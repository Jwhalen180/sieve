2022/03/18 18:00:26 server.go:17: registering rpc server...
2022/03/18 18:00:26 config.go:22: config:
map[crdList:[rabbitmqcluster] rateLimiterEnabled:false rateLimiterInterval:3]
2022/03/18 18:00:26 learn_server.go:125: start learnServer...
2022/03/18 18:00:26 learn_server.go:126: rateLimiterEnabled: false
2022/03/18 18:00:26 server.go:28: setting up connection...
2022/03/18 18:00:38 learn_server.go:279: [SIEVE-BEFORE-HEAR]	0	Added	rabbitmqcluster	{"metadata":{"name":"rabbitmq-cluster","namespace":"default","selfLink":"/apis/rabbitmq.com/v1beta1/namespaces/default/rabbitmqclusters/rabbitmq-cluster","uid":"18d9928b-0d1c-47be-80ec-20960d053827","resourceVersion":"693","generation":1,"creationTimestamp":"2022-03-18T18:00:38Z","annotations":{"kubectl.kubernetes.io/last-applied-configuration":"{\"apiVersion\":\"rabbitmq.com/v1beta1\",\"kind\":\"RabbitmqCluster\",\"metadata\":{\"annotations\":{},\"name\":\"rabbitmq-cluster\",\"namespace\":\"default\"},\"spec\":{\"persistence\":{\"storage\":\"10Gi\"},\"replicas\":1}}\n"},"managedFields":[{"manager":"kubectl-client-side-apply","operation":"Update","apiVersion":"rabbitmq.com/v1beta1","time":"2022-03-18T18:00:38Z","fieldsType":"FieldsV1","fieldsV1":{"f:metadata":{"f:annotations":{".":{},"f:kubectl.kubernetes.io/last-applied-configuration":{}}},"f:spec":{".":{},"f:image":{},"f:persistence":{".":{},"f:storage":{}},"f:replicas":{},"f:resources":{".":{},"f:limits":{".":{},"f:cpu":{},"f:memory":{}},"f:requests":{".":{},"f:cpu":{},"f:memory":{}}},"f:service":{".":{},"f:type":{}},"f:terminationGracePeriodSeconds":{}}}}]},"spec":{"replicas":1,"image":"rabbitmq:3.8.12-management","service":{"type":"ClusterIP"},"persistence":{"storage":"10Gi"},"resources":{"limits":{"cpu":"2","memory":"2Gi"},"requests":{"cpu":"1","memory":"2Gi"}},"rabbitmq":{},"tls":{},"override":{},"terminationGracePeriodSeconds":604800},"status":{"conditions":null}}
2022/03/18 18:00:38 learn_server.go:289: [SIEVE-AFTER-HEAR]	0
2022/03/18 18:00:38 learn_server.go:238: [SIEVE-BEFORE-RECONCILE]	github.com/rabbitmq/cluster-operator/controllers.(*RabbitmqClusterReconciler)	0
2022/03/18 18:00:38 learn_server.go:291: [SIEVE-AFTER-READ]	Get	true	rabbitmqcluster	default	rabbitmq-cluster	github.com/rabbitmq/cluster-operator/controllers.(*RabbitmqClusterReconciler)	NoError	{"kind":"RabbitmqCluster","apiVersion":"rabbitmq.com/v1beta1","metadata":{"name":"rabbitmq-cluster","namespace":"default","selfLink":"/apis/rabbitmq.com/v1beta1/namespaces/default/rabbitmqclusters/rabbitmq-cluster","uid":"18d9928b-0d1c-47be-80ec-20960d053827","resourceVersion":"693","generation":1,"creationTimestamp":"2022-03-18T18:00:38Z","annotations":{"kubectl.kubernetes.io/last-applied-configuration":"{\"apiVersion\":\"rabbitmq.com/v1beta1\",\"kind\":\"RabbitmqCluster\",\"metadata\":{\"annotations\":{},\"name\":\"rabbitmq-cluster\",\"namespace\":\"default\"},\"spec\":{\"persistence\":{\"storage\":\"10Gi\"},\"replicas\":1}}\n"},"managedFields":[{"manager":"kubectl-client-side-apply","operation":"Update","apiVersion":"rabbitmq.com/v1beta1","time":"2022-03-18T18:00:38Z","fieldsType":"FieldsV1","fieldsV1":{"f:metadata":{"f:annotations":{".":{},"f:kubectl.kubernetes.io/last-applied-configuration":{}}},"f:spec":{".":{},"f:image":{},"f:persistence":{".":{},"f:storage":{}},"f:replicas":{},"f:resources":{".":{},"f:limits":{".":{},"f:cpu":{},"f:memory":{}},"f:requests":{".":{},"f:cpu":{},"f:memory":{}}},"f:service":{".":{},"f:type":{}},"f:terminationGracePeriodSeconds":{}}}}]},"spec":{"replicas":1,"image":"rabbitmq:3.8.12-management","service":{"type":"ClusterIP"},"persistence":{"storage":"10Gi"},"resources":{"limits":{"cpu":"2","memory":"2Gi"},"requests":{"cpu":"1","memory":"2Gi"}},"rabbitmq":{},"tls":{},"override":{},"terminationGracePeriodSeconds":604800},"status":{"conditions":null}}
2022/03/18 18:00:38 learn_server.go:256: [SIEVE-BEFORE-WRITE]	0
2022/03/18 18:00:38 learn_server.go:279: [SIEVE-BEFORE-HEAR]	1	Updated	rabbitmqcluster	{"metadata":{"name":"rabbitmq-cluster","namespace":"default","selfLink":"/apis/rabbitmq.com/v1beta1/namespaces/default/rabbitmqclusters/rabbitmq-cluster","uid":"18d9928b-0d1c-47be-80ec-20960d053827","resourceVersion":"694","generation":2,"creationTimestamp":"2022-03-18T18:00:38Z","annotations":{"kubectl.kubernetes.io/last-applied-configuration":"{\"apiVersion\":\"rabbitmq.com/v1beta1\",\"kind\":\"RabbitmqCluster\",\"metadata\":{\"annotations\":{},\"name\":\"rabbitmq-cluster\",\"namespace\":\"default\"},\"spec\":{\"persistence\":{\"storage\":\"10Gi\"},\"replicas\":1}}\n"},"finalizers":["deletion.finalizers.rabbitmqclusters.rabbitmq.com"],"managedFields":[{"manager":"kubectl-client-side-apply","operation":"Update","apiVersion":"rabbitmq.com/v1beta1","time":"2022-03-18T18:00:38Z","fieldsType":"FieldsV1","fieldsV1":{"f:metadata":{"f:annotations":{".":{},"f:kubectl.kubernetes.io/last-applied-configuration":{}}},"f:spec":{".":{},"f:image":{},"f:persistence":{".":{},"f:storage":{}},"f:replicas":{},"f:resources":{".":{},"f:limits":{".":{},"f:memory":{}},"f:requests":{".":{},"f:memory":{}}},"f:service":{".":{},"f:type":{}},"f:terminationGracePeriodSeconds":{}}}},{"manager":"manager","operation":"Update","apiVersion":"rabbitmq.com/v1beta1","time":"2022-03-18T18:00:38Z","fieldsType":"FieldsV1","fieldsV1":{"f:metadata":{"f:finalizers":{}},"f:spec":{"f:override":{},"f:rabbitmq":{},"f:resources":{"f:limits":{"f:cpu":{}},"f:requests":{"f:cpu":{}}},"f:tls":{}},"f:status":{".":{},"f:conditions":{}}}}]},"spec":{"replicas":1,"image":"rabbitmq:3.8.12-management","service":{"type":"ClusterIP"},"persistence":{"storage":"10Gi"},"resources":{"limits":{"cpu":"2","memory":"2Gi"},"requests":{"cpu":"1","memory":"2Gi"}},"rabbitmq":{},"tls":{},"override":{},"terminationGracePeriodSeconds":604800},"status":{"conditions":null}}
2022/03/18 18:00:38 learn_server.go:289: [SIEVE-AFTER-HEAR]	1
2022/03/18 18:00:38 learn_server.go:263: [SIEVE-AFTER-WRITE]	0	Update	rabbitmqcluster	github.com/rabbitmq/cluster-operator/controllers.(*RabbitmqClusterReconciler)	NoError	{"metadata":{"name":"rabbitmq-cluster","namespace":"default","selfLink":"/apis/rabbitmq.com/v1beta1/namespaces/default/rabbitmqclusters/rabbitmq-cluster","uid":"18d9928b-0d1c-47be-80ec-20960d053827","resourceVersion":"694","generation":2,"creationTimestamp":"2022-03-18T18:00:38Z","annotations":{"kubectl.kubernetes.io/last-applied-configuration":"{\"apiVersion\":\"rabbitmq.com/v1beta1\",\"kind\":\"RabbitmqCluster\",\"metadata\":{\"annotations\":{},\"name\":\"rabbitmq-cluster\",\"namespace\":\"default\"},\"spec\":{\"persistence\":{\"storage\":\"10Gi\"},\"replicas\":1}}\n"},"finalizers":["deletion.finalizers.rabbitmqclusters.rabbitmq.com"],"managedFields":[{"manager":"kubectl-client-side-apply","operation":"Update","apiVersion":"rabbitmq.com/v1beta1","time":"2022-03-18T18:00:38Z","fieldsType":"FieldsV1","fieldsV1":{"f:metadata":{"f:annotations":{".":{},"f:kubectl.kubernetes.io/last-applied-configuration":{}}},"f:spec":{".":{},"f:image":{},"f:persistence":{".":{},"f:storage":{}},"f:replicas":{},"f:resources":{".":{},"f:limits":{".":{},"f:memory":{}},"f:requests":{".":{},"f:memory":{}}},"f:service":{".":{},"f:type":{}},"f:terminationGracePeriodSeconds":{}}}},{"manager":"manager","operation":"Update","apiVersion":"rabbitmq.com/v1beta1","time":"2022-03-18T18:00:38Z","fieldsType":"FieldsV1","fieldsV1":{"f:metadata":{"f:finalizers":{}},"f:spec":{"f:override":{},"f:rabbitmq":{},"f:resources":{"f:limits":{"f:cpu":{}},"f:requests":{"f:cpu":{}}},"f:tls":{}},"f:status":{".":{},"f:conditions":{}}}}]},"spec":{"replicas":1,"image":"rabbitmq:3.8.12-management","service":{"type":"ClusterIP"},"persistence":{"storage":"10Gi"},"resources":{"limits":{"cpu":"2","memory":"2Gi"},"requests":{"cpu":"1","memory":"2Gi"}},"rabbitmq":{},"tls":{},"override":{},"terminationGracePeriodSeconds":604800},"status":{"conditions":null}}
2022/03/18 18:00:38 learn_server.go:291: [SIEVE-AFTER-READ]	Get	true	statefulset	default	rabbitmq-cluster-server	github.com/rabbitmq/cluster-operator/controllers.(*RabbitmqClusterReconciler)	NotFound	{"metadata":{"creationTimestamp":null},"spec":{"selector":null,"template":{"metadata":{"creationTimestamp":null},"spec":{"containers":null}},"serviceName":"","updateStrategy":{}},"status":{"replicas":0}}
2022/03/18 18:00:38 learn_server.go:291: [SIEVE-AFTER-READ]	Get	true	endpoints	default	rabbitmq-cluster	github.com/rabbitmq/cluster-operator/controllers.(*RabbitmqClusterReconciler)	NotFound	{"metadata":{"creationTimestamp":null}}
2022/03/18 18:00:38 learn_server.go:256: [SIEVE-BEFORE-WRITE]	1
2022/03/18 18:00:38 learn_server.go:279: [SIEVE-BEFORE-HEAR]	2	Updated	rabbitmqcluster	{"metadata":{"name":"rabbitmq-cluster","namespace":"default","selfLink":"/apis/rabbitmq.com/v1beta1/namespaces/default/rabbitmqclusters/rabbitmq-cluster","uid":"18d9928b-0d1c-47be-80ec-20960d053827","resourceVersion":"695","generation":2,"creationTimestamp":"2022-03-18T18:00:38Z","annotations":{"kubectl.kubernetes.io/last-applied-configuration":"{\"apiVersion\":\"rabbitmq.com/v1beta1\",\"kind\":\"RabbitmqCluster\",\"metadata\":{\"annotations\":{},\"name\":\"rabbitmq-cluster\",\"namespace\":\"default\"},\"spec\":{\"persistence\":{\"storage\":\"10Gi\"},\"replicas\":1}}\n"},"finalizers":["deletion.finalizers.rabbitmqclusters.rabbitmq.com"],"managedFields":[{"manager":"kubectl-client-side-apply","operation":"Update","apiVersion":"rabbitmq.com/v1beta1","time":"2022-03-18T18:00:38Z","fieldsType":"FieldsV1","fieldsV1":{"f:metadata":{"f:annotations":{".":{},"f:kubectl.kubernetes.io/last-applied-configuration":{}}},"f:spec":{".":{},"f:image":{},"f:persistence":{".":{},"f:storage":{}},"f:replicas":{},"f:resources":{".":{},"f:limits":{".":{},"f:memory":{}},"f:requests":{".":{},"f:memory":{}}},"f:service":{".":{},"f:type":{}},"f:terminationGracePeriodSeconds":{}}}},{"manager":"manager","operation":"Update","apiVersion":"rabbitmq.com/v1beta1","time":"2022-03-18T18:00:38Z","fieldsType":"FieldsV1","fieldsV1":{"f:metadata":{"f:finalizers":{}},"f:spec":{"f:override":{},"f:rabbitmq":{},"f:resources":{"f:limits":{"f:cpu":{}},"f:requests":{"f:cpu":{}}},"f:tls":{}},"f:status":{".":{},"f:conditions":{}}}}]},"spec":{"replicas":1,"image":"rabbitmq:3.8.12-management","service":{"type":"ClusterIP"},"persistence":{"storage":"10Gi"},"resources":{"limits":{"cpu":"2","memory":"2Gi"},"requests":{"cpu":"1","memory":"2Gi"}},"rabbitmq":{},"tls":{},"override":{},"terminationGracePeriodSeconds":604800},"status":{"conditions":[{"type":"AllReplicasReady","status":"Unknown","lastTransitionTime":"2022-03-18T18:00:38Z","reason":"MissingStatefulSet","message":"Could not find StatefulSet"},{"type":"ClusterAvailable","status":"Unknown","lastTransitionTime":"2022-03-18T18:00:38Z","reason":"CouldNotRetrieveEndpoints","message":"Could not verify available service endpoints"},{"type":"NoWarnings","status":"Unknown","lastTransitionTime":"2022-03-18T18:00:38Z","reason":"MissingStatefulSet","message":"Could not find StatefulSet"},{"type":"ReconcileSuccess","status":"Unknown","lastTransitionTime":"2022-03-18T18:00:38Z","reason":"Initialising"}]}}
2022/03/18 18:00:38 learn_server.go:289: [SIEVE-AFTER-HEAR]	2
2022/03/18 18:00:38 learn_server.go:263: [SIEVE-AFTER-WRITE]	1	StatusUpdate	rabbitmqcluster	github.com/rabbitmq/cluster-operator/controllers.(*RabbitmqClusterReconciler)	NoError	{"metadata":{"name":"rabbitmq-cluster","namespace":"default","selfLink":"/apis/rabbitmq.com/v1beta1/namespaces/default/rabbitmqclusters/rabbitmq-cluster/status","uid":"18d9928b-0d1c-47be-80ec-20960d053827","resourceVersion":"695","generation":2,"creationTimestamp":"2022-03-18T18:00:38Z","annotations":{"kubectl.kubernetes.io/last-applied-configuration":"{\"apiVersion\":\"rabbitmq.com/v1beta1\",\"kind\":\"RabbitmqCluster\",\"metadata\":{\"annotations\":{},\"name\":\"rabbitmq-cluster\",\"namespace\":\"default\"},\"spec\":{\"persistence\":{\"storage\":\"10Gi\"},\"replicas\":1}}\n"},"finalizers":["deletion.finalizers.rabbitmqclusters.rabbitmq.com"],"managedFields":[{"manager":"kubectl-client-side-apply","operation":"Update","apiVersion":"rabbitmq.com/v1beta1","time":"2022-03-18T18:00:38Z","fieldsType":"FieldsV1","fieldsV1":{"f:metadata":{"f:annotations":{".":{},"f:kubectl.kubernetes.io/last-applied-configuration":{}}},"f:spec":{".":{},"f:image":{},"f:persistence":{".":{},"f:storage":{}},"f:replicas":{},"f:resources":{".":{},"f:limits":{".":{},"f:memory":{}},"f:requests":{".":{},"f:memory":{}}},"f:service":{".":{},"f:type":{}},"f:terminationGracePeriodSeconds":{}}}},{"manager":"manager","operation":"Update","apiVersion":"rabbitmq.com/v1beta1","time":"2022-03-18T18:00:38Z","fieldsType":"FieldsV1","fieldsV1":{"f:metadata":{"f:finalizers":{}},"f:spec":{"f:override":{},"f:rabbitmq":{},"f:resources":{"f:limits":{"f:cpu":{}},"f:requests":{"f:cpu":{}}},"f:tls":{}},"f:status":{".":{},"f:conditions":{}}}}]},"spec":{"replicas":1,"image":"rabbitmq:3.8.12-management","service":{"type":"ClusterIP"},"persistence":{"storage":"10Gi"},"resources":{"limits":{"cpu":"2","memory":"2Gi"},"requests":{"cpu":"1","memory":"2Gi"}},"rabbitmq":{},"tls":{},"override":{},"terminationGracePeriodSeconds":604800},"status":{"conditions":[{"type":"AllReplicasReady","status":"Unknown","lastTransitionTime":"2022-03-18T18:00:38Z","reason":"MissingStatefulSet","message":"Could not find StatefulSet"},{"type":"ClusterAvailable","status":"Unknown","lastTransitionTime":"2022-03-18T18:00:38Z","reason":"CouldNotRetrieveEndpoints","message":"Could not verify available service endpoints"},{"type":"NoWarnings","status":"Unknown","lastTransitionTime":"2022-03-18T18:00:38Z","reason":"MissingStatefulSet","message":"Could not find StatefulSet"},{"type":"ReconcileSuccess","status":"Unknown","lastTransitionTime":"2022-03-18T18:00:38Z","reason":"Initialising"}]}}
2022/03/18 18:00:38 learn_server.go:291: [SIEVE-AFTER-READ]	Get	true	statefulset	default	rabbitmq-cluster-server	github.com/rabbitmq/cluster-operator/controllers.(*RabbitmqClusterReconciler)	NotFound	{"metadata":{"creationTimestamp":null},"spec":{"selector":null,"template":{"metadata":{"creationTimestamp":null},"spec":{"containers":null}},"serviceName":"","updateStrategy":{}},"status":{"replicas":0}}
2022/03/18 18:00:38 learn_server.go:291: [SIEVE-AFTER-READ]	Get	true	service	default	rabbitmq-cluster-nodes	github.com/rabbitmq/cluster-operator/controllers.(*RabbitmqClusterReconciler)	NotFound	{"metadata":{"name":"rabbitmq-cluster-nodes","namespace":"default","creationTimestamp":null},"spec":{},"status":{"loadBalancer":{}}}
2022/03/18 18:00:38 learn_server.go:256: [SIEVE-BEFORE-WRITE]	2
2022/03/18 18:00:38 learn_server.go:263: [SIEVE-AFTER-WRITE]	2	Create	service	github.com/rabbitmq/cluster-operator/controllers.(*RabbitmqClusterReconciler)	NoError	{"metadata":{"name":"rabbitmq-cluster-nodes","namespace":"default","selfLink":"/api/v1/namespaces/default/services/rabbitmq-cluster-nodes","uid":"67c7eea9-1b87-4fd7-82e6-5bfe31fd1b52","resourceVersion":"696","creationTimestamp":"2022-03-18T18:00:38Z","labels":{"app.kubernetes.io/component":"rabbitmq","app.kubernetes.io/name":"rabbitmq-cluster","app.kubernetes.io/part-of":"rabbitmq"},"ownerReferences":[{"apiVersion":"rabbitmq.com/v1beta1","kind":"RabbitmqCluster","name":"rabbitmq-cluster","uid":"18d9928b-0d1c-47be-80ec-20960d053827","controller":true,"blockOwnerDeletion":true}],"managedFields":[{"manager":"manager","operation":"Update","apiVersion":"v1","time":"2022-03-18T18:00:38Z","fieldsType":"FieldsV1","fieldsV1":{"f:metadata":{"f:labels":{".":{},"f:app.kubernetes.io/component":{},"f:app.kubernetes.io/name":{},"f:app.kubernetes.io/part-of":{}},"f:ownerReferences":{".":{},"k:{\"uid\":\"18d9928b-0d1c-47be-80ec-20960d053827\"}":{".":{},"f:apiVersion":{},"f:blockOwnerDeletion":{},"f:controller":{},"f:kind":{},"f:name":{},"f:uid":{}}}},"f:spec":{"f:clusterIP":{},"f:ports":{".":{},"k:{\"port\":4369,\"protocol\":\"TCP\"}":{".":{},"f:name":{},"f:port":{},"f:protocol":{},"f:targetPort":{}},"k:{\"port\":25672,\"protocol\":\"TCP\"}":{".":{},"f:name":{},"f:port":{},"f:protocol":{},"f:targetPort":{}}},"f:publishNotReadyAddresses":{},"f:selector":{".":{},"f:app.kubernetes.io/name":{}},"f:sessionAffinity":{},"f:type":{}}}}]},"spec":{"ports":[{"name":"epmd","protocol":"TCP","port":4369,"targetPort":4369},{"name":"cluster-rpc","protocol":"TCP","port":25672,"targetPort":25672}],"selector":{"app.kubernetes.io/name":"rabbitmq-cluster"},"clusterIP":"None","type":"ClusterIP","sessionAffinity":"None","publishNotReadyAddresses":true},"status":{"loadBalancer":{}}}
2022/03/18 18:00:38 learn_server.go:279: [SIEVE-BEFORE-HEAR]	3	Added	service	{"metadata":{"name":"rabbitmq-cluster-nodes","namespace":"default","selfLink":"/api/v1/namespaces/default/services/rabbitmq-cluster-nodes","uid":"67c7eea9-1b87-4fd7-82e6-5bfe31fd1b52","resourceVersion":"696","creationTimestamp":"2022-03-18T18:00:38Z","labels":{"app.kubernetes.io/component":"rabbitmq","app.kubernetes.io/name":"rabbitmq-cluster","app.kubernetes.io/part-of":"rabbitmq"},"ownerReferences":[{"apiVersion":"rabbitmq.com/v1beta1","kind":"RabbitmqCluster","name":"rabbitmq-cluster","uid":"18d9928b-0d1c-47be-80ec-20960d053827","controller":true,"blockOwnerDeletion":true}],"managedFields":[{"manager":"manager","operation":"Update","apiVersion":"v1","time":"2022-03-18T18:00:38Z","fieldsType":"FieldsV1","fieldsV1":{"f:metadata":{"f:labels":{".":{},"f:app.kubernetes.io/component":{},"f:app.kubernetes.io/name":{},"f:app.kubernetes.io/part-of":{}},"f:ownerReferences":{".":{},"k:{\"uid\":\"18d9928b-0d1c-47be-80ec-20960d053827\"}":{".":{},"f:apiVersion":{},"f:blockOwnerDeletion":{},"f:controller":{},"f:kind":{},"f:name":{},"f:uid":{}}}},"f:spec":{"f:clusterIP":{},"f:ports":{".":{},"k:{\"port\":4369,\"protocol\":\"TCP\"}":{".":{},"f:name":{},"f:port":{},"f:protocol":{},"f:targetPort":{}},"k:{\"port\":25672,\"protocol\":\"TCP\"}":{".":{},"f:name":{},"f:port":{},"f:protocol":{},"f:targetPort":{}}},"f:publishNotReadyAddresses":{},"f:selector":{".":{},"f:app.kubernetes.io/name":{}},"f:sessionAffinity":{},"f:type":{}}}}]},"spec":{"ports":[{"name":"epmd","protocol":"TCP","port":4369,"targetPort":4369},{"name":"cluster-rpc","protocol":"TCP","port":25672,"targetPort":25672}],"selector":{"app.kubernetes.io/name":"rabbitmq-cluster"},"clusterIP":"None","type":"ClusterIP","sessionAffinity":"None","publishNotReadyAddresses":true},"status":{"loadBalancer":{}}}
2022/03/18 18:00:38 learn_server.go:289: [SIEVE-AFTER-HEAR]	3
2022/03/18 18:00:38 learn_server.go:291: [SIEVE-AFTER-READ]	Get	true	service	default	rabbitmq-cluster	github.com/rabbitmq/cluster-operator/controllers.(*RabbitmqClusterReconciler)	NotFound	{"metadata":{"name":"rabbitmq-cluster","namespace":"default","creationTimestamp":null},"spec":{},"status":{"loadBalancer":{}}}
2022/03/18 18:00:38 learn_server.go:256: [SIEVE-BEFORE-WRITE]	3
2022/03/18 18:00:38 learn_server.go:263: [SIEVE-AFTER-WRITE]	3	Create	service	github.com/rabbitmq/cluster-operator/controllers.(*RabbitmqClusterReconciler)	NoError	{"metadata":{"name":"rabbitmq-cluster","namespace":"default","selfLink":"/api/v1/namespaces/default/services/rabbitmq-cluster","uid":"56b50671-1945-458b-adac-05619b783392","resourceVersion":"701","creationTimestamp":"2022-03-18T18:00:38Z","labels":{"app.kubernetes.io/component":"rabbitmq","app.kubernetes.io/name":"rabbitmq-cluster","app.kubernetes.io/part-of":"rabbitmq"},"ownerReferences":[{"apiVersion":"rabbitmq.com/v1beta1","kind":"RabbitmqCluster","name":"rabbitmq-cluster","uid":"18d9928b-0d1c-47be-80ec-20960d053827","controller":true,"blockOwnerDeletion":true}],"managedFields":[{"manager":"manager","operation":"Update","apiVersion":"v1","time":"2022-03-18T18:00:38Z","fieldsType":"FieldsV1","fieldsV1":{"f:metadata":{"f:labels":{".":{},"f:app.kubernetes.io/component":{},"f:app.kubernetes.io/name":{},"f:app.kubernetes.io/part-of":{}},"f:ownerReferences":{".":{},"k:{\"uid\":\"18d9928b-0d1c-47be-80ec-20960d053827\"}":{".":{},"f:apiVersion":{},"f:blockOwnerDeletion":{},"f:controller":{},"f:kind":{},"f:name":{},"f:uid":{}}}},"f:spec":{"f:ports":{".":{},"k:{\"port\":5672,\"protocol\":\"TCP\"}":{".":{},"f:name":{},"f:port":{},"f:protocol":{},"f:targetPort":{}},"k:{\"port\":15672,\"protocol\":\"TCP\"}":{".":{},"f:name":{},"f:port":{},"f:protocol":{},"f:targetPort":{}}},"f:selector":{".":{},"f:app.kubernetes.io/name":{}},"f:sessionAffinity":{},"f:type":{}}}}]},"spec":{"ports":[{"name":"amqp","protocol":"TCP","port":5672,"targetPort":5672},{"name":"management","protocol":"TCP","port":15672,"targetPort":15672}],"selector":{"app.kubernetes.io/name":"rabbitmq-cluster"},"clusterIP":"10.96.254.158","type":"ClusterIP","sessionAffinity":"None"},"status":{"loadBalancer":{}}}
2022/03/18 18:00:38 learn_server.go:291: [SIEVE-AFTER-READ]	Get	true	secret	default	rabbitmq-cluster-erlang-cookie	github.com/rabbitmq/cluster-operator/controllers.(*RabbitmqClusterReconciler)	NotFound	{"metadata":{"name":"rabbitmq-cluster-erlang-cookie","namespace":"default","creationTimestamp":null},"data":{".erlang.cookie":"QW9hMkpWU0tlYS1FUGdWTUhrelNMNnFoMFZ0ZmRGNUY="},"type":"Opaque"}
2022/03/18 18:00:38 learn_server.go:256: [SIEVE-BEFORE-WRITE]	4
2022/03/18 18:00:38 learn_server.go:279: [SIEVE-BEFORE-HEAR]	4	Added	service	{"metadata":{"name":"rabbitmq-cluster","namespace":"default","selfLink":"/api/v1/namespaces/default/services/rabbitmq-cluster","uid":"56b50671-1945-458b-adac-05619b783392","resourceVersion":"701","creationTimestamp":"2022-03-18T18:00:38Z","labels":{"app.kubernetes.io/component":"rabbitmq","app.kubernetes.io/name":"rabbitmq-cluster","app.kubernetes.io/part-of":"rabbitmq"},"ownerReferences":[{"apiVersion":"rabbitmq.com/v1beta1","kind":"RabbitmqCluster","name":"rabbitmq-cluster","uid":"18d9928b-0d1c-47be-80ec-20960d053827","controller":true,"blockOwnerDeletion":true}],"managedFields":[{"manager":"manager","operation":"Update","apiVersion":"v1","time":"2022-03-18T18:00:38Z","fieldsType":"FieldsV1","fieldsV1":{"f:metadata":{"f:labels":{".":{},"f:app.kubernetes.io/component":{},"f:app.kubernetes.io/name":{},"f:app.kubernetes.io/part-of":{}},"f:ownerReferences":{".":{},"k:{\"uid\":\"18d9928b-0d1c-47be-80ec-20960d053827\"}":{".":{},"f:apiVersion":{},"f:blockOwnerDeletion":{},"f:controller":{},"f:kind":{},"f:name":{},"f:uid":{}}}},"f:spec":{"f:ports":{".":{},"k:{\"port\":5672,\"protocol\":\"TCP\"}":{".":{},"f:name":{},"f:port":{},"f:protocol":{},"f:targetPort":{}},"k:{\"port\":15672,\"protocol\":\"TCP\"}":{".":{},"f:name":{},"f:port":{},"f:protocol":{},"f:targetPort":{}}},"f:selector":{".":{},"f:app.kubernetes.io/name":{}},"f:sessionAffinity":{},"f:type":{}}}}]},"spec":{"ports":[{"name":"amqp","protocol":"TCP","port":5672,"targetPort":5672},{"name":"management","protocol":"TCP","port":15672,"targetPort":15672}],"selector":{"app.kubernetes.io/name":"rabbitmq-cluster"},"clusterIP":"10.96.254.158","type":"ClusterIP","sessionAffinity":"None"},"status":{"loadBalancer":{}}}
2022/03/18 18:00:38 learn_server.go:289: [SIEVE-AFTER-HEAR]	4
2022/03/18 18:00:38 learn_server.go:279: [SIEVE-BEFORE-HEAR]	5	Added	secret	{"metadata":{"name":"rabbitmq-cluster-erlang-cookie","namespace":"default","selfLink":"/api/v1/namespaces/default/secrets/rabbitmq-cluster-erlang-cookie","uid":"f8fbe8a6-0f40-4e13-960b-ab78b8ba75b0","resourceVersion":"705","creationTimestamp":"2022-03-18T18:00:38Z","labels":{"app.kubernetes.io/component":"rabbitmq","app.kubernetes.io/name":"rabbitmq-cluster","app.kubernetes.io/part-of":"rabbitmq"},"ownerReferences":[{"apiVersion":"rabbitmq.com/v1beta1","kind":"RabbitmqCluster","name":"rabbitmq-cluster","uid":"18d9928b-0d1c-47be-80ec-20960d053827","controller":true,"blockOwnerDeletion":true}],"managedFields":[{"manager":"manager","operation":"Update","apiVersion":"v1","time":"2022-03-18T18:00:38Z","fieldsType":"FieldsV1","fieldsV1":{"f:data":{".":{},"f:.erlang.cookie":{}},"f:metadata":{"f:labels":{".":{},"f:app.kubernetes.io/component":{},"f:app.kubernetes.io/name":{},"f:app.kubernetes.io/part-of":{}},"f:ownerReferences":{".":{},"k:{\"uid\":\"18d9928b-0d1c-47be-80ec-20960d053827\"}":{".":{},"f:apiVersion":{},"f:blockOwnerDeletion":{},"f:controller":{},"f:kind":{},"f:name":{},"f:uid":{}}}},"f:type":{}}}]},"data":{".erlang.cookie":"QW9hMkpWU0tlYS1FUGdWTUhrelNMNnFoMFZ0ZmRGNUY="},"type":"Opaque"}
2022/03/18 18:00:38 learn_server.go:289: [SIEVE-AFTER-HEAR]	5
2022/03/18 18:00:38 learn_server.go:263: [SIEVE-AFTER-WRITE]	4	Create	secret	github.com/rabbitmq/cluster-operator/controllers.(*RabbitmqClusterReconciler)	NoError	{"metadata":{"name":"rabbitmq-cluster-erlang-cookie","namespace":"default","selfLink":"/api/v1/namespaces/default/secrets/rabbitmq-cluster-erlang-cookie","uid":"f8fbe8a6-0f40-4e13-960b-ab78b8ba75b0","resourceVersion":"705","creationTimestamp":"2022-03-18T18:00:38Z","labels":{"app.kubernetes.io/component":"rabbitmq","app.kubernetes.io/name":"rabbitmq-cluster","app.kubernetes.io/part-of":"rabbitmq"},"ownerReferences":[{"apiVersion":"rabbitmq.com/v1beta1","kind":"RabbitmqCluster","name":"rabbitmq-cluster","uid":"18d9928b-0d1c-47be-80ec-20960d053827","controller":true,"blockOwnerDeletion":true}],"managedFields":[{"manager":"manager","operation":"Update","apiVersion":"v1","time":"2022-03-18T18:00:38Z","fieldsType":"FieldsV1","fieldsV1":{"f:data":{".":{},"f:.erlang.cookie":{}},"f:metadata":{"f:labels":{".":{},"f:app.kubernetes.io/component":{},"f:app.kubernetes.io/name":{},"f:app.kubernetes.io/part-of":{}},"f:ownerReferences":{".":{},"k:{\"uid\":\"18d9928b-0d1c-47be-80ec-20960d053827\"}":{".":{},"f:apiVersion":{},"f:blockOwnerDeletion":{},"f:controller":{},"f:kind":{},"f:name":{},"f:uid":{}}}},"f:type":{}}}]},"data":{".erlang.cookie":"QW9hMkpWU0tlYS1FUGdWTUhrelNMNnFoMFZ0ZmRGNUY="},"type":"Opaque"}
2022/03/18 18:00:38 learn_server.go:291: [SIEVE-AFTER-READ]	Get	true	secret	default	rabbitmq-cluster-default-user	github.com/rabbitmq/cluster-operator/controllers.(*RabbitmqClusterReconciler)	NotFound	{"metadata":{"name":"rabbitmq-cluster-default-user","namespace":"default","creationTimestamp":null},"data":{"default_user.conf":"ZGVmYXVsdF91c2VyID0gcTMxRmh3MGtjWW9SZUl5X3BPTXp2ZVBOUnNVU3I1Mk8KZGVmYXVsdF9wYXNzID0gY0dBX19jNTJHX05hVURpTGhraWZ6UDBOVVlNLTE2MWQK","password":"Y0dBX19jNTJHX05hVURpTGhraWZ6UDBOVVlNLTE2MWQ=","provider":"cmFiYml0bXE=","type":"cmFiYml0bXE=","username":"cTMxRmh3MGtjWW9SZUl5X3BPTXp2ZVBOUnNVU3I1Mk8="},"type":"Opaque"}
2022/03/18 18:00:38 learn_server.go:256: [SIEVE-BEFORE-WRITE]	5
2022/03/18 18:00:38 learn_server.go:263: [SIEVE-AFTER-WRITE]	5	Create	secret	github.com/rabbitmq/cluster-operator/controllers.(*RabbitmqClusterReconciler)	NoError	{"metadata":{"name":"rabbitmq-cluster-default-user","namespace":"default","selfLink":"/api/v1/namespaces/default/secrets/rabbitmq-cluster-default-user","uid":"0d9f460b-a23c-402b-8273-f541ed39023f","resourceVersion":"708","creationTimestamp":"2022-03-18T18:00:38Z","labels":{"app.kubernetes.io/component":"rabbitmq","app.kubernetes.io/name":"rabbitmq-cluster","app.kubernetes.io/part-of":"rabbitmq"},"ownerReferences":[{"apiVersion":"rabbitmq.com/v1beta1","kind":"RabbitmqCluster","name":"rabbitmq-cluster","uid":"18d9928b-0d1c-47be-80ec-20960d053827","controller":true,"blockOwnerDeletion":true}],"managedFields":[{"manager":"manager","operation":"Update","apiVersion":"v1","time":"2022-03-18T18:00:38Z","fieldsType":"FieldsV1","fieldsV1":{"f:data":{".":{},"f:default_user.conf":{},"f:password":{},"f:provider":{},"f:type":{},"f:username":{}},"f:metadata":{"f:labels":{".":{},"f:app.kubernetes.io/component":{},"f:app.kubernetes.io/name":{},"f:app.kubernetes.io/part-of":{}},"f:ownerReferences":{".":{},"k:{\"uid\":\"18d9928b-0d1c-47be-80ec-20960d053827\"}":{".":{},"f:apiVersion":{},"f:blockOwnerDeletion":{},"f:controller":{},"f:kind":{},"f:name":{},"f:uid":{}}}},"f:type":{}}}]},"data":{"default_user.conf":"ZGVmYXVsdF91c2VyID0gcTMxRmh3MGtjWW9SZUl5X3BPTXp2ZVBOUnNVU3I1Mk8KZGVmYXVsdF9wYXNzID0gY0dBX19jNTJHX05hVURpTGhraWZ6UDBOVVlNLTE2MWQK","password":"Y0dBX19jNTJHX05hVURpTGhraWZ6UDBOVVlNLTE2MWQ=","provider":"cmFiYml0bXE=","type":"cmFiYml0bXE=","username":"cTMxRmh3MGtjWW9SZUl5X3BPTXp2ZVBOUnNVU3I1Mk8="},"type":"Opaque"}
2022/03/18 18:00:38 learn_server.go:279: [SIEVE-BEFORE-HEAR]	6	Added	secret	{"metadata":{"name":"rabbitmq-cluster-default-user","namespace":"default","selfLink":"/api/v1/namespaces/default/secrets/rabbitmq-cluster-default-user","uid":"0d9f460b-a23c-402b-8273-f541ed39023f","resourceVersion":"708","creationTimestamp":"2022-03-18T18:00:38Z","labels":{"app.kubernetes.io/component":"rabbitmq","app.kubernetes.io/name":"rabbitmq-cluster","app.kubernetes.io/part-of":"rabbitmq"},"ownerReferences":[{"apiVersion":"rabbitmq.com/v1beta1","kind":"RabbitmqCluster","name":"rabbitmq-cluster","uid":"18d9928b-0d1c-47be-80ec-20960d053827","controller":true,"blockOwnerDeletion":true}],"managedFields":[{"manager":"manager","operation":"Update","apiVersion":"v1","time":"2022-03-18T18:00:38Z","fieldsType":"FieldsV1","fieldsV1":{"f:data":{".":{},"f:default_user.conf":{},"f:password":{},"f:provider":{},"f:type":{},"f:username":{}},"f:metadata":{"f:labels":{".":{},"f:app.kubernetes.io/component":{},"f:app.kubernetes.io/name":{},"f:app.kubernetes.io/part-of":{}},"f:ownerReferences":{".":{},"k:{\"uid\":\"18d9928b-0d1c-47be-80ec-20960d053827\"}":{".":{},"f:apiVersion":{},"f:blockOwnerDeletion":{},"f:controller":{},"f:kind":{},"f:name":{},"f:uid":{}}}},"f:type":{}}}]},"data":{"default_user.conf":"ZGVmYXVsdF91c2VyID0gcTMxRmh3MGtjWW9SZUl5X3BPTXp2ZVBOUnNVU3I1Mk8KZGVmYXVsdF9wYXNzID0gY0dBX19jNTJHX05hVURpTGhraWZ6UDBOVVlNLTE2MWQK","password":"Y0dBX19jNTJHX05hVURpTGhraWZ6UDBOVVlNLTE2MWQ=","provider":"cmFiYml0bXE=","type":"cmFiYml0bXE=","username":"cTMxRmh3MGtjWW9SZUl5X3BPTXp2ZVBOUnNVU3I1Mk8="},"type":"Opaque"}
2022/03/18 18:00:38 learn_server.go:289: [SIEVE-AFTER-HEAR]	6
2022/03/18 18:00:38 learn_server.go:291: [SIEVE-AFTER-READ]	Get	true	configmap	default	rabbitmq-cluster-plugins-conf	github.com/rabbitmq/cluster-operator/controllers.(*RabbitmqClusterReconciler)	NotFound	{"metadata":{"name":"rabbitmq-cluster-plugins-conf","namespace":"default","creationTimestamp":null,"labels":{"app.kubernetes.io/component":"rabbitmq","app.kubernetes.io/name":"rabbitmq-cluster","app.kubernetes.io/part-of":"rabbitmq"}},"data":{"enabled_plugins":"[rabbitmq_peer_discovery_k8s,rabbitmq_prometheus,rabbitmq_management]."}}
2022/03/18 18:00:38 learn_server.go:256: [SIEVE-BEFORE-WRITE]	6
2022/03/18 18:00:38 learn_server.go:279: [SIEVE-BEFORE-HEAR]	7	Added	configmap	{"metadata":{"name":"rabbitmq-cluster-plugins-conf","namespace":"default","selfLink":"/api/v1/namespaces/default/configmaps/rabbitmq-cluster-plugins-conf","uid":"a164075b-0562-47ac-a577-99aa8651ec40","resourceVersion":"709","creationTimestamp":"2022-03-18T18:00:38Z","labels":{"app.kubernetes.io/component":"rabbitmq","app.kubernetes.io/name":"rabbitmq-cluster","app.kubernetes.io/part-of":"rabbitmq"},"ownerReferences":[{"apiVersion":"rabbitmq.com/v1beta1","kind":"RabbitmqCluster","name":"rabbitmq-cluster","uid":"18d9928b-0d1c-47be-80ec-20960d053827","controller":true,"blockOwnerDeletion":true}],"managedFields":[{"manager":"manager","operation":"Update","apiVersion":"v1","time":"2022-03-18T18:00:38Z","fieldsType":"FieldsV1","fieldsV1":{"f:data":{".":{},"f:enabled_plugins":{}},"f:metadata":{"f:labels":{".":{},"f:app.kubernetes.io/component":{},"f:app.kubernetes.io/name":{},"f:app.kubernetes.io/part-of":{}},"f:ownerReferences":{".":{},"k:{\"uid\":\"18d9928b-0d1c-47be-80ec-20960d053827\"}":{".":{},"f:apiVersion":{},"f:blockOwnerDeletion":{},"f:controller":{},"f:kind":{},"f:name":{},"f:uid":{}}}}}}]},"data":{"enabled_plugins":"[rabbitmq_peer_discovery_k8s,rabbitmq_prometheus,rabbitmq_management]."}}
2022/03/18 18:00:38 learn_server.go:263: [SIEVE-AFTER-WRITE]	6	Create	configmap	github.com/rabbitmq/cluster-operator/controllers.(*RabbitmqClusterReconciler)	NoError	{"metadata":{"name":"rabbitmq-cluster-plugins-conf","namespace":"default","selfLink":"/api/v1/namespaces/default/configmaps/rabbitmq-cluster-plugins-conf","uid":"a164075b-0562-47ac-a577-99aa8651ec40","resourceVersion":"709","creationTimestamp":"2022-03-18T18:00:38Z","labels":{"app.kubernetes.io/component":"rabbitmq","app.kubernetes.io/name":"rabbitmq-cluster","app.kubernetes.io/part-of":"rabbitmq"},"ownerReferences":[{"apiVersion":"rabbitmq.com/v1beta1","kind":"RabbitmqCluster","name":"rabbitmq-cluster","uid":"18d9928b-0d1c-47be-80ec-20960d053827","controller":true,"blockOwnerDeletion":true}],"managedFields":[{"manager":"manager","operation":"Update","apiVersion":"v1","time":"2022-03-18T18:00:38Z","fieldsType":"FieldsV1","fieldsV1":{"f:data":{".":{},"f:enabled_plugins":{}},"f:metadata":{"f:labels":{".":{},"f:app.kubernetes.io/component":{},"f:app.kubernetes.io/name":{},"f:app.kubernetes.io/part-of":{}},"f:ownerReferences":{".":{},"k:{\"uid\":\"18d9928b-0d1c-47be-80ec-20960d053827\"}":{".":{},"f:apiVersion":{},"f:blockOwnerDeletion":{},"f:controller":{},"f:kind":{},"f:name":{},"f:uid":{}}}}}}]},"data":{"enabled_plugins":"[rabbitmq_peer_discovery_k8s,rabbitmq_prometheus,rabbitmq_management]."}}
2022/03/18 18:00:38 learn_server.go:289: [SIEVE-AFTER-HEAR]	7
2022/03/18 18:00:38 learn_server.go:291: [SIEVE-AFTER-READ]	Get	true	configmap	default	rabbitmq-cluster-server-conf	github.com/rabbitmq/cluster-operator/controllers.(*RabbitmqClusterReconciler)	NotFound	{"metadata":{"name":"rabbitmq-cluster-server-conf","namespace":"default","creationTimestamp":null,"labels":{"app.kubernetes.io/component":"rabbitmq","app.kubernetes.io/name":"rabbitmq-cluster","app.kubernetes.io/part-of":"rabbitmq"}}}
2022/03/18 18:00:38 learn_server.go:256: [SIEVE-BEFORE-WRITE]	7
2022/03/18 18:00:38 learn_server.go:279: [SIEVE-BEFORE-HEAR]	8	Added	configmap	{"metadata":{"name":"rabbitmq-cluster-server-conf","namespace":"default","selfLink":"/api/v1/namespaces/default/configmaps/rabbitmq-cluster-server-conf","uid":"22474f2b-8454-44b7-8079-8990223969cc","resourceVersion":"714","creationTimestamp":"2022-03-18T18:00:38Z","labels":{"app.kubernetes.io/component":"rabbitmq","app.kubernetes.io/name":"rabbitmq-cluster","app.kubernetes.io/part-of":"rabbitmq"},"ownerReferences":[{"apiVersion":"rabbitmq.com/v1beta1","kind":"RabbitmqCluster","name":"rabbitmq-cluster","uid":"18d9928b-0d1c-47be-80ec-20960d053827","controller":true,"blockOwnerDeletion":true}],"managedFields":[{"manager":"manager","operation":"Update","apiVersion":"v1","time":"2022-03-18T18:00:38Z","fieldsType":"FieldsV1","fieldsV1":{"f:data":{".":{},"f:operatorDefaults.conf":{},"f:userDefinedConfiguration.conf":{}},"f:metadata":{"f:labels":{".":{},"f:app.kubernetes.io/component":{},"f:app.kubernetes.io/name":{},"f:app.kubernetes.io/part-of":{}},"f:ownerReferences":{".":{},"k:{\"uid\":\"18d9928b-0d1c-47be-80ec-20960d053827\"}":{".":{},"f:apiVersion":{},"f:blockOwnerDeletion":{},"f:controller":{},"f:kind":{},"f:name":{},"f:uid":{}}}}}}]},"data":{"operatorDefaults.conf":"cluster_formation.peer_discovery_backend             = rabbit_peer_discovery_k8s\ncluster_formation.k8s.host                           = kubernetes.default\ncluster_formation.k8s.address_type                   = hostname\ncluster_partition_handling                           = pause_minority\nqueue_master_locator                                 = min-masters\ndisk_free_limit.absolute                             = 2GB\ncluster_formation.randomized_startup_delay_range.min = 5\ncluster_formation.randomized_startup_delay_range.max = 30\ncluster_name                                         = rabbitmq-cluster\n","userDefinedConfiguration.conf":"total_memory_available_override_value = 1717986919\n"}}
2022/03/18 18:00:38 learn_server.go:263: [SIEVE-AFTER-WRITE]	7	Create	configmap	github.com/rabbitmq/cluster-operator/controllers.(*RabbitmqClusterReconciler)	NoError	{"metadata":{"name":"rabbitmq-cluster-server-conf","namespace":"default","selfLink":"/api/v1/namespaces/default/configmaps/rabbitmq-cluster-server-conf","uid":"22474f2b-8454-44b7-8079-8990223969cc","resourceVersion":"714","creationTimestamp":"2022-03-18T18:00:38Z","labels":{"app.kubernetes.io/component":"rabbitmq","app.kubernetes.io/name":"rabbitmq-cluster","app.kubernetes.io/part-of":"rabbitmq"},"ownerReferences":[{"apiVersion":"rabbitmq.com/v1beta1","kind":"RabbitmqCluster","name":"rabbitmq-cluster","uid":"18d9928b-0d1c-47be-80ec-20960d053827","controller":true,"blockOwnerDeletion":true}],"managedFields":[{"manager":"manager","operation":"Update","apiVersion":"v1","time":"2022-03-18T18:00:38Z","fieldsType":"FieldsV1","fieldsV1":{"f:data":{".":{},"f:operatorDefaults.conf":{},"f:userDefinedConfiguration.conf":{}},"f:metadata":{"f:labels":{".":{},"f:app.kubernetes.io/component":{},"f:app.kubernetes.io/name":{},"f:app.kubernetes.io/part-of":{}},"f:ownerReferences":{".":{},"k:{\"uid\":\"18d9928b-0d1c-47be-80ec-20960d053827\"}":{".":{},"f:apiVersion":{},"f:blockOwnerDeletion":{},"f:controller":{},"f:kind":{},"f:name":{},"f:uid":{}}}}}}]},"data":{"operatorDefaults.conf":"cluster_formation.peer_discovery_backend             = rabbit_peer_discovery_k8s\ncluster_formation.k8s.host                           = kubernetes.default\ncluster_formation.k8s.address_type                   = hostname\ncluster_partition_handling                           = pause_minority\nqueue_master_locator                                 = min-masters\ndisk_free_limit.absolute                             = 2GB\ncluster_formation.randomized_startup_delay_range.min = 5\ncluster_formation.randomized_startup_delay_range.max = 30\ncluster_name                                         = rabbitmq-cluster\n","userDefinedConfiguration.conf":"total_memory_available_override_value = 1717986919\n"}}
2022/03/18 18:00:38 learn_server.go:291: [SIEVE-AFTER-READ]	Get	true	serviceaccount	default	rabbitmq-cluster-server	github.com/rabbitmq/cluster-operator/controllers.(*RabbitmqClusterReconciler)	NotFound	{"metadata":{"name":"rabbitmq-cluster-server","namespace":"default","creationTimestamp":null}}
2022/03/18 18:00:38 learn_server.go:256: [SIEVE-BEFORE-WRITE]	8
2022/03/18 18:00:38 learn_server.go:289: [SIEVE-AFTER-HEAR]	8
2022/03/18 18:00:38 learn_server.go:263: [SIEVE-AFTER-WRITE]	8	Create	serviceaccount	github.com/rabbitmq/cluster-operator/controllers.(*RabbitmqClusterReconciler)	NoError	{"metadata":{"name":"rabbitmq-cluster-server","namespace":"default","selfLink":"/api/v1/namespaces/default/serviceaccounts/rabbitmq-cluster-server","uid":"731589b5-ac97-4774-bee4-008949b54734","resourceVersion":"717","creationTimestamp":"2022-03-18T18:00:38Z","labels":{"app.kubernetes.io/component":"rabbitmq","app.kubernetes.io/name":"rabbitmq-cluster","app.kubernetes.io/part-of":"rabbitmq"},"ownerReferences":[{"apiVersion":"rabbitmq.com/v1beta1","kind":"RabbitmqCluster","name":"rabbitmq-cluster","uid":"18d9928b-0d1c-47be-80ec-20960d053827","controller":true,"blockOwnerDeletion":true}],"managedFields":[{"manager":"manager","operation":"Update","apiVersion":"v1","time":"2022-03-18T18:00:38Z","fieldsType":"FieldsV1","fieldsV1":{"f:metadata":{"f:labels":{".":{},"f:app.kubernetes.io/component":{},"f:app.kubernetes.io/name":{},"f:app.kubernetes.io/part-of":{}},"f:ownerReferences":{".":{},"k:{\"uid\":\"18d9928b-0d1c-47be-80ec-20960d053827\"}":{".":{},"f:apiVersion":{},"f:blockOwnerDeletion":{},"f:controller":{},"f:kind":{},"f:name":{},"f:uid":{}}}}}}]}}
2022/03/18 18:00:38 learn_server.go:291: [SIEVE-AFTER-READ]	Get	true	role	default	rabbitmq-cluster-peer-discovery	github.com/rabbitmq/cluster-operator/controllers.(*RabbitmqClusterReconciler)	NotFound	{"metadata":{"name":"rabbitmq-cluster-peer-discovery","namespace":"default","creationTimestamp":null},"rules":null}
2022/03/18 18:00:38 learn_server.go:279: [SIEVE-BEFORE-HEAR]	9	Added	serviceaccount	{"metadata":{"name":"rabbitmq-cluster-server","namespace":"default","selfLink":"/api/v1/namespaces/default/serviceaccounts/rabbitmq-cluster-server","uid":"731589b5-ac97-4774-bee4-008949b54734","resourceVersion":"717","creationTimestamp":"2022-03-18T18:00:38Z","labels":{"app.kubernetes.io/component":"rabbitmq","app.kubernetes.io/name":"rabbitmq-cluster","app.kubernetes.io/part-of":"rabbitmq"},"ownerReferences":[{"apiVersion":"rabbitmq.com/v1beta1","kind":"RabbitmqCluster","name":"rabbitmq-cluster","uid":"18d9928b-0d1c-47be-80ec-20960d053827","controller":true,"blockOwnerDeletion":true}],"managedFields":[{"manager":"manager","operation":"Update","apiVersion":"v1","time":"2022-03-18T18:00:38Z","fieldsType":"FieldsV1","fieldsV1":{"f:metadata":{"f:labels":{".":{},"f:app.kubernetes.io/component":{},"f:app.kubernetes.io/name":{},"f:app.kubernetes.io/part-of":{}},"f:ownerReferences":{".":{},"k:{\"uid\":\"18d9928b-0d1c-47be-80ec-20960d053827\"}":{".":{},"f:apiVersion":{},"f:blockOwnerDeletion":{},"f:controller":{},"f:kind":{},"f:name":{},"f:uid":{}}}}}}]}}
2022/03/18 18:00:38 learn_server.go:256: [SIEVE-BEFORE-WRITE]	9
2022/03/18 18:00:38 learn_server.go:289: [SIEVE-AFTER-HEAR]	9
2022/03/18 18:00:38 learn_server.go:279: [SIEVE-BEFORE-HEAR]	10	Updated	serviceaccount	{"metadata":{"name":"rabbitmq-cluster-server","namespace":"default","selfLink":"/api/v1/namespaces/default/serviceaccounts/rabbitmq-cluster-server","uid":"731589b5-ac97-4774-bee4-008949b54734","resourceVersion":"722","creationTimestamp":"2022-03-18T18:00:38Z","labels":{"app.kubernetes.io/component":"rabbitmq","app.kubernetes.io/name":"rabbitmq-cluster","app.kubernetes.io/part-of":"rabbitmq"},"ownerReferences":[{"apiVersion":"rabbitmq.com/v1beta1","kind":"RabbitmqCluster","name":"rabbitmq-cluster","uid":"18d9928b-0d1c-47be-80ec-20960d053827","controller":true,"blockOwnerDeletion":true}],"managedFields":[{"manager":"kube-controller-manager","operation":"Update","apiVersion":"v1","time":"2022-03-18T18:00:38Z","fieldsType":"FieldsV1","fieldsV1":{"f:secrets":{".":{},"k:{\"name\":\"rabbitmq-cluster-server-token-rhzq9\"}":{".":{},"f:name":{}}}}},{"manager":"manager","operation":"Update","apiVersion":"v1","time":"2022-03-18T18:00:38Z","fieldsType":"FieldsV1","fieldsV1":{"f:metadata":{"f:labels":{".":{},"f:app.kubernetes.io/component":{},"f:app.kubernetes.io/name":{},"f:app.kubernetes.io/part-of":{}},"f:ownerReferences":{".":{},"k:{\"uid\":\"18d9928b-0d1c-47be-80ec-20960d053827\"}":{".":{},"f:apiVersion":{},"f:blockOwnerDeletion":{},"f:controller":{},"f:kind":{},"f:name":{},"f:uid":{}}}}}}]},"secrets":[{"name":"rabbitmq-cluster-server-token-rhzq9"}]}
2022/03/18 18:00:38 learn_server.go:289: [SIEVE-AFTER-HEAR]	10
2022/03/18 18:00:38 learn_server.go:279: [SIEVE-BEFORE-HEAR]	11	Added	role	{"metadata":{"name":"rabbitmq-cluster-peer-discovery","namespace":"default","selfLink":"/apis/rbac.authorization.k8s.io/v1/namespaces/default/roles/rabbitmq-cluster-peer-discovery","uid":"52c80b50-4fdd-4089-bbfd-9756465953f2","resourceVersion":"723","creationTimestamp":"2022-03-18T18:00:38Z","labels":{"app.kubernetes.io/component":"rabbitmq","app.kubernetes.io/name":"rabbitmq-cluster","app.kubernetes.io/part-of":"rabbitmq"},"ownerReferences":[{"apiVersion":"rabbitmq.com/v1beta1","kind":"RabbitmqCluster","name":"rabbitmq-cluster","uid":"18d9928b-0d1c-47be-80ec-20960d053827","controller":true,"blockOwnerDeletion":true}],"managedFields":[{"manager":"manager","operation":"Update","apiVersion":"rbac.authorization.k8s.io/v1","time":"2022-03-18T18:00:38Z","fieldsType":"FieldsV1","fieldsV1":{"f:metadata":{"f:labels":{".":{},"f:app.kubernetes.io/component":{},"f:app.kubernetes.io/name":{},"f:app.kubernetes.io/part-of":{}},"f:ownerReferences":{".":{},"k:{\"uid\":\"18d9928b-0d1c-47be-80ec-20960d053827\"}":{".":{},"f:apiVersion":{},"f:blockOwnerDeletion":{},"f:controller":{},"f:kind":{},"f:name":{},"f:uid":{}}}},"f:rules":{}}}]},"rules":[{"verbs":["get"],"apiGroups":[""],"resources":["endpoints"]},{"verbs":["create"],"apiGroups":[""],"resources":["events"]}]}
2022/03/18 18:00:38 learn_server.go:263: [SIEVE-AFTER-WRITE]	9	Create	role	github.com/rabbitmq/cluster-operator/controllers.(*RabbitmqClusterReconciler)	NoError	{"metadata":{"name":"rabbitmq-cluster-peer-discovery","namespace":"default","selfLink":"/apis/rbac.authorization.k8s.io/v1/namespaces/default/roles/rabbitmq-cluster-peer-discovery","uid":"52c80b50-4fdd-4089-bbfd-9756465953f2","resourceVersion":"723","creationTimestamp":"2022-03-18T18:00:38Z","labels":{"app.kubernetes.io/component":"rabbitmq","app.kubernetes.io/name":"rabbitmq-cluster","app.kubernetes.io/part-of":"rabbitmq"},"ownerReferences":[{"apiVersion":"rabbitmq.com/v1beta1","kind":"RabbitmqCluster","name":"rabbitmq-cluster","uid":"18d9928b-0d1c-47be-80ec-20960d053827","controller":true,"blockOwnerDeletion":true}],"managedFields":[{"manager":"manager","operation":"Update","apiVersion":"rbac.authorization.k8s.io/v1","time":"2022-03-18T18:00:38Z","fieldsType":"FieldsV1","fieldsV1":{"f:metadata":{"f:labels":{".":{},"f:app.kubernetes.io/component":{},"f:app.kubernetes.io/name":{},"f:app.kubernetes.io/part-of":{}},"f:ownerReferences":{".":{},"k:{\"uid\":\"18d9928b-0d1c-47be-80ec-20960d053827\"}":{".":{},"f:apiVersion":{},"f:blockOwnerDeletion":{},"f:controller":{},"f:kind":{},"f:name":{},"f:uid":{}}}},"f:rules":{}}}]},"rules":[{"verbs":["get"],"apiGroups":[""],"resources":["endpoints"]},{"verbs":["create"],"apiGroups":[""],"resources":["events"]}]}
2022/03/18 18:00:38 learn_server.go:291: [SIEVE-AFTER-READ]	Get	true	rolebinding	default	rabbitmq-cluster-server	github.com/rabbitmq/cluster-operator/controllers.(*RabbitmqClusterReconciler)	NotFound	{"metadata":{"name":"rabbitmq-cluster-server","namespace":"default","creationTimestamp":null},"roleRef":{"apiGroup":"","kind":"","name":""}}
2022/03/18 18:00:38 learn_server.go:256: [SIEVE-BEFORE-WRITE]	10
2022/03/18 18:00:38 learn_server.go:289: [SIEVE-AFTER-HEAR]	11
2022/03/18 18:00:38 learn_server.go:279: [SIEVE-BEFORE-HEAR]	12	Added	rolebinding	{"metadata":{"name":"rabbitmq-cluster-server","namespace":"default","selfLink":"/apis/rbac.authorization.k8s.io/v1/namespaces/default/rolebindings/rabbitmq-cluster-server","uid":"495e9f7c-a20d-4515-86b0-34149a855034","resourceVersion":"725","creationTimestamp":"2022-03-18T18:00:38Z","labels":{"app.kubernetes.io/component":"rabbitmq","app.kubernetes.io/name":"rabbitmq-cluster","app.kubernetes.io/part-of":"rabbitmq"},"ownerReferences":[{"apiVersion":"rabbitmq.com/v1beta1","kind":"RabbitmqCluster","name":"rabbitmq-cluster","uid":"18d9928b-0d1c-47be-80ec-20960d053827","controller":true,"blockOwnerDeletion":true}],"managedFields":[{"manager":"manager","operation":"Update","apiVersion":"rbac.authorization.k8s.io/v1","time":"2022-03-18T18:00:38Z","fieldsType":"FieldsV1","fieldsV1":{"f:metadata":{"f:labels":{".":{},"f:app.kubernetes.io/component":{},"f:app.kubernetes.io/name":{},"f:app.kubernetes.io/part-of":{}},"f:ownerReferences":{".":{},"k:{\"uid\":\"18d9928b-0d1c-47be-80ec-20960d053827\"}":{".":{},"f:apiVersion":{},"f:blockOwnerDeletion":{},"f:controller":{},"f:kind":{},"f:name":{},"f:uid":{}}}},"f:roleRef":{"f:apiGroup":{},"f:kind":{},"f:name":{}},"f:subjects":{}}}]},"subjects":[{"kind":"ServiceAccount","name":"rabbitmq-cluster-server"}],"roleRef":{"apiGroup":"rbac.authorization.k8s.io","kind":"Role","name":"rabbitmq-cluster-peer-discovery"}}
2022/03/18 18:00:38 learn_server.go:263: [SIEVE-AFTER-WRITE]	10	Create	rolebinding	github.com/rabbitmq/cluster-operator/controllers.(*RabbitmqClusterReconciler)	NoError	{"metadata":{"name":"rabbitmq-cluster-server","namespace":"default","selfLink":"/apis/rbac.authorization.k8s.io/v1/namespaces/default/rolebindings/rabbitmq-cluster-server","uid":"495e9f7c-a20d-4515-86b0-34149a855034","resourceVersion":"725","creationTimestamp":"2022-03-18T18:00:38Z","labels":{"app.kubernetes.io/component":"rabbitmq","app.kubernetes.io/name":"rabbitmq-cluster","app.kubernetes.io/part-of":"rabbitmq"},"ownerReferences":[{"apiVersion":"rabbitmq.com/v1beta1","kind":"RabbitmqCluster","name":"rabbitmq-cluster","uid":"18d9928b-0d1c-47be-80ec-20960d053827","controller":true,"blockOwnerDeletion":true}],"managedFields":[{"manager":"manager","operation":"Update","apiVersion":"rbac.authorization.k8s.io/v1","time":"2022-03-18T18:00:38Z","fieldsType":"FieldsV1","fieldsV1":{"f:metadata":{"f:labels":{".":{},"f:app.kubernetes.io/component":{},"f:app.kubernetes.io/name":{},"f:app.kubernetes.io/part-of":{}},"f:ownerReferences":{".":{},"k:{\"uid\":\"18d9928b-0d1c-47be-80ec-20960d053827\"}":{".":{},"f:apiVersion":{},"f:blockOwnerDeletion":{},"f:controller":{},"f:kind":{},"f:name":{},"f:uid":{}}}},"f:roleRef":{"f:apiGroup":{},"f:kind":{},"f:name":{}},"f:subjects":{}}}]},"subjects":[{"kind":"ServiceAccount","name":"rabbitmq-cluster-server"}],"roleRef":{"apiGroup":"rbac.authorization.k8s.io","kind":"Role","name":"rabbitmq-cluster-peer-discovery"}}
2022/03/18 18:00:38 learn_server.go:289: [SIEVE-AFTER-HEAR]	12
2022/03/18 18:00:38 learn_server.go:291: [SIEVE-AFTER-READ]	Get	true	statefulset	default	rabbitmq-cluster-server	github.com/rabbitmq/cluster-operator/controllers.(*RabbitmqClusterReconciler)	NotFound	{"metadata":{"creationTimestamp":null},"spec":{"selector":null,"template":{"metadata":{"creationTimestamp":null},"spec":{"containers":null}},"serviceName":"","updateStrategy":{}},"status":{"replicas":0}}
2022/03/18 18:00:38 learn_server.go:291: [SIEVE-AFTER-READ]	Get	true	statefulset	default	rabbitmq-cluster-server	github.com/rabbitmq/cluster-operator/controllers.(*RabbitmqClusterReconciler)	NotFound	{"metadata":{"name":"rabbitmq-cluster-server","namespace":"default","creationTimestamp":null},"spec":{"selector":{"matchLabels":{"app.kubernetes.io/name":"rabbitmq-cluster"}},"template":{"metadata":{"creationTimestamp":null},"spec":{"containers":null}},"volumeClaimTemplates":[{"metadata":{"name":"persistence","namespace":"default","creationTimestamp":null,"labels":{"app.kubernetes.io/component":"rabbitmq","app.kubernetes.io/name":"rabbitmq-cluster","app.kubernetes.io/part-of":"rabbitmq"},"ownerReferences":[{"apiVersion":"rabbitmq.com/v1beta1","kind":"RabbitmqCluster","name":"rabbitmq-cluster","uid":"18d9928b-0d1c-47be-80ec-20960d053827","controller":true,"blockOwnerDeletion":false}]},"spec":{"accessModes":["ReadWriteOnce"],"resources":{"requests":{"storage":"10Gi"}}},"status":{}}],"serviceName":"rabbitmq-cluster-nodes","podManagementPolicy":"Parallel","updateStrategy":{}},"status":{"replicas":0}}
2022/03/18 18:00:38 learn_server.go:256: [SIEVE-BEFORE-WRITE]	11
2022/03/18 18:00:38 learn_server.go:263: [SIEVE-AFTER-WRITE]	11	Create	statefulset	github.com/rabbitmq/cluster-operator/controllers.(*RabbitmqClusterReconciler)	NoError	{"metadata":{"name":"rabbitmq-cluster-server","namespace":"default","selfLink":"/apis/apps/v1/namespaces/default/statefulsets/rabbitmq-cluster-server","uid":"cb5c43bc-6ee7-481c-ab01-6f3acffdd3c8","resourceVersion":"727","generation":1,"creationTimestamp":"2022-03-18T18:00:38Z","labels":{"app.kubernetes.io/component":"rabbitmq","app.kubernetes.io/name":"rabbitmq-cluster","app.kubernetes.io/part-of":"rabbitmq"},"ownerReferences":[{"apiVersion":"rabbitmq.com/v1beta1","kind":"RabbitmqCluster","name":"rabbitmq-cluster","uid":"18d9928b-0d1c-47be-80ec-20960d053827","controller":true,"blockOwnerDeletion":true}],"managedFields":[{"manager":"manager","operation":"Update","apiVersion":"apps/v1","time":"2022-03-18T18:00:38Z","fieldsType":"FieldsV1","fieldsV1":{"f:metadata":{"f:labels":{".":{},"f:app.kubernetes.io/component":{},"f:app.kubernetes.io/name":{},"f:app.kubernetes.io/part-of":{}},"f:ownerReferences":{".":{},"k:{\"uid\":\"18d9928b-0d1c-47be-80ec-20960d053827\"}":{".":{},"f:apiVersion":{},"f:blockOwnerDeletion":{},"f:controller":{},"f:kind":{},"f:name":{},"f:uid":{}}}},"f:spec":{"f:podManagementPolicy":{},"f:replicas":{},"f:revisionHistoryLimit":{},"f:selector":{"f:matchLabels":{".":{},"f:app.kubernetes.io/name":{}}},"f:serviceName":{},"f:template":{"f:metadata":{"f:annotations":{".":{},"f:prometheus.io/port":{},"f:prometheus.io/scrape":{}},"f:labels":{".":{},"f:app.kubernetes.io/component":{},"f:app.kubernetes.io/name":{},"f:app.kubernetes.io/part-of":{}}},"f:spec":{"f:automountServiceAccountToken":{},"f:containers":{"k:{\"name\":\"rabbitmq\"}":{".":{},"f:env":{".":{},"k:{\"name\":\"K8S_HOSTNAME_SUFFIX\"}":{".":{},"f:name":{},"f:value":{}},"k:{\"name\":\"K8S_SERVICE_NAME\"}":{".":{},"f:name":{},"f:value":{}},"k:{\"name\":\"MY_POD_NAME\"}":{".":{},"f:name":{},"f:valueFrom":{".":{},"f:fieldRef":{".":{},"f:apiVersion":{},"f:fieldPath":{}}}},"k:{\"name\":\"MY_POD_NAMESPACE\"}":{".":{},"f:name":{},"f:valueFrom":{".":{},"f:fieldRef":{".":{},"f:apiVersion":{},"f:fieldPath":{}}}},"k:{\"name\":\"RABBITMQ_ENABLED_PLUGINS_FILE\"}":{".":{},"f:name":{},"f:value":{}},"k:{\"name\":\"RABBITMQ_NODENAME\"}":{".":{},"f:name":{},"f:value":{}},"k:{\"name\":\"RABBITMQ_USE_LONGNAME\"}":{".":{},"f:name":{},"f:value":{}}},"f:image":{},"f:imagePullPolicy":{},"f:lifecycle":{".":{},"f:preStop":{".":{},"f:exec":{".":{},"f:command":{}}}},"f:name":{},"f:ports":{".":{},"k:{\"containerPort\":4369,\"protocol\":\"TCP\"}":{".":{},"f:containerPort":{},"f:name":{},"f:protocol":{}},"k:{\"containerPort\":5672,\"protocol\":\"TCP\"}":{".":{},"f:containerPort":{},"f:name":{},"f:protocol":{}},"k:{\"containerPort\":15672,\"protocol\":\"TCP\"}":{".":{},"f:containerPort":{},"f:name":{},"f:protocol":{}},"k:{\"containerPort\":15692,\"protocol\":\"TCP\"}":{".":{},"f:containerPort":{},"f:name":{},"f:protocol":{}}},"f:readinessProbe":{".":{},"f:failureThreshold":{},"f:initialDelaySeconds":{},"f:periodSeconds":{},"f:successThreshold":{},"f:tcpSocket":{".":{},"f:port":{}},"f:timeoutSeconds":{}},"f:resources":{".":{},"f:limits":{".":{},"f:cpu":{},"f:memory":{}},"f:requests":{".":{},"f:cpu":{},"f:memory":{}}},"f:terminationMessagePath":{},"f:terminationMessagePolicy":{},"f:volumeMounts":{".":{},"k:{\"mountPath\":\"/etc/pod-info/\"}":{".":{},"f:mountPath":{},"f:name":{}},"k:{\"mountPath\":\"/etc/rabbitmq/conf.d/10-operatorDefaults.conf\"}":{".":{},"f:mountPath":{},"f:name":{},"f:subPath":{}},"k:{\"mountPath\":\"/etc/rabbitmq/conf.d/11-default_user.conf\"}":{".":{},"f:mountPath":{},"f:name":{},"f:subPath":{}},"k:{\"mountPath\":\"/etc/rabbitmq/conf.d/90-userDefinedConfiguration.conf\"}":{".":{},"f:mountPath":{},"f:name":{},"f:subPath":{}},"k:{\"mountPath\":\"/operator\"}":{".":{},"f:mountPath":{},"f:name":{}},"k:{\"mountPath\":\"/var/lib/rabbitmq/\"}":{".":{},"f:mountPath":{},"f:name":{}},"k:{\"mountPath\":\"/var/lib/rabbitmq/mnesia/\"}":{".":{},"f:mountPath":{},"f:name":{}}}}},"f:dnsPolicy":{},"f:initContainers":{".":{},"k:{\"name\":\"setup-container\"}":{".":{},"f:command":{},"f:image":{},"f:imagePullPolicy":{},"f:name":{},"f:resources":{".":{},"f:limits":{".":{},"f:cpu":{},"f:memory":{}},"f:requests":{".":{},"f:cpu":{},"f:memory":{}}},"f:securityContext":{".":{},"f:capabilities":{".":{},"f:drop":{}},"f:runAsUser":{}},"f:terminationMessagePath":{},"f:terminationMessagePolicy":{},"f:volumeMounts":{".":{},"k:{\"mountPath\":\"/operator\"}":{".":{},"f:mountPath":{},"f:name":{}},"k:{\"mountPath\":\"/tmp/default_user.conf\"}":{".":{},"f:mountPath":{},"f:name":{},"f:subPath":{}},"k:{\"mountPath\":\"/tmp/erlang-cookie-secret/\"}":{".":{},"f:mountPath":{},"f:name":{}},"k:{\"mountPath\":\"/tmp/rabbitmq-plugins/\"}":{".":{},"f:mountPath":{},"f:name":{}},"k:{\"mountPath\":\"/var/lib/rabbitmq/\"}":{".":{},"f:mountPath":{},"f:name":{}},"k:{\"mountPath\":\"/var/lib/rabbitmq/mnesia/\"}":{".":{},"f:mountPath":{},"f:name":{}}}}},"f:restartPolicy":{},"f:schedulerName":{},"f:securityContext":{".":{},"f:fsGroup":{},"f:runAsGroup":{},"f:runAsUser":{}},"f:serviceAccount":{},"f:serviceAccountName":{},"f:terminationGracePeriodSeconds":{},"f:topologySpreadConstraints":{".":{},"k:{\"topologyKey\":\"topology.kubernetes.io/zone\",\"whenUnsatisfiable\":\"ScheduleAnyway\"}":{".":{},"f:labelSelector":{".":{},"f:matchLabels":{".":{},"f:app.kubernetes.io/name":{}}},"f:maxSkew":{},"f:topologyKey":{},"f:whenUnsatisfiable":{}}},"f:volumes":{".":{},"k:{\"name\":\"erlang-cookie-secret\"}":{".":{},"f:name":{},"f:secret":{".":{},"f:defaultMode":{},"f:secretName":{}}},"k:{\"name\":\"plugins-conf\"}":{".":{},"f:configMap":{".":{},"f:defaultMode":{},"f:name":{}},"f:name":{}},"k:{\"name\":\"pod-info\"}":{".":{},"f:downwardAPI":{".":{},"f:defaultMode":{},"f:items":{}},"f:name":{}},"k:{\"name\":\"rabbitmq-confd\"}":{".":{},"f:name":{},"f:projected":{".":{},"f:defaultMode":{},"f:sources":{}}},"k:{\"name\":\"rabbitmq-erlang-cookie\"}":{".":{},"f:emptyDir":{},"f:name":{}},"k:{\"name\":\"rabbitmq-plugins\"}":{".":{},"f:emptyDir":{},"f:name":{}}}}},"f:updateStrategy":{"f:rollingUpdate":{".":{},"f:partition":{}},"f:type":{}},"f:volumeClaimTemplates":{}}}}]},"spec":{"replicas":1,"selector":{"matchLabels":{"app.kubernetes.io/name":"rabbitmq-cluster"}},"template":{"metadata":{"creationTimestamp":null,"labels":{"app.kubernetes.io/component":"rabbitmq","app.kubernetes.io/name":"rabbitmq-cluster","app.kubernetes.io/part-of":"rabbitmq"},"annotations":{"prometheus.io/port":"15692","prometheus.io/scrape":"true"}},"spec":{"volumes":[{"name":"plugins-conf","configMap":{"name":"rabbitmq-cluster-plugins-conf","defaultMode":420}},{"name":"rabbitmq-confd","projected":{"sources":[{"secret":{"name":"rabbitmq-cluster-default-user","items":[{"key":"default_user.conf","path":"default_user.conf"}]}},{"configMap":{"name":"rabbitmq-cluster-server-conf","items":[{"key":"operatorDefaults.conf","path":"operatorDefaults.conf"},{"key":"userDefinedConfiguration.conf","path":"userDefinedConfiguration.conf"}]}}],"defaultMode":420}},{"name":"rabbitmq-erlang-cookie","emptyDir":{}},{"name":"erlang-cookie-secret","secret":{"secretName":"rabbitmq-cluster-erlang-cookie","defaultMode":420}},{"name":"rabbitmq-plugins","emptyDir":{}},{"name":"pod-info","downwardAPI":{"items":[{"path":"skipPreStopChecks","fieldRef":{"apiVersion":"v1","fieldPath":"metadata.labels['skipPreStopChecks']"}}],"defaultMode":420}}],"initContainers":[{"name":"setup-container","image":"rabbitmq:3.8.12-management","command":["sh","-c","cp /tmp/erlang-cookie-secret/.erlang.cookie /var/lib/rabbitmq/.erlang.cookie \u0026\u0026 chown 999:999 /var/lib/rabbitmq/.erlang.cookie \u0026\u0026 chmod 600 /var/lib/rabbitmq/.erlang.cookie ; cp /tmp/rabbitmq-plugins/enabled_plugins /operator/enabled_plugins \u0026\u0026 chown 999:999 /operator/enabled_plugins ; chown 999:999 /var/lib/rabbitmq/mnesia/ ; echo '[default]' \u003e /var/lib/rabbitmq/.rabbitmqadmin.conf \u0026\u0026 sed -e 's/default_user/username/' -e 's/default_pass/password/' /tmp/default_user.conf \u003e\u003e /var/lib/rabbitmq/.rabbitmqadmin.conf \u0026\u0026 chown 999:999 /var/lib/rabbitmq/.rabbitmqadmin.conf \u0026\u0026 chmod 600 /var/lib/rabbitmq/.rabbitmqadmin.conf"],"resources":{"limits":{"cpu":"100m","memory":"500Mi"},"requests":{"cpu":"100m","memory":"500Mi"}},"volumeMounts":[{"name":"plugins-conf","mountPath":"/tmp/rabbitmq-plugins/"},{"name":"rabbitmq-erlang-cookie","mountPath":"/var/lib/rabbitmq/"},{"name":"erlang-cookie-secret","mountPath":"/tmp/erlang-cookie-secret/"},{"name":"rabbitmq-plugins","mountPath":"/operator"},{"name":"persistence","mountPath":"/var/lib/rabbitmq/mnesia/"},{"name":"rabbitmq-confd","mountPath":"/tmp/default_user.conf","subPath":"default_user.conf"}],"terminationMessagePath":"/dev/termination-log","terminationMessagePolicy":"File","imagePullPolicy":"IfNotPresent","securityContext":{"capabilities":{"drop":["FSETID","KILL","SETGID","SETUID","SETPCAP","NET_BIND_SERVICE","NET_RAW","SYS_CHROOT","MKNOD","AUDIT_WRITE","SETFCAP"]},"runAsUser":0}}],"containers":[{"name":"rabbitmq","image":"rabbitmq:3.8.12-management","ports":[{"name":"epmd","containerPort":4369,"protocol":"TCP"},{"name":"amqp","containerPort":5672,"protocol":"TCP"},{"name":"management","containerPort":15672,"protocol":"TCP"},{"name":"prometheus","containerPort":15692,"protocol":"TCP"}],"env":[{"name":"MY_POD_NAME","valueFrom":{"fieldRef":{"apiVersion":"v1","fieldPath":"metadata.name"}}},{"name":"MY_POD_NAMESPACE","valueFrom":{"fieldRef":{"apiVersion":"v1","fieldPath":"metadata.namespace"}}},{"name":"RABBITMQ_ENABLED_PLUGINS_FILE","value":"/operator/enabled_plugins"},{"name":"K8S_SERVICE_NAME","value":"rabbitmq-cluster-nodes"},{"name":"RABBITMQ_USE_LONGNAME","value":"true"},{"name":"RABBITMQ_NODENAME","value":"rabbit@$(MY_POD_NAME).$(K8S_SERVICE_NAME).$(MY_POD_NAMESPACE)"},{"name":"K8S_HOSTNAME_SUFFIX","value":".$(K8S_SERVICE_NAME).$(MY_POD_NAMESPACE)"}],"resources":{"limits":{"cpu":"2","memory":"2Gi"},"requests":{"cpu":"1","memory":"2Gi"}},"volumeMounts":[{"name":"rabbitmq-erlang-cookie","mountPath":"/var/lib/rabbitmq/"},{"name":"persistence","mountPath":"/var/lib/rabbitmq/mnesia/"},{"name":"rabbitmq-plugins","mountPath":"/operator"},{"name":"rabbitmq-confd","mountPath":"/etc/rabbitmq/conf.d/10-operatorDefaults.conf","subPath":"operatorDefaults.conf"},{"name":"rabbitmq-confd","mountPath":"/etc/rabbitmq/conf.d/11-default_user.conf","subPath":"default_user.conf"},{"name":"rabbitmq-confd","mountPath":"/etc/rabbitmq/conf.d/90-userDefinedConfiguration.conf","subPath":"userDefinedConfiguration.conf"},{"name":"pod-info","mountPath":"/etc/pod-info/"}],"readinessProbe":{"tcpSocket":{"port":"amqp"},"initialDelaySeconds":10,"timeoutSeconds":5,"periodSeconds":10,"successThreshold":1,"failureThreshold":3},"lifecycle":{"preStop":{"exec":{"command":["/bin/bash","-c","if [ ! -z \"$(cat /etc/pod-info/skipPreStopChecks)\" ]; then exit 0; fi; rabbitmq-upgrade await_online_quorum_plus_one -t 604800; rabbitmq-upgrade await_online_synchronized_mirror -t 604800; rabbitmq-upgrade drain -t 604800"]}}},"terminationMessagePath":"/dev/termination-log","terminationMessagePolicy":"File","imagePullPolicy":"IfNotPresent"}],"restartPolicy":"Always","terminationGracePeriodSeconds":604800,"dnsPolicy":"ClusterFirst","serviceAccountName":"rabbitmq-cluster-server","serviceAccount":"rabbitmq-cluster-server","automountServiceAccountToken":true,"securityContext":{"runAsUser":999,"runAsGroup":999,"fsGroup":999},"schedulerName":"default-scheduler","topologySpreadConstraints":[{"maxSkew":1,"topologyKey":"topology.kubernetes.io/zone","whenUnsatisfiable":"ScheduleAnyway","labelSelector":{"matchLabels":{"app.kubernetes.io/name":"rabbitmq-cluster"}}}]}},"volumeClaimTemplates":[{"metadata":{"name":"persistence","namespace":"default","creationTimestamp":null,"labels":{"app.kubernetes.io/component":"rabbitmq","app.kubernetes.io/name":"rabbitmq-cluster","app.kubernetes.io/part-of":"rabbitmq"},"ownerReferences":[{"apiVersion":"rabbitmq.com/v1beta1","kind":"RabbitmqCluster","name":"rabbitmq-cluster","uid":"18d9928b-0d1c-47be-80ec-20960d053827","controller":true,"blockOwnerDeletion":false}]},"spec":{"accessModes":["ReadWriteOnce"],"resources":{"requests":{"storage":"10Gi"}},"volumeMode":"Filesystem"},"status":{"phase":"Pending"}}],"serviceName":"rabbitmq-cluster-nodes","podManagementPolicy":"Parallel","updateStrategy":{"type":"RollingUpdate","rollingUpdate":{"partition":0}},"revisionHistoryLimit":10},"status":{"replicas":0}}
2022/03/18 18:00:38 learn_server.go:291: [SIEVE-AFTER-READ]	Get	true	statefulset	default	rabbitmq-cluster-server	github.com/rabbitmq/cluster-operator/controllers.(*RabbitmqClusterReconciler)	NotFound	{"metadata":{"creationTimestamp":null},"spec":{"selector":null,"template":{"metadata":{"creationTimestamp":null},"spec":{"containers":null}},"serviceName":"","updateStrategy":{}},"status":{"replicas":0}}
2022/03/18 18:00:38 learn_server.go:279: [SIEVE-BEFORE-HEAR]	13	Added	statefulset	{"metadata":{"name":"rabbitmq-cluster-server","namespace":"default","selfLink":"/apis/apps/v1/namespaces/default/statefulsets/rabbitmq-cluster-server","uid":"cb5c43bc-6ee7-481c-ab01-6f3acffdd3c8","resourceVersion":"727","generation":1,"creationTimestamp":"2022-03-18T18:00:38Z","labels":{"app.kubernetes.io/component":"rabbitmq","app.kubernetes.io/name":"rabbitmq-cluster","app.kubernetes.io/part-of":"rabbitmq"},"ownerReferences":[{"apiVersion":"rabbitmq.com/v1beta1","kind":"RabbitmqCluster","name":"rabbitmq-cluster","uid":"18d9928b-0d1c-47be-80ec-20960d053827","controller":true,"blockOwnerDeletion":true}],"managedFields":[{"manager":"manager","operation":"Update","apiVersion":"apps/v1","time":"2022-03-18T18:00:38Z","fieldsType":"FieldsV1","fieldsV1":{"f:metadata":{"f:labels":{".":{},"f:app.kubernetes.io/component":{},"f:app.kubernetes.io/name":{},"f:app.kubernetes.io/part-of":{}},"f:ownerReferences":{".":{},"k:{\"uid\":\"18d9928b-0d1c-47be-80ec-20960d053827\"}":{".":{},"f:apiVersion":{},"f:blockOwnerDeletion":{},"f:controller":{},"f:kind":{},"f:name":{},"f:uid":{}}}},"f:spec":{"f:podManagementPolicy":{},"f:replicas":{},"f:revisionHistoryLimit":{},"f:selector":{"f:matchLabels":{".":{},"f:app.kubernetes.io/name":{}}},"f:serviceName":{},"f:template":{"f:metadata":{"f:annotations":{".":{},"f:prometheus.io/port":{},"f:prometheus.io/scrape":{}},"f:labels":{".":{},"f:app.kubernetes.io/component":{},"f:app.kubernetes.io/name":{},"f:app.kubernetes.io/part-of":{}}},"f:spec":{"f:automountServiceAccountToken":{},"f:containers":{"k:{\"name\":\"rabbitmq\"}":{".":{},"f:env":{".":{},"k:{\"name\":\"K8S_HOSTNAME_SUFFIX\"}":{".":{},"f:name":{},"f:value":{}},"k:{\"name\":\"K8S_SERVICE_NAME\"}":{".":{},"f:name":{},"f:value":{}},"k:{\"name\":\"MY_POD_NAME\"}":{".":{},"f:name":{},"f:valueFrom":{".":{},"f:fieldRef":{".":{},"f:apiVersion":{},"f:fieldPath":{}}}},"k:{\"name\":\"MY_POD_NAMESPACE\"}":{".":{},"f:name":{},"f:valueFrom":{".":{},"f:fieldRef":{".":{},"f:apiVersion":{},"f:fieldPath":{}}}},"k:{\"name\":\"RABBITMQ_ENABLED_PLUGINS_FILE\"}":{".":{},"f:name":{},"f:value":{}},"k:{\"name\":\"RABBITMQ_NODENAME\"}":{".":{},"f:name":{},"f:value":{}},"k:{\"name\":\"RABBITMQ_USE_LONGNAME\"}":{".":{},"f:name":{},"f:value":{}}},"f:image":{},"f:imagePullPolicy":{},"f:lifecycle":{".":{},"f:preStop":{".":{},"f:exec":{".":{},"f:command":{}}}},"f:name":{},"f:ports":{".":{},"k:{\"containerPort\":4369,\"protocol\":\"TCP\"}":{".":{},"f:containerPort":{},"f:name":{},"f:protocol":{}},"k:{\"containerPort\":5672,\"protocol\":\"TCP\"}":{".":{},"f:containerPort":{},"f:name":{},"f:protocol":{}},"k:{\"containerPort\":15672,\"protocol\":\"TCP\"}":{".":{},"f:containerPort":{},"f:name":{},"f:protocol":{}},"k:{\"containerPort\":15692,\"protocol\":\"TCP\"}":{".":{},"f:containerPort":{},"f:name":{},"f:protocol":{}}},"f:readinessProbe":{".":{},"f:failureThreshold":{},"f:initialDelaySeconds":{},"f:periodSeconds":{},"f:successThreshold":{},"f:tcpSocket":{".":{},"f:port":{}},"f:timeoutSeconds":{}},"f:resources":{".":{},"f:limits":{".":{},"f:cpu":{},"f:memory":{}},"f:requests":{".":{},"f:cpu":{},"f:memory":{}}},"f:terminationMessagePath":{},"f:terminationMessagePolicy":{},"f:volumeMounts":{".":{},"k:{\"mountPath\":\"/etc/pod-info/\"}":{".":{},"f:mountPath":{},"f:name":{}},"k:{\"mountPath\":\"/etc/rabbitmq/conf.d/10-operatorDefaults.conf\"}":{".":{},"f:mountPath":{},"f:name":{},"f:subPath":{}},"k:{\"mountPath\":\"/etc/rabbitmq/conf.d/11-default_user.conf\"}":{".":{},"f:mountPath":{},"f:name":{},"f:subPath":{}},"k:{\"mountPath\":\"/etc/rabbitmq/conf.d/90-userDefinedConfiguration.conf\"}":{".":{},"f:mountPath":{},"f:name":{},"f:subPath":{}},"k:{\"mountPath\":\"/operator\"}":{".":{},"f:mountPath":{},"f:name":{}},"k:{\"mountPath\":\"/var/lib/rabbitmq/\"}":{".":{},"f:mountPath":{},"f:name":{}},"k:{\"mountPath\":\"/var/lib/rabbitmq/mnesia/\"}":{".":{},"f:mountPath":{},"f:name":{}}}}},"f:dnsPolicy":{},"f:initContainers":{".":{},"k:{\"name\":\"setup-container\"}":{".":{},"f:command":{},"f:image":{},"f:imagePullPolicy":{},"f:name":{},"f:resources":{".":{},"f:limits":{".":{},"f:cpu":{},"f:memory":{}},"f:requests":{".":{},"f:cpu":{},"f:memory":{}}},"f:securityContext":{".":{},"f:capabilities":{".":{},"f:drop":{}},"f:runAsUser":{}},"f:terminationMessagePath":{},"f:terminationMessagePolicy":{},"f:volumeMounts":{".":{},"k:{\"mountPath\":\"/operator\"}":{".":{},"f:mountPath":{},"f:name":{}},"k:{\"mountPath\":\"/tmp/default_user.conf\"}":{".":{},"f:mountPath":{},"f:name":{},"f:subPath":{}},"k:{\"mountPath\":\"/tmp/erlang-cookie-secret/\"}":{".":{},"f:mountPath":{},"f:name":{}},"k:{\"mountPath\":\"/tmp/rabbitmq-plugins/\"}":{".":{},"f:mountPath":{},"f:name":{}},"k:{\"mountPath\":\"/var/lib/rabbitmq/\"}":{".":{},"f:mountPath":{},"f:name":{}},"k:{\"mountPath\":\"/var/lib/rabbitmq/mnesia/\"}":{".":{},"f:mountPath":{},"f:name":{}}}}},"f:restartPolicy":{},"f:schedulerName":{},"f:securityContext":{".":{},"f:fsGroup":{},"f:runAsGroup":{},"f:runAsUser":{}},"f:serviceAccount":{},"f:serviceAccountName":{},"f:terminationGracePeriodSeconds":{},"f:topologySpreadConstraints":{".":{},"k:{\"topologyKey\":\"topology.kubernetes.io/zone\",\"whenUnsatisfiable\":\"ScheduleAnyway\"}":{".":{},"f:labelSelector":{".":{},"f:matchLabels":{".":{},"f:app.kubernetes.io/name":{}}},"f:maxSkew":{},"f:topologyKey":{},"f:whenUnsatisfiable":{}}},"f:volumes":{".":{},"k:{\"name\":\"erlang-cookie-secret\"}":{".":{},"f:name":{},"f:secret":{".":{},"f:defaultMode":{},"f:secretName":{}}},"k:{\"name\":\"plugins-conf\"}":{".":{},"f:configMap":{".":{},"f:defaultMode":{},"f:name":{}},"f:name":{}},"k:{\"name\":\"pod-info\"}":{".":{},"f:downwardAPI":{".":{},"f:defaultMode":{},"f:items":{}},"f:name":{}},"k:{\"name\":\"rabbitmq-confd\"}":{".":{},"f:name":{},"f:projected":{".":{},"f:defaultMode":{},"f:sources":{}}},"k:{\"name\":\"rabbitmq-erlang-cookie\"}":{".":{},"f:emptyDir":{},"f:name":{}},"k:{\"name\":\"rabbitmq-plugins\"}":{".":{},"f:emptyDir":{},"f:name":{}}}}},"f:updateStrategy":{"f:rollingUpdate":{".":{},"f:partition":{}},"f:type":{}},"f:volumeClaimTemplates":{}}}}]},"spec":{"replicas":1,"selector":{"matchLabels":{"app.kubernetes.io/name":"rabbitmq-cluster"}},"template":{"metadata":{"creationTimestamp":null,"labels":{"app.kubernetes.io/component":"rabbitmq","app.kubernetes.io/name":"rabbitmq-cluster","app.kubernetes.io/part-of":"rabbitmq"},"annotations":{"prometheus.io/port":"15692","prometheus.io/scrape":"true"}},"spec":{"volumes":[{"name":"plugins-conf","configMap":{"name":"rabbitmq-cluster-plugins-conf","defaultMode":420}},{"name":"rabbitmq-confd","projected":{"sources":[{"secret":{"name":"rabbitmq-cluster-default-user","items":[{"key":"default_user.conf","path":"default_user.conf"}]}},{"configMap":{"name":"rabbitmq-cluster-server-conf","items":[{"key":"operatorDefaults.conf","path":"operatorDefaults.conf"},{"key":"userDefinedConfiguration.conf","path":"userDefinedConfiguration.conf"}]}}],"defaultMode":420}},{"name":"rabbitmq-erlang-cookie","emptyDir":{}},{"name":"erlang-cookie-secret","secret":{"secretName":"rabbitmq-cluster-erlang-cookie","defaultMode":420}},{"name":"rabbitmq-plugins","emptyDir":{}},{"name":"pod-info","downwardAPI":{"items":[{"path":"skipPreStopChecks","fieldRef":{"apiVersion":"v1","fieldPath":"metadata.labels['skipPreStopChecks']"}}],"defaultMode":420}}],"initContainers":[{"name":"setup-container","image":"rabbitmq:3.8.12-management","command":["sh","-c","cp /tmp/erlang-cookie-secret/.erlang.cookie /var/lib/rabbitmq/.erlang.cookie \u0026\u0026 chown 999:999 /var/lib/rabbitmq/.erlang.cookie \u0026\u0026 chmod 600 /var/lib/rabbitmq/.erlang.cookie ; cp /tmp/rabbitmq-plugins/enabled_plugins /operator/enabled_plugins \u0026\u0026 chown 999:999 /operator/enabled_plugins ; chown 999:999 /var/lib/rabbitmq/mnesia/ ; echo '[default]' \u003e /var/lib/rabbitmq/.rabbitmqadmin.conf \u0026\u0026 sed -e 's/default_user/username/' -e 's/default_pass/password/' /tmp/default_user.conf \u003e\u003e /var/lib/rabbitmq/.rabbitmqadmin.conf \u0026\u0026 chown 999:999 /var/lib/rabbitmq/.rabbitmqadmin.conf \u0026\u0026 chmod 600 /var/lib/rabbitmq/.rabbitmqadmin.conf"],"resources":{"limits":{"cpu":"100m","memory":"500Mi"},"requests":{"cpu":"100m","memory":"500Mi"}},"volumeMounts":[{"name":"plugins-conf","mountPath":"/tmp/rabbitmq-plugins/"},{"name":"rabbitmq-erlang-cookie","mountPath":"/var/lib/rabbitmq/"},{"name":"erlang-cookie-secret","mountPath":"/tmp/erlang-cookie-secret/"},{"name":"rabbitmq-plugins","mountPath":"/operator"},{"name":"persistence","mountPath":"/var/lib/rabbitmq/mnesia/"},{"name":"rabbitmq-confd","mountPath":"/tmp/default_user.conf","subPath":"default_user.conf"}],"terminationMessagePath":"/dev/termination-log","terminationMessagePolicy":"File","imagePullPolicy":"IfNotPresent","securityContext":{"capabilities":{"drop":["FSETID","KILL","SETGID","SETUID","SETPCAP","NET_BIND_SERVICE","NET_RAW","SYS_CHROOT","MKNOD","AUDIT_WRITE","SETFCAP"]},"runAsUser":0}}],"containers":[{"name":"rabbitmq","image":"rabbitmq:3.8.12-management","ports":[{"name":"epmd","containerPort":4369,"protocol":"TCP"},{"name":"amqp","containerPort":5672,"protocol":"TCP"},{"name":"management","containerPort":15672,"protocol":"TCP"},{"name":"prometheus","containerPort":15692,"protocol":"TCP"}],"env":[{"name":"MY_POD_NAME","valueFrom":{"fieldRef":{"apiVersion":"v1","fieldPath":"metadata.name"}}},{"name":"MY_POD_NAMESPACE","valueFrom":{"fieldRef":{"apiVersion":"v1","fieldPath":"metadata.namespace"}}},{"name":"RABBITMQ_ENABLED_PLUGINS_FILE","value":"/operator/enabled_plugins"},{"name":"K8S_SERVICE_NAME","value":"rabbitmq-cluster-nodes"},{"name":"RABBITMQ_USE_LONGNAME","value":"true"},{"name":"RABBITMQ_NODENAME","value":"rabbit@$(MY_POD_NAME).$(K8S_SERVICE_NAME).$(MY_POD_NAMESPACE)"},{"name":"K8S_HOSTNAME_SUFFIX","value":".$(K8S_SERVICE_NAME).$(MY_POD_NAMESPACE)"}],"resources":{"limits":{"cpu":"2","memory":"2Gi"},"requests":{"cpu":"1","memory":"2Gi"}},"volumeMounts":[{"name":"rabbitmq-erlang-cookie","mountPath":"/var/lib/rabbitmq/"},{"name":"persistence","mountPath":"/var/lib/rabbitmq/mnesia/"},{"name":"rabbitmq-plugins","mountPath":"/operator"},{"name":"rabbitmq-confd","mountPath":"/etc/rabbitmq/conf.d/10-operatorDefaults.conf","subPath":"operatorDefaults.conf"},{"name":"rabbitmq-confd","mountPath":"/etc/rabbitmq/conf.d/11-default_user.conf","subPath":"default_user.conf"},{"name":"rabbitmq-confd","mountPath":"/etc/rabbitmq/conf.d/90-userDefinedConfiguration.conf","subPath":"userDefinedConfiguration.conf"},{"name":"pod-info","mountPath":"/etc/pod-info/"}],"readinessProbe":{"tcpSocket":{"port":"amqp"},"initialDelaySeconds":10,"timeoutSeconds":5,"periodSeconds":10,"successThreshold":1,"failureThreshold":3},"lifecycle":{"preStop":{"exec":{"command":["/bin/bash","-c","if [ ! -z \"$(cat /etc/pod-info/skipPreStopChecks)\" ]; then exit 0; fi; rabbitmq-upgrade await_online_quorum_plus_one -t 604800; rabbitmq-upgrade await_online_synchronized_mirror -t 604800; rabbitmq-upgrade drain -t 604800"]}}},"terminationMessagePath":"/dev/termination-log","terminationMessagePolicy":"File","imagePullPolicy":"IfNotPresent"}],"restartPolicy":"Always","terminationGracePeriodSeconds":604800,"dnsPolicy":"ClusterFirst","serviceAccountName":"rabbitmq-cluster-server","serviceAccount":"rabbitmq-cluster-server","automountServiceAccountToken":true,"securityContext":{"runAsUser":999,"runAsGroup":999,"fsGroup":999},"schedulerName":"default-scheduler","topologySpreadConstraints":[{"maxSkew":1,"topologyKey":"topology.kubernetes.io/zone","whenUnsatisfiable":"ScheduleAnyway","labelSelector":{"matchLabels":{"app.kubernetes.io/name":"rabbitmq-cluster"}}}]}},"volumeClaimTemplates":[{"metadata":{"name":"persistence","namespace":"default","creationTimestamp":null,"labels":{"app.kubernetes.io/component":"rabbitmq","app.kubernetes.io/name":"rabbitmq-cluster","app.kubernetes.io/part-of":"rabbitmq"},"ownerReferences":[{"apiVersion":"rabbitmq.com/v1beta1","kind":"RabbitmqCluster","name":"rabbitmq-cluster","uid":"18d9928b-0d1c-47be-80ec-20960d053827","controller":true,"blockOwnerDeletion":false}]},"spec":{"accessModes":["ReadWriteOnce"],"resources":{"requests":{"storage":"10Gi"}},"volumeMode":"Filesystem"},"status":{"phase":"Pending"}}],"serviceName":"rabbitmq-cluster-nodes","podManagementPolicy":"Parallel","updateStrategy":{"type":"RollingUpdate","rollingUpdate":{"partition":0}},"revisionHistoryLimit":10},"status":{"replicas":0}}
2022/03/18 18:00:38 learn_server.go:289: [SIEVE-AFTER-HEAR]	13
2022/03/18 18:00:38 learn_server.go:291: [SIEVE-AFTER-READ]	Get	true	statefulset	default	rabbitmq-cluster-server	github.com/rabbitmq/cluster-operator/controllers.(*RabbitmqClusterReconciler)	NoError	{"kind":"StatefulSet","apiVersion":"apps/v1","metadata":{"name":"rabbitmq-cluster-server","namespace":"default","selfLink":"/apis/apps/v1/namespaces/default/statefulsets/rabbitmq-cluster-server","uid":"cb5c43bc-6ee7-481c-ab01-6f3acffdd3c8","resourceVersion":"727","generation":1,"creationTimestamp":"2022-03-18T18:00:38Z","labels":{"app.kubernetes.io/component":"rabbitmq","app.kubernetes.io/name":"rabbitmq-cluster","app.kubernetes.io/part-of":"rabbitmq"},"ownerReferences":[{"apiVersion":"rabbitmq.com/v1beta1","kind":"RabbitmqCluster","name":"rabbitmq-cluster","uid":"18d9928b-0d1c-47be-80ec-20960d053827","controller":true,"blockOwnerDeletion":true}],"managedFields":[{"manager":"manager","operation":"Update","apiVersion":"apps/v1","time":"2022-03-18T18:00:38Z","fieldsType":"FieldsV1","fieldsV1":{"f:metadata":{"f:labels":{".":{},"f:app.kubernetes.io/component":{},"f:app.kubernetes.io/name":{},"f:app.kubernetes.io/part-of":{}},"f:ownerReferences":{".":{},"k:{\"uid\":\"18d9928b-0d1c-47be-80ec-20960d053827\"}":{".":{},"f:apiVersion":{},"f:blockOwnerDeletion":{},"f:controller":{},"f:kind":{},"f:name":{},"f:uid":{}}}},"f:spec":{"f:podManagementPolicy":{},"f:replicas":{},"f:revisionHistoryLimit":{},"f:selector":{"f:matchLabels":{".":{},"f:app.kubernetes.io/name":{}}},"f:serviceName":{},"f:template":{"f:metadata":{"f:annotations":{".":{},"f:prometheus.io/port":{},"f:prometheus.io/scrape":{}},"f:labels":{".":{},"f:app.kubernetes.io/component":{},"f:app.kubernetes.io/name":{},"f:app.kubernetes.io/part-of":{}}},"f:spec":{"f:automountServiceAccountToken":{},"f:containers":{"k:{\"name\":\"rabbitmq\"}":{".":{},"f:env":{".":{},"k:{\"name\":\"K8S_HOSTNAME_SUFFIX\"}":{".":{},"f:name":{},"f:value":{}},"k:{\"name\":\"K8S_SERVICE_NAME\"}":{".":{},"f:name":{},"f:value":{}},"k:{\"name\":\"MY_POD_NAME\"}":{".":{},"f:name":{},"f:valueFrom":{".":{},"f:fieldRef":{".":{},"f:apiVersion":{},"f:fieldPath":{}}}},"k:{\"name\":\"MY_POD_NAMESPACE\"}":{".":{},"f:name":{},"f:valueFrom":{".":{},"f:fieldRef":{".":{},"f:apiVersion":{},"f:fieldPath":{}}}},"k:{\"name\":\"RABBITMQ_ENABLED_PLUGINS_FILE\"}":{".":{},"f:name":{},"f:value":{}},"k:{\"name\":\"RABBITMQ_NODENAME\"}":{".":{},"f:name":{},"f:value":{}},"k:{\"name\":\"RABBITMQ_USE_LONGNAME\"}":{".":{},"f:name":{},"f:value":{}}},"f:image":{},"f:imagePullPolicy":{},"f:lifecycle":{".":{},"f:preStop":{".":{},"f:exec":{".":{},"f:command":{}}}},"f:name":{},"f:ports":{".":{},"k:{\"containerPort\":4369,\"protocol\":\"TCP\"}":{".":{},"f:containerPort":{},"f:name":{},"f:protocol":{}},"k:{\"containerPort\":5672,\"protocol\":\"TCP\"}":{".":{},"f:containerPort":{},"f:name":{},"f:protocol":{}},"k:{\"containerPort\":15672,\"protocol\":\"TCP\"}":{".":{},"f:containerPort":{},"f:name":{},"f:protocol":{}},"k:{\"containerPort\":15692,\"protocol\":\"TCP\"}":{".":{},"f:containerPort":{},"f:name":{},"f:protocol":{}}},"f:readinessProbe":{".":{},"f:failureThreshold":{},"f:initialDelaySeconds":{},"f:periodSeconds":{},"f:successThreshold":{},"f:tcpSocket":{".":{},"f:port":{}},"f:timeoutSeconds":{}},"f:resources":{".":{},"f:limits":{".":{},"f:cpu":{},"f:memory":{}},"f:requests":{".":{},"f:cpu":{},"f:memory":{}}},"f:terminationMessagePath":{},"f:terminationMessagePolicy":{},"f:volumeMounts":{".":{},"k:{\"mountPath\":\"/etc/pod-info/\"}":{".":{},"f:mountPath":{},"f:name":{}},"k:{\"mountPath\":\"/etc/rabbitmq/conf.d/10-operatorDefaults.conf\"}":{".":{},"f:mountPath":{},"f:name":{},"f:subPath":{}},"k:{\"mountPath\":\"/etc/rabbitmq/conf.d/11-default_user.conf\"}":{".":{},"f:mountPath":{},"f:name":{},"f:subPath":{}},"k:{\"mountPath\":\"/etc/rabbitmq/conf.d/90-userDefinedConfiguration.conf\"}":{".":{},"f:mountPath":{},"f:name":{},"f:subPath":{}},"k:{\"mountPath\":\"/operator\"}":{".":{},"f:mountPath":{},"f:name":{}},"k:{\"mountPath\":\"/var/lib/rabbitmq/\"}":{".":{},"f:mountPath":{},"f:name":{}},"k:{\"mountPath\":\"/var/lib/rabbitmq/mnesia/\"}":{".":{},"f:mountPath":{},"f:name":{}}}}},"f:dnsPolicy":{},"f:initContainers":{".":{},"k:{\"name\":\"setup-container\"}":{".":{},"f:command":{},"f:image":{},"f:imagePullPolicy":{},"f:name":{},"f:resources":{".":{},"f:limits":{".":{},"f:cpu":{},"f:memory":{}},"f:requests":{".":{},"f:cpu":{},"f:memory":{}}},"f:securityContext":{".":{},"f:capabilities":{".":{},"f:drop":{}},"f:runAsUser":{}},"f:terminationMessagePath":{},"f:terminationMessagePolicy":{},"f:volumeMounts":{".":{},"k:{\"mountPath\":\"/operator\"}":{".":{},"f:mountPath":{},"f:name":{}},"k:{\"mountPath\":\"/tmp/default_user.conf\"}":{".":{},"f:mountPath":{},"f:name":{},"f:subPath":{}},"k:{\"mountPath\":\"/tmp/erlang-cookie-secret/\"}":{".":{},"f:mountPath":{},"f:name":{}},"k:{\"mountPath\":\"/tmp/rabbitmq-plugins/\"}":{".":{},"f:mountPath":{},"f:name":{}},"k:{\"mountPath\":\"/var/lib/rabbitmq/\"}":{".":{},"f:mountPath":{},"f:name":{}},"k:{\"mountPath\":\"/var/lib/rabbitmq/mnesia/\"}":{".":{},"f:mountPath":{},"f:name":{}}}}},"f:restartPolicy":{},"f:schedulerName":{},"f:securityContext":{".":{},"f:fsGroup":{},"f:runAsGroup":{},"f:runAsUser":{}},"f:serviceAccount":{},"f:serviceAccountName":{},"f:terminationGracePeriodSeconds":{},"f:topologySpreadConstraints":{".":{},"k:{\"topologyKey\":\"topology.kubernetes.io/zone\",\"whenUnsatisfiable\":\"ScheduleAnyway\"}":{".":{},"f:labelSelector":{".":{},"f:matchLabels":{".":{},"f:app.kubernetes.io/name":{}}},"f:maxSkew":{},"f:topologyKey":{},"f:whenUnsatisfiable":{}}},"f:volumes":{".":{},"k:{\"name\":\"erlang-cookie-secret\"}":{".":{},"f:name":{},"f:secret":{".":{},"f:defaultMode":{},"f:secretName":{}}},"k:{\"name\":\"plugins-conf\"}":{".":{},"f:configMap":{".":{},"f:defaultMode":{},"f:name":{}},"f:name":{}},"k:{\"name\":\"pod-info\"}":{".":{},"f:downwardAPI":{".":{},"f:defaultMode":{},"f:items":{}},"f:name":{}},"k:{\"name\":\"rabbitmq-confd\"}":{".":{},"f:name":{},"f:projected":{".":{},"f:defaultMode":{},"f:sources":{}}},"k:{\"name\":\"rabbitmq-erlang-cookie\"}":{".":{},"f:emptyDir":{},"f:name":{}},"k:{\"name\":\"rabbitmq-plugins\"}":{".":{},"f:emptyDir":{},"f:name":{}}}}},"f:updateStrategy":{"f:rollingUpdate":{".":{},"f:partition":{}},"f:type":{}},"f:volumeClaimTemplates":{}}}}]},"spec":{"replicas":1,"selector":{"matchLabels":{"app.kubernetes.io/name":"rabbitmq-cluster"}},"template":{"metadata":{"creationTimestamp":null,"labels":{"app.kubernetes.io/component":"rabbitmq","app.kubernetes.io/name":"rabbitmq-cluster","app.kubernetes.io/part-of":"rabbitmq"},"annotations":{"prometheus.io/port":"15692","prometheus.io/scrape":"true"}},"spec":{"volumes":[{"name":"plugins-conf","configMap":{"name":"rabbitmq-cluster-plugins-conf","defaultMode":420}},{"name":"rabbitmq-confd","projected":{"sources":[{"secret":{"name":"rabbitmq-cluster-default-user","items":[{"key":"default_user.conf","path":"default_user.conf"}]}},{"configMap":{"name":"rabbitmq-cluster-server-conf","items":[{"key":"operatorDefaults.conf","path":"operatorDefaults.conf"},{"key":"userDefinedConfiguration.conf","path":"userDefinedConfiguration.conf"}]}}],"defaultMode":420}},{"name":"rabbitmq-erlang-cookie","emptyDir":{}},{"name":"erlang-cookie-secret","secret":{"secretName":"rabbitmq-cluster-erlang-cookie","defaultMode":420}},{"name":"rabbitmq-plugins","emptyDir":{}},{"name":"pod-info","downwardAPI":{"items":[{"path":"skipPreStopChecks","fieldRef":{"apiVersion":"v1","fieldPath":"metadata.labels['skipPreStopChecks']"}}],"defaultMode":420}}],"initContainers":[{"name":"setup-container","image":"rabbitmq:3.8.12-management","command":["sh","-c","cp /tmp/erlang-cookie-secret/.erlang.cookie /var/lib/rabbitmq/.erlang.cookie \u0026\u0026 chown 999:999 /var/lib/rabbitmq/.erlang.cookie \u0026\u0026 chmod 600 /var/lib/rabbitmq/.erlang.cookie ; cp /tmp/rabbitmq-plugins/enabled_plugins /operator/enabled_plugins \u0026\u0026 chown 999:999 /operator/enabled_plugins ; chown 999:999 /var/lib/rabbitmq/mnesia/ ; echo '[default]' \u003e /var/lib/rabbitmq/.rabbitmqadmin.conf \u0026\u0026 sed -e 's/default_user/username/' -e 's/default_pass/password/' /tmp/default_user.conf \u003e\u003e /var/lib/rabbitmq/.rabbitmqadmin.conf \u0026\u0026 chown 999:999 /var/lib/rabbitmq/.rabbitmqadmin.conf \u0026\u0026 chmod 600 /var/lib/rabbitmq/.rabbitmqadmin.conf"],"resources":{"limits":{"cpu":"100m","memory":"500Mi"},"requests":{"cpu":"100m","memory":"500Mi"}},"volumeMounts":[{"name":"plugins-conf","mountPath":"/tmp/rabbitmq-plugins/"},{"name":"rabbitmq-erlang-cookie","mountPath":"/var/lib/rabbitmq/"},{"name":"erlang-cookie-secret","mountPath":"/tmp/erlang-cookie-secret/"},{"name":"rabbitmq-plugins","mountPath":"/operator"},{"name":"persistence","mountPath":"/var/lib/rabbitmq/mnesia/"},{"name":"rabbitmq-confd","mountPath":"/tmp/default_user.conf","subPath":"default_user.conf"}],"terminationMessagePath":"/dev/termination-log","terminationMessagePolicy":"File","imagePullPolicy":"IfNotPresent","securityContext":{"capabilities":{"drop":["FSETID","KILL","SETGID","SETUID","SETPCAP","NET_BIND_SERVICE","NET_RAW","SYS_CHROOT","MKNOD","AUDIT_WRITE","SETFCAP"]},"runAsUser":0}}],"containers":[{"name":"rabbitmq","image":"rabbitmq:3.8.12-management","ports":[{"name":"epmd","containerPort":4369,"protocol":"TCP"},{"name":"amqp","containerPort":5672,"protocol":"TCP"},{"name":"management","containerPort":15672,"protocol":"TCP"},{"name":"prometheus","containerPort":15692,"protocol":"TCP"}],"env":[{"name":"MY_POD_NAME","valueFrom":{"fieldRef":{"apiVersion":"v1","fieldPath":"metadata.name"}}},{"name":"MY_POD_NAMESPACE","valueFrom":{"fieldRef":{"apiVersion":"v1","fieldPath":"metadata.namespace"}}},{"name":"RABBITMQ_ENABLED_PLUGINS_FILE","value":"/operator/enabled_plugins"},{"name":"K8S_SERVICE_NAME","value":"rabbitmq-cluster-nodes"},{"name":"RABBITMQ_USE_LONGNAME","value":"true"},{"name":"RABBITMQ_NODENAME","value":"rabbit@$(MY_POD_NAME).$(K8S_SERVICE_NAME).$(MY_POD_NAMESPACE)"},{"name":"K8S_HOSTNAME_SUFFIX","value":".$(K8S_SERVICE_NAME).$(MY_POD_NAMESPACE)"}],"resources":{"limits":{"cpu":"2","memory":"2Gi"},"requests":{"cpu":"1","memory":"2Gi"}},"volumeMounts":[{"name":"rabbitmq-erlang-cookie","mountPath":"/var/lib/rabbitmq/"},{"name":"persistence","mountPath":"/var/lib/rabbitmq/mnesia/"},{"name":"rabbitmq-plugins","mountPath":"/operator"},{"name":"rabbitmq-confd","mountPath":"/etc/rabbitmq/conf.d/10-operatorDefaults.conf","subPath":"operatorDefaults.conf"},{"name":"rabbitmq-confd","mountPath":"/etc/rabbitmq/conf.d/11-default_user.conf","subPath":"default_user.conf"},{"name":"rabbitmq-confd","mountPath":"/etc/rabbitmq/conf.d/90-userDefinedConfiguration.conf","subPath":"userDefinedConfiguration.conf"},{"name":"pod-info","mountPath":"/etc/pod-info/"}],"readinessProbe":{"tcpSocket":{"port":"amqp"},"initialDelaySeconds":10,"timeoutSeconds":5,"periodSeconds":10,"successThreshold":1,"failureThreshold":3},"lifecycle":{"preStop":{"exec":{"command":["/bin/bash","-c","if [ ! -z \"$(cat /etc/pod-info/skipPreStopChecks)\" ]; then exit 0; fi; rabbitmq-upgrade await_online_quorum_plus_one -t 604800; rabbitmq-upgrade await_online_synchronized_mirror -t 604800; rabbitmq-upgrade drain -t 604800"]}}},"terminationMessagePath":"/dev/termination-log","terminationMessagePolicy":"File","imagePullPolicy":"IfNotPresent"}],"restartPolicy":"Always","terminationGracePeriodSeconds":604800,"dnsPolicy":"ClusterFirst","serviceAccountName":"rabbitmq-cluster-server","serviceAccount":"rabbitmq-cluster-server","automountServiceAccountToken":true,"securityContext":{"runAsUser":999,"runAsGroup":999,"fsGroup":999},"schedulerName":"default-scheduler","topologySpreadConstraints":[{"maxSkew":1,"topologyKey":"topology.kubernetes.io/zone","whenUnsatisfiable":"ScheduleAnyway","labelSelector":{"matchLabels":{"app.kubernetes.io/name":"rabbitmq-cluster"}}}]}},"volumeClaimTemplates":[{"metadata":{"name":"persistence","namespace":"default","creationTimestamp":null,"labels":{"app.kubernetes.io/component":"rabbitmq","app.kubernetes.io/name":"rabbitmq-cluster","app.kubernetes.io/part-of":"rabbitmq"},"ownerReferences":[{"apiVersion":"rabbitmq.com/v1beta1","kind":"RabbitmqCluster","name":"rabbitmq-cluster","uid":"18d9928b-0d1c-47be-80ec-20960d053827","controller":true,"blockOwnerDeletion":false}]},"spec":{"accessModes":["ReadWriteOnce"],"resources":{"requests":{"storage":"10Gi"}},"volumeMode":"Filesystem"},"status":{"phase":"Pending"}}],"serviceName":"rabbitmq-cluster-nodes","podManagementPolicy":"Parallel","updateStrategy":{"type":"RollingUpdate","rollingUpdate":{"partition":0}},"revisionHistoryLimit":10},"status":{"replicas":0}}
2022/03/18 18:00:38 learn_server.go:256: [SIEVE-BEFORE-WRITE]	12
2022/03/18 18:00:38 learn_server.go:279: [SIEVE-BEFORE-HEAR]	14	Updated	statefulset	{"metadata":{"name":"rabbitmq-cluster-server","namespace":"default","selfLink":"/apis/apps/v1/namespaces/default/statefulsets/rabbitmq-cluster-server","uid":"cb5c43bc-6ee7-481c-ab01-6f3acffdd3c8","resourceVersion":"737","generation":1,"creationTimestamp":"2022-03-18T18:00:38Z","labels":{"app.kubernetes.io/component":"rabbitmq","app.kubernetes.io/name":"rabbitmq-cluster","app.kubernetes.io/part-of":"rabbitmq"},"ownerReferences":[{"apiVersion":"rabbitmq.com/v1beta1","kind":"RabbitmqCluster","name":"rabbitmq-cluster","uid":"18d9928b-0d1c-47be-80ec-20960d053827","controller":true,"blockOwnerDeletion":true}],"managedFields":[{"manager":"kube-controller-manager","operation":"Update","apiVersion":"apps/v1","time":"2022-03-18T18:00:38Z","fieldsType":"FieldsV1","fieldsV1":{"f:status":{"f:collisionCount":{},"f:currentReplicas":{},"f:currentRevision":{},"f:observedGeneration":{},"f:replicas":{},"f:updateRevision":{},"f:updatedReplicas":{}}}},{"manager":"manager","operation":"Update","apiVersion":"apps/v1","time":"2022-03-18T18:00:38Z","fieldsType":"FieldsV1","fieldsV1":{"f:metadata":{"f:labels":{".":{},"f:app.kubernetes.io/component":{},"f:app.kubernetes.io/name":{},"f:app.kubernetes.io/part-of":{}},"f:ownerReferences":{".":{},"k:{\"uid\":\"18d9928b-0d1c-47be-80ec-20960d053827\"}":{".":{},"f:apiVersion":{},"f:blockOwnerDeletion":{},"f:controller":{},"f:kind":{},"f:name":{},"f:uid":{}}}},"f:spec":{"f:podManagementPolicy":{},"f:replicas":{},"f:revisionHistoryLimit":{},"f:selector":{"f:matchLabels":{".":{},"f:app.kubernetes.io/name":{}}},"f:serviceName":{},"f:template":{"f:metadata":{"f:annotations":{".":{},"f:prometheus.io/port":{},"f:prometheus.io/scrape":{}},"f:labels":{".":{},"f:app.kubernetes.io/component":{},"f:app.kubernetes.io/name":{},"f:app.kubernetes.io/part-of":{}}},"f:spec":{"f:automountServiceAccountToken":{},"f:containers":{"k:{\"name\":\"rabbitmq\"}":{".":{},"f:env":{".":{},"k:{\"name\":\"K8S_HOSTNAME_SUFFIX\"}":{".":{},"f:name":{},"f:value":{}},"k:{\"name\":\"K8S_SERVICE_NAME\"}":{".":{},"f:name":{},"f:value":{}},"k:{\"name\":\"MY_POD_NAME\"}":{".":{},"f:name":{},"f:valueFrom":{".":{},"f:fieldRef":{".":{},"f:apiVersion":{},"f:fieldPath":{}}}},"k:{\"name\":\"MY_POD_NAMESPACE\"}":{".":{},"f:name":{},"f:valueFrom":{".":{},"f:fieldRef":{".":{},"f:apiVersion":{},"f:fieldPath":{}}}},"k:{\"name\":\"RABBITMQ_ENABLED_PLUGINS_FILE\"}":{".":{},"f:name":{},"f:value":{}},"k:{\"name\":\"RABBITMQ_NODENAME\"}":{".":{},"f:name":{},"f:value":{}},"k:{\"name\":\"RABBITMQ_USE_LONGNAME\"}":{".":{},"f:name":{},"f:value":{}}},"f:image":{},"f:imagePullPolicy":{},"f:lifecycle":{".":{},"f:preStop":{".":{},"f:exec":{".":{},"f:command":{}}}},"f:name":{},"f:ports":{".":{},"k:{\"containerPort\":4369,\"protocol\":\"TCP\"}":{".":{},"f:containerPort":{},"f:name":{},"f:protocol":{}},"k:{\"containerPort\":5672,\"protocol\":\"TCP\"}":{".":{},"f:containerPort":{},"f:name":{},"f:protocol":{}},"k:{\"containerPort\":15672,\"protocol\":\"TCP\"}":{".":{},"f:containerPort":{},"f:name":{},"f:protocol":{}},"k:{\"containerPort\":15692,\"protocol\":\"TCP\"}":{".":{},"f:containerPort":{},"f:name":{},"f:protocol":{}}},"f:readinessProbe":{".":{},"f:failureThreshold":{},"f:initialDelaySeconds":{},"f:periodSeconds":{},"f:successThreshold":{},"f:tcpSocket":{".":{},"f:port":{}},"f:timeoutSeconds":{}},"f:resources":{".":{},"f:limits":{".":{},"f:cpu":{},"f:memory":{}},"f:requests":{".":{},"f:cpu":{},"f:memory":{}}},"f:terminationMessagePath":{},"f:terminationMessagePolicy":{},"f:volumeMounts":{".":{},"k:{\"mountPath\":\"/etc/pod-info/\"}":{".":{},"f:mountPath":{},"f:name":{}},"k:{\"mountPath\":\"/etc/rabbitmq/conf.d/10-operatorDefaults.conf\"}":{".":{},"f:mountPath":{},"f:name":{},"f:subPath":{}},"k:{\"mountPath\":\"/etc/rabbitmq/conf.d/11-default_user.conf\"}":{".":{},"f:mountPath":{},"f:name":{},"f:subPath":{}},"k:{\"mountPath\":\"/etc/rabbitmq/conf.d/90-userDefinedConfiguration.conf\"}":{".":{},"f:mountPath":{},"f:name":{},"f:subPath":{}},"k:{\"mountPath\":\"/operator\"}":{".":{},"f:mountPath":{},"f:name":{}},"k:{\"mountPath\":\"/var/lib/rabbitmq/\"}":{".":{},"f:mountPath":{},"f:name":{}},"k:{\"mountPath\":\"/var/lib/rabbitmq/mnesia/\"}":{".":{},"f:mountPath":{},"f:name":{}}}}},"f:dnsPolicy":{},"f:initContainers":{".":{},"k:{\"name\":\"setup-container\"}":{".":{},"f:command":{},"f:image":{},"f:imagePullPolicy":{},"f:name":{},"f:resources":{".":{},"f:limits":{".":{},"f:cpu":{},"f:memory":{}},"f:requests":{".":{},"f:cpu":{},"f:memory":{}}},"f:securityContext":{".":{},"f:capabilities":{".":{},"f:drop":{}},"f:runAsUser":{}},"f:terminationMessagePath":{},"f:terminationMessagePolicy":{},"f:volumeMounts":{".":{},"k:{\"mountPath\":\"/operator\"}":{".":{},"f:mountPath":{},"f:name":{}},"k:{\"mountPath\":\"/tmp/default_user.conf\"}":{".":{},"f:mountPath":{},"f:name":{},"f:subPath":{}},"k:{\"mountPath\":\"/tmp/erlang-cookie-secret/\"}":{".":{},"f:mountPath":{},"f:name":{}},"k:{\"mountPath\":\"/tmp/rabbitmq-plugins/\"}":{".":{},"f:mountPath":{},"f:name":{}},"k:{\"mountPath\":\"/var/lib/rabbitmq/\"}":{".":{},"f:mountPath":{},"f:name":{}},"k:{\"mountPath\":\"/var/lib/rabbitmq/mnesia/\"}":{".":{},"f:mountPath":{},"f:name":{}}}}},"f:restartPolicy":{},"f:schedulerName":{},"f:securityContext":{".":{},"f:fsGroup":{},"f:runAsGroup":{},"f:runAsUser":{}},"f:serviceAccount":{},"f:serviceAccountName":{},"f:terminationGracePeriodSeconds":{},"f:topologySpreadConstraints":{".":{},"k:{\"topologyKey\":\"topology.kubernetes.io/zone\",\"whenUnsatisfiable\":\"ScheduleAnyway\"}":{".":{},"f:labelSelector":{".":{},"f:matchLabels":{".":{},"f:app.kubernetes.io/name":{}}},"f:maxSkew":{},"f:topologyKey":{},"f:whenUnsatisfiable":{}}},"f:volumes":{".":{},"k:{\"name\":\"erlang-cookie-secret\"}":{".":{},"f:name":{},"f:secret":{".":{},"f:defaultMode":{},"f:secretName":{}}},"k:{\"name\":\"plugins-conf\"}":{".":{},"f:configMap":{".":{},"f:defaultMode":{},"f:name":{}},"f:name":{}},"k:{\"name\":\"pod-info\"}":{".":{},"f:downwardAPI":{".":{},"f:defaultMode":{},"f:items":{}},"f:name":{}},"k:{\"name\":\"rabbitmq-confd\"}":{".":{},"f:name":{},"f:projected":{".":{},"f:defaultMode":{},"f:sources":{}}},"k:{\"name\":\"rabbitmq-erlang-cookie\"}":{".":{},"f:emptyDir":{},"f:name":{}},"k:{\"name\":\"rabbitmq-plugins\"}":{".":{},"f:emptyDir":{},"f:name":{}}}}},"f:updateStrategy":{"f:rollingUpdate":{".":{},"f:partition":{}},"f:type":{}},"f:volumeClaimTemplates":{}}}}]},"spec":{"replicas":1,"selector":{"matchLabels":{"app.kubernetes.io/name":"rabbitmq-cluster"}},"template":{"metadata":{"creationTimestamp":null,"labels":{"app.kubernetes.io/component":"rabbitmq","app.kubernetes.io/name":"rabbitmq-cluster","app.kubernetes.io/part-of":"rabbitmq"},"annotations":{"prometheus.io/port":"15692","prometheus.io/scrape":"true"}},"spec":{"volumes":[{"name":"plugins-conf","configMap":{"name":"rabbitmq-cluster-plugins-conf","defaultMode":420}},{"name":"rabbitmq-confd","projected":{"sources":[{"secret":{"name":"rabbitmq-cluster-default-user","items":[{"key":"default_user.conf","path":"default_user.conf"}]}},{"configMap":{"name":"rabbitmq-cluster-server-conf","items":[{"key":"operatorDefaults.conf","path":"operatorDefaults.conf"},{"key":"userDefinedConfiguration.conf","path":"userDefinedConfiguration.conf"}]}}],"defaultMode":420}},{"name":"rabbitmq-erlang-cookie","emptyDir":{}},{"name":"erlang-cookie-secret","secret":{"secretName":"rabbitmq-cluster-erlang-cookie","defaultMode":420}},{"name":"rabbitmq-plugins","emptyDir":{}},{"name":"pod-info","downwardAPI":{"items":[{"path":"skipPreStopChecks","fieldRef":{"apiVersion":"v1","fieldPath":"metadata.labels['skipPreStopChecks']"}}],"defaultMode":420}}],"initContainers":[{"name":"setup-container","image":"rabbitmq:3.8.12-management","command":["sh","-c","cp /tmp/erlang-cookie-secret/.erlang.cookie /var/lib/rabbitmq/.erlang.cookie \u0026\u0026 chown 999:999 /var/lib/rabbitmq/.erlang.cookie \u0026\u0026 chmod 600 /var/lib/rabbitmq/.erlang.cookie ; cp /tmp/rabbitmq-plugins/enabled_plugins /operator/enabled_plugins \u0026\u0026 chown 999:999 /operator/enabled_plugins ; chown 999:999 /var/lib/rabbitmq/mnesia/ ; echo '[default]' \u003e /var/lib/rabbitmq/.rabbitmqadmin.conf \u0026\u0026 sed -e 's/default_user/username/' -e 's/default_pass/password/' /tmp/default_user.conf \u003e\u003e /var/lib/rabbitmq/.rabbitmqadmin.conf \u0026\u0026 chown 999:999 /var/lib/rabbitmq/.rabbitmqadmin.conf \u0026\u0026 chmod 600 /var/lib/rabbitmq/.rabbitmqadmin.conf"],"resources":{"limits":{"cpu":"100m","memory":"500Mi"},"requests":{"cpu":"100m","memory":"500Mi"}},"volumeMounts":[{"name":"plugins-conf","mountPath":"/tmp/rabbitmq-plugins/"},{"name":"rabbitmq-erlang-cookie","mountPath":"/var/lib/rabbitmq/"},{"name":"erlang-cookie-secret","mountPath":"/tmp/erlang-cookie-secret/"},{"name":"rabbitmq-plugins","mountPath":"/operator"},{"name":"persistence","mountPath":"/var/lib/rabbitmq/mnesia/"},{"name":"rabbitmq-confd","mountPath":"/tmp/default_user.conf","subPath":"default_user.conf"}],"terminationMessagePath":"/dev/termination-log","terminationMessagePolicy":"File","imagePullPolicy":"IfNotPresent","securityContext":{"capabilities":{"drop":["FSETID","KILL","SETGID","SETUID","SETPCAP","NET_BIND_SERVICE","NET_RAW","SYS_CHROOT","MKNOD","AUDIT_WRITE","SETFCAP"]},"runAsUser":0}}],"containers":[{"name":"rabbitmq","image":"rabbitmq:3.8.12-management","ports":[{"name":"epmd","containerPort":4369,"protocol":"TCP"},{"name":"amqp","containerPort":5672,"protocol":"TCP"},{"name":"management","containerPort":15672,"protocol":"TCP"},{"name":"prometheus","containerPort":15692,"protocol":"TCP"}],"env":[{"name":"MY_POD_NAME","valueFrom":{"fieldRef":{"apiVersion":"v1","fieldPath":"metadata.name"}}},{"name":"MY_POD_NAMESPACE","valueFrom":{"fieldRef":{"apiVersion":"v1","fieldPath":"metadata.namespace"}}},{"name":"RABBITMQ_ENABLED_PLUGINS_FILE","value":"/operator/enabled_plugins"},{"name":"K8S_SERVICE_NAME","value":"rabbitmq-cluster-nodes"},{"name":"RABBITMQ_USE_LONGNAME","value":"true"},{"name":"RABBITMQ_NODENAME","value":"rabbit@$(MY_POD_NAME).$(K8S_SERVICE_NAME).$(MY_POD_NAMESPACE)"},{"name":"K8S_HOSTNAME_SUFFIX","value":".$(K8S_SERVICE_NAME).$(MY_POD_NAMESPACE)"}],"resources":{"limits":{"cpu":"2","memory":"2Gi"},"requests":{"cpu":"1","memory":"2Gi"}},"volumeMounts":[{"name":"rabbitmq-erlang-cookie","mountPath":"/var/lib/rabbitmq/"},{"name":"persistence","mountPath":"/var/lib/rabbitmq/mnesia/"},{"name":"rabbitmq-plugins","mountPath":"/operator"},{"name":"rabbitmq-confd","mountPath":"/etc/rabbitmq/conf.d/10-operatorDefaults.conf","subPath":"operatorDefaults.conf"},{"name":"rabbitmq-confd","mountPath":"/etc/rabbitmq/conf.d/11-default_user.conf","subPath":"default_user.conf"},{"name":"rabbitmq-confd","mountPath":"/etc/rabbitmq/conf.d/90-userDefinedConfiguration.conf","subPath":"userDefinedConfiguration.conf"},{"name":"pod-info","mountPath":"/etc/pod-info/"}],"readinessProbe":{"tcpSocket":{"port":"amqp"},"initialDelaySeconds":10,"timeoutSeconds":5,"periodSeconds":10,"successThreshold":1,"failureThreshold":3},"lifecycle":{"preStop":{"exec":{"command":["/bin/bash","-c","if [ ! -z \"$(cat /etc/pod-info/skipPreStopChecks)\" ]; then exit 0; fi; rabbitmq-upgrade await_online_quorum_plus_one -t 604800; rabbitmq-upgrade await_online_synchronized_mirror -t 604800; rabbitmq-upgrade drain -t 604800"]}}},"terminationMessagePath":"/dev/termination-log","terminationMessagePolicy":"File","imagePullPolicy":"IfNotPresent"}],"restartPolicy":"Always","terminationGracePeriodSeconds":604800,"dnsPolicy":"ClusterFirst","serviceAccountName":"rabbitmq-cluster-server","serviceAccount":"rabbitmq-cluster-server","automountServiceAccountToken":true,"securityContext":{"runAsUser":999,"runAsGroup":999,"fsGroup":999},"schedulerName":"default-scheduler","topologySpreadConstraints":[{"maxSkew":1,"topologyKey":"topology.kubernetes.io/zone","whenUnsatisfiable":"ScheduleAnyway","labelSelector":{"matchLabels":{"app.kubernetes.io/name":"rabbitmq-cluster"}}}]}},"volumeClaimTemplates":[{"metadata":{"name":"persistence","namespace":"default","creationTimestamp":null,"labels":{"app.kubernetes.io/component":"rabbitmq","app.kubernetes.io/name":"rabbitmq-cluster","app.kubernetes.io/part-of":"rabbitmq"},"ownerReferences":[{"apiVersion":"rabbitmq.com/v1beta1","kind":"RabbitmqCluster","name":"rabbitmq-cluster","uid":"18d9928b-0d1c-47be-80ec-20960d053827","controller":true,"blockOwnerDeletion":false}]},"spec":{"accessModes":["ReadWriteOnce"],"resources":{"requests":{"storage":"10Gi"}},"volumeMode":"Filesystem"},"status":{"phase":"Pending"}}],"serviceName":"rabbitmq-cluster-nodes","podManagementPolicy":"Parallel","updateStrategy":{"type":"RollingUpdate","rollingUpdate":{"partition":0}},"revisionHistoryLimit":10},"status":{"observedGeneration":1,"replicas":1,"currentReplicas":1,"updatedReplicas":1,"currentRevision":"rabbitmq-cluster-server-5f8b8665fb","updateRevision":"rabbitmq-cluster-server-5f8b8665fb","collisionCount":0}}
2022/03/18 18:00:38 learn_server.go:289: [SIEVE-AFTER-HEAR]	14
2022/03/18 18:00:38 learn_server.go:263: [SIEVE-AFTER-WRITE]	12	Update	statefulset	github.com/rabbitmq/cluster-operator/controllers.(*RabbitmqClusterReconciler)	Conflict	{"kind":"StatefulSet","apiVersion":"apps/v1","metadata":{"name":"rabbitmq-cluster-server","namespace":"default","selfLink":"/apis/apps/v1/namespaces/default/statefulsets/rabbitmq-cluster-server","uid":"cb5c43bc-6ee7-481c-ab01-6f3acffdd3c8","resourceVersion":"727","generation":1,"creationTimestamp":"2022-03-18T18:00:38Z","labels":{"app.kubernetes.io/component":"rabbitmq","app.kubernetes.io/name":"rabbitmq-cluster","app.kubernetes.io/part-of":"rabbitmq"},"annotations":{"rabbitmq.com/createdAt":"2022-03-18T18:00:38Z"},"ownerReferences":[{"apiVersion":"rabbitmq.com/v1beta1","kind":"RabbitmqCluster","name":"rabbitmq-cluster","uid":"18d9928b-0d1c-47be-80ec-20960d053827","controller":true,"blockOwnerDeletion":true}],"managedFields":[{"manager":"manager","operation":"Update","apiVersion":"apps/v1","time":"2022-03-18T18:00:38Z","fieldsType":"FieldsV1","fieldsV1":{"f:metadata":{"f:labels":{".":{},"f:app.kubernetes.io/component":{},"f:app.kubernetes.io/name":{},"f:app.kubernetes.io/part-of":{}},"f:ownerReferences":{".":{},"k:{\"uid\":\"18d9928b-0d1c-47be-80ec-20960d053827\"}":{".":{},"f:apiVersion":{},"f:blockOwnerDeletion":{},"f:controller":{},"f:kind":{},"f:name":{},"f:uid":{}}}},"f:spec":{"f:podManagementPolicy":{},"f:replicas":{},"f:revisionHistoryLimit":{},"f:selector":{"f:matchLabels":{".":{},"f:app.kubernetes.io/name":{}}},"f:serviceName":{},"f:template":{"f:metadata":{"f:annotations":{".":{},"f:prometheus.io/port":{},"f:prometheus.io/scrape":{}},"f:labels":{".":{},"f:app.kubernetes.io/component":{},"f:app.kubernetes.io/name":{},"f:app.kubernetes.io/part-of":{}}},"f:spec":{"f:automountServiceAccountToken":{},"f:containers":{"k:{\"name\":\"rabbitmq\"}":{".":{},"f:env":{".":{},"k:{\"name\":\"K8S_HOSTNAME_SUFFIX\"}":{".":{},"f:name":{},"f:value":{}},"k:{\"name\":\"K8S_SERVICE_NAME\"}":{".":{},"f:name":{},"f:value":{}},"k:{\"name\":\"MY_POD_NAME\"}":{".":{},"f:name":{},"f:valueFrom":{".":{},"f:fieldRef":{".":{},"f:apiVersion":{},"f:fieldPath":{}}}},"k:{\"name\":\"MY_POD_NAMESPACE\"}":{".":{},"f:name":{},"f:valueFrom":{".":{},"f:fieldRef":{".":{},"f:apiVersion":{},"f:fieldPath":{}}}},"k:{\"name\":\"RABBITMQ_ENABLED_PLUGINS_FILE\"}":{".":{},"f:name":{},"f:value":{}},"k:{\"name\":\"RABBITMQ_NODENAME\"}":{".":{},"f:name":{},"f:value":{}},"k:{\"name\":\"RABBITMQ_USE_LONGNAME\"}":{".":{},"f:name":{},"f:value":{}}},"f:image":{},"f:imagePullPolicy":{},"f:lifecycle":{".":{},"f:preStop":{".":{},"f:exec":{".":{},"f:command":{}}}},"f:name":{},"f:ports":{".":{},"k:{\"containerPort\":4369,\"protocol\":\"TCP\"}":{".":{},"f:containerPort":{},"f:name":{},"f:protocol":{}},"k:{\"containerPort\":5672,\"protocol\":\"TCP\"}":{".":{},"f:containerPort":{},"f:name":{},"f:protocol":{}},"k:{\"containerPort\":15672,\"protocol\":\"TCP\"}":{".":{},"f:containerPort":{},"f:name":{},"f:protocol":{}},"k:{\"containerPort\":15692,\"protocol\":\"TCP\"}":{".":{},"f:containerPort":{},"f:name":{},"f:protocol":{}}},"f:readinessProbe":{".":{},"f:failureThreshold":{},"f:initialDelaySeconds":{},"f:periodSeconds":{},"f:successThreshold":{},"f:tcpSocket":{".":{},"f:port":{}},"f:timeoutSeconds":{}},"f:resources":{".":{},"f:limits":{".":{},"f:cpu":{},"f:memory":{}},"f:requests":{".":{},"f:cpu":{},"f:memory":{}}},"f:terminationMessagePath":{},"f:terminationMessagePolicy":{},"f:volumeMounts":{".":{},"k:{\"mountPath\":\"/etc/pod-info/\"}":{".":{},"f:mountPath":{},"f:name":{}},"k:{\"mountPath\":\"/etc/rabbitmq/conf.d/10-operatorDefaults.conf\"}":{".":{},"f:mountPath":{},"f:name":{},"f:subPath":{}},"k:{\"mountPath\":\"/etc/rabbitmq/conf.d/11-default_user.conf\"}":{".":{},"f:mountPath":{},"f:name":{},"f:subPath":{}},"k:{\"mountPath\":\"/etc/rabbitmq/conf.d/90-userDefinedConfiguration.conf\"}":{".":{},"f:mountPath":{},"f:name":{},"f:subPath":{}},"k:{\"mountPath\":\"/operator\"}":{".":{},"f:mountPath":{},"f:name":{}},"k:{\"mountPath\":\"/var/lib/rabbitmq/\"}":{".":{},"f:mountPath":{},"f:name":{}},"k:{\"mountPath\":\"/var/lib/rabbitmq/mnesia/\"}":{".":{},"f:mountPath":{},"f:name":{}}}}},"f:dnsPolicy":{},"f:initContainers":{".":{},"k:{\"name\":\"setup-container\"}":{".":{},"f:command":{},"f:image":{},"f:imagePullPolicy":{},"f:name":{},"f:resources":{".":{},"f:limits":{".":{},"f:cpu":{},"f:memory":{}},"f:requests":{".":{},"f:cpu":{},"f:memory":{}}},"f:securityContext":{".":{},"f:capabilities":{".":{},"f:drop":{}},"f:runAsUser":{}},"f:terminationMessagePath":{},"f:terminationMessagePolicy":{},"f:volumeMounts":{".":{},"k:{\"mountPath\":\"/operator\"}":{".":{},"f:mountPath":{},"f:name":{}},"k:{\"mountPath\":\"/tmp/default_user.conf\"}":{".":{},"f:mountPath":{},"f:name":{},"f:subPath":{}},"k:{\"mountPath\":\"/tmp/erlang-cookie-secret/\"}":{".":{},"f:mountPath":{},"f:name":{}},"k:{\"mountPath\":\"/tmp/rabbitmq-plugins/\"}":{".":{},"f:mountPath":{},"f:name":{}},"k:{\"mountPath\":\"/var/lib/rabbitmq/\"}":{".":{},"f:mountPath":{},"f:name":{}},"k:{\"mountPath\":\"/var/lib/rabbitmq/mnesia/\"}":{".":{},"f:mountPath":{},"f:name":{}}}}},"f:restartPolicy":{},"f:schedulerName":{},"f:securityContext":{".":{},"f:fsGroup":{},"f:runAsGroup":{},"f:runAsUser":{}},"f:serviceAccount":{},"f:serviceAccountName":{},"f:terminationGracePeriodSeconds":{},"f:topologySpreadConstraints":{".":{},"k:{\"topologyKey\":\"topology.kubernetes.io/zone\",\"whenUnsatisfiable\":\"ScheduleAnyway\"}":{".":{},"f:labelSelector":{".":{},"f:matchLabels":{".":{},"f:app.kubernetes.io/name":{}}},"f:maxSkew":{},"f:topologyKey":{},"f:whenUnsatisfiable":{}}},"f:volumes":{".":{},"k:{\"name\":\"erlang-cookie-secret\"}":{".":{},"f:name":{},"f:secret":{".":{},"f:defaultMode":{},"f:secretName":{}}},"k:{\"name\":\"plugins-conf\"}":{".":{},"f:configMap":{".":{},"f:defaultMode":{},"f:name":{}},"f:name":{}},"k:{\"name\":\"pod-info\"}":{".":{},"f:downwardAPI":{".":{},"f:defaultMode":{},"f:items":{}},"f:name":{}},"k:{\"name\":\"rabbitmq-confd\"}":{".":{},"f:name":{},"f:projected":{".":{},"f:defaultMode":{},"f:sources":{}}},"k:{\"name\":\"rabbitmq-erlang-cookie\"}":{".":{},"f:emptyDir":{},"f:name":{}},"k:{\"name\":\"rabbitmq-plugins\"}":{".":{},"f:emptyDir":{},"f:name":{}}}}},"f:updateStrategy":{"f:rollingUpdate":{".":{},"f:partition":{}},"f:type":{}},"f:volumeClaimTemplates":{}}}}]},"spec":{"replicas":1,"selector":{"matchLabels":{"app.kubernetes.io/name":"rabbitmq-cluster"}},"template":{"metadata":{"creationTimestamp":null,"labels":{"app.kubernetes.io/component":"rabbitmq","app.kubernetes.io/name":"rabbitmq-cluster","app.kubernetes.io/part-of":"rabbitmq"},"annotations":{"prometheus.io/port":"15692","prometheus.io/scrape":"true"}},"spec":{"volumes":[{"name":"plugins-conf","configMap":{"name":"rabbitmq-cluster-plugins-conf","defaultMode":420}},{"name":"rabbitmq-confd","projected":{"sources":[{"secret":{"name":"rabbitmq-cluster-default-user","items":[{"key":"default_user.conf","path":"default_user.conf"}]}},{"configMap":{"name":"rabbitmq-cluster-server-conf","items":[{"key":"operatorDefaults.conf","path":"operatorDefaults.conf"},{"key":"userDefinedConfiguration.conf","path":"userDefinedConfiguration.conf"}]}}],"defaultMode":420}},{"name":"rabbitmq-erlang-cookie","emptyDir":{}},{"name":"erlang-cookie-secret","secret":{"secretName":"rabbitmq-cluster-erlang-cookie","defaultMode":420}},{"name":"rabbitmq-plugins","emptyDir":{}},{"name":"pod-info","downwardAPI":{"items":[{"path":"skipPreStopChecks","fieldRef":{"apiVersion":"v1","fieldPath":"metadata.labels['skipPreStopChecks']"}}],"defaultMode":420}}],"initContainers":[{"name":"setup-container","image":"rabbitmq:3.8.12-management","command":["sh","-c","cp /tmp/erlang-cookie-secret/.erlang.cookie /var/lib/rabbitmq/.erlang.cookie \u0026\u0026 chown 999:999 /var/lib/rabbitmq/.erlang.cookie \u0026\u0026 chmod 600 /var/lib/rabbitmq/.erlang.cookie ; cp /tmp/rabbitmq-plugins/enabled_plugins /operator/enabled_plugins \u0026\u0026 chown 999:999 /operator/enabled_plugins ; chown 999:999 /var/lib/rabbitmq/mnesia/ ; echo '[default]' \u003e /var/lib/rabbitmq/.rabbitmqadmin.conf \u0026\u0026 sed -e 's/default_user/username/' -e 's/default_pass/password/' /tmp/default_user.conf \u003e\u003e /var/lib/rabbitmq/.rabbitmqadmin.conf \u0026\u0026 chown 999:999 /var/lib/rabbitmq/.rabbitmqadmin.conf \u0026\u0026 chmod 600 /var/lib/rabbitmq/.rabbitmqadmin.conf"],"resources":{"limits":{"cpu":"100m","memory":"500Mi"},"requests":{"cpu":"100m","memory":"500Mi"}},"volumeMounts":[{"name":"plugins-conf","mountPath":"/tmp/rabbitmq-plugins/"},{"name":"rabbitmq-erlang-cookie","mountPath":"/var/lib/rabbitmq/"},{"name":"erlang-cookie-secret","mountPath":"/tmp/erlang-cookie-secret/"},{"name":"rabbitmq-plugins","mountPath":"/operator"},{"name":"persistence","mountPath":"/var/lib/rabbitmq/mnesia/"},{"name":"rabbitmq-confd","mountPath":"/tmp/default_user.conf","subPath":"default_user.conf"}],"terminationMessagePath":"/dev/termination-log","terminationMessagePolicy":"File","imagePullPolicy":"IfNotPresent","securityContext":{"capabilities":{"drop":["FSETID","KILL","SETGID","SETUID","SETPCAP","NET_BIND_SERVICE","NET_RAW","SYS_CHROOT","MKNOD","AUDIT_WRITE","SETFCAP"]},"runAsUser":0}}],"containers":[{"name":"rabbitmq","image":"rabbitmq:3.8.12-management","ports":[{"name":"epmd","containerPort":4369,"protocol":"TCP"},{"name":"amqp","containerPort":5672,"protocol":"TCP"},{"name":"management","containerPort":15672,"protocol":"TCP"},{"name":"prometheus","containerPort":15692,"protocol":"TCP"}],"env":[{"name":"MY_POD_NAME","valueFrom":{"fieldRef":{"apiVersion":"v1","fieldPath":"metadata.name"}}},{"name":"MY_POD_NAMESPACE","valueFrom":{"fieldRef":{"apiVersion":"v1","fieldPath":"metadata.namespace"}}},{"name":"RABBITMQ_ENABLED_PLUGINS_FILE","value":"/operator/enabled_plugins"},{"name":"K8S_SERVICE_NAME","value":"rabbitmq-cluster-nodes"},{"name":"RABBITMQ_USE_LONGNAME","value":"true"},{"name":"RABBITMQ_NODENAME","value":"rabbit@$(MY_POD_NAME).$(K8S_SERVICE_NAME).$(MY_POD_NAMESPACE)"},{"name":"K8S_HOSTNAME_SUFFIX","value":".$(K8S_SERVICE_NAME).$(MY_POD_NAMESPACE)"}],"resources":{"limits":{"cpu":"2","memory":"2Gi"},"requests":{"cpu":"1","memory":"2Gi"}},"volumeMounts":[{"name":"rabbitmq-erlang-cookie","mountPath":"/var/lib/rabbitmq/"},{"name":"persistence","mountPath":"/var/lib/rabbitmq/mnesia/"},{"name":"rabbitmq-plugins","mountPath":"/operator"},{"name":"rabbitmq-confd","mountPath":"/etc/rabbitmq/conf.d/10-operatorDefaults.conf","subPath":"operatorDefaults.conf"},{"name":"rabbitmq-confd","mountPath":"/etc/rabbitmq/conf.d/11-default_user.conf","subPath":"default_user.conf"},{"name":"rabbitmq-confd","mountPath":"/etc/rabbitmq/conf.d/90-userDefinedConfiguration.conf","subPath":"userDefinedConfiguration.conf"},{"name":"pod-info","mountPath":"/etc/pod-info/"}],"readinessProbe":{"tcpSocket":{"port":"amqp"},"initialDelaySeconds":10,"timeoutSeconds":5,"periodSeconds":10,"successThreshold":1,"failureThreshold":3},"lifecycle":{"preStop":{"exec":{"command":["/bin/bash","-c","if [ ! -z \"$(cat /etc/pod-info/skipPreStopChecks)\" ]; then exit 0; fi; rabbitmq-upgrade await_online_quorum_plus_one -t 604800; rabbitmq-upgrade await_online_synchronized_mirror -t 604800; rabbitmq-upgrade drain -t 604800"]}}},"terminationMessagePath":"/dev/termination-log","terminationMessagePolicy":"File","imagePullPolicy":"IfNotPresent"}],"restartPolicy":"Always","terminationGracePeriodSeconds":604800,"dnsPolicy":"ClusterFirst","serviceAccountName":"rabbitmq-cluster-server","serviceAccount":"rabbitmq-cluster-server","automountServiceAccountToken":true,"securityContext":{"runAsUser":999,"runAsGroup":999,"fsGroup":999},"schedulerName":"default-scheduler","topologySpreadConstraints":[{"maxSkew":1,"topologyKey":"topology.kubernetes.io/zone","whenUnsatisfiable":"ScheduleAnyway","labelSelector":{"matchLabels":{"app.kubernetes.io/name":"rabbitmq-cluster"}}}]}},"volumeClaimTemplates":[{"metadata":{"name":"persistence","namespace":"default","creationTimestamp":null,"labels":{"app.kubernetes.io/component":"rabbitmq","app.kubernetes.io/name":"rabbitmq-cluster","app.kubernetes.io/part-of":"rabbitmq"},"ownerReferences":[{"apiVersion":"rabbitmq.com/v1beta1","kind":"RabbitmqCluster","name":"rabbitmq-cluster","uid":"18d9928b-0d1c-47be-80ec-20960d053827","controller":true,"blockOwnerDeletion":false}]},"spec":{"accessModes":["ReadWriteOnce"],"resources":{"requests":{"storage":"10Gi"}},"volumeMode":"Filesystem"},"status":{"phase":"Pending"}}],"serviceName":"rabbitmq-cluster-nodes","podManagementPolicy":"Parallel","updateStrategy":{"type":"RollingUpdate","rollingUpdate":{"partition":0}},"revisionHistoryLimit":10},"status":{"replicas":0}}
2022/03/18 18:00:38 learn_server.go:291: [SIEVE-AFTER-READ]	Get	true	statefulset	default	rabbitmq-cluster-server	github.com/rabbitmq/cluster-operator/controllers.(*RabbitmqClusterReconciler)	NoError	{"kind":"StatefulSet","apiVersion":"apps/v1","metadata":{"name":"rabbitmq-cluster-server","namespace":"default","selfLink":"/apis/apps/v1/namespaces/default/statefulsets/rabbitmq-cluster-server","uid":"cb5c43bc-6ee7-481c-ab01-6f3acffdd3c8","resourceVersion":"737","generation":1,"creationTimestamp":"2022-03-18T18:00:38Z","labels":{"app.kubernetes.io/component":"rabbitmq","app.kubernetes.io/name":"rabbitmq-cluster","app.kubernetes.io/part-of":"rabbitmq"},"ownerReferences":[{"apiVersion":"rabbitmq.com/v1beta1","kind":"RabbitmqCluster","name":"rabbitmq-cluster","uid":"18d9928b-0d1c-47be-80ec-20960d053827","controller":true,"blockOwnerDeletion":true}],"managedFields":[{"manager":"kube-controller-manager","operation":"Update","apiVersion":"apps/v1","time":"2022-03-18T18:00:38Z","fieldsType":"FieldsV1","fieldsV1":{"f:status":{"f:collisionCount":{},"f:currentReplicas":{},"f:currentRevision":{},"f:observedGeneration":{},"f:replicas":{},"f:updateRevision":{},"f:updatedReplicas":{}}}},{"manager":"manager","operation":"Update","apiVersion":"apps/v1","time":"2022-03-18T18:00:38Z","fieldsType":"FieldsV1","fieldsV1":{"f:metadata":{"f:labels":{".":{},"f:app.kubernetes.io/component":{},"f:app.kubernetes.io/name":{},"f:app.kubernetes.io/part-of":{}},"f:ownerReferences":{".":{},"k:{\"uid\":\"18d9928b-0d1c-47be-80ec-20960d053827\"}":{".":{},"f:apiVersion":{},"f:blockOwnerDeletion":{},"f:controller":{},"f:kind":{},"f:name":{},"f:uid":{}}}},"f:spec":{"f:podManagementPolicy":{},"f:replicas":{},"f:revisionHistoryLimit":{},"f:selector":{"f:matchLabels":{".":{},"f:app.kubernetes.io/name":{}}},"f:serviceName":{},"f:template":{"f:metadata":{"f:annotations":{".":{},"f:prometheus.io/port":{},"f:prometheus.io/scrape":{}},"f:labels":{".":{},"f:app.kubernetes.io/component":{},"f:app.kubernetes.io/name":{},"f:app.kubernetes.io/part-of":{}}},"f:spec":{"f:automountServiceAccountToken":{},"f:containers":{"k:{\"name\":\"rabbitmq\"}":{".":{},"f:env":{".":{},"k:{\"name\":\"K8S_HOSTNAME_SUFFIX\"}":{".":{},"f:name":{},"f:value":{}},"k:{\"name\":\"K8S_SERVICE_NAME\"}":{".":{},"f:name":{},"f:value":{}},"k:{\"name\":\"MY_POD_NAME\"}":{".":{},"f:name":{},"f:valueFrom":{".":{},"f:fieldRef":{".":{},"f:apiVersion":{},"f:fieldPath":{}}}},"k:{\"name\":\"MY_POD_NAMESPACE\"}":{".":{},"f:name":{},"f:valueFrom":{".":{},"f:fieldRef":{".":{},"f:apiVersion":{},"f:fieldPath":{}}}},"k:{\"name\":\"RABBITMQ_ENABLED_PLUGINS_FILE\"}":{".":{},"f:name":{},"f:value":{}},"k:{\"name\":\"RABBITMQ_NODENAME\"}":{".":{},"f:name":{},"f:value":{}},"k:{\"name\":\"RABBITMQ_USE_LONGNAME\"}":{".":{},"f:name":{},"f:value":{}}},"f:image":{},"f:imagePullPolicy":{},"f:lifecycle":{".":{},"f:preStop":{".":{},"f:exec":{".":{},"f:command":{}}}},"f:name":{},"f:ports":{".":{},"k:{\"containerPort\":4369,\"protocol\":\"TCP\"}":{".":{},"f:containerPort":{},"f:name":{},"f:protocol":{}},"k:{\"containerPort\":5672,\"protocol\":\"TCP\"}":{".":{},"f:containerPort":{},"f:name":{},"f:protocol":{}},"k:{\"containerPort\":15672,\"protocol\":\"TCP\"}":{".":{},"f:containerPort":{},"f:name":{},"f:protocol":{}},"k:{\"containerPort\":15692,\"protocol\":\"TCP\"}":{".":{},"f:containerPort":{},"f:name":{},"f:protocol":{}}},"f:readinessProbe":{".":{},"f:failureThreshold":{},"f:initialDelaySeconds":{},"f:periodSeconds":{},"f:successThreshold":{},"f:tcpSocket":{".":{},"f:port":{}},"f:timeoutSeconds":{}},"f:resources":{".":{},"f:limits":{".":{},"f:cpu":{},"f:memory":{}},"f:requests":{".":{},"f:cpu":{},"f:memory":{}}},"f:terminationMessagePath":{},"f:terminationMessagePolicy":{},"f:volumeMounts":{".":{},"k:{\"mountPath\":\"/etc/pod-info/\"}":{".":{},"f:mountPath":{},"f:name":{}},"k:{\"mountPath\":\"/etc/rabbitmq/conf.d/10-operatorDefaults.conf\"}":{".":{},"f:mountPath":{},"f:name":{},"f:subPath":{}},"k:{\"mountPath\":\"/etc/rabbitmq/conf.d/11-default_user.conf\"}":{".":{},"f:mountPath":{},"f:name":{},"f:subPath":{}},"k:{\"mountPath\":\"/etc/rabbitmq/conf.d/90-userDefinedConfiguration.conf\"}":{".":{},"f:mountPath":{},"f:name":{},"f:subPath":{}},"k:{\"mountPath\":\"/operator\"}":{".":{},"f:mountPath":{},"f:name":{}},"k:{\"mountPath\":\"/var/lib/rabbitmq/\"}":{".":{},"f:mountPath":{},"f:name":{}},"k:{\"mountPath\":\"/var/lib/rabbitmq/mnesia/\"}":{".":{},"f:mountPath":{},"f:name":{}}}}},"f:dnsPolicy":{},"f:initContainers":{".":{},"k:{\"name\":\"setup-container\"}":{".":{},"f:command":{},"f:image":{},"f:imagePullPolicy":{},"f:name":{},"f:resources":{".":{},"f:limits":{".":{},"f:cpu":{},"f:memory":{}},"f:requests":{".":{},"f:cpu":{},"f:memory":{}}},"f:securityContext":{".":{},"f:capabilities":{".":{},"f:drop":{}},"f:runAsUser":{}},"f:terminationMessagePath":{},"f:terminationMessagePolicy":{},"f:volumeMounts":{".":{},"k:{\"mountPath\":\"/operator\"}":{".":{},"f:mountPath":{},"f:name":{}},"k:{\"mountPath\":\"/tmp/default_user.conf\"}":{".":{},"f:mountPath":{},"f:name":{},"f:subPath":{}},"k:{\"mountPath\":\"/tmp/erlang-cookie-secret/\"}":{".":{},"f:mountPath":{},"f:name":{}},"k:{\"mountPath\":\"/tmp/rabbitmq-plugins/\"}":{".":{},"f:mountPath":{},"f:name":{}},"k:{\"mountPath\":\"/var/lib/rabbitmq/\"}":{".":{},"f:mountPath":{},"f:name":{}},"k:{\"mountPath\":\"/var/lib/rabbitmq/mnesia/\"}":{".":{},"f:mountPath":{},"f:name":{}}}}},"f:restartPolicy":{},"f:schedulerName":{},"f:securityContext":{".":{},"f:fsGroup":{},"f:runAsGroup":{},"f:runAsUser":{}},"f:serviceAccount":{},"f:serviceAccountName":{},"f:terminationGracePeriodSeconds":{},"f:topologySpreadConstraints":{".":{},"k:{\"topologyKey\":\"topology.kubernetes.io/zone\",\"whenUnsatisfiable\":\"ScheduleAnyway\"}":{".":{},"f:labelSelector":{".":{},"f:matchLabels":{".":{},"f:app.kubernetes.io/name":{}}},"f:maxSkew":{},"f:topologyKey":{},"f:whenUnsatisfiable":{}}},"f:volumes":{".":{},"k:{\"name\":\"erlang-cookie-secret\"}":{".":{},"f:name":{},"f:secret":{".":{},"f:defaultMode":{},"f:secretName":{}}},"k:{\"name\":\"plugins-conf\"}":{".":{},"f:configMap":{".":{},"f:defaultMode":{},"f:name":{}},"f:name":{}},"k:{\"name\":\"pod-info\"}":{".":{},"f:downwardAPI":{".":{},"f:defaultMode":{},"f:items":{}},"f:name":{}},"k:{\"name\":\"rabbitmq-confd\"}":{".":{},"f:name":{},"f:projected":{".":{},"f:defaultMode":{},"f:sources":{}}},"k:{\"name\":\"rabbitmq-erlang-cookie\"}":{".":{},"f:emptyDir":{},"f:name":{}},"k:{\"name\":\"rabbitmq-plugins\"}":{".":{},"f:emptyDir":{},"f:name":{}}}}},"f:updateStrategy":{"f:rollingUpdate":{".":{},"f:partition":{}},"f:type":{}},"f:volumeClaimTemplates":{}}}}]},"spec":{"replicas":1,"selector":{"matchLabels":{"app.kubernetes.io/name":"rabbitmq-cluster"}},"template":{"metadata":{"creationTimestamp":null,"labels":{"app.kubernetes.io/component":"rabbitmq","app.kubernetes.io/name":"rabbitmq-cluster","app.kubernetes.io/part-of":"rabbitmq"},"annotations":{"prometheus.io/port":"15692","prometheus.io/scrape":"true"}},"spec":{"volumes":[{"name":"plugins-conf","configMap":{"name":"rabbitmq-cluster-plugins-conf","defaultMode":420}},{"name":"rabbitmq-confd","projected":{"sources":[{"secret":{"name":"rabbitmq-cluster-default-user","items":[{"key":"default_user.conf","path":"default_user.conf"}]}},{"configMap":{"name":"rabbitmq-cluster-server-conf","items":[{"key":"operatorDefaults.conf","path":"operatorDefaults.conf"},{"key":"userDefinedConfiguration.conf","path":"userDefinedConfiguration.conf"}]}}],"defaultMode":420}},{"name":"rabbitmq-erlang-cookie","emptyDir":{}},{"name":"erlang-cookie-secret","secret":{"secretName":"rabbitmq-cluster-erlang-cookie","defaultMode":420}},{"name":"rabbitmq-plugins","emptyDir":{}},{"name":"pod-info","downwardAPI":{"items":[{"path":"skipPreStopChecks","fieldRef":{"apiVersion":"v1","fieldPath":"metadata.labels['skipPreStopChecks']"}}],"defaultMode":420}}],"initContainers":[{"name":"setup-container","image":"rabbitmq:3.8.12-management","command":["sh","-c","cp /tmp/erlang-cookie-secret/.erlang.cookie /var/lib/rabbitmq/.erlang.cookie \u0026\u0026 chown 999:999 /var/lib/rabbitmq/.erlang.cookie \u0026\u0026 chmod 600 /var/lib/rabbitmq/.erlang.cookie ; cp /tmp/rabbitmq-plugins/enabled_plugins /operator/enabled_plugins \u0026\u0026 chown 999:999 /operator/enabled_plugins ; chown 999:999 /var/lib/rabbitmq/mnesia/ ; echo '[default]' \u003e /var/lib/rabbitmq/.rabbitmqadmin.conf \u0026\u0026 sed -e 's/default_user/username/' -e 's/default_pass/password/' /tmp/default_user.conf \u003e\u003e /var/lib/rabbitmq/.rabbitmqadmin.conf \u0026\u0026 chown 999:999 /var/lib/rabbitmq/.rabbitmqadmin.conf \u0026\u0026 chmod 600 /var/lib/rabbitmq/.rabbitmqadmin.conf"],"resources":{"limits":{"cpu":"100m","memory":"500Mi"},"requests":{"cpu":"100m","memory":"500Mi"}},"volumeMounts":[{"name":"plugins-conf","mountPath":"/tmp/rabbitmq-plugins/"},{"name":"rabbitmq-erlang-cookie","mountPath":"/var/lib/rabbitmq/"},{"name":"erlang-cookie-secret","mountPath":"/tmp/erlang-cookie-secret/"},{"name":"rabbitmq-plugins","mountPath":"/operator"},{"name":"persistence","mountPath":"/var/lib/rabbitmq/mnesia/"},{"name":"rabbitmq-confd","mountPath":"/tmp/default_user.conf","subPath":"default_user.conf"}],"terminationMessagePath":"/dev/termination-log","terminationMessagePolicy":"File","imagePullPolicy":"IfNotPresent","securityContext":{"capabilities":{"drop":["FSETID","KILL","SETGID","SETUID","SETPCAP","NET_BIND_SERVICE","NET_RAW","SYS_CHROOT","MKNOD","AUDIT_WRITE","SETFCAP"]},"runAsUser":0}}],"containers":[{"name":"rabbitmq","image":"rabbitmq:3.8.12-management","ports":[{"name":"epmd","containerPort":4369,"protocol":"TCP"},{"name":"amqp","containerPort":5672,"protocol":"TCP"},{"name":"management","containerPort":15672,"protocol":"TCP"},{"name":"prometheus","containerPort":15692,"protocol":"TCP"}],"env":[{"name":"MY_POD_NAME","valueFrom":{"fieldRef":{"apiVersion":"v1","fieldPath":"metadata.name"}}},{"name":"MY_POD_NAMESPACE","valueFrom":{"fieldRef":{"apiVersion":"v1","fieldPath":"metadata.namespace"}}},{"name":"RABBITMQ_ENABLED_PLUGINS_FILE","value":"/operator/enabled_plugins"},{"name":"K8S_SERVICE_NAME","value":"rabbitmq-cluster-nodes"},{"name":"RABBITMQ_USE_LONGNAME","value":"true"},{"name":"RABBITMQ_NODENAME","value":"rabbit@$(MY_POD_NAME).$(K8S_SERVICE_NAME).$(MY_POD_NAMESPACE)"},{"name":"K8S_HOSTNAME_SUFFIX","value":".$(K8S_SERVICE_NAME).$(MY_POD_NAMESPACE)"}],"resources":{"limits":{"cpu":"2","memory":"2Gi"},"requests":{"cpu":"1","memory":"2Gi"}},"volumeMounts":[{"name":"rabbitmq-erlang-cookie","mountPath":"/var/lib/rabbitmq/"},{"name":"persistence","mountPath":"/var/lib/rabbitmq/mnesia/"},{"name":"rabbitmq-plugins","mountPath":"/operator"},{"name":"rabbitmq-confd","mountPath":"/etc/rabbitmq/conf.d/10-operatorDefaults.conf","subPath":"operatorDefaults.conf"},{"name":"rabbitmq-confd","mountPath":"/etc/rabbitmq/conf.d/11-default_user.conf","subPath":"default_user.conf"},{"name":"rabbitmq-confd","mountPath":"/etc/rabbitmq/conf.d/90-userDefinedConfiguration.conf","subPath":"userDefinedConfiguration.conf"},{"name":"pod-info","mountPath":"/etc/pod-info/"}],"readinessProbe":{"tcpSocket":{"port":"amqp"},"initialDelaySeconds":10,"timeoutSeconds":5,"periodSeconds":10,"successThreshold":1,"failureThreshold":3},"lifecycle":{"preStop":{"exec":{"command":["/bin/bash","-c","if [ ! -z \"$(cat /etc/pod-info/skipPreStopChecks)\" ]; then exit 0; fi; rabbitmq-upgrade await_online_quorum_plus_one -t 604800; rabbitmq-upgrade await_online_synchronized_mirror -t 604800; rabbitmq-upgrade drain -t 604800"]}}},"terminationMessagePath":"/dev/termination-log","terminationMessagePolicy":"File","imagePullPolicy":"IfNotPresent"}],"restartPolicy":"Always","terminationGracePeriodSeconds":604800,"dnsPolicy":"ClusterFirst","serviceAccountName":"rabbitmq-cluster-server","serviceAccount":"rabbitmq-cluster-server","automountServiceAccountToken":true,"securityContext":{"runAsUser":999,"runAsGroup":999,"fsGroup":999},"schedulerName":"default-scheduler","topologySpreadConstraints":[{"maxSkew":1,"topologyKey":"topology.kubernetes.io/zone","whenUnsatisfiable":"ScheduleAnyway","labelSelector":{"matchLabels":{"app.kubernetes.io/name":"rabbitmq-cluster"}}}]}},"volumeClaimTemplates":[{"metadata":{"name":"persistence","namespace":"default","creationTimestamp":null,"labels":{"app.kubernetes.io/component":"rabbitmq","app.kubernetes.io/name":"rabbitmq-cluster","app.kubernetes.io/part-of":"rabbitmq"},"ownerReferences":[{"apiVersion":"rabbitmq.com/v1beta1","kind":"RabbitmqCluster","name":"rabbitmq-cluster","uid":"18d9928b-0d1c-47be-80ec-20960d053827","controller":true,"blockOwnerDeletion":false}]},"spec":{"accessModes":["ReadWriteOnce"],"resources":{"requests":{"storage":"10Gi"}},"volumeMode":"Filesystem"},"status":{"phase":"Pending"}}],"serviceName":"rabbitmq-cluster-nodes","podManagementPolicy":"Parallel","updateStrategy":{"type":"RollingUpdate","rollingUpdate":{"partition":0}},"revisionHistoryLimit":10},"status":{"observedGeneration":1,"replicas":1,"currentReplicas":1,"updatedReplicas":1,"currentRevision":"rabbitmq-cluster-server-5f8b8665fb","updateRevision":"rabbitmq-cluster-server-5f8b8665fb","collisionCount":0}}
2022/03/18 18:00:38 learn_server.go:256: [SIEVE-BEFORE-WRITE]	13
2022/03/18 18:00:38 learn_server.go:279: [SIEVE-BEFORE-HEAR]	15	Updated	statefulset	{"metadata":{"name":"rabbitmq-cluster-server","namespace":"default","selfLink":"/apis/apps/v1/namespaces/default/statefulsets/rabbitmq-cluster-server","uid":"cb5c43bc-6ee7-481c-ab01-6f3acffdd3c8","resourceVersion":"744","generation":1,"creationTimestamp":"2022-03-18T18:00:38Z","labels":{"app.kubernetes.io/component":"rabbitmq","app.kubernetes.io/name":"rabbitmq-cluster","app.kubernetes.io/part-of":"rabbitmq"},"annotations":{"rabbitmq.com/createdAt":"2022-03-18T18:00:38Z"},"ownerReferences":[{"apiVersion":"rabbitmq.com/v1beta1","kind":"RabbitmqCluster","name":"rabbitmq-cluster","uid":"18d9928b-0d1c-47be-80ec-20960d053827","controller":true,"blockOwnerDeletion":true}],"managedFields":[{"manager":"kube-controller-manager","operation":"Update","apiVersion":"apps/v1","time":"2022-03-18T18:00:38Z","fieldsType":"FieldsV1","fieldsV1":{"f:status":{"f:collisionCount":{},"f:currentReplicas":{},"f:currentRevision":{},"f:observedGeneration":{},"f:replicas":{},"f:updateRevision":{},"f:updatedReplicas":{}}}},{"manager":"manager","operation":"Update","apiVersion":"apps/v1","time":"2022-03-18T18:00:38Z","fieldsType":"FieldsV1","fieldsV1":{"f:metadata":{"f:annotations":{".":{},"f:rabbitmq.com/createdAt":{}},"f:labels":{".":{},"f:app.kubernetes.io/component":{},"f:app.kubernetes.io/name":{},"f:app.kubernetes.io/part-of":{}},"f:ownerReferences":{".":{},"k:{\"uid\":\"18d9928b-0d1c-47be-80ec-20960d053827\"}":{".":{},"f:apiVersion":{},"f:blockOwnerDeletion":{},"f:controller":{},"f:kind":{},"f:name":{},"f:uid":{}}}},"f:spec":{"f:podManagementPolicy":{},"f:replicas":{},"f:revisionHistoryLimit":{},"f:selector":{"f:matchLabels":{".":{},"f:app.kubernetes.io/name":{}}},"f:serviceName":{},"f:template":{"f:metadata":{"f:annotations":{".":{},"f:prometheus.io/port":{},"f:prometheus.io/scrape":{}},"f:labels":{".":{},"f:app.kubernetes.io/component":{},"f:app.kubernetes.io/name":{},"f:app.kubernetes.io/part-of":{}}},"f:spec":{"f:automountServiceAccountToken":{},"f:containers":{"k:{\"name\":\"rabbitmq\"}":{".":{},"f:env":{".":{},"k:{\"name\":\"K8S_HOSTNAME_SUFFIX\"}":{".":{},"f:name":{},"f:value":{}},"k:{\"name\":\"K8S_SERVICE_NAME\"}":{".":{},"f:name":{},"f:value":{}},"k:{\"name\":\"MY_POD_NAME\"}":{".":{},"f:name":{},"f:valueFrom":{".":{},"f:fieldRef":{".":{},"f:apiVersion":{},"f:fieldPath":{}}}},"k:{\"name\":\"MY_POD_NAMESPACE\"}":{".":{},"f:name":{},"f:valueFrom":{".":{},"f:fieldRef":{".":{},"f:apiVersion":{},"f:fieldPath":{}}}},"k:{\"name\":\"RABBITMQ_ENABLED_PLUGINS_FILE\"}":{".":{},"f:name":{},"f:value":{}},"k:{\"name\":\"RABBITMQ_NODENAME\"}":{".":{},"f:name":{},"f:value":{}},"k:{\"name\":\"RABBITMQ_USE_LONGNAME\"}":{".":{},"f:name":{},"f:value":{}}},"f:image":{},"f:imagePullPolicy":{},"f:lifecycle":{".":{},"f:preStop":{".":{},"f:exec":{".":{},"f:command":{}}}},"f:name":{},"f:ports":{".":{},"k:{\"containerPort\":4369,\"protocol\":\"TCP\"}":{".":{},"f:containerPort":{},"f:name":{},"f:protocol":{}},"k:{\"containerPort\":5672,\"protocol\":\"TCP\"}":{".":{},"f:containerPort":{},"f:name":{},"f:protocol":{}},"k:{\"containerPort\":15672,\"protocol\":\"TCP\"}":{".":{},"f:containerPort":{},"f:name":{},"f:protocol":{}},"k:{\"containerPort\":15692,\"protocol\":\"TCP\"}":{".":{},"f:containerPort":{},"f:name":{},"f:protocol":{}}},"f:readinessProbe":{".":{},"f:failureThreshold":{},"f:initialDelaySeconds":{},"f:periodSeconds":{},"f:successThreshold":{},"f:tcpSocket":{".":{},"f:port":{}},"f:timeoutSeconds":{}},"f:resources":{".":{},"f:limits":{".":{},"f:cpu":{},"f:memory":{}},"f:requests":{".":{},"f:cpu":{},"f:memory":{}}},"f:terminationMessagePath":{},"f:terminationMessagePolicy":{},"f:volumeMounts":{".":{},"k:{\"mountPath\":\"/etc/pod-info/\"}":{".":{},"f:mountPath":{},"f:name":{}},"k:{\"mountPath\":\"/etc/rabbitmq/conf.d/10-operatorDefaults.conf\"}":{".":{},"f:mountPath":{},"f:name":{},"f:subPath":{}},"k:{\"mountPath\":\"/etc/rabbitmq/conf.d/11-default_user.conf\"}":{".":{},"f:mountPath":{},"f:name":{},"f:subPath":{}},"k:{\"mountPath\":\"/etc/rabbitmq/conf.d/90-userDefinedConfiguration.conf\"}":{".":{},"f:mountPath":{},"f:name":{},"f:subPath":{}},"k:{\"mountPath\":\"/operator\"}":{".":{},"f:mountPath":{},"f:name":{}},"k:{\"mountPath\":\"/var/lib/rabbitmq/\"}":{".":{},"f:mountPath":{},"f:name":{}},"k:{\"mountPath\":\"/var/lib/rabbitmq/mnesia/\"}":{".":{},"f:mountPath":{},"f:name":{}}}}},"f:dnsPolicy":{},"f:initContainers":{".":{},"k:{\"name\":\"setup-container\"}":{".":{},"f:command":{},"f:image":{},"f:imagePullPolicy":{},"f:name":{},"f:resources":{".":{},"f:limits":{".":{},"f:cpu":{},"f:memory":{}},"f:requests":{".":{},"f:cpu":{},"f:memory":{}}},"f:securityContext":{".":{},"f:capabilities":{".":{},"f:drop":{}},"f:runAsUser":{}},"f:terminationMessagePath":{},"f:terminationMessagePolicy":{},"f:volumeMounts":{".":{},"k:{\"mountPath\":\"/operator\"}":{".":{},"f:mountPath":{},"f:name":{}},"k:{\"mountPath\":\"/tmp/default_user.conf\"}":{".":{},"f:mountPath":{},"f:name":{},"f:subPath":{}},"k:{\"mountPath\":\"/tmp/erlang-cookie-secret/\"}":{".":{},"f:mountPath":{},"f:name":{}},"k:{\"mountPath\":\"/tmp/rabbitmq-plugins/\"}":{".":{},"f:mountPath":{},"f:name":{}},"k:{\"mountPath\":\"/var/lib/rabbitmq/\"}":{".":{},"f:mountPath":{},"f:name":{}},"k:{\"mountPath\":\"/var/lib/rabbitmq/mnesia/\"}":{".":{},"f:mountPath":{},"f:name":{}}}}},"f:restartPolicy":{},"f:schedulerName":{},"f:securityContext":{".":{},"f:fsGroup":{},"f:runAsGroup":{},"f:runAsUser":{}},"f:serviceAccount":{},"f:serviceAccountName":{},"f:terminationGracePeriodSeconds":{},"f:topologySpreadConstraints":{".":{},"k:{\"topologyKey\":\"topology.kubernetes.io/zone\",\"whenUnsatisfiable\":\"ScheduleAnyway\"}":{".":{},"f:labelSelector":{".":{},"f:matchLabels":{".":{},"f:app.kubernetes.io/name":{}}},"f:maxSkew":{},"f:topologyKey":{},"f:whenUnsatisfiable":{}}},"f:volumes":{".":{},"k:{\"name\":\"erlang-cookie-secret\"}":{".":{},"f:name":{},"f:secret":{".":{},"f:defaultMode":{},"f:secretName":{}}},"k:{\"name\":\"plugins-conf\"}":{".":{},"f:configMap":{".":{},"f:defaultMode":{},"f:name":{}},"f:name":{}},"k:{\"name\":\"pod-info\"}":{".":{},"f:downwardAPI":{".":{},"f:defaultMode":{},"f:items":{}},"f:name":{}},"k:{\"name\":\"rabbitmq-confd\"}":{".":{},"f:name":{},"f:projected":{".":{},"f:defaultMode":{},"f:sources":{}}},"k:{\"name\":\"rabbitmq-erlang-cookie\"}":{".":{},"f:emptyDir":{},"f:name":{}},"k:{\"name\":\"rabbitmq-plugins\"}":{".":{},"f:emptyDir":{},"f:name":{}}}}},"f:updateStrategy":{"f:rollingUpdate":{".":{},"f:partition":{}},"f:type":{}},"f:volumeClaimTemplates":{}}}}]},"spec":{"replicas":1,"selector":{"matchLabels":{"app.kubernetes.io/name":"rabbitmq-cluster"}},"template":{"metadata":{"creationTimestamp":null,"labels":{"app.kubernetes.io/component":"rabbitmq","app.kubernetes.io/name":"rabbitmq-cluster","app.kubernetes.io/part-of":"rabbitmq"},"annotations":{"prometheus.io/port":"15692","prometheus.io/scrape":"true"}},"spec":{"volumes":[{"name":"plugins-conf","configMap":{"name":"rabbitmq-cluster-plugins-conf","defaultMode":420}},{"name":"rabbitmq-confd","projected":{"sources":[{"secret":{"name":"rabbitmq-cluster-default-user","items":[{"key":"default_user.conf","path":"default_user.conf"}]}},{"configMap":{"name":"rabbitmq-cluster-server-conf","items":[{"key":"operatorDefaults.conf","path":"operatorDefaults.conf"},{"key":"userDefinedConfiguration.conf","path":"userDefinedConfiguration.conf"}]}}],"defaultMode":420}},{"name":"rabbitmq-erlang-cookie","emptyDir":{}},{"name":"erlang-cookie-secret","secret":{"secretName":"rabbitmq-cluster-erlang-cookie","defaultMode":420}},{"name":"rabbitmq-plugins","emptyDir":{}},{"name":"pod-info","downwardAPI":{"items":[{"path":"skipPreStopChecks","fieldRef":{"apiVersion":"v1","fieldPath":"metadata.labels['skipPreStopChecks']"}}],"defaultMode":420}}],"initContainers":[{"name":"setup-container","image":"rabbitmq:3.8.12-management","command":["sh","-c","cp /tmp/erlang-cookie-secret/.erlang.cookie /var/lib/rabbitmq/.erlang.cookie \u0026\u0026 chown 999:999 /var/lib/rabbitmq/.erlang.cookie \u0026\u0026 chmod 600 /var/lib/rabbitmq/.erlang.cookie ; cp /tmp/rabbitmq-plugins/enabled_plugins /operator/enabled_plugins \u0026\u0026 chown 999:999 /operator/enabled_plugins ; chown 999:999 /var/lib/rabbitmq/mnesia/ ; echo '[default]' \u003e /var/lib/rabbitmq/.rabbitmqadmin.conf \u0026\u0026 sed -e 's/default_user/username/' -e 's/default_pass/password/' /tmp/default_user.conf \u003e\u003e /var/lib/rabbitmq/.rabbitmqadmin.conf \u0026\u0026 chown 999:999 /var/lib/rabbitmq/.rabbitmqadmin.conf \u0026\u0026 chmod 600 /var/lib/rabbitmq/.rabbitmqadmin.conf"],"resources":{"limits":{"cpu":"100m","memory":"500Mi"},"requests":{"cpu":"100m","memory":"500Mi"}},"volumeMounts":[{"name":"plugins-conf","mountPath":"/tmp/rabbitmq-plugins/"},{"name":"rabbitmq-erlang-cookie","mountPath":"/var/lib/rabbitmq/"},{"name":"erlang-cookie-secret","mountPath":"/tmp/erlang-cookie-secret/"},{"name":"rabbitmq-plugins","mountPath":"/operator"},{"name":"persistence","mountPath":"/var/lib/rabbitmq/mnesia/"},{"name":"rabbitmq-confd","mountPath":"/tmp/default_user.conf","subPath":"default_user.conf"}],"terminationMessagePath":"/dev/termination-log","terminationMessagePolicy":"File","imagePullPolicy":"IfNotPresent","securityContext":{"capabilities":{"drop":["FSETID","KILL","SETGID","SETUID","SETPCAP","NET_BIND_SERVICE","NET_RAW","SYS_CHROOT","MKNOD","AUDIT_WRITE","SETFCAP"]},"runAsUser":0}}],"containers":[{"name":"rabbitmq","image":"rabbitmq:3.8.12-management","ports":[{"name":"epmd","containerPort":4369,"protocol":"TCP"},{"name":"amqp","containerPort":5672,"protocol":"TCP"},{"name":"management","containerPort":15672,"protocol":"TCP"},{"name":"prometheus","containerPort":15692,"protocol":"TCP"}],"env":[{"name":"MY_POD_NAME","valueFrom":{"fieldRef":{"apiVersion":"v1","fieldPath":"metadata.name"}}},{"name":"MY_POD_NAMESPACE","valueFrom":{"fieldRef":{"apiVersion":"v1","fieldPath":"metadata.namespace"}}},{"name":"RABBITMQ_ENABLED_PLUGINS_FILE","value":"/operator/enabled_plugins"},{"name":"K8S_SERVICE_NAME","value":"rabbitmq-cluster-nodes"},{"name":"RABBITMQ_USE_LONGNAME","value":"true"},{"name":"RABBITMQ_NODENAME","value":"rabbit@$(MY_POD_NAME).$(K8S_SERVICE_NAME).$(MY_POD_NAMESPACE)"},{"name":"K8S_HOSTNAME_SUFFIX","value":".$(K8S_SERVICE_NAME).$(MY_POD_NAMESPACE)"}],"resources":{"limits":{"cpu":"2","memory":"2Gi"},"requests":{"cpu":"1","memory":"2Gi"}},"volumeMounts":[{"name":"rabbitmq-erlang-cookie","mountPath":"/var/lib/rabbitmq/"},{"name":"persistence","mountPath":"/var/lib/rabbitmq/mnesia/"},{"name":"rabbitmq-plugins","mountPath":"/operator"},{"name":"rabbitmq-confd","mountPath":"/etc/rabbitmq/conf.d/10-operatorDefaults.conf","subPath":"operatorDefaults.conf"},{"name":"rabbitmq-confd","mountPath":"/etc/rabbitmq/conf.d/11-default_user.conf","subPath":"default_user.conf"},{"name":"rabbitmq-confd","mountPath":"/etc/rabbitmq/conf.d/90-userDefinedConfiguration.conf","subPath":"userDefinedConfiguration.conf"},{"name":"pod-info","mountPath":"/etc/pod-info/"}],"readinessProbe":{"tcpSocket":{"port":"amqp"},"initialDelaySeconds":10,"timeoutSeconds":5,"periodSeconds":10,"successThreshold":1,"failureThreshold":3},"lifecycle":{"preStop":{"exec":{"command":["/bin/bash","-c","if [ ! -z \"$(cat /etc/pod-info/skipPreStopChecks)\" ]; then exit 0; fi; rabbitmq-upgrade await_online_quorum_plus_one -t 604800; rabbitmq-upgrade await_online_synchronized_mirror -t 604800; rabbitmq-upgrade drain -t 604800"]}}},"terminationMessagePath":"/dev/termination-log","terminationMessagePolicy":"File","imagePullPolicy":"IfNotPresent"}],"restartPolicy":"Always","terminationGracePeriodSeconds":604800,"dnsPolicy":"ClusterFirst","serviceAccountName":"rabbitmq-cluster-server","serviceAccount":"rabbitmq-cluster-server","automountServiceAccountToken":true,"securityContext":{"runAsUser":999,"runAsGroup":999,"fsGroup":999},"schedulerName":"default-scheduler","topologySpreadConstraints":[{"maxSkew":1,"topologyKey":"topology.kubernetes.io/zone","whenUnsatisfiable":"ScheduleAnyway","labelSelector":{"matchLabels":{"app.kubernetes.io/name":"rabbitmq-cluster"}}}]}},"volumeClaimTemplates":[{"metadata":{"name":"persistence","namespace":"default","creationTimestamp":null,"labels":{"app.kubernetes.io/component":"rabbitmq","app.kubernetes.io/name":"rabbitmq-cluster","app.kubernetes.io/part-of":"rabbitmq"},"ownerReferences":[{"apiVersion":"rabbitmq.com/v1beta1","kind":"RabbitmqCluster","name":"rabbitmq-cluster","uid":"18d9928b-0d1c-47be-80ec-20960d053827","controller":true,"blockOwnerDeletion":false}]},"spec":{"accessModes":["ReadWriteOnce"],"resources":{"requests":{"storage":"10Gi"}},"volumeMode":"Filesystem"},"status":{"phase":"Pending"}}],"serviceName":"rabbitmq-cluster-nodes","podManagementPolicy":"Parallel","updateStrategy":{"type":"RollingUpdate","rollingUpdate":{"partition":0}},"revisionHistoryLimit":10},"status":{"observedGeneration":1,"replicas":1,"currentReplicas":1,"updatedReplicas":1,"currentRevision":"rabbitmq-cluster-server-5f8b8665fb","updateRevision":"rabbitmq-cluster-server-5f8b8665fb","collisionCount":0}}
2022/03/18 18:00:38 learn_server.go:289: [SIEVE-AFTER-HEAR]	15
2022/03/18 18:00:38 learn_server.go:263: [SIEVE-AFTER-WRITE]	13	Update	statefulset	github.com/rabbitmq/cluster-operator/controllers.(*RabbitmqClusterReconciler)	NoError	{"metadata":{"name":"rabbitmq-cluster-server","namespace":"default","selfLink":"/apis/apps/v1/namespaces/default/statefulsets/rabbitmq-cluster-server","uid":"cb5c43bc-6ee7-481c-ab01-6f3acffdd3c8","resourceVersion":"744","generation":1,"creationTimestamp":"2022-03-18T18:00:38Z","labels":{"app.kubernetes.io/component":"rabbitmq","app.kubernetes.io/name":"rabbitmq-cluster","app.kubernetes.io/part-of":"rabbitmq"},"annotations":{"rabbitmq.com/createdAt":"2022-03-18T18:00:38Z"},"ownerReferences":[{"apiVersion":"rabbitmq.com/v1beta1","kind":"RabbitmqCluster","name":"rabbitmq-cluster","uid":"18d9928b-0d1c-47be-80ec-20960d053827","controller":true,"blockOwnerDeletion":true}],"managedFields":[{"manager":"kube-controller-manager","operation":"Update","apiVersion":"apps/v1","time":"2022-03-18T18:00:38Z","fieldsType":"FieldsV1","fieldsV1":{"f:status":{"f:collisionCount":{},"f:currentReplicas":{},"f:currentRevision":{},"f:observedGeneration":{},"f:replicas":{},"f:updateRevision":{},"f:updatedReplicas":{}}}},{"manager":"manager","operation":"Update","apiVersion":"apps/v1","time":"2022-03-18T18:00:38Z","fieldsType":"FieldsV1","fieldsV1":{"f:metadata":{"f:annotations":{".":{},"f:rabbitmq.com/createdAt":{}},"f:labels":{".":{},"f:app.kubernetes.io/component":{},"f:app.kubernetes.io/name":{},"f:app.kubernetes.io/part-of":{}},"f:ownerReferences":{".":{},"k:{\"uid\":\"18d9928b-0d1c-47be-80ec-20960d053827\"}":{".":{},"f:apiVersion":{},"f:blockOwnerDeletion":{},"f:controller":{},"f:kind":{},"f:name":{},"f:uid":{}}}},"f:spec":{"f:podManagementPolicy":{},"f:replicas":{},"f:revisionHistoryLimit":{},"f:selector":{"f:matchLabels":{".":{},"f:app.kubernetes.io/name":{}}},"f:serviceName":{},"f:template":{"f:metadata":{"f:annotations":{".":{},"f:prometheus.io/port":{},"f:prometheus.io/scrape":{}},"f:labels":{".":{},"f:app.kubernetes.io/component":{},"f:app.kubernetes.io/name":{},"f:app.kubernetes.io/part-of":{}}},"f:spec":{"f:automountServiceAccountToken":{},"f:containers":{"k:{\"name\":\"rabbitmq\"}":{".":{},"f:env":{".":{},"k:{\"name\":\"K8S_HOSTNAME_SUFFIX\"}":{".":{},"f:name":{},"f:value":{}},"k:{\"name\":\"K8S_SERVICE_NAME\"}":{".":{},"f:name":{},"f:value":{}},"k:{\"name\":\"MY_POD_NAME\"}":{".":{},"f:name":{},"f:valueFrom":{".":{},"f:fieldRef":{".":{},"f:apiVersion":{},"f:fieldPath":{}}}},"k:{\"name\":\"MY_POD_NAMESPACE\"}":{".":{},"f:name":{},"f:valueFrom":{".":{},"f:fieldRef":{".":{},"f:apiVersion":{},"f:fieldPath":{}}}},"k:{\"name\":\"RABBITMQ_ENABLED_PLUGINS_FILE\"}":{".":{},"f:name":{},"f:value":{}},"k:{\"name\":\"RABBITMQ_NODENAME\"}":{".":{},"f:name":{},"f:value":{}},"k:{\"name\":\"RABBITMQ_USE_LONGNAME\"}":{".":{},"f:name":{},"f:value":{}}},"f:image":{},"f:imagePullPolicy":{},"f:lifecycle":{".":{},"f:preStop":{".":{},"f:exec":{".":{},"f:command":{}}}},"f:name":{},"f:ports":{".":{},"k:{\"containerPort\":4369,\"protocol\":\"TCP\"}":{".":{},"f:containerPort":{},"f:name":{},"f:protocol":{}},"k:{\"containerPort\":5672,\"protocol\":\"TCP\"}":{".":{},"f:containerPort":{},"f:name":{},"f:protocol":{}},"k:{\"containerPort\":15672,\"protocol\":\"TCP\"}":{".":{},"f:containerPort":{},"f:name":{},"f:protocol":{}},"k:{\"containerPort\":15692,\"protocol\":\"TCP\"}":{".":{},"f:containerPort":{},"f:name":{},"f:protocol":{}}},"f:readinessProbe":{".":{},"f:failureThreshold":{},"f:initialDelaySeconds":{},"f:periodSeconds":{},"f:successThreshold":{},"f:tcpSocket":{".":{},"f:port":{}},"f:timeoutSeconds":{}},"f:resources":{".":{},"f:limits":{".":{},"f:cpu":{},"f:memory":{}},"f:requests":{".":{},"f:cpu":{},"f:memory":{}}},"f:terminationMessagePath":{},"f:terminationMessagePolicy":{},"f:volumeMounts":{".":{},"k:{\"mountPath\":\"/etc/pod-info/\"}":{".":{},"f:mountPath":{},"f:name":{}},"k:{\"mountPath\":\"/etc/rabbitmq/conf.d/10-operatorDefaults.conf\"}":{".":{},"f:mountPath":{},"f:name":{},"f:subPath":{}},"k:{\"mountPath\":\"/etc/rabbitmq/conf.d/11-default_user.conf\"}":{".":{},"f:mountPath":{},"f:name":{},"f:subPath":{}},"k:{\"mountPath\":\"/etc/rabbitmq/conf.d/90-userDefinedConfiguration.conf\"}":{".":{},"f:mountPath":{},"f:name":{},"f:subPath":{}},"k:{\"mountPath\":\"/operator\"}":{".":{},"f:mountPath":{},"f:name":{}},"k:{\"mountPath\":\"/var/lib/rabbitmq/\"}":{".":{},"f:mountPath":{},"f:name":{}},"k:{\"mountPath\":\"/var/lib/rabbitmq/mnesia/\"}":{".":{},"f:mountPath":{},"f:name":{}}}}},"f:dnsPolicy":{},"f:initContainers":{".":{},"k:{\"name\":\"setup-container\"}":{".":{},"f:command":{},"f:image":{},"f:imagePullPolicy":{},"f:name":{},"f:resources":{".":{},"f:limits":{".":{},"f:cpu":{},"f:memory":{}},"f:requests":{".":{},"f:cpu":{},"f:memory":{}}},"f:securityContext":{".":{},"f:capabilities":{".":{},"f:drop":{}},"f:runAsUser":{}},"f:terminationMessagePath":{},"f:terminationMessagePolicy":{},"f:volumeMounts":{".":{},"k:{\"mountPath\":\"/operator\"}":{".":{},"f:mountPath":{},"f:name":{}},"k:{\"mountPath\":\"/tmp/default_user.conf\"}":{".":{},"f:mountPath":{},"f:name":{},"f:subPath":{}},"k:{\"mountPath\":\"/tmp/erlang-cookie-secret/\"}":{".":{},"f:mountPath":{},"f:name":{}},"k:{\"mountPath\":\"/tmp/rabbitmq-plugins/\"}":{".":{},"f:mountPath":{},"f:name":{}},"k:{\"mountPath\":\"/var/lib/rabbitmq/\"}":{".":{},"f:mountPath":{},"f:name":{}},"k:{\"mountPath\":\"/var/lib/rabbitmq/mnesia/\"}":{".":{},"f:mountPath":{},"f:name":{}}}}},"f:restartPolicy":{},"f:schedulerName":{},"f:securityContext":{".":{},"f:fsGroup":{},"f:runAsGroup":{},"f:runAsUser":{}},"f:serviceAccount":{},"f:serviceAccountName":{},"f:terminationGracePeriodSeconds":{},"f:topologySpreadConstraints":{".":{},"k:{\"topologyKey\":\"topology.kubernetes.io/zone\",\"whenUnsatisfiable\":\"ScheduleAnyway\"}":{".":{},"f:labelSelector":{".":{},"f:matchLabels":{".":{},"f:app.kubernetes.io/name":{}}},"f:maxSkew":{},"f:topologyKey":{},"f:whenUnsatisfiable":{}}},"f:volumes":{".":{},"k:{\"name\":\"erlang-cookie-secret\"}":{".":{},"f:name":{},"f:secret":{".":{},"f:defaultMode":{},"f:secretName":{}}},"k:{\"name\":\"plugins-conf\"}":{".":{},"f:configMap":{".":{},"f:defaultMode":{},"f:name":{}},"f:name":{}},"k:{\"name\":\"pod-info\"}":{".":{},"f:downwardAPI":{".":{},"f:defaultMode":{},"f:items":{}},"f:name":{}},"k:{\"name\":\"rabbitmq-confd\"}":{".":{},"f:name":{},"f:projected":{".":{},"f:defaultMode":{},"f:sources":{}}},"k:{\"name\":\"rabbitmq-erlang-cookie\"}":{".":{},"f:emptyDir":{},"f:name":{}},"k:{\"name\":\"rabbitmq-plugins\"}":{".":{},"f:emptyDir":{},"f:name":{}}}}},"f:updateStrategy":{"f:rollingUpdate":{".":{},"f:partition":{}},"f:type":{}},"f:volumeClaimTemplates":{}}}}]},"spec":{"replicas":1,"selector":{"matchLabels":{"app.kubernetes.io/name":"rabbitmq-cluster"}},"template":{"metadata":{"creationTimestamp":null,"labels":{"app.kubernetes.io/component":"rabbitmq","app.kubernetes.io/name":"rabbitmq-cluster","app.kubernetes.io/part-of":"rabbitmq"},"annotations":{"prometheus.io/port":"15692","prometheus.io/scrape":"true"}},"spec":{"volumes":[{"name":"plugins-conf","configMap":{"name":"rabbitmq-cluster-plugins-conf","defaultMode":420}},{"name":"rabbitmq-confd","projected":{"sources":[{"secret":{"name":"rabbitmq-cluster-default-user","items":[{"key":"default_user.conf","path":"default_user.conf"}]}},{"configMap":{"name":"rabbitmq-cluster-server-conf","items":[{"key":"operatorDefaults.conf","path":"operatorDefaults.conf"},{"key":"userDefinedConfiguration.conf","path":"userDefinedConfiguration.conf"}]}}],"defaultMode":420}},{"name":"rabbitmq-erlang-cookie","emptyDir":{}},{"name":"erlang-cookie-secret","secret":{"secretName":"rabbitmq-cluster-erlang-cookie","defaultMode":420}},{"name":"rabbitmq-plugins","emptyDir":{}},{"name":"pod-info","downwardAPI":{"items":[{"path":"skipPreStopChecks","fieldRef":{"apiVersion":"v1","fieldPath":"metadata.labels['skipPreStopChecks']"}}],"defaultMode":420}}],"initContainers":[{"name":"setup-container","image":"rabbitmq:3.8.12-management","command":["sh","-c","cp /tmp/erlang-cookie-secret/.erlang.cookie /var/lib/rabbitmq/.erlang.cookie \u0026\u0026 chown 999:999 /var/lib/rabbitmq/.erlang.cookie \u0026\u0026 chmod 600 /var/lib/rabbitmq/.erlang.cookie ; cp /tmp/rabbitmq-plugins/enabled_plugins /operator/enabled_plugins \u0026\u0026 chown 999:999 /operator/enabled_plugins ; chown 999:999 /var/lib/rabbitmq/mnesia/ ; echo '[default]' \u003e /var/lib/rabbitmq/.rabbitmqadmin.conf \u0026\u0026 sed -e 's/default_user/username/' -e 's/default_pass/password/' /tmp/default_user.conf \u003e\u003e /var/lib/rabbitmq/.rabbitmqadmin.conf \u0026\u0026 chown 999:999 /var/lib/rabbitmq/.rabbitmqadmin.conf \u0026\u0026 chmod 600 /var/lib/rabbitmq/.rabbitmqadmin.conf"],"resources":{"limits":{"cpu":"100m","memory":"500Mi"},"requests":{"cpu":"100m","memory":"500Mi"}},"volumeMounts":[{"name":"plugins-conf","mountPath":"/tmp/rabbitmq-plugins/"},{"name":"rabbitmq-erlang-cookie","mountPath":"/var/lib/rabbitmq/"},{"name":"erlang-cookie-secret","mountPath":"/tmp/erlang-cookie-secret/"},{"name":"rabbitmq-plugins","mountPath":"/operator"},{"name":"persistence","mountPath":"/var/lib/rabbitmq/mnesia/"},{"name":"rabbitmq-confd","mountPath":"/tmp/default_user.conf","subPath":"default_user.conf"}],"terminationMessagePath":"/dev/termination-log","terminationMessagePolicy":"File","imagePullPolicy":"IfNotPresent","securityContext":{"capabilities":{"drop":["FSETID","KILL","SETGID","SETUID","SETPCAP","NET_BIND_SERVICE","NET_RAW","SYS_CHROOT","MKNOD","AUDIT_WRITE","SETFCAP"]},"runAsUser":0}}],"containers":[{"name":"rabbitmq","image":"rabbitmq:3.8.12-management","ports":[{"name":"epmd","containerPort":4369,"protocol":"TCP"},{"name":"amqp","containerPort":5672,"protocol":"TCP"},{"name":"management","containerPort":15672,"protocol":"TCP"},{"name":"prometheus","containerPort":15692,"protocol":"TCP"}],"env":[{"name":"MY_POD_NAME","valueFrom":{"fieldRef":{"apiVersion":"v1","fieldPath":"metadata.name"}}},{"name":"MY_POD_NAMESPACE","valueFrom":{"fieldRef":{"apiVersion":"v1","fieldPath":"metadata.namespace"}}},{"name":"RABBITMQ_ENABLED_PLUGINS_FILE","value":"/operator/enabled_plugins"},{"name":"K8S_SERVICE_NAME","value":"rabbitmq-cluster-nodes"},{"name":"RABBITMQ_USE_LONGNAME","value":"true"},{"name":"RABBITMQ_NODENAME","value":"rabbit@$(MY_POD_NAME).$(K8S_SERVICE_NAME).$(MY_POD_NAMESPACE)"},{"name":"K8S_HOSTNAME_SUFFIX","value":".$(K8S_SERVICE_NAME).$(MY_POD_NAMESPACE)"}],"resources":{"limits":{"cpu":"2","memory":"2Gi"},"requests":{"cpu":"1","memory":"2Gi"}},"volumeMounts":[{"name":"rabbitmq-erlang-cookie","mountPath":"/var/lib/rabbitmq/"},{"name":"persistence","mountPath":"/var/lib/rabbitmq/mnesia/"},{"name":"rabbitmq-plugins","mountPath":"/operator"},{"name":"rabbitmq-confd","mountPath":"/etc/rabbitmq/conf.d/10-operatorDefaults.conf","subPath":"operatorDefaults.conf"},{"name":"rabbitmq-confd","mountPath":"/etc/rabbitmq/conf.d/11-default_user.conf","subPath":"default_user.conf"},{"name":"rabbitmq-confd","mountPath":"/etc/rabbitmq/conf.d/90-userDefinedConfiguration.conf","subPath":"userDefinedConfiguration.conf"},{"name":"pod-info","mountPath":"/etc/pod-info/"}],"readinessProbe":{"tcpSocket":{"port":"amqp"},"initialDelaySeconds":10,"timeoutSeconds":5,"periodSeconds":10,"successThreshold":1,"failureThreshold":3},"lifecycle":{"preStop":{"exec":{"command":["/bin/bash","-c","if [ ! -z \"$(cat /etc/pod-info/skipPreStopChecks)\" ]; then exit 0; fi; rabbitmq-upgrade await_online_quorum_plus_one -t 604800; rabbitmq-upgrade await_online_synchronized_mirror -t 604800; rabbitmq-upgrade drain -t 604800"]}}},"terminationMessagePath":"/dev/termination-log","terminationMessagePolicy":"File","imagePullPolicy":"IfNotPresent"}],"restartPolicy":"Always","terminationGracePeriodSeconds":604800,"dnsPolicy":"ClusterFirst","serviceAccountName":"rabbitmq-cluster-server","serviceAccount":"rabbitmq-cluster-server","automountServiceAccountToken":true,"securityContext":{"runAsUser":999,"runAsGroup":999,"fsGroup":999},"schedulerName":"default-scheduler","topologySpreadConstraints":[{"maxSkew":1,"topologyKey":"topology.kubernetes.io/zone","whenUnsatisfiable":"ScheduleAnyway","labelSelector":{"matchLabels":{"app.kubernetes.io/name":"rabbitmq-cluster"}}}]}},"volumeClaimTemplates":[{"metadata":{"name":"persistence","namespace":"default","creationTimestamp":null,"labels":{"app.kubernetes.io/component":"rabbitmq","app.kubernetes.io/name":"rabbitmq-cluster","app.kubernetes.io/part-of":"rabbitmq"},"ownerReferences":[{"apiVersion":"rabbitmq.com/v1beta1","kind":"RabbitmqCluster","name":"rabbitmq-cluster","uid":"18d9928b-0d1c-47be-80ec-20960d053827","controller":true,"blockOwnerDeletion":false}]},"spec":{"accessModes":["ReadWriteOnce"],"resources":{"requests":{"storage":"10Gi"}},"volumeMode":"Filesystem"},"status":{"phase":"Pending"}}],"serviceName":"rabbitmq-cluster-nodes","podManagementPolicy":"Parallel","updateStrategy":{"type":"RollingUpdate","rollingUpdate":{"partition":0}},"revisionHistoryLimit":10},"status":{"observedGeneration":1,"replicas":1,"currentReplicas":1,"updatedReplicas":1,"currentRevision":"rabbitmq-cluster-server-5f8b8665fb","updateRevision":"rabbitmq-cluster-server-5f8b8665fb","collisionCount":0}}
2022/03/18 18:00:38 learn_server.go:291: [SIEVE-AFTER-READ]	Get	true	configmap	default	rabbitmq-cluster-server-conf	github.com/rabbitmq/cluster-operator/controllers.(*RabbitmqClusterReconciler)	NoError	{"kind":"ConfigMap","apiVersion":"v1","metadata":{"name":"rabbitmq-cluster-server-conf","namespace":"default","selfLink":"/api/v1/namespaces/default/configmaps/rabbitmq-cluster-server-conf","uid":"22474f2b-8454-44b7-8079-8990223969cc","resourceVersion":"714","creationTimestamp":"2022-03-18T18:00:38Z","labels":{"app.kubernetes.io/component":"rabbitmq","app.kubernetes.io/name":"rabbitmq-cluster","app.kubernetes.io/part-of":"rabbitmq"},"ownerReferences":[{"apiVersion":"rabbitmq.com/v1beta1","kind":"RabbitmqCluster","name":"rabbitmq-cluster","uid":"18d9928b-0d1c-47be-80ec-20960d053827","controller":true,"blockOwnerDeletion":true}],"managedFields":[{"manager":"manager","operation":"Update","apiVersion":"v1","time":"2022-03-18T18:00:38Z","fieldsType":"FieldsV1","fieldsV1":{"f:data":{".":{},"f:operatorDefaults.conf":{},"f:userDefinedConfiguration.conf":{}},"f:metadata":{"f:labels":{".":{},"f:app.kubernetes.io/component":{},"f:app.kubernetes.io/name":{},"f:app.kubernetes.io/part-of":{}},"f:ownerReferences":{".":{},"k:{\"uid\":\"18d9928b-0d1c-47be-80ec-20960d053827\"}":{".":{},"f:apiVersion":{},"f:blockOwnerDeletion":{},"f:controller":{},"f:kind":{},"f:name":{},"f:uid":{}}}}}}]},"data":{"operatorDefaults.conf":"cluster_formation.peer_discovery_backend             = rabbit_peer_discovery_k8s\ncluster_formation.k8s.host                           = kubernetes.default\ncluster_formation.k8s.address_type                   = hostname\ncluster_partition_handling                           = pause_minority\nqueue_master_locator                                 = min-masters\ndisk_free_limit.absolute                             = 2GB\ncluster_formation.randomized_startup_delay_range.min = 5\ncluster_formation.randomized_startup_delay_range.max = 30\ncluster_name                                         = rabbitmq-cluster\n","userDefinedConfiguration.conf":"total_memory_available_override_value = 1717986919\n"}}
2022/03/18 18:00:38 learn_server.go:256: [SIEVE-BEFORE-WRITE]	14
2022/03/18 18:00:38 learn_server.go:279: [SIEVE-BEFORE-HEAR]	16	Updated	rabbitmqcluster	{"metadata":{"name":"rabbitmq-cluster","namespace":"default","selfLink":"/apis/rabbitmq.com/v1beta1/namespaces/default/rabbitmqclusters/rabbitmq-cluster","uid":"18d9928b-0d1c-47be-80ec-20960d053827","resourceVersion":"745","generation":2,"creationTimestamp":"2022-03-18T18:00:38Z","annotations":{"kubectl.kubernetes.io/last-applied-configuration":"{\"apiVersion\":\"rabbitmq.com/v1beta1\",\"kind\":\"RabbitmqCluster\",\"metadata\":{\"annotations\":{},\"name\":\"rabbitmq-cluster\",\"namespace\":\"default\"},\"spec\":{\"persistence\":{\"storage\":\"10Gi\"},\"replicas\":1}}\n"},"finalizers":["deletion.finalizers.rabbitmqclusters.rabbitmq.com"],"managedFields":[{"manager":"kubectl-client-side-apply","operation":"Update","apiVersion":"rabbitmq.com/v1beta1","time":"2022-03-18T18:00:38Z","fieldsType":"FieldsV1","fieldsV1":{"f:metadata":{"f:annotations":{".":{},"f:kubectl.kubernetes.io/last-applied-configuration":{}}},"f:spec":{".":{},"f:image":{},"f:persistence":{".":{},"f:storage":{}},"f:replicas":{},"f:resources":{".":{},"f:limits":{".":{},"f:memory":{}},"f:requests":{".":{},"f:memory":{}}},"f:service":{".":{},"f:type":{}},"f:terminationGracePeriodSeconds":{}}}},{"manager":"manager","operation":"Update","apiVersion":"rabbitmq.com/v1beta1","time":"2022-03-18T18:00:38Z","fieldsType":"FieldsV1","fieldsV1":{"f:metadata":{"f:finalizers":{}},"f:spec":{"f:override":{},"f:rabbitmq":{},"f:resources":{"f:limits":{"f:cpu":{}},"f:requests":{"f:cpu":{}}},"f:tls":{}},"f:status":{".":{},"f:conditions":{},"f:defaultUser":{".":{},"f:secretReference":{".":{},"f:keys":{".":{},"f:password":{},"f:username":{}},"f:name":{},"f:namespace":{}},"f:serviceReference":{".":{},"f:name":{},"f:namespace":{}}}}}}]},"spec":{"replicas":1,"image":"rabbitmq:3.8.12-management","service":{"type":"ClusterIP"},"persistence":{"storage":"10Gi"},"resources":{"limits":{"cpu":"2","memory":"2Gi"},"requests":{"cpu":"1","memory":"2Gi"}},"rabbitmq":{},"tls":{},"override":{},"terminationGracePeriodSeconds":604800},"status":{"conditions":[{"type":"AllReplicasReady","status":"Unknown","lastTransitionTime":"2022-03-18T18:00:38Z","reason":"MissingStatefulSet","message":"Could not find StatefulSet"},{"type":"ClusterAvailable","status":"Unknown","lastTransitionTime":"2022-03-18T18:00:38Z","reason":"CouldNotRetrieveEndpoints","message":"Could not verify available service endpoints"},{"type":"NoWarnings","status":"Unknown","lastTransitionTime":"2022-03-18T18:00:38Z","reason":"MissingStatefulSet","message":"Could not find StatefulSet"},{"type":"ReconcileSuccess","status":"Unknown","lastTransitionTime":"2022-03-18T18:00:38Z","reason":"Initialising"}],"defaultUser":{"secretReference":{"name":"rabbitmq-cluster-default-user","namespace":"default","keys":{"password":"password","username":"username"}},"serviceReference":{"name":"rabbitmq-cluster","namespace":"default"}}}}
2022/03/18 18:00:38 learn_server.go:289: [SIEVE-AFTER-HEAR]	16
2022/03/18 18:00:38 learn_server.go:263: [SIEVE-AFTER-WRITE]	14	StatusUpdate	rabbitmqcluster	github.com/rabbitmq/cluster-operator/controllers.(*RabbitmqClusterReconciler)	NoError	{"metadata":{"name":"rabbitmq-cluster","namespace":"default","selfLink":"/apis/rabbitmq.com/v1beta1/namespaces/default/rabbitmqclusters/rabbitmq-cluster/status","uid":"18d9928b-0d1c-47be-80ec-20960d053827","resourceVersion":"745","generation":2,"creationTimestamp":"2022-03-18T18:00:38Z","annotations":{"kubectl.kubernetes.io/last-applied-configuration":"{\"apiVersion\":\"rabbitmq.com/v1beta1\",\"kind\":\"RabbitmqCluster\",\"metadata\":{\"annotations\":{},\"name\":\"rabbitmq-cluster\",\"namespace\":\"default\"},\"spec\":{\"persistence\":{\"storage\":\"10Gi\"},\"replicas\":1}}\n"},"finalizers":["deletion.finalizers.rabbitmqclusters.rabbitmq.com"],"managedFields":[{"manager":"kubectl-client-side-apply","operation":"Update","apiVersion":"rabbitmq.com/v1beta1","time":"2022-03-18T18:00:38Z","fieldsType":"FieldsV1","fieldsV1":{"f:metadata":{"f:annotations":{".":{},"f:kubectl.kubernetes.io/last-applied-configuration":{}}},"f:spec":{".":{},"f:image":{},"f:persistence":{".":{},"f:storage":{}},"f:replicas":{},"f:resources":{".":{},"f:limits":{".":{},"f:memory":{}},"f:requests":{".":{},"f:memory":{}}},"f:service":{".":{},"f:type":{}},"f:terminationGracePeriodSeconds":{}}}},{"manager":"manager","operation":"Update","apiVersion":"rabbitmq.com/v1beta1","time":"2022-03-18T18:00:38Z","fieldsType":"FieldsV1","fieldsV1":{"f:metadata":{"f:finalizers":{}},"f:spec":{"f:override":{},"f:rabbitmq":{},"f:resources":{"f:limits":{"f:cpu":{}},"f:requests":{"f:cpu":{}}},"f:tls":{}},"f:status":{".":{},"f:conditions":{},"f:defaultUser":{".":{},"f:secretReference":{".":{},"f:keys":{".":{},"f:password":{},"f:username":{}},"f:name":{},"f:namespace":{}},"f:serviceReference":{".":{},"f:name":{},"f:namespace":{}}}}}}]},"spec":{"replicas":1,"image":"rabbitmq:3.8.12-management","service":{"type":"ClusterIP"},"persistence":{"storage":"10Gi"},"resources":{"limits":{"cpu":"2","memory":"2Gi"},"requests":{"cpu":"1","memory":"2Gi"}},"rabbitmq":{},"tls":{},"override":{},"terminationGracePeriodSeconds":604800},"status":{"conditions":[{"type":"AllReplicasReady","status":"Unknown","lastTransitionTime":"2022-03-18T18:00:38Z","reason":"MissingStatefulSet","message":"Could not find StatefulSet"},{"type":"ClusterAvailable","status":"Unknown","lastTransitionTime":"2022-03-18T18:00:38Z","reason":"CouldNotRetrieveEndpoints","message":"Could not verify available service endpoints"},{"type":"NoWarnings","status":"Unknown","lastTransitionTime":"2022-03-18T18:00:38Z","reason":"MissingStatefulSet","message":"Could not find StatefulSet"},{"type":"ReconcileSuccess","status":"Unknown","lastTransitionTime":"2022-03-18T18:00:38Z","reason":"Initialising"}],"defaultUser":{"secretReference":{"name":"rabbitmq-cluster-default-user","namespace":"default","keys":{"password":"password","username":"username"}},"serviceReference":{"name":"rabbitmq-cluster","namespace":"default"}}}}
2022/03/18 18:00:38 learn_server.go:256: [SIEVE-BEFORE-WRITE]	15
2022/03/18 18:00:38 learn_server.go:263: [SIEVE-AFTER-WRITE]	15	StatusUpdate	rabbitmqcluster	github.com/rabbitmq/cluster-operator/controllers.(*RabbitmqClusterReconciler)	NoError	{"metadata":{"name":"rabbitmq-cluster","namespace":"default","selfLink":"/apis/rabbitmq.com/v1beta1/namespaces/default/rabbitmqclusters/rabbitmq-cluster/status","uid":"18d9928b-0d1c-47be-80ec-20960d053827","resourceVersion":"745","generation":2,"creationTimestamp":"2022-03-18T18:00:38Z","annotations":{"kubectl.kubernetes.io/last-applied-configuration":"{\"apiVersion\":\"rabbitmq.com/v1beta1\",\"kind\":\"RabbitmqCluster\",\"metadata\":{\"annotations\":{},\"name\":\"rabbitmq-cluster\",\"namespace\":\"default\"},\"spec\":{\"persistence\":{\"storage\":\"10Gi\"},\"replicas\":1}}\n"},"finalizers":["deletion.finalizers.rabbitmqclusters.rabbitmq.com"],"managedFields":[{"manager":"kubectl-client-side-apply","operation":"Update","apiVersion":"rabbitmq.com/v1beta1","time":"2022-03-18T18:00:38Z","fieldsType":"FieldsV1","fieldsV1":{"f:metadata":{"f:annotations":{".":{},"f:kubectl.kubernetes.io/last-applied-configuration":{}}},"f:spec":{".":{},"f:image":{},"f:persistence":{".":{},"f:storage":{}},"f:replicas":{},"f:resources":{".":{},"f:limits":{".":{},"f:memory":{}},"f:requests":{".":{},"f:memory":{}}},"f:service":{".":{},"f:type":{}},"f:terminationGracePeriodSeconds":{}}}},{"manager":"manager","operation":"Update","apiVersion":"rabbitmq.com/v1beta1","time":"2022-03-18T18:00:38Z","fieldsType":"FieldsV1","fieldsV1":{"f:metadata":{"f:finalizers":{}},"f:spec":{"f:override":{},"f:rabbitmq":{},"f:resources":{"f:limits":{"f:cpu":{}},"f:requests":{"f:cpu":{}}},"f:tls":{}},"f:status":{".":{},"f:conditions":{},"f:defaultUser":{".":{},"f:secretReference":{".":{},"f:keys":{".":{},"f:password":{},"f:username":{}},"f:name":{},"f:namespace":{}},"f:serviceReference":{".":{},"f:name":{},"f:namespace":{}}}}}}]},"spec":{"replicas":1,"image":"rabbitmq:3.8.12-management","service":{"type":"ClusterIP"},"persistence":{"storage":"10Gi"},"resources":{"limits":{"cpu":"2","memory":"2Gi"},"requests":{"cpu":"1","memory":"2Gi"}},"rabbitmq":{},"tls":{},"override":{},"terminationGracePeriodSeconds":604800},"status":{"conditions":[{"type":"AllReplicasReady","status":"Unknown","lastTransitionTime":"2022-03-18T18:00:38Z","reason":"MissingStatefulSet","message":"Could not find StatefulSet"},{"type":"ClusterAvailable","status":"Unknown","lastTransitionTime":"2022-03-18T18:00:38Z","reason":"CouldNotRetrieveEndpoints","message":"Could not verify available service endpoints"},{"type":"NoWarnings","status":"Unknown","lastTransitionTime":"2022-03-18T18:00:38Z","reason":"MissingStatefulSet","message":"Could not find StatefulSet"},{"type":"ReconcileSuccess","status":"Unknown","lastTransitionTime":"2022-03-18T18:00:38Z","reason":"Initialising"}],"defaultUser":{"secretReference":{"name":"rabbitmq-cluster-default-user","namespace":"default","keys":{"password":"password","username":"username"}},"serviceReference":{"name":"rabbitmq-cluster","namespace":"default"}},"binding":{"name":"rabbitmq-cluster-default-user"}}}
2022/03/18 18:00:38 learn_server.go:291: [SIEVE-AFTER-READ]	Get	true	statefulset	default	rabbitmq-cluster-server	github.com/rabbitmq/cluster-operator/controllers.(*RabbitmqClusterReconciler)	NoError	{"kind":"StatefulSet","apiVersion":"apps/v1","metadata":{"name":"rabbitmq-cluster-server","namespace":"default","selfLink":"/apis/apps/v1/namespaces/default/statefulsets/rabbitmq-cluster-server","uid":"cb5c43bc-6ee7-481c-ab01-6f3acffdd3c8","resourceVersion":"744","generation":1,"creationTimestamp":"2022-03-18T18:00:38Z","labels":{"app.kubernetes.io/component":"rabbitmq","app.kubernetes.io/name":"rabbitmq-cluster","app.kubernetes.io/part-of":"rabbitmq"},"annotations":{"rabbitmq.com/createdAt":"2022-03-18T18:00:38Z"},"ownerReferences":[{"apiVersion":"rabbitmq.com/v1beta1","kind":"RabbitmqCluster","name":"rabbitmq-cluster","uid":"18d9928b-0d1c-47be-80ec-20960d053827","controller":true,"blockOwnerDeletion":true}],"managedFields":[{"manager":"kube-controller-manager","operation":"Update","apiVersion":"apps/v1","time":"2022-03-18T18:00:38Z","fieldsType":"FieldsV1","fieldsV1":{"f:status":{"f:collisionCount":{},"f:currentReplicas":{},"f:currentRevision":{},"f:observedGeneration":{},"f:replicas":{},"f:updateRevision":{},"f:updatedReplicas":{}}}},{"manager":"manager","operation":"Update","apiVersion":"apps/v1","time":"2022-03-18T18:00:38Z","fieldsType":"FieldsV1","fieldsV1":{"f:metadata":{"f:annotations":{".":{},"f:rabbitmq.com/createdAt":{}},"f:labels":{".":{},"f:app.kubernetes.io/component":{},"f:app.kubernetes.io/name":{},"f:app.kubernetes.io/part-of":{}},"f:ownerReferences":{".":{},"k:{\"uid\":\"18d9928b-0d1c-47be-80ec-20960d053827\"}":{".":{},"f:apiVersion":{},"f:blockOwnerDeletion":{},"f:controller":{},"f:kind":{},"f:name":{},"f:uid":{}}}},"f:spec":{"f:podManagementPolicy":{},"f:replicas":{},"f:revisionHistoryLimit":{},"f:selector":{"f:matchLabels":{".":{},"f:app.kubernetes.io/name":{}}},"f:serviceName":{},"f:template":{"f:metadata":{"f:annotations":{".":{},"f:prometheus.io/port":{},"f:prometheus.io/scrape":{}},"f:labels":{".":{},"f:app.kubernetes.io/component":{},"f:app.kubernetes.io/name":{},"f:app.kubernetes.io/part-of":{}}},"f:spec":{"f:automountServiceAccountToken":{},"f:containers":{"k:{\"name\":\"rabbitmq\"}":{".":{},"f:env":{".":{},"k:{\"name\":\"K8S_HOSTNAME_SUFFIX\"}":{".":{},"f:name":{},"f:value":{}},"k:{\"name\":\"K8S_SERVICE_NAME\"}":{".":{},"f:name":{},"f:value":{}},"k:{\"name\":\"MY_POD_NAME\"}":{".":{},"f:name":{},"f:valueFrom":{".":{},"f:fieldRef":{".":{},"f:apiVersion":{},"f:fieldPath":{}}}},"k:{\"name\":\"MY_POD_NAMESPACE\"}":{".":{},"f:name":{},"f:valueFrom":{".":{},"f:fieldRef":{".":{},"f:apiVersion":{},"f:fieldPath":{}}}},"k:{\"name\":\"RABBITMQ_ENABLED_PLUGINS_FILE\"}":{".":{},"f:name":{},"f:value":{}},"k:{\"name\":\"RABBITMQ_NODENAME\"}":{".":{},"f:name":{},"f:value":{}},"k:{\"name\":\"RABBITMQ_USE_LONGNAME\"}":{".":{},"f:name":{},"f:value":{}}},"f:image":{},"f:imagePullPolicy":{},"f:lifecycle":{".":{},"f:preStop":{".":{},"f:exec":{".":{},"f:command":{}}}},"f:name":{},"f:ports":{".":{},"k:{\"containerPort\":4369,\"protocol\":\"TCP\"}":{".":{},"f:containerPort":{},"f:name":{},"f:protocol":{}},"k:{\"containerPort\":5672,\"protocol\":\"TCP\"}":{".":{},"f:containerPort":{},"f:name":{},"f:protocol":{}},"k:{\"containerPort\":15672,\"protocol\":\"TCP\"}":{".":{},"f:containerPort":{},"f:name":{},"f:protocol":{}},"k:{\"containerPort\":15692,\"protocol\":\"TCP\"}":{".":{},"f:containerPort":{},"f:name":{},"f:protocol":{}}},"f:readinessProbe":{".":{},"f:failureThreshold":{},"f:initialDelaySeconds":{},"f:periodSeconds":{},"f:successThreshold":{},"f:tcpSocket":{".":{},"f:port":{}},"f:timeoutSeconds":{}},"f:resources":{".":{},"f:limits":{".":{},"f:cpu":{},"f:memory":{}},"f:requests":{".":{},"f:cpu":{},"f:memory":{}}},"f:terminationMessagePath":{},"f:terminationMessagePolicy":{},"f:volumeMounts":{".":{},"k:{\"mountPath\":\"/etc/pod-info/\"}":{".":{},"f:mountPath":{},"f:name":{}},"k:{\"mountPath\":\"/etc/rabbitmq/conf.d/10-operatorDefaults.conf\"}":{".":{},"f:mountPath":{},"f:name":{},"f:subPath":{}},"k:{\"mountPath\":\"/etc/rabbitmq/conf.d/11-default_user.conf\"}":{".":{},"f:mountPath":{},"f:name":{},"f:subPath":{}},"k:{\"mountPath\":\"/etc/rabbitmq/conf.d/90-userDefinedConfiguration.conf\"}":{".":{},"f:mountPath":{},"f:name":{},"f:subPath":{}},"k:{\"mountPath\":\"/operator\"}":{".":{},"f:mountPath":{},"f:name":{}},"k:{\"mountPath\":\"/var/lib/rabbitmq/\"}":{".":{},"f:mountPath":{},"f:name":{}},"k:{\"mountPath\":\"/var/lib/rabbitmq/mnesia/\"}":{".":{},"f:mountPath":{},"f:name":{}}}}},"f:dnsPolicy":{},"f:initContainers":{".":{},"k:{\"name\":\"setup-container\"}":{".":{},"f:command":{},"f:image":{},"f:imagePullPolicy":{},"f:name":{},"f:resources":{".":{},"f:limits":{".":{},"f:cpu":{},"f:memory":{}},"f:requests":{".":{},"f:cpu":{},"f:memory":{}}},"f:securityContext":{".":{},"f:capabilities":{".":{},"f:drop":{}},"f:runAsUser":{}},"f:terminationMessagePath":{},"f:terminationMessagePolicy":{},"f:volumeMounts":{".":{},"k:{\"mountPath\":\"/operator\"}":{".":{},"f:mountPath":{},"f:name":{}},"k:{\"mountPath\":\"/tmp/default_user.conf\"}":{".":{},"f:mountPath":{},"f:name":{},"f:subPath":{}},"k:{\"mountPath\":\"/tmp/erlang-cookie-secret/\"}":{".":{},"f:mountPath":{},"f:name":{}},"k:{\"mountPath\":\"/tmp/rabbitmq-plugins/\"}":{".":{},"f:mountPath":{},"f:name":{}},"k:{\"mountPath\":\"/var/lib/rabbitmq/\"}":{".":{},"f:mountPath":{},"f:name":{}},"k:{\"mountPath\":\"/var/lib/rabbitmq/mnesia/\"}":{".":{},"f:mountPath":{},"f:name":{}}}}},"f:restartPolicy":{},"f:schedulerName":{},"f:securityContext":{".":{},"f:fsGroup":{},"f:runAsGroup":{},"f:runAsUser":{}},"f:serviceAccount":{},"f:serviceAccountName":{},"f:terminationGracePeriodSeconds":{},"f:topologySpreadConstraints":{".":{},"k:{\"topologyKey\":\"topology.kubernetes.io/zone\",\"whenUnsatisfiable\":\"ScheduleAnyway\"}":{".":{},"f:labelSelector":{".":{},"f:matchLabels":{".":{},"f:app.kubernetes.io/name":{}}},"f:maxSkew":{},"f:topologyKey":{},"f:whenUnsatisfiable":{}}},"f:volumes":{".":{},"k:{\"name\":\"erlang-cookie-secret\"}":{".":{},"f:name":{},"f:secret":{".":{},"f:defaultMode":{},"f:secretName":{}}},"k:{\"name\":\"plugins-conf\"}":{".":{},"f:configMap":{".":{},"f:defaultMode":{},"f:name":{}},"f:name":{}},"k:{\"name\":\"pod-info\"}":{".":{},"f:downwardAPI":{".":{},"f:defaultMode":{},"f:items":{}},"f:name":{}},"k:{\"name\":\"rabbitmq-confd\"}":{".":{},"f:name":{},"f:projected":{".":{},"f:defaultMode":{},"f:sources":{}}},"k:{\"name\":\"rabbitmq-erlang-cookie\"}":{".":{},"f:emptyDir":{},"f:name":{}},"k:{\"name\":\"rabbitmq-plugins\"}":{".":{},"f:emptyDir":{},"f:name":{}}}}},"f:updateStrategy":{"f:rollingUpdate":{".":{},"f:partition":{}},"f:type":{}},"f:volumeClaimTemplates":{}}}}]},"spec":{"replicas":1,"selector":{"matchLabels":{"app.kubernetes.io/name":"rabbitmq-cluster"}},"template":{"metadata":{"creationTimestamp":null,"labels":{"app.kubernetes.io/component":"rabbitmq","app.kubernetes.io/name":"rabbitmq-cluster","app.kubernetes.io/part-of":"rabbitmq"},"annotations":{"prometheus.io/port":"15692","prometheus.io/scrape":"true"}},"spec":{"volumes":[{"name":"plugins-conf","configMap":{"name":"rabbitmq-cluster-plugins-conf","defaultMode":420}},{"name":"rabbitmq-confd","projected":{"sources":[{"secret":{"name":"rabbitmq-cluster-default-user","items":[{"key":"default_user.conf","path":"default_user.conf"}]}},{"configMap":{"name":"rabbitmq-cluster-server-conf","items":[{"key":"operatorDefaults.conf","path":"operatorDefaults.conf"},{"key":"userDefinedConfiguration.conf","path":"userDefinedConfiguration.conf"}]}}],"defaultMode":420}},{"name":"rabbitmq-erlang-cookie","emptyDir":{}},{"name":"erlang-cookie-secret","secret":{"secretName":"rabbitmq-cluster-erlang-cookie","defaultMode":420}},{"name":"rabbitmq-plugins","emptyDir":{}},{"name":"pod-info","downwardAPI":{"items":[{"path":"skipPreStopChecks","fieldRef":{"apiVersion":"v1","fieldPath":"metadata.labels['skipPreStopChecks']"}}],"defaultMode":420}}],"initContainers":[{"name":"setup-container","image":"rabbitmq:3.8.12-management","command":["sh","-c","cp /tmp/erlang-cookie-secret/.erlang.cookie /var/lib/rabbitmq/.erlang.cookie \u0026\u0026 chown 999:999 /var/lib/rabbitmq/.erlang.cookie \u0026\u0026 chmod 600 /var/lib/rabbitmq/.erlang.cookie ; cp /tmp/rabbitmq-plugins/enabled_plugins /operator/enabled_plugins \u0026\u0026 chown 999:999 /operator/enabled_plugins ; chown 999:999 /var/lib/rabbitmq/mnesia/ ; echo '[default]' \u003e /var/lib/rabbitmq/.rabbitmqadmin.conf \u0026\u0026 sed -e 's/default_user/username/' -e 's/default_pass/password/' /tmp/default_user.conf \u003e\u003e /var/lib/rabbitmq/.rabbitmqadmin.conf \u0026\u0026 chown 999:999 /var/lib/rabbitmq/.rabbitmqadmin.conf \u0026\u0026 chmod 600 /var/lib/rabbitmq/.rabbitmqadmin.conf"],"resources":{"limits":{"cpu":"100m","memory":"500Mi"},"requests":{"cpu":"100m","memory":"500Mi"}},"volumeMounts":[{"name":"plugins-conf","mountPath":"/tmp/rabbitmq-plugins/"},{"name":"rabbitmq-erlang-cookie","mountPath":"/var/lib/rabbitmq/"},{"name":"erlang-cookie-secret","mountPath":"/tmp/erlang-cookie-secret/"},{"name":"rabbitmq-plugins","mountPath":"/operator"},{"name":"persistence","mountPath":"/var/lib/rabbitmq/mnesia/"},{"name":"rabbitmq-confd","mountPath":"/tmp/default_user.conf","subPath":"default_user.conf"}],"terminationMessagePath":"/dev/termination-log","terminationMessagePolicy":"File","imagePullPolicy":"IfNotPresent","securityContext":{"capabilities":{"drop":["FSETID","KILL","SETGID","SETUID","SETPCAP","NET_BIND_SERVICE","NET_RAW","SYS_CHROOT","MKNOD","AUDIT_WRITE","SETFCAP"]},"runAsUser":0}}],"containers":[{"name":"rabbitmq","image":"rabbitmq:3.8.12-management","ports":[{"name":"epmd","containerPort":4369,"protocol":"TCP"},{"name":"amqp","containerPort":5672,"protocol":"TCP"},{"name":"management","containerPort":15672,"protocol":"TCP"},{"name":"prometheus","containerPort":15692,"protocol":"TCP"}],"env":[{"name":"MY_POD_NAME","valueFrom":{"fieldRef":{"apiVersion":"v1","fieldPath":"metadata.name"}}},{"name":"MY_POD_NAMESPACE","valueFrom":{"fieldRef":{"apiVersion":"v1","fieldPath":"metadata.namespace"}}},{"name":"RABBITMQ_ENABLED_PLUGINS_FILE","value":"/operator/enabled_plugins"},{"name":"K8S_SERVICE_NAME","value":"rabbitmq-cluster-nodes"},{"name":"RABBITMQ_USE_LONGNAME","value":"true"},{"name":"RABBITMQ_NODENAME","value":"rabbit@$(MY_POD_NAME).$(K8S_SERVICE_NAME).$(MY_POD_NAMESPACE)"},{"name":"K8S_HOSTNAME_SUFFIX","value":".$(K8S_SERVICE_NAME).$(MY_POD_NAMESPACE)"}],"resources":{"limits":{"cpu":"2","memory":"2Gi"},"requests":{"cpu":"1","memory":"2Gi"}},"volumeMounts":[{"name":"rabbitmq-erlang-cookie","mountPath":"/var/lib/rabbitmq/"},{"name":"persistence","mountPath":"/var/lib/rabbitmq/mnesia/"},{"name":"rabbitmq-plugins","mountPath":"/operator"},{"name":"rabbitmq-confd","mountPath":"/etc/rabbitmq/conf.d/10-operatorDefaults.conf","subPath":"operatorDefaults.conf"},{"name":"rabbitmq-confd","mountPath":"/etc/rabbitmq/conf.d/11-default_user.conf","subPath":"default_user.conf"},{"name":"rabbitmq-confd","mountPath":"/etc/rabbitmq/conf.d/90-userDefinedConfiguration.conf","subPath":"userDefinedConfiguration.conf"},{"name":"pod-info","mountPath":"/etc/pod-info/"}],"readinessProbe":{"tcpSocket":{"port":"amqp"},"initialDelaySeconds":10,"timeoutSeconds":5,"periodSeconds":10,"successThreshold":1,"failureThreshold":3},"lifecycle":{"preStop":{"exec":{"command":["/bin/bash","-c","if [ ! -z \"$(cat /etc/pod-info/skipPreStopChecks)\" ]; then exit 0; fi; rabbitmq-upgrade await_online_quorum_plus_one -t 604800; rabbitmq-upgrade await_online_synchronized_mirror -t 604800; rabbitmq-upgrade drain -t 604800"]}}},"terminationMessagePath":"/dev/termination-log","terminationMessagePolicy":"File","imagePullPolicy":"IfNotPresent"}],"restartPolicy":"Always","terminationGracePeriodSeconds":604800,"dnsPolicy":"ClusterFirst","serviceAccountName":"rabbitmq-cluster-server","serviceAccount":"rabbitmq-cluster-server","automountServiceAccountToken":true,"securityContext":{"runAsUser":999,"runAsGroup":999,"fsGroup":999},"schedulerName":"default-scheduler","topologySpreadConstraints":[{"maxSkew":1,"topologyKey":"topology.kubernetes.io/zone","whenUnsatisfiable":"ScheduleAnyway","labelSelector":{"matchLabels":{"app.kubernetes.io/name":"rabbitmq-cluster"}}}]}},"volumeClaimTemplates":[{"metadata":{"name":"persistence","namespace":"default","creationTimestamp":null,"labels":{"app.kubernetes.io/component":"rabbitmq","app.kubernetes.io/name":"rabbitmq-cluster","app.kubernetes.io/part-of":"rabbitmq"},"ownerReferences":[{"apiVersion":"rabbitmq.com/v1beta1","kind":"RabbitmqCluster","name":"rabbitmq-cluster","uid":"18d9928b-0d1c-47be-80ec-20960d053827","controller":true,"blockOwnerDeletion":false}]},"spec":{"accessModes":["ReadWriteOnce"],"resources":{"requests":{"storage":"10Gi"}},"volumeMode":"Filesystem"},"status":{"phase":"Pending"}}],"serviceName":"rabbitmq-cluster-nodes","podManagementPolicy":"Parallel","updateStrategy":{"type":"RollingUpdate","rollingUpdate":{"partition":0}},"revisionHistoryLimit":10},"status":{"observedGeneration":1,"replicas":1,"currentReplicas":1,"updatedReplicas":1,"currentRevision":"rabbitmq-cluster-server-5f8b8665fb","updateRevision":"rabbitmq-cluster-server-5f8b8665fb","collisionCount":0}}
2022/03/18 18:00:38 learn_server.go:253: [SIEVE-AFTER-RECONCILE]	github.com/rabbitmq/cluster-operator/controllers.(*RabbitmqClusterReconciler)	0
2022/03/18 18:00:38 learn_server.go:238: [SIEVE-BEFORE-RECONCILE]	github.com/rabbitmq/cluster-operator/controllers.(*RabbitmqClusterReconciler)	1
2022/03/18 18:00:38 learn_server.go:291: [SIEVE-AFTER-READ]	Get	true	rabbitmqcluster	default	rabbitmq-cluster	github.com/rabbitmq/cluster-operator/controllers.(*RabbitmqClusterReconciler)	NoError	{"kind":"RabbitmqCluster","apiVersion":"rabbitmq.com/v1beta1","metadata":{"name":"rabbitmq-cluster","namespace":"default","selfLink":"/apis/rabbitmq.com/v1beta1/namespaces/default/rabbitmqclusters/rabbitmq-cluster","uid":"18d9928b-0d1c-47be-80ec-20960d053827","resourceVersion":"745","generation":2,"creationTimestamp":"2022-03-18T18:00:38Z","annotations":{"kubectl.kubernetes.io/last-applied-configuration":"{\"apiVersion\":\"rabbitmq.com/v1beta1\",\"kind\":\"RabbitmqCluster\",\"metadata\":{\"annotations\":{},\"name\":\"rabbitmq-cluster\",\"namespace\":\"default\"},\"spec\":{\"persistence\":{\"storage\":\"10Gi\"},\"replicas\":1}}\n"},"finalizers":["deletion.finalizers.rabbitmqclusters.rabbitmq.com"],"managedFields":[{"manager":"kubectl-client-side-apply","operation":"Update","apiVersion":"rabbitmq.com/v1beta1","time":"2022-03-18T18:00:38Z","fieldsType":"FieldsV1","fieldsV1":{"f:metadata":{"f:annotations":{".":{},"f:kubectl.kubernetes.io/last-applied-configuration":{}}},"f:spec":{".":{},"f:image":{},"f:persistence":{".":{},"f:storage":{}},"f:replicas":{},"f:resources":{".":{},"f:limits":{".":{},"f:memory":{}},"f:requests":{".":{},"f:memory":{}}},"f:service":{".":{},"f:type":{}},"f:terminationGracePeriodSeconds":{}}}},{"manager":"manager","operation":"Update","apiVersion":"rabbitmq.com/v1beta1","time":"2022-03-18T18:00:38Z","fieldsType":"FieldsV1","fieldsV1":{"f:metadata":{"f:finalizers":{}},"f:spec":{"f:override":{},"f:rabbitmq":{},"f:resources":{"f:limits":{"f:cpu":{}},"f:requests":{"f:cpu":{}}},"f:tls":{}},"f:status":{".":{},"f:conditions":{},"f:defaultUser":{".":{},"f:secretReference":{".":{},"f:keys":{".":{},"f:password":{},"f:username":{}},"f:name":{},"f:namespace":{}},"f:serviceReference":{".":{},"f:name":{},"f:namespace":{}}}}}}]},"spec":{"replicas":1,"image":"rabbitmq:3.8.12-management","service":{"type":"ClusterIP"},"persistence":{"storage":"10Gi"},"resources":{"limits":{"cpu":"2","memory":"2Gi"},"requests":{"cpu":"1","memory":"2Gi"}},"rabbitmq":{},"tls":{},"override":{},"terminationGracePeriodSeconds":604800},"status":{"conditions":[{"type":"AllReplicasReady","status":"Unknown","lastTransitionTime":"2022-03-18T18:00:38Z","reason":"MissingStatefulSet","message":"Could not find StatefulSet"},{"type":"ClusterAvailable","status":"Unknown","lastTransitionTime":"2022-03-18T18:00:38Z","reason":"CouldNotRetrieveEndpoints","message":"Could not verify available service endpoints"},{"type":"NoWarnings","status":"Unknown","lastTransitionTime":"2022-03-18T18:00:38Z","reason":"MissingStatefulSet","message":"Could not find StatefulSet"},{"type":"ReconcileSuccess","status":"Unknown","lastTransitionTime":"2022-03-18T18:00:38Z","reason":"Initialising"}],"defaultUser":{"secretReference":{"name":"rabbitmq-cluster-default-user","namespace":"default","keys":{"password":"password","username":"username"}},"serviceReference":{"name":"rabbitmq-cluster","namespace":"default"}}}}
2022/03/18 18:00:38 learn_server.go:291: [SIEVE-AFTER-READ]	Get	true	statefulset	default	rabbitmq-cluster-server	github.com/rabbitmq/cluster-operator/controllers.(*RabbitmqClusterReconciler)	NoError	{"kind":"StatefulSet","apiVersion":"apps/v1","metadata":{"name":"rabbitmq-cluster-server","namespace":"default","selfLink":"/apis/apps/v1/namespaces/default/statefulsets/rabbitmq-cluster-server","uid":"cb5c43bc-6ee7-481c-ab01-6f3acffdd3c8","resourceVersion":"744","generation":1,"creationTimestamp":"2022-03-18T18:00:38Z","labels":{"app.kubernetes.io/component":"rabbitmq","app.kubernetes.io/name":"rabbitmq-cluster","app.kubernetes.io/part-of":"rabbitmq"},"annotations":{"rabbitmq.com/createdAt":"2022-03-18T18:00:38Z"},"ownerReferences":[{"apiVersion":"rabbitmq.com/v1beta1","kind":"RabbitmqCluster","name":"rabbitmq-cluster","uid":"18d9928b-0d1c-47be-80ec-20960d053827","controller":true,"blockOwnerDeletion":true}],"managedFields":[{"manager":"kube-controller-manager","operation":"Update","apiVersion":"apps/v1","time":"2022-03-18T18:00:38Z","fieldsType":"FieldsV1","fieldsV1":{"f:status":{"f:collisionCount":{},"f:currentReplicas":{},"f:currentRevision":{},"f:observedGeneration":{},"f:replicas":{},"f:updateRevision":{},"f:updatedReplicas":{}}}},{"manager":"manager","operation":"Update","apiVersion":"apps/v1","time":"2022-03-18T18:00:38Z","fieldsType":"FieldsV1","fieldsV1":{"f:metadata":{"f:annotations":{".":{},"f:rabbitmq.com/createdAt":{}},"f:labels":{".":{},"f:app.kubernetes.io/component":{},"f:app.kubernetes.io/name":{},"f:app.kubernetes.io/part-of":{}},"f:ownerReferences":{".":{},"k:{\"uid\":\"18d9928b-0d1c-47be-80ec-20960d053827\"}":{".":{},"f:apiVersion":{},"f:blockOwnerDeletion":{},"f:controller":{},"f:kind":{},"f:name":{},"f:uid":{}}}},"f:spec":{"f:podManagementPolicy":{},"f:replicas":{},"f:revisionHistoryLimit":{},"f:selector":{"f:matchLabels":{".":{},"f:app.kubernetes.io/name":{}}},"f:serviceName":{},"f:template":{"f:metadata":{"f:annotations":{".":{},"f:prometheus.io/port":{},"f:prometheus.io/scrape":{}},"f:labels":{".":{},"f:app.kubernetes.io/component":{},"f:app.kubernetes.io/name":{},"f:app.kubernetes.io/part-of":{}}},"f:spec":{"f:automountServiceAccountToken":{},"f:containers":{"k:{\"name\":\"rabbitmq\"}":{".":{},"f:env":{".":{},"k:{\"name\":\"K8S_HOSTNAME_SUFFIX\"}":{".":{},"f:name":{},"f:value":{}},"k:{\"name\":\"K8S_SERVICE_NAME\"}":{".":{},"f:name":{},"f:value":{}},"k:{\"name\":\"MY_POD_NAME\"}":{".":{},"f:name":{},"f:valueFrom":{".":{},"f:fieldRef":{".":{},"f:apiVersion":{},"f:fieldPath":{}}}},"k:{\"name\":\"MY_POD_NAMESPACE\"}":{".":{},"f:name":{},"f:valueFrom":{".":{},"f:fieldRef":{".":{},"f:apiVersion":{},"f:fieldPath":{}}}},"k:{\"name\":\"RABBITMQ_ENABLED_PLUGINS_FILE\"}":{".":{},"f:name":{},"f:value":{}},"k:{\"name\":\"RABBITMQ_NODENAME\"}":{".":{},"f:name":{},"f:value":{}},"k:{\"name\":\"RABBITMQ_USE_LONGNAME\"}":{".":{},"f:name":{},"f:value":{}}},"f:image":{},"f:imagePullPolicy":{},"f:lifecycle":{".":{},"f:preStop":{".":{},"f:exec":{".":{},"f:command":{}}}},"f:name":{},"f:ports":{".":{},"k:{\"containerPort\":4369,\"protocol\":\"TCP\"}":{".":{},"f:containerPort":{},"f:name":{},"f:protocol":{}},"k:{\"containerPort\":5672,\"protocol\":\"TCP\"}":{".":{},"f:containerPort":{},"f:name":{},"f:protocol":{}},"k:{\"containerPort\":15672,\"protocol\":\"TCP\"}":{".":{},"f:containerPort":{},"f:name":{},"f:protocol":{}},"k:{\"containerPort\":15692,\"protocol\":\"TCP\"}":{".":{},"f:containerPort":{},"f:name":{},"f:protocol":{}}},"f:readinessProbe":{".":{},"f:failureThreshold":{},"f:initialDelaySeconds":{},"f:periodSeconds":{},"f:successThreshold":{},"f:tcpSocket":{".":{},"f:port":{}},"f:timeoutSeconds":{}},"f:resources":{".":{},"f:limits":{".":{},"f:cpu":{},"f:memory":{}},"f:requests":{".":{},"f:cpu":{},"f:memory":{}}},"f:terminationMessagePath":{},"f:terminationMessagePolicy":{},"f:volumeMounts":{".":{},"k:{\"mountPath\":\"/etc/pod-info/\"}":{".":{},"f:mountPath":{},"f:name":{}},"k:{\"mountPath\":\"/etc/rabbitmq/conf.d/10-operatorDefaults.conf\"}":{".":{},"f:mountPath":{},"f:name":{},"f:subPath":{}},"k:{\"mountPath\":\"/etc/rabbitmq/conf.d/11-default_user.conf\"}":{".":{},"f:mountPath":{},"f:name":{},"f:subPath":{}},"k:{\"mountPath\":\"/etc/rabbitmq/conf.d/90-userDefinedConfiguration.conf\"}":{".":{},"f:mountPath":{},"f:name":{},"f:subPath":{}},"k:{\"mountPath\":\"/operator\"}":{".":{},"f:mountPath":{},"f:name":{}},"k:{\"mountPath\":\"/var/lib/rabbitmq/\"}":{".":{},"f:mountPath":{},"f:name":{}},"k:{\"mountPath\":\"/var/lib/rabbitmq/mnesia/\"}":{".":{},"f:mountPath":{},"f:name":{}}}}},"f:dnsPolicy":{},"f:initContainers":{".":{},"k:{\"name\":\"setup-container\"}":{".":{},"f:command":{},"f:image":{},"f:imagePullPolicy":{},"f:name":{},"f:resources":{".":{},"f:limits":{".":{},"f:cpu":{},"f:memory":{}},"f:requests":{".":{},"f:cpu":{},"f:memory":{}}},"f:securityContext":{".":{},"f:capabilities":{".":{},"f:drop":{}},"f:runAsUser":{}},"f:terminationMessagePath":{},"f:terminationMessagePolicy":{},"f:volumeMounts":{".":{},"k:{\"mountPath\":\"/operator\"}":{".":{},"f:mountPath":{},"f:name":{}},"k:{\"mountPath\":\"/tmp/default_user.conf\"}":{".":{},"f:mountPath":{},"f:name":{},"f:subPath":{}},"k:{\"mountPath\":\"/tmp/erlang-cookie-secret/\"}":{".":{},"f:mountPath":{},"f:name":{}},"k:{\"mountPath\":\"/tmp/rabbitmq-plugins/\"}":{".":{},"f:mountPath":{},"f:name":{}},"k:{\"mountPath\":\"/var/lib/rabbitmq/\"}":{".":{},"f:mountPath":{},"f:name":{}},"k:{\"mountPath\":\"/var/lib/rabbitmq/mnesia/\"}":{".":{},"f:mountPath":{},"f:name":{}}}}},"f:restartPolicy":{},"f:schedulerName":{},"f:securityContext":{".":{},"f:fsGroup":{},"f:runAsGroup":{},"f:runAsUser":{}},"f:serviceAccount":{},"f:serviceAccountName":{},"f:terminationGracePeriodSeconds":{},"f:topologySpreadConstraints":{".":{},"k:{\"topologyKey\":\"topology.kubernetes.io/zone\",\"whenUnsatisfiable\":\"ScheduleAnyway\"}":{".":{},"f:labelSelector":{".":{},"f:matchLabels":{".":{},"f:app.kubernetes.io/name":{}}},"f:maxSkew":{},"f:topologyKey":{},"f:whenUnsatisfiable":{}}},"f:volumes":{".":{},"k:{\"name\":\"erlang-cookie-secret\"}":{".":{},"f:name":{},"f:secret":{".":{},"f:defaultMode":{},"f:secretName":{}}},"k:{\"name\":\"plugins-conf\"}":{".":{},"f:configMap":{".":{},"f:defaultMode":{},"f:name":{}},"f:name":{}},"k:{\"name\":\"pod-info\"}":{".":{},"f:downwardAPI":{".":{},"f:defaultMode":{},"f:items":{}},"f:name":{}},"k:{\"name\":\"rabbitmq-confd\"}":{".":{},"f:name":{},"f:projected":{".":{},"f:defaultMode":{},"f:sources":{}}},"k:{\"name\":\"rabbitmq-erlang-cookie\"}":{".":{},"f:emptyDir":{},"f:name":{}},"k:{\"name\":\"rabbitmq-plugins\"}":{".":{},"f:emptyDir":{},"f:name":{}}}}},"f:updateStrategy":{"f:rollingUpdate":{".":{},"f:partition":{}},"f:type":{}},"f:volumeClaimTemplates":{}}}}]},"spec":{"replicas":1,"selector":{"matchLabels":{"app.kubernetes.io/name":"rabbitmq-cluster"}},"template":{"metadata":{"creationTimestamp":null,"labels":{"app.kubernetes.io/component":"rabbitmq","app.kubernetes.io/name":"rabbitmq-cluster","app.kubernetes.io/part-of":"rabbitmq"},"annotations":{"prometheus.io/port":"15692","prometheus.io/scrape":"true"}},"spec":{"volumes":[{"name":"plugins-conf","configMap":{"name":"rabbitmq-cluster-plugins-conf","defaultMode":420}},{"name":"rabbitmq-confd","projected":{"sources":[{"secret":{"name":"rabbitmq-cluster-default-user","items":[{"key":"default_user.conf","path":"default_user.conf"}]}},{"configMap":{"name":"rabbitmq-cluster-server-conf","items":[{"key":"operatorDefaults.conf","path":"operatorDefaults.conf"},{"key":"userDefinedConfiguration.conf","path":"userDefinedConfiguration.conf"}]}}],"defaultMode":420}},{"name":"rabbitmq-erlang-cookie","emptyDir":{}},{"name":"erlang-cookie-secret","secret":{"secretName":"rabbitmq-cluster-erlang-cookie","defaultMode":420}},{"name":"rabbitmq-plugins","emptyDir":{}},{"name":"pod-info","downwardAPI":{"items":[{"path":"skipPreStopChecks","fieldRef":{"apiVersion":"v1","fieldPath":"metadata.labels['skipPreStopChecks']"}}],"defaultMode":420}}],"initContainers":[{"name":"setup-container","image":"rabbitmq:3.8.12-management","command":["sh","-c","cp /tmp/erlang-cookie-secret/.erlang.cookie /var/lib/rabbitmq/.erlang.cookie \u0026\u0026 chown 999:999 /var/lib/rabbitmq/.erlang.cookie \u0026\u0026 chmod 600 /var/lib/rabbitmq/.erlang.cookie ; cp /tmp/rabbitmq-plugins/enabled_plugins /operator/enabled_plugins \u0026\u0026 chown 999:999 /operator/enabled_plugins ; chown 999:999 /var/lib/rabbitmq/mnesia/ ; echo '[default]' \u003e /var/lib/rabbitmq/.rabbitmqadmin.conf \u0026\u0026 sed -e 's/default_user/username/' -e 's/default_pass/password/' /tmp/default_user.conf \u003e\u003e /var/lib/rabbitmq/.rabbitmqadmin.conf \u0026\u0026 chown 999:999 /var/lib/rabbitmq/.rabbitmqadmin.conf \u0026\u0026 chmod 600 /var/lib/rabbitmq/.rabbitmqadmin.conf"],"resources":{"limits":{"cpu":"100m","memory":"500Mi"},"requests":{"cpu":"100m","memory":"500Mi"}},"volumeMounts":[{"name":"plugins-conf","mountPath":"/tmp/rabbitmq-plugins/"},{"name":"rabbitmq-erlang-cookie","mountPath":"/var/lib/rabbitmq/"},{"name":"erlang-cookie-secret","mountPath":"/tmp/erlang-cookie-secret/"},{"name":"rabbitmq-plugins","mountPath":"/operator"},{"name":"persistence","mountPath":"/var/lib/rabbitmq/mnesia/"},{"name":"rabbitmq-confd","mountPath":"/tmp/default_user.conf","subPath":"default_user.conf"}],"terminationMessagePath":"/dev/termination-log","terminationMessagePolicy":"File","imagePullPolicy":"IfNotPresent","securityContext":{"capabilities":{"drop":["FSETID","KILL","SETGID","SETUID","SETPCAP","NET_BIND_SERVICE","NET_RAW","SYS_CHROOT","MKNOD","AUDIT_WRITE","SETFCAP"]},"runAsUser":0}}],"containers":[{"name":"rabbitmq","image":"rabbitmq:3.8.12-management","ports":[{"name":"epmd","containerPort":4369,"protocol":"TCP"},{"name":"amqp","containerPort":5672,"protocol":"TCP"},{"name":"management","containerPort":15672,"protocol":"TCP"},{"name":"prometheus","containerPort":15692,"protocol":"TCP"}],"env":[{"name":"MY_POD_NAME","valueFrom":{"fieldRef":{"apiVersion":"v1","fieldPath":"metadata.name"}}},{"name":"MY_POD_NAMESPACE","valueFrom":{"fieldRef":{"apiVersion":"v1","fieldPath":"metadata.namespace"}}},{"name":"RABBITMQ_ENABLED_PLUGINS_FILE","value":"/operator/enabled_plugins"},{"name":"K8S_SERVICE_NAME","value":"rabbitmq-cluster-nodes"},{"name":"RABBITMQ_USE_LONGNAME","value":"true"},{"name":"RABBITMQ_NODENAME","value":"rabbit@$(MY_POD_NAME).$(K8S_SERVICE_NAME).$(MY_POD_NAMESPACE)"},{"name":"K8S_HOSTNAME_SUFFIX","value":".$(K8S_SERVICE_NAME).$(MY_POD_NAMESPACE)"}],"resources":{"limits":{"cpu":"2","memory":"2Gi"},"requests":{"cpu":"1","memory":"2Gi"}},"volumeMounts":[{"name":"rabbitmq-erlang-cookie","mountPath":"/var/lib/rabbitmq/"},{"name":"persistence","mountPath":"/var/lib/rabbitmq/mnesia/"},{"name":"rabbitmq-plugins","mountPath":"/operator"},{"name":"rabbitmq-confd","mountPath":"/etc/rabbitmq/conf.d/10-operatorDefaults.conf","subPath":"operatorDefaults.conf"},{"name":"rabbitmq-confd","mountPath":"/etc/rabbitmq/conf.d/11-default_user.conf","subPath":"default_user.conf"},{"name":"rabbitmq-confd","mountPath":"/etc/rabbitmq/conf.d/90-userDefinedConfiguration.conf","subPath":"userDefinedConfiguration.conf"},{"name":"pod-info","mountPath":"/etc/pod-info/"}],"readinessProbe":{"tcpSocket":{"port":"amqp"},"initialDelaySeconds":10,"timeoutSeconds":5,"periodSeconds":10,"successThreshold":1,"failureThreshold":3},"lifecycle":{"preStop":{"exec":{"command":["/bin/bash","-c","if [ ! -z \"$(cat /etc/pod-info/skipPreStopChecks)\" ]; then exit 0; fi; rabbitmq-upgrade await_online_quorum_plus_one -t 604800; rabbitmq-upgrade await_online_synchronized_mirror -t 604800; rabbitmq-upgrade drain -t 604800"]}}},"terminationMessagePath":"/dev/termination-log","terminationMessagePolicy":"File","imagePullPolicy":"IfNotPresent"}],"restartPolicy":"Always","terminationGracePeriodSeconds":604800,"dnsPolicy":"ClusterFirst","serviceAccountName":"rabbitmq-cluster-server","serviceAccount":"rabbitmq-cluster-server","automountServiceAccountToken":true,"securityContext":{"runAsUser":999,"runAsGroup":999,"fsGroup":999},"schedulerName":"default-scheduler","topologySpreadConstraints":[{"maxSkew":1,"topologyKey":"topology.kubernetes.io/zone","whenUnsatisfiable":"ScheduleAnyway","labelSelector":{"matchLabels":{"app.kubernetes.io/name":"rabbitmq-cluster"}}}]}},"volumeClaimTemplates":[{"metadata":{"name":"persistence","namespace":"default","creationTimestamp":null,"labels":{"app.kubernetes.io/component":"rabbitmq","app.kubernetes.io/name":"rabbitmq-cluster","app.kubernetes.io/part-of":"rabbitmq"},"ownerReferences":[{"apiVersion":"rabbitmq.com/v1beta1","kind":"RabbitmqCluster","name":"rabbitmq-cluster","uid":"18d9928b-0d1c-47be-80ec-20960d053827","controller":true,"blockOwnerDeletion":false}]},"spec":{"accessModes":["ReadWriteOnce"],"resources":{"requests":{"storage":"10Gi"}},"volumeMode":"Filesystem"},"status":{"phase":"Pending"}}],"serviceName":"rabbitmq-cluster-nodes","podManagementPolicy":"Parallel","updateStrategy":{"type":"RollingUpdate","rollingUpdate":{"partition":0}},"revisionHistoryLimit":10},"status":{"observedGeneration":1,"replicas":1,"currentReplicas":1,"updatedReplicas":1,"currentRevision":"rabbitmq-cluster-server-5f8b8665fb","updateRevision":"rabbitmq-cluster-server-5f8b8665fb","collisionCount":0}}
2022/03/18 18:00:38 learn_server.go:291: [SIEVE-AFTER-READ]	Get	true	endpoints	default	rabbitmq-cluster	github.com/rabbitmq/cluster-operator/controllers.(*RabbitmqClusterReconciler)	NoError	{"kind":"Endpoints","apiVersion":"v1","metadata":{"name":"rabbitmq-cluster","namespace":"default","selfLink":"/api/v1/namespaces/default/endpoints/rabbitmq-cluster","uid":"5c4723ad-f4fe-442d-9135-44879a2a8183","resourceVersion":"702","creationTimestamp":"2022-03-18T18:00:38Z","labels":{"app.kubernetes.io/component":"rabbitmq","app.kubernetes.io/name":"rabbitmq-cluster","app.kubernetes.io/part-of":"rabbitmq"},"annotations":{"endpoints.kubernetes.io/last-change-trigger-time":"2022-03-18T18:00:38Z"},"managedFields":[{"manager":"kube-controller-manager","operation":"Update","apiVersion":"v1","time":"2022-03-18T18:00:38Z","fieldsType":"FieldsV1","fieldsV1":{"f:metadata":{"f:annotations":{".":{},"f:endpoints.kubernetes.io/last-change-trigger-time":{}},"f:labels":{".":{},"f:app.kubernetes.io/component":{},"f:app.kubernetes.io/name":{},"f:app.kubernetes.io/part-of":{}}}}}]}}
2022/03/18 18:00:38 learn_server.go:256: [SIEVE-BEFORE-WRITE]	16
2022/03/18 18:00:38 learn_server.go:263: [SIEVE-AFTER-WRITE]	16	StatusUpdate	rabbitmqcluster	github.com/rabbitmq/cluster-operator/controllers.(*RabbitmqClusterReconciler)	NoError	{"metadata":{"name":"rabbitmq-cluster","namespace":"default","selfLink":"/apis/rabbitmq.com/v1beta1/namespaces/default/rabbitmqclusters/rabbitmq-cluster/status","uid":"18d9928b-0d1c-47be-80ec-20960d053827","resourceVersion":"746","generation":2,"creationTimestamp":"2022-03-18T18:00:38Z","annotations":{"kubectl.kubernetes.io/last-applied-configuration":"{\"apiVersion\":\"rabbitmq.com/v1beta1\",\"kind\":\"RabbitmqCluster\",\"metadata\":{\"annotations\":{},\"name\":\"rabbitmq-cluster\",\"namespace\":\"default\"},\"spec\":{\"persistence\":{\"storage\":\"10Gi\"},\"replicas\":1}}\n"},"finalizers":["deletion.finalizers.rabbitmqclusters.rabbitmq.com"],"managedFields":[{"manager":"kubectl-client-side-apply","operation":"Update","apiVersion":"rabbitmq.com/v1beta1","time":"2022-03-18T18:00:38Z","fieldsType":"FieldsV1","fieldsV1":{"f:metadata":{"f:annotations":{".":{},"f:kubectl.kubernetes.io/last-applied-configuration":{}}},"f:spec":{".":{},"f:image":{},"f:persistence":{".":{},"f:storage":{}},"f:replicas":{},"f:resources":{".":{},"f:limits":{".":{},"f:memory":{}},"f:requests":{".":{},"f:memory":{}}},"f:service":{".":{},"f:type":{}},"f:terminationGracePeriodSeconds":{}}}},{"manager":"manager","operation":"Update","apiVersion":"rabbitmq.com/v1beta1","time":"2022-03-18T18:00:38Z","fieldsType":"FieldsV1","fieldsV1":{"f:metadata":{"f:finalizers":{}},"f:spec":{"f:override":{},"f:rabbitmq":{},"f:resources":{"f:limits":{"f:cpu":{}},"f:requests":{"f:cpu":{}}},"f:tls":{}},"f:status":{".":{},"f:conditions":{},"f:defaultUser":{".":{},"f:secretReference":{".":{},"f:keys":{".":{},"f:password":{},"f:username":{}},"f:name":{},"f:namespace":{}},"f:serviceReference":{".":{},"f:name":{},"f:namespace":{}}}}}}]},"spec":{"replicas":1,"image":"rabbitmq:3.8.12-management","service":{"type":"ClusterIP"},"persistence":{"storage":"10Gi"},"resources":{"limits":{"cpu":"2","memory":"2Gi"},"requests":{"cpu":"1","memory":"2Gi"}},"rabbitmq":{},"tls":{},"override":{},"terminationGracePeriodSeconds":604800},"status":{"conditions":[{"type":"AllReplicasReady","status":"False","lastTransitionTime":"2022-03-18T18:00:38Z","reason":"NotAllPodsReady","message":"0/1 Pods ready"},{"type":"ClusterAvailable","status":"False","lastTransitionTime":"2022-03-18T18:00:38Z","reason":"NoEndpointsAvailable","message":"The service has no endpoints available"},{"type":"NoWarnings","status":"True","lastTransitionTime":"2022-03-18T18:00:38Z","reason":"NoWarnings"},{"type":"ReconcileSuccess","status":"Unknown","lastTransitionTime":"2022-03-18T18:00:38Z","reason":"Initialising"}],"defaultUser":{"secretReference":{"name":"rabbitmq-cluster-default-user","namespace":"default","keys":{"password":"password","username":"username"}},"serviceReference":{"name":"rabbitmq-cluster","namespace":"default"}}}}
2022/03/18 18:00:38 learn_server.go:279: [SIEVE-BEFORE-HEAR]	17	Updated	rabbitmqcluster	{"metadata":{"name":"rabbitmq-cluster","namespace":"default","selfLink":"/apis/rabbitmq.com/v1beta1/namespaces/default/rabbitmqclusters/rabbitmq-cluster","uid":"18d9928b-0d1c-47be-80ec-20960d053827","resourceVersion":"746","generation":2,"creationTimestamp":"2022-03-18T18:00:38Z","annotations":{"kubectl.kubernetes.io/last-applied-configuration":"{\"apiVersion\":\"rabbitmq.com/v1beta1\",\"kind\":\"RabbitmqCluster\",\"metadata\":{\"annotations\":{},\"name\":\"rabbitmq-cluster\",\"namespace\":\"default\"},\"spec\":{\"persistence\":{\"storage\":\"10Gi\"},\"replicas\":1}}\n"},"finalizers":["deletion.finalizers.rabbitmqclusters.rabbitmq.com"],"managedFields":[{"manager":"kubectl-client-side-apply","operation":"Update","apiVersion":"rabbitmq.com/v1beta1","time":"2022-03-18T18:00:38Z","fieldsType":"FieldsV1","fieldsV1":{"f:metadata":{"f:annotations":{".":{},"f:kubectl.kubernetes.io/last-applied-configuration":{}}},"f:spec":{".":{},"f:image":{},"f:persistence":{".":{},"f:storage":{}},"f:replicas":{},"f:resources":{".":{},"f:limits":{".":{},"f:memory":{}},"f:requests":{".":{},"f:memory":{}}},"f:service":{".":{},"f:type":{}},"f:terminationGracePeriodSeconds":{}}}},{"manager":"manager","operation":"Update","apiVersion":"rabbitmq.com/v1beta1","time":"2022-03-18T18:00:38Z","fieldsType":"FieldsV1","fieldsV1":{"f:metadata":{"f:finalizers":{}},"f:spec":{"f:override":{},"f:rabbitmq":{},"f:resources":{"f:limits":{"f:cpu":{}},"f:requests":{"f:cpu":{}}},"f:tls":{}},"f:status":{".":{},"f:conditions":{},"f:defaultUser":{".":{},"f:secretReference":{".":{},"f:keys":{".":{},"f:password":{},"f:username":{}},"f:name":{},"f:namespace":{}},"f:serviceReference":{".":{},"f:name":{},"f:namespace":{}}}}}}]},"spec":{"replicas":1,"image":"rabbitmq:3.8.12-management","service":{"type":"ClusterIP"},"persistence":{"storage":"10Gi"},"resources":{"limits":{"cpu":"2","memory":"2Gi"},"requests":{"cpu":"1","memory":"2Gi"}},"rabbitmq":{},"tls":{},"override":{},"terminationGracePeriodSeconds":604800},"status":{"conditions":[{"type":"AllReplicasReady","status":"False","lastTransitionTime":"2022-03-18T18:00:38Z","reason":"NotAllPodsReady","message":"0/1 Pods ready"},{"type":"ClusterAvailable","status":"False","lastTransitionTime":"2022-03-18T18:00:38Z","reason":"NoEndpointsAvailable","message":"The service has no endpoints available"},{"type":"NoWarnings","status":"True","lastTransitionTime":"2022-03-18T18:00:38Z","reason":"NoWarnings"},{"type":"ReconcileSuccess","status":"Unknown","lastTransitionTime":"2022-03-18T18:00:38Z","reason":"Initialising"}],"defaultUser":{"secretReference":{"name":"rabbitmq-cluster-default-user","namespace":"default","keys":{"password":"password","username":"username"}},"serviceReference":{"name":"rabbitmq-cluster","namespace":"default"}}}}
2022/03/18 18:00:38 learn_server.go:289: [SIEVE-AFTER-HEAR]	17
2022/03/18 18:00:38 learn_server.go:291: [SIEVE-AFTER-READ]	Get	true	statefulset	default	rabbitmq-cluster-server	github.com/rabbitmq/cluster-operator/controllers.(*RabbitmqClusterReconciler)	NoError	{"kind":"StatefulSet","apiVersion":"apps/v1","metadata":{"name":"rabbitmq-cluster-server","namespace":"default","selfLink":"/apis/apps/v1/namespaces/default/statefulsets/rabbitmq-cluster-server","uid":"cb5c43bc-6ee7-481c-ab01-6f3acffdd3c8","resourceVersion":"744","generation":1,"creationTimestamp":"2022-03-18T18:00:38Z","labels":{"app.kubernetes.io/component":"rabbitmq","app.kubernetes.io/name":"rabbitmq-cluster","app.kubernetes.io/part-of":"rabbitmq"},"annotations":{"rabbitmq.com/createdAt":"2022-03-18T18:00:38Z"},"ownerReferences":[{"apiVersion":"rabbitmq.com/v1beta1","kind":"RabbitmqCluster","name":"rabbitmq-cluster","uid":"18d9928b-0d1c-47be-80ec-20960d053827","controller":true,"blockOwnerDeletion":true}],"managedFields":[{"manager":"kube-controller-manager","operation":"Update","apiVersion":"apps/v1","time":"2022-03-18T18:00:38Z","fieldsType":"FieldsV1","fieldsV1":{"f:status":{"f:collisionCount":{},"f:currentReplicas":{},"f:currentRevision":{},"f:observedGeneration":{},"f:replicas":{},"f:updateRevision":{},"f:updatedReplicas":{}}}},{"manager":"manager","operation":"Update","apiVersion":"apps/v1","time":"2022-03-18T18:00:38Z","fieldsType":"FieldsV1","fieldsV1":{"f:metadata":{"f:annotations":{".":{},"f:rabbitmq.com/createdAt":{}},"f:labels":{".":{},"f:app.kubernetes.io/component":{},"f:app.kubernetes.io/name":{},"f:app.kubernetes.io/part-of":{}},"f:ownerReferences":{".":{},"k:{\"uid\":\"18d9928b-0d1c-47be-80ec-20960d053827\"}":{".":{},"f:apiVersion":{},"f:blockOwnerDeletion":{},"f:controller":{},"f:kind":{},"f:name":{},"f:uid":{}}}},"f:spec":{"f:podManagementPolicy":{},"f:replicas":{},"f:revisionHistoryLimit":{},"f:selector":{"f:matchLabels":{".":{},"f:app.kubernetes.io/name":{}}},"f:serviceName":{},"f:template":{"f:metadata":{"f:annotations":{".":{},"f:prometheus.io/port":{},"f:prometheus.io/scrape":{}},"f:labels":{".":{},"f:app.kubernetes.io/component":{},"f:app.kubernetes.io/name":{},"f:app.kubernetes.io/part-of":{}}},"f:spec":{"f:automountServiceAccountToken":{},"f:containers":{"k:{\"name\":\"rabbitmq\"}":{".":{},"f:env":{".":{},"k:{\"name\":\"K8S_HOSTNAME_SUFFIX\"}":{".":{},"f:name":{},"f:value":{}},"k:{\"name\":\"K8S_SERVICE_NAME\"}":{".":{},"f:name":{},"f:value":{}},"k:{\"name\":\"MY_POD_NAME\"}":{".":{},"f:name":{},"f:valueFrom":{".":{},"f:fieldRef":{".":{},"f:apiVersion":{},"f:fieldPath":{}}}},"k:{\"name\":\"MY_POD_NAMESPACE\"}":{".":{},"f:name":{},"f:valueFrom":{".":{},"f:fieldRef":{".":{},"f:apiVersion":{},"f:fieldPath":{}}}},"k:{\"name\":\"RABBITMQ_ENABLED_PLUGINS_FILE\"}":{".":{},"f:name":{},"f:value":{}},"k:{\"name\":\"RABBITMQ_NODENAME\"}":{".":{},"f:name":{},"f:value":{}},"k:{\"name\":\"RABBITMQ_USE_LONGNAME\"}":{".":{},"f:name":{},"f:value":{}}},"f:image":{},"f:imagePullPolicy":{},"f:lifecycle":{".":{},"f:preStop":{".":{},"f:exec":{".":{},"f:command":{}}}},"f:name":{},"f:ports":{".":{},"k:{\"containerPort\":4369,\"protocol\":\"TCP\"}":{".":{},"f:containerPort":{},"f:name":{},"f:protocol":{}},"k:{\"containerPort\":5672,\"protocol\":\"TCP\"}":{".":{},"f:containerPort":{},"f:name":{},"f:protocol":{}},"k:{\"containerPort\":15672,\"protocol\":\"TCP\"}":{".":{},"f:containerPort":{},"f:name":{},"f:protocol":{}},"k:{\"containerPort\":15692,\"protocol\":\"TCP\"}":{".":{},"f:containerPort":{},"f:name":{},"f:protocol":{}}},"f:readinessProbe":{".":{},"f:failureThreshold":{},"f:initialDelaySeconds":{},"f:periodSeconds":{},"f:successThreshold":{},"f:tcpSocket":{".":{},"f:port":{}},"f:timeoutSeconds":{}},"f:resources":{".":{},"f:limits":{".":{},"f:cpu":{},"f:memory":{}},"f:requests":{".":{},"f:cpu":{},"f:memory":{}}},"f:terminationMessagePath":{},"f:terminationMessagePolicy":{},"f:volumeMounts":{".":{},"k:{\"mountPath\":\"/etc/pod-info/\"}":{".":{},"f:mountPath":{},"f:name":{}},"k:{\"mountPath\":\"/etc/rabbitmq/conf.d/10-operatorDefaults.conf\"}":{".":{},"f:mountPath":{},"f:name":{},"f:subPath":{}},"k:{\"mountPath\":\"/etc/rabbitmq/conf.d/11-default_user.conf\"}":{".":{},"f:mountPath":{},"f:name":{},"f:subPath":{}},"k:{\"mountPath\":\"/etc/rabbitmq/conf.d/90-userDefinedConfiguration.conf\"}":{".":{},"f:mountPath":{},"f:name":{},"f:subPath":{}},"k:{\"mountPath\":\"/operator\"}":{".":{},"f:mountPath":{},"f:name":{}},"k:{\"mountPath\":\"/var/lib/rabbitmq/\"}":{".":{},"f:mountPath":{},"f:name":{}},"k:{\"mountPath\":\"/var/lib/rabbitmq/mnesia/\"}":{".":{},"f:mountPath":{},"f:name":{}}}}},"f:dnsPolicy":{},"f:initContainers":{".":{},"k:{\"name\":\"setup-container\"}":{".":{},"f:command":{},"f:image":{},"f:imagePullPolicy":{},"f:name":{},"f:resources":{".":{},"f:limits":{".":{},"f:cpu":{},"f:memory":{}},"f:requests":{".":{},"f:cpu":{},"f:memory":{}}},"f:securityContext":{".":{},"f:capabilities":{".":{},"f:drop":{}},"f:runAsUser":{}},"f:terminationMessagePath":{},"f:terminationMessagePolicy":{},"f:volumeMounts":{".":{},"k:{\"mountPath\":\"/operator\"}":{".":{},"f:mountPath":{},"f:name":{}},"k:{\"mountPath\":\"/tmp/default_user.conf\"}":{".":{},"f:mountPath":{},"f:name":{},"f:subPath":{}},"k:{\"mountPath\":\"/tmp/erlang-cookie-secret/\"}":{".":{},"f:mountPath":{},"f:name":{}},"k:{\"mountPath\":\"/tmp/rabbitmq-plugins/\"}":{".":{},"f:mountPath":{},"f:name":{}},"k:{\"mountPath\":\"/var/lib/rabbitmq/\"}":{".":{},"f:mountPath":{},"f:name":{}},"k:{\"mountPath\":\"/var/lib/rabbitmq/mnesia/\"}":{".":{},"f:mountPath":{},"f:name":{}}}}},"f:restartPolicy":{},"f:schedulerName":{},"f:securityContext":{".":{},"f:fsGroup":{},"f:runAsGroup":{},"f:runAsUser":{}},"f:serviceAccount":{},"f:serviceAccountName":{},"f:terminationGracePeriodSeconds":{},"f:topologySpreadConstraints":{".":{},"k:{\"topologyKey\":\"topology.kubernetes.io/zone\",\"whenUnsatisfiable\":\"ScheduleAnyway\"}":{".":{},"f:labelSelector":{".":{},"f:matchLabels":{".":{},"f:app.kubernetes.io/name":{}}},"f:maxSkew":{},"f:topologyKey":{},"f:whenUnsatisfiable":{}}},"f:volumes":{".":{},"k:{\"name\":\"erlang-cookie-secret\"}":{".":{},"f:name":{},"f:secret":{".":{},"f:defaultMode":{},"f:secretName":{}}},"k:{\"name\":\"plugins-conf\"}":{".":{},"f:configMap":{".":{},"f:defaultMode":{},"f:name":{}},"f:name":{}},"k:{\"name\":\"pod-info\"}":{".":{},"f:downwardAPI":{".":{},"f:defaultMode":{},"f:items":{}},"f:name":{}},"k:{\"name\":\"rabbitmq-confd\"}":{".":{},"f:name":{},"f:projected":{".":{},"f:defaultMode":{},"f:sources":{}}},"k:{\"name\":\"rabbitmq-erlang-cookie\"}":{".":{},"f:emptyDir":{},"f:name":{}},"k:{\"name\":\"rabbitmq-plugins\"}":{".":{},"f:emptyDir":{},"f:name":{}}}}},"f:updateStrategy":{"f:rollingUpdate":{".":{},"f:partition":{}},"f:type":{}},"f:volumeClaimTemplates":{}}}}]},"spec":{"replicas":1,"selector":{"matchLabels":{"app.kubernetes.io/name":"rabbitmq-cluster"}},"template":{"metadata":{"creationTimestamp":null,"labels":{"app.kubernetes.io/component":"rabbitmq","app.kubernetes.io/name":"rabbitmq-cluster","app.kubernetes.io/part-of":"rabbitmq"},"annotations":{"prometheus.io/port":"15692","prometheus.io/scrape":"true"}},"spec":{"volumes":[{"name":"plugins-conf","configMap":{"name":"rabbitmq-cluster-plugins-conf","defaultMode":420}},{"name":"rabbitmq-confd","projected":{"sources":[{"secret":{"name":"rabbitmq-cluster-default-user","items":[{"key":"default_user.conf","path":"default_user.conf"}]}},{"configMap":{"name":"rabbitmq-cluster-server-conf","items":[{"key":"operatorDefaults.conf","path":"operatorDefaults.conf"},{"key":"userDefinedConfiguration.conf","path":"userDefinedConfiguration.conf"}]}}],"defaultMode":420}},{"name":"rabbitmq-erlang-cookie","emptyDir":{}},{"name":"erlang-cookie-secret","secret":{"secretName":"rabbitmq-cluster-erlang-cookie","defaultMode":420}},{"name":"rabbitmq-plugins","emptyDir":{}},{"name":"pod-info","downwardAPI":{"items":[{"path":"skipPreStopChecks","fieldRef":{"apiVersion":"v1","fieldPath":"metadata.labels['skipPreStopChecks']"}}],"defaultMode":420}}],"initContainers":[{"name":"setup-container","image":"rabbitmq:3.8.12-management","command":["sh","-c","cp /tmp/erlang-cookie-secret/.erlang.cookie /var/lib/rabbitmq/.erlang.cookie \u0026\u0026 chown 999:999 /var/lib/rabbitmq/.erlang.cookie \u0026\u0026 chmod 600 /var/lib/rabbitmq/.erlang.cookie ; cp /tmp/rabbitmq-plugins/enabled_plugins /operator/enabled_plugins \u0026\u0026 chown 999:999 /operator/enabled_plugins ; chown 999:999 /var/lib/rabbitmq/mnesia/ ; echo '[default]' \u003e /var/lib/rabbitmq/.rabbitmqadmin.conf \u0026\u0026 sed -e 's/default_user/username/' -e 's/default_pass/password/' /tmp/default_user.conf \u003e\u003e /var/lib/rabbitmq/.rabbitmqadmin.conf \u0026\u0026 chown 999:999 /var/lib/rabbitmq/.rabbitmqadmin.conf \u0026\u0026 chmod 600 /var/lib/rabbitmq/.rabbitmqadmin.conf"],"resources":{"limits":{"cpu":"100m","memory":"500Mi"},"requests":{"cpu":"100m","memory":"500Mi"}},"volumeMounts":[{"name":"plugins-conf","mountPath":"/tmp/rabbitmq-plugins/"},{"name":"rabbitmq-erlang-cookie","mountPath":"/var/lib/rabbitmq/"},{"name":"erlang-cookie-secret","mountPath":"/tmp/erlang-cookie-secret/"},{"name":"rabbitmq-plugins","mountPath":"/operator"},{"name":"persistence","mountPath":"/var/lib/rabbitmq/mnesia/"},{"name":"rabbitmq-confd","mountPath":"/tmp/default_user.conf","subPath":"default_user.conf"}],"terminationMessagePath":"/dev/termination-log","terminationMessagePolicy":"File","imagePullPolicy":"IfNotPresent","securityContext":{"capabilities":{"drop":["FSETID","KILL","SETGID","SETUID","SETPCAP","NET_BIND_SERVICE","NET_RAW","SYS_CHROOT","MKNOD","AUDIT_WRITE","SETFCAP"]},"runAsUser":0}}],"containers":[{"name":"rabbitmq","image":"rabbitmq:3.8.12-management","ports":[{"name":"epmd","containerPort":4369,"protocol":"TCP"},{"name":"amqp","containerPort":5672,"protocol":"TCP"},{"name":"management","containerPort":15672,"protocol":"TCP"},{"name":"prometheus","containerPort":15692,"protocol":"TCP"}],"env":[{"name":"MY_POD_NAME","valueFrom":{"fieldRef":{"apiVersion":"v1","fieldPath":"metadata.name"}}},{"name":"MY_POD_NAMESPACE","valueFrom":{"fieldRef":{"apiVersion":"v1","fieldPath":"metadata.namespace"}}},{"name":"RABBITMQ_ENABLED_PLUGINS_FILE","value":"/operator/enabled_plugins"},{"name":"K8S_SERVICE_NAME","value":"rabbitmq-cluster-nodes"},{"name":"RABBITMQ_USE_LONGNAME","value":"true"},{"name":"RABBITMQ_NODENAME","value":"rabbit@$(MY_POD_NAME).$(K8S_SERVICE_NAME).$(MY_POD_NAMESPACE)"},{"name":"K8S_HOSTNAME_SUFFIX","value":".$(K8S_SERVICE_NAME).$(MY_POD_NAMESPACE)"}],"resources":{"limits":{"cpu":"2","memory":"2Gi"},"requests":{"cpu":"1","memory":"2Gi"}},"volumeMounts":[{"name":"rabbitmq-erlang-cookie","mountPath":"/var/lib/rabbitmq/"},{"name":"persistence","mountPath":"/var/lib/rabbitmq/mnesia/"},{"name":"rabbitmq-plugins","mountPath":"/operator"},{"name":"rabbitmq-confd","mountPath":"/etc/rabbitmq/conf.d/10-operatorDefaults.conf","subPath":"operatorDefaults.conf"},{"name":"rabbitmq-confd","mountPath":"/etc/rabbitmq/conf.d/11-default_user.conf","subPath":"default_user.conf"},{"name":"rabbitmq-confd","mountPath":"/etc/rabbitmq/conf.d/90-userDefinedConfiguration.conf","subPath":"userDefinedConfiguration.conf"},{"name":"pod-info","mountPath":"/etc/pod-info/"}],"readinessProbe":{"tcpSocket":{"port":"amqp"},"initialDelaySeconds":10,"timeoutSeconds":5,"periodSeconds":10,"successThreshold":1,"failureThreshold":3},"lifecycle":{"preStop":{"exec":{"command":["/bin/bash","-c","if [ ! -z \"$(cat /etc/pod-info/skipPreStopChecks)\" ]; then exit 0; fi; rabbitmq-upgrade await_online_quorum_plus_one -t 604800; rabbitmq-upgrade await_online_synchronized_mirror -t 604800; rabbitmq-upgrade drain -t 604800"]}}},"terminationMessagePath":"/dev/termination-log","terminationMessagePolicy":"File","imagePullPolicy":"IfNotPresent"}],"restartPolicy":"Always","terminationGracePeriodSeconds":604800,"dnsPolicy":"ClusterFirst","serviceAccountName":"rabbitmq-cluster-server","serviceAccount":"rabbitmq-cluster-server","automountServiceAccountToken":true,"securityContext":{"runAsUser":999,"runAsGroup":999,"fsGroup":999},"schedulerName":"default-scheduler","topologySpreadConstraints":[{"maxSkew":1,"topologyKey":"topology.kubernetes.io/zone","whenUnsatisfiable":"ScheduleAnyway","labelSelector":{"matchLabels":{"app.kubernetes.io/name":"rabbitmq-cluster"}}}]}},"volumeClaimTemplates":[{"metadata":{"name":"persistence","namespace":"default","creationTimestamp":null,"labels":{"app.kubernetes.io/component":"rabbitmq","app.kubernetes.io/name":"rabbitmq-cluster","app.kubernetes.io/part-of":"rabbitmq"},"ownerReferences":[{"apiVersion":"rabbitmq.com/v1beta1","kind":"RabbitmqCluster","name":"rabbitmq-cluster","uid":"18d9928b-0d1c-47be-80ec-20960d053827","controller":true,"blockOwnerDeletion":false}]},"spec":{"accessModes":["ReadWriteOnce"],"resources":{"requests":{"storage":"10Gi"}},"volumeMode":"Filesystem"},"status":{"phase":"Pending"}}],"serviceName":"rabbitmq-cluster-nodes","podManagementPolicy":"Parallel","updateStrategy":{"type":"RollingUpdate","rollingUpdate":{"partition":0}},"revisionHistoryLimit":10},"status":{"observedGeneration":1,"replicas":1,"currentReplicas":1,"updatedReplicas":1,"currentRevision":"rabbitmq-cluster-server-5f8b8665fb","updateRevision":"rabbitmq-cluster-server-5f8b8665fb","collisionCount":0}}
2022/03/18 18:00:38 learn_server.go:291: [SIEVE-AFTER-READ]	Get	true	service	default	rabbitmq-cluster-nodes	github.com/rabbitmq/cluster-operator/controllers.(*RabbitmqClusterReconciler)	NoError	{"kind":"Service","apiVersion":"v1","metadata":{"name":"rabbitmq-cluster-nodes","namespace":"default","selfLink":"/api/v1/namespaces/default/services/rabbitmq-cluster-nodes","uid":"67c7eea9-1b87-4fd7-82e6-5bfe31fd1b52","resourceVersion":"696","creationTimestamp":"2022-03-18T18:00:38Z","labels":{"app.kubernetes.io/component":"rabbitmq","app.kubernetes.io/name":"rabbitmq-cluster","app.kubernetes.io/part-of":"rabbitmq"},"ownerReferences":[{"apiVersion":"rabbitmq.com/v1beta1","kind":"RabbitmqCluster","name":"rabbitmq-cluster","uid":"18d9928b-0d1c-47be-80ec-20960d053827","controller":true,"blockOwnerDeletion":true}],"managedFields":[{"manager":"manager","operation":"Update","apiVersion":"v1","time":"2022-03-18T18:00:38Z","fieldsType":"FieldsV1","fieldsV1":{"f:metadata":{"f:labels":{".":{},"f:app.kubernetes.io/component":{},"f:app.kubernetes.io/name":{},"f:app.kubernetes.io/part-of":{}},"f:ownerReferences":{".":{},"k:{\"uid\":\"18d9928b-0d1c-47be-80ec-20960d053827\"}":{".":{},"f:apiVersion":{},"f:blockOwnerDeletion":{},"f:controller":{},"f:kind":{},"f:name":{},"f:uid":{}}}},"f:spec":{"f:clusterIP":{},"f:ports":{".":{},"k:{\"port\":4369,\"protocol\":\"TCP\"}":{".":{},"f:name":{},"f:port":{},"f:protocol":{},"f:targetPort":{}},"k:{\"port\":25672,\"protocol\":\"TCP\"}":{".":{},"f:name":{},"f:port":{},"f:protocol":{},"f:targetPort":{}}},"f:publishNotReadyAddresses":{},"f:selector":{".":{},"f:app.kubernetes.io/name":{}},"f:sessionAffinity":{},"f:type":{}}}}]},"spec":{"ports":[{"name":"epmd","protocol":"TCP","port":4369,"targetPort":4369},{"name":"cluster-rpc","protocol":"TCP","port":25672,"targetPort":25672}],"selector":{"app.kubernetes.io/name":"rabbitmq-cluster"},"clusterIP":"None","type":"ClusterIP","sessionAffinity":"None","publishNotReadyAddresses":true},"status":{"loadBalancer":{}}}
2022/03/18 18:00:38 learn_server.go:291: [SIEVE-AFTER-READ]	Get	true	service	default	rabbitmq-cluster	github.com/rabbitmq/cluster-operator/controllers.(*RabbitmqClusterReconciler)	NoError	{"kind":"Service","apiVersion":"v1","metadata":{"name":"rabbitmq-cluster","namespace":"default","selfLink":"/api/v1/namespaces/default/services/rabbitmq-cluster","uid":"56b50671-1945-458b-adac-05619b783392","resourceVersion":"701","creationTimestamp":"2022-03-18T18:00:38Z","labels":{"app.kubernetes.io/component":"rabbitmq","app.kubernetes.io/name":"rabbitmq-cluster","app.kubernetes.io/part-of":"rabbitmq"},"ownerReferences":[{"apiVersion":"rabbitmq.com/v1beta1","kind":"RabbitmqCluster","name":"rabbitmq-cluster","uid":"18d9928b-0d1c-47be-80ec-20960d053827","controller":true,"blockOwnerDeletion":true}],"managedFields":[{"manager":"manager","operation":"Update","apiVersion":"v1","time":"2022-03-18T18:00:38Z","fieldsType":"FieldsV1","fieldsV1":{"f:metadata":{"f:labels":{".":{},"f:app.kubernetes.io/component":{},"f:app.kubernetes.io/name":{},"f:app.kubernetes.io/part-of":{}},"f:ownerReferences":{".":{},"k:{\"uid\":\"18d9928b-0d1c-47be-80ec-20960d053827\"}":{".":{},"f:apiVersion":{},"f:blockOwnerDeletion":{},"f:controller":{},"f:kind":{},"f:name":{},"f:uid":{}}}},"f:spec":{"f:ports":{".":{},"k:{\"port\":5672,\"protocol\":\"TCP\"}":{".":{},"f:name":{},"f:port":{},"f:protocol":{},"f:targetPort":{}},"k:{\"port\":15672,\"protocol\":\"TCP\"}":{".":{},"f:name":{},"f:port":{},"f:protocol":{},"f:targetPort":{}}},"f:selector":{".":{},"f:app.kubernetes.io/name":{}},"f:sessionAffinity":{},"f:type":{}}}}]},"spec":{"ports":[{"name":"amqp","protocol":"TCP","port":5672,"targetPort":5672},{"name":"management","protocol":"TCP","port":15672,"targetPort":15672}],"selector":{"app.kubernetes.io/name":"rabbitmq-cluster"},"clusterIP":"10.96.254.158","type":"ClusterIP","sessionAffinity":"None"},"status":{"loadBalancer":{}}}
2022/03/18 18:00:38 learn_server.go:291: [SIEVE-AFTER-READ]	Get	true	secret	default	rabbitmq-cluster-erlang-cookie	github.com/rabbitmq/cluster-operator/controllers.(*RabbitmqClusterReconciler)	NoError	{"kind":"Secret","apiVersion":"v1","metadata":{"name":"rabbitmq-cluster-erlang-cookie","namespace":"default","selfLink":"/api/v1/namespaces/default/secrets/rabbitmq-cluster-erlang-cookie","uid":"f8fbe8a6-0f40-4e13-960b-ab78b8ba75b0","resourceVersion":"705","creationTimestamp":"2022-03-18T18:00:38Z","labels":{"app.kubernetes.io/component":"rabbitmq","app.kubernetes.io/name":"rabbitmq-cluster","app.kubernetes.io/part-of":"rabbitmq"},"ownerReferences":[{"apiVersion":"rabbitmq.com/v1beta1","kind":"RabbitmqCluster","name":"rabbitmq-cluster","uid":"18d9928b-0d1c-47be-80ec-20960d053827","controller":true,"blockOwnerDeletion":true}],"managedFields":[{"manager":"manager","operation":"Update","apiVersion":"v1","time":"2022-03-18T18:00:38Z","fieldsType":"FieldsV1","fieldsV1":{"f:data":{".":{},"f:.erlang.cookie":{}},"f:metadata":{"f:labels":{".":{},"f:app.kubernetes.io/component":{},"f:app.kubernetes.io/name":{},"f:app.kubernetes.io/part-of":{}},"f:ownerReferences":{".":{},"k:{\"uid\":\"18d9928b-0d1c-47be-80ec-20960d053827\"}":{".":{},"f:apiVersion":{},"f:blockOwnerDeletion":{},"f:controller":{},"f:kind":{},"f:name":{},"f:uid":{}}}},"f:type":{}}}]},"data":{".erlang.cookie":"QW9hMkpWU0tlYS1FUGdWTUhrelNMNnFoMFZ0ZmRGNUY="},"type":"Opaque"}
2022/03/18 18:00:38 learn_server.go:291: [SIEVE-AFTER-READ]	Get	true	secret	default	rabbitmq-cluster-default-user	github.com/rabbitmq/cluster-operator/controllers.(*RabbitmqClusterReconciler)	NoError	{"kind":"Secret","apiVersion":"v1","metadata":{"name":"rabbitmq-cluster-default-user","namespace":"default","selfLink":"/api/v1/namespaces/default/secrets/rabbitmq-cluster-default-user","uid":"0d9f460b-a23c-402b-8273-f541ed39023f","resourceVersion":"708","creationTimestamp":"2022-03-18T18:00:38Z","labels":{"app.kubernetes.io/component":"rabbitmq","app.kubernetes.io/name":"rabbitmq-cluster","app.kubernetes.io/part-of":"rabbitmq"},"ownerReferences":[{"apiVersion":"rabbitmq.com/v1beta1","kind":"RabbitmqCluster","name":"rabbitmq-cluster","uid":"18d9928b-0d1c-47be-80ec-20960d053827","controller":true,"blockOwnerDeletion":true}],"managedFields":[{"manager":"manager","operation":"Update","apiVersion":"v1","time":"2022-03-18T18:00:38Z","fieldsType":"FieldsV1","fieldsV1":{"f:data":{".":{},"f:default_user.conf":{},"f:password":{},"f:provider":{},"f:type":{},"f:username":{}},"f:metadata":{"f:labels":{".":{},"f:app.kubernetes.io/component":{},"f:app.kubernetes.io/name":{},"f:app.kubernetes.io/part-of":{}},"f:ownerReferences":{".":{},"k:{\"uid\":\"18d9928b-0d1c-47be-80ec-20960d053827\"}":{".":{},"f:apiVersion":{},"f:blockOwnerDeletion":{},"f:controller":{},"f:kind":{},"f:name":{},"f:uid":{}}}},"f:type":{}}}]},"data":{"default_user.conf":"ZGVmYXVsdF91c2VyID0gcTMxRmh3MGtjWW9SZUl5X3BPTXp2ZVBOUnNVU3I1Mk8KZGVmYXVsdF9wYXNzID0gY0dBX19jNTJHX05hVURpTGhraWZ6UDBOVVlNLTE2MWQK","password":"Y0dBX19jNTJHX05hVURpTGhraWZ6UDBOVVlNLTE2MWQ=","provider":"cmFiYml0bXE=","type":"cmFiYml0bXE=","username":"cTMxRmh3MGtjWW9SZUl5X3BPTXp2ZVBOUnNVU3I1Mk8="},"type":"Opaque"}
2022/03/18 18:00:38 learn_server.go:291: [SIEVE-AFTER-READ]	Get	true	configmap	default	rabbitmq-cluster-plugins-conf	github.com/rabbitmq/cluster-operator/controllers.(*RabbitmqClusterReconciler)	NoError	{"kind":"ConfigMap","apiVersion":"v1","metadata":{"name":"rabbitmq-cluster-plugins-conf","namespace":"default","selfLink":"/api/v1/namespaces/default/configmaps/rabbitmq-cluster-plugins-conf","uid":"a164075b-0562-47ac-a577-99aa8651ec40","resourceVersion":"709","creationTimestamp":"2022-03-18T18:00:38Z","labels":{"app.kubernetes.io/component":"rabbitmq","app.kubernetes.io/name":"rabbitmq-cluster","app.kubernetes.io/part-of":"rabbitmq"},"ownerReferences":[{"apiVersion":"rabbitmq.com/v1beta1","kind":"RabbitmqCluster","name":"rabbitmq-cluster","uid":"18d9928b-0d1c-47be-80ec-20960d053827","controller":true,"blockOwnerDeletion":true}],"managedFields":[{"manager":"manager","operation":"Update","apiVersion":"v1","time":"2022-03-18T18:00:38Z","fieldsType":"FieldsV1","fieldsV1":{"f:data":{".":{},"f:enabled_plugins":{}},"f:metadata":{"f:labels":{".":{},"f:app.kubernetes.io/component":{},"f:app.kubernetes.io/name":{},"f:app.kubernetes.io/part-of":{}},"f:ownerReferences":{".":{},"k:{\"uid\":\"18d9928b-0d1c-47be-80ec-20960d053827\"}":{".":{},"f:apiVersion":{},"f:blockOwnerDeletion":{},"f:controller":{},"f:kind":{},"f:name":{},"f:uid":{}}}}}}]},"data":{"enabled_plugins":"[rabbitmq_peer_discovery_k8s,rabbitmq_prometheus,rabbitmq_management]."}}
2022/03/18 18:00:38 learn_server.go:291: [SIEVE-AFTER-READ]	Get	true	configmap	default	rabbitmq-cluster-server-conf	github.com/rabbitmq/cluster-operator/controllers.(*RabbitmqClusterReconciler)	NoError	{"kind":"ConfigMap","apiVersion":"v1","metadata":{"name":"rabbitmq-cluster-server-conf","namespace":"default","selfLink":"/api/v1/namespaces/default/configmaps/rabbitmq-cluster-server-conf","uid":"22474f2b-8454-44b7-8079-8990223969cc","resourceVersion":"714","creationTimestamp":"2022-03-18T18:00:38Z","labels":{"app.kubernetes.io/component":"rabbitmq","app.kubernetes.io/name":"rabbitmq-cluster","app.kubernetes.io/part-of":"rabbitmq"},"ownerReferences":[{"apiVersion":"rabbitmq.com/v1beta1","kind":"RabbitmqCluster","name":"rabbitmq-cluster","uid":"18d9928b-0d1c-47be-80ec-20960d053827","controller":true,"blockOwnerDeletion":true}],"managedFields":[{"manager":"manager","operation":"Update","apiVersion":"v1","time":"2022-03-18T18:00:38Z","fieldsType":"FieldsV1","fieldsV1":{"f:data":{".":{},"f:operatorDefaults.conf":{},"f:userDefinedConfiguration.conf":{}},"f:metadata":{"f:labels":{".":{},"f:app.kubernetes.io/component":{},"f:app.kubernetes.io/name":{},"f:app.kubernetes.io/part-of":{}},"f:ownerReferences":{".":{},"k:{\"uid\":\"18d9928b-0d1c-47be-80ec-20960d053827\"}":{".":{},"f:apiVersion":{},"f:blockOwnerDeletion":{},"f:controller":{},"f:kind":{},"f:name":{},"f:uid":{}}}}}}]},"data":{"operatorDefaults.conf":"cluster_formation.peer_discovery_backend             = rabbit_peer_discovery_k8s\ncluster_formation.k8s.host                           = kubernetes.default\ncluster_formation.k8s.address_type                   = hostname\ncluster_partition_handling                           = pause_minority\nqueue_master_locator                                 = min-masters\ndisk_free_limit.absolute                             = 2GB\ncluster_formation.randomized_startup_delay_range.min = 5\ncluster_formation.randomized_startup_delay_range.max = 30\ncluster_name                                         = rabbitmq-cluster\n","userDefinedConfiguration.conf":"total_memory_available_override_value = 1717986919\n"}}
2022/03/18 18:00:38 learn_server.go:291: [SIEVE-AFTER-READ]	Get	true	serviceaccount	default	rabbitmq-cluster-server	github.com/rabbitmq/cluster-operator/controllers.(*RabbitmqClusterReconciler)	NoError	{"kind":"ServiceAccount","apiVersion":"v1","metadata":{"name":"rabbitmq-cluster-server","namespace":"default","selfLink":"/api/v1/namespaces/default/serviceaccounts/rabbitmq-cluster-server","uid":"731589b5-ac97-4774-bee4-008949b54734","resourceVersion":"722","creationTimestamp":"2022-03-18T18:00:38Z","labels":{"app.kubernetes.io/component":"rabbitmq","app.kubernetes.io/name":"rabbitmq-cluster","app.kubernetes.io/part-of":"rabbitmq"},"ownerReferences":[{"apiVersion":"rabbitmq.com/v1beta1","kind":"RabbitmqCluster","name":"rabbitmq-cluster","uid":"18d9928b-0d1c-47be-80ec-20960d053827","controller":true,"blockOwnerDeletion":true}],"managedFields":[{"manager":"kube-controller-manager","operation":"Update","apiVersion":"v1","time":"2022-03-18T18:00:38Z","fieldsType":"FieldsV1","fieldsV1":{"f:secrets":{".":{},"k:{\"name\":\"rabbitmq-cluster-server-token-rhzq9\"}":{".":{},"f:name":{}}}}},{"manager":"manager","operation":"Update","apiVersion":"v1","time":"2022-03-18T18:00:38Z","fieldsType":"FieldsV1","fieldsV1":{"f:metadata":{"f:labels":{".":{},"f:app.kubernetes.io/component":{},"f:app.kubernetes.io/name":{},"f:app.kubernetes.io/part-of":{}},"f:ownerReferences":{".":{},"k:{\"uid\":\"18d9928b-0d1c-47be-80ec-20960d053827\"}":{".":{},"f:apiVersion":{},"f:blockOwnerDeletion":{},"f:controller":{},"f:kind":{},"f:name":{},"f:uid":{}}}}}}]},"secrets":[{"name":"rabbitmq-cluster-server-token-rhzq9"}]}
2022/03/18 18:00:38 learn_server.go:291: [SIEVE-AFTER-READ]	Get	true	role	default	rabbitmq-cluster-peer-discovery	github.com/rabbitmq/cluster-operator/controllers.(*RabbitmqClusterReconciler)	NoError	{"kind":"Role","apiVersion":"rbac.authorization.k8s.io/v1","metadata":{"name":"rabbitmq-cluster-peer-discovery","namespace":"default","selfLink":"/apis/rbac.authorization.k8s.io/v1/namespaces/default/roles/rabbitmq-cluster-peer-discovery","uid":"52c80b50-4fdd-4089-bbfd-9756465953f2","resourceVersion":"723","creationTimestamp":"2022-03-18T18:00:38Z","labels":{"app.kubernetes.io/component":"rabbitmq","app.kubernetes.io/name":"rabbitmq-cluster","app.kubernetes.io/part-of":"rabbitmq"},"ownerReferences":[{"apiVersion":"rabbitmq.com/v1beta1","kind":"RabbitmqCluster","name":"rabbitmq-cluster","uid":"18d9928b-0d1c-47be-80ec-20960d053827","controller":true,"blockOwnerDeletion":true}],"managedFields":[{"manager":"manager","operation":"Update","apiVersion":"rbac.authorization.k8s.io/v1","time":"2022-03-18T18:00:38Z","fieldsType":"FieldsV1","fieldsV1":{"f:metadata":{"f:labels":{".":{},"f:app.kubernetes.io/component":{},"f:app.kubernetes.io/name":{},"f:app.kubernetes.io/part-of":{}},"f:ownerReferences":{".":{},"k:{\"uid\":\"18d9928b-0d1c-47be-80ec-20960d053827\"}":{".":{},"f:apiVersion":{},"f:blockOwnerDeletion":{},"f:controller":{},"f:kind":{},"f:name":{},"f:uid":{}}}},"f:rules":{}}}]},"rules":[{"verbs":["get"],"apiGroups":[""],"resources":["endpoints"]},{"verbs":["create"],"apiGroups":[""],"resources":["events"]}]}
2022/03/18 18:00:38 learn_server.go:291: [SIEVE-AFTER-READ]	Get	true	rolebinding	default	rabbitmq-cluster-server	github.com/rabbitmq/cluster-operator/controllers.(*RabbitmqClusterReconciler)	NoError	{"kind":"RoleBinding","apiVersion":"rbac.authorization.k8s.io/v1","metadata":{"name":"rabbitmq-cluster-server","namespace":"default","selfLink":"/apis/rbac.authorization.k8s.io/v1/namespaces/default/rolebindings/rabbitmq-cluster-server","uid":"495e9f7c-a20d-4515-86b0-34149a855034","resourceVersion":"725","creationTimestamp":"2022-03-18T18:00:38Z","labels":{"app.kubernetes.io/component":"rabbitmq","app.kubernetes.io/name":"rabbitmq-cluster","app.kubernetes.io/part-of":"rabbitmq"},"ownerReferences":[{"apiVersion":"rabbitmq.com/v1beta1","kind":"RabbitmqCluster","name":"rabbitmq-cluster","uid":"18d9928b-0d1c-47be-80ec-20960d053827","controller":true,"blockOwnerDeletion":true}],"managedFields":[{"manager":"manager","operation":"Update","apiVersion":"rbac.authorization.k8s.io/v1","time":"2022-03-18T18:00:38Z","fieldsType":"FieldsV1","fieldsV1":{"f:metadata":{"f:labels":{".":{},"f:app.kubernetes.io/component":{},"f:app.kubernetes.io/name":{},"f:app.kubernetes.io/part-of":{}},"f:ownerReferences":{".":{},"k:{\"uid\":\"18d9928b-0d1c-47be-80ec-20960d053827\"}":{".":{},"f:apiVersion":{},"f:blockOwnerDeletion":{},"f:controller":{},"f:kind":{},"f:name":{},"f:uid":{}}}},"f:roleRef":{"f:apiGroup":{},"f:kind":{},"f:name":{}},"f:subjects":{}}}]},"subjects":[{"kind":"ServiceAccount","name":"rabbitmq-cluster-server"}],"roleRef":{"apiGroup":"rbac.authorization.k8s.io","kind":"Role","name":"rabbitmq-cluster-peer-discovery"}}
2022/03/18 18:00:38 learn_server.go:291: [SIEVE-AFTER-READ]	Get	true	statefulset	default	rabbitmq-cluster-server	github.com/rabbitmq/cluster-operator/controllers.(*RabbitmqClusterReconciler)	NoError	{"kind":"StatefulSet","apiVersion":"apps/v1","metadata":{"name":"rabbitmq-cluster-server","namespace":"default","selfLink":"/apis/apps/v1/namespaces/default/statefulsets/rabbitmq-cluster-server","uid":"cb5c43bc-6ee7-481c-ab01-6f3acffdd3c8","resourceVersion":"744","generation":1,"creationTimestamp":"2022-03-18T18:00:38Z","labels":{"app.kubernetes.io/component":"rabbitmq","app.kubernetes.io/name":"rabbitmq-cluster","app.kubernetes.io/part-of":"rabbitmq"},"annotations":{"rabbitmq.com/createdAt":"2022-03-18T18:00:38Z"},"ownerReferences":[{"apiVersion":"rabbitmq.com/v1beta1","kind":"RabbitmqCluster","name":"rabbitmq-cluster","uid":"18d9928b-0d1c-47be-80ec-20960d053827","controller":true,"blockOwnerDeletion":true}],"managedFields":[{"manager":"kube-controller-manager","operation":"Update","apiVersion":"apps/v1","time":"2022-03-18T18:00:38Z","fieldsType":"FieldsV1","fieldsV1":{"f:status":{"f:collisionCount":{},"f:currentReplicas":{},"f:currentRevision":{},"f:observedGeneration":{},"f:replicas":{},"f:updateRevision":{},"f:updatedReplicas":{}}}},{"manager":"manager","operation":"Update","apiVersion":"apps/v1","time":"2022-03-18T18:00:38Z","fieldsType":"FieldsV1","fieldsV1":{"f:metadata":{"f:annotations":{".":{},"f:rabbitmq.com/createdAt":{}},"f:labels":{".":{},"f:app.kubernetes.io/component":{},"f:app.kubernetes.io/name":{},"f:app.kubernetes.io/part-of":{}},"f:ownerReferences":{".":{},"k:{\"uid\":\"18d9928b-0d1c-47be-80ec-20960d053827\"}":{".":{},"f:apiVersion":{},"f:blockOwnerDeletion":{},"f:controller":{},"f:kind":{},"f:name":{},"f:uid":{}}}},"f:spec":{"f:podManagementPolicy":{},"f:replicas":{},"f:revisionHistoryLimit":{},"f:selector":{"f:matchLabels":{".":{},"f:app.kubernetes.io/name":{}}},"f:serviceName":{},"f:template":{"f:metadata":{"f:annotations":{".":{},"f:prometheus.io/port":{},"f:prometheus.io/scrape":{}},"f:labels":{".":{},"f:app.kubernetes.io/component":{},"f:app.kubernetes.io/name":{},"f:app.kubernetes.io/part-of":{}}},"f:spec":{"f:automountServiceAccountToken":{},"f:containers":{"k:{\"name\":\"rabbitmq\"}":{".":{},"f:env":{".":{},"k:{\"name\":\"K8S_HOSTNAME_SUFFIX\"}":{".":{},"f:name":{},"f:value":{}},"k:{\"name\":\"K8S_SERVICE_NAME\"}":{".":{},"f:name":{},"f:value":{}},"k:{\"name\":\"MY_POD_NAME\"}":{".":{},"f:name":{},"f:valueFrom":{".":{},"f:fieldRef":{".":{},"f:apiVersion":{},"f:fieldPath":{}}}},"k:{\"name\":\"MY_POD_NAMESPACE\"}":{".":{},"f:name":{},"f:valueFrom":{".":{},"f:fieldRef":{".":{},"f:apiVersion":{},"f:fieldPath":{}}}},"k:{\"name\":\"RABBITMQ_ENABLED_PLUGINS_FILE\"}":{".":{},"f:name":{},"f:value":{}},"k:{\"name\":\"RABBITMQ_NODENAME\"}":{".":{},"f:name":{},"f:value":{}},"k:{\"name\":\"RABBITMQ_USE_LONGNAME\"}":{".":{},"f:name":{},"f:value":{}}},"f:image":{},"f:imagePullPolicy":{},"f:lifecycle":{".":{},"f:preStop":{".":{},"f:exec":{".":{},"f:command":{}}}},"f:name":{},"f:ports":{".":{},"k:{\"containerPort\":4369,\"protocol\":\"TCP\"}":{".":{},"f:containerPort":{},"f:name":{},"f:protocol":{}},"k:{\"containerPort\":5672,\"protocol\":\"TCP\"}":{".":{},"f:containerPort":{},"f:name":{},"f:protocol":{}},"k:{\"containerPort\":15672,\"protocol\":\"TCP\"}":{".":{},"f:containerPort":{},"f:name":{},"f:protocol":{}},"k:{\"containerPort\":15692,\"protocol\":\"TCP\"}":{".":{},"f:containerPort":{},"f:name":{},"f:protocol":{}}},"f:readinessProbe":{".":{},"f:failureThreshold":{},"f:initialDelaySeconds":{},"f:periodSeconds":{},"f:successThreshold":{},"f:tcpSocket":{".":{},"f:port":{}},"f:timeoutSeconds":{}},"f:resources":{".":{},"f:limits":{".":{},"f:cpu":{},"f:memory":{}},"f:requests":{".":{},"f:cpu":{},"f:memory":{}}},"f:terminationMessagePath":{},"f:terminationMessagePolicy":{},"f:volumeMounts":{".":{},"k:{\"mountPath\":\"/etc/pod-info/\"}":{".":{},"f:mountPath":{},"f:name":{}},"k:{\"mountPath\":\"/etc/rabbitmq/conf.d/10-operatorDefaults.conf\"}":{".":{},"f:mountPath":{},"f:name":{},"f:subPath":{}},"k:{\"mountPath\":\"/etc/rabbitmq/conf.d/11-default_user.conf\"}":{".":{},"f:mountPath":{},"f:name":{},"f:subPath":{}},"k:{\"mountPath\":\"/etc/rabbitmq/conf.d/90-userDefinedConfiguration.conf\"}":{".":{},"f:mountPath":{},"f:name":{},"f:subPath":{}},"k:{\"mountPath\":\"/operator\"}":{".":{},"f:mountPath":{},"f:name":{}},"k:{\"mountPath\":\"/var/lib/rabbitmq/\"}":{".":{},"f:mountPath":{},"f:name":{}},"k:{\"mountPath\":\"/var/lib/rabbitmq/mnesia/\"}":{".":{},"f:mountPath":{},"f:name":{}}}}},"f:dnsPolicy":{},"f:initContainers":{".":{},"k:{\"name\":\"setup-container\"}":{".":{},"f:command":{},"f:image":{},"f:imagePullPolicy":{},"f:name":{},"f:resources":{".":{},"f:limits":{".":{},"f:cpu":{},"f:memory":{}},"f:requests":{".":{},"f:cpu":{},"f:memory":{}}},"f:securityContext":{".":{},"f:capabilities":{".":{},"f:drop":{}},"f:runAsUser":{}},"f:terminationMessagePath":{},"f:terminationMessagePolicy":{},"f:volumeMounts":{".":{},"k:{\"mountPath\":\"/operator\"}":{".":{},"f:mountPath":{},"f:name":{}},"k:{\"mountPath\":\"/tmp/default_user.conf\"}":{".":{},"f:mountPath":{},"f:name":{},"f:subPath":{}},"k:{\"mountPath\":\"/tmp/erlang-cookie-secret/\"}":{".":{},"f:mountPath":{},"f:name":{}},"k:{\"mountPath\":\"/tmp/rabbitmq-plugins/\"}":{".":{},"f:mountPath":{},"f:name":{}},"k:{\"mountPath\":\"/var/lib/rabbitmq/\"}":{".":{},"f:mountPath":{},"f:name":{}},"k:{\"mountPath\":\"/var/lib/rabbitmq/mnesia/\"}":{".":{},"f:mountPath":{},"f:name":{}}}}},"f:restartPolicy":{},"f:schedulerName":{},"f:securityContext":{".":{},"f:fsGroup":{},"f:runAsGroup":{},"f:runAsUser":{}},"f:serviceAccount":{},"f:serviceAccountName":{},"f:terminationGracePeriodSeconds":{},"f:topologySpreadConstraints":{".":{},"k:{\"topologyKey\":\"topology.kubernetes.io/zone\",\"whenUnsatisfiable\":\"ScheduleAnyway\"}":{".":{},"f:labelSelector":{".":{},"f:matchLabels":{".":{},"f:app.kubernetes.io/name":{}}},"f:maxSkew":{},"f:topologyKey":{},"f:whenUnsatisfiable":{}}},"f:volumes":{".":{},"k:{\"name\":\"erlang-cookie-secret\"}":{".":{},"f:name":{},"f:secret":{".":{},"f:defaultMode":{},"f:secretName":{}}},"k:{\"name\":\"plugins-conf\"}":{".":{},"f:configMap":{".":{},"f:defaultMode":{},"f:name":{}},"f:name":{}},"k:{\"name\":\"pod-info\"}":{".":{},"f:downwardAPI":{".":{},"f:defaultMode":{},"f:items":{}},"f:name":{}},"k:{\"name\":\"rabbitmq-confd\"}":{".":{},"f:name":{},"f:projected":{".":{},"f:defaultMode":{},"f:sources":{}}},"k:{\"name\":\"rabbitmq-erlang-cookie\"}":{".":{},"f:emptyDir":{},"f:name":{}},"k:{\"name\":\"rabbitmq-plugins\"}":{".":{},"f:emptyDir":{},"f:name":{}}}}},"f:updateStrategy":{"f:rollingUpdate":{".":{},"f:partition":{}},"f:type":{}},"f:volumeClaimTemplates":{}}}}]},"spec":{"replicas":1,"selector":{"matchLabels":{"app.kubernetes.io/name":"rabbitmq-cluster"}},"template":{"metadata":{"creationTimestamp":null,"labels":{"app.kubernetes.io/component":"rabbitmq","app.kubernetes.io/name":"rabbitmq-cluster","app.kubernetes.io/part-of":"rabbitmq"},"annotations":{"prometheus.io/port":"15692","prometheus.io/scrape":"true"}},"spec":{"volumes":[{"name":"plugins-conf","configMap":{"name":"rabbitmq-cluster-plugins-conf","defaultMode":420}},{"name":"rabbitmq-confd","projected":{"sources":[{"secret":{"name":"rabbitmq-cluster-default-user","items":[{"key":"default_user.conf","path":"default_user.conf"}]}},{"configMap":{"name":"rabbitmq-cluster-server-conf","items":[{"key":"operatorDefaults.conf","path":"operatorDefaults.conf"},{"key":"userDefinedConfiguration.conf","path":"userDefinedConfiguration.conf"}]}}],"defaultMode":420}},{"name":"rabbitmq-erlang-cookie","emptyDir":{}},{"name":"erlang-cookie-secret","secret":{"secretName":"rabbitmq-cluster-erlang-cookie","defaultMode":420}},{"name":"rabbitmq-plugins","emptyDir":{}},{"name":"pod-info","downwardAPI":{"items":[{"path":"skipPreStopChecks","fieldRef":{"apiVersion":"v1","fieldPath":"metadata.labels['skipPreStopChecks']"}}],"defaultMode":420}}],"initContainers":[{"name":"setup-container","image":"rabbitmq:3.8.12-management","command":["sh","-c","cp /tmp/erlang-cookie-secret/.erlang.cookie /var/lib/rabbitmq/.erlang.cookie \u0026\u0026 chown 999:999 /var/lib/rabbitmq/.erlang.cookie \u0026\u0026 chmod 600 /var/lib/rabbitmq/.erlang.cookie ; cp /tmp/rabbitmq-plugins/enabled_plugins /operator/enabled_plugins \u0026\u0026 chown 999:999 /operator/enabled_plugins ; chown 999:999 /var/lib/rabbitmq/mnesia/ ; echo '[default]' \u003e /var/lib/rabbitmq/.rabbitmqadmin.conf \u0026\u0026 sed -e 's/default_user/username/' -e 's/default_pass/password/' /tmp/default_user.conf \u003e\u003e /var/lib/rabbitmq/.rabbitmqadmin.conf \u0026\u0026 chown 999:999 /var/lib/rabbitmq/.rabbitmqadmin.conf \u0026\u0026 chmod 600 /var/lib/rabbitmq/.rabbitmqadmin.conf"],"resources":{"limits":{"cpu":"100m","memory":"500Mi"},"requests":{"cpu":"100m","memory":"500Mi"}},"volumeMounts":[{"name":"plugins-conf","mountPath":"/tmp/rabbitmq-plugins/"},{"name":"rabbitmq-erlang-cookie","mountPath":"/var/lib/rabbitmq/"},{"name":"erlang-cookie-secret","mountPath":"/tmp/erlang-cookie-secret/"},{"name":"rabbitmq-plugins","mountPath":"/operator"},{"name":"persistence","mountPath":"/var/lib/rabbitmq/mnesia/"},{"name":"rabbitmq-confd","mountPath":"/tmp/default_user.conf","subPath":"default_user.conf"}],"terminationMessagePath":"/dev/termination-log","terminationMessagePolicy":"File","imagePullPolicy":"IfNotPresent","securityContext":{"capabilities":{"drop":["FSETID","KILL","SETGID","SETUID","SETPCAP","NET_BIND_SERVICE","NET_RAW","SYS_CHROOT","MKNOD","AUDIT_WRITE","SETFCAP"]},"runAsUser":0}}],"containers":[{"name":"rabbitmq","image":"rabbitmq:3.8.12-management","ports":[{"name":"epmd","containerPort":4369,"protocol":"TCP"},{"name":"amqp","containerPort":5672,"protocol":"TCP"},{"name":"management","containerPort":15672,"protocol":"TCP"},{"name":"prometheus","containerPort":15692,"protocol":"TCP"}],"env":[{"name":"MY_POD_NAME","valueFrom":{"fieldRef":{"apiVersion":"v1","fieldPath":"metadata.name"}}},{"name":"MY_POD_NAMESPACE","valueFrom":{"fieldRef":{"apiVersion":"v1","fieldPath":"metadata.namespace"}}},{"name":"RABBITMQ_ENABLED_PLUGINS_FILE","value":"/operator/enabled_plugins"},{"name":"K8S_SERVICE_NAME","value":"rabbitmq-cluster-nodes"},{"name":"RABBITMQ_USE_LONGNAME","value":"true"},{"name":"RABBITMQ_NODENAME","value":"rabbit@$(MY_POD_NAME).$(K8S_SERVICE_NAME).$(MY_POD_NAMESPACE)"},{"name":"K8S_HOSTNAME_SUFFIX","value":".$(K8S_SERVICE_NAME).$(MY_POD_NAMESPACE)"}],"resources":{"limits":{"cpu":"2","memory":"2Gi"},"requests":{"cpu":"1","memory":"2Gi"}},"volumeMounts":[{"name":"rabbitmq-erlang-cookie","mountPath":"/var/lib/rabbitmq/"},{"name":"persistence","mountPath":"/var/lib/rabbitmq/mnesia/"},{"name":"rabbitmq-plugins","mountPath":"/operator"},{"name":"rabbitmq-confd","mountPath":"/etc/rabbitmq/conf.d/10-operatorDefaults.conf","subPath":"operatorDefaults.conf"},{"name":"rabbitmq-confd","mountPath":"/etc/rabbitmq/conf.d/11-default_user.conf","subPath":"default_user.conf"},{"name":"rabbitmq-confd","mountPath":"/etc/rabbitmq/conf.d/90-userDefinedConfiguration.conf","subPath":"userDefinedConfiguration.conf"},{"name":"pod-info","mountPath":"/etc/pod-info/"}],"readinessProbe":{"tcpSocket":{"port":"amqp"},"initialDelaySeconds":10,"timeoutSeconds":5,"periodSeconds":10,"successThreshold":1,"failureThreshold":3},"lifecycle":{"preStop":{"exec":{"command":["/bin/bash","-c","if [ ! -z \"$(cat /etc/pod-info/skipPreStopChecks)\" ]; then exit 0; fi; rabbitmq-upgrade await_online_quorum_plus_one -t 604800; rabbitmq-upgrade await_online_synchronized_mirror -t 604800; rabbitmq-upgrade drain -t 604800"]}}},"terminationMessagePath":"/dev/termination-log","terminationMessagePolicy":"File","imagePullPolicy":"IfNotPresent"}],"restartPolicy":"Always","terminationGracePeriodSeconds":604800,"dnsPolicy":"ClusterFirst","serviceAccountName":"rabbitmq-cluster-server","serviceAccount":"rabbitmq-cluster-server","automountServiceAccountToken":true,"securityContext":{"runAsUser":999,"runAsGroup":999,"fsGroup":999},"schedulerName":"default-scheduler","topologySpreadConstraints":[{"maxSkew":1,"topologyKey":"topology.kubernetes.io/zone","whenUnsatisfiable":"ScheduleAnyway","labelSelector":{"matchLabels":{"app.kubernetes.io/name":"rabbitmq-cluster"}}}]}},"volumeClaimTemplates":[{"metadata":{"name":"persistence","namespace":"default","creationTimestamp":null,"labels":{"app.kubernetes.io/component":"rabbitmq","app.kubernetes.io/name":"rabbitmq-cluster","app.kubernetes.io/part-of":"rabbitmq"},"ownerReferences":[{"apiVersion":"rabbitmq.com/v1beta1","kind":"RabbitmqCluster","name":"rabbitmq-cluster","uid":"18d9928b-0d1c-47be-80ec-20960d053827","controller":true,"blockOwnerDeletion":false}]},"spec":{"accessModes":["ReadWriteOnce"],"resources":{"requests":{"storage":"10Gi"}},"volumeMode":"Filesystem"},"status":{"phase":"Pending"}}],"serviceName":"rabbitmq-cluster-nodes","podManagementPolicy":"Parallel","updateStrategy":{"type":"RollingUpdate","rollingUpdate":{"partition":0}},"revisionHistoryLimit":10},"status":{"observedGeneration":1,"replicas":1,"currentReplicas":1,"updatedReplicas":1,"currentRevision":"rabbitmq-cluster-server-5f8b8665fb","updateRevision":"rabbitmq-cluster-server-5f8b8665fb","collisionCount":0}}
2022/03/18 18:00:38 learn_server.go:291: [SIEVE-AFTER-READ]	Get	true	statefulset	default	rabbitmq-cluster-server	github.com/rabbitmq/cluster-operator/controllers.(*RabbitmqClusterReconciler)	NoError	{"kind":"StatefulSet","apiVersion":"apps/v1","metadata":{"name":"rabbitmq-cluster-server","namespace":"default","selfLink":"/apis/apps/v1/namespaces/default/statefulsets/rabbitmq-cluster-server","uid":"cb5c43bc-6ee7-481c-ab01-6f3acffdd3c8","resourceVersion":"744","generation":1,"creationTimestamp":"2022-03-18T18:00:38Z","labels":{"app.kubernetes.io/component":"rabbitmq","app.kubernetes.io/name":"rabbitmq-cluster","app.kubernetes.io/part-of":"rabbitmq"},"annotations":{"rabbitmq.com/createdAt":"2022-03-18T18:00:38Z"},"ownerReferences":[{"apiVersion":"rabbitmq.com/v1beta1","kind":"RabbitmqCluster","name":"rabbitmq-cluster","uid":"18d9928b-0d1c-47be-80ec-20960d053827","controller":true,"blockOwnerDeletion":true}],"managedFields":[{"manager":"kube-controller-manager","operation":"Update","apiVersion":"apps/v1","time":"2022-03-18T18:00:38Z","fieldsType":"FieldsV1","fieldsV1":{"f:status":{"f:collisionCount":{},"f:currentReplicas":{},"f:currentRevision":{},"f:observedGeneration":{},"f:replicas":{},"f:updateRevision":{},"f:updatedReplicas":{}}}},{"manager":"manager","operation":"Update","apiVersion":"apps/v1","time":"2022-03-18T18:00:38Z","fieldsType":"FieldsV1","fieldsV1":{"f:metadata":{"f:annotations":{".":{},"f:rabbitmq.com/createdAt":{}},"f:labels":{".":{},"f:app.kubernetes.io/component":{},"f:app.kubernetes.io/name":{},"f:app.kubernetes.io/part-of":{}},"f:ownerReferences":{".":{},"k:{\"uid\":\"18d9928b-0d1c-47be-80ec-20960d053827\"}":{".":{},"f:apiVersion":{},"f:blockOwnerDeletion":{},"f:controller":{},"f:kind":{},"f:name":{},"f:uid":{}}}},"f:spec":{"f:podManagementPolicy":{},"f:replicas":{},"f:revisionHistoryLimit":{},"f:selector":{"f:matchLabels":{".":{},"f:app.kubernetes.io/name":{}}},"f:serviceName":{},"f:template":{"f:metadata":{"f:annotations":{".":{},"f:prometheus.io/port":{},"f:prometheus.io/scrape":{}},"f:labels":{".":{},"f:app.kubernetes.io/component":{},"f:app.kubernetes.io/name":{},"f:app.kubernetes.io/part-of":{}}},"f:spec":{"f:automountServiceAccountToken":{},"f:containers":{"k:{\"name\":\"rabbitmq\"}":{".":{},"f:env":{".":{},"k:{\"name\":\"K8S_HOSTNAME_SUFFIX\"}":{".":{},"f:name":{},"f:value":{}},"k:{\"name\":\"K8S_SERVICE_NAME\"}":{".":{},"f:name":{},"f:value":{}},"k:{\"name\":\"MY_POD_NAME\"}":{".":{},"f:name":{},"f:valueFrom":{".":{},"f:fieldRef":{".":{},"f:apiVersion":{},"f:fieldPath":{}}}},"k:{\"name\":\"MY_POD_NAMESPACE\"}":{".":{},"f:name":{},"f:valueFrom":{".":{},"f:fieldRef":{".":{},"f:apiVersion":{},"f:fieldPath":{}}}},"k:{\"name\":\"RABBITMQ_ENABLED_PLUGINS_FILE\"}":{".":{},"f:name":{},"f:value":{}},"k:{\"name\":\"RABBITMQ_NODENAME\"}":{".":{},"f:name":{},"f:value":{}},"k:{\"name\":\"RABBITMQ_USE_LONGNAME\"}":{".":{},"f:name":{},"f:value":{}}},"f:image":{},"f:imagePullPolicy":{},"f:lifecycle":{".":{},"f:preStop":{".":{},"f:exec":{".":{},"f:command":{}}}},"f:name":{},"f:ports":{".":{},"k:{\"containerPort\":4369,\"protocol\":\"TCP\"}":{".":{},"f:containerPort":{},"f:name":{},"f:protocol":{}},"k:{\"containerPort\":5672,\"protocol\":\"TCP\"}":{".":{},"f:containerPort":{},"f:name":{},"f:protocol":{}},"k:{\"containerPort\":15672,\"protocol\":\"TCP\"}":{".":{},"f:containerPort":{},"f:name":{},"f:protocol":{}},"k:{\"containerPort\":15692,\"protocol\":\"TCP\"}":{".":{},"f:containerPort":{},"f:name":{},"f:protocol":{}}},"f:readinessProbe":{".":{},"f:failureThreshold":{},"f:initialDelaySeconds":{},"f:periodSeconds":{},"f:successThreshold":{},"f:tcpSocket":{".":{},"f:port":{}},"f:timeoutSeconds":{}},"f:resources":{".":{},"f:limits":{".":{},"f:cpu":{},"f:memory":{}},"f:requests":{".":{},"f:cpu":{},"f:memory":{}}},"f:terminationMessagePath":{},"f:terminationMessagePolicy":{},"f:volumeMounts":{".":{},"k:{\"mountPath\":\"/etc/pod-info/\"}":{".":{},"f:mountPath":{},"f:name":{}},"k:{\"mountPath\":\"/etc/rabbitmq/conf.d/10-operatorDefaults.conf\"}":{".":{},"f:mountPath":{},"f:name":{},"f:subPath":{}},"k:{\"mountPath\":\"/etc/rabbitmq/conf.d/11-default_user.conf\"}":{".":{},"f:mountPath":{},"f:name":{},"f:subPath":{}},"k:{\"mountPath\":\"/etc/rabbitmq/conf.d/90-userDefinedConfiguration.conf\"}":{".":{},"f:mountPath":{},"f:name":{},"f:subPath":{}},"k:{\"mountPath\":\"/operator\"}":{".":{},"f:mountPath":{},"f:name":{}},"k:{\"mountPath\":\"/var/lib/rabbitmq/\"}":{".":{},"f:mountPath":{},"f:name":{}},"k:{\"mountPath\":\"/var/lib/rabbitmq/mnesia/\"}":{".":{},"f:mountPath":{},"f:name":{}}}}},"f:dnsPolicy":{},"f:initContainers":{".":{},"k:{\"name\":\"setup-container\"}":{".":{},"f:command":{},"f:image":{},"f:imagePullPolicy":{},"f:name":{},"f:resources":{".":{},"f:limits":{".":{},"f:cpu":{},"f:memory":{}},"f:requests":{".":{},"f:cpu":{},"f:memory":{}}},"f:securityContext":{".":{},"f:capabilities":{".":{},"f:drop":{}},"f:runAsUser":{}},"f:terminationMessagePath":{},"f:terminationMessagePolicy":{},"f:volumeMounts":{".":{},"k:{\"mountPath\":\"/operator\"}":{".":{},"f:mountPath":{},"f:name":{}},"k:{\"mountPath\":\"/tmp/default_user.conf\"}":{".":{},"f:mountPath":{},"f:name":{},"f:subPath":{}},"k:{\"mountPath\":\"/tmp/erlang-cookie-secret/\"}":{".":{},"f:mountPath":{},"f:name":{}},"k:{\"mountPath\":\"/tmp/rabbitmq-plugins/\"}":{".":{},"f:mountPath":{},"f:name":{}},"k:{\"mountPath\":\"/var/lib/rabbitmq/\"}":{".":{},"f:mountPath":{},"f:name":{}},"k:{\"mountPath\":\"/var/lib/rabbitmq/mnesia/\"}":{".":{},"f:mountPath":{},"f:name":{}}}}},"f:restartPolicy":{},"f:schedulerName":{},"f:securityContext":{".":{},"f:fsGroup":{},"f:runAsGroup":{},"f:runAsUser":{}},"f:serviceAccount":{},"f:serviceAccountName":{},"f:terminationGracePeriodSeconds":{},"f:topologySpreadConstraints":{".":{},"k:{\"topologyKey\":\"topology.kubernetes.io/zone\",\"whenUnsatisfiable\":\"ScheduleAnyway\"}":{".":{},"f:labelSelector":{".":{},"f:matchLabels":{".":{},"f:app.kubernetes.io/name":{}}},"f:maxSkew":{},"f:topologyKey":{},"f:whenUnsatisfiable":{}}},"f:volumes":{".":{},"k:{\"name\":\"erlang-cookie-secret\"}":{".":{},"f:name":{},"f:secret":{".":{},"f:defaultMode":{},"f:secretName":{}}},"k:{\"name\":\"plugins-conf\"}":{".":{},"f:configMap":{".":{},"f:defaultMode":{},"f:name":{}},"f:name":{}},"k:{\"name\":\"pod-info\"}":{".":{},"f:downwardAPI":{".":{},"f:defaultMode":{},"f:items":{}},"f:name":{}},"k:{\"name\":\"rabbitmq-confd\"}":{".":{},"f:name":{},"f:projected":{".":{},"f:defaultMode":{},"f:sources":{}}},"k:{\"name\":\"rabbitmq-erlang-cookie\"}":{".":{},"f:emptyDir":{},"f:name":{}},"k:{\"name\":\"rabbitmq-plugins\"}":{".":{},"f:emptyDir":{},"f:name":{}}}}},"f:updateStrategy":{"f:rollingUpdate":{".":{},"f:partition":{}},"f:type":{}},"f:volumeClaimTemplates":{}}}}]},"spec":{"replicas":1,"selector":{"matchLabels":{"app.kubernetes.io/name":"rabbitmq-cluster"}},"template":{"metadata":{"creationTimestamp":null,"labels":{"app.kubernetes.io/component":"rabbitmq","app.kubernetes.io/name":"rabbitmq-cluster","app.kubernetes.io/part-of":"rabbitmq"},"annotations":{"prometheus.io/port":"15692","prometheus.io/scrape":"true"}},"spec":{"volumes":[{"name":"plugins-conf","configMap":{"name":"rabbitmq-cluster-plugins-conf","defaultMode":420}},{"name":"rabbitmq-confd","projected":{"sources":[{"secret":{"name":"rabbitmq-cluster-default-user","items":[{"key":"default_user.conf","path":"default_user.conf"}]}},{"configMap":{"name":"rabbitmq-cluster-server-conf","items":[{"key":"operatorDefaults.conf","path":"operatorDefaults.conf"},{"key":"userDefinedConfiguration.conf","path":"userDefinedConfiguration.conf"}]}}],"defaultMode":420}},{"name":"rabbitmq-erlang-cookie","emptyDir":{}},{"name":"erlang-cookie-secret","secret":{"secretName":"rabbitmq-cluster-erlang-cookie","defaultMode":420}},{"name":"rabbitmq-plugins","emptyDir":{}},{"name":"pod-info","downwardAPI":{"items":[{"path":"skipPreStopChecks","fieldRef":{"apiVersion":"v1","fieldPath":"metadata.labels['skipPreStopChecks']"}}],"defaultMode":420}}],"initContainers":[{"name":"setup-container","image":"rabbitmq:3.8.12-management","command":["sh","-c","cp /tmp/erlang-cookie-secret/.erlang.cookie /var/lib/rabbitmq/.erlang.cookie \u0026\u0026 chown 999:999 /var/lib/rabbitmq/.erlang.cookie \u0026\u0026 chmod 600 /var/lib/rabbitmq/.erlang.cookie ; cp /tmp/rabbitmq-plugins/enabled_plugins /operator/enabled_plugins \u0026\u0026 chown 999:999 /operator/enabled_plugins ; chown 999:999 /var/lib/rabbitmq/mnesia/ ; echo '[default]' \u003e /var/lib/rabbitmq/.rabbitmqadmin.conf \u0026\u0026 sed -e 's/default_user/username/' -e 's/default_pass/password/' /tmp/default_user.conf \u003e\u003e /var/lib/rabbitmq/.rabbitmqadmin.conf \u0026\u0026 chown 999:999 /var/lib/rabbitmq/.rabbitmqadmin.conf \u0026\u0026 chmod 600 /var/lib/rabbitmq/.rabbitmqadmin.conf"],"resources":{"limits":{"cpu":"100m","memory":"500Mi"},"requests":{"cpu":"100m","memory":"500Mi"}},"volumeMounts":[{"name":"plugins-conf","mountPath":"/tmp/rabbitmq-plugins/"},{"name":"rabbitmq-erlang-cookie","mountPath":"/var/lib/rabbitmq/"},{"name":"erlang-cookie-secret","mountPath":"/tmp/erlang-cookie-secret/"},{"name":"rabbitmq-plugins","mountPath":"/operator"},{"name":"persistence","mountPath":"/var/lib/rabbitmq/mnesia/"},{"name":"rabbitmq-confd","mountPath":"/tmp/default_user.conf","subPath":"default_user.conf"}],"terminationMessagePath":"/dev/termination-log","terminationMessagePolicy":"File","imagePullPolicy":"IfNotPresent","securityContext":{"capabilities":{"drop":["FSETID","KILL","SETGID","SETUID","SETPCAP","NET_BIND_SERVICE","NET_RAW","SYS_CHROOT","MKNOD","AUDIT_WRITE","SETFCAP"]},"runAsUser":0}}],"containers":[{"name":"rabbitmq","image":"rabbitmq:3.8.12-management","ports":[{"name":"epmd","containerPort":4369,"protocol":"TCP"},{"name":"amqp","containerPort":5672,"protocol":"TCP"},{"name":"management","containerPort":15672,"protocol":"TCP"},{"name":"prometheus","containerPort":15692,"protocol":"TCP"}],"env":[{"name":"MY_POD_NAME","valueFrom":{"fieldRef":{"apiVersion":"v1","fieldPath":"metadata.name"}}},{"name":"MY_POD_NAMESPACE","valueFrom":{"fieldRef":{"apiVersion":"v1","fieldPath":"metadata.namespace"}}},{"name":"RABBITMQ_ENABLED_PLUGINS_FILE","value":"/operator/enabled_plugins"},{"name":"K8S_SERVICE_NAME","value":"rabbitmq-cluster-nodes"},{"name":"RABBITMQ_USE_LONGNAME","value":"true"},{"name":"RABBITMQ_NODENAME","value":"rabbit@$(MY_POD_NAME).$(K8S_SERVICE_NAME).$(MY_POD_NAMESPACE)"},{"name":"K8S_HOSTNAME_SUFFIX","value":".$(K8S_SERVICE_NAME).$(MY_POD_NAMESPACE)"}],"resources":{"limits":{"cpu":"2","memory":"2Gi"},"requests":{"cpu":"1","memory":"2Gi"}},"volumeMounts":[{"name":"rabbitmq-erlang-cookie","mountPath":"/var/lib/rabbitmq/"},{"name":"persistence","mountPath":"/var/lib/rabbitmq/mnesia/"},{"name":"rabbitmq-plugins","mountPath":"/operator"},{"name":"rabbitmq-confd","mountPath":"/etc/rabbitmq/conf.d/10-operatorDefaults.conf","subPath":"operatorDefaults.conf"},{"name":"rabbitmq-confd","mountPath":"/etc/rabbitmq/conf.d/11-default_user.conf","subPath":"default_user.conf"},{"name":"rabbitmq-confd","mountPath":"/etc/rabbitmq/conf.d/90-userDefinedConfiguration.conf","subPath":"userDefinedConfiguration.conf"},{"name":"pod-info","mountPath":"/etc/pod-info/"}],"readinessProbe":{"tcpSocket":{"port":"amqp"},"initialDelaySeconds":10,"timeoutSeconds":5,"periodSeconds":10,"successThreshold":1,"failureThreshold":3},"lifecycle":{"preStop":{"exec":{"command":["/bin/bash","-c","if [ ! -z \"$(cat /etc/pod-info/skipPreStopChecks)\" ]; then exit 0; fi; rabbitmq-upgrade await_online_quorum_plus_one -t 604800; rabbitmq-upgrade await_online_synchronized_mirror -t 604800; rabbitmq-upgrade drain -t 604800"]}}},"terminationMessagePath":"/dev/termination-log","terminationMessagePolicy":"File","imagePullPolicy":"IfNotPresent"}],"restartPolicy":"Always","terminationGracePeriodSeconds":604800,"dnsPolicy":"ClusterFirst","serviceAccountName":"rabbitmq-cluster-server","serviceAccount":"rabbitmq-cluster-server","automountServiceAccountToken":true,"securityContext":{"runAsUser":999,"runAsGroup":999,"fsGroup":999},"schedulerName":"default-scheduler","topologySpreadConstraints":[{"maxSkew":1,"topologyKey":"topology.kubernetes.io/zone","whenUnsatisfiable":"ScheduleAnyway","labelSelector":{"matchLabels":{"app.kubernetes.io/name":"rabbitmq-cluster"}}}]}},"volumeClaimTemplates":[{"metadata":{"name":"persistence","namespace":"default","creationTimestamp":null,"labels":{"app.kubernetes.io/component":"rabbitmq","app.kubernetes.io/name":"rabbitmq-cluster","app.kubernetes.io/part-of":"rabbitmq"},"ownerReferences":[{"apiVersion":"rabbitmq.com/v1beta1","kind":"RabbitmqCluster","name":"rabbitmq-cluster","uid":"18d9928b-0d1c-47be-80ec-20960d053827","controller":true,"blockOwnerDeletion":false}]},"spec":{"accessModes":["ReadWriteOnce"],"resources":{"requests":{"storage":"10Gi"}},"volumeMode":"Filesystem"},"status":{"phase":"Pending"}}],"serviceName":"rabbitmq-cluster-nodes","podManagementPolicy":"Parallel","updateStrategy":{"type":"RollingUpdate","rollingUpdate":{"partition":0}},"revisionHistoryLimit":10},"status":{"observedGeneration":1,"replicas":1,"currentReplicas":1,"updatedReplicas":1,"currentRevision":"rabbitmq-cluster-server-5f8b8665fb","updateRevision":"rabbitmq-cluster-server-5f8b8665fb","collisionCount":0}}
2022/03/18 18:00:38 learn_server.go:256: [SIEVE-BEFORE-WRITE]	17
2022/03/18 18:00:38 learn_server.go:263: [SIEVE-AFTER-WRITE]	17	Update	statefulset	github.com/rabbitmq/cluster-operator/controllers.(*RabbitmqClusterReconciler)	NoError	{"metadata":{"name":"rabbitmq-cluster-server","namespace":"default","selfLink":"/apis/apps/v1/namespaces/default/statefulsets/rabbitmq-cluster-server","uid":"cb5c43bc-6ee7-481c-ab01-6f3acffdd3c8","resourceVersion":"744","generation":1,"creationTimestamp":"2022-03-18T18:00:38Z","labels":{"app.kubernetes.io/component":"rabbitmq","app.kubernetes.io/name":"rabbitmq-cluster","app.kubernetes.io/part-of":"rabbitmq"},"annotations":{"rabbitmq.com/createdAt":"2022-03-18T18:00:38Z"},"ownerReferences":[{"apiVersion":"rabbitmq.com/v1beta1","kind":"RabbitmqCluster","name":"rabbitmq-cluster","uid":"18d9928b-0d1c-47be-80ec-20960d053827","controller":true,"blockOwnerDeletion":true}],"managedFields":[{"manager":"kube-controller-manager","operation":"Update","apiVersion":"apps/v1","time":"2022-03-18T18:00:38Z","fieldsType":"FieldsV1","fieldsV1":{"f:status":{"f:collisionCount":{},"f:currentReplicas":{},"f:currentRevision":{},"f:observedGeneration":{},"f:replicas":{},"f:updateRevision":{},"f:updatedReplicas":{}}}},{"manager":"manager","operation":"Update","apiVersion":"apps/v1","time":"2022-03-18T18:00:38Z","fieldsType":"FieldsV1","fieldsV1":{"f:metadata":{"f:annotations":{".":{},"f:rabbitmq.com/createdAt":{}},"f:labels":{".":{},"f:app.kubernetes.io/component":{},"f:app.kubernetes.io/name":{},"f:app.kubernetes.io/part-of":{}},"f:ownerReferences":{".":{},"k:{\"uid\":\"18d9928b-0d1c-47be-80ec-20960d053827\"}":{".":{},"f:apiVersion":{},"f:blockOwnerDeletion":{},"f:controller":{},"f:kind":{},"f:name":{},"f:uid":{}}}},"f:spec":{"f:podManagementPolicy":{},"f:replicas":{},"f:revisionHistoryLimit":{},"f:selector":{"f:matchLabels":{".":{},"f:app.kubernetes.io/name":{}}},"f:serviceName":{},"f:template":{"f:metadata":{"f:annotations":{".":{},"f:prometheus.io/port":{},"f:prometheus.io/scrape":{}},"f:labels":{".":{},"f:app.kubernetes.io/component":{},"f:app.kubernetes.io/name":{},"f:app.kubernetes.io/part-of":{}}},"f:spec":{"f:automountServiceAccountToken":{},"f:containers":{"k:{\"name\":\"rabbitmq\"}":{".":{},"f:env":{".":{},"k:{\"name\":\"K8S_HOSTNAME_SUFFIX\"}":{".":{},"f:name":{},"f:value":{}},"k:{\"name\":\"K8S_SERVICE_NAME\"}":{".":{},"f:name":{},"f:value":{}},"k:{\"name\":\"MY_POD_NAME\"}":{".":{},"f:name":{},"f:valueFrom":{".":{},"f:fieldRef":{".":{},"f:apiVersion":{},"f:fieldPath":{}}}},"k:{\"name\":\"MY_POD_NAMESPACE\"}":{".":{},"f:name":{},"f:valueFrom":{".":{},"f:fieldRef":{".":{},"f:apiVersion":{},"f:fieldPath":{}}}},"k:{\"name\":\"RABBITMQ_ENABLED_PLUGINS_FILE\"}":{".":{},"f:name":{},"f:value":{}},"k:{\"name\":\"RABBITMQ_NODENAME\"}":{".":{},"f:name":{},"f:value":{}},"k:{\"name\":\"RABBITMQ_USE_LONGNAME\"}":{".":{},"f:name":{},"f:value":{}}},"f:image":{},"f:imagePullPolicy":{},"f:lifecycle":{".":{},"f:preStop":{".":{},"f:exec":{".":{},"f:command":{}}}},"f:name":{},"f:ports":{".":{},"k:{\"containerPort\":4369,\"protocol\":\"TCP\"}":{".":{},"f:containerPort":{},"f:name":{},"f:protocol":{}},"k:{\"containerPort\":5672,\"protocol\":\"TCP\"}":{".":{},"f:containerPort":{},"f:name":{},"f:protocol":{}},"k:{\"containerPort\":15672,\"protocol\":\"TCP\"}":{".":{},"f:containerPort":{},"f:name":{},"f:protocol":{}},"k:{\"containerPort\":15692,\"protocol\":\"TCP\"}":{".":{},"f:containerPort":{},"f:name":{},"f:protocol":{}}},"f:readinessProbe":{".":{},"f:failureThreshold":{},"f:initialDelaySeconds":{},"f:periodSeconds":{},"f:successThreshold":{},"f:tcpSocket":{".":{},"f:port":{}},"f:timeoutSeconds":{}},"f:resources":{".":{},"f:limits":{".":{},"f:cpu":{},"f:memory":{}},"f:requests":{".":{},"f:cpu":{},"f:memory":{}}},"f:terminationMessagePath":{},"f:terminationMessagePolicy":{},"f:volumeMounts":{".":{},"k:{\"mountPath\":\"/etc/pod-info/\"}":{".":{},"f:mountPath":{},"f:name":{}},"k:{\"mountPath\":\"/etc/rabbitmq/conf.d/10-operatorDefaults.conf\"}":{".":{},"f:mountPath":{},"f:name":{},"f:subPath":{}},"k:{\"mountPath\":\"/etc/rabbitmq/conf.d/11-default_user.conf\"}":{".":{},"f:mountPath":{},"f:name":{},"f:subPath":{}},"k:{\"mountPath\":\"/etc/rabbitmq/conf.d/90-userDefinedConfiguration.conf\"}":{".":{},"f:mountPath":{},"f:name":{},"f:subPath":{}},"k:{\"mountPath\":\"/operator\"}":{".":{},"f:mountPath":{},"f:name":{}},"k:{\"mountPath\":\"/var/lib/rabbitmq/\"}":{".":{},"f:mountPath":{},"f:name":{}},"k:{\"mountPath\":\"/var/lib/rabbitmq/mnesia/\"}":{".":{},"f:mountPath":{},"f:name":{}}}}},"f:dnsPolicy":{},"f:initContainers":{".":{},"k:{\"name\":\"setup-container\"}":{".":{},"f:command":{},"f:image":{},"f:imagePullPolicy":{},"f:name":{},"f:resources":{".":{},"f:limits":{".":{},"f:cpu":{},"f:memory":{}},"f:requests":{".":{},"f:cpu":{},"f:memory":{}}},"f:securityContext":{".":{},"f:capabilities":{".":{},"f:drop":{}},"f:runAsUser":{}},"f:terminationMessagePath":{},"f:terminationMessagePolicy":{},"f:volumeMounts":{".":{},"k:{\"mountPath\":\"/operator\"}":{".":{},"f:mountPath":{},"f:name":{}},"k:{\"mountPath\":\"/tmp/default_user.conf\"}":{".":{},"f:mountPath":{},"f:name":{},"f:subPath":{}},"k:{\"mountPath\":\"/tmp/erlang-cookie-secret/\"}":{".":{},"f:mountPath":{},"f:name":{}},"k:{\"mountPath\":\"/tmp/rabbitmq-plugins/\"}":{".":{},"f:mountPath":{},"f:name":{}},"k:{\"mountPath\":\"/var/lib/rabbitmq/\"}":{".":{},"f:mountPath":{},"f:name":{}},"k:{\"mountPath\":\"/var/lib/rabbitmq/mnesia/\"}":{".":{},"f:mountPath":{},"f:name":{}}}}},"f:restartPolicy":{},"f:schedulerName":{},"f:securityContext":{".":{},"f:fsGroup":{},"f:runAsGroup":{},"f:runAsUser":{}},"f:serviceAccount":{},"f:serviceAccountName":{},"f:terminationGracePeriodSeconds":{},"f:topologySpreadConstraints":{".":{},"k:{\"topologyKey\":\"topology.kubernetes.io/zone\",\"whenUnsatisfiable\":\"ScheduleAnyway\"}":{".":{},"f:labelSelector":{".":{},"f:matchLabels":{".":{},"f:app.kubernetes.io/name":{}}},"f:maxSkew":{},"f:topologyKey":{},"f:whenUnsatisfiable":{}}},"f:volumes":{".":{},"k:{\"name\":\"erlang-cookie-secret\"}":{".":{},"f:name":{},"f:secret":{".":{},"f:defaultMode":{},"f:secretName":{}}},"k:{\"name\":\"plugins-conf\"}":{".":{},"f:configMap":{".":{},"f:defaultMode":{},"f:name":{}},"f:name":{}},"k:{\"name\":\"pod-info\"}":{".":{},"f:downwardAPI":{".":{},"f:defaultMode":{},"f:items":{}},"f:name":{}},"k:{\"name\":\"rabbitmq-confd\"}":{".":{},"f:name":{},"f:projected":{".":{},"f:defaultMode":{},"f:sources":{}}},"k:{\"name\":\"rabbitmq-erlang-cookie\"}":{".":{},"f:emptyDir":{},"f:name":{}},"k:{\"name\":\"rabbitmq-plugins\"}":{".":{},"f:emptyDir":{},"f:name":{}}}}},"f:updateStrategy":{"f:rollingUpdate":{".":{},"f:partition":{}},"f:type":{}},"f:volumeClaimTemplates":{}}}}]},"spec":{"replicas":1,"selector":{"matchLabels":{"app.kubernetes.io/name":"rabbitmq-cluster"}},"template":{"metadata":{"creationTimestamp":null,"labels":{"app.kubernetes.io/component":"rabbitmq","app.kubernetes.io/name":"rabbitmq-cluster","app.kubernetes.io/part-of":"rabbitmq"},"annotations":{"prometheus.io/port":"15692","prometheus.io/scrape":"true"}},"spec":{"volumes":[{"name":"plugins-conf","configMap":{"name":"rabbitmq-cluster-plugins-conf","defaultMode":420}},{"name":"rabbitmq-confd","projected":{"sources":[{"secret":{"name":"rabbitmq-cluster-default-user","items":[{"key":"default_user.conf","path":"default_user.conf"}]}},{"configMap":{"name":"rabbitmq-cluster-server-conf","items":[{"key":"operatorDefaults.conf","path":"operatorDefaults.conf"},{"key":"userDefinedConfiguration.conf","path":"userDefinedConfiguration.conf"}]}}],"defaultMode":420}},{"name":"rabbitmq-erlang-cookie","emptyDir":{}},{"name":"erlang-cookie-secret","secret":{"secretName":"rabbitmq-cluster-erlang-cookie","defaultMode":420}},{"name":"rabbitmq-plugins","emptyDir":{}},{"name":"pod-info","downwardAPI":{"items":[{"path":"skipPreStopChecks","fieldRef":{"apiVersion":"v1","fieldPath":"metadata.labels['skipPreStopChecks']"}}],"defaultMode":420}}],"initContainers":[{"name":"setup-container","image":"rabbitmq:3.8.12-management","command":["sh","-c","cp /tmp/erlang-cookie-secret/.erlang.cookie /var/lib/rabbitmq/.erlang.cookie \u0026\u0026 chown 999:999 /var/lib/rabbitmq/.erlang.cookie \u0026\u0026 chmod 600 /var/lib/rabbitmq/.erlang.cookie ; cp /tmp/rabbitmq-plugins/enabled_plugins /operator/enabled_plugins \u0026\u0026 chown 999:999 /operator/enabled_plugins ; chown 999:999 /var/lib/rabbitmq/mnesia/ ; echo '[default]' \u003e /var/lib/rabbitmq/.rabbitmqadmin.conf \u0026\u0026 sed -e 's/default_user/username/' -e 's/default_pass/password/' /tmp/default_user.conf \u003e\u003e /var/lib/rabbitmq/.rabbitmqadmin.conf \u0026\u0026 chown 999:999 /var/lib/rabbitmq/.rabbitmqadmin.conf \u0026\u0026 chmod 600 /var/lib/rabbitmq/.rabbitmqadmin.conf"],"resources":{"limits":{"cpu":"100m","memory":"500Mi"},"requests":{"cpu":"100m","memory":"500Mi"}},"volumeMounts":[{"name":"plugins-conf","mountPath":"/tmp/rabbitmq-plugins/"},{"name":"rabbitmq-erlang-cookie","mountPath":"/var/lib/rabbitmq/"},{"name":"erlang-cookie-secret","mountPath":"/tmp/erlang-cookie-secret/"},{"name":"rabbitmq-plugins","mountPath":"/operator"},{"name":"persistence","mountPath":"/var/lib/rabbitmq/mnesia/"},{"name":"rabbitmq-confd","mountPath":"/tmp/default_user.conf","subPath":"default_user.conf"}],"terminationMessagePath":"/dev/termination-log","terminationMessagePolicy":"File","imagePullPolicy":"IfNotPresent","securityContext":{"capabilities":{"drop":["FSETID","KILL","SETGID","SETUID","SETPCAP","NET_BIND_SERVICE","NET_RAW","SYS_CHROOT","MKNOD","AUDIT_WRITE","SETFCAP"]},"runAsUser":0}}],"containers":[{"name":"rabbitmq","image":"rabbitmq:3.8.12-management","ports":[{"name":"epmd","containerPort":4369,"protocol":"TCP"},{"name":"amqp","containerPort":5672,"protocol":"TCP"},{"name":"management","containerPort":15672,"protocol":"TCP"},{"name":"prometheus","containerPort":15692,"protocol":"TCP"}],"env":[{"name":"MY_POD_NAME","valueFrom":{"fieldRef":{"apiVersion":"v1","fieldPath":"metadata.name"}}},{"name":"MY_POD_NAMESPACE","valueFrom":{"fieldRef":{"apiVersion":"v1","fieldPath":"metadata.namespace"}}},{"name":"RABBITMQ_ENABLED_PLUGINS_FILE","value":"/operator/enabled_plugins"},{"name":"K8S_SERVICE_NAME","value":"rabbitmq-cluster-nodes"},{"name":"RABBITMQ_USE_LONGNAME","value":"true"},{"name":"RABBITMQ_NODENAME","value":"rabbit@$(MY_POD_NAME).$(K8S_SERVICE_NAME).$(MY_POD_NAMESPACE)"},{"name":"K8S_HOSTNAME_SUFFIX","value":".$(K8S_SERVICE_NAME).$(MY_POD_NAMESPACE)"}],"resources":{"limits":{"cpu":"2","memory":"2Gi"},"requests":{"cpu":"1","memory":"2Gi"}},"volumeMounts":[{"name":"rabbitmq-erlang-cookie","mountPath":"/var/lib/rabbitmq/"},{"name":"persistence","mountPath":"/var/lib/rabbitmq/mnesia/"},{"name":"rabbitmq-plugins","mountPath":"/operator"},{"name":"rabbitmq-confd","mountPath":"/etc/rabbitmq/conf.d/10-operatorDefaults.conf","subPath":"operatorDefaults.conf"},{"name":"rabbitmq-confd","mountPath":"/etc/rabbitmq/conf.d/11-default_user.conf","subPath":"default_user.conf"},{"name":"rabbitmq-confd","mountPath":"/etc/rabbitmq/conf.d/90-userDefinedConfiguration.conf","subPath":"userDefinedConfiguration.conf"},{"name":"pod-info","mountPath":"/etc/pod-info/"}],"readinessProbe":{"tcpSocket":{"port":"amqp"},"initialDelaySeconds":10,"timeoutSeconds":5,"periodSeconds":10,"successThreshold":1,"failureThreshold":3},"lifecycle":{"preStop":{"exec":{"command":["/bin/bash","-c","if [ ! -z \"$(cat /etc/pod-info/skipPreStopChecks)\" ]; then exit 0; fi; rabbitmq-upgrade await_online_quorum_plus_one -t 604800; rabbitmq-upgrade await_online_synchronized_mirror -t 604800; rabbitmq-upgrade drain -t 604800"]}}},"terminationMessagePath":"/dev/termination-log","terminationMessagePolicy":"File","imagePullPolicy":"IfNotPresent"}],"restartPolicy":"Always","terminationGracePeriodSeconds":604800,"dnsPolicy":"ClusterFirst","serviceAccountName":"rabbitmq-cluster-server","serviceAccount":"rabbitmq-cluster-server","automountServiceAccountToken":true,"securityContext":{"runAsUser":999,"runAsGroup":999,"fsGroup":999},"schedulerName":"default-scheduler","topologySpreadConstraints":[{"maxSkew":1,"topologyKey":"topology.kubernetes.io/zone","whenUnsatisfiable":"ScheduleAnyway","labelSelector":{"matchLabels":{"app.kubernetes.io/name":"rabbitmq-cluster"}}}]}},"volumeClaimTemplates":[{"metadata":{"name":"persistence","namespace":"default","creationTimestamp":null,"labels":{"app.kubernetes.io/component":"rabbitmq","app.kubernetes.io/name":"rabbitmq-cluster","app.kubernetes.io/part-of":"rabbitmq"},"ownerReferences":[{"apiVersion":"rabbitmq.com/v1beta1","kind":"RabbitmqCluster","name":"rabbitmq-cluster","uid":"18d9928b-0d1c-47be-80ec-20960d053827","controller":true,"blockOwnerDeletion":false}]},"spec":{"accessModes":["ReadWriteOnce"],"resources":{"requests":{"storage":"10Gi"}},"volumeMode":"Filesystem"},"status":{"phase":"Pending"}}],"serviceName":"rabbitmq-cluster-nodes","podManagementPolicy":"Parallel","updateStrategy":{"type":"RollingUpdate","rollingUpdate":{"partition":0}},"revisionHistoryLimit":10},"status":{"observedGeneration":1,"replicas":1,"currentReplicas":1,"updatedReplicas":1,"currentRevision":"rabbitmq-cluster-server-5f8b8665fb","updateRevision":"rabbitmq-cluster-server-5f8b8665fb","collisionCount":0}}
2022/03/18 18:00:38 learn_server.go:291: [SIEVE-AFTER-READ]	Get	true	configmap	default	rabbitmq-cluster-server-conf	github.com/rabbitmq/cluster-operator/controllers.(*RabbitmqClusterReconciler)	NoError	{"kind":"ConfigMap","apiVersion":"v1","metadata":{"name":"rabbitmq-cluster-server-conf","namespace":"default","selfLink":"/api/v1/namespaces/default/configmaps/rabbitmq-cluster-server-conf","uid":"22474f2b-8454-44b7-8079-8990223969cc","resourceVersion":"714","creationTimestamp":"2022-03-18T18:00:38Z","labels":{"app.kubernetes.io/component":"rabbitmq","app.kubernetes.io/name":"rabbitmq-cluster","app.kubernetes.io/part-of":"rabbitmq"},"ownerReferences":[{"apiVersion":"rabbitmq.com/v1beta1","kind":"RabbitmqCluster","name":"rabbitmq-cluster","uid":"18d9928b-0d1c-47be-80ec-20960d053827","controller":true,"blockOwnerDeletion":true}],"managedFields":[{"manager":"manager","operation":"Update","apiVersion":"v1","time":"2022-03-18T18:00:38Z","fieldsType":"FieldsV1","fieldsV1":{"f:data":{".":{},"f:operatorDefaults.conf":{},"f:userDefinedConfiguration.conf":{}},"f:metadata":{"f:labels":{".":{},"f:app.kubernetes.io/component":{},"f:app.kubernetes.io/name":{},"f:app.kubernetes.io/part-of":{}},"f:ownerReferences":{".":{},"k:{\"uid\":\"18d9928b-0d1c-47be-80ec-20960d053827\"}":{".":{},"f:apiVersion":{},"f:blockOwnerDeletion":{},"f:controller":{},"f:kind":{},"f:name":{},"f:uid":{}}}}}}]},"data":{"operatorDefaults.conf":"cluster_formation.peer_discovery_backend             = rabbit_peer_discovery_k8s\ncluster_formation.k8s.host                           = kubernetes.default\ncluster_formation.k8s.address_type                   = hostname\ncluster_partition_handling                           = pause_minority\nqueue_master_locator                                 = min-masters\ndisk_free_limit.absolute                             = 2GB\ncluster_formation.randomized_startup_delay_range.min = 5\ncluster_formation.randomized_startup_delay_range.max = 30\ncluster_name                                         = rabbitmq-cluster\n","userDefinedConfiguration.conf":"total_memory_available_override_value = 1717986919\n"}}
2022/03/18 18:00:38 learn_server.go:256: [SIEVE-BEFORE-WRITE]	18
2022/03/18 18:00:38 learn_server.go:263: [SIEVE-AFTER-WRITE]	18	StatusUpdate	rabbitmqcluster	github.com/rabbitmq/cluster-operator/controllers.(*RabbitmqClusterReconciler)	NoError	{"metadata":{"name":"rabbitmq-cluster","namespace":"default","selfLink":"/apis/rabbitmq.com/v1beta1/namespaces/default/rabbitmqclusters/rabbitmq-cluster/status","uid":"18d9928b-0d1c-47be-80ec-20960d053827","resourceVersion":"746","generation":2,"creationTimestamp":"2022-03-18T18:00:38Z","annotations":{"kubectl.kubernetes.io/last-applied-configuration":"{\"apiVersion\":\"rabbitmq.com/v1beta1\",\"kind\":\"RabbitmqCluster\",\"metadata\":{\"annotations\":{},\"name\":\"rabbitmq-cluster\",\"namespace\":\"default\"},\"spec\":{\"persistence\":{\"storage\":\"10Gi\"},\"replicas\":1}}\n"},"finalizers":["deletion.finalizers.rabbitmqclusters.rabbitmq.com"],"managedFields":[{"manager":"kubectl-client-side-apply","operation":"Update","apiVersion":"rabbitmq.com/v1beta1","time":"2022-03-18T18:00:38Z","fieldsType":"FieldsV1","fieldsV1":{"f:metadata":{"f:annotations":{".":{},"f:kubectl.kubernetes.io/last-applied-configuration":{}}},"f:spec":{".":{},"f:image":{},"f:persistence":{".":{},"f:storage":{}},"f:replicas":{},"f:resources":{".":{},"f:limits":{".":{},"f:memory":{}},"f:requests":{".":{},"f:memory":{}}},"f:service":{".":{},"f:type":{}},"f:terminationGracePeriodSeconds":{}}}},{"manager":"manager","operation":"Update","apiVersion":"rabbitmq.com/v1beta1","time":"2022-03-18T18:00:38Z","fieldsType":"FieldsV1","fieldsV1":{"f:metadata":{"f:finalizers":{}},"f:spec":{"f:override":{},"f:rabbitmq":{},"f:resources":{"f:limits":{"f:cpu":{}},"f:requests":{"f:cpu":{}}},"f:tls":{}},"f:status":{".":{},"f:conditions":{},"f:defaultUser":{".":{},"f:secretReference":{".":{},"f:keys":{".":{},"f:password":{},"f:username":{}},"f:name":{},"f:namespace":{}},"f:serviceReference":{".":{},"f:name":{},"f:namespace":{}}}}}}]},"spec":{"replicas":1,"image":"rabbitmq:3.8.12-management","service":{"type":"ClusterIP"},"persistence":{"storage":"10Gi"},"resources":{"limits":{"cpu":"2","memory":"2Gi"},"requests":{"cpu":"1","memory":"2Gi"}},"rabbitmq":{},"tls":{},"override":{},"terminationGracePeriodSeconds":604800},"status":{"conditions":[{"type":"AllReplicasReady","status":"False","lastTransitionTime":"2022-03-18T18:00:38Z","reason":"NotAllPodsReady","message":"0/1 Pods ready"},{"type":"ClusterAvailable","status":"False","lastTransitionTime":"2022-03-18T18:00:38Z","reason":"NoEndpointsAvailable","message":"The service has no endpoints available"},{"type":"NoWarnings","status":"True","lastTransitionTime":"2022-03-18T18:00:38Z","reason":"NoWarnings"},{"type":"ReconcileSuccess","status":"Unknown","lastTransitionTime":"2022-03-18T18:00:38Z","reason":"Initialising"}],"defaultUser":{"secretReference":{"name":"rabbitmq-cluster-default-user","namespace":"default","keys":{"password":"password","username":"username"}},"serviceReference":{"name":"rabbitmq-cluster","namespace":"default"}},"binding":{"name":"rabbitmq-cluster-default-user"}}}
2022/03/18 18:00:38 learn_server.go:291: [SIEVE-AFTER-READ]	Get	true	statefulset	default	rabbitmq-cluster-server	github.com/rabbitmq/cluster-operator/controllers.(*RabbitmqClusterReconciler)	NoError	{"kind":"StatefulSet","apiVersion":"apps/v1","metadata":{"name":"rabbitmq-cluster-server","namespace":"default","selfLink":"/apis/apps/v1/namespaces/default/statefulsets/rabbitmq-cluster-server","uid":"cb5c43bc-6ee7-481c-ab01-6f3acffdd3c8","resourceVersion":"744","generation":1,"creationTimestamp":"2022-03-18T18:00:38Z","labels":{"app.kubernetes.io/component":"rabbitmq","app.kubernetes.io/name":"rabbitmq-cluster","app.kubernetes.io/part-of":"rabbitmq"},"annotations":{"rabbitmq.com/createdAt":"2022-03-18T18:00:38Z"},"ownerReferences":[{"apiVersion":"rabbitmq.com/v1beta1","kind":"RabbitmqCluster","name":"rabbitmq-cluster","uid":"18d9928b-0d1c-47be-80ec-20960d053827","controller":true,"blockOwnerDeletion":true}],"managedFields":[{"manager":"kube-controller-manager","operation":"Update","apiVersion":"apps/v1","time":"2022-03-18T18:00:38Z","fieldsType":"FieldsV1","fieldsV1":{"f:status":{"f:collisionCount":{},"f:currentReplicas":{},"f:currentRevision":{},"f:observedGeneration":{},"f:replicas":{},"f:updateRevision":{},"f:updatedReplicas":{}}}},{"manager":"manager","operation":"Update","apiVersion":"apps/v1","time":"2022-03-18T18:00:38Z","fieldsType":"FieldsV1","fieldsV1":{"f:metadata":{"f:annotations":{".":{},"f:rabbitmq.com/createdAt":{}},"f:labels":{".":{},"f:app.kubernetes.io/component":{},"f:app.kubernetes.io/name":{},"f:app.kubernetes.io/part-of":{}},"f:ownerReferences":{".":{},"k:{\"uid\":\"18d9928b-0d1c-47be-80ec-20960d053827\"}":{".":{},"f:apiVersion":{},"f:blockOwnerDeletion":{},"f:controller":{},"f:kind":{},"f:name":{},"f:uid":{}}}},"f:spec":{"f:podManagementPolicy":{},"f:replicas":{},"f:revisionHistoryLimit":{},"f:selector":{"f:matchLabels":{".":{},"f:app.kubernetes.io/name":{}}},"f:serviceName":{},"f:template":{"f:metadata":{"f:annotations":{".":{},"f:prometheus.io/port":{},"f:prometheus.io/scrape":{}},"f:labels":{".":{},"f:app.kubernetes.io/component":{},"f:app.kubernetes.io/name":{},"f:app.kubernetes.io/part-of":{}}},"f:spec":{"f:automountServiceAccountToken":{},"f:containers":{"k:{\"name\":\"rabbitmq\"}":{".":{},"f:env":{".":{},"k:{\"name\":\"K8S_HOSTNAME_SUFFIX\"}":{".":{},"f:name":{},"f:value":{}},"k:{\"name\":\"K8S_SERVICE_NAME\"}":{".":{},"f:name":{},"f:value":{}},"k:{\"name\":\"MY_POD_NAME\"}":{".":{},"f:name":{},"f:valueFrom":{".":{},"f:fieldRef":{".":{},"f:apiVersion":{},"f:fieldPath":{}}}},"k:{\"name\":\"MY_POD_NAMESPACE\"}":{".":{},"f:name":{},"f:valueFrom":{".":{},"f:fieldRef":{".":{},"f:apiVersion":{},"f:fieldPath":{}}}},"k:{\"name\":\"RABBITMQ_ENABLED_PLUGINS_FILE\"}":{".":{},"f:name":{},"f:value":{}},"k:{\"name\":\"RABBITMQ_NODENAME\"}":{".":{},"f:name":{},"f:value":{}},"k:{\"name\":\"RABBITMQ_USE_LONGNAME\"}":{".":{},"f:name":{},"f:value":{}}},"f:image":{},"f:imagePullPolicy":{},"f:lifecycle":{".":{},"f:preStop":{".":{},"f:exec":{".":{},"f:command":{}}}},"f:name":{},"f:ports":{".":{},"k:{\"containerPort\":4369,\"protocol\":\"TCP\"}":{".":{},"f:containerPort":{},"f:name":{},"f:protocol":{}},"k:{\"containerPort\":5672,\"protocol\":\"TCP\"}":{".":{},"f:containerPort":{},"f:name":{},"f:protocol":{}},"k:{\"containerPort\":15672,\"protocol\":\"TCP\"}":{".":{},"f:containerPort":{},"f:name":{},"f:protocol":{}},"k:{\"containerPort\":15692,\"protocol\":\"TCP\"}":{".":{},"f:containerPort":{},"f:name":{},"f:protocol":{}}},"f:readinessProbe":{".":{},"f:failureThreshold":{},"f:initialDelaySeconds":{},"f:periodSeconds":{},"f:successThreshold":{},"f:tcpSocket":{".":{},"f:port":{}},"f:timeoutSeconds":{}},"f:resources":{".":{},"f:limits":{".":{},"f:cpu":{},"f:memory":{}},"f:requests":{".":{},"f:cpu":{},"f:memory":{}}},"f:terminationMessagePath":{},"f:terminationMessagePolicy":{},"f:volumeMounts":{".":{},"k:{\"mountPath\":\"/etc/pod-info/\"}":{".":{},"f:mountPath":{},"f:name":{}},"k:{\"mountPath\":\"/etc/rabbitmq/conf.d/10-operatorDefaults.conf\"}":{".":{},"f:mountPath":{},"f:name":{},"f:subPath":{}},"k:{\"mountPath\":\"/etc/rabbitmq/conf.d/11-default_user.conf\"}":{".":{},"f:mountPath":{},"f:name":{},"f:subPath":{}},"k:{\"mountPath\":\"/etc/rabbitmq/conf.d/90-userDefinedConfiguration.conf\"}":{".":{},"f:mountPath":{},"f:name":{},"f:subPath":{}},"k:{\"mountPath\":\"/operator\"}":{".":{},"f:mountPath":{},"f:name":{}},"k:{\"mountPath\":\"/var/lib/rabbitmq/\"}":{".":{},"f:mountPath":{},"f:name":{}},"k:{\"mountPath\":\"/var/lib/rabbitmq/mnesia/\"}":{".":{},"f:mountPath":{},"f:name":{}}}}},"f:dnsPolicy":{},"f:initContainers":{".":{},"k:{\"name\":\"setup-container\"}":{".":{},"f:command":{},"f:image":{},"f:imagePullPolicy":{},"f:name":{},"f:resources":{".":{},"f:limits":{".":{},"f:cpu":{},"f:memory":{}},"f:requests":{".":{},"f:cpu":{},"f:memory":{}}},"f:securityContext":{".":{},"f:capabilities":{".":{},"f:drop":{}},"f:runAsUser":{}},"f:terminationMessagePath":{},"f:terminationMessagePolicy":{},"f:volumeMounts":{".":{},"k:{\"mountPath\":\"/operator\"}":{".":{},"f:mountPath":{},"f:name":{}},"k:{\"mountPath\":\"/tmp/default_user.conf\"}":{".":{},"f:mountPath":{},"f:name":{},"f:subPath":{}},"k:{\"mountPath\":\"/tmp/erlang-cookie-secret/\"}":{".":{},"f:mountPath":{},"f:name":{}},"k:{\"mountPath\":\"/tmp/rabbitmq-plugins/\"}":{".":{},"f:mountPath":{},"f:name":{}},"k:{\"mountPath\":\"/var/lib/rabbitmq/\"}":{".":{},"f:mountPath":{},"f:name":{}},"k:{\"mountPath\":\"/var/lib/rabbitmq/mnesia/\"}":{".":{},"f:mountPath":{},"f:name":{}}}}},"f:restartPolicy":{},"f:schedulerName":{},"f:securityContext":{".":{},"f:fsGroup":{},"f:runAsGroup":{},"f:runAsUser":{}},"f:serviceAccount":{},"f:serviceAccountName":{},"f:terminationGracePeriodSeconds":{},"f:topologySpreadConstraints":{".":{},"k:{\"topologyKey\":\"topology.kubernetes.io/zone\",\"whenUnsatisfiable\":\"ScheduleAnyway\"}":{".":{},"f:labelSelector":{".":{},"f:matchLabels":{".":{},"f:app.kubernetes.io/name":{}}},"f:maxSkew":{},"f:topologyKey":{},"f:whenUnsatisfiable":{}}},"f:volumes":{".":{},"k:{\"name\":\"erlang-cookie-secret\"}":{".":{},"f:name":{},"f:secret":{".":{},"f:defaultMode":{},"f:secretName":{}}},"k:{\"name\":\"plugins-conf\"}":{".":{},"f:configMap":{".":{},"f:defaultMode":{},"f:name":{}},"f:name":{}},"k:{\"name\":\"pod-info\"}":{".":{},"f:downwardAPI":{".":{},"f:defaultMode":{},"f:items":{}},"f:name":{}},"k:{\"name\":\"rabbitmq-confd\"}":{".":{},"f:name":{},"f:projected":{".":{},"f:defaultMode":{},"f:sources":{}}},"k:{\"name\":\"rabbitmq-erlang-cookie\"}":{".":{},"f:emptyDir":{},"f:name":{}},"k:{\"name\":\"rabbitmq-plugins\"}":{".":{},"f:emptyDir":{},"f:name":{}}}}},"f:updateStrategy":{"f:rollingUpdate":{".":{},"f:partition":{}},"f:type":{}},"f:volumeClaimTemplates":{}}}}]},"spec":{"replicas":1,"selector":{"matchLabels":{"app.kubernetes.io/name":"rabbitmq-cluster"}},"template":{"metadata":{"creationTimestamp":null,"labels":{"app.kubernetes.io/component":"rabbitmq","app.kubernetes.io/name":"rabbitmq-cluster","app.kubernetes.io/part-of":"rabbitmq"},"annotations":{"prometheus.io/port":"15692","prometheus.io/scrape":"true"}},"spec":{"volumes":[{"name":"plugins-conf","configMap":{"name":"rabbitmq-cluster-plugins-conf","defaultMode":420}},{"name":"rabbitmq-confd","projected":{"sources":[{"secret":{"name":"rabbitmq-cluster-default-user","items":[{"key":"default_user.conf","path":"default_user.conf"}]}},{"configMap":{"name":"rabbitmq-cluster-server-conf","items":[{"key":"operatorDefaults.conf","path":"operatorDefaults.conf"},{"key":"userDefinedConfiguration.conf","path":"userDefinedConfiguration.conf"}]}}],"defaultMode":420}},{"name":"rabbitmq-erlang-cookie","emptyDir":{}},{"name":"erlang-cookie-secret","secret":{"secretName":"rabbitmq-cluster-erlang-cookie","defaultMode":420}},{"name":"rabbitmq-plugins","emptyDir":{}},{"name":"pod-info","downwardAPI":{"items":[{"path":"skipPreStopChecks","fieldRef":{"apiVersion":"v1","fieldPath":"metadata.labels['skipPreStopChecks']"}}],"defaultMode":420}}],"initContainers":[{"name":"setup-container","image":"rabbitmq:3.8.12-management","command":["sh","-c","cp /tmp/erlang-cookie-secret/.erlang.cookie /var/lib/rabbitmq/.erlang.cookie \u0026\u0026 chown 999:999 /var/lib/rabbitmq/.erlang.cookie \u0026\u0026 chmod 600 /var/lib/rabbitmq/.erlang.cookie ; cp /tmp/rabbitmq-plugins/enabled_plugins /operator/enabled_plugins \u0026\u0026 chown 999:999 /operator/enabled_plugins ; chown 999:999 /var/lib/rabbitmq/mnesia/ ; echo '[default]' \u003e /var/lib/rabbitmq/.rabbitmqadmin.conf \u0026\u0026 sed -e 's/default_user/username/' -e 's/default_pass/password/' /tmp/default_user.conf \u003e\u003e /var/lib/rabbitmq/.rabbitmqadmin.conf \u0026\u0026 chown 999:999 /var/lib/rabbitmq/.rabbitmqadmin.conf \u0026\u0026 chmod 600 /var/lib/rabbitmq/.rabbitmqadmin.conf"],"resources":{"limits":{"cpu":"100m","memory":"500Mi"},"requests":{"cpu":"100m","memory":"500Mi"}},"volumeMounts":[{"name":"plugins-conf","mountPath":"/tmp/rabbitmq-plugins/"},{"name":"rabbitmq-erlang-cookie","mountPath":"/var/lib/rabbitmq/"},{"name":"erlang-cookie-secret","mountPath":"/tmp/erlang-cookie-secret/"},{"name":"rabbitmq-plugins","mountPath":"/operator"},{"name":"persistence","mountPath":"/var/lib/rabbitmq/mnesia/"},{"name":"rabbitmq-confd","mountPath":"/tmp/default_user.conf","subPath":"default_user.conf"}],"terminationMessagePath":"/dev/termination-log","terminationMessagePolicy":"File","imagePullPolicy":"IfNotPresent","securityContext":{"capabilities":{"drop":["FSETID","KILL","SETGID","SETUID","SETPCAP","NET_BIND_SERVICE","NET_RAW","SYS_CHROOT","MKNOD","AUDIT_WRITE","SETFCAP"]},"runAsUser":0}}],"containers":[{"name":"rabbitmq","image":"rabbitmq:3.8.12-management","ports":[{"name":"epmd","containerPort":4369,"protocol":"TCP"},{"name":"amqp","containerPort":5672,"protocol":"TCP"},{"name":"management","containerPort":15672,"protocol":"TCP"},{"name":"prometheus","containerPort":15692,"protocol":"TCP"}],"env":[{"name":"MY_POD_NAME","valueFrom":{"fieldRef":{"apiVersion":"v1","fieldPath":"metadata.name"}}},{"name":"MY_POD_NAMESPACE","valueFrom":{"fieldRef":{"apiVersion":"v1","fieldPath":"metadata.namespace"}}},{"name":"RABBITMQ_ENABLED_PLUGINS_FILE","value":"/operator/enabled_plugins"},{"name":"K8S_SERVICE_NAME","value":"rabbitmq-cluster-nodes"},{"name":"RABBITMQ_USE_LONGNAME","value":"true"},{"name":"RABBITMQ_NODENAME","value":"rabbit@$(MY_POD_NAME).$(K8S_SERVICE_NAME).$(MY_POD_NAMESPACE)"},{"name":"K8S_HOSTNAME_SUFFIX","value":".$(K8S_SERVICE_NAME).$(MY_POD_NAMESPACE)"}],"resources":{"limits":{"cpu":"2","memory":"2Gi"},"requests":{"cpu":"1","memory":"2Gi"}},"volumeMounts":[{"name":"rabbitmq-erlang-cookie","mountPath":"/var/lib/rabbitmq/"},{"name":"persistence","mountPath":"/var/lib/rabbitmq/mnesia/"},{"name":"rabbitmq-plugins","mountPath":"/operator"},{"name":"rabbitmq-confd","mountPath":"/etc/rabbitmq/conf.d/10-operatorDefaults.conf","subPath":"operatorDefaults.conf"},{"name":"rabbitmq-confd","mountPath":"/etc/rabbitmq/conf.d/11-default_user.conf","subPath":"default_user.conf"},{"name":"rabbitmq-confd","mountPath":"/etc/rabbitmq/conf.d/90-userDefinedConfiguration.conf","subPath":"userDefinedConfiguration.conf"},{"name":"pod-info","mountPath":"/etc/pod-info/"}],"readinessProbe":{"tcpSocket":{"port":"amqp"},"initialDelaySeconds":10,"timeoutSeconds":5,"periodSeconds":10,"successThreshold":1,"failureThreshold":3},"lifecycle":{"preStop":{"exec":{"command":["/bin/bash","-c","if [ ! -z \"$(cat /etc/pod-info/skipPreStopChecks)\" ]; then exit 0; fi; rabbitmq-upgrade await_online_quorum_plus_one -t 604800; rabbitmq-upgrade await_online_synchronized_mirror -t 604800; rabbitmq-upgrade drain -t 604800"]}}},"terminationMessagePath":"/dev/termination-log","terminationMessagePolicy":"File","imagePullPolicy":"IfNotPresent"}],"restartPolicy":"Always","terminationGracePeriodSeconds":604800,"dnsPolicy":"ClusterFirst","serviceAccountName":"rabbitmq-cluster-server","serviceAccount":"rabbitmq-cluster-server","automountServiceAccountToken":true,"securityContext":{"runAsUser":999,"runAsGroup":999,"fsGroup":999},"schedulerName":"default-scheduler","topologySpreadConstraints":[{"maxSkew":1,"topologyKey":"topology.kubernetes.io/zone","whenUnsatisfiable":"ScheduleAnyway","labelSelector":{"matchLabels":{"app.kubernetes.io/name":"rabbitmq-cluster"}}}]}},"volumeClaimTemplates":[{"metadata":{"name":"persistence","namespace":"default","creationTimestamp":null,"labels":{"app.kubernetes.io/component":"rabbitmq","app.kubernetes.io/name":"rabbitmq-cluster","app.kubernetes.io/part-of":"rabbitmq"},"ownerReferences":[{"apiVersion":"rabbitmq.com/v1beta1","kind":"RabbitmqCluster","name":"rabbitmq-cluster","uid":"18d9928b-0d1c-47be-80ec-20960d053827","controller":true,"blockOwnerDeletion":false}]},"spec":{"accessModes":["ReadWriteOnce"],"resources":{"requests":{"storage":"10Gi"}},"volumeMode":"Filesystem"},"status":{"phase":"Pending"}}],"serviceName":"rabbitmq-cluster-nodes","podManagementPolicy":"Parallel","updateStrategy":{"type":"RollingUpdate","rollingUpdate":{"partition":0}},"revisionHistoryLimit":10},"status":{"observedGeneration":1,"replicas":1,"currentReplicas":1,"updatedReplicas":1,"currentRevision":"rabbitmq-cluster-server-5f8b8665fb","updateRevision":"rabbitmq-cluster-server-5f8b8665fb","collisionCount":0}}
2022/03/18 18:00:38 learn_server.go:253: [SIEVE-AFTER-RECONCILE]	github.com/rabbitmq/cluster-operator/controllers.(*RabbitmqClusterReconciler)	1
2022/03/18 18:00:38 learn_server.go:238: [SIEVE-BEFORE-RECONCILE]	github.com/rabbitmq/cluster-operator/controllers.(*RabbitmqClusterReconciler)	2
2022/03/18 18:00:38 learn_server.go:291: [SIEVE-AFTER-READ]	Get	true	rabbitmqcluster	default	rabbitmq-cluster	github.com/rabbitmq/cluster-operator/controllers.(*RabbitmqClusterReconciler)	NoError	{"kind":"RabbitmqCluster","apiVersion":"rabbitmq.com/v1beta1","metadata":{"name":"rabbitmq-cluster","namespace":"default","selfLink":"/apis/rabbitmq.com/v1beta1/namespaces/default/rabbitmqclusters/rabbitmq-cluster","uid":"18d9928b-0d1c-47be-80ec-20960d053827","resourceVersion":"746","generation":2,"creationTimestamp":"2022-03-18T18:00:38Z","annotations":{"kubectl.kubernetes.io/last-applied-configuration":"{\"apiVersion\":\"rabbitmq.com/v1beta1\",\"kind\":\"RabbitmqCluster\",\"metadata\":{\"annotations\":{},\"name\":\"rabbitmq-cluster\",\"namespace\":\"default\"},\"spec\":{\"persistence\":{\"storage\":\"10Gi\"},\"replicas\":1}}\n"},"finalizers":["deletion.finalizers.rabbitmqclusters.rabbitmq.com"],"managedFields":[{"manager":"kubectl-client-side-apply","operation":"Update","apiVersion":"rabbitmq.com/v1beta1","time":"2022-03-18T18:00:38Z","fieldsType":"FieldsV1","fieldsV1":{"f:metadata":{"f:annotations":{".":{},"f:kubectl.kubernetes.io/last-applied-configuration":{}}},"f:spec":{".":{},"f:image":{},"f:persistence":{".":{},"f:storage":{}},"f:replicas":{},"f:resources":{".":{},"f:limits":{".":{},"f:memory":{}},"f:requests":{".":{},"f:memory":{}}},"f:service":{".":{},"f:type":{}},"f:terminationGracePeriodSeconds":{}}}},{"manager":"manager","operation":"Update","apiVersion":"rabbitmq.com/v1beta1","time":"2022-03-18T18:00:38Z","fieldsType":"FieldsV1","fieldsV1":{"f:metadata":{"f:finalizers":{}},"f:spec":{"f:override":{},"f:rabbitmq":{},"f:resources":{"f:limits":{"f:cpu":{}},"f:requests":{"f:cpu":{}}},"f:tls":{}},"f:status":{".":{},"f:conditions":{},"f:defaultUser":{".":{},"f:secretReference":{".":{},"f:keys":{".":{},"f:password":{},"f:username":{}},"f:name":{},"f:namespace":{}},"f:serviceReference":{".":{},"f:name":{},"f:namespace":{}}}}}}]},"spec":{"replicas":1,"image":"rabbitmq:3.8.12-management","service":{"type":"ClusterIP"},"persistence":{"storage":"10Gi"},"resources":{"limits":{"cpu":"2","memory":"2Gi"},"requests":{"cpu":"1","memory":"2Gi"}},"rabbitmq":{},"tls":{},"override":{},"terminationGracePeriodSeconds":604800},"status":{"conditions":[{"type":"AllReplicasReady","status":"False","lastTransitionTime":"2022-03-18T18:00:38Z","reason":"NotAllPodsReady","message":"0/1 Pods ready"},{"type":"ClusterAvailable","status":"False","lastTransitionTime":"2022-03-18T18:00:38Z","reason":"NoEndpointsAvailable","message":"The service has no endpoints available"},{"type":"NoWarnings","status":"True","lastTransitionTime":"2022-03-18T18:00:38Z","reason":"NoWarnings"},{"type":"ReconcileSuccess","status":"Unknown","lastTransitionTime":"2022-03-18T18:00:38Z","reason":"Initialising"}],"defaultUser":{"secretReference":{"name":"rabbitmq-cluster-default-user","namespace":"default","keys":{"password":"password","username":"username"}},"serviceReference":{"name":"rabbitmq-cluster","namespace":"default"}}}}
2022/03/18 18:00:38 learn_server.go:291: [SIEVE-AFTER-READ]	Get	true	statefulset	default	rabbitmq-cluster-server	github.com/rabbitmq/cluster-operator/controllers.(*RabbitmqClusterReconciler)	NoError	{"kind":"StatefulSet","apiVersion":"apps/v1","metadata":{"name":"rabbitmq-cluster-server","namespace":"default","selfLink":"/apis/apps/v1/namespaces/default/statefulsets/rabbitmq-cluster-server","uid":"cb5c43bc-6ee7-481c-ab01-6f3acffdd3c8","resourceVersion":"744","generation":1,"creationTimestamp":"2022-03-18T18:00:38Z","labels":{"app.kubernetes.io/component":"rabbitmq","app.kubernetes.io/name":"rabbitmq-cluster","app.kubernetes.io/part-of":"rabbitmq"},"annotations":{"rabbitmq.com/createdAt":"2022-03-18T18:00:38Z"},"ownerReferences":[{"apiVersion":"rabbitmq.com/v1beta1","kind":"RabbitmqCluster","name":"rabbitmq-cluster","uid":"18d9928b-0d1c-47be-80ec-20960d053827","controller":true,"blockOwnerDeletion":true}],"managedFields":[{"manager":"kube-controller-manager","operation":"Update","apiVersion":"apps/v1","time":"2022-03-18T18:00:38Z","fieldsType":"FieldsV1","fieldsV1":{"f:status":{"f:collisionCount":{},"f:currentReplicas":{},"f:currentRevision":{},"f:observedGeneration":{},"f:replicas":{},"f:updateRevision":{},"f:updatedReplicas":{}}}},{"manager":"manager","operation":"Update","apiVersion":"apps/v1","time":"2022-03-18T18:00:38Z","fieldsType":"FieldsV1","fieldsV1":{"f:metadata":{"f:annotations":{".":{},"f:rabbitmq.com/createdAt":{}},"f:labels":{".":{},"f:app.kubernetes.io/component":{},"f:app.kubernetes.io/name":{},"f:app.kubernetes.io/part-of":{}},"f:ownerReferences":{".":{},"k:{\"uid\":\"18d9928b-0d1c-47be-80ec-20960d053827\"}":{".":{},"f:apiVersion":{},"f:blockOwnerDeletion":{},"f:controller":{},"f:kind":{},"f:name":{},"f:uid":{}}}},"f:spec":{"f:podManagementPolicy":{},"f:replicas":{},"f:revisionHistoryLimit":{},"f:selector":{"f:matchLabels":{".":{},"f:app.kubernetes.io/name":{}}},"f:serviceName":{},"f:template":{"f:metadata":{"f:annotations":{".":{},"f:prometheus.io/port":{},"f:prometheus.io/scrape":{}},"f:labels":{".":{},"f:app.kubernetes.io/component":{},"f:app.kubernetes.io/name":{},"f:app.kubernetes.io/part-of":{}}},"f:spec":{"f:automountServiceAccountToken":{},"f:containers":{"k:{\"name\":\"rabbitmq\"}":{".":{},"f:env":{".":{},"k:{\"name\":\"K8S_HOSTNAME_SUFFIX\"}":{".":{},"f:name":{},"f:value":{}},"k:{\"name\":\"K8S_SERVICE_NAME\"}":{".":{},"f:name":{},"f:value":{}},"k:{\"name\":\"MY_POD_NAME\"}":{".":{},"f:name":{},"f:valueFrom":{".":{},"f:fieldRef":{".":{},"f:apiVersion":{},"f:fieldPath":{}}}},"k:{\"name\":\"MY_POD_NAMESPACE\"}":{".":{},"f:name":{},"f:valueFrom":{".":{},"f:fieldRef":{".":{},"f:apiVersion":{},"f:fieldPath":{}}}},"k:{\"name\":\"RABBITMQ_ENABLED_PLUGINS_FILE\"}":{".":{},"f:name":{},"f:value":{}},"k:{\"name\":\"RABBITMQ_NODENAME\"}":{".":{},"f:name":{},"f:value":{}},"k:{\"name\":\"RABBITMQ_USE_LONGNAME\"}":{".":{},"f:name":{},"f:value":{}}},"f:image":{},"f:imagePullPolicy":{},"f:lifecycle":{".":{},"f:preStop":{".":{},"f:exec":{".":{},"f:command":{}}}},"f:name":{},"f:ports":{".":{},"k:{\"containerPort\":4369,\"protocol\":\"TCP\"}":{".":{},"f:containerPort":{},"f:name":{},"f:protocol":{}},"k:{\"containerPort\":5672,\"protocol\":\"TCP\"}":{".":{},"f:containerPort":{},"f:name":{},"f:protocol":{}},"k:{\"containerPort\":15672,\"protocol\":\"TCP\"}":{".":{},"f:containerPort":{},"f:name":{},"f:protocol":{}},"k:{\"containerPort\":15692,\"protocol\":\"TCP\"}":{".":{},"f:containerPort":{},"f:name":{},"f:protocol":{}}},"f:readinessProbe":{".":{},"f:failureThreshold":{},"f:initialDelaySeconds":{},"f:periodSeconds":{},"f:successThreshold":{},"f:tcpSocket":{".":{},"f:port":{}},"f:timeoutSeconds":{}},"f:resources":{".":{},"f:limits":{".":{},"f:cpu":{},"f:memory":{}},"f:requests":{".":{},"f:cpu":{},"f:memory":{}}},"f:terminationMessagePath":{},"f:terminationMessagePolicy":{},"f:volumeMounts":{".":{},"k:{\"mountPath\":\"/etc/pod-info/\"}":{".":{},"f:mountPath":{},"f:name":{}},"k:{\"mountPath\":\"/etc/rabbitmq/conf.d/10-operatorDefaults.conf\"}":{".":{},"f:mountPath":{},"f:name":{},"f:subPath":{}},"k:{\"mountPath\":\"/etc/rabbitmq/conf.d/11-default_user.conf\"}":{".":{},"f:mountPath":{},"f:name":{},"f:subPath":{}},"k:{\"mountPath\":\"/etc/rabbitmq/conf.d/90-userDefinedConfiguration.conf\"}":{".":{},"f:mountPath":{},"f:name":{},"f:subPath":{}},"k:{\"mountPath\":\"/operator\"}":{".":{},"f:mountPath":{},"f:name":{}},"k:{\"mountPath\":\"/var/lib/rabbitmq/\"}":{".":{},"f:mountPath":{},"f:name":{}},"k:{\"mountPath\":\"/var/lib/rabbitmq/mnesia/\"}":{".":{},"f:mountPath":{},"f:name":{}}}}},"f:dnsPolicy":{},"f:initContainers":{".":{},"k:{\"name\":\"setup-container\"}":{".":{},"f:command":{},"f:image":{},"f:imagePullPolicy":{},"f:name":{},"f:resources":{".":{},"f:limits":{".":{},"f:cpu":{},"f:memory":{}},"f:requests":{".":{},"f:cpu":{},"f:memory":{}}},"f:securityContext":{".":{},"f:capabilities":{".":{},"f:drop":{}},"f:runAsUser":{}},"f:terminationMessagePath":{},"f:terminationMessagePolicy":{},"f:volumeMounts":{".":{},"k:{\"mountPath\":\"/operator\"}":{".":{},"f:mountPath":{},"f:name":{}},"k:{\"mountPath\":\"/tmp/default_user.conf\"}":{".":{},"f:mountPath":{},"f:name":{},"f:subPath":{}},"k:{\"mountPath\":\"/tmp/erlang-cookie-secret/\"}":{".":{},"f:mountPath":{},"f:name":{}},"k:{\"mountPath\":\"/tmp/rabbitmq-plugins/\"}":{".":{},"f:mountPath":{},"f:name":{}},"k:{\"mountPath\":\"/var/lib/rabbitmq/\"}":{".":{},"f:mountPath":{},"f:name":{}},"k:{\"mountPath\":\"/var/lib/rabbitmq/mnesia/\"}":{".":{},"f:mountPath":{},"f:name":{}}}}},"f:restartPolicy":{},"f:schedulerName":{},"f:securityContext":{".":{},"f:fsGroup":{},"f:runAsGroup":{},"f:runAsUser":{}},"f:serviceAccount":{},"f:serviceAccountName":{},"f:terminationGracePeriodSeconds":{},"f:topologySpreadConstraints":{".":{},"k:{\"topologyKey\":\"topology.kubernetes.io/zone\",\"whenUnsatisfiable\":\"ScheduleAnyway\"}":{".":{},"f:labelSelector":{".":{},"f:matchLabels":{".":{},"f:app.kubernetes.io/name":{}}},"f:maxSkew":{},"f:topologyKey":{},"f:whenUnsatisfiable":{}}},"f:volumes":{".":{},"k:{\"name\":\"erlang-cookie-secret\"}":{".":{},"f:name":{},"f:secret":{".":{},"f:defaultMode":{},"f:secretName":{}}},"k:{\"name\":\"plugins-conf\"}":{".":{},"f:configMap":{".":{},"f:defaultMode":{},"f:name":{}},"f:name":{}},"k:{\"name\":\"pod-info\"}":{".":{},"f:downwardAPI":{".":{},"f:defaultMode":{},"f:items":{}},"f:name":{}},"k:{\"name\":\"rabbitmq-confd\"}":{".":{},"f:name":{},"f:projected":{".":{},"f:defaultMode":{},"f:sources":{}}},"k:{\"name\":\"rabbitmq-erlang-cookie\"}":{".":{},"f:emptyDir":{},"f:name":{}},"k:{\"name\":\"rabbitmq-plugins\"}":{".":{},"f:emptyDir":{},"f:name":{}}}}},"f:updateStrategy":{"f:rollingUpdate":{".":{},"f:partition":{}},"f:type":{}},"f:volumeClaimTemplates":{}}}}]},"spec":{"replicas":1,"selector":{"matchLabels":{"app.kubernetes.io/name":"rabbitmq-cluster"}},"template":{"metadata":{"creationTimestamp":null,"labels":{"app.kubernetes.io/component":"rabbitmq","app.kubernetes.io/name":"rabbitmq-cluster","app.kubernetes.io/part-of":"rabbitmq"},"annotations":{"prometheus.io/port":"15692","prometheus.io/scrape":"true"}},"spec":{"volumes":[{"name":"plugins-conf","configMap":{"name":"rabbitmq-cluster-plugins-conf","defaultMode":420}},{"name":"rabbitmq-confd","projected":{"sources":[{"secret":{"name":"rabbitmq-cluster-default-user","items":[{"key":"default_user.conf","path":"default_user.conf"}]}},{"configMap":{"name":"rabbitmq-cluster-server-conf","items":[{"key":"operatorDefaults.conf","path":"operatorDefaults.conf"},{"key":"userDefinedConfiguration.conf","path":"userDefinedConfiguration.conf"}]}}],"defaultMode":420}},{"name":"rabbitmq-erlang-cookie","emptyDir":{}},{"name":"erlang-cookie-secret","secret":{"secretName":"rabbitmq-cluster-erlang-cookie","defaultMode":420}},{"name":"rabbitmq-plugins","emptyDir":{}},{"name":"pod-info","downwardAPI":{"items":[{"path":"skipPreStopChecks","fieldRef":{"apiVersion":"v1","fieldPath":"metadata.labels['skipPreStopChecks']"}}],"defaultMode":420}}],"initContainers":[{"name":"setup-container","image":"rabbitmq:3.8.12-management","command":["sh","-c","cp /tmp/erlang-cookie-secret/.erlang.cookie /var/lib/rabbitmq/.erlang.cookie \u0026\u0026 chown 999:999 /var/lib/rabbitmq/.erlang.cookie \u0026\u0026 chmod 600 /var/lib/rabbitmq/.erlang.cookie ; cp /tmp/rabbitmq-plugins/enabled_plugins /operator/enabled_plugins \u0026\u0026 chown 999:999 /operator/enabled_plugins ; chown 999:999 /var/lib/rabbitmq/mnesia/ ; echo '[default]' \u003e /var/lib/rabbitmq/.rabbitmqadmin.conf \u0026\u0026 sed -e 's/default_user/username/' -e 's/default_pass/password/' /tmp/default_user.conf \u003e\u003e /var/lib/rabbitmq/.rabbitmqadmin.conf \u0026\u0026 chown 999:999 /var/lib/rabbitmq/.rabbitmqadmin.conf \u0026\u0026 chmod 600 /var/lib/rabbitmq/.rabbitmqadmin.conf"],"resources":{"limits":{"cpu":"100m","memory":"500Mi"},"requests":{"cpu":"100m","memory":"500Mi"}},"volumeMounts":[{"name":"plugins-conf","mountPath":"/tmp/rabbitmq-plugins/"},{"name":"rabbitmq-erlang-cookie","mountPath":"/var/lib/rabbitmq/"},{"name":"erlang-cookie-secret","mountPath":"/tmp/erlang-cookie-secret/"},{"name":"rabbitmq-plugins","mountPath":"/operator"},{"name":"persistence","mountPath":"/var/lib/rabbitmq/mnesia/"},{"name":"rabbitmq-confd","mountPath":"/tmp/default_user.conf","subPath":"default_user.conf"}],"terminationMessagePath":"/dev/termination-log","terminationMessagePolicy":"File","imagePullPolicy":"IfNotPresent","securityContext":{"capabilities":{"drop":["FSETID","KILL","SETGID","SETUID","SETPCAP","NET_BIND_SERVICE","NET_RAW","SYS_CHROOT","MKNOD","AUDIT_WRITE","SETFCAP"]},"runAsUser":0}}],"containers":[{"name":"rabbitmq","image":"rabbitmq:3.8.12-management","ports":[{"name":"epmd","containerPort":4369,"protocol":"TCP"},{"name":"amqp","containerPort":5672,"protocol":"TCP"},{"name":"management","containerPort":15672,"protocol":"TCP"},{"name":"prometheus","containerPort":15692,"protocol":"TCP"}],"env":[{"name":"MY_POD_NAME","valueFrom":{"fieldRef":{"apiVersion":"v1","fieldPath":"metadata.name"}}},{"name":"MY_POD_NAMESPACE","valueFrom":{"fieldRef":{"apiVersion":"v1","fieldPath":"metadata.namespace"}}},{"name":"RABBITMQ_ENABLED_PLUGINS_FILE","value":"/operator/enabled_plugins"},{"name":"K8S_SERVICE_NAME","value":"rabbitmq-cluster-nodes"},{"name":"RABBITMQ_USE_LONGNAME","value":"true"},{"name":"RABBITMQ_NODENAME","value":"rabbit@$(MY_POD_NAME).$(K8S_SERVICE_NAME).$(MY_POD_NAMESPACE)"},{"name":"K8S_HOSTNAME_SUFFIX","value":".$(K8S_SERVICE_NAME).$(MY_POD_NAMESPACE)"}],"resources":{"limits":{"cpu":"2","memory":"2Gi"},"requests":{"cpu":"1","memory":"2Gi"}},"volumeMounts":[{"name":"rabbitmq-erlang-cookie","mountPath":"/var/lib/rabbitmq/"},{"name":"persistence","mountPath":"/var/lib/rabbitmq/mnesia/"},{"name":"rabbitmq-plugins","mountPath":"/operator"},{"name":"rabbitmq-confd","mountPath":"/etc/rabbitmq/conf.d/10-operatorDefaults.conf","subPath":"operatorDefaults.conf"},{"name":"rabbitmq-confd","mountPath":"/etc/rabbitmq/conf.d/11-default_user.conf","subPath":"default_user.conf"},{"name":"rabbitmq-confd","mountPath":"/etc/rabbitmq/conf.d/90-userDefinedConfiguration.conf","subPath":"userDefinedConfiguration.conf"},{"name":"pod-info","mountPath":"/etc/pod-info/"}],"readinessProbe":{"tcpSocket":{"port":"amqp"},"initialDelaySeconds":10,"timeoutSeconds":5,"periodSeconds":10,"successThreshold":1,"failureThreshold":3},"lifecycle":{"preStop":{"exec":{"command":["/bin/bash","-c","if [ ! -z \"$(cat /etc/pod-info/skipPreStopChecks)\" ]; then exit 0; fi; rabbitmq-upgrade await_online_quorum_plus_one -t 604800; rabbitmq-upgrade await_online_synchronized_mirror -t 604800; rabbitmq-upgrade drain -t 604800"]}}},"terminationMessagePath":"/dev/termination-log","terminationMessagePolicy":"File","imagePullPolicy":"IfNotPresent"}],"restartPolicy":"Always","terminationGracePeriodSeconds":604800,"dnsPolicy":"ClusterFirst","serviceAccountName":"rabbitmq-cluster-server","serviceAccount":"rabbitmq-cluster-server","automountServiceAccountToken":true,"securityContext":{"runAsUser":999,"runAsGroup":999,"fsGroup":999},"schedulerName":"default-scheduler","topologySpreadConstraints":[{"maxSkew":1,"topologyKey":"topology.kubernetes.io/zone","whenUnsatisfiable":"ScheduleAnyway","labelSelector":{"matchLabels":{"app.kubernetes.io/name":"rabbitmq-cluster"}}}]}},"volumeClaimTemplates":[{"metadata":{"name":"persistence","namespace":"default","creationTimestamp":null,"labels":{"app.kubernetes.io/component":"rabbitmq","app.kubernetes.io/name":"rabbitmq-cluster","app.kubernetes.io/part-of":"rabbitmq"},"ownerReferences":[{"apiVersion":"rabbitmq.com/v1beta1","kind":"RabbitmqCluster","name":"rabbitmq-cluster","uid":"18d9928b-0d1c-47be-80ec-20960d053827","controller":true,"blockOwnerDeletion":false}]},"spec":{"accessModes":["ReadWriteOnce"],"resources":{"requests":{"storage":"10Gi"}},"volumeMode":"Filesystem"},"status":{"phase":"Pending"}}],"serviceName":"rabbitmq-cluster-nodes","podManagementPolicy":"Parallel","updateStrategy":{"type":"RollingUpdate","rollingUpdate":{"partition":0}},"revisionHistoryLimit":10},"status":{"observedGeneration":1,"replicas":1,"currentReplicas":1,"updatedReplicas":1,"currentRevision":"rabbitmq-cluster-server-5f8b8665fb","updateRevision":"rabbitmq-cluster-server-5f8b8665fb","collisionCount":0}}
2022/03/18 18:00:38 learn_server.go:291: [SIEVE-AFTER-READ]	Get	true	endpoints	default	rabbitmq-cluster	github.com/rabbitmq/cluster-operator/controllers.(*RabbitmqClusterReconciler)	NoError	{"kind":"Endpoints","apiVersion":"v1","metadata":{"name":"rabbitmq-cluster","namespace":"default","selfLink":"/api/v1/namespaces/default/endpoints/rabbitmq-cluster","uid":"5c4723ad-f4fe-442d-9135-44879a2a8183","resourceVersion":"702","creationTimestamp":"2022-03-18T18:00:38Z","labels":{"app.kubernetes.io/component":"rabbitmq","app.kubernetes.io/name":"rabbitmq-cluster","app.kubernetes.io/part-of":"rabbitmq"},"annotations":{"endpoints.kubernetes.io/last-change-trigger-time":"2022-03-18T18:00:38Z"},"managedFields":[{"manager":"kube-controller-manager","operation":"Update","apiVersion":"v1","time":"2022-03-18T18:00:38Z","fieldsType":"FieldsV1","fieldsV1":{"f:metadata":{"f:annotations":{".":{},"f:endpoints.kubernetes.io/last-change-trigger-time":{}},"f:labels":{".":{},"f:app.kubernetes.io/component":{},"f:app.kubernetes.io/name":{},"f:app.kubernetes.io/part-of":{}}}}}]}}
2022/03/18 18:00:38 learn_server.go:291: [SIEVE-AFTER-READ]	Get	true	statefulset	default	rabbitmq-cluster-server	github.com/rabbitmq/cluster-operator/controllers.(*RabbitmqClusterReconciler)	NoError	{"kind":"StatefulSet","apiVersion":"apps/v1","metadata":{"name":"rabbitmq-cluster-server","namespace":"default","selfLink":"/apis/apps/v1/namespaces/default/statefulsets/rabbitmq-cluster-server","uid":"cb5c43bc-6ee7-481c-ab01-6f3acffdd3c8","resourceVersion":"744","generation":1,"creationTimestamp":"2022-03-18T18:00:38Z","labels":{"app.kubernetes.io/component":"rabbitmq","app.kubernetes.io/name":"rabbitmq-cluster","app.kubernetes.io/part-of":"rabbitmq"},"annotations":{"rabbitmq.com/createdAt":"2022-03-18T18:00:38Z"},"ownerReferences":[{"apiVersion":"rabbitmq.com/v1beta1","kind":"RabbitmqCluster","name":"rabbitmq-cluster","uid":"18d9928b-0d1c-47be-80ec-20960d053827","controller":true,"blockOwnerDeletion":true}],"managedFields":[{"manager":"kube-controller-manager","operation":"Update","apiVersion":"apps/v1","time":"2022-03-18T18:00:38Z","fieldsType":"FieldsV1","fieldsV1":{"f:status":{"f:collisionCount":{},"f:currentReplicas":{},"f:currentRevision":{},"f:observedGeneration":{},"f:replicas":{},"f:updateRevision":{},"f:updatedReplicas":{}}}},{"manager":"manager","operation":"Update","apiVersion":"apps/v1","time":"2022-03-18T18:00:38Z","fieldsType":"FieldsV1","fieldsV1":{"f:metadata":{"f:annotations":{".":{},"f:rabbitmq.com/createdAt":{}},"f:labels":{".":{},"f:app.kubernetes.io/component":{},"f:app.kubernetes.io/name":{},"f:app.kubernetes.io/part-of":{}},"f:ownerReferences":{".":{},"k:{\"uid\":\"18d9928b-0d1c-47be-80ec-20960d053827\"}":{".":{},"f:apiVersion":{},"f:blockOwnerDeletion":{},"f:controller":{},"f:kind":{},"f:name":{},"f:uid":{}}}},"f:spec":{"f:podManagementPolicy":{},"f:replicas":{},"f:revisionHistoryLimit":{},"f:selector":{"f:matchLabels":{".":{},"f:app.kubernetes.io/name":{}}},"f:serviceName":{},"f:template":{"f:metadata":{"f:annotations":{".":{},"f:prometheus.io/port":{},"f:prometheus.io/scrape":{}},"f:labels":{".":{},"f:app.kubernetes.io/component":{},"f:app.kubernetes.io/name":{},"f:app.kubernetes.io/part-of":{}}},"f:spec":{"f:automountServiceAccountToken":{},"f:containers":{"k:{\"name\":\"rabbitmq\"}":{".":{},"f:env":{".":{},"k:{\"name\":\"K8S_HOSTNAME_SUFFIX\"}":{".":{},"f:name":{},"f:value":{}},"k:{\"name\":\"K8S_SERVICE_NAME\"}":{".":{},"f:name":{},"f:value":{}},"k:{\"name\":\"MY_POD_NAME\"}":{".":{},"f:name":{},"f:valueFrom":{".":{},"f:fieldRef":{".":{},"f:apiVersion":{},"f:fieldPath":{}}}},"k:{\"name\":\"MY_POD_NAMESPACE\"}":{".":{},"f:name":{},"f:valueFrom":{".":{},"f:fieldRef":{".":{},"f:apiVersion":{},"f:fieldPath":{}}}},"k:{\"name\":\"RABBITMQ_ENABLED_PLUGINS_FILE\"}":{".":{},"f:name":{},"f:value":{}},"k:{\"name\":\"RABBITMQ_NODENAME\"}":{".":{},"f:name":{},"f:value":{}},"k:{\"name\":\"RABBITMQ_USE_LONGNAME\"}":{".":{},"f:name":{},"f:value":{}}},"f:image":{},"f:imagePullPolicy":{},"f:lifecycle":{".":{},"f:preStop":{".":{},"f:exec":{".":{},"f:command":{}}}},"f:name":{},"f:ports":{".":{},"k:{\"containerPort\":4369,\"protocol\":\"TCP\"}":{".":{},"f:containerPort":{},"f:name":{},"f:protocol":{}},"k:{\"containerPort\":5672,\"protocol\":\"TCP\"}":{".":{},"f:containerPort":{},"f:name":{},"f:protocol":{}},"k:{\"containerPort\":15672,\"protocol\":\"TCP\"}":{".":{},"f:containerPort":{},"f:name":{},"f:protocol":{}},"k:{\"containerPort\":15692,\"protocol\":\"TCP\"}":{".":{},"f:containerPort":{},"f:name":{},"f:protocol":{}}},"f:readinessProbe":{".":{},"f:failureThreshold":{},"f:initialDelaySeconds":{},"f:periodSeconds":{},"f:successThreshold":{},"f:tcpSocket":{".":{},"f:port":{}},"f:timeoutSeconds":{}},"f:resources":{".":{},"f:limits":{".":{},"f:cpu":{},"f:memory":{}},"f:requests":{".":{},"f:cpu":{},"f:memory":{}}},"f:terminationMessagePath":{},"f:terminationMessagePolicy":{},"f:volumeMounts":{".":{},"k:{\"mountPath\":\"/etc/pod-info/\"}":{".":{},"f:mountPath":{},"f:name":{}},"k:{\"mountPath\":\"/etc/rabbitmq/conf.d/10-operatorDefaults.conf\"}":{".":{},"f:mountPath":{},"f:name":{},"f:subPath":{}},"k:{\"mountPath\":\"/etc/rabbitmq/conf.d/11-default_user.conf\"}":{".":{},"f:mountPath":{},"f:name":{},"f:subPath":{}},"k:{\"mountPath\":\"/etc/rabbitmq/conf.d/90-userDefinedConfiguration.conf\"}":{".":{},"f:mountPath":{},"f:name":{},"f:subPath":{}},"k:{\"mountPath\":\"/operator\"}":{".":{},"f:mountPath":{},"f:name":{}},"k:{\"mountPath\":\"/var/lib/rabbitmq/\"}":{".":{},"f:mountPath":{},"f:name":{}},"k:{\"mountPath\":\"/var/lib/rabbitmq/mnesia/\"}":{".":{},"f:mountPath":{},"f:name":{}}}}},"f:dnsPolicy":{},"f:initContainers":{".":{},"k:{\"name\":\"setup-container\"}":{".":{},"f:command":{},"f:image":{},"f:imagePullPolicy":{},"f:name":{},"f:resources":{".":{},"f:limits":{".":{},"f:cpu":{},"f:memory":{}},"f:requests":{".":{},"f:cpu":{},"f:memory":{}}},"f:securityContext":{".":{},"f:capabilities":{".":{},"f:drop":{}},"f:runAsUser":{}},"f:terminationMessagePath":{},"f:terminationMessagePolicy":{},"f:volumeMounts":{".":{},"k:{\"mountPath\":\"/operator\"}":{".":{},"f:mountPath":{},"f:name":{}},"k:{\"mountPath\":\"/tmp/default_user.conf\"}":{".":{},"f:mountPath":{},"f:name":{},"f:subPath":{}},"k:{\"mountPath\":\"/tmp/erlang-cookie-secret/\"}":{".":{},"f:mountPath":{},"f:name":{}},"k:{\"mountPath\":\"/tmp/rabbitmq-plugins/\"}":{".":{},"f:mountPath":{},"f:name":{}},"k:{\"mountPath\":\"/var/lib/rabbitmq/\"}":{".":{},"f:mountPath":{},"f:name":{}},"k:{\"mountPath\":\"/var/lib/rabbitmq/mnesia/\"}":{".":{},"f:mountPath":{},"f:name":{}}}}},"f:restartPolicy":{},"f:schedulerName":{},"f:securityContext":{".":{},"f:fsGroup":{},"f:runAsGroup":{},"f:runAsUser":{}},"f:serviceAccount":{},"f:serviceAccountName":{},"f:terminationGracePeriodSeconds":{},"f:topologySpreadConstraints":{".":{},"k:{\"topologyKey\":\"topology.kubernetes.io/zone\",\"whenUnsatisfiable\":\"ScheduleAnyway\"}":{".":{},"f:labelSelector":{".":{},"f:matchLabels":{".":{},"f:app.kubernetes.io/name":{}}},"f:maxSkew":{},"f:topologyKey":{},"f:whenUnsatisfiable":{}}},"f:volumes":{".":{},"k:{\"name\":\"erlang-cookie-secret\"}":{".":{},"f:name":{},"f:secret":{".":{},"f:defaultMode":{},"f:secretName":{}}},"k:{\"name\":\"plugins-conf\"}":{".":{},"f:configMap":{".":{},"f:defaultMode":{},"f:name":{}},"f:name":{}},"k:{\"name\":\"pod-info\"}":{".":{},"f:downwardAPI":{".":{},"f:defaultMode":{},"f:items":{}},"f:name":{}},"k:{\"name\":\"rabbitmq-confd\"}":{".":{},"f:name":{},"f:projected":{".":{},"f:defaultMode":{},"f:sources":{}}},"k:{\"name\":\"rabbitmq-erlang-cookie\"}":{".":{},"f:emptyDir":{},"f:name":{}},"k:{\"name\":\"rabbitmq-plugins\"}":{".":{},"f:emptyDir":{},"f:name":{}}}}},"f:updateStrategy":{"f:rollingUpdate":{".":{},"f:partition":{}},"f:type":{}},"f:volumeClaimTemplates":{}}}}]},"spec":{"replicas":1,"selector":{"matchLabels":{"app.kubernetes.io/name":"rabbitmq-cluster"}},"template":{"metadata":{"creationTimestamp":null,"labels":{"app.kubernetes.io/component":"rabbitmq","app.kubernetes.io/name":"rabbitmq-cluster","app.kubernetes.io/part-of":"rabbitmq"},"annotations":{"prometheus.io/port":"15692","prometheus.io/scrape":"true"}},"spec":{"volumes":[{"name":"plugins-conf","configMap":{"name":"rabbitmq-cluster-plugins-conf","defaultMode":420}},{"name":"rabbitmq-confd","projected":{"sources":[{"secret":{"name":"rabbitmq-cluster-default-user","items":[{"key":"default_user.conf","path":"default_user.conf"}]}},{"configMap":{"name":"rabbitmq-cluster-server-conf","items":[{"key":"operatorDefaults.conf","path":"operatorDefaults.conf"},{"key":"userDefinedConfiguration.conf","path":"userDefinedConfiguration.conf"}]}}],"defaultMode":420}},{"name":"rabbitmq-erlang-cookie","emptyDir":{}},{"name":"erlang-cookie-secret","secret":{"secretName":"rabbitmq-cluster-erlang-cookie","defaultMode":420}},{"name":"rabbitmq-plugins","emptyDir":{}},{"name":"pod-info","downwardAPI":{"items":[{"path":"skipPreStopChecks","fieldRef":{"apiVersion":"v1","fieldPath":"metadata.labels['skipPreStopChecks']"}}],"defaultMode":420}}],"initContainers":[{"name":"setup-container","image":"rabbitmq:3.8.12-management","command":["sh","-c","cp /tmp/erlang-cookie-secret/.erlang.cookie /var/lib/rabbitmq/.erlang.cookie \u0026\u0026 chown 999:999 /var/lib/rabbitmq/.erlang.cookie \u0026\u0026 chmod 600 /var/lib/rabbitmq/.erlang.cookie ; cp /tmp/rabbitmq-plugins/enabled_plugins /operator/enabled_plugins \u0026\u0026 chown 999:999 /operator/enabled_plugins ; chown 999:999 /var/lib/rabbitmq/mnesia/ ; echo '[default]' \u003e /var/lib/rabbitmq/.rabbitmqadmin.conf \u0026\u0026 sed -e 's/default_user/username/' -e 's/default_pass/password/' /tmp/default_user.conf \u003e\u003e /var/lib/rabbitmq/.rabbitmqadmin.conf \u0026\u0026 chown 999:999 /var/lib/rabbitmq/.rabbitmqadmin.conf \u0026\u0026 chmod 600 /var/lib/rabbitmq/.rabbitmqadmin.conf"],"resources":{"limits":{"cpu":"100m","memory":"500Mi"},"requests":{"cpu":"100m","memory":"500Mi"}},"volumeMounts":[{"name":"plugins-conf","mountPath":"/tmp/rabbitmq-plugins/"},{"name":"rabbitmq-erlang-cookie","mountPath":"/var/lib/rabbitmq/"},{"name":"erlang-cookie-secret","mountPath":"/tmp/erlang-cookie-secret/"},{"name":"rabbitmq-plugins","mountPath":"/operator"},{"name":"persistence","mountPath":"/var/lib/rabbitmq/mnesia/"},{"name":"rabbitmq-confd","mountPath":"/tmp/default_user.conf","subPath":"default_user.conf"}],"terminationMessagePath":"/dev/termination-log","terminationMessagePolicy":"File","imagePullPolicy":"IfNotPresent","securityContext":{"capabilities":{"drop":["FSETID","KILL","SETGID","SETUID","SETPCAP","NET_BIND_SERVICE","NET_RAW","SYS_CHROOT","MKNOD","AUDIT_WRITE","SETFCAP"]},"runAsUser":0}}],"containers":[{"name":"rabbitmq","image":"rabbitmq:3.8.12-management","ports":[{"name":"epmd","containerPort":4369,"protocol":"TCP"},{"name":"amqp","containerPort":5672,"protocol":"TCP"},{"name":"management","containerPort":15672,"protocol":"TCP"},{"name":"prometheus","containerPort":15692,"protocol":"TCP"}],"env":[{"name":"MY_POD_NAME","valueFrom":{"fieldRef":{"apiVersion":"v1","fieldPath":"metadata.name"}}},{"name":"MY_POD_NAMESPACE","valueFrom":{"fieldRef":{"apiVersion":"v1","fieldPath":"metadata.namespace"}}},{"name":"RABBITMQ_ENABLED_PLUGINS_FILE","value":"/operator/enabled_plugins"},{"name":"K8S_SERVICE_NAME","value":"rabbitmq-cluster-nodes"},{"name":"RABBITMQ_USE_LONGNAME","value":"true"},{"name":"RABBITMQ_NODENAME","value":"rabbit@$(MY_POD_NAME).$(K8S_SERVICE_NAME).$(MY_POD_NAMESPACE)"},{"name":"K8S_HOSTNAME_SUFFIX","value":".$(K8S_SERVICE_NAME).$(MY_POD_NAMESPACE)"}],"resources":{"limits":{"cpu":"2","memory":"2Gi"},"requests":{"cpu":"1","memory":"2Gi"}},"volumeMounts":[{"name":"rabbitmq-erlang-cookie","mountPath":"/var/lib/rabbitmq/"},{"name":"persistence","mountPath":"/var/lib/rabbitmq/mnesia/"},{"name":"rabbitmq-plugins","mountPath":"/operator"},{"name":"rabbitmq-confd","mountPath":"/etc/rabbitmq/conf.d/10-operatorDefaults.conf","subPath":"operatorDefaults.conf"},{"name":"rabbitmq-confd","mountPath":"/etc/rabbitmq/conf.d/11-default_user.conf","subPath":"default_user.conf"},{"name":"rabbitmq-confd","mountPath":"/etc/rabbitmq/conf.d/90-userDefinedConfiguration.conf","subPath":"userDefinedConfiguration.conf"},{"name":"pod-info","mountPath":"/etc/pod-info/"}],"readinessProbe":{"tcpSocket":{"port":"amqp"},"initialDelaySeconds":10,"timeoutSeconds":5,"periodSeconds":10,"successThreshold":1,"failureThreshold":3},"lifecycle":{"preStop":{"exec":{"command":["/bin/bash","-c","if [ ! -z \"$(cat /etc/pod-info/skipPreStopChecks)\" ]; then exit 0; fi; rabbitmq-upgrade await_online_quorum_plus_one -t 604800; rabbitmq-upgrade await_online_synchronized_mirror -t 604800; rabbitmq-upgrade drain -t 604800"]}}},"terminationMessagePath":"/dev/termination-log","terminationMessagePolicy":"File","imagePullPolicy":"IfNotPresent"}],"restartPolicy":"Always","terminationGracePeriodSeconds":604800,"dnsPolicy":"ClusterFirst","serviceAccountName":"rabbitmq-cluster-server","serviceAccount":"rabbitmq-cluster-server","automountServiceAccountToken":true,"securityContext":{"runAsUser":999,"runAsGroup":999,"fsGroup":999},"schedulerName":"default-scheduler","topologySpreadConstraints":[{"maxSkew":1,"topologyKey":"topology.kubernetes.io/zone","whenUnsatisfiable":"ScheduleAnyway","labelSelector":{"matchLabels":{"app.kubernetes.io/name":"rabbitmq-cluster"}}}]}},"volumeClaimTemplates":[{"metadata":{"name":"persistence","namespace":"default","creationTimestamp":null,"labels":{"app.kubernetes.io/component":"rabbitmq","app.kubernetes.io/name":"rabbitmq-cluster","app.kubernetes.io/part-of":"rabbitmq"},"ownerReferences":[{"apiVersion":"rabbitmq.com/v1beta1","kind":"RabbitmqCluster","name":"rabbitmq-cluster","uid":"18d9928b-0d1c-47be-80ec-20960d053827","controller":true,"blockOwnerDeletion":false}]},"spec":{"accessModes":["ReadWriteOnce"],"resources":{"requests":{"storage":"10Gi"}},"volumeMode":"Filesystem"},"status":{"phase":"Pending"}}],"serviceName":"rabbitmq-cluster-nodes","podManagementPolicy":"Parallel","updateStrategy":{"type":"RollingUpdate","rollingUpdate":{"partition":0}},"revisionHistoryLimit":10},"status":{"observedGeneration":1,"replicas":1,"currentReplicas":1,"updatedReplicas":1,"currentRevision":"rabbitmq-cluster-server-5f8b8665fb","updateRevision":"rabbitmq-cluster-server-5f8b8665fb","collisionCount":0}}
2022/03/18 18:00:38 learn_server.go:291: [SIEVE-AFTER-READ]	Get	true	service	default	rabbitmq-cluster-nodes	github.com/rabbitmq/cluster-operator/controllers.(*RabbitmqClusterReconciler)	NoError	{"kind":"Service","apiVersion":"v1","metadata":{"name":"rabbitmq-cluster-nodes","namespace":"default","selfLink":"/api/v1/namespaces/default/services/rabbitmq-cluster-nodes","uid":"67c7eea9-1b87-4fd7-82e6-5bfe31fd1b52","resourceVersion":"696","creationTimestamp":"2022-03-18T18:00:38Z","labels":{"app.kubernetes.io/component":"rabbitmq","app.kubernetes.io/name":"rabbitmq-cluster","app.kubernetes.io/part-of":"rabbitmq"},"ownerReferences":[{"apiVersion":"rabbitmq.com/v1beta1","kind":"RabbitmqCluster","name":"rabbitmq-cluster","uid":"18d9928b-0d1c-47be-80ec-20960d053827","controller":true,"blockOwnerDeletion":true}],"managedFields":[{"manager":"manager","operation":"Update","apiVersion":"v1","time":"2022-03-18T18:00:38Z","fieldsType":"FieldsV1","fieldsV1":{"f:metadata":{"f:labels":{".":{},"f:app.kubernetes.io/component":{},"f:app.kubernetes.io/name":{},"f:app.kubernetes.io/part-of":{}},"f:ownerReferences":{".":{},"k:{\"uid\":\"18d9928b-0d1c-47be-80ec-20960d053827\"}":{".":{},"f:apiVersion":{},"f:blockOwnerDeletion":{},"f:controller":{},"f:kind":{},"f:name":{},"f:uid":{}}}},"f:spec":{"f:clusterIP":{},"f:ports":{".":{},"k:{\"port\":4369,\"protocol\":\"TCP\"}":{".":{},"f:name":{},"f:port":{},"f:protocol":{},"f:targetPort":{}},"k:{\"port\":25672,\"protocol\":\"TCP\"}":{".":{},"f:name":{},"f:port":{},"f:protocol":{},"f:targetPort":{}}},"f:publishNotReadyAddresses":{},"f:selector":{".":{},"f:app.kubernetes.io/name":{}},"f:sessionAffinity":{},"f:type":{}}}}]},"spec":{"ports":[{"name":"epmd","protocol":"TCP","port":4369,"targetPort":4369},{"name":"cluster-rpc","protocol":"TCP","port":25672,"targetPort":25672}],"selector":{"app.kubernetes.io/name":"rabbitmq-cluster"},"clusterIP":"None","type":"ClusterIP","sessionAffinity":"None","publishNotReadyAddresses":true},"status":{"loadBalancer":{}}}
2022/03/18 18:00:38 learn_server.go:291: [SIEVE-AFTER-READ]	Get	true	service	default	rabbitmq-cluster	github.com/rabbitmq/cluster-operator/controllers.(*RabbitmqClusterReconciler)	NoError	{"kind":"Service","apiVersion":"v1","metadata":{"name":"rabbitmq-cluster","namespace":"default","selfLink":"/api/v1/namespaces/default/services/rabbitmq-cluster","uid":"56b50671-1945-458b-adac-05619b783392","resourceVersion":"701","creationTimestamp":"2022-03-18T18:00:38Z","labels":{"app.kubernetes.io/component":"rabbitmq","app.kubernetes.io/name":"rabbitmq-cluster","app.kubernetes.io/part-of":"rabbitmq"},"ownerReferences":[{"apiVersion":"rabbitmq.com/v1beta1","kind":"RabbitmqCluster","name":"rabbitmq-cluster","uid":"18d9928b-0d1c-47be-80ec-20960d053827","controller":true,"blockOwnerDeletion":true}],"managedFields":[{"manager":"manager","operation":"Update","apiVersion":"v1","time":"2022-03-18T18:00:38Z","fieldsType":"FieldsV1","fieldsV1":{"f:metadata":{"f:labels":{".":{},"f:app.kubernetes.io/component":{},"f:app.kubernetes.io/name":{},"f:app.kubernetes.io/part-of":{}},"f:ownerReferences":{".":{},"k:{\"uid\":\"18d9928b-0d1c-47be-80ec-20960d053827\"}":{".":{},"f:apiVersion":{},"f:blockOwnerDeletion":{},"f:controller":{},"f:kind":{},"f:name":{},"f:uid":{}}}},"f:spec":{"f:ports":{".":{},"k:{\"port\":5672,\"protocol\":\"TCP\"}":{".":{},"f:name":{},"f:port":{},"f:protocol":{},"f:targetPort":{}},"k:{\"port\":15672,\"protocol\":\"TCP\"}":{".":{},"f:name":{},"f:port":{},"f:protocol":{},"f:targetPort":{}}},"f:selector":{".":{},"f:app.kubernetes.io/name":{}},"f:sessionAffinity":{},"f:type":{}}}}]},"spec":{"ports":[{"name":"amqp","protocol":"TCP","port":5672,"targetPort":5672},{"name":"management","protocol":"TCP","port":15672,"targetPort":15672}],"selector":{"app.kubernetes.io/name":"rabbitmq-cluster"},"clusterIP":"10.96.254.158","type":"ClusterIP","sessionAffinity":"None"},"status":{"loadBalancer":{}}}
2022/03/18 18:00:38 learn_server.go:291: [SIEVE-AFTER-READ]	Get	true	secret	default	rabbitmq-cluster-erlang-cookie	github.com/rabbitmq/cluster-operator/controllers.(*RabbitmqClusterReconciler)	NoError	{"kind":"Secret","apiVersion":"v1","metadata":{"name":"rabbitmq-cluster-erlang-cookie","namespace":"default","selfLink":"/api/v1/namespaces/default/secrets/rabbitmq-cluster-erlang-cookie","uid":"f8fbe8a6-0f40-4e13-960b-ab78b8ba75b0","resourceVersion":"705","creationTimestamp":"2022-03-18T18:00:38Z","labels":{"app.kubernetes.io/component":"rabbitmq","app.kubernetes.io/name":"rabbitmq-cluster","app.kubernetes.io/part-of":"rabbitmq"},"ownerReferences":[{"apiVersion":"rabbitmq.com/v1beta1","kind":"RabbitmqCluster","name":"rabbitmq-cluster","uid":"18d9928b-0d1c-47be-80ec-20960d053827","controller":true,"blockOwnerDeletion":true}],"managedFields":[{"manager":"manager","operation":"Update","apiVersion":"v1","time":"2022-03-18T18:00:38Z","fieldsType":"FieldsV1","fieldsV1":{"f:data":{".":{},"f:.erlang.cookie":{}},"f:metadata":{"f:labels":{".":{},"f:app.kubernetes.io/component":{},"f:app.kubernetes.io/name":{},"f:app.kubernetes.io/part-of":{}},"f:ownerReferences":{".":{},"k:{\"uid\":\"18d9928b-0d1c-47be-80ec-20960d053827\"}":{".":{},"f:apiVersion":{},"f:blockOwnerDeletion":{},"f:controller":{},"f:kind":{},"f:name":{},"f:uid":{}}}},"f:type":{}}}]},"data":{".erlang.cookie":"QW9hMkpWU0tlYS1FUGdWTUhrelNMNnFoMFZ0ZmRGNUY="},"type":"Opaque"}
2022/03/18 18:00:38 learn_server.go:291: [SIEVE-AFTER-READ]	Get	true	secret	default	rabbitmq-cluster-default-user	github.com/rabbitmq/cluster-operator/controllers.(*RabbitmqClusterReconciler)	NoError	{"kind":"Secret","apiVersion":"v1","metadata":{"name":"rabbitmq-cluster-default-user","namespace":"default","selfLink":"/api/v1/namespaces/default/secrets/rabbitmq-cluster-default-user","uid":"0d9f460b-a23c-402b-8273-f541ed39023f","resourceVersion":"708","creationTimestamp":"2022-03-18T18:00:38Z","labels":{"app.kubernetes.io/component":"rabbitmq","app.kubernetes.io/name":"rabbitmq-cluster","app.kubernetes.io/part-of":"rabbitmq"},"ownerReferences":[{"apiVersion":"rabbitmq.com/v1beta1","kind":"RabbitmqCluster","name":"rabbitmq-cluster","uid":"18d9928b-0d1c-47be-80ec-20960d053827","controller":true,"blockOwnerDeletion":true}],"managedFields":[{"manager":"manager","operation":"Update","apiVersion":"v1","time":"2022-03-18T18:00:38Z","fieldsType":"FieldsV1","fieldsV1":{"f:data":{".":{},"f:default_user.conf":{},"f:password":{},"f:provider":{},"f:type":{},"f:username":{}},"f:metadata":{"f:labels":{".":{},"f:app.kubernetes.io/component":{},"f:app.kubernetes.io/name":{},"f:app.kubernetes.io/part-of":{}},"f:ownerReferences":{".":{},"k:{\"uid\":\"18d9928b-0d1c-47be-80ec-20960d053827\"}":{".":{},"f:apiVersion":{},"f:blockOwnerDeletion":{},"f:controller":{},"f:kind":{},"f:name":{},"f:uid":{}}}},"f:type":{}}}]},"data":{"default_user.conf":"ZGVmYXVsdF91c2VyID0gcTMxRmh3MGtjWW9SZUl5X3BPTXp2ZVBOUnNVU3I1Mk8KZGVmYXVsdF9wYXNzID0gY0dBX19jNTJHX05hVURpTGhraWZ6UDBOVVlNLTE2MWQK","password":"Y0dBX19jNTJHX05hVURpTGhraWZ6UDBOVVlNLTE2MWQ=","provider":"cmFiYml0bXE=","type":"cmFiYml0bXE=","username":"cTMxRmh3MGtjWW9SZUl5X3BPTXp2ZVBOUnNVU3I1Mk8="},"type":"Opaque"}
2022/03/18 18:00:38 learn_server.go:291: [SIEVE-AFTER-READ]	Get	true	configmap	default	rabbitmq-cluster-plugins-conf	github.com/rabbitmq/cluster-operator/controllers.(*RabbitmqClusterReconciler)	NoError	{"kind":"ConfigMap","apiVersion":"v1","metadata":{"name":"rabbitmq-cluster-plugins-conf","namespace":"default","selfLink":"/api/v1/namespaces/default/configmaps/rabbitmq-cluster-plugins-conf","uid":"a164075b-0562-47ac-a577-99aa8651ec40","resourceVersion":"709","creationTimestamp":"2022-03-18T18:00:38Z","labels":{"app.kubernetes.io/component":"rabbitmq","app.kubernetes.io/name":"rabbitmq-cluster","app.kubernetes.io/part-of":"rabbitmq"},"ownerReferences":[{"apiVersion":"rabbitmq.com/v1beta1","kind":"RabbitmqCluster","name":"rabbitmq-cluster","uid":"18d9928b-0d1c-47be-80ec-20960d053827","controller":true,"blockOwnerDeletion":true}],"managedFields":[{"manager":"manager","operation":"Update","apiVersion":"v1","time":"2022-03-18T18:00:38Z","fieldsType":"FieldsV1","fieldsV1":{"f:data":{".":{},"f:enabled_plugins":{}},"f:metadata":{"f:labels":{".":{},"f:app.kubernetes.io/component":{},"f:app.kubernetes.io/name":{},"f:app.kubernetes.io/part-of":{}},"f:ownerReferences":{".":{},"k:{\"uid\":\"18d9928b-0d1c-47be-80ec-20960d053827\"}":{".":{},"f:apiVersion":{},"f:blockOwnerDeletion":{},"f:controller":{},"f:kind":{},"f:name":{},"f:uid":{}}}}}}]},"data":{"enabled_plugins":"[rabbitmq_peer_discovery_k8s,rabbitmq_prometheus,rabbitmq_management]."}}
2022/03/18 18:00:38 learn_server.go:291: [SIEVE-AFTER-READ]	Get	true	configmap	default	rabbitmq-cluster-server-conf	github.com/rabbitmq/cluster-operator/controllers.(*RabbitmqClusterReconciler)	NoError	{"kind":"ConfigMap","apiVersion":"v1","metadata":{"name":"rabbitmq-cluster-server-conf","namespace":"default","selfLink":"/api/v1/namespaces/default/configmaps/rabbitmq-cluster-server-conf","uid":"22474f2b-8454-44b7-8079-8990223969cc","resourceVersion":"714","creationTimestamp":"2022-03-18T18:00:38Z","labels":{"app.kubernetes.io/component":"rabbitmq","app.kubernetes.io/name":"rabbitmq-cluster","app.kubernetes.io/part-of":"rabbitmq"},"ownerReferences":[{"apiVersion":"rabbitmq.com/v1beta1","kind":"RabbitmqCluster","name":"rabbitmq-cluster","uid":"18d9928b-0d1c-47be-80ec-20960d053827","controller":true,"blockOwnerDeletion":true}],"managedFields":[{"manager":"manager","operation":"Update","apiVersion":"v1","time":"2022-03-18T18:00:38Z","fieldsType":"FieldsV1","fieldsV1":{"f:data":{".":{},"f:operatorDefaults.conf":{},"f:userDefinedConfiguration.conf":{}},"f:metadata":{"f:labels":{".":{},"f:app.kubernetes.io/component":{},"f:app.kubernetes.io/name":{},"f:app.kubernetes.io/part-of":{}},"f:ownerReferences":{".":{},"k:{\"uid\":\"18d9928b-0d1c-47be-80ec-20960d053827\"}":{".":{},"f:apiVersion":{},"f:blockOwnerDeletion":{},"f:controller":{},"f:kind":{},"f:name":{},"f:uid":{}}}}}}]},"data":{"operatorDefaults.conf":"cluster_formation.peer_discovery_backend             = rabbit_peer_discovery_k8s\ncluster_formation.k8s.host                           = kubernetes.default\ncluster_formation.k8s.address_type                   = hostname\ncluster_partition_handling                           = pause_minority\nqueue_master_locator                                 = min-masters\ndisk_free_limit.absolute                             = 2GB\ncluster_formation.randomized_startup_delay_range.min = 5\ncluster_formation.randomized_startup_delay_range.max = 30\ncluster_name                                         = rabbitmq-cluster\n","userDefinedConfiguration.conf":"total_memory_available_override_value = 1717986919\n"}}
2022/03/18 18:00:38 learn_server.go:291: [SIEVE-AFTER-READ]	Get	true	serviceaccount	default	rabbitmq-cluster-server	github.com/rabbitmq/cluster-operator/controllers.(*RabbitmqClusterReconciler)	NoError	{"kind":"ServiceAccount","apiVersion":"v1","metadata":{"name":"rabbitmq-cluster-server","namespace":"default","selfLink":"/api/v1/namespaces/default/serviceaccounts/rabbitmq-cluster-server","uid":"731589b5-ac97-4774-bee4-008949b54734","resourceVersion":"722","creationTimestamp":"2022-03-18T18:00:38Z","labels":{"app.kubernetes.io/component":"rabbitmq","app.kubernetes.io/name":"rabbitmq-cluster","app.kubernetes.io/part-of":"rabbitmq"},"ownerReferences":[{"apiVersion":"rabbitmq.com/v1beta1","kind":"RabbitmqCluster","name":"rabbitmq-cluster","uid":"18d9928b-0d1c-47be-80ec-20960d053827","controller":true,"blockOwnerDeletion":true}],"managedFields":[{"manager":"kube-controller-manager","operation":"Update","apiVersion":"v1","time":"2022-03-18T18:00:38Z","fieldsType":"FieldsV1","fieldsV1":{"f:secrets":{".":{},"k:{\"name\":\"rabbitmq-cluster-server-token-rhzq9\"}":{".":{},"f:name":{}}}}},{"manager":"manager","operation":"Update","apiVersion":"v1","time":"2022-03-18T18:00:38Z","fieldsType":"FieldsV1","fieldsV1":{"f:metadata":{"f:labels":{".":{},"f:app.kubernetes.io/component":{},"f:app.kubernetes.io/name":{},"f:app.kubernetes.io/part-of":{}},"f:ownerReferences":{".":{},"k:{\"uid\":\"18d9928b-0d1c-47be-80ec-20960d053827\"}":{".":{},"f:apiVersion":{},"f:blockOwnerDeletion":{},"f:controller":{},"f:kind":{},"f:name":{},"f:uid":{}}}}}}]},"secrets":[{"name":"rabbitmq-cluster-server-token-rhzq9"}]}
2022/03/18 18:00:38 learn_server.go:291: [SIEVE-AFTER-READ]	Get	true	role	default	rabbitmq-cluster-peer-discovery	github.com/rabbitmq/cluster-operator/controllers.(*RabbitmqClusterReconciler)	NoError	{"kind":"Role","apiVersion":"rbac.authorization.k8s.io/v1","metadata":{"name":"rabbitmq-cluster-peer-discovery","namespace":"default","selfLink":"/apis/rbac.authorization.k8s.io/v1/namespaces/default/roles/rabbitmq-cluster-peer-discovery","uid":"52c80b50-4fdd-4089-bbfd-9756465953f2","resourceVersion":"723","creationTimestamp":"2022-03-18T18:00:38Z","labels":{"app.kubernetes.io/component":"rabbitmq","app.kubernetes.io/name":"rabbitmq-cluster","app.kubernetes.io/part-of":"rabbitmq"},"ownerReferences":[{"apiVersion":"rabbitmq.com/v1beta1","kind":"RabbitmqCluster","name":"rabbitmq-cluster","uid":"18d9928b-0d1c-47be-80ec-20960d053827","controller":true,"blockOwnerDeletion":true}],"managedFields":[{"manager":"manager","operation":"Update","apiVersion":"rbac.authorization.k8s.io/v1","time":"2022-03-18T18:00:38Z","fieldsType":"FieldsV1","fieldsV1":{"f:metadata":{"f:labels":{".":{},"f:app.kubernetes.io/component":{},"f:app.kubernetes.io/name":{},"f:app.kubernetes.io/part-of":{}},"f:ownerReferences":{".":{},"k:{\"uid\":\"18d9928b-0d1c-47be-80ec-20960d053827\"}":{".":{},"f:apiVersion":{},"f:blockOwnerDeletion":{},"f:controller":{},"f:kind":{},"f:name":{},"f:uid":{}}}},"f:rules":{}}}]},"rules":[{"verbs":["get"],"apiGroups":[""],"resources":["endpoints"]},{"verbs":["create"],"apiGroups":[""],"resources":["events"]}]}
2022/03/18 18:00:38 learn_server.go:291: [SIEVE-AFTER-READ]	Get	true	rolebinding	default	rabbitmq-cluster-server	github.com/rabbitmq/cluster-operator/controllers.(*RabbitmqClusterReconciler)	NoError	{"kind":"RoleBinding","apiVersion":"rbac.authorization.k8s.io/v1","metadata":{"name":"rabbitmq-cluster-server","namespace":"default","selfLink":"/apis/rbac.authorization.k8s.io/v1/namespaces/default/rolebindings/rabbitmq-cluster-server","uid":"495e9f7c-a20d-4515-86b0-34149a855034","resourceVersion":"725","creationTimestamp":"2022-03-18T18:00:38Z","labels":{"app.kubernetes.io/component":"rabbitmq","app.kubernetes.io/name":"rabbitmq-cluster","app.kubernetes.io/part-of":"rabbitmq"},"ownerReferences":[{"apiVersion":"rabbitmq.com/v1beta1","kind":"RabbitmqCluster","name":"rabbitmq-cluster","uid":"18d9928b-0d1c-47be-80ec-20960d053827","controller":true,"blockOwnerDeletion":true}],"managedFields":[{"manager":"manager","operation":"Update","apiVersion":"rbac.authorization.k8s.io/v1","time":"2022-03-18T18:00:38Z","fieldsType":"FieldsV1","fieldsV1":{"f:metadata":{"f:labels":{".":{},"f:app.kubernetes.io/component":{},"f:app.kubernetes.io/name":{},"f:app.kubernetes.io/part-of":{}},"f:ownerReferences":{".":{},"k:{\"uid\":\"18d9928b-0d1c-47be-80ec-20960d053827\"}":{".":{},"f:apiVersion":{},"f:blockOwnerDeletion":{},"f:controller":{},"f:kind":{},"f:name":{},"f:uid":{}}}},"f:roleRef":{"f:apiGroup":{},"f:kind":{},"f:name":{}},"f:subjects":{}}}]},"subjects":[{"kind":"ServiceAccount","name":"rabbitmq-cluster-server"}],"roleRef":{"apiGroup":"rbac.authorization.k8s.io","kind":"Role","name":"rabbitmq-cluster-peer-discovery"}}
2022/03/18 18:00:38 learn_server.go:291: [SIEVE-AFTER-READ]	Get	true	statefulset	default	rabbitmq-cluster-server	github.com/rabbitmq/cluster-operator/controllers.(*RabbitmqClusterReconciler)	NoError	{"kind":"StatefulSet","apiVersion":"apps/v1","metadata":{"name":"rabbitmq-cluster-server","namespace":"default","selfLink":"/apis/apps/v1/namespaces/default/statefulsets/rabbitmq-cluster-server","uid":"cb5c43bc-6ee7-481c-ab01-6f3acffdd3c8","resourceVersion":"744","generation":1,"creationTimestamp":"2022-03-18T18:00:38Z","labels":{"app.kubernetes.io/component":"rabbitmq","app.kubernetes.io/name":"rabbitmq-cluster","app.kubernetes.io/part-of":"rabbitmq"},"annotations":{"rabbitmq.com/createdAt":"2022-03-18T18:00:38Z"},"ownerReferences":[{"apiVersion":"rabbitmq.com/v1beta1","kind":"RabbitmqCluster","name":"rabbitmq-cluster","uid":"18d9928b-0d1c-47be-80ec-20960d053827","controller":true,"blockOwnerDeletion":true}],"managedFields":[{"manager":"kube-controller-manager","operation":"Update","apiVersion":"apps/v1","time":"2022-03-18T18:00:38Z","fieldsType":"FieldsV1","fieldsV1":{"f:status":{"f:collisionCount":{},"f:currentReplicas":{},"f:currentRevision":{},"f:observedGeneration":{},"f:replicas":{},"f:updateRevision":{},"f:updatedReplicas":{}}}},{"manager":"manager","operation":"Update","apiVersion":"apps/v1","time":"2022-03-18T18:00:38Z","fieldsType":"FieldsV1","fieldsV1":{"f:metadata":{"f:annotations":{".":{},"f:rabbitmq.com/createdAt":{}},"f:labels":{".":{},"f:app.kubernetes.io/component":{},"f:app.kubernetes.io/name":{},"f:app.kubernetes.io/part-of":{}},"f:ownerReferences":{".":{},"k:{\"uid\":\"18d9928b-0d1c-47be-80ec-20960d053827\"}":{".":{},"f:apiVersion":{},"f:blockOwnerDeletion":{},"f:controller":{},"f:kind":{},"f:name":{},"f:uid":{}}}},"f:spec":{"f:podManagementPolicy":{},"f:replicas":{},"f:revisionHistoryLimit":{},"f:selector":{"f:matchLabels":{".":{},"f:app.kubernetes.io/name":{}}},"f:serviceName":{},"f:template":{"f:metadata":{"f:annotations":{".":{},"f:prometheus.io/port":{},"f:prometheus.io/scrape":{}},"f:labels":{".":{},"f:app.kubernetes.io/component":{},"f:app.kubernetes.io/name":{},"f:app.kubernetes.io/part-of":{}}},"f:spec":{"f:automountServiceAccountToken":{},"f:containers":{"k:{\"name\":\"rabbitmq\"}":{".":{},"f:env":{".":{},"k:{\"name\":\"K8S_HOSTNAME_SUFFIX\"}":{".":{},"f:name":{},"f:value":{}},"k:{\"name\":\"K8S_SERVICE_NAME\"}":{".":{},"f:name":{},"f:value":{}},"k:{\"name\":\"MY_POD_NAME\"}":{".":{},"f:name":{},"f:valueFrom":{".":{},"f:fieldRef":{".":{},"f:apiVersion":{},"f:fieldPath":{}}}},"k:{\"name\":\"MY_POD_NAMESPACE\"}":{".":{},"f:name":{},"f:valueFrom":{".":{},"f:fieldRef":{".":{},"f:apiVersion":{},"f:fieldPath":{}}}},"k:{\"name\":\"RABBITMQ_ENABLED_PLUGINS_FILE\"}":{".":{},"f:name":{},"f:value":{}},"k:{\"name\":\"RABBITMQ_NODENAME\"}":{".":{},"f:name":{},"f:value":{}},"k:{\"name\":\"RABBITMQ_USE_LONGNAME\"}":{".":{},"f:name":{},"f:value":{}}},"f:image":{},"f:imagePullPolicy":{},"f:lifecycle":{".":{},"f:preStop":{".":{},"f:exec":{".":{},"f:command":{}}}},"f:name":{},"f:ports":{".":{},"k:{\"containerPort\":4369,\"protocol\":\"TCP\"}":{".":{},"f:containerPort":{},"f:name":{},"f:protocol":{}},"k:{\"containerPort\":5672,\"protocol\":\"TCP\"}":{".":{},"f:containerPort":{},"f:name":{},"f:protocol":{}},"k:{\"containerPort\":15672,\"protocol\":\"TCP\"}":{".":{},"f:containerPort":{},"f:name":{},"f:protocol":{}},"k:{\"containerPort\":15692,\"protocol\":\"TCP\"}":{".":{},"f:containerPort":{},"f:name":{},"f:protocol":{}}},"f:readinessProbe":{".":{},"f:failureThreshold":{},"f:initialDelaySeconds":{},"f:periodSeconds":{},"f:successThreshold":{},"f:tcpSocket":{".":{},"f:port":{}},"f:timeoutSeconds":{}},"f:resources":{".":{},"f:limits":{".":{},"f:cpu":{},"f:memory":{}},"f:requests":{".":{},"f:cpu":{},"f:memory":{}}},"f:terminationMessagePath":{},"f:terminationMessagePolicy":{},"f:volumeMounts":{".":{},"k:{\"mountPath\":\"/etc/pod-info/\"}":{".":{},"f:mountPath":{},"f:name":{}},"k:{\"mountPath\":\"/etc/rabbitmq/conf.d/10-operatorDefaults.conf\"}":{".":{},"f:mountPath":{},"f:name":{},"f:subPath":{}},"k:{\"mountPath\":\"/etc/rabbitmq/conf.d/11-default_user.conf\"}":{".":{},"f:mountPath":{},"f:name":{},"f:subPath":{}},"k:{\"mountPath\":\"/etc/rabbitmq/conf.d/90-userDefinedConfiguration.conf\"}":{".":{},"f:mountPath":{},"f:name":{},"f:subPath":{}},"k:{\"mountPath\":\"/operator\"}":{".":{},"f:mountPath":{},"f:name":{}},"k:{\"mountPath\":\"/var/lib/rabbitmq/\"}":{".":{},"f:mountPath":{},"f:name":{}},"k:{\"mountPath\":\"/var/lib/rabbitmq/mnesia/\"}":{".":{},"f:mountPath":{},"f:name":{}}}}},"f:dnsPolicy":{},"f:initContainers":{".":{},"k:{\"name\":\"setup-container\"}":{".":{},"f:command":{},"f:image":{},"f:imagePullPolicy":{},"f:name":{},"f:resources":{".":{},"f:limits":{".":{},"f:cpu":{},"f:memory":{}},"f:requests":{".":{},"f:cpu":{},"f:memory":{}}},"f:securityContext":{".":{},"f:capabilities":{".":{},"f:drop":{}},"f:runAsUser":{}},"f:terminationMessagePath":{},"f:terminationMessagePolicy":{},"f:volumeMounts":{".":{},"k:{\"mountPath\":\"/operator\"}":{".":{},"f:mountPath":{},"f:name":{}},"k:{\"mountPath\":\"/tmp/default_user.conf\"}":{".":{},"f:mountPath":{},"f:name":{},"f:subPath":{}},"k:{\"mountPath\":\"/tmp/erlang-cookie-secret/\"}":{".":{},"f:mountPath":{},"f:name":{}},"k:{\"mountPath\":\"/tmp/rabbitmq-plugins/\"}":{".":{},"f:mountPath":{},"f:name":{}},"k:{\"mountPath\":\"/var/lib/rabbitmq/\"}":{".":{},"f:mountPath":{},"f:name":{}},"k:{\"mountPath\":\"/var/lib/rabbitmq/mnesia/\"}":{".":{},"f:mountPath":{},"f:name":{}}}}},"f:restartPolicy":{},"f:schedulerName":{},"f:securityContext":{".":{},"f:fsGroup":{},"f:runAsGroup":{},"f:runAsUser":{}},"f:serviceAccount":{},"f:serviceAccountName":{},"f:terminationGracePeriodSeconds":{},"f:topologySpreadConstraints":{".":{},"k:{\"topologyKey\":\"topology.kubernetes.io/zone\",\"whenUnsatisfiable\":\"ScheduleAnyway\"}":{".":{},"f:labelSelector":{".":{},"f:matchLabels":{".":{},"f:app.kubernetes.io/name":{}}},"f:maxSkew":{},"f:topologyKey":{},"f:whenUnsatisfiable":{}}},"f:volumes":{".":{},"k:{\"name\":\"erlang-cookie-secret\"}":{".":{},"f:name":{},"f:secret":{".":{},"f:defaultMode":{},"f:secretName":{}}},"k:{\"name\":\"plugins-conf\"}":{".":{},"f:configMap":{".":{},"f:defaultMode":{},"f:name":{}},"f:name":{}},"k:{\"name\":\"pod-info\"}":{".":{},"f:downwardAPI":{".":{},"f:defaultMode":{},"f:items":{}},"f:name":{}},"k:{\"name\":\"rabbitmq-confd\"}":{".":{},"f:name":{},"f:projected":{".":{},"f:defaultMode":{},"f:sources":{}}},"k:{\"name\":\"rabbitmq-erlang-cookie\"}":{".":{},"f:emptyDir":{},"f:name":{}},"k:{\"name\":\"rabbitmq-plugins\"}":{".":{},"f:emptyDir":{},"f:name":{}}}}},"f:updateStrategy":{"f:rollingUpdate":{".":{},"f:partition":{}},"f:type":{}},"f:volumeClaimTemplates":{}}}}]},"spec":{"replicas":1,"selector":{"matchLabels":{"app.kubernetes.io/name":"rabbitmq-cluster"}},"template":{"metadata":{"creationTimestamp":null,"labels":{"app.kubernetes.io/component":"rabbitmq","app.kubernetes.io/name":"rabbitmq-cluster","app.kubernetes.io/part-of":"rabbitmq"},"annotations":{"prometheus.io/port":"15692","prometheus.io/scrape":"true"}},"spec":{"volumes":[{"name":"plugins-conf","configMap":{"name":"rabbitmq-cluster-plugins-conf","defaultMode":420}},{"name":"rabbitmq-confd","projected":{"sources":[{"secret":{"name":"rabbitmq-cluster-default-user","items":[{"key":"default_user.conf","path":"default_user.conf"}]}},{"configMap":{"name":"rabbitmq-cluster-server-conf","items":[{"key":"operatorDefaults.conf","path":"operatorDefaults.conf"},{"key":"userDefinedConfiguration.conf","path":"userDefinedConfiguration.conf"}]}}],"defaultMode":420}},{"name":"rabbitmq-erlang-cookie","emptyDir":{}},{"name":"erlang-cookie-secret","secret":{"secretName":"rabbitmq-cluster-erlang-cookie","defaultMode":420}},{"name":"rabbitmq-plugins","emptyDir":{}},{"name":"pod-info","downwardAPI":{"items":[{"path":"skipPreStopChecks","fieldRef":{"apiVersion":"v1","fieldPath":"metadata.labels['skipPreStopChecks']"}}],"defaultMode":420}}],"initContainers":[{"name":"setup-container","image":"rabbitmq:3.8.12-management","command":["sh","-c","cp /tmp/erlang-cookie-secret/.erlang.cookie /var/lib/rabbitmq/.erlang.cookie \u0026\u0026 chown 999:999 /var/lib/rabbitmq/.erlang.cookie \u0026\u0026 chmod 600 /var/lib/rabbitmq/.erlang.cookie ; cp /tmp/rabbitmq-plugins/enabled_plugins /operator/enabled_plugins \u0026\u0026 chown 999:999 /operator/enabled_plugins ; chown 999:999 /var/lib/rabbitmq/mnesia/ ; echo '[default]' \u003e /var/lib/rabbitmq/.rabbitmqadmin.conf \u0026\u0026 sed -e 's/default_user/username/' -e 's/default_pass/password/' /tmp/default_user.conf \u003e\u003e /var/lib/rabbitmq/.rabbitmqadmin.conf \u0026\u0026 chown 999:999 /var/lib/rabbitmq/.rabbitmqadmin.conf \u0026\u0026 chmod 600 /var/lib/rabbitmq/.rabbitmqadmin.conf"],"resources":{"limits":{"cpu":"100m","memory":"500Mi"},"requests":{"cpu":"100m","memory":"500Mi"}},"volumeMounts":[{"name":"plugins-conf","mountPath":"/tmp/rabbitmq-plugins/"},{"name":"rabbitmq-erlang-cookie","mountPath":"/var/lib/rabbitmq/"},{"name":"erlang-cookie-secret","mountPath":"/tmp/erlang-cookie-secret/"},{"name":"rabbitmq-plugins","mountPath":"/operator"},{"name":"persistence","mountPath":"/var/lib/rabbitmq/mnesia/"},{"name":"rabbitmq-confd","mountPath":"/tmp/default_user.conf","subPath":"default_user.conf"}],"terminationMessagePath":"/dev/termination-log","terminationMessagePolicy":"File","imagePullPolicy":"IfNotPresent","securityContext":{"capabilities":{"drop":["FSETID","KILL","SETGID","SETUID","SETPCAP","NET_BIND_SERVICE","NET_RAW","SYS_CHROOT","MKNOD","AUDIT_WRITE","SETFCAP"]},"runAsUser":0}}],"containers":[{"name":"rabbitmq","image":"rabbitmq:3.8.12-management","ports":[{"name":"epmd","containerPort":4369,"protocol":"TCP"},{"name":"amqp","containerPort":5672,"protocol":"TCP"},{"name":"management","containerPort":15672,"protocol":"TCP"},{"name":"prometheus","containerPort":15692,"protocol":"TCP"}],"env":[{"name":"MY_POD_NAME","valueFrom":{"fieldRef":{"apiVersion":"v1","fieldPath":"metadata.name"}}},{"name":"MY_POD_NAMESPACE","valueFrom":{"fieldRef":{"apiVersion":"v1","fieldPath":"metadata.namespace"}}},{"name":"RABBITMQ_ENABLED_PLUGINS_FILE","value":"/operator/enabled_plugins"},{"name":"K8S_SERVICE_NAME","value":"rabbitmq-cluster-nodes"},{"name":"RABBITMQ_USE_LONGNAME","value":"true"},{"name":"RABBITMQ_NODENAME","value":"rabbit@$(MY_POD_NAME).$(K8S_SERVICE_NAME).$(MY_POD_NAMESPACE)"},{"name":"K8S_HOSTNAME_SUFFIX","value":".$(K8S_SERVICE_NAME).$(MY_POD_NAMESPACE)"}],"resources":{"limits":{"cpu":"2","memory":"2Gi"},"requests":{"cpu":"1","memory":"2Gi"}},"volumeMounts":[{"name":"rabbitmq-erlang-cookie","mountPath":"/var/lib/rabbitmq/"},{"name":"persistence","mountPath":"/var/lib/rabbitmq/mnesia/"},{"name":"rabbitmq-plugins","mountPath":"/operator"},{"name":"rabbitmq-confd","mountPath":"/etc/rabbitmq/conf.d/10-operatorDefaults.conf","subPath":"operatorDefaults.conf"},{"name":"rabbitmq-confd","mountPath":"/etc/rabbitmq/conf.d/11-default_user.conf","subPath":"default_user.conf"},{"name":"rabbitmq-confd","mountPath":"/etc/rabbitmq/conf.d/90-userDefinedConfiguration.conf","subPath":"userDefinedConfiguration.conf"},{"name":"pod-info","mountPath":"/etc/pod-info/"}],"readinessProbe":{"tcpSocket":{"port":"amqp"},"initialDelaySeconds":10,"timeoutSeconds":5,"periodSeconds":10,"successThreshold":1,"failureThreshold":3},"lifecycle":{"preStop":{"exec":{"command":["/bin/bash","-c","if [ ! -z \"$(cat /etc/pod-info/skipPreStopChecks)\" ]; then exit 0; fi; rabbitmq-upgrade await_online_quorum_plus_one -t 604800; rabbitmq-upgrade await_online_synchronized_mirror -t 604800; rabbitmq-upgrade drain -t 604800"]}}},"terminationMessagePath":"/dev/termination-log","terminationMessagePolicy":"File","imagePullPolicy":"IfNotPresent"}],"restartPolicy":"Always","terminationGracePeriodSeconds":604800,"dnsPolicy":"ClusterFirst","serviceAccountName":"rabbitmq-cluster-server","serviceAccount":"rabbitmq-cluster-server","automountServiceAccountToken":true,"securityContext":{"runAsUser":999,"runAsGroup":999,"fsGroup":999},"schedulerName":"default-scheduler","topologySpreadConstraints":[{"maxSkew":1,"topologyKey":"topology.kubernetes.io/zone","whenUnsatisfiable":"ScheduleAnyway","labelSelector":{"matchLabels":{"app.kubernetes.io/name":"rabbitmq-cluster"}}}]}},"volumeClaimTemplates":[{"metadata":{"name":"persistence","namespace":"default","creationTimestamp":null,"labels":{"app.kubernetes.io/component":"rabbitmq","app.kubernetes.io/name":"rabbitmq-cluster","app.kubernetes.io/part-of":"rabbitmq"},"ownerReferences":[{"apiVersion":"rabbitmq.com/v1beta1","kind":"RabbitmqCluster","name":"rabbitmq-cluster","uid":"18d9928b-0d1c-47be-80ec-20960d053827","controller":true,"blockOwnerDeletion":false}]},"spec":{"accessModes":["ReadWriteOnce"],"resources":{"requests":{"storage":"10Gi"}},"volumeMode":"Filesystem"},"status":{"phase":"Pending"}}],"serviceName":"rabbitmq-cluster-nodes","podManagementPolicy":"Parallel","updateStrategy":{"type":"RollingUpdate","rollingUpdate":{"partition":0}},"revisionHistoryLimit":10},"status":{"observedGeneration":1,"replicas":1,"currentReplicas":1,"updatedReplicas":1,"currentRevision":"rabbitmq-cluster-server-5f8b8665fb","updateRevision":"rabbitmq-cluster-server-5f8b8665fb","collisionCount":0}}
2022/03/18 18:00:38 learn_server.go:291: [SIEVE-AFTER-READ]	Get	true	statefulset	default	rabbitmq-cluster-server	github.com/rabbitmq/cluster-operator/controllers.(*RabbitmqClusterReconciler)	NoError	{"kind":"StatefulSet","apiVersion":"apps/v1","metadata":{"name":"rabbitmq-cluster-server","namespace":"default","selfLink":"/apis/apps/v1/namespaces/default/statefulsets/rabbitmq-cluster-server","uid":"cb5c43bc-6ee7-481c-ab01-6f3acffdd3c8","resourceVersion":"744","generation":1,"creationTimestamp":"2022-03-18T18:00:38Z","labels":{"app.kubernetes.io/component":"rabbitmq","app.kubernetes.io/name":"rabbitmq-cluster","app.kubernetes.io/part-of":"rabbitmq"},"annotations":{"rabbitmq.com/createdAt":"2022-03-18T18:00:38Z"},"ownerReferences":[{"apiVersion":"rabbitmq.com/v1beta1","kind":"RabbitmqCluster","name":"rabbitmq-cluster","uid":"18d9928b-0d1c-47be-80ec-20960d053827","controller":true,"blockOwnerDeletion":true}],"managedFields":[{"manager":"kube-controller-manager","operation":"Update","apiVersion":"apps/v1","time":"2022-03-18T18:00:38Z","fieldsType":"FieldsV1","fieldsV1":{"f:status":{"f:collisionCount":{},"f:currentReplicas":{},"f:currentRevision":{},"f:observedGeneration":{},"f:replicas":{},"f:updateRevision":{},"f:updatedReplicas":{}}}},{"manager":"manager","operation":"Update","apiVersion":"apps/v1","time":"2022-03-18T18:00:38Z","fieldsType":"FieldsV1","fieldsV1":{"f:metadata":{"f:annotations":{".":{},"f:rabbitmq.com/createdAt":{}},"f:labels":{".":{},"f:app.kubernetes.io/component":{},"f:app.kubernetes.io/name":{},"f:app.kubernetes.io/part-of":{}},"f:ownerReferences":{".":{},"k:{\"uid\":\"18d9928b-0d1c-47be-80ec-20960d053827\"}":{".":{},"f:apiVersion":{},"f:blockOwnerDeletion":{},"f:controller":{},"f:kind":{},"f:name":{},"f:uid":{}}}},"f:spec":{"f:podManagementPolicy":{},"f:replicas":{},"f:revisionHistoryLimit":{},"f:selector":{"f:matchLabels":{".":{},"f:app.kubernetes.io/name":{}}},"f:serviceName":{},"f:template":{"f:metadata":{"f:annotations":{".":{},"f:prometheus.io/port":{},"f:prometheus.io/scrape":{}},"f:labels":{".":{},"f:app.kubernetes.io/component":{},"f:app.kubernetes.io/name":{},"f:app.kubernetes.io/part-of":{}}},"f:spec":{"f:automountServiceAccountToken":{},"f:containers":{"k:{\"name\":\"rabbitmq\"}":{".":{},"f:env":{".":{},"k:{\"name\":\"K8S_HOSTNAME_SUFFIX\"}":{".":{},"f:name":{},"f:value":{}},"k:{\"name\":\"K8S_SERVICE_NAME\"}":{".":{},"f:name":{},"f:value":{}},"k:{\"name\":\"MY_POD_NAME\"}":{".":{},"f:name":{},"f:valueFrom":{".":{},"f:fieldRef":{".":{},"f:apiVersion":{},"f:fieldPath":{}}}},"k:{\"name\":\"MY_POD_NAMESPACE\"}":{".":{},"f:name":{},"f:valueFrom":{".":{},"f:fieldRef":{".":{},"f:apiVersion":{},"f:fieldPath":{}}}},"k:{\"name\":\"RABBITMQ_ENABLED_PLUGINS_FILE\"}":{".":{},"f:name":{},"f:value":{}},"k:{\"name\":\"RABBITMQ_NODENAME\"}":{".":{},"f:name":{},"f:value":{}},"k:{\"name\":\"RABBITMQ_USE_LONGNAME\"}":{".":{},"f:name":{},"f:value":{}}},"f:image":{},"f:imagePullPolicy":{},"f:lifecycle":{".":{},"f:preStop":{".":{},"f:exec":{".":{},"f:command":{}}}},"f:name":{},"f:ports":{".":{},"k:{\"containerPort\":4369,\"protocol\":\"TCP\"}":{".":{},"f:containerPort":{},"f:name":{},"f:protocol":{}},"k:{\"containerPort\":5672,\"protocol\":\"TCP\"}":{".":{},"f:containerPort":{},"f:name":{},"f:protocol":{}},"k:{\"containerPort\":15672,\"protocol\":\"TCP\"}":{".":{},"f:containerPort":{},"f:name":{},"f:protocol":{}},"k:{\"containerPort\":15692,\"protocol\":\"TCP\"}":{".":{},"f:containerPort":{},"f:name":{},"f:protocol":{}}},"f:readinessProbe":{".":{},"f:failureThreshold":{},"f:initialDelaySeconds":{},"f:periodSeconds":{},"f:successThreshold":{},"f:tcpSocket":{".":{},"f:port":{}},"f:timeoutSeconds":{}},"f:resources":{".":{},"f:limits":{".":{},"f:cpu":{},"f:memory":{}},"f:requests":{".":{},"f:cpu":{},"f:memory":{}}},"f:terminationMessagePath":{},"f:terminationMessagePolicy":{},"f:volumeMounts":{".":{},"k:{\"mountPath\":\"/etc/pod-info/\"}":{".":{},"f:mountPath":{},"f:name":{}},"k:{\"mountPath\":\"/etc/rabbitmq/conf.d/10-operatorDefaults.conf\"}":{".":{},"f:mountPath":{},"f:name":{},"f:subPath":{}},"k:{\"mountPath\":\"/etc/rabbitmq/conf.d/11-default_user.conf\"}":{".":{},"f:mountPath":{},"f:name":{},"f:subPath":{}},"k:{\"mountPath\":\"/etc/rabbitmq/conf.d/90-userDefinedConfiguration.conf\"}":{".":{},"f:mountPath":{},"f:name":{},"f:subPath":{}},"k:{\"mountPath\":\"/operator\"}":{".":{},"f:mountPath":{},"f:name":{}},"k:{\"mountPath\":\"/var/lib/rabbitmq/\"}":{".":{},"f:mountPath":{},"f:name":{}},"k:{\"mountPath\":\"/var/lib/rabbitmq/mnesia/\"}":{".":{},"f:mountPath":{},"f:name":{}}}}},"f:dnsPolicy":{},"f:initContainers":{".":{},"k:{\"name\":\"setup-container\"}":{".":{},"f:command":{},"f:image":{},"f:imagePullPolicy":{},"f:name":{},"f:resources":{".":{},"f:limits":{".":{},"f:cpu":{},"f:memory":{}},"f:requests":{".":{},"f:cpu":{},"f:memory":{}}},"f:securityContext":{".":{},"f:capabilities":{".":{},"f:drop":{}},"f:runAsUser":{}},"f:terminationMessagePath":{},"f:terminationMessagePolicy":{},"f:volumeMounts":{".":{},"k:{\"mountPath\":\"/operator\"}":{".":{},"f:mountPath":{},"f:name":{}},"k:{\"mountPath\":\"/tmp/default_user.conf\"}":{".":{},"f:mountPath":{},"f:name":{},"f:subPath":{}},"k:{\"mountPath\":\"/tmp/erlang-cookie-secret/\"}":{".":{},"f:mountPath":{},"f:name":{}},"k:{\"mountPath\":\"/tmp/rabbitmq-plugins/\"}":{".":{},"f:mountPath":{},"f:name":{}},"k:{\"mountPath\":\"/var/lib/rabbitmq/\"}":{".":{},"f:mountPath":{},"f:name":{}},"k:{\"mountPath\":\"/var/lib/rabbitmq/mnesia/\"}":{".":{},"f:mountPath":{},"f:name":{}}}}},"f:restartPolicy":{},"f:schedulerName":{},"f:securityContext":{".":{},"f:fsGroup":{},"f:runAsGroup":{},"f:runAsUser":{}},"f:serviceAccount":{},"f:serviceAccountName":{},"f:terminationGracePeriodSeconds":{},"f:topologySpreadConstraints":{".":{},"k:{\"topologyKey\":\"topology.kubernetes.io/zone\",\"whenUnsatisfiable\":\"ScheduleAnyway\"}":{".":{},"f:labelSelector":{".":{},"f:matchLabels":{".":{},"f:app.kubernetes.io/name":{}}},"f:maxSkew":{},"f:topologyKey":{},"f:whenUnsatisfiable":{}}},"f:volumes":{".":{},"k:{\"name\":\"erlang-cookie-secret\"}":{".":{},"f:name":{},"f:secret":{".":{},"f:defaultMode":{},"f:secretName":{}}},"k:{\"name\":\"plugins-conf\"}":{".":{},"f:configMap":{".":{},"f:defaultMode":{},"f:name":{}},"f:name":{}},"k:{\"name\":\"pod-info\"}":{".":{},"f:downwardAPI":{".":{},"f:defaultMode":{},"f:items":{}},"f:name":{}},"k:{\"name\":\"rabbitmq-confd\"}":{".":{},"f:name":{},"f:projected":{".":{},"f:defaultMode":{},"f:sources":{}}},"k:{\"name\":\"rabbitmq-erlang-cookie\"}":{".":{},"f:emptyDir":{},"f:name":{}},"k:{\"name\":\"rabbitmq-plugins\"}":{".":{},"f:emptyDir":{},"f:name":{}}}}},"f:updateStrategy":{"f:rollingUpdate":{".":{},"f:partition":{}},"f:type":{}},"f:volumeClaimTemplates":{}}}}]},"spec":{"replicas":1,"selector":{"matchLabels":{"app.kubernetes.io/name":"rabbitmq-cluster"}},"template":{"metadata":{"creationTimestamp":null,"labels":{"app.kubernetes.io/component":"rabbitmq","app.kubernetes.io/name":"rabbitmq-cluster","app.kubernetes.io/part-of":"rabbitmq"},"annotations":{"prometheus.io/port":"15692","prometheus.io/scrape":"true"}},"spec":{"volumes":[{"name":"plugins-conf","configMap":{"name":"rabbitmq-cluster-plugins-conf","defaultMode":420}},{"name":"rabbitmq-confd","projected":{"sources":[{"secret":{"name":"rabbitmq-cluster-default-user","items":[{"key":"default_user.conf","path":"default_user.conf"}]}},{"configMap":{"name":"rabbitmq-cluster-server-conf","items":[{"key":"operatorDefaults.conf","path":"operatorDefaults.conf"},{"key":"userDefinedConfiguration.conf","path":"userDefinedConfiguration.conf"}]}}],"defaultMode":420}},{"name":"rabbitmq-erlang-cookie","emptyDir":{}},{"name":"erlang-cookie-secret","secret":{"secretName":"rabbitmq-cluster-erlang-cookie","defaultMode":420}},{"name":"rabbitmq-plugins","emptyDir":{}},{"name":"pod-info","downwardAPI":{"items":[{"path":"skipPreStopChecks","fieldRef":{"apiVersion":"v1","fieldPath":"metadata.labels['skipPreStopChecks']"}}],"defaultMode":420}}],"initContainers":[{"name":"setup-container","image":"rabbitmq:3.8.12-management","command":["sh","-c","cp /tmp/erlang-cookie-secret/.erlang.cookie /var/lib/rabbitmq/.erlang.cookie \u0026\u0026 chown 999:999 /var/lib/rabbitmq/.erlang.cookie \u0026\u0026 chmod 600 /var/lib/rabbitmq/.erlang.cookie ; cp /tmp/rabbitmq-plugins/enabled_plugins /operator/enabled_plugins \u0026\u0026 chown 999:999 /operator/enabled_plugins ; chown 999:999 /var/lib/rabbitmq/mnesia/ ; echo '[default]' \u003e /var/lib/rabbitmq/.rabbitmqadmin.conf \u0026\u0026 sed -e 's/default_user/username/' -e 's/default_pass/password/' /tmp/default_user.conf \u003e\u003e /var/lib/rabbitmq/.rabbitmqadmin.conf \u0026\u0026 chown 999:999 /var/lib/rabbitmq/.rabbitmqadmin.conf \u0026\u0026 chmod 600 /var/lib/rabbitmq/.rabbitmqadmin.conf"],"resources":{"limits":{"cpu":"100m","memory":"500Mi"},"requests":{"cpu":"100m","memory":"500Mi"}},"volumeMounts":[{"name":"plugins-conf","mountPath":"/tmp/rabbitmq-plugins/"},{"name":"rabbitmq-erlang-cookie","mountPath":"/var/lib/rabbitmq/"},{"name":"erlang-cookie-secret","mountPath":"/tmp/erlang-cookie-secret/"},{"name":"rabbitmq-plugins","mountPath":"/operator"},{"name":"persistence","mountPath":"/var/lib/rabbitmq/mnesia/"},{"name":"rabbitmq-confd","mountPath":"/tmp/default_user.conf","subPath":"default_user.conf"}],"terminationMessagePath":"/dev/termination-log","terminationMessagePolicy":"File","imagePullPolicy":"IfNotPresent","securityContext":{"capabilities":{"drop":["FSETID","KILL","SETGID","SETUID","SETPCAP","NET_BIND_SERVICE","NET_RAW","SYS_CHROOT","MKNOD","AUDIT_WRITE","SETFCAP"]},"runAsUser":0}}],"containers":[{"name":"rabbitmq","image":"rabbitmq:3.8.12-management","ports":[{"name":"epmd","containerPort":4369,"protocol":"TCP"},{"name":"amqp","containerPort":5672,"protocol":"TCP"},{"name":"management","containerPort":15672,"protocol":"TCP"},{"name":"prometheus","containerPort":15692,"protocol":"TCP"}],"env":[{"name":"MY_POD_NAME","valueFrom":{"fieldRef":{"apiVersion":"v1","fieldPath":"metadata.name"}}},{"name":"MY_POD_NAMESPACE","valueFrom":{"fieldRef":{"apiVersion":"v1","fieldPath":"metadata.namespace"}}},{"name":"RABBITMQ_ENABLED_PLUGINS_FILE","value":"/operator/enabled_plugins"},{"name":"K8S_SERVICE_NAME","value":"rabbitmq-cluster-nodes"},{"name":"RABBITMQ_USE_LONGNAME","value":"true"},{"name":"RABBITMQ_NODENAME","value":"rabbit@$(MY_POD_NAME).$(K8S_SERVICE_NAME).$(MY_POD_NAMESPACE)"},{"name":"K8S_HOSTNAME_SUFFIX","value":".$(K8S_SERVICE_NAME).$(MY_POD_NAMESPACE)"}],"resources":{"limits":{"cpu":"2","memory":"2Gi"},"requests":{"cpu":"1","memory":"2Gi"}},"volumeMounts":[{"name":"rabbitmq-erlang-cookie","mountPath":"/var/lib/rabbitmq/"},{"name":"persistence","mountPath":"/var/lib/rabbitmq/mnesia/"},{"name":"rabbitmq-plugins","mountPath":"/operator"},{"name":"rabbitmq-confd","mountPath":"/etc/rabbitmq/conf.d/10-operatorDefaults.conf","subPath":"operatorDefaults.conf"},{"name":"rabbitmq-confd","mountPath":"/etc/rabbitmq/conf.d/11-default_user.conf","subPath":"default_user.conf"},{"name":"rabbitmq-confd","mountPath":"/etc/rabbitmq/conf.d/90-userDefinedConfiguration.conf","subPath":"userDefinedConfiguration.conf"},{"name":"pod-info","mountPath":"/etc/pod-info/"}],"readinessProbe":{"tcpSocket":{"port":"amqp"},"initialDelaySeconds":10,"timeoutSeconds":5,"periodSeconds":10,"successThreshold":1,"failureThreshold":3},"lifecycle":{"preStop":{"exec":{"command":["/bin/bash","-c","if [ ! -z \"$(cat /etc/pod-info/skipPreStopChecks)\" ]; then exit 0; fi; rabbitmq-upgrade await_online_quorum_plus_one -t 604800; rabbitmq-upgrade await_online_synchronized_mirror -t 604800; rabbitmq-upgrade drain -t 604800"]}}},"terminationMessagePath":"/dev/termination-log","terminationMessagePolicy":"File","imagePullPolicy":"IfNotPresent"}],"restartPolicy":"Always","terminationGracePeriodSeconds":604800,"dnsPolicy":"ClusterFirst","serviceAccountName":"rabbitmq-cluster-server","serviceAccount":"rabbitmq-cluster-server","automountServiceAccountToken":true,"securityContext":{"runAsUser":999,"runAsGroup":999,"fsGroup":999},"schedulerName":"default-scheduler","topologySpreadConstraints":[{"maxSkew":1,"topologyKey":"topology.kubernetes.io/zone","whenUnsatisfiable":"ScheduleAnyway","labelSelector":{"matchLabels":{"app.kubernetes.io/name":"rabbitmq-cluster"}}}]}},"volumeClaimTemplates":[{"metadata":{"name":"persistence","namespace":"default","creationTimestamp":null,"labels":{"app.kubernetes.io/component":"rabbitmq","app.kubernetes.io/name":"rabbitmq-cluster","app.kubernetes.io/part-of":"rabbitmq"},"ownerReferences":[{"apiVersion":"rabbitmq.com/v1beta1","kind":"RabbitmqCluster","name":"rabbitmq-cluster","uid":"18d9928b-0d1c-47be-80ec-20960d053827","controller":true,"blockOwnerDeletion":false}]},"spec":{"accessModes":["ReadWriteOnce"],"resources":{"requests":{"storage":"10Gi"}},"volumeMode":"Filesystem"},"status":{"phase":"Pending"}}],"serviceName":"rabbitmq-cluster-nodes","podManagementPolicy":"Parallel","updateStrategy":{"type":"RollingUpdate","rollingUpdate":{"partition":0}},"revisionHistoryLimit":10},"status":{"observedGeneration":1,"replicas":1,"currentReplicas":1,"updatedReplicas":1,"currentRevision":"rabbitmq-cluster-server-5f8b8665fb","updateRevision":"rabbitmq-cluster-server-5f8b8665fb","collisionCount":0}}
2022/03/18 18:00:38 learn_server.go:256: [SIEVE-BEFORE-WRITE]	19
2022/03/18 18:00:38 learn_server.go:263: [SIEVE-AFTER-WRITE]	19	Update	statefulset	github.com/rabbitmq/cluster-operator/controllers.(*RabbitmqClusterReconciler)	NoError	{"metadata":{"name":"rabbitmq-cluster-server","namespace":"default","selfLink":"/apis/apps/v1/namespaces/default/statefulsets/rabbitmq-cluster-server","uid":"cb5c43bc-6ee7-481c-ab01-6f3acffdd3c8","resourceVersion":"744","generation":1,"creationTimestamp":"2022-03-18T18:00:38Z","labels":{"app.kubernetes.io/component":"rabbitmq","app.kubernetes.io/name":"rabbitmq-cluster","app.kubernetes.io/part-of":"rabbitmq"},"annotations":{"rabbitmq.com/createdAt":"2022-03-18T18:00:38Z"},"ownerReferences":[{"apiVersion":"rabbitmq.com/v1beta1","kind":"RabbitmqCluster","name":"rabbitmq-cluster","uid":"18d9928b-0d1c-47be-80ec-20960d053827","controller":true,"blockOwnerDeletion":true}],"managedFields":[{"manager":"kube-controller-manager","operation":"Update","apiVersion":"apps/v1","time":"2022-03-18T18:00:38Z","fieldsType":"FieldsV1","fieldsV1":{"f:status":{"f:collisionCount":{},"f:currentReplicas":{},"f:currentRevision":{},"f:observedGeneration":{},"f:replicas":{},"f:updateRevision":{},"f:updatedReplicas":{}}}},{"manager":"manager","operation":"Update","apiVersion":"apps/v1","time":"2022-03-18T18:00:38Z","fieldsType":"FieldsV1","fieldsV1":{"f:metadata":{"f:annotations":{".":{},"f:rabbitmq.com/createdAt":{}},"f:labels":{".":{},"f:app.kubernetes.io/component":{},"f:app.kubernetes.io/name":{},"f:app.kubernetes.io/part-of":{}},"f:ownerReferences":{".":{},"k:{\"uid\":\"18d9928b-0d1c-47be-80ec-20960d053827\"}":{".":{},"f:apiVersion":{},"f:blockOwnerDeletion":{},"f:controller":{},"f:kind":{},"f:name":{},"f:uid":{}}}},"f:spec":{"f:podManagementPolicy":{},"f:replicas":{},"f:revisionHistoryLimit":{},"f:selector":{"f:matchLabels":{".":{},"f:app.kubernetes.io/name":{}}},"f:serviceName":{},"f:template":{"f:metadata":{"f:annotations":{".":{},"f:prometheus.io/port":{},"f:prometheus.io/scrape":{}},"f:labels":{".":{},"f:app.kubernetes.io/component":{},"f:app.kubernetes.io/name":{},"f:app.kubernetes.io/part-of":{}}},"f:spec":{"f:automountServiceAccountToken":{},"f:containers":{"k:{\"name\":\"rabbitmq\"}":{".":{},"f:env":{".":{},"k:{\"name\":\"K8S_HOSTNAME_SUFFIX\"}":{".":{},"f:name":{},"f:value":{}},"k:{\"name\":\"K8S_SERVICE_NAME\"}":{".":{},"f:name":{},"f:value":{}},"k:{\"name\":\"MY_POD_NAME\"}":{".":{},"f:name":{},"f:valueFrom":{".":{},"f:fieldRef":{".":{},"f:apiVersion":{},"f:fieldPath":{}}}},"k:{\"name\":\"MY_POD_NAMESPACE\"}":{".":{},"f:name":{},"f:valueFrom":{".":{},"f:fieldRef":{".":{},"f:apiVersion":{},"f:fieldPath":{}}}},"k:{\"name\":\"RABBITMQ_ENABLED_PLUGINS_FILE\"}":{".":{},"f:name":{},"f:value":{}},"k:{\"name\":\"RABBITMQ_NODENAME\"}":{".":{},"f:name":{},"f:value":{}},"k:{\"name\":\"RABBITMQ_USE_LONGNAME\"}":{".":{},"f:name":{},"f:value":{}}},"f:image":{},"f:imagePullPolicy":{},"f:lifecycle":{".":{},"f:preStop":{".":{},"f:exec":{".":{},"f:command":{}}}},"f:name":{},"f:ports":{".":{},"k:{\"containerPort\":4369,\"protocol\":\"TCP\"}":{".":{},"f:containerPort":{},"f:name":{},"f:protocol":{}},"k:{\"containerPort\":5672,\"protocol\":\"TCP\"}":{".":{},"f:containerPort":{},"f:name":{},"f:protocol":{}},"k:{\"containerPort\":15672,\"protocol\":\"TCP\"}":{".":{},"f:containerPort":{},"f:name":{},"f:protocol":{}},"k:{\"containerPort\":15692,\"protocol\":\"TCP\"}":{".":{},"f:containerPort":{},"f:name":{},"f:protocol":{}}},"f:readinessProbe":{".":{},"f:failureThreshold":{},"f:initialDelaySeconds":{},"f:periodSeconds":{},"f:successThreshold":{},"f:tcpSocket":{".":{},"f:port":{}},"f:timeoutSeconds":{}},"f:resources":{".":{},"f:limits":{".":{},"f:cpu":{},"f:memory":{}},"f:requests":{".":{},"f:cpu":{},"f:memory":{}}},"f:terminationMessagePath":{},"f:terminationMessagePolicy":{},"f:volumeMounts":{".":{},"k:{\"mountPath\":\"/etc/pod-info/\"}":{".":{},"f:mountPath":{},"f:name":{}},"k:{\"mountPath\":\"/etc/rabbitmq/conf.d/10-operatorDefaults.conf\"}":{".":{},"f:mountPath":{},"f:name":{},"f:subPath":{}},"k:{\"mountPath\":\"/etc/rabbitmq/conf.d/11-default_user.conf\"}":{".":{},"f:mountPath":{},"f:name":{},"f:subPath":{}},"k:{\"mountPath\":\"/etc/rabbitmq/conf.d/90-userDefinedConfiguration.conf\"}":{".":{},"f:mountPath":{},"f:name":{},"f:subPath":{}},"k:{\"mountPath\":\"/operator\"}":{".":{},"f:mountPath":{},"f:name":{}},"k:{\"mountPath\":\"/var/lib/rabbitmq/\"}":{".":{},"f:mountPath":{},"f:name":{}},"k:{\"mountPath\":\"/var/lib/rabbitmq/mnesia/\"}":{".":{},"f:mountPath":{},"f:name":{}}}}},"f:dnsPolicy":{},"f:initContainers":{".":{},"k:{\"name\":\"setup-container\"}":{".":{},"f:command":{},"f:image":{},"f:imagePullPolicy":{},"f:name":{},"f:resources":{".":{},"f:limits":{".":{},"f:cpu":{},"f:memory":{}},"f:requests":{".":{},"f:cpu":{},"f:memory":{}}},"f:securityContext":{".":{},"f:capabilities":{".":{},"f:drop":{}},"f:runAsUser":{}},"f:terminationMessagePath":{},"f:terminationMessagePolicy":{},"f:volumeMounts":{".":{},"k:{\"mountPath\":\"/operator\"}":{".":{},"f:mountPath":{},"f:name":{}},"k:{\"mountPath\":\"/tmp/default_user.conf\"}":{".":{},"f:mountPath":{},"f:name":{},"f:subPath":{}},"k:{\"mountPath\":\"/tmp/erlang-cookie-secret/\"}":{".":{},"f:mountPath":{},"f:name":{}},"k:{\"mountPath\":\"/tmp/rabbitmq-plugins/\"}":{".":{},"f:mountPath":{},"f:name":{}},"k:{\"mountPath\":\"/var/lib/rabbitmq/\"}":{".":{},"f:mountPath":{},"f:name":{}},"k:{\"mountPath\":\"/var/lib/rabbitmq/mnesia/\"}":{".":{},"f:mountPath":{},"f:name":{}}}}},"f:restartPolicy":{},"f:schedulerName":{},"f:securityContext":{".":{},"f:fsGroup":{},"f:runAsGroup":{},"f:runAsUser":{}},"f:serviceAccount":{},"f:serviceAccountName":{},"f:terminationGracePeriodSeconds":{},"f:topologySpreadConstraints":{".":{},"k:{\"topologyKey\":\"topology.kubernetes.io/zone\",\"whenUnsatisfiable\":\"ScheduleAnyway\"}":{".":{},"f:labelSelector":{".":{},"f:matchLabels":{".":{},"f:app.kubernetes.io/name":{}}},"f:maxSkew":{},"f:topologyKey":{},"f:whenUnsatisfiable":{}}},"f:volumes":{".":{},"k:{\"name\":\"erlang-cookie-secret\"}":{".":{},"f:name":{},"f:secret":{".":{},"f:defaultMode":{},"f:secretName":{}}},"k:{\"name\":\"plugins-conf\"}":{".":{},"f:configMap":{".":{},"f:defaultMode":{},"f:name":{}},"f:name":{}},"k:{\"name\":\"pod-info\"}":{".":{},"f:downwardAPI":{".":{},"f:defaultMode":{},"f:items":{}},"f:name":{}},"k:{\"name\":\"rabbitmq-confd\"}":{".":{},"f:name":{},"f:projected":{".":{},"f:defaultMode":{},"f:sources":{}}},"k:{\"name\":\"rabbitmq-erlang-cookie\"}":{".":{},"f:emptyDir":{},"f:name":{}},"k:{\"name\":\"rabbitmq-plugins\"}":{".":{},"f:emptyDir":{},"f:name":{}}}}},"f:updateStrategy":{"f:rollingUpdate":{".":{},"f:partition":{}},"f:type":{}},"f:volumeClaimTemplates":{}}}}]},"spec":{"replicas":1,"selector":{"matchLabels":{"app.kubernetes.io/name":"rabbitmq-cluster"}},"template":{"metadata":{"creationTimestamp":null,"labels":{"app.kubernetes.io/component":"rabbitmq","app.kubernetes.io/name":"rabbitmq-cluster","app.kubernetes.io/part-of":"rabbitmq"},"annotations":{"prometheus.io/port":"15692","prometheus.io/scrape":"true"}},"spec":{"volumes":[{"name":"plugins-conf","configMap":{"name":"rabbitmq-cluster-plugins-conf","defaultMode":420}},{"name":"rabbitmq-confd","projected":{"sources":[{"secret":{"name":"rabbitmq-cluster-default-user","items":[{"key":"default_user.conf","path":"default_user.conf"}]}},{"configMap":{"name":"rabbitmq-cluster-server-conf","items":[{"key":"operatorDefaults.conf","path":"operatorDefaults.conf"},{"key":"userDefinedConfiguration.conf","path":"userDefinedConfiguration.conf"}]}}],"defaultMode":420}},{"name":"rabbitmq-erlang-cookie","emptyDir":{}},{"name":"erlang-cookie-secret","secret":{"secretName":"rabbitmq-cluster-erlang-cookie","defaultMode":420}},{"name":"rabbitmq-plugins","emptyDir":{}},{"name":"pod-info","downwardAPI":{"items":[{"path":"skipPreStopChecks","fieldRef":{"apiVersion":"v1","fieldPath":"metadata.labels['skipPreStopChecks']"}}],"defaultMode":420}}],"initContainers":[{"name":"setup-container","image":"rabbitmq:3.8.12-management","command":["sh","-c","cp /tmp/erlang-cookie-secret/.erlang.cookie /var/lib/rabbitmq/.erlang.cookie \u0026\u0026 chown 999:999 /var/lib/rabbitmq/.erlang.cookie \u0026\u0026 chmod 600 /var/lib/rabbitmq/.erlang.cookie ; cp /tmp/rabbitmq-plugins/enabled_plugins /operator/enabled_plugins \u0026\u0026 chown 999:999 /operator/enabled_plugins ; chown 999:999 /var/lib/rabbitmq/mnesia/ ; echo '[default]' \u003e /var/lib/rabbitmq/.rabbitmqadmin.conf \u0026\u0026 sed -e 's/default_user/username/' -e 's/default_pass/password/' /tmp/default_user.conf \u003e\u003e /var/lib/rabbitmq/.rabbitmqadmin.conf \u0026\u0026 chown 999:999 /var/lib/rabbitmq/.rabbitmqadmin.conf \u0026\u0026 chmod 600 /var/lib/rabbitmq/.rabbitmqadmin.conf"],"resources":{"limits":{"cpu":"100m","memory":"500Mi"},"requests":{"cpu":"100m","memory":"500Mi"}},"volumeMounts":[{"name":"plugins-conf","mountPath":"/tmp/rabbitmq-plugins/"},{"name":"rabbitmq-erlang-cookie","mountPath":"/var/lib/rabbitmq/"},{"name":"erlang-cookie-secret","mountPath":"/tmp/erlang-cookie-secret/"},{"name":"rabbitmq-plugins","mountPath":"/operator"},{"name":"persistence","mountPath":"/var/lib/rabbitmq/mnesia/"},{"name":"rabbitmq-confd","mountPath":"/tmp/default_user.conf","subPath":"default_user.conf"}],"terminationMessagePath":"/dev/termination-log","terminationMessagePolicy":"File","imagePullPolicy":"IfNotPresent","securityContext":{"capabilities":{"drop":["FSETID","KILL","SETGID","SETUID","SETPCAP","NET_BIND_SERVICE","NET_RAW","SYS_CHROOT","MKNOD","AUDIT_WRITE","SETFCAP"]},"runAsUser":0}}],"containers":[{"name":"rabbitmq","image":"rabbitmq:3.8.12-management","ports":[{"name":"epmd","containerPort":4369,"protocol":"TCP"},{"name":"amqp","containerPort":5672,"protocol":"TCP"},{"name":"management","containerPort":15672,"protocol":"TCP"},{"name":"prometheus","containerPort":15692,"protocol":"TCP"}],"env":[{"name":"MY_POD_NAME","valueFrom":{"fieldRef":{"apiVersion":"v1","fieldPath":"metadata.name"}}},{"name":"MY_POD_NAMESPACE","valueFrom":{"fieldRef":{"apiVersion":"v1","fieldPath":"metadata.namespace"}}},{"name":"RABBITMQ_ENABLED_PLUGINS_FILE","value":"/operator/enabled_plugins"},{"name":"K8S_SERVICE_NAME","value":"rabbitmq-cluster-nodes"},{"name":"RABBITMQ_USE_LONGNAME","value":"true"},{"name":"RABBITMQ_NODENAME","value":"rabbit@$(MY_POD_NAME).$(K8S_SERVICE_NAME).$(MY_POD_NAMESPACE)"},{"name":"K8S_HOSTNAME_SUFFIX","value":".$(K8S_SERVICE_NAME).$(MY_POD_NAMESPACE)"}],"resources":{"limits":{"cpu":"2","memory":"2Gi"},"requests":{"cpu":"1","memory":"2Gi"}},"volumeMounts":[{"name":"rabbitmq-erlang-cookie","mountPath":"/var/lib/rabbitmq/"},{"name":"persistence","mountPath":"/var/lib/rabbitmq/mnesia/"},{"name":"rabbitmq-plugins","mountPath":"/operator"},{"name":"rabbitmq-confd","mountPath":"/etc/rabbitmq/conf.d/10-operatorDefaults.conf","subPath":"operatorDefaults.conf"},{"name":"rabbitmq-confd","mountPath":"/etc/rabbitmq/conf.d/11-default_user.conf","subPath":"default_user.conf"},{"name":"rabbitmq-confd","mountPath":"/etc/rabbitmq/conf.d/90-userDefinedConfiguration.conf","subPath":"userDefinedConfiguration.conf"},{"name":"pod-info","mountPath":"/etc/pod-info/"}],"readinessProbe":{"tcpSocket":{"port":"amqp"},"initialDelaySeconds":10,"timeoutSeconds":5,"periodSeconds":10,"successThreshold":1,"failureThreshold":3},"lifecycle":{"preStop":{"exec":{"command":["/bin/bash","-c","if [ ! -z \"$(cat /etc/pod-info/skipPreStopChecks)\" ]; then exit 0; fi; rabbitmq-upgrade await_online_quorum_plus_one -t 604800; rabbitmq-upgrade await_online_synchronized_mirror -t 604800; rabbitmq-upgrade drain -t 604800"]}}},"terminationMessagePath":"/dev/termination-log","terminationMessagePolicy":"File","imagePullPolicy":"IfNotPresent"}],"restartPolicy":"Always","terminationGracePeriodSeconds":604800,"dnsPolicy":"ClusterFirst","serviceAccountName":"rabbitmq-cluster-server","serviceAccount":"rabbitmq-cluster-server","automountServiceAccountToken":true,"securityContext":{"runAsUser":999,"runAsGroup":999,"fsGroup":999},"schedulerName":"default-scheduler","topologySpreadConstraints":[{"maxSkew":1,"topologyKey":"topology.kubernetes.io/zone","whenUnsatisfiable":"ScheduleAnyway","labelSelector":{"matchLabels":{"app.kubernetes.io/name":"rabbitmq-cluster"}}}]}},"volumeClaimTemplates":[{"metadata":{"name":"persistence","namespace":"default","creationTimestamp":null,"labels":{"app.kubernetes.io/component":"rabbitmq","app.kubernetes.io/name":"rabbitmq-cluster","app.kubernetes.io/part-of":"rabbitmq"},"ownerReferences":[{"apiVersion":"rabbitmq.com/v1beta1","kind":"RabbitmqCluster","name":"rabbitmq-cluster","uid":"18d9928b-0d1c-47be-80ec-20960d053827","controller":true,"blockOwnerDeletion":false}]},"spec":{"accessModes":["ReadWriteOnce"],"resources":{"requests":{"storage":"10Gi"}},"volumeMode":"Filesystem"},"status":{"phase":"Pending"}}],"serviceName":"rabbitmq-cluster-nodes","podManagementPolicy":"Parallel","updateStrategy":{"type":"RollingUpdate","rollingUpdate":{"partition":0}},"revisionHistoryLimit":10},"status":{"observedGeneration":1,"replicas":1,"currentReplicas":1,"updatedReplicas":1,"currentRevision":"rabbitmq-cluster-server-5f8b8665fb","updateRevision":"rabbitmq-cluster-server-5f8b8665fb","collisionCount":0}}
2022/03/18 18:00:38 learn_server.go:291: [SIEVE-AFTER-READ]	Get	true	configmap	default	rabbitmq-cluster-server-conf	github.com/rabbitmq/cluster-operator/controllers.(*RabbitmqClusterReconciler)	NoError	{"kind":"ConfigMap","apiVersion":"v1","metadata":{"name":"rabbitmq-cluster-server-conf","namespace":"default","selfLink":"/api/v1/namespaces/default/configmaps/rabbitmq-cluster-server-conf","uid":"22474f2b-8454-44b7-8079-8990223969cc","resourceVersion":"714","creationTimestamp":"2022-03-18T18:00:38Z","labels":{"app.kubernetes.io/component":"rabbitmq","app.kubernetes.io/name":"rabbitmq-cluster","app.kubernetes.io/part-of":"rabbitmq"},"ownerReferences":[{"apiVersion":"rabbitmq.com/v1beta1","kind":"RabbitmqCluster","name":"rabbitmq-cluster","uid":"18d9928b-0d1c-47be-80ec-20960d053827","controller":true,"blockOwnerDeletion":true}],"managedFields":[{"manager":"manager","operation":"Update","apiVersion":"v1","time":"2022-03-18T18:00:38Z","fieldsType":"FieldsV1","fieldsV1":{"f:data":{".":{},"f:operatorDefaults.conf":{},"f:userDefinedConfiguration.conf":{}},"f:metadata":{"f:labels":{".":{},"f:app.kubernetes.io/component":{},"f:app.kubernetes.io/name":{},"f:app.kubernetes.io/part-of":{}},"f:ownerReferences":{".":{},"k:{\"uid\":\"18d9928b-0d1c-47be-80ec-20960d053827\"}":{".":{},"f:apiVersion":{},"f:blockOwnerDeletion":{},"f:controller":{},"f:kind":{},"f:name":{},"f:uid":{}}}}}}]},"data":{"operatorDefaults.conf":"cluster_formation.peer_discovery_backend             = rabbit_peer_discovery_k8s\ncluster_formation.k8s.host                           = kubernetes.default\ncluster_formation.k8s.address_type                   = hostname\ncluster_partition_handling                           = pause_minority\nqueue_master_locator                                 = min-masters\ndisk_free_limit.absolute                             = 2GB\ncluster_formation.randomized_startup_delay_range.min = 5\ncluster_formation.randomized_startup_delay_range.max = 30\ncluster_name                                         = rabbitmq-cluster\n","userDefinedConfiguration.conf":"total_memory_available_override_value = 1717986919\n"}}
2022/03/18 18:00:38 learn_server.go:256: [SIEVE-BEFORE-WRITE]	20
2022/03/18 18:00:38 learn_server.go:263: [SIEVE-AFTER-WRITE]	20	StatusUpdate	rabbitmqcluster	github.com/rabbitmq/cluster-operator/controllers.(*RabbitmqClusterReconciler)	NoError	{"metadata":{"name":"rabbitmq-cluster","namespace":"default","selfLink":"/apis/rabbitmq.com/v1beta1/namespaces/default/rabbitmqclusters/rabbitmq-cluster/status","uid":"18d9928b-0d1c-47be-80ec-20960d053827","resourceVersion":"746","generation":2,"creationTimestamp":"2022-03-18T18:00:38Z","annotations":{"kubectl.kubernetes.io/last-applied-configuration":"{\"apiVersion\":\"rabbitmq.com/v1beta1\",\"kind\":\"RabbitmqCluster\",\"metadata\":{\"annotations\":{},\"name\":\"rabbitmq-cluster\",\"namespace\":\"default\"},\"spec\":{\"persistence\":{\"storage\":\"10Gi\"},\"replicas\":1}}\n"},"finalizers":["deletion.finalizers.rabbitmqclusters.rabbitmq.com"],"managedFields":[{"manager":"kubectl-client-side-apply","operation":"Update","apiVersion":"rabbitmq.com/v1beta1","time":"2022-03-18T18:00:38Z","fieldsType":"FieldsV1","fieldsV1":{"f:metadata":{"f:annotations":{".":{},"f:kubectl.kubernetes.io/last-applied-configuration":{}}},"f:spec":{".":{},"f:image":{},"f:persistence":{".":{},"f:storage":{}},"f:replicas":{},"f:resources":{".":{},"f:limits":{".":{},"f:memory":{}},"f:requests":{".":{},"f:memory":{}}},"f:service":{".":{},"f:type":{}},"f:terminationGracePeriodSeconds":{}}}},{"manager":"manager","operation":"Update","apiVersion":"rabbitmq.com/v1beta1","time":"2022-03-18T18:00:38Z","fieldsType":"FieldsV1","fieldsV1":{"f:metadata":{"f:finalizers":{}},"f:spec":{"f:override":{},"f:rabbitmq":{},"f:resources":{"f:limits":{"f:cpu":{}},"f:requests":{"f:cpu":{}}},"f:tls":{}},"f:status":{".":{},"f:conditions":{},"f:defaultUser":{".":{},"f:secretReference":{".":{},"f:keys":{".":{},"f:password":{},"f:username":{}},"f:name":{},"f:namespace":{}},"f:serviceReference":{".":{},"f:name":{},"f:namespace":{}}}}}}]},"spec":{"replicas":1,"image":"rabbitmq:3.8.12-management","service":{"type":"ClusterIP"},"persistence":{"storage":"10Gi"},"resources":{"limits":{"cpu":"2","memory":"2Gi"},"requests":{"cpu":"1","memory":"2Gi"}},"rabbitmq":{},"tls":{},"override":{},"terminationGracePeriodSeconds":604800},"status":{"conditions":[{"type":"AllReplicasReady","status":"False","lastTransitionTime":"2022-03-18T18:00:38Z","reason":"NotAllPodsReady","message":"0/1 Pods ready"},{"type":"ClusterAvailable","status":"False","lastTransitionTime":"2022-03-18T18:00:38Z","reason":"NoEndpointsAvailable","message":"The service has no endpoints available"},{"type":"NoWarnings","status":"True","lastTransitionTime":"2022-03-18T18:00:38Z","reason":"NoWarnings"},{"type":"ReconcileSuccess","status":"Unknown","lastTransitionTime":"2022-03-18T18:00:38Z","reason":"Initialising"}],"defaultUser":{"secretReference":{"name":"rabbitmq-cluster-default-user","namespace":"default","keys":{"password":"password","username":"username"}},"serviceReference":{"name":"rabbitmq-cluster","namespace":"default"}},"binding":{"name":"rabbitmq-cluster-default-user"}}}
2022/03/18 18:00:38 learn_server.go:291: [SIEVE-AFTER-READ]	Get	true	statefulset	default	rabbitmq-cluster-server	github.com/rabbitmq/cluster-operator/controllers.(*RabbitmqClusterReconciler)	NoError	{"kind":"StatefulSet","apiVersion":"apps/v1","metadata":{"name":"rabbitmq-cluster-server","namespace":"default","selfLink":"/apis/apps/v1/namespaces/default/statefulsets/rabbitmq-cluster-server","uid":"cb5c43bc-6ee7-481c-ab01-6f3acffdd3c8","resourceVersion":"744","generation":1,"creationTimestamp":"2022-03-18T18:00:38Z","labels":{"app.kubernetes.io/component":"rabbitmq","app.kubernetes.io/name":"rabbitmq-cluster","app.kubernetes.io/part-of":"rabbitmq"},"annotations":{"rabbitmq.com/createdAt":"2022-03-18T18:00:38Z"},"ownerReferences":[{"apiVersion":"rabbitmq.com/v1beta1","kind":"RabbitmqCluster","name":"rabbitmq-cluster","uid":"18d9928b-0d1c-47be-80ec-20960d053827","controller":true,"blockOwnerDeletion":true}],"managedFields":[{"manager":"kube-controller-manager","operation":"Update","apiVersion":"apps/v1","time":"2022-03-18T18:00:38Z","fieldsType":"FieldsV1","fieldsV1":{"f:status":{"f:collisionCount":{},"f:currentReplicas":{},"f:currentRevision":{},"f:observedGeneration":{},"f:replicas":{},"f:updateRevision":{},"f:updatedReplicas":{}}}},{"manager":"manager","operation":"Update","apiVersion":"apps/v1","time":"2022-03-18T18:00:38Z","fieldsType":"FieldsV1","fieldsV1":{"f:metadata":{"f:annotations":{".":{},"f:rabbitmq.com/createdAt":{}},"f:labels":{".":{},"f:app.kubernetes.io/component":{},"f:app.kubernetes.io/name":{},"f:app.kubernetes.io/part-of":{}},"f:ownerReferences":{".":{},"k:{\"uid\":\"18d9928b-0d1c-47be-80ec-20960d053827\"}":{".":{},"f:apiVersion":{},"f:blockOwnerDeletion":{},"f:controller":{},"f:kind":{},"f:name":{},"f:uid":{}}}},"f:spec":{"f:podManagementPolicy":{},"f:replicas":{},"f:revisionHistoryLimit":{},"f:selector":{"f:matchLabels":{".":{},"f:app.kubernetes.io/name":{}}},"f:serviceName":{},"f:template":{"f:metadata":{"f:annotations":{".":{},"f:prometheus.io/port":{},"f:prometheus.io/scrape":{}},"f:labels":{".":{},"f:app.kubernetes.io/component":{},"f:app.kubernetes.io/name":{},"f:app.kubernetes.io/part-of":{}}},"f:spec":{"f:automountServiceAccountToken":{},"f:containers":{"k:{\"name\":\"rabbitmq\"}":{".":{},"f:env":{".":{},"k:{\"name\":\"K8S_HOSTNAME_SUFFIX\"}":{".":{},"f:name":{},"f:value":{}},"k:{\"name\":\"K8S_SERVICE_NAME\"}":{".":{},"f:name":{},"f:value":{}},"k:{\"name\":\"MY_POD_NAME\"}":{".":{},"f:name":{},"f:valueFrom":{".":{},"f:fieldRef":{".":{},"f:apiVersion":{},"f:fieldPath":{}}}},"k:{\"name\":\"MY_POD_NAMESPACE\"}":{".":{},"f:name":{},"f:valueFrom":{".":{},"f:fieldRef":{".":{},"f:apiVersion":{},"f:fieldPath":{}}}},"k:{\"name\":\"RABBITMQ_ENABLED_PLUGINS_FILE\"}":{".":{},"f:name":{},"f:value":{}},"k:{\"name\":\"RABBITMQ_NODENAME\"}":{".":{},"f:name":{},"f:value":{}},"k:{\"name\":\"RABBITMQ_USE_LONGNAME\"}":{".":{},"f:name":{},"f:value":{}}},"f:image":{},"f:imagePullPolicy":{},"f:lifecycle":{".":{},"f:preStop":{".":{},"f:exec":{".":{},"f:command":{}}}},"f:name":{},"f:ports":{".":{},"k:{\"containerPort\":4369,\"protocol\":\"TCP\"}":{".":{},"f:containerPort":{},"f:name":{},"f:protocol":{}},"k:{\"containerPort\":5672,\"protocol\":\"TCP\"}":{".":{},"f:containerPort":{},"f:name":{},"f:protocol":{}},"k:{\"containerPort\":15672,\"protocol\":\"TCP\"}":{".":{},"f:containerPort":{},"f:name":{},"f:protocol":{}},"k:{\"containerPort\":15692,\"protocol\":\"TCP\"}":{".":{},"f:containerPort":{},"f:name":{},"f:protocol":{}}},"f:readinessProbe":{".":{},"f:failureThreshold":{},"f:initialDelaySeconds":{},"f:periodSeconds":{},"f:successThreshold":{},"f:tcpSocket":{".":{},"f:port":{}},"f:timeoutSeconds":{}},"f:resources":{".":{},"f:limits":{".":{},"f:cpu":{},"f:memory":{}},"f:requests":{".":{},"f:cpu":{},"f:memory":{}}},"f:terminationMessagePath":{},"f:terminationMessagePolicy":{},"f:volumeMounts":{".":{},"k:{\"mountPath\":\"/etc/pod-info/\"}":{".":{},"f:mountPath":{},"f:name":{}},"k:{\"mountPath\":\"/etc/rabbitmq/conf.d/10-operatorDefaults.conf\"}":{".":{},"f:mountPath":{},"f:name":{},"f:subPath":{}},"k:{\"mountPath\":\"/etc/rabbitmq/conf.d/11-default_user.conf\"}":{".":{},"f:mountPath":{},"f:name":{},"f:subPath":{}},"k:{\"mountPath\":\"/etc/rabbitmq/conf.d/90-userDefinedConfiguration.conf\"}":{".":{},"f:mountPath":{},"f:name":{},"f:subPath":{}},"k:{\"mountPath\":\"/operator\"}":{".":{},"f:mountPath":{},"f:name":{}},"k:{\"mountPath\":\"/var/lib/rabbitmq/\"}":{".":{},"f:mountPath":{},"f:name":{}},"k:{\"mountPath\":\"/var/lib/rabbitmq/mnesia/\"}":{".":{},"f:mountPath":{},"f:name":{}}}}},"f:dnsPolicy":{},"f:initContainers":{".":{},"k:{\"name\":\"setup-container\"}":{".":{},"f:command":{},"f:image":{},"f:imagePullPolicy":{},"f:name":{},"f:resources":{".":{},"f:limits":{".":{},"f:cpu":{},"f:memory":{}},"f:requests":{".":{},"f:cpu":{},"f:memory":{}}},"f:securityContext":{".":{},"f:capabilities":{".":{},"f:drop":{}},"f:runAsUser":{}},"f:terminationMessagePath":{},"f:terminationMessagePolicy":{},"f:volumeMounts":{".":{},"k:{\"mountPath\":\"/operator\"}":{".":{},"f:mountPath":{},"f:name":{}},"k:{\"mountPath\":\"/tmp/default_user.conf\"}":{".":{},"f:mountPath":{},"f:name":{},"f:subPath":{}},"k:{\"mountPath\":\"/tmp/erlang-cookie-secret/\"}":{".":{},"f:mountPath":{},"f:name":{}},"k:{\"mountPath\":\"/tmp/rabbitmq-plugins/\"}":{".":{},"f:mountPath":{},"f:name":{}},"k:{\"mountPath\":\"/var/lib/rabbitmq/\"}":{".":{},"f:mountPath":{},"f:name":{}},"k:{\"mountPath\":\"/var/lib/rabbitmq/mnesia/\"}":{".":{},"f:mountPath":{},"f:name":{}}}}},"f:restartPolicy":{},"f:schedulerName":{},"f:securityContext":{".":{},"f:fsGroup":{},"f:runAsGroup":{},"f:runAsUser":{}},"f:serviceAccount":{},"f:serviceAccountName":{},"f:terminationGracePeriodSeconds":{},"f:topologySpreadConstraints":{".":{},"k:{\"topologyKey\":\"topology.kubernetes.io/zone\",\"whenUnsatisfiable\":\"ScheduleAnyway\"}":{".":{},"f:labelSelector":{".":{},"f:matchLabels":{".":{},"f:app.kubernetes.io/name":{}}},"f:maxSkew":{},"f:topologyKey":{},"f:whenUnsatisfiable":{}}},"f:volumes":{".":{},"k:{\"name\":\"erlang-cookie-secret\"}":{".":{},"f:name":{},"f:secret":{".":{},"f:defaultMode":{},"f:secretName":{}}},"k:{\"name\":\"plugins-conf\"}":{".":{},"f:configMap":{".":{},"f:defaultMode":{},"f:name":{}},"f:name":{}},"k:{\"name\":\"pod-info\"}":{".":{},"f:downwardAPI":{".":{},"f:defaultMode":{},"f:items":{}},"f:name":{}},"k:{\"name\":\"rabbitmq-confd\"}":{".":{},"f:name":{},"f:projected":{".":{},"f:defaultMode":{},"f:sources":{}}},"k:{\"name\":\"rabbitmq-erlang-cookie\"}":{".":{},"f:emptyDir":{},"f:name":{}},"k:{\"name\":\"rabbitmq-plugins\"}":{".":{},"f:emptyDir":{},"f:name":{}}}}},"f:updateStrategy":{"f:rollingUpdate":{".":{},"f:partition":{}},"f:type":{}},"f:volumeClaimTemplates":{}}}}]},"spec":{"replicas":1,"selector":{"matchLabels":{"app.kubernetes.io/name":"rabbitmq-cluster"}},"template":{"metadata":{"creationTimestamp":null,"labels":{"app.kubernetes.io/component":"rabbitmq","app.kubernetes.io/name":"rabbitmq-cluster","app.kubernetes.io/part-of":"rabbitmq"},"annotations":{"prometheus.io/port":"15692","prometheus.io/scrape":"true"}},"spec":{"volumes":[{"name":"plugins-conf","configMap":{"name":"rabbitmq-cluster-plugins-conf","defaultMode":420}},{"name":"rabbitmq-confd","projected":{"sources":[{"secret":{"name":"rabbitmq-cluster-default-user","items":[{"key":"default_user.conf","path":"default_user.conf"}]}},{"configMap":{"name":"rabbitmq-cluster-server-conf","items":[{"key":"operatorDefaults.conf","path":"operatorDefaults.conf"},{"key":"userDefinedConfiguration.conf","path":"userDefinedConfiguration.conf"}]}}],"defaultMode":420}},{"name":"rabbitmq-erlang-cookie","emptyDir":{}},{"name":"erlang-cookie-secret","secret":{"secretName":"rabbitmq-cluster-erlang-cookie","defaultMode":420}},{"name":"rabbitmq-plugins","emptyDir":{}},{"name":"pod-info","downwardAPI":{"items":[{"path":"skipPreStopChecks","fieldRef":{"apiVersion":"v1","fieldPath":"metadata.labels['skipPreStopChecks']"}}],"defaultMode":420}}],"initContainers":[{"name":"setup-container","image":"rabbitmq:3.8.12-management","command":["sh","-c","cp /tmp/erlang-cookie-secret/.erlang.cookie /var/lib/rabbitmq/.erlang.cookie \u0026\u0026 chown 999:999 /var/lib/rabbitmq/.erlang.cookie \u0026\u0026 chmod 600 /var/lib/rabbitmq/.erlang.cookie ; cp /tmp/rabbitmq-plugins/enabled_plugins /operator/enabled_plugins \u0026\u0026 chown 999:999 /operator/enabled_plugins ; chown 999:999 /var/lib/rabbitmq/mnesia/ ; echo '[default]' \u003e /var/lib/rabbitmq/.rabbitmqadmin.conf \u0026\u0026 sed -e 's/default_user/username/' -e 's/default_pass/password/' /tmp/default_user.conf \u003e\u003e /var/lib/rabbitmq/.rabbitmqadmin.conf \u0026\u0026 chown 999:999 /var/lib/rabbitmq/.rabbitmqadmin.conf \u0026\u0026 chmod 600 /var/lib/rabbitmq/.rabbitmqadmin.conf"],"resources":{"limits":{"cpu":"100m","memory":"500Mi"},"requests":{"cpu":"100m","memory":"500Mi"}},"volumeMounts":[{"name":"plugins-conf","mountPath":"/tmp/rabbitmq-plugins/"},{"name":"rabbitmq-erlang-cookie","mountPath":"/var/lib/rabbitmq/"},{"name":"erlang-cookie-secret","mountPath":"/tmp/erlang-cookie-secret/"},{"name":"rabbitmq-plugins","mountPath":"/operator"},{"name":"persistence","mountPath":"/var/lib/rabbitmq/mnesia/"},{"name":"rabbitmq-confd","mountPath":"/tmp/default_user.conf","subPath":"default_user.conf"}],"terminationMessagePath":"/dev/termination-log","terminationMessagePolicy":"File","imagePullPolicy":"IfNotPresent","securityContext":{"capabilities":{"drop":["FSETID","KILL","SETGID","SETUID","SETPCAP","NET_BIND_SERVICE","NET_RAW","SYS_CHROOT","MKNOD","AUDIT_WRITE","SETFCAP"]},"runAsUser":0}}],"containers":[{"name":"rabbitmq","image":"rabbitmq:3.8.12-management","ports":[{"name":"epmd","containerPort":4369,"protocol":"TCP"},{"name":"amqp","containerPort":5672,"protocol":"TCP"},{"name":"management","containerPort":15672,"protocol":"TCP"},{"name":"prometheus","containerPort":15692,"protocol":"TCP"}],"env":[{"name":"MY_POD_NAME","valueFrom":{"fieldRef":{"apiVersion":"v1","fieldPath":"metadata.name"}}},{"name":"MY_POD_NAMESPACE","valueFrom":{"fieldRef":{"apiVersion":"v1","fieldPath":"metadata.namespace"}}},{"name":"RABBITMQ_ENABLED_PLUGINS_FILE","value":"/operator/enabled_plugins"},{"name":"K8S_SERVICE_NAME","value":"rabbitmq-cluster-nodes"},{"name":"RABBITMQ_USE_LONGNAME","value":"true"},{"name":"RABBITMQ_NODENAME","value":"rabbit@$(MY_POD_NAME).$(K8S_SERVICE_NAME).$(MY_POD_NAMESPACE)"},{"name":"K8S_HOSTNAME_SUFFIX","value":".$(K8S_SERVICE_NAME).$(MY_POD_NAMESPACE)"}],"resources":{"limits":{"cpu":"2","memory":"2Gi"},"requests":{"cpu":"1","memory":"2Gi"}},"volumeMounts":[{"name":"rabbitmq-erlang-cookie","mountPath":"/var/lib/rabbitmq/"},{"name":"persistence","mountPath":"/var/lib/rabbitmq/mnesia/"},{"name":"rabbitmq-plugins","mountPath":"/operator"},{"name":"rabbitmq-confd","mountPath":"/etc/rabbitmq/conf.d/10-operatorDefaults.conf","subPath":"operatorDefaults.conf"},{"name":"rabbitmq-confd","mountPath":"/etc/rabbitmq/conf.d/11-default_user.conf","subPath":"default_user.conf"},{"name":"rabbitmq-confd","mountPath":"/etc/rabbitmq/conf.d/90-userDefinedConfiguration.conf","subPath":"userDefinedConfiguration.conf"},{"name":"pod-info","mountPath":"/etc/pod-info/"}],"readinessProbe":{"tcpSocket":{"port":"amqp"},"initialDelaySeconds":10,"timeoutSeconds":5,"periodSeconds":10,"successThreshold":1,"failureThreshold":3},"lifecycle":{"preStop":{"exec":{"command":["/bin/bash","-c","if [ ! -z \"$(cat /etc/pod-info/skipPreStopChecks)\" ]; then exit 0; fi; rabbitmq-upgrade await_online_quorum_plus_one -t 604800; rabbitmq-upgrade await_online_synchronized_mirror -t 604800; rabbitmq-upgrade drain -t 604800"]}}},"terminationMessagePath":"/dev/termination-log","terminationMessagePolicy":"File","imagePullPolicy":"IfNotPresent"}],"restartPolicy":"Always","terminationGracePeriodSeconds":604800,"dnsPolicy":"ClusterFirst","serviceAccountName":"rabbitmq-cluster-server","serviceAccount":"rabbitmq-cluster-server","automountServiceAccountToken":true,"securityContext":{"runAsUser":999,"runAsGroup":999,"fsGroup":999},"schedulerName":"default-scheduler","topologySpreadConstraints":[{"maxSkew":1,"topologyKey":"topology.kubernetes.io/zone","whenUnsatisfiable":"ScheduleAnyway","labelSelector":{"matchLabels":{"app.kubernetes.io/name":"rabbitmq-cluster"}}}]}},"volumeClaimTemplates":[{"metadata":{"name":"persistence","namespace":"default","creationTimestamp":null,"labels":{"app.kubernetes.io/component":"rabbitmq","app.kubernetes.io/name":"rabbitmq-cluster","app.kubernetes.io/part-of":"rabbitmq"},"ownerReferences":[{"apiVersion":"rabbitmq.com/v1beta1","kind":"RabbitmqCluster","name":"rabbitmq-cluster","uid":"18d9928b-0d1c-47be-80ec-20960d053827","controller":true,"blockOwnerDeletion":false}]},"spec":{"accessModes":["ReadWriteOnce"],"resources":{"requests":{"storage":"10Gi"}},"volumeMode":"Filesystem"},"status":{"phase":"Pending"}}],"serviceName":"rabbitmq-cluster-nodes","podManagementPolicy":"Parallel","updateStrategy":{"type":"RollingUpdate","rollingUpdate":{"partition":0}},"revisionHistoryLimit":10},"status":{"observedGeneration":1,"replicas":1,"currentReplicas":1,"updatedReplicas":1,"currentRevision":"rabbitmq-cluster-server-5f8b8665fb","updateRevision":"rabbitmq-cluster-server-5f8b8665fb","collisionCount":0}}
2022/03/18 18:00:38 learn_server.go:253: [SIEVE-AFTER-RECONCILE]	github.com/rabbitmq/cluster-operator/controllers.(*RabbitmqClusterReconciler)	2
2022/03/18 18:00:53 learn_server.go:238: [SIEVE-BEFORE-RECONCILE]	github.com/rabbitmq/cluster-operator/controllers.(*RabbitmqClusterReconciler)	3
2022/03/18 18:00:53 learn_server.go:291: [SIEVE-AFTER-READ]	Get	true	rabbitmqcluster	default	rabbitmq-cluster	github.com/rabbitmq/cluster-operator/controllers.(*RabbitmqClusterReconciler)	NoError	{"kind":"RabbitmqCluster","apiVersion":"rabbitmq.com/v1beta1","metadata":{"name":"rabbitmq-cluster","namespace":"default","selfLink":"/apis/rabbitmq.com/v1beta1/namespaces/default/rabbitmqclusters/rabbitmq-cluster","uid":"18d9928b-0d1c-47be-80ec-20960d053827","resourceVersion":"746","generation":2,"creationTimestamp":"2022-03-18T18:00:38Z","annotations":{"kubectl.kubernetes.io/last-applied-configuration":"{\"apiVersion\":\"rabbitmq.com/v1beta1\",\"kind\":\"RabbitmqCluster\",\"metadata\":{\"annotations\":{},\"name\":\"rabbitmq-cluster\",\"namespace\":\"default\"},\"spec\":{\"persistence\":{\"storage\":\"10Gi\"},\"replicas\":1}}\n"},"finalizers":["deletion.finalizers.rabbitmqclusters.rabbitmq.com"],"managedFields":[{"manager":"kubectl-client-side-apply","operation":"Update","apiVersion":"rabbitmq.com/v1beta1","time":"2022-03-18T18:00:38Z","fieldsType":"FieldsV1","fieldsV1":{"f:metadata":{"f:annotations":{".":{},"f:kubectl.kubernetes.io/last-applied-configuration":{}}},"f:spec":{".":{},"f:image":{},"f:persistence":{".":{},"f:storage":{}},"f:replicas":{},"f:resources":{".":{},"f:limits":{".":{},"f:memory":{}},"f:requests":{".":{},"f:memory":{}}},"f:service":{".":{},"f:type":{}},"f:terminationGracePeriodSeconds":{}}}},{"manager":"manager","operation":"Update","apiVersion":"rabbitmq.com/v1beta1","time":"2022-03-18T18:00:38Z","fieldsType":"FieldsV1","fieldsV1":{"f:metadata":{"f:finalizers":{}},"f:spec":{"f:override":{},"f:rabbitmq":{},"f:resources":{"f:limits":{"f:cpu":{}},"f:requests":{"f:cpu":{}}},"f:tls":{}},"f:status":{".":{},"f:conditions":{},"f:defaultUser":{".":{},"f:secretReference":{".":{},"f:keys":{".":{},"f:password":{},"f:username":{}},"f:name":{},"f:namespace":{}},"f:serviceReference":{".":{},"f:name":{},"f:namespace":{}}}}}}]},"spec":{"replicas":1,"image":"rabbitmq:3.8.12-management","service":{"type":"ClusterIP"},"persistence":{"storage":"10Gi"},"resources":{"limits":{"cpu":"2","memory":"2Gi"},"requests":{"cpu":"1","memory":"2Gi"}},"rabbitmq":{},"tls":{},"override":{},"terminationGracePeriodSeconds":604800},"status":{"conditions":[{"type":"AllReplicasReady","status":"False","lastTransitionTime":"2022-03-18T18:00:38Z","reason":"NotAllPodsReady","message":"0/1 Pods ready"},{"type":"ClusterAvailable","status":"False","lastTransitionTime":"2022-03-18T18:00:38Z","reason":"NoEndpointsAvailable","message":"The service has no endpoints available"},{"type":"NoWarnings","status":"True","lastTransitionTime":"2022-03-18T18:00:38Z","reason":"NoWarnings"},{"type":"ReconcileSuccess","status":"Unknown","lastTransitionTime":"2022-03-18T18:00:38Z","reason":"Initialising"}],"defaultUser":{"secretReference":{"name":"rabbitmq-cluster-default-user","namespace":"default","keys":{"password":"password","username":"username"}},"serviceReference":{"name":"rabbitmq-cluster","namespace":"default"}}}}
2022/03/18 18:00:53 learn_server.go:291: [SIEVE-AFTER-READ]	Get	true	statefulset	default	rabbitmq-cluster-server	github.com/rabbitmq/cluster-operator/controllers.(*RabbitmqClusterReconciler)	NoError	{"kind":"StatefulSet","apiVersion":"apps/v1","metadata":{"name":"rabbitmq-cluster-server","namespace":"default","selfLink":"/apis/apps/v1/namespaces/default/statefulsets/rabbitmq-cluster-server","uid":"cb5c43bc-6ee7-481c-ab01-6f3acffdd3c8","resourceVersion":"744","generation":1,"creationTimestamp":"2022-03-18T18:00:38Z","labels":{"app.kubernetes.io/component":"rabbitmq","app.kubernetes.io/name":"rabbitmq-cluster","app.kubernetes.io/part-of":"rabbitmq"},"annotations":{"rabbitmq.com/createdAt":"2022-03-18T18:00:38Z"},"ownerReferences":[{"apiVersion":"rabbitmq.com/v1beta1","kind":"RabbitmqCluster","name":"rabbitmq-cluster","uid":"18d9928b-0d1c-47be-80ec-20960d053827","controller":true,"blockOwnerDeletion":true}],"managedFields":[{"manager":"kube-controller-manager","operation":"Update","apiVersion":"apps/v1","time":"2022-03-18T18:00:38Z","fieldsType":"FieldsV1","fieldsV1":{"f:status":{"f:collisionCount":{},"f:currentReplicas":{},"f:currentRevision":{},"f:observedGeneration":{},"f:replicas":{},"f:updateRevision":{},"f:updatedReplicas":{}}}},{"manager":"manager","operation":"Update","apiVersion":"apps/v1","time":"2022-03-18T18:00:38Z","fieldsType":"FieldsV1","fieldsV1":{"f:metadata":{"f:annotations":{".":{},"f:rabbitmq.com/createdAt":{}},"f:labels":{".":{},"f:app.kubernetes.io/component":{},"f:app.kubernetes.io/name":{},"f:app.kubernetes.io/part-of":{}},"f:ownerReferences":{".":{},"k:{\"uid\":\"18d9928b-0d1c-47be-80ec-20960d053827\"}":{".":{},"f:apiVersion":{},"f:blockOwnerDeletion":{},"f:controller":{},"f:kind":{},"f:name":{},"f:uid":{}}}},"f:spec":{"f:podManagementPolicy":{},"f:replicas":{},"f:revisionHistoryLimit":{},"f:selector":{"f:matchLabels":{".":{},"f:app.kubernetes.io/name":{}}},"f:serviceName":{},"f:template":{"f:metadata":{"f:annotations":{".":{},"f:prometheus.io/port":{},"f:prometheus.io/scrape":{}},"f:labels":{".":{},"f:app.kubernetes.io/component":{},"f:app.kubernetes.io/name":{},"f:app.kubernetes.io/part-of":{}}},"f:spec":{"f:automountServiceAccountToken":{},"f:containers":{"k:{\"name\":\"rabbitmq\"}":{".":{},"f:env":{".":{},"k:{\"name\":\"K8S_HOSTNAME_SUFFIX\"}":{".":{},"f:name":{},"f:value":{}},"k:{\"name\":\"K8S_SERVICE_NAME\"}":{".":{},"f:name":{},"f:value":{}},"k:{\"name\":\"MY_POD_NAME\"}":{".":{},"f:name":{},"f:valueFrom":{".":{},"f:fieldRef":{".":{},"f:apiVersion":{},"f:fieldPath":{}}}},"k:{\"name\":\"MY_POD_NAMESPACE\"}":{".":{},"f:name":{},"f:valueFrom":{".":{},"f:fieldRef":{".":{},"f:apiVersion":{},"f:fieldPath":{}}}},"k:{\"name\":\"RABBITMQ_ENABLED_PLUGINS_FILE\"}":{".":{},"f:name":{},"f:value":{}},"k:{\"name\":\"RABBITMQ_NODENAME\"}":{".":{},"f:name":{},"f:value":{}},"k:{\"name\":\"RABBITMQ_USE_LONGNAME\"}":{".":{},"f:name":{},"f:value":{}}},"f:image":{},"f:imagePullPolicy":{},"f:lifecycle":{".":{},"f:preStop":{".":{},"f:exec":{".":{},"f:command":{}}}},"f:name":{},"f:ports":{".":{},"k:{\"containerPort\":4369,\"protocol\":\"TCP\"}":{".":{},"f:containerPort":{},"f:name":{},"f:protocol":{}},"k:{\"containerPort\":5672,\"protocol\":\"TCP\"}":{".":{},"f:containerPort":{},"f:name":{},"f:protocol":{}},"k:{\"containerPort\":15672,\"protocol\":\"TCP\"}":{".":{},"f:containerPort":{},"f:name":{},"f:protocol":{}},"k:{\"containerPort\":15692,\"protocol\":\"TCP\"}":{".":{},"f:containerPort":{},"f:name":{},"f:protocol":{}}},"f:readinessProbe":{".":{},"f:failureThreshold":{},"f:initialDelaySeconds":{},"f:periodSeconds":{},"f:successThreshold":{},"f:tcpSocket":{".":{},"f:port":{}},"f:timeoutSeconds":{}},"f:resources":{".":{},"f:limits":{".":{},"f:cpu":{},"f:memory":{}},"f:requests":{".":{},"f:cpu":{},"f:memory":{}}},"f:terminationMessagePath":{},"f:terminationMessagePolicy":{},"f:volumeMounts":{".":{},"k:{\"mountPath\":\"/etc/pod-info/\"}":{".":{},"f:mountPath":{},"f:name":{}},"k:{\"mountPath\":\"/etc/rabbitmq/conf.d/10-operatorDefaults.conf\"}":{".":{},"f:mountPath":{},"f:name":{},"f:subPath":{}},"k:{\"mountPath\":\"/etc/rabbitmq/conf.d/11-default_user.conf\"}":{".":{},"f:mountPath":{},"f:name":{},"f:subPath":{}},"k:{\"mountPath\":\"/etc/rabbitmq/conf.d/90-userDefinedConfiguration.conf\"}":{".":{},"f:mountPath":{},"f:name":{},"f:subPath":{}},"k:{\"mountPath\":\"/operator\"}":{".":{},"f:mountPath":{},"f:name":{}},"k:{\"mountPath\":\"/var/lib/rabbitmq/\"}":{".":{},"f:mountPath":{},"f:name":{}},"k:{\"mountPath\":\"/var/lib/rabbitmq/mnesia/\"}":{".":{},"f:mountPath":{},"f:name":{}}}}},"f:dnsPolicy":{},"f:initContainers":{".":{},"k:{\"name\":\"setup-container\"}":{".":{},"f:command":{},"f:image":{},"f:imagePullPolicy":{},"f:name":{},"f:resources":{".":{},"f:limits":{".":{},"f:cpu":{},"f:memory":{}},"f:requests":{".":{},"f:cpu":{},"f:memory":{}}},"f:securityContext":{".":{},"f:capabilities":{".":{},"f:drop":{}},"f:runAsUser":{}},"f:terminationMessagePath":{},"f:terminationMessagePolicy":{},"f:volumeMounts":{".":{},"k:{\"mountPath\":\"/operator\"}":{".":{},"f:mountPath":{},"f:name":{}},"k:{\"mountPath\":\"/tmp/default_user.conf\"}":{".":{},"f:mountPath":{},"f:name":{},"f:subPath":{}},"k:{\"mountPath\":\"/tmp/erlang-cookie-secret/\"}":{".":{},"f:mountPath":{},"f:name":{}},"k:{\"mountPath\":\"/tmp/rabbitmq-plugins/\"}":{".":{},"f:mountPath":{},"f:name":{}},"k:{\"mountPath\":\"/var/lib/rabbitmq/\"}":{".":{},"f:mountPath":{},"f:name":{}},"k:{\"mountPath\":\"/var/lib/rabbitmq/mnesia/\"}":{".":{},"f:mountPath":{},"f:name":{}}}}},"f:restartPolicy":{},"f:schedulerName":{},"f:securityContext":{".":{},"f:fsGroup":{},"f:runAsGroup":{},"f:runAsUser":{}},"f:serviceAccount":{},"f:serviceAccountName":{},"f:terminationGracePeriodSeconds":{},"f:topologySpreadConstraints":{".":{},"k:{\"topologyKey\":\"topology.kubernetes.io/zone\",\"whenUnsatisfiable\":\"ScheduleAnyway\"}":{".":{},"f:labelSelector":{".":{},"f:matchLabels":{".":{},"f:app.kubernetes.io/name":{}}},"f:maxSkew":{},"f:topologyKey":{},"f:whenUnsatisfiable":{}}},"f:volumes":{".":{},"k:{\"name\":\"erlang-cookie-secret\"}":{".":{},"f:name":{},"f:secret":{".":{},"f:defaultMode":{},"f:secretName":{}}},"k:{\"name\":\"plugins-conf\"}":{".":{},"f:configMap":{".":{},"f:defaultMode":{},"f:name":{}},"f:name":{}},"k:{\"name\":\"pod-info\"}":{".":{},"f:downwardAPI":{".":{},"f:defaultMode":{},"f:items":{}},"f:name":{}},"k:{\"name\":\"rabbitmq-confd\"}":{".":{},"f:name":{},"f:projected":{".":{},"f:defaultMode":{},"f:sources":{}}},"k:{\"name\":\"rabbitmq-erlang-cookie\"}":{".":{},"f:emptyDir":{},"f:name":{}},"k:{\"name\":\"rabbitmq-plugins\"}":{".":{},"f:emptyDir":{},"f:name":{}}}}},"f:updateStrategy":{"f:rollingUpdate":{".":{},"f:partition":{}},"f:type":{}},"f:volumeClaimTemplates":{}}}}]},"spec":{"replicas":1,"selector":{"matchLabels":{"app.kubernetes.io/name":"rabbitmq-cluster"}},"template":{"metadata":{"creationTimestamp":null,"labels":{"app.kubernetes.io/component":"rabbitmq","app.kubernetes.io/name":"rabbitmq-cluster","app.kubernetes.io/part-of":"rabbitmq"},"annotations":{"prometheus.io/port":"15692","prometheus.io/scrape":"true"}},"spec":{"volumes":[{"name":"plugins-conf","configMap":{"name":"rabbitmq-cluster-plugins-conf","defaultMode":420}},{"name":"rabbitmq-confd","projected":{"sources":[{"secret":{"name":"rabbitmq-cluster-default-user","items":[{"key":"default_user.conf","path":"default_user.conf"}]}},{"configMap":{"name":"rabbitmq-cluster-server-conf","items":[{"key":"operatorDefaults.conf","path":"operatorDefaults.conf"},{"key":"userDefinedConfiguration.conf","path":"userDefinedConfiguration.conf"}]}}],"defaultMode":420}},{"name":"rabbitmq-erlang-cookie","emptyDir":{}},{"name":"erlang-cookie-secret","secret":{"secretName":"rabbitmq-cluster-erlang-cookie","defaultMode":420}},{"name":"rabbitmq-plugins","emptyDir":{}},{"name":"pod-info","downwardAPI":{"items":[{"path":"skipPreStopChecks","fieldRef":{"apiVersion":"v1","fieldPath":"metadata.labels['skipPreStopChecks']"}}],"defaultMode":420}}],"initContainers":[{"name":"setup-container","image":"rabbitmq:3.8.12-management","command":["sh","-c","cp /tmp/erlang-cookie-secret/.erlang.cookie /var/lib/rabbitmq/.erlang.cookie \u0026\u0026 chown 999:999 /var/lib/rabbitmq/.erlang.cookie \u0026\u0026 chmod 600 /var/lib/rabbitmq/.erlang.cookie ; cp /tmp/rabbitmq-plugins/enabled_plugins /operator/enabled_plugins \u0026\u0026 chown 999:999 /operator/enabled_plugins ; chown 999:999 /var/lib/rabbitmq/mnesia/ ; echo '[default]' \u003e /var/lib/rabbitmq/.rabbitmqadmin.conf \u0026\u0026 sed -e 's/default_user/username/' -e 's/default_pass/password/' /tmp/default_user.conf \u003e\u003e /var/lib/rabbitmq/.rabbitmqadmin.conf \u0026\u0026 chown 999:999 /var/lib/rabbitmq/.rabbitmqadmin.conf \u0026\u0026 chmod 600 /var/lib/rabbitmq/.rabbitmqadmin.conf"],"resources":{"limits":{"cpu":"100m","memory":"500Mi"},"requests":{"cpu":"100m","memory":"500Mi"}},"volumeMounts":[{"name":"plugins-conf","mountPath":"/tmp/rabbitmq-plugins/"},{"name":"rabbitmq-erlang-cookie","mountPath":"/var/lib/rabbitmq/"},{"name":"erlang-cookie-secret","mountPath":"/tmp/erlang-cookie-secret/"},{"name":"rabbitmq-plugins","mountPath":"/operator"},{"name":"persistence","mountPath":"/var/lib/rabbitmq/mnesia/"},{"name":"rabbitmq-confd","mountPath":"/tmp/default_user.conf","subPath":"default_user.conf"}],"terminationMessagePath":"/dev/termination-log","terminationMessagePolicy":"File","imagePullPolicy":"IfNotPresent","securityContext":{"capabilities":{"drop":["FSETID","KILL","SETGID","SETUID","SETPCAP","NET_BIND_SERVICE","NET_RAW","SYS_CHROOT","MKNOD","AUDIT_WRITE","SETFCAP"]},"runAsUser":0}}],"containers":[{"name":"rabbitmq","image":"rabbitmq:3.8.12-management","ports":[{"name":"epmd","containerPort":4369,"protocol":"TCP"},{"name":"amqp","containerPort":5672,"protocol":"TCP"},{"name":"management","containerPort":15672,"protocol":"TCP"},{"name":"prometheus","containerPort":15692,"protocol":"TCP"}],"env":[{"name":"MY_POD_NAME","valueFrom":{"fieldRef":{"apiVersion":"v1","fieldPath":"metadata.name"}}},{"name":"MY_POD_NAMESPACE","valueFrom":{"fieldRef":{"apiVersion":"v1","fieldPath":"metadata.namespace"}}},{"name":"RABBITMQ_ENABLED_PLUGINS_FILE","value":"/operator/enabled_plugins"},{"name":"K8S_SERVICE_NAME","value":"rabbitmq-cluster-nodes"},{"name":"RABBITMQ_USE_LONGNAME","value":"true"},{"name":"RABBITMQ_NODENAME","value":"rabbit@$(MY_POD_NAME).$(K8S_SERVICE_NAME).$(MY_POD_NAMESPACE)"},{"name":"K8S_HOSTNAME_SUFFIX","value":".$(K8S_SERVICE_NAME).$(MY_POD_NAMESPACE)"}],"resources":{"limits":{"cpu":"2","memory":"2Gi"},"requests":{"cpu":"1","memory":"2Gi"}},"volumeMounts":[{"name":"rabbitmq-erlang-cookie","mountPath":"/var/lib/rabbitmq/"},{"name":"persistence","mountPath":"/var/lib/rabbitmq/mnesia/"},{"name":"rabbitmq-plugins","mountPath":"/operator"},{"name":"rabbitmq-confd","mountPath":"/etc/rabbitmq/conf.d/10-operatorDefaults.conf","subPath":"operatorDefaults.conf"},{"name":"rabbitmq-confd","mountPath":"/etc/rabbitmq/conf.d/11-default_user.conf","subPath":"default_user.conf"},{"name":"rabbitmq-confd","mountPath":"/etc/rabbitmq/conf.d/90-userDefinedConfiguration.conf","subPath":"userDefinedConfiguration.conf"},{"name":"pod-info","mountPath":"/etc/pod-info/"}],"readinessProbe":{"tcpSocket":{"port":"amqp"},"initialDelaySeconds":10,"timeoutSeconds":5,"periodSeconds":10,"successThreshold":1,"failureThreshold":3},"lifecycle":{"preStop":{"exec":{"command":["/bin/bash","-c","if [ ! -z \"$(cat /etc/pod-info/skipPreStopChecks)\" ]; then exit 0; fi; rabbitmq-upgrade await_online_quorum_plus_one -t 604800; rabbitmq-upgrade await_online_synchronized_mirror -t 604800; rabbitmq-upgrade drain -t 604800"]}}},"terminationMessagePath":"/dev/termination-log","terminationMessagePolicy":"File","imagePullPolicy":"IfNotPresent"}],"restartPolicy":"Always","terminationGracePeriodSeconds":604800,"dnsPolicy":"ClusterFirst","serviceAccountName":"rabbitmq-cluster-server","serviceAccount":"rabbitmq-cluster-server","automountServiceAccountToken":true,"securityContext":{"runAsUser":999,"runAsGroup":999,"fsGroup":999},"schedulerName":"default-scheduler","topologySpreadConstraints":[{"maxSkew":1,"topologyKey":"topology.kubernetes.io/zone","whenUnsatisfiable":"ScheduleAnyway","labelSelector":{"matchLabels":{"app.kubernetes.io/name":"rabbitmq-cluster"}}}]}},"volumeClaimTemplates":[{"metadata":{"name":"persistence","namespace":"default","creationTimestamp":null,"labels":{"app.kubernetes.io/component":"rabbitmq","app.kubernetes.io/name":"rabbitmq-cluster","app.kubernetes.io/part-of":"rabbitmq"},"ownerReferences":[{"apiVersion":"rabbitmq.com/v1beta1","kind":"RabbitmqCluster","name":"rabbitmq-cluster","uid":"18d9928b-0d1c-47be-80ec-20960d053827","controller":true,"blockOwnerDeletion":false}]},"spec":{"accessModes":["ReadWriteOnce"],"resources":{"requests":{"storage":"10Gi"}},"volumeMode":"Filesystem"},"status":{"phase":"Pending"}}],"serviceName":"rabbitmq-cluster-nodes","podManagementPolicy":"Parallel","updateStrategy":{"type":"RollingUpdate","rollingUpdate":{"partition":0}},"revisionHistoryLimit":10},"status":{"observedGeneration":1,"replicas":1,"currentReplicas":1,"updatedReplicas":1,"currentRevision":"rabbitmq-cluster-server-5f8b8665fb","updateRevision":"rabbitmq-cluster-server-5f8b8665fb","collisionCount":0}}
2022/03/18 18:00:53 learn_server.go:291: [SIEVE-AFTER-READ]	Get	true	endpoints	default	rabbitmq-cluster	github.com/rabbitmq/cluster-operator/controllers.(*RabbitmqClusterReconciler)	NoError	{"kind":"Endpoints","apiVersion":"v1","metadata":{"name":"rabbitmq-cluster","namespace":"default","selfLink":"/api/v1/namespaces/default/endpoints/rabbitmq-cluster","uid":"5c4723ad-f4fe-442d-9135-44879a2a8183","resourceVersion":"802","creationTimestamp":"2022-03-18T18:00:38Z","labels":{"app.kubernetes.io/component":"rabbitmq","app.kubernetes.io/name":"rabbitmq-cluster","app.kubernetes.io/part-of":"rabbitmq"},"annotations":{"endpoints.kubernetes.io/last-change-trigger-time":"2022-03-18T18:00:41Z"},"managedFields":[{"manager":"kube-controller-manager","operation":"Update","apiVersion":"v1","time":"2022-03-18T18:00:46Z","fieldsType":"FieldsV1","fieldsV1":{"f:metadata":{"f:annotations":{".":{},"f:endpoints.kubernetes.io/last-change-trigger-time":{}},"f:labels":{".":{},"f:app.kubernetes.io/component":{},"f:app.kubernetes.io/name":{},"f:app.kubernetes.io/part-of":{}}},"f:subsets":{}}}]},"subsets":[{"notReadyAddresses":[{"ip":"10.244.1.4","nodeName":"kind-worker2","targetRef":{"kind":"Pod","namespace":"default","name":"rabbitmq-cluster-server-0","uid":"e7faffc5-b656-4e69-9777-92d12cb6ec5a","resourceVersion":"798"}}],"ports":[{"name":"amqp","port":5672,"protocol":"TCP"},{"name":"management","port":15672,"protocol":"TCP"}]}]}
2022/03/18 18:00:53 learn_server.go:291: [SIEVE-AFTER-READ]	Get	true	statefulset	default	rabbitmq-cluster-server	github.com/rabbitmq/cluster-operator/controllers.(*RabbitmqClusterReconciler)	NoError	{"kind":"StatefulSet","apiVersion":"apps/v1","metadata":{"name":"rabbitmq-cluster-server","namespace":"default","selfLink":"/apis/apps/v1/namespaces/default/statefulsets/rabbitmq-cluster-server","uid":"cb5c43bc-6ee7-481c-ab01-6f3acffdd3c8","resourceVersion":"744","generation":1,"creationTimestamp":"2022-03-18T18:00:38Z","labels":{"app.kubernetes.io/component":"rabbitmq","app.kubernetes.io/name":"rabbitmq-cluster","app.kubernetes.io/part-of":"rabbitmq"},"annotations":{"rabbitmq.com/createdAt":"2022-03-18T18:00:38Z"},"ownerReferences":[{"apiVersion":"rabbitmq.com/v1beta1","kind":"RabbitmqCluster","name":"rabbitmq-cluster","uid":"18d9928b-0d1c-47be-80ec-20960d053827","controller":true,"blockOwnerDeletion":true}],"managedFields":[{"manager":"kube-controller-manager","operation":"Update","apiVersion":"apps/v1","time":"2022-03-18T18:00:38Z","fieldsType":"FieldsV1","fieldsV1":{"f:status":{"f:collisionCount":{},"f:currentReplicas":{},"f:currentRevision":{},"f:observedGeneration":{},"f:replicas":{},"f:updateRevision":{},"f:updatedReplicas":{}}}},{"manager":"manager","operation":"Update","apiVersion":"apps/v1","time":"2022-03-18T18:00:38Z","fieldsType":"FieldsV1","fieldsV1":{"f:metadata":{"f:annotations":{".":{},"f:rabbitmq.com/createdAt":{}},"f:labels":{".":{},"f:app.kubernetes.io/component":{},"f:app.kubernetes.io/name":{},"f:app.kubernetes.io/part-of":{}},"f:ownerReferences":{".":{},"k:{\"uid\":\"18d9928b-0d1c-47be-80ec-20960d053827\"}":{".":{},"f:apiVersion":{},"f:blockOwnerDeletion":{},"f:controller":{},"f:kind":{},"f:name":{},"f:uid":{}}}},"f:spec":{"f:podManagementPolicy":{},"f:replicas":{},"f:revisionHistoryLimit":{},"f:selector":{"f:matchLabels":{".":{},"f:app.kubernetes.io/name":{}}},"f:serviceName":{},"f:template":{"f:metadata":{"f:annotations":{".":{},"f:prometheus.io/port":{},"f:prometheus.io/scrape":{}},"f:labels":{".":{},"f:app.kubernetes.io/component":{},"f:app.kubernetes.io/name":{},"f:app.kubernetes.io/part-of":{}}},"f:spec":{"f:automountServiceAccountToken":{},"f:containers":{"k:{\"name\":\"rabbitmq\"}":{".":{},"f:env":{".":{},"k:{\"name\":\"K8S_HOSTNAME_SUFFIX\"}":{".":{},"f:name":{},"f:value":{}},"k:{\"name\":\"K8S_SERVICE_NAME\"}":{".":{},"f:name":{},"f:value":{}},"k:{\"name\":\"MY_POD_NAME\"}":{".":{},"f:name":{},"f:valueFrom":{".":{},"f:fieldRef":{".":{},"f:apiVersion":{},"f:fieldPath":{}}}},"k:{\"name\":\"MY_POD_NAMESPACE\"}":{".":{},"f:name":{},"f:valueFrom":{".":{},"f:fieldRef":{".":{},"f:apiVersion":{},"f:fieldPath":{}}}},"k:{\"name\":\"RABBITMQ_ENABLED_PLUGINS_FILE\"}":{".":{},"f:name":{},"f:value":{}},"k:{\"name\":\"RABBITMQ_NODENAME\"}":{".":{},"f:name":{},"f:value":{}},"k:{\"name\":\"RABBITMQ_USE_LONGNAME\"}":{".":{},"f:name":{},"f:value":{}}},"f:image":{},"f:imagePullPolicy":{},"f:lifecycle":{".":{},"f:preStop":{".":{},"f:exec":{".":{},"f:command":{}}}},"f:name":{},"f:ports":{".":{},"k:{\"containerPort\":4369,\"protocol\":\"TCP\"}":{".":{},"f:containerPort":{},"f:name":{},"f:protocol":{}},"k:{\"containerPort\":5672,\"protocol\":\"TCP\"}":{".":{},"f:containerPort":{},"f:name":{},"f:protocol":{}},"k:{\"containerPort\":15672,\"protocol\":\"TCP\"}":{".":{},"f:containerPort":{},"f:name":{},"f:protocol":{}},"k:{\"containerPort\":15692,\"protocol\":\"TCP\"}":{".":{},"f:containerPort":{},"f:name":{},"f:protocol":{}}},"f:readinessProbe":{".":{},"f:failureThreshold":{},"f:initialDelaySeconds":{},"f:periodSeconds":{},"f:successThreshold":{},"f:tcpSocket":{".":{},"f:port":{}},"f:timeoutSeconds":{}},"f:resources":{".":{},"f:limits":{".":{},"f:cpu":{},"f:memory":{}},"f:requests":{".":{},"f:cpu":{},"f:memory":{}}},"f:terminationMessagePath":{},"f:terminationMessagePolicy":{},"f:volumeMounts":{".":{},"k:{\"mountPath\":\"/etc/pod-info/\"}":{".":{},"f:mountPath":{},"f:name":{}},"k:{\"mountPath\":\"/etc/rabbitmq/conf.d/10-operatorDefaults.conf\"}":{".":{},"f:mountPath":{},"f:name":{},"f:subPath":{}},"k:{\"mountPath\":\"/etc/rabbitmq/conf.d/11-default_user.conf\"}":{".":{},"f:mountPath":{},"f:name":{},"f:subPath":{}},"k:{\"mountPath\":\"/etc/rabbitmq/conf.d/90-userDefinedConfiguration.conf\"}":{".":{},"f:mountPath":{},"f:name":{},"f:subPath":{}},"k:{\"mountPath\":\"/operator\"}":{".":{},"f:mountPath":{},"f:name":{}},"k:{\"mountPath\":\"/var/lib/rabbitmq/\"}":{".":{},"f:mountPath":{},"f:name":{}},"k:{\"mountPath\":\"/var/lib/rabbitmq/mnesia/\"}":{".":{},"f:mountPath":{},"f:name":{}}}}},"f:dnsPolicy":{},"f:initContainers":{".":{},"k:{\"name\":\"setup-container\"}":{".":{},"f:command":{},"f:image":{},"f:imagePullPolicy":{},"f:name":{},"f:resources":{".":{},"f:limits":{".":{},"f:cpu":{},"f:memory":{}},"f:requests":{".":{},"f:cpu":{},"f:memory":{}}},"f:securityContext":{".":{},"f:capabilities":{".":{},"f:drop":{}},"f:runAsUser":{}},"f:terminationMessagePath":{},"f:terminationMessagePolicy":{},"f:volumeMounts":{".":{},"k:{\"mountPath\":\"/operator\"}":{".":{},"f:mountPath":{},"f:name":{}},"k:{\"mountPath\":\"/tmp/default_user.conf\"}":{".":{},"f:mountPath":{},"f:name":{},"f:subPath":{}},"k:{\"mountPath\":\"/tmp/erlang-cookie-secret/\"}":{".":{},"f:mountPath":{},"f:name":{}},"k:{\"mountPath\":\"/tmp/rabbitmq-plugins/\"}":{".":{},"f:mountPath":{},"f:name":{}},"k:{\"mountPath\":\"/var/lib/rabbitmq/\"}":{".":{},"f:mountPath":{},"f:name":{}},"k:{\"mountPath\":\"/var/lib/rabbitmq/mnesia/\"}":{".":{},"f:mountPath":{},"f:name":{}}}}},"f:restartPolicy":{},"f:schedulerName":{},"f:securityContext":{".":{},"f:fsGroup":{},"f:runAsGroup":{},"f:runAsUser":{}},"f:serviceAccount":{},"f:serviceAccountName":{},"f:terminationGracePeriodSeconds":{},"f:topologySpreadConstraints":{".":{},"k:{\"topologyKey\":\"topology.kubernetes.io/zone\",\"whenUnsatisfiable\":\"ScheduleAnyway\"}":{".":{},"f:labelSelector":{".":{},"f:matchLabels":{".":{},"f:app.kubernetes.io/name":{}}},"f:maxSkew":{},"f:topologyKey":{},"f:whenUnsatisfiable":{}}},"f:volumes":{".":{},"k:{\"name\":\"erlang-cookie-secret\"}":{".":{},"f:name":{},"f:secret":{".":{},"f:defaultMode":{},"f:secretName":{}}},"k:{\"name\":\"plugins-conf\"}":{".":{},"f:configMap":{".":{},"f:defaultMode":{},"f:name":{}},"f:name":{}},"k:{\"name\":\"pod-info\"}":{".":{},"f:downwardAPI":{".":{},"f:defaultMode":{},"f:items":{}},"f:name":{}},"k:{\"name\":\"rabbitmq-confd\"}":{".":{},"f:name":{},"f:projected":{".":{},"f:defaultMode":{},"f:sources":{}}},"k:{\"name\":\"rabbitmq-erlang-cookie\"}":{".":{},"f:emptyDir":{},"f:name":{}},"k:{\"name\":\"rabbitmq-plugins\"}":{".":{},"f:emptyDir":{},"f:name":{}}}}},"f:updateStrategy":{"f:rollingUpdate":{".":{},"f:partition":{}},"f:type":{}},"f:volumeClaimTemplates":{}}}}]},"spec":{"replicas":1,"selector":{"matchLabels":{"app.kubernetes.io/name":"rabbitmq-cluster"}},"template":{"metadata":{"creationTimestamp":null,"labels":{"app.kubernetes.io/component":"rabbitmq","app.kubernetes.io/name":"rabbitmq-cluster","app.kubernetes.io/part-of":"rabbitmq"},"annotations":{"prometheus.io/port":"15692","prometheus.io/scrape":"true"}},"spec":{"volumes":[{"name":"plugins-conf","configMap":{"name":"rabbitmq-cluster-plugins-conf","defaultMode":420}},{"name":"rabbitmq-confd","projected":{"sources":[{"secret":{"name":"rabbitmq-cluster-default-user","items":[{"key":"default_user.conf","path":"default_user.conf"}]}},{"configMap":{"name":"rabbitmq-cluster-server-conf","items":[{"key":"operatorDefaults.conf","path":"operatorDefaults.conf"},{"key":"userDefinedConfiguration.conf","path":"userDefinedConfiguration.conf"}]}}],"defaultMode":420}},{"name":"rabbitmq-erlang-cookie","emptyDir":{}},{"name":"erlang-cookie-secret","secret":{"secretName":"rabbitmq-cluster-erlang-cookie","defaultMode":420}},{"name":"rabbitmq-plugins","emptyDir":{}},{"name":"pod-info","downwardAPI":{"items":[{"path":"skipPreStopChecks","fieldRef":{"apiVersion":"v1","fieldPath":"metadata.labels['skipPreStopChecks']"}}],"defaultMode":420}}],"initContainers":[{"name":"setup-container","image":"rabbitmq:3.8.12-management","command":["sh","-c","cp /tmp/erlang-cookie-secret/.erlang.cookie /var/lib/rabbitmq/.erlang.cookie \u0026\u0026 chown 999:999 /var/lib/rabbitmq/.erlang.cookie \u0026\u0026 chmod 600 /var/lib/rabbitmq/.erlang.cookie ; cp /tmp/rabbitmq-plugins/enabled_plugins /operator/enabled_plugins \u0026\u0026 chown 999:999 /operator/enabled_plugins ; chown 999:999 /var/lib/rabbitmq/mnesia/ ; echo '[default]' \u003e /var/lib/rabbitmq/.rabbitmqadmin.conf \u0026\u0026 sed -e 's/default_user/username/' -e 's/default_pass/password/' /tmp/default_user.conf \u003e\u003e /var/lib/rabbitmq/.rabbitmqadmin.conf \u0026\u0026 chown 999:999 /var/lib/rabbitmq/.rabbitmqadmin.conf \u0026\u0026 chmod 600 /var/lib/rabbitmq/.rabbitmqadmin.conf"],"resources":{"limits":{"cpu":"100m","memory":"500Mi"},"requests":{"cpu":"100m","memory":"500Mi"}},"volumeMounts":[{"name":"plugins-conf","mountPath":"/tmp/rabbitmq-plugins/"},{"name":"rabbitmq-erlang-cookie","mountPath":"/var/lib/rabbitmq/"},{"name":"erlang-cookie-secret","mountPath":"/tmp/erlang-cookie-secret/"},{"name":"rabbitmq-plugins","mountPath":"/operator"},{"name":"persistence","mountPath":"/var/lib/rabbitmq/mnesia/"},{"name":"rabbitmq-confd","mountPath":"/tmp/default_user.conf","subPath":"default_user.conf"}],"terminationMessagePath":"/dev/termination-log","terminationMessagePolicy":"File","imagePullPolicy":"IfNotPresent","securityContext":{"capabilities":{"drop":["FSETID","KILL","SETGID","SETUID","SETPCAP","NET_BIND_SERVICE","NET_RAW","SYS_CHROOT","MKNOD","AUDIT_WRITE","SETFCAP"]},"runAsUser":0}}],"containers":[{"name":"rabbitmq","image":"rabbitmq:3.8.12-management","ports":[{"name":"epmd","containerPort":4369,"protocol":"TCP"},{"name":"amqp","containerPort":5672,"protocol":"TCP"},{"name":"management","containerPort":15672,"protocol":"TCP"},{"name":"prometheus","containerPort":15692,"protocol":"TCP"}],"env":[{"name":"MY_POD_NAME","valueFrom":{"fieldRef":{"apiVersion":"v1","fieldPath":"metadata.name"}}},{"name":"MY_POD_NAMESPACE","valueFrom":{"fieldRef":{"apiVersion":"v1","fieldPath":"metadata.namespace"}}},{"name":"RABBITMQ_ENABLED_PLUGINS_FILE","value":"/operator/enabled_plugins"},{"name":"K8S_SERVICE_NAME","value":"rabbitmq-cluster-nodes"},{"name":"RABBITMQ_USE_LONGNAME","value":"true"},{"name":"RABBITMQ_NODENAME","value":"rabbit@$(MY_POD_NAME).$(K8S_SERVICE_NAME).$(MY_POD_NAMESPACE)"},{"name":"K8S_HOSTNAME_SUFFIX","value":".$(K8S_SERVICE_NAME).$(MY_POD_NAMESPACE)"}],"resources":{"limits":{"cpu":"2","memory":"2Gi"},"requests":{"cpu":"1","memory":"2Gi"}},"volumeMounts":[{"name":"rabbitmq-erlang-cookie","mountPath":"/var/lib/rabbitmq/"},{"name":"persistence","mountPath":"/var/lib/rabbitmq/mnesia/"},{"name":"rabbitmq-plugins","mountPath":"/operator"},{"name":"rabbitmq-confd","mountPath":"/etc/rabbitmq/conf.d/10-operatorDefaults.conf","subPath":"operatorDefaults.conf"},{"name":"rabbitmq-confd","mountPath":"/etc/rabbitmq/conf.d/11-default_user.conf","subPath":"default_user.conf"},{"name":"rabbitmq-confd","mountPath":"/etc/rabbitmq/conf.d/90-userDefinedConfiguration.conf","subPath":"userDefinedConfiguration.conf"},{"name":"pod-info","mountPath":"/etc/pod-info/"}],"readinessProbe":{"tcpSocket":{"port":"amqp"},"initialDelaySeconds":10,"timeoutSeconds":5,"periodSeconds":10,"successThreshold":1,"failureThreshold":3},"lifecycle":{"preStop":{"exec":{"command":["/bin/bash","-c","if [ ! -z \"$(cat /etc/pod-info/skipPreStopChecks)\" ]; then exit 0; fi; rabbitmq-upgrade await_online_quorum_plus_one -t 604800; rabbitmq-upgrade await_online_synchronized_mirror -t 604800; rabbitmq-upgrade drain -t 604800"]}}},"terminationMessagePath":"/dev/termination-log","terminationMessagePolicy":"File","imagePullPolicy":"IfNotPresent"}],"restartPolicy":"Always","terminationGracePeriodSeconds":604800,"dnsPolicy":"ClusterFirst","serviceAccountName":"rabbitmq-cluster-server","serviceAccount":"rabbitmq-cluster-server","automountServiceAccountToken":true,"securityContext":{"runAsUser":999,"runAsGroup":999,"fsGroup":999},"schedulerName":"default-scheduler","topologySpreadConstraints":[{"maxSkew":1,"topologyKey":"topology.kubernetes.io/zone","whenUnsatisfiable":"ScheduleAnyway","labelSelector":{"matchLabels":{"app.kubernetes.io/name":"rabbitmq-cluster"}}}]}},"volumeClaimTemplates":[{"metadata":{"name":"persistence","namespace":"default","creationTimestamp":null,"labels":{"app.kubernetes.io/component":"rabbitmq","app.kubernetes.io/name":"rabbitmq-cluster","app.kubernetes.io/part-of":"rabbitmq"},"ownerReferences":[{"apiVersion":"rabbitmq.com/v1beta1","kind":"RabbitmqCluster","name":"rabbitmq-cluster","uid":"18d9928b-0d1c-47be-80ec-20960d053827","controller":true,"blockOwnerDeletion":false}]},"spec":{"accessModes":["ReadWriteOnce"],"resources":{"requests":{"storage":"10Gi"}},"volumeMode":"Filesystem"},"status":{"phase":"Pending"}}],"serviceName":"rabbitmq-cluster-nodes","podManagementPolicy":"Parallel","updateStrategy":{"type":"RollingUpdate","rollingUpdate":{"partition":0}},"revisionHistoryLimit":10},"status":{"observedGeneration":1,"replicas":1,"currentReplicas":1,"updatedReplicas":1,"currentRevision":"rabbitmq-cluster-server-5f8b8665fb","updateRevision":"rabbitmq-cluster-server-5f8b8665fb","collisionCount":0}}
2022/03/18 18:00:53 learn_server.go:291: [SIEVE-AFTER-READ]	Get	true	service	default	rabbitmq-cluster-nodes	github.com/rabbitmq/cluster-operator/controllers.(*RabbitmqClusterReconciler)	NoError	{"kind":"Service","apiVersion":"v1","metadata":{"name":"rabbitmq-cluster-nodes","namespace":"default","selfLink":"/api/v1/namespaces/default/services/rabbitmq-cluster-nodes","uid":"67c7eea9-1b87-4fd7-82e6-5bfe31fd1b52","resourceVersion":"696","creationTimestamp":"2022-03-18T18:00:38Z","labels":{"app.kubernetes.io/component":"rabbitmq","app.kubernetes.io/name":"rabbitmq-cluster","app.kubernetes.io/part-of":"rabbitmq"},"ownerReferences":[{"apiVersion":"rabbitmq.com/v1beta1","kind":"RabbitmqCluster","name":"rabbitmq-cluster","uid":"18d9928b-0d1c-47be-80ec-20960d053827","controller":true,"blockOwnerDeletion":true}],"managedFields":[{"manager":"manager","operation":"Update","apiVersion":"v1","time":"2022-03-18T18:00:38Z","fieldsType":"FieldsV1","fieldsV1":{"f:metadata":{"f:labels":{".":{},"f:app.kubernetes.io/component":{},"f:app.kubernetes.io/name":{},"f:app.kubernetes.io/part-of":{}},"f:ownerReferences":{".":{},"k:{\"uid\":\"18d9928b-0d1c-47be-80ec-20960d053827\"}":{".":{},"f:apiVersion":{},"f:blockOwnerDeletion":{},"f:controller":{},"f:kind":{},"f:name":{},"f:uid":{}}}},"f:spec":{"f:clusterIP":{},"f:ports":{".":{},"k:{\"port\":4369,\"protocol\":\"TCP\"}":{".":{},"f:name":{},"f:port":{},"f:protocol":{},"f:targetPort":{}},"k:{\"port\":25672,\"protocol\":\"TCP\"}":{".":{},"f:name":{},"f:port":{},"f:protocol":{},"f:targetPort":{}}},"f:publishNotReadyAddresses":{},"f:selector":{".":{},"f:app.kubernetes.io/name":{}},"f:sessionAffinity":{},"f:type":{}}}}]},"spec":{"ports":[{"name":"epmd","protocol":"TCP","port":4369,"targetPort":4369},{"name":"cluster-rpc","protocol":"TCP","port":25672,"targetPort":25672}],"selector":{"app.kubernetes.io/name":"rabbitmq-cluster"},"clusterIP":"None","type":"ClusterIP","sessionAffinity":"None","publishNotReadyAddresses":true},"status":{"loadBalancer":{}}}
2022/03/18 18:00:53 learn_server.go:291: [SIEVE-AFTER-READ]	Get	true	service	default	rabbitmq-cluster	github.com/rabbitmq/cluster-operator/controllers.(*RabbitmqClusterReconciler)	NoError	{"kind":"Service","apiVersion":"v1","metadata":{"name":"rabbitmq-cluster","namespace":"default","selfLink":"/api/v1/namespaces/default/services/rabbitmq-cluster","uid":"56b50671-1945-458b-adac-05619b783392","resourceVersion":"701","creationTimestamp":"2022-03-18T18:00:38Z","labels":{"app.kubernetes.io/component":"rabbitmq","app.kubernetes.io/name":"rabbitmq-cluster","app.kubernetes.io/part-of":"rabbitmq"},"ownerReferences":[{"apiVersion":"rabbitmq.com/v1beta1","kind":"RabbitmqCluster","name":"rabbitmq-cluster","uid":"18d9928b-0d1c-47be-80ec-20960d053827","controller":true,"blockOwnerDeletion":true}],"managedFields":[{"manager":"manager","operation":"Update","apiVersion":"v1","time":"2022-03-18T18:00:38Z","fieldsType":"FieldsV1","fieldsV1":{"f:metadata":{"f:labels":{".":{},"f:app.kubernetes.io/component":{},"f:app.kubernetes.io/name":{},"f:app.kubernetes.io/part-of":{}},"f:ownerReferences":{".":{},"k:{\"uid\":\"18d9928b-0d1c-47be-80ec-20960d053827\"}":{".":{},"f:apiVersion":{},"f:blockOwnerDeletion":{},"f:controller":{},"f:kind":{},"f:name":{},"f:uid":{}}}},"f:spec":{"f:ports":{".":{},"k:{\"port\":5672,\"protocol\":\"TCP\"}":{".":{},"f:name":{},"f:port":{},"f:protocol":{},"f:targetPort":{}},"k:{\"port\":15672,\"protocol\":\"TCP\"}":{".":{},"f:name":{},"f:port":{},"f:protocol":{},"f:targetPort":{}}},"f:selector":{".":{},"f:app.kubernetes.io/name":{}},"f:sessionAffinity":{},"f:type":{}}}}]},"spec":{"ports":[{"name":"amqp","protocol":"TCP","port":5672,"targetPort":5672},{"name":"management","protocol":"TCP","port":15672,"targetPort":15672}],"selector":{"app.kubernetes.io/name":"rabbitmq-cluster"},"clusterIP":"10.96.254.158","type":"ClusterIP","sessionAffinity":"None"},"status":{"loadBalancer":{}}}
2022/03/18 18:00:53 learn_server.go:291: [SIEVE-AFTER-READ]	Get	true	secret	default	rabbitmq-cluster-erlang-cookie	github.com/rabbitmq/cluster-operator/controllers.(*RabbitmqClusterReconciler)	NoError	{"kind":"Secret","apiVersion":"v1","metadata":{"name":"rabbitmq-cluster-erlang-cookie","namespace":"default","selfLink":"/api/v1/namespaces/default/secrets/rabbitmq-cluster-erlang-cookie","uid":"f8fbe8a6-0f40-4e13-960b-ab78b8ba75b0","resourceVersion":"705","creationTimestamp":"2022-03-18T18:00:38Z","labels":{"app.kubernetes.io/component":"rabbitmq","app.kubernetes.io/name":"rabbitmq-cluster","app.kubernetes.io/part-of":"rabbitmq"},"ownerReferences":[{"apiVersion":"rabbitmq.com/v1beta1","kind":"RabbitmqCluster","name":"rabbitmq-cluster","uid":"18d9928b-0d1c-47be-80ec-20960d053827","controller":true,"blockOwnerDeletion":true}],"managedFields":[{"manager":"manager","operation":"Update","apiVersion":"v1","time":"2022-03-18T18:00:38Z","fieldsType":"FieldsV1","fieldsV1":{"f:data":{".":{},"f:.erlang.cookie":{}},"f:metadata":{"f:labels":{".":{},"f:app.kubernetes.io/component":{},"f:app.kubernetes.io/name":{},"f:app.kubernetes.io/part-of":{}},"f:ownerReferences":{".":{},"k:{\"uid\":\"18d9928b-0d1c-47be-80ec-20960d053827\"}":{".":{},"f:apiVersion":{},"f:blockOwnerDeletion":{},"f:controller":{},"f:kind":{},"f:name":{},"f:uid":{}}}},"f:type":{}}}]},"data":{".erlang.cookie":"QW9hMkpWU0tlYS1FUGdWTUhrelNMNnFoMFZ0ZmRGNUY="},"type":"Opaque"}
2022/03/18 18:00:53 learn_server.go:291: [SIEVE-AFTER-READ]	Get	true	secret	default	rabbitmq-cluster-default-user	github.com/rabbitmq/cluster-operator/controllers.(*RabbitmqClusterReconciler)	NoError	{"kind":"Secret","apiVersion":"v1","metadata":{"name":"rabbitmq-cluster-default-user","namespace":"default","selfLink":"/api/v1/namespaces/default/secrets/rabbitmq-cluster-default-user","uid":"0d9f460b-a23c-402b-8273-f541ed39023f","resourceVersion":"708","creationTimestamp":"2022-03-18T18:00:38Z","labels":{"app.kubernetes.io/component":"rabbitmq","app.kubernetes.io/name":"rabbitmq-cluster","app.kubernetes.io/part-of":"rabbitmq"},"ownerReferences":[{"apiVersion":"rabbitmq.com/v1beta1","kind":"RabbitmqCluster","name":"rabbitmq-cluster","uid":"18d9928b-0d1c-47be-80ec-20960d053827","controller":true,"blockOwnerDeletion":true}],"managedFields":[{"manager":"manager","operation":"Update","apiVersion":"v1","time":"2022-03-18T18:00:38Z","fieldsType":"FieldsV1","fieldsV1":{"f:data":{".":{},"f:default_user.conf":{},"f:password":{},"f:provider":{},"f:type":{},"f:username":{}},"f:metadata":{"f:labels":{".":{},"f:app.kubernetes.io/component":{},"f:app.kubernetes.io/name":{},"f:app.kubernetes.io/part-of":{}},"f:ownerReferences":{".":{},"k:{\"uid\":\"18d9928b-0d1c-47be-80ec-20960d053827\"}":{".":{},"f:apiVersion":{},"f:blockOwnerDeletion":{},"f:controller":{},"f:kind":{},"f:name":{},"f:uid":{}}}},"f:type":{}}}]},"data":{"default_user.conf":"ZGVmYXVsdF91c2VyID0gcTMxRmh3MGtjWW9SZUl5X3BPTXp2ZVBOUnNVU3I1Mk8KZGVmYXVsdF9wYXNzID0gY0dBX19jNTJHX05hVURpTGhraWZ6UDBOVVlNLTE2MWQK","password":"Y0dBX19jNTJHX05hVURpTGhraWZ6UDBOVVlNLTE2MWQ=","provider":"cmFiYml0bXE=","type":"cmFiYml0bXE=","username":"cTMxRmh3MGtjWW9SZUl5X3BPTXp2ZVBOUnNVU3I1Mk8="},"type":"Opaque"}
2022/03/18 18:00:53 learn_server.go:291: [SIEVE-AFTER-READ]	Get	true	configmap	default	rabbitmq-cluster-plugins-conf	github.com/rabbitmq/cluster-operator/controllers.(*RabbitmqClusterReconciler)	NoError	{"kind":"ConfigMap","apiVersion":"v1","metadata":{"name":"rabbitmq-cluster-plugins-conf","namespace":"default","selfLink":"/api/v1/namespaces/default/configmaps/rabbitmq-cluster-plugins-conf","uid":"a164075b-0562-47ac-a577-99aa8651ec40","resourceVersion":"709","creationTimestamp":"2022-03-18T18:00:38Z","labels":{"app.kubernetes.io/component":"rabbitmq","app.kubernetes.io/name":"rabbitmq-cluster","app.kubernetes.io/part-of":"rabbitmq"},"ownerReferences":[{"apiVersion":"rabbitmq.com/v1beta1","kind":"RabbitmqCluster","name":"rabbitmq-cluster","uid":"18d9928b-0d1c-47be-80ec-20960d053827","controller":true,"blockOwnerDeletion":true}],"managedFields":[{"manager":"manager","operation":"Update","apiVersion":"v1","time":"2022-03-18T18:00:38Z","fieldsType":"FieldsV1","fieldsV1":{"f:data":{".":{},"f:enabled_plugins":{}},"f:metadata":{"f:labels":{".":{},"f:app.kubernetes.io/component":{},"f:app.kubernetes.io/name":{},"f:app.kubernetes.io/part-of":{}},"f:ownerReferences":{".":{},"k:{\"uid\":\"18d9928b-0d1c-47be-80ec-20960d053827\"}":{".":{},"f:apiVersion":{},"f:blockOwnerDeletion":{},"f:controller":{},"f:kind":{},"f:name":{},"f:uid":{}}}}}}]},"data":{"enabled_plugins":"[rabbitmq_peer_discovery_k8s,rabbitmq_prometheus,rabbitmq_management]."}}
2022/03/18 18:00:53 learn_server.go:291: [SIEVE-AFTER-READ]	Get	true	configmap	default	rabbitmq-cluster-server-conf	github.com/rabbitmq/cluster-operator/controllers.(*RabbitmqClusterReconciler)	NoError	{"kind":"ConfigMap","apiVersion":"v1","metadata":{"name":"rabbitmq-cluster-server-conf","namespace":"default","selfLink":"/api/v1/namespaces/default/configmaps/rabbitmq-cluster-server-conf","uid":"22474f2b-8454-44b7-8079-8990223969cc","resourceVersion":"714","creationTimestamp":"2022-03-18T18:00:38Z","labels":{"app.kubernetes.io/component":"rabbitmq","app.kubernetes.io/name":"rabbitmq-cluster","app.kubernetes.io/part-of":"rabbitmq"},"ownerReferences":[{"apiVersion":"rabbitmq.com/v1beta1","kind":"RabbitmqCluster","name":"rabbitmq-cluster","uid":"18d9928b-0d1c-47be-80ec-20960d053827","controller":true,"blockOwnerDeletion":true}],"managedFields":[{"manager":"manager","operation":"Update","apiVersion":"v1","time":"2022-03-18T18:00:38Z","fieldsType":"FieldsV1","fieldsV1":{"f:data":{".":{},"f:operatorDefaults.conf":{},"f:userDefinedConfiguration.conf":{}},"f:metadata":{"f:labels":{".":{},"f:app.kubernetes.io/component":{},"f:app.kubernetes.io/name":{},"f:app.kubernetes.io/part-of":{}},"f:ownerReferences":{".":{},"k:{\"uid\":\"18d9928b-0d1c-47be-80ec-20960d053827\"}":{".":{},"f:apiVersion":{},"f:blockOwnerDeletion":{},"f:controller":{},"f:kind":{},"f:name":{},"f:uid":{}}}}}}]},"data":{"operatorDefaults.conf":"cluster_formation.peer_discovery_backend             = rabbit_peer_discovery_k8s\ncluster_formation.k8s.host                           = kubernetes.default\ncluster_formation.k8s.address_type                   = hostname\ncluster_partition_handling                           = pause_minority\nqueue_master_locator                                 = min-masters\ndisk_free_limit.absolute                             = 2GB\ncluster_formation.randomized_startup_delay_range.min = 5\ncluster_formation.randomized_startup_delay_range.max = 30\ncluster_name                                         = rabbitmq-cluster\n","userDefinedConfiguration.conf":"total_memory_available_override_value = 1717986919\n"}}
2022/03/18 18:00:53 learn_server.go:291: [SIEVE-AFTER-READ]	Get	true	serviceaccount	default	rabbitmq-cluster-server	github.com/rabbitmq/cluster-operator/controllers.(*RabbitmqClusterReconciler)	NoError	{"kind":"ServiceAccount","apiVersion":"v1","metadata":{"name":"rabbitmq-cluster-server","namespace":"default","selfLink":"/api/v1/namespaces/default/serviceaccounts/rabbitmq-cluster-server","uid":"731589b5-ac97-4774-bee4-008949b54734","resourceVersion":"722","creationTimestamp":"2022-03-18T18:00:38Z","labels":{"app.kubernetes.io/component":"rabbitmq","app.kubernetes.io/name":"rabbitmq-cluster","app.kubernetes.io/part-of":"rabbitmq"},"ownerReferences":[{"apiVersion":"rabbitmq.com/v1beta1","kind":"RabbitmqCluster","name":"rabbitmq-cluster","uid":"18d9928b-0d1c-47be-80ec-20960d053827","controller":true,"blockOwnerDeletion":true}],"managedFields":[{"manager":"kube-controller-manager","operation":"Update","apiVersion":"v1","time":"2022-03-18T18:00:38Z","fieldsType":"FieldsV1","fieldsV1":{"f:secrets":{".":{},"k:{\"name\":\"rabbitmq-cluster-server-token-rhzq9\"}":{".":{},"f:name":{}}}}},{"manager":"manager","operation":"Update","apiVersion":"v1","time":"2022-03-18T18:00:38Z","fieldsType":"FieldsV1","fieldsV1":{"f:metadata":{"f:labels":{".":{},"f:app.kubernetes.io/component":{},"f:app.kubernetes.io/name":{},"f:app.kubernetes.io/part-of":{}},"f:ownerReferences":{".":{},"k:{\"uid\":\"18d9928b-0d1c-47be-80ec-20960d053827\"}":{".":{},"f:apiVersion":{},"f:blockOwnerDeletion":{},"f:controller":{},"f:kind":{},"f:name":{},"f:uid":{}}}}}}]},"secrets":[{"name":"rabbitmq-cluster-server-token-rhzq9"}]}
2022/03/18 18:00:53 learn_server.go:291: [SIEVE-AFTER-READ]	Get	true	role	default	rabbitmq-cluster-peer-discovery	github.com/rabbitmq/cluster-operator/controllers.(*RabbitmqClusterReconciler)	NoError	{"kind":"Role","apiVersion":"rbac.authorization.k8s.io/v1","metadata":{"name":"rabbitmq-cluster-peer-discovery","namespace":"default","selfLink":"/apis/rbac.authorization.k8s.io/v1/namespaces/default/roles/rabbitmq-cluster-peer-discovery","uid":"52c80b50-4fdd-4089-bbfd-9756465953f2","resourceVersion":"723","creationTimestamp":"2022-03-18T18:00:38Z","labels":{"app.kubernetes.io/component":"rabbitmq","app.kubernetes.io/name":"rabbitmq-cluster","app.kubernetes.io/part-of":"rabbitmq"},"ownerReferences":[{"apiVersion":"rabbitmq.com/v1beta1","kind":"RabbitmqCluster","name":"rabbitmq-cluster","uid":"18d9928b-0d1c-47be-80ec-20960d053827","controller":true,"blockOwnerDeletion":true}],"managedFields":[{"manager":"manager","operation":"Update","apiVersion":"rbac.authorization.k8s.io/v1","time":"2022-03-18T18:00:38Z","fieldsType":"FieldsV1","fieldsV1":{"f:metadata":{"f:labels":{".":{},"f:app.kubernetes.io/component":{},"f:app.kubernetes.io/name":{},"f:app.kubernetes.io/part-of":{}},"f:ownerReferences":{".":{},"k:{\"uid\":\"18d9928b-0d1c-47be-80ec-20960d053827\"}":{".":{},"f:apiVersion":{},"f:blockOwnerDeletion":{},"f:controller":{},"f:kind":{},"f:name":{},"f:uid":{}}}},"f:rules":{}}}]},"rules":[{"verbs":["get"],"apiGroups":[""],"resources":["endpoints"]},{"verbs":["create"],"apiGroups":[""],"resources":["events"]}]}
2022/03/18 18:00:53 learn_server.go:291: [SIEVE-AFTER-READ]	Get	true	rolebinding	default	rabbitmq-cluster-server	github.com/rabbitmq/cluster-operator/controllers.(*RabbitmqClusterReconciler)	NoError	{"kind":"RoleBinding","apiVersion":"rbac.authorization.k8s.io/v1","metadata":{"name":"rabbitmq-cluster-server","namespace":"default","selfLink":"/apis/rbac.authorization.k8s.io/v1/namespaces/default/rolebindings/rabbitmq-cluster-server","uid":"495e9f7c-a20d-4515-86b0-34149a855034","resourceVersion":"725","creationTimestamp":"2022-03-18T18:00:38Z","labels":{"app.kubernetes.io/component":"rabbitmq","app.kubernetes.io/name":"rabbitmq-cluster","app.kubernetes.io/part-of":"rabbitmq"},"ownerReferences":[{"apiVersion":"rabbitmq.com/v1beta1","kind":"RabbitmqCluster","name":"rabbitmq-cluster","uid":"18d9928b-0d1c-47be-80ec-20960d053827","controller":true,"blockOwnerDeletion":true}],"managedFields":[{"manager":"manager","operation":"Update","apiVersion":"rbac.authorization.k8s.io/v1","time":"2022-03-18T18:00:38Z","fieldsType":"FieldsV1","fieldsV1":{"f:metadata":{"f:labels":{".":{},"f:app.kubernetes.io/component":{},"f:app.kubernetes.io/name":{},"f:app.kubernetes.io/part-of":{}},"f:ownerReferences":{".":{},"k:{\"uid\":\"18d9928b-0d1c-47be-80ec-20960d053827\"}":{".":{},"f:apiVersion":{},"f:blockOwnerDeletion":{},"f:controller":{},"f:kind":{},"f:name":{},"f:uid":{}}}},"f:roleRef":{"f:apiGroup":{},"f:kind":{},"f:name":{}},"f:subjects":{}}}]},"subjects":[{"kind":"ServiceAccount","name":"rabbitmq-cluster-server"}],"roleRef":{"apiGroup":"rbac.authorization.k8s.io","kind":"Role","name":"rabbitmq-cluster-peer-discovery"}}
2022/03/18 18:00:53 learn_server.go:291: [SIEVE-AFTER-READ]	Get	true	statefulset	default	rabbitmq-cluster-server	github.com/rabbitmq/cluster-operator/controllers.(*RabbitmqClusterReconciler)	NoError	{"kind":"StatefulSet","apiVersion":"apps/v1","metadata":{"name":"rabbitmq-cluster-server","namespace":"default","selfLink":"/apis/apps/v1/namespaces/default/statefulsets/rabbitmq-cluster-server","uid":"cb5c43bc-6ee7-481c-ab01-6f3acffdd3c8","resourceVersion":"744","generation":1,"creationTimestamp":"2022-03-18T18:00:38Z","labels":{"app.kubernetes.io/component":"rabbitmq","app.kubernetes.io/name":"rabbitmq-cluster","app.kubernetes.io/part-of":"rabbitmq"},"annotations":{"rabbitmq.com/createdAt":"2022-03-18T18:00:38Z"},"ownerReferences":[{"apiVersion":"rabbitmq.com/v1beta1","kind":"RabbitmqCluster","name":"rabbitmq-cluster","uid":"18d9928b-0d1c-47be-80ec-20960d053827","controller":true,"blockOwnerDeletion":true}],"managedFields":[{"manager":"kube-controller-manager","operation":"Update","apiVersion":"apps/v1","time":"2022-03-18T18:00:38Z","fieldsType":"FieldsV1","fieldsV1":{"f:status":{"f:collisionCount":{},"f:currentReplicas":{},"f:currentRevision":{},"f:observedGeneration":{},"f:replicas":{},"f:updateRevision":{},"f:updatedReplicas":{}}}},{"manager":"manager","operation":"Update","apiVersion":"apps/v1","time":"2022-03-18T18:00:38Z","fieldsType":"FieldsV1","fieldsV1":{"f:metadata":{"f:annotations":{".":{},"f:rabbitmq.com/createdAt":{}},"f:labels":{".":{},"f:app.kubernetes.io/component":{},"f:app.kubernetes.io/name":{},"f:app.kubernetes.io/part-of":{}},"f:ownerReferences":{".":{},"k:{\"uid\":\"18d9928b-0d1c-47be-80ec-20960d053827\"}":{".":{},"f:apiVersion":{},"f:blockOwnerDeletion":{},"f:controller":{},"f:kind":{},"f:name":{},"f:uid":{}}}},"f:spec":{"f:podManagementPolicy":{},"f:replicas":{},"f:revisionHistoryLimit":{},"f:selector":{"f:matchLabels":{".":{},"f:app.kubernetes.io/name":{}}},"f:serviceName":{},"f:template":{"f:metadata":{"f:annotations":{".":{},"f:prometheus.io/port":{},"f:prometheus.io/scrape":{}},"f:labels":{".":{},"f:app.kubernetes.io/component":{},"f:app.kubernetes.io/name":{},"f:app.kubernetes.io/part-of":{}}},"f:spec":{"f:automountServiceAccountToken":{},"f:containers":{"k:{\"name\":\"rabbitmq\"}":{".":{},"f:env":{".":{},"k:{\"name\":\"K8S_HOSTNAME_SUFFIX\"}":{".":{},"f:name":{},"f:value":{}},"k:{\"name\":\"K8S_SERVICE_NAME\"}":{".":{},"f:name":{},"f:value":{}},"k:{\"name\":\"MY_POD_NAME\"}":{".":{},"f:name":{},"f:valueFrom":{".":{},"f:fieldRef":{".":{},"f:apiVersion":{},"f:fieldPath":{}}}},"k:{\"name\":\"MY_POD_NAMESPACE\"}":{".":{},"f:name":{},"f:valueFrom":{".":{},"f:fieldRef":{".":{},"f:apiVersion":{},"f:fieldPath":{}}}},"k:{\"name\":\"RABBITMQ_ENABLED_PLUGINS_FILE\"}":{".":{},"f:name":{},"f:value":{}},"k:{\"name\":\"RABBITMQ_NODENAME\"}":{".":{},"f:name":{},"f:value":{}},"k:{\"name\":\"RABBITMQ_USE_LONGNAME\"}":{".":{},"f:name":{},"f:value":{}}},"f:image":{},"f:imagePullPolicy":{},"f:lifecycle":{".":{},"f:preStop":{".":{},"f:exec":{".":{},"f:command":{}}}},"f:name":{},"f:ports":{".":{},"k:{\"containerPort\":4369,\"protocol\":\"TCP\"}":{".":{},"f:containerPort":{},"f:name":{},"f:protocol":{}},"k:{\"containerPort\":5672,\"protocol\":\"TCP\"}":{".":{},"f:containerPort":{},"f:name":{},"f:protocol":{}},"k:{\"containerPort\":15672,\"protocol\":\"TCP\"}":{".":{},"f:containerPort":{},"f:name":{},"f:protocol":{}},"k:{\"containerPort\":15692,\"protocol\":\"TCP\"}":{".":{},"f:containerPort":{},"f:name":{},"f:protocol":{}}},"f:readinessProbe":{".":{},"f:failureThreshold":{},"f:initialDelaySeconds":{},"f:periodSeconds":{},"f:successThreshold":{},"f:tcpSocket":{".":{},"f:port":{}},"f:timeoutSeconds":{}},"f:resources":{".":{},"f:limits":{".":{},"f:cpu":{},"f:memory":{}},"f:requests":{".":{},"f:cpu":{},"f:memory":{}}},"f:terminationMessagePath":{},"f:terminationMessagePolicy":{},"f:volumeMounts":{".":{},"k:{\"mountPath\":\"/etc/pod-info/\"}":{".":{},"f:mountPath":{},"f:name":{}},"k:{\"mountPath\":\"/etc/rabbitmq/conf.d/10-operatorDefaults.conf\"}":{".":{},"f:mountPath":{},"f:name":{},"f:subPath":{}},"k:{\"mountPath\":\"/etc/rabbitmq/conf.d/11-default_user.conf\"}":{".":{},"f:mountPath":{},"f:name":{},"f:subPath":{}},"k:{\"mountPath\":\"/etc/rabbitmq/conf.d/90-userDefinedConfiguration.conf\"}":{".":{},"f:mountPath":{},"f:name":{},"f:subPath":{}},"k:{\"mountPath\":\"/operator\"}":{".":{},"f:mountPath":{},"f:name":{}},"k:{\"mountPath\":\"/var/lib/rabbitmq/\"}":{".":{},"f:mountPath":{},"f:name":{}},"k:{\"mountPath\":\"/var/lib/rabbitmq/mnesia/\"}":{".":{},"f:mountPath":{},"f:name":{}}}}},"f:dnsPolicy":{},"f:initContainers":{".":{},"k:{\"name\":\"setup-container\"}":{".":{},"f:command":{},"f:image":{},"f:imagePullPolicy":{},"f:name":{},"f:resources":{".":{},"f:limits":{".":{},"f:cpu":{},"f:memory":{}},"f:requests":{".":{},"f:cpu":{},"f:memory":{}}},"f:securityContext":{".":{},"f:capabilities":{".":{},"f:drop":{}},"f:runAsUser":{}},"f:terminationMessagePath":{},"f:terminationMessagePolicy":{},"f:volumeMounts":{".":{},"k:{\"mountPath\":\"/operator\"}":{".":{},"f:mountPath":{},"f:name":{}},"k:{\"mountPath\":\"/tmp/default_user.conf\"}":{".":{},"f:mountPath":{},"f:name":{},"f:subPath":{}},"k:{\"mountPath\":\"/tmp/erlang-cookie-secret/\"}":{".":{},"f:mountPath":{},"f:name":{}},"k:{\"mountPath\":\"/tmp/rabbitmq-plugins/\"}":{".":{},"f:mountPath":{},"f:name":{}},"k:{\"mountPath\":\"/var/lib/rabbitmq/\"}":{".":{},"f:mountPath":{},"f:name":{}},"k:{\"mountPath\":\"/var/lib/rabbitmq/mnesia/\"}":{".":{},"f:mountPath":{},"f:name":{}}}}},"f:restartPolicy":{},"f:schedulerName":{},"f:securityContext":{".":{},"f:fsGroup":{},"f:runAsGroup":{},"f:runAsUser":{}},"f:serviceAccount":{},"f:serviceAccountName":{},"f:terminationGracePeriodSeconds":{},"f:topologySpreadConstraints":{".":{},"k:{\"topologyKey\":\"topology.kubernetes.io/zone\",\"whenUnsatisfiable\":\"ScheduleAnyway\"}":{".":{},"f:labelSelector":{".":{},"f:matchLabels":{".":{},"f:app.kubernetes.io/name":{}}},"f:maxSkew":{},"f:topologyKey":{},"f:whenUnsatisfiable":{}}},"f:volumes":{".":{},"k:{\"name\":\"erlang-cookie-secret\"}":{".":{},"f:name":{},"f:secret":{".":{},"f:defaultMode":{},"f:secretName":{}}},"k:{\"name\":\"plugins-conf\"}":{".":{},"f:configMap":{".":{},"f:defaultMode":{},"f:name":{}},"f:name":{}},"k:{\"name\":\"pod-info\"}":{".":{},"f:downwardAPI":{".":{},"f:defaultMode":{},"f:items":{}},"f:name":{}},"k:{\"name\":\"rabbitmq-confd\"}":{".":{},"f:name":{},"f:projected":{".":{},"f:defaultMode":{},"f:sources":{}}},"k:{\"name\":\"rabbitmq-erlang-cookie\"}":{".":{},"f:emptyDir":{},"f:name":{}},"k:{\"name\":\"rabbitmq-plugins\"}":{".":{},"f:emptyDir":{},"f:name":{}}}}},"f:updateStrategy":{"f:rollingUpdate":{".":{},"f:partition":{}},"f:type":{}},"f:volumeClaimTemplates":{}}}}]},"spec":{"replicas":1,"selector":{"matchLabels":{"app.kubernetes.io/name":"rabbitmq-cluster"}},"template":{"metadata":{"creationTimestamp":null,"labels":{"app.kubernetes.io/component":"rabbitmq","app.kubernetes.io/name":"rabbitmq-cluster","app.kubernetes.io/part-of":"rabbitmq"},"annotations":{"prometheus.io/port":"15692","prometheus.io/scrape":"true"}},"spec":{"volumes":[{"name":"plugins-conf","configMap":{"name":"rabbitmq-cluster-plugins-conf","defaultMode":420}},{"name":"rabbitmq-confd","projected":{"sources":[{"secret":{"name":"rabbitmq-cluster-default-user","items":[{"key":"default_user.conf","path":"default_user.conf"}]}},{"configMap":{"name":"rabbitmq-cluster-server-conf","items":[{"key":"operatorDefaults.conf","path":"operatorDefaults.conf"},{"key":"userDefinedConfiguration.conf","path":"userDefinedConfiguration.conf"}]}}],"defaultMode":420}},{"name":"rabbitmq-erlang-cookie","emptyDir":{}},{"name":"erlang-cookie-secret","secret":{"secretName":"rabbitmq-cluster-erlang-cookie","defaultMode":420}},{"name":"rabbitmq-plugins","emptyDir":{}},{"name":"pod-info","downwardAPI":{"items":[{"path":"skipPreStopChecks","fieldRef":{"apiVersion":"v1","fieldPath":"metadata.labels['skipPreStopChecks']"}}],"defaultMode":420}}],"initContainers":[{"name":"setup-container","image":"rabbitmq:3.8.12-management","command":["sh","-c","cp /tmp/erlang-cookie-secret/.erlang.cookie /var/lib/rabbitmq/.erlang.cookie \u0026\u0026 chown 999:999 /var/lib/rabbitmq/.erlang.cookie \u0026\u0026 chmod 600 /var/lib/rabbitmq/.erlang.cookie ; cp /tmp/rabbitmq-plugins/enabled_plugins /operator/enabled_plugins \u0026\u0026 chown 999:999 /operator/enabled_plugins ; chown 999:999 /var/lib/rabbitmq/mnesia/ ; echo '[default]' \u003e /var/lib/rabbitmq/.rabbitmqadmin.conf \u0026\u0026 sed -e 's/default_user/username/' -e 's/default_pass/password/' /tmp/default_user.conf \u003e\u003e /var/lib/rabbitmq/.rabbitmqadmin.conf \u0026\u0026 chown 999:999 /var/lib/rabbitmq/.rabbitmqadmin.conf \u0026\u0026 chmod 600 /var/lib/rabbitmq/.rabbitmqadmin.conf"],"resources":{"limits":{"cpu":"100m","memory":"500Mi"},"requests":{"cpu":"100m","memory":"500Mi"}},"volumeMounts":[{"name":"plugins-conf","mountPath":"/tmp/rabbitmq-plugins/"},{"name":"rabbitmq-erlang-cookie","mountPath":"/var/lib/rabbitmq/"},{"name":"erlang-cookie-secret","mountPath":"/tmp/erlang-cookie-secret/"},{"name":"rabbitmq-plugins","mountPath":"/operator"},{"name":"persistence","mountPath":"/var/lib/rabbitmq/mnesia/"},{"name":"rabbitmq-confd","mountPath":"/tmp/default_user.conf","subPath":"default_user.conf"}],"terminationMessagePath":"/dev/termination-log","terminationMessagePolicy":"File","imagePullPolicy":"IfNotPresent","securityContext":{"capabilities":{"drop":["FSETID","KILL","SETGID","SETUID","SETPCAP","NET_BIND_SERVICE","NET_RAW","SYS_CHROOT","MKNOD","AUDIT_WRITE","SETFCAP"]},"runAsUser":0}}],"containers":[{"name":"rabbitmq","image":"rabbitmq:3.8.12-management","ports":[{"name":"epmd","containerPort":4369,"protocol":"TCP"},{"name":"amqp","containerPort":5672,"protocol":"TCP"},{"name":"management","containerPort":15672,"protocol":"TCP"},{"name":"prometheus","containerPort":15692,"protocol":"TCP"}],"env":[{"name":"MY_POD_NAME","valueFrom":{"fieldRef":{"apiVersion":"v1","fieldPath":"metadata.name"}}},{"name":"MY_POD_NAMESPACE","valueFrom":{"fieldRef":{"apiVersion":"v1","fieldPath":"metadata.namespace"}}},{"name":"RABBITMQ_ENABLED_PLUGINS_FILE","value":"/operator/enabled_plugins"},{"name":"K8S_SERVICE_NAME","value":"rabbitmq-cluster-nodes"},{"name":"RABBITMQ_USE_LONGNAME","value":"true"},{"name":"RABBITMQ_NODENAME","value":"rabbit@$(MY_POD_NAME).$(K8S_SERVICE_NAME).$(MY_POD_NAMESPACE)"},{"name":"K8S_HOSTNAME_SUFFIX","value":".$(K8S_SERVICE_NAME).$(MY_POD_NAMESPACE)"}],"resources":{"limits":{"cpu":"2","memory":"2Gi"},"requests":{"cpu":"1","memory":"2Gi"}},"volumeMounts":[{"name":"rabbitmq-erlang-cookie","mountPath":"/var/lib/rabbitmq/"},{"name":"persistence","mountPath":"/var/lib/rabbitmq/mnesia/"},{"name":"rabbitmq-plugins","mountPath":"/operator"},{"name":"rabbitmq-confd","mountPath":"/etc/rabbitmq/conf.d/10-operatorDefaults.conf","subPath":"operatorDefaults.conf"},{"name":"rabbitmq-confd","mountPath":"/etc/rabbitmq/conf.d/11-default_user.conf","subPath":"default_user.conf"},{"name":"rabbitmq-confd","mountPath":"/etc/rabbitmq/conf.d/90-userDefinedConfiguration.conf","subPath":"userDefinedConfiguration.conf"},{"name":"pod-info","mountPath":"/etc/pod-info/"}],"readinessProbe":{"tcpSocket":{"port":"amqp"},"initialDelaySeconds":10,"timeoutSeconds":5,"periodSeconds":10,"successThreshold":1,"failureThreshold":3},"lifecycle":{"preStop":{"exec":{"command":["/bin/bash","-c","if [ ! -z \"$(cat /etc/pod-info/skipPreStopChecks)\" ]; then exit 0; fi; rabbitmq-upgrade await_online_quorum_plus_one -t 604800; rabbitmq-upgrade await_online_synchronized_mirror -t 604800; rabbitmq-upgrade drain -t 604800"]}}},"terminationMessagePath":"/dev/termination-log","terminationMessagePolicy":"File","imagePullPolicy":"IfNotPresent"}],"restartPolicy":"Always","terminationGracePeriodSeconds":604800,"dnsPolicy":"ClusterFirst","serviceAccountName":"rabbitmq-cluster-server","serviceAccount":"rabbitmq-cluster-server","automountServiceAccountToken":true,"securityContext":{"runAsUser":999,"runAsGroup":999,"fsGroup":999},"schedulerName":"default-scheduler","topologySpreadConstraints":[{"maxSkew":1,"topologyKey":"topology.kubernetes.io/zone","whenUnsatisfiable":"ScheduleAnyway","labelSelector":{"matchLabels":{"app.kubernetes.io/name":"rabbitmq-cluster"}}}]}},"volumeClaimTemplates":[{"metadata":{"name":"persistence","namespace":"default","creationTimestamp":null,"labels":{"app.kubernetes.io/component":"rabbitmq","app.kubernetes.io/name":"rabbitmq-cluster","app.kubernetes.io/part-of":"rabbitmq"},"ownerReferences":[{"apiVersion":"rabbitmq.com/v1beta1","kind":"RabbitmqCluster","name":"rabbitmq-cluster","uid":"18d9928b-0d1c-47be-80ec-20960d053827","controller":true,"blockOwnerDeletion":false}]},"spec":{"accessModes":["ReadWriteOnce"],"resources":{"requests":{"storage":"10Gi"}},"volumeMode":"Filesystem"},"status":{"phase":"Pending"}}],"serviceName":"rabbitmq-cluster-nodes","podManagementPolicy":"Parallel","updateStrategy":{"type":"RollingUpdate","rollingUpdate":{"partition":0}},"revisionHistoryLimit":10},"status":{"observedGeneration":1,"replicas":1,"currentReplicas":1,"updatedReplicas":1,"currentRevision":"rabbitmq-cluster-server-5f8b8665fb","updateRevision":"rabbitmq-cluster-server-5f8b8665fb","collisionCount":0}}
2022/03/18 18:00:53 learn_server.go:291: [SIEVE-AFTER-READ]	Get	true	statefulset	default	rabbitmq-cluster-server	github.com/rabbitmq/cluster-operator/controllers.(*RabbitmqClusterReconciler)	NoError	{"kind":"StatefulSet","apiVersion":"apps/v1","metadata":{"name":"rabbitmq-cluster-server","namespace":"default","selfLink":"/apis/apps/v1/namespaces/default/statefulsets/rabbitmq-cluster-server","uid":"cb5c43bc-6ee7-481c-ab01-6f3acffdd3c8","resourceVersion":"744","generation":1,"creationTimestamp":"2022-03-18T18:00:38Z","labels":{"app.kubernetes.io/component":"rabbitmq","app.kubernetes.io/name":"rabbitmq-cluster","app.kubernetes.io/part-of":"rabbitmq"},"annotations":{"rabbitmq.com/createdAt":"2022-03-18T18:00:38Z"},"ownerReferences":[{"apiVersion":"rabbitmq.com/v1beta1","kind":"RabbitmqCluster","name":"rabbitmq-cluster","uid":"18d9928b-0d1c-47be-80ec-20960d053827","controller":true,"blockOwnerDeletion":true}],"managedFields":[{"manager":"kube-controller-manager","operation":"Update","apiVersion":"apps/v1","time":"2022-03-18T18:00:38Z","fieldsType":"FieldsV1","fieldsV1":{"f:status":{"f:collisionCount":{},"f:currentReplicas":{},"f:currentRevision":{},"f:observedGeneration":{},"f:replicas":{},"f:updateRevision":{},"f:updatedReplicas":{}}}},{"manager":"manager","operation":"Update","apiVersion":"apps/v1","time":"2022-03-18T18:00:38Z","fieldsType":"FieldsV1","fieldsV1":{"f:metadata":{"f:annotations":{".":{},"f:rabbitmq.com/createdAt":{}},"f:labels":{".":{},"f:app.kubernetes.io/component":{},"f:app.kubernetes.io/name":{},"f:app.kubernetes.io/part-of":{}},"f:ownerReferences":{".":{},"k:{\"uid\":\"18d9928b-0d1c-47be-80ec-20960d053827\"}":{".":{},"f:apiVersion":{},"f:blockOwnerDeletion":{},"f:controller":{},"f:kind":{},"f:name":{},"f:uid":{}}}},"f:spec":{"f:podManagementPolicy":{},"f:replicas":{},"f:revisionHistoryLimit":{},"f:selector":{"f:matchLabels":{".":{},"f:app.kubernetes.io/name":{}}},"f:serviceName":{},"f:template":{"f:metadata":{"f:annotations":{".":{},"f:prometheus.io/port":{},"f:prometheus.io/scrape":{}},"f:labels":{".":{},"f:app.kubernetes.io/component":{},"f:app.kubernetes.io/name":{},"f:app.kubernetes.io/part-of":{}}},"f:spec":{"f:automountServiceAccountToken":{},"f:containers":{"k:{\"name\":\"rabbitmq\"}":{".":{},"f:env":{".":{},"k:{\"name\":\"K8S_HOSTNAME_SUFFIX\"}":{".":{},"f:name":{},"f:value":{}},"k:{\"name\":\"K8S_SERVICE_NAME\"}":{".":{},"f:name":{},"f:value":{}},"k:{\"name\":\"MY_POD_NAME\"}":{".":{},"f:name":{},"f:valueFrom":{".":{},"f:fieldRef":{".":{},"f:apiVersion":{},"f:fieldPath":{}}}},"k:{\"name\":\"MY_POD_NAMESPACE\"}":{".":{},"f:name":{},"f:valueFrom":{".":{},"f:fieldRef":{".":{},"f:apiVersion":{},"f:fieldPath":{}}}},"k:{\"name\":\"RABBITMQ_ENABLED_PLUGINS_FILE\"}":{".":{},"f:name":{},"f:value":{}},"k:{\"name\":\"RABBITMQ_NODENAME\"}":{".":{},"f:name":{},"f:value":{}},"k:{\"name\":\"RABBITMQ_USE_LONGNAME\"}":{".":{},"f:name":{},"f:value":{}}},"f:image":{},"f:imagePullPolicy":{},"f:lifecycle":{".":{},"f:preStop":{".":{},"f:exec":{".":{},"f:command":{}}}},"f:name":{},"f:ports":{".":{},"k:{\"containerPort\":4369,\"protocol\":\"TCP\"}":{".":{},"f:containerPort":{},"f:name":{},"f:protocol":{}},"k:{\"containerPort\":5672,\"protocol\":\"TCP\"}":{".":{},"f:containerPort":{},"f:name":{},"f:protocol":{}},"k:{\"containerPort\":15672,\"protocol\":\"TCP\"}":{".":{},"f:containerPort":{},"f:name":{},"f:protocol":{}},"k:{\"containerPort\":15692,\"protocol\":\"TCP\"}":{".":{},"f:containerPort":{},"f:name":{},"f:protocol":{}}},"f:readinessProbe":{".":{},"f:failureThreshold":{},"f:initialDelaySeconds":{},"f:periodSeconds":{},"f:successThreshold":{},"f:tcpSocket":{".":{},"f:port":{}},"f:timeoutSeconds":{}},"f:resources":{".":{},"f:limits":{".":{},"f:cpu":{},"f:memory":{}},"f:requests":{".":{},"f:cpu":{},"f:memory":{}}},"f:terminationMessagePath":{},"f:terminationMessagePolicy":{},"f:volumeMounts":{".":{},"k:{\"mountPath\":\"/etc/pod-info/\"}":{".":{},"f:mountPath":{},"f:name":{}},"k:{\"mountPath\":\"/etc/rabbitmq/conf.d/10-operatorDefaults.conf\"}":{".":{},"f:mountPath":{},"f:name":{},"f:subPath":{}},"k:{\"mountPath\":\"/etc/rabbitmq/conf.d/11-default_user.conf\"}":{".":{},"f:mountPath":{},"f:name":{},"f:subPath":{}},"k:{\"mountPath\":\"/etc/rabbitmq/conf.d/90-userDefinedConfiguration.conf\"}":{".":{},"f:mountPath":{},"f:name":{},"f:subPath":{}},"k:{\"mountPath\":\"/operator\"}":{".":{},"f:mountPath":{},"f:name":{}},"k:{\"mountPath\":\"/var/lib/rabbitmq/\"}":{".":{},"f:mountPath":{},"f:name":{}},"k:{\"mountPath\":\"/var/lib/rabbitmq/mnesia/\"}":{".":{},"f:mountPath":{},"f:name":{}}}}},"f:dnsPolicy":{},"f:initContainers":{".":{},"k:{\"name\":\"setup-container\"}":{".":{},"f:command":{},"f:image":{},"f:imagePullPolicy":{},"f:name":{},"f:resources":{".":{},"f:limits":{".":{},"f:cpu":{},"f:memory":{}},"f:requests":{".":{},"f:cpu":{},"f:memory":{}}},"f:securityContext":{".":{},"f:capabilities":{".":{},"f:drop":{}},"f:runAsUser":{}},"f:terminationMessagePath":{},"f:terminationMessagePolicy":{},"f:volumeMounts":{".":{},"k:{\"mountPath\":\"/operator\"}":{".":{},"f:mountPath":{},"f:name":{}},"k:{\"mountPath\":\"/tmp/default_user.conf\"}":{".":{},"f:mountPath":{},"f:name":{},"f:subPath":{}},"k:{\"mountPath\":\"/tmp/erlang-cookie-secret/\"}":{".":{},"f:mountPath":{},"f:name":{}},"k:{\"mountPath\":\"/tmp/rabbitmq-plugins/\"}":{".":{},"f:mountPath":{},"f:name":{}},"k:{\"mountPath\":\"/var/lib/rabbitmq/\"}":{".":{},"f:mountPath":{},"f:name":{}},"k:{\"mountPath\":\"/var/lib/rabbitmq/mnesia/\"}":{".":{},"f:mountPath":{},"f:name":{}}}}},"f:restartPolicy":{},"f:schedulerName":{},"f:securityContext":{".":{},"f:fsGroup":{},"f:runAsGroup":{},"f:runAsUser":{}},"f:serviceAccount":{},"f:serviceAccountName":{},"f:terminationGracePeriodSeconds":{},"f:topologySpreadConstraints":{".":{},"k:{\"topologyKey\":\"topology.kubernetes.io/zone\",\"whenUnsatisfiable\":\"ScheduleAnyway\"}":{".":{},"f:labelSelector":{".":{},"f:matchLabels":{".":{},"f:app.kubernetes.io/name":{}}},"f:maxSkew":{},"f:topologyKey":{},"f:whenUnsatisfiable":{}}},"f:volumes":{".":{},"k:{\"name\":\"erlang-cookie-secret\"}":{".":{},"f:name":{},"f:secret":{".":{},"f:defaultMode":{},"f:secretName":{}}},"k:{\"name\":\"plugins-conf\"}":{".":{},"f:configMap":{".":{},"f:defaultMode":{},"f:name":{}},"f:name":{}},"k:{\"name\":\"pod-info\"}":{".":{},"f:downwardAPI":{".":{},"f:defaultMode":{},"f:items":{}},"f:name":{}},"k:{\"name\":\"rabbitmq-confd\"}":{".":{},"f:name":{},"f:projected":{".":{},"f:defaultMode":{},"f:sources":{}}},"k:{\"name\":\"rabbitmq-erlang-cookie\"}":{".":{},"f:emptyDir":{},"f:name":{}},"k:{\"name\":\"rabbitmq-plugins\"}":{".":{},"f:emptyDir":{},"f:name":{}}}}},"f:updateStrategy":{"f:rollingUpdate":{".":{},"f:partition":{}},"f:type":{}},"f:volumeClaimTemplates":{}}}}]},"spec":{"replicas":1,"selector":{"matchLabels":{"app.kubernetes.io/name":"rabbitmq-cluster"}},"template":{"metadata":{"creationTimestamp":null,"labels":{"app.kubernetes.io/component":"rabbitmq","app.kubernetes.io/name":"rabbitmq-cluster","app.kubernetes.io/part-of":"rabbitmq"},"annotations":{"prometheus.io/port":"15692","prometheus.io/scrape":"true"}},"spec":{"volumes":[{"name":"plugins-conf","configMap":{"name":"rabbitmq-cluster-plugins-conf","defaultMode":420}},{"name":"rabbitmq-confd","projected":{"sources":[{"secret":{"name":"rabbitmq-cluster-default-user","items":[{"key":"default_user.conf","path":"default_user.conf"}]}},{"configMap":{"name":"rabbitmq-cluster-server-conf","items":[{"key":"operatorDefaults.conf","path":"operatorDefaults.conf"},{"key":"userDefinedConfiguration.conf","path":"userDefinedConfiguration.conf"}]}}],"defaultMode":420}},{"name":"rabbitmq-erlang-cookie","emptyDir":{}},{"name":"erlang-cookie-secret","secret":{"secretName":"rabbitmq-cluster-erlang-cookie","defaultMode":420}},{"name":"rabbitmq-plugins","emptyDir":{}},{"name":"pod-info","downwardAPI":{"items":[{"path":"skipPreStopChecks","fieldRef":{"apiVersion":"v1","fieldPath":"metadata.labels['skipPreStopChecks']"}}],"defaultMode":420}}],"initContainers":[{"name":"setup-container","image":"rabbitmq:3.8.12-management","command":["sh","-c","cp /tmp/erlang-cookie-secret/.erlang.cookie /var/lib/rabbitmq/.erlang.cookie \u0026\u0026 chown 999:999 /var/lib/rabbitmq/.erlang.cookie \u0026\u0026 chmod 600 /var/lib/rabbitmq/.erlang.cookie ; cp /tmp/rabbitmq-plugins/enabled_plugins /operator/enabled_plugins \u0026\u0026 chown 999:999 /operator/enabled_plugins ; chown 999:999 /var/lib/rabbitmq/mnesia/ ; echo '[default]' \u003e /var/lib/rabbitmq/.rabbitmqadmin.conf \u0026\u0026 sed -e 's/default_user/username/' -e 's/default_pass/password/' /tmp/default_user.conf \u003e\u003e /var/lib/rabbitmq/.rabbitmqadmin.conf \u0026\u0026 chown 999:999 /var/lib/rabbitmq/.rabbitmqadmin.conf \u0026\u0026 chmod 600 /var/lib/rabbitmq/.rabbitmqadmin.conf"],"resources":{"limits":{"cpu":"100m","memory":"500Mi"},"requests":{"cpu":"100m","memory":"500Mi"}},"volumeMounts":[{"name":"plugins-conf","mountPath":"/tmp/rabbitmq-plugins/"},{"name":"rabbitmq-erlang-cookie","mountPath":"/var/lib/rabbitmq/"},{"name":"erlang-cookie-secret","mountPath":"/tmp/erlang-cookie-secret/"},{"name":"rabbitmq-plugins","mountPath":"/operator"},{"name":"persistence","mountPath":"/var/lib/rabbitmq/mnesia/"},{"name":"rabbitmq-confd","mountPath":"/tmp/default_user.conf","subPath":"default_user.conf"}],"terminationMessagePath":"/dev/termination-log","terminationMessagePolicy":"File","imagePullPolicy":"IfNotPresent","securityContext":{"capabilities":{"drop":["FSETID","KILL","SETGID","SETUID","SETPCAP","NET_BIND_SERVICE","NET_RAW","SYS_CHROOT","MKNOD","AUDIT_WRITE","SETFCAP"]},"runAsUser":0}}],"containers":[{"name":"rabbitmq","image":"rabbitmq:3.8.12-management","ports":[{"name":"epmd","containerPort":4369,"protocol":"TCP"},{"name":"amqp","containerPort":5672,"protocol":"TCP"},{"name":"management","containerPort":15672,"protocol":"TCP"},{"name":"prometheus","containerPort":15692,"protocol":"TCP"}],"env":[{"name":"MY_POD_NAME","valueFrom":{"fieldRef":{"apiVersion":"v1","fieldPath":"metadata.name"}}},{"name":"MY_POD_NAMESPACE","valueFrom":{"fieldRef":{"apiVersion":"v1","fieldPath":"metadata.namespace"}}},{"name":"RABBITMQ_ENABLED_PLUGINS_FILE","value":"/operator/enabled_plugins"},{"name":"K8S_SERVICE_NAME","value":"rabbitmq-cluster-nodes"},{"name":"RABBITMQ_USE_LONGNAME","value":"true"},{"name":"RABBITMQ_NODENAME","value":"rabbit@$(MY_POD_NAME).$(K8S_SERVICE_NAME).$(MY_POD_NAMESPACE)"},{"name":"K8S_HOSTNAME_SUFFIX","value":".$(K8S_SERVICE_NAME).$(MY_POD_NAMESPACE)"}],"resources":{"limits":{"cpu":"2","memory":"2Gi"},"requests":{"cpu":"1","memory":"2Gi"}},"volumeMounts":[{"name":"rabbitmq-erlang-cookie","mountPath":"/var/lib/rabbitmq/"},{"name":"persistence","mountPath":"/var/lib/rabbitmq/mnesia/"},{"name":"rabbitmq-plugins","mountPath":"/operator"},{"name":"rabbitmq-confd","mountPath":"/etc/rabbitmq/conf.d/10-operatorDefaults.conf","subPath":"operatorDefaults.conf"},{"name":"rabbitmq-confd","mountPath":"/etc/rabbitmq/conf.d/11-default_user.conf","subPath":"default_user.conf"},{"name":"rabbitmq-confd","mountPath":"/etc/rabbitmq/conf.d/90-userDefinedConfiguration.conf","subPath":"userDefinedConfiguration.conf"},{"name":"pod-info","mountPath":"/etc/pod-info/"}],"readinessProbe":{"tcpSocket":{"port":"amqp"},"initialDelaySeconds":10,"timeoutSeconds":5,"periodSeconds":10,"successThreshold":1,"failureThreshold":3},"lifecycle":{"preStop":{"exec":{"command":["/bin/bash","-c","if [ ! -z \"$(cat /etc/pod-info/skipPreStopChecks)\" ]; then exit 0; fi; rabbitmq-upgrade await_online_quorum_plus_one -t 604800; rabbitmq-upgrade await_online_synchronized_mirror -t 604800; rabbitmq-upgrade drain -t 604800"]}}},"terminationMessagePath":"/dev/termination-log","terminationMessagePolicy":"File","imagePullPolicy":"IfNotPresent"}],"restartPolicy":"Always","terminationGracePeriodSeconds":604800,"dnsPolicy":"ClusterFirst","serviceAccountName":"rabbitmq-cluster-server","serviceAccount":"rabbitmq-cluster-server","automountServiceAccountToken":true,"securityContext":{"runAsUser":999,"runAsGroup":999,"fsGroup":999},"schedulerName":"default-scheduler","topologySpreadConstraints":[{"maxSkew":1,"topologyKey":"topology.kubernetes.io/zone","whenUnsatisfiable":"ScheduleAnyway","labelSelector":{"matchLabels":{"app.kubernetes.io/name":"rabbitmq-cluster"}}}]}},"volumeClaimTemplates":[{"metadata":{"name":"persistence","namespace":"default","creationTimestamp":null,"labels":{"app.kubernetes.io/component":"rabbitmq","app.kubernetes.io/name":"rabbitmq-cluster","app.kubernetes.io/part-of":"rabbitmq"},"ownerReferences":[{"apiVersion":"rabbitmq.com/v1beta1","kind":"RabbitmqCluster","name":"rabbitmq-cluster","uid":"18d9928b-0d1c-47be-80ec-20960d053827","controller":true,"blockOwnerDeletion":false}]},"spec":{"accessModes":["ReadWriteOnce"],"resources":{"requests":{"storage":"10Gi"}},"volumeMode":"Filesystem"},"status":{"phase":"Pending"}}],"serviceName":"rabbitmq-cluster-nodes","podManagementPolicy":"Parallel","updateStrategy":{"type":"RollingUpdate","rollingUpdate":{"partition":0}},"revisionHistoryLimit":10},"status":{"observedGeneration":1,"replicas":1,"currentReplicas":1,"updatedReplicas":1,"currentRevision":"rabbitmq-cluster-server-5f8b8665fb","updateRevision":"rabbitmq-cluster-server-5f8b8665fb","collisionCount":0}}
2022/03/18 18:00:53 learn_server.go:256: [SIEVE-BEFORE-WRITE]	21
2022/03/18 18:00:53 learn_server.go:263: [SIEVE-AFTER-WRITE]	21	Update	statefulset	github.com/rabbitmq/cluster-operator/controllers.(*RabbitmqClusterReconciler)	NoError	{"metadata":{"name":"rabbitmq-cluster-server","namespace":"default","selfLink":"/apis/apps/v1/namespaces/default/statefulsets/rabbitmq-cluster-server","uid":"cb5c43bc-6ee7-481c-ab01-6f3acffdd3c8","resourceVersion":"744","generation":1,"creationTimestamp":"2022-03-18T18:00:38Z","labels":{"app.kubernetes.io/component":"rabbitmq","app.kubernetes.io/name":"rabbitmq-cluster","app.kubernetes.io/part-of":"rabbitmq"},"annotations":{"rabbitmq.com/createdAt":"2022-03-18T18:00:38Z"},"ownerReferences":[{"apiVersion":"rabbitmq.com/v1beta1","kind":"RabbitmqCluster","name":"rabbitmq-cluster","uid":"18d9928b-0d1c-47be-80ec-20960d053827","controller":true,"blockOwnerDeletion":true}],"managedFields":[{"manager":"kube-controller-manager","operation":"Update","apiVersion":"apps/v1","time":"2022-03-18T18:00:38Z","fieldsType":"FieldsV1","fieldsV1":{"f:status":{"f:collisionCount":{},"f:currentReplicas":{},"f:currentRevision":{},"f:observedGeneration":{},"f:replicas":{},"f:updateRevision":{},"f:updatedReplicas":{}}}},{"manager":"manager","operation":"Update","apiVersion":"apps/v1","time":"2022-03-18T18:00:38Z","fieldsType":"FieldsV1","fieldsV1":{"f:metadata":{"f:annotations":{".":{},"f:rabbitmq.com/createdAt":{}},"f:labels":{".":{},"f:app.kubernetes.io/component":{},"f:app.kubernetes.io/name":{},"f:app.kubernetes.io/part-of":{}},"f:ownerReferences":{".":{},"k:{\"uid\":\"18d9928b-0d1c-47be-80ec-20960d053827\"}":{".":{},"f:apiVersion":{},"f:blockOwnerDeletion":{},"f:controller":{},"f:kind":{},"f:name":{},"f:uid":{}}}},"f:spec":{"f:podManagementPolicy":{},"f:replicas":{},"f:revisionHistoryLimit":{},"f:selector":{"f:matchLabels":{".":{},"f:app.kubernetes.io/name":{}}},"f:serviceName":{},"f:template":{"f:metadata":{"f:annotations":{".":{},"f:prometheus.io/port":{},"f:prometheus.io/scrape":{}},"f:labels":{".":{},"f:app.kubernetes.io/component":{},"f:app.kubernetes.io/name":{},"f:app.kubernetes.io/part-of":{}}},"f:spec":{"f:automountServiceAccountToken":{},"f:containers":{"k:{\"name\":\"rabbitmq\"}":{".":{},"f:env":{".":{},"k:{\"name\":\"K8S_HOSTNAME_SUFFIX\"}":{".":{},"f:name":{},"f:value":{}},"k:{\"name\":\"K8S_SERVICE_NAME\"}":{".":{},"f:name":{},"f:value":{}},"k:{\"name\":\"MY_POD_NAME\"}":{".":{},"f:name":{},"f:valueFrom":{".":{},"f:fieldRef":{".":{},"f:apiVersion":{},"f:fieldPath":{}}}},"k:{\"name\":\"MY_POD_NAMESPACE\"}":{".":{},"f:name":{},"f:valueFrom":{".":{},"f:fieldRef":{".":{},"f:apiVersion":{},"f:fieldPath":{}}}},"k:{\"name\":\"RABBITMQ_ENABLED_PLUGINS_FILE\"}":{".":{},"f:name":{},"f:value":{}},"k:{\"name\":\"RABBITMQ_NODENAME\"}":{".":{},"f:name":{},"f:value":{}},"k:{\"name\":\"RABBITMQ_USE_LONGNAME\"}":{".":{},"f:name":{},"f:value":{}}},"f:image":{},"f:imagePullPolicy":{},"f:lifecycle":{".":{},"f:preStop":{".":{},"f:exec":{".":{},"f:command":{}}}},"f:name":{},"f:ports":{".":{},"k:{\"containerPort\":4369,\"protocol\":\"TCP\"}":{".":{},"f:containerPort":{},"f:name":{},"f:protocol":{}},"k:{\"containerPort\":5672,\"protocol\":\"TCP\"}":{".":{},"f:containerPort":{},"f:name":{},"f:protocol":{}},"k:{\"containerPort\":15672,\"protocol\":\"TCP\"}":{".":{},"f:containerPort":{},"f:name":{},"f:protocol":{}},"k:{\"containerPort\":15692,\"protocol\":\"TCP\"}":{".":{},"f:containerPort":{},"f:name":{},"f:protocol":{}}},"f:readinessProbe":{".":{},"f:failureThreshold":{},"f:initialDelaySeconds":{},"f:periodSeconds":{},"f:successThreshold":{},"f:tcpSocket":{".":{},"f:port":{}},"f:timeoutSeconds":{}},"f:resources":{".":{},"f:limits":{".":{},"f:cpu":{},"f:memory":{}},"f:requests":{".":{},"f:cpu":{},"f:memory":{}}},"f:terminationMessagePath":{},"f:terminationMessagePolicy":{},"f:volumeMounts":{".":{},"k:{\"mountPath\":\"/etc/pod-info/\"}":{".":{},"f:mountPath":{},"f:name":{}},"k:{\"mountPath\":\"/etc/rabbitmq/conf.d/10-operatorDefaults.conf\"}":{".":{},"f:mountPath":{},"f:name":{},"f:subPath":{}},"k:{\"mountPath\":\"/etc/rabbitmq/conf.d/11-default_user.conf\"}":{".":{},"f:mountPath":{},"f:name":{},"f:subPath":{}},"k:{\"mountPath\":\"/etc/rabbitmq/conf.d/90-userDefinedConfiguration.conf\"}":{".":{},"f:mountPath":{},"f:name":{},"f:subPath":{}},"k:{\"mountPath\":\"/operator\"}":{".":{},"f:mountPath":{},"f:name":{}},"k:{\"mountPath\":\"/var/lib/rabbitmq/\"}":{".":{},"f:mountPath":{},"f:name":{}},"k:{\"mountPath\":\"/var/lib/rabbitmq/mnesia/\"}":{".":{},"f:mountPath":{},"f:name":{}}}}},"f:dnsPolicy":{},"f:initContainers":{".":{},"k:{\"name\":\"setup-container\"}":{".":{},"f:command":{},"f:image":{},"f:imagePullPolicy":{},"f:name":{},"f:resources":{".":{},"f:limits":{".":{},"f:cpu":{},"f:memory":{}},"f:requests":{".":{},"f:cpu":{},"f:memory":{}}},"f:securityContext":{".":{},"f:capabilities":{".":{},"f:drop":{}},"f:runAsUser":{}},"f:terminationMessagePath":{},"f:terminationMessagePolicy":{},"f:volumeMounts":{".":{},"k:{\"mountPath\":\"/operator\"}":{".":{},"f:mountPath":{},"f:name":{}},"k:{\"mountPath\":\"/tmp/default_user.conf\"}":{".":{},"f:mountPath":{},"f:name":{},"f:subPath":{}},"k:{\"mountPath\":\"/tmp/erlang-cookie-secret/\"}":{".":{},"f:mountPath":{},"f:name":{}},"k:{\"mountPath\":\"/tmp/rabbitmq-plugins/\"}":{".":{},"f:mountPath":{},"f:name":{}},"k:{\"mountPath\":\"/var/lib/rabbitmq/\"}":{".":{},"f:mountPath":{},"f:name":{}},"k:{\"mountPath\":\"/var/lib/rabbitmq/mnesia/\"}":{".":{},"f:mountPath":{},"f:name":{}}}}},"f:restartPolicy":{},"f:schedulerName":{},"f:securityContext":{".":{},"f:fsGroup":{},"f:runAsGroup":{},"f:runAsUser":{}},"f:serviceAccount":{},"f:serviceAccountName":{},"f:terminationGracePeriodSeconds":{},"f:topologySpreadConstraints":{".":{},"k:{\"topologyKey\":\"topology.kubernetes.io/zone\",\"whenUnsatisfiable\":\"ScheduleAnyway\"}":{".":{},"f:labelSelector":{".":{},"f:matchLabels":{".":{},"f:app.kubernetes.io/name":{}}},"f:maxSkew":{},"f:topologyKey":{},"f:whenUnsatisfiable":{}}},"f:volumes":{".":{},"k:{\"name\":\"erlang-cookie-secret\"}":{".":{},"f:name":{},"f:secret":{".":{},"f:defaultMode":{},"f:secretName":{}}},"k:{\"name\":\"plugins-conf\"}":{".":{},"f:configMap":{".":{},"f:defaultMode":{},"f:name":{}},"f:name":{}},"k:{\"name\":\"pod-info\"}":{".":{},"f:downwardAPI":{".":{},"f:defaultMode":{},"f:items":{}},"f:name":{}},"k:{\"name\":\"rabbitmq-confd\"}":{".":{},"f:name":{},"f:projected":{".":{},"f:defaultMode":{},"f:sources":{}}},"k:{\"name\":\"rabbitmq-erlang-cookie\"}":{".":{},"f:emptyDir":{},"f:name":{}},"k:{\"name\":\"rabbitmq-plugins\"}":{".":{},"f:emptyDir":{},"f:name":{}}}}},"f:updateStrategy":{"f:rollingUpdate":{".":{},"f:partition":{}},"f:type":{}},"f:volumeClaimTemplates":{}}}}]},"spec":{"replicas":1,"selector":{"matchLabels":{"app.kubernetes.io/name":"rabbitmq-cluster"}},"template":{"metadata":{"creationTimestamp":null,"labels":{"app.kubernetes.io/component":"rabbitmq","app.kubernetes.io/name":"rabbitmq-cluster","app.kubernetes.io/part-of":"rabbitmq"},"annotations":{"prometheus.io/port":"15692","prometheus.io/scrape":"true"}},"spec":{"volumes":[{"name":"plugins-conf","configMap":{"name":"rabbitmq-cluster-plugins-conf","defaultMode":420}},{"name":"rabbitmq-confd","projected":{"sources":[{"secret":{"name":"rabbitmq-cluster-default-user","items":[{"key":"default_user.conf","path":"default_user.conf"}]}},{"configMap":{"name":"rabbitmq-cluster-server-conf","items":[{"key":"operatorDefaults.conf","path":"operatorDefaults.conf"},{"key":"userDefinedConfiguration.conf","path":"userDefinedConfiguration.conf"}]}}],"defaultMode":420}},{"name":"rabbitmq-erlang-cookie","emptyDir":{}},{"name":"erlang-cookie-secret","secret":{"secretName":"rabbitmq-cluster-erlang-cookie","defaultMode":420}},{"name":"rabbitmq-plugins","emptyDir":{}},{"name":"pod-info","downwardAPI":{"items":[{"path":"skipPreStopChecks","fieldRef":{"apiVersion":"v1","fieldPath":"metadata.labels['skipPreStopChecks']"}}],"defaultMode":420}}],"initContainers":[{"name":"setup-container","image":"rabbitmq:3.8.12-management","command":["sh","-c","cp /tmp/erlang-cookie-secret/.erlang.cookie /var/lib/rabbitmq/.erlang.cookie \u0026\u0026 chown 999:999 /var/lib/rabbitmq/.erlang.cookie \u0026\u0026 chmod 600 /var/lib/rabbitmq/.erlang.cookie ; cp /tmp/rabbitmq-plugins/enabled_plugins /operator/enabled_plugins \u0026\u0026 chown 999:999 /operator/enabled_plugins ; chown 999:999 /var/lib/rabbitmq/mnesia/ ; echo '[default]' \u003e /var/lib/rabbitmq/.rabbitmqadmin.conf \u0026\u0026 sed -e 's/default_user/username/' -e 's/default_pass/password/' /tmp/default_user.conf \u003e\u003e /var/lib/rabbitmq/.rabbitmqadmin.conf \u0026\u0026 chown 999:999 /var/lib/rabbitmq/.rabbitmqadmin.conf \u0026\u0026 chmod 600 /var/lib/rabbitmq/.rabbitmqadmin.conf"],"resources":{"limits":{"cpu":"100m","memory":"500Mi"},"requests":{"cpu":"100m","memory":"500Mi"}},"volumeMounts":[{"name":"plugins-conf","mountPath":"/tmp/rabbitmq-plugins/"},{"name":"rabbitmq-erlang-cookie","mountPath":"/var/lib/rabbitmq/"},{"name":"erlang-cookie-secret","mountPath":"/tmp/erlang-cookie-secret/"},{"name":"rabbitmq-plugins","mountPath":"/operator"},{"name":"persistence","mountPath":"/var/lib/rabbitmq/mnesia/"},{"name":"rabbitmq-confd","mountPath":"/tmp/default_user.conf","subPath":"default_user.conf"}],"terminationMessagePath":"/dev/termination-log","terminationMessagePolicy":"File","imagePullPolicy":"IfNotPresent","securityContext":{"capabilities":{"drop":["FSETID","KILL","SETGID","SETUID","SETPCAP","NET_BIND_SERVICE","NET_RAW","SYS_CHROOT","MKNOD","AUDIT_WRITE","SETFCAP"]},"runAsUser":0}}],"containers":[{"name":"rabbitmq","image":"rabbitmq:3.8.12-management","ports":[{"name":"epmd","containerPort":4369,"protocol":"TCP"},{"name":"amqp","containerPort":5672,"protocol":"TCP"},{"name":"management","containerPort":15672,"protocol":"TCP"},{"name":"prometheus","containerPort":15692,"protocol":"TCP"}],"env":[{"name":"MY_POD_NAME","valueFrom":{"fieldRef":{"apiVersion":"v1","fieldPath":"metadata.name"}}},{"name":"MY_POD_NAMESPACE","valueFrom":{"fieldRef":{"apiVersion":"v1","fieldPath":"metadata.namespace"}}},{"name":"RABBITMQ_ENABLED_PLUGINS_FILE","value":"/operator/enabled_plugins"},{"name":"K8S_SERVICE_NAME","value":"rabbitmq-cluster-nodes"},{"name":"RABBITMQ_USE_LONGNAME","value":"true"},{"name":"RABBITMQ_NODENAME","value":"rabbit@$(MY_POD_NAME).$(K8S_SERVICE_NAME).$(MY_POD_NAMESPACE)"},{"name":"K8S_HOSTNAME_SUFFIX","value":".$(K8S_SERVICE_NAME).$(MY_POD_NAMESPACE)"}],"resources":{"limits":{"cpu":"2","memory":"2Gi"},"requests":{"cpu":"1","memory":"2Gi"}},"volumeMounts":[{"name":"rabbitmq-erlang-cookie","mountPath":"/var/lib/rabbitmq/"},{"name":"persistence","mountPath":"/var/lib/rabbitmq/mnesia/"},{"name":"rabbitmq-plugins","mountPath":"/operator"},{"name":"rabbitmq-confd","mountPath":"/etc/rabbitmq/conf.d/10-operatorDefaults.conf","subPath":"operatorDefaults.conf"},{"name":"rabbitmq-confd","mountPath":"/etc/rabbitmq/conf.d/11-default_user.conf","subPath":"default_user.conf"},{"name":"rabbitmq-confd","mountPath":"/etc/rabbitmq/conf.d/90-userDefinedConfiguration.conf","subPath":"userDefinedConfiguration.conf"},{"name":"pod-info","mountPath":"/etc/pod-info/"}],"readinessProbe":{"tcpSocket":{"port":"amqp"},"initialDelaySeconds":10,"timeoutSeconds":5,"periodSeconds":10,"successThreshold":1,"failureThreshold":3},"lifecycle":{"preStop":{"exec":{"command":["/bin/bash","-c","if [ ! -z \"$(cat /etc/pod-info/skipPreStopChecks)\" ]; then exit 0; fi; rabbitmq-upgrade await_online_quorum_plus_one -t 604800; rabbitmq-upgrade await_online_synchronized_mirror -t 604800; rabbitmq-upgrade drain -t 604800"]}}},"terminationMessagePath":"/dev/termination-log","terminationMessagePolicy":"File","imagePullPolicy":"IfNotPresent"}],"restartPolicy":"Always","terminationGracePeriodSeconds":604800,"dnsPolicy":"ClusterFirst","serviceAccountName":"rabbitmq-cluster-server","serviceAccount":"rabbitmq-cluster-server","automountServiceAccountToken":true,"securityContext":{"runAsUser":999,"runAsGroup":999,"fsGroup":999},"schedulerName":"default-scheduler","topologySpreadConstraints":[{"maxSkew":1,"topologyKey":"topology.kubernetes.io/zone","whenUnsatisfiable":"ScheduleAnyway","labelSelector":{"matchLabels":{"app.kubernetes.io/name":"rabbitmq-cluster"}}}]}},"volumeClaimTemplates":[{"metadata":{"name":"persistence","namespace":"default","creationTimestamp":null,"labels":{"app.kubernetes.io/component":"rabbitmq","app.kubernetes.io/name":"rabbitmq-cluster","app.kubernetes.io/part-of":"rabbitmq"},"ownerReferences":[{"apiVersion":"rabbitmq.com/v1beta1","kind":"RabbitmqCluster","name":"rabbitmq-cluster","uid":"18d9928b-0d1c-47be-80ec-20960d053827","controller":true,"blockOwnerDeletion":false}]},"spec":{"accessModes":["ReadWriteOnce"],"resources":{"requests":{"storage":"10Gi"}},"volumeMode":"Filesystem"},"status":{"phase":"Pending"}}],"serviceName":"rabbitmq-cluster-nodes","podManagementPolicy":"Parallel","updateStrategy":{"type":"RollingUpdate","rollingUpdate":{"partition":0}},"revisionHistoryLimit":10},"status":{"observedGeneration":1,"replicas":1,"currentReplicas":1,"updatedReplicas":1,"currentRevision":"rabbitmq-cluster-server-5f8b8665fb","updateRevision":"rabbitmq-cluster-server-5f8b8665fb","collisionCount":0}}
2022/03/18 18:00:53 learn_server.go:291: [SIEVE-AFTER-READ]	Get	true	configmap	default	rabbitmq-cluster-server-conf	github.com/rabbitmq/cluster-operator/controllers.(*RabbitmqClusterReconciler)	NoError	{"kind":"ConfigMap","apiVersion":"v1","metadata":{"name":"rabbitmq-cluster-server-conf","namespace":"default","selfLink":"/api/v1/namespaces/default/configmaps/rabbitmq-cluster-server-conf","uid":"22474f2b-8454-44b7-8079-8990223969cc","resourceVersion":"714","creationTimestamp":"2022-03-18T18:00:38Z","labels":{"app.kubernetes.io/component":"rabbitmq","app.kubernetes.io/name":"rabbitmq-cluster","app.kubernetes.io/part-of":"rabbitmq"},"ownerReferences":[{"apiVersion":"rabbitmq.com/v1beta1","kind":"RabbitmqCluster","name":"rabbitmq-cluster","uid":"18d9928b-0d1c-47be-80ec-20960d053827","controller":true,"blockOwnerDeletion":true}],"managedFields":[{"manager":"manager","operation":"Update","apiVersion":"v1","time":"2022-03-18T18:00:38Z","fieldsType":"FieldsV1","fieldsV1":{"f:data":{".":{},"f:operatorDefaults.conf":{},"f:userDefinedConfiguration.conf":{}},"f:metadata":{"f:labels":{".":{},"f:app.kubernetes.io/component":{},"f:app.kubernetes.io/name":{},"f:app.kubernetes.io/part-of":{}},"f:ownerReferences":{".":{},"k:{\"uid\":\"18d9928b-0d1c-47be-80ec-20960d053827\"}":{".":{},"f:apiVersion":{},"f:blockOwnerDeletion":{},"f:controller":{},"f:kind":{},"f:name":{},"f:uid":{}}}}}}]},"data":{"operatorDefaults.conf":"cluster_formation.peer_discovery_backend             = rabbit_peer_discovery_k8s\ncluster_formation.k8s.host                           = kubernetes.default\ncluster_formation.k8s.address_type                   = hostname\ncluster_partition_handling                           = pause_minority\nqueue_master_locator                                 = min-masters\ndisk_free_limit.absolute                             = 2GB\ncluster_formation.randomized_startup_delay_range.min = 5\ncluster_formation.randomized_startup_delay_range.max = 30\ncluster_name                                         = rabbitmq-cluster\n","userDefinedConfiguration.conf":"total_memory_available_override_value = 1717986919\n"}}
2022/03/18 18:00:53 learn_server.go:256: [SIEVE-BEFORE-WRITE]	22
2022/03/18 18:00:53 learn_server.go:263: [SIEVE-AFTER-WRITE]	22	StatusUpdate	rabbitmqcluster	github.com/rabbitmq/cluster-operator/controllers.(*RabbitmqClusterReconciler)	NoError	{"metadata":{"name":"rabbitmq-cluster","namespace":"default","selfLink":"/apis/rabbitmq.com/v1beta1/namespaces/default/rabbitmqclusters/rabbitmq-cluster/status","uid":"18d9928b-0d1c-47be-80ec-20960d053827","resourceVersion":"746","generation":2,"creationTimestamp":"2022-03-18T18:00:38Z","annotations":{"kubectl.kubernetes.io/last-applied-configuration":"{\"apiVersion\":\"rabbitmq.com/v1beta1\",\"kind\":\"RabbitmqCluster\",\"metadata\":{\"annotations\":{},\"name\":\"rabbitmq-cluster\",\"namespace\":\"default\"},\"spec\":{\"persistence\":{\"storage\":\"10Gi\"},\"replicas\":1}}\n"},"finalizers":["deletion.finalizers.rabbitmqclusters.rabbitmq.com"],"managedFields":[{"manager":"kubectl-client-side-apply","operation":"Update","apiVersion":"rabbitmq.com/v1beta1","time":"2022-03-18T18:00:38Z","fieldsType":"FieldsV1","fieldsV1":{"f:metadata":{"f:annotations":{".":{},"f:kubectl.kubernetes.io/last-applied-configuration":{}}},"f:spec":{".":{},"f:image":{},"f:persistence":{".":{},"f:storage":{}},"f:replicas":{},"f:resources":{".":{},"f:limits":{".":{},"f:memory":{}},"f:requests":{".":{},"f:memory":{}}},"f:service":{".":{},"f:type":{}},"f:terminationGracePeriodSeconds":{}}}},{"manager":"manager","operation":"Update","apiVersion":"rabbitmq.com/v1beta1","time":"2022-03-18T18:00:38Z","fieldsType":"FieldsV1","fieldsV1":{"f:metadata":{"f:finalizers":{}},"f:spec":{"f:override":{},"f:rabbitmq":{},"f:resources":{"f:limits":{"f:cpu":{}},"f:requests":{"f:cpu":{}}},"f:tls":{}},"f:status":{".":{},"f:conditions":{},"f:defaultUser":{".":{},"f:secretReference":{".":{},"f:keys":{".":{},"f:password":{},"f:username":{}},"f:name":{},"f:namespace":{}},"f:serviceReference":{".":{},"f:name":{},"f:namespace":{}}}}}}]},"spec":{"replicas":1,"image":"rabbitmq:3.8.12-management","service":{"type":"ClusterIP"},"persistence":{"storage":"10Gi"},"resources":{"limits":{"cpu":"2","memory":"2Gi"},"requests":{"cpu":"1","memory":"2Gi"}},"rabbitmq":{},"tls":{},"override":{},"terminationGracePeriodSeconds":604800},"status":{"conditions":[{"type":"AllReplicasReady","status":"False","lastTransitionTime":"2022-03-18T18:00:38Z","reason":"NotAllPodsReady","message":"0/1 Pods ready"},{"type":"ClusterAvailable","status":"False","lastTransitionTime":"2022-03-18T18:00:38Z","reason":"NoEndpointsAvailable","message":"The service has no endpoints available"},{"type":"NoWarnings","status":"True","lastTransitionTime":"2022-03-18T18:00:38Z","reason":"NoWarnings"},{"type":"ReconcileSuccess","status":"Unknown","lastTransitionTime":"2022-03-18T18:00:38Z","reason":"Initialising"}],"defaultUser":{"secretReference":{"name":"rabbitmq-cluster-default-user","namespace":"default","keys":{"password":"password","username":"username"}},"serviceReference":{"name":"rabbitmq-cluster","namespace":"default"}},"binding":{"name":"rabbitmq-cluster-default-user"}}}
2022/03/18 18:00:53 learn_server.go:291: [SIEVE-AFTER-READ]	Get	true	statefulset	default	rabbitmq-cluster-server	github.com/rabbitmq/cluster-operator/controllers.(*RabbitmqClusterReconciler)	NoError	{"kind":"StatefulSet","apiVersion":"apps/v1","metadata":{"name":"rabbitmq-cluster-server","namespace":"default","selfLink":"/apis/apps/v1/namespaces/default/statefulsets/rabbitmq-cluster-server","uid":"cb5c43bc-6ee7-481c-ab01-6f3acffdd3c8","resourceVersion":"744","generation":1,"creationTimestamp":"2022-03-18T18:00:38Z","labels":{"app.kubernetes.io/component":"rabbitmq","app.kubernetes.io/name":"rabbitmq-cluster","app.kubernetes.io/part-of":"rabbitmq"},"annotations":{"rabbitmq.com/createdAt":"2022-03-18T18:00:38Z"},"ownerReferences":[{"apiVersion":"rabbitmq.com/v1beta1","kind":"RabbitmqCluster","name":"rabbitmq-cluster","uid":"18d9928b-0d1c-47be-80ec-20960d053827","controller":true,"blockOwnerDeletion":true}],"managedFields":[{"manager":"kube-controller-manager","operation":"Update","apiVersion":"apps/v1","time":"2022-03-18T18:00:38Z","fieldsType":"FieldsV1","fieldsV1":{"f:status":{"f:collisionCount":{},"f:currentReplicas":{},"f:currentRevision":{},"f:observedGeneration":{},"f:replicas":{},"f:updateRevision":{},"f:updatedReplicas":{}}}},{"manager":"manager","operation":"Update","apiVersion":"apps/v1","time":"2022-03-18T18:00:38Z","fieldsType":"FieldsV1","fieldsV1":{"f:metadata":{"f:annotations":{".":{},"f:rabbitmq.com/createdAt":{}},"f:labels":{".":{},"f:app.kubernetes.io/component":{},"f:app.kubernetes.io/name":{},"f:app.kubernetes.io/part-of":{}},"f:ownerReferences":{".":{},"k:{\"uid\":\"18d9928b-0d1c-47be-80ec-20960d053827\"}":{".":{},"f:apiVersion":{},"f:blockOwnerDeletion":{},"f:controller":{},"f:kind":{},"f:name":{},"f:uid":{}}}},"f:spec":{"f:podManagementPolicy":{},"f:replicas":{},"f:revisionHistoryLimit":{},"f:selector":{"f:matchLabels":{".":{},"f:app.kubernetes.io/name":{}}},"f:serviceName":{},"f:template":{"f:metadata":{"f:annotations":{".":{},"f:prometheus.io/port":{},"f:prometheus.io/scrape":{}},"f:labels":{".":{},"f:app.kubernetes.io/component":{},"f:app.kubernetes.io/name":{},"f:app.kubernetes.io/part-of":{}}},"f:spec":{"f:automountServiceAccountToken":{},"f:containers":{"k:{\"name\":\"rabbitmq\"}":{".":{},"f:env":{".":{},"k:{\"name\":\"K8S_HOSTNAME_SUFFIX\"}":{".":{},"f:name":{},"f:value":{}},"k:{\"name\":\"K8S_SERVICE_NAME\"}":{".":{},"f:name":{},"f:value":{}},"k:{\"name\":\"MY_POD_NAME\"}":{".":{},"f:name":{},"f:valueFrom":{".":{},"f:fieldRef":{".":{},"f:apiVersion":{},"f:fieldPath":{}}}},"k:{\"name\":\"MY_POD_NAMESPACE\"}":{".":{},"f:name":{},"f:valueFrom":{".":{},"f:fieldRef":{".":{},"f:apiVersion":{},"f:fieldPath":{}}}},"k:{\"name\":\"RABBITMQ_ENABLED_PLUGINS_FILE\"}":{".":{},"f:name":{},"f:value":{}},"k:{\"name\":\"RABBITMQ_NODENAME\"}":{".":{},"f:name":{},"f:value":{}},"k:{\"name\":\"RABBITMQ_USE_LONGNAME\"}":{".":{},"f:name":{},"f:value":{}}},"f:image":{},"f:imagePullPolicy":{},"f:lifecycle":{".":{},"f:preStop":{".":{},"f:exec":{".":{},"f:command":{}}}},"f:name":{},"f:ports":{".":{},"k:{\"containerPort\":4369,\"protocol\":\"TCP\"}":{".":{},"f:containerPort":{},"f:name":{},"f:protocol":{}},"k:{\"containerPort\":5672,\"protocol\":\"TCP\"}":{".":{},"f:containerPort":{},"f:name":{},"f:protocol":{}},"k:{\"containerPort\":15672,\"protocol\":\"TCP\"}":{".":{},"f:containerPort":{},"f:name":{},"f:protocol":{}},"k:{\"containerPort\":15692,\"protocol\":\"TCP\"}":{".":{},"f:containerPort":{},"f:name":{},"f:protocol":{}}},"f:readinessProbe":{".":{},"f:failureThreshold":{},"f:initialDelaySeconds":{},"f:periodSeconds":{},"f:successThreshold":{},"f:tcpSocket":{".":{},"f:port":{}},"f:timeoutSeconds":{}},"f:resources":{".":{},"f:limits":{".":{},"f:cpu":{},"f:memory":{}},"f:requests":{".":{},"f:cpu":{},"f:memory":{}}},"f:terminationMessagePath":{},"f:terminationMessagePolicy":{},"f:volumeMounts":{".":{},"k:{\"mountPath\":\"/etc/pod-info/\"}":{".":{},"f:mountPath":{},"f:name":{}},"k:{\"mountPath\":\"/etc/rabbitmq/conf.d/10-operatorDefaults.conf\"}":{".":{},"f:mountPath":{},"f:name":{},"f:subPath":{}},"k:{\"mountPath\":\"/etc/rabbitmq/conf.d/11-default_user.conf\"}":{".":{},"f:mountPath":{},"f:name":{},"f:subPath":{}},"k:{\"mountPath\":\"/etc/rabbitmq/conf.d/90-userDefinedConfiguration.conf\"}":{".":{},"f:mountPath":{},"f:name":{},"f:subPath":{}},"k:{\"mountPath\":\"/operator\"}":{".":{},"f:mountPath":{},"f:name":{}},"k:{\"mountPath\":\"/var/lib/rabbitmq/\"}":{".":{},"f:mountPath":{},"f:name":{}},"k:{\"mountPath\":\"/var/lib/rabbitmq/mnesia/\"}":{".":{},"f:mountPath":{},"f:name":{}}}}},"f:dnsPolicy":{},"f:initContainers":{".":{},"k:{\"name\":\"setup-container\"}":{".":{},"f:command":{},"f:image":{},"f:imagePullPolicy":{},"f:name":{},"f:resources":{".":{},"f:limits":{".":{},"f:cpu":{},"f:memory":{}},"f:requests":{".":{},"f:cpu":{},"f:memory":{}}},"f:securityContext":{".":{},"f:capabilities":{".":{},"f:drop":{}},"f:runAsUser":{}},"f:terminationMessagePath":{},"f:terminationMessagePolicy":{},"f:volumeMounts":{".":{},"k:{\"mountPath\":\"/operator\"}":{".":{},"f:mountPath":{},"f:name":{}},"k:{\"mountPath\":\"/tmp/default_user.conf\"}":{".":{},"f:mountPath":{},"f:name":{},"f:subPath":{}},"k:{\"mountPath\":\"/tmp/erlang-cookie-secret/\"}":{".":{},"f:mountPath":{},"f:name":{}},"k:{\"mountPath\":\"/tmp/rabbitmq-plugins/\"}":{".":{},"f:mountPath":{},"f:name":{}},"k:{\"mountPath\":\"/var/lib/rabbitmq/\"}":{".":{},"f:mountPath":{},"f:name":{}},"k:{\"mountPath\":\"/var/lib/rabbitmq/mnesia/\"}":{".":{},"f:mountPath":{},"f:name":{}}}}},"f:restartPolicy":{},"f:schedulerName":{},"f:securityContext":{".":{},"f:fsGroup":{},"f:runAsGroup":{},"f:runAsUser":{}},"f:serviceAccount":{},"f:serviceAccountName":{},"f:terminationGracePeriodSeconds":{},"f:topologySpreadConstraints":{".":{},"k:{\"topologyKey\":\"topology.kubernetes.io/zone\",\"whenUnsatisfiable\":\"ScheduleAnyway\"}":{".":{},"f:labelSelector":{".":{},"f:matchLabels":{".":{},"f:app.kubernetes.io/name":{}}},"f:maxSkew":{},"f:topologyKey":{},"f:whenUnsatisfiable":{}}},"f:volumes":{".":{},"k:{\"name\":\"erlang-cookie-secret\"}":{".":{},"f:name":{},"f:secret":{".":{},"f:defaultMode":{},"f:secretName":{}}},"k:{\"name\":\"plugins-conf\"}":{".":{},"f:configMap":{".":{},"f:defaultMode":{},"f:name":{}},"f:name":{}},"k:{\"name\":\"pod-info\"}":{".":{},"f:downwardAPI":{".":{},"f:defaultMode":{},"f:items":{}},"f:name":{}},"k:{\"name\":\"rabbitmq-confd\"}":{".":{},"f:name":{},"f:projected":{".":{},"f:defaultMode":{},"f:sources":{}}},"k:{\"name\":\"rabbitmq-erlang-cookie\"}":{".":{},"f:emptyDir":{},"f:name":{}},"k:{\"name\":\"rabbitmq-plugins\"}":{".":{},"f:emptyDir":{},"f:name":{}}}}},"f:updateStrategy":{"f:rollingUpdate":{".":{},"f:partition":{}},"f:type":{}},"f:volumeClaimTemplates":{}}}}]},"spec":{"replicas":1,"selector":{"matchLabels":{"app.kubernetes.io/name":"rabbitmq-cluster"}},"template":{"metadata":{"creationTimestamp":null,"labels":{"app.kubernetes.io/component":"rabbitmq","app.kubernetes.io/name":"rabbitmq-cluster","app.kubernetes.io/part-of":"rabbitmq"},"annotations":{"prometheus.io/port":"15692","prometheus.io/scrape":"true"}},"spec":{"volumes":[{"name":"plugins-conf","configMap":{"name":"rabbitmq-cluster-plugins-conf","defaultMode":420}},{"name":"rabbitmq-confd","projected":{"sources":[{"secret":{"name":"rabbitmq-cluster-default-user","items":[{"key":"default_user.conf","path":"default_user.conf"}]}},{"configMap":{"name":"rabbitmq-cluster-server-conf","items":[{"key":"operatorDefaults.conf","path":"operatorDefaults.conf"},{"key":"userDefinedConfiguration.conf","path":"userDefinedConfiguration.conf"}]}}],"defaultMode":420}},{"name":"rabbitmq-erlang-cookie","emptyDir":{}},{"name":"erlang-cookie-secret","secret":{"secretName":"rabbitmq-cluster-erlang-cookie","defaultMode":420}},{"name":"rabbitmq-plugins","emptyDir":{}},{"name":"pod-info","downwardAPI":{"items":[{"path":"skipPreStopChecks","fieldRef":{"apiVersion":"v1","fieldPath":"metadata.labels['skipPreStopChecks']"}}],"defaultMode":420}}],"initContainers":[{"name":"setup-container","image":"rabbitmq:3.8.12-management","command":["sh","-c","cp /tmp/erlang-cookie-secret/.erlang.cookie /var/lib/rabbitmq/.erlang.cookie \u0026\u0026 chown 999:999 /var/lib/rabbitmq/.erlang.cookie \u0026\u0026 chmod 600 /var/lib/rabbitmq/.erlang.cookie ; cp /tmp/rabbitmq-plugins/enabled_plugins /operator/enabled_plugins \u0026\u0026 chown 999:999 /operator/enabled_plugins ; chown 999:999 /var/lib/rabbitmq/mnesia/ ; echo '[default]' \u003e /var/lib/rabbitmq/.rabbitmqadmin.conf \u0026\u0026 sed -e 's/default_user/username/' -e 's/default_pass/password/' /tmp/default_user.conf \u003e\u003e /var/lib/rabbitmq/.rabbitmqadmin.conf \u0026\u0026 chown 999:999 /var/lib/rabbitmq/.rabbitmqadmin.conf \u0026\u0026 chmod 600 /var/lib/rabbitmq/.rabbitmqadmin.conf"],"resources":{"limits":{"cpu":"100m","memory":"500Mi"},"requests":{"cpu":"100m","memory":"500Mi"}},"volumeMounts":[{"name":"plugins-conf","mountPath":"/tmp/rabbitmq-plugins/"},{"name":"rabbitmq-erlang-cookie","mountPath":"/var/lib/rabbitmq/"},{"name":"erlang-cookie-secret","mountPath":"/tmp/erlang-cookie-secret/"},{"name":"rabbitmq-plugins","mountPath":"/operator"},{"name":"persistence","mountPath":"/var/lib/rabbitmq/mnesia/"},{"name":"rabbitmq-confd","mountPath":"/tmp/default_user.conf","subPath":"default_user.conf"}],"terminationMessagePath":"/dev/termination-log","terminationMessagePolicy":"File","imagePullPolicy":"IfNotPresent","securityContext":{"capabilities":{"drop":["FSETID","KILL","SETGID","SETUID","SETPCAP","NET_BIND_SERVICE","NET_RAW","SYS_CHROOT","MKNOD","AUDIT_WRITE","SETFCAP"]},"runAsUser":0}}],"containers":[{"name":"rabbitmq","image":"rabbitmq:3.8.12-management","ports":[{"name":"epmd","containerPort":4369,"protocol":"TCP"},{"name":"amqp","containerPort":5672,"protocol":"TCP"},{"name":"management","containerPort":15672,"protocol":"TCP"},{"name":"prometheus","containerPort":15692,"protocol":"TCP"}],"env":[{"name":"MY_POD_NAME","valueFrom":{"fieldRef":{"apiVersion":"v1","fieldPath":"metadata.name"}}},{"name":"MY_POD_NAMESPACE","valueFrom":{"fieldRef":{"apiVersion":"v1","fieldPath":"metadata.namespace"}}},{"name":"RABBITMQ_ENABLED_PLUGINS_FILE","value":"/operator/enabled_plugins"},{"name":"K8S_SERVICE_NAME","value":"rabbitmq-cluster-nodes"},{"name":"RABBITMQ_USE_LONGNAME","value":"true"},{"name":"RABBITMQ_NODENAME","value":"rabbit@$(MY_POD_NAME).$(K8S_SERVICE_NAME).$(MY_POD_NAMESPACE)"},{"name":"K8S_HOSTNAME_SUFFIX","value":".$(K8S_SERVICE_NAME).$(MY_POD_NAMESPACE)"}],"resources":{"limits":{"cpu":"2","memory":"2Gi"},"requests":{"cpu":"1","memory":"2Gi"}},"volumeMounts":[{"name":"rabbitmq-erlang-cookie","mountPath":"/var/lib/rabbitmq/"},{"name":"persistence","mountPath":"/var/lib/rabbitmq/mnesia/"},{"name":"rabbitmq-plugins","mountPath":"/operator"},{"name":"rabbitmq-confd","mountPath":"/etc/rabbitmq/conf.d/10-operatorDefaults.conf","subPath":"operatorDefaults.conf"},{"name":"rabbitmq-confd","mountPath":"/etc/rabbitmq/conf.d/11-default_user.conf","subPath":"default_user.conf"},{"name":"rabbitmq-confd","mountPath":"/etc/rabbitmq/conf.d/90-userDefinedConfiguration.conf","subPath":"userDefinedConfiguration.conf"},{"name":"pod-info","mountPath":"/etc/pod-info/"}],"readinessProbe":{"tcpSocket":{"port":"amqp"},"initialDelaySeconds":10,"timeoutSeconds":5,"periodSeconds":10,"successThreshold":1,"failureThreshold":3},"lifecycle":{"preStop":{"exec":{"command":["/bin/bash","-c","if [ ! -z \"$(cat /etc/pod-info/skipPreStopChecks)\" ]; then exit 0; fi; rabbitmq-upgrade await_online_quorum_plus_one -t 604800; rabbitmq-upgrade await_online_synchronized_mirror -t 604800; rabbitmq-upgrade drain -t 604800"]}}},"terminationMessagePath":"/dev/termination-log","terminationMessagePolicy":"File","imagePullPolicy":"IfNotPresent"}],"restartPolicy":"Always","terminationGracePeriodSeconds":604800,"dnsPolicy":"ClusterFirst","serviceAccountName":"rabbitmq-cluster-server","serviceAccount":"rabbitmq-cluster-server","automountServiceAccountToken":true,"securityContext":{"runAsUser":999,"runAsGroup":999,"fsGroup":999},"schedulerName":"default-scheduler","topologySpreadConstraints":[{"maxSkew":1,"topologyKey":"topology.kubernetes.io/zone","whenUnsatisfiable":"ScheduleAnyway","labelSelector":{"matchLabels":{"app.kubernetes.io/name":"rabbitmq-cluster"}}}]}},"volumeClaimTemplates":[{"metadata":{"name":"persistence","namespace":"default","creationTimestamp":null,"labels":{"app.kubernetes.io/component":"rabbitmq","app.kubernetes.io/name":"rabbitmq-cluster","app.kubernetes.io/part-of":"rabbitmq"},"ownerReferences":[{"apiVersion":"rabbitmq.com/v1beta1","kind":"RabbitmqCluster","name":"rabbitmq-cluster","uid":"18d9928b-0d1c-47be-80ec-20960d053827","controller":true,"blockOwnerDeletion":false}]},"spec":{"accessModes":["ReadWriteOnce"],"resources":{"requests":{"storage":"10Gi"}},"volumeMode":"Filesystem"},"status":{"phase":"Pending"}}],"serviceName":"rabbitmq-cluster-nodes","podManagementPolicy":"Parallel","updateStrategy":{"type":"RollingUpdate","rollingUpdate":{"partition":0}},"revisionHistoryLimit":10},"status":{"observedGeneration":1,"replicas":1,"currentReplicas":1,"updatedReplicas":1,"currentRevision":"rabbitmq-cluster-server-5f8b8665fb","updateRevision":"rabbitmq-cluster-server-5f8b8665fb","collisionCount":0}}
2022/03/18 18:00:53 learn_server.go:253: [SIEVE-AFTER-RECONCILE]	github.com/rabbitmq/cluster-operator/controllers.(*RabbitmqClusterReconciler)	3
2022/03/18 18:01:08 learn_server.go:238: [SIEVE-BEFORE-RECONCILE]	github.com/rabbitmq/cluster-operator/controllers.(*RabbitmqClusterReconciler)	4
2022/03/18 18:01:08 learn_server.go:291: [SIEVE-AFTER-READ]	Get	true	rabbitmqcluster	default	rabbitmq-cluster	github.com/rabbitmq/cluster-operator/controllers.(*RabbitmqClusterReconciler)	NoError	{"kind":"RabbitmqCluster","apiVersion":"rabbitmq.com/v1beta1","metadata":{"name":"rabbitmq-cluster","namespace":"default","selfLink":"/apis/rabbitmq.com/v1beta1/namespaces/default/rabbitmqclusters/rabbitmq-cluster","uid":"18d9928b-0d1c-47be-80ec-20960d053827","resourceVersion":"746","generation":2,"creationTimestamp":"2022-03-18T18:00:38Z","annotations":{"kubectl.kubernetes.io/last-applied-configuration":"{\"apiVersion\":\"rabbitmq.com/v1beta1\",\"kind\":\"RabbitmqCluster\",\"metadata\":{\"annotations\":{},\"name\":\"rabbitmq-cluster\",\"namespace\":\"default\"},\"spec\":{\"persistence\":{\"storage\":\"10Gi\"},\"replicas\":1}}\n"},"finalizers":["deletion.finalizers.rabbitmqclusters.rabbitmq.com"],"managedFields":[{"manager":"kubectl-client-side-apply","operation":"Update","apiVersion":"rabbitmq.com/v1beta1","time":"2022-03-18T18:00:38Z","fieldsType":"FieldsV1","fieldsV1":{"f:metadata":{"f:annotations":{".":{},"f:kubectl.kubernetes.io/last-applied-configuration":{}}},"f:spec":{".":{},"f:image":{},"f:persistence":{".":{},"f:storage":{}},"f:replicas":{},"f:resources":{".":{},"f:limits":{".":{},"f:memory":{}},"f:requests":{".":{},"f:memory":{}}},"f:service":{".":{},"f:type":{}},"f:terminationGracePeriodSeconds":{}}}},{"manager":"manager","operation":"Update","apiVersion":"rabbitmq.com/v1beta1","time":"2022-03-18T18:00:38Z","fieldsType":"FieldsV1","fieldsV1":{"f:metadata":{"f:finalizers":{}},"f:spec":{"f:override":{},"f:rabbitmq":{},"f:resources":{"f:limits":{"f:cpu":{}},"f:requests":{"f:cpu":{}}},"f:tls":{}},"f:status":{".":{},"f:conditions":{},"f:defaultUser":{".":{},"f:secretReference":{".":{},"f:keys":{".":{},"f:password":{},"f:username":{}},"f:name":{},"f:namespace":{}},"f:serviceReference":{".":{},"f:name":{},"f:namespace":{}}}}}}]},"spec":{"replicas":1,"image":"rabbitmq:3.8.12-management","service":{"type":"ClusterIP"},"persistence":{"storage":"10Gi"},"resources":{"limits":{"cpu":"2","memory":"2Gi"},"requests":{"cpu":"1","memory":"2Gi"}},"rabbitmq":{},"tls":{},"override":{},"terminationGracePeriodSeconds":604800},"status":{"conditions":[{"type":"AllReplicasReady","status":"False","lastTransitionTime":"2022-03-18T18:00:38Z","reason":"NotAllPodsReady","message":"0/1 Pods ready"},{"type":"ClusterAvailable","status":"False","lastTransitionTime":"2022-03-18T18:00:38Z","reason":"NoEndpointsAvailable","message":"The service has no endpoints available"},{"type":"NoWarnings","status":"True","lastTransitionTime":"2022-03-18T18:00:38Z","reason":"NoWarnings"},{"type":"ReconcileSuccess","status":"Unknown","lastTransitionTime":"2022-03-18T18:00:38Z","reason":"Initialising"}],"defaultUser":{"secretReference":{"name":"rabbitmq-cluster-default-user","namespace":"default","keys":{"password":"password","username":"username"}},"serviceReference":{"name":"rabbitmq-cluster","namespace":"default"}}}}
2022/03/18 18:01:08 learn_server.go:291: [SIEVE-AFTER-READ]	Get	true	statefulset	default	rabbitmq-cluster-server	github.com/rabbitmq/cluster-operator/controllers.(*RabbitmqClusterReconciler)	NoError	{"kind":"StatefulSet","apiVersion":"apps/v1","metadata":{"name":"rabbitmq-cluster-server","namespace":"default","selfLink":"/apis/apps/v1/namespaces/default/statefulsets/rabbitmq-cluster-server","uid":"cb5c43bc-6ee7-481c-ab01-6f3acffdd3c8","resourceVersion":"744","generation":1,"creationTimestamp":"2022-03-18T18:00:38Z","labels":{"app.kubernetes.io/component":"rabbitmq","app.kubernetes.io/name":"rabbitmq-cluster","app.kubernetes.io/part-of":"rabbitmq"},"annotations":{"rabbitmq.com/createdAt":"2022-03-18T18:00:38Z"},"ownerReferences":[{"apiVersion":"rabbitmq.com/v1beta1","kind":"RabbitmqCluster","name":"rabbitmq-cluster","uid":"18d9928b-0d1c-47be-80ec-20960d053827","controller":true,"blockOwnerDeletion":true}],"managedFields":[{"manager":"kube-controller-manager","operation":"Update","apiVersion":"apps/v1","time":"2022-03-18T18:00:38Z","fieldsType":"FieldsV1","fieldsV1":{"f:status":{"f:collisionCount":{},"f:currentReplicas":{},"f:currentRevision":{},"f:observedGeneration":{},"f:replicas":{},"f:updateRevision":{},"f:updatedReplicas":{}}}},{"manager":"manager","operation":"Update","apiVersion":"apps/v1","time":"2022-03-18T18:00:38Z","fieldsType":"FieldsV1","fieldsV1":{"f:metadata":{"f:annotations":{".":{},"f:rabbitmq.com/createdAt":{}},"f:labels":{".":{},"f:app.kubernetes.io/component":{},"f:app.kubernetes.io/name":{},"f:app.kubernetes.io/part-of":{}},"f:ownerReferences":{".":{},"k:{\"uid\":\"18d9928b-0d1c-47be-80ec-20960d053827\"}":{".":{},"f:apiVersion":{},"f:blockOwnerDeletion":{},"f:controller":{},"f:kind":{},"f:name":{},"f:uid":{}}}},"f:spec":{"f:podManagementPolicy":{},"f:replicas":{},"f:revisionHistoryLimit":{},"f:selector":{"f:matchLabels":{".":{},"f:app.kubernetes.io/name":{}}},"f:serviceName":{},"f:template":{"f:metadata":{"f:annotations":{".":{},"f:prometheus.io/port":{},"f:prometheus.io/scrape":{}},"f:labels":{".":{},"f:app.kubernetes.io/component":{},"f:app.kubernetes.io/name":{},"f:app.kubernetes.io/part-of":{}}},"f:spec":{"f:automountServiceAccountToken":{},"f:containers":{"k:{\"name\":\"rabbitmq\"}":{".":{},"f:env":{".":{},"k:{\"name\":\"K8S_HOSTNAME_SUFFIX\"}":{".":{},"f:name":{},"f:value":{}},"k:{\"name\":\"K8S_SERVICE_NAME\"}":{".":{},"f:name":{},"f:value":{}},"k:{\"name\":\"MY_POD_NAME\"}":{".":{},"f:name":{},"f:valueFrom":{".":{},"f:fieldRef":{".":{},"f:apiVersion":{},"f:fieldPath":{}}}},"k:{\"name\":\"MY_POD_NAMESPACE\"}":{".":{},"f:name":{},"f:valueFrom":{".":{},"f:fieldRef":{".":{},"f:apiVersion":{},"f:fieldPath":{}}}},"k:{\"name\":\"RABBITMQ_ENABLED_PLUGINS_FILE\"}":{".":{},"f:name":{},"f:value":{}},"k:{\"name\":\"RABBITMQ_NODENAME\"}":{".":{},"f:name":{},"f:value":{}},"k:{\"name\":\"RABBITMQ_USE_LONGNAME\"}":{".":{},"f:name":{},"f:value":{}}},"f:image":{},"f:imagePullPolicy":{},"f:lifecycle":{".":{},"f:preStop":{".":{},"f:exec":{".":{},"f:command":{}}}},"f:name":{},"f:ports":{".":{},"k:{\"containerPort\":4369,\"protocol\":\"TCP\"}":{".":{},"f:containerPort":{},"f:name":{},"f:protocol":{}},"k:{\"containerPort\":5672,\"protocol\":\"TCP\"}":{".":{},"f:containerPort":{},"f:name":{},"f:protocol":{}},"k:{\"containerPort\":15672,\"protocol\":\"TCP\"}":{".":{},"f:containerPort":{},"f:name":{},"f:protocol":{}},"k:{\"containerPort\":15692,\"protocol\":\"TCP\"}":{".":{},"f:containerPort":{},"f:name":{},"f:protocol":{}}},"f:readinessProbe":{".":{},"f:failureThreshold":{},"f:initialDelaySeconds":{},"f:periodSeconds":{},"f:successThreshold":{},"f:tcpSocket":{".":{},"f:port":{}},"f:timeoutSeconds":{}},"f:resources":{".":{},"f:limits":{".":{},"f:cpu":{},"f:memory":{}},"f:requests":{".":{},"f:cpu":{},"f:memory":{}}},"f:terminationMessagePath":{},"f:terminationMessagePolicy":{},"f:volumeMounts":{".":{},"k:{\"mountPath\":\"/etc/pod-info/\"}":{".":{},"f:mountPath":{},"f:name":{}},"k:{\"mountPath\":\"/etc/rabbitmq/conf.d/10-operatorDefaults.conf\"}":{".":{},"f:mountPath":{},"f:name":{},"f:subPath":{}},"k:{\"mountPath\":\"/etc/rabbitmq/conf.d/11-default_user.conf\"}":{".":{},"f:mountPath":{},"f:name":{},"f:subPath":{}},"k:{\"mountPath\":\"/etc/rabbitmq/conf.d/90-userDefinedConfiguration.conf\"}":{".":{},"f:mountPath":{},"f:name":{},"f:subPath":{}},"k:{\"mountPath\":\"/operator\"}":{".":{},"f:mountPath":{},"f:name":{}},"k:{\"mountPath\":\"/var/lib/rabbitmq/\"}":{".":{},"f:mountPath":{},"f:name":{}},"k:{\"mountPath\":\"/var/lib/rabbitmq/mnesia/\"}":{".":{},"f:mountPath":{},"f:name":{}}}}},"f:dnsPolicy":{},"f:initContainers":{".":{},"k:{\"name\":\"setup-container\"}":{".":{},"f:command":{},"f:image":{},"f:imagePullPolicy":{},"f:name":{},"f:resources":{".":{},"f:limits":{".":{},"f:cpu":{},"f:memory":{}},"f:requests":{".":{},"f:cpu":{},"f:memory":{}}},"f:securityContext":{".":{},"f:capabilities":{".":{},"f:drop":{}},"f:runAsUser":{}},"f:terminationMessagePath":{},"f:terminationMessagePolicy":{},"f:volumeMounts":{".":{},"k:{\"mountPath\":\"/operator\"}":{".":{},"f:mountPath":{},"f:name":{}},"k:{\"mountPath\":\"/tmp/default_user.conf\"}":{".":{},"f:mountPath":{},"f:name":{},"f:subPath":{}},"k:{\"mountPath\":\"/tmp/erlang-cookie-secret/\"}":{".":{},"f:mountPath":{},"f:name":{}},"k:{\"mountPath\":\"/tmp/rabbitmq-plugins/\"}":{".":{},"f:mountPath":{},"f:name":{}},"k:{\"mountPath\":\"/var/lib/rabbitmq/\"}":{".":{},"f:mountPath":{},"f:name":{}},"k:{\"mountPath\":\"/var/lib/rabbitmq/mnesia/\"}":{".":{},"f:mountPath":{},"f:name":{}}}}},"f:restartPolicy":{},"f:schedulerName":{},"f:securityContext":{".":{},"f:fsGroup":{},"f:runAsGroup":{},"f:runAsUser":{}},"f:serviceAccount":{},"f:serviceAccountName":{},"f:terminationGracePeriodSeconds":{},"f:topologySpreadConstraints":{".":{},"k:{\"topologyKey\":\"topology.kubernetes.io/zone\",\"whenUnsatisfiable\":\"ScheduleAnyway\"}":{".":{},"f:labelSelector":{".":{},"f:matchLabels":{".":{},"f:app.kubernetes.io/name":{}}},"f:maxSkew":{},"f:topologyKey":{},"f:whenUnsatisfiable":{}}},"f:volumes":{".":{},"k:{\"name\":\"erlang-cookie-secret\"}":{".":{},"f:name":{},"f:secret":{".":{},"f:defaultMode":{},"f:secretName":{}}},"k:{\"name\":\"plugins-conf\"}":{".":{},"f:configMap":{".":{},"f:defaultMode":{},"f:name":{}},"f:name":{}},"k:{\"name\":\"pod-info\"}":{".":{},"f:downwardAPI":{".":{},"f:defaultMode":{},"f:items":{}},"f:name":{}},"k:{\"name\":\"rabbitmq-confd\"}":{".":{},"f:name":{},"f:projected":{".":{},"f:defaultMode":{},"f:sources":{}}},"k:{\"name\":\"rabbitmq-erlang-cookie\"}":{".":{},"f:emptyDir":{},"f:name":{}},"k:{\"name\":\"rabbitmq-plugins\"}":{".":{},"f:emptyDir":{},"f:name":{}}}}},"f:updateStrategy":{"f:rollingUpdate":{".":{},"f:partition":{}},"f:type":{}},"f:volumeClaimTemplates":{}}}}]},"spec":{"replicas":1,"selector":{"matchLabels":{"app.kubernetes.io/name":"rabbitmq-cluster"}},"template":{"metadata":{"creationTimestamp":null,"labels":{"app.kubernetes.io/component":"rabbitmq","app.kubernetes.io/name":"rabbitmq-cluster","app.kubernetes.io/part-of":"rabbitmq"},"annotations":{"prometheus.io/port":"15692","prometheus.io/scrape":"true"}},"spec":{"volumes":[{"name":"plugins-conf","configMap":{"name":"rabbitmq-cluster-plugins-conf","defaultMode":420}},{"name":"rabbitmq-confd","projected":{"sources":[{"secret":{"name":"rabbitmq-cluster-default-user","items":[{"key":"default_user.conf","path":"default_user.conf"}]}},{"configMap":{"name":"rabbitmq-cluster-server-conf","items":[{"key":"operatorDefaults.conf","path":"operatorDefaults.conf"},{"key":"userDefinedConfiguration.conf","path":"userDefinedConfiguration.conf"}]}}],"defaultMode":420}},{"name":"rabbitmq-erlang-cookie","emptyDir":{}},{"name":"erlang-cookie-secret","secret":{"secretName":"rabbitmq-cluster-erlang-cookie","defaultMode":420}},{"name":"rabbitmq-plugins","emptyDir":{}},{"name":"pod-info","downwardAPI":{"items":[{"path":"skipPreStopChecks","fieldRef":{"apiVersion":"v1","fieldPath":"metadata.labels['skipPreStopChecks']"}}],"defaultMode":420}}],"initContainers":[{"name":"setup-container","image":"rabbitmq:3.8.12-management","command":["sh","-c","cp /tmp/erlang-cookie-secret/.erlang.cookie /var/lib/rabbitmq/.erlang.cookie \u0026\u0026 chown 999:999 /var/lib/rabbitmq/.erlang.cookie \u0026\u0026 chmod 600 /var/lib/rabbitmq/.erlang.cookie ; cp /tmp/rabbitmq-plugins/enabled_plugins /operator/enabled_plugins \u0026\u0026 chown 999:999 /operator/enabled_plugins ; chown 999:999 /var/lib/rabbitmq/mnesia/ ; echo '[default]' \u003e /var/lib/rabbitmq/.rabbitmqadmin.conf \u0026\u0026 sed -e 's/default_user/username/' -e 's/default_pass/password/' /tmp/default_user.conf \u003e\u003e /var/lib/rabbitmq/.rabbitmqadmin.conf \u0026\u0026 chown 999:999 /var/lib/rabbitmq/.rabbitmqadmin.conf \u0026\u0026 chmod 600 /var/lib/rabbitmq/.rabbitmqadmin.conf"],"resources":{"limits":{"cpu":"100m","memory":"500Mi"},"requests":{"cpu":"100m","memory":"500Mi"}},"volumeMounts":[{"name":"plugins-conf","mountPath":"/tmp/rabbitmq-plugins/"},{"name":"rabbitmq-erlang-cookie","mountPath":"/var/lib/rabbitmq/"},{"name":"erlang-cookie-secret","mountPath":"/tmp/erlang-cookie-secret/"},{"name":"rabbitmq-plugins","mountPath":"/operator"},{"name":"persistence","mountPath":"/var/lib/rabbitmq/mnesia/"},{"name":"rabbitmq-confd","mountPath":"/tmp/default_user.conf","subPath":"default_user.conf"}],"terminationMessagePath":"/dev/termination-log","terminationMessagePolicy":"File","imagePullPolicy":"IfNotPresent","securityContext":{"capabilities":{"drop":["FSETID","KILL","SETGID","SETUID","SETPCAP","NET_BIND_SERVICE","NET_RAW","SYS_CHROOT","MKNOD","AUDIT_WRITE","SETFCAP"]},"runAsUser":0}}],"containers":[{"name":"rabbitmq","image":"rabbitmq:3.8.12-management","ports":[{"name":"epmd","containerPort":4369,"protocol":"TCP"},{"name":"amqp","containerPort":5672,"protocol":"TCP"},{"name":"management","containerPort":15672,"protocol":"TCP"},{"name":"prometheus","containerPort":15692,"protocol":"TCP"}],"env":[{"name":"MY_POD_NAME","valueFrom":{"fieldRef":{"apiVersion":"v1","fieldPath":"metadata.name"}}},{"name":"MY_POD_NAMESPACE","valueFrom":{"fieldRef":{"apiVersion":"v1","fieldPath":"metadata.namespace"}}},{"name":"RABBITMQ_ENABLED_PLUGINS_FILE","value":"/operator/enabled_plugins"},{"name":"K8S_SERVICE_NAME","value":"rabbitmq-cluster-nodes"},{"name":"RABBITMQ_USE_LONGNAME","value":"true"},{"name":"RABBITMQ_NODENAME","value":"rabbit@$(MY_POD_NAME).$(K8S_SERVICE_NAME).$(MY_POD_NAMESPACE)"},{"name":"K8S_HOSTNAME_SUFFIX","value":".$(K8S_SERVICE_NAME).$(MY_POD_NAMESPACE)"}],"resources":{"limits":{"cpu":"2","memory":"2Gi"},"requests":{"cpu":"1","memory":"2Gi"}},"volumeMounts":[{"name":"rabbitmq-erlang-cookie","mountPath":"/var/lib/rabbitmq/"},{"name":"persistence","mountPath":"/var/lib/rabbitmq/mnesia/"},{"name":"rabbitmq-plugins","mountPath":"/operator"},{"name":"rabbitmq-confd","mountPath":"/etc/rabbitmq/conf.d/10-operatorDefaults.conf","subPath":"operatorDefaults.conf"},{"name":"rabbitmq-confd","mountPath":"/etc/rabbitmq/conf.d/11-default_user.conf","subPath":"default_user.conf"},{"name":"rabbitmq-confd","mountPath":"/etc/rabbitmq/conf.d/90-userDefinedConfiguration.conf","subPath":"userDefinedConfiguration.conf"},{"name":"pod-info","mountPath":"/etc/pod-info/"}],"readinessProbe":{"tcpSocket":{"port":"amqp"},"initialDelaySeconds":10,"timeoutSeconds":5,"periodSeconds":10,"successThreshold":1,"failureThreshold":3},"lifecycle":{"preStop":{"exec":{"command":["/bin/bash","-c","if [ ! -z \"$(cat /etc/pod-info/skipPreStopChecks)\" ]; then exit 0; fi; rabbitmq-upgrade await_online_quorum_plus_one -t 604800; rabbitmq-upgrade await_online_synchronized_mirror -t 604800; rabbitmq-upgrade drain -t 604800"]}}},"terminationMessagePath":"/dev/termination-log","terminationMessagePolicy":"File","imagePullPolicy":"IfNotPresent"}],"restartPolicy":"Always","terminationGracePeriodSeconds":604800,"dnsPolicy":"ClusterFirst","serviceAccountName":"rabbitmq-cluster-server","serviceAccount":"rabbitmq-cluster-server","automountServiceAccountToken":true,"securityContext":{"runAsUser":999,"runAsGroup":999,"fsGroup":999},"schedulerName":"default-scheduler","topologySpreadConstraints":[{"maxSkew":1,"topologyKey":"topology.kubernetes.io/zone","whenUnsatisfiable":"ScheduleAnyway","labelSelector":{"matchLabels":{"app.kubernetes.io/name":"rabbitmq-cluster"}}}]}},"volumeClaimTemplates":[{"metadata":{"name":"persistence","namespace":"default","creationTimestamp":null,"labels":{"app.kubernetes.io/component":"rabbitmq","app.kubernetes.io/name":"rabbitmq-cluster","app.kubernetes.io/part-of":"rabbitmq"},"ownerReferences":[{"apiVersion":"rabbitmq.com/v1beta1","kind":"RabbitmqCluster","name":"rabbitmq-cluster","uid":"18d9928b-0d1c-47be-80ec-20960d053827","controller":true,"blockOwnerDeletion":false}]},"spec":{"accessModes":["ReadWriteOnce"],"resources":{"requests":{"storage":"10Gi"}},"volumeMode":"Filesystem"},"status":{"phase":"Pending"}}],"serviceName":"rabbitmq-cluster-nodes","podManagementPolicy":"Parallel","updateStrategy":{"type":"RollingUpdate","rollingUpdate":{"partition":0}},"revisionHistoryLimit":10},"status":{"observedGeneration":1,"replicas":1,"currentReplicas":1,"updatedReplicas":1,"currentRevision":"rabbitmq-cluster-server-5f8b8665fb","updateRevision":"rabbitmq-cluster-server-5f8b8665fb","collisionCount":0}}
2022/03/18 18:01:08 learn_server.go:291: [SIEVE-AFTER-READ]	Get	true	endpoints	default	rabbitmq-cluster	github.com/rabbitmq/cluster-operator/controllers.(*RabbitmqClusterReconciler)	NoError	{"kind":"Endpoints","apiVersion":"v1","metadata":{"name":"rabbitmq-cluster","namespace":"default","selfLink":"/api/v1/namespaces/default/endpoints/rabbitmq-cluster","uid":"5c4723ad-f4fe-442d-9135-44879a2a8183","resourceVersion":"802","creationTimestamp":"2022-03-18T18:00:38Z","labels":{"app.kubernetes.io/component":"rabbitmq","app.kubernetes.io/name":"rabbitmq-cluster","app.kubernetes.io/part-of":"rabbitmq"},"annotations":{"endpoints.kubernetes.io/last-change-trigger-time":"2022-03-18T18:00:41Z"},"managedFields":[{"manager":"kube-controller-manager","operation":"Update","apiVersion":"v1","time":"2022-03-18T18:00:46Z","fieldsType":"FieldsV1","fieldsV1":{"f:metadata":{"f:annotations":{".":{},"f:endpoints.kubernetes.io/last-change-trigger-time":{}},"f:labels":{".":{},"f:app.kubernetes.io/component":{},"f:app.kubernetes.io/name":{},"f:app.kubernetes.io/part-of":{}}},"f:subsets":{}}}]},"subsets":[{"notReadyAddresses":[{"ip":"10.244.1.4","nodeName":"kind-worker2","targetRef":{"kind":"Pod","namespace":"default","name":"rabbitmq-cluster-server-0","uid":"e7faffc5-b656-4e69-9777-92d12cb6ec5a","resourceVersion":"798"}}],"ports":[{"name":"amqp","port":5672,"protocol":"TCP"},{"name":"management","port":15672,"protocol":"TCP"}]}]}
2022/03/18 18:01:08 learn_server.go:291: [SIEVE-AFTER-READ]	Get	true	statefulset	default	rabbitmq-cluster-server	github.com/rabbitmq/cluster-operator/controllers.(*RabbitmqClusterReconciler)	NoError	{"kind":"StatefulSet","apiVersion":"apps/v1","metadata":{"name":"rabbitmq-cluster-server","namespace":"default","selfLink":"/apis/apps/v1/namespaces/default/statefulsets/rabbitmq-cluster-server","uid":"cb5c43bc-6ee7-481c-ab01-6f3acffdd3c8","resourceVersion":"744","generation":1,"creationTimestamp":"2022-03-18T18:00:38Z","labels":{"app.kubernetes.io/component":"rabbitmq","app.kubernetes.io/name":"rabbitmq-cluster","app.kubernetes.io/part-of":"rabbitmq"},"annotations":{"rabbitmq.com/createdAt":"2022-03-18T18:00:38Z"},"ownerReferences":[{"apiVersion":"rabbitmq.com/v1beta1","kind":"RabbitmqCluster","name":"rabbitmq-cluster","uid":"18d9928b-0d1c-47be-80ec-20960d053827","controller":true,"blockOwnerDeletion":true}],"managedFields":[{"manager":"kube-controller-manager","operation":"Update","apiVersion":"apps/v1","time":"2022-03-18T18:00:38Z","fieldsType":"FieldsV1","fieldsV1":{"f:status":{"f:collisionCount":{},"f:currentReplicas":{},"f:currentRevision":{},"f:observedGeneration":{},"f:replicas":{},"f:updateRevision":{},"f:updatedReplicas":{}}}},{"manager":"manager","operation":"Update","apiVersion":"apps/v1","time":"2022-03-18T18:00:38Z","fieldsType":"FieldsV1","fieldsV1":{"f:metadata":{"f:annotations":{".":{},"f:rabbitmq.com/createdAt":{}},"f:labels":{".":{},"f:app.kubernetes.io/component":{},"f:app.kubernetes.io/name":{},"f:app.kubernetes.io/part-of":{}},"f:ownerReferences":{".":{},"k:{\"uid\":\"18d9928b-0d1c-47be-80ec-20960d053827\"}":{".":{},"f:apiVersion":{},"f:blockOwnerDeletion":{},"f:controller":{},"f:kind":{},"f:name":{},"f:uid":{}}}},"f:spec":{"f:podManagementPolicy":{},"f:replicas":{},"f:revisionHistoryLimit":{},"f:selector":{"f:matchLabels":{".":{},"f:app.kubernetes.io/name":{}}},"f:serviceName":{},"f:template":{"f:metadata":{"f:annotations":{".":{},"f:prometheus.io/port":{},"f:prometheus.io/scrape":{}},"f:labels":{".":{},"f:app.kubernetes.io/component":{},"f:app.kubernetes.io/name":{},"f:app.kubernetes.io/part-of":{}}},"f:spec":{"f:automountServiceAccountToken":{},"f:containers":{"k:{\"name\":\"rabbitmq\"}":{".":{},"f:env":{".":{},"k:{\"name\":\"K8S_HOSTNAME_SUFFIX\"}":{".":{},"f:name":{},"f:value":{}},"k:{\"name\":\"K8S_SERVICE_NAME\"}":{".":{},"f:name":{},"f:value":{}},"k:{\"name\":\"MY_POD_NAME\"}":{".":{},"f:name":{},"f:valueFrom":{".":{},"f:fieldRef":{".":{},"f:apiVersion":{},"f:fieldPath":{}}}},"k:{\"name\":\"MY_POD_NAMESPACE\"}":{".":{},"f:name":{},"f:valueFrom":{".":{},"f:fieldRef":{".":{},"f:apiVersion":{},"f:fieldPath":{}}}},"k:{\"name\":\"RABBITMQ_ENABLED_PLUGINS_FILE\"}":{".":{},"f:name":{},"f:value":{}},"k:{\"name\":\"RABBITMQ_NODENAME\"}":{".":{},"f:name":{},"f:value":{}},"k:{\"name\":\"RABBITMQ_USE_LONGNAME\"}":{".":{},"f:name":{},"f:value":{}}},"f:image":{},"f:imagePullPolicy":{},"f:lifecycle":{".":{},"f:preStop":{".":{},"f:exec":{".":{},"f:command":{}}}},"f:name":{},"f:ports":{".":{},"k:{\"containerPort\":4369,\"protocol\":\"TCP\"}":{".":{},"f:containerPort":{},"f:name":{},"f:protocol":{}},"k:{\"containerPort\":5672,\"protocol\":\"TCP\"}":{".":{},"f:containerPort":{},"f:name":{},"f:protocol":{}},"k:{\"containerPort\":15672,\"protocol\":\"TCP\"}":{".":{},"f:containerPort":{},"f:name":{},"f:protocol":{}},"k:{\"containerPort\":15692,\"protocol\":\"TCP\"}":{".":{},"f:containerPort":{},"f:name":{},"f:protocol":{}}},"f:readinessProbe":{".":{},"f:failureThreshold":{},"f:initialDelaySeconds":{},"f:periodSeconds":{},"f:successThreshold":{},"f:tcpSocket":{".":{},"f:port":{}},"f:timeoutSeconds":{}},"f:resources":{".":{},"f:limits":{".":{},"f:cpu":{},"f:memory":{}},"f:requests":{".":{},"f:cpu":{},"f:memory":{}}},"f:terminationMessagePath":{},"f:terminationMessagePolicy":{},"f:volumeMounts":{".":{},"k:{\"mountPath\":\"/etc/pod-info/\"}":{".":{},"f:mountPath":{},"f:name":{}},"k:{\"mountPath\":\"/etc/rabbitmq/conf.d/10-operatorDefaults.conf\"}":{".":{},"f:mountPath":{},"f:name":{},"f:subPath":{}},"k:{\"mountPath\":\"/etc/rabbitmq/conf.d/11-default_user.conf\"}":{".":{},"f:mountPath":{},"f:name":{},"f:subPath":{}},"k:{\"mountPath\":\"/etc/rabbitmq/conf.d/90-userDefinedConfiguration.conf\"}":{".":{},"f:mountPath":{},"f:name":{},"f:subPath":{}},"k:{\"mountPath\":\"/operator\"}":{".":{},"f:mountPath":{},"f:name":{}},"k:{\"mountPath\":\"/var/lib/rabbitmq/\"}":{".":{},"f:mountPath":{},"f:name":{}},"k:{\"mountPath\":\"/var/lib/rabbitmq/mnesia/\"}":{".":{},"f:mountPath":{},"f:name":{}}}}},"f:dnsPolicy":{},"f:initContainers":{".":{},"k:{\"name\":\"setup-container\"}":{".":{},"f:command":{},"f:image":{},"f:imagePullPolicy":{},"f:name":{},"f:resources":{".":{},"f:limits":{".":{},"f:cpu":{},"f:memory":{}},"f:requests":{".":{},"f:cpu":{},"f:memory":{}}},"f:securityContext":{".":{},"f:capabilities":{".":{},"f:drop":{}},"f:runAsUser":{}},"f:terminationMessagePath":{},"f:terminationMessagePolicy":{},"f:volumeMounts":{".":{},"k:{\"mountPath\":\"/operator\"}":{".":{},"f:mountPath":{},"f:name":{}},"k:{\"mountPath\":\"/tmp/default_user.conf\"}":{".":{},"f:mountPath":{},"f:name":{},"f:subPath":{}},"k:{\"mountPath\":\"/tmp/erlang-cookie-secret/\"}":{".":{},"f:mountPath":{},"f:name":{}},"k:{\"mountPath\":\"/tmp/rabbitmq-plugins/\"}":{".":{},"f:mountPath":{},"f:name":{}},"k:{\"mountPath\":\"/var/lib/rabbitmq/\"}":{".":{},"f:mountPath":{},"f:name":{}},"k:{\"mountPath\":\"/var/lib/rabbitmq/mnesia/\"}":{".":{},"f:mountPath":{},"f:name":{}}}}},"f:restartPolicy":{},"f:schedulerName":{},"f:securityContext":{".":{},"f:fsGroup":{},"f:runAsGroup":{},"f:runAsUser":{}},"f:serviceAccount":{},"f:serviceAccountName":{},"f:terminationGracePeriodSeconds":{},"f:topologySpreadConstraints":{".":{},"k:{\"topologyKey\":\"topology.kubernetes.io/zone\",\"whenUnsatisfiable\":\"ScheduleAnyway\"}":{".":{},"f:labelSelector":{".":{},"f:matchLabels":{".":{},"f:app.kubernetes.io/name":{}}},"f:maxSkew":{},"f:topologyKey":{},"f:whenUnsatisfiable":{}}},"f:volumes":{".":{},"k:{\"name\":\"erlang-cookie-secret\"}":{".":{},"f:name":{},"f:secret":{".":{},"f:defaultMode":{},"f:secretName":{}}},"k:{\"name\":\"plugins-conf\"}":{".":{},"f:configMap":{".":{},"f:defaultMode":{},"f:name":{}},"f:name":{}},"k:{\"name\":\"pod-info\"}":{".":{},"f:downwardAPI":{".":{},"f:defaultMode":{},"f:items":{}},"f:name":{}},"k:{\"name\":\"rabbitmq-confd\"}":{".":{},"f:name":{},"f:projected":{".":{},"f:defaultMode":{},"f:sources":{}}},"k:{\"name\":\"rabbitmq-erlang-cookie\"}":{".":{},"f:emptyDir":{},"f:name":{}},"k:{\"name\":\"rabbitmq-plugins\"}":{".":{},"f:emptyDir":{},"f:name":{}}}}},"f:updateStrategy":{"f:rollingUpdate":{".":{},"f:partition":{}},"f:type":{}},"f:volumeClaimTemplates":{}}}}]},"spec":{"replicas":1,"selector":{"matchLabels":{"app.kubernetes.io/name":"rabbitmq-cluster"}},"template":{"metadata":{"creationTimestamp":null,"labels":{"app.kubernetes.io/component":"rabbitmq","app.kubernetes.io/name":"rabbitmq-cluster","app.kubernetes.io/part-of":"rabbitmq"},"annotations":{"prometheus.io/port":"15692","prometheus.io/scrape":"true"}},"spec":{"volumes":[{"name":"plugins-conf","configMap":{"name":"rabbitmq-cluster-plugins-conf","defaultMode":420}},{"name":"rabbitmq-confd","projected":{"sources":[{"secret":{"name":"rabbitmq-cluster-default-user","items":[{"key":"default_user.conf","path":"default_user.conf"}]}},{"configMap":{"name":"rabbitmq-cluster-server-conf","items":[{"key":"operatorDefaults.conf","path":"operatorDefaults.conf"},{"key":"userDefinedConfiguration.conf","path":"userDefinedConfiguration.conf"}]}}],"defaultMode":420}},{"name":"rabbitmq-erlang-cookie","emptyDir":{}},{"name":"erlang-cookie-secret","secret":{"secretName":"rabbitmq-cluster-erlang-cookie","defaultMode":420}},{"name":"rabbitmq-plugins","emptyDir":{}},{"name":"pod-info","downwardAPI":{"items":[{"path":"skipPreStopChecks","fieldRef":{"apiVersion":"v1","fieldPath":"metadata.labels['skipPreStopChecks']"}}],"defaultMode":420}}],"initContainers":[{"name":"setup-container","image":"rabbitmq:3.8.12-management","command":["sh","-c","cp /tmp/erlang-cookie-secret/.erlang.cookie /var/lib/rabbitmq/.erlang.cookie \u0026\u0026 chown 999:999 /var/lib/rabbitmq/.erlang.cookie \u0026\u0026 chmod 600 /var/lib/rabbitmq/.erlang.cookie ; cp /tmp/rabbitmq-plugins/enabled_plugins /operator/enabled_plugins \u0026\u0026 chown 999:999 /operator/enabled_plugins ; chown 999:999 /var/lib/rabbitmq/mnesia/ ; echo '[default]' \u003e /var/lib/rabbitmq/.rabbitmqadmin.conf \u0026\u0026 sed -e 's/default_user/username/' -e 's/default_pass/password/' /tmp/default_user.conf \u003e\u003e /var/lib/rabbitmq/.rabbitmqadmin.conf \u0026\u0026 chown 999:999 /var/lib/rabbitmq/.rabbitmqadmin.conf \u0026\u0026 chmod 600 /var/lib/rabbitmq/.rabbitmqadmin.conf"],"resources":{"limits":{"cpu":"100m","memory":"500Mi"},"requests":{"cpu":"100m","memory":"500Mi"}},"volumeMounts":[{"name":"plugins-conf","mountPath":"/tmp/rabbitmq-plugins/"},{"name":"rabbitmq-erlang-cookie","mountPath":"/var/lib/rabbitmq/"},{"name":"erlang-cookie-secret","mountPath":"/tmp/erlang-cookie-secret/"},{"name":"rabbitmq-plugins","mountPath":"/operator"},{"name":"persistence","mountPath":"/var/lib/rabbitmq/mnesia/"},{"name":"rabbitmq-confd","mountPath":"/tmp/default_user.conf","subPath":"default_user.conf"}],"terminationMessagePath":"/dev/termination-log","terminationMessagePolicy":"File","imagePullPolicy":"IfNotPresent","securityContext":{"capabilities":{"drop":["FSETID","KILL","SETGID","SETUID","SETPCAP","NET_BIND_SERVICE","NET_RAW","SYS_CHROOT","MKNOD","AUDIT_WRITE","SETFCAP"]},"runAsUser":0}}],"containers":[{"name":"rabbitmq","image":"rabbitmq:3.8.12-management","ports":[{"name":"epmd","containerPort":4369,"protocol":"TCP"},{"name":"amqp","containerPort":5672,"protocol":"TCP"},{"name":"management","containerPort":15672,"protocol":"TCP"},{"name":"prometheus","containerPort":15692,"protocol":"TCP"}],"env":[{"name":"MY_POD_NAME","valueFrom":{"fieldRef":{"apiVersion":"v1","fieldPath":"metadata.name"}}},{"name":"MY_POD_NAMESPACE","valueFrom":{"fieldRef":{"apiVersion":"v1","fieldPath":"metadata.namespace"}}},{"name":"RABBITMQ_ENABLED_PLUGINS_FILE","value":"/operator/enabled_plugins"},{"name":"K8S_SERVICE_NAME","value":"rabbitmq-cluster-nodes"},{"name":"RABBITMQ_USE_LONGNAME","value":"true"},{"name":"RABBITMQ_NODENAME","value":"rabbit@$(MY_POD_NAME).$(K8S_SERVICE_NAME).$(MY_POD_NAMESPACE)"},{"name":"K8S_HOSTNAME_SUFFIX","value":".$(K8S_SERVICE_NAME).$(MY_POD_NAMESPACE)"}],"resources":{"limits":{"cpu":"2","memory":"2Gi"},"requests":{"cpu":"1","memory":"2Gi"}},"volumeMounts":[{"name":"rabbitmq-erlang-cookie","mountPath":"/var/lib/rabbitmq/"},{"name":"persistence","mountPath":"/var/lib/rabbitmq/mnesia/"},{"name":"rabbitmq-plugins","mountPath":"/operator"},{"name":"rabbitmq-confd","mountPath":"/etc/rabbitmq/conf.d/10-operatorDefaults.conf","subPath":"operatorDefaults.conf"},{"name":"rabbitmq-confd","mountPath":"/etc/rabbitmq/conf.d/11-default_user.conf","subPath":"default_user.conf"},{"name":"rabbitmq-confd","mountPath":"/etc/rabbitmq/conf.d/90-userDefinedConfiguration.conf","subPath":"userDefinedConfiguration.conf"},{"name":"pod-info","mountPath":"/etc/pod-info/"}],"readinessProbe":{"tcpSocket":{"port":"amqp"},"initialDelaySeconds":10,"timeoutSeconds":5,"periodSeconds":10,"successThreshold":1,"failureThreshold":3},"lifecycle":{"preStop":{"exec":{"command":["/bin/bash","-c","if [ ! -z \"$(cat /etc/pod-info/skipPreStopChecks)\" ]; then exit 0; fi; rabbitmq-upgrade await_online_quorum_plus_one -t 604800; rabbitmq-upgrade await_online_synchronized_mirror -t 604800; rabbitmq-upgrade drain -t 604800"]}}},"terminationMessagePath":"/dev/termination-log","terminationMessagePolicy":"File","imagePullPolicy":"IfNotPresent"}],"restartPolicy":"Always","terminationGracePeriodSeconds":604800,"dnsPolicy":"ClusterFirst","serviceAccountName":"rabbitmq-cluster-server","serviceAccount":"rabbitmq-cluster-server","automountServiceAccountToken":true,"securityContext":{"runAsUser":999,"runAsGroup":999,"fsGroup":999},"schedulerName":"default-scheduler","topologySpreadConstraints":[{"maxSkew":1,"topologyKey":"topology.kubernetes.io/zone","whenUnsatisfiable":"ScheduleAnyway","labelSelector":{"matchLabels":{"app.kubernetes.io/name":"rabbitmq-cluster"}}}]}},"volumeClaimTemplates":[{"metadata":{"name":"persistence","namespace":"default","creationTimestamp":null,"labels":{"app.kubernetes.io/component":"rabbitmq","app.kubernetes.io/name":"rabbitmq-cluster","app.kubernetes.io/part-of":"rabbitmq"},"ownerReferences":[{"apiVersion":"rabbitmq.com/v1beta1","kind":"RabbitmqCluster","name":"rabbitmq-cluster","uid":"18d9928b-0d1c-47be-80ec-20960d053827","controller":true,"blockOwnerDeletion":false}]},"spec":{"accessModes":["ReadWriteOnce"],"resources":{"requests":{"storage":"10Gi"}},"volumeMode":"Filesystem"},"status":{"phase":"Pending"}}],"serviceName":"rabbitmq-cluster-nodes","podManagementPolicy":"Parallel","updateStrategy":{"type":"RollingUpdate","rollingUpdate":{"partition":0}},"revisionHistoryLimit":10},"status":{"observedGeneration":1,"replicas":1,"currentReplicas":1,"updatedReplicas":1,"currentRevision":"rabbitmq-cluster-server-5f8b8665fb","updateRevision":"rabbitmq-cluster-server-5f8b8665fb","collisionCount":0}}
2022/03/18 18:01:08 learn_server.go:291: [SIEVE-AFTER-READ]	Get	true	service	default	rabbitmq-cluster-nodes	github.com/rabbitmq/cluster-operator/controllers.(*RabbitmqClusterReconciler)	NoError	{"kind":"Service","apiVersion":"v1","metadata":{"name":"rabbitmq-cluster-nodes","namespace":"default","selfLink":"/api/v1/namespaces/default/services/rabbitmq-cluster-nodes","uid":"67c7eea9-1b87-4fd7-82e6-5bfe31fd1b52","resourceVersion":"696","creationTimestamp":"2022-03-18T18:00:38Z","labels":{"app.kubernetes.io/component":"rabbitmq","app.kubernetes.io/name":"rabbitmq-cluster","app.kubernetes.io/part-of":"rabbitmq"},"ownerReferences":[{"apiVersion":"rabbitmq.com/v1beta1","kind":"RabbitmqCluster","name":"rabbitmq-cluster","uid":"18d9928b-0d1c-47be-80ec-20960d053827","controller":true,"blockOwnerDeletion":true}],"managedFields":[{"manager":"manager","operation":"Update","apiVersion":"v1","time":"2022-03-18T18:00:38Z","fieldsType":"FieldsV1","fieldsV1":{"f:metadata":{"f:labels":{".":{},"f:app.kubernetes.io/component":{},"f:app.kubernetes.io/name":{},"f:app.kubernetes.io/part-of":{}},"f:ownerReferences":{".":{},"k:{\"uid\":\"18d9928b-0d1c-47be-80ec-20960d053827\"}":{".":{},"f:apiVersion":{},"f:blockOwnerDeletion":{},"f:controller":{},"f:kind":{},"f:name":{},"f:uid":{}}}},"f:spec":{"f:clusterIP":{},"f:ports":{".":{},"k:{\"port\":4369,\"protocol\":\"TCP\"}":{".":{},"f:name":{},"f:port":{},"f:protocol":{},"f:targetPort":{}},"k:{\"port\":25672,\"protocol\":\"TCP\"}":{".":{},"f:name":{},"f:port":{},"f:protocol":{},"f:targetPort":{}}},"f:publishNotReadyAddresses":{},"f:selector":{".":{},"f:app.kubernetes.io/name":{}},"f:sessionAffinity":{},"f:type":{}}}}]},"spec":{"ports":[{"name":"epmd","protocol":"TCP","port":4369,"targetPort":4369},{"name":"cluster-rpc","protocol":"TCP","port":25672,"targetPort":25672}],"selector":{"app.kubernetes.io/name":"rabbitmq-cluster"},"clusterIP":"None","type":"ClusterIP","sessionAffinity":"None","publishNotReadyAddresses":true},"status":{"loadBalancer":{}}}
2022/03/18 18:01:08 learn_server.go:291: [SIEVE-AFTER-READ]	Get	true	service	default	rabbitmq-cluster	github.com/rabbitmq/cluster-operator/controllers.(*RabbitmqClusterReconciler)	NoError	{"kind":"Service","apiVersion":"v1","metadata":{"name":"rabbitmq-cluster","namespace":"default","selfLink":"/api/v1/namespaces/default/services/rabbitmq-cluster","uid":"56b50671-1945-458b-adac-05619b783392","resourceVersion":"701","creationTimestamp":"2022-03-18T18:00:38Z","labels":{"app.kubernetes.io/component":"rabbitmq","app.kubernetes.io/name":"rabbitmq-cluster","app.kubernetes.io/part-of":"rabbitmq"},"ownerReferences":[{"apiVersion":"rabbitmq.com/v1beta1","kind":"RabbitmqCluster","name":"rabbitmq-cluster","uid":"18d9928b-0d1c-47be-80ec-20960d053827","controller":true,"blockOwnerDeletion":true}],"managedFields":[{"manager":"manager","operation":"Update","apiVersion":"v1","time":"2022-03-18T18:00:38Z","fieldsType":"FieldsV1","fieldsV1":{"f:metadata":{"f:labels":{".":{},"f:app.kubernetes.io/component":{},"f:app.kubernetes.io/name":{},"f:app.kubernetes.io/part-of":{}},"f:ownerReferences":{".":{},"k:{\"uid\":\"18d9928b-0d1c-47be-80ec-20960d053827\"}":{".":{},"f:apiVersion":{},"f:blockOwnerDeletion":{},"f:controller":{},"f:kind":{},"f:name":{},"f:uid":{}}}},"f:spec":{"f:ports":{".":{},"k:{\"port\":5672,\"protocol\":\"TCP\"}":{".":{},"f:name":{},"f:port":{},"f:protocol":{},"f:targetPort":{}},"k:{\"port\":15672,\"protocol\":\"TCP\"}":{".":{},"f:name":{},"f:port":{},"f:protocol":{},"f:targetPort":{}}},"f:selector":{".":{},"f:app.kubernetes.io/name":{}},"f:sessionAffinity":{},"f:type":{}}}}]},"spec":{"ports":[{"name":"amqp","protocol":"TCP","port":5672,"targetPort":5672},{"name":"management","protocol":"TCP","port":15672,"targetPort":15672}],"selector":{"app.kubernetes.io/name":"rabbitmq-cluster"},"clusterIP":"10.96.254.158","type":"ClusterIP","sessionAffinity":"None"},"status":{"loadBalancer":{}}}
2022/03/18 18:01:08 learn_server.go:291: [SIEVE-AFTER-READ]	Get	true	secret	default	rabbitmq-cluster-erlang-cookie	github.com/rabbitmq/cluster-operator/controllers.(*RabbitmqClusterReconciler)	NoError	{"kind":"Secret","apiVersion":"v1","metadata":{"name":"rabbitmq-cluster-erlang-cookie","namespace":"default","selfLink":"/api/v1/namespaces/default/secrets/rabbitmq-cluster-erlang-cookie","uid":"f8fbe8a6-0f40-4e13-960b-ab78b8ba75b0","resourceVersion":"705","creationTimestamp":"2022-03-18T18:00:38Z","labels":{"app.kubernetes.io/component":"rabbitmq","app.kubernetes.io/name":"rabbitmq-cluster","app.kubernetes.io/part-of":"rabbitmq"},"ownerReferences":[{"apiVersion":"rabbitmq.com/v1beta1","kind":"RabbitmqCluster","name":"rabbitmq-cluster","uid":"18d9928b-0d1c-47be-80ec-20960d053827","controller":true,"blockOwnerDeletion":true}],"managedFields":[{"manager":"manager","operation":"Update","apiVersion":"v1","time":"2022-03-18T18:00:38Z","fieldsType":"FieldsV1","fieldsV1":{"f:data":{".":{},"f:.erlang.cookie":{}},"f:metadata":{"f:labels":{".":{},"f:app.kubernetes.io/component":{},"f:app.kubernetes.io/name":{},"f:app.kubernetes.io/part-of":{}},"f:ownerReferences":{".":{},"k:{\"uid\":\"18d9928b-0d1c-47be-80ec-20960d053827\"}":{".":{},"f:apiVersion":{},"f:blockOwnerDeletion":{},"f:controller":{},"f:kind":{},"f:name":{},"f:uid":{}}}},"f:type":{}}}]},"data":{".erlang.cookie":"QW9hMkpWU0tlYS1FUGdWTUhrelNMNnFoMFZ0ZmRGNUY="},"type":"Opaque"}
2022/03/18 18:01:08 learn_server.go:291: [SIEVE-AFTER-READ]	Get	true	secret	default	rabbitmq-cluster-default-user	github.com/rabbitmq/cluster-operator/controllers.(*RabbitmqClusterReconciler)	NoError	{"kind":"Secret","apiVersion":"v1","metadata":{"name":"rabbitmq-cluster-default-user","namespace":"default","selfLink":"/api/v1/namespaces/default/secrets/rabbitmq-cluster-default-user","uid":"0d9f460b-a23c-402b-8273-f541ed39023f","resourceVersion":"708","creationTimestamp":"2022-03-18T18:00:38Z","labels":{"app.kubernetes.io/component":"rabbitmq","app.kubernetes.io/name":"rabbitmq-cluster","app.kubernetes.io/part-of":"rabbitmq"},"ownerReferences":[{"apiVersion":"rabbitmq.com/v1beta1","kind":"RabbitmqCluster","name":"rabbitmq-cluster","uid":"18d9928b-0d1c-47be-80ec-20960d053827","controller":true,"blockOwnerDeletion":true}],"managedFields":[{"manager":"manager","operation":"Update","apiVersion":"v1","time":"2022-03-18T18:00:38Z","fieldsType":"FieldsV1","fieldsV1":{"f:data":{".":{},"f:default_user.conf":{},"f:password":{},"f:provider":{},"f:type":{},"f:username":{}},"f:metadata":{"f:labels":{".":{},"f:app.kubernetes.io/component":{},"f:app.kubernetes.io/name":{},"f:app.kubernetes.io/part-of":{}},"f:ownerReferences":{".":{},"k:{\"uid\":\"18d9928b-0d1c-47be-80ec-20960d053827\"}":{".":{},"f:apiVersion":{},"f:blockOwnerDeletion":{},"f:controller":{},"f:kind":{},"f:name":{},"f:uid":{}}}},"f:type":{}}}]},"data":{"default_user.conf":"ZGVmYXVsdF91c2VyID0gcTMxRmh3MGtjWW9SZUl5X3BPTXp2ZVBOUnNVU3I1Mk8KZGVmYXVsdF9wYXNzID0gY0dBX19jNTJHX05hVURpTGhraWZ6UDBOVVlNLTE2MWQK","password":"Y0dBX19jNTJHX05hVURpTGhraWZ6UDBOVVlNLTE2MWQ=","provider":"cmFiYml0bXE=","type":"cmFiYml0bXE=","username":"cTMxRmh3MGtjWW9SZUl5X3BPTXp2ZVBOUnNVU3I1Mk8="},"type":"Opaque"}
2022/03/18 18:01:08 learn_server.go:291: [SIEVE-AFTER-READ]	Get	true	configmap	default	rabbitmq-cluster-plugins-conf	github.com/rabbitmq/cluster-operator/controllers.(*RabbitmqClusterReconciler)	NoError	{"kind":"ConfigMap","apiVersion":"v1","metadata":{"name":"rabbitmq-cluster-plugins-conf","namespace":"default","selfLink":"/api/v1/namespaces/default/configmaps/rabbitmq-cluster-plugins-conf","uid":"a164075b-0562-47ac-a577-99aa8651ec40","resourceVersion":"709","creationTimestamp":"2022-03-18T18:00:38Z","labels":{"app.kubernetes.io/component":"rabbitmq","app.kubernetes.io/name":"rabbitmq-cluster","app.kubernetes.io/part-of":"rabbitmq"},"ownerReferences":[{"apiVersion":"rabbitmq.com/v1beta1","kind":"RabbitmqCluster","name":"rabbitmq-cluster","uid":"18d9928b-0d1c-47be-80ec-20960d053827","controller":true,"blockOwnerDeletion":true}],"managedFields":[{"manager":"manager","operation":"Update","apiVersion":"v1","time":"2022-03-18T18:00:38Z","fieldsType":"FieldsV1","fieldsV1":{"f:data":{".":{},"f:enabled_plugins":{}},"f:metadata":{"f:labels":{".":{},"f:app.kubernetes.io/component":{},"f:app.kubernetes.io/name":{},"f:app.kubernetes.io/part-of":{}},"f:ownerReferences":{".":{},"k:{\"uid\":\"18d9928b-0d1c-47be-80ec-20960d053827\"}":{".":{},"f:apiVersion":{},"f:blockOwnerDeletion":{},"f:controller":{},"f:kind":{},"f:name":{},"f:uid":{}}}}}}]},"data":{"enabled_plugins":"[rabbitmq_peer_discovery_k8s,rabbitmq_prometheus,rabbitmq_management]."}}
2022/03/18 18:01:08 learn_server.go:291: [SIEVE-AFTER-READ]	Get	true	configmap	default	rabbitmq-cluster-server-conf	github.com/rabbitmq/cluster-operator/controllers.(*RabbitmqClusterReconciler)	NoError	{"kind":"ConfigMap","apiVersion":"v1","metadata":{"name":"rabbitmq-cluster-server-conf","namespace":"default","selfLink":"/api/v1/namespaces/default/configmaps/rabbitmq-cluster-server-conf","uid":"22474f2b-8454-44b7-8079-8990223969cc","resourceVersion":"714","creationTimestamp":"2022-03-18T18:00:38Z","labels":{"app.kubernetes.io/component":"rabbitmq","app.kubernetes.io/name":"rabbitmq-cluster","app.kubernetes.io/part-of":"rabbitmq"},"ownerReferences":[{"apiVersion":"rabbitmq.com/v1beta1","kind":"RabbitmqCluster","name":"rabbitmq-cluster","uid":"18d9928b-0d1c-47be-80ec-20960d053827","controller":true,"blockOwnerDeletion":true}],"managedFields":[{"manager":"manager","operation":"Update","apiVersion":"v1","time":"2022-03-18T18:00:38Z","fieldsType":"FieldsV1","fieldsV1":{"f:data":{".":{},"f:operatorDefaults.conf":{},"f:userDefinedConfiguration.conf":{}},"f:metadata":{"f:labels":{".":{},"f:app.kubernetes.io/component":{},"f:app.kubernetes.io/name":{},"f:app.kubernetes.io/part-of":{}},"f:ownerReferences":{".":{},"k:{\"uid\":\"18d9928b-0d1c-47be-80ec-20960d053827\"}":{".":{},"f:apiVersion":{},"f:blockOwnerDeletion":{},"f:controller":{},"f:kind":{},"f:name":{},"f:uid":{}}}}}}]},"data":{"operatorDefaults.conf":"cluster_formation.peer_discovery_backend             = rabbit_peer_discovery_k8s\ncluster_formation.k8s.host                           = kubernetes.default\ncluster_formation.k8s.address_type                   = hostname\ncluster_partition_handling                           = pause_minority\nqueue_master_locator                                 = min-masters\ndisk_free_limit.absolute                             = 2GB\ncluster_formation.randomized_startup_delay_range.min = 5\ncluster_formation.randomized_startup_delay_range.max = 30\ncluster_name                                         = rabbitmq-cluster\n","userDefinedConfiguration.conf":"total_memory_available_override_value = 1717986919\n"}}
2022/03/18 18:01:08 learn_server.go:291: [SIEVE-AFTER-READ]	Get	true	serviceaccount	default	rabbitmq-cluster-server	github.com/rabbitmq/cluster-operator/controllers.(*RabbitmqClusterReconciler)	NoError	{"kind":"ServiceAccount","apiVersion":"v1","metadata":{"name":"rabbitmq-cluster-server","namespace":"default","selfLink":"/api/v1/namespaces/default/serviceaccounts/rabbitmq-cluster-server","uid":"731589b5-ac97-4774-bee4-008949b54734","resourceVersion":"722","creationTimestamp":"2022-03-18T18:00:38Z","labels":{"app.kubernetes.io/component":"rabbitmq","app.kubernetes.io/name":"rabbitmq-cluster","app.kubernetes.io/part-of":"rabbitmq"},"ownerReferences":[{"apiVersion":"rabbitmq.com/v1beta1","kind":"RabbitmqCluster","name":"rabbitmq-cluster","uid":"18d9928b-0d1c-47be-80ec-20960d053827","controller":true,"blockOwnerDeletion":true}],"managedFields":[{"manager":"kube-controller-manager","operation":"Update","apiVersion":"v1","time":"2022-03-18T18:00:38Z","fieldsType":"FieldsV1","fieldsV1":{"f:secrets":{".":{},"k:{\"name\":\"rabbitmq-cluster-server-token-rhzq9\"}":{".":{},"f:name":{}}}}},{"manager":"manager","operation":"Update","apiVersion":"v1","time":"2022-03-18T18:00:38Z","fieldsType":"FieldsV1","fieldsV1":{"f:metadata":{"f:labels":{".":{},"f:app.kubernetes.io/component":{},"f:app.kubernetes.io/name":{},"f:app.kubernetes.io/part-of":{}},"f:ownerReferences":{".":{},"k:{\"uid\":\"18d9928b-0d1c-47be-80ec-20960d053827\"}":{".":{},"f:apiVersion":{},"f:blockOwnerDeletion":{},"f:controller":{},"f:kind":{},"f:name":{},"f:uid":{}}}}}}]},"secrets":[{"name":"rabbitmq-cluster-server-token-rhzq9"}]}
2022/03/18 18:01:08 learn_server.go:291: [SIEVE-AFTER-READ]	Get	true	role	default	rabbitmq-cluster-peer-discovery	github.com/rabbitmq/cluster-operator/controllers.(*RabbitmqClusterReconciler)	NoError	{"kind":"Role","apiVersion":"rbac.authorization.k8s.io/v1","metadata":{"name":"rabbitmq-cluster-peer-discovery","namespace":"default","selfLink":"/apis/rbac.authorization.k8s.io/v1/namespaces/default/roles/rabbitmq-cluster-peer-discovery","uid":"52c80b50-4fdd-4089-bbfd-9756465953f2","resourceVersion":"723","creationTimestamp":"2022-03-18T18:00:38Z","labels":{"app.kubernetes.io/component":"rabbitmq","app.kubernetes.io/name":"rabbitmq-cluster","app.kubernetes.io/part-of":"rabbitmq"},"ownerReferences":[{"apiVersion":"rabbitmq.com/v1beta1","kind":"RabbitmqCluster","name":"rabbitmq-cluster","uid":"18d9928b-0d1c-47be-80ec-20960d053827","controller":true,"blockOwnerDeletion":true}],"managedFields":[{"manager":"manager","operation":"Update","apiVersion":"rbac.authorization.k8s.io/v1","time":"2022-03-18T18:00:38Z","fieldsType":"FieldsV1","fieldsV1":{"f:metadata":{"f:labels":{".":{},"f:app.kubernetes.io/component":{},"f:app.kubernetes.io/name":{},"f:app.kubernetes.io/part-of":{}},"f:ownerReferences":{".":{},"k:{\"uid\":\"18d9928b-0d1c-47be-80ec-20960d053827\"}":{".":{},"f:apiVersion":{},"f:blockOwnerDeletion":{},"f:controller":{},"f:kind":{},"f:name":{},"f:uid":{}}}},"f:rules":{}}}]},"rules":[{"verbs":["get"],"apiGroups":[""],"resources":["endpoints"]},{"verbs":["create"],"apiGroups":[""],"resources":["events"]}]}
2022/03/18 18:01:08 learn_server.go:291: [SIEVE-AFTER-READ]	Get	true	rolebinding	default	rabbitmq-cluster-server	github.com/rabbitmq/cluster-operator/controllers.(*RabbitmqClusterReconciler)	NoError	{"kind":"RoleBinding","apiVersion":"rbac.authorization.k8s.io/v1","metadata":{"name":"rabbitmq-cluster-server","namespace":"default","selfLink":"/apis/rbac.authorization.k8s.io/v1/namespaces/default/rolebindings/rabbitmq-cluster-server","uid":"495e9f7c-a20d-4515-86b0-34149a855034","resourceVersion":"725","creationTimestamp":"2022-03-18T18:00:38Z","labels":{"app.kubernetes.io/component":"rabbitmq","app.kubernetes.io/name":"rabbitmq-cluster","app.kubernetes.io/part-of":"rabbitmq"},"ownerReferences":[{"apiVersion":"rabbitmq.com/v1beta1","kind":"RabbitmqCluster","name":"rabbitmq-cluster","uid":"18d9928b-0d1c-47be-80ec-20960d053827","controller":true,"blockOwnerDeletion":true}],"managedFields":[{"manager":"manager","operation":"Update","apiVersion":"rbac.authorization.k8s.io/v1","time":"2022-03-18T18:00:38Z","fieldsType":"FieldsV1","fieldsV1":{"f:metadata":{"f:labels":{".":{},"f:app.kubernetes.io/component":{},"f:app.kubernetes.io/name":{},"f:app.kubernetes.io/part-of":{}},"f:ownerReferences":{".":{},"k:{\"uid\":\"18d9928b-0d1c-47be-80ec-20960d053827\"}":{".":{},"f:apiVersion":{},"f:blockOwnerDeletion":{},"f:controller":{},"f:kind":{},"f:name":{},"f:uid":{}}}},"f:roleRef":{"f:apiGroup":{},"f:kind":{},"f:name":{}},"f:subjects":{}}}]},"subjects":[{"kind":"ServiceAccount","name":"rabbitmq-cluster-server"}],"roleRef":{"apiGroup":"rbac.authorization.k8s.io","kind":"Role","name":"rabbitmq-cluster-peer-discovery"}}
2022/03/18 18:01:08 learn_server.go:291: [SIEVE-AFTER-READ]	Get	true	statefulset	default	rabbitmq-cluster-server	github.com/rabbitmq/cluster-operator/controllers.(*RabbitmqClusterReconciler)	NoError	{"kind":"StatefulSet","apiVersion":"apps/v1","metadata":{"name":"rabbitmq-cluster-server","namespace":"default","selfLink":"/apis/apps/v1/namespaces/default/statefulsets/rabbitmq-cluster-server","uid":"cb5c43bc-6ee7-481c-ab01-6f3acffdd3c8","resourceVersion":"744","generation":1,"creationTimestamp":"2022-03-18T18:00:38Z","labels":{"app.kubernetes.io/component":"rabbitmq","app.kubernetes.io/name":"rabbitmq-cluster","app.kubernetes.io/part-of":"rabbitmq"},"annotations":{"rabbitmq.com/createdAt":"2022-03-18T18:00:38Z"},"ownerReferences":[{"apiVersion":"rabbitmq.com/v1beta1","kind":"RabbitmqCluster","name":"rabbitmq-cluster","uid":"18d9928b-0d1c-47be-80ec-20960d053827","controller":true,"blockOwnerDeletion":true}],"managedFields":[{"manager":"kube-controller-manager","operation":"Update","apiVersion":"apps/v1","time":"2022-03-18T18:00:38Z","fieldsType":"FieldsV1","fieldsV1":{"f:status":{"f:collisionCount":{},"f:currentReplicas":{},"f:currentRevision":{},"f:observedGeneration":{},"f:replicas":{},"f:updateRevision":{},"f:updatedReplicas":{}}}},{"manager":"manager","operation":"Update","apiVersion":"apps/v1","time":"2022-03-18T18:00:38Z","fieldsType":"FieldsV1","fieldsV1":{"f:metadata":{"f:annotations":{".":{},"f:rabbitmq.com/createdAt":{}},"f:labels":{".":{},"f:app.kubernetes.io/component":{},"f:app.kubernetes.io/name":{},"f:app.kubernetes.io/part-of":{}},"f:ownerReferences":{".":{},"k:{\"uid\":\"18d9928b-0d1c-47be-80ec-20960d053827\"}":{".":{},"f:apiVersion":{},"f:blockOwnerDeletion":{},"f:controller":{},"f:kind":{},"f:name":{},"f:uid":{}}}},"f:spec":{"f:podManagementPolicy":{},"f:replicas":{},"f:revisionHistoryLimit":{},"f:selector":{"f:matchLabels":{".":{},"f:app.kubernetes.io/name":{}}},"f:serviceName":{},"f:template":{"f:metadata":{"f:annotations":{".":{},"f:prometheus.io/port":{},"f:prometheus.io/scrape":{}},"f:labels":{".":{},"f:app.kubernetes.io/component":{},"f:app.kubernetes.io/name":{},"f:app.kubernetes.io/part-of":{}}},"f:spec":{"f:automountServiceAccountToken":{},"f:containers":{"k:{\"name\":\"rabbitmq\"}":{".":{},"f:env":{".":{},"k:{\"name\":\"K8S_HOSTNAME_SUFFIX\"}":{".":{},"f:name":{},"f:value":{}},"k:{\"name\":\"K8S_SERVICE_NAME\"}":{".":{},"f:name":{},"f:value":{}},"k:{\"name\":\"MY_POD_NAME\"}":{".":{},"f:name":{},"f:valueFrom":{".":{},"f:fieldRef":{".":{},"f:apiVersion":{},"f:fieldPath":{}}}},"k:{\"name\":\"MY_POD_NAMESPACE\"}":{".":{},"f:name":{},"f:valueFrom":{".":{},"f:fieldRef":{".":{},"f:apiVersion":{},"f:fieldPath":{}}}},"k:{\"name\":\"RABBITMQ_ENABLED_PLUGINS_FILE\"}":{".":{},"f:name":{},"f:value":{}},"k:{\"name\":\"RABBITMQ_NODENAME\"}":{".":{},"f:name":{},"f:value":{}},"k:{\"name\":\"RABBITMQ_USE_LONGNAME\"}":{".":{},"f:name":{},"f:value":{}}},"f:image":{},"f:imagePullPolicy":{},"f:lifecycle":{".":{},"f:preStop":{".":{},"f:exec":{".":{},"f:command":{}}}},"f:name":{},"f:ports":{".":{},"k:{\"containerPort\":4369,\"protocol\":\"TCP\"}":{".":{},"f:containerPort":{},"f:name":{},"f:protocol":{}},"k:{\"containerPort\":5672,\"protocol\":\"TCP\"}":{".":{},"f:containerPort":{},"f:name":{},"f:protocol":{}},"k:{\"containerPort\":15672,\"protocol\":\"TCP\"}":{".":{},"f:containerPort":{},"f:name":{},"f:protocol":{}},"k:{\"containerPort\":15692,\"protocol\":\"TCP\"}":{".":{},"f:containerPort":{},"f:name":{},"f:protocol":{}}},"f:readinessProbe":{".":{},"f:failureThreshold":{},"f:initialDelaySeconds":{},"f:periodSeconds":{},"f:successThreshold":{},"f:tcpSocket":{".":{},"f:port":{}},"f:timeoutSeconds":{}},"f:resources":{".":{},"f:limits":{".":{},"f:cpu":{},"f:memory":{}},"f:requests":{".":{},"f:cpu":{},"f:memory":{}}},"f:terminationMessagePath":{},"f:terminationMessagePolicy":{},"f:volumeMounts":{".":{},"k:{\"mountPath\":\"/etc/pod-info/\"}":{".":{},"f:mountPath":{},"f:name":{}},"k:{\"mountPath\":\"/etc/rabbitmq/conf.d/10-operatorDefaults.conf\"}":{".":{},"f:mountPath":{},"f:name":{},"f:subPath":{}},"k:{\"mountPath\":\"/etc/rabbitmq/conf.d/11-default_user.conf\"}":{".":{},"f:mountPath":{},"f:name":{},"f:subPath":{}},"k:{\"mountPath\":\"/etc/rabbitmq/conf.d/90-userDefinedConfiguration.conf\"}":{".":{},"f:mountPath":{},"f:name":{},"f:subPath":{}},"k:{\"mountPath\":\"/operator\"}":{".":{},"f:mountPath":{},"f:name":{}},"k:{\"mountPath\":\"/var/lib/rabbitmq/\"}":{".":{},"f:mountPath":{},"f:name":{}},"k:{\"mountPath\":\"/var/lib/rabbitmq/mnesia/\"}":{".":{},"f:mountPath":{},"f:name":{}}}}},"f:dnsPolicy":{},"f:initContainers":{".":{},"k:{\"name\":\"setup-container\"}":{".":{},"f:command":{},"f:image":{},"f:imagePullPolicy":{},"f:name":{},"f:resources":{".":{},"f:limits":{".":{},"f:cpu":{},"f:memory":{}},"f:requests":{".":{},"f:cpu":{},"f:memory":{}}},"f:securityContext":{".":{},"f:capabilities":{".":{},"f:drop":{}},"f:runAsUser":{}},"f:terminationMessagePath":{},"f:terminationMessagePolicy":{},"f:volumeMounts":{".":{},"k:{\"mountPath\":\"/operator\"}":{".":{},"f:mountPath":{},"f:name":{}},"k:{\"mountPath\":\"/tmp/default_user.conf\"}":{".":{},"f:mountPath":{},"f:name":{},"f:subPath":{}},"k:{\"mountPath\":\"/tmp/erlang-cookie-secret/\"}":{".":{},"f:mountPath":{},"f:name":{}},"k:{\"mountPath\":\"/tmp/rabbitmq-plugins/\"}":{".":{},"f:mountPath":{},"f:name":{}},"k:{\"mountPath\":\"/var/lib/rabbitmq/\"}":{".":{},"f:mountPath":{},"f:name":{}},"k:{\"mountPath\":\"/var/lib/rabbitmq/mnesia/\"}":{".":{},"f:mountPath":{},"f:name":{}}}}},"f:restartPolicy":{},"f:schedulerName":{},"f:securityContext":{".":{},"f:fsGroup":{},"f:runAsGroup":{},"f:runAsUser":{}},"f:serviceAccount":{},"f:serviceAccountName":{},"f:terminationGracePeriodSeconds":{},"f:topologySpreadConstraints":{".":{},"k:{\"topologyKey\":\"topology.kubernetes.io/zone\",\"whenUnsatisfiable\":\"ScheduleAnyway\"}":{".":{},"f:labelSelector":{".":{},"f:matchLabels":{".":{},"f:app.kubernetes.io/name":{}}},"f:maxSkew":{},"f:topologyKey":{},"f:whenUnsatisfiable":{}}},"f:volumes":{".":{},"k:{\"name\":\"erlang-cookie-secret\"}":{".":{},"f:name":{},"f:secret":{".":{},"f:defaultMode":{},"f:secretName":{}}},"k:{\"name\":\"plugins-conf\"}":{".":{},"f:configMap":{".":{},"f:defaultMode":{},"f:name":{}},"f:name":{}},"k:{\"name\":\"pod-info\"}":{".":{},"f:downwardAPI":{".":{},"f:defaultMode":{},"f:items":{}},"f:name":{}},"k:{\"name\":\"rabbitmq-confd\"}":{".":{},"f:name":{},"f:projected":{".":{},"f:defaultMode":{},"f:sources":{}}},"k:{\"name\":\"rabbitmq-erlang-cookie\"}":{".":{},"f:emptyDir":{},"f:name":{}},"k:{\"name\":\"rabbitmq-plugins\"}":{".":{},"f:emptyDir":{},"f:name":{}}}}},"f:updateStrategy":{"f:rollingUpdate":{".":{},"f:partition":{}},"f:type":{}},"f:volumeClaimTemplates":{}}}}]},"spec":{"replicas":1,"selector":{"matchLabels":{"app.kubernetes.io/name":"rabbitmq-cluster"}},"template":{"metadata":{"creationTimestamp":null,"labels":{"app.kubernetes.io/component":"rabbitmq","app.kubernetes.io/name":"rabbitmq-cluster","app.kubernetes.io/part-of":"rabbitmq"},"annotations":{"prometheus.io/port":"15692","prometheus.io/scrape":"true"}},"spec":{"volumes":[{"name":"plugins-conf","configMap":{"name":"rabbitmq-cluster-plugins-conf","defaultMode":420}},{"name":"rabbitmq-confd","projected":{"sources":[{"secret":{"name":"rabbitmq-cluster-default-user","items":[{"key":"default_user.conf","path":"default_user.conf"}]}},{"configMap":{"name":"rabbitmq-cluster-server-conf","items":[{"key":"operatorDefaults.conf","path":"operatorDefaults.conf"},{"key":"userDefinedConfiguration.conf","path":"userDefinedConfiguration.conf"}]}}],"defaultMode":420}},{"name":"rabbitmq-erlang-cookie","emptyDir":{}},{"name":"erlang-cookie-secret","secret":{"secretName":"rabbitmq-cluster-erlang-cookie","defaultMode":420}},{"name":"rabbitmq-plugins","emptyDir":{}},{"name":"pod-info","downwardAPI":{"items":[{"path":"skipPreStopChecks","fieldRef":{"apiVersion":"v1","fieldPath":"metadata.labels['skipPreStopChecks']"}}],"defaultMode":420}}],"initContainers":[{"name":"setup-container","image":"rabbitmq:3.8.12-management","command":["sh","-c","cp /tmp/erlang-cookie-secret/.erlang.cookie /var/lib/rabbitmq/.erlang.cookie \u0026\u0026 chown 999:999 /var/lib/rabbitmq/.erlang.cookie \u0026\u0026 chmod 600 /var/lib/rabbitmq/.erlang.cookie ; cp /tmp/rabbitmq-plugins/enabled_plugins /operator/enabled_plugins \u0026\u0026 chown 999:999 /operator/enabled_plugins ; chown 999:999 /var/lib/rabbitmq/mnesia/ ; echo '[default]' \u003e /var/lib/rabbitmq/.rabbitmqadmin.conf \u0026\u0026 sed -e 's/default_user/username/' -e 's/default_pass/password/' /tmp/default_user.conf \u003e\u003e /var/lib/rabbitmq/.rabbitmqadmin.conf \u0026\u0026 chown 999:999 /var/lib/rabbitmq/.rabbitmqadmin.conf \u0026\u0026 chmod 600 /var/lib/rabbitmq/.rabbitmqadmin.conf"],"resources":{"limits":{"cpu":"100m","memory":"500Mi"},"requests":{"cpu":"100m","memory":"500Mi"}},"volumeMounts":[{"name":"plugins-conf","mountPath":"/tmp/rabbitmq-plugins/"},{"name":"rabbitmq-erlang-cookie","mountPath":"/var/lib/rabbitmq/"},{"name":"erlang-cookie-secret","mountPath":"/tmp/erlang-cookie-secret/"},{"name":"rabbitmq-plugins","mountPath":"/operator"},{"name":"persistence","mountPath":"/var/lib/rabbitmq/mnesia/"},{"name":"rabbitmq-confd","mountPath":"/tmp/default_user.conf","subPath":"default_user.conf"}],"terminationMessagePath":"/dev/termination-log","terminationMessagePolicy":"File","imagePullPolicy":"IfNotPresent","securityContext":{"capabilities":{"drop":["FSETID","KILL","SETGID","SETUID","SETPCAP","NET_BIND_SERVICE","NET_RAW","SYS_CHROOT","MKNOD","AUDIT_WRITE","SETFCAP"]},"runAsUser":0}}],"containers":[{"name":"rabbitmq","image":"rabbitmq:3.8.12-management","ports":[{"name":"epmd","containerPort":4369,"protocol":"TCP"},{"name":"amqp","containerPort":5672,"protocol":"TCP"},{"name":"management","containerPort":15672,"protocol":"TCP"},{"name":"prometheus","containerPort":15692,"protocol":"TCP"}],"env":[{"name":"MY_POD_NAME","valueFrom":{"fieldRef":{"apiVersion":"v1","fieldPath":"metadata.name"}}},{"name":"MY_POD_NAMESPACE","valueFrom":{"fieldRef":{"apiVersion":"v1","fieldPath":"metadata.namespace"}}},{"name":"RABBITMQ_ENABLED_PLUGINS_FILE","value":"/operator/enabled_plugins"},{"name":"K8S_SERVICE_NAME","value":"rabbitmq-cluster-nodes"},{"name":"RABBITMQ_USE_LONGNAME","value":"true"},{"name":"RABBITMQ_NODENAME","value":"rabbit@$(MY_POD_NAME).$(K8S_SERVICE_NAME).$(MY_POD_NAMESPACE)"},{"name":"K8S_HOSTNAME_SUFFIX","value":".$(K8S_SERVICE_NAME).$(MY_POD_NAMESPACE)"}],"resources":{"limits":{"cpu":"2","memory":"2Gi"},"requests":{"cpu":"1","memory":"2Gi"}},"volumeMounts":[{"name":"rabbitmq-erlang-cookie","mountPath":"/var/lib/rabbitmq/"},{"name":"persistence","mountPath":"/var/lib/rabbitmq/mnesia/"},{"name":"rabbitmq-plugins","mountPath":"/operator"},{"name":"rabbitmq-confd","mountPath":"/etc/rabbitmq/conf.d/10-operatorDefaults.conf","subPath":"operatorDefaults.conf"},{"name":"rabbitmq-confd","mountPath":"/etc/rabbitmq/conf.d/11-default_user.conf","subPath":"default_user.conf"},{"name":"rabbitmq-confd","mountPath":"/etc/rabbitmq/conf.d/90-userDefinedConfiguration.conf","subPath":"userDefinedConfiguration.conf"},{"name":"pod-info","mountPath":"/etc/pod-info/"}],"readinessProbe":{"tcpSocket":{"port":"amqp"},"initialDelaySeconds":10,"timeoutSeconds":5,"periodSeconds":10,"successThreshold":1,"failureThreshold":3},"lifecycle":{"preStop":{"exec":{"command":["/bin/bash","-c","if [ ! -z \"$(cat /etc/pod-info/skipPreStopChecks)\" ]; then exit 0; fi; rabbitmq-upgrade await_online_quorum_plus_one -t 604800; rabbitmq-upgrade await_online_synchronized_mirror -t 604800; rabbitmq-upgrade drain -t 604800"]}}},"terminationMessagePath":"/dev/termination-log","terminationMessagePolicy":"File","imagePullPolicy":"IfNotPresent"}],"restartPolicy":"Always","terminationGracePeriodSeconds":604800,"dnsPolicy":"ClusterFirst","serviceAccountName":"rabbitmq-cluster-server","serviceAccount":"rabbitmq-cluster-server","automountServiceAccountToken":true,"securityContext":{"runAsUser":999,"runAsGroup":999,"fsGroup":999},"schedulerName":"default-scheduler","topologySpreadConstraints":[{"maxSkew":1,"topologyKey":"topology.kubernetes.io/zone","whenUnsatisfiable":"ScheduleAnyway","labelSelector":{"matchLabels":{"app.kubernetes.io/name":"rabbitmq-cluster"}}}]}},"volumeClaimTemplates":[{"metadata":{"name":"persistence","namespace":"default","creationTimestamp":null,"labels":{"app.kubernetes.io/component":"rabbitmq","app.kubernetes.io/name":"rabbitmq-cluster","app.kubernetes.io/part-of":"rabbitmq"},"ownerReferences":[{"apiVersion":"rabbitmq.com/v1beta1","kind":"RabbitmqCluster","name":"rabbitmq-cluster","uid":"18d9928b-0d1c-47be-80ec-20960d053827","controller":true,"blockOwnerDeletion":false}]},"spec":{"accessModes":["ReadWriteOnce"],"resources":{"requests":{"storage":"10Gi"}},"volumeMode":"Filesystem"},"status":{"phase":"Pending"}}],"serviceName":"rabbitmq-cluster-nodes","podManagementPolicy":"Parallel","updateStrategy":{"type":"RollingUpdate","rollingUpdate":{"partition":0}},"revisionHistoryLimit":10},"status":{"observedGeneration":1,"replicas":1,"currentReplicas":1,"updatedReplicas":1,"currentRevision":"rabbitmq-cluster-server-5f8b8665fb","updateRevision":"rabbitmq-cluster-server-5f8b8665fb","collisionCount":0}}
2022/03/18 18:01:08 learn_server.go:291: [SIEVE-AFTER-READ]	Get	true	statefulset	default	rabbitmq-cluster-server	github.com/rabbitmq/cluster-operator/controllers.(*RabbitmqClusterReconciler)	NoError	{"kind":"StatefulSet","apiVersion":"apps/v1","metadata":{"name":"rabbitmq-cluster-server","namespace":"default","selfLink":"/apis/apps/v1/namespaces/default/statefulsets/rabbitmq-cluster-server","uid":"cb5c43bc-6ee7-481c-ab01-6f3acffdd3c8","resourceVersion":"744","generation":1,"creationTimestamp":"2022-03-18T18:00:38Z","labels":{"app.kubernetes.io/component":"rabbitmq","app.kubernetes.io/name":"rabbitmq-cluster","app.kubernetes.io/part-of":"rabbitmq"},"annotations":{"rabbitmq.com/createdAt":"2022-03-18T18:00:38Z"},"ownerReferences":[{"apiVersion":"rabbitmq.com/v1beta1","kind":"RabbitmqCluster","name":"rabbitmq-cluster","uid":"18d9928b-0d1c-47be-80ec-20960d053827","controller":true,"blockOwnerDeletion":true}],"managedFields":[{"manager":"kube-controller-manager","operation":"Update","apiVersion":"apps/v1","time":"2022-03-18T18:00:38Z","fieldsType":"FieldsV1","fieldsV1":{"f:status":{"f:collisionCount":{},"f:currentReplicas":{},"f:currentRevision":{},"f:observedGeneration":{},"f:replicas":{},"f:updateRevision":{},"f:updatedReplicas":{}}}},{"manager":"manager","operation":"Update","apiVersion":"apps/v1","time":"2022-03-18T18:00:38Z","fieldsType":"FieldsV1","fieldsV1":{"f:metadata":{"f:annotations":{".":{},"f:rabbitmq.com/createdAt":{}},"f:labels":{".":{},"f:app.kubernetes.io/component":{},"f:app.kubernetes.io/name":{},"f:app.kubernetes.io/part-of":{}},"f:ownerReferences":{".":{},"k:{\"uid\":\"18d9928b-0d1c-47be-80ec-20960d053827\"}":{".":{},"f:apiVersion":{},"f:blockOwnerDeletion":{},"f:controller":{},"f:kind":{},"f:name":{},"f:uid":{}}}},"f:spec":{"f:podManagementPolicy":{},"f:replicas":{},"f:revisionHistoryLimit":{},"f:selector":{"f:matchLabels":{".":{},"f:app.kubernetes.io/name":{}}},"f:serviceName":{},"f:template":{"f:metadata":{"f:annotations":{".":{},"f:prometheus.io/port":{},"f:prometheus.io/scrape":{}},"f:labels":{".":{},"f:app.kubernetes.io/component":{},"f:app.kubernetes.io/name":{},"f:app.kubernetes.io/part-of":{}}},"f:spec":{"f:automountServiceAccountToken":{},"f:containers":{"k:{\"name\":\"rabbitmq\"}":{".":{},"f:env":{".":{},"k:{\"name\":\"K8S_HOSTNAME_SUFFIX\"}":{".":{},"f:name":{},"f:value":{}},"k:{\"name\":\"K8S_SERVICE_NAME\"}":{".":{},"f:name":{},"f:value":{}},"k:{\"name\":\"MY_POD_NAME\"}":{".":{},"f:name":{},"f:valueFrom":{".":{},"f:fieldRef":{".":{},"f:apiVersion":{},"f:fieldPath":{}}}},"k:{\"name\":\"MY_POD_NAMESPACE\"}":{".":{},"f:name":{},"f:valueFrom":{".":{},"f:fieldRef":{".":{},"f:apiVersion":{},"f:fieldPath":{}}}},"k:{\"name\":\"RABBITMQ_ENABLED_PLUGINS_FILE\"}":{".":{},"f:name":{},"f:value":{}},"k:{\"name\":\"RABBITMQ_NODENAME\"}":{".":{},"f:name":{},"f:value":{}},"k:{\"name\":\"RABBITMQ_USE_LONGNAME\"}":{".":{},"f:name":{},"f:value":{}}},"f:image":{},"f:imagePullPolicy":{},"f:lifecycle":{".":{},"f:preStop":{".":{},"f:exec":{".":{},"f:command":{}}}},"f:name":{},"f:ports":{".":{},"k:{\"containerPort\":4369,\"protocol\":\"TCP\"}":{".":{},"f:containerPort":{},"f:name":{},"f:protocol":{}},"k:{\"containerPort\":5672,\"protocol\":\"TCP\"}":{".":{},"f:containerPort":{},"f:name":{},"f:protocol":{}},"k:{\"containerPort\":15672,\"protocol\":\"TCP\"}":{".":{},"f:containerPort":{},"f:name":{},"f:protocol":{}},"k:{\"containerPort\":15692,\"protocol\":\"TCP\"}":{".":{},"f:containerPort":{},"f:name":{},"f:protocol":{}}},"f:readinessProbe":{".":{},"f:failureThreshold":{},"f:initialDelaySeconds":{},"f:periodSeconds":{},"f:successThreshold":{},"f:tcpSocket":{".":{},"f:port":{}},"f:timeoutSeconds":{}},"f:resources":{".":{},"f:limits":{".":{},"f:cpu":{},"f:memory":{}},"f:requests":{".":{},"f:cpu":{},"f:memory":{}}},"f:terminationMessagePath":{},"f:terminationMessagePolicy":{},"f:volumeMounts":{".":{},"k:{\"mountPath\":\"/etc/pod-info/\"}":{".":{},"f:mountPath":{},"f:name":{}},"k:{\"mountPath\":\"/etc/rabbitmq/conf.d/10-operatorDefaults.conf\"}":{".":{},"f:mountPath":{},"f:name":{},"f:subPath":{}},"k:{\"mountPath\":\"/etc/rabbitmq/conf.d/11-default_user.conf\"}":{".":{},"f:mountPath":{},"f:name":{},"f:subPath":{}},"k:{\"mountPath\":\"/etc/rabbitmq/conf.d/90-userDefinedConfiguration.conf\"}":{".":{},"f:mountPath":{},"f:name":{},"f:subPath":{}},"k:{\"mountPath\":\"/operator\"}":{".":{},"f:mountPath":{},"f:name":{}},"k:{\"mountPath\":\"/var/lib/rabbitmq/\"}":{".":{},"f:mountPath":{},"f:name":{}},"k:{\"mountPath\":\"/var/lib/rabbitmq/mnesia/\"}":{".":{},"f:mountPath":{},"f:name":{}}}}},"f:dnsPolicy":{},"f:initContainers":{".":{},"k:{\"name\":\"setup-container\"}":{".":{},"f:command":{},"f:image":{},"f:imagePullPolicy":{},"f:name":{},"f:resources":{".":{},"f:limits":{".":{},"f:cpu":{},"f:memory":{}},"f:requests":{".":{},"f:cpu":{},"f:memory":{}}},"f:securityContext":{".":{},"f:capabilities":{".":{},"f:drop":{}},"f:runAsUser":{}},"f:terminationMessagePath":{},"f:terminationMessagePolicy":{},"f:volumeMounts":{".":{},"k:{\"mountPath\":\"/operator\"}":{".":{},"f:mountPath":{},"f:name":{}},"k:{\"mountPath\":\"/tmp/default_user.conf\"}":{".":{},"f:mountPath":{},"f:name":{},"f:subPath":{}},"k:{\"mountPath\":\"/tmp/erlang-cookie-secret/\"}":{".":{},"f:mountPath":{},"f:name":{}},"k:{\"mountPath\":\"/tmp/rabbitmq-plugins/\"}":{".":{},"f:mountPath":{},"f:name":{}},"k:{\"mountPath\":\"/var/lib/rabbitmq/\"}":{".":{},"f:mountPath":{},"f:name":{}},"k:{\"mountPath\":\"/var/lib/rabbitmq/mnesia/\"}":{".":{},"f:mountPath":{},"f:name":{}}}}},"f:restartPolicy":{},"f:schedulerName":{},"f:securityContext":{".":{},"f:fsGroup":{},"f:runAsGroup":{},"f:runAsUser":{}},"f:serviceAccount":{},"f:serviceAccountName":{},"f:terminationGracePeriodSeconds":{},"f:topologySpreadConstraints":{".":{},"k:{\"topologyKey\":\"topology.kubernetes.io/zone\",\"whenUnsatisfiable\":\"ScheduleAnyway\"}":{".":{},"f:labelSelector":{".":{},"f:matchLabels":{".":{},"f:app.kubernetes.io/name":{}}},"f:maxSkew":{},"f:topologyKey":{},"f:whenUnsatisfiable":{}}},"f:volumes":{".":{},"k:{\"name\":\"erlang-cookie-secret\"}":{".":{},"f:name":{},"f:secret":{".":{},"f:defaultMode":{},"f:secretName":{}}},"k:{\"name\":\"plugins-conf\"}":{".":{},"f:configMap":{".":{},"f:defaultMode":{},"f:name":{}},"f:name":{}},"k:{\"name\":\"pod-info\"}":{".":{},"f:downwardAPI":{".":{},"f:defaultMode":{},"f:items":{}},"f:name":{}},"k:{\"name\":\"rabbitmq-confd\"}":{".":{},"f:name":{},"f:projected":{".":{},"f:defaultMode":{},"f:sources":{}}},"k:{\"name\":\"rabbitmq-erlang-cookie\"}":{".":{},"f:emptyDir":{},"f:name":{}},"k:{\"name\":\"rabbitmq-plugins\"}":{".":{},"f:emptyDir":{},"f:name":{}}}}},"f:updateStrategy":{"f:rollingUpdate":{".":{},"f:partition":{}},"f:type":{}},"f:volumeClaimTemplates":{}}}}]},"spec":{"replicas":1,"selector":{"matchLabels":{"app.kubernetes.io/name":"rabbitmq-cluster"}},"template":{"metadata":{"creationTimestamp":null,"labels":{"app.kubernetes.io/component":"rabbitmq","app.kubernetes.io/name":"rabbitmq-cluster","app.kubernetes.io/part-of":"rabbitmq"},"annotations":{"prometheus.io/port":"15692","prometheus.io/scrape":"true"}},"spec":{"volumes":[{"name":"plugins-conf","configMap":{"name":"rabbitmq-cluster-plugins-conf","defaultMode":420}},{"name":"rabbitmq-confd","projected":{"sources":[{"secret":{"name":"rabbitmq-cluster-default-user","items":[{"key":"default_user.conf","path":"default_user.conf"}]}},{"configMap":{"name":"rabbitmq-cluster-server-conf","items":[{"key":"operatorDefaults.conf","path":"operatorDefaults.conf"},{"key":"userDefinedConfiguration.conf","path":"userDefinedConfiguration.conf"}]}}],"defaultMode":420}},{"name":"rabbitmq-erlang-cookie","emptyDir":{}},{"name":"erlang-cookie-secret","secret":{"secretName":"rabbitmq-cluster-erlang-cookie","defaultMode":420}},{"name":"rabbitmq-plugins","emptyDir":{}},{"name":"pod-info","downwardAPI":{"items":[{"path":"skipPreStopChecks","fieldRef":{"apiVersion":"v1","fieldPath":"metadata.labels['skipPreStopChecks']"}}],"defaultMode":420}}],"initContainers":[{"name":"setup-container","image":"rabbitmq:3.8.12-management","command":["sh","-c","cp /tmp/erlang-cookie-secret/.erlang.cookie /var/lib/rabbitmq/.erlang.cookie \u0026\u0026 chown 999:999 /var/lib/rabbitmq/.erlang.cookie \u0026\u0026 chmod 600 /var/lib/rabbitmq/.erlang.cookie ; cp /tmp/rabbitmq-plugins/enabled_plugins /operator/enabled_plugins \u0026\u0026 chown 999:999 /operator/enabled_plugins ; chown 999:999 /var/lib/rabbitmq/mnesia/ ; echo '[default]' \u003e /var/lib/rabbitmq/.rabbitmqadmin.conf \u0026\u0026 sed -e 's/default_user/username/' -e 's/default_pass/password/' /tmp/default_user.conf \u003e\u003e /var/lib/rabbitmq/.rabbitmqadmin.conf \u0026\u0026 chown 999:999 /var/lib/rabbitmq/.rabbitmqadmin.conf \u0026\u0026 chmod 600 /var/lib/rabbitmq/.rabbitmqadmin.conf"],"resources":{"limits":{"cpu":"100m","memory":"500Mi"},"requests":{"cpu":"100m","memory":"500Mi"}},"volumeMounts":[{"name":"plugins-conf","mountPath":"/tmp/rabbitmq-plugins/"},{"name":"rabbitmq-erlang-cookie","mountPath":"/var/lib/rabbitmq/"},{"name":"erlang-cookie-secret","mountPath":"/tmp/erlang-cookie-secret/"},{"name":"rabbitmq-plugins","mountPath":"/operator"},{"name":"persistence","mountPath":"/var/lib/rabbitmq/mnesia/"},{"name":"rabbitmq-confd","mountPath":"/tmp/default_user.conf","subPath":"default_user.conf"}],"terminationMessagePath":"/dev/termination-log","terminationMessagePolicy":"File","imagePullPolicy":"IfNotPresent","securityContext":{"capabilities":{"drop":["FSETID","KILL","SETGID","SETUID","SETPCAP","NET_BIND_SERVICE","NET_RAW","SYS_CHROOT","MKNOD","AUDIT_WRITE","SETFCAP"]},"runAsUser":0}}],"containers":[{"name":"rabbitmq","image":"rabbitmq:3.8.12-management","ports":[{"name":"epmd","containerPort":4369,"protocol":"TCP"},{"name":"amqp","containerPort":5672,"protocol":"TCP"},{"name":"management","containerPort":15672,"protocol":"TCP"},{"name":"prometheus","containerPort":15692,"protocol":"TCP"}],"env":[{"name":"MY_POD_NAME","valueFrom":{"fieldRef":{"apiVersion":"v1","fieldPath":"metadata.name"}}},{"name":"MY_POD_NAMESPACE","valueFrom":{"fieldRef":{"apiVersion":"v1","fieldPath":"metadata.namespace"}}},{"name":"RABBITMQ_ENABLED_PLUGINS_FILE","value":"/operator/enabled_plugins"},{"name":"K8S_SERVICE_NAME","value":"rabbitmq-cluster-nodes"},{"name":"RABBITMQ_USE_LONGNAME","value":"true"},{"name":"RABBITMQ_NODENAME","value":"rabbit@$(MY_POD_NAME).$(K8S_SERVICE_NAME).$(MY_POD_NAMESPACE)"},{"name":"K8S_HOSTNAME_SUFFIX","value":".$(K8S_SERVICE_NAME).$(MY_POD_NAMESPACE)"}],"resources":{"limits":{"cpu":"2","memory":"2Gi"},"requests":{"cpu":"1","memory":"2Gi"}},"volumeMounts":[{"name":"rabbitmq-erlang-cookie","mountPath":"/var/lib/rabbitmq/"},{"name":"persistence","mountPath":"/var/lib/rabbitmq/mnesia/"},{"name":"rabbitmq-plugins","mountPath":"/operator"},{"name":"rabbitmq-confd","mountPath":"/etc/rabbitmq/conf.d/10-operatorDefaults.conf","subPath":"operatorDefaults.conf"},{"name":"rabbitmq-confd","mountPath":"/etc/rabbitmq/conf.d/11-default_user.conf","subPath":"default_user.conf"},{"name":"rabbitmq-confd","mountPath":"/etc/rabbitmq/conf.d/90-userDefinedConfiguration.conf","subPath":"userDefinedConfiguration.conf"},{"name":"pod-info","mountPath":"/etc/pod-info/"}],"readinessProbe":{"tcpSocket":{"port":"amqp"},"initialDelaySeconds":10,"timeoutSeconds":5,"periodSeconds":10,"successThreshold":1,"failureThreshold":3},"lifecycle":{"preStop":{"exec":{"command":["/bin/bash","-c","if [ ! -z \"$(cat /etc/pod-info/skipPreStopChecks)\" ]; then exit 0; fi; rabbitmq-upgrade await_online_quorum_plus_one -t 604800; rabbitmq-upgrade await_online_synchronized_mirror -t 604800; rabbitmq-upgrade drain -t 604800"]}}},"terminationMessagePath":"/dev/termination-log","terminationMessagePolicy":"File","imagePullPolicy":"IfNotPresent"}],"restartPolicy":"Always","terminationGracePeriodSeconds":604800,"dnsPolicy":"ClusterFirst","serviceAccountName":"rabbitmq-cluster-server","serviceAccount":"rabbitmq-cluster-server","automountServiceAccountToken":true,"securityContext":{"runAsUser":999,"runAsGroup":999,"fsGroup":999},"schedulerName":"default-scheduler","topologySpreadConstraints":[{"maxSkew":1,"topologyKey":"topology.kubernetes.io/zone","whenUnsatisfiable":"ScheduleAnyway","labelSelector":{"matchLabels":{"app.kubernetes.io/name":"rabbitmq-cluster"}}}]}},"volumeClaimTemplates":[{"metadata":{"name":"persistence","namespace":"default","creationTimestamp":null,"labels":{"app.kubernetes.io/component":"rabbitmq","app.kubernetes.io/name":"rabbitmq-cluster","app.kubernetes.io/part-of":"rabbitmq"},"ownerReferences":[{"apiVersion":"rabbitmq.com/v1beta1","kind":"RabbitmqCluster","name":"rabbitmq-cluster","uid":"18d9928b-0d1c-47be-80ec-20960d053827","controller":true,"blockOwnerDeletion":false}]},"spec":{"accessModes":["ReadWriteOnce"],"resources":{"requests":{"storage":"10Gi"}},"volumeMode":"Filesystem"},"status":{"phase":"Pending"}}],"serviceName":"rabbitmq-cluster-nodes","podManagementPolicy":"Parallel","updateStrategy":{"type":"RollingUpdate","rollingUpdate":{"partition":0}},"revisionHistoryLimit":10},"status":{"observedGeneration":1,"replicas":1,"currentReplicas":1,"updatedReplicas":1,"currentRevision":"rabbitmq-cluster-server-5f8b8665fb","updateRevision":"rabbitmq-cluster-server-5f8b8665fb","collisionCount":0}}
2022/03/18 18:01:08 learn_server.go:256: [SIEVE-BEFORE-WRITE]	23
2022/03/18 18:01:08 learn_server.go:263: [SIEVE-AFTER-WRITE]	23	Update	statefulset	github.com/rabbitmq/cluster-operator/controllers.(*RabbitmqClusterReconciler)	NoError	{"metadata":{"name":"rabbitmq-cluster-server","namespace":"default","selfLink":"/apis/apps/v1/namespaces/default/statefulsets/rabbitmq-cluster-server","uid":"cb5c43bc-6ee7-481c-ab01-6f3acffdd3c8","resourceVersion":"744","generation":1,"creationTimestamp":"2022-03-18T18:00:38Z","labels":{"app.kubernetes.io/component":"rabbitmq","app.kubernetes.io/name":"rabbitmq-cluster","app.kubernetes.io/part-of":"rabbitmq"},"annotations":{"rabbitmq.com/createdAt":"2022-03-18T18:00:38Z"},"ownerReferences":[{"apiVersion":"rabbitmq.com/v1beta1","kind":"RabbitmqCluster","name":"rabbitmq-cluster","uid":"18d9928b-0d1c-47be-80ec-20960d053827","controller":true,"blockOwnerDeletion":true}],"managedFields":[{"manager":"kube-controller-manager","operation":"Update","apiVersion":"apps/v1","time":"2022-03-18T18:00:38Z","fieldsType":"FieldsV1","fieldsV1":{"f:status":{"f:collisionCount":{},"f:currentReplicas":{},"f:currentRevision":{},"f:observedGeneration":{},"f:replicas":{},"f:updateRevision":{},"f:updatedReplicas":{}}}},{"manager":"manager","operation":"Update","apiVersion":"apps/v1","time":"2022-03-18T18:00:38Z","fieldsType":"FieldsV1","fieldsV1":{"f:metadata":{"f:annotations":{".":{},"f:rabbitmq.com/createdAt":{}},"f:labels":{".":{},"f:app.kubernetes.io/component":{},"f:app.kubernetes.io/name":{},"f:app.kubernetes.io/part-of":{}},"f:ownerReferences":{".":{},"k:{\"uid\":\"18d9928b-0d1c-47be-80ec-20960d053827\"}":{".":{},"f:apiVersion":{},"f:blockOwnerDeletion":{},"f:controller":{},"f:kind":{},"f:name":{},"f:uid":{}}}},"f:spec":{"f:podManagementPolicy":{},"f:replicas":{},"f:revisionHistoryLimit":{},"f:selector":{"f:matchLabels":{".":{},"f:app.kubernetes.io/name":{}}},"f:serviceName":{},"f:template":{"f:metadata":{"f:annotations":{".":{},"f:prometheus.io/port":{},"f:prometheus.io/scrape":{}},"f:labels":{".":{},"f:app.kubernetes.io/component":{},"f:app.kubernetes.io/name":{},"f:app.kubernetes.io/part-of":{}}},"f:spec":{"f:automountServiceAccountToken":{},"f:containers":{"k:{\"name\":\"rabbitmq\"}":{".":{},"f:env":{".":{},"k:{\"name\":\"K8S_HOSTNAME_SUFFIX\"}":{".":{},"f:name":{},"f:value":{}},"k:{\"name\":\"K8S_SERVICE_NAME\"}":{".":{},"f:name":{},"f:value":{}},"k:{\"name\":\"MY_POD_NAME\"}":{".":{},"f:name":{},"f:valueFrom":{".":{},"f:fieldRef":{".":{},"f:apiVersion":{},"f:fieldPath":{}}}},"k:{\"name\":\"MY_POD_NAMESPACE\"}":{".":{},"f:name":{},"f:valueFrom":{".":{},"f:fieldRef":{".":{},"f:apiVersion":{},"f:fieldPath":{}}}},"k:{\"name\":\"RABBITMQ_ENABLED_PLUGINS_FILE\"}":{".":{},"f:name":{},"f:value":{}},"k:{\"name\":\"RABBITMQ_NODENAME\"}":{".":{},"f:name":{},"f:value":{}},"k:{\"name\":\"RABBITMQ_USE_LONGNAME\"}":{".":{},"f:name":{},"f:value":{}}},"f:image":{},"f:imagePullPolicy":{},"f:lifecycle":{".":{},"f:preStop":{".":{},"f:exec":{".":{},"f:command":{}}}},"f:name":{},"f:ports":{".":{},"k:{\"containerPort\":4369,\"protocol\":\"TCP\"}":{".":{},"f:containerPort":{},"f:name":{},"f:protocol":{}},"k:{\"containerPort\":5672,\"protocol\":\"TCP\"}":{".":{},"f:containerPort":{},"f:name":{},"f:protocol":{}},"k:{\"containerPort\":15672,\"protocol\":\"TCP\"}":{".":{},"f:containerPort":{},"f:name":{},"f:protocol":{}},"k:{\"containerPort\":15692,\"protocol\":\"TCP\"}":{".":{},"f:containerPort":{},"f:name":{},"f:protocol":{}}},"f:readinessProbe":{".":{},"f:failureThreshold":{},"f:initialDelaySeconds":{},"f:periodSeconds":{},"f:successThreshold":{},"f:tcpSocket":{".":{},"f:port":{}},"f:timeoutSeconds":{}},"f:resources":{".":{},"f:limits":{".":{},"f:cpu":{},"f:memory":{}},"f:requests":{".":{},"f:cpu":{},"f:memory":{}}},"f:terminationMessagePath":{},"f:terminationMessagePolicy":{},"f:volumeMounts":{".":{},"k:{\"mountPath\":\"/etc/pod-info/\"}":{".":{},"f:mountPath":{},"f:name":{}},"k:{\"mountPath\":\"/etc/rabbitmq/conf.d/10-operatorDefaults.conf\"}":{".":{},"f:mountPath":{},"f:name":{},"f:subPath":{}},"k:{\"mountPath\":\"/etc/rabbitmq/conf.d/11-default_user.conf\"}":{".":{},"f:mountPath":{},"f:name":{},"f:subPath":{}},"k:{\"mountPath\":\"/etc/rabbitmq/conf.d/90-userDefinedConfiguration.conf\"}":{".":{},"f:mountPath":{},"f:name":{},"f:subPath":{}},"k:{\"mountPath\":\"/operator\"}":{".":{},"f:mountPath":{},"f:name":{}},"k:{\"mountPath\":\"/var/lib/rabbitmq/\"}":{".":{},"f:mountPath":{},"f:name":{}},"k:{\"mountPath\":\"/var/lib/rabbitmq/mnesia/\"}":{".":{},"f:mountPath":{},"f:name":{}}}}},"f:dnsPolicy":{},"f:initContainers":{".":{},"k:{\"name\":\"setup-container\"}":{".":{},"f:command":{},"f:image":{},"f:imagePullPolicy":{},"f:name":{},"f:resources":{".":{},"f:limits":{".":{},"f:cpu":{},"f:memory":{}},"f:requests":{".":{},"f:cpu":{},"f:memory":{}}},"f:securityContext":{".":{},"f:capabilities":{".":{},"f:drop":{}},"f:runAsUser":{}},"f:terminationMessagePath":{},"f:terminationMessagePolicy":{},"f:volumeMounts":{".":{},"k:{\"mountPath\":\"/operator\"}":{".":{},"f:mountPath":{},"f:name":{}},"k:{\"mountPath\":\"/tmp/default_user.conf\"}":{".":{},"f:mountPath":{},"f:name":{},"f:subPath":{}},"k:{\"mountPath\":\"/tmp/erlang-cookie-secret/\"}":{".":{},"f:mountPath":{},"f:name":{}},"k:{\"mountPath\":\"/tmp/rabbitmq-plugins/\"}":{".":{},"f:mountPath":{},"f:name":{}},"k:{\"mountPath\":\"/var/lib/rabbitmq/\"}":{".":{},"f:mountPath":{},"f:name":{}},"k:{\"mountPath\":\"/var/lib/rabbitmq/mnesia/\"}":{".":{},"f:mountPath":{},"f:name":{}}}}},"f:restartPolicy":{},"f:schedulerName":{},"f:securityContext":{".":{},"f:fsGroup":{},"f:runAsGroup":{},"f:runAsUser":{}},"f:serviceAccount":{},"f:serviceAccountName":{},"f:terminationGracePeriodSeconds":{},"f:topologySpreadConstraints":{".":{},"k:{\"topologyKey\":\"topology.kubernetes.io/zone\",\"whenUnsatisfiable\":\"ScheduleAnyway\"}":{".":{},"f:labelSelector":{".":{},"f:matchLabels":{".":{},"f:app.kubernetes.io/name":{}}},"f:maxSkew":{},"f:topologyKey":{},"f:whenUnsatisfiable":{}}},"f:volumes":{".":{},"k:{\"name\":\"erlang-cookie-secret\"}":{".":{},"f:name":{},"f:secret":{".":{},"f:defaultMode":{},"f:secretName":{}}},"k:{\"name\":\"plugins-conf\"}":{".":{},"f:configMap":{".":{},"f:defaultMode":{},"f:name":{}},"f:name":{}},"k:{\"name\":\"pod-info\"}":{".":{},"f:downwardAPI":{".":{},"f:defaultMode":{},"f:items":{}},"f:name":{}},"k:{\"name\":\"rabbitmq-confd\"}":{".":{},"f:name":{},"f:projected":{".":{},"f:defaultMode":{},"f:sources":{}}},"k:{\"name\":\"rabbitmq-erlang-cookie\"}":{".":{},"f:emptyDir":{},"f:name":{}},"k:{\"name\":\"rabbitmq-plugins\"}":{".":{},"f:emptyDir":{},"f:name":{}}}}},"f:updateStrategy":{"f:rollingUpdate":{".":{},"f:partition":{}},"f:type":{}},"f:volumeClaimTemplates":{}}}}]},"spec":{"replicas":1,"selector":{"matchLabels":{"app.kubernetes.io/name":"rabbitmq-cluster"}},"template":{"metadata":{"creationTimestamp":null,"labels":{"app.kubernetes.io/component":"rabbitmq","app.kubernetes.io/name":"rabbitmq-cluster","app.kubernetes.io/part-of":"rabbitmq"},"annotations":{"prometheus.io/port":"15692","prometheus.io/scrape":"true"}},"spec":{"volumes":[{"name":"plugins-conf","configMap":{"name":"rabbitmq-cluster-plugins-conf","defaultMode":420}},{"name":"rabbitmq-confd","projected":{"sources":[{"secret":{"name":"rabbitmq-cluster-default-user","items":[{"key":"default_user.conf","path":"default_user.conf"}]}},{"configMap":{"name":"rabbitmq-cluster-server-conf","items":[{"key":"operatorDefaults.conf","path":"operatorDefaults.conf"},{"key":"userDefinedConfiguration.conf","path":"userDefinedConfiguration.conf"}]}}],"defaultMode":420}},{"name":"rabbitmq-erlang-cookie","emptyDir":{}},{"name":"erlang-cookie-secret","secret":{"secretName":"rabbitmq-cluster-erlang-cookie","defaultMode":420}},{"name":"rabbitmq-plugins","emptyDir":{}},{"name":"pod-info","downwardAPI":{"items":[{"path":"skipPreStopChecks","fieldRef":{"apiVersion":"v1","fieldPath":"metadata.labels['skipPreStopChecks']"}}],"defaultMode":420}}],"initContainers":[{"name":"setup-container","image":"rabbitmq:3.8.12-management","command":["sh","-c","cp /tmp/erlang-cookie-secret/.erlang.cookie /var/lib/rabbitmq/.erlang.cookie \u0026\u0026 chown 999:999 /var/lib/rabbitmq/.erlang.cookie \u0026\u0026 chmod 600 /var/lib/rabbitmq/.erlang.cookie ; cp /tmp/rabbitmq-plugins/enabled_plugins /operator/enabled_plugins \u0026\u0026 chown 999:999 /operator/enabled_plugins ; chown 999:999 /var/lib/rabbitmq/mnesia/ ; echo '[default]' \u003e /var/lib/rabbitmq/.rabbitmqadmin.conf \u0026\u0026 sed -e 's/default_user/username/' -e 's/default_pass/password/' /tmp/default_user.conf \u003e\u003e /var/lib/rabbitmq/.rabbitmqadmin.conf \u0026\u0026 chown 999:999 /var/lib/rabbitmq/.rabbitmqadmin.conf \u0026\u0026 chmod 600 /var/lib/rabbitmq/.rabbitmqadmin.conf"],"resources":{"limits":{"cpu":"100m","memory":"500Mi"},"requests":{"cpu":"100m","memory":"500Mi"}},"volumeMounts":[{"name":"plugins-conf","mountPath":"/tmp/rabbitmq-plugins/"},{"name":"rabbitmq-erlang-cookie","mountPath":"/var/lib/rabbitmq/"},{"name":"erlang-cookie-secret","mountPath":"/tmp/erlang-cookie-secret/"},{"name":"rabbitmq-plugins","mountPath":"/operator"},{"name":"persistence","mountPath":"/var/lib/rabbitmq/mnesia/"},{"name":"rabbitmq-confd","mountPath":"/tmp/default_user.conf","subPath":"default_user.conf"}],"terminationMessagePath":"/dev/termination-log","terminationMessagePolicy":"File","imagePullPolicy":"IfNotPresent","securityContext":{"capabilities":{"drop":["FSETID","KILL","SETGID","SETUID","SETPCAP","NET_BIND_SERVICE","NET_RAW","SYS_CHROOT","MKNOD","AUDIT_WRITE","SETFCAP"]},"runAsUser":0}}],"containers":[{"name":"rabbitmq","image":"rabbitmq:3.8.12-management","ports":[{"name":"epmd","containerPort":4369,"protocol":"TCP"},{"name":"amqp","containerPort":5672,"protocol":"TCP"},{"name":"management","containerPort":15672,"protocol":"TCP"},{"name":"prometheus","containerPort":15692,"protocol":"TCP"}],"env":[{"name":"MY_POD_NAME","valueFrom":{"fieldRef":{"apiVersion":"v1","fieldPath":"metadata.name"}}},{"name":"MY_POD_NAMESPACE","valueFrom":{"fieldRef":{"apiVersion":"v1","fieldPath":"metadata.namespace"}}},{"name":"RABBITMQ_ENABLED_PLUGINS_FILE","value":"/operator/enabled_plugins"},{"name":"K8S_SERVICE_NAME","value":"rabbitmq-cluster-nodes"},{"name":"RABBITMQ_USE_LONGNAME","value":"true"},{"name":"RABBITMQ_NODENAME","value":"rabbit@$(MY_POD_NAME).$(K8S_SERVICE_NAME).$(MY_POD_NAMESPACE)"},{"name":"K8S_HOSTNAME_SUFFIX","value":".$(K8S_SERVICE_NAME).$(MY_POD_NAMESPACE)"}],"resources":{"limits":{"cpu":"2","memory":"2Gi"},"requests":{"cpu":"1","memory":"2Gi"}},"volumeMounts":[{"name":"rabbitmq-erlang-cookie","mountPath":"/var/lib/rabbitmq/"},{"name":"persistence","mountPath":"/var/lib/rabbitmq/mnesia/"},{"name":"rabbitmq-plugins","mountPath":"/operator"},{"name":"rabbitmq-confd","mountPath":"/etc/rabbitmq/conf.d/10-operatorDefaults.conf","subPath":"operatorDefaults.conf"},{"name":"rabbitmq-confd","mountPath":"/etc/rabbitmq/conf.d/11-default_user.conf","subPath":"default_user.conf"},{"name":"rabbitmq-confd","mountPath":"/etc/rabbitmq/conf.d/90-userDefinedConfiguration.conf","subPath":"userDefinedConfiguration.conf"},{"name":"pod-info","mountPath":"/etc/pod-info/"}],"readinessProbe":{"tcpSocket":{"port":"amqp"},"initialDelaySeconds":10,"timeoutSeconds":5,"periodSeconds":10,"successThreshold":1,"failureThreshold":3},"lifecycle":{"preStop":{"exec":{"command":["/bin/bash","-c","if [ ! -z \"$(cat /etc/pod-info/skipPreStopChecks)\" ]; then exit 0; fi; rabbitmq-upgrade await_online_quorum_plus_one -t 604800; rabbitmq-upgrade await_online_synchronized_mirror -t 604800; rabbitmq-upgrade drain -t 604800"]}}},"terminationMessagePath":"/dev/termination-log","terminationMessagePolicy":"File","imagePullPolicy":"IfNotPresent"}],"restartPolicy":"Always","terminationGracePeriodSeconds":604800,"dnsPolicy":"ClusterFirst","serviceAccountName":"rabbitmq-cluster-server","serviceAccount":"rabbitmq-cluster-server","automountServiceAccountToken":true,"securityContext":{"runAsUser":999,"runAsGroup":999,"fsGroup":999},"schedulerName":"default-scheduler","topologySpreadConstraints":[{"maxSkew":1,"topologyKey":"topology.kubernetes.io/zone","whenUnsatisfiable":"ScheduleAnyway","labelSelector":{"matchLabels":{"app.kubernetes.io/name":"rabbitmq-cluster"}}}]}},"volumeClaimTemplates":[{"metadata":{"name":"persistence","namespace":"default","creationTimestamp":null,"labels":{"app.kubernetes.io/component":"rabbitmq","app.kubernetes.io/name":"rabbitmq-cluster","app.kubernetes.io/part-of":"rabbitmq"},"ownerReferences":[{"apiVersion":"rabbitmq.com/v1beta1","kind":"RabbitmqCluster","name":"rabbitmq-cluster","uid":"18d9928b-0d1c-47be-80ec-20960d053827","controller":true,"blockOwnerDeletion":false}]},"spec":{"accessModes":["ReadWriteOnce"],"resources":{"requests":{"storage":"10Gi"}},"volumeMode":"Filesystem"},"status":{"phase":"Pending"}}],"serviceName":"rabbitmq-cluster-nodes","podManagementPolicy":"Parallel","updateStrategy":{"type":"RollingUpdate","rollingUpdate":{"partition":0}},"revisionHistoryLimit":10},"status":{"observedGeneration":1,"replicas":1,"currentReplicas":1,"updatedReplicas":1,"currentRevision":"rabbitmq-cluster-server-5f8b8665fb","updateRevision":"rabbitmq-cluster-server-5f8b8665fb","collisionCount":0}}
2022/03/18 18:01:08 learn_server.go:291: [SIEVE-AFTER-READ]	Get	true	configmap	default	rabbitmq-cluster-server-conf	github.com/rabbitmq/cluster-operator/controllers.(*RabbitmqClusterReconciler)	NoError	{"kind":"ConfigMap","apiVersion":"v1","metadata":{"name":"rabbitmq-cluster-server-conf","namespace":"default","selfLink":"/api/v1/namespaces/default/configmaps/rabbitmq-cluster-server-conf","uid":"22474f2b-8454-44b7-8079-8990223969cc","resourceVersion":"714","creationTimestamp":"2022-03-18T18:00:38Z","labels":{"app.kubernetes.io/component":"rabbitmq","app.kubernetes.io/name":"rabbitmq-cluster","app.kubernetes.io/part-of":"rabbitmq"},"ownerReferences":[{"apiVersion":"rabbitmq.com/v1beta1","kind":"RabbitmqCluster","name":"rabbitmq-cluster","uid":"18d9928b-0d1c-47be-80ec-20960d053827","controller":true,"blockOwnerDeletion":true}],"managedFields":[{"manager":"manager","operation":"Update","apiVersion":"v1","time":"2022-03-18T18:00:38Z","fieldsType":"FieldsV1","fieldsV1":{"f:data":{".":{},"f:operatorDefaults.conf":{},"f:userDefinedConfiguration.conf":{}},"f:metadata":{"f:labels":{".":{},"f:app.kubernetes.io/component":{},"f:app.kubernetes.io/name":{},"f:app.kubernetes.io/part-of":{}},"f:ownerReferences":{".":{},"k:{\"uid\":\"18d9928b-0d1c-47be-80ec-20960d053827\"}":{".":{},"f:apiVersion":{},"f:blockOwnerDeletion":{},"f:controller":{},"f:kind":{},"f:name":{},"f:uid":{}}}}}}]},"data":{"operatorDefaults.conf":"cluster_formation.peer_discovery_backend             = rabbit_peer_discovery_k8s\ncluster_formation.k8s.host                           = kubernetes.default\ncluster_formation.k8s.address_type                   = hostname\ncluster_partition_handling                           = pause_minority\nqueue_master_locator                                 = min-masters\ndisk_free_limit.absolute                             = 2GB\ncluster_formation.randomized_startup_delay_range.min = 5\ncluster_formation.randomized_startup_delay_range.max = 30\ncluster_name                                         = rabbitmq-cluster\n","userDefinedConfiguration.conf":"total_memory_available_override_value = 1717986919\n"}}
2022/03/18 18:01:08 learn_server.go:256: [SIEVE-BEFORE-WRITE]	24
2022/03/18 18:01:08 learn_server.go:263: [SIEVE-AFTER-WRITE]	24	StatusUpdate	rabbitmqcluster	github.com/rabbitmq/cluster-operator/controllers.(*RabbitmqClusterReconciler)	NoError	{"metadata":{"name":"rabbitmq-cluster","namespace":"default","selfLink":"/apis/rabbitmq.com/v1beta1/namespaces/default/rabbitmqclusters/rabbitmq-cluster/status","uid":"18d9928b-0d1c-47be-80ec-20960d053827","resourceVersion":"746","generation":2,"creationTimestamp":"2022-03-18T18:00:38Z","annotations":{"kubectl.kubernetes.io/last-applied-configuration":"{\"apiVersion\":\"rabbitmq.com/v1beta1\",\"kind\":\"RabbitmqCluster\",\"metadata\":{\"annotations\":{},\"name\":\"rabbitmq-cluster\",\"namespace\":\"default\"},\"spec\":{\"persistence\":{\"storage\":\"10Gi\"},\"replicas\":1}}\n"},"finalizers":["deletion.finalizers.rabbitmqclusters.rabbitmq.com"],"managedFields":[{"manager":"kubectl-client-side-apply","operation":"Update","apiVersion":"rabbitmq.com/v1beta1","time":"2022-03-18T18:00:38Z","fieldsType":"FieldsV1","fieldsV1":{"f:metadata":{"f:annotations":{".":{},"f:kubectl.kubernetes.io/last-applied-configuration":{}}},"f:spec":{".":{},"f:image":{},"f:persistence":{".":{},"f:storage":{}},"f:replicas":{},"f:resources":{".":{},"f:limits":{".":{},"f:memory":{}},"f:requests":{".":{},"f:memory":{}}},"f:service":{".":{},"f:type":{}},"f:terminationGracePeriodSeconds":{}}}},{"manager":"manager","operation":"Update","apiVersion":"rabbitmq.com/v1beta1","time":"2022-03-18T18:00:38Z","fieldsType":"FieldsV1","fieldsV1":{"f:metadata":{"f:finalizers":{}},"f:spec":{"f:override":{},"f:rabbitmq":{},"f:resources":{"f:limits":{"f:cpu":{}},"f:requests":{"f:cpu":{}}},"f:tls":{}},"f:status":{".":{},"f:conditions":{},"f:defaultUser":{".":{},"f:secretReference":{".":{},"f:keys":{".":{},"f:password":{},"f:username":{}},"f:name":{},"f:namespace":{}},"f:serviceReference":{".":{},"f:name":{},"f:namespace":{}}}}}}]},"spec":{"replicas":1,"image":"rabbitmq:3.8.12-management","service":{"type":"ClusterIP"},"persistence":{"storage":"10Gi"},"resources":{"limits":{"cpu":"2","memory":"2Gi"},"requests":{"cpu":"1","memory":"2Gi"}},"rabbitmq":{},"tls":{},"override":{},"terminationGracePeriodSeconds":604800},"status":{"conditions":[{"type":"AllReplicasReady","status":"False","lastTransitionTime":"2022-03-18T18:00:38Z","reason":"NotAllPodsReady","message":"0/1 Pods ready"},{"type":"ClusterAvailable","status":"False","lastTransitionTime":"2022-03-18T18:00:38Z","reason":"NoEndpointsAvailable","message":"The service has no endpoints available"},{"type":"NoWarnings","status":"True","lastTransitionTime":"2022-03-18T18:00:38Z","reason":"NoWarnings"},{"type":"ReconcileSuccess","status":"Unknown","lastTransitionTime":"2022-03-18T18:00:38Z","reason":"Initialising"}],"defaultUser":{"secretReference":{"name":"rabbitmq-cluster-default-user","namespace":"default","keys":{"password":"password","username":"username"}},"serviceReference":{"name":"rabbitmq-cluster","namespace":"default"}},"binding":{"name":"rabbitmq-cluster-default-user"}}}
2022/03/18 18:01:08 learn_server.go:291: [SIEVE-AFTER-READ]	Get	true	statefulset	default	rabbitmq-cluster-server	github.com/rabbitmq/cluster-operator/controllers.(*RabbitmqClusterReconciler)	NoError	{"kind":"StatefulSet","apiVersion":"apps/v1","metadata":{"name":"rabbitmq-cluster-server","namespace":"default","selfLink":"/apis/apps/v1/namespaces/default/statefulsets/rabbitmq-cluster-server","uid":"cb5c43bc-6ee7-481c-ab01-6f3acffdd3c8","resourceVersion":"744","generation":1,"creationTimestamp":"2022-03-18T18:00:38Z","labels":{"app.kubernetes.io/component":"rabbitmq","app.kubernetes.io/name":"rabbitmq-cluster","app.kubernetes.io/part-of":"rabbitmq"},"annotations":{"rabbitmq.com/createdAt":"2022-03-18T18:00:38Z"},"ownerReferences":[{"apiVersion":"rabbitmq.com/v1beta1","kind":"RabbitmqCluster","name":"rabbitmq-cluster","uid":"18d9928b-0d1c-47be-80ec-20960d053827","controller":true,"blockOwnerDeletion":true}],"managedFields":[{"manager":"kube-controller-manager","operation":"Update","apiVersion":"apps/v1","time":"2022-03-18T18:00:38Z","fieldsType":"FieldsV1","fieldsV1":{"f:status":{"f:collisionCount":{},"f:currentReplicas":{},"f:currentRevision":{},"f:observedGeneration":{},"f:replicas":{},"f:updateRevision":{},"f:updatedReplicas":{}}}},{"manager":"manager","operation":"Update","apiVersion":"apps/v1","time":"2022-03-18T18:00:38Z","fieldsType":"FieldsV1","fieldsV1":{"f:metadata":{"f:annotations":{".":{},"f:rabbitmq.com/createdAt":{}},"f:labels":{".":{},"f:app.kubernetes.io/component":{},"f:app.kubernetes.io/name":{},"f:app.kubernetes.io/part-of":{}},"f:ownerReferences":{".":{},"k:{\"uid\":\"18d9928b-0d1c-47be-80ec-20960d053827\"}":{".":{},"f:apiVersion":{},"f:blockOwnerDeletion":{},"f:controller":{},"f:kind":{},"f:name":{},"f:uid":{}}}},"f:spec":{"f:podManagementPolicy":{},"f:replicas":{},"f:revisionHistoryLimit":{},"f:selector":{"f:matchLabels":{".":{},"f:app.kubernetes.io/name":{}}},"f:serviceName":{},"f:template":{"f:metadata":{"f:annotations":{".":{},"f:prometheus.io/port":{},"f:prometheus.io/scrape":{}},"f:labels":{".":{},"f:app.kubernetes.io/component":{},"f:app.kubernetes.io/name":{},"f:app.kubernetes.io/part-of":{}}},"f:spec":{"f:automountServiceAccountToken":{},"f:containers":{"k:{\"name\":\"rabbitmq\"}":{".":{},"f:env":{".":{},"k:{\"name\":\"K8S_HOSTNAME_SUFFIX\"}":{".":{},"f:name":{},"f:value":{}},"k:{\"name\":\"K8S_SERVICE_NAME\"}":{".":{},"f:name":{},"f:value":{}},"k:{\"name\":\"MY_POD_NAME\"}":{".":{},"f:name":{},"f:valueFrom":{".":{},"f:fieldRef":{".":{},"f:apiVersion":{},"f:fieldPath":{}}}},"k:{\"name\":\"MY_POD_NAMESPACE\"}":{".":{},"f:name":{},"f:valueFrom":{".":{},"f:fieldRef":{".":{},"f:apiVersion":{},"f:fieldPath":{}}}},"k:{\"name\":\"RABBITMQ_ENABLED_PLUGINS_FILE\"}":{".":{},"f:name":{},"f:value":{}},"k:{\"name\":\"RABBITMQ_NODENAME\"}":{".":{},"f:name":{},"f:value":{}},"k:{\"name\":\"RABBITMQ_USE_LONGNAME\"}":{".":{},"f:name":{},"f:value":{}}},"f:image":{},"f:imagePullPolicy":{},"f:lifecycle":{".":{},"f:preStop":{".":{},"f:exec":{".":{},"f:command":{}}}},"f:name":{},"f:ports":{".":{},"k:{\"containerPort\":4369,\"protocol\":\"TCP\"}":{".":{},"f:containerPort":{},"f:name":{},"f:protocol":{}},"k:{\"containerPort\":5672,\"protocol\":\"TCP\"}":{".":{},"f:containerPort":{},"f:name":{},"f:protocol":{}},"k:{\"containerPort\":15672,\"protocol\":\"TCP\"}":{".":{},"f:containerPort":{},"f:name":{},"f:protocol":{}},"k:{\"containerPort\":15692,\"protocol\":\"TCP\"}":{".":{},"f:containerPort":{},"f:name":{},"f:protocol":{}}},"f:readinessProbe":{".":{},"f:failureThreshold":{},"f:initialDelaySeconds":{},"f:periodSeconds":{},"f:successThreshold":{},"f:tcpSocket":{".":{},"f:port":{}},"f:timeoutSeconds":{}},"f:resources":{".":{},"f:limits":{".":{},"f:cpu":{},"f:memory":{}},"f:requests":{".":{},"f:cpu":{},"f:memory":{}}},"f:terminationMessagePath":{},"f:terminationMessagePolicy":{},"f:volumeMounts":{".":{},"k:{\"mountPath\":\"/etc/pod-info/\"}":{".":{},"f:mountPath":{},"f:name":{}},"k:{\"mountPath\":\"/etc/rabbitmq/conf.d/10-operatorDefaults.conf\"}":{".":{},"f:mountPath":{},"f:name":{},"f:subPath":{}},"k:{\"mountPath\":\"/etc/rabbitmq/conf.d/11-default_user.conf\"}":{".":{},"f:mountPath":{},"f:name":{},"f:subPath":{}},"k:{\"mountPath\":\"/etc/rabbitmq/conf.d/90-userDefinedConfiguration.conf\"}":{".":{},"f:mountPath":{},"f:name":{},"f:subPath":{}},"k:{\"mountPath\":\"/operator\"}":{".":{},"f:mountPath":{},"f:name":{}},"k:{\"mountPath\":\"/var/lib/rabbitmq/\"}":{".":{},"f:mountPath":{},"f:name":{}},"k:{\"mountPath\":\"/var/lib/rabbitmq/mnesia/\"}":{".":{},"f:mountPath":{},"f:name":{}}}}},"f:dnsPolicy":{},"f:initContainers":{".":{},"k:{\"name\":\"setup-container\"}":{".":{},"f:command":{},"f:image":{},"f:imagePullPolicy":{},"f:name":{},"f:resources":{".":{},"f:limits":{".":{},"f:cpu":{},"f:memory":{}},"f:requests":{".":{},"f:cpu":{},"f:memory":{}}},"f:securityContext":{".":{},"f:capabilities":{".":{},"f:drop":{}},"f:runAsUser":{}},"f:terminationMessagePath":{},"f:terminationMessagePolicy":{},"f:volumeMounts":{".":{},"k:{\"mountPath\":\"/operator\"}":{".":{},"f:mountPath":{},"f:name":{}},"k:{\"mountPath\":\"/tmp/default_user.conf\"}":{".":{},"f:mountPath":{},"f:name":{},"f:subPath":{}},"k:{\"mountPath\":\"/tmp/erlang-cookie-secret/\"}":{".":{},"f:mountPath":{},"f:name":{}},"k:{\"mountPath\":\"/tmp/rabbitmq-plugins/\"}":{".":{},"f:mountPath":{},"f:name":{}},"k:{\"mountPath\":\"/var/lib/rabbitmq/\"}":{".":{},"f:mountPath":{},"f:name":{}},"k:{\"mountPath\":\"/var/lib/rabbitmq/mnesia/\"}":{".":{},"f:mountPath":{},"f:name":{}}}}},"f:restartPolicy":{},"f:schedulerName":{},"f:securityContext":{".":{},"f:fsGroup":{},"f:runAsGroup":{},"f:runAsUser":{}},"f:serviceAccount":{},"f:serviceAccountName":{},"f:terminationGracePeriodSeconds":{},"f:topologySpreadConstraints":{".":{},"k:{\"topologyKey\":\"topology.kubernetes.io/zone\",\"whenUnsatisfiable\":\"ScheduleAnyway\"}":{".":{},"f:labelSelector":{".":{},"f:matchLabels":{".":{},"f:app.kubernetes.io/name":{}}},"f:maxSkew":{},"f:topologyKey":{},"f:whenUnsatisfiable":{}}},"f:volumes":{".":{},"k:{\"name\":\"erlang-cookie-secret\"}":{".":{},"f:name":{},"f:secret":{".":{},"f:defaultMode":{},"f:secretName":{}}},"k:{\"name\":\"plugins-conf\"}":{".":{},"f:configMap":{".":{},"f:defaultMode":{},"f:name":{}},"f:name":{}},"k:{\"name\":\"pod-info\"}":{".":{},"f:downwardAPI":{".":{},"f:defaultMode":{},"f:items":{}},"f:name":{}},"k:{\"name\":\"rabbitmq-confd\"}":{".":{},"f:name":{},"f:projected":{".":{},"f:defaultMode":{},"f:sources":{}}},"k:{\"name\":\"rabbitmq-erlang-cookie\"}":{".":{},"f:emptyDir":{},"f:name":{}},"k:{\"name\":\"rabbitmq-plugins\"}":{".":{},"f:emptyDir":{},"f:name":{}}}}},"f:updateStrategy":{"f:rollingUpdate":{".":{},"f:partition":{}},"f:type":{}},"f:volumeClaimTemplates":{}}}}]},"spec":{"replicas":1,"selector":{"matchLabels":{"app.kubernetes.io/name":"rabbitmq-cluster"}},"template":{"metadata":{"creationTimestamp":null,"labels":{"app.kubernetes.io/component":"rabbitmq","app.kubernetes.io/name":"rabbitmq-cluster","app.kubernetes.io/part-of":"rabbitmq"},"annotations":{"prometheus.io/port":"15692","prometheus.io/scrape":"true"}},"spec":{"volumes":[{"name":"plugins-conf","configMap":{"name":"rabbitmq-cluster-plugins-conf","defaultMode":420}},{"name":"rabbitmq-confd","projected":{"sources":[{"secret":{"name":"rabbitmq-cluster-default-user","items":[{"key":"default_user.conf","path":"default_user.conf"}]}},{"configMap":{"name":"rabbitmq-cluster-server-conf","items":[{"key":"operatorDefaults.conf","path":"operatorDefaults.conf"},{"key":"userDefinedConfiguration.conf","path":"userDefinedConfiguration.conf"}]}}],"defaultMode":420}},{"name":"rabbitmq-erlang-cookie","emptyDir":{}},{"name":"erlang-cookie-secret","secret":{"secretName":"rabbitmq-cluster-erlang-cookie","defaultMode":420}},{"name":"rabbitmq-plugins","emptyDir":{}},{"name":"pod-info","downwardAPI":{"items":[{"path":"skipPreStopChecks","fieldRef":{"apiVersion":"v1","fieldPath":"metadata.labels['skipPreStopChecks']"}}],"defaultMode":420}}],"initContainers":[{"name":"setup-container","image":"rabbitmq:3.8.12-management","command":["sh","-c","cp /tmp/erlang-cookie-secret/.erlang.cookie /var/lib/rabbitmq/.erlang.cookie \u0026\u0026 chown 999:999 /var/lib/rabbitmq/.erlang.cookie \u0026\u0026 chmod 600 /var/lib/rabbitmq/.erlang.cookie ; cp /tmp/rabbitmq-plugins/enabled_plugins /operator/enabled_plugins \u0026\u0026 chown 999:999 /operator/enabled_plugins ; chown 999:999 /var/lib/rabbitmq/mnesia/ ; echo '[default]' \u003e /var/lib/rabbitmq/.rabbitmqadmin.conf \u0026\u0026 sed -e 's/default_user/username/' -e 's/default_pass/password/' /tmp/default_user.conf \u003e\u003e /var/lib/rabbitmq/.rabbitmqadmin.conf \u0026\u0026 chown 999:999 /var/lib/rabbitmq/.rabbitmqadmin.conf \u0026\u0026 chmod 600 /var/lib/rabbitmq/.rabbitmqadmin.conf"],"resources":{"limits":{"cpu":"100m","memory":"500Mi"},"requests":{"cpu":"100m","memory":"500Mi"}},"volumeMounts":[{"name":"plugins-conf","mountPath":"/tmp/rabbitmq-plugins/"},{"name":"rabbitmq-erlang-cookie","mountPath":"/var/lib/rabbitmq/"},{"name":"erlang-cookie-secret","mountPath":"/tmp/erlang-cookie-secret/"},{"name":"rabbitmq-plugins","mountPath":"/operator"},{"name":"persistence","mountPath":"/var/lib/rabbitmq/mnesia/"},{"name":"rabbitmq-confd","mountPath":"/tmp/default_user.conf","subPath":"default_user.conf"}],"terminationMessagePath":"/dev/termination-log","terminationMessagePolicy":"File","imagePullPolicy":"IfNotPresent","securityContext":{"capabilities":{"drop":["FSETID","KILL","SETGID","SETUID","SETPCAP","NET_BIND_SERVICE","NET_RAW","SYS_CHROOT","MKNOD","AUDIT_WRITE","SETFCAP"]},"runAsUser":0}}],"containers":[{"name":"rabbitmq","image":"rabbitmq:3.8.12-management","ports":[{"name":"epmd","containerPort":4369,"protocol":"TCP"},{"name":"amqp","containerPort":5672,"protocol":"TCP"},{"name":"management","containerPort":15672,"protocol":"TCP"},{"name":"prometheus","containerPort":15692,"protocol":"TCP"}],"env":[{"name":"MY_POD_NAME","valueFrom":{"fieldRef":{"apiVersion":"v1","fieldPath":"metadata.name"}}},{"name":"MY_POD_NAMESPACE","valueFrom":{"fieldRef":{"apiVersion":"v1","fieldPath":"metadata.namespace"}}},{"name":"RABBITMQ_ENABLED_PLUGINS_FILE","value":"/operator/enabled_plugins"},{"name":"K8S_SERVICE_NAME","value":"rabbitmq-cluster-nodes"},{"name":"RABBITMQ_USE_LONGNAME","value":"true"},{"name":"RABBITMQ_NODENAME","value":"rabbit@$(MY_POD_NAME).$(K8S_SERVICE_NAME).$(MY_POD_NAMESPACE)"},{"name":"K8S_HOSTNAME_SUFFIX","value":".$(K8S_SERVICE_NAME).$(MY_POD_NAMESPACE)"}],"resources":{"limits":{"cpu":"2","memory":"2Gi"},"requests":{"cpu":"1","memory":"2Gi"}},"volumeMounts":[{"name":"rabbitmq-erlang-cookie","mountPath":"/var/lib/rabbitmq/"},{"name":"persistence","mountPath":"/var/lib/rabbitmq/mnesia/"},{"name":"rabbitmq-plugins","mountPath":"/operator"},{"name":"rabbitmq-confd","mountPath":"/etc/rabbitmq/conf.d/10-operatorDefaults.conf","subPath":"operatorDefaults.conf"},{"name":"rabbitmq-confd","mountPath":"/etc/rabbitmq/conf.d/11-default_user.conf","subPath":"default_user.conf"},{"name":"rabbitmq-confd","mountPath":"/etc/rabbitmq/conf.d/90-userDefinedConfiguration.conf","subPath":"userDefinedConfiguration.conf"},{"name":"pod-info","mountPath":"/etc/pod-info/"}],"readinessProbe":{"tcpSocket":{"port":"amqp"},"initialDelaySeconds":10,"timeoutSeconds":5,"periodSeconds":10,"successThreshold":1,"failureThreshold":3},"lifecycle":{"preStop":{"exec":{"command":["/bin/bash","-c","if [ ! -z \"$(cat /etc/pod-info/skipPreStopChecks)\" ]; then exit 0; fi; rabbitmq-upgrade await_online_quorum_plus_one -t 604800; rabbitmq-upgrade await_online_synchronized_mirror -t 604800; rabbitmq-upgrade drain -t 604800"]}}},"terminationMessagePath":"/dev/termination-log","terminationMessagePolicy":"File","imagePullPolicy":"IfNotPresent"}],"restartPolicy":"Always","terminationGracePeriodSeconds":604800,"dnsPolicy":"ClusterFirst","serviceAccountName":"rabbitmq-cluster-server","serviceAccount":"rabbitmq-cluster-server","automountServiceAccountToken":true,"securityContext":{"runAsUser":999,"runAsGroup":999,"fsGroup":999},"schedulerName":"default-scheduler","topologySpreadConstraints":[{"maxSkew":1,"topologyKey":"topology.kubernetes.io/zone","whenUnsatisfiable":"ScheduleAnyway","labelSelector":{"matchLabels":{"app.kubernetes.io/name":"rabbitmq-cluster"}}}]}},"volumeClaimTemplates":[{"metadata":{"name":"persistence","namespace":"default","creationTimestamp":null,"labels":{"app.kubernetes.io/component":"rabbitmq","app.kubernetes.io/name":"rabbitmq-cluster","app.kubernetes.io/part-of":"rabbitmq"},"ownerReferences":[{"apiVersion":"rabbitmq.com/v1beta1","kind":"RabbitmqCluster","name":"rabbitmq-cluster","uid":"18d9928b-0d1c-47be-80ec-20960d053827","controller":true,"blockOwnerDeletion":false}]},"spec":{"accessModes":["ReadWriteOnce"],"resources":{"requests":{"storage":"10Gi"}},"volumeMode":"Filesystem"},"status":{"phase":"Pending"}}],"serviceName":"rabbitmq-cluster-nodes","podManagementPolicy":"Parallel","updateStrategy":{"type":"RollingUpdate","rollingUpdate":{"partition":0}},"revisionHistoryLimit":10},"status":{"observedGeneration":1,"replicas":1,"currentReplicas":1,"updatedReplicas":1,"currentRevision":"rabbitmq-cluster-server-5f8b8665fb","updateRevision":"rabbitmq-cluster-server-5f8b8665fb","collisionCount":0}}
2022/03/18 18:01:08 learn_server.go:253: [SIEVE-AFTER-RECONCILE]	github.com/rabbitmq/cluster-operator/controllers.(*RabbitmqClusterReconciler)	4
2022/03/18 18:01:17 learn_server.go:279: [SIEVE-BEFORE-HEAR]	18	Updated	statefulset	{"metadata":{"name":"rabbitmq-cluster-server","namespace":"default","selfLink":"/apis/apps/v1/namespaces/default/statefulsets/rabbitmq-cluster-server","uid":"cb5c43bc-6ee7-481c-ab01-6f3acffdd3c8","resourceVersion":"943","generation":1,"creationTimestamp":"2022-03-18T18:00:38Z","labels":{"app.kubernetes.io/component":"rabbitmq","app.kubernetes.io/name":"rabbitmq-cluster","app.kubernetes.io/part-of":"rabbitmq"},"annotations":{"rabbitmq.com/createdAt":"2022-03-18T18:00:38Z"},"ownerReferences":[{"apiVersion":"rabbitmq.com/v1beta1","kind":"RabbitmqCluster","name":"rabbitmq-cluster","uid":"18d9928b-0d1c-47be-80ec-20960d053827","controller":true,"blockOwnerDeletion":true}],"managedFields":[{"manager":"manager","operation":"Update","apiVersion":"apps/v1","time":"2022-03-18T18:00:38Z","fieldsType":"FieldsV1","fieldsV1":{"f:metadata":{"f:annotations":{".":{},"f:rabbitmq.com/createdAt":{}},"f:labels":{".":{},"f:app.kubernetes.io/component":{},"f:app.kubernetes.io/name":{},"f:app.kubernetes.io/part-of":{}},"f:ownerReferences":{".":{},"k:{\"uid\":\"18d9928b-0d1c-47be-80ec-20960d053827\"}":{".":{},"f:apiVersion":{},"f:blockOwnerDeletion":{},"f:controller":{},"f:kind":{},"f:name":{},"f:uid":{}}}},"f:spec":{"f:podManagementPolicy":{},"f:replicas":{},"f:revisionHistoryLimit":{},"f:selector":{"f:matchLabels":{".":{},"f:app.kubernetes.io/name":{}}},"f:serviceName":{},"f:template":{"f:metadata":{"f:annotations":{".":{},"f:prometheus.io/port":{},"f:prometheus.io/scrape":{}},"f:labels":{".":{},"f:app.kubernetes.io/component":{},"f:app.kubernetes.io/name":{},"f:app.kubernetes.io/part-of":{}}},"f:spec":{"f:automountServiceAccountToken":{},"f:containers":{"k:{\"name\":\"rabbitmq\"}":{".":{},"f:env":{".":{},"k:{\"name\":\"K8S_HOSTNAME_SUFFIX\"}":{".":{},"f:name":{},"f:value":{}},"k:{\"name\":\"K8S_SERVICE_NAME\"}":{".":{},"f:name":{},"f:value":{}},"k:{\"name\":\"MY_POD_NAME\"}":{".":{},"f:name":{},"f:valueFrom":{".":{},"f:fieldRef":{".":{},"f:apiVersion":{},"f:fieldPath":{}}}},"k:{\"name\":\"MY_POD_NAMESPACE\"}":{".":{},"f:name":{},"f:valueFrom":{".":{},"f:fieldRef":{".":{},"f:apiVersion":{},"f:fieldPath":{}}}},"k:{\"name\":\"RABBITMQ_ENABLED_PLUGINS_FILE\"}":{".":{},"f:name":{},"f:value":{}},"k:{\"name\":\"RABBITMQ_NODENAME\"}":{".":{},"f:name":{},"f:value":{}},"k:{\"name\":\"RABBITMQ_USE_LONGNAME\"}":{".":{},"f:name":{},"f:value":{}}},"f:image":{},"f:imagePullPolicy":{},"f:lifecycle":{".":{},"f:preStop":{".":{},"f:exec":{".":{},"f:command":{}}}},"f:name":{},"f:ports":{".":{},"k:{\"containerPort\":4369,\"protocol\":\"TCP\"}":{".":{},"f:containerPort":{},"f:name":{},"f:protocol":{}},"k:{\"containerPort\":5672,\"protocol\":\"TCP\"}":{".":{},"f:containerPort":{},"f:name":{},"f:protocol":{}},"k:{\"containerPort\":15672,\"protocol\":\"TCP\"}":{".":{},"f:containerPort":{},"f:name":{},"f:protocol":{}},"k:{\"containerPort\":15692,\"protocol\":\"TCP\"}":{".":{},"f:containerPort":{},"f:name":{},"f:protocol":{}}},"f:readinessProbe":{".":{},"f:failureThreshold":{},"f:initialDelaySeconds":{},"f:periodSeconds":{},"f:successThreshold":{},"f:tcpSocket":{".":{},"f:port":{}},"f:timeoutSeconds":{}},"f:resources":{".":{},"f:limits":{".":{},"f:cpu":{},"f:memory":{}},"f:requests":{".":{},"f:cpu":{},"f:memory":{}}},"f:terminationMessagePath":{},"f:terminationMessagePolicy":{},"f:volumeMounts":{".":{},"k:{\"mountPath\":\"/etc/pod-info/\"}":{".":{},"f:mountPath":{},"f:name":{}},"k:{\"mountPath\":\"/etc/rabbitmq/conf.d/10-operatorDefaults.conf\"}":{".":{},"f:mountPath":{},"f:name":{},"f:subPath":{}},"k:{\"mountPath\":\"/etc/rabbitmq/conf.d/11-default_user.conf\"}":{".":{},"f:mountPath":{},"f:name":{},"f:subPath":{}},"k:{\"mountPath\":\"/etc/rabbitmq/conf.d/90-userDefinedConfiguration.conf\"}":{".":{},"f:mountPath":{},"f:name":{},"f:subPath":{}},"k:{\"mountPath\":\"/operator\"}":{".":{},"f:mountPath":{},"f:name":{}},"k:{\"mountPath\":\"/var/lib/rabbitmq/\"}":{".":{},"f:mountPath":{},"f:name":{}},"k:{\"mountPath\":\"/var/lib/rabbitmq/mnesia/\"}":{".":{},"f:mountPath":{},"f:name":{}}}}},"f:dnsPolicy":{},"f:initContainers":{".":{},"k:{\"name\":\"setup-container\"}":{".":{},"f:command":{},"f:image":{},"f:imagePullPolicy":{},"f:name":{},"f:resources":{".":{},"f:limits":{".":{},"f:cpu":{},"f:memory":{}},"f:requests":{".":{},"f:cpu":{},"f:memory":{}}},"f:securityContext":{".":{},"f:capabilities":{".":{},"f:drop":{}},"f:runAsUser":{}},"f:terminationMessagePath":{},"f:terminationMessagePolicy":{},"f:volumeMounts":{".":{},"k:{\"mountPath\":\"/operator\"}":{".":{},"f:mountPath":{},"f:name":{}},"k:{\"mountPath\":\"/tmp/default_user.conf\"}":{".":{},"f:mountPath":{},"f:name":{},"f:subPath":{}},"k:{\"mountPath\":\"/tmp/erlang-cookie-secret/\"}":{".":{},"f:mountPath":{},"f:name":{}},"k:{\"mountPath\":\"/tmp/rabbitmq-plugins/\"}":{".":{},"f:mountPath":{},"f:name":{}},"k:{\"mountPath\":\"/var/lib/rabbitmq/\"}":{".":{},"f:mountPath":{},"f:name":{}},"k:{\"mountPath\":\"/var/lib/rabbitmq/mnesia/\"}":{".":{},"f:mountPath":{},"f:name":{}}}}},"f:restartPolicy":{},"f:schedulerName":{},"f:securityContext":{".":{},"f:fsGroup":{},"f:runAsGroup":{},"f:runAsUser":{}},"f:serviceAccount":{},"f:serviceAccountName":{},"f:terminationGracePeriodSeconds":{},"f:topologySpreadConstraints":{".":{},"k:{\"topologyKey\":\"topology.kubernetes.io/zone\",\"whenUnsatisfiable\":\"ScheduleAnyway\"}":{".":{},"f:labelSelector":{".":{},"f:matchLabels":{".":{},"f:app.kubernetes.io/name":{}}},"f:maxSkew":{},"f:topologyKey":{},"f:whenUnsatisfiable":{}}},"f:volumes":{".":{},"k:{\"name\":\"erlang-cookie-secret\"}":{".":{},"f:name":{},"f:secret":{".":{},"f:defaultMode":{},"f:secretName":{}}},"k:{\"name\":\"plugins-conf\"}":{".":{},"f:configMap":{".":{},"f:defaultMode":{},"f:name":{}},"f:name":{}},"k:{\"name\":\"pod-info\"}":{".":{},"f:downwardAPI":{".":{},"f:defaultMode":{},"f:items":{}},"f:name":{}},"k:{\"name\":\"rabbitmq-confd\"}":{".":{},"f:name":{},"f:projected":{".":{},"f:defaultMode":{},"f:sources":{}}},"k:{\"name\":\"rabbitmq-erlang-cookie\"}":{".":{},"f:emptyDir":{},"f:name":{}},"k:{\"name\":\"rabbitmq-plugins\"}":{".":{},"f:emptyDir":{},"f:name":{}}}}},"f:updateStrategy":{"f:rollingUpdate":{".":{},"f:partition":{}},"f:type":{}},"f:volumeClaimTemplates":{}}}},{"manager":"kube-controller-manager","operation":"Update","apiVersion":"apps/v1","time":"2022-03-18T18:01:17Z","fieldsType":"FieldsV1","fieldsV1":{"f:status":{"f:collisionCount":{},"f:currentReplicas":{},"f:currentRevision":{},"f:observedGeneration":{},"f:readyReplicas":{},"f:replicas":{},"f:updateRevision":{},"f:updatedReplicas":{}}}}]},"spec":{"replicas":1,"selector":{"matchLabels":{"app.kubernetes.io/name":"rabbitmq-cluster"}},"template":{"metadata":{"creationTimestamp":null,"labels":{"app.kubernetes.io/component":"rabbitmq","app.kubernetes.io/name":"rabbitmq-cluster","app.kubernetes.io/part-of":"rabbitmq"},"annotations":{"prometheus.io/port":"15692","prometheus.io/scrape":"true"}},"spec":{"volumes":[{"name":"plugins-conf","configMap":{"name":"rabbitmq-cluster-plugins-conf","defaultMode":420}},{"name":"rabbitmq-confd","projected":{"sources":[{"secret":{"name":"rabbitmq-cluster-default-user","items":[{"key":"default_user.conf","path":"default_user.conf"}]}},{"configMap":{"name":"rabbitmq-cluster-server-conf","items":[{"key":"operatorDefaults.conf","path":"operatorDefaults.conf"},{"key":"userDefinedConfiguration.conf","path":"userDefinedConfiguration.conf"}]}}],"defaultMode":420}},{"name":"rabbitmq-erlang-cookie","emptyDir":{}},{"name":"erlang-cookie-secret","secret":{"secretName":"rabbitmq-cluster-erlang-cookie","defaultMode":420}},{"name":"rabbitmq-plugins","emptyDir":{}},{"name":"pod-info","downwardAPI":{"items":[{"path":"skipPreStopChecks","fieldRef":{"apiVersion":"v1","fieldPath":"metadata.labels['skipPreStopChecks']"}}],"defaultMode":420}}],"initContainers":[{"name":"setup-container","image":"rabbitmq:3.8.12-management","command":["sh","-c","cp /tmp/erlang-cookie-secret/.erlang.cookie /var/lib/rabbitmq/.erlang.cookie \u0026\u0026 chown 999:999 /var/lib/rabbitmq/.erlang.cookie \u0026\u0026 chmod 600 /var/lib/rabbitmq/.erlang.cookie ; cp /tmp/rabbitmq-plugins/enabled_plugins /operator/enabled_plugins \u0026\u0026 chown 999:999 /operator/enabled_plugins ; chown 999:999 /var/lib/rabbitmq/mnesia/ ; echo '[default]' \u003e /var/lib/rabbitmq/.rabbitmqadmin.conf \u0026\u0026 sed -e 's/default_user/username/' -e 's/default_pass/password/' /tmp/default_user.conf \u003e\u003e /var/lib/rabbitmq/.rabbitmqadmin.conf \u0026\u0026 chown 999:999 /var/lib/rabbitmq/.rabbitmqadmin.conf \u0026\u0026 chmod 600 /var/lib/rabbitmq/.rabbitmqadmin.conf"],"resources":{"limits":{"cpu":"100m","memory":"500Mi"},"requests":{"cpu":"100m","memory":"500Mi"}},"volumeMounts":[{"name":"plugins-conf","mountPath":"/tmp/rabbitmq-plugins/"},{"name":"rabbitmq-erlang-cookie","mountPath":"/var/lib/rabbitmq/"},{"name":"erlang-cookie-secret","mountPath":"/tmp/erlang-cookie-secret/"},{"name":"rabbitmq-plugins","mountPath":"/operator"},{"name":"persistence","mountPath":"/var/lib/rabbitmq/mnesia/"},{"name":"rabbitmq-confd","mountPath":"/tmp/default_user.conf","subPath":"default_user.conf"}],"terminationMessagePath":"/dev/termination-log","terminationMessagePolicy":"File","imagePullPolicy":"IfNotPresent","securityContext":{"capabilities":{"drop":["FSETID","KILL","SETGID","SETUID","SETPCAP","NET_BIND_SERVICE","NET_RAW","SYS_CHROOT","MKNOD","AUDIT_WRITE","SETFCAP"]},"runAsUser":0}}],"containers":[{"name":"rabbitmq","image":"rabbitmq:3.8.12-management","ports":[{"name":"epmd","containerPort":4369,"protocol":"TCP"},{"name":"amqp","containerPort":5672,"protocol":"TCP"},{"name":"management","containerPort":15672,"protocol":"TCP"},{"name":"prometheus","containerPort":15692,"protocol":"TCP"}],"env":[{"name":"MY_POD_NAME","valueFrom":{"fieldRef":{"apiVersion":"v1","fieldPath":"metadata.name"}}},{"name":"MY_POD_NAMESPACE","valueFrom":{"fieldRef":{"apiVersion":"v1","fieldPath":"metadata.namespace"}}},{"name":"RABBITMQ_ENABLED_PLUGINS_FILE","value":"/operator/enabled_plugins"},{"name":"K8S_SERVICE_NAME","value":"rabbitmq-cluster-nodes"},{"name":"RABBITMQ_USE_LONGNAME","value":"true"},{"name":"RABBITMQ_NODENAME","value":"rabbit@$(MY_POD_NAME).$(K8S_SERVICE_NAME).$(MY_POD_NAMESPACE)"},{"name":"K8S_HOSTNAME_SUFFIX","value":".$(K8S_SERVICE_NAME).$(MY_POD_NAMESPACE)"}],"resources":{"limits":{"cpu":"2","memory":"2Gi"},"requests":{"cpu":"1","memory":"2Gi"}},"volumeMounts":[{"name":"rabbitmq-erlang-cookie","mountPath":"/var/lib/rabbitmq/"},{"name":"persistence","mountPath":"/var/lib/rabbitmq/mnesia/"},{"name":"rabbitmq-plugins","mountPath":"/operator"},{"name":"rabbitmq-confd","mountPath":"/etc/rabbitmq/conf.d/10-operatorDefaults.conf","subPath":"operatorDefaults.conf"},{"name":"rabbitmq-confd","mountPath":"/etc/rabbitmq/conf.d/11-default_user.conf","subPath":"default_user.conf"},{"name":"rabbitmq-confd","mountPath":"/etc/rabbitmq/conf.d/90-userDefinedConfiguration.conf","subPath":"userDefinedConfiguration.conf"},{"name":"pod-info","mountPath":"/etc/pod-info/"}],"readinessProbe":{"tcpSocket":{"port":"amqp"},"initialDelaySeconds":10,"timeoutSeconds":5,"periodSeconds":10,"successThreshold":1,"failureThreshold":3},"lifecycle":{"preStop":{"exec":{"command":["/bin/bash","-c","if [ ! -z \"$(cat /etc/pod-info/skipPreStopChecks)\" ]; then exit 0; fi; rabbitmq-upgrade await_online_quorum_plus_one -t 604800; rabbitmq-upgrade await_online_synchronized_mirror -t 604800; rabbitmq-upgrade drain -t 604800"]}}},"terminationMessagePath":"/dev/termination-log","terminationMessagePolicy":"File","imagePullPolicy":"IfNotPresent"}],"restartPolicy":"Always","terminationGracePeriodSeconds":604800,"dnsPolicy":"ClusterFirst","serviceAccountName":"rabbitmq-cluster-server","serviceAccount":"rabbitmq-cluster-server","automountServiceAccountToken":true,"securityContext":{"runAsUser":999,"runAsGroup":999,"fsGroup":999},"schedulerName":"default-scheduler","topologySpreadConstraints":[{"maxSkew":1,"topologyKey":"topology.kubernetes.io/zone","whenUnsatisfiable":"ScheduleAnyway","labelSelector":{"matchLabels":{"app.kubernetes.io/name":"rabbitmq-cluster"}}}]}},"volumeClaimTemplates":[{"metadata":{"name":"persistence","namespace":"default","creationTimestamp":null,"labels":{"app.kubernetes.io/component":"rabbitmq","app.kubernetes.io/name":"rabbitmq-cluster","app.kubernetes.io/part-of":"rabbitmq"},"ownerReferences":[{"apiVersion":"rabbitmq.com/v1beta1","kind":"RabbitmqCluster","name":"rabbitmq-cluster","uid":"18d9928b-0d1c-47be-80ec-20960d053827","controller":true,"blockOwnerDeletion":false}]},"spec":{"accessModes":["ReadWriteOnce"],"resources":{"requests":{"storage":"10Gi"}},"volumeMode":"Filesystem"},"status":{"phase":"Pending"}}],"serviceName":"rabbitmq-cluster-nodes","podManagementPolicy":"Parallel","updateStrategy":{"type":"RollingUpdate","rollingUpdate":{"partition":0}},"revisionHistoryLimit":10},"status":{"observedGeneration":1,"replicas":1,"readyReplicas":1,"currentReplicas":1,"updatedReplicas":1,"currentRevision":"rabbitmq-cluster-server-5f8b8665fb","updateRevision":"rabbitmq-cluster-server-5f8b8665fb","collisionCount":0}}
2022/03/18 18:01:17 learn_server.go:289: [SIEVE-AFTER-HEAR]	18
2022/03/18 18:01:17 learn_server.go:238: [SIEVE-BEFORE-RECONCILE]	github.com/rabbitmq/cluster-operator/controllers.(*RabbitmqClusterReconciler)	5
2022/03/18 18:01:17 learn_server.go:291: [SIEVE-AFTER-READ]	Get	true	rabbitmqcluster	default	rabbitmq-cluster	github.com/rabbitmq/cluster-operator/controllers.(*RabbitmqClusterReconciler)	NoError	{"kind":"RabbitmqCluster","apiVersion":"rabbitmq.com/v1beta1","metadata":{"name":"rabbitmq-cluster","namespace":"default","selfLink":"/apis/rabbitmq.com/v1beta1/namespaces/default/rabbitmqclusters/rabbitmq-cluster","uid":"18d9928b-0d1c-47be-80ec-20960d053827","resourceVersion":"746","generation":2,"creationTimestamp":"2022-03-18T18:00:38Z","annotations":{"kubectl.kubernetes.io/last-applied-configuration":"{\"apiVersion\":\"rabbitmq.com/v1beta1\",\"kind\":\"RabbitmqCluster\",\"metadata\":{\"annotations\":{},\"name\":\"rabbitmq-cluster\",\"namespace\":\"default\"},\"spec\":{\"persistence\":{\"storage\":\"10Gi\"},\"replicas\":1}}\n"},"finalizers":["deletion.finalizers.rabbitmqclusters.rabbitmq.com"],"managedFields":[{"manager":"kubectl-client-side-apply","operation":"Update","apiVersion":"rabbitmq.com/v1beta1","time":"2022-03-18T18:00:38Z","fieldsType":"FieldsV1","fieldsV1":{"f:metadata":{"f:annotations":{".":{},"f:kubectl.kubernetes.io/last-applied-configuration":{}}},"f:spec":{".":{},"f:image":{},"f:persistence":{".":{},"f:storage":{}},"f:replicas":{},"f:resources":{".":{},"f:limits":{".":{},"f:memory":{}},"f:requests":{".":{},"f:memory":{}}},"f:service":{".":{},"f:type":{}},"f:terminationGracePeriodSeconds":{}}}},{"manager":"manager","operation":"Update","apiVersion":"rabbitmq.com/v1beta1","time":"2022-03-18T18:00:38Z","fieldsType":"FieldsV1","fieldsV1":{"f:metadata":{"f:finalizers":{}},"f:spec":{"f:override":{},"f:rabbitmq":{},"f:resources":{"f:limits":{"f:cpu":{}},"f:requests":{"f:cpu":{}}},"f:tls":{}},"f:status":{".":{},"f:conditions":{},"f:defaultUser":{".":{},"f:secretReference":{".":{},"f:keys":{".":{},"f:password":{},"f:username":{}},"f:name":{},"f:namespace":{}},"f:serviceReference":{".":{},"f:name":{},"f:namespace":{}}}}}}]},"spec":{"replicas":1,"image":"rabbitmq:3.8.12-management","service":{"type":"ClusterIP"},"persistence":{"storage":"10Gi"},"resources":{"limits":{"cpu":"2","memory":"2Gi"},"requests":{"cpu":"1","memory":"2Gi"}},"rabbitmq":{},"tls":{},"override":{},"terminationGracePeriodSeconds":604800},"status":{"conditions":[{"type":"AllReplicasReady","status":"False","lastTransitionTime":"2022-03-18T18:00:38Z","reason":"NotAllPodsReady","message":"0/1 Pods ready"},{"type":"ClusterAvailable","status":"False","lastTransitionTime":"2022-03-18T18:00:38Z","reason":"NoEndpointsAvailable","message":"The service has no endpoints available"},{"type":"NoWarnings","status":"True","lastTransitionTime":"2022-03-18T18:00:38Z","reason":"NoWarnings"},{"type":"ReconcileSuccess","status":"Unknown","lastTransitionTime":"2022-03-18T18:00:38Z","reason":"Initialising"}],"defaultUser":{"secretReference":{"name":"rabbitmq-cluster-default-user","namespace":"default","keys":{"password":"password","username":"username"}},"serviceReference":{"name":"rabbitmq-cluster","namespace":"default"}}}}
2022/03/18 18:01:17 learn_server.go:291: [SIEVE-AFTER-READ]	Get	true	statefulset	default	rabbitmq-cluster-server	github.com/rabbitmq/cluster-operator/controllers.(*RabbitmqClusterReconciler)	NoError	{"kind":"StatefulSet","apiVersion":"apps/v1","metadata":{"name":"rabbitmq-cluster-server","namespace":"default","selfLink":"/apis/apps/v1/namespaces/default/statefulsets/rabbitmq-cluster-server","uid":"cb5c43bc-6ee7-481c-ab01-6f3acffdd3c8","resourceVersion":"943","generation":1,"creationTimestamp":"2022-03-18T18:00:38Z","labels":{"app.kubernetes.io/component":"rabbitmq","app.kubernetes.io/name":"rabbitmq-cluster","app.kubernetes.io/part-of":"rabbitmq"},"annotations":{"rabbitmq.com/createdAt":"2022-03-18T18:00:38Z"},"ownerReferences":[{"apiVersion":"rabbitmq.com/v1beta1","kind":"RabbitmqCluster","name":"rabbitmq-cluster","uid":"18d9928b-0d1c-47be-80ec-20960d053827","controller":true,"blockOwnerDeletion":true}],"managedFields":[{"manager":"manager","operation":"Update","apiVersion":"apps/v1","time":"2022-03-18T18:00:38Z","fieldsType":"FieldsV1","fieldsV1":{"f:metadata":{"f:annotations":{".":{},"f:rabbitmq.com/createdAt":{}},"f:labels":{".":{},"f:app.kubernetes.io/component":{},"f:app.kubernetes.io/name":{},"f:app.kubernetes.io/part-of":{}},"f:ownerReferences":{".":{},"k:{\"uid\":\"18d9928b-0d1c-47be-80ec-20960d053827\"}":{".":{},"f:apiVersion":{},"f:blockOwnerDeletion":{},"f:controller":{},"f:kind":{},"f:name":{},"f:uid":{}}}},"f:spec":{"f:podManagementPolicy":{},"f:replicas":{},"f:revisionHistoryLimit":{},"f:selector":{"f:matchLabels":{".":{},"f:app.kubernetes.io/name":{}}},"f:serviceName":{},"f:template":{"f:metadata":{"f:annotations":{".":{},"f:prometheus.io/port":{},"f:prometheus.io/scrape":{}},"f:labels":{".":{},"f:app.kubernetes.io/component":{},"f:app.kubernetes.io/name":{},"f:app.kubernetes.io/part-of":{}}},"f:spec":{"f:automountServiceAccountToken":{},"f:containers":{"k:{\"name\":\"rabbitmq\"}":{".":{},"f:env":{".":{},"k:{\"name\":\"K8S_HOSTNAME_SUFFIX\"}":{".":{},"f:name":{},"f:value":{}},"k:{\"name\":\"K8S_SERVICE_NAME\"}":{".":{},"f:name":{},"f:value":{}},"k:{\"name\":\"MY_POD_NAME\"}":{".":{},"f:name":{},"f:valueFrom":{".":{},"f:fieldRef":{".":{},"f:apiVersion":{},"f:fieldPath":{}}}},"k:{\"name\":\"MY_POD_NAMESPACE\"}":{".":{},"f:name":{},"f:valueFrom":{".":{},"f:fieldRef":{".":{},"f:apiVersion":{},"f:fieldPath":{}}}},"k:{\"name\":\"RABBITMQ_ENABLED_PLUGINS_FILE\"}":{".":{},"f:name":{},"f:value":{}},"k:{\"name\":\"RABBITMQ_NODENAME\"}":{".":{},"f:name":{},"f:value":{}},"k:{\"name\":\"RABBITMQ_USE_LONGNAME\"}":{".":{},"f:name":{},"f:value":{}}},"f:image":{},"f:imagePullPolicy":{},"f:lifecycle":{".":{},"f:preStop":{".":{},"f:exec":{".":{},"f:command":{}}}},"f:name":{},"f:ports":{".":{},"k:{\"containerPort\":4369,\"protocol\":\"TCP\"}":{".":{},"f:containerPort":{},"f:name":{},"f:protocol":{}},"k:{\"containerPort\":5672,\"protocol\":\"TCP\"}":{".":{},"f:containerPort":{},"f:name":{},"f:protocol":{}},"k:{\"containerPort\":15672,\"protocol\":\"TCP\"}":{".":{},"f:containerPort":{},"f:name":{},"f:protocol":{}},"k:{\"containerPort\":15692,\"protocol\":\"TCP\"}":{".":{},"f:containerPort":{},"f:name":{},"f:protocol":{}}},"f:readinessProbe":{".":{},"f:failureThreshold":{},"f:initialDelaySeconds":{},"f:periodSeconds":{},"f:successThreshold":{},"f:tcpSocket":{".":{},"f:port":{}},"f:timeoutSeconds":{}},"f:resources":{".":{},"f:limits":{".":{},"f:cpu":{},"f:memory":{}},"f:requests":{".":{},"f:cpu":{},"f:memory":{}}},"f:terminationMessagePath":{},"f:terminationMessagePolicy":{},"f:volumeMounts":{".":{},"k:{\"mountPath\":\"/etc/pod-info/\"}":{".":{},"f:mountPath":{},"f:name":{}},"k:{\"mountPath\":\"/etc/rabbitmq/conf.d/10-operatorDefaults.conf\"}":{".":{},"f:mountPath":{},"f:name":{},"f:subPath":{}},"k:{\"mountPath\":\"/etc/rabbitmq/conf.d/11-default_user.conf\"}":{".":{},"f:mountPath":{},"f:name":{},"f:subPath":{}},"k:{\"mountPath\":\"/etc/rabbitmq/conf.d/90-userDefinedConfiguration.conf\"}":{".":{},"f:mountPath":{},"f:name":{},"f:subPath":{}},"k:{\"mountPath\":\"/operator\"}":{".":{},"f:mountPath":{},"f:name":{}},"k:{\"mountPath\":\"/var/lib/rabbitmq/\"}":{".":{},"f:mountPath":{},"f:name":{}},"k:{\"mountPath\":\"/var/lib/rabbitmq/mnesia/\"}":{".":{},"f:mountPath":{},"f:name":{}}}}},"f:dnsPolicy":{},"f:initContainers":{".":{},"k:{\"name\":\"setup-container\"}":{".":{},"f:command":{},"f:image":{},"f:imagePullPolicy":{},"f:name":{},"f:resources":{".":{},"f:limits":{".":{},"f:cpu":{},"f:memory":{}},"f:requests":{".":{},"f:cpu":{},"f:memory":{}}},"f:securityContext":{".":{},"f:capabilities":{".":{},"f:drop":{}},"f:runAsUser":{}},"f:terminationMessagePath":{},"f:terminationMessagePolicy":{},"f:volumeMounts":{".":{},"k:{\"mountPath\":\"/operator\"}":{".":{},"f:mountPath":{},"f:name":{}},"k:{\"mountPath\":\"/tmp/default_user.conf\"}":{".":{},"f:mountPath":{},"f:name":{},"f:subPath":{}},"k:{\"mountPath\":\"/tmp/erlang-cookie-secret/\"}":{".":{},"f:mountPath":{},"f:name":{}},"k:{\"mountPath\":\"/tmp/rabbitmq-plugins/\"}":{".":{},"f:mountPath":{},"f:name":{}},"k:{\"mountPath\":\"/var/lib/rabbitmq/\"}":{".":{},"f:mountPath":{},"f:name":{}},"k:{\"mountPath\":\"/var/lib/rabbitmq/mnesia/\"}":{".":{},"f:mountPath":{},"f:name":{}}}}},"f:restartPolicy":{},"f:schedulerName":{},"f:securityContext":{".":{},"f:fsGroup":{},"f:runAsGroup":{},"f:runAsUser":{}},"f:serviceAccount":{},"f:serviceAccountName":{},"f:terminationGracePeriodSeconds":{},"f:topologySpreadConstraints":{".":{},"k:{\"topologyKey\":\"topology.kubernetes.io/zone\",\"whenUnsatisfiable\":\"ScheduleAnyway\"}":{".":{},"f:labelSelector":{".":{},"f:matchLabels":{".":{},"f:app.kubernetes.io/name":{}}},"f:maxSkew":{},"f:topologyKey":{},"f:whenUnsatisfiable":{}}},"f:volumes":{".":{},"k:{\"name\":\"erlang-cookie-secret\"}":{".":{},"f:name":{},"f:secret":{".":{},"f:defaultMode":{},"f:secretName":{}}},"k:{\"name\":\"plugins-conf\"}":{".":{},"f:configMap":{".":{},"f:defaultMode":{},"f:name":{}},"f:name":{}},"k:{\"name\":\"pod-info\"}":{".":{},"f:downwardAPI":{".":{},"f:defaultMode":{},"f:items":{}},"f:name":{}},"k:{\"name\":\"rabbitmq-confd\"}":{".":{},"f:name":{},"f:projected":{".":{},"f:defaultMode":{},"f:sources":{}}},"k:{\"name\":\"rabbitmq-erlang-cookie\"}":{".":{},"f:emptyDir":{},"f:name":{}},"k:{\"name\":\"rabbitmq-plugins\"}":{".":{},"f:emptyDir":{},"f:name":{}}}}},"f:updateStrategy":{"f:rollingUpdate":{".":{},"f:partition":{}},"f:type":{}},"f:volumeClaimTemplates":{}}}},{"manager":"kube-controller-manager","operation":"Update","apiVersion":"apps/v1","time":"2022-03-18T18:01:17Z","fieldsType":"FieldsV1","fieldsV1":{"f:status":{"f:collisionCount":{},"f:currentReplicas":{},"f:currentRevision":{},"f:observedGeneration":{},"f:readyReplicas":{},"f:replicas":{},"f:updateRevision":{},"f:updatedReplicas":{}}}}]},"spec":{"replicas":1,"selector":{"matchLabels":{"app.kubernetes.io/name":"rabbitmq-cluster"}},"template":{"metadata":{"creationTimestamp":null,"labels":{"app.kubernetes.io/component":"rabbitmq","app.kubernetes.io/name":"rabbitmq-cluster","app.kubernetes.io/part-of":"rabbitmq"},"annotations":{"prometheus.io/port":"15692","prometheus.io/scrape":"true"}},"spec":{"volumes":[{"name":"plugins-conf","configMap":{"name":"rabbitmq-cluster-plugins-conf","defaultMode":420}},{"name":"rabbitmq-confd","projected":{"sources":[{"secret":{"name":"rabbitmq-cluster-default-user","items":[{"key":"default_user.conf","path":"default_user.conf"}]}},{"configMap":{"name":"rabbitmq-cluster-server-conf","items":[{"key":"operatorDefaults.conf","path":"operatorDefaults.conf"},{"key":"userDefinedConfiguration.conf","path":"userDefinedConfiguration.conf"}]}}],"defaultMode":420}},{"name":"rabbitmq-erlang-cookie","emptyDir":{}},{"name":"erlang-cookie-secret","secret":{"secretName":"rabbitmq-cluster-erlang-cookie","defaultMode":420}},{"name":"rabbitmq-plugins","emptyDir":{}},{"name":"pod-info","downwardAPI":{"items":[{"path":"skipPreStopChecks","fieldRef":{"apiVersion":"v1","fieldPath":"metadata.labels['skipPreStopChecks']"}}],"defaultMode":420}}],"initContainers":[{"name":"setup-container","image":"rabbitmq:3.8.12-management","command":["sh","-c","cp /tmp/erlang-cookie-secret/.erlang.cookie /var/lib/rabbitmq/.erlang.cookie \u0026\u0026 chown 999:999 /var/lib/rabbitmq/.erlang.cookie \u0026\u0026 chmod 600 /var/lib/rabbitmq/.erlang.cookie ; cp /tmp/rabbitmq-plugins/enabled_plugins /operator/enabled_plugins \u0026\u0026 chown 999:999 /operator/enabled_plugins ; chown 999:999 /var/lib/rabbitmq/mnesia/ ; echo '[default]' \u003e /var/lib/rabbitmq/.rabbitmqadmin.conf \u0026\u0026 sed -e 's/default_user/username/' -e 's/default_pass/password/' /tmp/default_user.conf \u003e\u003e /var/lib/rabbitmq/.rabbitmqadmin.conf \u0026\u0026 chown 999:999 /var/lib/rabbitmq/.rabbitmqadmin.conf \u0026\u0026 chmod 600 /var/lib/rabbitmq/.rabbitmqadmin.conf"],"resources":{"limits":{"cpu":"100m","memory":"500Mi"},"requests":{"cpu":"100m","memory":"500Mi"}},"volumeMounts":[{"name":"plugins-conf","mountPath":"/tmp/rabbitmq-plugins/"},{"name":"rabbitmq-erlang-cookie","mountPath":"/var/lib/rabbitmq/"},{"name":"erlang-cookie-secret","mountPath":"/tmp/erlang-cookie-secret/"},{"name":"rabbitmq-plugins","mountPath":"/operator"},{"name":"persistence","mountPath":"/var/lib/rabbitmq/mnesia/"},{"name":"rabbitmq-confd","mountPath":"/tmp/default_user.conf","subPath":"default_user.conf"}],"terminationMessagePath":"/dev/termination-log","terminationMessagePolicy":"File","imagePullPolicy":"IfNotPresent","securityContext":{"capabilities":{"drop":["FSETID","KILL","SETGID","SETUID","SETPCAP","NET_BIND_SERVICE","NET_RAW","SYS_CHROOT","MKNOD","AUDIT_WRITE","SETFCAP"]},"runAsUser":0}}],"containers":[{"name":"rabbitmq","image":"rabbitmq:3.8.12-management","ports":[{"name":"epmd","containerPort":4369,"protocol":"TCP"},{"name":"amqp","containerPort":5672,"protocol":"TCP"},{"name":"management","containerPort":15672,"protocol":"TCP"},{"name":"prometheus","containerPort":15692,"protocol":"TCP"}],"env":[{"name":"MY_POD_NAME","valueFrom":{"fieldRef":{"apiVersion":"v1","fieldPath":"metadata.name"}}},{"name":"MY_POD_NAMESPACE","valueFrom":{"fieldRef":{"apiVersion":"v1","fieldPath":"metadata.namespace"}}},{"name":"RABBITMQ_ENABLED_PLUGINS_FILE","value":"/operator/enabled_plugins"},{"name":"K8S_SERVICE_NAME","value":"rabbitmq-cluster-nodes"},{"name":"RABBITMQ_USE_LONGNAME","value":"true"},{"name":"RABBITMQ_NODENAME","value":"rabbit@$(MY_POD_NAME).$(K8S_SERVICE_NAME).$(MY_POD_NAMESPACE)"},{"name":"K8S_HOSTNAME_SUFFIX","value":".$(K8S_SERVICE_NAME).$(MY_POD_NAMESPACE)"}],"resources":{"limits":{"cpu":"2","memory":"2Gi"},"requests":{"cpu":"1","memory":"2Gi"}},"volumeMounts":[{"name":"rabbitmq-erlang-cookie","mountPath":"/var/lib/rabbitmq/"},{"name":"persistence","mountPath":"/var/lib/rabbitmq/mnesia/"},{"name":"rabbitmq-plugins","mountPath":"/operator"},{"name":"rabbitmq-confd","mountPath":"/etc/rabbitmq/conf.d/10-operatorDefaults.conf","subPath":"operatorDefaults.conf"},{"name":"rabbitmq-confd","mountPath":"/etc/rabbitmq/conf.d/11-default_user.conf","subPath":"default_user.conf"},{"name":"rabbitmq-confd","mountPath":"/etc/rabbitmq/conf.d/90-userDefinedConfiguration.conf","subPath":"userDefinedConfiguration.conf"},{"name":"pod-info","mountPath":"/etc/pod-info/"}],"readinessProbe":{"tcpSocket":{"port":"amqp"},"initialDelaySeconds":10,"timeoutSeconds":5,"periodSeconds":10,"successThreshold":1,"failureThreshold":3},"lifecycle":{"preStop":{"exec":{"command":["/bin/bash","-c","if [ ! -z \"$(cat /etc/pod-info/skipPreStopChecks)\" ]; then exit 0; fi; rabbitmq-upgrade await_online_quorum_plus_one -t 604800; rabbitmq-upgrade await_online_synchronized_mirror -t 604800; rabbitmq-upgrade drain -t 604800"]}}},"terminationMessagePath":"/dev/termination-log","terminationMessagePolicy":"File","imagePullPolicy":"IfNotPresent"}],"restartPolicy":"Always","terminationGracePeriodSeconds":604800,"dnsPolicy":"ClusterFirst","serviceAccountName":"rabbitmq-cluster-server","serviceAccount":"rabbitmq-cluster-server","automountServiceAccountToken":true,"securityContext":{"runAsUser":999,"runAsGroup":999,"fsGroup":999},"schedulerName":"default-scheduler","topologySpreadConstraints":[{"maxSkew":1,"topologyKey":"topology.kubernetes.io/zone","whenUnsatisfiable":"ScheduleAnyway","labelSelector":{"matchLabels":{"app.kubernetes.io/name":"rabbitmq-cluster"}}}]}},"volumeClaimTemplates":[{"metadata":{"name":"persistence","namespace":"default","creationTimestamp":null,"labels":{"app.kubernetes.io/component":"rabbitmq","app.kubernetes.io/name":"rabbitmq-cluster","app.kubernetes.io/part-of":"rabbitmq"},"ownerReferences":[{"apiVersion":"rabbitmq.com/v1beta1","kind":"RabbitmqCluster","name":"rabbitmq-cluster","uid":"18d9928b-0d1c-47be-80ec-20960d053827","controller":true,"blockOwnerDeletion":false}]},"spec":{"accessModes":["ReadWriteOnce"],"resources":{"requests":{"storage":"10Gi"}},"volumeMode":"Filesystem"},"status":{"phase":"Pending"}}],"serviceName":"rabbitmq-cluster-nodes","podManagementPolicy":"Parallel","updateStrategy":{"type":"RollingUpdate","rollingUpdate":{"partition":0}},"revisionHistoryLimit":10},"status":{"observedGeneration":1,"replicas":1,"readyReplicas":1,"currentReplicas":1,"updatedReplicas":1,"currentRevision":"rabbitmq-cluster-server-5f8b8665fb","updateRevision":"rabbitmq-cluster-server-5f8b8665fb","collisionCount":0}}
2022/03/18 18:01:17 learn_server.go:291: [SIEVE-AFTER-READ]	Get	true	endpoints	default	rabbitmq-cluster	github.com/rabbitmq/cluster-operator/controllers.(*RabbitmqClusterReconciler)	NoError	{"kind":"Endpoints","apiVersion":"v1","metadata":{"name":"rabbitmq-cluster","namespace":"default","selfLink":"/api/v1/namespaces/default/endpoints/rabbitmq-cluster","uid":"5c4723ad-f4fe-442d-9135-44879a2a8183","resourceVersion":"939","creationTimestamp":"2022-03-18T18:00:38Z","labels":{"app.kubernetes.io/component":"rabbitmq","app.kubernetes.io/name":"rabbitmq-cluster","app.kubernetes.io/part-of":"rabbitmq"},"annotations":{"endpoints.kubernetes.io/last-change-trigger-time":"2022-03-18T18:01:17Z"},"managedFields":[{"manager":"kube-controller-manager","operation":"Update","apiVersion":"v1","time":"2022-03-18T18:01:17Z","fieldsType":"FieldsV1","fieldsV1":{"f:metadata":{"f:annotations":{".":{},"f:endpoints.kubernetes.io/last-change-trigger-time":{}},"f:labels":{".":{},"f:app.kubernetes.io/component":{},"f:app.kubernetes.io/name":{},"f:app.kubernetes.io/part-of":{}}},"f:subsets":{}}}]},"subsets":[{"addresses":[{"ip":"10.244.1.4","nodeName":"kind-worker2","targetRef":{"kind":"Pod","namespace":"default","name":"rabbitmq-cluster-server-0","uid":"e7faffc5-b656-4e69-9777-92d12cb6ec5a","resourceVersion":"938"}}],"ports":[{"name":"amqp","port":5672,"protocol":"TCP"},{"name":"management","port":15672,"protocol":"TCP"}]}]}
2022/03/18 18:01:17 learn_server.go:256: [SIEVE-BEFORE-WRITE]	25
2022/03/18 18:01:17 learn_server.go:279: [SIEVE-BEFORE-HEAR]	19	Updated	rabbitmqcluster	{"metadata":{"name":"rabbitmq-cluster","namespace":"default","selfLink":"/apis/rabbitmq.com/v1beta1/namespaces/default/rabbitmqclusters/rabbitmq-cluster","uid":"18d9928b-0d1c-47be-80ec-20960d053827","resourceVersion":"944","generation":2,"creationTimestamp":"2022-03-18T18:00:38Z","annotations":{"kubectl.kubernetes.io/last-applied-configuration":"{\"apiVersion\":\"rabbitmq.com/v1beta1\",\"kind\":\"RabbitmqCluster\",\"metadata\":{\"annotations\":{},\"name\":\"rabbitmq-cluster\",\"namespace\":\"default\"},\"spec\":{\"persistence\":{\"storage\":\"10Gi\"},\"replicas\":1}}\n"},"finalizers":["deletion.finalizers.rabbitmqclusters.rabbitmq.com"],"managedFields":[{"manager":"kubectl-client-side-apply","operation":"Update","apiVersion":"rabbitmq.com/v1beta1","time":"2022-03-18T18:00:38Z","fieldsType":"FieldsV1","fieldsV1":{"f:metadata":{"f:annotations":{".":{},"f:kubectl.kubernetes.io/last-applied-configuration":{}}},"f:spec":{".":{},"f:image":{},"f:persistence":{".":{},"f:storage":{}},"f:replicas":{},"f:resources":{".":{},"f:limits":{".":{},"f:memory":{}},"f:requests":{".":{},"f:memory":{}}},"f:service":{".":{},"f:type":{}},"f:terminationGracePeriodSeconds":{}}}},{"manager":"manager","operation":"Update","apiVersion":"rabbitmq.com/v1beta1","time":"2022-03-18T18:01:17Z","fieldsType":"FieldsV1","fieldsV1":{"f:metadata":{"f:finalizers":{}},"f:spec":{"f:override":{},"f:rabbitmq":{},"f:resources":{"f:limits":{"f:cpu":{}},"f:requests":{"f:cpu":{}}},"f:tls":{}},"f:status":{".":{},"f:conditions":{},"f:defaultUser":{".":{},"f:secretReference":{".":{},"f:keys":{".":{},"f:password":{},"f:username":{}},"f:name":{},"f:namespace":{}},"f:serviceReference":{".":{},"f:name":{},"f:namespace":{}}}}}}]},"spec":{"replicas":1,"image":"rabbitmq:3.8.12-management","service":{"type":"ClusterIP"},"persistence":{"storage":"10Gi"},"resources":{"limits":{"cpu":"2","memory":"2Gi"},"requests":{"cpu":"1","memory":"2Gi"}},"rabbitmq":{},"tls":{},"override":{},"terminationGracePeriodSeconds":604800},"status":{"conditions":[{"type":"AllReplicasReady","status":"True","lastTransitionTime":"2022-03-18T18:01:17Z","reason":"AllPodsAreReady"},{"type":"ClusterAvailable","status":"True","lastTransitionTime":"2022-03-18T18:01:17Z","reason":"AtLeastOneEndpointAvailable"},{"type":"NoWarnings","status":"True","lastTransitionTime":"2022-03-18T18:00:38Z","reason":"NoWarnings"},{"type":"ReconcileSuccess","status":"Unknown","lastTransitionTime":"2022-03-18T18:00:38Z","reason":"Initialising"}],"defaultUser":{"secretReference":{"name":"rabbitmq-cluster-default-user","namespace":"default","keys":{"password":"password","username":"username"}},"serviceReference":{"name":"rabbitmq-cluster","namespace":"default"}}}}
2022/03/18 18:01:17 learn_server.go:289: [SIEVE-AFTER-HEAR]	19
2022/03/18 18:01:17 learn_server.go:263: [SIEVE-AFTER-WRITE]	25	StatusUpdate	rabbitmqcluster	github.com/rabbitmq/cluster-operator/controllers.(*RabbitmqClusterReconciler)	NoError	{"metadata":{"name":"rabbitmq-cluster","namespace":"default","selfLink":"/apis/rabbitmq.com/v1beta1/namespaces/default/rabbitmqclusters/rabbitmq-cluster/status","uid":"18d9928b-0d1c-47be-80ec-20960d053827","resourceVersion":"944","generation":2,"creationTimestamp":"2022-03-18T18:00:38Z","annotations":{"kubectl.kubernetes.io/last-applied-configuration":"{\"apiVersion\":\"rabbitmq.com/v1beta1\",\"kind\":\"RabbitmqCluster\",\"metadata\":{\"annotations\":{},\"name\":\"rabbitmq-cluster\",\"namespace\":\"default\"},\"spec\":{\"persistence\":{\"storage\":\"10Gi\"},\"replicas\":1}}\n"},"finalizers":["deletion.finalizers.rabbitmqclusters.rabbitmq.com"],"managedFields":[{"manager":"kubectl-client-side-apply","operation":"Update","apiVersion":"rabbitmq.com/v1beta1","time":"2022-03-18T18:00:38Z","fieldsType":"FieldsV1","fieldsV1":{"f:metadata":{"f:annotations":{".":{},"f:kubectl.kubernetes.io/last-applied-configuration":{}}},"f:spec":{".":{},"f:image":{},"f:persistence":{".":{},"f:storage":{}},"f:replicas":{},"f:resources":{".":{},"f:limits":{".":{},"f:memory":{}},"f:requests":{".":{},"f:memory":{}}},"f:service":{".":{},"f:type":{}},"f:terminationGracePeriodSeconds":{}}}},{"manager":"manager","operation":"Update","apiVersion":"rabbitmq.com/v1beta1","time":"2022-03-18T18:01:17Z","fieldsType":"FieldsV1","fieldsV1":{"f:metadata":{"f:finalizers":{}},"f:spec":{"f:override":{},"f:rabbitmq":{},"f:resources":{"f:limits":{"f:cpu":{}},"f:requests":{"f:cpu":{}}},"f:tls":{}},"f:status":{".":{},"f:conditions":{},"f:defaultUser":{".":{},"f:secretReference":{".":{},"f:keys":{".":{},"f:password":{},"f:username":{}},"f:name":{},"f:namespace":{}},"f:serviceReference":{".":{},"f:name":{},"f:namespace":{}}}}}}]},"spec":{"replicas":1,"image":"rabbitmq:3.8.12-management","service":{"type":"ClusterIP"},"persistence":{"storage":"10Gi"},"resources":{"limits":{"cpu":"2","memory":"2Gi"},"requests":{"cpu":"1","memory":"2Gi"}},"rabbitmq":{},"tls":{},"override":{},"terminationGracePeriodSeconds":604800},"status":{"conditions":[{"type":"AllReplicasReady","status":"True","lastTransitionTime":"2022-03-18T18:01:17Z","reason":"AllPodsAreReady"},{"type":"ClusterAvailable","status":"True","lastTransitionTime":"2022-03-18T18:01:17Z","reason":"AtLeastOneEndpointAvailable"},{"type":"NoWarnings","status":"True","lastTransitionTime":"2022-03-18T18:00:38Z","reason":"NoWarnings"},{"type":"ReconcileSuccess","status":"Unknown","lastTransitionTime":"2022-03-18T18:00:38Z","reason":"Initialising"}],"defaultUser":{"secretReference":{"name":"rabbitmq-cluster-default-user","namespace":"default","keys":{"password":"password","username":"username"}},"serviceReference":{"name":"rabbitmq-cluster","namespace":"default"}}}}
2022/03/18 18:01:17 learn_server.go:291: [SIEVE-AFTER-READ]	Get	true	statefulset	default	rabbitmq-cluster-server	github.com/rabbitmq/cluster-operator/controllers.(*RabbitmqClusterReconciler)	NoError	{"kind":"StatefulSet","apiVersion":"apps/v1","metadata":{"name":"rabbitmq-cluster-server","namespace":"default","selfLink":"/apis/apps/v1/namespaces/default/statefulsets/rabbitmq-cluster-server","uid":"cb5c43bc-6ee7-481c-ab01-6f3acffdd3c8","resourceVersion":"943","generation":1,"creationTimestamp":"2022-03-18T18:00:38Z","labels":{"app.kubernetes.io/component":"rabbitmq","app.kubernetes.io/name":"rabbitmq-cluster","app.kubernetes.io/part-of":"rabbitmq"},"annotations":{"rabbitmq.com/createdAt":"2022-03-18T18:00:38Z"},"ownerReferences":[{"apiVersion":"rabbitmq.com/v1beta1","kind":"RabbitmqCluster","name":"rabbitmq-cluster","uid":"18d9928b-0d1c-47be-80ec-20960d053827","controller":true,"blockOwnerDeletion":true}],"managedFields":[{"manager":"manager","operation":"Update","apiVersion":"apps/v1","time":"2022-03-18T18:00:38Z","fieldsType":"FieldsV1","fieldsV1":{"f:metadata":{"f:annotations":{".":{},"f:rabbitmq.com/createdAt":{}},"f:labels":{".":{},"f:app.kubernetes.io/component":{},"f:app.kubernetes.io/name":{},"f:app.kubernetes.io/part-of":{}},"f:ownerReferences":{".":{},"k:{\"uid\":\"18d9928b-0d1c-47be-80ec-20960d053827\"}":{".":{},"f:apiVersion":{},"f:blockOwnerDeletion":{},"f:controller":{},"f:kind":{},"f:name":{},"f:uid":{}}}},"f:spec":{"f:podManagementPolicy":{},"f:replicas":{},"f:revisionHistoryLimit":{},"f:selector":{"f:matchLabels":{".":{},"f:app.kubernetes.io/name":{}}},"f:serviceName":{},"f:template":{"f:metadata":{"f:annotations":{".":{},"f:prometheus.io/port":{},"f:prometheus.io/scrape":{}},"f:labels":{".":{},"f:app.kubernetes.io/component":{},"f:app.kubernetes.io/name":{},"f:app.kubernetes.io/part-of":{}}},"f:spec":{"f:automountServiceAccountToken":{},"f:containers":{"k:{\"name\":\"rabbitmq\"}":{".":{},"f:env":{".":{},"k:{\"name\":\"K8S_HOSTNAME_SUFFIX\"}":{".":{},"f:name":{},"f:value":{}},"k:{\"name\":\"K8S_SERVICE_NAME\"}":{".":{},"f:name":{},"f:value":{}},"k:{\"name\":\"MY_POD_NAME\"}":{".":{},"f:name":{},"f:valueFrom":{".":{},"f:fieldRef":{".":{},"f:apiVersion":{},"f:fieldPath":{}}}},"k:{\"name\":\"MY_POD_NAMESPACE\"}":{".":{},"f:name":{},"f:valueFrom":{".":{},"f:fieldRef":{".":{},"f:apiVersion":{},"f:fieldPath":{}}}},"k:{\"name\":\"RABBITMQ_ENABLED_PLUGINS_FILE\"}":{".":{},"f:name":{},"f:value":{}},"k:{\"name\":\"RABBITMQ_NODENAME\"}":{".":{},"f:name":{},"f:value":{}},"k:{\"name\":\"RABBITMQ_USE_LONGNAME\"}":{".":{},"f:name":{},"f:value":{}}},"f:image":{},"f:imagePullPolicy":{},"f:lifecycle":{".":{},"f:preStop":{".":{},"f:exec":{".":{},"f:command":{}}}},"f:name":{},"f:ports":{".":{},"k:{\"containerPort\":4369,\"protocol\":\"TCP\"}":{".":{},"f:containerPort":{},"f:name":{},"f:protocol":{}},"k:{\"containerPort\":5672,\"protocol\":\"TCP\"}":{".":{},"f:containerPort":{},"f:name":{},"f:protocol":{}},"k:{\"containerPort\":15672,\"protocol\":\"TCP\"}":{".":{},"f:containerPort":{},"f:name":{},"f:protocol":{}},"k:{\"containerPort\":15692,\"protocol\":\"TCP\"}":{".":{},"f:containerPort":{},"f:name":{},"f:protocol":{}}},"f:readinessProbe":{".":{},"f:failureThreshold":{},"f:initialDelaySeconds":{},"f:periodSeconds":{},"f:successThreshold":{},"f:tcpSocket":{".":{},"f:port":{}},"f:timeoutSeconds":{}},"f:resources":{".":{},"f:limits":{".":{},"f:cpu":{},"f:memory":{}},"f:requests":{".":{},"f:cpu":{},"f:memory":{}}},"f:terminationMessagePath":{},"f:terminationMessagePolicy":{},"f:volumeMounts":{".":{},"k:{\"mountPath\":\"/etc/pod-info/\"}":{".":{},"f:mountPath":{},"f:name":{}},"k:{\"mountPath\":\"/etc/rabbitmq/conf.d/10-operatorDefaults.conf\"}":{".":{},"f:mountPath":{},"f:name":{},"f:subPath":{}},"k:{\"mountPath\":\"/etc/rabbitmq/conf.d/11-default_user.conf\"}":{".":{},"f:mountPath":{},"f:name":{},"f:subPath":{}},"k:{\"mountPath\":\"/etc/rabbitmq/conf.d/90-userDefinedConfiguration.conf\"}":{".":{},"f:mountPath":{},"f:name":{},"f:subPath":{}},"k:{\"mountPath\":\"/operator\"}":{".":{},"f:mountPath":{},"f:name":{}},"k:{\"mountPath\":\"/var/lib/rabbitmq/\"}":{".":{},"f:mountPath":{},"f:name":{}},"k:{\"mountPath\":\"/var/lib/rabbitmq/mnesia/\"}":{".":{},"f:mountPath":{},"f:name":{}}}}},"f:dnsPolicy":{},"f:initContainers":{".":{},"k:{\"name\":\"setup-container\"}":{".":{},"f:command":{},"f:image":{},"f:imagePullPolicy":{},"f:name":{},"f:resources":{".":{},"f:limits":{".":{},"f:cpu":{},"f:memory":{}},"f:requests":{".":{},"f:cpu":{},"f:memory":{}}},"f:securityContext":{".":{},"f:capabilities":{".":{},"f:drop":{}},"f:runAsUser":{}},"f:terminationMessagePath":{},"f:terminationMessagePolicy":{},"f:volumeMounts":{".":{},"k:{\"mountPath\":\"/operator\"}":{".":{},"f:mountPath":{},"f:name":{}},"k:{\"mountPath\":\"/tmp/default_user.conf\"}":{".":{},"f:mountPath":{},"f:name":{},"f:subPath":{}},"k:{\"mountPath\":\"/tmp/erlang-cookie-secret/\"}":{".":{},"f:mountPath":{},"f:name":{}},"k:{\"mountPath\":\"/tmp/rabbitmq-plugins/\"}":{".":{},"f:mountPath":{},"f:name":{}},"k:{\"mountPath\":\"/var/lib/rabbitmq/\"}":{".":{},"f:mountPath":{},"f:name":{}},"k:{\"mountPath\":\"/var/lib/rabbitmq/mnesia/\"}":{".":{},"f:mountPath":{},"f:name":{}}}}},"f:restartPolicy":{},"f:schedulerName":{},"f:securityContext":{".":{},"f:fsGroup":{},"f:runAsGroup":{},"f:runAsUser":{}},"f:serviceAccount":{},"f:serviceAccountName":{},"f:terminationGracePeriodSeconds":{},"f:topologySpreadConstraints":{".":{},"k:{\"topologyKey\":\"topology.kubernetes.io/zone\",\"whenUnsatisfiable\":\"ScheduleAnyway\"}":{".":{},"f:labelSelector":{".":{},"f:matchLabels":{".":{},"f:app.kubernetes.io/name":{}}},"f:maxSkew":{},"f:topologyKey":{},"f:whenUnsatisfiable":{}}},"f:volumes":{".":{},"k:{\"name\":\"erlang-cookie-secret\"}":{".":{},"f:name":{},"f:secret":{".":{},"f:defaultMode":{},"f:secretName":{}}},"k:{\"name\":\"plugins-conf\"}":{".":{},"f:configMap":{".":{},"f:defaultMode":{},"f:name":{}},"f:name":{}},"k:{\"name\":\"pod-info\"}":{".":{},"f:downwardAPI":{".":{},"f:defaultMode":{},"f:items":{}},"f:name":{}},"k:{\"name\":\"rabbitmq-confd\"}":{".":{},"f:name":{},"f:projected":{".":{},"f:defaultMode":{},"f:sources":{}}},"k:{\"name\":\"rabbitmq-erlang-cookie\"}":{".":{},"f:emptyDir":{},"f:name":{}},"k:{\"name\":\"rabbitmq-plugins\"}":{".":{},"f:emptyDir":{},"f:name":{}}}}},"f:updateStrategy":{"f:rollingUpdate":{".":{},"f:partition":{}},"f:type":{}},"f:volumeClaimTemplates":{}}}},{"manager":"kube-controller-manager","operation":"Update","apiVersion":"apps/v1","time":"2022-03-18T18:01:17Z","fieldsType":"FieldsV1","fieldsV1":{"f:status":{"f:collisionCount":{},"f:currentReplicas":{},"f:currentRevision":{},"f:observedGeneration":{},"f:readyReplicas":{},"f:replicas":{},"f:updateRevision":{},"f:updatedReplicas":{}}}}]},"spec":{"replicas":1,"selector":{"matchLabels":{"app.kubernetes.io/name":"rabbitmq-cluster"}},"template":{"metadata":{"creationTimestamp":null,"labels":{"app.kubernetes.io/component":"rabbitmq","app.kubernetes.io/name":"rabbitmq-cluster","app.kubernetes.io/part-of":"rabbitmq"},"annotations":{"prometheus.io/port":"15692","prometheus.io/scrape":"true"}},"spec":{"volumes":[{"name":"plugins-conf","configMap":{"name":"rabbitmq-cluster-plugins-conf","defaultMode":420}},{"name":"rabbitmq-confd","projected":{"sources":[{"secret":{"name":"rabbitmq-cluster-default-user","items":[{"key":"default_user.conf","path":"default_user.conf"}]}},{"configMap":{"name":"rabbitmq-cluster-server-conf","items":[{"key":"operatorDefaults.conf","path":"operatorDefaults.conf"},{"key":"userDefinedConfiguration.conf","path":"userDefinedConfiguration.conf"}]}}],"defaultMode":420}},{"name":"rabbitmq-erlang-cookie","emptyDir":{}},{"name":"erlang-cookie-secret","secret":{"secretName":"rabbitmq-cluster-erlang-cookie","defaultMode":420}},{"name":"rabbitmq-plugins","emptyDir":{}},{"name":"pod-info","downwardAPI":{"items":[{"path":"skipPreStopChecks","fieldRef":{"apiVersion":"v1","fieldPath":"metadata.labels['skipPreStopChecks']"}}],"defaultMode":420}}],"initContainers":[{"name":"setup-container","image":"rabbitmq:3.8.12-management","command":["sh","-c","cp /tmp/erlang-cookie-secret/.erlang.cookie /var/lib/rabbitmq/.erlang.cookie \u0026\u0026 chown 999:999 /var/lib/rabbitmq/.erlang.cookie \u0026\u0026 chmod 600 /var/lib/rabbitmq/.erlang.cookie ; cp /tmp/rabbitmq-plugins/enabled_plugins /operator/enabled_plugins \u0026\u0026 chown 999:999 /operator/enabled_plugins ; chown 999:999 /var/lib/rabbitmq/mnesia/ ; echo '[default]' \u003e /var/lib/rabbitmq/.rabbitmqadmin.conf \u0026\u0026 sed -e 's/default_user/username/' -e 's/default_pass/password/' /tmp/default_user.conf \u003e\u003e /var/lib/rabbitmq/.rabbitmqadmin.conf \u0026\u0026 chown 999:999 /var/lib/rabbitmq/.rabbitmqadmin.conf \u0026\u0026 chmod 600 /var/lib/rabbitmq/.rabbitmqadmin.conf"],"resources":{"limits":{"cpu":"100m","memory":"500Mi"},"requests":{"cpu":"100m","memory":"500Mi"}},"volumeMounts":[{"name":"plugins-conf","mountPath":"/tmp/rabbitmq-plugins/"},{"name":"rabbitmq-erlang-cookie","mountPath":"/var/lib/rabbitmq/"},{"name":"erlang-cookie-secret","mountPath":"/tmp/erlang-cookie-secret/"},{"name":"rabbitmq-plugins","mountPath":"/operator"},{"name":"persistence","mountPath":"/var/lib/rabbitmq/mnesia/"},{"name":"rabbitmq-confd","mountPath":"/tmp/default_user.conf","subPath":"default_user.conf"}],"terminationMessagePath":"/dev/termination-log","terminationMessagePolicy":"File","imagePullPolicy":"IfNotPresent","securityContext":{"capabilities":{"drop":["FSETID","KILL","SETGID","SETUID","SETPCAP","NET_BIND_SERVICE","NET_RAW","SYS_CHROOT","MKNOD","AUDIT_WRITE","SETFCAP"]},"runAsUser":0}}],"containers":[{"name":"rabbitmq","image":"rabbitmq:3.8.12-management","ports":[{"name":"epmd","containerPort":4369,"protocol":"TCP"},{"name":"amqp","containerPort":5672,"protocol":"TCP"},{"name":"management","containerPort":15672,"protocol":"TCP"},{"name":"prometheus","containerPort":15692,"protocol":"TCP"}],"env":[{"name":"MY_POD_NAME","valueFrom":{"fieldRef":{"apiVersion":"v1","fieldPath":"metadata.name"}}},{"name":"MY_POD_NAMESPACE","valueFrom":{"fieldRef":{"apiVersion":"v1","fieldPath":"metadata.namespace"}}},{"name":"RABBITMQ_ENABLED_PLUGINS_FILE","value":"/operator/enabled_plugins"},{"name":"K8S_SERVICE_NAME","value":"rabbitmq-cluster-nodes"},{"name":"RABBITMQ_USE_LONGNAME","value":"true"},{"name":"RABBITMQ_NODENAME","value":"rabbit@$(MY_POD_NAME).$(K8S_SERVICE_NAME).$(MY_POD_NAMESPACE)"},{"name":"K8S_HOSTNAME_SUFFIX","value":".$(K8S_SERVICE_NAME).$(MY_POD_NAMESPACE)"}],"resources":{"limits":{"cpu":"2","memory":"2Gi"},"requests":{"cpu":"1","memory":"2Gi"}},"volumeMounts":[{"name":"rabbitmq-erlang-cookie","mountPath":"/var/lib/rabbitmq/"},{"name":"persistence","mountPath":"/var/lib/rabbitmq/mnesia/"},{"name":"rabbitmq-plugins","mountPath":"/operator"},{"name":"rabbitmq-confd","mountPath":"/etc/rabbitmq/conf.d/10-operatorDefaults.conf","subPath":"operatorDefaults.conf"},{"name":"rabbitmq-confd","mountPath":"/etc/rabbitmq/conf.d/11-default_user.conf","subPath":"default_user.conf"},{"name":"rabbitmq-confd","mountPath":"/etc/rabbitmq/conf.d/90-userDefinedConfiguration.conf","subPath":"userDefinedConfiguration.conf"},{"name":"pod-info","mountPath":"/etc/pod-info/"}],"readinessProbe":{"tcpSocket":{"port":"amqp"},"initialDelaySeconds":10,"timeoutSeconds":5,"periodSeconds":10,"successThreshold":1,"failureThreshold":3},"lifecycle":{"preStop":{"exec":{"command":["/bin/bash","-c","if [ ! -z \"$(cat /etc/pod-info/skipPreStopChecks)\" ]; then exit 0; fi; rabbitmq-upgrade await_online_quorum_plus_one -t 604800; rabbitmq-upgrade await_online_synchronized_mirror -t 604800; rabbitmq-upgrade drain -t 604800"]}}},"terminationMessagePath":"/dev/termination-log","terminationMessagePolicy":"File","imagePullPolicy":"IfNotPresent"}],"restartPolicy":"Always","terminationGracePeriodSeconds":604800,"dnsPolicy":"ClusterFirst","serviceAccountName":"rabbitmq-cluster-server","serviceAccount":"rabbitmq-cluster-server","automountServiceAccountToken":true,"securityContext":{"runAsUser":999,"runAsGroup":999,"fsGroup":999},"schedulerName":"default-scheduler","topologySpreadConstraints":[{"maxSkew":1,"topologyKey":"topology.kubernetes.io/zone","whenUnsatisfiable":"ScheduleAnyway","labelSelector":{"matchLabels":{"app.kubernetes.io/name":"rabbitmq-cluster"}}}]}},"volumeClaimTemplates":[{"metadata":{"name":"persistence","namespace":"default","creationTimestamp":null,"labels":{"app.kubernetes.io/component":"rabbitmq","app.kubernetes.io/name":"rabbitmq-cluster","app.kubernetes.io/part-of":"rabbitmq"},"ownerReferences":[{"apiVersion":"rabbitmq.com/v1beta1","kind":"RabbitmqCluster","name":"rabbitmq-cluster","uid":"18d9928b-0d1c-47be-80ec-20960d053827","controller":true,"blockOwnerDeletion":false}]},"spec":{"accessModes":["ReadWriteOnce"],"resources":{"requests":{"storage":"10Gi"}},"volumeMode":"Filesystem"},"status":{"phase":"Pending"}}],"serviceName":"rabbitmq-cluster-nodes","podManagementPolicy":"Parallel","updateStrategy":{"type":"RollingUpdate","rollingUpdate":{"partition":0}},"revisionHistoryLimit":10},"status":{"observedGeneration":1,"replicas":1,"readyReplicas":1,"currentReplicas":1,"updatedReplicas":1,"currentRevision":"rabbitmq-cluster-server-5f8b8665fb","updateRevision":"rabbitmq-cluster-server-5f8b8665fb","collisionCount":0}}
2022/03/18 18:01:17 learn_server.go:291: [SIEVE-AFTER-READ]	Get	true	service	default	rabbitmq-cluster-nodes	github.com/rabbitmq/cluster-operator/controllers.(*RabbitmqClusterReconciler)	NoError	{"kind":"Service","apiVersion":"v1","metadata":{"name":"rabbitmq-cluster-nodes","namespace":"default","selfLink":"/api/v1/namespaces/default/services/rabbitmq-cluster-nodes","uid":"67c7eea9-1b87-4fd7-82e6-5bfe31fd1b52","resourceVersion":"696","creationTimestamp":"2022-03-18T18:00:38Z","labels":{"app.kubernetes.io/component":"rabbitmq","app.kubernetes.io/name":"rabbitmq-cluster","app.kubernetes.io/part-of":"rabbitmq"},"ownerReferences":[{"apiVersion":"rabbitmq.com/v1beta1","kind":"RabbitmqCluster","name":"rabbitmq-cluster","uid":"18d9928b-0d1c-47be-80ec-20960d053827","controller":true,"blockOwnerDeletion":true}],"managedFields":[{"manager":"manager","operation":"Update","apiVersion":"v1","time":"2022-03-18T18:00:38Z","fieldsType":"FieldsV1","fieldsV1":{"f:metadata":{"f:labels":{".":{},"f:app.kubernetes.io/component":{},"f:app.kubernetes.io/name":{},"f:app.kubernetes.io/part-of":{}},"f:ownerReferences":{".":{},"k:{\"uid\":\"18d9928b-0d1c-47be-80ec-20960d053827\"}":{".":{},"f:apiVersion":{},"f:blockOwnerDeletion":{},"f:controller":{},"f:kind":{},"f:name":{},"f:uid":{}}}},"f:spec":{"f:clusterIP":{},"f:ports":{".":{},"k:{\"port\":4369,\"protocol\":\"TCP\"}":{".":{},"f:name":{},"f:port":{},"f:protocol":{},"f:targetPort":{}},"k:{\"port\":25672,\"protocol\":\"TCP\"}":{".":{},"f:name":{},"f:port":{},"f:protocol":{},"f:targetPort":{}}},"f:publishNotReadyAddresses":{},"f:selector":{".":{},"f:app.kubernetes.io/name":{}},"f:sessionAffinity":{},"f:type":{}}}}]},"spec":{"ports":[{"name":"epmd","protocol":"TCP","port":4369,"targetPort":4369},{"name":"cluster-rpc","protocol":"TCP","port":25672,"targetPort":25672}],"selector":{"app.kubernetes.io/name":"rabbitmq-cluster"},"clusterIP":"None","type":"ClusterIP","sessionAffinity":"None","publishNotReadyAddresses":true},"status":{"loadBalancer":{}}}
2022/03/18 18:01:17 learn_server.go:291: [SIEVE-AFTER-READ]	Get	true	service	default	rabbitmq-cluster	github.com/rabbitmq/cluster-operator/controllers.(*RabbitmqClusterReconciler)	NoError	{"kind":"Service","apiVersion":"v1","metadata":{"name":"rabbitmq-cluster","namespace":"default","selfLink":"/api/v1/namespaces/default/services/rabbitmq-cluster","uid":"56b50671-1945-458b-adac-05619b783392","resourceVersion":"701","creationTimestamp":"2022-03-18T18:00:38Z","labels":{"app.kubernetes.io/component":"rabbitmq","app.kubernetes.io/name":"rabbitmq-cluster","app.kubernetes.io/part-of":"rabbitmq"},"ownerReferences":[{"apiVersion":"rabbitmq.com/v1beta1","kind":"RabbitmqCluster","name":"rabbitmq-cluster","uid":"18d9928b-0d1c-47be-80ec-20960d053827","controller":true,"blockOwnerDeletion":true}],"managedFields":[{"manager":"manager","operation":"Update","apiVersion":"v1","time":"2022-03-18T18:00:38Z","fieldsType":"FieldsV1","fieldsV1":{"f:metadata":{"f:labels":{".":{},"f:app.kubernetes.io/component":{},"f:app.kubernetes.io/name":{},"f:app.kubernetes.io/part-of":{}},"f:ownerReferences":{".":{},"k:{\"uid\":\"18d9928b-0d1c-47be-80ec-20960d053827\"}":{".":{},"f:apiVersion":{},"f:blockOwnerDeletion":{},"f:controller":{},"f:kind":{},"f:name":{},"f:uid":{}}}},"f:spec":{"f:ports":{".":{},"k:{\"port\":5672,\"protocol\":\"TCP\"}":{".":{},"f:name":{},"f:port":{},"f:protocol":{},"f:targetPort":{}},"k:{\"port\":15672,\"protocol\":\"TCP\"}":{".":{},"f:name":{},"f:port":{},"f:protocol":{},"f:targetPort":{}}},"f:selector":{".":{},"f:app.kubernetes.io/name":{}},"f:sessionAffinity":{},"f:type":{}}}}]},"spec":{"ports":[{"name":"amqp","protocol":"TCP","port":5672,"targetPort":5672},{"name":"management","protocol":"TCP","port":15672,"targetPort":15672}],"selector":{"app.kubernetes.io/name":"rabbitmq-cluster"},"clusterIP":"10.96.254.158","type":"ClusterIP","sessionAffinity":"None"},"status":{"loadBalancer":{}}}
2022/03/18 18:01:17 learn_server.go:291: [SIEVE-AFTER-READ]	Get	true	secret	default	rabbitmq-cluster-erlang-cookie	github.com/rabbitmq/cluster-operator/controllers.(*RabbitmqClusterReconciler)	NoError	{"kind":"Secret","apiVersion":"v1","metadata":{"name":"rabbitmq-cluster-erlang-cookie","namespace":"default","selfLink":"/api/v1/namespaces/default/secrets/rabbitmq-cluster-erlang-cookie","uid":"f8fbe8a6-0f40-4e13-960b-ab78b8ba75b0","resourceVersion":"705","creationTimestamp":"2022-03-18T18:00:38Z","labels":{"app.kubernetes.io/component":"rabbitmq","app.kubernetes.io/name":"rabbitmq-cluster","app.kubernetes.io/part-of":"rabbitmq"},"ownerReferences":[{"apiVersion":"rabbitmq.com/v1beta1","kind":"RabbitmqCluster","name":"rabbitmq-cluster","uid":"18d9928b-0d1c-47be-80ec-20960d053827","controller":true,"blockOwnerDeletion":true}],"managedFields":[{"manager":"manager","operation":"Update","apiVersion":"v1","time":"2022-03-18T18:00:38Z","fieldsType":"FieldsV1","fieldsV1":{"f:data":{".":{},"f:.erlang.cookie":{}},"f:metadata":{"f:labels":{".":{},"f:app.kubernetes.io/component":{},"f:app.kubernetes.io/name":{},"f:app.kubernetes.io/part-of":{}},"f:ownerReferences":{".":{},"k:{\"uid\":\"18d9928b-0d1c-47be-80ec-20960d053827\"}":{".":{},"f:apiVersion":{},"f:blockOwnerDeletion":{},"f:controller":{},"f:kind":{},"f:name":{},"f:uid":{}}}},"f:type":{}}}]},"data":{".erlang.cookie":"QW9hMkpWU0tlYS1FUGdWTUhrelNMNnFoMFZ0ZmRGNUY="},"type":"Opaque"}
2022/03/18 18:01:17 learn_server.go:291: [SIEVE-AFTER-READ]	Get	true	secret	default	rabbitmq-cluster-default-user	github.com/rabbitmq/cluster-operator/controllers.(*RabbitmqClusterReconciler)	NoError	{"kind":"Secret","apiVersion":"v1","metadata":{"name":"rabbitmq-cluster-default-user","namespace":"default","selfLink":"/api/v1/namespaces/default/secrets/rabbitmq-cluster-default-user","uid":"0d9f460b-a23c-402b-8273-f541ed39023f","resourceVersion":"708","creationTimestamp":"2022-03-18T18:00:38Z","labels":{"app.kubernetes.io/component":"rabbitmq","app.kubernetes.io/name":"rabbitmq-cluster","app.kubernetes.io/part-of":"rabbitmq"},"ownerReferences":[{"apiVersion":"rabbitmq.com/v1beta1","kind":"RabbitmqCluster","name":"rabbitmq-cluster","uid":"18d9928b-0d1c-47be-80ec-20960d053827","controller":true,"blockOwnerDeletion":true}],"managedFields":[{"manager":"manager","operation":"Update","apiVersion":"v1","time":"2022-03-18T18:00:38Z","fieldsType":"FieldsV1","fieldsV1":{"f:data":{".":{},"f:default_user.conf":{},"f:password":{},"f:provider":{},"f:type":{},"f:username":{}},"f:metadata":{"f:labels":{".":{},"f:app.kubernetes.io/component":{},"f:app.kubernetes.io/name":{},"f:app.kubernetes.io/part-of":{}},"f:ownerReferences":{".":{},"k:{\"uid\":\"18d9928b-0d1c-47be-80ec-20960d053827\"}":{".":{},"f:apiVersion":{},"f:blockOwnerDeletion":{},"f:controller":{},"f:kind":{},"f:name":{},"f:uid":{}}}},"f:type":{}}}]},"data":{"default_user.conf":"ZGVmYXVsdF91c2VyID0gcTMxRmh3MGtjWW9SZUl5X3BPTXp2ZVBOUnNVU3I1Mk8KZGVmYXVsdF9wYXNzID0gY0dBX19jNTJHX05hVURpTGhraWZ6UDBOVVlNLTE2MWQK","password":"Y0dBX19jNTJHX05hVURpTGhraWZ6UDBOVVlNLTE2MWQ=","provider":"cmFiYml0bXE=","type":"cmFiYml0bXE=","username":"cTMxRmh3MGtjWW9SZUl5X3BPTXp2ZVBOUnNVU3I1Mk8="},"type":"Opaque"}
2022/03/18 18:01:17 learn_server.go:291: [SIEVE-AFTER-READ]	Get	true	configmap	default	rabbitmq-cluster-plugins-conf	github.com/rabbitmq/cluster-operator/controllers.(*RabbitmqClusterReconciler)	NoError	{"kind":"ConfigMap","apiVersion":"v1","metadata":{"name":"rabbitmq-cluster-plugins-conf","namespace":"default","selfLink":"/api/v1/namespaces/default/configmaps/rabbitmq-cluster-plugins-conf","uid":"a164075b-0562-47ac-a577-99aa8651ec40","resourceVersion":"709","creationTimestamp":"2022-03-18T18:00:38Z","labels":{"app.kubernetes.io/component":"rabbitmq","app.kubernetes.io/name":"rabbitmq-cluster","app.kubernetes.io/part-of":"rabbitmq"},"ownerReferences":[{"apiVersion":"rabbitmq.com/v1beta1","kind":"RabbitmqCluster","name":"rabbitmq-cluster","uid":"18d9928b-0d1c-47be-80ec-20960d053827","controller":true,"blockOwnerDeletion":true}],"managedFields":[{"manager":"manager","operation":"Update","apiVersion":"v1","time":"2022-03-18T18:00:38Z","fieldsType":"FieldsV1","fieldsV1":{"f:data":{".":{},"f:enabled_plugins":{}},"f:metadata":{"f:labels":{".":{},"f:app.kubernetes.io/component":{},"f:app.kubernetes.io/name":{},"f:app.kubernetes.io/part-of":{}},"f:ownerReferences":{".":{},"k:{\"uid\":\"18d9928b-0d1c-47be-80ec-20960d053827\"}":{".":{},"f:apiVersion":{},"f:blockOwnerDeletion":{},"f:controller":{},"f:kind":{},"f:name":{},"f:uid":{}}}}}}]},"data":{"enabled_plugins":"[rabbitmq_peer_discovery_k8s,rabbitmq_prometheus,rabbitmq_management]."}}
2022/03/18 18:01:17 learn_server.go:291: [SIEVE-AFTER-READ]	Get	true	configmap	default	rabbitmq-cluster-server-conf	github.com/rabbitmq/cluster-operator/controllers.(*RabbitmqClusterReconciler)	NoError	{"kind":"ConfigMap","apiVersion":"v1","metadata":{"name":"rabbitmq-cluster-server-conf","namespace":"default","selfLink":"/api/v1/namespaces/default/configmaps/rabbitmq-cluster-server-conf","uid":"22474f2b-8454-44b7-8079-8990223969cc","resourceVersion":"714","creationTimestamp":"2022-03-18T18:00:38Z","labels":{"app.kubernetes.io/component":"rabbitmq","app.kubernetes.io/name":"rabbitmq-cluster","app.kubernetes.io/part-of":"rabbitmq"},"ownerReferences":[{"apiVersion":"rabbitmq.com/v1beta1","kind":"RabbitmqCluster","name":"rabbitmq-cluster","uid":"18d9928b-0d1c-47be-80ec-20960d053827","controller":true,"blockOwnerDeletion":true}],"managedFields":[{"manager":"manager","operation":"Update","apiVersion":"v1","time":"2022-03-18T18:00:38Z","fieldsType":"FieldsV1","fieldsV1":{"f:data":{".":{},"f:operatorDefaults.conf":{},"f:userDefinedConfiguration.conf":{}},"f:metadata":{"f:labels":{".":{},"f:app.kubernetes.io/component":{},"f:app.kubernetes.io/name":{},"f:app.kubernetes.io/part-of":{}},"f:ownerReferences":{".":{},"k:{\"uid\":\"18d9928b-0d1c-47be-80ec-20960d053827\"}":{".":{},"f:apiVersion":{},"f:blockOwnerDeletion":{},"f:controller":{},"f:kind":{},"f:name":{},"f:uid":{}}}}}}]},"data":{"operatorDefaults.conf":"cluster_formation.peer_discovery_backend             = rabbit_peer_discovery_k8s\ncluster_formation.k8s.host                           = kubernetes.default\ncluster_formation.k8s.address_type                   = hostname\ncluster_partition_handling                           = pause_minority\nqueue_master_locator                                 = min-masters\ndisk_free_limit.absolute                             = 2GB\ncluster_formation.randomized_startup_delay_range.min = 5\ncluster_formation.randomized_startup_delay_range.max = 30\ncluster_name                                         = rabbitmq-cluster\n","userDefinedConfiguration.conf":"total_memory_available_override_value = 1717986919\n"}}
2022/03/18 18:01:17 learn_server.go:291: [SIEVE-AFTER-READ]	Get	true	serviceaccount	default	rabbitmq-cluster-server	github.com/rabbitmq/cluster-operator/controllers.(*RabbitmqClusterReconciler)	NoError	{"kind":"ServiceAccount","apiVersion":"v1","metadata":{"name":"rabbitmq-cluster-server","namespace":"default","selfLink":"/api/v1/namespaces/default/serviceaccounts/rabbitmq-cluster-server","uid":"731589b5-ac97-4774-bee4-008949b54734","resourceVersion":"722","creationTimestamp":"2022-03-18T18:00:38Z","labels":{"app.kubernetes.io/component":"rabbitmq","app.kubernetes.io/name":"rabbitmq-cluster","app.kubernetes.io/part-of":"rabbitmq"},"ownerReferences":[{"apiVersion":"rabbitmq.com/v1beta1","kind":"RabbitmqCluster","name":"rabbitmq-cluster","uid":"18d9928b-0d1c-47be-80ec-20960d053827","controller":true,"blockOwnerDeletion":true}],"managedFields":[{"manager":"kube-controller-manager","operation":"Update","apiVersion":"v1","time":"2022-03-18T18:00:38Z","fieldsType":"FieldsV1","fieldsV1":{"f:secrets":{".":{},"k:{\"name\":\"rabbitmq-cluster-server-token-rhzq9\"}":{".":{},"f:name":{}}}}},{"manager":"manager","operation":"Update","apiVersion":"v1","time":"2022-03-18T18:00:38Z","fieldsType":"FieldsV1","fieldsV1":{"f:metadata":{"f:labels":{".":{},"f:app.kubernetes.io/component":{},"f:app.kubernetes.io/name":{},"f:app.kubernetes.io/part-of":{}},"f:ownerReferences":{".":{},"k:{\"uid\":\"18d9928b-0d1c-47be-80ec-20960d053827\"}":{".":{},"f:apiVersion":{},"f:blockOwnerDeletion":{},"f:controller":{},"f:kind":{},"f:name":{},"f:uid":{}}}}}}]},"secrets":[{"name":"rabbitmq-cluster-server-token-rhzq9"}]}
2022/03/18 18:01:17 learn_server.go:291: [SIEVE-AFTER-READ]	Get	true	role	default	rabbitmq-cluster-peer-discovery	github.com/rabbitmq/cluster-operator/controllers.(*RabbitmqClusterReconciler)	NoError	{"kind":"Role","apiVersion":"rbac.authorization.k8s.io/v1","metadata":{"name":"rabbitmq-cluster-peer-discovery","namespace":"default","selfLink":"/apis/rbac.authorization.k8s.io/v1/namespaces/default/roles/rabbitmq-cluster-peer-discovery","uid":"52c80b50-4fdd-4089-bbfd-9756465953f2","resourceVersion":"723","creationTimestamp":"2022-03-18T18:00:38Z","labels":{"app.kubernetes.io/component":"rabbitmq","app.kubernetes.io/name":"rabbitmq-cluster","app.kubernetes.io/part-of":"rabbitmq"},"ownerReferences":[{"apiVersion":"rabbitmq.com/v1beta1","kind":"RabbitmqCluster","name":"rabbitmq-cluster","uid":"18d9928b-0d1c-47be-80ec-20960d053827","controller":true,"blockOwnerDeletion":true}],"managedFields":[{"manager":"manager","operation":"Update","apiVersion":"rbac.authorization.k8s.io/v1","time":"2022-03-18T18:00:38Z","fieldsType":"FieldsV1","fieldsV1":{"f:metadata":{"f:labels":{".":{},"f:app.kubernetes.io/component":{},"f:app.kubernetes.io/name":{},"f:app.kubernetes.io/part-of":{}},"f:ownerReferences":{".":{},"k:{\"uid\":\"18d9928b-0d1c-47be-80ec-20960d053827\"}":{".":{},"f:apiVersion":{},"f:blockOwnerDeletion":{},"f:controller":{},"f:kind":{},"f:name":{},"f:uid":{}}}},"f:rules":{}}}]},"rules":[{"verbs":["get"],"apiGroups":[""],"resources":["endpoints"]},{"verbs":["create"],"apiGroups":[""],"resources":["events"]}]}
2022/03/18 18:01:17 learn_server.go:291: [SIEVE-AFTER-READ]	Get	true	rolebinding	default	rabbitmq-cluster-server	github.com/rabbitmq/cluster-operator/controllers.(*RabbitmqClusterReconciler)	NoError	{"kind":"RoleBinding","apiVersion":"rbac.authorization.k8s.io/v1","metadata":{"name":"rabbitmq-cluster-server","namespace":"default","selfLink":"/apis/rbac.authorization.k8s.io/v1/namespaces/default/rolebindings/rabbitmq-cluster-server","uid":"495e9f7c-a20d-4515-86b0-34149a855034","resourceVersion":"725","creationTimestamp":"2022-03-18T18:00:38Z","labels":{"app.kubernetes.io/component":"rabbitmq","app.kubernetes.io/name":"rabbitmq-cluster","app.kubernetes.io/part-of":"rabbitmq"},"ownerReferences":[{"apiVersion":"rabbitmq.com/v1beta1","kind":"RabbitmqCluster","name":"rabbitmq-cluster","uid":"18d9928b-0d1c-47be-80ec-20960d053827","controller":true,"blockOwnerDeletion":true}],"managedFields":[{"manager":"manager","operation":"Update","apiVersion":"rbac.authorization.k8s.io/v1","time":"2022-03-18T18:00:38Z","fieldsType":"FieldsV1","fieldsV1":{"f:metadata":{"f:labels":{".":{},"f:app.kubernetes.io/component":{},"f:app.kubernetes.io/name":{},"f:app.kubernetes.io/part-of":{}},"f:ownerReferences":{".":{},"k:{\"uid\":\"18d9928b-0d1c-47be-80ec-20960d053827\"}":{".":{},"f:apiVersion":{},"f:blockOwnerDeletion":{},"f:controller":{},"f:kind":{},"f:name":{},"f:uid":{}}}},"f:roleRef":{"f:apiGroup":{},"f:kind":{},"f:name":{}},"f:subjects":{}}}]},"subjects":[{"kind":"ServiceAccount","name":"rabbitmq-cluster-server"}],"roleRef":{"apiGroup":"rbac.authorization.k8s.io","kind":"Role","name":"rabbitmq-cluster-peer-discovery"}}
2022/03/18 18:01:17 learn_server.go:291: [SIEVE-AFTER-READ]	Get	true	statefulset	default	rabbitmq-cluster-server	github.com/rabbitmq/cluster-operator/controllers.(*RabbitmqClusterReconciler)	NoError	{"kind":"StatefulSet","apiVersion":"apps/v1","metadata":{"name":"rabbitmq-cluster-server","namespace":"default","selfLink":"/apis/apps/v1/namespaces/default/statefulsets/rabbitmq-cluster-server","uid":"cb5c43bc-6ee7-481c-ab01-6f3acffdd3c8","resourceVersion":"943","generation":1,"creationTimestamp":"2022-03-18T18:00:38Z","labels":{"app.kubernetes.io/component":"rabbitmq","app.kubernetes.io/name":"rabbitmq-cluster","app.kubernetes.io/part-of":"rabbitmq"},"annotations":{"rabbitmq.com/createdAt":"2022-03-18T18:00:38Z"},"ownerReferences":[{"apiVersion":"rabbitmq.com/v1beta1","kind":"RabbitmqCluster","name":"rabbitmq-cluster","uid":"18d9928b-0d1c-47be-80ec-20960d053827","controller":true,"blockOwnerDeletion":true}],"managedFields":[{"manager":"manager","operation":"Update","apiVersion":"apps/v1","time":"2022-03-18T18:00:38Z","fieldsType":"FieldsV1","fieldsV1":{"f:metadata":{"f:annotations":{".":{},"f:rabbitmq.com/createdAt":{}},"f:labels":{".":{},"f:app.kubernetes.io/component":{},"f:app.kubernetes.io/name":{},"f:app.kubernetes.io/part-of":{}},"f:ownerReferences":{".":{},"k:{\"uid\":\"18d9928b-0d1c-47be-80ec-20960d053827\"}":{".":{},"f:apiVersion":{},"f:blockOwnerDeletion":{},"f:controller":{},"f:kind":{},"f:name":{},"f:uid":{}}}},"f:spec":{"f:podManagementPolicy":{},"f:replicas":{},"f:revisionHistoryLimit":{},"f:selector":{"f:matchLabels":{".":{},"f:app.kubernetes.io/name":{}}},"f:serviceName":{},"f:template":{"f:metadata":{"f:annotations":{".":{},"f:prometheus.io/port":{},"f:prometheus.io/scrape":{}},"f:labels":{".":{},"f:app.kubernetes.io/component":{},"f:app.kubernetes.io/name":{},"f:app.kubernetes.io/part-of":{}}},"f:spec":{"f:automountServiceAccountToken":{},"f:containers":{"k:{\"name\":\"rabbitmq\"}":{".":{},"f:env":{".":{},"k:{\"name\":\"K8S_HOSTNAME_SUFFIX\"}":{".":{},"f:name":{},"f:value":{}},"k:{\"name\":\"K8S_SERVICE_NAME\"}":{".":{},"f:name":{},"f:value":{}},"k:{\"name\":\"MY_POD_NAME\"}":{".":{},"f:name":{},"f:valueFrom":{".":{},"f:fieldRef":{".":{},"f:apiVersion":{},"f:fieldPath":{}}}},"k:{\"name\":\"MY_POD_NAMESPACE\"}":{".":{},"f:name":{},"f:valueFrom":{".":{},"f:fieldRef":{".":{},"f:apiVersion":{},"f:fieldPath":{}}}},"k:{\"name\":\"RABBITMQ_ENABLED_PLUGINS_FILE\"}":{".":{},"f:name":{},"f:value":{}},"k:{\"name\":\"RABBITMQ_NODENAME\"}":{".":{},"f:name":{},"f:value":{}},"k:{\"name\":\"RABBITMQ_USE_LONGNAME\"}":{".":{},"f:name":{},"f:value":{}}},"f:image":{},"f:imagePullPolicy":{},"f:lifecycle":{".":{},"f:preStop":{".":{},"f:exec":{".":{},"f:command":{}}}},"f:name":{},"f:ports":{".":{},"k:{\"containerPort\":4369,\"protocol\":\"TCP\"}":{".":{},"f:containerPort":{},"f:name":{},"f:protocol":{}},"k:{\"containerPort\":5672,\"protocol\":\"TCP\"}":{".":{},"f:containerPort":{},"f:name":{},"f:protocol":{}},"k:{\"containerPort\":15672,\"protocol\":\"TCP\"}":{".":{},"f:containerPort":{},"f:name":{},"f:protocol":{}},"k:{\"containerPort\":15692,\"protocol\":\"TCP\"}":{".":{},"f:containerPort":{},"f:name":{},"f:protocol":{}}},"f:readinessProbe":{".":{},"f:failureThreshold":{},"f:initialDelaySeconds":{},"f:periodSeconds":{},"f:successThreshold":{},"f:tcpSocket":{".":{},"f:port":{}},"f:timeoutSeconds":{}},"f:resources":{".":{},"f:limits":{".":{},"f:cpu":{},"f:memory":{}},"f:requests":{".":{},"f:cpu":{},"f:memory":{}}},"f:terminationMessagePath":{},"f:terminationMessagePolicy":{},"f:volumeMounts":{".":{},"k:{\"mountPath\":\"/etc/pod-info/\"}":{".":{},"f:mountPath":{},"f:name":{}},"k:{\"mountPath\":\"/etc/rabbitmq/conf.d/10-operatorDefaults.conf\"}":{".":{},"f:mountPath":{},"f:name":{},"f:subPath":{}},"k:{\"mountPath\":\"/etc/rabbitmq/conf.d/11-default_user.conf\"}":{".":{},"f:mountPath":{},"f:name":{},"f:subPath":{}},"k:{\"mountPath\":\"/etc/rabbitmq/conf.d/90-userDefinedConfiguration.conf\"}":{".":{},"f:mountPath":{},"f:name":{},"f:subPath":{}},"k:{\"mountPath\":\"/operator\"}":{".":{},"f:mountPath":{},"f:name":{}},"k:{\"mountPath\":\"/var/lib/rabbitmq/\"}":{".":{},"f:mountPath":{},"f:name":{}},"k:{\"mountPath\":\"/var/lib/rabbitmq/mnesia/\"}":{".":{},"f:mountPath":{},"f:name":{}}}}},"f:dnsPolicy":{},"f:initContainers":{".":{},"k:{\"name\":\"setup-container\"}":{".":{},"f:command":{},"f:image":{},"f:imagePullPolicy":{},"f:name":{},"f:resources":{".":{},"f:limits":{".":{},"f:cpu":{},"f:memory":{}},"f:requests":{".":{},"f:cpu":{},"f:memory":{}}},"f:securityContext":{".":{},"f:capabilities":{".":{},"f:drop":{}},"f:runAsUser":{}},"f:terminationMessagePath":{},"f:terminationMessagePolicy":{},"f:volumeMounts":{".":{},"k:{\"mountPath\":\"/operator\"}":{".":{},"f:mountPath":{},"f:name":{}},"k:{\"mountPath\":\"/tmp/default_user.conf\"}":{".":{},"f:mountPath":{},"f:name":{},"f:subPath":{}},"k:{\"mountPath\":\"/tmp/erlang-cookie-secret/\"}":{".":{},"f:mountPath":{},"f:name":{}},"k:{\"mountPath\":\"/tmp/rabbitmq-plugins/\"}":{".":{},"f:mountPath":{},"f:name":{}},"k:{\"mountPath\":\"/var/lib/rabbitmq/\"}":{".":{},"f:mountPath":{},"f:name":{}},"k:{\"mountPath\":\"/var/lib/rabbitmq/mnesia/\"}":{".":{},"f:mountPath":{},"f:name":{}}}}},"f:restartPolicy":{},"f:schedulerName":{},"f:securityContext":{".":{},"f:fsGroup":{},"f:runAsGroup":{},"f:runAsUser":{}},"f:serviceAccount":{},"f:serviceAccountName":{},"f:terminationGracePeriodSeconds":{},"f:topologySpreadConstraints":{".":{},"k:{\"topologyKey\":\"topology.kubernetes.io/zone\",\"whenUnsatisfiable\":\"ScheduleAnyway\"}":{".":{},"f:labelSelector":{".":{},"f:matchLabels":{".":{},"f:app.kubernetes.io/name":{}}},"f:maxSkew":{},"f:topologyKey":{},"f:whenUnsatisfiable":{}}},"f:volumes":{".":{},"k:{\"name\":\"erlang-cookie-secret\"}":{".":{},"f:name":{},"f:secret":{".":{},"f:defaultMode":{},"f:secretName":{}}},"k:{\"name\":\"plugins-conf\"}":{".":{},"f:configMap":{".":{},"f:defaultMode":{},"f:name":{}},"f:name":{}},"k:{\"name\":\"pod-info\"}":{".":{},"f:downwardAPI":{".":{},"f:defaultMode":{},"f:items":{}},"f:name":{}},"k:{\"name\":\"rabbitmq-confd\"}":{".":{},"f:name":{},"f:projected":{".":{},"f:defaultMode":{},"f:sources":{}}},"k:{\"name\":\"rabbitmq-erlang-cookie\"}":{".":{},"f:emptyDir":{},"f:name":{}},"k:{\"name\":\"rabbitmq-plugins\"}":{".":{},"f:emptyDir":{},"f:name":{}}}}},"f:updateStrategy":{"f:rollingUpdate":{".":{},"f:partition":{}},"f:type":{}},"f:volumeClaimTemplates":{}}}},{"manager":"kube-controller-manager","operation":"Update","apiVersion":"apps/v1","time":"2022-03-18T18:01:17Z","fieldsType":"FieldsV1","fieldsV1":{"f:status":{"f:collisionCount":{},"f:currentReplicas":{},"f:currentRevision":{},"f:observedGeneration":{},"f:readyReplicas":{},"f:replicas":{},"f:updateRevision":{},"f:updatedReplicas":{}}}}]},"spec":{"replicas":1,"selector":{"matchLabels":{"app.kubernetes.io/name":"rabbitmq-cluster"}},"template":{"metadata":{"creationTimestamp":null,"labels":{"app.kubernetes.io/component":"rabbitmq","app.kubernetes.io/name":"rabbitmq-cluster","app.kubernetes.io/part-of":"rabbitmq"},"annotations":{"prometheus.io/port":"15692","prometheus.io/scrape":"true"}},"spec":{"volumes":[{"name":"plugins-conf","configMap":{"name":"rabbitmq-cluster-plugins-conf","defaultMode":420}},{"name":"rabbitmq-confd","projected":{"sources":[{"secret":{"name":"rabbitmq-cluster-default-user","items":[{"key":"default_user.conf","path":"default_user.conf"}]}},{"configMap":{"name":"rabbitmq-cluster-server-conf","items":[{"key":"operatorDefaults.conf","path":"operatorDefaults.conf"},{"key":"userDefinedConfiguration.conf","path":"userDefinedConfiguration.conf"}]}}],"defaultMode":420}},{"name":"rabbitmq-erlang-cookie","emptyDir":{}},{"name":"erlang-cookie-secret","secret":{"secretName":"rabbitmq-cluster-erlang-cookie","defaultMode":420}},{"name":"rabbitmq-plugins","emptyDir":{}},{"name":"pod-info","downwardAPI":{"items":[{"path":"skipPreStopChecks","fieldRef":{"apiVersion":"v1","fieldPath":"metadata.labels['skipPreStopChecks']"}}],"defaultMode":420}}],"initContainers":[{"name":"setup-container","image":"rabbitmq:3.8.12-management","command":["sh","-c","cp /tmp/erlang-cookie-secret/.erlang.cookie /var/lib/rabbitmq/.erlang.cookie \u0026\u0026 chown 999:999 /var/lib/rabbitmq/.erlang.cookie \u0026\u0026 chmod 600 /var/lib/rabbitmq/.erlang.cookie ; cp /tmp/rabbitmq-plugins/enabled_plugins /operator/enabled_plugins \u0026\u0026 chown 999:999 /operator/enabled_plugins ; chown 999:999 /var/lib/rabbitmq/mnesia/ ; echo '[default]' \u003e /var/lib/rabbitmq/.rabbitmqadmin.conf \u0026\u0026 sed -e 's/default_user/username/' -e 's/default_pass/password/' /tmp/default_user.conf \u003e\u003e /var/lib/rabbitmq/.rabbitmqadmin.conf \u0026\u0026 chown 999:999 /var/lib/rabbitmq/.rabbitmqadmin.conf \u0026\u0026 chmod 600 /var/lib/rabbitmq/.rabbitmqadmin.conf"],"resources":{"limits":{"cpu":"100m","memory":"500Mi"},"requests":{"cpu":"100m","memory":"500Mi"}},"volumeMounts":[{"name":"plugins-conf","mountPath":"/tmp/rabbitmq-plugins/"},{"name":"rabbitmq-erlang-cookie","mountPath":"/var/lib/rabbitmq/"},{"name":"erlang-cookie-secret","mountPath":"/tmp/erlang-cookie-secret/"},{"name":"rabbitmq-plugins","mountPath":"/operator"},{"name":"persistence","mountPath":"/var/lib/rabbitmq/mnesia/"},{"name":"rabbitmq-confd","mountPath":"/tmp/default_user.conf","subPath":"default_user.conf"}],"terminationMessagePath":"/dev/termination-log","terminationMessagePolicy":"File","imagePullPolicy":"IfNotPresent","securityContext":{"capabilities":{"drop":["FSETID","KILL","SETGID","SETUID","SETPCAP","NET_BIND_SERVICE","NET_RAW","SYS_CHROOT","MKNOD","AUDIT_WRITE","SETFCAP"]},"runAsUser":0}}],"containers":[{"name":"rabbitmq","image":"rabbitmq:3.8.12-management","ports":[{"name":"epmd","containerPort":4369,"protocol":"TCP"},{"name":"amqp","containerPort":5672,"protocol":"TCP"},{"name":"management","containerPort":15672,"protocol":"TCP"},{"name":"prometheus","containerPort":15692,"protocol":"TCP"}],"env":[{"name":"MY_POD_NAME","valueFrom":{"fieldRef":{"apiVersion":"v1","fieldPath":"metadata.name"}}},{"name":"MY_POD_NAMESPACE","valueFrom":{"fieldRef":{"apiVersion":"v1","fieldPath":"metadata.namespace"}}},{"name":"RABBITMQ_ENABLED_PLUGINS_FILE","value":"/operator/enabled_plugins"},{"name":"K8S_SERVICE_NAME","value":"rabbitmq-cluster-nodes"},{"name":"RABBITMQ_USE_LONGNAME","value":"true"},{"name":"RABBITMQ_NODENAME","value":"rabbit@$(MY_POD_NAME).$(K8S_SERVICE_NAME).$(MY_POD_NAMESPACE)"},{"name":"K8S_HOSTNAME_SUFFIX","value":".$(K8S_SERVICE_NAME).$(MY_POD_NAMESPACE)"}],"resources":{"limits":{"cpu":"2","memory":"2Gi"},"requests":{"cpu":"1","memory":"2Gi"}},"volumeMounts":[{"name":"rabbitmq-erlang-cookie","mountPath":"/var/lib/rabbitmq/"},{"name":"persistence","mountPath":"/var/lib/rabbitmq/mnesia/"},{"name":"rabbitmq-plugins","mountPath":"/operator"},{"name":"rabbitmq-confd","mountPath":"/etc/rabbitmq/conf.d/10-operatorDefaults.conf","subPath":"operatorDefaults.conf"},{"name":"rabbitmq-confd","mountPath":"/etc/rabbitmq/conf.d/11-default_user.conf","subPath":"default_user.conf"},{"name":"rabbitmq-confd","mountPath":"/etc/rabbitmq/conf.d/90-userDefinedConfiguration.conf","subPath":"userDefinedConfiguration.conf"},{"name":"pod-info","mountPath":"/etc/pod-info/"}],"readinessProbe":{"tcpSocket":{"port":"amqp"},"initialDelaySeconds":10,"timeoutSeconds":5,"periodSeconds":10,"successThreshold":1,"failureThreshold":3},"lifecycle":{"preStop":{"exec":{"command":["/bin/bash","-c","if [ ! -z \"$(cat /etc/pod-info/skipPreStopChecks)\" ]; then exit 0; fi; rabbitmq-upgrade await_online_quorum_plus_one -t 604800; rabbitmq-upgrade await_online_synchronized_mirror -t 604800; rabbitmq-upgrade drain -t 604800"]}}},"terminationMessagePath":"/dev/termination-log","terminationMessagePolicy":"File","imagePullPolicy":"IfNotPresent"}],"restartPolicy":"Always","terminationGracePeriodSeconds":604800,"dnsPolicy":"ClusterFirst","serviceAccountName":"rabbitmq-cluster-server","serviceAccount":"rabbitmq-cluster-server","automountServiceAccountToken":true,"securityContext":{"runAsUser":999,"runAsGroup":999,"fsGroup":999},"schedulerName":"default-scheduler","topologySpreadConstraints":[{"maxSkew":1,"topologyKey":"topology.kubernetes.io/zone","whenUnsatisfiable":"ScheduleAnyway","labelSelector":{"matchLabels":{"app.kubernetes.io/name":"rabbitmq-cluster"}}}]}},"volumeClaimTemplates":[{"metadata":{"name":"persistence","namespace":"default","creationTimestamp":null,"labels":{"app.kubernetes.io/component":"rabbitmq","app.kubernetes.io/name":"rabbitmq-cluster","app.kubernetes.io/part-of":"rabbitmq"},"ownerReferences":[{"apiVersion":"rabbitmq.com/v1beta1","kind":"RabbitmqCluster","name":"rabbitmq-cluster","uid":"18d9928b-0d1c-47be-80ec-20960d053827","controller":true,"blockOwnerDeletion":false}]},"spec":{"accessModes":["ReadWriteOnce"],"resources":{"requests":{"storage":"10Gi"}},"volumeMode":"Filesystem"},"status":{"phase":"Pending"}}],"serviceName":"rabbitmq-cluster-nodes","podManagementPolicy":"Parallel","updateStrategy":{"type":"RollingUpdate","rollingUpdate":{"partition":0}},"revisionHistoryLimit":10},"status":{"observedGeneration":1,"replicas":1,"readyReplicas":1,"currentReplicas":1,"updatedReplicas":1,"currentRevision":"rabbitmq-cluster-server-5f8b8665fb","updateRevision":"rabbitmq-cluster-server-5f8b8665fb","collisionCount":0}}
2022/03/18 18:01:17 learn_server.go:291: [SIEVE-AFTER-READ]	Get	true	statefulset	default	rabbitmq-cluster-server	github.com/rabbitmq/cluster-operator/controllers.(*RabbitmqClusterReconciler)	NoError	{"kind":"StatefulSet","apiVersion":"apps/v1","metadata":{"name":"rabbitmq-cluster-server","namespace":"default","selfLink":"/apis/apps/v1/namespaces/default/statefulsets/rabbitmq-cluster-server","uid":"cb5c43bc-6ee7-481c-ab01-6f3acffdd3c8","resourceVersion":"943","generation":1,"creationTimestamp":"2022-03-18T18:00:38Z","labels":{"app.kubernetes.io/component":"rabbitmq","app.kubernetes.io/name":"rabbitmq-cluster","app.kubernetes.io/part-of":"rabbitmq"},"annotations":{"rabbitmq.com/createdAt":"2022-03-18T18:00:38Z"},"ownerReferences":[{"apiVersion":"rabbitmq.com/v1beta1","kind":"RabbitmqCluster","name":"rabbitmq-cluster","uid":"18d9928b-0d1c-47be-80ec-20960d053827","controller":true,"blockOwnerDeletion":true}],"managedFields":[{"manager":"manager","operation":"Update","apiVersion":"apps/v1","time":"2022-03-18T18:00:38Z","fieldsType":"FieldsV1","fieldsV1":{"f:metadata":{"f:annotations":{".":{},"f:rabbitmq.com/createdAt":{}},"f:labels":{".":{},"f:app.kubernetes.io/component":{},"f:app.kubernetes.io/name":{},"f:app.kubernetes.io/part-of":{}},"f:ownerReferences":{".":{},"k:{\"uid\":\"18d9928b-0d1c-47be-80ec-20960d053827\"}":{".":{},"f:apiVersion":{},"f:blockOwnerDeletion":{},"f:controller":{},"f:kind":{},"f:name":{},"f:uid":{}}}},"f:spec":{"f:podManagementPolicy":{},"f:replicas":{},"f:revisionHistoryLimit":{},"f:selector":{"f:matchLabels":{".":{},"f:app.kubernetes.io/name":{}}},"f:serviceName":{},"f:template":{"f:metadata":{"f:annotations":{".":{},"f:prometheus.io/port":{},"f:prometheus.io/scrape":{}},"f:labels":{".":{},"f:app.kubernetes.io/component":{},"f:app.kubernetes.io/name":{},"f:app.kubernetes.io/part-of":{}}},"f:spec":{"f:automountServiceAccountToken":{},"f:containers":{"k:{\"name\":\"rabbitmq\"}":{".":{},"f:env":{".":{},"k:{\"name\":\"K8S_HOSTNAME_SUFFIX\"}":{".":{},"f:name":{},"f:value":{}},"k:{\"name\":\"K8S_SERVICE_NAME\"}":{".":{},"f:name":{},"f:value":{}},"k:{\"name\":\"MY_POD_NAME\"}":{".":{},"f:name":{},"f:valueFrom":{".":{},"f:fieldRef":{".":{},"f:apiVersion":{},"f:fieldPath":{}}}},"k:{\"name\":\"MY_POD_NAMESPACE\"}":{".":{},"f:name":{},"f:valueFrom":{".":{},"f:fieldRef":{".":{},"f:apiVersion":{},"f:fieldPath":{}}}},"k:{\"name\":\"RABBITMQ_ENABLED_PLUGINS_FILE\"}":{".":{},"f:name":{},"f:value":{}},"k:{\"name\":\"RABBITMQ_NODENAME\"}":{".":{},"f:name":{},"f:value":{}},"k:{\"name\":\"RABBITMQ_USE_LONGNAME\"}":{".":{},"f:name":{},"f:value":{}}},"f:image":{},"f:imagePullPolicy":{},"f:lifecycle":{".":{},"f:preStop":{".":{},"f:exec":{".":{},"f:command":{}}}},"f:name":{},"f:ports":{".":{},"k:{\"containerPort\":4369,\"protocol\":\"TCP\"}":{".":{},"f:containerPort":{},"f:name":{},"f:protocol":{}},"k:{\"containerPort\":5672,\"protocol\":\"TCP\"}":{".":{},"f:containerPort":{},"f:name":{},"f:protocol":{}},"k:{\"containerPort\":15672,\"protocol\":\"TCP\"}":{".":{},"f:containerPort":{},"f:name":{},"f:protocol":{}},"k:{\"containerPort\":15692,\"protocol\":\"TCP\"}":{".":{},"f:containerPort":{},"f:name":{},"f:protocol":{}}},"f:readinessProbe":{".":{},"f:failureThreshold":{},"f:initialDelaySeconds":{},"f:periodSeconds":{},"f:successThreshold":{},"f:tcpSocket":{".":{},"f:port":{}},"f:timeoutSeconds":{}},"f:resources":{".":{},"f:limits":{".":{},"f:cpu":{},"f:memory":{}},"f:requests":{".":{},"f:cpu":{},"f:memory":{}}},"f:terminationMessagePath":{},"f:terminationMessagePolicy":{},"f:volumeMounts":{".":{},"k:{\"mountPath\":\"/etc/pod-info/\"}":{".":{},"f:mountPath":{},"f:name":{}},"k:{\"mountPath\":\"/etc/rabbitmq/conf.d/10-operatorDefaults.conf\"}":{".":{},"f:mountPath":{},"f:name":{},"f:subPath":{}},"k:{\"mountPath\":\"/etc/rabbitmq/conf.d/11-default_user.conf\"}":{".":{},"f:mountPath":{},"f:name":{},"f:subPath":{}},"k:{\"mountPath\":\"/etc/rabbitmq/conf.d/90-userDefinedConfiguration.conf\"}":{".":{},"f:mountPath":{},"f:name":{},"f:subPath":{}},"k:{\"mountPath\":\"/operator\"}":{".":{},"f:mountPath":{},"f:name":{}},"k:{\"mountPath\":\"/var/lib/rabbitmq/\"}":{".":{},"f:mountPath":{},"f:name":{}},"k:{\"mountPath\":\"/var/lib/rabbitmq/mnesia/\"}":{".":{},"f:mountPath":{},"f:name":{}}}}},"f:dnsPolicy":{},"f:initContainers":{".":{},"k:{\"name\":\"setup-container\"}":{".":{},"f:command":{},"f:image":{},"f:imagePullPolicy":{},"f:name":{},"f:resources":{".":{},"f:limits":{".":{},"f:cpu":{},"f:memory":{}},"f:requests":{".":{},"f:cpu":{},"f:memory":{}}},"f:securityContext":{".":{},"f:capabilities":{".":{},"f:drop":{}},"f:runAsUser":{}},"f:terminationMessagePath":{},"f:terminationMessagePolicy":{},"f:volumeMounts":{".":{},"k:{\"mountPath\":\"/operator\"}":{".":{},"f:mountPath":{},"f:name":{}},"k:{\"mountPath\":\"/tmp/default_user.conf\"}":{".":{},"f:mountPath":{},"f:name":{},"f:subPath":{}},"k:{\"mountPath\":\"/tmp/erlang-cookie-secret/\"}":{".":{},"f:mountPath":{},"f:name":{}},"k:{\"mountPath\":\"/tmp/rabbitmq-plugins/\"}":{".":{},"f:mountPath":{},"f:name":{}},"k:{\"mountPath\":\"/var/lib/rabbitmq/\"}":{".":{},"f:mountPath":{},"f:name":{}},"k:{\"mountPath\":\"/var/lib/rabbitmq/mnesia/\"}":{".":{},"f:mountPath":{},"f:name":{}}}}},"f:restartPolicy":{},"f:schedulerName":{},"f:securityContext":{".":{},"f:fsGroup":{},"f:runAsGroup":{},"f:runAsUser":{}},"f:serviceAccount":{},"f:serviceAccountName":{},"f:terminationGracePeriodSeconds":{},"f:topologySpreadConstraints":{".":{},"k:{\"topologyKey\":\"topology.kubernetes.io/zone\",\"whenUnsatisfiable\":\"ScheduleAnyway\"}":{".":{},"f:labelSelector":{".":{},"f:matchLabels":{".":{},"f:app.kubernetes.io/name":{}}},"f:maxSkew":{},"f:topologyKey":{},"f:whenUnsatisfiable":{}}},"f:volumes":{".":{},"k:{\"name\":\"erlang-cookie-secret\"}":{".":{},"f:name":{},"f:secret":{".":{},"f:defaultMode":{},"f:secretName":{}}},"k:{\"name\":\"plugins-conf\"}":{".":{},"f:configMap":{".":{},"f:defaultMode":{},"f:name":{}},"f:name":{}},"k:{\"name\":\"pod-info\"}":{".":{},"f:downwardAPI":{".":{},"f:defaultMode":{},"f:items":{}},"f:name":{}},"k:{\"name\":\"rabbitmq-confd\"}":{".":{},"f:name":{},"f:projected":{".":{},"f:defaultMode":{},"f:sources":{}}},"k:{\"name\":\"rabbitmq-erlang-cookie\"}":{".":{},"f:emptyDir":{},"f:name":{}},"k:{\"name\":\"rabbitmq-plugins\"}":{".":{},"f:emptyDir":{},"f:name":{}}}}},"f:updateStrategy":{"f:rollingUpdate":{".":{},"f:partition":{}},"f:type":{}},"f:volumeClaimTemplates":{}}}},{"manager":"kube-controller-manager","operation":"Update","apiVersion":"apps/v1","time":"2022-03-18T18:01:17Z","fieldsType":"FieldsV1","fieldsV1":{"f:status":{"f:collisionCount":{},"f:currentReplicas":{},"f:currentRevision":{},"f:observedGeneration":{},"f:readyReplicas":{},"f:replicas":{},"f:updateRevision":{},"f:updatedReplicas":{}}}}]},"spec":{"replicas":1,"selector":{"matchLabels":{"app.kubernetes.io/name":"rabbitmq-cluster"}},"template":{"metadata":{"creationTimestamp":null,"labels":{"app.kubernetes.io/component":"rabbitmq","app.kubernetes.io/name":"rabbitmq-cluster","app.kubernetes.io/part-of":"rabbitmq"},"annotations":{"prometheus.io/port":"15692","prometheus.io/scrape":"true"}},"spec":{"volumes":[{"name":"plugins-conf","configMap":{"name":"rabbitmq-cluster-plugins-conf","defaultMode":420}},{"name":"rabbitmq-confd","projected":{"sources":[{"secret":{"name":"rabbitmq-cluster-default-user","items":[{"key":"default_user.conf","path":"default_user.conf"}]}},{"configMap":{"name":"rabbitmq-cluster-server-conf","items":[{"key":"operatorDefaults.conf","path":"operatorDefaults.conf"},{"key":"userDefinedConfiguration.conf","path":"userDefinedConfiguration.conf"}]}}],"defaultMode":420}},{"name":"rabbitmq-erlang-cookie","emptyDir":{}},{"name":"erlang-cookie-secret","secret":{"secretName":"rabbitmq-cluster-erlang-cookie","defaultMode":420}},{"name":"rabbitmq-plugins","emptyDir":{}},{"name":"pod-info","downwardAPI":{"items":[{"path":"skipPreStopChecks","fieldRef":{"apiVersion":"v1","fieldPath":"metadata.labels['skipPreStopChecks']"}}],"defaultMode":420}}],"initContainers":[{"name":"setup-container","image":"rabbitmq:3.8.12-management","command":["sh","-c","cp /tmp/erlang-cookie-secret/.erlang.cookie /var/lib/rabbitmq/.erlang.cookie \u0026\u0026 chown 999:999 /var/lib/rabbitmq/.erlang.cookie \u0026\u0026 chmod 600 /var/lib/rabbitmq/.erlang.cookie ; cp /tmp/rabbitmq-plugins/enabled_plugins /operator/enabled_plugins \u0026\u0026 chown 999:999 /operator/enabled_plugins ; chown 999:999 /var/lib/rabbitmq/mnesia/ ; echo '[default]' \u003e /var/lib/rabbitmq/.rabbitmqadmin.conf \u0026\u0026 sed -e 's/default_user/username/' -e 's/default_pass/password/' /tmp/default_user.conf \u003e\u003e /var/lib/rabbitmq/.rabbitmqadmin.conf \u0026\u0026 chown 999:999 /var/lib/rabbitmq/.rabbitmqadmin.conf \u0026\u0026 chmod 600 /var/lib/rabbitmq/.rabbitmqadmin.conf"],"resources":{"limits":{"cpu":"100m","memory":"500Mi"},"requests":{"cpu":"100m","memory":"500Mi"}},"volumeMounts":[{"name":"plugins-conf","mountPath":"/tmp/rabbitmq-plugins/"},{"name":"rabbitmq-erlang-cookie","mountPath":"/var/lib/rabbitmq/"},{"name":"erlang-cookie-secret","mountPath":"/tmp/erlang-cookie-secret/"},{"name":"rabbitmq-plugins","mountPath":"/operator"},{"name":"persistence","mountPath":"/var/lib/rabbitmq/mnesia/"},{"name":"rabbitmq-confd","mountPath":"/tmp/default_user.conf","subPath":"default_user.conf"}],"terminationMessagePath":"/dev/termination-log","terminationMessagePolicy":"File","imagePullPolicy":"IfNotPresent","securityContext":{"capabilities":{"drop":["FSETID","KILL","SETGID","SETUID","SETPCAP","NET_BIND_SERVICE","NET_RAW","SYS_CHROOT","MKNOD","AUDIT_WRITE","SETFCAP"]},"runAsUser":0}}],"containers":[{"name":"rabbitmq","image":"rabbitmq:3.8.12-management","ports":[{"name":"epmd","containerPort":4369,"protocol":"TCP"},{"name":"amqp","containerPort":5672,"protocol":"TCP"},{"name":"management","containerPort":15672,"protocol":"TCP"},{"name":"prometheus","containerPort":15692,"protocol":"TCP"}],"env":[{"name":"MY_POD_NAME","valueFrom":{"fieldRef":{"apiVersion":"v1","fieldPath":"metadata.name"}}},{"name":"MY_POD_NAMESPACE","valueFrom":{"fieldRef":{"apiVersion":"v1","fieldPath":"metadata.namespace"}}},{"name":"RABBITMQ_ENABLED_PLUGINS_FILE","value":"/operator/enabled_plugins"},{"name":"K8S_SERVICE_NAME","value":"rabbitmq-cluster-nodes"},{"name":"RABBITMQ_USE_LONGNAME","value":"true"},{"name":"RABBITMQ_NODENAME","value":"rabbit@$(MY_POD_NAME).$(K8S_SERVICE_NAME).$(MY_POD_NAMESPACE)"},{"name":"K8S_HOSTNAME_SUFFIX","value":".$(K8S_SERVICE_NAME).$(MY_POD_NAMESPACE)"}],"resources":{"limits":{"cpu":"2","memory":"2Gi"},"requests":{"cpu":"1","memory":"2Gi"}},"volumeMounts":[{"name":"rabbitmq-erlang-cookie","mountPath":"/var/lib/rabbitmq/"},{"name":"persistence","mountPath":"/var/lib/rabbitmq/mnesia/"},{"name":"rabbitmq-plugins","mountPath":"/operator"},{"name":"rabbitmq-confd","mountPath":"/etc/rabbitmq/conf.d/10-operatorDefaults.conf","subPath":"operatorDefaults.conf"},{"name":"rabbitmq-confd","mountPath":"/etc/rabbitmq/conf.d/11-default_user.conf","subPath":"default_user.conf"},{"name":"rabbitmq-confd","mountPath":"/etc/rabbitmq/conf.d/90-userDefinedConfiguration.conf","subPath":"userDefinedConfiguration.conf"},{"name":"pod-info","mountPath":"/etc/pod-info/"}],"readinessProbe":{"tcpSocket":{"port":"amqp"},"initialDelaySeconds":10,"timeoutSeconds":5,"periodSeconds":10,"successThreshold":1,"failureThreshold":3},"lifecycle":{"preStop":{"exec":{"command":["/bin/bash","-c","if [ ! -z \"$(cat /etc/pod-info/skipPreStopChecks)\" ]; then exit 0; fi; rabbitmq-upgrade await_online_quorum_plus_one -t 604800; rabbitmq-upgrade await_online_synchronized_mirror -t 604800; rabbitmq-upgrade drain -t 604800"]}}},"terminationMessagePath":"/dev/termination-log","terminationMessagePolicy":"File","imagePullPolicy":"IfNotPresent"}],"restartPolicy":"Always","terminationGracePeriodSeconds":604800,"dnsPolicy":"ClusterFirst","serviceAccountName":"rabbitmq-cluster-server","serviceAccount":"rabbitmq-cluster-server","automountServiceAccountToken":true,"securityContext":{"runAsUser":999,"runAsGroup":999,"fsGroup":999},"schedulerName":"default-scheduler","topologySpreadConstraints":[{"maxSkew":1,"topologyKey":"topology.kubernetes.io/zone","whenUnsatisfiable":"ScheduleAnyway","labelSelector":{"matchLabels":{"app.kubernetes.io/name":"rabbitmq-cluster"}}}]}},"volumeClaimTemplates":[{"metadata":{"name":"persistence","namespace":"default","creationTimestamp":null,"labels":{"app.kubernetes.io/component":"rabbitmq","app.kubernetes.io/name":"rabbitmq-cluster","app.kubernetes.io/part-of":"rabbitmq"},"ownerReferences":[{"apiVersion":"rabbitmq.com/v1beta1","kind":"RabbitmqCluster","name":"rabbitmq-cluster","uid":"18d9928b-0d1c-47be-80ec-20960d053827","controller":true,"blockOwnerDeletion":false}]},"spec":{"accessModes":["ReadWriteOnce"],"resources":{"requests":{"storage":"10Gi"}},"volumeMode":"Filesystem"},"status":{"phase":"Pending"}}],"serviceName":"rabbitmq-cluster-nodes","podManagementPolicy":"Parallel","updateStrategy":{"type":"RollingUpdate","rollingUpdate":{"partition":0}},"revisionHistoryLimit":10},"status":{"observedGeneration":1,"replicas":1,"readyReplicas":1,"currentReplicas":1,"updatedReplicas":1,"currentRevision":"rabbitmq-cluster-server-5f8b8665fb","updateRevision":"rabbitmq-cluster-server-5f8b8665fb","collisionCount":0}}
2022/03/18 18:01:17 learn_server.go:256: [SIEVE-BEFORE-WRITE]	26
2022/03/18 18:01:17 learn_server.go:263: [SIEVE-AFTER-WRITE]	26	Update	statefulset	github.com/rabbitmq/cluster-operator/controllers.(*RabbitmqClusterReconciler)	NoError	{"metadata":{"name":"rabbitmq-cluster-server","namespace":"default","selfLink":"/apis/apps/v1/namespaces/default/statefulsets/rabbitmq-cluster-server","uid":"cb5c43bc-6ee7-481c-ab01-6f3acffdd3c8","resourceVersion":"943","generation":1,"creationTimestamp":"2022-03-18T18:00:38Z","labels":{"app.kubernetes.io/component":"rabbitmq","app.kubernetes.io/name":"rabbitmq-cluster","app.kubernetes.io/part-of":"rabbitmq"},"annotations":{"rabbitmq.com/createdAt":"2022-03-18T18:00:38Z"},"ownerReferences":[{"apiVersion":"rabbitmq.com/v1beta1","kind":"RabbitmqCluster","name":"rabbitmq-cluster","uid":"18d9928b-0d1c-47be-80ec-20960d053827","controller":true,"blockOwnerDeletion":true}],"managedFields":[{"manager":"manager","operation":"Update","apiVersion":"apps/v1","time":"2022-03-18T18:00:38Z","fieldsType":"FieldsV1","fieldsV1":{"f:metadata":{"f:annotations":{".":{},"f:rabbitmq.com/createdAt":{}},"f:labels":{".":{},"f:app.kubernetes.io/component":{},"f:app.kubernetes.io/name":{},"f:app.kubernetes.io/part-of":{}},"f:ownerReferences":{".":{},"k:{\"uid\":\"18d9928b-0d1c-47be-80ec-20960d053827\"}":{".":{},"f:apiVersion":{},"f:blockOwnerDeletion":{},"f:controller":{},"f:kind":{},"f:name":{},"f:uid":{}}}},"f:spec":{"f:podManagementPolicy":{},"f:replicas":{},"f:revisionHistoryLimit":{},"f:selector":{"f:matchLabels":{".":{},"f:app.kubernetes.io/name":{}}},"f:serviceName":{},"f:template":{"f:metadata":{"f:annotations":{".":{},"f:prometheus.io/port":{},"f:prometheus.io/scrape":{}},"f:labels":{".":{},"f:app.kubernetes.io/component":{},"f:app.kubernetes.io/name":{},"f:app.kubernetes.io/part-of":{}}},"f:spec":{"f:automountServiceAccountToken":{},"f:containers":{"k:{\"name\":\"rabbitmq\"}":{".":{},"f:env":{".":{},"k:{\"name\":\"K8S_HOSTNAME_SUFFIX\"}":{".":{},"f:name":{},"f:value":{}},"k:{\"name\":\"K8S_SERVICE_NAME\"}":{".":{},"f:name":{},"f:value":{}},"k:{\"name\":\"MY_POD_NAME\"}":{".":{},"f:name":{},"f:valueFrom":{".":{},"f:fieldRef":{".":{},"f:apiVersion":{},"f:fieldPath":{}}}},"k:{\"name\":\"MY_POD_NAMESPACE\"}":{".":{},"f:name":{},"f:valueFrom":{".":{},"f:fieldRef":{".":{},"f:apiVersion":{},"f:fieldPath":{}}}},"k:{\"name\":\"RABBITMQ_ENABLED_PLUGINS_FILE\"}":{".":{},"f:name":{},"f:value":{}},"k:{\"name\":\"RABBITMQ_NODENAME\"}":{".":{},"f:name":{},"f:value":{}},"k:{\"name\":\"RABBITMQ_USE_LONGNAME\"}":{".":{},"f:name":{},"f:value":{}}},"f:image":{},"f:imagePullPolicy":{},"f:lifecycle":{".":{},"f:preStop":{".":{},"f:exec":{".":{},"f:command":{}}}},"f:name":{},"f:ports":{".":{},"k:{\"containerPort\":4369,\"protocol\":\"TCP\"}":{".":{},"f:containerPort":{},"f:name":{},"f:protocol":{}},"k:{\"containerPort\":5672,\"protocol\":\"TCP\"}":{".":{},"f:containerPort":{},"f:name":{},"f:protocol":{}},"k:{\"containerPort\":15672,\"protocol\":\"TCP\"}":{".":{},"f:containerPort":{},"f:name":{},"f:protocol":{}},"k:{\"containerPort\":15692,\"protocol\":\"TCP\"}":{".":{},"f:containerPort":{},"f:name":{},"f:protocol":{}}},"f:readinessProbe":{".":{},"f:failureThreshold":{},"f:initialDelaySeconds":{},"f:periodSeconds":{},"f:successThreshold":{},"f:tcpSocket":{".":{},"f:port":{}},"f:timeoutSeconds":{}},"f:resources":{".":{},"f:limits":{".":{},"f:cpu":{},"f:memory":{}},"f:requests":{".":{},"f:cpu":{},"f:memory":{}}},"f:terminationMessagePath":{},"f:terminationMessagePolicy":{},"f:volumeMounts":{".":{},"k:{\"mountPath\":\"/etc/pod-info/\"}":{".":{},"f:mountPath":{},"f:name":{}},"k:{\"mountPath\":\"/etc/rabbitmq/conf.d/10-operatorDefaults.conf\"}":{".":{},"f:mountPath":{},"f:name":{},"f:subPath":{}},"k:{\"mountPath\":\"/etc/rabbitmq/conf.d/11-default_user.conf\"}":{".":{},"f:mountPath":{},"f:name":{},"f:subPath":{}},"k:{\"mountPath\":\"/etc/rabbitmq/conf.d/90-userDefinedConfiguration.conf\"}":{".":{},"f:mountPath":{},"f:name":{},"f:subPath":{}},"k:{\"mountPath\":\"/operator\"}":{".":{},"f:mountPath":{},"f:name":{}},"k:{\"mountPath\":\"/var/lib/rabbitmq/\"}":{".":{},"f:mountPath":{},"f:name":{}},"k:{\"mountPath\":\"/var/lib/rabbitmq/mnesia/\"}":{".":{},"f:mountPath":{},"f:name":{}}}}},"f:dnsPolicy":{},"f:initContainers":{".":{},"k:{\"name\":\"setup-container\"}":{".":{},"f:command":{},"f:image":{},"f:imagePullPolicy":{},"f:name":{},"f:resources":{".":{},"f:limits":{".":{},"f:cpu":{},"f:memory":{}},"f:requests":{".":{},"f:cpu":{},"f:memory":{}}},"f:securityContext":{".":{},"f:capabilities":{".":{},"f:drop":{}},"f:runAsUser":{}},"f:terminationMessagePath":{},"f:terminationMessagePolicy":{},"f:volumeMounts":{".":{},"k:{\"mountPath\":\"/operator\"}":{".":{},"f:mountPath":{},"f:name":{}},"k:{\"mountPath\":\"/tmp/default_user.conf\"}":{".":{},"f:mountPath":{},"f:name":{},"f:subPath":{}},"k:{\"mountPath\":\"/tmp/erlang-cookie-secret/\"}":{".":{},"f:mountPath":{},"f:name":{}},"k:{\"mountPath\":\"/tmp/rabbitmq-plugins/\"}":{".":{},"f:mountPath":{},"f:name":{}},"k:{\"mountPath\":\"/var/lib/rabbitmq/\"}":{".":{},"f:mountPath":{},"f:name":{}},"k:{\"mountPath\":\"/var/lib/rabbitmq/mnesia/\"}":{".":{},"f:mountPath":{},"f:name":{}}}}},"f:restartPolicy":{},"f:schedulerName":{},"f:securityContext":{".":{},"f:fsGroup":{},"f:runAsGroup":{},"f:runAsUser":{}},"f:serviceAccount":{},"f:serviceAccountName":{},"f:terminationGracePeriodSeconds":{},"f:topologySpreadConstraints":{".":{},"k:{\"topologyKey\":\"topology.kubernetes.io/zone\",\"whenUnsatisfiable\":\"ScheduleAnyway\"}":{".":{},"f:labelSelector":{".":{},"f:matchLabels":{".":{},"f:app.kubernetes.io/name":{}}},"f:maxSkew":{},"f:topologyKey":{},"f:whenUnsatisfiable":{}}},"f:volumes":{".":{},"k:{\"name\":\"erlang-cookie-secret\"}":{".":{},"f:name":{},"f:secret":{".":{},"f:defaultMode":{},"f:secretName":{}}},"k:{\"name\":\"plugins-conf\"}":{".":{},"f:configMap":{".":{},"f:defaultMode":{},"f:name":{}},"f:name":{}},"k:{\"name\":\"pod-info\"}":{".":{},"f:downwardAPI":{".":{},"f:defaultMode":{},"f:items":{}},"f:name":{}},"k:{\"name\":\"rabbitmq-confd\"}":{".":{},"f:name":{},"f:projected":{".":{},"f:defaultMode":{},"f:sources":{}}},"k:{\"name\":\"rabbitmq-erlang-cookie\"}":{".":{},"f:emptyDir":{},"f:name":{}},"k:{\"name\":\"rabbitmq-plugins\"}":{".":{},"f:emptyDir":{},"f:name":{}}}}},"f:updateStrategy":{"f:rollingUpdate":{".":{},"f:partition":{}},"f:type":{}},"f:volumeClaimTemplates":{}}}},{"manager":"kube-controller-manager","operation":"Update","apiVersion":"apps/v1","time":"2022-03-18T18:01:17Z","fieldsType":"FieldsV1","fieldsV1":{"f:status":{"f:collisionCount":{},"f:currentReplicas":{},"f:currentRevision":{},"f:observedGeneration":{},"f:readyReplicas":{},"f:replicas":{},"f:updateRevision":{},"f:updatedReplicas":{}}}}]},"spec":{"replicas":1,"selector":{"matchLabels":{"app.kubernetes.io/name":"rabbitmq-cluster"}},"template":{"metadata":{"creationTimestamp":null,"labels":{"app.kubernetes.io/component":"rabbitmq","app.kubernetes.io/name":"rabbitmq-cluster","app.kubernetes.io/part-of":"rabbitmq"},"annotations":{"prometheus.io/port":"15692","prometheus.io/scrape":"true"}},"spec":{"volumes":[{"name":"plugins-conf","configMap":{"name":"rabbitmq-cluster-plugins-conf","defaultMode":420}},{"name":"rabbitmq-confd","projected":{"sources":[{"secret":{"name":"rabbitmq-cluster-default-user","items":[{"key":"default_user.conf","path":"default_user.conf"}]}},{"configMap":{"name":"rabbitmq-cluster-server-conf","items":[{"key":"operatorDefaults.conf","path":"operatorDefaults.conf"},{"key":"userDefinedConfiguration.conf","path":"userDefinedConfiguration.conf"}]}}],"defaultMode":420}},{"name":"rabbitmq-erlang-cookie","emptyDir":{}},{"name":"erlang-cookie-secret","secret":{"secretName":"rabbitmq-cluster-erlang-cookie","defaultMode":420}},{"name":"rabbitmq-plugins","emptyDir":{}},{"name":"pod-info","downwardAPI":{"items":[{"path":"skipPreStopChecks","fieldRef":{"apiVersion":"v1","fieldPath":"metadata.labels['skipPreStopChecks']"}}],"defaultMode":420}}],"initContainers":[{"name":"setup-container","image":"rabbitmq:3.8.12-management","command":["sh","-c","cp /tmp/erlang-cookie-secret/.erlang.cookie /var/lib/rabbitmq/.erlang.cookie \u0026\u0026 chown 999:999 /var/lib/rabbitmq/.erlang.cookie \u0026\u0026 chmod 600 /var/lib/rabbitmq/.erlang.cookie ; cp /tmp/rabbitmq-plugins/enabled_plugins /operator/enabled_plugins \u0026\u0026 chown 999:999 /operator/enabled_plugins ; chown 999:999 /var/lib/rabbitmq/mnesia/ ; echo '[default]' \u003e /var/lib/rabbitmq/.rabbitmqadmin.conf \u0026\u0026 sed -e 's/default_user/username/' -e 's/default_pass/password/' /tmp/default_user.conf \u003e\u003e /var/lib/rabbitmq/.rabbitmqadmin.conf \u0026\u0026 chown 999:999 /var/lib/rabbitmq/.rabbitmqadmin.conf \u0026\u0026 chmod 600 /var/lib/rabbitmq/.rabbitmqadmin.conf"],"resources":{"limits":{"cpu":"100m","memory":"500Mi"},"requests":{"cpu":"100m","memory":"500Mi"}},"volumeMounts":[{"name":"plugins-conf","mountPath":"/tmp/rabbitmq-plugins/"},{"name":"rabbitmq-erlang-cookie","mountPath":"/var/lib/rabbitmq/"},{"name":"erlang-cookie-secret","mountPath":"/tmp/erlang-cookie-secret/"},{"name":"rabbitmq-plugins","mountPath":"/operator"},{"name":"persistence","mountPath":"/var/lib/rabbitmq/mnesia/"},{"name":"rabbitmq-confd","mountPath":"/tmp/default_user.conf","subPath":"default_user.conf"}],"terminationMessagePath":"/dev/termination-log","terminationMessagePolicy":"File","imagePullPolicy":"IfNotPresent","securityContext":{"capabilities":{"drop":["FSETID","KILL","SETGID","SETUID","SETPCAP","NET_BIND_SERVICE","NET_RAW","SYS_CHROOT","MKNOD","AUDIT_WRITE","SETFCAP"]},"runAsUser":0}}],"containers":[{"name":"rabbitmq","image":"rabbitmq:3.8.12-management","ports":[{"name":"epmd","containerPort":4369,"protocol":"TCP"},{"name":"amqp","containerPort":5672,"protocol":"TCP"},{"name":"management","containerPort":15672,"protocol":"TCP"},{"name":"prometheus","containerPort":15692,"protocol":"TCP"}],"env":[{"name":"MY_POD_NAME","valueFrom":{"fieldRef":{"apiVersion":"v1","fieldPath":"metadata.name"}}},{"name":"MY_POD_NAMESPACE","valueFrom":{"fieldRef":{"apiVersion":"v1","fieldPath":"metadata.namespace"}}},{"name":"RABBITMQ_ENABLED_PLUGINS_FILE","value":"/operator/enabled_plugins"},{"name":"K8S_SERVICE_NAME","value":"rabbitmq-cluster-nodes"},{"name":"RABBITMQ_USE_LONGNAME","value":"true"},{"name":"RABBITMQ_NODENAME","value":"rabbit@$(MY_POD_NAME).$(K8S_SERVICE_NAME).$(MY_POD_NAMESPACE)"},{"name":"K8S_HOSTNAME_SUFFIX","value":".$(K8S_SERVICE_NAME).$(MY_POD_NAMESPACE)"}],"resources":{"limits":{"cpu":"2","memory":"2Gi"},"requests":{"cpu":"1","memory":"2Gi"}},"volumeMounts":[{"name":"rabbitmq-erlang-cookie","mountPath":"/var/lib/rabbitmq/"},{"name":"persistence","mountPath":"/var/lib/rabbitmq/mnesia/"},{"name":"rabbitmq-plugins","mountPath":"/operator"},{"name":"rabbitmq-confd","mountPath":"/etc/rabbitmq/conf.d/10-operatorDefaults.conf","subPath":"operatorDefaults.conf"},{"name":"rabbitmq-confd","mountPath":"/etc/rabbitmq/conf.d/11-default_user.conf","subPath":"default_user.conf"},{"name":"rabbitmq-confd","mountPath":"/etc/rabbitmq/conf.d/90-userDefinedConfiguration.conf","subPath":"userDefinedConfiguration.conf"},{"name":"pod-info","mountPath":"/etc/pod-info/"}],"readinessProbe":{"tcpSocket":{"port":"amqp"},"initialDelaySeconds":10,"timeoutSeconds":5,"periodSeconds":10,"successThreshold":1,"failureThreshold":3},"lifecycle":{"preStop":{"exec":{"command":["/bin/bash","-c","if [ ! -z \"$(cat /etc/pod-info/skipPreStopChecks)\" ]; then exit 0; fi; rabbitmq-upgrade await_online_quorum_plus_one -t 604800; rabbitmq-upgrade await_online_synchronized_mirror -t 604800; rabbitmq-upgrade drain -t 604800"]}}},"terminationMessagePath":"/dev/termination-log","terminationMessagePolicy":"File","imagePullPolicy":"IfNotPresent"}],"restartPolicy":"Always","terminationGracePeriodSeconds":604800,"dnsPolicy":"ClusterFirst","serviceAccountName":"rabbitmq-cluster-server","serviceAccount":"rabbitmq-cluster-server","automountServiceAccountToken":true,"securityContext":{"runAsUser":999,"runAsGroup":999,"fsGroup":999},"schedulerName":"default-scheduler","topologySpreadConstraints":[{"maxSkew":1,"topologyKey":"topology.kubernetes.io/zone","whenUnsatisfiable":"ScheduleAnyway","labelSelector":{"matchLabels":{"app.kubernetes.io/name":"rabbitmq-cluster"}}}]}},"volumeClaimTemplates":[{"metadata":{"name":"persistence","namespace":"default","creationTimestamp":null,"labels":{"app.kubernetes.io/component":"rabbitmq","app.kubernetes.io/name":"rabbitmq-cluster","app.kubernetes.io/part-of":"rabbitmq"},"ownerReferences":[{"apiVersion":"rabbitmq.com/v1beta1","kind":"RabbitmqCluster","name":"rabbitmq-cluster","uid":"18d9928b-0d1c-47be-80ec-20960d053827","controller":true,"blockOwnerDeletion":false}]},"spec":{"accessModes":["ReadWriteOnce"],"resources":{"requests":{"storage":"10Gi"}},"volumeMode":"Filesystem"},"status":{"phase":"Pending"}}],"serviceName":"rabbitmq-cluster-nodes","podManagementPolicy":"Parallel","updateStrategy":{"type":"RollingUpdate","rollingUpdate":{"partition":0}},"revisionHistoryLimit":10},"status":{"observedGeneration":1,"replicas":1,"readyReplicas":1,"currentReplicas":1,"updatedReplicas":1,"currentRevision":"rabbitmq-cluster-server-5f8b8665fb","updateRevision":"rabbitmq-cluster-server-5f8b8665fb","collisionCount":0}}
2022/03/18 18:01:17 learn_server.go:291: [SIEVE-AFTER-READ]	Get	true	configmap	default	rabbitmq-cluster-server-conf	github.com/rabbitmq/cluster-operator/controllers.(*RabbitmqClusterReconciler)	NoError	{"kind":"ConfigMap","apiVersion":"v1","metadata":{"name":"rabbitmq-cluster-server-conf","namespace":"default","selfLink":"/api/v1/namespaces/default/configmaps/rabbitmq-cluster-server-conf","uid":"22474f2b-8454-44b7-8079-8990223969cc","resourceVersion":"714","creationTimestamp":"2022-03-18T18:00:38Z","labels":{"app.kubernetes.io/component":"rabbitmq","app.kubernetes.io/name":"rabbitmq-cluster","app.kubernetes.io/part-of":"rabbitmq"},"ownerReferences":[{"apiVersion":"rabbitmq.com/v1beta1","kind":"RabbitmqCluster","name":"rabbitmq-cluster","uid":"18d9928b-0d1c-47be-80ec-20960d053827","controller":true,"blockOwnerDeletion":true}],"managedFields":[{"manager":"manager","operation":"Update","apiVersion":"v1","time":"2022-03-18T18:00:38Z","fieldsType":"FieldsV1","fieldsV1":{"f:data":{".":{},"f:operatorDefaults.conf":{},"f:userDefinedConfiguration.conf":{}},"f:metadata":{"f:labels":{".":{},"f:app.kubernetes.io/component":{},"f:app.kubernetes.io/name":{},"f:app.kubernetes.io/part-of":{}},"f:ownerReferences":{".":{},"k:{\"uid\":\"18d9928b-0d1c-47be-80ec-20960d053827\"}":{".":{},"f:apiVersion":{},"f:blockOwnerDeletion":{},"f:controller":{},"f:kind":{},"f:name":{},"f:uid":{}}}}}}]},"data":{"operatorDefaults.conf":"cluster_formation.peer_discovery_backend             = rabbit_peer_discovery_k8s\ncluster_formation.k8s.host                           = kubernetes.default\ncluster_formation.k8s.address_type                   = hostname\ncluster_partition_handling                           = pause_minority\nqueue_master_locator                                 = min-masters\ndisk_free_limit.absolute                             = 2GB\ncluster_formation.randomized_startup_delay_range.min = 5\ncluster_formation.randomized_startup_delay_range.max = 30\ncluster_name                                         = rabbitmq-cluster\n","userDefinedConfiguration.conf":"total_memory_available_override_value = 1717986919\n"}}
2022/03/18 18:01:17 learn_server.go:256: [SIEVE-BEFORE-WRITE]	27
2022/03/18 18:01:17 learn_server.go:263: [SIEVE-AFTER-WRITE]	27	StatusUpdate	rabbitmqcluster	github.com/rabbitmq/cluster-operator/controllers.(*RabbitmqClusterReconciler)	NoError	{"metadata":{"name":"rabbitmq-cluster","namespace":"default","selfLink":"/apis/rabbitmq.com/v1beta1/namespaces/default/rabbitmqclusters/rabbitmq-cluster/status","uid":"18d9928b-0d1c-47be-80ec-20960d053827","resourceVersion":"944","generation":2,"creationTimestamp":"2022-03-18T18:00:38Z","annotations":{"kubectl.kubernetes.io/last-applied-configuration":"{\"apiVersion\":\"rabbitmq.com/v1beta1\",\"kind\":\"RabbitmqCluster\",\"metadata\":{\"annotations\":{},\"name\":\"rabbitmq-cluster\",\"namespace\":\"default\"},\"spec\":{\"persistence\":{\"storage\":\"10Gi\"},\"replicas\":1}}\n"},"finalizers":["deletion.finalizers.rabbitmqclusters.rabbitmq.com"],"managedFields":[{"manager":"kubectl-client-side-apply","operation":"Update","apiVersion":"rabbitmq.com/v1beta1","time":"2022-03-18T18:00:38Z","fieldsType":"FieldsV1","fieldsV1":{"f:metadata":{"f:annotations":{".":{},"f:kubectl.kubernetes.io/last-applied-configuration":{}}},"f:spec":{".":{},"f:image":{},"f:persistence":{".":{},"f:storage":{}},"f:replicas":{},"f:resources":{".":{},"f:limits":{".":{},"f:memory":{}},"f:requests":{".":{},"f:memory":{}}},"f:service":{".":{},"f:type":{}},"f:terminationGracePeriodSeconds":{}}}},{"manager":"manager","operation":"Update","apiVersion":"rabbitmq.com/v1beta1","time":"2022-03-18T18:01:17Z","fieldsType":"FieldsV1","fieldsV1":{"f:metadata":{"f:finalizers":{}},"f:spec":{"f:override":{},"f:rabbitmq":{},"f:resources":{"f:limits":{"f:cpu":{}},"f:requests":{"f:cpu":{}}},"f:tls":{}},"f:status":{".":{},"f:conditions":{},"f:defaultUser":{".":{},"f:secretReference":{".":{},"f:keys":{".":{},"f:password":{},"f:username":{}},"f:name":{},"f:namespace":{}},"f:serviceReference":{".":{},"f:name":{},"f:namespace":{}}}}}}]},"spec":{"replicas":1,"image":"rabbitmq:3.8.12-management","service":{"type":"ClusterIP"},"persistence":{"storage":"10Gi"},"resources":{"limits":{"cpu":"2","memory":"2Gi"},"requests":{"cpu":"1","memory":"2Gi"}},"rabbitmq":{},"tls":{},"override":{},"terminationGracePeriodSeconds":604800},"status":{"conditions":[{"type":"AllReplicasReady","status":"True","lastTransitionTime":"2022-03-18T18:01:17Z","reason":"AllPodsAreReady"},{"type":"ClusterAvailable","status":"True","lastTransitionTime":"2022-03-18T18:01:17Z","reason":"AtLeastOneEndpointAvailable"},{"type":"NoWarnings","status":"True","lastTransitionTime":"2022-03-18T18:00:38Z","reason":"NoWarnings"},{"type":"ReconcileSuccess","status":"Unknown","lastTransitionTime":"2022-03-18T18:00:38Z","reason":"Initialising"}],"defaultUser":{"secretReference":{"name":"rabbitmq-cluster-default-user","namespace":"default","keys":{"password":"password","username":"username"}},"serviceReference":{"name":"rabbitmq-cluster","namespace":"default"}},"binding":{"name":"rabbitmq-cluster-default-user"}}}
2022/03/18 18:01:17 learn_server.go:291: [SIEVE-AFTER-READ]	Get	true	statefulset	default	rabbitmq-cluster-server	github.com/rabbitmq/cluster-operator/controllers.(*RabbitmqClusterReconciler)	NoError	{"kind":"StatefulSet","apiVersion":"apps/v1","metadata":{"name":"rabbitmq-cluster-server","namespace":"default","selfLink":"/apis/apps/v1/namespaces/default/statefulsets/rabbitmq-cluster-server","uid":"cb5c43bc-6ee7-481c-ab01-6f3acffdd3c8","resourceVersion":"943","generation":1,"creationTimestamp":"2022-03-18T18:00:38Z","labels":{"app.kubernetes.io/component":"rabbitmq","app.kubernetes.io/name":"rabbitmq-cluster","app.kubernetes.io/part-of":"rabbitmq"},"annotations":{"rabbitmq.com/createdAt":"2022-03-18T18:00:38Z"},"ownerReferences":[{"apiVersion":"rabbitmq.com/v1beta1","kind":"RabbitmqCluster","name":"rabbitmq-cluster","uid":"18d9928b-0d1c-47be-80ec-20960d053827","controller":true,"blockOwnerDeletion":true}],"managedFields":[{"manager":"manager","operation":"Update","apiVersion":"apps/v1","time":"2022-03-18T18:00:38Z","fieldsType":"FieldsV1","fieldsV1":{"f:metadata":{"f:annotations":{".":{},"f:rabbitmq.com/createdAt":{}},"f:labels":{".":{},"f:app.kubernetes.io/component":{},"f:app.kubernetes.io/name":{},"f:app.kubernetes.io/part-of":{}},"f:ownerReferences":{".":{},"k:{\"uid\":\"18d9928b-0d1c-47be-80ec-20960d053827\"}":{".":{},"f:apiVersion":{},"f:blockOwnerDeletion":{},"f:controller":{},"f:kind":{},"f:name":{},"f:uid":{}}}},"f:spec":{"f:podManagementPolicy":{},"f:replicas":{},"f:revisionHistoryLimit":{},"f:selector":{"f:matchLabels":{".":{},"f:app.kubernetes.io/name":{}}},"f:serviceName":{},"f:template":{"f:metadata":{"f:annotations":{".":{},"f:prometheus.io/port":{},"f:prometheus.io/scrape":{}},"f:labels":{".":{},"f:app.kubernetes.io/component":{},"f:app.kubernetes.io/name":{},"f:app.kubernetes.io/part-of":{}}},"f:spec":{"f:automountServiceAccountToken":{},"f:containers":{"k:{\"name\":\"rabbitmq\"}":{".":{},"f:env":{".":{},"k:{\"name\":\"K8S_HOSTNAME_SUFFIX\"}":{".":{},"f:name":{},"f:value":{}},"k:{\"name\":\"K8S_SERVICE_NAME\"}":{".":{},"f:name":{},"f:value":{}},"k:{\"name\":\"MY_POD_NAME\"}":{".":{},"f:name":{},"f:valueFrom":{".":{},"f:fieldRef":{".":{},"f:apiVersion":{},"f:fieldPath":{}}}},"k:{\"name\":\"MY_POD_NAMESPACE\"}":{".":{},"f:name":{},"f:valueFrom":{".":{},"f:fieldRef":{".":{},"f:apiVersion":{},"f:fieldPath":{}}}},"k:{\"name\":\"RABBITMQ_ENABLED_PLUGINS_FILE\"}":{".":{},"f:name":{},"f:value":{}},"k:{\"name\":\"RABBITMQ_NODENAME\"}":{".":{},"f:name":{},"f:value":{}},"k:{\"name\":\"RABBITMQ_USE_LONGNAME\"}":{".":{},"f:name":{},"f:value":{}}},"f:image":{},"f:imagePullPolicy":{},"f:lifecycle":{".":{},"f:preStop":{".":{},"f:exec":{".":{},"f:command":{}}}},"f:name":{},"f:ports":{".":{},"k:{\"containerPort\":4369,\"protocol\":\"TCP\"}":{".":{},"f:containerPort":{},"f:name":{},"f:protocol":{}},"k:{\"containerPort\":5672,\"protocol\":\"TCP\"}":{".":{},"f:containerPort":{},"f:name":{},"f:protocol":{}},"k:{\"containerPort\":15672,\"protocol\":\"TCP\"}":{".":{},"f:containerPort":{},"f:name":{},"f:protocol":{}},"k:{\"containerPort\":15692,\"protocol\":\"TCP\"}":{".":{},"f:containerPort":{},"f:name":{},"f:protocol":{}}},"f:readinessProbe":{".":{},"f:failureThreshold":{},"f:initialDelaySeconds":{},"f:periodSeconds":{},"f:successThreshold":{},"f:tcpSocket":{".":{},"f:port":{}},"f:timeoutSeconds":{}},"f:resources":{".":{},"f:limits":{".":{},"f:cpu":{},"f:memory":{}},"f:requests":{".":{},"f:cpu":{},"f:memory":{}}},"f:terminationMessagePath":{},"f:terminationMessagePolicy":{},"f:volumeMounts":{".":{},"k:{\"mountPath\":\"/etc/pod-info/\"}":{".":{},"f:mountPath":{},"f:name":{}},"k:{\"mountPath\":\"/etc/rabbitmq/conf.d/10-operatorDefaults.conf\"}":{".":{},"f:mountPath":{},"f:name":{},"f:subPath":{}},"k:{\"mountPath\":\"/etc/rabbitmq/conf.d/11-default_user.conf\"}":{".":{},"f:mountPath":{},"f:name":{},"f:subPath":{}},"k:{\"mountPath\":\"/etc/rabbitmq/conf.d/90-userDefinedConfiguration.conf\"}":{".":{},"f:mountPath":{},"f:name":{},"f:subPath":{}},"k:{\"mountPath\":\"/operator\"}":{".":{},"f:mountPath":{},"f:name":{}},"k:{\"mountPath\":\"/var/lib/rabbitmq/\"}":{".":{},"f:mountPath":{},"f:name":{}},"k:{\"mountPath\":\"/var/lib/rabbitmq/mnesia/\"}":{".":{},"f:mountPath":{},"f:name":{}}}}},"f:dnsPolicy":{},"f:initContainers":{".":{},"k:{\"name\":\"setup-container\"}":{".":{},"f:command":{},"f:image":{},"f:imagePullPolicy":{},"f:name":{},"f:resources":{".":{},"f:limits":{".":{},"f:cpu":{},"f:memory":{}},"f:requests":{".":{},"f:cpu":{},"f:memory":{}}},"f:securityContext":{".":{},"f:capabilities":{".":{},"f:drop":{}},"f:runAsUser":{}},"f:terminationMessagePath":{},"f:terminationMessagePolicy":{},"f:volumeMounts":{".":{},"k:{\"mountPath\":\"/operator\"}":{".":{},"f:mountPath":{},"f:name":{}},"k:{\"mountPath\":\"/tmp/default_user.conf\"}":{".":{},"f:mountPath":{},"f:name":{},"f:subPath":{}},"k:{\"mountPath\":\"/tmp/erlang-cookie-secret/\"}":{".":{},"f:mountPath":{},"f:name":{}},"k:{\"mountPath\":\"/tmp/rabbitmq-plugins/\"}":{".":{},"f:mountPath":{},"f:name":{}},"k:{\"mountPath\":\"/var/lib/rabbitmq/\"}":{".":{},"f:mountPath":{},"f:name":{}},"k:{\"mountPath\":\"/var/lib/rabbitmq/mnesia/\"}":{".":{},"f:mountPath":{},"f:name":{}}}}},"f:restartPolicy":{},"f:schedulerName":{},"f:securityContext":{".":{},"f:fsGroup":{},"f:runAsGroup":{},"f:runAsUser":{}},"f:serviceAccount":{},"f:serviceAccountName":{},"f:terminationGracePeriodSeconds":{},"f:topologySpreadConstraints":{".":{},"k:{\"topologyKey\":\"topology.kubernetes.io/zone\",\"whenUnsatisfiable\":\"ScheduleAnyway\"}":{".":{},"f:labelSelector":{".":{},"f:matchLabels":{".":{},"f:app.kubernetes.io/name":{}}},"f:maxSkew":{},"f:topologyKey":{},"f:whenUnsatisfiable":{}}},"f:volumes":{".":{},"k:{\"name\":\"erlang-cookie-secret\"}":{".":{},"f:name":{},"f:secret":{".":{},"f:defaultMode":{},"f:secretName":{}}},"k:{\"name\":\"plugins-conf\"}":{".":{},"f:configMap":{".":{},"f:defaultMode":{},"f:name":{}},"f:name":{}},"k:{\"name\":\"pod-info\"}":{".":{},"f:downwardAPI":{".":{},"f:defaultMode":{},"f:items":{}},"f:name":{}},"k:{\"name\":\"rabbitmq-confd\"}":{".":{},"f:name":{},"f:projected":{".":{},"f:defaultMode":{},"f:sources":{}}},"k:{\"name\":\"rabbitmq-erlang-cookie\"}":{".":{},"f:emptyDir":{},"f:name":{}},"k:{\"name\":\"rabbitmq-plugins\"}":{".":{},"f:emptyDir":{},"f:name":{}}}}},"f:updateStrategy":{"f:rollingUpdate":{".":{},"f:partition":{}},"f:type":{}},"f:volumeClaimTemplates":{}}}},{"manager":"kube-controller-manager","operation":"Update","apiVersion":"apps/v1","time":"2022-03-18T18:01:17Z","fieldsType":"FieldsV1","fieldsV1":{"f:status":{"f:collisionCount":{},"f:currentReplicas":{},"f:currentRevision":{},"f:observedGeneration":{},"f:readyReplicas":{},"f:replicas":{},"f:updateRevision":{},"f:updatedReplicas":{}}}}]},"spec":{"replicas":1,"selector":{"matchLabels":{"app.kubernetes.io/name":"rabbitmq-cluster"}},"template":{"metadata":{"creationTimestamp":null,"labels":{"app.kubernetes.io/component":"rabbitmq","app.kubernetes.io/name":"rabbitmq-cluster","app.kubernetes.io/part-of":"rabbitmq"},"annotations":{"prometheus.io/port":"15692","prometheus.io/scrape":"true"}},"spec":{"volumes":[{"name":"plugins-conf","configMap":{"name":"rabbitmq-cluster-plugins-conf","defaultMode":420}},{"name":"rabbitmq-confd","projected":{"sources":[{"secret":{"name":"rabbitmq-cluster-default-user","items":[{"key":"default_user.conf","path":"default_user.conf"}]}},{"configMap":{"name":"rabbitmq-cluster-server-conf","items":[{"key":"operatorDefaults.conf","path":"operatorDefaults.conf"},{"key":"userDefinedConfiguration.conf","path":"userDefinedConfiguration.conf"}]}}],"defaultMode":420}},{"name":"rabbitmq-erlang-cookie","emptyDir":{}},{"name":"erlang-cookie-secret","secret":{"secretName":"rabbitmq-cluster-erlang-cookie","defaultMode":420}},{"name":"rabbitmq-plugins","emptyDir":{}},{"name":"pod-info","downwardAPI":{"items":[{"path":"skipPreStopChecks","fieldRef":{"apiVersion":"v1","fieldPath":"metadata.labels['skipPreStopChecks']"}}],"defaultMode":420}}],"initContainers":[{"name":"setup-container","image":"rabbitmq:3.8.12-management","command":["sh","-c","cp /tmp/erlang-cookie-secret/.erlang.cookie /var/lib/rabbitmq/.erlang.cookie \u0026\u0026 chown 999:999 /var/lib/rabbitmq/.erlang.cookie \u0026\u0026 chmod 600 /var/lib/rabbitmq/.erlang.cookie ; cp /tmp/rabbitmq-plugins/enabled_plugins /operator/enabled_plugins \u0026\u0026 chown 999:999 /operator/enabled_plugins ; chown 999:999 /var/lib/rabbitmq/mnesia/ ; echo '[default]' \u003e /var/lib/rabbitmq/.rabbitmqadmin.conf \u0026\u0026 sed -e 's/default_user/username/' -e 's/default_pass/password/' /tmp/default_user.conf \u003e\u003e /var/lib/rabbitmq/.rabbitmqadmin.conf \u0026\u0026 chown 999:999 /var/lib/rabbitmq/.rabbitmqadmin.conf \u0026\u0026 chmod 600 /var/lib/rabbitmq/.rabbitmqadmin.conf"],"resources":{"limits":{"cpu":"100m","memory":"500Mi"},"requests":{"cpu":"100m","memory":"500Mi"}},"volumeMounts":[{"name":"plugins-conf","mountPath":"/tmp/rabbitmq-plugins/"},{"name":"rabbitmq-erlang-cookie","mountPath":"/var/lib/rabbitmq/"},{"name":"erlang-cookie-secret","mountPath":"/tmp/erlang-cookie-secret/"},{"name":"rabbitmq-plugins","mountPath":"/operator"},{"name":"persistence","mountPath":"/var/lib/rabbitmq/mnesia/"},{"name":"rabbitmq-confd","mountPath":"/tmp/default_user.conf","subPath":"default_user.conf"}],"terminationMessagePath":"/dev/termination-log","terminationMessagePolicy":"File","imagePullPolicy":"IfNotPresent","securityContext":{"capabilities":{"drop":["FSETID","KILL","SETGID","SETUID","SETPCAP","NET_BIND_SERVICE","NET_RAW","SYS_CHROOT","MKNOD","AUDIT_WRITE","SETFCAP"]},"runAsUser":0}}],"containers":[{"name":"rabbitmq","image":"rabbitmq:3.8.12-management","ports":[{"name":"epmd","containerPort":4369,"protocol":"TCP"},{"name":"amqp","containerPort":5672,"protocol":"TCP"},{"name":"management","containerPort":15672,"protocol":"TCP"},{"name":"prometheus","containerPort":15692,"protocol":"TCP"}],"env":[{"name":"MY_POD_NAME","valueFrom":{"fieldRef":{"apiVersion":"v1","fieldPath":"metadata.name"}}},{"name":"MY_POD_NAMESPACE","valueFrom":{"fieldRef":{"apiVersion":"v1","fieldPath":"metadata.namespace"}}},{"name":"RABBITMQ_ENABLED_PLUGINS_FILE","value":"/operator/enabled_plugins"},{"name":"K8S_SERVICE_NAME","value":"rabbitmq-cluster-nodes"},{"name":"RABBITMQ_USE_LONGNAME","value":"true"},{"name":"RABBITMQ_NODENAME","value":"rabbit@$(MY_POD_NAME).$(K8S_SERVICE_NAME).$(MY_POD_NAMESPACE)"},{"name":"K8S_HOSTNAME_SUFFIX","value":".$(K8S_SERVICE_NAME).$(MY_POD_NAMESPACE)"}],"resources":{"limits":{"cpu":"2","memory":"2Gi"},"requests":{"cpu":"1","memory":"2Gi"}},"volumeMounts":[{"name":"rabbitmq-erlang-cookie","mountPath":"/var/lib/rabbitmq/"},{"name":"persistence","mountPath":"/var/lib/rabbitmq/mnesia/"},{"name":"rabbitmq-plugins","mountPath":"/operator"},{"name":"rabbitmq-confd","mountPath":"/etc/rabbitmq/conf.d/10-operatorDefaults.conf","subPath":"operatorDefaults.conf"},{"name":"rabbitmq-confd","mountPath":"/etc/rabbitmq/conf.d/11-default_user.conf","subPath":"default_user.conf"},{"name":"rabbitmq-confd","mountPath":"/etc/rabbitmq/conf.d/90-userDefinedConfiguration.conf","subPath":"userDefinedConfiguration.conf"},{"name":"pod-info","mountPath":"/etc/pod-info/"}],"readinessProbe":{"tcpSocket":{"port":"amqp"},"initialDelaySeconds":10,"timeoutSeconds":5,"periodSeconds":10,"successThreshold":1,"failureThreshold":3},"lifecycle":{"preStop":{"exec":{"command":["/bin/bash","-c","if [ ! -z \"$(cat /etc/pod-info/skipPreStopChecks)\" ]; then exit 0; fi; rabbitmq-upgrade await_online_quorum_plus_one -t 604800; rabbitmq-upgrade await_online_synchronized_mirror -t 604800; rabbitmq-upgrade drain -t 604800"]}}},"terminationMessagePath":"/dev/termination-log","terminationMessagePolicy":"File","imagePullPolicy":"IfNotPresent"}],"restartPolicy":"Always","terminationGracePeriodSeconds":604800,"dnsPolicy":"ClusterFirst","serviceAccountName":"rabbitmq-cluster-server","serviceAccount":"rabbitmq-cluster-server","automountServiceAccountToken":true,"securityContext":{"runAsUser":999,"runAsGroup":999,"fsGroup":999},"schedulerName":"default-scheduler","topologySpreadConstraints":[{"maxSkew":1,"topologyKey":"topology.kubernetes.io/zone","whenUnsatisfiable":"ScheduleAnyway","labelSelector":{"matchLabels":{"app.kubernetes.io/name":"rabbitmq-cluster"}}}]}},"volumeClaimTemplates":[{"metadata":{"name":"persistence","namespace":"default","creationTimestamp":null,"labels":{"app.kubernetes.io/component":"rabbitmq","app.kubernetes.io/name":"rabbitmq-cluster","app.kubernetes.io/part-of":"rabbitmq"},"ownerReferences":[{"apiVersion":"rabbitmq.com/v1beta1","kind":"RabbitmqCluster","name":"rabbitmq-cluster","uid":"18d9928b-0d1c-47be-80ec-20960d053827","controller":true,"blockOwnerDeletion":false}]},"spec":{"accessModes":["ReadWriteOnce"],"resources":{"requests":{"storage":"10Gi"}},"volumeMode":"Filesystem"},"status":{"phase":"Pending"}}],"serviceName":"rabbitmq-cluster-nodes","podManagementPolicy":"Parallel","updateStrategy":{"type":"RollingUpdate","rollingUpdate":{"partition":0}},"revisionHistoryLimit":10},"status":{"observedGeneration":1,"replicas":1,"readyReplicas":1,"currentReplicas":1,"updatedReplicas":1,"currentRevision":"rabbitmq-cluster-server-5f8b8665fb","updateRevision":"rabbitmq-cluster-server-5f8b8665fb","collisionCount":0}}
2022/03/18 18:01:17 learn_server.go:291: [SIEVE-AFTER-READ]	Get	true	configmap	default	rabbitmq-cluster-plugins-conf	github.com/rabbitmq/cluster-operator/controllers.(*RabbitmqClusterReconciler)	NoError	{"kind":"ConfigMap","apiVersion":"v1","metadata":{"name":"rabbitmq-cluster-plugins-conf","namespace":"default","selfLink":"/api/v1/namespaces/default/configmaps/rabbitmq-cluster-plugins-conf","uid":"a164075b-0562-47ac-a577-99aa8651ec40","resourceVersion":"709","creationTimestamp":"2022-03-18T18:00:38Z","labels":{"app.kubernetes.io/component":"rabbitmq","app.kubernetes.io/name":"rabbitmq-cluster","app.kubernetes.io/part-of":"rabbitmq"},"ownerReferences":[{"apiVersion":"rabbitmq.com/v1beta1","kind":"RabbitmqCluster","name":"rabbitmq-cluster","uid":"18d9928b-0d1c-47be-80ec-20960d053827","controller":true,"blockOwnerDeletion":true}],"managedFields":[{"manager":"manager","operation":"Update","apiVersion":"v1","time":"2022-03-18T18:00:38Z","fieldsType":"FieldsV1","fieldsV1":{"f:data":{".":{},"f:enabled_plugins":{}},"f:metadata":{"f:labels":{".":{},"f:app.kubernetes.io/component":{},"f:app.kubernetes.io/name":{},"f:app.kubernetes.io/part-of":{}},"f:ownerReferences":{".":{},"k:{\"uid\":\"18d9928b-0d1c-47be-80ec-20960d053827\"}":{".":{},"f:apiVersion":{},"f:blockOwnerDeletion":{},"f:controller":{},"f:kind":{},"f:name":{},"f:uid":{}}}}}}]},"data":{"enabled_plugins":"[rabbitmq_peer_discovery_k8s,rabbitmq_prometheus,rabbitmq_management]."}}
2022/03/18 18:01:18 learn_server.go:256: [SIEVE-BEFORE-WRITE]	28
2022/03/18 18:01:18 learn_server.go:263: [SIEVE-AFTER-WRITE]	28	Update	statefulset	github.com/rabbitmq/cluster-operator/controllers.(*RabbitmqClusterReconciler)	NoError	{"metadata":{"name":"rabbitmq-cluster-server","namespace":"default","selfLink":"/apis/apps/v1/namespaces/default/statefulsets/rabbitmq-cluster-server","uid":"cb5c43bc-6ee7-481c-ab01-6f3acffdd3c8","resourceVersion":"948","generation":1,"creationTimestamp":"2022-03-18T18:00:38Z","labels":{"app.kubernetes.io/component":"rabbitmq","app.kubernetes.io/name":"rabbitmq-cluster","app.kubernetes.io/part-of":"rabbitmq"},"ownerReferences":[{"apiVersion":"rabbitmq.com/v1beta1","kind":"RabbitmqCluster","name":"rabbitmq-cluster","uid":"18d9928b-0d1c-47be-80ec-20960d053827","controller":true,"blockOwnerDeletion":true}],"managedFields":[{"manager":"manager","operation":"Update","apiVersion":"apps/v1","time":"2022-03-18T18:00:38Z","fieldsType":"FieldsV1","fieldsV1":{"f:metadata":{"f:labels":{".":{},"f:app.kubernetes.io/component":{},"f:app.kubernetes.io/name":{},"f:app.kubernetes.io/part-of":{}},"f:ownerReferences":{".":{},"k:{\"uid\":\"18d9928b-0d1c-47be-80ec-20960d053827\"}":{".":{},"f:apiVersion":{},"f:blockOwnerDeletion":{},"f:controller":{},"f:kind":{},"f:name":{},"f:uid":{}}}},"f:spec":{"f:podManagementPolicy":{},"f:replicas":{},"f:revisionHistoryLimit":{},"f:selector":{"f:matchLabels":{".":{},"f:app.kubernetes.io/name":{}}},"f:serviceName":{},"f:template":{"f:metadata":{"f:annotations":{".":{},"f:prometheus.io/port":{},"f:prometheus.io/scrape":{}},"f:labels":{".":{},"f:app.kubernetes.io/component":{},"f:app.kubernetes.io/name":{},"f:app.kubernetes.io/part-of":{}}},"f:spec":{"f:automountServiceAccountToken":{},"f:containers":{"k:{\"name\":\"rabbitmq\"}":{".":{},"f:env":{".":{},"k:{\"name\":\"K8S_HOSTNAME_SUFFIX\"}":{".":{},"f:name":{},"f:value":{}},"k:{\"name\":\"K8S_SERVICE_NAME\"}":{".":{},"f:name":{},"f:value":{}},"k:{\"name\":\"MY_POD_NAME\"}":{".":{},"f:name":{},"f:valueFrom":{".":{},"f:fieldRef":{".":{},"f:apiVersion":{},"f:fieldPath":{}}}},"k:{\"name\":\"MY_POD_NAMESPACE\"}":{".":{},"f:name":{},"f:valueFrom":{".":{},"f:fieldRef":{".":{},"f:apiVersion":{},"f:fieldPath":{}}}},"k:{\"name\":\"RABBITMQ_ENABLED_PLUGINS_FILE\"}":{".":{},"f:name":{},"f:value":{}},"k:{\"name\":\"RABBITMQ_NODENAME\"}":{".":{},"f:name":{},"f:value":{}},"k:{\"name\":\"RABBITMQ_USE_LONGNAME\"}":{".":{},"f:name":{},"f:value":{}}},"f:image":{},"f:imagePullPolicy":{},"f:lifecycle":{".":{},"f:preStop":{".":{},"f:exec":{".":{},"f:command":{}}}},"f:name":{},"f:ports":{".":{},"k:{\"containerPort\":4369,\"protocol\":\"TCP\"}":{".":{},"f:containerPort":{},"f:name":{},"f:protocol":{}},"k:{\"containerPort\":5672,\"protocol\":\"TCP\"}":{".":{},"f:containerPort":{},"f:name":{},"f:protocol":{}},"k:{\"containerPort\":15672,\"protocol\":\"TCP\"}":{".":{},"f:containerPort":{},"f:name":{},"f:protocol":{}},"k:{\"containerPort\":15692,\"protocol\":\"TCP\"}":{".":{},"f:containerPort":{},"f:name":{},"f:protocol":{}}},"f:readinessProbe":{".":{},"f:failureThreshold":{},"f:initialDelaySeconds":{},"f:periodSeconds":{},"f:successThreshold":{},"f:tcpSocket":{".":{},"f:port":{}},"f:timeoutSeconds":{}},"f:resources":{".":{},"f:limits":{".":{},"f:cpu":{},"f:memory":{}},"f:requests":{".":{},"f:cpu":{},"f:memory":{}}},"f:terminationMessagePath":{},"f:terminationMessagePolicy":{},"f:volumeMounts":{".":{},"k:{\"mountPath\":\"/etc/pod-info/\"}":{".":{},"f:mountPath":{},"f:name":{}},"k:{\"mountPath\":\"/etc/rabbitmq/conf.d/10-operatorDefaults.conf\"}":{".":{},"f:mountPath":{},"f:name":{},"f:subPath":{}},"k:{\"mountPath\":\"/etc/rabbitmq/conf.d/11-default_user.conf\"}":{".":{},"f:mountPath":{},"f:name":{},"f:subPath":{}},"k:{\"mountPath\":\"/etc/rabbitmq/conf.d/90-userDefinedConfiguration.conf\"}":{".":{},"f:mountPath":{},"f:name":{},"f:subPath":{}},"k:{\"mountPath\":\"/operator\"}":{".":{},"f:mountPath":{},"f:name":{}},"k:{\"mountPath\":\"/var/lib/rabbitmq/\"}":{".":{},"f:mountPath":{},"f:name":{}},"k:{\"mountPath\":\"/var/lib/rabbitmq/mnesia/\"}":{".":{},"f:mountPath":{},"f:name":{}}}}},"f:dnsPolicy":{},"f:initContainers":{".":{},"k:{\"name\":\"setup-container\"}":{".":{},"f:command":{},"f:image":{},"f:imagePullPolicy":{},"f:name":{},"f:resources":{".":{},"f:limits":{".":{},"f:cpu":{},"f:memory":{}},"f:requests":{".":{},"f:cpu":{},"f:memory":{}}},"f:securityContext":{".":{},"f:capabilities":{".":{},"f:drop":{}},"f:runAsUser":{}},"f:terminationMessagePath":{},"f:terminationMessagePolicy":{},"f:volumeMounts":{".":{},"k:{\"mountPath\":\"/operator\"}":{".":{},"f:mountPath":{},"f:name":{}},"k:{\"mountPath\":\"/tmp/default_user.conf\"}":{".":{},"f:mountPath":{},"f:name":{},"f:subPath":{}},"k:{\"mountPath\":\"/tmp/erlang-cookie-secret/\"}":{".":{},"f:mountPath":{},"f:name":{}},"k:{\"mountPath\":\"/tmp/rabbitmq-plugins/\"}":{".":{},"f:mountPath":{},"f:name":{}},"k:{\"mountPath\":\"/var/lib/rabbitmq/\"}":{".":{},"f:mountPath":{},"f:name":{}},"k:{\"mountPath\":\"/var/lib/rabbitmq/mnesia/\"}":{".":{},"f:mountPath":{},"f:name":{}}}}},"f:restartPolicy":{},"f:schedulerName":{},"f:securityContext":{".":{},"f:fsGroup":{},"f:runAsGroup":{},"f:runAsUser":{}},"f:serviceAccount":{},"f:serviceAccountName":{},"f:terminationGracePeriodSeconds":{},"f:topologySpreadConstraints":{".":{},"k:{\"topologyKey\":\"topology.kubernetes.io/zone\",\"whenUnsatisfiable\":\"ScheduleAnyway\"}":{".":{},"f:labelSelector":{".":{},"f:matchLabels":{".":{},"f:app.kubernetes.io/name":{}}},"f:maxSkew":{},"f:topologyKey":{},"f:whenUnsatisfiable":{}}},"f:volumes":{".":{},"k:{\"name\":\"erlang-cookie-secret\"}":{".":{},"f:name":{},"f:secret":{".":{},"f:defaultMode":{},"f:secretName":{}}},"k:{\"name\":\"plugins-conf\"}":{".":{},"f:configMap":{".":{},"f:defaultMode":{},"f:name":{}},"f:name":{}},"k:{\"name\":\"pod-info\"}":{".":{},"f:downwardAPI":{".":{},"f:defaultMode":{},"f:items":{}},"f:name":{}},"k:{\"name\":\"rabbitmq-confd\"}":{".":{},"f:name":{},"f:projected":{".":{},"f:defaultMode":{},"f:sources":{}}},"k:{\"name\":\"rabbitmq-erlang-cookie\"}":{".":{},"f:emptyDir":{},"f:name":{}},"k:{\"name\":\"rabbitmq-plugins\"}":{".":{},"f:emptyDir":{},"f:name":{}}}}},"f:updateStrategy":{"f:rollingUpdate":{".":{},"f:partition":{}},"f:type":{}},"f:volumeClaimTemplates":{}}}},{"manager":"kube-controller-manager","operation":"Update","apiVersion":"apps/v1","time":"2022-03-18T18:01:17Z","fieldsType":"FieldsV1","fieldsV1":{"f:status":{"f:collisionCount":{},"f:currentReplicas":{},"f:currentRevision":{},"f:observedGeneration":{},"f:readyReplicas":{},"f:replicas":{},"f:updateRevision":{},"f:updatedReplicas":{}}}}]},"spec":{"replicas":1,"selector":{"matchLabels":{"app.kubernetes.io/name":"rabbitmq-cluster"}},"template":{"metadata":{"creationTimestamp":null,"labels":{"app.kubernetes.io/component":"rabbitmq","app.kubernetes.io/name":"rabbitmq-cluster","app.kubernetes.io/part-of":"rabbitmq"},"annotations":{"prometheus.io/port":"15692","prometheus.io/scrape":"true"}},"spec":{"volumes":[{"name":"plugins-conf","configMap":{"name":"rabbitmq-cluster-plugins-conf","defaultMode":420}},{"name":"rabbitmq-confd","projected":{"sources":[{"secret":{"name":"rabbitmq-cluster-default-user","items":[{"key":"default_user.conf","path":"default_user.conf"}]}},{"configMap":{"name":"rabbitmq-cluster-server-conf","items":[{"key":"operatorDefaults.conf","path":"operatorDefaults.conf"},{"key":"userDefinedConfiguration.conf","path":"userDefinedConfiguration.conf"}]}}],"defaultMode":420}},{"name":"rabbitmq-erlang-cookie","emptyDir":{}},{"name":"erlang-cookie-secret","secret":{"secretName":"rabbitmq-cluster-erlang-cookie","defaultMode":420}},{"name":"rabbitmq-plugins","emptyDir":{}},{"name":"pod-info","downwardAPI":{"items":[{"path":"skipPreStopChecks","fieldRef":{"apiVersion":"v1","fieldPath":"metadata.labels['skipPreStopChecks']"}}],"defaultMode":420}}],"initContainers":[{"name":"setup-container","image":"rabbitmq:3.8.12-management","command":["sh","-c","cp /tmp/erlang-cookie-secret/.erlang.cookie /var/lib/rabbitmq/.erlang.cookie \u0026\u0026 chown 999:999 /var/lib/rabbitmq/.erlang.cookie \u0026\u0026 chmod 600 /var/lib/rabbitmq/.erlang.cookie ; cp /tmp/rabbitmq-plugins/enabled_plugins /operator/enabled_plugins \u0026\u0026 chown 999:999 /operator/enabled_plugins ; chown 999:999 /var/lib/rabbitmq/mnesia/ ; echo '[default]' \u003e /var/lib/rabbitmq/.rabbitmqadmin.conf \u0026\u0026 sed -e 's/default_user/username/' -e 's/default_pass/password/' /tmp/default_user.conf \u003e\u003e /var/lib/rabbitmq/.rabbitmqadmin.conf \u0026\u0026 chown 999:999 /var/lib/rabbitmq/.rabbitmqadmin.conf \u0026\u0026 chmod 600 /var/lib/rabbitmq/.rabbitmqadmin.conf"],"resources":{"limits":{"cpu":"100m","memory":"500Mi"},"requests":{"cpu":"100m","memory":"500Mi"}},"volumeMounts":[{"name":"plugins-conf","mountPath":"/tmp/rabbitmq-plugins/"},{"name":"rabbitmq-erlang-cookie","mountPath":"/var/lib/rabbitmq/"},{"name":"erlang-cookie-secret","mountPath":"/tmp/erlang-cookie-secret/"},{"name":"rabbitmq-plugins","mountPath":"/operator"},{"name":"persistence","mountPath":"/var/lib/rabbitmq/mnesia/"},{"name":"rabbitmq-confd","mountPath":"/tmp/default_user.conf","subPath":"default_user.conf"}],"terminationMessagePath":"/dev/termination-log","terminationMessagePolicy":"File","imagePullPolicy":"IfNotPresent","securityContext":{"capabilities":{"drop":["FSETID","KILL","SETGID","SETUID","SETPCAP","NET_BIND_SERVICE","NET_RAW","SYS_CHROOT","MKNOD","AUDIT_WRITE","SETFCAP"]},"runAsUser":0}}],"containers":[{"name":"rabbitmq","image":"rabbitmq:3.8.12-management","ports":[{"name":"epmd","containerPort":4369,"protocol":"TCP"},{"name":"amqp","containerPort":5672,"protocol":"TCP"},{"name":"management","containerPort":15672,"protocol":"TCP"},{"name":"prometheus","containerPort":15692,"protocol":"TCP"}],"env":[{"name":"MY_POD_NAME","valueFrom":{"fieldRef":{"apiVersion":"v1","fieldPath":"metadata.name"}}},{"name":"MY_POD_NAMESPACE","valueFrom":{"fieldRef":{"apiVersion":"v1","fieldPath":"metadata.namespace"}}},{"name":"RABBITMQ_ENABLED_PLUGINS_FILE","value":"/operator/enabled_plugins"},{"name":"K8S_SERVICE_NAME","value":"rabbitmq-cluster-nodes"},{"name":"RABBITMQ_USE_LONGNAME","value":"true"},{"name":"RABBITMQ_NODENAME","value":"rabbit@$(MY_POD_NAME).$(K8S_SERVICE_NAME).$(MY_POD_NAMESPACE)"},{"name":"K8S_HOSTNAME_SUFFIX","value":".$(K8S_SERVICE_NAME).$(MY_POD_NAMESPACE)"}],"resources":{"limits":{"cpu":"2","memory":"2Gi"},"requests":{"cpu":"1","memory":"2Gi"}},"volumeMounts":[{"name":"rabbitmq-erlang-cookie","mountPath":"/var/lib/rabbitmq/"},{"name":"persistence","mountPath":"/var/lib/rabbitmq/mnesia/"},{"name":"rabbitmq-plugins","mountPath":"/operator"},{"name":"rabbitmq-confd","mountPath":"/etc/rabbitmq/conf.d/10-operatorDefaults.conf","subPath":"operatorDefaults.conf"},{"name":"rabbitmq-confd","mountPath":"/etc/rabbitmq/conf.d/11-default_user.conf","subPath":"default_user.conf"},{"name":"rabbitmq-confd","mountPath":"/etc/rabbitmq/conf.d/90-userDefinedConfiguration.conf","subPath":"userDefinedConfiguration.conf"},{"name":"pod-info","mountPath":"/etc/pod-info/"}],"readinessProbe":{"tcpSocket":{"port":"amqp"},"initialDelaySeconds":10,"timeoutSeconds":5,"periodSeconds":10,"successThreshold":1,"failureThreshold":3},"lifecycle":{"preStop":{"exec":{"command":["/bin/bash","-c","if [ ! -z \"$(cat /etc/pod-info/skipPreStopChecks)\" ]; then exit 0; fi; rabbitmq-upgrade await_online_quorum_plus_one -t 604800; rabbitmq-upgrade await_online_synchronized_mirror -t 604800; rabbitmq-upgrade drain -t 604800"]}}},"terminationMessagePath":"/dev/termination-log","terminationMessagePolicy":"File","imagePullPolicy":"IfNotPresent"}],"restartPolicy":"Always","terminationGracePeriodSeconds":604800,"dnsPolicy":"ClusterFirst","serviceAccountName":"rabbitmq-cluster-server","serviceAccount":"rabbitmq-cluster-server","automountServiceAccountToken":true,"securityContext":{"runAsUser":999,"runAsGroup":999,"fsGroup":999},"schedulerName":"default-scheduler","topologySpreadConstraints":[{"maxSkew":1,"topologyKey":"topology.kubernetes.io/zone","whenUnsatisfiable":"ScheduleAnyway","labelSelector":{"matchLabels":{"app.kubernetes.io/name":"rabbitmq-cluster"}}}]}},"volumeClaimTemplates":[{"metadata":{"name":"persistence","namespace":"default","creationTimestamp":null,"labels":{"app.kubernetes.io/component":"rabbitmq","app.kubernetes.io/name":"rabbitmq-cluster","app.kubernetes.io/part-of":"rabbitmq"},"ownerReferences":[{"apiVersion":"rabbitmq.com/v1beta1","kind":"RabbitmqCluster","name":"rabbitmq-cluster","uid":"18d9928b-0d1c-47be-80ec-20960d053827","controller":true,"blockOwnerDeletion":false}]},"spec":{"accessModes":["ReadWriteOnce"],"resources":{"requests":{"storage":"10Gi"}},"volumeMode":"Filesystem"},"status":{"phase":"Pending"}}],"serviceName":"rabbitmq-cluster-nodes","podManagementPolicy":"Parallel","updateStrategy":{"type":"RollingUpdate","rollingUpdate":{"partition":0}},"revisionHistoryLimit":10},"status":{"observedGeneration":1,"replicas":1,"readyReplicas":1,"currentReplicas":1,"updatedReplicas":1,"currentRevision":"rabbitmq-cluster-server-5f8b8665fb","updateRevision":"rabbitmq-cluster-server-5f8b8665fb","collisionCount":0}}
2022/03/18 18:01:18 learn_server.go:256: [SIEVE-BEFORE-WRITE]	29
2022/03/18 18:01:18 learn_server.go:279: [SIEVE-BEFORE-HEAR]	20	Updated	statefulset	{"metadata":{"name":"rabbitmq-cluster-server","namespace":"default","selfLink":"/apis/apps/v1/namespaces/default/statefulsets/rabbitmq-cluster-server","uid":"cb5c43bc-6ee7-481c-ab01-6f3acffdd3c8","resourceVersion":"948","generation":1,"creationTimestamp":"2022-03-18T18:00:38Z","labels":{"app.kubernetes.io/component":"rabbitmq","app.kubernetes.io/name":"rabbitmq-cluster","app.kubernetes.io/part-of":"rabbitmq"},"ownerReferences":[{"apiVersion":"rabbitmq.com/v1beta1","kind":"RabbitmqCluster","name":"rabbitmq-cluster","uid":"18d9928b-0d1c-47be-80ec-20960d053827","controller":true,"blockOwnerDeletion":true}],"managedFields":[{"manager":"manager","operation":"Update","apiVersion":"apps/v1","time":"2022-03-18T18:00:38Z","fieldsType":"FieldsV1","fieldsV1":{"f:metadata":{"f:labels":{".":{},"f:app.kubernetes.io/component":{},"f:app.kubernetes.io/name":{},"f:app.kubernetes.io/part-of":{}},"f:ownerReferences":{".":{},"k:{\"uid\":\"18d9928b-0d1c-47be-80ec-20960d053827\"}":{".":{},"f:apiVersion":{},"f:blockOwnerDeletion":{},"f:controller":{},"f:kind":{},"f:name":{},"f:uid":{}}}},"f:spec":{"f:podManagementPolicy":{},"f:replicas":{},"f:revisionHistoryLimit":{},"f:selector":{"f:matchLabels":{".":{},"f:app.kubernetes.io/name":{}}},"f:serviceName":{},"f:template":{"f:metadata":{"f:annotations":{".":{},"f:prometheus.io/port":{},"f:prometheus.io/scrape":{}},"f:labels":{".":{},"f:app.kubernetes.io/component":{},"f:app.kubernetes.io/name":{},"f:app.kubernetes.io/part-of":{}}},"f:spec":{"f:automountServiceAccountToken":{},"f:containers":{"k:{\"name\":\"rabbitmq\"}":{".":{},"f:env":{".":{},"k:{\"name\":\"K8S_HOSTNAME_SUFFIX\"}":{".":{},"f:name":{},"f:value":{}},"k:{\"name\":\"K8S_SERVICE_NAME\"}":{".":{},"f:name":{},"f:value":{}},"k:{\"name\":\"MY_POD_NAME\"}":{".":{},"f:name":{},"f:valueFrom":{".":{},"f:fieldRef":{".":{},"f:apiVersion":{},"f:fieldPath":{}}}},"k:{\"name\":\"MY_POD_NAMESPACE\"}":{".":{},"f:name":{},"f:valueFrom":{".":{},"f:fieldRef":{".":{},"f:apiVersion":{},"f:fieldPath":{}}}},"k:{\"name\":\"RABBITMQ_ENABLED_PLUGINS_FILE\"}":{".":{},"f:name":{},"f:value":{}},"k:{\"name\":\"RABBITMQ_NODENAME\"}":{".":{},"f:name":{},"f:value":{}},"k:{\"name\":\"RABBITMQ_USE_LONGNAME\"}":{".":{},"f:name":{},"f:value":{}}},"f:image":{},"f:imagePullPolicy":{},"f:lifecycle":{".":{},"f:preStop":{".":{},"f:exec":{".":{},"f:command":{}}}},"f:name":{},"f:ports":{".":{},"k:{\"containerPort\":4369,\"protocol\":\"TCP\"}":{".":{},"f:containerPort":{},"f:name":{},"f:protocol":{}},"k:{\"containerPort\":5672,\"protocol\":\"TCP\"}":{".":{},"f:containerPort":{},"f:name":{},"f:protocol":{}},"k:{\"containerPort\":15672,\"protocol\":\"TCP\"}":{".":{},"f:containerPort":{},"f:name":{},"f:protocol":{}},"k:{\"containerPort\":15692,\"protocol\":\"TCP\"}":{".":{},"f:containerPort":{},"f:name":{},"f:protocol":{}}},"f:readinessProbe":{".":{},"f:failureThreshold":{},"f:initialDelaySeconds":{},"f:periodSeconds":{},"f:successThreshold":{},"f:tcpSocket":{".":{},"f:port":{}},"f:timeoutSeconds":{}},"f:resources":{".":{},"f:limits":{".":{},"f:cpu":{},"f:memory":{}},"f:requests":{".":{},"f:cpu":{},"f:memory":{}}},"f:terminationMessagePath":{},"f:terminationMessagePolicy":{},"f:volumeMounts":{".":{},"k:{\"mountPath\":\"/etc/pod-info/\"}":{".":{},"f:mountPath":{},"f:name":{}},"k:{\"mountPath\":\"/etc/rabbitmq/conf.d/10-operatorDefaults.conf\"}":{".":{},"f:mountPath":{},"f:name":{},"f:subPath":{}},"k:{\"mountPath\":\"/etc/rabbitmq/conf.d/11-default_user.conf\"}":{".":{},"f:mountPath":{},"f:name":{},"f:subPath":{}},"k:{\"mountPath\":\"/etc/rabbitmq/conf.d/90-userDefinedConfiguration.conf\"}":{".":{},"f:mountPath":{},"f:name":{},"f:subPath":{}},"k:{\"mountPath\":\"/operator\"}":{".":{},"f:mountPath":{},"f:name":{}},"k:{\"mountPath\":\"/var/lib/rabbitmq/\"}":{".":{},"f:mountPath":{},"f:name":{}},"k:{\"mountPath\":\"/var/lib/rabbitmq/mnesia/\"}":{".":{},"f:mountPath":{},"f:name":{}}}}},"f:dnsPolicy":{},"f:initContainers":{".":{},"k:{\"name\":\"setup-container\"}":{".":{},"f:command":{},"f:image":{},"f:imagePullPolicy":{},"f:name":{},"f:resources":{".":{},"f:limits":{".":{},"f:cpu":{},"f:memory":{}},"f:requests":{".":{},"f:cpu":{},"f:memory":{}}},"f:securityContext":{".":{},"f:capabilities":{".":{},"f:drop":{}},"f:runAsUser":{}},"f:terminationMessagePath":{},"f:terminationMessagePolicy":{},"f:volumeMounts":{".":{},"k:{\"mountPath\":\"/operator\"}":{".":{},"f:mountPath":{},"f:name":{}},"k:{\"mountPath\":\"/tmp/default_user.conf\"}":{".":{},"f:mountPath":{},"f:name":{},"f:subPath":{}},"k:{\"mountPath\":\"/tmp/erlang-cookie-secret/\"}":{".":{},"f:mountPath":{},"f:name":{}},"k:{\"mountPath\":\"/tmp/rabbitmq-plugins/\"}":{".":{},"f:mountPath":{},"f:name":{}},"k:{\"mountPath\":\"/var/lib/rabbitmq/\"}":{".":{},"f:mountPath":{},"f:name":{}},"k:{\"mountPath\":\"/var/lib/rabbitmq/mnesia/\"}":{".":{},"f:mountPath":{},"f:name":{}}}}},"f:restartPolicy":{},"f:schedulerName":{},"f:securityContext":{".":{},"f:fsGroup":{},"f:runAsGroup":{},"f:runAsUser":{}},"f:serviceAccount":{},"f:serviceAccountName":{},"f:terminationGracePeriodSeconds":{},"f:topologySpreadConstraints":{".":{},"k:{\"topologyKey\":\"topology.kubernetes.io/zone\",\"whenUnsatisfiable\":\"ScheduleAnyway\"}":{".":{},"f:labelSelector":{".":{},"f:matchLabels":{".":{},"f:app.kubernetes.io/name":{}}},"f:maxSkew":{},"f:topologyKey":{},"f:whenUnsatisfiable":{}}},"f:volumes":{".":{},"k:{\"name\":\"erlang-cookie-secret\"}":{".":{},"f:name":{},"f:secret":{".":{},"f:defaultMode":{},"f:secretName":{}}},"k:{\"name\":\"plugins-conf\"}":{".":{},"f:configMap":{".":{},"f:defaultMode":{},"f:name":{}},"f:name":{}},"k:{\"name\":\"pod-info\"}":{".":{},"f:downwardAPI":{".":{},"f:defaultMode":{},"f:items":{}},"f:name":{}},"k:{\"name\":\"rabbitmq-confd\"}":{".":{},"f:name":{},"f:projected":{".":{},"f:defaultMode":{},"f:sources":{}}},"k:{\"name\":\"rabbitmq-erlang-cookie\"}":{".":{},"f:emptyDir":{},"f:name":{}},"k:{\"name\":\"rabbitmq-plugins\"}":{".":{},"f:emptyDir":{},"f:name":{}}}}},"f:updateStrategy":{"f:rollingUpdate":{".":{},"f:partition":{}},"f:type":{}},"f:volumeClaimTemplates":{}}}},{"manager":"kube-controller-manager","operation":"Update","apiVersion":"apps/v1","time":"2022-03-18T18:01:17Z","fieldsType":"FieldsV1","fieldsV1":{"f:status":{"f:collisionCount":{},"f:currentReplicas":{},"f:currentRevision":{},"f:observedGeneration":{},"f:readyReplicas":{},"f:replicas":{},"f:updateRevision":{},"f:updatedReplicas":{}}}}]},"spec":{"replicas":1,"selector":{"matchLabels":{"app.kubernetes.io/name":"rabbitmq-cluster"}},"template":{"metadata":{"creationTimestamp":null,"labels":{"app.kubernetes.io/component":"rabbitmq","app.kubernetes.io/name":"rabbitmq-cluster","app.kubernetes.io/part-of":"rabbitmq"},"annotations":{"prometheus.io/port":"15692","prometheus.io/scrape":"true"}},"spec":{"volumes":[{"name":"plugins-conf","configMap":{"name":"rabbitmq-cluster-plugins-conf","defaultMode":420}},{"name":"rabbitmq-confd","projected":{"sources":[{"secret":{"name":"rabbitmq-cluster-default-user","items":[{"key":"default_user.conf","path":"default_user.conf"}]}},{"configMap":{"name":"rabbitmq-cluster-server-conf","items":[{"key":"operatorDefaults.conf","path":"operatorDefaults.conf"},{"key":"userDefinedConfiguration.conf","path":"userDefinedConfiguration.conf"}]}}],"defaultMode":420}},{"name":"rabbitmq-erlang-cookie","emptyDir":{}},{"name":"erlang-cookie-secret","secret":{"secretName":"rabbitmq-cluster-erlang-cookie","defaultMode":420}},{"name":"rabbitmq-plugins","emptyDir":{}},{"name":"pod-info","downwardAPI":{"items":[{"path":"skipPreStopChecks","fieldRef":{"apiVersion":"v1","fieldPath":"metadata.labels['skipPreStopChecks']"}}],"defaultMode":420}}],"initContainers":[{"name":"setup-container","image":"rabbitmq:3.8.12-management","command":["sh","-c","cp /tmp/erlang-cookie-secret/.erlang.cookie /var/lib/rabbitmq/.erlang.cookie \u0026\u0026 chown 999:999 /var/lib/rabbitmq/.erlang.cookie \u0026\u0026 chmod 600 /var/lib/rabbitmq/.erlang.cookie ; cp /tmp/rabbitmq-plugins/enabled_plugins /operator/enabled_plugins \u0026\u0026 chown 999:999 /operator/enabled_plugins ; chown 999:999 /var/lib/rabbitmq/mnesia/ ; echo '[default]' \u003e /var/lib/rabbitmq/.rabbitmqadmin.conf \u0026\u0026 sed -e 's/default_user/username/' -e 's/default_pass/password/' /tmp/default_user.conf \u003e\u003e /var/lib/rabbitmq/.rabbitmqadmin.conf \u0026\u0026 chown 999:999 /var/lib/rabbitmq/.rabbitmqadmin.conf \u0026\u0026 chmod 600 /var/lib/rabbitmq/.rabbitmqadmin.conf"],"resources":{"limits":{"cpu":"100m","memory":"500Mi"},"requests":{"cpu":"100m","memory":"500Mi"}},"volumeMounts":[{"name":"plugins-conf","mountPath":"/tmp/rabbitmq-plugins/"},{"name":"rabbitmq-erlang-cookie","mountPath":"/var/lib/rabbitmq/"},{"name":"erlang-cookie-secret","mountPath":"/tmp/erlang-cookie-secret/"},{"name":"rabbitmq-plugins","mountPath":"/operator"},{"name":"persistence","mountPath":"/var/lib/rabbitmq/mnesia/"},{"name":"rabbitmq-confd","mountPath":"/tmp/default_user.conf","subPath":"default_user.conf"}],"terminationMessagePath":"/dev/termination-log","terminationMessagePolicy":"File","imagePullPolicy":"IfNotPresent","securityContext":{"capabilities":{"drop":["FSETID","KILL","SETGID","SETUID","SETPCAP","NET_BIND_SERVICE","NET_RAW","SYS_CHROOT","MKNOD","AUDIT_WRITE","SETFCAP"]},"runAsUser":0}}],"containers":[{"name":"rabbitmq","image":"rabbitmq:3.8.12-management","ports":[{"name":"epmd","containerPort":4369,"protocol":"TCP"},{"name":"amqp","containerPort":5672,"protocol":"TCP"},{"name":"management","containerPort":15672,"protocol":"TCP"},{"name":"prometheus","containerPort":15692,"protocol":"TCP"}],"env":[{"name":"MY_POD_NAME","valueFrom":{"fieldRef":{"apiVersion":"v1","fieldPath":"metadata.name"}}},{"name":"MY_POD_NAMESPACE","valueFrom":{"fieldRef":{"apiVersion":"v1","fieldPath":"metadata.namespace"}}},{"name":"RABBITMQ_ENABLED_PLUGINS_FILE","value":"/operator/enabled_plugins"},{"name":"K8S_SERVICE_NAME","value":"rabbitmq-cluster-nodes"},{"name":"RABBITMQ_USE_LONGNAME","value":"true"},{"name":"RABBITMQ_NODENAME","value":"rabbit@$(MY_POD_NAME).$(K8S_SERVICE_NAME).$(MY_POD_NAMESPACE)"},{"name":"K8S_HOSTNAME_SUFFIX","value":".$(K8S_SERVICE_NAME).$(MY_POD_NAMESPACE)"}],"resources":{"limits":{"cpu":"2","memory":"2Gi"},"requests":{"cpu":"1","memory":"2Gi"}},"volumeMounts":[{"name":"rabbitmq-erlang-cookie","mountPath":"/var/lib/rabbitmq/"},{"name":"persistence","mountPath":"/var/lib/rabbitmq/mnesia/"},{"name":"rabbitmq-plugins","mountPath":"/operator"},{"name":"rabbitmq-confd","mountPath":"/etc/rabbitmq/conf.d/10-operatorDefaults.conf","subPath":"operatorDefaults.conf"},{"name":"rabbitmq-confd","mountPath":"/etc/rabbitmq/conf.d/11-default_user.conf","subPath":"default_user.conf"},{"name":"rabbitmq-confd","mountPath":"/etc/rabbitmq/conf.d/90-userDefinedConfiguration.conf","subPath":"userDefinedConfiguration.conf"},{"name":"pod-info","mountPath":"/etc/pod-info/"}],"readinessProbe":{"tcpSocket":{"port":"amqp"},"initialDelaySeconds":10,"timeoutSeconds":5,"periodSeconds":10,"successThreshold":1,"failureThreshold":3},"lifecycle":{"preStop":{"exec":{"command":["/bin/bash","-c","if [ ! -z \"$(cat /etc/pod-info/skipPreStopChecks)\" ]; then exit 0; fi; rabbitmq-upgrade await_online_quorum_plus_one -t 604800; rabbitmq-upgrade await_online_synchronized_mirror -t 604800; rabbitmq-upgrade drain -t 604800"]}}},"terminationMessagePath":"/dev/termination-log","terminationMessagePolicy":"File","imagePullPolicy":"IfNotPresent"}],"restartPolicy":"Always","terminationGracePeriodSeconds":604800,"dnsPolicy":"ClusterFirst","serviceAccountName":"rabbitmq-cluster-server","serviceAccount":"rabbitmq-cluster-server","automountServiceAccountToken":true,"securityContext":{"runAsUser":999,"runAsGroup":999,"fsGroup":999},"schedulerName":"default-scheduler","topologySpreadConstraints":[{"maxSkew":1,"topologyKey":"topology.kubernetes.io/zone","whenUnsatisfiable":"ScheduleAnyway","labelSelector":{"matchLabels":{"app.kubernetes.io/name":"rabbitmq-cluster"}}}]}},"volumeClaimTemplates":[{"metadata":{"name":"persistence","namespace":"default","creationTimestamp":null,"labels":{"app.kubernetes.io/component":"rabbitmq","app.kubernetes.io/name":"rabbitmq-cluster","app.kubernetes.io/part-of":"rabbitmq"},"ownerReferences":[{"apiVersion":"rabbitmq.com/v1beta1","kind":"RabbitmqCluster","name":"rabbitmq-cluster","uid":"18d9928b-0d1c-47be-80ec-20960d053827","controller":true,"blockOwnerDeletion":false}]},"spec":{"accessModes":["ReadWriteOnce"],"resources":{"requests":{"storage":"10Gi"}},"volumeMode":"Filesystem"},"status":{"phase":"Pending"}}],"serviceName":"rabbitmq-cluster-nodes","podManagementPolicy":"Parallel","updateStrategy":{"type":"RollingUpdate","rollingUpdate":{"partition":0}},"revisionHistoryLimit":10},"status":{"observedGeneration":1,"replicas":1,"readyReplicas":1,"currentReplicas":1,"updatedReplicas":1,"currentRevision":"rabbitmq-cluster-server-5f8b8665fb","updateRevision":"rabbitmq-cluster-server-5f8b8665fb","collisionCount":0}}
2022/03/18 18:01:18 learn_server.go:289: [SIEVE-AFTER-HEAR]	20
2022/03/18 18:01:18 learn_server.go:263: [SIEVE-AFTER-WRITE]	29	StatusUpdate	rabbitmqcluster	github.com/rabbitmq/cluster-operator/controllers.(*RabbitmqClusterReconciler)	NoError	{"metadata":{"name":"rabbitmq-cluster","namespace":"default","selfLink":"/apis/rabbitmq.com/v1beta1/namespaces/default/rabbitmqclusters/rabbitmq-cluster/status","uid":"18d9928b-0d1c-47be-80ec-20960d053827","resourceVersion":"949","generation":2,"creationTimestamp":"2022-03-18T18:00:38Z","annotations":{"kubectl.kubernetes.io/last-applied-configuration":"{\"apiVersion\":\"rabbitmq.com/v1beta1\",\"kind\":\"RabbitmqCluster\",\"metadata\":{\"annotations\":{},\"name\":\"rabbitmq-cluster\",\"namespace\":\"default\"},\"spec\":{\"persistence\":{\"storage\":\"10Gi\"},\"replicas\":1}}\n"},"finalizers":["deletion.finalizers.rabbitmqclusters.rabbitmq.com"],"managedFields":[{"manager":"kubectl-client-side-apply","operation":"Update","apiVersion":"rabbitmq.com/v1beta1","time":"2022-03-18T18:00:38Z","fieldsType":"FieldsV1","fieldsV1":{"f:metadata":{"f:annotations":{".":{},"f:kubectl.kubernetes.io/last-applied-configuration":{}}},"f:spec":{".":{},"f:image":{},"f:persistence":{".":{},"f:storage":{}},"f:replicas":{},"f:resources":{".":{},"f:limits":{".":{},"f:memory":{}},"f:requests":{".":{},"f:memory":{}}},"f:service":{".":{},"f:type":{}},"f:terminationGracePeriodSeconds":{}}}},{"manager":"manager","operation":"Update","apiVersion":"rabbitmq.com/v1beta1","time":"2022-03-18T18:01:18Z","fieldsType":"FieldsV1","fieldsV1":{"f:metadata":{"f:finalizers":{}},"f:spec":{"f:override":{},"f:rabbitmq":{},"f:resources":{"f:limits":{"f:cpu":{}},"f:requests":{"f:cpu":{}}},"f:tls":{}},"f:status":{".":{},"f:conditions":{},"f:defaultUser":{".":{},"f:secretReference":{".":{},"f:keys":{".":{},"f:password":{},"f:username":{}},"f:name":{},"f:namespace":{}},"f:serviceReference":{".":{},"f:name":{},"f:namespace":{}}}}}}]},"spec":{"replicas":1,"image":"rabbitmq:3.8.12-management","service":{"type":"ClusterIP"},"persistence":{"storage":"10Gi"},"resources":{"limits":{"cpu":"2","memory":"2Gi"},"requests":{"cpu":"1","memory":"2Gi"}},"rabbitmq":{},"tls":{},"override":{},"terminationGracePeriodSeconds":604800},"status":{"conditions":[{"type":"AllReplicasReady","status":"True","lastTransitionTime":"2022-03-18T18:01:17Z","reason":"AllPodsAreReady"},{"type":"ClusterAvailable","status":"True","lastTransitionTime":"2022-03-18T18:01:17Z","reason":"AtLeastOneEndpointAvailable"},{"type":"NoWarnings","status":"True","lastTransitionTime":"2022-03-18T18:00:38Z","reason":"NoWarnings"},{"type":"ReconcileSuccess","status":"True","lastTransitionTime":"2022-03-18T18:01:18Z","reason":"Success","message":"Finish reconciling"}],"defaultUser":{"secretReference":{"name":"rabbitmq-cluster-default-user","namespace":"default","keys":{"password":"password","username":"username"}},"serviceReference":{"name":"rabbitmq-cluster","namespace":"default"}},"binding":{"name":"rabbitmq-cluster-default-user"}}}
2022/03/18 18:01:18 learn_server.go:253: [SIEVE-AFTER-RECONCILE]	github.com/rabbitmq/cluster-operator/controllers.(*RabbitmqClusterReconciler)	5
2022/03/18 18:01:18 learn_server.go:238: [SIEVE-BEFORE-RECONCILE]	github.com/rabbitmq/cluster-operator/controllers.(*RabbitmqClusterReconciler)	6
2022/03/18 18:01:18 learn_server.go:291: [SIEVE-AFTER-READ]	Get	true	rabbitmqcluster	default	rabbitmq-cluster	github.com/rabbitmq/cluster-operator/controllers.(*RabbitmqClusterReconciler)	NoError	{"kind":"RabbitmqCluster","apiVersion":"rabbitmq.com/v1beta1","metadata":{"name":"rabbitmq-cluster","namespace":"default","selfLink":"/apis/rabbitmq.com/v1beta1/namespaces/default/rabbitmqclusters/rabbitmq-cluster","uid":"18d9928b-0d1c-47be-80ec-20960d053827","resourceVersion":"944","generation":2,"creationTimestamp":"2022-03-18T18:00:38Z","annotations":{"kubectl.kubernetes.io/last-applied-configuration":"{\"apiVersion\":\"rabbitmq.com/v1beta1\",\"kind\":\"RabbitmqCluster\",\"metadata\":{\"annotations\":{},\"name\":\"rabbitmq-cluster\",\"namespace\":\"default\"},\"spec\":{\"persistence\":{\"storage\":\"10Gi\"},\"replicas\":1}}\n"},"finalizers":["deletion.finalizers.rabbitmqclusters.rabbitmq.com"],"managedFields":[{"manager":"kubectl-client-side-apply","operation":"Update","apiVersion":"rabbitmq.com/v1beta1","time":"2022-03-18T18:00:38Z","fieldsType":"FieldsV1","fieldsV1":{"f:metadata":{"f:annotations":{".":{},"f:kubectl.kubernetes.io/last-applied-configuration":{}}},"f:spec":{".":{},"f:image":{},"f:persistence":{".":{},"f:storage":{}},"f:replicas":{},"f:resources":{".":{},"f:limits":{".":{},"f:memory":{}},"f:requests":{".":{},"f:memory":{}}},"f:service":{".":{},"f:type":{}},"f:terminationGracePeriodSeconds":{}}}},{"manager":"manager","operation":"Update","apiVersion":"rabbitmq.com/v1beta1","time":"2022-03-18T18:01:17Z","fieldsType":"FieldsV1","fieldsV1":{"f:metadata":{"f:finalizers":{}},"f:spec":{"f:override":{},"f:rabbitmq":{},"f:resources":{"f:limits":{"f:cpu":{}},"f:requests":{"f:cpu":{}}},"f:tls":{}},"f:status":{".":{},"f:conditions":{},"f:defaultUser":{".":{},"f:secretReference":{".":{},"f:keys":{".":{},"f:password":{},"f:username":{}},"f:name":{},"f:namespace":{}},"f:serviceReference":{".":{},"f:name":{},"f:namespace":{}}}}}}]},"spec":{"replicas":1,"image":"rabbitmq:3.8.12-management","service":{"type":"ClusterIP"},"persistence":{"storage":"10Gi"},"resources":{"limits":{"cpu":"2","memory":"2Gi"},"requests":{"cpu":"1","memory":"2Gi"}},"rabbitmq":{},"tls":{},"override":{},"terminationGracePeriodSeconds":604800},"status":{"conditions":[{"type":"AllReplicasReady","status":"True","lastTransitionTime":"2022-03-18T18:01:17Z","reason":"AllPodsAreReady"},{"type":"ClusterAvailable","status":"True","lastTransitionTime":"2022-03-18T18:01:17Z","reason":"AtLeastOneEndpointAvailable"},{"type":"NoWarnings","status":"True","lastTransitionTime":"2022-03-18T18:00:38Z","reason":"NoWarnings"},{"type":"ReconcileSuccess","status":"Unknown","lastTransitionTime":"2022-03-18T18:00:38Z","reason":"Initialising"}],"defaultUser":{"secretReference":{"name":"rabbitmq-cluster-default-user","namespace":"default","keys":{"password":"password","username":"username"}},"serviceReference":{"name":"rabbitmq-cluster","namespace":"default"}}}}
2022/03/18 18:01:18 learn_server.go:279: [SIEVE-BEFORE-HEAR]	21	Updated	rabbitmqcluster	{"metadata":{"name":"rabbitmq-cluster","namespace":"default","selfLink":"/apis/rabbitmq.com/v1beta1/namespaces/default/rabbitmqclusters/rabbitmq-cluster","uid":"18d9928b-0d1c-47be-80ec-20960d053827","resourceVersion":"949","generation":2,"creationTimestamp":"2022-03-18T18:00:38Z","annotations":{"kubectl.kubernetes.io/last-applied-configuration":"{\"apiVersion\":\"rabbitmq.com/v1beta1\",\"kind\":\"RabbitmqCluster\",\"metadata\":{\"annotations\":{},\"name\":\"rabbitmq-cluster\",\"namespace\":\"default\"},\"spec\":{\"persistence\":{\"storage\":\"10Gi\"},\"replicas\":1}}\n"},"finalizers":["deletion.finalizers.rabbitmqclusters.rabbitmq.com"],"managedFields":[{"manager":"kubectl-client-side-apply","operation":"Update","apiVersion":"rabbitmq.com/v1beta1","time":"2022-03-18T18:00:38Z","fieldsType":"FieldsV1","fieldsV1":{"f:metadata":{"f:annotations":{".":{},"f:kubectl.kubernetes.io/last-applied-configuration":{}}},"f:spec":{".":{},"f:image":{},"f:persistence":{".":{},"f:storage":{}},"f:replicas":{},"f:resources":{".":{},"f:limits":{".":{},"f:memory":{}},"f:requests":{".":{},"f:memory":{}}},"f:service":{".":{},"f:type":{}},"f:terminationGracePeriodSeconds":{}}}},{"manager":"manager","operation":"Update","apiVersion":"rabbitmq.com/v1beta1","time":"2022-03-18T18:01:18Z","fieldsType":"FieldsV1","fieldsV1":{"f:metadata":{"f:finalizers":{}},"f:spec":{"f:override":{},"f:rabbitmq":{},"f:resources":{"f:limits":{"f:cpu":{}},"f:requests":{"f:cpu":{}}},"f:tls":{}},"f:status":{".":{},"f:conditions":{},"f:defaultUser":{".":{},"f:secretReference":{".":{},"f:keys":{".":{},"f:password":{},"f:username":{}},"f:name":{},"f:namespace":{}},"f:serviceReference":{".":{},"f:name":{},"f:namespace":{}}}}}}]},"spec":{"replicas":1,"image":"rabbitmq:3.8.12-management","service":{"type":"ClusterIP"},"persistence":{"storage":"10Gi"},"resources":{"limits":{"cpu":"2","memory":"2Gi"},"requests":{"cpu":"1","memory":"2Gi"}},"rabbitmq":{},"tls":{},"override":{},"terminationGracePeriodSeconds":604800},"status":{"conditions":[{"type":"AllReplicasReady","status":"True","lastTransitionTime":"2022-03-18T18:01:17Z","reason":"AllPodsAreReady"},{"type":"ClusterAvailable","status":"True","lastTransitionTime":"2022-03-18T18:01:17Z","reason":"AtLeastOneEndpointAvailable"},{"type":"NoWarnings","status":"True","lastTransitionTime":"2022-03-18T18:00:38Z","reason":"NoWarnings"},{"type":"ReconcileSuccess","status":"True","lastTransitionTime":"2022-03-18T18:01:18Z","reason":"Success","message":"Finish reconciling"}],"defaultUser":{"secretReference":{"name":"rabbitmq-cluster-default-user","namespace":"default","keys":{"password":"password","username":"username"}},"serviceReference":{"name":"rabbitmq-cluster","namespace":"default"}}}}
2022/03/18 18:01:18 learn_server.go:289: [SIEVE-AFTER-HEAR]	21
2022/03/18 18:01:18 learn_server.go:291: [SIEVE-AFTER-READ]	Get	true	statefulset	default	rabbitmq-cluster-server	github.com/rabbitmq/cluster-operator/controllers.(*RabbitmqClusterReconciler)	NoError	{"kind":"StatefulSet","apiVersion":"apps/v1","metadata":{"name":"rabbitmq-cluster-server","namespace":"default","selfLink":"/apis/apps/v1/namespaces/default/statefulsets/rabbitmq-cluster-server","uid":"cb5c43bc-6ee7-481c-ab01-6f3acffdd3c8","resourceVersion":"948","generation":1,"creationTimestamp":"2022-03-18T18:00:38Z","labels":{"app.kubernetes.io/component":"rabbitmq","app.kubernetes.io/name":"rabbitmq-cluster","app.kubernetes.io/part-of":"rabbitmq"},"ownerReferences":[{"apiVersion":"rabbitmq.com/v1beta1","kind":"RabbitmqCluster","name":"rabbitmq-cluster","uid":"18d9928b-0d1c-47be-80ec-20960d053827","controller":true,"blockOwnerDeletion":true}],"managedFields":[{"manager":"manager","operation":"Update","apiVersion":"apps/v1","time":"2022-03-18T18:00:38Z","fieldsType":"FieldsV1","fieldsV1":{"f:metadata":{"f:labels":{".":{},"f:app.kubernetes.io/component":{},"f:app.kubernetes.io/name":{},"f:app.kubernetes.io/part-of":{}},"f:ownerReferences":{".":{},"k:{\"uid\":\"18d9928b-0d1c-47be-80ec-20960d053827\"}":{".":{},"f:apiVersion":{},"f:blockOwnerDeletion":{},"f:controller":{},"f:kind":{},"f:name":{},"f:uid":{}}}},"f:spec":{"f:podManagementPolicy":{},"f:replicas":{},"f:revisionHistoryLimit":{},"f:selector":{"f:matchLabels":{".":{},"f:app.kubernetes.io/name":{}}},"f:serviceName":{},"f:template":{"f:metadata":{"f:annotations":{".":{},"f:prometheus.io/port":{},"f:prometheus.io/scrape":{}},"f:labels":{".":{},"f:app.kubernetes.io/component":{},"f:app.kubernetes.io/name":{},"f:app.kubernetes.io/part-of":{}}},"f:spec":{"f:automountServiceAccountToken":{},"f:containers":{"k:{\"name\":\"rabbitmq\"}":{".":{},"f:env":{".":{},"k:{\"name\":\"K8S_HOSTNAME_SUFFIX\"}":{".":{},"f:name":{},"f:value":{}},"k:{\"name\":\"K8S_SERVICE_NAME\"}":{".":{},"f:name":{},"f:value":{}},"k:{\"name\":\"MY_POD_NAME\"}":{".":{},"f:name":{},"f:valueFrom":{".":{},"f:fieldRef":{".":{},"f:apiVersion":{},"f:fieldPath":{}}}},"k:{\"name\":\"MY_POD_NAMESPACE\"}":{".":{},"f:name":{},"f:valueFrom":{".":{},"f:fieldRef":{".":{},"f:apiVersion":{},"f:fieldPath":{}}}},"k:{\"name\":\"RABBITMQ_ENABLED_PLUGINS_FILE\"}":{".":{},"f:name":{},"f:value":{}},"k:{\"name\":\"RABBITMQ_NODENAME\"}":{".":{},"f:name":{},"f:value":{}},"k:{\"name\":\"RABBITMQ_USE_LONGNAME\"}":{".":{},"f:name":{},"f:value":{}}},"f:image":{},"f:imagePullPolicy":{},"f:lifecycle":{".":{},"f:preStop":{".":{},"f:exec":{".":{},"f:command":{}}}},"f:name":{},"f:ports":{".":{},"k:{\"containerPort\":4369,\"protocol\":\"TCP\"}":{".":{},"f:containerPort":{},"f:name":{},"f:protocol":{}},"k:{\"containerPort\":5672,\"protocol\":\"TCP\"}":{".":{},"f:containerPort":{},"f:name":{},"f:protocol":{}},"k:{\"containerPort\":15672,\"protocol\":\"TCP\"}":{".":{},"f:containerPort":{},"f:name":{},"f:protocol":{}},"k:{\"containerPort\":15692,\"protocol\":\"TCP\"}":{".":{},"f:containerPort":{},"f:name":{},"f:protocol":{}}},"f:readinessProbe":{".":{},"f:failureThreshold":{},"f:initialDelaySeconds":{},"f:periodSeconds":{},"f:successThreshold":{},"f:tcpSocket":{".":{},"f:port":{}},"f:timeoutSeconds":{}},"f:resources":{".":{},"f:limits":{".":{},"f:cpu":{},"f:memory":{}},"f:requests":{".":{},"f:cpu":{},"f:memory":{}}},"f:terminationMessagePath":{},"f:terminationMessagePolicy":{},"f:volumeMounts":{".":{},"k:{\"mountPath\":\"/etc/pod-info/\"}":{".":{},"f:mountPath":{},"f:name":{}},"k:{\"mountPath\":\"/etc/rabbitmq/conf.d/10-operatorDefaults.conf\"}":{".":{},"f:mountPath":{},"f:name":{},"f:subPath":{}},"k:{\"mountPath\":\"/etc/rabbitmq/conf.d/11-default_user.conf\"}":{".":{},"f:mountPath":{},"f:name":{},"f:subPath":{}},"k:{\"mountPath\":\"/etc/rabbitmq/conf.d/90-userDefinedConfiguration.conf\"}":{".":{},"f:mountPath":{},"f:name":{},"f:subPath":{}},"k:{\"mountPath\":\"/operator\"}":{".":{},"f:mountPath":{},"f:name":{}},"k:{\"mountPath\":\"/var/lib/rabbitmq/\"}":{".":{},"f:mountPath":{},"f:name":{}},"k:{\"mountPath\":\"/var/lib/rabbitmq/mnesia/\"}":{".":{},"f:mountPath":{},"f:name":{}}}}},"f:dnsPolicy":{},"f:initContainers":{".":{},"k:{\"name\":\"setup-container\"}":{".":{},"f:command":{},"f:image":{},"f:imagePullPolicy":{},"f:name":{},"f:resources":{".":{},"f:limits":{".":{},"f:cpu":{},"f:memory":{}},"f:requests":{".":{},"f:cpu":{},"f:memory":{}}},"f:securityContext":{".":{},"f:capabilities":{".":{},"f:drop":{}},"f:runAsUser":{}},"f:terminationMessagePath":{},"f:terminationMessagePolicy":{},"f:volumeMounts":{".":{},"k:{\"mountPath\":\"/operator\"}":{".":{},"f:mountPath":{},"f:name":{}},"k:{\"mountPath\":\"/tmp/default_user.conf\"}":{".":{},"f:mountPath":{},"f:name":{},"f:subPath":{}},"k:{\"mountPath\":\"/tmp/erlang-cookie-secret/\"}":{".":{},"f:mountPath":{},"f:name":{}},"k:{\"mountPath\":\"/tmp/rabbitmq-plugins/\"}":{".":{},"f:mountPath":{},"f:name":{}},"k:{\"mountPath\":\"/var/lib/rabbitmq/\"}":{".":{},"f:mountPath":{},"f:name":{}},"k:{\"mountPath\":\"/var/lib/rabbitmq/mnesia/\"}":{".":{},"f:mountPath":{},"f:name":{}}}}},"f:restartPolicy":{},"f:schedulerName":{},"f:securityContext":{".":{},"f:fsGroup":{},"f:runAsGroup":{},"f:runAsUser":{}},"f:serviceAccount":{},"f:serviceAccountName":{},"f:terminationGracePeriodSeconds":{},"f:topologySpreadConstraints":{".":{},"k:{\"topologyKey\":\"topology.kubernetes.io/zone\",\"whenUnsatisfiable\":\"ScheduleAnyway\"}":{".":{},"f:labelSelector":{".":{},"f:matchLabels":{".":{},"f:app.kubernetes.io/name":{}}},"f:maxSkew":{},"f:topologyKey":{},"f:whenUnsatisfiable":{}}},"f:volumes":{".":{},"k:{\"name\":\"erlang-cookie-secret\"}":{".":{},"f:name":{},"f:secret":{".":{},"f:defaultMode":{},"f:secretName":{}}},"k:{\"name\":\"plugins-conf\"}":{".":{},"f:configMap":{".":{},"f:defaultMode":{},"f:name":{}},"f:name":{}},"k:{\"name\":\"pod-info\"}":{".":{},"f:downwardAPI":{".":{},"f:defaultMode":{},"f:items":{}},"f:name":{}},"k:{\"name\":\"rabbitmq-confd\"}":{".":{},"f:name":{},"f:projected":{".":{},"f:defaultMode":{},"f:sources":{}}},"k:{\"name\":\"rabbitmq-erlang-cookie\"}":{".":{},"f:emptyDir":{},"f:name":{}},"k:{\"name\":\"rabbitmq-plugins\"}":{".":{},"f:emptyDir":{},"f:name":{}}}}},"f:updateStrategy":{"f:rollingUpdate":{".":{},"f:partition":{}},"f:type":{}},"f:volumeClaimTemplates":{}}}},{"manager":"kube-controller-manager","operation":"Update","apiVersion":"apps/v1","time":"2022-03-18T18:01:17Z","fieldsType":"FieldsV1","fieldsV1":{"f:status":{"f:collisionCount":{},"f:currentReplicas":{},"f:currentRevision":{},"f:observedGeneration":{},"f:readyReplicas":{},"f:replicas":{},"f:updateRevision":{},"f:updatedReplicas":{}}}}]},"spec":{"replicas":1,"selector":{"matchLabels":{"app.kubernetes.io/name":"rabbitmq-cluster"}},"template":{"metadata":{"creationTimestamp":null,"labels":{"app.kubernetes.io/component":"rabbitmq","app.kubernetes.io/name":"rabbitmq-cluster","app.kubernetes.io/part-of":"rabbitmq"},"annotations":{"prometheus.io/port":"15692","prometheus.io/scrape":"true"}},"spec":{"volumes":[{"name":"plugins-conf","configMap":{"name":"rabbitmq-cluster-plugins-conf","defaultMode":420}},{"name":"rabbitmq-confd","projected":{"sources":[{"secret":{"name":"rabbitmq-cluster-default-user","items":[{"key":"default_user.conf","path":"default_user.conf"}]}},{"configMap":{"name":"rabbitmq-cluster-server-conf","items":[{"key":"operatorDefaults.conf","path":"operatorDefaults.conf"},{"key":"userDefinedConfiguration.conf","path":"userDefinedConfiguration.conf"}]}}],"defaultMode":420}},{"name":"rabbitmq-erlang-cookie","emptyDir":{}},{"name":"erlang-cookie-secret","secret":{"secretName":"rabbitmq-cluster-erlang-cookie","defaultMode":420}},{"name":"rabbitmq-plugins","emptyDir":{}},{"name":"pod-info","downwardAPI":{"items":[{"path":"skipPreStopChecks","fieldRef":{"apiVersion":"v1","fieldPath":"metadata.labels['skipPreStopChecks']"}}],"defaultMode":420}}],"initContainers":[{"name":"setup-container","image":"rabbitmq:3.8.12-management","command":["sh","-c","cp /tmp/erlang-cookie-secret/.erlang.cookie /var/lib/rabbitmq/.erlang.cookie \u0026\u0026 chown 999:999 /var/lib/rabbitmq/.erlang.cookie \u0026\u0026 chmod 600 /var/lib/rabbitmq/.erlang.cookie ; cp /tmp/rabbitmq-plugins/enabled_plugins /operator/enabled_plugins \u0026\u0026 chown 999:999 /operator/enabled_plugins ; chown 999:999 /var/lib/rabbitmq/mnesia/ ; echo '[default]' \u003e /var/lib/rabbitmq/.rabbitmqadmin.conf \u0026\u0026 sed -e 's/default_user/username/' -e 's/default_pass/password/' /tmp/default_user.conf \u003e\u003e /var/lib/rabbitmq/.rabbitmqadmin.conf \u0026\u0026 chown 999:999 /var/lib/rabbitmq/.rabbitmqadmin.conf \u0026\u0026 chmod 600 /var/lib/rabbitmq/.rabbitmqadmin.conf"],"resources":{"limits":{"cpu":"100m","memory":"500Mi"},"requests":{"cpu":"100m","memory":"500Mi"}},"volumeMounts":[{"name":"plugins-conf","mountPath":"/tmp/rabbitmq-plugins/"},{"name":"rabbitmq-erlang-cookie","mountPath":"/var/lib/rabbitmq/"},{"name":"erlang-cookie-secret","mountPath":"/tmp/erlang-cookie-secret/"},{"name":"rabbitmq-plugins","mountPath":"/operator"},{"name":"persistence","mountPath":"/var/lib/rabbitmq/mnesia/"},{"name":"rabbitmq-confd","mountPath":"/tmp/default_user.conf","subPath":"default_user.conf"}],"terminationMessagePath":"/dev/termination-log","terminationMessagePolicy":"File","imagePullPolicy":"IfNotPresent","securityContext":{"capabilities":{"drop":["FSETID","KILL","SETGID","SETUID","SETPCAP","NET_BIND_SERVICE","NET_RAW","SYS_CHROOT","MKNOD","AUDIT_WRITE","SETFCAP"]},"runAsUser":0}}],"containers":[{"name":"rabbitmq","image":"rabbitmq:3.8.12-management","ports":[{"name":"epmd","containerPort":4369,"protocol":"TCP"},{"name":"amqp","containerPort":5672,"protocol":"TCP"},{"name":"management","containerPort":15672,"protocol":"TCP"},{"name":"prometheus","containerPort":15692,"protocol":"TCP"}],"env":[{"name":"MY_POD_NAME","valueFrom":{"fieldRef":{"apiVersion":"v1","fieldPath":"metadata.name"}}},{"name":"MY_POD_NAMESPACE","valueFrom":{"fieldRef":{"apiVersion":"v1","fieldPath":"metadata.namespace"}}},{"name":"RABBITMQ_ENABLED_PLUGINS_FILE","value":"/operator/enabled_plugins"},{"name":"K8S_SERVICE_NAME","value":"rabbitmq-cluster-nodes"},{"name":"RABBITMQ_USE_LONGNAME","value":"true"},{"name":"RABBITMQ_NODENAME","value":"rabbit@$(MY_POD_NAME).$(K8S_SERVICE_NAME).$(MY_POD_NAMESPACE)"},{"name":"K8S_HOSTNAME_SUFFIX","value":".$(K8S_SERVICE_NAME).$(MY_POD_NAMESPACE)"}],"resources":{"limits":{"cpu":"2","memory":"2Gi"},"requests":{"cpu":"1","memory":"2Gi"}},"volumeMounts":[{"name":"rabbitmq-erlang-cookie","mountPath":"/var/lib/rabbitmq/"},{"name":"persistence","mountPath":"/var/lib/rabbitmq/mnesia/"},{"name":"rabbitmq-plugins","mountPath":"/operator"},{"name":"rabbitmq-confd","mountPath":"/etc/rabbitmq/conf.d/10-operatorDefaults.conf","subPath":"operatorDefaults.conf"},{"name":"rabbitmq-confd","mountPath":"/etc/rabbitmq/conf.d/11-default_user.conf","subPath":"default_user.conf"},{"name":"rabbitmq-confd","mountPath":"/etc/rabbitmq/conf.d/90-userDefinedConfiguration.conf","subPath":"userDefinedConfiguration.conf"},{"name":"pod-info","mountPath":"/etc/pod-info/"}],"readinessProbe":{"tcpSocket":{"port":"amqp"},"initialDelaySeconds":10,"timeoutSeconds":5,"periodSeconds":10,"successThreshold":1,"failureThreshold":3},"lifecycle":{"preStop":{"exec":{"command":["/bin/bash","-c","if [ ! -z \"$(cat /etc/pod-info/skipPreStopChecks)\" ]; then exit 0; fi; rabbitmq-upgrade await_online_quorum_plus_one -t 604800; rabbitmq-upgrade await_online_synchronized_mirror -t 604800; rabbitmq-upgrade drain -t 604800"]}}},"terminationMessagePath":"/dev/termination-log","terminationMessagePolicy":"File","imagePullPolicy":"IfNotPresent"}],"restartPolicy":"Always","terminationGracePeriodSeconds":604800,"dnsPolicy":"ClusterFirst","serviceAccountName":"rabbitmq-cluster-server","serviceAccount":"rabbitmq-cluster-server","automountServiceAccountToken":true,"securityContext":{"runAsUser":999,"runAsGroup":999,"fsGroup":999},"schedulerName":"default-scheduler","topologySpreadConstraints":[{"maxSkew":1,"topologyKey":"topology.kubernetes.io/zone","whenUnsatisfiable":"ScheduleAnyway","labelSelector":{"matchLabels":{"app.kubernetes.io/name":"rabbitmq-cluster"}}}]}},"volumeClaimTemplates":[{"metadata":{"name":"persistence","namespace":"default","creationTimestamp":null,"labels":{"app.kubernetes.io/component":"rabbitmq","app.kubernetes.io/name":"rabbitmq-cluster","app.kubernetes.io/part-of":"rabbitmq"},"ownerReferences":[{"apiVersion":"rabbitmq.com/v1beta1","kind":"RabbitmqCluster","name":"rabbitmq-cluster","uid":"18d9928b-0d1c-47be-80ec-20960d053827","controller":true,"blockOwnerDeletion":false}]},"spec":{"accessModes":["ReadWriteOnce"],"resources":{"requests":{"storage":"10Gi"}},"volumeMode":"Filesystem"},"status":{"phase":"Pending"}}],"serviceName":"rabbitmq-cluster-nodes","podManagementPolicy":"Parallel","updateStrategy":{"type":"RollingUpdate","rollingUpdate":{"partition":0}},"revisionHistoryLimit":10},"status":{"observedGeneration":1,"replicas":1,"readyReplicas":1,"currentReplicas":1,"updatedReplicas":1,"currentRevision":"rabbitmq-cluster-server-5f8b8665fb","updateRevision":"rabbitmq-cluster-server-5f8b8665fb","collisionCount":0}}
2022/03/18 18:01:18 learn_server.go:291: [SIEVE-AFTER-READ]	Get	true	endpoints	default	rabbitmq-cluster	github.com/rabbitmq/cluster-operator/controllers.(*RabbitmqClusterReconciler)	NoError	{"kind":"Endpoints","apiVersion":"v1","metadata":{"name":"rabbitmq-cluster","namespace":"default","selfLink":"/api/v1/namespaces/default/endpoints/rabbitmq-cluster","uid":"5c4723ad-f4fe-442d-9135-44879a2a8183","resourceVersion":"939","creationTimestamp":"2022-03-18T18:00:38Z","labels":{"app.kubernetes.io/component":"rabbitmq","app.kubernetes.io/name":"rabbitmq-cluster","app.kubernetes.io/part-of":"rabbitmq"},"annotations":{"endpoints.kubernetes.io/last-change-trigger-time":"2022-03-18T18:01:17Z"},"managedFields":[{"manager":"kube-controller-manager","operation":"Update","apiVersion":"v1","time":"2022-03-18T18:01:17Z","fieldsType":"FieldsV1","fieldsV1":{"f:metadata":{"f:annotations":{".":{},"f:endpoints.kubernetes.io/last-change-trigger-time":{}},"f:labels":{".":{},"f:app.kubernetes.io/component":{},"f:app.kubernetes.io/name":{},"f:app.kubernetes.io/part-of":{}}},"f:subsets":{}}}]},"subsets":[{"addresses":[{"ip":"10.244.1.4","nodeName":"kind-worker2","targetRef":{"kind":"Pod","namespace":"default","name":"rabbitmq-cluster-server-0","uid":"e7faffc5-b656-4e69-9777-92d12cb6ec5a","resourceVersion":"938"}}],"ports":[{"name":"amqp","port":5672,"protocol":"TCP"},{"name":"management","port":15672,"protocol":"TCP"}]}]}
2022/03/18 18:01:18 learn_server.go:291: [SIEVE-AFTER-READ]	Get	true	statefulset	default	rabbitmq-cluster-server	github.com/rabbitmq/cluster-operator/controllers.(*RabbitmqClusterReconciler)	NoError	{"kind":"StatefulSet","apiVersion":"apps/v1","metadata":{"name":"rabbitmq-cluster-server","namespace":"default","selfLink":"/apis/apps/v1/namespaces/default/statefulsets/rabbitmq-cluster-server","uid":"cb5c43bc-6ee7-481c-ab01-6f3acffdd3c8","resourceVersion":"948","generation":1,"creationTimestamp":"2022-03-18T18:00:38Z","labels":{"app.kubernetes.io/component":"rabbitmq","app.kubernetes.io/name":"rabbitmq-cluster","app.kubernetes.io/part-of":"rabbitmq"},"ownerReferences":[{"apiVersion":"rabbitmq.com/v1beta1","kind":"RabbitmqCluster","name":"rabbitmq-cluster","uid":"18d9928b-0d1c-47be-80ec-20960d053827","controller":true,"blockOwnerDeletion":true}],"managedFields":[{"manager":"manager","operation":"Update","apiVersion":"apps/v1","time":"2022-03-18T18:00:38Z","fieldsType":"FieldsV1","fieldsV1":{"f:metadata":{"f:labels":{".":{},"f:app.kubernetes.io/component":{},"f:app.kubernetes.io/name":{},"f:app.kubernetes.io/part-of":{}},"f:ownerReferences":{".":{},"k:{\"uid\":\"18d9928b-0d1c-47be-80ec-20960d053827\"}":{".":{},"f:apiVersion":{},"f:blockOwnerDeletion":{},"f:controller":{},"f:kind":{},"f:name":{},"f:uid":{}}}},"f:spec":{"f:podManagementPolicy":{},"f:replicas":{},"f:revisionHistoryLimit":{},"f:selector":{"f:matchLabels":{".":{},"f:app.kubernetes.io/name":{}}},"f:serviceName":{},"f:template":{"f:metadata":{"f:annotations":{".":{},"f:prometheus.io/port":{},"f:prometheus.io/scrape":{}},"f:labels":{".":{},"f:app.kubernetes.io/component":{},"f:app.kubernetes.io/name":{},"f:app.kubernetes.io/part-of":{}}},"f:spec":{"f:automountServiceAccountToken":{},"f:containers":{"k:{\"name\":\"rabbitmq\"}":{".":{},"f:env":{".":{},"k:{\"name\":\"K8S_HOSTNAME_SUFFIX\"}":{".":{},"f:name":{},"f:value":{}},"k:{\"name\":\"K8S_SERVICE_NAME\"}":{".":{},"f:name":{},"f:value":{}},"k:{\"name\":\"MY_POD_NAME\"}":{".":{},"f:name":{},"f:valueFrom":{".":{},"f:fieldRef":{".":{},"f:apiVersion":{},"f:fieldPath":{}}}},"k:{\"name\":\"MY_POD_NAMESPACE\"}":{".":{},"f:name":{},"f:valueFrom":{".":{},"f:fieldRef":{".":{},"f:apiVersion":{},"f:fieldPath":{}}}},"k:{\"name\":\"RABBITMQ_ENABLED_PLUGINS_FILE\"}":{".":{},"f:name":{},"f:value":{}},"k:{\"name\":\"RABBITMQ_NODENAME\"}":{".":{},"f:name":{},"f:value":{}},"k:{\"name\":\"RABBITMQ_USE_LONGNAME\"}":{".":{},"f:name":{},"f:value":{}}},"f:image":{},"f:imagePullPolicy":{},"f:lifecycle":{".":{},"f:preStop":{".":{},"f:exec":{".":{},"f:command":{}}}},"f:name":{},"f:ports":{".":{},"k:{\"containerPort\":4369,\"protocol\":\"TCP\"}":{".":{},"f:containerPort":{},"f:name":{},"f:protocol":{}},"k:{\"containerPort\":5672,\"protocol\":\"TCP\"}":{".":{},"f:containerPort":{},"f:name":{},"f:protocol":{}},"k:{\"containerPort\":15672,\"protocol\":\"TCP\"}":{".":{},"f:containerPort":{},"f:name":{},"f:protocol":{}},"k:{\"containerPort\":15692,\"protocol\":\"TCP\"}":{".":{},"f:containerPort":{},"f:name":{},"f:protocol":{}}},"f:readinessProbe":{".":{},"f:failureThreshold":{},"f:initialDelaySeconds":{},"f:periodSeconds":{},"f:successThreshold":{},"f:tcpSocket":{".":{},"f:port":{}},"f:timeoutSeconds":{}},"f:resources":{".":{},"f:limits":{".":{},"f:cpu":{},"f:memory":{}},"f:requests":{".":{},"f:cpu":{},"f:memory":{}}},"f:terminationMessagePath":{},"f:terminationMessagePolicy":{},"f:volumeMounts":{".":{},"k:{\"mountPath\":\"/etc/pod-info/\"}":{".":{},"f:mountPath":{},"f:name":{}},"k:{\"mountPath\":\"/etc/rabbitmq/conf.d/10-operatorDefaults.conf\"}":{".":{},"f:mountPath":{},"f:name":{},"f:subPath":{}},"k:{\"mountPath\":\"/etc/rabbitmq/conf.d/11-default_user.conf\"}":{".":{},"f:mountPath":{},"f:name":{},"f:subPath":{}},"k:{\"mountPath\":\"/etc/rabbitmq/conf.d/90-userDefinedConfiguration.conf\"}":{".":{},"f:mountPath":{},"f:name":{},"f:subPath":{}},"k:{\"mountPath\":\"/operator\"}":{".":{},"f:mountPath":{},"f:name":{}},"k:{\"mountPath\":\"/var/lib/rabbitmq/\"}":{".":{},"f:mountPath":{},"f:name":{}},"k:{\"mountPath\":\"/var/lib/rabbitmq/mnesia/\"}":{".":{},"f:mountPath":{},"f:name":{}}}}},"f:dnsPolicy":{},"f:initContainers":{".":{},"k:{\"name\":\"setup-container\"}":{".":{},"f:command":{},"f:image":{},"f:imagePullPolicy":{},"f:name":{},"f:resources":{".":{},"f:limits":{".":{},"f:cpu":{},"f:memory":{}},"f:requests":{".":{},"f:cpu":{},"f:memory":{}}},"f:securityContext":{".":{},"f:capabilities":{".":{},"f:drop":{}},"f:runAsUser":{}},"f:terminationMessagePath":{},"f:terminationMessagePolicy":{},"f:volumeMounts":{".":{},"k:{\"mountPath\":\"/operator\"}":{".":{},"f:mountPath":{},"f:name":{}},"k:{\"mountPath\":\"/tmp/default_user.conf\"}":{".":{},"f:mountPath":{},"f:name":{},"f:subPath":{}},"k:{\"mountPath\":\"/tmp/erlang-cookie-secret/\"}":{".":{},"f:mountPath":{},"f:name":{}},"k:{\"mountPath\":\"/tmp/rabbitmq-plugins/\"}":{".":{},"f:mountPath":{},"f:name":{}},"k:{\"mountPath\":\"/var/lib/rabbitmq/\"}":{".":{},"f:mountPath":{},"f:name":{}},"k:{\"mountPath\":\"/var/lib/rabbitmq/mnesia/\"}":{".":{},"f:mountPath":{},"f:name":{}}}}},"f:restartPolicy":{},"f:schedulerName":{},"f:securityContext":{".":{},"f:fsGroup":{},"f:runAsGroup":{},"f:runAsUser":{}},"f:serviceAccount":{},"f:serviceAccountName":{},"f:terminationGracePeriodSeconds":{},"f:topologySpreadConstraints":{".":{},"k:{\"topologyKey\":\"topology.kubernetes.io/zone\",\"whenUnsatisfiable\":\"ScheduleAnyway\"}":{".":{},"f:labelSelector":{".":{},"f:matchLabels":{".":{},"f:app.kubernetes.io/name":{}}},"f:maxSkew":{},"f:topologyKey":{},"f:whenUnsatisfiable":{}}},"f:volumes":{".":{},"k:{\"name\":\"erlang-cookie-secret\"}":{".":{},"f:name":{},"f:secret":{".":{},"f:defaultMode":{},"f:secretName":{}}},"k:{\"name\":\"plugins-conf\"}":{".":{},"f:configMap":{".":{},"f:defaultMode":{},"f:name":{}},"f:name":{}},"k:{\"name\":\"pod-info\"}":{".":{},"f:downwardAPI":{".":{},"f:defaultMode":{},"f:items":{}},"f:name":{}},"k:{\"name\":\"rabbitmq-confd\"}":{".":{},"f:name":{},"f:projected":{".":{},"f:defaultMode":{},"f:sources":{}}},"k:{\"name\":\"rabbitmq-erlang-cookie\"}":{".":{},"f:emptyDir":{},"f:name":{}},"k:{\"name\":\"rabbitmq-plugins\"}":{".":{},"f:emptyDir":{},"f:name":{}}}}},"f:updateStrategy":{"f:rollingUpdate":{".":{},"f:partition":{}},"f:type":{}},"f:volumeClaimTemplates":{}}}},{"manager":"kube-controller-manager","operation":"Update","apiVersion":"apps/v1","time":"2022-03-18T18:01:17Z","fieldsType":"FieldsV1","fieldsV1":{"f:status":{"f:collisionCount":{},"f:currentReplicas":{},"f:currentRevision":{},"f:observedGeneration":{},"f:readyReplicas":{},"f:replicas":{},"f:updateRevision":{},"f:updatedReplicas":{}}}}]},"spec":{"replicas":1,"selector":{"matchLabels":{"app.kubernetes.io/name":"rabbitmq-cluster"}},"template":{"metadata":{"creationTimestamp":null,"labels":{"app.kubernetes.io/component":"rabbitmq","app.kubernetes.io/name":"rabbitmq-cluster","app.kubernetes.io/part-of":"rabbitmq"},"annotations":{"prometheus.io/port":"15692","prometheus.io/scrape":"true"}},"spec":{"volumes":[{"name":"plugins-conf","configMap":{"name":"rabbitmq-cluster-plugins-conf","defaultMode":420}},{"name":"rabbitmq-confd","projected":{"sources":[{"secret":{"name":"rabbitmq-cluster-default-user","items":[{"key":"default_user.conf","path":"default_user.conf"}]}},{"configMap":{"name":"rabbitmq-cluster-server-conf","items":[{"key":"operatorDefaults.conf","path":"operatorDefaults.conf"},{"key":"userDefinedConfiguration.conf","path":"userDefinedConfiguration.conf"}]}}],"defaultMode":420}},{"name":"rabbitmq-erlang-cookie","emptyDir":{}},{"name":"erlang-cookie-secret","secret":{"secretName":"rabbitmq-cluster-erlang-cookie","defaultMode":420}},{"name":"rabbitmq-plugins","emptyDir":{}},{"name":"pod-info","downwardAPI":{"items":[{"path":"skipPreStopChecks","fieldRef":{"apiVersion":"v1","fieldPath":"metadata.labels['skipPreStopChecks']"}}],"defaultMode":420}}],"initContainers":[{"name":"setup-container","image":"rabbitmq:3.8.12-management","command":["sh","-c","cp /tmp/erlang-cookie-secret/.erlang.cookie /var/lib/rabbitmq/.erlang.cookie \u0026\u0026 chown 999:999 /var/lib/rabbitmq/.erlang.cookie \u0026\u0026 chmod 600 /var/lib/rabbitmq/.erlang.cookie ; cp /tmp/rabbitmq-plugins/enabled_plugins /operator/enabled_plugins \u0026\u0026 chown 999:999 /operator/enabled_plugins ; chown 999:999 /var/lib/rabbitmq/mnesia/ ; echo '[default]' \u003e /var/lib/rabbitmq/.rabbitmqadmin.conf \u0026\u0026 sed -e 's/default_user/username/' -e 's/default_pass/password/' /tmp/default_user.conf \u003e\u003e /var/lib/rabbitmq/.rabbitmqadmin.conf \u0026\u0026 chown 999:999 /var/lib/rabbitmq/.rabbitmqadmin.conf \u0026\u0026 chmod 600 /var/lib/rabbitmq/.rabbitmqadmin.conf"],"resources":{"limits":{"cpu":"100m","memory":"500Mi"},"requests":{"cpu":"100m","memory":"500Mi"}},"volumeMounts":[{"name":"plugins-conf","mountPath":"/tmp/rabbitmq-plugins/"},{"name":"rabbitmq-erlang-cookie","mountPath":"/var/lib/rabbitmq/"},{"name":"erlang-cookie-secret","mountPath":"/tmp/erlang-cookie-secret/"},{"name":"rabbitmq-plugins","mountPath":"/operator"},{"name":"persistence","mountPath":"/var/lib/rabbitmq/mnesia/"},{"name":"rabbitmq-confd","mountPath":"/tmp/default_user.conf","subPath":"default_user.conf"}],"terminationMessagePath":"/dev/termination-log","terminationMessagePolicy":"File","imagePullPolicy":"IfNotPresent","securityContext":{"capabilities":{"drop":["FSETID","KILL","SETGID","SETUID","SETPCAP","NET_BIND_SERVICE","NET_RAW","SYS_CHROOT","MKNOD","AUDIT_WRITE","SETFCAP"]},"runAsUser":0}}],"containers":[{"name":"rabbitmq","image":"rabbitmq:3.8.12-management","ports":[{"name":"epmd","containerPort":4369,"protocol":"TCP"},{"name":"amqp","containerPort":5672,"protocol":"TCP"},{"name":"management","containerPort":15672,"protocol":"TCP"},{"name":"prometheus","containerPort":15692,"protocol":"TCP"}],"env":[{"name":"MY_POD_NAME","valueFrom":{"fieldRef":{"apiVersion":"v1","fieldPath":"metadata.name"}}},{"name":"MY_POD_NAMESPACE","valueFrom":{"fieldRef":{"apiVersion":"v1","fieldPath":"metadata.namespace"}}},{"name":"RABBITMQ_ENABLED_PLUGINS_FILE","value":"/operator/enabled_plugins"},{"name":"K8S_SERVICE_NAME","value":"rabbitmq-cluster-nodes"},{"name":"RABBITMQ_USE_LONGNAME","value":"true"},{"name":"RABBITMQ_NODENAME","value":"rabbit@$(MY_POD_NAME).$(K8S_SERVICE_NAME).$(MY_POD_NAMESPACE)"},{"name":"K8S_HOSTNAME_SUFFIX","value":".$(K8S_SERVICE_NAME).$(MY_POD_NAMESPACE)"}],"resources":{"limits":{"cpu":"2","memory":"2Gi"},"requests":{"cpu":"1","memory":"2Gi"}},"volumeMounts":[{"name":"rabbitmq-erlang-cookie","mountPath":"/var/lib/rabbitmq/"},{"name":"persistence","mountPath":"/var/lib/rabbitmq/mnesia/"},{"name":"rabbitmq-plugins","mountPath":"/operator"},{"name":"rabbitmq-confd","mountPath":"/etc/rabbitmq/conf.d/10-operatorDefaults.conf","subPath":"operatorDefaults.conf"},{"name":"rabbitmq-confd","mountPath":"/etc/rabbitmq/conf.d/11-default_user.conf","subPath":"default_user.conf"},{"name":"rabbitmq-confd","mountPath":"/etc/rabbitmq/conf.d/90-userDefinedConfiguration.conf","subPath":"userDefinedConfiguration.conf"},{"name":"pod-info","mountPath":"/etc/pod-info/"}],"readinessProbe":{"tcpSocket":{"port":"amqp"},"initialDelaySeconds":10,"timeoutSeconds":5,"periodSeconds":10,"successThreshold":1,"failureThreshold":3},"lifecycle":{"preStop":{"exec":{"command":["/bin/bash","-c","if [ ! -z \"$(cat /etc/pod-info/skipPreStopChecks)\" ]; then exit 0; fi; rabbitmq-upgrade await_online_quorum_plus_one -t 604800; rabbitmq-upgrade await_online_synchronized_mirror -t 604800; rabbitmq-upgrade drain -t 604800"]}}},"terminationMessagePath":"/dev/termination-log","terminationMessagePolicy":"File","imagePullPolicy":"IfNotPresent"}],"restartPolicy":"Always","terminationGracePeriodSeconds":604800,"dnsPolicy":"ClusterFirst","serviceAccountName":"rabbitmq-cluster-server","serviceAccount":"rabbitmq-cluster-server","automountServiceAccountToken":true,"securityContext":{"runAsUser":999,"runAsGroup":999,"fsGroup":999},"schedulerName":"default-scheduler","topologySpreadConstraints":[{"maxSkew":1,"topologyKey":"topology.kubernetes.io/zone","whenUnsatisfiable":"ScheduleAnyway","labelSelector":{"matchLabels":{"app.kubernetes.io/name":"rabbitmq-cluster"}}}]}},"volumeClaimTemplates":[{"metadata":{"name":"persistence","namespace":"default","creationTimestamp":null,"labels":{"app.kubernetes.io/component":"rabbitmq","app.kubernetes.io/name":"rabbitmq-cluster","app.kubernetes.io/part-of":"rabbitmq"},"ownerReferences":[{"apiVersion":"rabbitmq.com/v1beta1","kind":"RabbitmqCluster","name":"rabbitmq-cluster","uid":"18d9928b-0d1c-47be-80ec-20960d053827","controller":true,"blockOwnerDeletion":false}]},"spec":{"accessModes":["ReadWriteOnce"],"resources":{"requests":{"storage":"10Gi"}},"volumeMode":"Filesystem"},"status":{"phase":"Pending"}}],"serviceName":"rabbitmq-cluster-nodes","podManagementPolicy":"Parallel","updateStrategy":{"type":"RollingUpdate","rollingUpdate":{"partition":0}},"revisionHistoryLimit":10},"status":{"observedGeneration":1,"replicas":1,"readyReplicas":1,"currentReplicas":1,"updatedReplicas":1,"currentRevision":"rabbitmq-cluster-server-5f8b8665fb","updateRevision":"rabbitmq-cluster-server-5f8b8665fb","collisionCount":0}}
2022/03/18 18:01:18 learn_server.go:291: [SIEVE-AFTER-READ]	Get	true	service	default	rabbitmq-cluster-nodes	github.com/rabbitmq/cluster-operator/controllers.(*RabbitmqClusterReconciler)	NoError	{"kind":"Service","apiVersion":"v1","metadata":{"name":"rabbitmq-cluster-nodes","namespace":"default","selfLink":"/api/v1/namespaces/default/services/rabbitmq-cluster-nodes","uid":"67c7eea9-1b87-4fd7-82e6-5bfe31fd1b52","resourceVersion":"696","creationTimestamp":"2022-03-18T18:00:38Z","labels":{"app.kubernetes.io/component":"rabbitmq","app.kubernetes.io/name":"rabbitmq-cluster","app.kubernetes.io/part-of":"rabbitmq"},"ownerReferences":[{"apiVersion":"rabbitmq.com/v1beta1","kind":"RabbitmqCluster","name":"rabbitmq-cluster","uid":"18d9928b-0d1c-47be-80ec-20960d053827","controller":true,"blockOwnerDeletion":true}],"managedFields":[{"manager":"manager","operation":"Update","apiVersion":"v1","time":"2022-03-18T18:00:38Z","fieldsType":"FieldsV1","fieldsV1":{"f:metadata":{"f:labels":{".":{},"f:app.kubernetes.io/component":{},"f:app.kubernetes.io/name":{},"f:app.kubernetes.io/part-of":{}},"f:ownerReferences":{".":{},"k:{\"uid\":\"18d9928b-0d1c-47be-80ec-20960d053827\"}":{".":{},"f:apiVersion":{},"f:blockOwnerDeletion":{},"f:controller":{},"f:kind":{},"f:name":{},"f:uid":{}}}},"f:spec":{"f:clusterIP":{},"f:ports":{".":{},"k:{\"port\":4369,\"protocol\":\"TCP\"}":{".":{},"f:name":{},"f:port":{},"f:protocol":{},"f:targetPort":{}},"k:{\"port\":25672,\"protocol\":\"TCP\"}":{".":{},"f:name":{},"f:port":{},"f:protocol":{},"f:targetPort":{}}},"f:publishNotReadyAddresses":{},"f:selector":{".":{},"f:app.kubernetes.io/name":{}},"f:sessionAffinity":{},"f:type":{}}}}]},"spec":{"ports":[{"name":"epmd","protocol":"TCP","port":4369,"targetPort":4369},{"name":"cluster-rpc","protocol":"TCP","port":25672,"targetPort":25672}],"selector":{"app.kubernetes.io/name":"rabbitmq-cluster"},"clusterIP":"None","type":"ClusterIP","sessionAffinity":"None","publishNotReadyAddresses":true},"status":{"loadBalancer":{}}}
2022/03/18 18:01:18 learn_server.go:291: [SIEVE-AFTER-READ]	Get	true	service	default	rabbitmq-cluster	github.com/rabbitmq/cluster-operator/controllers.(*RabbitmqClusterReconciler)	NoError	{"kind":"Service","apiVersion":"v1","metadata":{"name":"rabbitmq-cluster","namespace":"default","selfLink":"/api/v1/namespaces/default/services/rabbitmq-cluster","uid":"56b50671-1945-458b-adac-05619b783392","resourceVersion":"701","creationTimestamp":"2022-03-18T18:00:38Z","labels":{"app.kubernetes.io/component":"rabbitmq","app.kubernetes.io/name":"rabbitmq-cluster","app.kubernetes.io/part-of":"rabbitmq"},"ownerReferences":[{"apiVersion":"rabbitmq.com/v1beta1","kind":"RabbitmqCluster","name":"rabbitmq-cluster","uid":"18d9928b-0d1c-47be-80ec-20960d053827","controller":true,"blockOwnerDeletion":true}],"managedFields":[{"manager":"manager","operation":"Update","apiVersion":"v1","time":"2022-03-18T18:00:38Z","fieldsType":"FieldsV1","fieldsV1":{"f:metadata":{"f:labels":{".":{},"f:app.kubernetes.io/component":{},"f:app.kubernetes.io/name":{},"f:app.kubernetes.io/part-of":{}},"f:ownerReferences":{".":{},"k:{\"uid\":\"18d9928b-0d1c-47be-80ec-20960d053827\"}":{".":{},"f:apiVersion":{},"f:blockOwnerDeletion":{},"f:controller":{},"f:kind":{},"f:name":{},"f:uid":{}}}},"f:spec":{"f:ports":{".":{},"k:{\"port\":5672,\"protocol\":\"TCP\"}":{".":{},"f:name":{},"f:port":{},"f:protocol":{},"f:targetPort":{}},"k:{\"port\":15672,\"protocol\":\"TCP\"}":{".":{},"f:name":{},"f:port":{},"f:protocol":{},"f:targetPort":{}}},"f:selector":{".":{},"f:app.kubernetes.io/name":{}},"f:sessionAffinity":{},"f:type":{}}}}]},"spec":{"ports":[{"name":"amqp","protocol":"TCP","port":5672,"targetPort":5672},{"name":"management","protocol":"TCP","port":15672,"targetPort":15672}],"selector":{"app.kubernetes.io/name":"rabbitmq-cluster"},"clusterIP":"10.96.254.158","type":"ClusterIP","sessionAffinity":"None"},"status":{"loadBalancer":{}}}
2022/03/18 18:01:18 learn_server.go:291: [SIEVE-AFTER-READ]	Get	true	secret	default	rabbitmq-cluster-erlang-cookie	github.com/rabbitmq/cluster-operator/controllers.(*RabbitmqClusterReconciler)	NoError	{"kind":"Secret","apiVersion":"v1","metadata":{"name":"rabbitmq-cluster-erlang-cookie","namespace":"default","selfLink":"/api/v1/namespaces/default/secrets/rabbitmq-cluster-erlang-cookie","uid":"f8fbe8a6-0f40-4e13-960b-ab78b8ba75b0","resourceVersion":"705","creationTimestamp":"2022-03-18T18:00:38Z","labels":{"app.kubernetes.io/component":"rabbitmq","app.kubernetes.io/name":"rabbitmq-cluster","app.kubernetes.io/part-of":"rabbitmq"},"ownerReferences":[{"apiVersion":"rabbitmq.com/v1beta1","kind":"RabbitmqCluster","name":"rabbitmq-cluster","uid":"18d9928b-0d1c-47be-80ec-20960d053827","controller":true,"blockOwnerDeletion":true}],"managedFields":[{"manager":"manager","operation":"Update","apiVersion":"v1","time":"2022-03-18T18:00:38Z","fieldsType":"FieldsV1","fieldsV1":{"f:data":{".":{},"f:.erlang.cookie":{}},"f:metadata":{"f:labels":{".":{},"f:app.kubernetes.io/component":{},"f:app.kubernetes.io/name":{},"f:app.kubernetes.io/part-of":{}},"f:ownerReferences":{".":{},"k:{\"uid\":\"18d9928b-0d1c-47be-80ec-20960d053827\"}":{".":{},"f:apiVersion":{},"f:blockOwnerDeletion":{},"f:controller":{},"f:kind":{},"f:name":{},"f:uid":{}}}},"f:type":{}}}]},"data":{".erlang.cookie":"QW9hMkpWU0tlYS1FUGdWTUhrelNMNnFoMFZ0ZmRGNUY="},"type":"Opaque"}
2022/03/18 18:01:18 learn_server.go:291: [SIEVE-AFTER-READ]	Get	true	secret	default	rabbitmq-cluster-default-user	github.com/rabbitmq/cluster-operator/controllers.(*RabbitmqClusterReconciler)	NoError	{"kind":"Secret","apiVersion":"v1","metadata":{"name":"rabbitmq-cluster-default-user","namespace":"default","selfLink":"/api/v1/namespaces/default/secrets/rabbitmq-cluster-default-user","uid":"0d9f460b-a23c-402b-8273-f541ed39023f","resourceVersion":"708","creationTimestamp":"2022-03-18T18:00:38Z","labels":{"app.kubernetes.io/component":"rabbitmq","app.kubernetes.io/name":"rabbitmq-cluster","app.kubernetes.io/part-of":"rabbitmq"},"ownerReferences":[{"apiVersion":"rabbitmq.com/v1beta1","kind":"RabbitmqCluster","name":"rabbitmq-cluster","uid":"18d9928b-0d1c-47be-80ec-20960d053827","controller":true,"blockOwnerDeletion":true}],"managedFields":[{"manager":"manager","operation":"Update","apiVersion":"v1","time":"2022-03-18T18:00:38Z","fieldsType":"FieldsV1","fieldsV1":{"f:data":{".":{},"f:default_user.conf":{},"f:password":{},"f:provider":{},"f:type":{},"f:username":{}},"f:metadata":{"f:labels":{".":{},"f:app.kubernetes.io/component":{},"f:app.kubernetes.io/name":{},"f:app.kubernetes.io/part-of":{}},"f:ownerReferences":{".":{},"k:{\"uid\":\"18d9928b-0d1c-47be-80ec-20960d053827\"}":{".":{},"f:apiVersion":{},"f:blockOwnerDeletion":{},"f:controller":{},"f:kind":{},"f:name":{},"f:uid":{}}}},"f:type":{}}}]},"data":{"default_user.conf":"ZGVmYXVsdF91c2VyID0gcTMxRmh3MGtjWW9SZUl5X3BPTXp2ZVBOUnNVU3I1Mk8KZGVmYXVsdF9wYXNzID0gY0dBX19jNTJHX05hVURpTGhraWZ6UDBOVVlNLTE2MWQK","password":"Y0dBX19jNTJHX05hVURpTGhraWZ6UDBOVVlNLTE2MWQ=","provider":"cmFiYml0bXE=","type":"cmFiYml0bXE=","username":"cTMxRmh3MGtjWW9SZUl5X3BPTXp2ZVBOUnNVU3I1Mk8="},"type":"Opaque"}
2022/03/18 18:01:18 learn_server.go:291: [SIEVE-AFTER-READ]	Get	true	configmap	default	rabbitmq-cluster-plugins-conf	github.com/rabbitmq/cluster-operator/controllers.(*RabbitmqClusterReconciler)	NoError	{"kind":"ConfigMap","apiVersion":"v1","metadata":{"name":"rabbitmq-cluster-plugins-conf","namespace":"default","selfLink":"/api/v1/namespaces/default/configmaps/rabbitmq-cluster-plugins-conf","uid":"a164075b-0562-47ac-a577-99aa8651ec40","resourceVersion":"709","creationTimestamp":"2022-03-18T18:00:38Z","labels":{"app.kubernetes.io/component":"rabbitmq","app.kubernetes.io/name":"rabbitmq-cluster","app.kubernetes.io/part-of":"rabbitmq"},"ownerReferences":[{"apiVersion":"rabbitmq.com/v1beta1","kind":"RabbitmqCluster","name":"rabbitmq-cluster","uid":"18d9928b-0d1c-47be-80ec-20960d053827","controller":true,"blockOwnerDeletion":true}],"managedFields":[{"manager":"manager","operation":"Update","apiVersion":"v1","time":"2022-03-18T18:00:38Z","fieldsType":"FieldsV1","fieldsV1":{"f:data":{".":{},"f:enabled_plugins":{}},"f:metadata":{"f:labels":{".":{},"f:app.kubernetes.io/component":{},"f:app.kubernetes.io/name":{},"f:app.kubernetes.io/part-of":{}},"f:ownerReferences":{".":{},"k:{\"uid\":\"18d9928b-0d1c-47be-80ec-20960d053827\"}":{".":{},"f:apiVersion":{},"f:blockOwnerDeletion":{},"f:controller":{},"f:kind":{},"f:name":{},"f:uid":{}}}}}}]},"data":{"enabled_plugins":"[rabbitmq_peer_discovery_k8s,rabbitmq_prometheus,rabbitmq_management]."}}
2022/03/18 18:01:18 learn_server.go:291: [SIEVE-AFTER-READ]	Get	true	configmap	default	rabbitmq-cluster-server-conf	github.com/rabbitmq/cluster-operator/controllers.(*RabbitmqClusterReconciler)	NoError	{"kind":"ConfigMap","apiVersion":"v1","metadata":{"name":"rabbitmq-cluster-server-conf","namespace":"default","selfLink":"/api/v1/namespaces/default/configmaps/rabbitmq-cluster-server-conf","uid":"22474f2b-8454-44b7-8079-8990223969cc","resourceVersion":"714","creationTimestamp":"2022-03-18T18:00:38Z","labels":{"app.kubernetes.io/component":"rabbitmq","app.kubernetes.io/name":"rabbitmq-cluster","app.kubernetes.io/part-of":"rabbitmq"},"ownerReferences":[{"apiVersion":"rabbitmq.com/v1beta1","kind":"RabbitmqCluster","name":"rabbitmq-cluster","uid":"18d9928b-0d1c-47be-80ec-20960d053827","controller":true,"blockOwnerDeletion":true}],"managedFields":[{"manager":"manager","operation":"Update","apiVersion":"v1","time":"2022-03-18T18:00:38Z","fieldsType":"FieldsV1","fieldsV1":{"f:data":{".":{},"f:operatorDefaults.conf":{},"f:userDefinedConfiguration.conf":{}},"f:metadata":{"f:labels":{".":{},"f:app.kubernetes.io/component":{},"f:app.kubernetes.io/name":{},"f:app.kubernetes.io/part-of":{}},"f:ownerReferences":{".":{},"k:{\"uid\":\"18d9928b-0d1c-47be-80ec-20960d053827\"}":{".":{},"f:apiVersion":{},"f:blockOwnerDeletion":{},"f:controller":{},"f:kind":{},"f:name":{},"f:uid":{}}}}}}]},"data":{"operatorDefaults.conf":"cluster_formation.peer_discovery_backend             = rabbit_peer_discovery_k8s\ncluster_formation.k8s.host                           = kubernetes.default\ncluster_formation.k8s.address_type                   = hostname\ncluster_partition_handling                           = pause_minority\nqueue_master_locator                                 = min-masters\ndisk_free_limit.absolute                             = 2GB\ncluster_formation.randomized_startup_delay_range.min = 5\ncluster_formation.randomized_startup_delay_range.max = 30\ncluster_name                                         = rabbitmq-cluster\n","userDefinedConfiguration.conf":"total_memory_available_override_value = 1717986919\n"}}
2022/03/18 18:01:18 learn_server.go:291: [SIEVE-AFTER-READ]	Get	true	serviceaccount	default	rabbitmq-cluster-server	github.com/rabbitmq/cluster-operator/controllers.(*RabbitmqClusterReconciler)	NoError	{"kind":"ServiceAccount","apiVersion":"v1","metadata":{"name":"rabbitmq-cluster-server","namespace":"default","selfLink":"/api/v1/namespaces/default/serviceaccounts/rabbitmq-cluster-server","uid":"731589b5-ac97-4774-bee4-008949b54734","resourceVersion":"722","creationTimestamp":"2022-03-18T18:00:38Z","labels":{"app.kubernetes.io/component":"rabbitmq","app.kubernetes.io/name":"rabbitmq-cluster","app.kubernetes.io/part-of":"rabbitmq"},"ownerReferences":[{"apiVersion":"rabbitmq.com/v1beta1","kind":"RabbitmqCluster","name":"rabbitmq-cluster","uid":"18d9928b-0d1c-47be-80ec-20960d053827","controller":true,"blockOwnerDeletion":true}],"managedFields":[{"manager":"kube-controller-manager","operation":"Update","apiVersion":"v1","time":"2022-03-18T18:00:38Z","fieldsType":"FieldsV1","fieldsV1":{"f:secrets":{".":{},"k:{\"name\":\"rabbitmq-cluster-server-token-rhzq9\"}":{".":{},"f:name":{}}}}},{"manager":"manager","operation":"Update","apiVersion":"v1","time":"2022-03-18T18:00:38Z","fieldsType":"FieldsV1","fieldsV1":{"f:metadata":{"f:labels":{".":{},"f:app.kubernetes.io/component":{},"f:app.kubernetes.io/name":{},"f:app.kubernetes.io/part-of":{}},"f:ownerReferences":{".":{},"k:{\"uid\":\"18d9928b-0d1c-47be-80ec-20960d053827\"}":{".":{},"f:apiVersion":{},"f:blockOwnerDeletion":{},"f:controller":{},"f:kind":{},"f:name":{},"f:uid":{}}}}}}]},"secrets":[{"name":"rabbitmq-cluster-server-token-rhzq9"}]}
2022/03/18 18:01:18 learn_server.go:291: [SIEVE-AFTER-READ]	Get	true	role	default	rabbitmq-cluster-peer-discovery	github.com/rabbitmq/cluster-operator/controllers.(*RabbitmqClusterReconciler)	NoError	{"kind":"Role","apiVersion":"rbac.authorization.k8s.io/v1","metadata":{"name":"rabbitmq-cluster-peer-discovery","namespace":"default","selfLink":"/apis/rbac.authorization.k8s.io/v1/namespaces/default/roles/rabbitmq-cluster-peer-discovery","uid":"52c80b50-4fdd-4089-bbfd-9756465953f2","resourceVersion":"723","creationTimestamp":"2022-03-18T18:00:38Z","labels":{"app.kubernetes.io/component":"rabbitmq","app.kubernetes.io/name":"rabbitmq-cluster","app.kubernetes.io/part-of":"rabbitmq"},"ownerReferences":[{"apiVersion":"rabbitmq.com/v1beta1","kind":"RabbitmqCluster","name":"rabbitmq-cluster","uid":"18d9928b-0d1c-47be-80ec-20960d053827","controller":true,"blockOwnerDeletion":true}],"managedFields":[{"manager":"manager","operation":"Update","apiVersion":"rbac.authorization.k8s.io/v1","time":"2022-03-18T18:00:38Z","fieldsType":"FieldsV1","fieldsV1":{"f:metadata":{"f:labels":{".":{},"f:app.kubernetes.io/component":{},"f:app.kubernetes.io/name":{},"f:app.kubernetes.io/part-of":{}},"f:ownerReferences":{".":{},"k:{\"uid\":\"18d9928b-0d1c-47be-80ec-20960d053827\"}":{".":{},"f:apiVersion":{},"f:blockOwnerDeletion":{},"f:controller":{},"f:kind":{},"f:name":{},"f:uid":{}}}},"f:rules":{}}}]},"rules":[{"verbs":["get"],"apiGroups":[""],"resources":["endpoints"]},{"verbs":["create"],"apiGroups":[""],"resources":["events"]}]}
2022/03/18 18:01:18 learn_server.go:291: [SIEVE-AFTER-READ]	Get	true	rolebinding	default	rabbitmq-cluster-server	github.com/rabbitmq/cluster-operator/controllers.(*RabbitmqClusterReconciler)	NoError	{"kind":"RoleBinding","apiVersion":"rbac.authorization.k8s.io/v1","metadata":{"name":"rabbitmq-cluster-server","namespace":"default","selfLink":"/apis/rbac.authorization.k8s.io/v1/namespaces/default/rolebindings/rabbitmq-cluster-server","uid":"495e9f7c-a20d-4515-86b0-34149a855034","resourceVersion":"725","creationTimestamp":"2022-03-18T18:00:38Z","labels":{"app.kubernetes.io/component":"rabbitmq","app.kubernetes.io/name":"rabbitmq-cluster","app.kubernetes.io/part-of":"rabbitmq"},"ownerReferences":[{"apiVersion":"rabbitmq.com/v1beta1","kind":"RabbitmqCluster","name":"rabbitmq-cluster","uid":"18d9928b-0d1c-47be-80ec-20960d053827","controller":true,"blockOwnerDeletion":true}],"managedFields":[{"manager":"manager","operation":"Update","apiVersion":"rbac.authorization.k8s.io/v1","time":"2022-03-18T18:00:38Z","fieldsType":"FieldsV1","fieldsV1":{"f:metadata":{"f:labels":{".":{},"f:app.kubernetes.io/component":{},"f:app.kubernetes.io/name":{},"f:app.kubernetes.io/part-of":{}},"f:ownerReferences":{".":{},"k:{\"uid\":\"18d9928b-0d1c-47be-80ec-20960d053827\"}":{".":{},"f:apiVersion":{},"f:blockOwnerDeletion":{},"f:controller":{},"f:kind":{},"f:name":{},"f:uid":{}}}},"f:roleRef":{"f:apiGroup":{},"f:kind":{},"f:name":{}},"f:subjects":{}}}]},"subjects":[{"kind":"ServiceAccount","name":"rabbitmq-cluster-server"}],"roleRef":{"apiGroup":"rbac.authorization.k8s.io","kind":"Role","name":"rabbitmq-cluster-peer-discovery"}}
2022/03/18 18:01:18 learn_server.go:291: [SIEVE-AFTER-READ]	Get	true	statefulset	default	rabbitmq-cluster-server	github.com/rabbitmq/cluster-operator/controllers.(*RabbitmqClusterReconciler)	NoError	{"kind":"StatefulSet","apiVersion":"apps/v1","metadata":{"name":"rabbitmq-cluster-server","namespace":"default","selfLink":"/apis/apps/v1/namespaces/default/statefulsets/rabbitmq-cluster-server","uid":"cb5c43bc-6ee7-481c-ab01-6f3acffdd3c8","resourceVersion":"948","generation":1,"creationTimestamp":"2022-03-18T18:00:38Z","labels":{"app.kubernetes.io/component":"rabbitmq","app.kubernetes.io/name":"rabbitmq-cluster","app.kubernetes.io/part-of":"rabbitmq"},"ownerReferences":[{"apiVersion":"rabbitmq.com/v1beta1","kind":"RabbitmqCluster","name":"rabbitmq-cluster","uid":"18d9928b-0d1c-47be-80ec-20960d053827","controller":true,"blockOwnerDeletion":true}],"managedFields":[{"manager":"manager","operation":"Update","apiVersion":"apps/v1","time":"2022-03-18T18:00:38Z","fieldsType":"FieldsV1","fieldsV1":{"f:metadata":{"f:labels":{".":{},"f:app.kubernetes.io/component":{},"f:app.kubernetes.io/name":{},"f:app.kubernetes.io/part-of":{}},"f:ownerReferences":{".":{},"k:{\"uid\":\"18d9928b-0d1c-47be-80ec-20960d053827\"}":{".":{},"f:apiVersion":{},"f:blockOwnerDeletion":{},"f:controller":{},"f:kind":{},"f:name":{},"f:uid":{}}}},"f:spec":{"f:podManagementPolicy":{},"f:replicas":{},"f:revisionHistoryLimit":{},"f:selector":{"f:matchLabels":{".":{},"f:app.kubernetes.io/name":{}}},"f:serviceName":{},"f:template":{"f:metadata":{"f:annotations":{".":{},"f:prometheus.io/port":{},"f:prometheus.io/scrape":{}},"f:labels":{".":{},"f:app.kubernetes.io/component":{},"f:app.kubernetes.io/name":{},"f:app.kubernetes.io/part-of":{}}},"f:spec":{"f:automountServiceAccountToken":{},"f:containers":{"k:{\"name\":\"rabbitmq\"}":{".":{},"f:env":{".":{},"k:{\"name\":\"K8S_HOSTNAME_SUFFIX\"}":{".":{},"f:name":{},"f:value":{}},"k:{\"name\":\"K8S_SERVICE_NAME\"}":{".":{},"f:name":{},"f:value":{}},"k:{\"name\":\"MY_POD_NAME\"}":{".":{},"f:name":{},"f:valueFrom":{".":{},"f:fieldRef":{".":{},"f:apiVersion":{},"f:fieldPath":{}}}},"k:{\"name\":\"MY_POD_NAMESPACE\"}":{".":{},"f:name":{},"f:valueFrom":{".":{},"f:fieldRef":{".":{},"f:apiVersion":{},"f:fieldPath":{}}}},"k:{\"name\":\"RABBITMQ_ENABLED_PLUGINS_FILE\"}":{".":{},"f:name":{},"f:value":{}},"k:{\"name\":\"RABBITMQ_NODENAME\"}":{".":{},"f:name":{},"f:value":{}},"k:{\"name\":\"RABBITMQ_USE_LONGNAME\"}":{".":{},"f:name":{},"f:value":{}}},"f:image":{},"f:imagePullPolicy":{},"f:lifecycle":{".":{},"f:preStop":{".":{},"f:exec":{".":{},"f:command":{}}}},"f:name":{},"f:ports":{".":{},"k:{\"containerPort\":4369,\"protocol\":\"TCP\"}":{".":{},"f:containerPort":{},"f:name":{},"f:protocol":{}},"k:{\"containerPort\":5672,\"protocol\":\"TCP\"}":{".":{},"f:containerPort":{},"f:name":{},"f:protocol":{}},"k:{\"containerPort\":15672,\"protocol\":\"TCP\"}":{".":{},"f:containerPort":{},"f:name":{},"f:protocol":{}},"k:{\"containerPort\":15692,\"protocol\":\"TCP\"}":{".":{},"f:containerPort":{},"f:name":{},"f:protocol":{}}},"f:readinessProbe":{".":{},"f:failureThreshold":{},"f:initialDelaySeconds":{},"f:periodSeconds":{},"f:successThreshold":{},"f:tcpSocket":{".":{},"f:port":{}},"f:timeoutSeconds":{}},"f:resources":{".":{},"f:limits":{".":{},"f:cpu":{},"f:memory":{}},"f:requests":{".":{},"f:cpu":{},"f:memory":{}}},"f:terminationMessagePath":{},"f:terminationMessagePolicy":{},"f:volumeMounts":{".":{},"k:{\"mountPath\":\"/etc/pod-info/\"}":{".":{},"f:mountPath":{},"f:name":{}},"k:{\"mountPath\":\"/etc/rabbitmq/conf.d/10-operatorDefaults.conf\"}":{".":{},"f:mountPath":{},"f:name":{},"f:subPath":{}},"k:{\"mountPath\":\"/etc/rabbitmq/conf.d/11-default_user.conf\"}":{".":{},"f:mountPath":{},"f:name":{},"f:subPath":{}},"k:{\"mountPath\":\"/etc/rabbitmq/conf.d/90-userDefinedConfiguration.conf\"}":{".":{},"f:mountPath":{},"f:name":{},"f:subPath":{}},"k:{\"mountPath\":\"/operator\"}":{".":{},"f:mountPath":{},"f:name":{}},"k:{\"mountPath\":\"/var/lib/rabbitmq/\"}":{".":{},"f:mountPath":{},"f:name":{}},"k:{\"mountPath\":\"/var/lib/rabbitmq/mnesia/\"}":{".":{},"f:mountPath":{},"f:name":{}}}}},"f:dnsPolicy":{},"f:initContainers":{".":{},"k:{\"name\":\"setup-container\"}":{".":{},"f:command":{},"f:image":{},"f:imagePullPolicy":{},"f:name":{},"f:resources":{".":{},"f:limits":{".":{},"f:cpu":{},"f:memory":{}},"f:requests":{".":{},"f:cpu":{},"f:memory":{}}},"f:securityContext":{".":{},"f:capabilities":{".":{},"f:drop":{}},"f:runAsUser":{}},"f:terminationMessagePath":{},"f:terminationMessagePolicy":{},"f:volumeMounts":{".":{},"k:{\"mountPath\":\"/operator\"}":{".":{},"f:mountPath":{},"f:name":{}},"k:{\"mountPath\":\"/tmp/default_user.conf\"}":{".":{},"f:mountPath":{},"f:name":{},"f:subPath":{}},"k:{\"mountPath\":\"/tmp/erlang-cookie-secret/\"}":{".":{},"f:mountPath":{},"f:name":{}},"k:{\"mountPath\":\"/tmp/rabbitmq-plugins/\"}":{".":{},"f:mountPath":{},"f:name":{}},"k:{\"mountPath\":\"/var/lib/rabbitmq/\"}":{".":{},"f:mountPath":{},"f:name":{}},"k:{\"mountPath\":\"/var/lib/rabbitmq/mnesia/\"}":{".":{},"f:mountPath":{},"f:name":{}}}}},"f:restartPolicy":{},"f:schedulerName":{},"f:securityContext":{".":{},"f:fsGroup":{},"f:runAsGroup":{},"f:runAsUser":{}},"f:serviceAccount":{},"f:serviceAccountName":{},"f:terminationGracePeriodSeconds":{},"f:topologySpreadConstraints":{".":{},"k:{\"topologyKey\":\"topology.kubernetes.io/zone\",\"whenUnsatisfiable\":\"ScheduleAnyway\"}":{".":{},"f:labelSelector":{".":{},"f:matchLabels":{".":{},"f:app.kubernetes.io/name":{}}},"f:maxSkew":{},"f:topologyKey":{},"f:whenUnsatisfiable":{}}},"f:volumes":{".":{},"k:{\"name\":\"erlang-cookie-secret\"}":{".":{},"f:name":{},"f:secret":{".":{},"f:defaultMode":{},"f:secretName":{}}},"k:{\"name\":\"plugins-conf\"}":{".":{},"f:configMap":{".":{},"f:defaultMode":{},"f:name":{}},"f:name":{}},"k:{\"name\":\"pod-info\"}":{".":{},"f:downwardAPI":{".":{},"f:defaultMode":{},"f:items":{}},"f:name":{}},"k:{\"name\":\"rabbitmq-confd\"}":{".":{},"f:name":{},"f:projected":{".":{},"f:defaultMode":{},"f:sources":{}}},"k:{\"name\":\"rabbitmq-erlang-cookie\"}":{".":{},"f:emptyDir":{},"f:name":{}},"k:{\"name\":\"rabbitmq-plugins\"}":{".":{},"f:emptyDir":{},"f:name":{}}}}},"f:updateStrategy":{"f:rollingUpdate":{".":{},"f:partition":{}},"f:type":{}},"f:volumeClaimTemplates":{}}}},{"manager":"kube-controller-manager","operation":"Update","apiVersion":"apps/v1","time":"2022-03-18T18:01:17Z","fieldsType":"FieldsV1","fieldsV1":{"f:status":{"f:collisionCount":{},"f:currentReplicas":{},"f:currentRevision":{},"f:observedGeneration":{},"f:readyReplicas":{},"f:replicas":{},"f:updateRevision":{},"f:updatedReplicas":{}}}}]},"spec":{"replicas":1,"selector":{"matchLabels":{"app.kubernetes.io/name":"rabbitmq-cluster"}},"template":{"metadata":{"creationTimestamp":null,"labels":{"app.kubernetes.io/component":"rabbitmq","app.kubernetes.io/name":"rabbitmq-cluster","app.kubernetes.io/part-of":"rabbitmq"},"annotations":{"prometheus.io/port":"15692","prometheus.io/scrape":"true"}},"spec":{"volumes":[{"name":"plugins-conf","configMap":{"name":"rabbitmq-cluster-plugins-conf","defaultMode":420}},{"name":"rabbitmq-confd","projected":{"sources":[{"secret":{"name":"rabbitmq-cluster-default-user","items":[{"key":"default_user.conf","path":"default_user.conf"}]}},{"configMap":{"name":"rabbitmq-cluster-server-conf","items":[{"key":"operatorDefaults.conf","path":"operatorDefaults.conf"},{"key":"userDefinedConfiguration.conf","path":"userDefinedConfiguration.conf"}]}}],"defaultMode":420}},{"name":"rabbitmq-erlang-cookie","emptyDir":{}},{"name":"erlang-cookie-secret","secret":{"secretName":"rabbitmq-cluster-erlang-cookie","defaultMode":420}},{"name":"rabbitmq-plugins","emptyDir":{}},{"name":"pod-info","downwardAPI":{"items":[{"path":"skipPreStopChecks","fieldRef":{"apiVersion":"v1","fieldPath":"metadata.labels['skipPreStopChecks']"}}],"defaultMode":420}}],"initContainers":[{"name":"setup-container","image":"rabbitmq:3.8.12-management","command":["sh","-c","cp /tmp/erlang-cookie-secret/.erlang.cookie /var/lib/rabbitmq/.erlang.cookie \u0026\u0026 chown 999:999 /var/lib/rabbitmq/.erlang.cookie \u0026\u0026 chmod 600 /var/lib/rabbitmq/.erlang.cookie ; cp /tmp/rabbitmq-plugins/enabled_plugins /operator/enabled_plugins \u0026\u0026 chown 999:999 /operator/enabled_plugins ; chown 999:999 /var/lib/rabbitmq/mnesia/ ; echo '[default]' \u003e /var/lib/rabbitmq/.rabbitmqadmin.conf \u0026\u0026 sed -e 's/default_user/username/' -e 's/default_pass/password/' /tmp/default_user.conf \u003e\u003e /var/lib/rabbitmq/.rabbitmqadmin.conf \u0026\u0026 chown 999:999 /var/lib/rabbitmq/.rabbitmqadmin.conf \u0026\u0026 chmod 600 /var/lib/rabbitmq/.rabbitmqadmin.conf"],"resources":{"limits":{"cpu":"100m","memory":"500Mi"},"requests":{"cpu":"100m","memory":"500Mi"}},"volumeMounts":[{"name":"plugins-conf","mountPath":"/tmp/rabbitmq-plugins/"},{"name":"rabbitmq-erlang-cookie","mountPath":"/var/lib/rabbitmq/"},{"name":"erlang-cookie-secret","mountPath":"/tmp/erlang-cookie-secret/"},{"name":"rabbitmq-plugins","mountPath":"/operator"},{"name":"persistence","mountPath":"/var/lib/rabbitmq/mnesia/"},{"name":"rabbitmq-confd","mountPath":"/tmp/default_user.conf","subPath":"default_user.conf"}],"terminationMessagePath":"/dev/termination-log","terminationMessagePolicy":"File","imagePullPolicy":"IfNotPresent","securityContext":{"capabilities":{"drop":["FSETID","KILL","SETGID","SETUID","SETPCAP","NET_BIND_SERVICE","NET_RAW","SYS_CHROOT","MKNOD","AUDIT_WRITE","SETFCAP"]},"runAsUser":0}}],"containers":[{"name":"rabbitmq","image":"rabbitmq:3.8.12-management","ports":[{"name":"epmd","containerPort":4369,"protocol":"TCP"},{"name":"amqp","containerPort":5672,"protocol":"TCP"},{"name":"management","containerPort":15672,"protocol":"TCP"},{"name":"prometheus","containerPort":15692,"protocol":"TCP"}],"env":[{"name":"MY_POD_NAME","valueFrom":{"fieldRef":{"apiVersion":"v1","fieldPath":"metadata.name"}}},{"name":"MY_POD_NAMESPACE","valueFrom":{"fieldRef":{"apiVersion":"v1","fieldPath":"metadata.namespace"}}},{"name":"RABBITMQ_ENABLED_PLUGINS_FILE","value":"/operator/enabled_plugins"},{"name":"K8S_SERVICE_NAME","value":"rabbitmq-cluster-nodes"},{"name":"RABBITMQ_USE_LONGNAME","value":"true"},{"name":"RABBITMQ_NODENAME","value":"rabbit@$(MY_POD_NAME).$(K8S_SERVICE_NAME).$(MY_POD_NAMESPACE)"},{"name":"K8S_HOSTNAME_SUFFIX","value":".$(K8S_SERVICE_NAME).$(MY_POD_NAMESPACE)"}],"resources":{"limits":{"cpu":"2","memory":"2Gi"},"requests":{"cpu":"1","memory":"2Gi"}},"volumeMounts":[{"name":"rabbitmq-erlang-cookie","mountPath":"/var/lib/rabbitmq/"},{"name":"persistence","mountPath":"/var/lib/rabbitmq/mnesia/"},{"name":"rabbitmq-plugins","mountPath":"/operator"},{"name":"rabbitmq-confd","mountPath":"/etc/rabbitmq/conf.d/10-operatorDefaults.conf","subPath":"operatorDefaults.conf"},{"name":"rabbitmq-confd","mountPath":"/etc/rabbitmq/conf.d/11-default_user.conf","subPath":"default_user.conf"},{"name":"rabbitmq-confd","mountPath":"/etc/rabbitmq/conf.d/90-userDefinedConfiguration.conf","subPath":"userDefinedConfiguration.conf"},{"name":"pod-info","mountPath":"/etc/pod-info/"}],"readinessProbe":{"tcpSocket":{"port":"amqp"},"initialDelaySeconds":10,"timeoutSeconds":5,"periodSeconds":10,"successThreshold":1,"failureThreshold":3},"lifecycle":{"preStop":{"exec":{"command":["/bin/bash","-c","if [ ! -z \"$(cat /etc/pod-info/skipPreStopChecks)\" ]; then exit 0; fi; rabbitmq-upgrade await_online_quorum_plus_one -t 604800; rabbitmq-upgrade await_online_synchronized_mirror -t 604800; rabbitmq-upgrade drain -t 604800"]}}},"terminationMessagePath":"/dev/termination-log","terminationMessagePolicy":"File","imagePullPolicy":"IfNotPresent"}],"restartPolicy":"Always","terminationGracePeriodSeconds":604800,"dnsPolicy":"ClusterFirst","serviceAccountName":"rabbitmq-cluster-server","serviceAccount":"rabbitmq-cluster-server","automountServiceAccountToken":true,"securityContext":{"runAsUser":999,"runAsGroup":999,"fsGroup":999},"schedulerName":"default-scheduler","topologySpreadConstraints":[{"maxSkew":1,"topologyKey":"topology.kubernetes.io/zone","whenUnsatisfiable":"ScheduleAnyway","labelSelector":{"matchLabels":{"app.kubernetes.io/name":"rabbitmq-cluster"}}}]}},"volumeClaimTemplates":[{"metadata":{"name":"persistence","namespace":"default","creationTimestamp":null,"labels":{"app.kubernetes.io/component":"rabbitmq","app.kubernetes.io/name":"rabbitmq-cluster","app.kubernetes.io/part-of":"rabbitmq"},"ownerReferences":[{"apiVersion":"rabbitmq.com/v1beta1","kind":"RabbitmqCluster","name":"rabbitmq-cluster","uid":"18d9928b-0d1c-47be-80ec-20960d053827","controller":true,"blockOwnerDeletion":false}]},"spec":{"accessModes":["ReadWriteOnce"],"resources":{"requests":{"storage":"10Gi"}},"volumeMode":"Filesystem"},"status":{"phase":"Pending"}}],"serviceName":"rabbitmq-cluster-nodes","podManagementPolicy":"Parallel","updateStrategy":{"type":"RollingUpdate","rollingUpdate":{"partition":0}},"revisionHistoryLimit":10},"status":{"observedGeneration":1,"replicas":1,"readyReplicas":1,"currentReplicas":1,"updatedReplicas":1,"currentRevision":"rabbitmq-cluster-server-5f8b8665fb","updateRevision":"rabbitmq-cluster-server-5f8b8665fb","collisionCount":0}}
2022/03/18 18:01:18 learn_server.go:291: [SIEVE-AFTER-READ]	Get	true	statefulset	default	rabbitmq-cluster-server	github.com/rabbitmq/cluster-operator/controllers.(*RabbitmqClusterReconciler)	NoError	{"kind":"StatefulSet","apiVersion":"apps/v1","metadata":{"name":"rabbitmq-cluster-server","namespace":"default","selfLink":"/apis/apps/v1/namespaces/default/statefulsets/rabbitmq-cluster-server","uid":"cb5c43bc-6ee7-481c-ab01-6f3acffdd3c8","resourceVersion":"948","generation":1,"creationTimestamp":"2022-03-18T18:00:38Z","labels":{"app.kubernetes.io/component":"rabbitmq","app.kubernetes.io/name":"rabbitmq-cluster","app.kubernetes.io/part-of":"rabbitmq"},"ownerReferences":[{"apiVersion":"rabbitmq.com/v1beta1","kind":"RabbitmqCluster","name":"rabbitmq-cluster","uid":"18d9928b-0d1c-47be-80ec-20960d053827","controller":true,"blockOwnerDeletion":true}],"managedFields":[{"manager":"manager","operation":"Update","apiVersion":"apps/v1","time":"2022-03-18T18:00:38Z","fieldsType":"FieldsV1","fieldsV1":{"f:metadata":{"f:labels":{".":{},"f:app.kubernetes.io/component":{},"f:app.kubernetes.io/name":{},"f:app.kubernetes.io/part-of":{}},"f:ownerReferences":{".":{},"k:{\"uid\":\"18d9928b-0d1c-47be-80ec-20960d053827\"}":{".":{},"f:apiVersion":{},"f:blockOwnerDeletion":{},"f:controller":{},"f:kind":{},"f:name":{},"f:uid":{}}}},"f:spec":{"f:podManagementPolicy":{},"f:replicas":{},"f:revisionHistoryLimit":{},"f:selector":{"f:matchLabels":{".":{},"f:app.kubernetes.io/name":{}}},"f:serviceName":{},"f:template":{"f:metadata":{"f:annotations":{".":{},"f:prometheus.io/port":{},"f:prometheus.io/scrape":{}},"f:labels":{".":{},"f:app.kubernetes.io/component":{},"f:app.kubernetes.io/name":{},"f:app.kubernetes.io/part-of":{}}},"f:spec":{"f:automountServiceAccountToken":{},"f:containers":{"k:{\"name\":\"rabbitmq\"}":{".":{},"f:env":{".":{},"k:{\"name\":\"K8S_HOSTNAME_SUFFIX\"}":{".":{},"f:name":{},"f:value":{}},"k:{\"name\":\"K8S_SERVICE_NAME\"}":{".":{},"f:name":{},"f:value":{}},"k:{\"name\":\"MY_POD_NAME\"}":{".":{},"f:name":{},"f:valueFrom":{".":{},"f:fieldRef":{".":{},"f:apiVersion":{},"f:fieldPath":{}}}},"k:{\"name\":\"MY_POD_NAMESPACE\"}":{".":{},"f:name":{},"f:valueFrom":{".":{},"f:fieldRef":{".":{},"f:apiVersion":{},"f:fieldPath":{}}}},"k:{\"name\":\"RABBITMQ_ENABLED_PLUGINS_FILE\"}":{".":{},"f:name":{},"f:value":{}},"k:{\"name\":\"RABBITMQ_NODENAME\"}":{".":{},"f:name":{},"f:value":{}},"k:{\"name\":\"RABBITMQ_USE_LONGNAME\"}":{".":{},"f:name":{},"f:value":{}}},"f:image":{},"f:imagePullPolicy":{},"f:lifecycle":{".":{},"f:preStop":{".":{},"f:exec":{".":{},"f:command":{}}}},"f:name":{},"f:ports":{".":{},"k:{\"containerPort\":4369,\"protocol\":\"TCP\"}":{".":{},"f:containerPort":{},"f:name":{},"f:protocol":{}},"k:{\"containerPort\":5672,\"protocol\":\"TCP\"}":{".":{},"f:containerPort":{},"f:name":{},"f:protocol":{}},"k:{\"containerPort\":15672,\"protocol\":\"TCP\"}":{".":{},"f:containerPort":{},"f:name":{},"f:protocol":{}},"k:{\"containerPort\":15692,\"protocol\":\"TCP\"}":{".":{},"f:containerPort":{},"f:name":{},"f:protocol":{}}},"f:readinessProbe":{".":{},"f:failureThreshold":{},"f:initialDelaySeconds":{},"f:periodSeconds":{},"f:successThreshold":{},"f:tcpSocket":{".":{},"f:port":{}},"f:timeoutSeconds":{}},"f:resources":{".":{},"f:limits":{".":{},"f:cpu":{},"f:memory":{}},"f:requests":{".":{},"f:cpu":{},"f:memory":{}}},"f:terminationMessagePath":{},"f:terminationMessagePolicy":{},"f:volumeMounts":{".":{},"k:{\"mountPath\":\"/etc/pod-info/\"}":{".":{},"f:mountPath":{},"f:name":{}},"k:{\"mountPath\":\"/etc/rabbitmq/conf.d/10-operatorDefaults.conf\"}":{".":{},"f:mountPath":{},"f:name":{},"f:subPath":{}},"k:{\"mountPath\":\"/etc/rabbitmq/conf.d/11-default_user.conf\"}":{".":{},"f:mountPath":{},"f:name":{},"f:subPath":{}},"k:{\"mountPath\":\"/etc/rabbitmq/conf.d/90-userDefinedConfiguration.conf\"}":{".":{},"f:mountPath":{},"f:name":{},"f:subPath":{}},"k:{\"mountPath\":\"/operator\"}":{".":{},"f:mountPath":{},"f:name":{}},"k:{\"mountPath\":\"/var/lib/rabbitmq/\"}":{".":{},"f:mountPath":{},"f:name":{}},"k:{\"mountPath\":\"/var/lib/rabbitmq/mnesia/\"}":{".":{},"f:mountPath":{},"f:name":{}}}}},"f:dnsPolicy":{},"f:initContainers":{".":{},"k:{\"name\":\"setup-container\"}":{".":{},"f:command":{},"f:image":{},"f:imagePullPolicy":{},"f:name":{},"f:resources":{".":{},"f:limits":{".":{},"f:cpu":{},"f:memory":{}},"f:requests":{".":{},"f:cpu":{},"f:memory":{}}},"f:securityContext":{".":{},"f:capabilities":{".":{},"f:drop":{}},"f:runAsUser":{}},"f:terminationMessagePath":{},"f:terminationMessagePolicy":{},"f:volumeMounts":{".":{},"k:{\"mountPath\":\"/operator\"}":{".":{},"f:mountPath":{},"f:name":{}},"k:{\"mountPath\":\"/tmp/default_user.conf\"}":{".":{},"f:mountPath":{},"f:name":{},"f:subPath":{}},"k:{\"mountPath\":\"/tmp/erlang-cookie-secret/\"}":{".":{},"f:mountPath":{},"f:name":{}},"k:{\"mountPath\":\"/tmp/rabbitmq-plugins/\"}":{".":{},"f:mountPath":{},"f:name":{}},"k:{\"mountPath\":\"/var/lib/rabbitmq/\"}":{".":{},"f:mountPath":{},"f:name":{}},"k:{\"mountPath\":\"/var/lib/rabbitmq/mnesia/\"}":{".":{},"f:mountPath":{},"f:name":{}}}}},"f:restartPolicy":{},"f:schedulerName":{},"f:securityContext":{".":{},"f:fsGroup":{},"f:runAsGroup":{},"f:runAsUser":{}},"f:serviceAccount":{},"f:serviceAccountName":{},"f:terminationGracePeriodSeconds":{},"f:topologySpreadConstraints":{".":{},"k:{\"topologyKey\":\"topology.kubernetes.io/zone\",\"whenUnsatisfiable\":\"ScheduleAnyway\"}":{".":{},"f:labelSelector":{".":{},"f:matchLabels":{".":{},"f:app.kubernetes.io/name":{}}},"f:maxSkew":{},"f:topologyKey":{},"f:whenUnsatisfiable":{}}},"f:volumes":{".":{},"k:{\"name\":\"erlang-cookie-secret\"}":{".":{},"f:name":{},"f:secret":{".":{},"f:defaultMode":{},"f:secretName":{}}},"k:{\"name\":\"plugins-conf\"}":{".":{},"f:configMap":{".":{},"f:defaultMode":{},"f:name":{}},"f:name":{}},"k:{\"name\":\"pod-info\"}":{".":{},"f:downwardAPI":{".":{},"f:defaultMode":{},"f:items":{}},"f:name":{}},"k:{\"name\":\"rabbitmq-confd\"}":{".":{},"f:name":{},"f:projected":{".":{},"f:defaultMode":{},"f:sources":{}}},"k:{\"name\":\"rabbitmq-erlang-cookie\"}":{".":{},"f:emptyDir":{},"f:name":{}},"k:{\"name\":\"rabbitmq-plugins\"}":{".":{},"f:emptyDir":{},"f:name":{}}}}},"f:updateStrategy":{"f:rollingUpdate":{".":{},"f:partition":{}},"f:type":{}},"f:volumeClaimTemplates":{}}}},{"manager":"kube-controller-manager","operation":"Update","apiVersion":"apps/v1","time":"2022-03-18T18:01:17Z","fieldsType":"FieldsV1","fieldsV1":{"f:status":{"f:collisionCount":{},"f:currentReplicas":{},"f:currentRevision":{},"f:observedGeneration":{},"f:readyReplicas":{},"f:replicas":{},"f:updateRevision":{},"f:updatedReplicas":{}}}}]},"spec":{"replicas":1,"selector":{"matchLabels":{"app.kubernetes.io/name":"rabbitmq-cluster"}},"template":{"metadata":{"creationTimestamp":null,"labels":{"app.kubernetes.io/component":"rabbitmq","app.kubernetes.io/name":"rabbitmq-cluster","app.kubernetes.io/part-of":"rabbitmq"},"annotations":{"prometheus.io/port":"15692","prometheus.io/scrape":"true"}},"spec":{"volumes":[{"name":"plugins-conf","configMap":{"name":"rabbitmq-cluster-plugins-conf","defaultMode":420}},{"name":"rabbitmq-confd","projected":{"sources":[{"secret":{"name":"rabbitmq-cluster-default-user","items":[{"key":"default_user.conf","path":"default_user.conf"}]}},{"configMap":{"name":"rabbitmq-cluster-server-conf","items":[{"key":"operatorDefaults.conf","path":"operatorDefaults.conf"},{"key":"userDefinedConfiguration.conf","path":"userDefinedConfiguration.conf"}]}}],"defaultMode":420}},{"name":"rabbitmq-erlang-cookie","emptyDir":{}},{"name":"erlang-cookie-secret","secret":{"secretName":"rabbitmq-cluster-erlang-cookie","defaultMode":420}},{"name":"rabbitmq-plugins","emptyDir":{}},{"name":"pod-info","downwardAPI":{"items":[{"path":"skipPreStopChecks","fieldRef":{"apiVersion":"v1","fieldPath":"metadata.labels['skipPreStopChecks']"}}],"defaultMode":420}}],"initContainers":[{"name":"setup-container","image":"rabbitmq:3.8.12-management","command":["sh","-c","cp /tmp/erlang-cookie-secret/.erlang.cookie /var/lib/rabbitmq/.erlang.cookie \u0026\u0026 chown 999:999 /var/lib/rabbitmq/.erlang.cookie \u0026\u0026 chmod 600 /var/lib/rabbitmq/.erlang.cookie ; cp /tmp/rabbitmq-plugins/enabled_plugins /operator/enabled_plugins \u0026\u0026 chown 999:999 /operator/enabled_plugins ; chown 999:999 /var/lib/rabbitmq/mnesia/ ; echo '[default]' \u003e /var/lib/rabbitmq/.rabbitmqadmin.conf \u0026\u0026 sed -e 's/default_user/username/' -e 's/default_pass/password/' /tmp/default_user.conf \u003e\u003e /var/lib/rabbitmq/.rabbitmqadmin.conf \u0026\u0026 chown 999:999 /var/lib/rabbitmq/.rabbitmqadmin.conf \u0026\u0026 chmod 600 /var/lib/rabbitmq/.rabbitmqadmin.conf"],"resources":{"limits":{"cpu":"100m","memory":"500Mi"},"requests":{"cpu":"100m","memory":"500Mi"}},"volumeMounts":[{"name":"plugins-conf","mountPath":"/tmp/rabbitmq-plugins/"},{"name":"rabbitmq-erlang-cookie","mountPath":"/var/lib/rabbitmq/"},{"name":"erlang-cookie-secret","mountPath":"/tmp/erlang-cookie-secret/"},{"name":"rabbitmq-plugins","mountPath":"/operator"},{"name":"persistence","mountPath":"/var/lib/rabbitmq/mnesia/"},{"name":"rabbitmq-confd","mountPath":"/tmp/default_user.conf","subPath":"default_user.conf"}],"terminationMessagePath":"/dev/termination-log","terminationMessagePolicy":"File","imagePullPolicy":"IfNotPresent","securityContext":{"capabilities":{"drop":["FSETID","KILL","SETGID","SETUID","SETPCAP","NET_BIND_SERVICE","NET_RAW","SYS_CHROOT","MKNOD","AUDIT_WRITE","SETFCAP"]},"runAsUser":0}}],"containers":[{"name":"rabbitmq","image":"rabbitmq:3.8.12-management","ports":[{"name":"epmd","containerPort":4369,"protocol":"TCP"},{"name":"amqp","containerPort":5672,"protocol":"TCP"},{"name":"management","containerPort":15672,"protocol":"TCP"},{"name":"prometheus","containerPort":15692,"protocol":"TCP"}],"env":[{"name":"MY_POD_NAME","valueFrom":{"fieldRef":{"apiVersion":"v1","fieldPath":"metadata.name"}}},{"name":"MY_POD_NAMESPACE","valueFrom":{"fieldRef":{"apiVersion":"v1","fieldPath":"metadata.namespace"}}},{"name":"RABBITMQ_ENABLED_PLUGINS_FILE","value":"/operator/enabled_plugins"},{"name":"K8S_SERVICE_NAME","value":"rabbitmq-cluster-nodes"},{"name":"RABBITMQ_USE_LONGNAME","value":"true"},{"name":"RABBITMQ_NODENAME","value":"rabbit@$(MY_POD_NAME).$(K8S_SERVICE_NAME).$(MY_POD_NAMESPACE)"},{"name":"K8S_HOSTNAME_SUFFIX","value":".$(K8S_SERVICE_NAME).$(MY_POD_NAMESPACE)"}],"resources":{"limits":{"cpu":"2","memory":"2Gi"},"requests":{"cpu":"1","memory":"2Gi"}},"volumeMounts":[{"name":"rabbitmq-erlang-cookie","mountPath":"/var/lib/rabbitmq/"},{"name":"persistence","mountPath":"/var/lib/rabbitmq/mnesia/"},{"name":"rabbitmq-plugins","mountPath":"/operator"},{"name":"rabbitmq-confd","mountPath":"/etc/rabbitmq/conf.d/10-operatorDefaults.conf","subPath":"operatorDefaults.conf"},{"name":"rabbitmq-confd","mountPath":"/etc/rabbitmq/conf.d/11-default_user.conf","subPath":"default_user.conf"},{"name":"rabbitmq-confd","mountPath":"/etc/rabbitmq/conf.d/90-userDefinedConfiguration.conf","subPath":"userDefinedConfiguration.conf"},{"name":"pod-info","mountPath":"/etc/pod-info/"}],"readinessProbe":{"tcpSocket":{"port":"amqp"},"initialDelaySeconds":10,"timeoutSeconds":5,"periodSeconds":10,"successThreshold":1,"failureThreshold":3},"lifecycle":{"preStop":{"exec":{"command":["/bin/bash","-c","if [ ! -z \"$(cat /etc/pod-info/skipPreStopChecks)\" ]; then exit 0; fi; rabbitmq-upgrade await_online_quorum_plus_one -t 604800; rabbitmq-upgrade await_online_synchronized_mirror -t 604800; rabbitmq-upgrade drain -t 604800"]}}},"terminationMessagePath":"/dev/termination-log","terminationMessagePolicy":"File","imagePullPolicy":"IfNotPresent"}],"restartPolicy":"Always","terminationGracePeriodSeconds":604800,"dnsPolicy":"ClusterFirst","serviceAccountName":"rabbitmq-cluster-server","serviceAccount":"rabbitmq-cluster-server","automountServiceAccountToken":true,"securityContext":{"runAsUser":999,"runAsGroup":999,"fsGroup":999},"schedulerName":"default-scheduler","topologySpreadConstraints":[{"maxSkew":1,"topologyKey":"topology.kubernetes.io/zone","whenUnsatisfiable":"ScheduleAnyway","labelSelector":{"matchLabels":{"app.kubernetes.io/name":"rabbitmq-cluster"}}}]}},"volumeClaimTemplates":[{"metadata":{"name":"persistence","namespace":"default","creationTimestamp":null,"labels":{"app.kubernetes.io/component":"rabbitmq","app.kubernetes.io/name":"rabbitmq-cluster","app.kubernetes.io/part-of":"rabbitmq"},"ownerReferences":[{"apiVersion":"rabbitmq.com/v1beta1","kind":"RabbitmqCluster","name":"rabbitmq-cluster","uid":"18d9928b-0d1c-47be-80ec-20960d053827","controller":true,"blockOwnerDeletion":false}]},"spec":{"accessModes":["ReadWriteOnce"],"resources":{"requests":{"storage":"10Gi"}},"volumeMode":"Filesystem"},"status":{"phase":"Pending"}}],"serviceName":"rabbitmq-cluster-nodes","podManagementPolicy":"Parallel","updateStrategy":{"type":"RollingUpdate","rollingUpdate":{"partition":0}},"revisionHistoryLimit":10},"status":{"observedGeneration":1,"replicas":1,"readyReplicas":1,"currentReplicas":1,"updatedReplicas":1,"currentRevision":"rabbitmq-cluster-server-5f8b8665fb","updateRevision":"rabbitmq-cluster-server-5f8b8665fb","collisionCount":0}}
2022/03/18 18:01:18 learn_server.go:256: [SIEVE-BEFORE-WRITE]	30
2022/03/18 18:01:18 learn_server.go:263: [SIEVE-AFTER-WRITE]	30	Update	statefulset	github.com/rabbitmq/cluster-operator/controllers.(*RabbitmqClusterReconciler)	NoError	{"metadata":{"name":"rabbitmq-cluster-server","namespace":"default","selfLink":"/apis/apps/v1/namespaces/default/statefulsets/rabbitmq-cluster-server","uid":"cb5c43bc-6ee7-481c-ab01-6f3acffdd3c8","resourceVersion":"948","generation":1,"creationTimestamp":"2022-03-18T18:00:38Z","labels":{"app.kubernetes.io/component":"rabbitmq","app.kubernetes.io/name":"rabbitmq-cluster","app.kubernetes.io/part-of":"rabbitmq"},"ownerReferences":[{"apiVersion":"rabbitmq.com/v1beta1","kind":"RabbitmqCluster","name":"rabbitmq-cluster","uid":"18d9928b-0d1c-47be-80ec-20960d053827","controller":true,"blockOwnerDeletion":true}],"managedFields":[{"manager":"manager","operation":"Update","apiVersion":"apps/v1","time":"2022-03-18T18:00:38Z","fieldsType":"FieldsV1","fieldsV1":{"f:metadata":{"f:labels":{".":{},"f:app.kubernetes.io/component":{},"f:app.kubernetes.io/name":{},"f:app.kubernetes.io/part-of":{}},"f:ownerReferences":{".":{},"k:{\"uid\":\"18d9928b-0d1c-47be-80ec-20960d053827\"}":{".":{},"f:apiVersion":{},"f:blockOwnerDeletion":{},"f:controller":{},"f:kind":{},"f:name":{},"f:uid":{}}}},"f:spec":{"f:podManagementPolicy":{},"f:replicas":{},"f:revisionHistoryLimit":{},"f:selector":{"f:matchLabels":{".":{},"f:app.kubernetes.io/name":{}}},"f:serviceName":{},"f:template":{"f:metadata":{"f:annotations":{".":{},"f:prometheus.io/port":{},"f:prometheus.io/scrape":{}},"f:labels":{".":{},"f:app.kubernetes.io/component":{},"f:app.kubernetes.io/name":{},"f:app.kubernetes.io/part-of":{}}},"f:spec":{"f:automountServiceAccountToken":{},"f:containers":{"k:{\"name\":\"rabbitmq\"}":{".":{},"f:env":{".":{},"k:{\"name\":\"K8S_HOSTNAME_SUFFIX\"}":{".":{},"f:name":{},"f:value":{}},"k:{\"name\":\"K8S_SERVICE_NAME\"}":{".":{},"f:name":{},"f:value":{}},"k:{\"name\":\"MY_POD_NAME\"}":{".":{},"f:name":{},"f:valueFrom":{".":{},"f:fieldRef":{".":{},"f:apiVersion":{},"f:fieldPath":{}}}},"k:{\"name\":\"MY_POD_NAMESPACE\"}":{".":{},"f:name":{},"f:valueFrom":{".":{},"f:fieldRef":{".":{},"f:apiVersion":{},"f:fieldPath":{}}}},"k:{\"name\":\"RABBITMQ_ENABLED_PLUGINS_FILE\"}":{".":{},"f:name":{},"f:value":{}},"k:{\"name\":\"RABBITMQ_NODENAME\"}":{".":{},"f:name":{},"f:value":{}},"k:{\"name\":\"RABBITMQ_USE_LONGNAME\"}":{".":{},"f:name":{},"f:value":{}}},"f:image":{},"f:imagePullPolicy":{},"f:lifecycle":{".":{},"f:preStop":{".":{},"f:exec":{".":{},"f:command":{}}}},"f:name":{},"f:ports":{".":{},"k:{\"containerPort\":4369,\"protocol\":\"TCP\"}":{".":{},"f:containerPort":{},"f:name":{},"f:protocol":{}},"k:{\"containerPort\":5672,\"protocol\":\"TCP\"}":{".":{},"f:containerPort":{},"f:name":{},"f:protocol":{}},"k:{\"containerPort\":15672,\"protocol\":\"TCP\"}":{".":{},"f:containerPort":{},"f:name":{},"f:protocol":{}},"k:{\"containerPort\":15692,\"protocol\":\"TCP\"}":{".":{},"f:containerPort":{},"f:name":{},"f:protocol":{}}},"f:readinessProbe":{".":{},"f:failureThreshold":{},"f:initialDelaySeconds":{},"f:periodSeconds":{},"f:successThreshold":{},"f:tcpSocket":{".":{},"f:port":{}},"f:timeoutSeconds":{}},"f:resources":{".":{},"f:limits":{".":{},"f:cpu":{},"f:memory":{}},"f:requests":{".":{},"f:cpu":{},"f:memory":{}}},"f:terminationMessagePath":{},"f:terminationMessagePolicy":{},"f:volumeMounts":{".":{},"k:{\"mountPath\":\"/etc/pod-info/\"}":{".":{},"f:mountPath":{},"f:name":{}},"k:{\"mountPath\":\"/etc/rabbitmq/conf.d/10-operatorDefaults.conf\"}":{".":{},"f:mountPath":{},"f:name":{},"f:subPath":{}},"k:{\"mountPath\":\"/etc/rabbitmq/conf.d/11-default_user.conf\"}":{".":{},"f:mountPath":{},"f:name":{},"f:subPath":{}},"k:{\"mountPath\":\"/etc/rabbitmq/conf.d/90-userDefinedConfiguration.conf\"}":{".":{},"f:mountPath":{},"f:name":{},"f:subPath":{}},"k:{\"mountPath\":\"/operator\"}":{".":{},"f:mountPath":{},"f:name":{}},"k:{\"mountPath\":\"/var/lib/rabbitmq/\"}":{".":{},"f:mountPath":{},"f:name":{}},"k:{\"mountPath\":\"/var/lib/rabbitmq/mnesia/\"}":{".":{},"f:mountPath":{},"f:name":{}}}}},"f:dnsPolicy":{},"f:initContainers":{".":{},"k:{\"name\":\"setup-container\"}":{".":{},"f:command":{},"f:image":{},"f:imagePullPolicy":{},"f:name":{},"f:resources":{".":{},"f:limits":{".":{},"f:cpu":{},"f:memory":{}},"f:requests":{".":{},"f:cpu":{},"f:memory":{}}},"f:securityContext":{".":{},"f:capabilities":{".":{},"f:drop":{}},"f:runAsUser":{}},"f:terminationMessagePath":{},"f:terminationMessagePolicy":{},"f:volumeMounts":{".":{},"k:{\"mountPath\":\"/operator\"}":{".":{},"f:mountPath":{},"f:name":{}},"k:{\"mountPath\":\"/tmp/default_user.conf\"}":{".":{},"f:mountPath":{},"f:name":{},"f:subPath":{}},"k:{\"mountPath\":\"/tmp/erlang-cookie-secret/\"}":{".":{},"f:mountPath":{},"f:name":{}},"k:{\"mountPath\":\"/tmp/rabbitmq-plugins/\"}":{".":{},"f:mountPath":{},"f:name":{}},"k:{\"mountPath\":\"/var/lib/rabbitmq/\"}":{".":{},"f:mountPath":{},"f:name":{}},"k:{\"mountPath\":\"/var/lib/rabbitmq/mnesia/\"}":{".":{},"f:mountPath":{},"f:name":{}}}}},"f:restartPolicy":{},"f:schedulerName":{},"f:securityContext":{".":{},"f:fsGroup":{},"f:runAsGroup":{},"f:runAsUser":{}},"f:serviceAccount":{},"f:serviceAccountName":{},"f:terminationGracePeriodSeconds":{},"f:topologySpreadConstraints":{".":{},"k:{\"topologyKey\":\"topology.kubernetes.io/zone\",\"whenUnsatisfiable\":\"ScheduleAnyway\"}":{".":{},"f:labelSelector":{".":{},"f:matchLabels":{".":{},"f:app.kubernetes.io/name":{}}},"f:maxSkew":{},"f:topologyKey":{},"f:whenUnsatisfiable":{}}},"f:volumes":{".":{},"k:{\"name\":\"erlang-cookie-secret\"}":{".":{},"f:name":{},"f:secret":{".":{},"f:defaultMode":{},"f:secretName":{}}},"k:{\"name\":\"plugins-conf\"}":{".":{},"f:configMap":{".":{},"f:defaultMode":{},"f:name":{}},"f:name":{}},"k:{\"name\":\"pod-info\"}":{".":{},"f:downwardAPI":{".":{},"f:defaultMode":{},"f:items":{}},"f:name":{}},"k:{\"name\":\"rabbitmq-confd\"}":{".":{},"f:name":{},"f:projected":{".":{},"f:defaultMode":{},"f:sources":{}}},"k:{\"name\":\"rabbitmq-erlang-cookie\"}":{".":{},"f:emptyDir":{},"f:name":{}},"k:{\"name\":\"rabbitmq-plugins\"}":{".":{},"f:emptyDir":{},"f:name":{}}}}},"f:updateStrategy":{"f:rollingUpdate":{".":{},"f:partition":{}},"f:type":{}},"f:volumeClaimTemplates":{}}}},{"manager":"kube-controller-manager","operation":"Update","apiVersion":"apps/v1","time":"2022-03-18T18:01:17Z","fieldsType":"FieldsV1","fieldsV1":{"f:status":{"f:collisionCount":{},"f:currentReplicas":{},"f:currentRevision":{},"f:observedGeneration":{},"f:readyReplicas":{},"f:replicas":{},"f:updateRevision":{},"f:updatedReplicas":{}}}}]},"spec":{"replicas":1,"selector":{"matchLabels":{"app.kubernetes.io/name":"rabbitmq-cluster"}},"template":{"metadata":{"creationTimestamp":null,"labels":{"app.kubernetes.io/component":"rabbitmq","app.kubernetes.io/name":"rabbitmq-cluster","app.kubernetes.io/part-of":"rabbitmq"},"annotations":{"prometheus.io/port":"15692","prometheus.io/scrape":"true"}},"spec":{"volumes":[{"name":"plugins-conf","configMap":{"name":"rabbitmq-cluster-plugins-conf","defaultMode":420}},{"name":"rabbitmq-confd","projected":{"sources":[{"secret":{"name":"rabbitmq-cluster-default-user","items":[{"key":"default_user.conf","path":"default_user.conf"}]}},{"configMap":{"name":"rabbitmq-cluster-server-conf","items":[{"key":"operatorDefaults.conf","path":"operatorDefaults.conf"},{"key":"userDefinedConfiguration.conf","path":"userDefinedConfiguration.conf"}]}}],"defaultMode":420}},{"name":"rabbitmq-erlang-cookie","emptyDir":{}},{"name":"erlang-cookie-secret","secret":{"secretName":"rabbitmq-cluster-erlang-cookie","defaultMode":420}},{"name":"rabbitmq-plugins","emptyDir":{}},{"name":"pod-info","downwardAPI":{"items":[{"path":"skipPreStopChecks","fieldRef":{"apiVersion":"v1","fieldPath":"metadata.labels['skipPreStopChecks']"}}],"defaultMode":420}}],"initContainers":[{"name":"setup-container","image":"rabbitmq:3.8.12-management","command":["sh","-c","cp /tmp/erlang-cookie-secret/.erlang.cookie /var/lib/rabbitmq/.erlang.cookie \u0026\u0026 chown 999:999 /var/lib/rabbitmq/.erlang.cookie \u0026\u0026 chmod 600 /var/lib/rabbitmq/.erlang.cookie ; cp /tmp/rabbitmq-plugins/enabled_plugins /operator/enabled_plugins \u0026\u0026 chown 999:999 /operator/enabled_plugins ; chown 999:999 /var/lib/rabbitmq/mnesia/ ; echo '[default]' \u003e /var/lib/rabbitmq/.rabbitmqadmin.conf \u0026\u0026 sed -e 's/default_user/username/' -e 's/default_pass/password/' /tmp/default_user.conf \u003e\u003e /var/lib/rabbitmq/.rabbitmqadmin.conf \u0026\u0026 chown 999:999 /var/lib/rabbitmq/.rabbitmqadmin.conf \u0026\u0026 chmod 600 /var/lib/rabbitmq/.rabbitmqadmin.conf"],"resources":{"limits":{"cpu":"100m","memory":"500Mi"},"requests":{"cpu":"100m","memory":"500Mi"}},"volumeMounts":[{"name":"plugins-conf","mountPath":"/tmp/rabbitmq-plugins/"},{"name":"rabbitmq-erlang-cookie","mountPath":"/var/lib/rabbitmq/"},{"name":"erlang-cookie-secret","mountPath":"/tmp/erlang-cookie-secret/"},{"name":"rabbitmq-plugins","mountPath":"/operator"},{"name":"persistence","mountPath":"/var/lib/rabbitmq/mnesia/"},{"name":"rabbitmq-confd","mountPath":"/tmp/default_user.conf","subPath":"default_user.conf"}],"terminationMessagePath":"/dev/termination-log","terminationMessagePolicy":"File","imagePullPolicy":"IfNotPresent","securityContext":{"capabilities":{"drop":["FSETID","KILL","SETGID","SETUID","SETPCAP","NET_BIND_SERVICE","NET_RAW","SYS_CHROOT","MKNOD","AUDIT_WRITE","SETFCAP"]},"runAsUser":0}}],"containers":[{"name":"rabbitmq","image":"rabbitmq:3.8.12-management","ports":[{"name":"epmd","containerPort":4369,"protocol":"TCP"},{"name":"amqp","containerPort":5672,"protocol":"TCP"},{"name":"management","containerPort":15672,"protocol":"TCP"},{"name":"prometheus","containerPort":15692,"protocol":"TCP"}],"env":[{"name":"MY_POD_NAME","valueFrom":{"fieldRef":{"apiVersion":"v1","fieldPath":"metadata.name"}}},{"name":"MY_POD_NAMESPACE","valueFrom":{"fieldRef":{"apiVersion":"v1","fieldPath":"metadata.namespace"}}},{"name":"RABBITMQ_ENABLED_PLUGINS_FILE","value":"/operator/enabled_plugins"},{"name":"K8S_SERVICE_NAME","value":"rabbitmq-cluster-nodes"},{"name":"RABBITMQ_USE_LONGNAME","value":"true"},{"name":"RABBITMQ_NODENAME","value":"rabbit@$(MY_POD_NAME).$(K8S_SERVICE_NAME).$(MY_POD_NAMESPACE)"},{"name":"K8S_HOSTNAME_SUFFIX","value":".$(K8S_SERVICE_NAME).$(MY_POD_NAMESPACE)"}],"resources":{"limits":{"cpu":"2","memory":"2Gi"},"requests":{"cpu":"1","memory":"2Gi"}},"volumeMounts":[{"name":"rabbitmq-erlang-cookie","mountPath":"/var/lib/rabbitmq/"},{"name":"persistence","mountPath":"/var/lib/rabbitmq/mnesia/"},{"name":"rabbitmq-plugins","mountPath":"/operator"},{"name":"rabbitmq-confd","mountPath":"/etc/rabbitmq/conf.d/10-operatorDefaults.conf","subPath":"operatorDefaults.conf"},{"name":"rabbitmq-confd","mountPath":"/etc/rabbitmq/conf.d/11-default_user.conf","subPath":"default_user.conf"},{"name":"rabbitmq-confd","mountPath":"/etc/rabbitmq/conf.d/90-userDefinedConfiguration.conf","subPath":"userDefinedConfiguration.conf"},{"name":"pod-info","mountPath":"/etc/pod-info/"}],"readinessProbe":{"tcpSocket":{"port":"amqp"},"initialDelaySeconds":10,"timeoutSeconds":5,"periodSeconds":10,"successThreshold":1,"failureThreshold":3},"lifecycle":{"preStop":{"exec":{"command":["/bin/bash","-c","if [ ! -z \"$(cat /etc/pod-info/skipPreStopChecks)\" ]; then exit 0; fi; rabbitmq-upgrade await_online_quorum_plus_one -t 604800; rabbitmq-upgrade await_online_synchronized_mirror -t 604800; rabbitmq-upgrade drain -t 604800"]}}},"terminationMessagePath":"/dev/termination-log","terminationMessagePolicy":"File","imagePullPolicy":"IfNotPresent"}],"restartPolicy":"Always","terminationGracePeriodSeconds":604800,"dnsPolicy":"ClusterFirst","serviceAccountName":"rabbitmq-cluster-server","serviceAccount":"rabbitmq-cluster-server","automountServiceAccountToken":true,"securityContext":{"runAsUser":999,"runAsGroup":999,"fsGroup":999},"schedulerName":"default-scheduler","topologySpreadConstraints":[{"maxSkew":1,"topologyKey":"topology.kubernetes.io/zone","whenUnsatisfiable":"ScheduleAnyway","labelSelector":{"matchLabels":{"app.kubernetes.io/name":"rabbitmq-cluster"}}}]}},"volumeClaimTemplates":[{"metadata":{"name":"persistence","namespace":"default","creationTimestamp":null,"labels":{"app.kubernetes.io/component":"rabbitmq","app.kubernetes.io/name":"rabbitmq-cluster","app.kubernetes.io/part-of":"rabbitmq"},"ownerReferences":[{"apiVersion":"rabbitmq.com/v1beta1","kind":"RabbitmqCluster","name":"rabbitmq-cluster","uid":"18d9928b-0d1c-47be-80ec-20960d053827","controller":true,"blockOwnerDeletion":false}]},"spec":{"accessModes":["ReadWriteOnce"],"resources":{"requests":{"storage":"10Gi"}},"volumeMode":"Filesystem"},"status":{"phase":"Pending"}}],"serviceName":"rabbitmq-cluster-nodes","podManagementPolicy":"Parallel","updateStrategy":{"type":"RollingUpdate","rollingUpdate":{"partition":0}},"revisionHistoryLimit":10},"status":{"observedGeneration":1,"replicas":1,"readyReplicas":1,"currentReplicas":1,"updatedReplicas":1,"currentRevision":"rabbitmq-cluster-server-5f8b8665fb","updateRevision":"rabbitmq-cluster-server-5f8b8665fb","collisionCount":0}}
2022/03/18 18:01:18 learn_server.go:291: [SIEVE-AFTER-READ]	Get	true	configmap	default	rabbitmq-cluster-server-conf	github.com/rabbitmq/cluster-operator/controllers.(*RabbitmqClusterReconciler)	NoError	{"kind":"ConfigMap","apiVersion":"v1","metadata":{"name":"rabbitmq-cluster-server-conf","namespace":"default","selfLink":"/api/v1/namespaces/default/configmaps/rabbitmq-cluster-server-conf","uid":"22474f2b-8454-44b7-8079-8990223969cc","resourceVersion":"714","creationTimestamp":"2022-03-18T18:00:38Z","labels":{"app.kubernetes.io/component":"rabbitmq","app.kubernetes.io/name":"rabbitmq-cluster","app.kubernetes.io/part-of":"rabbitmq"},"ownerReferences":[{"apiVersion":"rabbitmq.com/v1beta1","kind":"RabbitmqCluster","name":"rabbitmq-cluster","uid":"18d9928b-0d1c-47be-80ec-20960d053827","controller":true,"blockOwnerDeletion":true}],"managedFields":[{"manager":"manager","operation":"Update","apiVersion":"v1","time":"2022-03-18T18:00:38Z","fieldsType":"FieldsV1","fieldsV1":{"f:data":{".":{},"f:operatorDefaults.conf":{},"f:userDefinedConfiguration.conf":{}},"f:metadata":{"f:labels":{".":{},"f:app.kubernetes.io/component":{},"f:app.kubernetes.io/name":{},"f:app.kubernetes.io/part-of":{}},"f:ownerReferences":{".":{},"k:{\"uid\":\"18d9928b-0d1c-47be-80ec-20960d053827\"}":{".":{},"f:apiVersion":{},"f:blockOwnerDeletion":{},"f:controller":{},"f:kind":{},"f:name":{},"f:uid":{}}}}}}]},"data":{"operatorDefaults.conf":"cluster_formation.peer_discovery_backend             = rabbit_peer_discovery_k8s\ncluster_formation.k8s.host                           = kubernetes.default\ncluster_formation.k8s.address_type                   = hostname\ncluster_partition_handling                           = pause_minority\nqueue_master_locator                                 = min-masters\ndisk_free_limit.absolute                             = 2GB\ncluster_formation.randomized_startup_delay_range.min = 5\ncluster_formation.randomized_startup_delay_range.max = 30\ncluster_name                                         = rabbitmq-cluster\n","userDefinedConfiguration.conf":"total_memory_available_override_value = 1717986919\n"}}
2022/03/18 18:01:18 learn_server.go:256: [SIEVE-BEFORE-WRITE]	31
2022/03/18 18:01:18 learn_server.go:263: [SIEVE-AFTER-WRITE]	31	StatusUpdate	rabbitmqcluster	github.com/rabbitmq/cluster-operator/controllers.(*RabbitmqClusterReconciler)	Conflict	{"kind":"RabbitmqCluster","apiVersion":"rabbitmq.com/v1beta1","metadata":{"name":"rabbitmq-cluster","namespace":"default","selfLink":"/apis/rabbitmq.com/v1beta1/namespaces/default/rabbitmqclusters/rabbitmq-cluster","uid":"18d9928b-0d1c-47be-80ec-20960d053827","resourceVersion":"944","generation":2,"creationTimestamp":"2022-03-18T18:00:38Z","annotations":{"kubectl.kubernetes.io/last-applied-configuration":"{\"apiVersion\":\"rabbitmq.com/v1beta1\",\"kind\":\"RabbitmqCluster\",\"metadata\":{\"annotations\":{},\"name\":\"rabbitmq-cluster\",\"namespace\":\"default\"},\"spec\":{\"persistence\":{\"storage\":\"10Gi\"},\"replicas\":1}}\n"},"finalizers":["deletion.finalizers.rabbitmqclusters.rabbitmq.com"],"managedFields":[{"manager":"kubectl-client-side-apply","operation":"Update","apiVersion":"rabbitmq.com/v1beta1","time":"2022-03-18T18:00:38Z","fieldsType":"FieldsV1","fieldsV1":{"f:metadata":{"f:annotations":{".":{},"f:kubectl.kubernetes.io/last-applied-configuration":{}}},"f:spec":{".":{},"f:image":{},"f:persistence":{".":{},"f:storage":{}},"f:replicas":{},"f:resources":{".":{},"f:limits":{".":{},"f:memory":{}},"f:requests":{".":{},"f:memory":{}}},"f:service":{".":{},"f:type":{}},"f:terminationGracePeriodSeconds":{}}}},{"manager":"manager","operation":"Update","apiVersion":"rabbitmq.com/v1beta1","time":"2022-03-18T18:01:17Z","fieldsType":"FieldsV1","fieldsV1":{"f:metadata":{"f:finalizers":{}},"f:spec":{"f:override":{},"f:rabbitmq":{},"f:resources":{"f:limits":{"f:cpu":{}},"f:requests":{"f:cpu":{}}},"f:tls":{}},"f:status":{".":{},"f:conditions":{},"f:defaultUser":{".":{},"f:secretReference":{".":{},"f:keys":{".":{},"f:password":{},"f:username":{}},"f:name":{},"f:namespace":{}},"f:serviceReference":{".":{},"f:name":{},"f:namespace":{}}}}}}]},"spec":{"replicas":1,"image":"rabbitmq:3.8.12-management","service":{"type":"ClusterIP"},"persistence":{"storage":"10Gi"},"resources":{"limits":{"cpu":"2","memory":"2Gi"},"requests":{"cpu":"1","memory":"2Gi"}},"rabbitmq":{},"tls":{},"override":{},"terminationGracePeriodSeconds":604800},"status":{"conditions":[{"type":"AllReplicasReady","status":"True","lastTransitionTime":"2022-03-18T18:01:17Z","reason":"AllPodsAreReady"},{"type":"ClusterAvailable","status":"True","lastTransitionTime":"2022-03-18T18:01:17Z","reason":"AtLeastOneEndpointAvailable"},{"type":"NoWarnings","status":"True","lastTransitionTime":"2022-03-18T18:00:38Z","reason":"NoWarnings"},{"type":"ReconcileSuccess","status":"Unknown","lastTransitionTime":"2022-03-18T18:00:38Z","reason":"Initialising"}],"defaultUser":{"secretReference":{"name":"rabbitmq-cluster-default-user","namespace":"default","keys":{"password":"password","username":"username"}},"serviceReference":{"name":"rabbitmq-cluster","namespace":"default"}},"binding":{"name":"rabbitmq-cluster-default-user"}}}
2022/03/18 18:01:18 learn_server.go:253: [SIEVE-AFTER-RECONCILE]	github.com/rabbitmq/cluster-operator/controllers.(*RabbitmqClusterReconciler)	6
2022/03/18 18:01:18 learn_server.go:238: [SIEVE-BEFORE-RECONCILE]	github.com/rabbitmq/cluster-operator/controllers.(*RabbitmqClusterReconciler)	7
2022/03/18 18:01:18 learn_server.go:291: [SIEVE-AFTER-READ]	Get	true	rabbitmqcluster	default	rabbitmq-cluster	github.com/rabbitmq/cluster-operator/controllers.(*RabbitmqClusterReconciler)	NoError	{"kind":"RabbitmqCluster","apiVersion":"rabbitmq.com/v1beta1","metadata":{"name":"rabbitmq-cluster","namespace":"default","selfLink":"/apis/rabbitmq.com/v1beta1/namespaces/default/rabbitmqclusters/rabbitmq-cluster","uid":"18d9928b-0d1c-47be-80ec-20960d053827","resourceVersion":"949","generation":2,"creationTimestamp":"2022-03-18T18:00:38Z","annotations":{"kubectl.kubernetes.io/last-applied-configuration":"{\"apiVersion\":\"rabbitmq.com/v1beta1\",\"kind\":\"RabbitmqCluster\",\"metadata\":{\"annotations\":{},\"name\":\"rabbitmq-cluster\",\"namespace\":\"default\"},\"spec\":{\"persistence\":{\"storage\":\"10Gi\"},\"replicas\":1}}\n"},"finalizers":["deletion.finalizers.rabbitmqclusters.rabbitmq.com"],"managedFields":[{"manager":"kubectl-client-side-apply","operation":"Update","apiVersion":"rabbitmq.com/v1beta1","time":"2022-03-18T18:00:38Z","fieldsType":"FieldsV1","fieldsV1":{"f:metadata":{"f:annotations":{".":{},"f:kubectl.kubernetes.io/last-applied-configuration":{}}},"f:spec":{".":{},"f:image":{},"f:persistence":{".":{},"f:storage":{}},"f:replicas":{},"f:resources":{".":{},"f:limits":{".":{},"f:memory":{}},"f:requests":{".":{},"f:memory":{}}},"f:service":{".":{},"f:type":{}},"f:terminationGracePeriodSeconds":{}}}},{"manager":"manager","operation":"Update","apiVersion":"rabbitmq.com/v1beta1","time":"2022-03-18T18:01:18Z","fieldsType":"FieldsV1","fieldsV1":{"f:metadata":{"f:finalizers":{}},"f:spec":{"f:override":{},"f:rabbitmq":{},"f:resources":{"f:limits":{"f:cpu":{}},"f:requests":{"f:cpu":{}}},"f:tls":{}},"f:status":{".":{},"f:conditions":{},"f:defaultUser":{".":{},"f:secretReference":{".":{},"f:keys":{".":{},"f:password":{},"f:username":{}},"f:name":{},"f:namespace":{}},"f:serviceReference":{".":{},"f:name":{},"f:namespace":{}}}}}}]},"spec":{"replicas":1,"image":"rabbitmq:3.8.12-management","service":{"type":"ClusterIP"},"persistence":{"storage":"10Gi"},"resources":{"limits":{"cpu":"2","memory":"2Gi"},"requests":{"cpu":"1","memory":"2Gi"}},"rabbitmq":{},"tls":{},"override":{},"terminationGracePeriodSeconds":604800},"status":{"conditions":[{"type":"AllReplicasReady","status":"True","lastTransitionTime":"2022-03-18T18:01:17Z","reason":"AllPodsAreReady"},{"type":"ClusterAvailable","status":"True","lastTransitionTime":"2022-03-18T18:01:17Z","reason":"AtLeastOneEndpointAvailable"},{"type":"NoWarnings","status":"True","lastTransitionTime":"2022-03-18T18:00:38Z","reason":"NoWarnings"},{"type":"ReconcileSuccess","status":"True","lastTransitionTime":"2022-03-18T18:01:18Z","reason":"Success","message":"Finish reconciling"}],"defaultUser":{"secretReference":{"name":"rabbitmq-cluster-default-user","namespace":"default","keys":{"password":"password","username":"username"}},"serviceReference":{"name":"rabbitmq-cluster","namespace":"default"}}}}
2022/03/18 18:01:18 learn_server.go:291: [SIEVE-AFTER-READ]	Get	true	statefulset	default	rabbitmq-cluster-server	github.com/rabbitmq/cluster-operator/controllers.(*RabbitmqClusterReconciler)	NoError	{"kind":"StatefulSet","apiVersion":"apps/v1","metadata":{"name":"rabbitmq-cluster-server","namespace":"default","selfLink":"/apis/apps/v1/namespaces/default/statefulsets/rabbitmq-cluster-server","uid":"cb5c43bc-6ee7-481c-ab01-6f3acffdd3c8","resourceVersion":"948","generation":1,"creationTimestamp":"2022-03-18T18:00:38Z","labels":{"app.kubernetes.io/component":"rabbitmq","app.kubernetes.io/name":"rabbitmq-cluster","app.kubernetes.io/part-of":"rabbitmq"},"ownerReferences":[{"apiVersion":"rabbitmq.com/v1beta1","kind":"RabbitmqCluster","name":"rabbitmq-cluster","uid":"18d9928b-0d1c-47be-80ec-20960d053827","controller":true,"blockOwnerDeletion":true}],"managedFields":[{"manager":"manager","operation":"Update","apiVersion":"apps/v1","time":"2022-03-18T18:00:38Z","fieldsType":"FieldsV1","fieldsV1":{"f:metadata":{"f:labels":{".":{},"f:app.kubernetes.io/component":{},"f:app.kubernetes.io/name":{},"f:app.kubernetes.io/part-of":{}},"f:ownerReferences":{".":{},"k:{\"uid\":\"18d9928b-0d1c-47be-80ec-20960d053827\"}":{".":{},"f:apiVersion":{},"f:blockOwnerDeletion":{},"f:controller":{},"f:kind":{},"f:name":{},"f:uid":{}}}},"f:spec":{"f:podManagementPolicy":{},"f:replicas":{},"f:revisionHistoryLimit":{},"f:selector":{"f:matchLabels":{".":{},"f:app.kubernetes.io/name":{}}},"f:serviceName":{},"f:template":{"f:metadata":{"f:annotations":{".":{},"f:prometheus.io/port":{},"f:prometheus.io/scrape":{}},"f:labels":{".":{},"f:app.kubernetes.io/component":{},"f:app.kubernetes.io/name":{},"f:app.kubernetes.io/part-of":{}}},"f:spec":{"f:automountServiceAccountToken":{},"f:containers":{"k:{\"name\":\"rabbitmq\"}":{".":{},"f:env":{".":{},"k:{\"name\":\"K8S_HOSTNAME_SUFFIX\"}":{".":{},"f:name":{},"f:value":{}},"k:{\"name\":\"K8S_SERVICE_NAME\"}":{".":{},"f:name":{},"f:value":{}},"k:{\"name\":\"MY_POD_NAME\"}":{".":{},"f:name":{},"f:valueFrom":{".":{},"f:fieldRef":{".":{},"f:apiVersion":{},"f:fieldPath":{}}}},"k:{\"name\":\"MY_POD_NAMESPACE\"}":{".":{},"f:name":{},"f:valueFrom":{".":{},"f:fieldRef":{".":{},"f:apiVersion":{},"f:fieldPath":{}}}},"k:{\"name\":\"RABBITMQ_ENABLED_PLUGINS_FILE\"}":{".":{},"f:name":{},"f:value":{}},"k:{\"name\":\"RABBITMQ_NODENAME\"}":{".":{},"f:name":{},"f:value":{}},"k:{\"name\":\"RABBITMQ_USE_LONGNAME\"}":{".":{},"f:name":{},"f:value":{}}},"f:image":{},"f:imagePullPolicy":{},"f:lifecycle":{".":{},"f:preStop":{".":{},"f:exec":{".":{},"f:command":{}}}},"f:name":{},"f:ports":{".":{},"k:{\"containerPort\":4369,\"protocol\":\"TCP\"}":{".":{},"f:containerPort":{},"f:name":{},"f:protocol":{}},"k:{\"containerPort\":5672,\"protocol\":\"TCP\"}":{".":{},"f:containerPort":{},"f:name":{},"f:protocol":{}},"k:{\"containerPort\":15672,\"protocol\":\"TCP\"}":{".":{},"f:containerPort":{},"f:name":{},"f:protocol":{}},"k:{\"containerPort\":15692,\"protocol\":\"TCP\"}":{".":{},"f:containerPort":{},"f:name":{},"f:protocol":{}}},"f:readinessProbe":{".":{},"f:failureThreshold":{},"f:initialDelaySeconds":{},"f:periodSeconds":{},"f:successThreshold":{},"f:tcpSocket":{".":{},"f:port":{}},"f:timeoutSeconds":{}},"f:resources":{".":{},"f:limits":{".":{},"f:cpu":{},"f:memory":{}},"f:requests":{".":{},"f:cpu":{},"f:memory":{}}},"f:terminationMessagePath":{},"f:terminationMessagePolicy":{},"f:volumeMounts":{".":{},"k:{\"mountPath\":\"/etc/pod-info/\"}":{".":{},"f:mountPath":{},"f:name":{}},"k:{\"mountPath\":\"/etc/rabbitmq/conf.d/10-operatorDefaults.conf\"}":{".":{},"f:mountPath":{},"f:name":{},"f:subPath":{}},"k:{\"mountPath\":\"/etc/rabbitmq/conf.d/11-default_user.conf\"}":{".":{},"f:mountPath":{},"f:name":{},"f:subPath":{}},"k:{\"mountPath\":\"/etc/rabbitmq/conf.d/90-userDefinedConfiguration.conf\"}":{".":{},"f:mountPath":{},"f:name":{},"f:subPath":{}},"k:{\"mountPath\":\"/operator\"}":{".":{},"f:mountPath":{},"f:name":{}},"k:{\"mountPath\":\"/var/lib/rabbitmq/\"}":{".":{},"f:mountPath":{},"f:name":{}},"k:{\"mountPath\":\"/var/lib/rabbitmq/mnesia/\"}":{".":{},"f:mountPath":{},"f:name":{}}}}},"f:dnsPolicy":{},"f:initContainers":{".":{},"k:{\"name\":\"setup-container\"}":{".":{},"f:command":{},"f:image":{},"f:imagePullPolicy":{},"f:name":{},"f:resources":{".":{},"f:limits":{".":{},"f:cpu":{},"f:memory":{}},"f:requests":{".":{},"f:cpu":{},"f:memory":{}}},"f:securityContext":{".":{},"f:capabilities":{".":{},"f:drop":{}},"f:runAsUser":{}},"f:terminationMessagePath":{},"f:terminationMessagePolicy":{},"f:volumeMounts":{".":{},"k:{\"mountPath\":\"/operator\"}":{".":{},"f:mountPath":{},"f:name":{}},"k:{\"mountPath\":\"/tmp/default_user.conf\"}":{".":{},"f:mountPath":{},"f:name":{},"f:subPath":{}},"k:{\"mountPath\":\"/tmp/erlang-cookie-secret/\"}":{".":{},"f:mountPath":{},"f:name":{}},"k:{\"mountPath\":\"/tmp/rabbitmq-plugins/\"}":{".":{},"f:mountPath":{},"f:name":{}},"k:{\"mountPath\":\"/var/lib/rabbitmq/\"}":{".":{},"f:mountPath":{},"f:name":{}},"k:{\"mountPath\":\"/var/lib/rabbitmq/mnesia/\"}":{".":{},"f:mountPath":{},"f:name":{}}}}},"f:restartPolicy":{},"f:schedulerName":{},"f:securityContext":{".":{},"f:fsGroup":{},"f:runAsGroup":{},"f:runAsUser":{}},"f:serviceAccount":{},"f:serviceAccountName":{},"f:terminationGracePeriodSeconds":{},"f:topologySpreadConstraints":{".":{},"k:{\"topologyKey\":\"topology.kubernetes.io/zone\",\"whenUnsatisfiable\":\"ScheduleAnyway\"}":{".":{},"f:labelSelector":{".":{},"f:matchLabels":{".":{},"f:app.kubernetes.io/name":{}}},"f:maxSkew":{},"f:topologyKey":{},"f:whenUnsatisfiable":{}}},"f:volumes":{".":{},"k:{\"name\":\"erlang-cookie-secret\"}":{".":{},"f:name":{},"f:secret":{".":{},"f:defaultMode":{},"f:secretName":{}}},"k:{\"name\":\"plugins-conf\"}":{".":{},"f:configMap":{".":{},"f:defaultMode":{},"f:name":{}},"f:name":{}},"k:{\"name\":\"pod-info\"}":{".":{},"f:downwardAPI":{".":{},"f:defaultMode":{},"f:items":{}},"f:name":{}},"k:{\"name\":\"rabbitmq-confd\"}":{".":{},"f:name":{},"f:projected":{".":{},"f:defaultMode":{},"f:sources":{}}},"k:{\"name\":\"rabbitmq-erlang-cookie\"}":{".":{},"f:emptyDir":{},"f:name":{}},"k:{\"name\":\"rabbitmq-plugins\"}":{".":{},"f:emptyDir":{},"f:name":{}}}}},"f:updateStrategy":{"f:rollingUpdate":{".":{},"f:partition":{}},"f:type":{}},"f:volumeClaimTemplates":{}}}},{"manager":"kube-controller-manager","operation":"Update","apiVersion":"apps/v1","time":"2022-03-18T18:01:17Z","fieldsType":"FieldsV1","fieldsV1":{"f:status":{"f:collisionCount":{},"f:currentReplicas":{},"f:currentRevision":{},"f:observedGeneration":{},"f:readyReplicas":{},"f:replicas":{},"f:updateRevision":{},"f:updatedReplicas":{}}}}]},"spec":{"replicas":1,"selector":{"matchLabels":{"app.kubernetes.io/name":"rabbitmq-cluster"}},"template":{"metadata":{"creationTimestamp":null,"labels":{"app.kubernetes.io/component":"rabbitmq","app.kubernetes.io/name":"rabbitmq-cluster","app.kubernetes.io/part-of":"rabbitmq"},"annotations":{"prometheus.io/port":"15692","prometheus.io/scrape":"true"}},"spec":{"volumes":[{"name":"plugins-conf","configMap":{"name":"rabbitmq-cluster-plugins-conf","defaultMode":420}},{"name":"rabbitmq-confd","projected":{"sources":[{"secret":{"name":"rabbitmq-cluster-default-user","items":[{"key":"default_user.conf","path":"default_user.conf"}]}},{"configMap":{"name":"rabbitmq-cluster-server-conf","items":[{"key":"operatorDefaults.conf","path":"operatorDefaults.conf"},{"key":"userDefinedConfiguration.conf","path":"userDefinedConfiguration.conf"}]}}],"defaultMode":420}},{"name":"rabbitmq-erlang-cookie","emptyDir":{}},{"name":"erlang-cookie-secret","secret":{"secretName":"rabbitmq-cluster-erlang-cookie","defaultMode":420}},{"name":"rabbitmq-plugins","emptyDir":{}},{"name":"pod-info","downwardAPI":{"items":[{"path":"skipPreStopChecks","fieldRef":{"apiVersion":"v1","fieldPath":"metadata.labels['skipPreStopChecks']"}}],"defaultMode":420}}],"initContainers":[{"name":"setup-container","image":"rabbitmq:3.8.12-management","command":["sh","-c","cp /tmp/erlang-cookie-secret/.erlang.cookie /var/lib/rabbitmq/.erlang.cookie \u0026\u0026 chown 999:999 /var/lib/rabbitmq/.erlang.cookie \u0026\u0026 chmod 600 /var/lib/rabbitmq/.erlang.cookie ; cp /tmp/rabbitmq-plugins/enabled_plugins /operator/enabled_plugins \u0026\u0026 chown 999:999 /operator/enabled_plugins ; chown 999:999 /var/lib/rabbitmq/mnesia/ ; echo '[default]' \u003e /var/lib/rabbitmq/.rabbitmqadmin.conf \u0026\u0026 sed -e 's/default_user/username/' -e 's/default_pass/password/' /tmp/default_user.conf \u003e\u003e /var/lib/rabbitmq/.rabbitmqadmin.conf \u0026\u0026 chown 999:999 /var/lib/rabbitmq/.rabbitmqadmin.conf \u0026\u0026 chmod 600 /var/lib/rabbitmq/.rabbitmqadmin.conf"],"resources":{"limits":{"cpu":"100m","memory":"500Mi"},"requests":{"cpu":"100m","memory":"500Mi"}},"volumeMounts":[{"name":"plugins-conf","mountPath":"/tmp/rabbitmq-plugins/"},{"name":"rabbitmq-erlang-cookie","mountPath":"/var/lib/rabbitmq/"},{"name":"erlang-cookie-secret","mountPath":"/tmp/erlang-cookie-secret/"},{"name":"rabbitmq-plugins","mountPath":"/operator"},{"name":"persistence","mountPath":"/var/lib/rabbitmq/mnesia/"},{"name":"rabbitmq-confd","mountPath":"/tmp/default_user.conf","subPath":"default_user.conf"}],"terminationMessagePath":"/dev/termination-log","terminationMessagePolicy":"File","imagePullPolicy":"IfNotPresent","securityContext":{"capabilities":{"drop":["FSETID","KILL","SETGID","SETUID","SETPCAP","NET_BIND_SERVICE","NET_RAW","SYS_CHROOT","MKNOD","AUDIT_WRITE","SETFCAP"]},"runAsUser":0}}],"containers":[{"name":"rabbitmq","image":"rabbitmq:3.8.12-management","ports":[{"name":"epmd","containerPort":4369,"protocol":"TCP"},{"name":"amqp","containerPort":5672,"protocol":"TCP"},{"name":"management","containerPort":15672,"protocol":"TCP"},{"name":"prometheus","containerPort":15692,"protocol":"TCP"}],"env":[{"name":"MY_POD_NAME","valueFrom":{"fieldRef":{"apiVersion":"v1","fieldPath":"metadata.name"}}},{"name":"MY_POD_NAMESPACE","valueFrom":{"fieldRef":{"apiVersion":"v1","fieldPath":"metadata.namespace"}}},{"name":"RABBITMQ_ENABLED_PLUGINS_FILE","value":"/operator/enabled_plugins"},{"name":"K8S_SERVICE_NAME","value":"rabbitmq-cluster-nodes"},{"name":"RABBITMQ_USE_LONGNAME","value":"true"},{"name":"RABBITMQ_NODENAME","value":"rabbit@$(MY_POD_NAME).$(K8S_SERVICE_NAME).$(MY_POD_NAMESPACE)"},{"name":"K8S_HOSTNAME_SUFFIX","value":".$(K8S_SERVICE_NAME).$(MY_POD_NAMESPACE)"}],"resources":{"limits":{"cpu":"2","memory":"2Gi"},"requests":{"cpu":"1","memory":"2Gi"}},"volumeMounts":[{"name":"rabbitmq-erlang-cookie","mountPath":"/var/lib/rabbitmq/"},{"name":"persistence","mountPath":"/var/lib/rabbitmq/mnesia/"},{"name":"rabbitmq-plugins","mountPath":"/operator"},{"name":"rabbitmq-confd","mountPath":"/etc/rabbitmq/conf.d/10-operatorDefaults.conf","subPath":"operatorDefaults.conf"},{"name":"rabbitmq-confd","mountPath":"/etc/rabbitmq/conf.d/11-default_user.conf","subPath":"default_user.conf"},{"name":"rabbitmq-confd","mountPath":"/etc/rabbitmq/conf.d/90-userDefinedConfiguration.conf","subPath":"userDefinedConfiguration.conf"},{"name":"pod-info","mountPath":"/etc/pod-info/"}],"readinessProbe":{"tcpSocket":{"port":"amqp"},"initialDelaySeconds":10,"timeoutSeconds":5,"periodSeconds":10,"successThreshold":1,"failureThreshold":3},"lifecycle":{"preStop":{"exec":{"command":["/bin/bash","-c","if [ ! -z \"$(cat /etc/pod-info/skipPreStopChecks)\" ]; then exit 0; fi; rabbitmq-upgrade await_online_quorum_plus_one -t 604800; rabbitmq-upgrade await_online_synchronized_mirror -t 604800; rabbitmq-upgrade drain -t 604800"]}}},"terminationMessagePath":"/dev/termination-log","terminationMessagePolicy":"File","imagePullPolicy":"IfNotPresent"}],"restartPolicy":"Always","terminationGracePeriodSeconds":604800,"dnsPolicy":"ClusterFirst","serviceAccountName":"rabbitmq-cluster-server","serviceAccount":"rabbitmq-cluster-server","automountServiceAccountToken":true,"securityContext":{"runAsUser":999,"runAsGroup":999,"fsGroup":999},"schedulerName":"default-scheduler","topologySpreadConstraints":[{"maxSkew":1,"topologyKey":"topology.kubernetes.io/zone","whenUnsatisfiable":"ScheduleAnyway","labelSelector":{"matchLabels":{"app.kubernetes.io/name":"rabbitmq-cluster"}}}]}},"volumeClaimTemplates":[{"metadata":{"name":"persistence","namespace":"default","creationTimestamp":null,"labels":{"app.kubernetes.io/component":"rabbitmq","app.kubernetes.io/name":"rabbitmq-cluster","app.kubernetes.io/part-of":"rabbitmq"},"ownerReferences":[{"apiVersion":"rabbitmq.com/v1beta1","kind":"RabbitmqCluster","name":"rabbitmq-cluster","uid":"18d9928b-0d1c-47be-80ec-20960d053827","controller":true,"blockOwnerDeletion":false}]},"spec":{"accessModes":["ReadWriteOnce"],"resources":{"requests":{"storage":"10Gi"}},"volumeMode":"Filesystem"},"status":{"phase":"Pending"}}],"serviceName":"rabbitmq-cluster-nodes","podManagementPolicy":"Parallel","updateStrategy":{"type":"RollingUpdate","rollingUpdate":{"partition":0}},"revisionHistoryLimit":10},"status":{"observedGeneration":1,"replicas":1,"readyReplicas":1,"currentReplicas":1,"updatedReplicas":1,"currentRevision":"rabbitmq-cluster-server-5f8b8665fb","updateRevision":"rabbitmq-cluster-server-5f8b8665fb","collisionCount":0}}
2022/03/18 18:01:18 learn_server.go:291: [SIEVE-AFTER-READ]	Get	true	endpoints	default	rabbitmq-cluster	github.com/rabbitmq/cluster-operator/controllers.(*RabbitmqClusterReconciler)	NoError	{"kind":"Endpoints","apiVersion":"v1","metadata":{"name":"rabbitmq-cluster","namespace":"default","selfLink":"/api/v1/namespaces/default/endpoints/rabbitmq-cluster","uid":"5c4723ad-f4fe-442d-9135-44879a2a8183","resourceVersion":"939","creationTimestamp":"2022-03-18T18:00:38Z","labels":{"app.kubernetes.io/component":"rabbitmq","app.kubernetes.io/name":"rabbitmq-cluster","app.kubernetes.io/part-of":"rabbitmq"},"annotations":{"endpoints.kubernetes.io/last-change-trigger-time":"2022-03-18T18:01:17Z"},"managedFields":[{"manager":"kube-controller-manager","operation":"Update","apiVersion":"v1","time":"2022-03-18T18:01:17Z","fieldsType":"FieldsV1","fieldsV1":{"f:metadata":{"f:annotations":{".":{},"f:endpoints.kubernetes.io/last-change-trigger-time":{}},"f:labels":{".":{},"f:app.kubernetes.io/component":{},"f:app.kubernetes.io/name":{},"f:app.kubernetes.io/part-of":{}}},"f:subsets":{}}}]},"subsets":[{"addresses":[{"ip":"10.244.1.4","nodeName":"kind-worker2","targetRef":{"kind":"Pod","namespace":"default","name":"rabbitmq-cluster-server-0","uid":"e7faffc5-b656-4e69-9777-92d12cb6ec5a","resourceVersion":"938"}}],"ports":[{"name":"amqp","port":5672,"protocol":"TCP"},{"name":"management","port":15672,"protocol":"TCP"}]}]}
2022/03/18 18:01:18 learn_server.go:291: [SIEVE-AFTER-READ]	Get	true	statefulset	default	rabbitmq-cluster-server	github.com/rabbitmq/cluster-operator/controllers.(*RabbitmqClusterReconciler)	NoError	{"kind":"StatefulSet","apiVersion":"apps/v1","metadata":{"name":"rabbitmq-cluster-server","namespace":"default","selfLink":"/apis/apps/v1/namespaces/default/statefulsets/rabbitmq-cluster-server","uid":"cb5c43bc-6ee7-481c-ab01-6f3acffdd3c8","resourceVersion":"948","generation":1,"creationTimestamp":"2022-03-18T18:00:38Z","labels":{"app.kubernetes.io/component":"rabbitmq","app.kubernetes.io/name":"rabbitmq-cluster","app.kubernetes.io/part-of":"rabbitmq"},"ownerReferences":[{"apiVersion":"rabbitmq.com/v1beta1","kind":"RabbitmqCluster","name":"rabbitmq-cluster","uid":"18d9928b-0d1c-47be-80ec-20960d053827","controller":true,"blockOwnerDeletion":true}],"managedFields":[{"manager":"manager","operation":"Update","apiVersion":"apps/v1","time":"2022-03-18T18:00:38Z","fieldsType":"FieldsV1","fieldsV1":{"f:metadata":{"f:labels":{".":{},"f:app.kubernetes.io/component":{},"f:app.kubernetes.io/name":{},"f:app.kubernetes.io/part-of":{}},"f:ownerReferences":{".":{},"k:{\"uid\":\"18d9928b-0d1c-47be-80ec-20960d053827\"}":{".":{},"f:apiVersion":{},"f:blockOwnerDeletion":{},"f:controller":{},"f:kind":{},"f:name":{},"f:uid":{}}}},"f:spec":{"f:podManagementPolicy":{},"f:replicas":{},"f:revisionHistoryLimit":{},"f:selector":{"f:matchLabels":{".":{},"f:app.kubernetes.io/name":{}}},"f:serviceName":{},"f:template":{"f:metadata":{"f:annotations":{".":{},"f:prometheus.io/port":{},"f:prometheus.io/scrape":{}},"f:labels":{".":{},"f:app.kubernetes.io/component":{},"f:app.kubernetes.io/name":{},"f:app.kubernetes.io/part-of":{}}},"f:spec":{"f:automountServiceAccountToken":{},"f:containers":{"k:{\"name\":\"rabbitmq\"}":{".":{},"f:env":{".":{},"k:{\"name\":\"K8S_HOSTNAME_SUFFIX\"}":{".":{},"f:name":{},"f:value":{}},"k:{\"name\":\"K8S_SERVICE_NAME\"}":{".":{},"f:name":{},"f:value":{}},"k:{\"name\":\"MY_POD_NAME\"}":{".":{},"f:name":{},"f:valueFrom":{".":{},"f:fieldRef":{".":{},"f:apiVersion":{},"f:fieldPath":{}}}},"k:{\"name\":\"MY_POD_NAMESPACE\"}":{".":{},"f:name":{},"f:valueFrom":{".":{},"f:fieldRef":{".":{},"f:apiVersion":{},"f:fieldPath":{}}}},"k:{\"name\":\"RABBITMQ_ENABLED_PLUGINS_FILE\"}":{".":{},"f:name":{},"f:value":{}},"k:{\"name\":\"RABBITMQ_NODENAME\"}":{".":{},"f:name":{},"f:value":{}},"k:{\"name\":\"RABBITMQ_USE_LONGNAME\"}":{".":{},"f:name":{},"f:value":{}}},"f:image":{},"f:imagePullPolicy":{},"f:lifecycle":{".":{},"f:preStop":{".":{},"f:exec":{".":{},"f:command":{}}}},"f:name":{},"f:ports":{".":{},"k:{\"containerPort\":4369,\"protocol\":\"TCP\"}":{".":{},"f:containerPort":{},"f:name":{},"f:protocol":{}},"k:{\"containerPort\":5672,\"protocol\":\"TCP\"}":{".":{},"f:containerPort":{},"f:name":{},"f:protocol":{}},"k:{\"containerPort\":15672,\"protocol\":\"TCP\"}":{".":{},"f:containerPort":{},"f:name":{},"f:protocol":{}},"k:{\"containerPort\":15692,\"protocol\":\"TCP\"}":{".":{},"f:containerPort":{},"f:name":{},"f:protocol":{}}},"f:readinessProbe":{".":{},"f:failureThreshold":{},"f:initialDelaySeconds":{},"f:periodSeconds":{},"f:successThreshold":{},"f:tcpSocket":{".":{},"f:port":{}},"f:timeoutSeconds":{}},"f:resources":{".":{},"f:limits":{".":{},"f:cpu":{},"f:memory":{}},"f:requests":{".":{},"f:cpu":{},"f:memory":{}}},"f:terminationMessagePath":{},"f:terminationMessagePolicy":{},"f:volumeMounts":{".":{},"k:{\"mountPath\":\"/etc/pod-info/\"}":{".":{},"f:mountPath":{},"f:name":{}},"k:{\"mountPath\":\"/etc/rabbitmq/conf.d/10-operatorDefaults.conf\"}":{".":{},"f:mountPath":{},"f:name":{},"f:subPath":{}},"k:{\"mountPath\":\"/etc/rabbitmq/conf.d/11-default_user.conf\"}":{".":{},"f:mountPath":{},"f:name":{},"f:subPath":{}},"k:{\"mountPath\":\"/etc/rabbitmq/conf.d/90-userDefinedConfiguration.conf\"}":{".":{},"f:mountPath":{},"f:name":{},"f:subPath":{}},"k:{\"mountPath\":\"/operator\"}":{".":{},"f:mountPath":{},"f:name":{}},"k:{\"mountPath\":\"/var/lib/rabbitmq/\"}":{".":{},"f:mountPath":{},"f:name":{}},"k:{\"mountPath\":\"/var/lib/rabbitmq/mnesia/\"}":{".":{},"f:mountPath":{},"f:name":{}}}}},"f:dnsPolicy":{},"f:initContainers":{".":{},"k:{\"name\":\"setup-container\"}":{".":{},"f:command":{},"f:image":{},"f:imagePullPolicy":{},"f:name":{},"f:resources":{".":{},"f:limits":{".":{},"f:cpu":{},"f:memory":{}},"f:requests":{".":{},"f:cpu":{},"f:memory":{}}},"f:securityContext":{".":{},"f:capabilities":{".":{},"f:drop":{}},"f:runAsUser":{}},"f:terminationMessagePath":{},"f:terminationMessagePolicy":{},"f:volumeMounts":{".":{},"k:{\"mountPath\":\"/operator\"}":{".":{},"f:mountPath":{},"f:name":{}},"k:{\"mountPath\":\"/tmp/default_user.conf\"}":{".":{},"f:mountPath":{},"f:name":{},"f:subPath":{}},"k:{\"mountPath\":\"/tmp/erlang-cookie-secret/\"}":{".":{},"f:mountPath":{},"f:name":{}},"k:{\"mountPath\":\"/tmp/rabbitmq-plugins/\"}":{".":{},"f:mountPath":{},"f:name":{}},"k:{\"mountPath\":\"/var/lib/rabbitmq/\"}":{".":{},"f:mountPath":{},"f:name":{}},"k:{\"mountPath\":\"/var/lib/rabbitmq/mnesia/\"}":{".":{},"f:mountPath":{},"f:name":{}}}}},"f:restartPolicy":{},"f:schedulerName":{},"f:securityContext":{".":{},"f:fsGroup":{},"f:runAsGroup":{},"f:runAsUser":{}},"f:serviceAccount":{},"f:serviceAccountName":{},"f:terminationGracePeriodSeconds":{},"f:topologySpreadConstraints":{".":{},"k:{\"topologyKey\":\"topology.kubernetes.io/zone\",\"whenUnsatisfiable\":\"ScheduleAnyway\"}":{".":{},"f:labelSelector":{".":{},"f:matchLabels":{".":{},"f:app.kubernetes.io/name":{}}},"f:maxSkew":{},"f:topologyKey":{},"f:whenUnsatisfiable":{}}},"f:volumes":{".":{},"k:{\"name\":\"erlang-cookie-secret\"}":{".":{},"f:name":{},"f:secret":{".":{},"f:defaultMode":{},"f:secretName":{}}},"k:{\"name\":\"plugins-conf\"}":{".":{},"f:configMap":{".":{},"f:defaultMode":{},"f:name":{}},"f:name":{}},"k:{\"name\":\"pod-info\"}":{".":{},"f:downwardAPI":{".":{},"f:defaultMode":{},"f:items":{}},"f:name":{}},"k:{\"name\":\"rabbitmq-confd\"}":{".":{},"f:name":{},"f:projected":{".":{},"f:defaultMode":{},"f:sources":{}}},"k:{\"name\":\"rabbitmq-erlang-cookie\"}":{".":{},"f:emptyDir":{},"f:name":{}},"k:{\"name\":\"rabbitmq-plugins\"}":{".":{},"f:emptyDir":{},"f:name":{}}}}},"f:updateStrategy":{"f:rollingUpdate":{".":{},"f:partition":{}},"f:type":{}},"f:volumeClaimTemplates":{}}}},{"manager":"kube-controller-manager","operation":"Update","apiVersion":"apps/v1","time":"2022-03-18T18:01:17Z","fieldsType":"FieldsV1","fieldsV1":{"f:status":{"f:collisionCount":{},"f:currentReplicas":{},"f:currentRevision":{},"f:observedGeneration":{},"f:readyReplicas":{},"f:replicas":{},"f:updateRevision":{},"f:updatedReplicas":{}}}}]},"spec":{"replicas":1,"selector":{"matchLabels":{"app.kubernetes.io/name":"rabbitmq-cluster"}},"template":{"metadata":{"creationTimestamp":null,"labels":{"app.kubernetes.io/component":"rabbitmq","app.kubernetes.io/name":"rabbitmq-cluster","app.kubernetes.io/part-of":"rabbitmq"},"annotations":{"prometheus.io/port":"15692","prometheus.io/scrape":"true"}},"spec":{"volumes":[{"name":"plugins-conf","configMap":{"name":"rabbitmq-cluster-plugins-conf","defaultMode":420}},{"name":"rabbitmq-confd","projected":{"sources":[{"secret":{"name":"rabbitmq-cluster-default-user","items":[{"key":"default_user.conf","path":"default_user.conf"}]}},{"configMap":{"name":"rabbitmq-cluster-server-conf","items":[{"key":"operatorDefaults.conf","path":"operatorDefaults.conf"},{"key":"userDefinedConfiguration.conf","path":"userDefinedConfiguration.conf"}]}}],"defaultMode":420}},{"name":"rabbitmq-erlang-cookie","emptyDir":{}},{"name":"erlang-cookie-secret","secret":{"secretName":"rabbitmq-cluster-erlang-cookie","defaultMode":420}},{"name":"rabbitmq-plugins","emptyDir":{}},{"name":"pod-info","downwardAPI":{"items":[{"path":"skipPreStopChecks","fieldRef":{"apiVersion":"v1","fieldPath":"metadata.labels['skipPreStopChecks']"}}],"defaultMode":420}}],"initContainers":[{"name":"setup-container","image":"rabbitmq:3.8.12-management","command":["sh","-c","cp /tmp/erlang-cookie-secret/.erlang.cookie /var/lib/rabbitmq/.erlang.cookie \u0026\u0026 chown 999:999 /var/lib/rabbitmq/.erlang.cookie \u0026\u0026 chmod 600 /var/lib/rabbitmq/.erlang.cookie ; cp /tmp/rabbitmq-plugins/enabled_plugins /operator/enabled_plugins \u0026\u0026 chown 999:999 /operator/enabled_plugins ; chown 999:999 /var/lib/rabbitmq/mnesia/ ; echo '[default]' \u003e /var/lib/rabbitmq/.rabbitmqadmin.conf \u0026\u0026 sed -e 's/default_user/username/' -e 's/default_pass/password/' /tmp/default_user.conf \u003e\u003e /var/lib/rabbitmq/.rabbitmqadmin.conf \u0026\u0026 chown 999:999 /var/lib/rabbitmq/.rabbitmqadmin.conf \u0026\u0026 chmod 600 /var/lib/rabbitmq/.rabbitmqadmin.conf"],"resources":{"limits":{"cpu":"100m","memory":"500Mi"},"requests":{"cpu":"100m","memory":"500Mi"}},"volumeMounts":[{"name":"plugins-conf","mountPath":"/tmp/rabbitmq-plugins/"},{"name":"rabbitmq-erlang-cookie","mountPath":"/var/lib/rabbitmq/"},{"name":"erlang-cookie-secret","mountPath":"/tmp/erlang-cookie-secret/"},{"name":"rabbitmq-plugins","mountPath":"/operator"},{"name":"persistence","mountPath":"/var/lib/rabbitmq/mnesia/"},{"name":"rabbitmq-confd","mountPath":"/tmp/default_user.conf","subPath":"default_user.conf"}],"terminationMessagePath":"/dev/termination-log","terminationMessagePolicy":"File","imagePullPolicy":"IfNotPresent","securityContext":{"capabilities":{"drop":["FSETID","KILL","SETGID","SETUID","SETPCAP","NET_BIND_SERVICE","NET_RAW","SYS_CHROOT","MKNOD","AUDIT_WRITE","SETFCAP"]},"runAsUser":0}}],"containers":[{"name":"rabbitmq","image":"rabbitmq:3.8.12-management","ports":[{"name":"epmd","containerPort":4369,"protocol":"TCP"},{"name":"amqp","containerPort":5672,"protocol":"TCP"},{"name":"management","containerPort":15672,"protocol":"TCP"},{"name":"prometheus","containerPort":15692,"protocol":"TCP"}],"env":[{"name":"MY_POD_NAME","valueFrom":{"fieldRef":{"apiVersion":"v1","fieldPath":"metadata.name"}}},{"name":"MY_POD_NAMESPACE","valueFrom":{"fieldRef":{"apiVersion":"v1","fieldPath":"metadata.namespace"}}},{"name":"RABBITMQ_ENABLED_PLUGINS_FILE","value":"/operator/enabled_plugins"},{"name":"K8S_SERVICE_NAME","value":"rabbitmq-cluster-nodes"},{"name":"RABBITMQ_USE_LONGNAME","value":"true"},{"name":"RABBITMQ_NODENAME","value":"rabbit@$(MY_POD_NAME).$(K8S_SERVICE_NAME).$(MY_POD_NAMESPACE)"},{"name":"K8S_HOSTNAME_SUFFIX","value":".$(K8S_SERVICE_NAME).$(MY_POD_NAMESPACE)"}],"resources":{"limits":{"cpu":"2","memory":"2Gi"},"requests":{"cpu":"1","memory":"2Gi"}},"volumeMounts":[{"name":"rabbitmq-erlang-cookie","mountPath":"/var/lib/rabbitmq/"},{"name":"persistence","mountPath":"/var/lib/rabbitmq/mnesia/"},{"name":"rabbitmq-plugins","mountPath":"/operator"},{"name":"rabbitmq-confd","mountPath":"/etc/rabbitmq/conf.d/10-operatorDefaults.conf","subPath":"operatorDefaults.conf"},{"name":"rabbitmq-confd","mountPath":"/etc/rabbitmq/conf.d/11-default_user.conf","subPath":"default_user.conf"},{"name":"rabbitmq-confd","mountPath":"/etc/rabbitmq/conf.d/90-userDefinedConfiguration.conf","subPath":"userDefinedConfiguration.conf"},{"name":"pod-info","mountPath":"/etc/pod-info/"}],"readinessProbe":{"tcpSocket":{"port":"amqp"},"initialDelaySeconds":10,"timeoutSeconds":5,"periodSeconds":10,"successThreshold":1,"failureThreshold":3},"lifecycle":{"preStop":{"exec":{"command":["/bin/bash","-c","if [ ! -z \"$(cat /etc/pod-info/skipPreStopChecks)\" ]; then exit 0; fi; rabbitmq-upgrade await_online_quorum_plus_one -t 604800; rabbitmq-upgrade await_online_synchronized_mirror -t 604800; rabbitmq-upgrade drain -t 604800"]}}},"terminationMessagePath":"/dev/termination-log","terminationMessagePolicy":"File","imagePullPolicy":"IfNotPresent"}],"restartPolicy":"Always","terminationGracePeriodSeconds":604800,"dnsPolicy":"ClusterFirst","serviceAccountName":"rabbitmq-cluster-server","serviceAccount":"rabbitmq-cluster-server","automountServiceAccountToken":true,"securityContext":{"runAsUser":999,"runAsGroup":999,"fsGroup":999},"schedulerName":"default-scheduler","topologySpreadConstraints":[{"maxSkew":1,"topologyKey":"topology.kubernetes.io/zone","whenUnsatisfiable":"ScheduleAnyway","labelSelector":{"matchLabels":{"app.kubernetes.io/name":"rabbitmq-cluster"}}}]}},"volumeClaimTemplates":[{"metadata":{"name":"persistence","namespace":"default","creationTimestamp":null,"labels":{"app.kubernetes.io/component":"rabbitmq","app.kubernetes.io/name":"rabbitmq-cluster","app.kubernetes.io/part-of":"rabbitmq"},"ownerReferences":[{"apiVersion":"rabbitmq.com/v1beta1","kind":"RabbitmqCluster","name":"rabbitmq-cluster","uid":"18d9928b-0d1c-47be-80ec-20960d053827","controller":true,"blockOwnerDeletion":false}]},"spec":{"accessModes":["ReadWriteOnce"],"resources":{"requests":{"storage":"10Gi"}},"volumeMode":"Filesystem"},"status":{"phase":"Pending"}}],"serviceName":"rabbitmq-cluster-nodes","podManagementPolicy":"Parallel","updateStrategy":{"type":"RollingUpdate","rollingUpdate":{"partition":0}},"revisionHistoryLimit":10},"status":{"observedGeneration":1,"replicas":1,"readyReplicas":1,"currentReplicas":1,"updatedReplicas":1,"currentRevision":"rabbitmq-cluster-server-5f8b8665fb","updateRevision":"rabbitmq-cluster-server-5f8b8665fb","collisionCount":0}}
2022/03/18 18:01:18 learn_server.go:291: [SIEVE-AFTER-READ]	Get	true	service	default	rabbitmq-cluster-nodes	github.com/rabbitmq/cluster-operator/controllers.(*RabbitmqClusterReconciler)	NoError	{"kind":"Service","apiVersion":"v1","metadata":{"name":"rabbitmq-cluster-nodes","namespace":"default","selfLink":"/api/v1/namespaces/default/services/rabbitmq-cluster-nodes","uid":"67c7eea9-1b87-4fd7-82e6-5bfe31fd1b52","resourceVersion":"696","creationTimestamp":"2022-03-18T18:00:38Z","labels":{"app.kubernetes.io/component":"rabbitmq","app.kubernetes.io/name":"rabbitmq-cluster","app.kubernetes.io/part-of":"rabbitmq"},"ownerReferences":[{"apiVersion":"rabbitmq.com/v1beta1","kind":"RabbitmqCluster","name":"rabbitmq-cluster","uid":"18d9928b-0d1c-47be-80ec-20960d053827","controller":true,"blockOwnerDeletion":true}],"managedFields":[{"manager":"manager","operation":"Update","apiVersion":"v1","time":"2022-03-18T18:00:38Z","fieldsType":"FieldsV1","fieldsV1":{"f:metadata":{"f:labels":{".":{},"f:app.kubernetes.io/component":{},"f:app.kubernetes.io/name":{},"f:app.kubernetes.io/part-of":{}},"f:ownerReferences":{".":{},"k:{\"uid\":\"18d9928b-0d1c-47be-80ec-20960d053827\"}":{".":{},"f:apiVersion":{},"f:blockOwnerDeletion":{},"f:controller":{},"f:kind":{},"f:name":{},"f:uid":{}}}},"f:spec":{"f:clusterIP":{},"f:ports":{".":{},"k:{\"port\":4369,\"protocol\":\"TCP\"}":{".":{},"f:name":{},"f:port":{},"f:protocol":{},"f:targetPort":{}},"k:{\"port\":25672,\"protocol\":\"TCP\"}":{".":{},"f:name":{},"f:port":{},"f:protocol":{},"f:targetPort":{}}},"f:publishNotReadyAddresses":{},"f:selector":{".":{},"f:app.kubernetes.io/name":{}},"f:sessionAffinity":{},"f:type":{}}}}]},"spec":{"ports":[{"name":"epmd","protocol":"TCP","port":4369,"targetPort":4369},{"name":"cluster-rpc","protocol":"TCP","port":25672,"targetPort":25672}],"selector":{"app.kubernetes.io/name":"rabbitmq-cluster"},"clusterIP":"None","type":"ClusterIP","sessionAffinity":"None","publishNotReadyAddresses":true},"status":{"loadBalancer":{}}}
2022/03/18 18:01:18 learn_server.go:291: [SIEVE-AFTER-READ]	Get	true	service	default	rabbitmq-cluster	github.com/rabbitmq/cluster-operator/controllers.(*RabbitmqClusterReconciler)	NoError	{"kind":"Service","apiVersion":"v1","metadata":{"name":"rabbitmq-cluster","namespace":"default","selfLink":"/api/v1/namespaces/default/services/rabbitmq-cluster","uid":"56b50671-1945-458b-adac-05619b783392","resourceVersion":"701","creationTimestamp":"2022-03-18T18:00:38Z","labels":{"app.kubernetes.io/component":"rabbitmq","app.kubernetes.io/name":"rabbitmq-cluster","app.kubernetes.io/part-of":"rabbitmq"},"ownerReferences":[{"apiVersion":"rabbitmq.com/v1beta1","kind":"RabbitmqCluster","name":"rabbitmq-cluster","uid":"18d9928b-0d1c-47be-80ec-20960d053827","controller":true,"blockOwnerDeletion":true}],"managedFields":[{"manager":"manager","operation":"Update","apiVersion":"v1","time":"2022-03-18T18:00:38Z","fieldsType":"FieldsV1","fieldsV1":{"f:metadata":{"f:labels":{".":{},"f:app.kubernetes.io/component":{},"f:app.kubernetes.io/name":{},"f:app.kubernetes.io/part-of":{}},"f:ownerReferences":{".":{},"k:{\"uid\":\"18d9928b-0d1c-47be-80ec-20960d053827\"}":{".":{},"f:apiVersion":{},"f:blockOwnerDeletion":{},"f:controller":{},"f:kind":{},"f:name":{},"f:uid":{}}}},"f:spec":{"f:ports":{".":{},"k:{\"port\":5672,\"protocol\":\"TCP\"}":{".":{},"f:name":{},"f:port":{},"f:protocol":{},"f:targetPort":{}},"k:{\"port\":15672,\"protocol\":\"TCP\"}":{".":{},"f:name":{},"f:port":{},"f:protocol":{},"f:targetPort":{}}},"f:selector":{".":{},"f:app.kubernetes.io/name":{}},"f:sessionAffinity":{},"f:type":{}}}}]},"spec":{"ports":[{"name":"amqp","protocol":"TCP","port":5672,"targetPort":5672},{"name":"management","protocol":"TCP","port":15672,"targetPort":15672}],"selector":{"app.kubernetes.io/name":"rabbitmq-cluster"},"clusterIP":"10.96.254.158","type":"ClusterIP","sessionAffinity":"None"},"status":{"loadBalancer":{}}}
2022/03/18 18:01:18 learn_server.go:291: [SIEVE-AFTER-READ]	Get	true	secret	default	rabbitmq-cluster-erlang-cookie	github.com/rabbitmq/cluster-operator/controllers.(*RabbitmqClusterReconciler)	NoError	{"kind":"Secret","apiVersion":"v1","metadata":{"name":"rabbitmq-cluster-erlang-cookie","namespace":"default","selfLink":"/api/v1/namespaces/default/secrets/rabbitmq-cluster-erlang-cookie","uid":"f8fbe8a6-0f40-4e13-960b-ab78b8ba75b0","resourceVersion":"705","creationTimestamp":"2022-03-18T18:00:38Z","labels":{"app.kubernetes.io/component":"rabbitmq","app.kubernetes.io/name":"rabbitmq-cluster","app.kubernetes.io/part-of":"rabbitmq"},"ownerReferences":[{"apiVersion":"rabbitmq.com/v1beta1","kind":"RabbitmqCluster","name":"rabbitmq-cluster","uid":"18d9928b-0d1c-47be-80ec-20960d053827","controller":true,"blockOwnerDeletion":true}],"managedFields":[{"manager":"manager","operation":"Update","apiVersion":"v1","time":"2022-03-18T18:00:38Z","fieldsType":"FieldsV1","fieldsV1":{"f:data":{".":{},"f:.erlang.cookie":{}},"f:metadata":{"f:labels":{".":{},"f:app.kubernetes.io/component":{},"f:app.kubernetes.io/name":{},"f:app.kubernetes.io/part-of":{}},"f:ownerReferences":{".":{},"k:{\"uid\":\"18d9928b-0d1c-47be-80ec-20960d053827\"}":{".":{},"f:apiVersion":{},"f:blockOwnerDeletion":{},"f:controller":{},"f:kind":{},"f:name":{},"f:uid":{}}}},"f:type":{}}}]},"data":{".erlang.cookie":"QW9hMkpWU0tlYS1FUGdWTUhrelNMNnFoMFZ0ZmRGNUY="},"type":"Opaque"}
2022/03/18 18:01:18 learn_server.go:291: [SIEVE-AFTER-READ]	Get	true	secret	default	rabbitmq-cluster-default-user	github.com/rabbitmq/cluster-operator/controllers.(*RabbitmqClusterReconciler)	NoError	{"kind":"Secret","apiVersion":"v1","metadata":{"name":"rabbitmq-cluster-default-user","namespace":"default","selfLink":"/api/v1/namespaces/default/secrets/rabbitmq-cluster-default-user","uid":"0d9f460b-a23c-402b-8273-f541ed39023f","resourceVersion":"708","creationTimestamp":"2022-03-18T18:00:38Z","labels":{"app.kubernetes.io/component":"rabbitmq","app.kubernetes.io/name":"rabbitmq-cluster","app.kubernetes.io/part-of":"rabbitmq"},"ownerReferences":[{"apiVersion":"rabbitmq.com/v1beta1","kind":"RabbitmqCluster","name":"rabbitmq-cluster","uid":"18d9928b-0d1c-47be-80ec-20960d053827","controller":true,"blockOwnerDeletion":true}],"managedFields":[{"manager":"manager","operation":"Update","apiVersion":"v1","time":"2022-03-18T18:00:38Z","fieldsType":"FieldsV1","fieldsV1":{"f:data":{".":{},"f:default_user.conf":{},"f:password":{},"f:provider":{},"f:type":{},"f:username":{}},"f:metadata":{"f:labels":{".":{},"f:app.kubernetes.io/component":{},"f:app.kubernetes.io/name":{},"f:app.kubernetes.io/part-of":{}},"f:ownerReferences":{".":{},"k:{\"uid\":\"18d9928b-0d1c-47be-80ec-20960d053827\"}":{".":{},"f:apiVersion":{},"f:blockOwnerDeletion":{},"f:controller":{},"f:kind":{},"f:name":{},"f:uid":{}}}},"f:type":{}}}]},"data":{"default_user.conf":"ZGVmYXVsdF91c2VyID0gcTMxRmh3MGtjWW9SZUl5X3BPTXp2ZVBOUnNVU3I1Mk8KZGVmYXVsdF9wYXNzID0gY0dBX19jNTJHX05hVURpTGhraWZ6UDBOVVlNLTE2MWQK","password":"Y0dBX19jNTJHX05hVURpTGhraWZ6UDBOVVlNLTE2MWQ=","provider":"cmFiYml0bXE=","type":"cmFiYml0bXE=","username":"cTMxRmh3MGtjWW9SZUl5X3BPTXp2ZVBOUnNVU3I1Mk8="},"type":"Opaque"}
2022/03/18 18:01:18 learn_server.go:291: [SIEVE-AFTER-READ]	Get	true	configmap	default	rabbitmq-cluster-plugins-conf	github.com/rabbitmq/cluster-operator/controllers.(*RabbitmqClusterReconciler)	NoError	{"kind":"ConfigMap","apiVersion":"v1","metadata":{"name":"rabbitmq-cluster-plugins-conf","namespace":"default","selfLink":"/api/v1/namespaces/default/configmaps/rabbitmq-cluster-plugins-conf","uid":"a164075b-0562-47ac-a577-99aa8651ec40","resourceVersion":"709","creationTimestamp":"2022-03-18T18:00:38Z","labels":{"app.kubernetes.io/component":"rabbitmq","app.kubernetes.io/name":"rabbitmq-cluster","app.kubernetes.io/part-of":"rabbitmq"},"ownerReferences":[{"apiVersion":"rabbitmq.com/v1beta1","kind":"RabbitmqCluster","name":"rabbitmq-cluster","uid":"18d9928b-0d1c-47be-80ec-20960d053827","controller":true,"blockOwnerDeletion":true}],"managedFields":[{"manager":"manager","operation":"Update","apiVersion":"v1","time":"2022-03-18T18:00:38Z","fieldsType":"FieldsV1","fieldsV1":{"f:data":{".":{},"f:enabled_plugins":{}},"f:metadata":{"f:labels":{".":{},"f:app.kubernetes.io/component":{},"f:app.kubernetes.io/name":{},"f:app.kubernetes.io/part-of":{}},"f:ownerReferences":{".":{},"k:{\"uid\":\"18d9928b-0d1c-47be-80ec-20960d053827\"}":{".":{},"f:apiVersion":{},"f:blockOwnerDeletion":{},"f:controller":{},"f:kind":{},"f:name":{},"f:uid":{}}}}}}]},"data":{"enabled_plugins":"[rabbitmq_peer_discovery_k8s,rabbitmq_prometheus,rabbitmq_management]."}}
2022/03/18 18:01:18 learn_server.go:291: [SIEVE-AFTER-READ]	Get	true	configmap	default	rabbitmq-cluster-server-conf	github.com/rabbitmq/cluster-operator/controllers.(*RabbitmqClusterReconciler)	NoError	{"kind":"ConfigMap","apiVersion":"v1","metadata":{"name":"rabbitmq-cluster-server-conf","namespace":"default","selfLink":"/api/v1/namespaces/default/configmaps/rabbitmq-cluster-server-conf","uid":"22474f2b-8454-44b7-8079-8990223969cc","resourceVersion":"714","creationTimestamp":"2022-03-18T18:00:38Z","labels":{"app.kubernetes.io/component":"rabbitmq","app.kubernetes.io/name":"rabbitmq-cluster","app.kubernetes.io/part-of":"rabbitmq"},"ownerReferences":[{"apiVersion":"rabbitmq.com/v1beta1","kind":"RabbitmqCluster","name":"rabbitmq-cluster","uid":"18d9928b-0d1c-47be-80ec-20960d053827","controller":true,"blockOwnerDeletion":true}],"managedFields":[{"manager":"manager","operation":"Update","apiVersion":"v1","time":"2022-03-18T18:00:38Z","fieldsType":"FieldsV1","fieldsV1":{"f:data":{".":{},"f:operatorDefaults.conf":{},"f:userDefinedConfiguration.conf":{}},"f:metadata":{"f:labels":{".":{},"f:app.kubernetes.io/component":{},"f:app.kubernetes.io/name":{},"f:app.kubernetes.io/part-of":{}},"f:ownerReferences":{".":{},"k:{\"uid\":\"18d9928b-0d1c-47be-80ec-20960d053827\"}":{".":{},"f:apiVersion":{},"f:blockOwnerDeletion":{},"f:controller":{},"f:kind":{},"f:name":{},"f:uid":{}}}}}}]},"data":{"operatorDefaults.conf":"cluster_formation.peer_discovery_backend             = rabbit_peer_discovery_k8s\ncluster_formation.k8s.host                           = kubernetes.default\ncluster_formation.k8s.address_type                   = hostname\ncluster_partition_handling                           = pause_minority\nqueue_master_locator                                 = min-masters\ndisk_free_limit.absolute                             = 2GB\ncluster_formation.randomized_startup_delay_range.min = 5\ncluster_formation.randomized_startup_delay_range.max = 30\ncluster_name                                         = rabbitmq-cluster\n","userDefinedConfiguration.conf":"total_memory_available_override_value = 1717986919\n"}}
2022/03/18 18:01:18 learn_server.go:291: [SIEVE-AFTER-READ]	Get	true	serviceaccount	default	rabbitmq-cluster-server	github.com/rabbitmq/cluster-operator/controllers.(*RabbitmqClusterReconciler)	NoError	{"kind":"ServiceAccount","apiVersion":"v1","metadata":{"name":"rabbitmq-cluster-server","namespace":"default","selfLink":"/api/v1/namespaces/default/serviceaccounts/rabbitmq-cluster-server","uid":"731589b5-ac97-4774-bee4-008949b54734","resourceVersion":"722","creationTimestamp":"2022-03-18T18:00:38Z","labels":{"app.kubernetes.io/component":"rabbitmq","app.kubernetes.io/name":"rabbitmq-cluster","app.kubernetes.io/part-of":"rabbitmq"},"ownerReferences":[{"apiVersion":"rabbitmq.com/v1beta1","kind":"RabbitmqCluster","name":"rabbitmq-cluster","uid":"18d9928b-0d1c-47be-80ec-20960d053827","controller":true,"blockOwnerDeletion":true}],"managedFields":[{"manager":"kube-controller-manager","operation":"Update","apiVersion":"v1","time":"2022-03-18T18:00:38Z","fieldsType":"FieldsV1","fieldsV1":{"f:secrets":{".":{},"k:{\"name\":\"rabbitmq-cluster-server-token-rhzq9\"}":{".":{},"f:name":{}}}}},{"manager":"manager","operation":"Update","apiVersion":"v1","time":"2022-03-18T18:00:38Z","fieldsType":"FieldsV1","fieldsV1":{"f:metadata":{"f:labels":{".":{},"f:app.kubernetes.io/component":{},"f:app.kubernetes.io/name":{},"f:app.kubernetes.io/part-of":{}},"f:ownerReferences":{".":{},"k:{\"uid\":\"18d9928b-0d1c-47be-80ec-20960d053827\"}":{".":{},"f:apiVersion":{},"f:blockOwnerDeletion":{},"f:controller":{},"f:kind":{},"f:name":{},"f:uid":{}}}}}}]},"secrets":[{"name":"rabbitmq-cluster-server-token-rhzq9"}]}
2022/03/18 18:01:18 learn_server.go:291: [SIEVE-AFTER-READ]	Get	true	role	default	rabbitmq-cluster-peer-discovery	github.com/rabbitmq/cluster-operator/controllers.(*RabbitmqClusterReconciler)	NoError	{"kind":"Role","apiVersion":"rbac.authorization.k8s.io/v1","metadata":{"name":"rabbitmq-cluster-peer-discovery","namespace":"default","selfLink":"/apis/rbac.authorization.k8s.io/v1/namespaces/default/roles/rabbitmq-cluster-peer-discovery","uid":"52c80b50-4fdd-4089-bbfd-9756465953f2","resourceVersion":"723","creationTimestamp":"2022-03-18T18:00:38Z","labels":{"app.kubernetes.io/component":"rabbitmq","app.kubernetes.io/name":"rabbitmq-cluster","app.kubernetes.io/part-of":"rabbitmq"},"ownerReferences":[{"apiVersion":"rabbitmq.com/v1beta1","kind":"RabbitmqCluster","name":"rabbitmq-cluster","uid":"18d9928b-0d1c-47be-80ec-20960d053827","controller":true,"blockOwnerDeletion":true}],"managedFields":[{"manager":"manager","operation":"Update","apiVersion":"rbac.authorization.k8s.io/v1","time":"2022-03-18T18:00:38Z","fieldsType":"FieldsV1","fieldsV1":{"f:metadata":{"f:labels":{".":{},"f:app.kubernetes.io/component":{},"f:app.kubernetes.io/name":{},"f:app.kubernetes.io/part-of":{}},"f:ownerReferences":{".":{},"k:{\"uid\":\"18d9928b-0d1c-47be-80ec-20960d053827\"}":{".":{},"f:apiVersion":{},"f:blockOwnerDeletion":{},"f:controller":{},"f:kind":{},"f:name":{},"f:uid":{}}}},"f:rules":{}}}]},"rules":[{"verbs":["get"],"apiGroups":[""],"resources":["endpoints"]},{"verbs":["create"],"apiGroups":[""],"resources":["events"]}]}
2022/03/18 18:01:18 learn_server.go:291: [SIEVE-AFTER-READ]	Get	true	rolebinding	default	rabbitmq-cluster-server	github.com/rabbitmq/cluster-operator/controllers.(*RabbitmqClusterReconciler)	NoError	{"kind":"RoleBinding","apiVersion":"rbac.authorization.k8s.io/v1","metadata":{"name":"rabbitmq-cluster-server","namespace":"default","selfLink":"/apis/rbac.authorization.k8s.io/v1/namespaces/default/rolebindings/rabbitmq-cluster-server","uid":"495e9f7c-a20d-4515-86b0-34149a855034","resourceVersion":"725","creationTimestamp":"2022-03-18T18:00:38Z","labels":{"app.kubernetes.io/component":"rabbitmq","app.kubernetes.io/name":"rabbitmq-cluster","app.kubernetes.io/part-of":"rabbitmq"},"ownerReferences":[{"apiVersion":"rabbitmq.com/v1beta1","kind":"RabbitmqCluster","name":"rabbitmq-cluster","uid":"18d9928b-0d1c-47be-80ec-20960d053827","controller":true,"blockOwnerDeletion":true}],"managedFields":[{"manager":"manager","operation":"Update","apiVersion":"rbac.authorization.k8s.io/v1","time":"2022-03-18T18:00:38Z","fieldsType":"FieldsV1","fieldsV1":{"f:metadata":{"f:labels":{".":{},"f:app.kubernetes.io/component":{},"f:app.kubernetes.io/name":{},"f:app.kubernetes.io/part-of":{}},"f:ownerReferences":{".":{},"k:{\"uid\":\"18d9928b-0d1c-47be-80ec-20960d053827\"}":{".":{},"f:apiVersion":{},"f:blockOwnerDeletion":{},"f:controller":{},"f:kind":{},"f:name":{},"f:uid":{}}}},"f:roleRef":{"f:apiGroup":{},"f:kind":{},"f:name":{}},"f:subjects":{}}}]},"subjects":[{"kind":"ServiceAccount","name":"rabbitmq-cluster-server"}],"roleRef":{"apiGroup":"rbac.authorization.k8s.io","kind":"Role","name":"rabbitmq-cluster-peer-discovery"}}
2022/03/18 18:01:18 learn_server.go:291: [SIEVE-AFTER-READ]	Get	true	statefulset	default	rabbitmq-cluster-server	github.com/rabbitmq/cluster-operator/controllers.(*RabbitmqClusterReconciler)	NoError	{"kind":"StatefulSet","apiVersion":"apps/v1","metadata":{"name":"rabbitmq-cluster-server","namespace":"default","selfLink":"/apis/apps/v1/namespaces/default/statefulsets/rabbitmq-cluster-server","uid":"cb5c43bc-6ee7-481c-ab01-6f3acffdd3c8","resourceVersion":"948","generation":1,"creationTimestamp":"2022-03-18T18:00:38Z","labels":{"app.kubernetes.io/component":"rabbitmq","app.kubernetes.io/name":"rabbitmq-cluster","app.kubernetes.io/part-of":"rabbitmq"},"ownerReferences":[{"apiVersion":"rabbitmq.com/v1beta1","kind":"RabbitmqCluster","name":"rabbitmq-cluster","uid":"18d9928b-0d1c-47be-80ec-20960d053827","controller":true,"blockOwnerDeletion":true}],"managedFields":[{"manager":"manager","operation":"Update","apiVersion":"apps/v1","time":"2022-03-18T18:00:38Z","fieldsType":"FieldsV1","fieldsV1":{"f:metadata":{"f:labels":{".":{},"f:app.kubernetes.io/component":{},"f:app.kubernetes.io/name":{},"f:app.kubernetes.io/part-of":{}},"f:ownerReferences":{".":{},"k:{\"uid\":\"18d9928b-0d1c-47be-80ec-20960d053827\"}":{".":{},"f:apiVersion":{},"f:blockOwnerDeletion":{},"f:controller":{},"f:kind":{},"f:name":{},"f:uid":{}}}},"f:spec":{"f:podManagementPolicy":{},"f:replicas":{},"f:revisionHistoryLimit":{},"f:selector":{"f:matchLabels":{".":{},"f:app.kubernetes.io/name":{}}},"f:serviceName":{},"f:template":{"f:metadata":{"f:annotations":{".":{},"f:prometheus.io/port":{},"f:prometheus.io/scrape":{}},"f:labels":{".":{},"f:app.kubernetes.io/component":{},"f:app.kubernetes.io/name":{},"f:app.kubernetes.io/part-of":{}}},"f:spec":{"f:automountServiceAccountToken":{},"f:containers":{"k:{\"name\":\"rabbitmq\"}":{".":{},"f:env":{".":{},"k:{\"name\":\"K8S_HOSTNAME_SUFFIX\"}":{".":{},"f:name":{},"f:value":{}},"k:{\"name\":\"K8S_SERVICE_NAME\"}":{".":{},"f:name":{},"f:value":{}},"k:{\"name\":\"MY_POD_NAME\"}":{".":{},"f:name":{},"f:valueFrom":{".":{},"f:fieldRef":{".":{},"f:apiVersion":{},"f:fieldPath":{}}}},"k:{\"name\":\"MY_POD_NAMESPACE\"}":{".":{},"f:name":{},"f:valueFrom":{".":{},"f:fieldRef":{".":{},"f:apiVersion":{},"f:fieldPath":{}}}},"k:{\"name\":\"RABBITMQ_ENABLED_PLUGINS_FILE\"}":{".":{},"f:name":{},"f:value":{}},"k:{\"name\":\"RABBITMQ_NODENAME\"}":{".":{},"f:name":{},"f:value":{}},"k:{\"name\":\"RABBITMQ_USE_LONGNAME\"}":{".":{},"f:name":{},"f:value":{}}},"f:image":{},"f:imagePullPolicy":{},"f:lifecycle":{".":{},"f:preStop":{".":{},"f:exec":{".":{},"f:command":{}}}},"f:name":{},"f:ports":{".":{},"k:{\"containerPort\":4369,\"protocol\":\"TCP\"}":{".":{},"f:containerPort":{},"f:name":{},"f:protocol":{}},"k:{\"containerPort\":5672,\"protocol\":\"TCP\"}":{".":{},"f:containerPort":{},"f:name":{},"f:protocol":{}},"k:{\"containerPort\":15672,\"protocol\":\"TCP\"}":{".":{},"f:containerPort":{},"f:name":{},"f:protocol":{}},"k:{\"containerPort\":15692,\"protocol\":\"TCP\"}":{".":{},"f:containerPort":{},"f:name":{},"f:protocol":{}}},"f:readinessProbe":{".":{},"f:failureThreshold":{},"f:initialDelaySeconds":{},"f:periodSeconds":{},"f:successThreshold":{},"f:tcpSocket":{".":{},"f:port":{}},"f:timeoutSeconds":{}},"f:resources":{".":{},"f:limits":{".":{},"f:cpu":{},"f:memory":{}},"f:requests":{".":{},"f:cpu":{},"f:memory":{}}},"f:terminationMessagePath":{},"f:terminationMessagePolicy":{},"f:volumeMounts":{".":{},"k:{\"mountPath\":\"/etc/pod-info/\"}":{".":{},"f:mountPath":{},"f:name":{}},"k:{\"mountPath\":\"/etc/rabbitmq/conf.d/10-operatorDefaults.conf\"}":{".":{},"f:mountPath":{},"f:name":{},"f:subPath":{}},"k:{\"mountPath\":\"/etc/rabbitmq/conf.d/11-default_user.conf\"}":{".":{},"f:mountPath":{},"f:name":{},"f:subPath":{}},"k:{\"mountPath\":\"/etc/rabbitmq/conf.d/90-userDefinedConfiguration.conf\"}":{".":{},"f:mountPath":{},"f:name":{},"f:subPath":{}},"k:{\"mountPath\":\"/operator\"}":{".":{},"f:mountPath":{},"f:name":{}},"k:{\"mountPath\":\"/var/lib/rabbitmq/\"}":{".":{},"f:mountPath":{},"f:name":{}},"k:{\"mountPath\":\"/var/lib/rabbitmq/mnesia/\"}":{".":{},"f:mountPath":{},"f:name":{}}}}},"f:dnsPolicy":{},"f:initContainers":{".":{},"k:{\"name\":\"setup-container\"}":{".":{},"f:command":{},"f:image":{},"f:imagePullPolicy":{},"f:name":{},"f:resources":{".":{},"f:limits":{".":{},"f:cpu":{},"f:memory":{}},"f:requests":{".":{},"f:cpu":{},"f:memory":{}}},"f:securityContext":{".":{},"f:capabilities":{".":{},"f:drop":{}},"f:runAsUser":{}},"f:terminationMessagePath":{},"f:terminationMessagePolicy":{},"f:volumeMounts":{".":{},"k:{\"mountPath\":\"/operator\"}":{".":{},"f:mountPath":{},"f:name":{}},"k:{\"mountPath\":\"/tmp/default_user.conf\"}":{".":{},"f:mountPath":{},"f:name":{},"f:subPath":{}},"k:{\"mountPath\":\"/tmp/erlang-cookie-secret/\"}":{".":{},"f:mountPath":{},"f:name":{}},"k:{\"mountPath\":\"/tmp/rabbitmq-plugins/\"}":{".":{},"f:mountPath":{},"f:name":{}},"k:{\"mountPath\":\"/var/lib/rabbitmq/\"}":{".":{},"f:mountPath":{},"f:name":{}},"k:{\"mountPath\":\"/var/lib/rabbitmq/mnesia/\"}":{".":{},"f:mountPath":{},"f:name":{}}}}},"f:restartPolicy":{},"f:schedulerName":{},"f:securityContext":{".":{},"f:fsGroup":{},"f:runAsGroup":{},"f:runAsUser":{}},"f:serviceAccount":{},"f:serviceAccountName":{},"f:terminationGracePeriodSeconds":{},"f:topologySpreadConstraints":{".":{},"k:{\"topologyKey\":\"topology.kubernetes.io/zone\",\"whenUnsatisfiable\":\"ScheduleAnyway\"}":{".":{},"f:labelSelector":{".":{},"f:matchLabels":{".":{},"f:app.kubernetes.io/name":{}}},"f:maxSkew":{},"f:topologyKey":{},"f:whenUnsatisfiable":{}}},"f:volumes":{".":{},"k:{\"name\":\"erlang-cookie-secret\"}":{".":{},"f:name":{},"f:secret":{".":{},"f:defaultMode":{},"f:secretName":{}}},"k:{\"name\":\"plugins-conf\"}":{".":{},"f:configMap":{".":{},"f:defaultMode":{},"f:name":{}},"f:name":{}},"k:{\"name\":\"pod-info\"}":{".":{},"f:downwardAPI":{".":{},"f:defaultMode":{},"f:items":{}},"f:name":{}},"k:{\"name\":\"rabbitmq-confd\"}":{".":{},"f:name":{},"f:projected":{".":{},"f:defaultMode":{},"f:sources":{}}},"k:{\"name\":\"rabbitmq-erlang-cookie\"}":{".":{},"f:emptyDir":{},"f:name":{}},"k:{\"name\":\"rabbitmq-plugins\"}":{".":{},"f:emptyDir":{},"f:name":{}}}}},"f:updateStrategy":{"f:rollingUpdate":{".":{},"f:partition":{}},"f:type":{}},"f:volumeClaimTemplates":{}}}},{"manager":"kube-controller-manager","operation":"Update","apiVersion":"apps/v1","time":"2022-03-18T18:01:17Z","fieldsType":"FieldsV1","fieldsV1":{"f:status":{"f:collisionCount":{},"f:currentReplicas":{},"f:currentRevision":{},"f:observedGeneration":{},"f:readyReplicas":{},"f:replicas":{},"f:updateRevision":{},"f:updatedReplicas":{}}}}]},"spec":{"replicas":1,"selector":{"matchLabels":{"app.kubernetes.io/name":"rabbitmq-cluster"}},"template":{"metadata":{"creationTimestamp":null,"labels":{"app.kubernetes.io/component":"rabbitmq","app.kubernetes.io/name":"rabbitmq-cluster","app.kubernetes.io/part-of":"rabbitmq"},"annotations":{"prometheus.io/port":"15692","prometheus.io/scrape":"true"}},"spec":{"volumes":[{"name":"plugins-conf","configMap":{"name":"rabbitmq-cluster-plugins-conf","defaultMode":420}},{"name":"rabbitmq-confd","projected":{"sources":[{"secret":{"name":"rabbitmq-cluster-default-user","items":[{"key":"default_user.conf","path":"default_user.conf"}]}},{"configMap":{"name":"rabbitmq-cluster-server-conf","items":[{"key":"operatorDefaults.conf","path":"operatorDefaults.conf"},{"key":"userDefinedConfiguration.conf","path":"userDefinedConfiguration.conf"}]}}],"defaultMode":420}},{"name":"rabbitmq-erlang-cookie","emptyDir":{}},{"name":"erlang-cookie-secret","secret":{"secretName":"rabbitmq-cluster-erlang-cookie","defaultMode":420}},{"name":"rabbitmq-plugins","emptyDir":{}},{"name":"pod-info","downwardAPI":{"items":[{"path":"skipPreStopChecks","fieldRef":{"apiVersion":"v1","fieldPath":"metadata.labels['skipPreStopChecks']"}}],"defaultMode":420}}],"initContainers":[{"name":"setup-container","image":"rabbitmq:3.8.12-management","command":["sh","-c","cp /tmp/erlang-cookie-secret/.erlang.cookie /var/lib/rabbitmq/.erlang.cookie \u0026\u0026 chown 999:999 /var/lib/rabbitmq/.erlang.cookie \u0026\u0026 chmod 600 /var/lib/rabbitmq/.erlang.cookie ; cp /tmp/rabbitmq-plugins/enabled_plugins /operator/enabled_plugins \u0026\u0026 chown 999:999 /operator/enabled_plugins ; chown 999:999 /var/lib/rabbitmq/mnesia/ ; echo '[default]' \u003e /var/lib/rabbitmq/.rabbitmqadmin.conf \u0026\u0026 sed -e 's/default_user/username/' -e 's/default_pass/password/' /tmp/default_user.conf \u003e\u003e /var/lib/rabbitmq/.rabbitmqadmin.conf \u0026\u0026 chown 999:999 /var/lib/rabbitmq/.rabbitmqadmin.conf \u0026\u0026 chmod 600 /var/lib/rabbitmq/.rabbitmqadmin.conf"],"resources":{"limits":{"cpu":"100m","memory":"500Mi"},"requests":{"cpu":"100m","memory":"500Mi"}},"volumeMounts":[{"name":"plugins-conf","mountPath":"/tmp/rabbitmq-plugins/"},{"name":"rabbitmq-erlang-cookie","mountPath":"/var/lib/rabbitmq/"},{"name":"erlang-cookie-secret","mountPath":"/tmp/erlang-cookie-secret/"},{"name":"rabbitmq-plugins","mountPath":"/operator"},{"name":"persistence","mountPath":"/var/lib/rabbitmq/mnesia/"},{"name":"rabbitmq-confd","mountPath":"/tmp/default_user.conf","subPath":"default_user.conf"}],"terminationMessagePath":"/dev/termination-log","terminationMessagePolicy":"File","imagePullPolicy":"IfNotPresent","securityContext":{"capabilities":{"drop":["FSETID","KILL","SETGID","SETUID","SETPCAP","NET_BIND_SERVICE","NET_RAW","SYS_CHROOT","MKNOD","AUDIT_WRITE","SETFCAP"]},"runAsUser":0}}],"containers":[{"name":"rabbitmq","image":"rabbitmq:3.8.12-management","ports":[{"name":"epmd","containerPort":4369,"protocol":"TCP"},{"name":"amqp","containerPort":5672,"protocol":"TCP"},{"name":"management","containerPort":15672,"protocol":"TCP"},{"name":"prometheus","containerPort":15692,"protocol":"TCP"}],"env":[{"name":"MY_POD_NAME","valueFrom":{"fieldRef":{"apiVersion":"v1","fieldPath":"metadata.name"}}},{"name":"MY_POD_NAMESPACE","valueFrom":{"fieldRef":{"apiVersion":"v1","fieldPath":"metadata.namespace"}}},{"name":"RABBITMQ_ENABLED_PLUGINS_FILE","value":"/operator/enabled_plugins"},{"name":"K8S_SERVICE_NAME","value":"rabbitmq-cluster-nodes"},{"name":"RABBITMQ_USE_LONGNAME","value":"true"},{"name":"RABBITMQ_NODENAME","value":"rabbit@$(MY_POD_NAME).$(K8S_SERVICE_NAME).$(MY_POD_NAMESPACE)"},{"name":"K8S_HOSTNAME_SUFFIX","value":".$(K8S_SERVICE_NAME).$(MY_POD_NAMESPACE)"}],"resources":{"limits":{"cpu":"2","memory":"2Gi"},"requests":{"cpu":"1","memory":"2Gi"}},"volumeMounts":[{"name":"rabbitmq-erlang-cookie","mountPath":"/var/lib/rabbitmq/"},{"name":"persistence","mountPath":"/var/lib/rabbitmq/mnesia/"},{"name":"rabbitmq-plugins","mountPath":"/operator"},{"name":"rabbitmq-confd","mountPath":"/etc/rabbitmq/conf.d/10-operatorDefaults.conf","subPath":"operatorDefaults.conf"},{"name":"rabbitmq-confd","mountPath":"/etc/rabbitmq/conf.d/11-default_user.conf","subPath":"default_user.conf"},{"name":"rabbitmq-confd","mountPath":"/etc/rabbitmq/conf.d/90-userDefinedConfiguration.conf","subPath":"userDefinedConfiguration.conf"},{"name":"pod-info","mountPath":"/etc/pod-info/"}],"readinessProbe":{"tcpSocket":{"port":"amqp"},"initialDelaySeconds":10,"timeoutSeconds":5,"periodSeconds":10,"successThreshold":1,"failureThreshold":3},"lifecycle":{"preStop":{"exec":{"command":["/bin/bash","-c","if [ ! -z \"$(cat /etc/pod-info/skipPreStopChecks)\" ]; then exit 0; fi; rabbitmq-upgrade await_online_quorum_plus_one -t 604800; rabbitmq-upgrade await_online_synchronized_mirror -t 604800; rabbitmq-upgrade drain -t 604800"]}}},"terminationMessagePath":"/dev/termination-log","terminationMessagePolicy":"File","imagePullPolicy":"IfNotPresent"}],"restartPolicy":"Always","terminationGracePeriodSeconds":604800,"dnsPolicy":"ClusterFirst","serviceAccountName":"rabbitmq-cluster-server","serviceAccount":"rabbitmq-cluster-server","automountServiceAccountToken":true,"securityContext":{"runAsUser":999,"runAsGroup":999,"fsGroup":999},"schedulerName":"default-scheduler","topologySpreadConstraints":[{"maxSkew":1,"topologyKey":"topology.kubernetes.io/zone","whenUnsatisfiable":"ScheduleAnyway","labelSelector":{"matchLabels":{"app.kubernetes.io/name":"rabbitmq-cluster"}}}]}},"volumeClaimTemplates":[{"metadata":{"name":"persistence","namespace":"default","creationTimestamp":null,"labels":{"app.kubernetes.io/component":"rabbitmq","app.kubernetes.io/name":"rabbitmq-cluster","app.kubernetes.io/part-of":"rabbitmq"},"ownerReferences":[{"apiVersion":"rabbitmq.com/v1beta1","kind":"RabbitmqCluster","name":"rabbitmq-cluster","uid":"18d9928b-0d1c-47be-80ec-20960d053827","controller":true,"blockOwnerDeletion":false}]},"spec":{"accessModes":["ReadWriteOnce"],"resources":{"requests":{"storage":"10Gi"}},"volumeMode":"Filesystem"},"status":{"phase":"Pending"}}],"serviceName":"rabbitmq-cluster-nodes","podManagementPolicy":"Parallel","updateStrategy":{"type":"RollingUpdate","rollingUpdate":{"partition":0}},"revisionHistoryLimit":10},"status":{"observedGeneration":1,"replicas":1,"readyReplicas":1,"currentReplicas":1,"updatedReplicas":1,"currentRevision":"rabbitmq-cluster-server-5f8b8665fb","updateRevision":"rabbitmq-cluster-server-5f8b8665fb","collisionCount":0}}
2022/03/18 18:01:18 learn_server.go:291: [SIEVE-AFTER-READ]	Get	true	statefulset	default	rabbitmq-cluster-server	github.com/rabbitmq/cluster-operator/controllers.(*RabbitmqClusterReconciler)	NoError	{"kind":"StatefulSet","apiVersion":"apps/v1","metadata":{"name":"rabbitmq-cluster-server","namespace":"default","selfLink":"/apis/apps/v1/namespaces/default/statefulsets/rabbitmq-cluster-server","uid":"cb5c43bc-6ee7-481c-ab01-6f3acffdd3c8","resourceVersion":"948","generation":1,"creationTimestamp":"2022-03-18T18:00:38Z","labels":{"app.kubernetes.io/component":"rabbitmq","app.kubernetes.io/name":"rabbitmq-cluster","app.kubernetes.io/part-of":"rabbitmq"},"ownerReferences":[{"apiVersion":"rabbitmq.com/v1beta1","kind":"RabbitmqCluster","name":"rabbitmq-cluster","uid":"18d9928b-0d1c-47be-80ec-20960d053827","controller":true,"blockOwnerDeletion":true}],"managedFields":[{"manager":"manager","operation":"Update","apiVersion":"apps/v1","time":"2022-03-18T18:00:38Z","fieldsType":"FieldsV1","fieldsV1":{"f:metadata":{"f:labels":{".":{},"f:app.kubernetes.io/component":{},"f:app.kubernetes.io/name":{},"f:app.kubernetes.io/part-of":{}},"f:ownerReferences":{".":{},"k:{\"uid\":\"18d9928b-0d1c-47be-80ec-20960d053827\"}":{".":{},"f:apiVersion":{},"f:blockOwnerDeletion":{},"f:controller":{},"f:kind":{},"f:name":{},"f:uid":{}}}},"f:spec":{"f:podManagementPolicy":{},"f:replicas":{},"f:revisionHistoryLimit":{},"f:selector":{"f:matchLabels":{".":{},"f:app.kubernetes.io/name":{}}},"f:serviceName":{},"f:template":{"f:metadata":{"f:annotations":{".":{},"f:prometheus.io/port":{},"f:prometheus.io/scrape":{}},"f:labels":{".":{},"f:app.kubernetes.io/component":{},"f:app.kubernetes.io/name":{},"f:app.kubernetes.io/part-of":{}}},"f:spec":{"f:automountServiceAccountToken":{},"f:containers":{"k:{\"name\":\"rabbitmq\"}":{".":{},"f:env":{".":{},"k:{\"name\":\"K8S_HOSTNAME_SUFFIX\"}":{".":{},"f:name":{},"f:value":{}},"k:{\"name\":\"K8S_SERVICE_NAME\"}":{".":{},"f:name":{},"f:value":{}},"k:{\"name\":\"MY_POD_NAME\"}":{".":{},"f:name":{},"f:valueFrom":{".":{},"f:fieldRef":{".":{},"f:apiVersion":{},"f:fieldPath":{}}}},"k:{\"name\":\"MY_POD_NAMESPACE\"}":{".":{},"f:name":{},"f:valueFrom":{".":{},"f:fieldRef":{".":{},"f:apiVersion":{},"f:fieldPath":{}}}},"k:{\"name\":\"RABBITMQ_ENABLED_PLUGINS_FILE\"}":{".":{},"f:name":{},"f:value":{}},"k:{\"name\":\"RABBITMQ_NODENAME\"}":{".":{},"f:name":{},"f:value":{}},"k:{\"name\":\"RABBITMQ_USE_LONGNAME\"}":{".":{},"f:name":{},"f:value":{}}},"f:image":{},"f:imagePullPolicy":{},"f:lifecycle":{".":{},"f:preStop":{".":{},"f:exec":{".":{},"f:command":{}}}},"f:name":{},"f:ports":{".":{},"k:{\"containerPort\":4369,\"protocol\":\"TCP\"}":{".":{},"f:containerPort":{},"f:name":{},"f:protocol":{}},"k:{\"containerPort\":5672,\"protocol\":\"TCP\"}":{".":{},"f:containerPort":{},"f:name":{},"f:protocol":{}},"k:{\"containerPort\":15672,\"protocol\":\"TCP\"}":{".":{},"f:containerPort":{},"f:name":{},"f:protocol":{}},"k:{\"containerPort\":15692,\"protocol\":\"TCP\"}":{".":{},"f:containerPort":{},"f:name":{},"f:protocol":{}}},"f:readinessProbe":{".":{},"f:failureThreshold":{},"f:initialDelaySeconds":{},"f:periodSeconds":{},"f:successThreshold":{},"f:tcpSocket":{".":{},"f:port":{}},"f:timeoutSeconds":{}},"f:resources":{".":{},"f:limits":{".":{},"f:cpu":{},"f:memory":{}},"f:requests":{".":{},"f:cpu":{},"f:memory":{}}},"f:terminationMessagePath":{},"f:terminationMessagePolicy":{},"f:volumeMounts":{".":{},"k:{\"mountPath\":\"/etc/pod-info/\"}":{".":{},"f:mountPath":{},"f:name":{}},"k:{\"mountPath\":\"/etc/rabbitmq/conf.d/10-operatorDefaults.conf\"}":{".":{},"f:mountPath":{},"f:name":{},"f:subPath":{}},"k:{\"mountPath\":\"/etc/rabbitmq/conf.d/11-default_user.conf\"}":{".":{},"f:mountPath":{},"f:name":{},"f:subPath":{}},"k:{\"mountPath\":\"/etc/rabbitmq/conf.d/90-userDefinedConfiguration.conf\"}":{".":{},"f:mountPath":{},"f:name":{},"f:subPath":{}},"k:{\"mountPath\":\"/operator\"}":{".":{},"f:mountPath":{},"f:name":{}},"k:{\"mountPath\":\"/var/lib/rabbitmq/\"}":{".":{},"f:mountPath":{},"f:name":{}},"k:{\"mountPath\":\"/var/lib/rabbitmq/mnesia/\"}":{".":{},"f:mountPath":{},"f:name":{}}}}},"f:dnsPolicy":{},"f:initContainers":{".":{},"k:{\"name\":\"setup-container\"}":{".":{},"f:command":{},"f:image":{},"f:imagePullPolicy":{},"f:name":{},"f:resources":{".":{},"f:limits":{".":{},"f:cpu":{},"f:memory":{}},"f:requests":{".":{},"f:cpu":{},"f:memory":{}}},"f:securityContext":{".":{},"f:capabilities":{".":{},"f:drop":{}},"f:runAsUser":{}},"f:terminationMessagePath":{},"f:terminationMessagePolicy":{},"f:volumeMounts":{".":{},"k:{\"mountPath\":\"/operator\"}":{".":{},"f:mountPath":{},"f:name":{}},"k:{\"mountPath\":\"/tmp/default_user.conf\"}":{".":{},"f:mountPath":{},"f:name":{},"f:subPath":{}},"k:{\"mountPath\":\"/tmp/erlang-cookie-secret/\"}":{".":{},"f:mountPath":{},"f:name":{}},"k:{\"mountPath\":\"/tmp/rabbitmq-plugins/\"}":{".":{},"f:mountPath":{},"f:name":{}},"k:{\"mountPath\":\"/var/lib/rabbitmq/\"}":{".":{},"f:mountPath":{},"f:name":{}},"k:{\"mountPath\":\"/var/lib/rabbitmq/mnesia/\"}":{".":{},"f:mountPath":{},"f:name":{}}}}},"f:restartPolicy":{},"f:schedulerName":{},"f:securityContext":{".":{},"f:fsGroup":{},"f:runAsGroup":{},"f:runAsUser":{}},"f:serviceAccount":{},"f:serviceAccountName":{},"f:terminationGracePeriodSeconds":{},"f:topologySpreadConstraints":{".":{},"k:{\"topologyKey\":\"topology.kubernetes.io/zone\",\"whenUnsatisfiable\":\"ScheduleAnyway\"}":{".":{},"f:labelSelector":{".":{},"f:matchLabels":{".":{},"f:app.kubernetes.io/name":{}}},"f:maxSkew":{},"f:topologyKey":{},"f:whenUnsatisfiable":{}}},"f:volumes":{".":{},"k:{\"name\":\"erlang-cookie-secret\"}":{".":{},"f:name":{},"f:secret":{".":{},"f:defaultMode":{},"f:secretName":{}}},"k:{\"name\":\"plugins-conf\"}":{".":{},"f:configMap":{".":{},"f:defaultMode":{},"f:name":{}},"f:name":{}},"k:{\"name\":\"pod-info\"}":{".":{},"f:downwardAPI":{".":{},"f:defaultMode":{},"f:items":{}},"f:name":{}},"k:{\"name\":\"rabbitmq-confd\"}":{".":{},"f:name":{},"f:projected":{".":{},"f:defaultMode":{},"f:sources":{}}},"k:{\"name\":\"rabbitmq-erlang-cookie\"}":{".":{},"f:emptyDir":{},"f:name":{}},"k:{\"name\":\"rabbitmq-plugins\"}":{".":{},"f:emptyDir":{},"f:name":{}}}}},"f:updateStrategy":{"f:rollingUpdate":{".":{},"f:partition":{}},"f:type":{}},"f:volumeClaimTemplates":{}}}},{"manager":"kube-controller-manager","operation":"Update","apiVersion":"apps/v1","time":"2022-03-18T18:01:17Z","fieldsType":"FieldsV1","fieldsV1":{"f:status":{"f:collisionCount":{},"f:currentReplicas":{},"f:currentRevision":{},"f:observedGeneration":{},"f:readyReplicas":{},"f:replicas":{},"f:updateRevision":{},"f:updatedReplicas":{}}}}]},"spec":{"replicas":1,"selector":{"matchLabels":{"app.kubernetes.io/name":"rabbitmq-cluster"}},"template":{"metadata":{"creationTimestamp":null,"labels":{"app.kubernetes.io/component":"rabbitmq","app.kubernetes.io/name":"rabbitmq-cluster","app.kubernetes.io/part-of":"rabbitmq"},"annotations":{"prometheus.io/port":"15692","prometheus.io/scrape":"true"}},"spec":{"volumes":[{"name":"plugins-conf","configMap":{"name":"rabbitmq-cluster-plugins-conf","defaultMode":420}},{"name":"rabbitmq-confd","projected":{"sources":[{"secret":{"name":"rabbitmq-cluster-default-user","items":[{"key":"default_user.conf","path":"default_user.conf"}]}},{"configMap":{"name":"rabbitmq-cluster-server-conf","items":[{"key":"operatorDefaults.conf","path":"operatorDefaults.conf"},{"key":"userDefinedConfiguration.conf","path":"userDefinedConfiguration.conf"}]}}],"defaultMode":420}},{"name":"rabbitmq-erlang-cookie","emptyDir":{}},{"name":"erlang-cookie-secret","secret":{"secretName":"rabbitmq-cluster-erlang-cookie","defaultMode":420}},{"name":"rabbitmq-plugins","emptyDir":{}},{"name":"pod-info","downwardAPI":{"items":[{"path":"skipPreStopChecks","fieldRef":{"apiVersion":"v1","fieldPath":"metadata.labels['skipPreStopChecks']"}}],"defaultMode":420}}],"initContainers":[{"name":"setup-container","image":"rabbitmq:3.8.12-management","command":["sh","-c","cp /tmp/erlang-cookie-secret/.erlang.cookie /var/lib/rabbitmq/.erlang.cookie \u0026\u0026 chown 999:999 /var/lib/rabbitmq/.erlang.cookie \u0026\u0026 chmod 600 /var/lib/rabbitmq/.erlang.cookie ; cp /tmp/rabbitmq-plugins/enabled_plugins /operator/enabled_plugins \u0026\u0026 chown 999:999 /operator/enabled_plugins ; chown 999:999 /var/lib/rabbitmq/mnesia/ ; echo '[default]' \u003e /var/lib/rabbitmq/.rabbitmqadmin.conf \u0026\u0026 sed -e 's/default_user/username/' -e 's/default_pass/password/' /tmp/default_user.conf \u003e\u003e /var/lib/rabbitmq/.rabbitmqadmin.conf \u0026\u0026 chown 999:999 /var/lib/rabbitmq/.rabbitmqadmin.conf \u0026\u0026 chmod 600 /var/lib/rabbitmq/.rabbitmqadmin.conf"],"resources":{"limits":{"cpu":"100m","memory":"500Mi"},"requests":{"cpu":"100m","memory":"500Mi"}},"volumeMounts":[{"name":"plugins-conf","mountPath":"/tmp/rabbitmq-plugins/"},{"name":"rabbitmq-erlang-cookie","mountPath":"/var/lib/rabbitmq/"},{"name":"erlang-cookie-secret","mountPath":"/tmp/erlang-cookie-secret/"},{"name":"rabbitmq-plugins","mountPath":"/operator"},{"name":"persistence","mountPath":"/var/lib/rabbitmq/mnesia/"},{"name":"rabbitmq-confd","mountPath":"/tmp/default_user.conf","subPath":"default_user.conf"}],"terminationMessagePath":"/dev/termination-log","terminationMessagePolicy":"File","imagePullPolicy":"IfNotPresent","securityContext":{"capabilities":{"drop":["FSETID","KILL","SETGID","SETUID","SETPCAP","NET_BIND_SERVICE","NET_RAW","SYS_CHROOT","MKNOD","AUDIT_WRITE","SETFCAP"]},"runAsUser":0}}],"containers":[{"name":"rabbitmq","image":"rabbitmq:3.8.12-management","ports":[{"name":"epmd","containerPort":4369,"protocol":"TCP"},{"name":"amqp","containerPort":5672,"protocol":"TCP"},{"name":"management","containerPort":15672,"protocol":"TCP"},{"name":"prometheus","containerPort":15692,"protocol":"TCP"}],"env":[{"name":"MY_POD_NAME","valueFrom":{"fieldRef":{"apiVersion":"v1","fieldPath":"metadata.name"}}},{"name":"MY_POD_NAMESPACE","valueFrom":{"fieldRef":{"apiVersion":"v1","fieldPath":"metadata.namespace"}}},{"name":"RABBITMQ_ENABLED_PLUGINS_FILE","value":"/operator/enabled_plugins"},{"name":"K8S_SERVICE_NAME","value":"rabbitmq-cluster-nodes"},{"name":"RABBITMQ_USE_LONGNAME","value":"true"},{"name":"RABBITMQ_NODENAME","value":"rabbit@$(MY_POD_NAME).$(K8S_SERVICE_NAME).$(MY_POD_NAMESPACE)"},{"name":"K8S_HOSTNAME_SUFFIX","value":".$(K8S_SERVICE_NAME).$(MY_POD_NAMESPACE)"}],"resources":{"limits":{"cpu":"2","memory":"2Gi"},"requests":{"cpu":"1","memory":"2Gi"}},"volumeMounts":[{"name":"rabbitmq-erlang-cookie","mountPath":"/var/lib/rabbitmq/"},{"name":"persistence","mountPath":"/var/lib/rabbitmq/mnesia/"},{"name":"rabbitmq-plugins","mountPath":"/operator"},{"name":"rabbitmq-confd","mountPath":"/etc/rabbitmq/conf.d/10-operatorDefaults.conf","subPath":"operatorDefaults.conf"},{"name":"rabbitmq-confd","mountPath":"/etc/rabbitmq/conf.d/11-default_user.conf","subPath":"default_user.conf"},{"name":"rabbitmq-confd","mountPath":"/etc/rabbitmq/conf.d/90-userDefinedConfiguration.conf","subPath":"userDefinedConfiguration.conf"},{"name":"pod-info","mountPath":"/etc/pod-info/"}],"readinessProbe":{"tcpSocket":{"port":"amqp"},"initialDelaySeconds":10,"timeoutSeconds":5,"periodSeconds":10,"successThreshold":1,"failureThreshold":3},"lifecycle":{"preStop":{"exec":{"command":["/bin/bash","-c","if [ ! -z \"$(cat /etc/pod-info/skipPreStopChecks)\" ]; then exit 0; fi; rabbitmq-upgrade await_online_quorum_plus_one -t 604800; rabbitmq-upgrade await_online_synchronized_mirror -t 604800; rabbitmq-upgrade drain -t 604800"]}}},"terminationMessagePath":"/dev/termination-log","terminationMessagePolicy":"File","imagePullPolicy":"IfNotPresent"}],"restartPolicy":"Always","terminationGracePeriodSeconds":604800,"dnsPolicy":"ClusterFirst","serviceAccountName":"rabbitmq-cluster-server","serviceAccount":"rabbitmq-cluster-server","automountServiceAccountToken":true,"securityContext":{"runAsUser":999,"runAsGroup":999,"fsGroup":999},"schedulerName":"default-scheduler","topologySpreadConstraints":[{"maxSkew":1,"topologyKey":"topology.kubernetes.io/zone","whenUnsatisfiable":"ScheduleAnyway","labelSelector":{"matchLabels":{"app.kubernetes.io/name":"rabbitmq-cluster"}}}]}},"volumeClaimTemplates":[{"metadata":{"name":"persistence","namespace":"default","creationTimestamp":null,"labels":{"app.kubernetes.io/component":"rabbitmq","app.kubernetes.io/name":"rabbitmq-cluster","app.kubernetes.io/part-of":"rabbitmq"},"ownerReferences":[{"apiVersion":"rabbitmq.com/v1beta1","kind":"RabbitmqCluster","name":"rabbitmq-cluster","uid":"18d9928b-0d1c-47be-80ec-20960d053827","controller":true,"blockOwnerDeletion":false}]},"spec":{"accessModes":["ReadWriteOnce"],"resources":{"requests":{"storage":"10Gi"}},"volumeMode":"Filesystem"},"status":{"phase":"Pending"}}],"serviceName":"rabbitmq-cluster-nodes","podManagementPolicy":"Parallel","updateStrategy":{"type":"RollingUpdate","rollingUpdate":{"partition":0}},"revisionHistoryLimit":10},"status":{"observedGeneration":1,"replicas":1,"readyReplicas":1,"currentReplicas":1,"updatedReplicas":1,"currentRevision":"rabbitmq-cluster-server-5f8b8665fb","updateRevision":"rabbitmq-cluster-server-5f8b8665fb","collisionCount":0}}
2022/03/18 18:01:18 learn_server.go:256: [SIEVE-BEFORE-WRITE]	32
2022/03/18 18:01:18 learn_server.go:263: [SIEVE-AFTER-WRITE]	32	Update	statefulset	github.com/rabbitmq/cluster-operator/controllers.(*RabbitmqClusterReconciler)	NoError	{"metadata":{"name":"rabbitmq-cluster-server","namespace":"default","selfLink":"/apis/apps/v1/namespaces/default/statefulsets/rabbitmq-cluster-server","uid":"cb5c43bc-6ee7-481c-ab01-6f3acffdd3c8","resourceVersion":"948","generation":1,"creationTimestamp":"2022-03-18T18:00:38Z","labels":{"app.kubernetes.io/component":"rabbitmq","app.kubernetes.io/name":"rabbitmq-cluster","app.kubernetes.io/part-of":"rabbitmq"},"ownerReferences":[{"apiVersion":"rabbitmq.com/v1beta1","kind":"RabbitmqCluster","name":"rabbitmq-cluster","uid":"18d9928b-0d1c-47be-80ec-20960d053827","controller":true,"blockOwnerDeletion":true}],"managedFields":[{"manager":"manager","operation":"Update","apiVersion":"apps/v1","time":"2022-03-18T18:00:38Z","fieldsType":"FieldsV1","fieldsV1":{"f:metadata":{"f:labels":{".":{},"f:app.kubernetes.io/component":{},"f:app.kubernetes.io/name":{},"f:app.kubernetes.io/part-of":{}},"f:ownerReferences":{".":{},"k:{\"uid\":\"18d9928b-0d1c-47be-80ec-20960d053827\"}":{".":{},"f:apiVersion":{},"f:blockOwnerDeletion":{},"f:controller":{},"f:kind":{},"f:name":{},"f:uid":{}}}},"f:spec":{"f:podManagementPolicy":{},"f:replicas":{},"f:revisionHistoryLimit":{},"f:selector":{"f:matchLabels":{".":{},"f:app.kubernetes.io/name":{}}},"f:serviceName":{},"f:template":{"f:metadata":{"f:annotations":{".":{},"f:prometheus.io/port":{},"f:prometheus.io/scrape":{}},"f:labels":{".":{},"f:app.kubernetes.io/component":{},"f:app.kubernetes.io/name":{},"f:app.kubernetes.io/part-of":{}}},"f:spec":{"f:automountServiceAccountToken":{},"f:containers":{"k:{\"name\":\"rabbitmq\"}":{".":{},"f:env":{".":{},"k:{\"name\":\"K8S_HOSTNAME_SUFFIX\"}":{".":{},"f:name":{},"f:value":{}},"k:{\"name\":\"K8S_SERVICE_NAME\"}":{".":{},"f:name":{},"f:value":{}},"k:{\"name\":\"MY_POD_NAME\"}":{".":{},"f:name":{},"f:valueFrom":{".":{},"f:fieldRef":{".":{},"f:apiVersion":{},"f:fieldPath":{}}}},"k:{\"name\":\"MY_POD_NAMESPACE\"}":{".":{},"f:name":{},"f:valueFrom":{".":{},"f:fieldRef":{".":{},"f:apiVersion":{},"f:fieldPath":{}}}},"k:{\"name\":\"RABBITMQ_ENABLED_PLUGINS_FILE\"}":{".":{},"f:name":{},"f:value":{}},"k:{\"name\":\"RABBITMQ_NODENAME\"}":{".":{},"f:name":{},"f:value":{}},"k:{\"name\":\"RABBITMQ_USE_LONGNAME\"}":{".":{},"f:name":{},"f:value":{}}},"f:image":{},"f:imagePullPolicy":{},"f:lifecycle":{".":{},"f:preStop":{".":{},"f:exec":{".":{},"f:command":{}}}},"f:name":{},"f:ports":{".":{},"k:{\"containerPort\":4369,\"protocol\":\"TCP\"}":{".":{},"f:containerPort":{},"f:name":{},"f:protocol":{}},"k:{\"containerPort\":5672,\"protocol\":\"TCP\"}":{".":{},"f:containerPort":{},"f:name":{},"f:protocol":{}},"k:{\"containerPort\":15672,\"protocol\":\"TCP\"}":{".":{},"f:containerPort":{},"f:name":{},"f:protocol":{}},"k:{\"containerPort\":15692,\"protocol\":\"TCP\"}":{".":{},"f:containerPort":{},"f:name":{},"f:protocol":{}}},"f:readinessProbe":{".":{},"f:failureThreshold":{},"f:initialDelaySeconds":{},"f:periodSeconds":{},"f:successThreshold":{},"f:tcpSocket":{".":{},"f:port":{}},"f:timeoutSeconds":{}},"f:resources":{".":{},"f:limits":{".":{},"f:cpu":{},"f:memory":{}},"f:requests":{".":{},"f:cpu":{},"f:memory":{}}},"f:terminationMessagePath":{},"f:terminationMessagePolicy":{},"f:volumeMounts":{".":{},"k:{\"mountPath\":\"/etc/pod-info/\"}":{".":{},"f:mountPath":{},"f:name":{}},"k:{\"mountPath\":\"/etc/rabbitmq/conf.d/10-operatorDefaults.conf\"}":{".":{},"f:mountPath":{},"f:name":{},"f:subPath":{}},"k:{\"mountPath\":\"/etc/rabbitmq/conf.d/11-default_user.conf\"}":{".":{},"f:mountPath":{},"f:name":{},"f:subPath":{}},"k:{\"mountPath\":\"/etc/rabbitmq/conf.d/90-userDefinedConfiguration.conf\"}":{".":{},"f:mountPath":{},"f:name":{},"f:subPath":{}},"k:{\"mountPath\":\"/operator\"}":{".":{},"f:mountPath":{},"f:name":{}},"k:{\"mountPath\":\"/var/lib/rabbitmq/\"}":{".":{},"f:mountPath":{},"f:name":{}},"k:{\"mountPath\":\"/var/lib/rabbitmq/mnesia/\"}":{".":{},"f:mountPath":{},"f:name":{}}}}},"f:dnsPolicy":{},"f:initContainers":{".":{},"k:{\"name\":\"setup-container\"}":{".":{},"f:command":{},"f:image":{},"f:imagePullPolicy":{},"f:name":{},"f:resources":{".":{},"f:limits":{".":{},"f:cpu":{},"f:memory":{}},"f:requests":{".":{},"f:cpu":{},"f:memory":{}}},"f:securityContext":{".":{},"f:capabilities":{".":{},"f:drop":{}},"f:runAsUser":{}},"f:terminationMessagePath":{},"f:terminationMessagePolicy":{},"f:volumeMounts":{".":{},"k:{\"mountPath\":\"/operator\"}":{".":{},"f:mountPath":{},"f:name":{}},"k:{\"mountPath\":\"/tmp/default_user.conf\"}":{".":{},"f:mountPath":{},"f:name":{},"f:subPath":{}},"k:{\"mountPath\":\"/tmp/erlang-cookie-secret/\"}":{".":{},"f:mountPath":{},"f:name":{}},"k:{\"mountPath\":\"/tmp/rabbitmq-plugins/\"}":{".":{},"f:mountPath":{},"f:name":{}},"k:{\"mountPath\":\"/var/lib/rabbitmq/\"}":{".":{},"f:mountPath":{},"f:name":{}},"k:{\"mountPath\":\"/var/lib/rabbitmq/mnesia/\"}":{".":{},"f:mountPath":{},"f:name":{}}}}},"f:restartPolicy":{},"f:schedulerName":{},"f:securityContext":{".":{},"f:fsGroup":{},"f:runAsGroup":{},"f:runAsUser":{}},"f:serviceAccount":{},"f:serviceAccountName":{},"f:terminationGracePeriodSeconds":{},"f:topologySpreadConstraints":{".":{},"k:{\"topologyKey\":\"topology.kubernetes.io/zone\",\"whenUnsatisfiable\":\"ScheduleAnyway\"}":{".":{},"f:labelSelector":{".":{},"f:matchLabels":{".":{},"f:app.kubernetes.io/name":{}}},"f:maxSkew":{},"f:topologyKey":{},"f:whenUnsatisfiable":{}}},"f:volumes":{".":{},"k:{\"name\":\"erlang-cookie-secret\"}":{".":{},"f:name":{},"f:secret":{".":{},"f:defaultMode":{},"f:secretName":{}}},"k:{\"name\":\"plugins-conf\"}":{".":{},"f:configMap":{".":{},"f:defaultMode":{},"f:name":{}},"f:name":{}},"k:{\"name\":\"pod-info\"}":{".":{},"f:downwardAPI":{".":{},"f:defaultMode":{},"f:items":{}},"f:name":{}},"k:{\"name\":\"rabbitmq-confd\"}":{".":{},"f:name":{},"f:projected":{".":{},"f:defaultMode":{},"f:sources":{}}},"k:{\"name\":\"rabbitmq-erlang-cookie\"}":{".":{},"f:emptyDir":{},"f:name":{}},"k:{\"name\":\"rabbitmq-plugins\"}":{".":{},"f:emptyDir":{},"f:name":{}}}}},"f:updateStrategy":{"f:rollingUpdate":{".":{},"f:partition":{}},"f:type":{}},"f:volumeClaimTemplates":{}}}},{"manager":"kube-controller-manager","operation":"Update","apiVersion":"apps/v1","time":"2022-03-18T18:01:17Z","fieldsType":"FieldsV1","fieldsV1":{"f:status":{"f:collisionCount":{},"f:currentReplicas":{},"f:currentRevision":{},"f:observedGeneration":{},"f:readyReplicas":{},"f:replicas":{},"f:updateRevision":{},"f:updatedReplicas":{}}}}]},"spec":{"replicas":1,"selector":{"matchLabels":{"app.kubernetes.io/name":"rabbitmq-cluster"}},"template":{"metadata":{"creationTimestamp":null,"labels":{"app.kubernetes.io/component":"rabbitmq","app.kubernetes.io/name":"rabbitmq-cluster","app.kubernetes.io/part-of":"rabbitmq"},"annotations":{"prometheus.io/port":"15692","prometheus.io/scrape":"true"}},"spec":{"volumes":[{"name":"plugins-conf","configMap":{"name":"rabbitmq-cluster-plugins-conf","defaultMode":420}},{"name":"rabbitmq-confd","projected":{"sources":[{"secret":{"name":"rabbitmq-cluster-default-user","items":[{"key":"default_user.conf","path":"default_user.conf"}]}},{"configMap":{"name":"rabbitmq-cluster-server-conf","items":[{"key":"operatorDefaults.conf","path":"operatorDefaults.conf"},{"key":"userDefinedConfiguration.conf","path":"userDefinedConfiguration.conf"}]}}],"defaultMode":420}},{"name":"rabbitmq-erlang-cookie","emptyDir":{}},{"name":"erlang-cookie-secret","secret":{"secretName":"rabbitmq-cluster-erlang-cookie","defaultMode":420}},{"name":"rabbitmq-plugins","emptyDir":{}},{"name":"pod-info","downwardAPI":{"items":[{"path":"skipPreStopChecks","fieldRef":{"apiVersion":"v1","fieldPath":"metadata.labels['skipPreStopChecks']"}}],"defaultMode":420}}],"initContainers":[{"name":"setup-container","image":"rabbitmq:3.8.12-management","command":["sh","-c","cp /tmp/erlang-cookie-secret/.erlang.cookie /var/lib/rabbitmq/.erlang.cookie \u0026\u0026 chown 999:999 /var/lib/rabbitmq/.erlang.cookie \u0026\u0026 chmod 600 /var/lib/rabbitmq/.erlang.cookie ; cp /tmp/rabbitmq-plugins/enabled_plugins /operator/enabled_plugins \u0026\u0026 chown 999:999 /operator/enabled_plugins ; chown 999:999 /var/lib/rabbitmq/mnesia/ ; echo '[default]' \u003e /var/lib/rabbitmq/.rabbitmqadmin.conf \u0026\u0026 sed -e 's/default_user/username/' -e 's/default_pass/password/' /tmp/default_user.conf \u003e\u003e /var/lib/rabbitmq/.rabbitmqadmin.conf \u0026\u0026 chown 999:999 /var/lib/rabbitmq/.rabbitmqadmin.conf \u0026\u0026 chmod 600 /var/lib/rabbitmq/.rabbitmqadmin.conf"],"resources":{"limits":{"cpu":"100m","memory":"500Mi"},"requests":{"cpu":"100m","memory":"500Mi"}},"volumeMounts":[{"name":"plugins-conf","mountPath":"/tmp/rabbitmq-plugins/"},{"name":"rabbitmq-erlang-cookie","mountPath":"/var/lib/rabbitmq/"},{"name":"erlang-cookie-secret","mountPath":"/tmp/erlang-cookie-secret/"},{"name":"rabbitmq-plugins","mountPath":"/operator"},{"name":"persistence","mountPath":"/var/lib/rabbitmq/mnesia/"},{"name":"rabbitmq-confd","mountPath":"/tmp/default_user.conf","subPath":"default_user.conf"}],"terminationMessagePath":"/dev/termination-log","terminationMessagePolicy":"File","imagePullPolicy":"IfNotPresent","securityContext":{"capabilities":{"drop":["FSETID","KILL","SETGID","SETUID","SETPCAP","NET_BIND_SERVICE","NET_RAW","SYS_CHROOT","MKNOD","AUDIT_WRITE","SETFCAP"]},"runAsUser":0}}],"containers":[{"name":"rabbitmq","image":"rabbitmq:3.8.12-management","ports":[{"name":"epmd","containerPort":4369,"protocol":"TCP"},{"name":"amqp","containerPort":5672,"protocol":"TCP"},{"name":"management","containerPort":15672,"protocol":"TCP"},{"name":"prometheus","containerPort":15692,"protocol":"TCP"}],"env":[{"name":"MY_POD_NAME","valueFrom":{"fieldRef":{"apiVersion":"v1","fieldPath":"metadata.name"}}},{"name":"MY_POD_NAMESPACE","valueFrom":{"fieldRef":{"apiVersion":"v1","fieldPath":"metadata.namespace"}}},{"name":"RABBITMQ_ENABLED_PLUGINS_FILE","value":"/operator/enabled_plugins"},{"name":"K8S_SERVICE_NAME","value":"rabbitmq-cluster-nodes"},{"name":"RABBITMQ_USE_LONGNAME","value":"true"},{"name":"RABBITMQ_NODENAME","value":"rabbit@$(MY_POD_NAME).$(K8S_SERVICE_NAME).$(MY_POD_NAMESPACE)"},{"name":"K8S_HOSTNAME_SUFFIX","value":".$(K8S_SERVICE_NAME).$(MY_POD_NAMESPACE)"}],"resources":{"limits":{"cpu":"2","memory":"2Gi"},"requests":{"cpu":"1","memory":"2Gi"}},"volumeMounts":[{"name":"rabbitmq-erlang-cookie","mountPath":"/var/lib/rabbitmq/"},{"name":"persistence","mountPath":"/var/lib/rabbitmq/mnesia/"},{"name":"rabbitmq-plugins","mountPath":"/operator"},{"name":"rabbitmq-confd","mountPath":"/etc/rabbitmq/conf.d/10-operatorDefaults.conf","subPath":"operatorDefaults.conf"},{"name":"rabbitmq-confd","mountPath":"/etc/rabbitmq/conf.d/11-default_user.conf","subPath":"default_user.conf"},{"name":"rabbitmq-confd","mountPath":"/etc/rabbitmq/conf.d/90-userDefinedConfiguration.conf","subPath":"userDefinedConfiguration.conf"},{"name":"pod-info","mountPath":"/etc/pod-info/"}],"readinessProbe":{"tcpSocket":{"port":"amqp"},"initialDelaySeconds":10,"timeoutSeconds":5,"periodSeconds":10,"successThreshold":1,"failureThreshold":3},"lifecycle":{"preStop":{"exec":{"command":["/bin/bash","-c","if [ ! -z \"$(cat /etc/pod-info/skipPreStopChecks)\" ]; then exit 0; fi; rabbitmq-upgrade await_online_quorum_plus_one -t 604800; rabbitmq-upgrade await_online_synchronized_mirror -t 604800; rabbitmq-upgrade drain -t 604800"]}}},"terminationMessagePath":"/dev/termination-log","terminationMessagePolicy":"File","imagePullPolicy":"IfNotPresent"}],"restartPolicy":"Always","terminationGracePeriodSeconds":604800,"dnsPolicy":"ClusterFirst","serviceAccountName":"rabbitmq-cluster-server","serviceAccount":"rabbitmq-cluster-server","automountServiceAccountToken":true,"securityContext":{"runAsUser":999,"runAsGroup":999,"fsGroup":999},"schedulerName":"default-scheduler","topologySpreadConstraints":[{"maxSkew":1,"topologyKey":"topology.kubernetes.io/zone","whenUnsatisfiable":"ScheduleAnyway","labelSelector":{"matchLabels":{"app.kubernetes.io/name":"rabbitmq-cluster"}}}]}},"volumeClaimTemplates":[{"metadata":{"name":"persistence","namespace":"default","creationTimestamp":null,"labels":{"app.kubernetes.io/component":"rabbitmq","app.kubernetes.io/name":"rabbitmq-cluster","app.kubernetes.io/part-of":"rabbitmq"},"ownerReferences":[{"apiVersion":"rabbitmq.com/v1beta1","kind":"RabbitmqCluster","name":"rabbitmq-cluster","uid":"18d9928b-0d1c-47be-80ec-20960d053827","controller":true,"blockOwnerDeletion":false}]},"spec":{"accessModes":["ReadWriteOnce"],"resources":{"requests":{"storage":"10Gi"}},"volumeMode":"Filesystem"},"status":{"phase":"Pending"}}],"serviceName":"rabbitmq-cluster-nodes","podManagementPolicy":"Parallel","updateStrategy":{"type":"RollingUpdate","rollingUpdate":{"partition":0}},"revisionHistoryLimit":10},"status":{"observedGeneration":1,"replicas":1,"readyReplicas":1,"currentReplicas":1,"updatedReplicas":1,"currentRevision":"rabbitmq-cluster-server-5f8b8665fb","updateRevision":"rabbitmq-cluster-server-5f8b8665fb","collisionCount":0}}
2022/03/18 18:01:18 learn_server.go:291: [SIEVE-AFTER-READ]	Get	true	configmap	default	rabbitmq-cluster-server-conf	github.com/rabbitmq/cluster-operator/controllers.(*RabbitmqClusterReconciler)	NoError	{"kind":"ConfigMap","apiVersion":"v1","metadata":{"name":"rabbitmq-cluster-server-conf","namespace":"default","selfLink":"/api/v1/namespaces/default/configmaps/rabbitmq-cluster-server-conf","uid":"22474f2b-8454-44b7-8079-8990223969cc","resourceVersion":"714","creationTimestamp":"2022-03-18T18:00:38Z","labels":{"app.kubernetes.io/component":"rabbitmq","app.kubernetes.io/name":"rabbitmq-cluster","app.kubernetes.io/part-of":"rabbitmq"},"ownerReferences":[{"apiVersion":"rabbitmq.com/v1beta1","kind":"RabbitmqCluster","name":"rabbitmq-cluster","uid":"18d9928b-0d1c-47be-80ec-20960d053827","controller":true,"blockOwnerDeletion":true}],"managedFields":[{"manager":"manager","operation":"Update","apiVersion":"v1","time":"2022-03-18T18:00:38Z","fieldsType":"FieldsV1","fieldsV1":{"f:data":{".":{},"f:operatorDefaults.conf":{},"f:userDefinedConfiguration.conf":{}},"f:metadata":{"f:labels":{".":{},"f:app.kubernetes.io/component":{},"f:app.kubernetes.io/name":{},"f:app.kubernetes.io/part-of":{}},"f:ownerReferences":{".":{},"k:{\"uid\":\"18d9928b-0d1c-47be-80ec-20960d053827\"}":{".":{},"f:apiVersion":{},"f:blockOwnerDeletion":{},"f:controller":{},"f:kind":{},"f:name":{},"f:uid":{}}}}}}]},"data":{"operatorDefaults.conf":"cluster_formation.peer_discovery_backend             = rabbit_peer_discovery_k8s\ncluster_formation.k8s.host                           = kubernetes.default\ncluster_formation.k8s.address_type                   = hostname\ncluster_partition_handling                           = pause_minority\nqueue_master_locator                                 = min-masters\ndisk_free_limit.absolute                             = 2GB\ncluster_formation.randomized_startup_delay_range.min = 5\ncluster_formation.randomized_startup_delay_range.max = 30\ncluster_name                                         = rabbitmq-cluster\n","userDefinedConfiguration.conf":"total_memory_available_override_value = 1717986919\n"}}
2022/03/18 18:01:18 learn_server.go:256: [SIEVE-BEFORE-WRITE]	33
2022/03/18 18:01:18 learn_server.go:263: [SIEVE-AFTER-WRITE]	33	StatusUpdate	rabbitmqcluster	github.com/rabbitmq/cluster-operator/controllers.(*RabbitmqClusterReconciler)	NoError	{"metadata":{"name":"rabbitmq-cluster","namespace":"default","selfLink":"/apis/rabbitmq.com/v1beta1/namespaces/default/rabbitmqclusters/rabbitmq-cluster/status","uid":"18d9928b-0d1c-47be-80ec-20960d053827","resourceVersion":"949","generation":2,"creationTimestamp":"2022-03-18T18:00:38Z","annotations":{"kubectl.kubernetes.io/last-applied-configuration":"{\"apiVersion\":\"rabbitmq.com/v1beta1\",\"kind\":\"RabbitmqCluster\",\"metadata\":{\"annotations\":{},\"name\":\"rabbitmq-cluster\",\"namespace\":\"default\"},\"spec\":{\"persistence\":{\"storage\":\"10Gi\"},\"replicas\":1}}\n"},"finalizers":["deletion.finalizers.rabbitmqclusters.rabbitmq.com"],"managedFields":[{"manager":"kubectl-client-side-apply","operation":"Update","apiVersion":"rabbitmq.com/v1beta1","time":"2022-03-18T18:00:38Z","fieldsType":"FieldsV1","fieldsV1":{"f:metadata":{"f:annotations":{".":{},"f:kubectl.kubernetes.io/last-applied-configuration":{}}},"f:spec":{".":{},"f:image":{},"f:persistence":{".":{},"f:storage":{}},"f:replicas":{},"f:resources":{".":{},"f:limits":{".":{},"f:memory":{}},"f:requests":{".":{},"f:memory":{}}},"f:service":{".":{},"f:type":{}},"f:terminationGracePeriodSeconds":{}}}},{"manager":"manager","operation":"Update","apiVersion":"rabbitmq.com/v1beta1","time":"2022-03-18T18:01:18Z","fieldsType":"FieldsV1","fieldsV1":{"f:metadata":{"f:finalizers":{}},"f:spec":{"f:override":{},"f:rabbitmq":{},"f:resources":{"f:limits":{"f:cpu":{}},"f:requests":{"f:cpu":{}}},"f:tls":{}},"f:status":{".":{},"f:conditions":{},"f:defaultUser":{".":{},"f:secretReference":{".":{},"f:keys":{".":{},"f:password":{},"f:username":{}},"f:name":{},"f:namespace":{}},"f:serviceReference":{".":{},"f:name":{},"f:namespace":{}}}}}}]},"spec":{"replicas":1,"image":"rabbitmq:3.8.12-management","service":{"type":"ClusterIP"},"persistence":{"storage":"10Gi"},"resources":{"limits":{"cpu":"2","memory":"2Gi"},"requests":{"cpu":"1","memory":"2Gi"}},"rabbitmq":{},"tls":{},"override":{},"terminationGracePeriodSeconds":604800},"status":{"conditions":[{"type":"AllReplicasReady","status":"True","lastTransitionTime":"2022-03-18T18:01:17Z","reason":"AllPodsAreReady"},{"type":"ClusterAvailable","status":"True","lastTransitionTime":"2022-03-18T18:01:17Z","reason":"AtLeastOneEndpointAvailable"},{"type":"NoWarnings","status":"True","lastTransitionTime":"2022-03-18T18:00:38Z","reason":"NoWarnings"},{"type":"ReconcileSuccess","status":"True","lastTransitionTime":"2022-03-18T18:01:18Z","reason":"Success","message":"Finish reconciling"}],"defaultUser":{"secretReference":{"name":"rabbitmq-cluster-default-user","namespace":"default","keys":{"password":"password","username":"username"}},"serviceReference":{"name":"rabbitmq-cluster","namespace":"default"}},"binding":{"name":"rabbitmq-cluster-default-user"}}}
2022/03/18 18:01:18 learn_server.go:291: [SIEVE-AFTER-READ]	Get	true	statefulset	default	rabbitmq-cluster-server	github.com/rabbitmq/cluster-operator/controllers.(*RabbitmqClusterReconciler)	NoError	{"kind":"StatefulSet","apiVersion":"apps/v1","metadata":{"name":"rabbitmq-cluster-server","namespace":"default","selfLink":"/apis/apps/v1/namespaces/default/statefulsets/rabbitmq-cluster-server","uid":"cb5c43bc-6ee7-481c-ab01-6f3acffdd3c8","resourceVersion":"948","generation":1,"creationTimestamp":"2022-03-18T18:00:38Z","labels":{"app.kubernetes.io/component":"rabbitmq","app.kubernetes.io/name":"rabbitmq-cluster","app.kubernetes.io/part-of":"rabbitmq"},"ownerReferences":[{"apiVersion":"rabbitmq.com/v1beta1","kind":"RabbitmqCluster","name":"rabbitmq-cluster","uid":"18d9928b-0d1c-47be-80ec-20960d053827","controller":true,"blockOwnerDeletion":true}],"managedFields":[{"manager":"manager","operation":"Update","apiVersion":"apps/v1","time":"2022-03-18T18:00:38Z","fieldsType":"FieldsV1","fieldsV1":{"f:metadata":{"f:labels":{".":{},"f:app.kubernetes.io/component":{},"f:app.kubernetes.io/name":{},"f:app.kubernetes.io/part-of":{}},"f:ownerReferences":{".":{},"k:{\"uid\":\"18d9928b-0d1c-47be-80ec-20960d053827\"}":{".":{},"f:apiVersion":{},"f:blockOwnerDeletion":{},"f:controller":{},"f:kind":{},"f:name":{},"f:uid":{}}}},"f:spec":{"f:podManagementPolicy":{},"f:replicas":{},"f:revisionHistoryLimit":{},"f:selector":{"f:matchLabels":{".":{},"f:app.kubernetes.io/name":{}}},"f:serviceName":{},"f:template":{"f:metadata":{"f:annotations":{".":{},"f:prometheus.io/port":{},"f:prometheus.io/scrape":{}},"f:labels":{".":{},"f:app.kubernetes.io/component":{},"f:app.kubernetes.io/name":{},"f:app.kubernetes.io/part-of":{}}},"f:spec":{"f:automountServiceAccountToken":{},"f:containers":{"k:{\"name\":\"rabbitmq\"}":{".":{},"f:env":{".":{},"k:{\"name\":\"K8S_HOSTNAME_SUFFIX\"}":{".":{},"f:name":{},"f:value":{}},"k:{\"name\":\"K8S_SERVICE_NAME\"}":{".":{},"f:name":{},"f:value":{}},"k:{\"name\":\"MY_POD_NAME\"}":{".":{},"f:name":{},"f:valueFrom":{".":{},"f:fieldRef":{".":{},"f:apiVersion":{},"f:fieldPath":{}}}},"k:{\"name\":\"MY_POD_NAMESPACE\"}":{".":{},"f:name":{},"f:valueFrom":{".":{},"f:fieldRef":{".":{},"f:apiVersion":{},"f:fieldPath":{}}}},"k:{\"name\":\"RABBITMQ_ENABLED_PLUGINS_FILE\"}":{".":{},"f:name":{},"f:value":{}},"k:{\"name\":\"RABBITMQ_NODENAME\"}":{".":{},"f:name":{},"f:value":{}},"k:{\"name\":\"RABBITMQ_USE_LONGNAME\"}":{".":{},"f:name":{},"f:value":{}}},"f:image":{},"f:imagePullPolicy":{},"f:lifecycle":{".":{},"f:preStop":{".":{},"f:exec":{".":{},"f:command":{}}}},"f:name":{},"f:ports":{".":{},"k:{\"containerPort\":4369,\"protocol\":\"TCP\"}":{".":{},"f:containerPort":{},"f:name":{},"f:protocol":{}},"k:{\"containerPort\":5672,\"protocol\":\"TCP\"}":{".":{},"f:containerPort":{},"f:name":{},"f:protocol":{}},"k:{\"containerPort\":15672,\"protocol\":\"TCP\"}":{".":{},"f:containerPort":{},"f:name":{},"f:protocol":{}},"k:{\"containerPort\":15692,\"protocol\":\"TCP\"}":{".":{},"f:containerPort":{},"f:name":{},"f:protocol":{}}},"f:readinessProbe":{".":{},"f:failureThreshold":{},"f:initialDelaySeconds":{},"f:periodSeconds":{},"f:successThreshold":{},"f:tcpSocket":{".":{},"f:port":{}},"f:timeoutSeconds":{}},"f:resources":{".":{},"f:limits":{".":{},"f:cpu":{},"f:memory":{}},"f:requests":{".":{},"f:cpu":{},"f:memory":{}}},"f:terminationMessagePath":{},"f:terminationMessagePolicy":{},"f:volumeMounts":{".":{},"k:{\"mountPath\":\"/etc/pod-info/\"}":{".":{},"f:mountPath":{},"f:name":{}},"k:{\"mountPath\":\"/etc/rabbitmq/conf.d/10-operatorDefaults.conf\"}":{".":{},"f:mountPath":{},"f:name":{},"f:subPath":{}},"k:{\"mountPath\":\"/etc/rabbitmq/conf.d/11-default_user.conf\"}":{".":{},"f:mountPath":{},"f:name":{},"f:subPath":{}},"k:{\"mountPath\":\"/etc/rabbitmq/conf.d/90-userDefinedConfiguration.conf\"}":{".":{},"f:mountPath":{},"f:name":{},"f:subPath":{}},"k:{\"mountPath\":\"/operator\"}":{".":{},"f:mountPath":{},"f:name":{}},"k:{\"mountPath\":\"/var/lib/rabbitmq/\"}":{".":{},"f:mountPath":{},"f:name":{}},"k:{\"mountPath\":\"/var/lib/rabbitmq/mnesia/\"}":{".":{},"f:mountPath":{},"f:name":{}}}}},"f:dnsPolicy":{},"f:initContainers":{".":{},"k:{\"name\":\"setup-container\"}":{".":{},"f:command":{},"f:image":{},"f:imagePullPolicy":{},"f:name":{},"f:resources":{".":{},"f:limits":{".":{},"f:cpu":{},"f:memory":{}},"f:requests":{".":{},"f:cpu":{},"f:memory":{}}},"f:securityContext":{".":{},"f:capabilities":{".":{},"f:drop":{}},"f:runAsUser":{}},"f:terminationMessagePath":{},"f:terminationMessagePolicy":{},"f:volumeMounts":{".":{},"k:{\"mountPath\":\"/operator\"}":{".":{},"f:mountPath":{},"f:name":{}},"k:{\"mountPath\":\"/tmp/default_user.conf\"}":{".":{},"f:mountPath":{},"f:name":{},"f:subPath":{}},"k:{\"mountPath\":\"/tmp/erlang-cookie-secret/\"}":{".":{},"f:mountPath":{},"f:name":{}},"k:{\"mountPath\":\"/tmp/rabbitmq-plugins/\"}":{".":{},"f:mountPath":{},"f:name":{}},"k:{\"mountPath\":\"/var/lib/rabbitmq/\"}":{".":{},"f:mountPath":{},"f:name":{}},"k:{\"mountPath\":\"/var/lib/rabbitmq/mnesia/\"}":{".":{},"f:mountPath":{},"f:name":{}}}}},"f:restartPolicy":{},"f:schedulerName":{},"f:securityContext":{".":{},"f:fsGroup":{},"f:runAsGroup":{},"f:runAsUser":{}},"f:serviceAccount":{},"f:serviceAccountName":{},"f:terminationGracePeriodSeconds":{},"f:topologySpreadConstraints":{".":{},"k:{\"topologyKey\":\"topology.kubernetes.io/zone\",\"whenUnsatisfiable\":\"ScheduleAnyway\"}":{".":{},"f:labelSelector":{".":{},"f:matchLabels":{".":{},"f:app.kubernetes.io/name":{}}},"f:maxSkew":{},"f:topologyKey":{},"f:whenUnsatisfiable":{}}},"f:volumes":{".":{},"k:{\"name\":\"erlang-cookie-secret\"}":{".":{},"f:name":{},"f:secret":{".":{},"f:defaultMode":{},"f:secretName":{}}},"k:{\"name\":\"plugins-conf\"}":{".":{},"f:configMap":{".":{},"f:defaultMode":{},"f:name":{}},"f:name":{}},"k:{\"name\":\"pod-info\"}":{".":{},"f:downwardAPI":{".":{},"f:defaultMode":{},"f:items":{}},"f:name":{}},"k:{\"name\":\"rabbitmq-confd\"}":{".":{},"f:name":{},"f:projected":{".":{},"f:defaultMode":{},"f:sources":{}}},"k:{\"name\":\"rabbitmq-erlang-cookie\"}":{".":{},"f:emptyDir":{},"f:name":{}},"k:{\"name\":\"rabbitmq-plugins\"}":{".":{},"f:emptyDir":{},"f:name":{}}}}},"f:updateStrategy":{"f:rollingUpdate":{".":{},"f:partition":{}},"f:type":{}},"f:volumeClaimTemplates":{}}}},{"manager":"kube-controller-manager","operation":"Update","apiVersion":"apps/v1","time":"2022-03-18T18:01:17Z","fieldsType":"FieldsV1","fieldsV1":{"f:status":{"f:collisionCount":{},"f:currentReplicas":{},"f:currentRevision":{},"f:observedGeneration":{},"f:readyReplicas":{},"f:replicas":{},"f:updateRevision":{},"f:updatedReplicas":{}}}}]},"spec":{"replicas":1,"selector":{"matchLabels":{"app.kubernetes.io/name":"rabbitmq-cluster"}},"template":{"metadata":{"creationTimestamp":null,"labels":{"app.kubernetes.io/component":"rabbitmq","app.kubernetes.io/name":"rabbitmq-cluster","app.kubernetes.io/part-of":"rabbitmq"},"annotations":{"prometheus.io/port":"15692","prometheus.io/scrape":"true"}},"spec":{"volumes":[{"name":"plugins-conf","configMap":{"name":"rabbitmq-cluster-plugins-conf","defaultMode":420}},{"name":"rabbitmq-confd","projected":{"sources":[{"secret":{"name":"rabbitmq-cluster-default-user","items":[{"key":"default_user.conf","path":"default_user.conf"}]}},{"configMap":{"name":"rabbitmq-cluster-server-conf","items":[{"key":"operatorDefaults.conf","path":"operatorDefaults.conf"},{"key":"userDefinedConfiguration.conf","path":"userDefinedConfiguration.conf"}]}}],"defaultMode":420}},{"name":"rabbitmq-erlang-cookie","emptyDir":{}},{"name":"erlang-cookie-secret","secret":{"secretName":"rabbitmq-cluster-erlang-cookie","defaultMode":420}},{"name":"rabbitmq-plugins","emptyDir":{}},{"name":"pod-info","downwardAPI":{"items":[{"path":"skipPreStopChecks","fieldRef":{"apiVersion":"v1","fieldPath":"metadata.labels['skipPreStopChecks']"}}],"defaultMode":420}}],"initContainers":[{"name":"setup-container","image":"rabbitmq:3.8.12-management","command":["sh","-c","cp /tmp/erlang-cookie-secret/.erlang.cookie /var/lib/rabbitmq/.erlang.cookie \u0026\u0026 chown 999:999 /var/lib/rabbitmq/.erlang.cookie \u0026\u0026 chmod 600 /var/lib/rabbitmq/.erlang.cookie ; cp /tmp/rabbitmq-plugins/enabled_plugins /operator/enabled_plugins \u0026\u0026 chown 999:999 /operator/enabled_plugins ; chown 999:999 /var/lib/rabbitmq/mnesia/ ; echo '[default]' \u003e /var/lib/rabbitmq/.rabbitmqadmin.conf \u0026\u0026 sed -e 's/default_user/username/' -e 's/default_pass/password/' /tmp/default_user.conf \u003e\u003e /var/lib/rabbitmq/.rabbitmqadmin.conf \u0026\u0026 chown 999:999 /var/lib/rabbitmq/.rabbitmqadmin.conf \u0026\u0026 chmod 600 /var/lib/rabbitmq/.rabbitmqadmin.conf"],"resources":{"limits":{"cpu":"100m","memory":"500Mi"},"requests":{"cpu":"100m","memory":"500Mi"}},"volumeMounts":[{"name":"plugins-conf","mountPath":"/tmp/rabbitmq-plugins/"},{"name":"rabbitmq-erlang-cookie","mountPath":"/var/lib/rabbitmq/"},{"name":"erlang-cookie-secret","mountPath":"/tmp/erlang-cookie-secret/"},{"name":"rabbitmq-plugins","mountPath":"/operator"},{"name":"persistence","mountPath":"/var/lib/rabbitmq/mnesia/"},{"name":"rabbitmq-confd","mountPath":"/tmp/default_user.conf","subPath":"default_user.conf"}],"terminationMessagePath":"/dev/termination-log","terminationMessagePolicy":"File","imagePullPolicy":"IfNotPresent","securityContext":{"capabilities":{"drop":["FSETID","KILL","SETGID","SETUID","SETPCAP","NET_BIND_SERVICE","NET_RAW","SYS_CHROOT","MKNOD","AUDIT_WRITE","SETFCAP"]},"runAsUser":0}}],"containers":[{"name":"rabbitmq","image":"rabbitmq:3.8.12-management","ports":[{"name":"epmd","containerPort":4369,"protocol":"TCP"},{"name":"amqp","containerPort":5672,"protocol":"TCP"},{"name":"management","containerPort":15672,"protocol":"TCP"},{"name":"prometheus","containerPort":15692,"protocol":"TCP"}],"env":[{"name":"MY_POD_NAME","valueFrom":{"fieldRef":{"apiVersion":"v1","fieldPath":"metadata.name"}}},{"name":"MY_POD_NAMESPACE","valueFrom":{"fieldRef":{"apiVersion":"v1","fieldPath":"metadata.namespace"}}},{"name":"RABBITMQ_ENABLED_PLUGINS_FILE","value":"/operator/enabled_plugins"},{"name":"K8S_SERVICE_NAME","value":"rabbitmq-cluster-nodes"},{"name":"RABBITMQ_USE_LONGNAME","value":"true"},{"name":"RABBITMQ_NODENAME","value":"rabbit@$(MY_POD_NAME).$(K8S_SERVICE_NAME).$(MY_POD_NAMESPACE)"},{"name":"K8S_HOSTNAME_SUFFIX","value":".$(K8S_SERVICE_NAME).$(MY_POD_NAMESPACE)"}],"resources":{"limits":{"cpu":"2","memory":"2Gi"},"requests":{"cpu":"1","memory":"2Gi"}},"volumeMounts":[{"name":"rabbitmq-erlang-cookie","mountPath":"/var/lib/rabbitmq/"},{"name":"persistence","mountPath":"/var/lib/rabbitmq/mnesia/"},{"name":"rabbitmq-plugins","mountPath":"/operator"},{"name":"rabbitmq-confd","mountPath":"/etc/rabbitmq/conf.d/10-operatorDefaults.conf","subPath":"operatorDefaults.conf"},{"name":"rabbitmq-confd","mountPath":"/etc/rabbitmq/conf.d/11-default_user.conf","subPath":"default_user.conf"},{"name":"rabbitmq-confd","mountPath":"/etc/rabbitmq/conf.d/90-userDefinedConfiguration.conf","subPath":"userDefinedConfiguration.conf"},{"name":"pod-info","mountPath":"/etc/pod-info/"}],"readinessProbe":{"tcpSocket":{"port":"amqp"},"initialDelaySeconds":10,"timeoutSeconds":5,"periodSeconds":10,"successThreshold":1,"failureThreshold":3},"lifecycle":{"preStop":{"exec":{"command":["/bin/bash","-c","if [ ! -z \"$(cat /etc/pod-info/skipPreStopChecks)\" ]; then exit 0; fi; rabbitmq-upgrade await_online_quorum_plus_one -t 604800; rabbitmq-upgrade await_online_synchronized_mirror -t 604800; rabbitmq-upgrade drain -t 604800"]}}},"terminationMessagePath":"/dev/termination-log","terminationMessagePolicy":"File","imagePullPolicy":"IfNotPresent"}],"restartPolicy":"Always","terminationGracePeriodSeconds":604800,"dnsPolicy":"ClusterFirst","serviceAccountName":"rabbitmq-cluster-server","serviceAccount":"rabbitmq-cluster-server","automountServiceAccountToken":true,"securityContext":{"runAsUser":999,"runAsGroup":999,"fsGroup":999},"schedulerName":"default-scheduler","topologySpreadConstraints":[{"maxSkew":1,"topologyKey":"topology.kubernetes.io/zone","whenUnsatisfiable":"ScheduleAnyway","labelSelector":{"matchLabels":{"app.kubernetes.io/name":"rabbitmq-cluster"}}}]}},"volumeClaimTemplates":[{"metadata":{"name":"persistence","namespace":"default","creationTimestamp":null,"labels":{"app.kubernetes.io/component":"rabbitmq","app.kubernetes.io/name":"rabbitmq-cluster","app.kubernetes.io/part-of":"rabbitmq"},"ownerReferences":[{"apiVersion":"rabbitmq.com/v1beta1","kind":"RabbitmqCluster","name":"rabbitmq-cluster","uid":"18d9928b-0d1c-47be-80ec-20960d053827","controller":true,"blockOwnerDeletion":false}]},"spec":{"accessModes":["ReadWriteOnce"],"resources":{"requests":{"storage":"10Gi"}},"volumeMode":"Filesystem"},"status":{"phase":"Pending"}}],"serviceName":"rabbitmq-cluster-nodes","podManagementPolicy":"Parallel","updateStrategy":{"type":"RollingUpdate","rollingUpdate":{"partition":0}},"revisionHistoryLimit":10},"status":{"observedGeneration":1,"replicas":1,"readyReplicas":1,"currentReplicas":1,"updatedReplicas":1,"currentRevision":"rabbitmq-cluster-server-5f8b8665fb","updateRevision":"rabbitmq-cluster-server-5f8b8665fb","collisionCount":0}}
2022/03/18 18:01:18 learn_server.go:291: [SIEVE-AFTER-READ]	Get	true	configmap	default	rabbitmq-cluster-plugins-conf	github.com/rabbitmq/cluster-operator/controllers.(*RabbitmqClusterReconciler)	NoError	{"kind":"ConfigMap","apiVersion":"v1","metadata":{"name":"rabbitmq-cluster-plugins-conf","namespace":"default","selfLink":"/api/v1/namespaces/default/configmaps/rabbitmq-cluster-plugins-conf","uid":"a164075b-0562-47ac-a577-99aa8651ec40","resourceVersion":"709","creationTimestamp":"2022-03-18T18:00:38Z","labels":{"app.kubernetes.io/component":"rabbitmq","app.kubernetes.io/name":"rabbitmq-cluster","app.kubernetes.io/part-of":"rabbitmq"},"ownerReferences":[{"apiVersion":"rabbitmq.com/v1beta1","kind":"RabbitmqCluster","name":"rabbitmq-cluster","uid":"18d9928b-0d1c-47be-80ec-20960d053827","controller":true,"blockOwnerDeletion":true}],"managedFields":[{"manager":"manager","operation":"Update","apiVersion":"v1","time":"2022-03-18T18:00:38Z","fieldsType":"FieldsV1","fieldsV1":{"f:data":{".":{},"f:enabled_plugins":{}},"f:metadata":{"f:labels":{".":{},"f:app.kubernetes.io/component":{},"f:app.kubernetes.io/name":{},"f:app.kubernetes.io/part-of":{}},"f:ownerReferences":{".":{},"k:{\"uid\":\"18d9928b-0d1c-47be-80ec-20960d053827\"}":{".":{},"f:apiVersion":{},"f:blockOwnerDeletion":{},"f:controller":{},"f:kind":{},"f:name":{},"f:uid":{}}}}}}]},"data":{"enabled_plugins":"[rabbitmq_peer_discovery_k8s,rabbitmq_prometheus,rabbitmq_management]."}}
2022/03/18 18:01:18 learn_server.go:256: [SIEVE-BEFORE-WRITE]	34
2022/03/18 18:01:18 learn_server.go:263: [SIEVE-AFTER-WRITE]	34	StatusUpdate	rabbitmqcluster	github.com/rabbitmq/cluster-operator/controllers.(*RabbitmqClusterReconciler)	NoError	{"metadata":{"name":"rabbitmq-cluster","namespace":"default","selfLink":"/apis/rabbitmq.com/v1beta1/namespaces/default/rabbitmqclusters/rabbitmq-cluster/status","uid":"18d9928b-0d1c-47be-80ec-20960d053827","resourceVersion":"949","generation":2,"creationTimestamp":"2022-03-18T18:00:38Z","annotations":{"kubectl.kubernetes.io/last-applied-configuration":"{\"apiVersion\":\"rabbitmq.com/v1beta1\",\"kind\":\"RabbitmqCluster\",\"metadata\":{\"annotations\":{},\"name\":\"rabbitmq-cluster\",\"namespace\":\"default\"},\"spec\":{\"persistence\":{\"storage\":\"10Gi\"},\"replicas\":1}}\n"},"finalizers":["deletion.finalizers.rabbitmqclusters.rabbitmq.com"],"managedFields":[{"manager":"kubectl-client-side-apply","operation":"Update","apiVersion":"rabbitmq.com/v1beta1","time":"2022-03-18T18:00:38Z","fieldsType":"FieldsV1","fieldsV1":{"f:metadata":{"f:annotations":{".":{},"f:kubectl.kubernetes.io/last-applied-configuration":{}}},"f:spec":{".":{},"f:image":{},"f:persistence":{".":{},"f:storage":{}},"f:replicas":{},"f:resources":{".":{},"f:limits":{".":{},"f:memory":{}},"f:requests":{".":{},"f:memory":{}}},"f:service":{".":{},"f:type":{}},"f:terminationGracePeriodSeconds":{}}}},{"manager":"manager","operation":"Update","apiVersion":"rabbitmq.com/v1beta1","time":"2022-03-18T18:01:18Z","fieldsType":"FieldsV1","fieldsV1":{"f:metadata":{"f:finalizers":{}},"f:spec":{"f:override":{},"f:rabbitmq":{},"f:resources":{"f:limits":{"f:cpu":{}},"f:requests":{"f:cpu":{}}},"f:tls":{}},"f:status":{".":{},"f:conditions":{},"f:defaultUser":{".":{},"f:secretReference":{".":{},"f:keys":{".":{},"f:password":{},"f:username":{}},"f:name":{},"f:namespace":{}},"f:serviceReference":{".":{},"f:name":{},"f:namespace":{}}}}}}]},"spec":{"replicas":1,"image":"rabbitmq:3.8.12-management","service":{"type":"ClusterIP"},"persistence":{"storage":"10Gi"},"resources":{"limits":{"cpu":"2","memory":"2Gi"},"requests":{"cpu":"1","memory":"2Gi"}},"rabbitmq":{},"tls":{},"override":{},"terminationGracePeriodSeconds":604800},"status":{"conditions":[{"type":"AllReplicasReady","status":"True","lastTransitionTime":"2022-03-18T18:01:17Z","reason":"AllPodsAreReady"},{"type":"ClusterAvailable","status":"True","lastTransitionTime":"2022-03-18T18:01:17Z","reason":"AtLeastOneEndpointAvailable"},{"type":"NoWarnings","status":"True","lastTransitionTime":"2022-03-18T18:00:38Z","reason":"NoWarnings"},{"type":"ReconcileSuccess","status":"True","lastTransitionTime":"2022-03-18T18:01:18Z","reason":"Success","message":"Finish reconciling"}],"defaultUser":{"secretReference":{"name":"rabbitmq-cluster-default-user","namespace":"default","keys":{"password":"password","username":"username"}},"serviceReference":{"name":"rabbitmq-cluster","namespace":"default"}},"binding":{"name":"rabbitmq-cluster-default-user"}}}
2022/03/18 18:01:18 learn_server.go:253: [SIEVE-AFTER-RECONCILE]	github.com/rabbitmq/cluster-operator/controllers.(*RabbitmqClusterReconciler)	7
2022/03/18 18:01:18 learn_server.go:238: [SIEVE-BEFORE-RECONCILE]	github.com/rabbitmq/cluster-operator/controllers.(*RabbitmqClusterReconciler)	8
2022/03/18 18:01:18 learn_server.go:291: [SIEVE-AFTER-READ]	Get	true	rabbitmqcluster	default	rabbitmq-cluster	github.com/rabbitmq/cluster-operator/controllers.(*RabbitmqClusterReconciler)	NoError	{"kind":"RabbitmqCluster","apiVersion":"rabbitmq.com/v1beta1","metadata":{"name":"rabbitmq-cluster","namespace":"default","selfLink":"/apis/rabbitmq.com/v1beta1/namespaces/default/rabbitmqclusters/rabbitmq-cluster","uid":"18d9928b-0d1c-47be-80ec-20960d053827","resourceVersion":"949","generation":2,"creationTimestamp":"2022-03-18T18:00:38Z","annotations":{"kubectl.kubernetes.io/last-applied-configuration":"{\"apiVersion\":\"rabbitmq.com/v1beta1\",\"kind\":\"RabbitmqCluster\",\"metadata\":{\"annotations\":{},\"name\":\"rabbitmq-cluster\",\"namespace\":\"default\"},\"spec\":{\"persistence\":{\"storage\":\"10Gi\"},\"replicas\":1}}\n"},"finalizers":["deletion.finalizers.rabbitmqclusters.rabbitmq.com"],"managedFields":[{"manager":"kubectl-client-side-apply","operation":"Update","apiVersion":"rabbitmq.com/v1beta1","time":"2022-03-18T18:00:38Z","fieldsType":"FieldsV1","fieldsV1":{"f:metadata":{"f:annotations":{".":{},"f:kubectl.kubernetes.io/last-applied-configuration":{}}},"f:spec":{".":{},"f:image":{},"f:persistence":{".":{},"f:storage":{}},"f:replicas":{},"f:resources":{".":{},"f:limits":{".":{},"f:memory":{}},"f:requests":{".":{},"f:memory":{}}},"f:service":{".":{},"f:type":{}},"f:terminationGracePeriodSeconds":{}}}},{"manager":"manager","operation":"Update","apiVersion":"rabbitmq.com/v1beta1","time":"2022-03-18T18:01:18Z","fieldsType":"FieldsV1","fieldsV1":{"f:metadata":{"f:finalizers":{}},"f:spec":{"f:override":{},"f:rabbitmq":{},"f:resources":{"f:limits":{"f:cpu":{}},"f:requests":{"f:cpu":{}}},"f:tls":{}},"f:status":{".":{},"f:conditions":{},"f:defaultUser":{".":{},"f:secretReference":{".":{},"f:keys":{".":{},"f:password":{},"f:username":{}},"f:name":{},"f:namespace":{}},"f:serviceReference":{".":{},"f:name":{},"f:namespace":{}}}}}}]},"spec":{"replicas":1,"image":"rabbitmq:3.8.12-management","service":{"type":"ClusterIP"},"persistence":{"storage":"10Gi"},"resources":{"limits":{"cpu":"2","memory":"2Gi"},"requests":{"cpu":"1","memory":"2Gi"}},"rabbitmq":{},"tls":{},"override":{},"terminationGracePeriodSeconds":604800},"status":{"conditions":[{"type":"AllReplicasReady","status":"True","lastTransitionTime":"2022-03-18T18:01:17Z","reason":"AllPodsAreReady"},{"type":"ClusterAvailable","status":"True","lastTransitionTime":"2022-03-18T18:01:17Z","reason":"AtLeastOneEndpointAvailable"},{"type":"NoWarnings","status":"True","lastTransitionTime":"2022-03-18T18:00:38Z","reason":"NoWarnings"},{"type":"ReconcileSuccess","status":"True","lastTransitionTime":"2022-03-18T18:01:18Z","reason":"Success","message":"Finish reconciling"}],"defaultUser":{"secretReference":{"name":"rabbitmq-cluster-default-user","namespace":"default","keys":{"password":"password","username":"username"}},"serviceReference":{"name":"rabbitmq-cluster","namespace":"default"}}}}
2022/03/18 18:01:18 learn_server.go:291: [SIEVE-AFTER-READ]	Get	true	statefulset	default	rabbitmq-cluster-server	github.com/rabbitmq/cluster-operator/controllers.(*RabbitmqClusterReconciler)	NoError	{"kind":"StatefulSet","apiVersion":"apps/v1","metadata":{"name":"rabbitmq-cluster-server","namespace":"default","selfLink":"/apis/apps/v1/namespaces/default/statefulsets/rabbitmq-cluster-server","uid":"cb5c43bc-6ee7-481c-ab01-6f3acffdd3c8","resourceVersion":"948","generation":1,"creationTimestamp":"2022-03-18T18:00:38Z","labels":{"app.kubernetes.io/component":"rabbitmq","app.kubernetes.io/name":"rabbitmq-cluster","app.kubernetes.io/part-of":"rabbitmq"},"ownerReferences":[{"apiVersion":"rabbitmq.com/v1beta1","kind":"RabbitmqCluster","name":"rabbitmq-cluster","uid":"18d9928b-0d1c-47be-80ec-20960d053827","controller":true,"blockOwnerDeletion":true}],"managedFields":[{"manager":"manager","operation":"Update","apiVersion":"apps/v1","time":"2022-03-18T18:00:38Z","fieldsType":"FieldsV1","fieldsV1":{"f:metadata":{"f:labels":{".":{},"f:app.kubernetes.io/component":{},"f:app.kubernetes.io/name":{},"f:app.kubernetes.io/part-of":{}},"f:ownerReferences":{".":{},"k:{\"uid\":\"18d9928b-0d1c-47be-80ec-20960d053827\"}":{".":{},"f:apiVersion":{},"f:blockOwnerDeletion":{},"f:controller":{},"f:kind":{},"f:name":{},"f:uid":{}}}},"f:spec":{"f:podManagementPolicy":{},"f:replicas":{},"f:revisionHistoryLimit":{},"f:selector":{"f:matchLabels":{".":{},"f:app.kubernetes.io/name":{}}},"f:serviceName":{},"f:template":{"f:metadata":{"f:annotations":{".":{},"f:prometheus.io/port":{},"f:prometheus.io/scrape":{}},"f:labels":{".":{},"f:app.kubernetes.io/component":{},"f:app.kubernetes.io/name":{},"f:app.kubernetes.io/part-of":{}}},"f:spec":{"f:automountServiceAccountToken":{},"f:containers":{"k:{\"name\":\"rabbitmq\"}":{".":{},"f:env":{".":{},"k:{\"name\":\"K8S_HOSTNAME_SUFFIX\"}":{".":{},"f:name":{},"f:value":{}},"k:{\"name\":\"K8S_SERVICE_NAME\"}":{".":{},"f:name":{},"f:value":{}},"k:{\"name\":\"MY_POD_NAME\"}":{".":{},"f:name":{},"f:valueFrom":{".":{},"f:fieldRef":{".":{},"f:apiVersion":{},"f:fieldPath":{}}}},"k:{\"name\":\"MY_POD_NAMESPACE\"}":{".":{},"f:name":{},"f:valueFrom":{".":{},"f:fieldRef":{".":{},"f:apiVersion":{},"f:fieldPath":{}}}},"k:{\"name\":\"RABBITMQ_ENABLED_PLUGINS_FILE\"}":{".":{},"f:name":{},"f:value":{}},"k:{\"name\":\"RABBITMQ_NODENAME\"}":{".":{},"f:name":{},"f:value":{}},"k:{\"name\":\"RABBITMQ_USE_LONGNAME\"}":{".":{},"f:name":{},"f:value":{}}},"f:image":{},"f:imagePullPolicy":{},"f:lifecycle":{".":{},"f:preStop":{".":{},"f:exec":{".":{},"f:command":{}}}},"f:name":{},"f:ports":{".":{},"k:{\"containerPort\":4369,\"protocol\":\"TCP\"}":{".":{},"f:containerPort":{},"f:name":{},"f:protocol":{}},"k:{\"containerPort\":5672,\"protocol\":\"TCP\"}":{".":{},"f:containerPort":{},"f:name":{},"f:protocol":{}},"k:{\"containerPort\":15672,\"protocol\":\"TCP\"}":{".":{},"f:containerPort":{},"f:name":{},"f:protocol":{}},"k:{\"containerPort\":15692,\"protocol\":\"TCP\"}":{".":{},"f:containerPort":{},"f:name":{},"f:protocol":{}}},"f:readinessProbe":{".":{},"f:failureThreshold":{},"f:initialDelaySeconds":{},"f:periodSeconds":{},"f:successThreshold":{},"f:tcpSocket":{".":{},"f:port":{}},"f:timeoutSeconds":{}},"f:resources":{".":{},"f:limits":{".":{},"f:cpu":{},"f:memory":{}},"f:requests":{".":{},"f:cpu":{},"f:memory":{}}},"f:terminationMessagePath":{},"f:terminationMessagePolicy":{},"f:volumeMounts":{".":{},"k:{\"mountPath\":\"/etc/pod-info/\"}":{".":{},"f:mountPath":{},"f:name":{}},"k:{\"mountPath\":\"/etc/rabbitmq/conf.d/10-operatorDefaults.conf\"}":{".":{},"f:mountPath":{},"f:name":{},"f:subPath":{}},"k:{\"mountPath\":\"/etc/rabbitmq/conf.d/11-default_user.conf\"}":{".":{},"f:mountPath":{},"f:name":{},"f:subPath":{}},"k:{\"mountPath\":\"/etc/rabbitmq/conf.d/90-userDefinedConfiguration.conf\"}":{".":{},"f:mountPath":{},"f:name":{},"f:subPath":{}},"k:{\"mountPath\":\"/operator\"}":{".":{},"f:mountPath":{},"f:name":{}},"k:{\"mountPath\":\"/var/lib/rabbitmq/\"}":{".":{},"f:mountPath":{},"f:name":{}},"k:{\"mountPath\":\"/var/lib/rabbitmq/mnesia/\"}":{".":{},"f:mountPath":{},"f:name":{}}}}},"f:dnsPolicy":{},"f:initContainers":{".":{},"k:{\"name\":\"setup-container\"}":{".":{},"f:command":{},"f:image":{},"f:imagePullPolicy":{},"f:name":{},"f:resources":{".":{},"f:limits":{".":{},"f:cpu":{},"f:memory":{}},"f:requests":{".":{},"f:cpu":{},"f:memory":{}}},"f:securityContext":{".":{},"f:capabilities":{".":{},"f:drop":{}},"f:runAsUser":{}},"f:terminationMessagePath":{},"f:terminationMessagePolicy":{},"f:volumeMounts":{".":{},"k:{\"mountPath\":\"/operator\"}":{".":{},"f:mountPath":{},"f:name":{}},"k:{\"mountPath\":\"/tmp/default_user.conf\"}":{".":{},"f:mountPath":{},"f:name":{},"f:subPath":{}},"k:{\"mountPath\":\"/tmp/erlang-cookie-secret/\"}":{".":{},"f:mountPath":{},"f:name":{}},"k:{\"mountPath\":\"/tmp/rabbitmq-plugins/\"}":{".":{},"f:mountPath":{},"f:name":{}},"k:{\"mountPath\":\"/var/lib/rabbitmq/\"}":{".":{},"f:mountPath":{},"f:name":{}},"k:{\"mountPath\":\"/var/lib/rabbitmq/mnesia/\"}":{".":{},"f:mountPath":{},"f:name":{}}}}},"f:restartPolicy":{},"f:schedulerName":{},"f:securityContext":{".":{},"f:fsGroup":{},"f:runAsGroup":{},"f:runAsUser":{}},"f:serviceAccount":{},"f:serviceAccountName":{},"f:terminationGracePeriodSeconds":{},"f:topologySpreadConstraints":{".":{},"k:{\"topologyKey\":\"topology.kubernetes.io/zone\",\"whenUnsatisfiable\":\"ScheduleAnyway\"}":{".":{},"f:labelSelector":{".":{},"f:matchLabels":{".":{},"f:app.kubernetes.io/name":{}}},"f:maxSkew":{},"f:topologyKey":{},"f:whenUnsatisfiable":{}}},"f:volumes":{".":{},"k:{\"name\":\"erlang-cookie-secret\"}":{".":{},"f:name":{},"f:secret":{".":{},"f:defaultMode":{},"f:secretName":{}}},"k:{\"name\":\"plugins-conf\"}":{".":{},"f:configMap":{".":{},"f:defaultMode":{},"f:name":{}},"f:name":{}},"k:{\"name\":\"pod-info\"}":{".":{},"f:downwardAPI":{".":{},"f:defaultMode":{},"f:items":{}},"f:name":{}},"k:{\"name\":\"rabbitmq-confd\"}":{".":{},"f:name":{},"f:projected":{".":{},"f:defaultMode":{},"f:sources":{}}},"k:{\"name\":\"rabbitmq-erlang-cookie\"}":{".":{},"f:emptyDir":{},"f:name":{}},"k:{\"name\":\"rabbitmq-plugins\"}":{".":{},"f:emptyDir":{},"f:name":{}}}}},"f:updateStrategy":{"f:rollingUpdate":{".":{},"f:partition":{}},"f:type":{}},"f:volumeClaimTemplates":{}}}},{"manager":"kube-controller-manager","operation":"Update","apiVersion":"apps/v1","time":"2022-03-18T18:01:17Z","fieldsType":"FieldsV1","fieldsV1":{"f:status":{"f:collisionCount":{},"f:currentReplicas":{},"f:currentRevision":{},"f:observedGeneration":{},"f:readyReplicas":{},"f:replicas":{},"f:updateRevision":{},"f:updatedReplicas":{}}}}]},"spec":{"replicas":1,"selector":{"matchLabels":{"app.kubernetes.io/name":"rabbitmq-cluster"}},"template":{"metadata":{"creationTimestamp":null,"labels":{"app.kubernetes.io/component":"rabbitmq","app.kubernetes.io/name":"rabbitmq-cluster","app.kubernetes.io/part-of":"rabbitmq"},"annotations":{"prometheus.io/port":"15692","prometheus.io/scrape":"true"}},"spec":{"volumes":[{"name":"plugins-conf","configMap":{"name":"rabbitmq-cluster-plugins-conf","defaultMode":420}},{"name":"rabbitmq-confd","projected":{"sources":[{"secret":{"name":"rabbitmq-cluster-default-user","items":[{"key":"default_user.conf","path":"default_user.conf"}]}},{"configMap":{"name":"rabbitmq-cluster-server-conf","items":[{"key":"operatorDefaults.conf","path":"operatorDefaults.conf"},{"key":"userDefinedConfiguration.conf","path":"userDefinedConfiguration.conf"}]}}],"defaultMode":420}},{"name":"rabbitmq-erlang-cookie","emptyDir":{}},{"name":"erlang-cookie-secret","secret":{"secretName":"rabbitmq-cluster-erlang-cookie","defaultMode":420}},{"name":"rabbitmq-plugins","emptyDir":{}},{"name":"pod-info","downwardAPI":{"items":[{"path":"skipPreStopChecks","fieldRef":{"apiVersion":"v1","fieldPath":"metadata.labels['skipPreStopChecks']"}}],"defaultMode":420}}],"initContainers":[{"name":"setup-container","image":"rabbitmq:3.8.12-management","command":["sh","-c","cp /tmp/erlang-cookie-secret/.erlang.cookie /var/lib/rabbitmq/.erlang.cookie \u0026\u0026 chown 999:999 /var/lib/rabbitmq/.erlang.cookie \u0026\u0026 chmod 600 /var/lib/rabbitmq/.erlang.cookie ; cp /tmp/rabbitmq-plugins/enabled_plugins /operator/enabled_plugins \u0026\u0026 chown 999:999 /operator/enabled_plugins ; chown 999:999 /var/lib/rabbitmq/mnesia/ ; echo '[default]' \u003e /var/lib/rabbitmq/.rabbitmqadmin.conf \u0026\u0026 sed -e 's/default_user/username/' -e 's/default_pass/password/' /tmp/default_user.conf \u003e\u003e /var/lib/rabbitmq/.rabbitmqadmin.conf \u0026\u0026 chown 999:999 /var/lib/rabbitmq/.rabbitmqadmin.conf \u0026\u0026 chmod 600 /var/lib/rabbitmq/.rabbitmqadmin.conf"],"resources":{"limits":{"cpu":"100m","memory":"500Mi"},"requests":{"cpu":"100m","memory":"500Mi"}},"volumeMounts":[{"name":"plugins-conf","mountPath":"/tmp/rabbitmq-plugins/"},{"name":"rabbitmq-erlang-cookie","mountPath":"/var/lib/rabbitmq/"},{"name":"erlang-cookie-secret","mountPath":"/tmp/erlang-cookie-secret/"},{"name":"rabbitmq-plugins","mountPath":"/operator"},{"name":"persistence","mountPath":"/var/lib/rabbitmq/mnesia/"},{"name":"rabbitmq-confd","mountPath":"/tmp/default_user.conf","subPath":"default_user.conf"}],"terminationMessagePath":"/dev/termination-log","terminationMessagePolicy":"File","imagePullPolicy":"IfNotPresent","securityContext":{"capabilities":{"drop":["FSETID","KILL","SETGID","SETUID","SETPCAP","NET_BIND_SERVICE","NET_RAW","SYS_CHROOT","MKNOD","AUDIT_WRITE","SETFCAP"]},"runAsUser":0}}],"containers":[{"name":"rabbitmq","image":"rabbitmq:3.8.12-management","ports":[{"name":"epmd","containerPort":4369,"protocol":"TCP"},{"name":"amqp","containerPort":5672,"protocol":"TCP"},{"name":"management","containerPort":15672,"protocol":"TCP"},{"name":"prometheus","containerPort":15692,"protocol":"TCP"}],"env":[{"name":"MY_POD_NAME","valueFrom":{"fieldRef":{"apiVersion":"v1","fieldPath":"metadata.name"}}},{"name":"MY_POD_NAMESPACE","valueFrom":{"fieldRef":{"apiVersion":"v1","fieldPath":"metadata.namespace"}}},{"name":"RABBITMQ_ENABLED_PLUGINS_FILE","value":"/operator/enabled_plugins"},{"name":"K8S_SERVICE_NAME","value":"rabbitmq-cluster-nodes"},{"name":"RABBITMQ_USE_LONGNAME","value":"true"},{"name":"RABBITMQ_NODENAME","value":"rabbit@$(MY_POD_NAME).$(K8S_SERVICE_NAME).$(MY_POD_NAMESPACE)"},{"name":"K8S_HOSTNAME_SUFFIX","value":".$(K8S_SERVICE_NAME).$(MY_POD_NAMESPACE)"}],"resources":{"limits":{"cpu":"2","memory":"2Gi"},"requests":{"cpu":"1","memory":"2Gi"}},"volumeMounts":[{"name":"rabbitmq-erlang-cookie","mountPath":"/var/lib/rabbitmq/"},{"name":"persistence","mountPath":"/var/lib/rabbitmq/mnesia/"},{"name":"rabbitmq-plugins","mountPath":"/operator"},{"name":"rabbitmq-confd","mountPath":"/etc/rabbitmq/conf.d/10-operatorDefaults.conf","subPath":"operatorDefaults.conf"},{"name":"rabbitmq-confd","mountPath":"/etc/rabbitmq/conf.d/11-default_user.conf","subPath":"default_user.conf"},{"name":"rabbitmq-confd","mountPath":"/etc/rabbitmq/conf.d/90-userDefinedConfiguration.conf","subPath":"userDefinedConfiguration.conf"},{"name":"pod-info","mountPath":"/etc/pod-info/"}],"readinessProbe":{"tcpSocket":{"port":"amqp"},"initialDelaySeconds":10,"timeoutSeconds":5,"periodSeconds":10,"successThreshold":1,"failureThreshold":3},"lifecycle":{"preStop":{"exec":{"command":["/bin/bash","-c","if [ ! -z \"$(cat /etc/pod-info/skipPreStopChecks)\" ]; then exit 0; fi; rabbitmq-upgrade await_online_quorum_plus_one -t 604800; rabbitmq-upgrade await_online_synchronized_mirror -t 604800; rabbitmq-upgrade drain -t 604800"]}}},"terminationMessagePath":"/dev/termination-log","terminationMessagePolicy":"File","imagePullPolicy":"IfNotPresent"}],"restartPolicy":"Always","terminationGracePeriodSeconds":604800,"dnsPolicy":"ClusterFirst","serviceAccountName":"rabbitmq-cluster-server","serviceAccount":"rabbitmq-cluster-server","automountServiceAccountToken":true,"securityContext":{"runAsUser":999,"runAsGroup":999,"fsGroup":999},"schedulerName":"default-scheduler","topologySpreadConstraints":[{"maxSkew":1,"topologyKey":"topology.kubernetes.io/zone","whenUnsatisfiable":"ScheduleAnyway","labelSelector":{"matchLabels":{"app.kubernetes.io/name":"rabbitmq-cluster"}}}]}},"volumeClaimTemplates":[{"metadata":{"name":"persistence","namespace":"default","creationTimestamp":null,"labels":{"app.kubernetes.io/component":"rabbitmq","app.kubernetes.io/name":"rabbitmq-cluster","app.kubernetes.io/part-of":"rabbitmq"},"ownerReferences":[{"apiVersion":"rabbitmq.com/v1beta1","kind":"RabbitmqCluster","name":"rabbitmq-cluster","uid":"18d9928b-0d1c-47be-80ec-20960d053827","controller":true,"blockOwnerDeletion":false}]},"spec":{"accessModes":["ReadWriteOnce"],"resources":{"requests":{"storage":"10Gi"}},"volumeMode":"Filesystem"},"status":{"phase":"Pending"}}],"serviceName":"rabbitmq-cluster-nodes","podManagementPolicy":"Parallel","updateStrategy":{"type":"RollingUpdate","rollingUpdate":{"partition":0}},"revisionHistoryLimit":10},"status":{"observedGeneration":1,"replicas":1,"readyReplicas":1,"currentReplicas":1,"updatedReplicas":1,"currentRevision":"rabbitmq-cluster-server-5f8b8665fb","updateRevision":"rabbitmq-cluster-server-5f8b8665fb","collisionCount":0}}
2022/03/18 18:01:18 learn_server.go:291: [SIEVE-AFTER-READ]	Get	true	endpoints	default	rabbitmq-cluster	github.com/rabbitmq/cluster-operator/controllers.(*RabbitmqClusterReconciler)	NoError	{"kind":"Endpoints","apiVersion":"v1","metadata":{"name":"rabbitmq-cluster","namespace":"default","selfLink":"/api/v1/namespaces/default/endpoints/rabbitmq-cluster","uid":"5c4723ad-f4fe-442d-9135-44879a2a8183","resourceVersion":"939","creationTimestamp":"2022-03-18T18:00:38Z","labels":{"app.kubernetes.io/component":"rabbitmq","app.kubernetes.io/name":"rabbitmq-cluster","app.kubernetes.io/part-of":"rabbitmq"},"annotations":{"endpoints.kubernetes.io/last-change-trigger-time":"2022-03-18T18:01:17Z"},"managedFields":[{"manager":"kube-controller-manager","operation":"Update","apiVersion":"v1","time":"2022-03-18T18:01:17Z","fieldsType":"FieldsV1","fieldsV1":{"f:metadata":{"f:annotations":{".":{},"f:endpoints.kubernetes.io/last-change-trigger-time":{}},"f:labels":{".":{},"f:app.kubernetes.io/component":{},"f:app.kubernetes.io/name":{},"f:app.kubernetes.io/part-of":{}}},"f:subsets":{}}}]},"subsets":[{"addresses":[{"ip":"10.244.1.4","nodeName":"kind-worker2","targetRef":{"kind":"Pod","namespace":"default","name":"rabbitmq-cluster-server-0","uid":"e7faffc5-b656-4e69-9777-92d12cb6ec5a","resourceVersion":"938"}}],"ports":[{"name":"amqp","port":5672,"protocol":"TCP"},{"name":"management","port":15672,"protocol":"TCP"}]}]}
2022/03/18 18:01:18 learn_server.go:291: [SIEVE-AFTER-READ]	Get	true	statefulset	default	rabbitmq-cluster-server	github.com/rabbitmq/cluster-operator/controllers.(*RabbitmqClusterReconciler)	NoError	{"kind":"StatefulSet","apiVersion":"apps/v1","metadata":{"name":"rabbitmq-cluster-server","namespace":"default","selfLink":"/apis/apps/v1/namespaces/default/statefulsets/rabbitmq-cluster-server","uid":"cb5c43bc-6ee7-481c-ab01-6f3acffdd3c8","resourceVersion":"948","generation":1,"creationTimestamp":"2022-03-18T18:00:38Z","labels":{"app.kubernetes.io/component":"rabbitmq","app.kubernetes.io/name":"rabbitmq-cluster","app.kubernetes.io/part-of":"rabbitmq"},"ownerReferences":[{"apiVersion":"rabbitmq.com/v1beta1","kind":"RabbitmqCluster","name":"rabbitmq-cluster","uid":"18d9928b-0d1c-47be-80ec-20960d053827","controller":true,"blockOwnerDeletion":true}],"managedFields":[{"manager":"manager","operation":"Update","apiVersion":"apps/v1","time":"2022-03-18T18:00:38Z","fieldsType":"FieldsV1","fieldsV1":{"f:metadata":{"f:labels":{".":{},"f:app.kubernetes.io/component":{},"f:app.kubernetes.io/name":{},"f:app.kubernetes.io/part-of":{}},"f:ownerReferences":{".":{},"k:{\"uid\":\"18d9928b-0d1c-47be-80ec-20960d053827\"}":{".":{},"f:apiVersion":{},"f:blockOwnerDeletion":{},"f:controller":{},"f:kind":{},"f:name":{},"f:uid":{}}}},"f:spec":{"f:podManagementPolicy":{},"f:replicas":{},"f:revisionHistoryLimit":{},"f:selector":{"f:matchLabels":{".":{},"f:app.kubernetes.io/name":{}}},"f:serviceName":{},"f:template":{"f:metadata":{"f:annotations":{".":{},"f:prometheus.io/port":{},"f:prometheus.io/scrape":{}},"f:labels":{".":{},"f:app.kubernetes.io/component":{},"f:app.kubernetes.io/name":{},"f:app.kubernetes.io/part-of":{}}},"f:spec":{"f:automountServiceAccountToken":{},"f:containers":{"k:{\"name\":\"rabbitmq\"}":{".":{},"f:env":{".":{},"k:{\"name\":\"K8S_HOSTNAME_SUFFIX\"}":{".":{},"f:name":{},"f:value":{}},"k:{\"name\":\"K8S_SERVICE_NAME\"}":{".":{},"f:name":{},"f:value":{}},"k:{\"name\":\"MY_POD_NAME\"}":{".":{},"f:name":{},"f:valueFrom":{".":{},"f:fieldRef":{".":{},"f:apiVersion":{},"f:fieldPath":{}}}},"k:{\"name\":\"MY_POD_NAMESPACE\"}":{".":{},"f:name":{},"f:valueFrom":{".":{},"f:fieldRef":{".":{},"f:apiVersion":{},"f:fieldPath":{}}}},"k:{\"name\":\"RABBITMQ_ENABLED_PLUGINS_FILE\"}":{".":{},"f:name":{},"f:value":{}},"k:{\"name\":\"RABBITMQ_NODENAME\"}":{".":{},"f:name":{},"f:value":{}},"k:{\"name\":\"RABBITMQ_USE_LONGNAME\"}":{".":{},"f:name":{},"f:value":{}}},"f:image":{},"f:imagePullPolicy":{},"f:lifecycle":{".":{},"f:preStop":{".":{},"f:exec":{".":{},"f:command":{}}}},"f:name":{},"f:ports":{".":{},"k:{\"containerPort\":4369,\"protocol\":\"TCP\"}":{".":{},"f:containerPort":{},"f:name":{},"f:protocol":{}},"k:{\"containerPort\":5672,\"protocol\":\"TCP\"}":{".":{},"f:containerPort":{},"f:name":{},"f:protocol":{}},"k:{\"containerPort\":15672,\"protocol\":\"TCP\"}":{".":{},"f:containerPort":{},"f:name":{},"f:protocol":{}},"k:{\"containerPort\":15692,\"protocol\":\"TCP\"}":{".":{},"f:containerPort":{},"f:name":{},"f:protocol":{}}},"f:readinessProbe":{".":{},"f:failureThreshold":{},"f:initialDelaySeconds":{},"f:periodSeconds":{},"f:successThreshold":{},"f:tcpSocket":{".":{},"f:port":{}},"f:timeoutSeconds":{}},"f:resources":{".":{},"f:limits":{".":{},"f:cpu":{},"f:memory":{}},"f:requests":{".":{},"f:cpu":{},"f:memory":{}}},"f:terminationMessagePath":{},"f:terminationMessagePolicy":{},"f:volumeMounts":{".":{},"k:{\"mountPath\":\"/etc/pod-info/\"}":{".":{},"f:mountPath":{},"f:name":{}},"k:{\"mountPath\":\"/etc/rabbitmq/conf.d/10-operatorDefaults.conf\"}":{".":{},"f:mountPath":{},"f:name":{},"f:subPath":{}},"k:{\"mountPath\":\"/etc/rabbitmq/conf.d/11-default_user.conf\"}":{".":{},"f:mountPath":{},"f:name":{},"f:subPath":{}},"k:{\"mountPath\":\"/etc/rabbitmq/conf.d/90-userDefinedConfiguration.conf\"}":{".":{},"f:mountPath":{},"f:name":{},"f:subPath":{}},"k:{\"mountPath\":\"/operator\"}":{".":{},"f:mountPath":{},"f:name":{}},"k:{\"mountPath\":\"/var/lib/rabbitmq/\"}":{".":{},"f:mountPath":{},"f:name":{}},"k:{\"mountPath\":\"/var/lib/rabbitmq/mnesia/\"}":{".":{},"f:mountPath":{},"f:name":{}}}}},"f:dnsPolicy":{},"f:initContainers":{".":{},"k:{\"name\":\"setup-container\"}":{".":{},"f:command":{},"f:image":{},"f:imagePullPolicy":{},"f:name":{},"f:resources":{".":{},"f:limits":{".":{},"f:cpu":{},"f:memory":{}},"f:requests":{".":{},"f:cpu":{},"f:memory":{}}},"f:securityContext":{".":{},"f:capabilities":{".":{},"f:drop":{}},"f:runAsUser":{}},"f:terminationMessagePath":{},"f:terminationMessagePolicy":{},"f:volumeMounts":{".":{},"k:{\"mountPath\":\"/operator\"}":{".":{},"f:mountPath":{},"f:name":{}},"k:{\"mountPath\":\"/tmp/default_user.conf\"}":{".":{},"f:mountPath":{},"f:name":{},"f:subPath":{}},"k:{\"mountPath\":\"/tmp/erlang-cookie-secret/\"}":{".":{},"f:mountPath":{},"f:name":{}},"k:{\"mountPath\":\"/tmp/rabbitmq-plugins/\"}":{".":{},"f:mountPath":{},"f:name":{}},"k:{\"mountPath\":\"/var/lib/rabbitmq/\"}":{".":{},"f:mountPath":{},"f:name":{}},"k:{\"mountPath\":\"/var/lib/rabbitmq/mnesia/\"}":{".":{},"f:mountPath":{},"f:name":{}}}}},"f:restartPolicy":{},"f:schedulerName":{},"f:securityContext":{".":{},"f:fsGroup":{},"f:runAsGroup":{},"f:runAsUser":{}},"f:serviceAccount":{},"f:serviceAccountName":{},"f:terminationGracePeriodSeconds":{},"f:topologySpreadConstraints":{".":{},"k:{\"topologyKey\":\"topology.kubernetes.io/zone\",\"whenUnsatisfiable\":\"ScheduleAnyway\"}":{".":{},"f:labelSelector":{".":{},"f:matchLabels":{".":{},"f:app.kubernetes.io/name":{}}},"f:maxSkew":{},"f:topologyKey":{},"f:whenUnsatisfiable":{}}},"f:volumes":{".":{},"k:{\"name\":\"erlang-cookie-secret\"}":{".":{},"f:name":{},"f:secret":{".":{},"f:defaultMode":{},"f:secretName":{}}},"k:{\"name\":\"plugins-conf\"}":{".":{},"f:configMap":{".":{},"f:defaultMode":{},"f:name":{}},"f:name":{}},"k:{\"name\":\"pod-info\"}":{".":{},"f:downwardAPI":{".":{},"f:defaultMode":{},"f:items":{}},"f:name":{}},"k:{\"name\":\"rabbitmq-confd\"}":{".":{},"f:name":{},"f:projected":{".":{},"f:defaultMode":{},"f:sources":{}}},"k:{\"name\":\"rabbitmq-erlang-cookie\"}":{".":{},"f:emptyDir":{},"f:name":{}},"k:{\"name\":\"rabbitmq-plugins\"}":{".":{},"f:emptyDir":{},"f:name":{}}}}},"f:updateStrategy":{"f:rollingUpdate":{".":{},"f:partition":{}},"f:type":{}},"f:volumeClaimTemplates":{}}}},{"manager":"kube-controller-manager","operation":"Update","apiVersion":"apps/v1","time":"2022-03-18T18:01:17Z","fieldsType":"FieldsV1","fieldsV1":{"f:status":{"f:collisionCount":{},"f:currentReplicas":{},"f:currentRevision":{},"f:observedGeneration":{},"f:readyReplicas":{},"f:replicas":{},"f:updateRevision":{},"f:updatedReplicas":{}}}}]},"spec":{"replicas":1,"selector":{"matchLabels":{"app.kubernetes.io/name":"rabbitmq-cluster"}},"template":{"metadata":{"creationTimestamp":null,"labels":{"app.kubernetes.io/component":"rabbitmq","app.kubernetes.io/name":"rabbitmq-cluster","app.kubernetes.io/part-of":"rabbitmq"},"annotations":{"prometheus.io/port":"15692","prometheus.io/scrape":"true"}},"spec":{"volumes":[{"name":"plugins-conf","configMap":{"name":"rabbitmq-cluster-plugins-conf","defaultMode":420}},{"name":"rabbitmq-confd","projected":{"sources":[{"secret":{"name":"rabbitmq-cluster-default-user","items":[{"key":"default_user.conf","path":"default_user.conf"}]}},{"configMap":{"name":"rabbitmq-cluster-server-conf","items":[{"key":"operatorDefaults.conf","path":"operatorDefaults.conf"},{"key":"userDefinedConfiguration.conf","path":"userDefinedConfiguration.conf"}]}}],"defaultMode":420}},{"name":"rabbitmq-erlang-cookie","emptyDir":{}},{"name":"erlang-cookie-secret","secret":{"secretName":"rabbitmq-cluster-erlang-cookie","defaultMode":420}},{"name":"rabbitmq-plugins","emptyDir":{}},{"name":"pod-info","downwardAPI":{"items":[{"path":"skipPreStopChecks","fieldRef":{"apiVersion":"v1","fieldPath":"metadata.labels['skipPreStopChecks']"}}],"defaultMode":420}}],"initContainers":[{"name":"setup-container","image":"rabbitmq:3.8.12-management","command":["sh","-c","cp /tmp/erlang-cookie-secret/.erlang.cookie /var/lib/rabbitmq/.erlang.cookie \u0026\u0026 chown 999:999 /var/lib/rabbitmq/.erlang.cookie \u0026\u0026 chmod 600 /var/lib/rabbitmq/.erlang.cookie ; cp /tmp/rabbitmq-plugins/enabled_plugins /operator/enabled_plugins \u0026\u0026 chown 999:999 /operator/enabled_plugins ; chown 999:999 /var/lib/rabbitmq/mnesia/ ; echo '[default]' \u003e /var/lib/rabbitmq/.rabbitmqadmin.conf \u0026\u0026 sed -e 's/default_user/username/' -e 's/default_pass/password/' /tmp/default_user.conf \u003e\u003e /var/lib/rabbitmq/.rabbitmqadmin.conf \u0026\u0026 chown 999:999 /var/lib/rabbitmq/.rabbitmqadmin.conf \u0026\u0026 chmod 600 /var/lib/rabbitmq/.rabbitmqadmin.conf"],"resources":{"limits":{"cpu":"100m","memory":"500Mi"},"requests":{"cpu":"100m","memory":"500Mi"}},"volumeMounts":[{"name":"plugins-conf","mountPath":"/tmp/rabbitmq-plugins/"},{"name":"rabbitmq-erlang-cookie","mountPath":"/var/lib/rabbitmq/"},{"name":"erlang-cookie-secret","mountPath":"/tmp/erlang-cookie-secret/"},{"name":"rabbitmq-plugins","mountPath":"/operator"},{"name":"persistence","mountPath":"/var/lib/rabbitmq/mnesia/"},{"name":"rabbitmq-confd","mountPath":"/tmp/default_user.conf","subPath":"default_user.conf"}],"terminationMessagePath":"/dev/termination-log","terminationMessagePolicy":"File","imagePullPolicy":"IfNotPresent","securityContext":{"capabilities":{"drop":["FSETID","KILL","SETGID","SETUID","SETPCAP","NET_BIND_SERVICE","NET_RAW","SYS_CHROOT","MKNOD","AUDIT_WRITE","SETFCAP"]},"runAsUser":0}}],"containers":[{"name":"rabbitmq","image":"rabbitmq:3.8.12-management","ports":[{"name":"epmd","containerPort":4369,"protocol":"TCP"},{"name":"amqp","containerPort":5672,"protocol":"TCP"},{"name":"management","containerPort":15672,"protocol":"TCP"},{"name":"prometheus","containerPort":15692,"protocol":"TCP"}],"env":[{"name":"MY_POD_NAME","valueFrom":{"fieldRef":{"apiVersion":"v1","fieldPath":"metadata.name"}}},{"name":"MY_POD_NAMESPACE","valueFrom":{"fieldRef":{"apiVersion":"v1","fieldPath":"metadata.namespace"}}},{"name":"RABBITMQ_ENABLED_PLUGINS_FILE","value":"/operator/enabled_plugins"},{"name":"K8S_SERVICE_NAME","value":"rabbitmq-cluster-nodes"},{"name":"RABBITMQ_USE_LONGNAME","value":"true"},{"name":"RABBITMQ_NODENAME","value":"rabbit@$(MY_POD_NAME).$(K8S_SERVICE_NAME).$(MY_POD_NAMESPACE)"},{"name":"K8S_HOSTNAME_SUFFIX","value":".$(K8S_SERVICE_NAME).$(MY_POD_NAMESPACE)"}],"resources":{"limits":{"cpu":"2","memory":"2Gi"},"requests":{"cpu":"1","memory":"2Gi"}},"volumeMounts":[{"name":"rabbitmq-erlang-cookie","mountPath":"/var/lib/rabbitmq/"},{"name":"persistence","mountPath":"/var/lib/rabbitmq/mnesia/"},{"name":"rabbitmq-plugins","mountPath":"/operator"},{"name":"rabbitmq-confd","mountPath":"/etc/rabbitmq/conf.d/10-operatorDefaults.conf","subPath":"operatorDefaults.conf"},{"name":"rabbitmq-confd","mountPath":"/etc/rabbitmq/conf.d/11-default_user.conf","subPath":"default_user.conf"},{"name":"rabbitmq-confd","mountPath":"/etc/rabbitmq/conf.d/90-userDefinedConfiguration.conf","subPath":"userDefinedConfiguration.conf"},{"name":"pod-info","mountPath":"/etc/pod-info/"}],"readinessProbe":{"tcpSocket":{"port":"amqp"},"initialDelaySeconds":10,"timeoutSeconds":5,"periodSeconds":10,"successThreshold":1,"failureThreshold":3},"lifecycle":{"preStop":{"exec":{"command":["/bin/bash","-c","if [ ! -z \"$(cat /etc/pod-info/skipPreStopChecks)\" ]; then exit 0; fi; rabbitmq-upgrade await_online_quorum_plus_one -t 604800; rabbitmq-upgrade await_online_synchronized_mirror -t 604800; rabbitmq-upgrade drain -t 604800"]}}},"terminationMessagePath":"/dev/termination-log","terminationMessagePolicy":"File","imagePullPolicy":"IfNotPresent"}],"restartPolicy":"Always","terminationGracePeriodSeconds":604800,"dnsPolicy":"ClusterFirst","serviceAccountName":"rabbitmq-cluster-server","serviceAccount":"rabbitmq-cluster-server","automountServiceAccountToken":true,"securityContext":{"runAsUser":999,"runAsGroup":999,"fsGroup":999},"schedulerName":"default-scheduler","topologySpreadConstraints":[{"maxSkew":1,"topologyKey":"topology.kubernetes.io/zone","whenUnsatisfiable":"ScheduleAnyway","labelSelector":{"matchLabels":{"app.kubernetes.io/name":"rabbitmq-cluster"}}}]}},"volumeClaimTemplates":[{"metadata":{"name":"persistence","namespace":"default","creationTimestamp":null,"labels":{"app.kubernetes.io/component":"rabbitmq","app.kubernetes.io/name":"rabbitmq-cluster","app.kubernetes.io/part-of":"rabbitmq"},"ownerReferences":[{"apiVersion":"rabbitmq.com/v1beta1","kind":"RabbitmqCluster","name":"rabbitmq-cluster","uid":"18d9928b-0d1c-47be-80ec-20960d053827","controller":true,"blockOwnerDeletion":false}]},"spec":{"accessModes":["ReadWriteOnce"],"resources":{"requests":{"storage":"10Gi"}},"volumeMode":"Filesystem"},"status":{"phase":"Pending"}}],"serviceName":"rabbitmq-cluster-nodes","podManagementPolicy":"Parallel","updateStrategy":{"type":"RollingUpdate","rollingUpdate":{"partition":0}},"revisionHistoryLimit":10},"status":{"observedGeneration":1,"replicas":1,"readyReplicas":1,"currentReplicas":1,"updatedReplicas":1,"currentRevision":"rabbitmq-cluster-server-5f8b8665fb","updateRevision":"rabbitmq-cluster-server-5f8b8665fb","collisionCount":0}}
2022/03/18 18:01:18 learn_server.go:291: [SIEVE-AFTER-READ]	Get	true	service	default	rabbitmq-cluster-nodes	github.com/rabbitmq/cluster-operator/controllers.(*RabbitmqClusterReconciler)	NoError	{"kind":"Service","apiVersion":"v1","metadata":{"name":"rabbitmq-cluster-nodes","namespace":"default","selfLink":"/api/v1/namespaces/default/services/rabbitmq-cluster-nodes","uid":"67c7eea9-1b87-4fd7-82e6-5bfe31fd1b52","resourceVersion":"696","creationTimestamp":"2022-03-18T18:00:38Z","labels":{"app.kubernetes.io/component":"rabbitmq","app.kubernetes.io/name":"rabbitmq-cluster","app.kubernetes.io/part-of":"rabbitmq"},"ownerReferences":[{"apiVersion":"rabbitmq.com/v1beta1","kind":"RabbitmqCluster","name":"rabbitmq-cluster","uid":"18d9928b-0d1c-47be-80ec-20960d053827","controller":true,"blockOwnerDeletion":true}],"managedFields":[{"manager":"manager","operation":"Update","apiVersion":"v1","time":"2022-03-18T18:00:38Z","fieldsType":"FieldsV1","fieldsV1":{"f:metadata":{"f:labels":{".":{},"f:app.kubernetes.io/component":{},"f:app.kubernetes.io/name":{},"f:app.kubernetes.io/part-of":{}},"f:ownerReferences":{".":{},"k:{\"uid\":\"18d9928b-0d1c-47be-80ec-20960d053827\"}":{".":{},"f:apiVersion":{},"f:blockOwnerDeletion":{},"f:controller":{},"f:kind":{},"f:name":{},"f:uid":{}}}},"f:spec":{"f:clusterIP":{},"f:ports":{".":{},"k:{\"port\":4369,\"protocol\":\"TCP\"}":{".":{},"f:name":{},"f:port":{},"f:protocol":{},"f:targetPort":{}},"k:{\"port\":25672,\"protocol\":\"TCP\"}":{".":{},"f:name":{},"f:port":{},"f:protocol":{},"f:targetPort":{}}},"f:publishNotReadyAddresses":{},"f:selector":{".":{},"f:app.kubernetes.io/name":{}},"f:sessionAffinity":{},"f:type":{}}}}]},"spec":{"ports":[{"name":"epmd","protocol":"TCP","port":4369,"targetPort":4369},{"name":"cluster-rpc","protocol":"TCP","port":25672,"targetPort":25672}],"selector":{"app.kubernetes.io/name":"rabbitmq-cluster"},"clusterIP":"None","type":"ClusterIP","sessionAffinity":"None","publishNotReadyAddresses":true},"status":{"loadBalancer":{}}}
2022/03/18 18:01:18 learn_server.go:291: [SIEVE-AFTER-READ]	Get	true	service	default	rabbitmq-cluster	github.com/rabbitmq/cluster-operator/controllers.(*RabbitmqClusterReconciler)	NoError	{"kind":"Service","apiVersion":"v1","metadata":{"name":"rabbitmq-cluster","namespace":"default","selfLink":"/api/v1/namespaces/default/services/rabbitmq-cluster","uid":"56b50671-1945-458b-adac-05619b783392","resourceVersion":"701","creationTimestamp":"2022-03-18T18:00:38Z","labels":{"app.kubernetes.io/component":"rabbitmq","app.kubernetes.io/name":"rabbitmq-cluster","app.kubernetes.io/part-of":"rabbitmq"},"ownerReferences":[{"apiVersion":"rabbitmq.com/v1beta1","kind":"RabbitmqCluster","name":"rabbitmq-cluster","uid":"18d9928b-0d1c-47be-80ec-20960d053827","controller":true,"blockOwnerDeletion":true}],"managedFields":[{"manager":"manager","operation":"Update","apiVersion":"v1","time":"2022-03-18T18:00:38Z","fieldsType":"FieldsV1","fieldsV1":{"f:metadata":{"f:labels":{".":{},"f:app.kubernetes.io/component":{},"f:app.kubernetes.io/name":{},"f:app.kubernetes.io/part-of":{}},"f:ownerReferences":{".":{},"k:{\"uid\":\"18d9928b-0d1c-47be-80ec-20960d053827\"}":{".":{},"f:apiVersion":{},"f:blockOwnerDeletion":{},"f:controller":{},"f:kind":{},"f:name":{},"f:uid":{}}}},"f:spec":{"f:ports":{".":{},"k:{\"port\":5672,\"protocol\":\"TCP\"}":{".":{},"f:name":{},"f:port":{},"f:protocol":{},"f:targetPort":{}},"k:{\"port\":15672,\"protocol\":\"TCP\"}":{".":{},"f:name":{},"f:port":{},"f:protocol":{},"f:targetPort":{}}},"f:selector":{".":{},"f:app.kubernetes.io/name":{}},"f:sessionAffinity":{},"f:type":{}}}}]},"spec":{"ports":[{"name":"amqp","protocol":"TCP","port":5672,"targetPort":5672},{"name":"management","protocol":"TCP","port":15672,"targetPort":15672}],"selector":{"app.kubernetes.io/name":"rabbitmq-cluster"},"clusterIP":"10.96.254.158","type":"ClusterIP","sessionAffinity":"None"},"status":{"loadBalancer":{}}}
2022/03/18 18:01:18 learn_server.go:291: [SIEVE-AFTER-READ]	Get	true	secret	default	rabbitmq-cluster-erlang-cookie	github.com/rabbitmq/cluster-operator/controllers.(*RabbitmqClusterReconciler)	NoError	{"kind":"Secret","apiVersion":"v1","metadata":{"name":"rabbitmq-cluster-erlang-cookie","namespace":"default","selfLink":"/api/v1/namespaces/default/secrets/rabbitmq-cluster-erlang-cookie","uid":"f8fbe8a6-0f40-4e13-960b-ab78b8ba75b0","resourceVersion":"705","creationTimestamp":"2022-03-18T18:00:38Z","labels":{"app.kubernetes.io/component":"rabbitmq","app.kubernetes.io/name":"rabbitmq-cluster","app.kubernetes.io/part-of":"rabbitmq"},"ownerReferences":[{"apiVersion":"rabbitmq.com/v1beta1","kind":"RabbitmqCluster","name":"rabbitmq-cluster","uid":"18d9928b-0d1c-47be-80ec-20960d053827","controller":true,"blockOwnerDeletion":true}],"managedFields":[{"manager":"manager","operation":"Update","apiVersion":"v1","time":"2022-03-18T18:00:38Z","fieldsType":"FieldsV1","fieldsV1":{"f:data":{".":{},"f:.erlang.cookie":{}},"f:metadata":{"f:labels":{".":{},"f:app.kubernetes.io/component":{},"f:app.kubernetes.io/name":{},"f:app.kubernetes.io/part-of":{}},"f:ownerReferences":{".":{},"k:{\"uid\":\"18d9928b-0d1c-47be-80ec-20960d053827\"}":{".":{},"f:apiVersion":{},"f:blockOwnerDeletion":{},"f:controller":{},"f:kind":{},"f:name":{},"f:uid":{}}}},"f:type":{}}}]},"data":{".erlang.cookie":"QW9hMkpWU0tlYS1FUGdWTUhrelNMNnFoMFZ0ZmRGNUY="},"type":"Opaque"}
2022/03/18 18:01:18 learn_server.go:291: [SIEVE-AFTER-READ]	Get	true	secret	default	rabbitmq-cluster-default-user	github.com/rabbitmq/cluster-operator/controllers.(*RabbitmqClusterReconciler)	NoError	{"kind":"Secret","apiVersion":"v1","metadata":{"name":"rabbitmq-cluster-default-user","namespace":"default","selfLink":"/api/v1/namespaces/default/secrets/rabbitmq-cluster-default-user","uid":"0d9f460b-a23c-402b-8273-f541ed39023f","resourceVersion":"708","creationTimestamp":"2022-03-18T18:00:38Z","labels":{"app.kubernetes.io/component":"rabbitmq","app.kubernetes.io/name":"rabbitmq-cluster","app.kubernetes.io/part-of":"rabbitmq"},"ownerReferences":[{"apiVersion":"rabbitmq.com/v1beta1","kind":"RabbitmqCluster","name":"rabbitmq-cluster","uid":"18d9928b-0d1c-47be-80ec-20960d053827","controller":true,"blockOwnerDeletion":true}],"managedFields":[{"manager":"manager","operation":"Update","apiVersion":"v1","time":"2022-03-18T18:00:38Z","fieldsType":"FieldsV1","fieldsV1":{"f:data":{".":{},"f:default_user.conf":{},"f:password":{},"f:provider":{},"f:type":{},"f:username":{}},"f:metadata":{"f:labels":{".":{},"f:app.kubernetes.io/component":{},"f:app.kubernetes.io/name":{},"f:app.kubernetes.io/part-of":{}},"f:ownerReferences":{".":{},"k:{\"uid\":\"18d9928b-0d1c-47be-80ec-20960d053827\"}":{".":{},"f:apiVersion":{},"f:blockOwnerDeletion":{},"f:controller":{},"f:kind":{},"f:name":{},"f:uid":{}}}},"f:type":{}}}]},"data":{"default_user.conf":"ZGVmYXVsdF91c2VyID0gcTMxRmh3MGtjWW9SZUl5X3BPTXp2ZVBOUnNVU3I1Mk8KZGVmYXVsdF9wYXNzID0gY0dBX19jNTJHX05hVURpTGhraWZ6UDBOVVlNLTE2MWQK","password":"Y0dBX19jNTJHX05hVURpTGhraWZ6UDBOVVlNLTE2MWQ=","provider":"cmFiYml0bXE=","type":"cmFiYml0bXE=","username":"cTMxRmh3MGtjWW9SZUl5X3BPTXp2ZVBOUnNVU3I1Mk8="},"type":"Opaque"}
2022/03/18 18:01:18 learn_server.go:291: [SIEVE-AFTER-READ]	Get	true	configmap	default	rabbitmq-cluster-plugins-conf	github.com/rabbitmq/cluster-operator/controllers.(*RabbitmqClusterReconciler)	NoError	{"kind":"ConfigMap","apiVersion":"v1","metadata":{"name":"rabbitmq-cluster-plugins-conf","namespace":"default","selfLink":"/api/v1/namespaces/default/configmaps/rabbitmq-cluster-plugins-conf","uid":"a164075b-0562-47ac-a577-99aa8651ec40","resourceVersion":"709","creationTimestamp":"2022-03-18T18:00:38Z","labels":{"app.kubernetes.io/component":"rabbitmq","app.kubernetes.io/name":"rabbitmq-cluster","app.kubernetes.io/part-of":"rabbitmq"},"ownerReferences":[{"apiVersion":"rabbitmq.com/v1beta1","kind":"RabbitmqCluster","name":"rabbitmq-cluster","uid":"18d9928b-0d1c-47be-80ec-20960d053827","controller":true,"blockOwnerDeletion":true}],"managedFields":[{"manager":"manager","operation":"Update","apiVersion":"v1","time":"2022-03-18T18:00:38Z","fieldsType":"FieldsV1","fieldsV1":{"f:data":{".":{},"f:enabled_plugins":{}},"f:metadata":{"f:labels":{".":{},"f:app.kubernetes.io/component":{},"f:app.kubernetes.io/name":{},"f:app.kubernetes.io/part-of":{}},"f:ownerReferences":{".":{},"k:{\"uid\":\"18d9928b-0d1c-47be-80ec-20960d053827\"}":{".":{},"f:apiVersion":{},"f:blockOwnerDeletion":{},"f:controller":{},"f:kind":{},"f:name":{},"f:uid":{}}}}}}]},"data":{"enabled_plugins":"[rabbitmq_peer_discovery_k8s,rabbitmq_prometheus,rabbitmq_management]."}}
2022/03/18 18:01:18 learn_server.go:291: [SIEVE-AFTER-READ]	Get	true	configmap	default	rabbitmq-cluster-server-conf	github.com/rabbitmq/cluster-operator/controllers.(*RabbitmqClusterReconciler)	NoError	{"kind":"ConfigMap","apiVersion":"v1","metadata":{"name":"rabbitmq-cluster-server-conf","namespace":"default","selfLink":"/api/v1/namespaces/default/configmaps/rabbitmq-cluster-server-conf","uid":"22474f2b-8454-44b7-8079-8990223969cc","resourceVersion":"714","creationTimestamp":"2022-03-18T18:00:38Z","labels":{"app.kubernetes.io/component":"rabbitmq","app.kubernetes.io/name":"rabbitmq-cluster","app.kubernetes.io/part-of":"rabbitmq"},"ownerReferences":[{"apiVersion":"rabbitmq.com/v1beta1","kind":"RabbitmqCluster","name":"rabbitmq-cluster","uid":"18d9928b-0d1c-47be-80ec-20960d053827","controller":true,"blockOwnerDeletion":true}],"managedFields":[{"manager":"manager","operation":"Update","apiVersion":"v1","time":"2022-03-18T18:00:38Z","fieldsType":"FieldsV1","fieldsV1":{"f:data":{".":{},"f:operatorDefaults.conf":{},"f:userDefinedConfiguration.conf":{}},"f:metadata":{"f:labels":{".":{},"f:app.kubernetes.io/component":{},"f:app.kubernetes.io/name":{},"f:app.kubernetes.io/part-of":{}},"f:ownerReferences":{".":{},"k:{\"uid\":\"18d9928b-0d1c-47be-80ec-20960d053827\"}":{".":{},"f:apiVersion":{},"f:blockOwnerDeletion":{},"f:controller":{},"f:kind":{},"f:name":{},"f:uid":{}}}}}}]},"data":{"operatorDefaults.conf":"cluster_formation.peer_discovery_backend             = rabbit_peer_discovery_k8s\ncluster_formation.k8s.host                           = kubernetes.default\ncluster_formation.k8s.address_type                   = hostname\ncluster_partition_handling                           = pause_minority\nqueue_master_locator                                 = min-masters\ndisk_free_limit.absolute                             = 2GB\ncluster_formation.randomized_startup_delay_range.min = 5\ncluster_formation.randomized_startup_delay_range.max = 30\ncluster_name                                         = rabbitmq-cluster\n","userDefinedConfiguration.conf":"total_memory_available_override_value = 1717986919\n"}}
2022/03/18 18:01:18 learn_server.go:291: [SIEVE-AFTER-READ]	Get	true	serviceaccount	default	rabbitmq-cluster-server	github.com/rabbitmq/cluster-operator/controllers.(*RabbitmqClusterReconciler)	NoError	{"kind":"ServiceAccount","apiVersion":"v1","metadata":{"name":"rabbitmq-cluster-server","namespace":"default","selfLink":"/api/v1/namespaces/default/serviceaccounts/rabbitmq-cluster-server","uid":"731589b5-ac97-4774-bee4-008949b54734","resourceVersion":"722","creationTimestamp":"2022-03-18T18:00:38Z","labels":{"app.kubernetes.io/component":"rabbitmq","app.kubernetes.io/name":"rabbitmq-cluster","app.kubernetes.io/part-of":"rabbitmq"},"ownerReferences":[{"apiVersion":"rabbitmq.com/v1beta1","kind":"RabbitmqCluster","name":"rabbitmq-cluster","uid":"18d9928b-0d1c-47be-80ec-20960d053827","controller":true,"blockOwnerDeletion":true}],"managedFields":[{"manager":"kube-controller-manager","operation":"Update","apiVersion":"v1","time":"2022-03-18T18:00:38Z","fieldsType":"FieldsV1","fieldsV1":{"f:secrets":{".":{},"k:{\"name\":\"rabbitmq-cluster-server-token-rhzq9\"}":{".":{},"f:name":{}}}}},{"manager":"manager","operation":"Update","apiVersion":"v1","time":"2022-03-18T18:00:38Z","fieldsType":"FieldsV1","fieldsV1":{"f:metadata":{"f:labels":{".":{},"f:app.kubernetes.io/component":{},"f:app.kubernetes.io/name":{},"f:app.kubernetes.io/part-of":{}},"f:ownerReferences":{".":{},"k:{\"uid\":\"18d9928b-0d1c-47be-80ec-20960d053827\"}":{".":{},"f:apiVersion":{},"f:blockOwnerDeletion":{},"f:controller":{},"f:kind":{},"f:name":{},"f:uid":{}}}}}}]},"secrets":[{"name":"rabbitmq-cluster-server-token-rhzq9"}]}
2022/03/18 18:01:18 learn_server.go:291: [SIEVE-AFTER-READ]	Get	true	role	default	rabbitmq-cluster-peer-discovery	github.com/rabbitmq/cluster-operator/controllers.(*RabbitmqClusterReconciler)	NoError	{"kind":"Role","apiVersion":"rbac.authorization.k8s.io/v1","metadata":{"name":"rabbitmq-cluster-peer-discovery","namespace":"default","selfLink":"/apis/rbac.authorization.k8s.io/v1/namespaces/default/roles/rabbitmq-cluster-peer-discovery","uid":"52c80b50-4fdd-4089-bbfd-9756465953f2","resourceVersion":"723","creationTimestamp":"2022-03-18T18:00:38Z","labels":{"app.kubernetes.io/component":"rabbitmq","app.kubernetes.io/name":"rabbitmq-cluster","app.kubernetes.io/part-of":"rabbitmq"},"ownerReferences":[{"apiVersion":"rabbitmq.com/v1beta1","kind":"RabbitmqCluster","name":"rabbitmq-cluster","uid":"18d9928b-0d1c-47be-80ec-20960d053827","controller":true,"blockOwnerDeletion":true}],"managedFields":[{"manager":"manager","operation":"Update","apiVersion":"rbac.authorization.k8s.io/v1","time":"2022-03-18T18:00:38Z","fieldsType":"FieldsV1","fieldsV1":{"f:metadata":{"f:labels":{".":{},"f:app.kubernetes.io/component":{},"f:app.kubernetes.io/name":{},"f:app.kubernetes.io/part-of":{}},"f:ownerReferences":{".":{},"k:{\"uid\":\"18d9928b-0d1c-47be-80ec-20960d053827\"}":{".":{},"f:apiVersion":{},"f:blockOwnerDeletion":{},"f:controller":{},"f:kind":{},"f:name":{},"f:uid":{}}}},"f:rules":{}}}]},"rules":[{"verbs":["get"],"apiGroups":[""],"resources":["endpoints"]},{"verbs":["create"],"apiGroups":[""],"resources":["events"]}]}
2022/03/18 18:01:18 learn_server.go:291: [SIEVE-AFTER-READ]	Get	true	rolebinding	default	rabbitmq-cluster-server	github.com/rabbitmq/cluster-operator/controllers.(*RabbitmqClusterReconciler)	NoError	{"kind":"RoleBinding","apiVersion":"rbac.authorization.k8s.io/v1","metadata":{"name":"rabbitmq-cluster-server","namespace":"default","selfLink":"/apis/rbac.authorization.k8s.io/v1/namespaces/default/rolebindings/rabbitmq-cluster-server","uid":"495e9f7c-a20d-4515-86b0-34149a855034","resourceVersion":"725","creationTimestamp":"2022-03-18T18:00:38Z","labels":{"app.kubernetes.io/component":"rabbitmq","app.kubernetes.io/name":"rabbitmq-cluster","app.kubernetes.io/part-of":"rabbitmq"},"ownerReferences":[{"apiVersion":"rabbitmq.com/v1beta1","kind":"RabbitmqCluster","name":"rabbitmq-cluster","uid":"18d9928b-0d1c-47be-80ec-20960d053827","controller":true,"blockOwnerDeletion":true}],"managedFields":[{"manager":"manager","operation":"Update","apiVersion":"rbac.authorization.k8s.io/v1","time":"2022-03-18T18:00:38Z","fieldsType":"FieldsV1","fieldsV1":{"f:metadata":{"f:labels":{".":{},"f:app.kubernetes.io/component":{},"f:app.kubernetes.io/name":{},"f:app.kubernetes.io/part-of":{}},"f:ownerReferences":{".":{},"k:{\"uid\":\"18d9928b-0d1c-47be-80ec-20960d053827\"}":{".":{},"f:apiVersion":{},"f:blockOwnerDeletion":{},"f:controller":{},"f:kind":{},"f:name":{},"f:uid":{}}}},"f:roleRef":{"f:apiGroup":{},"f:kind":{},"f:name":{}},"f:subjects":{}}}]},"subjects":[{"kind":"ServiceAccount","name":"rabbitmq-cluster-server"}],"roleRef":{"apiGroup":"rbac.authorization.k8s.io","kind":"Role","name":"rabbitmq-cluster-peer-discovery"}}
2022/03/18 18:01:18 learn_server.go:291: [SIEVE-AFTER-READ]	Get	true	statefulset	default	rabbitmq-cluster-server	github.com/rabbitmq/cluster-operator/controllers.(*RabbitmqClusterReconciler)	NoError	{"kind":"StatefulSet","apiVersion":"apps/v1","metadata":{"name":"rabbitmq-cluster-server","namespace":"default","selfLink":"/apis/apps/v1/namespaces/default/statefulsets/rabbitmq-cluster-server","uid":"cb5c43bc-6ee7-481c-ab01-6f3acffdd3c8","resourceVersion":"948","generation":1,"creationTimestamp":"2022-03-18T18:00:38Z","labels":{"app.kubernetes.io/component":"rabbitmq","app.kubernetes.io/name":"rabbitmq-cluster","app.kubernetes.io/part-of":"rabbitmq"},"ownerReferences":[{"apiVersion":"rabbitmq.com/v1beta1","kind":"RabbitmqCluster","name":"rabbitmq-cluster","uid":"18d9928b-0d1c-47be-80ec-20960d053827","controller":true,"blockOwnerDeletion":true}],"managedFields":[{"manager":"manager","operation":"Update","apiVersion":"apps/v1","time":"2022-03-18T18:00:38Z","fieldsType":"FieldsV1","fieldsV1":{"f:metadata":{"f:labels":{".":{},"f:app.kubernetes.io/component":{},"f:app.kubernetes.io/name":{},"f:app.kubernetes.io/part-of":{}},"f:ownerReferences":{".":{},"k:{\"uid\":\"18d9928b-0d1c-47be-80ec-20960d053827\"}":{".":{},"f:apiVersion":{},"f:blockOwnerDeletion":{},"f:controller":{},"f:kind":{},"f:name":{},"f:uid":{}}}},"f:spec":{"f:podManagementPolicy":{},"f:replicas":{},"f:revisionHistoryLimit":{},"f:selector":{"f:matchLabels":{".":{},"f:app.kubernetes.io/name":{}}},"f:serviceName":{},"f:template":{"f:metadata":{"f:annotations":{".":{},"f:prometheus.io/port":{},"f:prometheus.io/scrape":{}},"f:labels":{".":{},"f:app.kubernetes.io/component":{},"f:app.kubernetes.io/name":{},"f:app.kubernetes.io/part-of":{}}},"f:spec":{"f:automountServiceAccountToken":{},"f:containers":{"k:{\"name\":\"rabbitmq\"}":{".":{},"f:env":{".":{},"k:{\"name\":\"K8S_HOSTNAME_SUFFIX\"}":{".":{},"f:name":{},"f:value":{}},"k:{\"name\":\"K8S_SERVICE_NAME\"}":{".":{},"f:name":{},"f:value":{}},"k:{\"name\":\"MY_POD_NAME\"}":{".":{},"f:name":{},"f:valueFrom":{".":{},"f:fieldRef":{".":{},"f:apiVersion":{},"f:fieldPath":{}}}},"k:{\"name\":\"MY_POD_NAMESPACE\"}":{".":{},"f:name":{},"f:valueFrom":{".":{},"f:fieldRef":{".":{},"f:apiVersion":{},"f:fieldPath":{}}}},"k:{\"name\":\"RABBITMQ_ENABLED_PLUGINS_FILE\"}":{".":{},"f:name":{},"f:value":{}},"k:{\"name\":\"RABBITMQ_NODENAME\"}":{".":{},"f:name":{},"f:value":{}},"k:{\"name\":\"RABBITMQ_USE_LONGNAME\"}":{".":{},"f:name":{},"f:value":{}}},"f:image":{},"f:imagePullPolicy":{},"f:lifecycle":{".":{},"f:preStop":{".":{},"f:exec":{".":{},"f:command":{}}}},"f:name":{},"f:ports":{".":{},"k:{\"containerPort\":4369,\"protocol\":\"TCP\"}":{".":{},"f:containerPort":{},"f:name":{},"f:protocol":{}},"k:{\"containerPort\":5672,\"protocol\":\"TCP\"}":{".":{},"f:containerPort":{},"f:name":{},"f:protocol":{}},"k:{\"containerPort\":15672,\"protocol\":\"TCP\"}":{".":{},"f:containerPort":{},"f:name":{},"f:protocol":{}},"k:{\"containerPort\":15692,\"protocol\":\"TCP\"}":{".":{},"f:containerPort":{},"f:name":{},"f:protocol":{}}},"f:readinessProbe":{".":{},"f:failureThreshold":{},"f:initialDelaySeconds":{},"f:periodSeconds":{},"f:successThreshold":{},"f:tcpSocket":{".":{},"f:port":{}},"f:timeoutSeconds":{}},"f:resources":{".":{},"f:limits":{".":{},"f:cpu":{},"f:memory":{}},"f:requests":{".":{},"f:cpu":{},"f:memory":{}}},"f:terminationMessagePath":{},"f:terminationMessagePolicy":{},"f:volumeMounts":{".":{},"k:{\"mountPath\":\"/etc/pod-info/\"}":{".":{},"f:mountPath":{},"f:name":{}},"k:{\"mountPath\":\"/etc/rabbitmq/conf.d/10-operatorDefaults.conf\"}":{".":{},"f:mountPath":{},"f:name":{},"f:subPath":{}},"k:{\"mountPath\":\"/etc/rabbitmq/conf.d/11-default_user.conf\"}":{".":{},"f:mountPath":{},"f:name":{},"f:subPath":{}},"k:{\"mountPath\":\"/etc/rabbitmq/conf.d/90-userDefinedConfiguration.conf\"}":{".":{},"f:mountPath":{},"f:name":{},"f:subPath":{}},"k:{\"mountPath\":\"/operator\"}":{".":{},"f:mountPath":{},"f:name":{}},"k:{\"mountPath\":\"/var/lib/rabbitmq/\"}":{".":{},"f:mountPath":{},"f:name":{}},"k:{\"mountPath\":\"/var/lib/rabbitmq/mnesia/\"}":{".":{},"f:mountPath":{},"f:name":{}}}}},"f:dnsPolicy":{},"f:initContainers":{".":{},"k:{\"name\":\"setup-container\"}":{".":{},"f:command":{},"f:image":{},"f:imagePullPolicy":{},"f:name":{},"f:resources":{".":{},"f:limits":{".":{},"f:cpu":{},"f:memory":{}},"f:requests":{".":{},"f:cpu":{},"f:memory":{}}},"f:securityContext":{".":{},"f:capabilities":{".":{},"f:drop":{}},"f:runAsUser":{}},"f:terminationMessagePath":{},"f:terminationMessagePolicy":{},"f:volumeMounts":{".":{},"k:{\"mountPath\":\"/operator\"}":{".":{},"f:mountPath":{},"f:name":{}},"k:{\"mountPath\":\"/tmp/default_user.conf\"}":{".":{},"f:mountPath":{},"f:name":{},"f:subPath":{}},"k:{\"mountPath\":\"/tmp/erlang-cookie-secret/\"}":{".":{},"f:mountPath":{},"f:name":{}},"k:{\"mountPath\":\"/tmp/rabbitmq-plugins/\"}":{".":{},"f:mountPath":{},"f:name":{}},"k:{\"mountPath\":\"/var/lib/rabbitmq/\"}":{".":{},"f:mountPath":{},"f:name":{}},"k:{\"mountPath\":\"/var/lib/rabbitmq/mnesia/\"}":{".":{},"f:mountPath":{},"f:name":{}}}}},"f:restartPolicy":{},"f:schedulerName":{},"f:securityContext":{".":{},"f:fsGroup":{},"f:runAsGroup":{},"f:runAsUser":{}},"f:serviceAccount":{},"f:serviceAccountName":{},"f:terminationGracePeriodSeconds":{},"f:topologySpreadConstraints":{".":{},"k:{\"topologyKey\":\"topology.kubernetes.io/zone\",\"whenUnsatisfiable\":\"ScheduleAnyway\"}":{".":{},"f:labelSelector":{".":{},"f:matchLabels":{".":{},"f:app.kubernetes.io/name":{}}},"f:maxSkew":{},"f:topologyKey":{},"f:whenUnsatisfiable":{}}},"f:volumes":{".":{},"k:{\"name\":\"erlang-cookie-secret\"}":{".":{},"f:name":{},"f:secret":{".":{},"f:defaultMode":{},"f:secretName":{}}},"k:{\"name\":\"plugins-conf\"}":{".":{},"f:configMap":{".":{},"f:defaultMode":{},"f:name":{}},"f:name":{}},"k:{\"name\":\"pod-info\"}":{".":{},"f:downwardAPI":{".":{},"f:defaultMode":{},"f:items":{}},"f:name":{}},"k:{\"name\":\"rabbitmq-confd\"}":{".":{},"f:name":{},"f:projected":{".":{},"f:defaultMode":{},"f:sources":{}}},"k:{\"name\":\"rabbitmq-erlang-cookie\"}":{".":{},"f:emptyDir":{},"f:name":{}},"k:{\"name\":\"rabbitmq-plugins\"}":{".":{},"f:emptyDir":{},"f:name":{}}}}},"f:updateStrategy":{"f:rollingUpdate":{".":{},"f:partition":{}},"f:type":{}},"f:volumeClaimTemplates":{}}}},{"manager":"kube-controller-manager","operation":"Update","apiVersion":"apps/v1","time":"2022-03-18T18:01:17Z","fieldsType":"FieldsV1","fieldsV1":{"f:status":{"f:collisionCount":{},"f:currentReplicas":{},"f:currentRevision":{},"f:observedGeneration":{},"f:readyReplicas":{},"f:replicas":{},"f:updateRevision":{},"f:updatedReplicas":{}}}}]},"spec":{"replicas":1,"selector":{"matchLabels":{"app.kubernetes.io/name":"rabbitmq-cluster"}},"template":{"metadata":{"creationTimestamp":null,"labels":{"app.kubernetes.io/component":"rabbitmq","app.kubernetes.io/name":"rabbitmq-cluster","app.kubernetes.io/part-of":"rabbitmq"},"annotations":{"prometheus.io/port":"15692","prometheus.io/scrape":"true"}},"spec":{"volumes":[{"name":"plugins-conf","configMap":{"name":"rabbitmq-cluster-plugins-conf","defaultMode":420}},{"name":"rabbitmq-confd","projected":{"sources":[{"secret":{"name":"rabbitmq-cluster-default-user","items":[{"key":"default_user.conf","path":"default_user.conf"}]}},{"configMap":{"name":"rabbitmq-cluster-server-conf","items":[{"key":"operatorDefaults.conf","path":"operatorDefaults.conf"},{"key":"userDefinedConfiguration.conf","path":"userDefinedConfiguration.conf"}]}}],"defaultMode":420}},{"name":"rabbitmq-erlang-cookie","emptyDir":{}},{"name":"erlang-cookie-secret","secret":{"secretName":"rabbitmq-cluster-erlang-cookie","defaultMode":420}},{"name":"rabbitmq-plugins","emptyDir":{}},{"name":"pod-info","downwardAPI":{"items":[{"path":"skipPreStopChecks","fieldRef":{"apiVersion":"v1","fieldPath":"metadata.labels['skipPreStopChecks']"}}],"defaultMode":420}}],"initContainers":[{"name":"setup-container","image":"rabbitmq:3.8.12-management","command":["sh","-c","cp /tmp/erlang-cookie-secret/.erlang.cookie /var/lib/rabbitmq/.erlang.cookie \u0026\u0026 chown 999:999 /var/lib/rabbitmq/.erlang.cookie \u0026\u0026 chmod 600 /var/lib/rabbitmq/.erlang.cookie ; cp /tmp/rabbitmq-plugins/enabled_plugins /operator/enabled_plugins \u0026\u0026 chown 999:999 /operator/enabled_plugins ; chown 999:999 /var/lib/rabbitmq/mnesia/ ; echo '[default]' \u003e /var/lib/rabbitmq/.rabbitmqadmin.conf \u0026\u0026 sed -e 's/default_user/username/' -e 's/default_pass/password/' /tmp/default_user.conf \u003e\u003e /var/lib/rabbitmq/.rabbitmqadmin.conf \u0026\u0026 chown 999:999 /var/lib/rabbitmq/.rabbitmqadmin.conf \u0026\u0026 chmod 600 /var/lib/rabbitmq/.rabbitmqadmin.conf"],"resources":{"limits":{"cpu":"100m","memory":"500Mi"},"requests":{"cpu":"100m","memory":"500Mi"}},"volumeMounts":[{"name":"plugins-conf","mountPath":"/tmp/rabbitmq-plugins/"},{"name":"rabbitmq-erlang-cookie","mountPath":"/var/lib/rabbitmq/"},{"name":"erlang-cookie-secret","mountPath":"/tmp/erlang-cookie-secret/"},{"name":"rabbitmq-plugins","mountPath":"/operator"},{"name":"persistence","mountPath":"/var/lib/rabbitmq/mnesia/"},{"name":"rabbitmq-confd","mountPath":"/tmp/default_user.conf","subPath":"default_user.conf"}],"terminationMessagePath":"/dev/termination-log","terminationMessagePolicy":"File","imagePullPolicy":"IfNotPresent","securityContext":{"capabilities":{"drop":["FSETID","KILL","SETGID","SETUID","SETPCAP","NET_BIND_SERVICE","NET_RAW","SYS_CHROOT","MKNOD","AUDIT_WRITE","SETFCAP"]},"runAsUser":0}}],"containers":[{"name":"rabbitmq","image":"rabbitmq:3.8.12-management","ports":[{"name":"epmd","containerPort":4369,"protocol":"TCP"},{"name":"amqp","containerPort":5672,"protocol":"TCP"},{"name":"management","containerPort":15672,"protocol":"TCP"},{"name":"prometheus","containerPort":15692,"protocol":"TCP"}],"env":[{"name":"MY_POD_NAME","valueFrom":{"fieldRef":{"apiVersion":"v1","fieldPath":"metadata.name"}}},{"name":"MY_POD_NAMESPACE","valueFrom":{"fieldRef":{"apiVersion":"v1","fieldPath":"metadata.namespace"}}},{"name":"RABBITMQ_ENABLED_PLUGINS_FILE","value":"/operator/enabled_plugins"},{"name":"K8S_SERVICE_NAME","value":"rabbitmq-cluster-nodes"},{"name":"RABBITMQ_USE_LONGNAME","value":"true"},{"name":"RABBITMQ_NODENAME","value":"rabbit@$(MY_POD_NAME).$(K8S_SERVICE_NAME).$(MY_POD_NAMESPACE)"},{"name":"K8S_HOSTNAME_SUFFIX","value":".$(K8S_SERVICE_NAME).$(MY_POD_NAMESPACE)"}],"resources":{"limits":{"cpu":"2","memory":"2Gi"},"requests":{"cpu":"1","memory":"2Gi"}},"volumeMounts":[{"name":"rabbitmq-erlang-cookie","mountPath":"/var/lib/rabbitmq/"},{"name":"persistence","mountPath":"/var/lib/rabbitmq/mnesia/"},{"name":"rabbitmq-plugins","mountPath":"/operator"},{"name":"rabbitmq-confd","mountPath":"/etc/rabbitmq/conf.d/10-operatorDefaults.conf","subPath":"operatorDefaults.conf"},{"name":"rabbitmq-confd","mountPath":"/etc/rabbitmq/conf.d/11-default_user.conf","subPath":"default_user.conf"},{"name":"rabbitmq-confd","mountPath":"/etc/rabbitmq/conf.d/90-userDefinedConfiguration.conf","subPath":"userDefinedConfiguration.conf"},{"name":"pod-info","mountPath":"/etc/pod-info/"}],"readinessProbe":{"tcpSocket":{"port":"amqp"},"initialDelaySeconds":10,"timeoutSeconds":5,"periodSeconds":10,"successThreshold":1,"failureThreshold":3},"lifecycle":{"preStop":{"exec":{"command":["/bin/bash","-c","if [ ! -z \"$(cat /etc/pod-info/skipPreStopChecks)\" ]; then exit 0; fi; rabbitmq-upgrade await_online_quorum_plus_one -t 604800; rabbitmq-upgrade await_online_synchronized_mirror -t 604800; rabbitmq-upgrade drain -t 604800"]}}},"terminationMessagePath":"/dev/termination-log","terminationMessagePolicy":"File","imagePullPolicy":"IfNotPresent"}],"restartPolicy":"Always","terminationGracePeriodSeconds":604800,"dnsPolicy":"ClusterFirst","serviceAccountName":"rabbitmq-cluster-server","serviceAccount":"rabbitmq-cluster-server","automountServiceAccountToken":true,"securityContext":{"runAsUser":999,"runAsGroup":999,"fsGroup":999},"schedulerName":"default-scheduler","topologySpreadConstraints":[{"maxSkew":1,"topologyKey":"topology.kubernetes.io/zone","whenUnsatisfiable":"ScheduleAnyway","labelSelector":{"matchLabels":{"app.kubernetes.io/name":"rabbitmq-cluster"}}}]}},"volumeClaimTemplates":[{"metadata":{"name":"persistence","namespace":"default","creationTimestamp":null,"labels":{"app.kubernetes.io/component":"rabbitmq","app.kubernetes.io/name":"rabbitmq-cluster","app.kubernetes.io/part-of":"rabbitmq"},"ownerReferences":[{"apiVersion":"rabbitmq.com/v1beta1","kind":"RabbitmqCluster","name":"rabbitmq-cluster","uid":"18d9928b-0d1c-47be-80ec-20960d053827","controller":true,"blockOwnerDeletion":false}]},"spec":{"accessModes":["ReadWriteOnce"],"resources":{"requests":{"storage":"10Gi"}},"volumeMode":"Filesystem"},"status":{"phase":"Pending"}}],"serviceName":"rabbitmq-cluster-nodes","podManagementPolicy":"Parallel","updateStrategy":{"type":"RollingUpdate","rollingUpdate":{"partition":0}},"revisionHistoryLimit":10},"status":{"observedGeneration":1,"replicas":1,"readyReplicas":1,"currentReplicas":1,"updatedReplicas":1,"currentRevision":"rabbitmq-cluster-server-5f8b8665fb","updateRevision":"rabbitmq-cluster-server-5f8b8665fb","collisionCount":0}}
2022/03/18 18:01:18 learn_server.go:291: [SIEVE-AFTER-READ]	Get	true	statefulset	default	rabbitmq-cluster-server	github.com/rabbitmq/cluster-operator/controllers.(*RabbitmqClusterReconciler)	NoError	{"kind":"StatefulSet","apiVersion":"apps/v1","metadata":{"name":"rabbitmq-cluster-server","namespace":"default","selfLink":"/apis/apps/v1/namespaces/default/statefulsets/rabbitmq-cluster-server","uid":"cb5c43bc-6ee7-481c-ab01-6f3acffdd3c8","resourceVersion":"948","generation":1,"creationTimestamp":"2022-03-18T18:00:38Z","labels":{"app.kubernetes.io/component":"rabbitmq","app.kubernetes.io/name":"rabbitmq-cluster","app.kubernetes.io/part-of":"rabbitmq"},"ownerReferences":[{"apiVersion":"rabbitmq.com/v1beta1","kind":"RabbitmqCluster","name":"rabbitmq-cluster","uid":"18d9928b-0d1c-47be-80ec-20960d053827","controller":true,"blockOwnerDeletion":true}],"managedFields":[{"manager":"manager","operation":"Update","apiVersion":"apps/v1","time":"2022-03-18T18:00:38Z","fieldsType":"FieldsV1","fieldsV1":{"f:metadata":{"f:labels":{".":{},"f:app.kubernetes.io/component":{},"f:app.kubernetes.io/name":{},"f:app.kubernetes.io/part-of":{}},"f:ownerReferences":{".":{},"k:{\"uid\":\"18d9928b-0d1c-47be-80ec-20960d053827\"}":{".":{},"f:apiVersion":{},"f:blockOwnerDeletion":{},"f:controller":{},"f:kind":{},"f:name":{},"f:uid":{}}}},"f:spec":{"f:podManagementPolicy":{},"f:replicas":{},"f:revisionHistoryLimit":{},"f:selector":{"f:matchLabels":{".":{},"f:app.kubernetes.io/name":{}}},"f:serviceName":{},"f:template":{"f:metadata":{"f:annotations":{".":{},"f:prometheus.io/port":{},"f:prometheus.io/scrape":{}},"f:labels":{".":{},"f:app.kubernetes.io/component":{},"f:app.kubernetes.io/name":{},"f:app.kubernetes.io/part-of":{}}},"f:spec":{"f:automountServiceAccountToken":{},"f:containers":{"k:{\"name\":\"rabbitmq\"}":{".":{},"f:env":{".":{},"k:{\"name\":\"K8S_HOSTNAME_SUFFIX\"}":{".":{},"f:name":{},"f:value":{}},"k:{\"name\":\"K8S_SERVICE_NAME\"}":{".":{},"f:name":{},"f:value":{}},"k:{\"name\":\"MY_POD_NAME\"}":{".":{},"f:name":{},"f:valueFrom":{".":{},"f:fieldRef":{".":{},"f:apiVersion":{},"f:fieldPath":{}}}},"k:{\"name\":\"MY_POD_NAMESPACE\"}":{".":{},"f:name":{},"f:valueFrom":{".":{},"f:fieldRef":{".":{},"f:apiVersion":{},"f:fieldPath":{}}}},"k:{\"name\":\"RABBITMQ_ENABLED_PLUGINS_FILE\"}":{".":{},"f:name":{},"f:value":{}},"k:{\"name\":\"RABBITMQ_NODENAME\"}":{".":{},"f:name":{},"f:value":{}},"k:{\"name\":\"RABBITMQ_USE_LONGNAME\"}":{".":{},"f:name":{},"f:value":{}}},"f:image":{},"f:imagePullPolicy":{},"f:lifecycle":{".":{},"f:preStop":{".":{},"f:exec":{".":{},"f:command":{}}}},"f:name":{},"f:ports":{".":{},"k:{\"containerPort\":4369,\"protocol\":\"TCP\"}":{".":{},"f:containerPort":{},"f:name":{},"f:protocol":{}},"k:{\"containerPort\":5672,\"protocol\":\"TCP\"}":{".":{},"f:containerPort":{},"f:name":{},"f:protocol":{}},"k:{\"containerPort\":15672,\"protocol\":\"TCP\"}":{".":{},"f:containerPort":{},"f:name":{},"f:protocol":{}},"k:{\"containerPort\":15692,\"protocol\":\"TCP\"}":{".":{},"f:containerPort":{},"f:name":{},"f:protocol":{}}},"f:readinessProbe":{".":{},"f:failureThreshold":{},"f:initialDelaySeconds":{},"f:periodSeconds":{},"f:successThreshold":{},"f:tcpSocket":{".":{},"f:port":{}},"f:timeoutSeconds":{}},"f:resources":{".":{},"f:limits":{".":{},"f:cpu":{},"f:memory":{}},"f:requests":{".":{},"f:cpu":{},"f:memory":{}}},"f:terminationMessagePath":{},"f:terminationMessagePolicy":{},"f:volumeMounts":{".":{},"k:{\"mountPath\":\"/etc/pod-info/\"}":{".":{},"f:mountPath":{},"f:name":{}},"k:{\"mountPath\":\"/etc/rabbitmq/conf.d/10-operatorDefaults.conf\"}":{".":{},"f:mountPath":{},"f:name":{},"f:subPath":{}},"k:{\"mountPath\":\"/etc/rabbitmq/conf.d/11-default_user.conf\"}":{".":{},"f:mountPath":{},"f:name":{},"f:subPath":{}},"k:{\"mountPath\":\"/etc/rabbitmq/conf.d/90-userDefinedConfiguration.conf\"}":{".":{},"f:mountPath":{},"f:name":{},"f:subPath":{}},"k:{\"mountPath\":\"/operator\"}":{".":{},"f:mountPath":{},"f:name":{}},"k:{\"mountPath\":\"/var/lib/rabbitmq/\"}":{".":{},"f:mountPath":{},"f:name":{}},"k:{\"mountPath\":\"/var/lib/rabbitmq/mnesia/\"}":{".":{},"f:mountPath":{},"f:name":{}}}}},"f:dnsPolicy":{},"f:initContainers":{".":{},"k:{\"name\":\"setup-container\"}":{".":{},"f:command":{},"f:image":{},"f:imagePullPolicy":{},"f:name":{},"f:resources":{".":{},"f:limits":{".":{},"f:cpu":{},"f:memory":{}},"f:requests":{".":{},"f:cpu":{},"f:memory":{}}},"f:securityContext":{".":{},"f:capabilities":{".":{},"f:drop":{}},"f:runAsUser":{}},"f:terminationMessagePath":{},"f:terminationMessagePolicy":{},"f:volumeMounts":{".":{},"k:{\"mountPath\":\"/operator\"}":{".":{},"f:mountPath":{},"f:name":{}},"k:{\"mountPath\":\"/tmp/default_user.conf\"}":{".":{},"f:mountPath":{},"f:name":{},"f:subPath":{}},"k:{\"mountPath\":\"/tmp/erlang-cookie-secret/\"}":{".":{},"f:mountPath":{},"f:name":{}},"k:{\"mountPath\":\"/tmp/rabbitmq-plugins/\"}":{".":{},"f:mountPath":{},"f:name":{}},"k:{\"mountPath\":\"/var/lib/rabbitmq/\"}":{".":{},"f:mountPath":{},"f:name":{}},"k:{\"mountPath\":\"/var/lib/rabbitmq/mnesia/\"}":{".":{},"f:mountPath":{},"f:name":{}}}}},"f:restartPolicy":{},"f:schedulerName":{},"f:securityContext":{".":{},"f:fsGroup":{},"f:runAsGroup":{},"f:runAsUser":{}},"f:serviceAccount":{},"f:serviceAccountName":{},"f:terminationGracePeriodSeconds":{},"f:topologySpreadConstraints":{".":{},"k:{\"topologyKey\":\"topology.kubernetes.io/zone\",\"whenUnsatisfiable\":\"ScheduleAnyway\"}":{".":{},"f:labelSelector":{".":{},"f:matchLabels":{".":{},"f:app.kubernetes.io/name":{}}},"f:maxSkew":{},"f:topologyKey":{},"f:whenUnsatisfiable":{}}},"f:volumes":{".":{},"k:{\"name\":\"erlang-cookie-secret\"}":{".":{},"f:name":{},"f:secret":{".":{},"f:defaultMode":{},"f:secretName":{}}},"k:{\"name\":\"plugins-conf\"}":{".":{},"f:configMap":{".":{},"f:defaultMode":{},"f:name":{}},"f:name":{}},"k:{\"name\":\"pod-info\"}":{".":{},"f:downwardAPI":{".":{},"f:defaultMode":{},"f:items":{}},"f:name":{}},"k:{\"name\":\"rabbitmq-confd\"}":{".":{},"f:name":{},"f:projected":{".":{},"f:defaultMode":{},"f:sources":{}}},"k:{\"name\":\"rabbitmq-erlang-cookie\"}":{".":{},"f:emptyDir":{},"f:name":{}},"k:{\"name\":\"rabbitmq-plugins\"}":{".":{},"f:emptyDir":{},"f:name":{}}}}},"f:updateStrategy":{"f:rollingUpdate":{".":{},"f:partition":{}},"f:type":{}},"f:volumeClaimTemplates":{}}}},{"manager":"kube-controller-manager","operation":"Update","apiVersion":"apps/v1","time":"2022-03-18T18:01:17Z","fieldsType":"FieldsV1","fieldsV1":{"f:status":{"f:collisionCount":{},"f:currentReplicas":{},"f:currentRevision":{},"f:observedGeneration":{},"f:readyReplicas":{},"f:replicas":{},"f:updateRevision":{},"f:updatedReplicas":{}}}}]},"spec":{"replicas":1,"selector":{"matchLabels":{"app.kubernetes.io/name":"rabbitmq-cluster"}},"template":{"metadata":{"creationTimestamp":null,"labels":{"app.kubernetes.io/component":"rabbitmq","app.kubernetes.io/name":"rabbitmq-cluster","app.kubernetes.io/part-of":"rabbitmq"},"annotations":{"prometheus.io/port":"15692","prometheus.io/scrape":"true"}},"spec":{"volumes":[{"name":"plugins-conf","configMap":{"name":"rabbitmq-cluster-plugins-conf","defaultMode":420}},{"name":"rabbitmq-confd","projected":{"sources":[{"secret":{"name":"rabbitmq-cluster-default-user","items":[{"key":"default_user.conf","path":"default_user.conf"}]}},{"configMap":{"name":"rabbitmq-cluster-server-conf","items":[{"key":"operatorDefaults.conf","path":"operatorDefaults.conf"},{"key":"userDefinedConfiguration.conf","path":"userDefinedConfiguration.conf"}]}}],"defaultMode":420}},{"name":"rabbitmq-erlang-cookie","emptyDir":{}},{"name":"erlang-cookie-secret","secret":{"secretName":"rabbitmq-cluster-erlang-cookie","defaultMode":420}},{"name":"rabbitmq-plugins","emptyDir":{}},{"name":"pod-info","downwardAPI":{"items":[{"path":"skipPreStopChecks","fieldRef":{"apiVersion":"v1","fieldPath":"metadata.labels['skipPreStopChecks']"}}],"defaultMode":420}}],"initContainers":[{"name":"setup-container","image":"rabbitmq:3.8.12-management","command":["sh","-c","cp /tmp/erlang-cookie-secret/.erlang.cookie /var/lib/rabbitmq/.erlang.cookie \u0026\u0026 chown 999:999 /var/lib/rabbitmq/.erlang.cookie \u0026\u0026 chmod 600 /var/lib/rabbitmq/.erlang.cookie ; cp /tmp/rabbitmq-plugins/enabled_plugins /operator/enabled_plugins \u0026\u0026 chown 999:999 /operator/enabled_plugins ; chown 999:999 /var/lib/rabbitmq/mnesia/ ; echo '[default]' \u003e /var/lib/rabbitmq/.rabbitmqadmin.conf \u0026\u0026 sed -e 's/default_user/username/' -e 's/default_pass/password/' /tmp/default_user.conf \u003e\u003e /var/lib/rabbitmq/.rabbitmqadmin.conf \u0026\u0026 chown 999:999 /var/lib/rabbitmq/.rabbitmqadmin.conf \u0026\u0026 chmod 600 /var/lib/rabbitmq/.rabbitmqadmin.conf"],"resources":{"limits":{"cpu":"100m","memory":"500Mi"},"requests":{"cpu":"100m","memory":"500Mi"}},"volumeMounts":[{"name":"plugins-conf","mountPath":"/tmp/rabbitmq-plugins/"},{"name":"rabbitmq-erlang-cookie","mountPath":"/var/lib/rabbitmq/"},{"name":"erlang-cookie-secret","mountPath":"/tmp/erlang-cookie-secret/"},{"name":"rabbitmq-plugins","mountPath":"/operator"},{"name":"persistence","mountPath":"/var/lib/rabbitmq/mnesia/"},{"name":"rabbitmq-confd","mountPath":"/tmp/default_user.conf","subPath":"default_user.conf"}],"terminationMessagePath":"/dev/termination-log","terminationMessagePolicy":"File","imagePullPolicy":"IfNotPresent","securityContext":{"capabilities":{"drop":["FSETID","KILL","SETGID","SETUID","SETPCAP","NET_BIND_SERVICE","NET_RAW","SYS_CHROOT","MKNOD","AUDIT_WRITE","SETFCAP"]},"runAsUser":0}}],"containers":[{"name":"rabbitmq","image":"rabbitmq:3.8.12-management","ports":[{"name":"epmd","containerPort":4369,"protocol":"TCP"},{"name":"amqp","containerPort":5672,"protocol":"TCP"},{"name":"management","containerPort":15672,"protocol":"TCP"},{"name":"prometheus","containerPort":15692,"protocol":"TCP"}],"env":[{"name":"MY_POD_NAME","valueFrom":{"fieldRef":{"apiVersion":"v1","fieldPath":"metadata.name"}}},{"name":"MY_POD_NAMESPACE","valueFrom":{"fieldRef":{"apiVersion":"v1","fieldPath":"metadata.namespace"}}},{"name":"RABBITMQ_ENABLED_PLUGINS_FILE","value":"/operator/enabled_plugins"},{"name":"K8S_SERVICE_NAME","value":"rabbitmq-cluster-nodes"},{"name":"RABBITMQ_USE_LONGNAME","value":"true"},{"name":"RABBITMQ_NODENAME","value":"rabbit@$(MY_POD_NAME).$(K8S_SERVICE_NAME).$(MY_POD_NAMESPACE)"},{"name":"K8S_HOSTNAME_SUFFIX","value":".$(K8S_SERVICE_NAME).$(MY_POD_NAMESPACE)"}],"resources":{"limits":{"cpu":"2","memory":"2Gi"},"requests":{"cpu":"1","memory":"2Gi"}},"volumeMounts":[{"name":"rabbitmq-erlang-cookie","mountPath":"/var/lib/rabbitmq/"},{"name":"persistence","mountPath":"/var/lib/rabbitmq/mnesia/"},{"name":"rabbitmq-plugins","mountPath":"/operator"},{"name":"rabbitmq-confd","mountPath":"/etc/rabbitmq/conf.d/10-operatorDefaults.conf","subPath":"operatorDefaults.conf"},{"name":"rabbitmq-confd","mountPath":"/etc/rabbitmq/conf.d/11-default_user.conf","subPath":"default_user.conf"},{"name":"rabbitmq-confd","mountPath":"/etc/rabbitmq/conf.d/90-userDefinedConfiguration.conf","subPath":"userDefinedConfiguration.conf"},{"name":"pod-info","mountPath":"/etc/pod-info/"}],"readinessProbe":{"tcpSocket":{"port":"amqp"},"initialDelaySeconds":10,"timeoutSeconds":5,"periodSeconds":10,"successThreshold":1,"failureThreshold":3},"lifecycle":{"preStop":{"exec":{"command":["/bin/bash","-c","if [ ! -z \"$(cat /etc/pod-info/skipPreStopChecks)\" ]; then exit 0; fi; rabbitmq-upgrade await_online_quorum_plus_one -t 604800; rabbitmq-upgrade await_online_synchronized_mirror -t 604800; rabbitmq-upgrade drain -t 604800"]}}},"terminationMessagePath":"/dev/termination-log","terminationMessagePolicy":"File","imagePullPolicy":"IfNotPresent"}],"restartPolicy":"Always","terminationGracePeriodSeconds":604800,"dnsPolicy":"ClusterFirst","serviceAccountName":"rabbitmq-cluster-server","serviceAccount":"rabbitmq-cluster-server","automountServiceAccountToken":true,"securityContext":{"runAsUser":999,"runAsGroup":999,"fsGroup":999},"schedulerName":"default-scheduler","topologySpreadConstraints":[{"maxSkew":1,"topologyKey":"topology.kubernetes.io/zone","whenUnsatisfiable":"ScheduleAnyway","labelSelector":{"matchLabels":{"app.kubernetes.io/name":"rabbitmq-cluster"}}}]}},"volumeClaimTemplates":[{"metadata":{"name":"persistence","namespace":"default","creationTimestamp":null,"labels":{"app.kubernetes.io/component":"rabbitmq","app.kubernetes.io/name":"rabbitmq-cluster","app.kubernetes.io/part-of":"rabbitmq"},"ownerReferences":[{"apiVersion":"rabbitmq.com/v1beta1","kind":"RabbitmqCluster","name":"rabbitmq-cluster","uid":"18d9928b-0d1c-47be-80ec-20960d053827","controller":true,"blockOwnerDeletion":false}]},"spec":{"accessModes":["ReadWriteOnce"],"resources":{"requests":{"storage":"10Gi"}},"volumeMode":"Filesystem"},"status":{"phase":"Pending"}}],"serviceName":"rabbitmq-cluster-nodes","podManagementPolicy":"Parallel","updateStrategy":{"type":"RollingUpdate","rollingUpdate":{"partition":0}},"revisionHistoryLimit":10},"status":{"observedGeneration":1,"replicas":1,"readyReplicas":1,"currentReplicas":1,"updatedReplicas":1,"currentRevision":"rabbitmq-cluster-server-5f8b8665fb","updateRevision":"rabbitmq-cluster-server-5f8b8665fb","collisionCount":0}}
2022/03/18 18:01:18 learn_server.go:256: [SIEVE-BEFORE-WRITE]	35
2022/03/18 18:01:18 learn_server.go:263: [SIEVE-AFTER-WRITE]	35	Update	statefulset	github.com/rabbitmq/cluster-operator/controllers.(*RabbitmqClusterReconciler)	NoError	{"metadata":{"name":"rabbitmq-cluster-server","namespace":"default","selfLink":"/apis/apps/v1/namespaces/default/statefulsets/rabbitmq-cluster-server","uid":"cb5c43bc-6ee7-481c-ab01-6f3acffdd3c8","resourceVersion":"948","generation":1,"creationTimestamp":"2022-03-18T18:00:38Z","labels":{"app.kubernetes.io/component":"rabbitmq","app.kubernetes.io/name":"rabbitmq-cluster","app.kubernetes.io/part-of":"rabbitmq"},"ownerReferences":[{"apiVersion":"rabbitmq.com/v1beta1","kind":"RabbitmqCluster","name":"rabbitmq-cluster","uid":"18d9928b-0d1c-47be-80ec-20960d053827","controller":true,"blockOwnerDeletion":true}],"managedFields":[{"manager":"manager","operation":"Update","apiVersion":"apps/v1","time":"2022-03-18T18:00:38Z","fieldsType":"FieldsV1","fieldsV1":{"f:metadata":{"f:labels":{".":{},"f:app.kubernetes.io/component":{},"f:app.kubernetes.io/name":{},"f:app.kubernetes.io/part-of":{}},"f:ownerReferences":{".":{},"k:{\"uid\":\"18d9928b-0d1c-47be-80ec-20960d053827\"}":{".":{},"f:apiVersion":{},"f:blockOwnerDeletion":{},"f:controller":{},"f:kind":{},"f:name":{},"f:uid":{}}}},"f:spec":{"f:podManagementPolicy":{},"f:replicas":{},"f:revisionHistoryLimit":{},"f:selector":{"f:matchLabels":{".":{},"f:app.kubernetes.io/name":{}}},"f:serviceName":{},"f:template":{"f:metadata":{"f:annotations":{".":{},"f:prometheus.io/port":{},"f:prometheus.io/scrape":{}},"f:labels":{".":{},"f:app.kubernetes.io/component":{},"f:app.kubernetes.io/name":{},"f:app.kubernetes.io/part-of":{}}},"f:spec":{"f:automountServiceAccountToken":{},"f:containers":{"k:{\"name\":\"rabbitmq\"}":{".":{},"f:env":{".":{},"k:{\"name\":\"K8S_HOSTNAME_SUFFIX\"}":{".":{},"f:name":{},"f:value":{}},"k:{\"name\":\"K8S_SERVICE_NAME\"}":{".":{},"f:name":{},"f:value":{}},"k:{\"name\":\"MY_POD_NAME\"}":{".":{},"f:name":{},"f:valueFrom":{".":{},"f:fieldRef":{".":{},"f:apiVersion":{},"f:fieldPath":{}}}},"k:{\"name\":\"MY_POD_NAMESPACE\"}":{".":{},"f:name":{},"f:valueFrom":{".":{},"f:fieldRef":{".":{},"f:apiVersion":{},"f:fieldPath":{}}}},"k:{\"name\":\"RABBITMQ_ENABLED_PLUGINS_FILE\"}":{".":{},"f:name":{},"f:value":{}},"k:{\"name\":\"RABBITMQ_NODENAME\"}":{".":{},"f:name":{},"f:value":{}},"k:{\"name\":\"RABBITMQ_USE_LONGNAME\"}":{".":{},"f:name":{},"f:value":{}}},"f:image":{},"f:imagePullPolicy":{},"f:lifecycle":{".":{},"f:preStop":{".":{},"f:exec":{".":{},"f:command":{}}}},"f:name":{},"f:ports":{".":{},"k:{\"containerPort\":4369,\"protocol\":\"TCP\"}":{".":{},"f:containerPort":{},"f:name":{},"f:protocol":{}},"k:{\"containerPort\":5672,\"protocol\":\"TCP\"}":{".":{},"f:containerPort":{},"f:name":{},"f:protocol":{}},"k:{\"containerPort\":15672,\"protocol\":\"TCP\"}":{".":{},"f:containerPort":{},"f:name":{},"f:protocol":{}},"k:{\"containerPort\":15692,\"protocol\":\"TCP\"}":{".":{},"f:containerPort":{},"f:name":{},"f:protocol":{}}},"f:readinessProbe":{".":{},"f:failureThreshold":{},"f:initialDelaySeconds":{},"f:periodSeconds":{},"f:successThreshold":{},"f:tcpSocket":{".":{},"f:port":{}},"f:timeoutSeconds":{}},"f:resources":{".":{},"f:limits":{".":{},"f:cpu":{},"f:memory":{}},"f:requests":{".":{},"f:cpu":{},"f:memory":{}}},"f:terminationMessagePath":{},"f:terminationMessagePolicy":{},"f:volumeMounts":{".":{},"k:{\"mountPath\":\"/etc/pod-info/\"}":{".":{},"f:mountPath":{},"f:name":{}},"k:{\"mountPath\":\"/etc/rabbitmq/conf.d/10-operatorDefaults.conf\"}":{".":{},"f:mountPath":{},"f:name":{},"f:subPath":{}},"k:{\"mountPath\":\"/etc/rabbitmq/conf.d/11-default_user.conf\"}":{".":{},"f:mountPath":{},"f:name":{},"f:subPath":{}},"k:{\"mountPath\":\"/etc/rabbitmq/conf.d/90-userDefinedConfiguration.conf\"}":{".":{},"f:mountPath":{},"f:name":{},"f:subPath":{}},"k:{\"mountPath\":\"/operator\"}":{".":{},"f:mountPath":{},"f:name":{}},"k:{\"mountPath\":\"/var/lib/rabbitmq/\"}":{".":{},"f:mountPath":{},"f:name":{}},"k:{\"mountPath\":\"/var/lib/rabbitmq/mnesia/\"}":{".":{},"f:mountPath":{},"f:name":{}}}}},"f:dnsPolicy":{},"f:initContainers":{".":{},"k:{\"name\":\"setup-container\"}":{".":{},"f:command":{},"f:image":{},"f:imagePullPolicy":{},"f:name":{},"f:resources":{".":{},"f:limits":{".":{},"f:cpu":{},"f:memory":{}},"f:requests":{".":{},"f:cpu":{},"f:memory":{}}},"f:securityContext":{".":{},"f:capabilities":{".":{},"f:drop":{}},"f:runAsUser":{}},"f:terminationMessagePath":{},"f:terminationMessagePolicy":{},"f:volumeMounts":{".":{},"k:{\"mountPath\":\"/operator\"}":{".":{},"f:mountPath":{},"f:name":{}},"k:{\"mountPath\":\"/tmp/default_user.conf\"}":{".":{},"f:mountPath":{},"f:name":{},"f:subPath":{}},"k:{\"mountPath\":\"/tmp/erlang-cookie-secret/\"}":{".":{},"f:mountPath":{},"f:name":{}},"k:{\"mountPath\":\"/tmp/rabbitmq-plugins/\"}":{".":{},"f:mountPath":{},"f:name":{}},"k:{\"mountPath\":\"/var/lib/rabbitmq/\"}":{".":{},"f:mountPath":{},"f:name":{}},"k:{\"mountPath\":\"/var/lib/rabbitmq/mnesia/\"}":{".":{},"f:mountPath":{},"f:name":{}}}}},"f:restartPolicy":{},"f:schedulerName":{},"f:securityContext":{".":{},"f:fsGroup":{},"f:runAsGroup":{},"f:runAsUser":{}},"f:serviceAccount":{},"f:serviceAccountName":{},"f:terminationGracePeriodSeconds":{},"f:topologySpreadConstraints":{".":{},"k:{\"topologyKey\":\"topology.kubernetes.io/zone\",\"whenUnsatisfiable\":\"ScheduleAnyway\"}":{".":{},"f:labelSelector":{".":{},"f:matchLabels":{".":{},"f:app.kubernetes.io/name":{}}},"f:maxSkew":{},"f:topologyKey":{},"f:whenUnsatisfiable":{}}},"f:volumes":{".":{},"k:{\"name\":\"erlang-cookie-secret\"}":{".":{},"f:name":{},"f:secret":{".":{},"f:defaultMode":{},"f:secretName":{}}},"k:{\"name\":\"plugins-conf\"}":{".":{},"f:configMap":{".":{},"f:defaultMode":{},"f:name":{}},"f:name":{}},"k:{\"name\":\"pod-info\"}":{".":{},"f:downwardAPI":{".":{},"f:defaultMode":{},"f:items":{}},"f:name":{}},"k:{\"name\":\"rabbitmq-confd\"}":{".":{},"f:name":{},"f:projected":{".":{},"f:defaultMode":{},"f:sources":{}}},"k:{\"name\":\"rabbitmq-erlang-cookie\"}":{".":{},"f:emptyDir":{},"f:name":{}},"k:{\"name\":\"rabbitmq-plugins\"}":{".":{},"f:emptyDir":{},"f:name":{}}}}},"f:updateStrategy":{"f:rollingUpdate":{".":{},"f:partition":{}},"f:type":{}},"f:volumeClaimTemplates":{}}}},{"manager":"kube-controller-manager","operation":"Update","apiVersion":"apps/v1","time":"2022-03-18T18:01:17Z","fieldsType":"FieldsV1","fieldsV1":{"f:status":{"f:collisionCount":{},"f:currentReplicas":{},"f:currentRevision":{},"f:observedGeneration":{},"f:readyReplicas":{},"f:replicas":{},"f:updateRevision":{},"f:updatedReplicas":{}}}}]},"spec":{"replicas":1,"selector":{"matchLabels":{"app.kubernetes.io/name":"rabbitmq-cluster"}},"template":{"metadata":{"creationTimestamp":null,"labels":{"app.kubernetes.io/component":"rabbitmq","app.kubernetes.io/name":"rabbitmq-cluster","app.kubernetes.io/part-of":"rabbitmq"},"annotations":{"prometheus.io/port":"15692","prometheus.io/scrape":"true"}},"spec":{"volumes":[{"name":"plugins-conf","configMap":{"name":"rabbitmq-cluster-plugins-conf","defaultMode":420}},{"name":"rabbitmq-confd","projected":{"sources":[{"secret":{"name":"rabbitmq-cluster-default-user","items":[{"key":"default_user.conf","path":"default_user.conf"}]}},{"configMap":{"name":"rabbitmq-cluster-server-conf","items":[{"key":"operatorDefaults.conf","path":"operatorDefaults.conf"},{"key":"userDefinedConfiguration.conf","path":"userDefinedConfiguration.conf"}]}}],"defaultMode":420}},{"name":"rabbitmq-erlang-cookie","emptyDir":{}},{"name":"erlang-cookie-secret","secret":{"secretName":"rabbitmq-cluster-erlang-cookie","defaultMode":420}},{"name":"rabbitmq-plugins","emptyDir":{}},{"name":"pod-info","downwardAPI":{"items":[{"path":"skipPreStopChecks","fieldRef":{"apiVersion":"v1","fieldPath":"metadata.labels['skipPreStopChecks']"}}],"defaultMode":420}}],"initContainers":[{"name":"setup-container","image":"rabbitmq:3.8.12-management","command":["sh","-c","cp /tmp/erlang-cookie-secret/.erlang.cookie /var/lib/rabbitmq/.erlang.cookie \u0026\u0026 chown 999:999 /var/lib/rabbitmq/.erlang.cookie \u0026\u0026 chmod 600 /var/lib/rabbitmq/.erlang.cookie ; cp /tmp/rabbitmq-plugins/enabled_plugins /operator/enabled_plugins \u0026\u0026 chown 999:999 /operator/enabled_plugins ; chown 999:999 /var/lib/rabbitmq/mnesia/ ; echo '[default]' \u003e /var/lib/rabbitmq/.rabbitmqadmin.conf \u0026\u0026 sed -e 's/default_user/username/' -e 's/default_pass/password/' /tmp/default_user.conf \u003e\u003e /var/lib/rabbitmq/.rabbitmqadmin.conf \u0026\u0026 chown 999:999 /var/lib/rabbitmq/.rabbitmqadmin.conf \u0026\u0026 chmod 600 /var/lib/rabbitmq/.rabbitmqadmin.conf"],"resources":{"limits":{"cpu":"100m","memory":"500Mi"},"requests":{"cpu":"100m","memory":"500Mi"}},"volumeMounts":[{"name":"plugins-conf","mountPath":"/tmp/rabbitmq-plugins/"},{"name":"rabbitmq-erlang-cookie","mountPath":"/var/lib/rabbitmq/"},{"name":"erlang-cookie-secret","mountPath":"/tmp/erlang-cookie-secret/"},{"name":"rabbitmq-plugins","mountPath":"/operator"},{"name":"persistence","mountPath":"/var/lib/rabbitmq/mnesia/"},{"name":"rabbitmq-confd","mountPath":"/tmp/default_user.conf","subPath":"default_user.conf"}],"terminationMessagePath":"/dev/termination-log","terminationMessagePolicy":"File","imagePullPolicy":"IfNotPresent","securityContext":{"capabilities":{"drop":["FSETID","KILL","SETGID","SETUID","SETPCAP","NET_BIND_SERVICE","NET_RAW","SYS_CHROOT","MKNOD","AUDIT_WRITE","SETFCAP"]},"runAsUser":0}}],"containers":[{"name":"rabbitmq","image":"rabbitmq:3.8.12-management","ports":[{"name":"epmd","containerPort":4369,"protocol":"TCP"},{"name":"amqp","containerPort":5672,"protocol":"TCP"},{"name":"management","containerPort":15672,"protocol":"TCP"},{"name":"prometheus","containerPort":15692,"protocol":"TCP"}],"env":[{"name":"MY_POD_NAME","valueFrom":{"fieldRef":{"apiVersion":"v1","fieldPath":"metadata.name"}}},{"name":"MY_POD_NAMESPACE","valueFrom":{"fieldRef":{"apiVersion":"v1","fieldPath":"metadata.namespace"}}},{"name":"RABBITMQ_ENABLED_PLUGINS_FILE","value":"/operator/enabled_plugins"},{"name":"K8S_SERVICE_NAME","value":"rabbitmq-cluster-nodes"},{"name":"RABBITMQ_USE_LONGNAME","value":"true"},{"name":"RABBITMQ_NODENAME","value":"rabbit@$(MY_POD_NAME).$(K8S_SERVICE_NAME).$(MY_POD_NAMESPACE)"},{"name":"K8S_HOSTNAME_SUFFIX","value":".$(K8S_SERVICE_NAME).$(MY_POD_NAMESPACE)"}],"resources":{"limits":{"cpu":"2","memory":"2Gi"},"requests":{"cpu":"1","memory":"2Gi"}},"volumeMounts":[{"name":"rabbitmq-erlang-cookie","mountPath":"/var/lib/rabbitmq/"},{"name":"persistence","mountPath":"/var/lib/rabbitmq/mnesia/"},{"name":"rabbitmq-plugins","mountPath":"/operator"},{"name":"rabbitmq-confd","mountPath":"/etc/rabbitmq/conf.d/10-operatorDefaults.conf","subPath":"operatorDefaults.conf"},{"name":"rabbitmq-confd","mountPath":"/etc/rabbitmq/conf.d/11-default_user.conf","subPath":"default_user.conf"},{"name":"rabbitmq-confd","mountPath":"/etc/rabbitmq/conf.d/90-userDefinedConfiguration.conf","subPath":"userDefinedConfiguration.conf"},{"name":"pod-info","mountPath":"/etc/pod-info/"}],"readinessProbe":{"tcpSocket":{"port":"amqp"},"initialDelaySeconds":10,"timeoutSeconds":5,"periodSeconds":10,"successThreshold":1,"failureThreshold":3},"lifecycle":{"preStop":{"exec":{"command":["/bin/bash","-c","if [ ! -z \"$(cat /etc/pod-info/skipPreStopChecks)\" ]; then exit 0; fi; rabbitmq-upgrade await_online_quorum_plus_one -t 604800; rabbitmq-upgrade await_online_synchronized_mirror -t 604800; rabbitmq-upgrade drain -t 604800"]}}},"terminationMessagePath":"/dev/termination-log","terminationMessagePolicy":"File","imagePullPolicy":"IfNotPresent"}],"restartPolicy":"Always","terminationGracePeriodSeconds":604800,"dnsPolicy":"ClusterFirst","serviceAccountName":"rabbitmq-cluster-server","serviceAccount":"rabbitmq-cluster-server","automountServiceAccountToken":true,"securityContext":{"runAsUser":999,"runAsGroup":999,"fsGroup":999},"schedulerName":"default-scheduler","topologySpreadConstraints":[{"maxSkew":1,"topologyKey":"topology.kubernetes.io/zone","whenUnsatisfiable":"ScheduleAnyway","labelSelector":{"matchLabels":{"app.kubernetes.io/name":"rabbitmq-cluster"}}}]}},"volumeClaimTemplates":[{"metadata":{"name":"persistence","namespace":"default","creationTimestamp":null,"labels":{"app.kubernetes.io/component":"rabbitmq","app.kubernetes.io/name":"rabbitmq-cluster","app.kubernetes.io/part-of":"rabbitmq"},"ownerReferences":[{"apiVersion":"rabbitmq.com/v1beta1","kind":"RabbitmqCluster","name":"rabbitmq-cluster","uid":"18d9928b-0d1c-47be-80ec-20960d053827","controller":true,"blockOwnerDeletion":false}]},"spec":{"accessModes":["ReadWriteOnce"],"resources":{"requests":{"storage":"10Gi"}},"volumeMode":"Filesystem"},"status":{"phase":"Pending"}}],"serviceName":"rabbitmq-cluster-nodes","podManagementPolicy":"Parallel","updateStrategy":{"type":"RollingUpdate","rollingUpdate":{"partition":0}},"revisionHistoryLimit":10},"status":{"observedGeneration":1,"replicas":1,"readyReplicas":1,"currentReplicas":1,"updatedReplicas":1,"currentRevision":"rabbitmq-cluster-server-5f8b8665fb","updateRevision":"rabbitmq-cluster-server-5f8b8665fb","collisionCount":0}}
2022/03/18 18:01:18 learn_server.go:291: [SIEVE-AFTER-READ]	Get	true	configmap	default	rabbitmq-cluster-server-conf	github.com/rabbitmq/cluster-operator/controllers.(*RabbitmqClusterReconciler)	NoError	{"kind":"ConfigMap","apiVersion":"v1","metadata":{"name":"rabbitmq-cluster-server-conf","namespace":"default","selfLink":"/api/v1/namespaces/default/configmaps/rabbitmq-cluster-server-conf","uid":"22474f2b-8454-44b7-8079-8990223969cc","resourceVersion":"714","creationTimestamp":"2022-03-18T18:00:38Z","labels":{"app.kubernetes.io/component":"rabbitmq","app.kubernetes.io/name":"rabbitmq-cluster","app.kubernetes.io/part-of":"rabbitmq"},"ownerReferences":[{"apiVersion":"rabbitmq.com/v1beta1","kind":"RabbitmqCluster","name":"rabbitmq-cluster","uid":"18d9928b-0d1c-47be-80ec-20960d053827","controller":true,"blockOwnerDeletion":true}],"managedFields":[{"manager":"manager","operation":"Update","apiVersion":"v1","time":"2022-03-18T18:00:38Z","fieldsType":"FieldsV1","fieldsV1":{"f:data":{".":{},"f:operatorDefaults.conf":{},"f:userDefinedConfiguration.conf":{}},"f:metadata":{"f:labels":{".":{},"f:app.kubernetes.io/component":{},"f:app.kubernetes.io/name":{},"f:app.kubernetes.io/part-of":{}},"f:ownerReferences":{".":{},"k:{\"uid\":\"18d9928b-0d1c-47be-80ec-20960d053827\"}":{".":{},"f:apiVersion":{},"f:blockOwnerDeletion":{},"f:controller":{},"f:kind":{},"f:name":{},"f:uid":{}}}}}}]},"data":{"operatorDefaults.conf":"cluster_formation.peer_discovery_backend             = rabbit_peer_discovery_k8s\ncluster_formation.k8s.host                           = kubernetes.default\ncluster_formation.k8s.address_type                   = hostname\ncluster_partition_handling                           = pause_minority\nqueue_master_locator                                 = min-masters\ndisk_free_limit.absolute                             = 2GB\ncluster_formation.randomized_startup_delay_range.min = 5\ncluster_formation.randomized_startup_delay_range.max = 30\ncluster_name                                         = rabbitmq-cluster\n","userDefinedConfiguration.conf":"total_memory_available_override_value = 1717986919\n"}}
2022/03/18 18:01:18 learn_server.go:256: [SIEVE-BEFORE-WRITE]	36
2022/03/18 18:01:18 learn_server.go:263: [SIEVE-AFTER-WRITE]	36	StatusUpdate	rabbitmqcluster	github.com/rabbitmq/cluster-operator/controllers.(*RabbitmqClusterReconciler)	NoError	{"metadata":{"name":"rabbitmq-cluster","namespace":"default","selfLink":"/apis/rabbitmq.com/v1beta1/namespaces/default/rabbitmqclusters/rabbitmq-cluster/status","uid":"18d9928b-0d1c-47be-80ec-20960d053827","resourceVersion":"949","generation":2,"creationTimestamp":"2022-03-18T18:00:38Z","annotations":{"kubectl.kubernetes.io/last-applied-configuration":"{\"apiVersion\":\"rabbitmq.com/v1beta1\",\"kind\":\"RabbitmqCluster\",\"metadata\":{\"annotations\":{},\"name\":\"rabbitmq-cluster\",\"namespace\":\"default\"},\"spec\":{\"persistence\":{\"storage\":\"10Gi\"},\"replicas\":1}}\n"},"finalizers":["deletion.finalizers.rabbitmqclusters.rabbitmq.com"],"managedFields":[{"manager":"kubectl-client-side-apply","operation":"Update","apiVersion":"rabbitmq.com/v1beta1","time":"2022-03-18T18:00:38Z","fieldsType":"FieldsV1","fieldsV1":{"f:metadata":{"f:annotations":{".":{},"f:kubectl.kubernetes.io/last-applied-configuration":{}}},"f:spec":{".":{},"f:image":{},"f:persistence":{".":{},"f:storage":{}},"f:replicas":{},"f:resources":{".":{},"f:limits":{".":{},"f:memory":{}},"f:requests":{".":{},"f:memory":{}}},"f:service":{".":{},"f:type":{}},"f:terminationGracePeriodSeconds":{}}}},{"manager":"manager","operation":"Update","apiVersion":"rabbitmq.com/v1beta1","time":"2022-03-18T18:01:18Z","fieldsType":"FieldsV1","fieldsV1":{"f:metadata":{"f:finalizers":{}},"f:spec":{"f:override":{},"f:rabbitmq":{},"f:resources":{"f:limits":{"f:cpu":{}},"f:requests":{"f:cpu":{}}},"f:tls":{}},"f:status":{".":{},"f:conditions":{},"f:defaultUser":{".":{},"f:secretReference":{".":{},"f:keys":{".":{},"f:password":{},"f:username":{}},"f:name":{},"f:namespace":{}},"f:serviceReference":{".":{},"f:name":{},"f:namespace":{}}}}}}]},"spec":{"replicas":1,"image":"rabbitmq:3.8.12-management","service":{"type":"ClusterIP"},"persistence":{"storage":"10Gi"},"resources":{"limits":{"cpu":"2","memory":"2Gi"},"requests":{"cpu":"1","memory":"2Gi"}},"rabbitmq":{},"tls":{},"override":{},"terminationGracePeriodSeconds":604800},"status":{"conditions":[{"type":"AllReplicasReady","status":"True","lastTransitionTime":"2022-03-18T18:01:17Z","reason":"AllPodsAreReady"},{"type":"ClusterAvailable","status":"True","lastTransitionTime":"2022-03-18T18:01:17Z","reason":"AtLeastOneEndpointAvailable"},{"type":"NoWarnings","status":"True","lastTransitionTime":"2022-03-18T18:00:38Z","reason":"NoWarnings"},{"type":"ReconcileSuccess","status":"True","lastTransitionTime":"2022-03-18T18:01:18Z","reason":"Success","message":"Finish reconciling"}],"defaultUser":{"secretReference":{"name":"rabbitmq-cluster-default-user","namespace":"default","keys":{"password":"password","username":"username"}},"serviceReference":{"name":"rabbitmq-cluster","namespace":"default"}},"binding":{"name":"rabbitmq-cluster-default-user"}}}
2022/03/18 18:01:18 learn_server.go:291: [SIEVE-AFTER-READ]	Get	true	statefulset	default	rabbitmq-cluster-server	github.com/rabbitmq/cluster-operator/controllers.(*RabbitmqClusterReconciler)	NoError	{"kind":"StatefulSet","apiVersion":"apps/v1","metadata":{"name":"rabbitmq-cluster-server","namespace":"default","selfLink":"/apis/apps/v1/namespaces/default/statefulsets/rabbitmq-cluster-server","uid":"cb5c43bc-6ee7-481c-ab01-6f3acffdd3c8","resourceVersion":"948","generation":1,"creationTimestamp":"2022-03-18T18:00:38Z","labels":{"app.kubernetes.io/component":"rabbitmq","app.kubernetes.io/name":"rabbitmq-cluster","app.kubernetes.io/part-of":"rabbitmq"},"ownerReferences":[{"apiVersion":"rabbitmq.com/v1beta1","kind":"RabbitmqCluster","name":"rabbitmq-cluster","uid":"18d9928b-0d1c-47be-80ec-20960d053827","controller":true,"blockOwnerDeletion":true}],"managedFields":[{"manager":"manager","operation":"Update","apiVersion":"apps/v1","time":"2022-03-18T18:00:38Z","fieldsType":"FieldsV1","fieldsV1":{"f:metadata":{"f:labels":{".":{},"f:app.kubernetes.io/component":{},"f:app.kubernetes.io/name":{},"f:app.kubernetes.io/part-of":{}},"f:ownerReferences":{".":{},"k:{\"uid\":\"18d9928b-0d1c-47be-80ec-20960d053827\"}":{".":{},"f:apiVersion":{},"f:blockOwnerDeletion":{},"f:controller":{},"f:kind":{},"f:name":{},"f:uid":{}}}},"f:spec":{"f:podManagementPolicy":{},"f:replicas":{},"f:revisionHistoryLimit":{},"f:selector":{"f:matchLabels":{".":{},"f:app.kubernetes.io/name":{}}},"f:serviceName":{},"f:template":{"f:metadata":{"f:annotations":{".":{},"f:prometheus.io/port":{},"f:prometheus.io/scrape":{}},"f:labels":{".":{},"f:app.kubernetes.io/component":{},"f:app.kubernetes.io/name":{},"f:app.kubernetes.io/part-of":{}}},"f:spec":{"f:automountServiceAccountToken":{},"f:containers":{"k:{\"name\":\"rabbitmq\"}":{".":{},"f:env":{".":{},"k:{\"name\":\"K8S_HOSTNAME_SUFFIX\"}":{".":{},"f:name":{},"f:value":{}},"k:{\"name\":\"K8S_SERVICE_NAME\"}":{".":{},"f:name":{},"f:value":{}},"k:{\"name\":\"MY_POD_NAME\"}":{".":{},"f:name":{},"f:valueFrom":{".":{},"f:fieldRef":{".":{},"f:apiVersion":{},"f:fieldPath":{}}}},"k:{\"name\":\"MY_POD_NAMESPACE\"}":{".":{},"f:name":{},"f:valueFrom":{".":{},"f:fieldRef":{".":{},"f:apiVersion":{},"f:fieldPath":{}}}},"k:{\"name\":\"RABBITMQ_ENABLED_PLUGINS_FILE\"}":{".":{},"f:name":{},"f:value":{}},"k:{\"name\":\"RABBITMQ_NODENAME\"}":{".":{},"f:name":{},"f:value":{}},"k:{\"name\":\"RABBITMQ_USE_LONGNAME\"}":{".":{},"f:name":{},"f:value":{}}},"f:image":{},"f:imagePullPolicy":{},"f:lifecycle":{".":{},"f:preStop":{".":{},"f:exec":{".":{},"f:command":{}}}},"f:name":{},"f:ports":{".":{},"k:{\"containerPort\":4369,\"protocol\":\"TCP\"}":{".":{},"f:containerPort":{},"f:name":{},"f:protocol":{}},"k:{\"containerPort\":5672,\"protocol\":\"TCP\"}":{".":{},"f:containerPort":{},"f:name":{},"f:protocol":{}},"k:{\"containerPort\":15672,\"protocol\":\"TCP\"}":{".":{},"f:containerPort":{},"f:name":{},"f:protocol":{}},"k:{\"containerPort\":15692,\"protocol\":\"TCP\"}":{".":{},"f:containerPort":{},"f:name":{},"f:protocol":{}}},"f:readinessProbe":{".":{},"f:failureThreshold":{},"f:initialDelaySeconds":{},"f:periodSeconds":{},"f:successThreshold":{},"f:tcpSocket":{".":{},"f:port":{}},"f:timeoutSeconds":{}},"f:resources":{".":{},"f:limits":{".":{},"f:cpu":{},"f:memory":{}},"f:requests":{".":{},"f:cpu":{},"f:memory":{}}},"f:terminationMessagePath":{},"f:terminationMessagePolicy":{},"f:volumeMounts":{".":{},"k:{\"mountPath\":\"/etc/pod-info/\"}":{".":{},"f:mountPath":{},"f:name":{}},"k:{\"mountPath\":\"/etc/rabbitmq/conf.d/10-operatorDefaults.conf\"}":{".":{},"f:mountPath":{},"f:name":{},"f:subPath":{}},"k:{\"mountPath\":\"/etc/rabbitmq/conf.d/11-default_user.conf\"}":{".":{},"f:mountPath":{},"f:name":{},"f:subPath":{}},"k:{\"mountPath\":\"/etc/rabbitmq/conf.d/90-userDefinedConfiguration.conf\"}":{".":{},"f:mountPath":{},"f:name":{},"f:subPath":{}},"k:{\"mountPath\":\"/operator\"}":{".":{},"f:mountPath":{},"f:name":{}},"k:{\"mountPath\":\"/var/lib/rabbitmq/\"}":{".":{},"f:mountPath":{},"f:name":{}},"k:{\"mountPath\":\"/var/lib/rabbitmq/mnesia/\"}":{".":{},"f:mountPath":{},"f:name":{}}}}},"f:dnsPolicy":{},"f:initContainers":{".":{},"k:{\"name\":\"setup-container\"}":{".":{},"f:command":{},"f:image":{},"f:imagePullPolicy":{},"f:name":{},"f:resources":{".":{},"f:limits":{".":{},"f:cpu":{},"f:memory":{}},"f:requests":{".":{},"f:cpu":{},"f:memory":{}}},"f:securityContext":{".":{},"f:capabilities":{".":{},"f:drop":{}},"f:runAsUser":{}},"f:terminationMessagePath":{},"f:terminationMessagePolicy":{},"f:volumeMounts":{".":{},"k:{\"mountPath\":\"/operator\"}":{".":{},"f:mountPath":{},"f:name":{}},"k:{\"mountPath\":\"/tmp/default_user.conf\"}":{".":{},"f:mountPath":{},"f:name":{},"f:subPath":{}},"k:{\"mountPath\":\"/tmp/erlang-cookie-secret/\"}":{".":{},"f:mountPath":{},"f:name":{}},"k:{\"mountPath\":\"/tmp/rabbitmq-plugins/\"}":{".":{},"f:mountPath":{},"f:name":{}},"k:{\"mountPath\":\"/var/lib/rabbitmq/\"}":{".":{},"f:mountPath":{},"f:name":{}},"k:{\"mountPath\":\"/var/lib/rabbitmq/mnesia/\"}":{".":{},"f:mountPath":{},"f:name":{}}}}},"f:restartPolicy":{},"f:schedulerName":{},"f:securityContext":{".":{},"f:fsGroup":{},"f:runAsGroup":{},"f:runAsUser":{}},"f:serviceAccount":{},"f:serviceAccountName":{},"f:terminationGracePeriodSeconds":{},"f:topologySpreadConstraints":{".":{},"k:{\"topologyKey\":\"topology.kubernetes.io/zone\",\"whenUnsatisfiable\":\"ScheduleAnyway\"}":{".":{},"f:labelSelector":{".":{},"f:matchLabels":{".":{},"f:app.kubernetes.io/name":{}}},"f:maxSkew":{},"f:topologyKey":{},"f:whenUnsatisfiable":{}}},"f:volumes":{".":{},"k:{\"name\":\"erlang-cookie-secret\"}":{".":{},"f:name":{},"f:secret":{".":{},"f:defaultMode":{},"f:secretName":{}}},"k:{\"name\":\"plugins-conf\"}":{".":{},"f:configMap":{".":{},"f:defaultMode":{},"f:name":{}},"f:name":{}},"k:{\"name\":\"pod-info\"}":{".":{},"f:downwardAPI":{".":{},"f:defaultMode":{},"f:items":{}},"f:name":{}},"k:{\"name\":\"rabbitmq-confd\"}":{".":{},"f:name":{},"f:projected":{".":{},"f:defaultMode":{},"f:sources":{}}},"k:{\"name\":\"rabbitmq-erlang-cookie\"}":{".":{},"f:emptyDir":{},"f:name":{}},"k:{\"name\":\"rabbitmq-plugins\"}":{".":{},"f:emptyDir":{},"f:name":{}}}}},"f:updateStrategy":{"f:rollingUpdate":{".":{},"f:partition":{}},"f:type":{}},"f:volumeClaimTemplates":{}}}},{"manager":"kube-controller-manager","operation":"Update","apiVersion":"apps/v1","time":"2022-03-18T18:01:17Z","fieldsType":"FieldsV1","fieldsV1":{"f:status":{"f:collisionCount":{},"f:currentReplicas":{},"f:currentRevision":{},"f:observedGeneration":{},"f:readyReplicas":{},"f:replicas":{},"f:updateRevision":{},"f:updatedReplicas":{}}}}]},"spec":{"replicas":1,"selector":{"matchLabels":{"app.kubernetes.io/name":"rabbitmq-cluster"}},"template":{"metadata":{"creationTimestamp":null,"labels":{"app.kubernetes.io/component":"rabbitmq","app.kubernetes.io/name":"rabbitmq-cluster","app.kubernetes.io/part-of":"rabbitmq"},"annotations":{"prometheus.io/port":"15692","prometheus.io/scrape":"true"}},"spec":{"volumes":[{"name":"plugins-conf","configMap":{"name":"rabbitmq-cluster-plugins-conf","defaultMode":420}},{"name":"rabbitmq-confd","projected":{"sources":[{"secret":{"name":"rabbitmq-cluster-default-user","items":[{"key":"default_user.conf","path":"default_user.conf"}]}},{"configMap":{"name":"rabbitmq-cluster-server-conf","items":[{"key":"operatorDefaults.conf","path":"operatorDefaults.conf"},{"key":"userDefinedConfiguration.conf","path":"userDefinedConfiguration.conf"}]}}],"defaultMode":420}},{"name":"rabbitmq-erlang-cookie","emptyDir":{}},{"name":"erlang-cookie-secret","secret":{"secretName":"rabbitmq-cluster-erlang-cookie","defaultMode":420}},{"name":"rabbitmq-plugins","emptyDir":{}},{"name":"pod-info","downwardAPI":{"items":[{"path":"skipPreStopChecks","fieldRef":{"apiVersion":"v1","fieldPath":"metadata.labels['skipPreStopChecks']"}}],"defaultMode":420}}],"initContainers":[{"name":"setup-container","image":"rabbitmq:3.8.12-management","command":["sh","-c","cp /tmp/erlang-cookie-secret/.erlang.cookie /var/lib/rabbitmq/.erlang.cookie \u0026\u0026 chown 999:999 /var/lib/rabbitmq/.erlang.cookie \u0026\u0026 chmod 600 /var/lib/rabbitmq/.erlang.cookie ; cp /tmp/rabbitmq-plugins/enabled_plugins /operator/enabled_plugins \u0026\u0026 chown 999:999 /operator/enabled_plugins ; chown 999:999 /var/lib/rabbitmq/mnesia/ ; echo '[default]' \u003e /var/lib/rabbitmq/.rabbitmqadmin.conf \u0026\u0026 sed -e 's/default_user/username/' -e 's/default_pass/password/' /tmp/default_user.conf \u003e\u003e /var/lib/rabbitmq/.rabbitmqadmin.conf \u0026\u0026 chown 999:999 /var/lib/rabbitmq/.rabbitmqadmin.conf \u0026\u0026 chmod 600 /var/lib/rabbitmq/.rabbitmqadmin.conf"],"resources":{"limits":{"cpu":"100m","memory":"500Mi"},"requests":{"cpu":"100m","memory":"500Mi"}},"volumeMounts":[{"name":"plugins-conf","mountPath":"/tmp/rabbitmq-plugins/"},{"name":"rabbitmq-erlang-cookie","mountPath":"/var/lib/rabbitmq/"},{"name":"erlang-cookie-secret","mountPath":"/tmp/erlang-cookie-secret/"},{"name":"rabbitmq-plugins","mountPath":"/operator"},{"name":"persistence","mountPath":"/var/lib/rabbitmq/mnesia/"},{"name":"rabbitmq-confd","mountPath":"/tmp/default_user.conf","subPath":"default_user.conf"}],"terminationMessagePath":"/dev/termination-log","terminationMessagePolicy":"File","imagePullPolicy":"IfNotPresent","securityContext":{"capabilities":{"drop":["FSETID","KILL","SETGID","SETUID","SETPCAP","NET_BIND_SERVICE","NET_RAW","SYS_CHROOT","MKNOD","AUDIT_WRITE","SETFCAP"]},"runAsUser":0}}],"containers":[{"name":"rabbitmq","image":"rabbitmq:3.8.12-management","ports":[{"name":"epmd","containerPort":4369,"protocol":"TCP"},{"name":"amqp","containerPort":5672,"protocol":"TCP"},{"name":"management","containerPort":15672,"protocol":"TCP"},{"name":"prometheus","containerPort":15692,"protocol":"TCP"}],"env":[{"name":"MY_POD_NAME","valueFrom":{"fieldRef":{"apiVersion":"v1","fieldPath":"metadata.name"}}},{"name":"MY_POD_NAMESPACE","valueFrom":{"fieldRef":{"apiVersion":"v1","fieldPath":"metadata.namespace"}}},{"name":"RABBITMQ_ENABLED_PLUGINS_FILE","value":"/operator/enabled_plugins"},{"name":"K8S_SERVICE_NAME","value":"rabbitmq-cluster-nodes"},{"name":"RABBITMQ_USE_LONGNAME","value":"true"},{"name":"RABBITMQ_NODENAME","value":"rabbit@$(MY_POD_NAME).$(K8S_SERVICE_NAME).$(MY_POD_NAMESPACE)"},{"name":"K8S_HOSTNAME_SUFFIX","value":".$(K8S_SERVICE_NAME).$(MY_POD_NAMESPACE)"}],"resources":{"limits":{"cpu":"2","memory":"2Gi"},"requests":{"cpu":"1","memory":"2Gi"}},"volumeMounts":[{"name":"rabbitmq-erlang-cookie","mountPath":"/var/lib/rabbitmq/"},{"name":"persistence","mountPath":"/var/lib/rabbitmq/mnesia/"},{"name":"rabbitmq-plugins","mountPath":"/operator"},{"name":"rabbitmq-confd","mountPath":"/etc/rabbitmq/conf.d/10-operatorDefaults.conf","subPath":"operatorDefaults.conf"},{"name":"rabbitmq-confd","mountPath":"/etc/rabbitmq/conf.d/11-default_user.conf","subPath":"default_user.conf"},{"name":"rabbitmq-confd","mountPath":"/etc/rabbitmq/conf.d/90-userDefinedConfiguration.conf","subPath":"userDefinedConfiguration.conf"},{"name":"pod-info","mountPath":"/etc/pod-info/"}],"readinessProbe":{"tcpSocket":{"port":"amqp"},"initialDelaySeconds":10,"timeoutSeconds":5,"periodSeconds":10,"successThreshold":1,"failureThreshold":3},"lifecycle":{"preStop":{"exec":{"command":["/bin/bash","-c","if [ ! -z \"$(cat /etc/pod-info/skipPreStopChecks)\" ]; then exit 0; fi; rabbitmq-upgrade await_online_quorum_plus_one -t 604800; rabbitmq-upgrade await_online_synchronized_mirror -t 604800; rabbitmq-upgrade drain -t 604800"]}}},"terminationMessagePath":"/dev/termination-log","terminationMessagePolicy":"File","imagePullPolicy":"IfNotPresent"}],"restartPolicy":"Always","terminationGracePeriodSeconds":604800,"dnsPolicy":"ClusterFirst","serviceAccountName":"rabbitmq-cluster-server","serviceAccount":"rabbitmq-cluster-server","automountServiceAccountToken":true,"securityContext":{"runAsUser":999,"runAsGroup":999,"fsGroup":999},"schedulerName":"default-scheduler","topologySpreadConstraints":[{"maxSkew":1,"topologyKey":"topology.kubernetes.io/zone","whenUnsatisfiable":"ScheduleAnyway","labelSelector":{"matchLabels":{"app.kubernetes.io/name":"rabbitmq-cluster"}}}]}},"volumeClaimTemplates":[{"metadata":{"name":"persistence","namespace":"default","creationTimestamp":null,"labels":{"app.kubernetes.io/component":"rabbitmq","app.kubernetes.io/name":"rabbitmq-cluster","app.kubernetes.io/part-of":"rabbitmq"},"ownerReferences":[{"apiVersion":"rabbitmq.com/v1beta1","kind":"RabbitmqCluster","name":"rabbitmq-cluster","uid":"18d9928b-0d1c-47be-80ec-20960d053827","controller":true,"blockOwnerDeletion":false}]},"spec":{"accessModes":["ReadWriteOnce"],"resources":{"requests":{"storage":"10Gi"}},"volumeMode":"Filesystem"},"status":{"phase":"Pending"}}],"serviceName":"rabbitmq-cluster-nodes","podManagementPolicy":"Parallel","updateStrategy":{"type":"RollingUpdate","rollingUpdate":{"partition":0}},"revisionHistoryLimit":10},"status":{"observedGeneration":1,"replicas":1,"readyReplicas":1,"currentReplicas":1,"updatedReplicas":1,"currentRevision":"rabbitmq-cluster-server-5f8b8665fb","updateRevision":"rabbitmq-cluster-server-5f8b8665fb","collisionCount":0}}
2022/03/18 18:01:18 learn_server.go:291: [SIEVE-AFTER-READ]	Get	true	configmap	default	rabbitmq-cluster-plugins-conf	github.com/rabbitmq/cluster-operator/controllers.(*RabbitmqClusterReconciler)	NoError	{"kind":"ConfigMap","apiVersion":"v1","metadata":{"name":"rabbitmq-cluster-plugins-conf","namespace":"default","selfLink":"/api/v1/namespaces/default/configmaps/rabbitmq-cluster-plugins-conf","uid":"a164075b-0562-47ac-a577-99aa8651ec40","resourceVersion":"709","creationTimestamp":"2022-03-18T18:00:38Z","labels":{"app.kubernetes.io/component":"rabbitmq","app.kubernetes.io/name":"rabbitmq-cluster","app.kubernetes.io/part-of":"rabbitmq"},"ownerReferences":[{"apiVersion":"rabbitmq.com/v1beta1","kind":"RabbitmqCluster","name":"rabbitmq-cluster","uid":"18d9928b-0d1c-47be-80ec-20960d053827","controller":true,"blockOwnerDeletion":true}],"managedFields":[{"manager":"manager","operation":"Update","apiVersion":"v1","time":"2022-03-18T18:00:38Z","fieldsType":"FieldsV1","fieldsV1":{"f:data":{".":{},"f:enabled_plugins":{}},"f:metadata":{"f:labels":{".":{},"f:app.kubernetes.io/component":{},"f:app.kubernetes.io/name":{},"f:app.kubernetes.io/part-of":{}},"f:ownerReferences":{".":{},"k:{\"uid\":\"18d9928b-0d1c-47be-80ec-20960d053827\"}":{".":{},"f:apiVersion":{},"f:blockOwnerDeletion":{},"f:controller":{},"f:kind":{},"f:name":{},"f:uid":{}}}}}}]},"data":{"enabled_plugins":"[rabbitmq_peer_discovery_k8s,rabbitmq_prometheus,rabbitmq_management]."}}
2022/03/18 18:01:18 learn_server.go:256: [SIEVE-BEFORE-WRITE]	37
2022/03/18 18:01:18 learn_server.go:263: [SIEVE-AFTER-WRITE]	37	StatusUpdate	rabbitmqcluster	github.com/rabbitmq/cluster-operator/controllers.(*RabbitmqClusterReconciler)	NoError	{"metadata":{"name":"rabbitmq-cluster","namespace":"default","selfLink":"/apis/rabbitmq.com/v1beta1/namespaces/default/rabbitmqclusters/rabbitmq-cluster/status","uid":"18d9928b-0d1c-47be-80ec-20960d053827","resourceVersion":"949","generation":2,"creationTimestamp":"2022-03-18T18:00:38Z","annotations":{"kubectl.kubernetes.io/last-applied-configuration":"{\"apiVersion\":\"rabbitmq.com/v1beta1\",\"kind\":\"RabbitmqCluster\",\"metadata\":{\"annotations\":{},\"name\":\"rabbitmq-cluster\",\"namespace\":\"default\"},\"spec\":{\"persistence\":{\"storage\":\"10Gi\"},\"replicas\":1}}\n"},"finalizers":["deletion.finalizers.rabbitmqclusters.rabbitmq.com"],"managedFields":[{"manager":"kubectl-client-side-apply","operation":"Update","apiVersion":"rabbitmq.com/v1beta1","time":"2022-03-18T18:00:38Z","fieldsType":"FieldsV1","fieldsV1":{"f:metadata":{"f:annotations":{".":{},"f:kubectl.kubernetes.io/last-applied-configuration":{}}},"f:spec":{".":{},"f:image":{},"f:persistence":{".":{},"f:storage":{}},"f:replicas":{},"f:resources":{".":{},"f:limits":{".":{},"f:memory":{}},"f:requests":{".":{},"f:memory":{}}},"f:service":{".":{},"f:type":{}},"f:terminationGracePeriodSeconds":{}}}},{"manager":"manager","operation":"Update","apiVersion":"rabbitmq.com/v1beta1","time":"2022-03-18T18:01:18Z","fieldsType":"FieldsV1","fieldsV1":{"f:metadata":{"f:finalizers":{}},"f:spec":{"f:override":{},"f:rabbitmq":{},"f:resources":{"f:limits":{"f:cpu":{}},"f:requests":{"f:cpu":{}}},"f:tls":{}},"f:status":{".":{},"f:conditions":{},"f:defaultUser":{".":{},"f:secretReference":{".":{},"f:keys":{".":{},"f:password":{},"f:username":{}},"f:name":{},"f:namespace":{}},"f:serviceReference":{".":{},"f:name":{},"f:namespace":{}}}}}}]},"spec":{"replicas":1,"image":"rabbitmq:3.8.12-management","service":{"type":"ClusterIP"},"persistence":{"storage":"10Gi"},"resources":{"limits":{"cpu":"2","memory":"2Gi"},"requests":{"cpu":"1","memory":"2Gi"}},"rabbitmq":{},"tls":{},"override":{},"terminationGracePeriodSeconds":604800},"status":{"conditions":[{"type":"AllReplicasReady","status":"True","lastTransitionTime":"2022-03-18T18:01:17Z","reason":"AllPodsAreReady"},{"type":"ClusterAvailable","status":"True","lastTransitionTime":"2022-03-18T18:01:17Z","reason":"AtLeastOneEndpointAvailable"},{"type":"NoWarnings","status":"True","lastTransitionTime":"2022-03-18T18:00:38Z","reason":"NoWarnings"},{"type":"ReconcileSuccess","status":"True","lastTransitionTime":"2022-03-18T18:01:18Z","reason":"Success","message":"Finish reconciling"}],"defaultUser":{"secretReference":{"name":"rabbitmq-cluster-default-user","namespace":"default","keys":{"password":"password","username":"username"}},"serviceReference":{"name":"rabbitmq-cluster","namespace":"default"}},"binding":{"name":"rabbitmq-cluster-default-user"}}}
2022/03/18 18:01:18 learn_server.go:253: [SIEVE-AFTER-RECONCILE]	github.com/rabbitmq/cluster-operator/controllers.(*RabbitmqClusterReconciler)	8
2022/03/18 18:01:23 learn_server.go:279: [SIEVE-BEFORE-HEAR]	22	Updated	rabbitmqcluster	{"metadata":{"name":"rabbitmq-cluster","namespace":"default","selfLink":"/apis/rabbitmq.com/v1beta1/namespaces/default/rabbitmqclusters/rabbitmq-cluster","uid":"18d9928b-0d1c-47be-80ec-20960d053827","resourceVersion":"973","generation":3,"creationTimestamp":"2022-03-18T18:00:38Z","annotations":{"kubectl.kubernetes.io/last-applied-configuration":"{\"apiVersion\":\"rabbitmq.com/v1beta1\",\"kind\":\"RabbitmqCluster\",\"metadata\":{\"annotations\":{},\"name\":\"rabbitmq-cluster\",\"namespace\":\"default\"},\"spec\":{\"persistence\":{\"storage\":\"10Gi\"},\"replicas\":1}}\n"},"finalizers":["deletion.finalizers.rabbitmqclusters.rabbitmq.com"],"managedFields":[{"manager":"kubectl-client-side-apply","operation":"Update","apiVersion":"rabbitmq.com/v1beta1","time":"2022-03-18T18:00:38Z","fieldsType":"FieldsV1","fieldsV1":{"f:metadata":{"f:annotations":{".":{},"f:kubectl.kubernetes.io/last-applied-configuration":{}}},"f:spec":{".":{},"f:image":{},"f:persistence":{".":{},"f:storage":{}},"f:resources":{".":{},"f:limits":{".":{},"f:memory":{}},"f:requests":{".":{},"f:memory":{}}},"f:service":{".":{},"f:type":{}},"f:terminationGracePeriodSeconds":{}}}},{"manager":"manager","operation":"Update","apiVersion":"rabbitmq.com/v1beta1","time":"2022-03-18T18:01:18Z","fieldsType":"FieldsV1","fieldsV1":{"f:metadata":{"f:finalizers":{}},"f:spec":{"f:override":{},"f:rabbitmq":{},"f:resources":{"f:limits":{"f:cpu":{}},"f:requests":{"f:cpu":{}}},"f:tls":{}},"f:status":{".":{},"f:conditions":{},"f:defaultUser":{".":{},"f:secretReference":{".":{},"f:keys":{".":{},"f:password":{},"f:username":{}},"f:name":{},"f:namespace":{}},"f:serviceReference":{".":{},"f:name":{},"f:namespace":{}}}}}},{"manager":"kubectl-patch","operation":"Update","apiVersion":"rabbitmq.com/v1beta1","time":"2022-03-18T18:01:23Z","fieldsType":"FieldsV1","fieldsV1":{"f:spec":{"f:replicas":{}}}}]},"spec":{"replicas":3,"image":"rabbitmq:3.8.12-management","service":{"type":"ClusterIP"},"persistence":{"storage":"10Gi"},"resources":{"limits":{"cpu":"2","memory":"2Gi"},"requests":{"cpu":"1","memory":"2Gi"}},"rabbitmq":{},"tls":{},"override":{},"terminationGracePeriodSeconds":604800},"status":{"conditions":[{"type":"AllReplicasReady","status":"True","lastTransitionTime":"2022-03-18T18:01:17Z","reason":"AllPodsAreReady"},{"type":"ClusterAvailable","status":"True","lastTransitionTime":"2022-03-18T18:01:17Z","reason":"AtLeastOneEndpointAvailable"},{"type":"NoWarnings","status":"True","lastTransitionTime":"2022-03-18T18:00:38Z","reason":"NoWarnings"},{"type":"ReconcileSuccess","status":"True","lastTransitionTime":"2022-03-18T18:01:18Z","reason":"Success","message":"Finish reconciling"}],"defaultUser":{"secretReference":{"name":"rabbitmq-cluster-default-user","namespace":"default","keys":{"password":"password","username":"username"}},"serviceReference":{"name":"rabbitmq-cluster","namespace":"default"}}}}
2022/03/18 18:01:23 learn_server.go:289: [SIEVE-AFTER-HEAR]	22
2022/03/18 18:01:23 learn_server.go:238: [SIEVE-BEFORE-RECONCILE]	github.com/rabbitmq/cluster-operator/controllers.(*RabbitmqClusterReconciler)	9
2022/03/18 18:01:23 learn_server.go:291: [SIEVE-AFTER-READ]	Get	true	rabbitmqcluster	default	rabbitmq-cluster	github.com/rabbitmq/cluster-operator/controllers.(*RabbitmqClusterReconciler)	NoError	{"kind":"RabbitmqCluster","apiVersion":"rabbitmq.com/v1beta1","metadata":{"name":"rabbitmq-cluster","namespace":"default","selfLink":"/apis/rabbitmq.com/v1beta1/namespaces/default/rabbitmqclusters/rabbitmq-cluster","uid":"18d9928b-0d1c-47be-80ec-20960d053827","resourceVersion":"973","generation":3,"creationTimestamp":"2022-03-18T18:00:38Z","annotations":{"kubectl.kubernetes.io/last-applied-configuration":"{\"apiVersion\":\"rabbitmq.com/v1beta1\",\"kind\":\"RabbitmqCluster\",\"metadata\":{\"annotations\":{},\"name\":\"rabbitmq-cluster\",\"namespace\":\"default\"},\"spec\":{\"persistence\":{\"storage\":\"10Gi\"},\"replicas\":1}}\n"},"finalizers":["deletion.finalizers.rabbitmqclusters.rabbitmq.com"],"managedFields":[{"manager":"kubectl-client-side-apply","operation":"Update","apiVersion":"rabbitmq.com/v1beta1","time":"2022-03-18T18:00:38Z","fieldsType":"FieldsV1","fieldsV1":{"f:metadata":{"f:annotations":{".":{},"f:kubectl.kubernetes.io/last-applied-configuration":{}}},"f:spec":{".":{},"f:image":{},"f:persistence":{".":{},"f:storage":{}},"f:resources":{".":{},"f:limits":{".":{},"f:memory":{}},"f:requests":{".":{},"f:memory":{}}},"f:service":{".":{},"f:type":{}},"f:terminationGracePeriodSeconds":{}}}},{"manager":"manager","operation":"Update","apiVersion":"rabbitmq.com/v1beta1","time":"2022-03-18T18:01:18Z","fieldsType":"FieldsV1","fieldsV1":{"f:metadata":{"f:finalizers":{}},"f:spec":{"f:override":{},"f:rabbitmq":{},"f:resources":{"f:limits":{"f:cpu":{}},"f:requests":{"f:cpu":{}}},"f:tls":{}},"f:status":{".":{},"f:conditions":{},"f:defaultUser":{".":{},"f:secretReference":{".":{},"f:keys":{".":{},"f:password":{},"f:username":{}},"f:name":{},"f:namespace":{}},"f:serviceReference":{".":{},"f:name":{},"f:namespace":{}}}}}},{"manager":"kubectl-patch","operation":"Update","apiVersion":"rabbitmq.com/v1beta1","time":"2022-03-18T18:01:23Z","fieldsType":"FieldsV1","fieldsV1":{"f:spec":{"f:replicas":{}}}}]},"spec":{"replicas":3,"image":"rabbitmq:3.8.12-management","service":{"type":"ClusterIP"},"persistence":{"storage":"10Gi"},"resources":{"limits":{"cpu":"2","memory":"2Gi"},"requests":{"cpu":"1","memory":"2Gi"}},"rabbitmq":{},"tls":{},"override":{},"terminationGracePeriodSeconds":604800},"status":{"conditions":[{"type":"AllReplicasReady","status":"True","lastTransitionTime":"2022-03-18T18:01:17Z","reason":"AllPodsAreReady"},{"type":"ClusterAvailable","status":"True","lastTransitionTime":"2022-03-18T18:01:17Z","reason":"AtLeastOneEndpointAvailable"},{"type":"NoWarnings","status":"True","lastTransitionTime":"2022-03-18T18:00:38Z","reason":"NoWarnings"},{"type":"ReconcileSuccess","status":"True","lastTransitionTime":"2022-03-18T18:01:18Z","reason":"Success","message":"Finish reconciling"}],"defaultUser":{"secretReference":{"name":"rabbitmq-cluster-default-user","namespace":"default","keys":{"password":"password","username":"username"}},"serviceReference":{"name":"rabbitmq-cluster","namespace":"default"}}}}
2022/03/18 18:01:23 learn_server.go:291: [SIEVE-AFTER-READ]	Get	true	statefulset	default	rabbitmq-cluster-server	github.com/rabbitmq/cluster-operator/controllers.(*RabbitmqClusterReconciler)	NoError	{"kind":"StatefulSet","apiVersion":"apps/v1","metadata":{"name":"rabbitmq-cluster-server","namespace":"default","selfLink":"/apis/apps/v1/namespaces/default/statefulsets/rabbitmq-cluster-server","uid":"cb5c43bc-6ee7-481c-ab01-6f3acffdd3c8","resourceVersion":"948","generation":1,"creationTimestamp":"2022-03-18T18:00:38Z","labels":{"app.kubernetes.io/component":"rabbitmq","app.kubernetes.io/name":"rabbitmq-cluster","app.kubernetes.io/part-of":"rabbitmq"},"ownerReferences":[{"apiVersion":"rabbitmq.com/v1beta1","kind":"RabbitmqCluster","name":"rabbitmq-cluster","uid":"18d9928b-0d1c-47be-80ec-20960d053827","controller":true,"blockOwnerDeletion":true}],"managedFields":[{"manager":"manager","operation":"Update","apiVersion":"apps/v1","time":"2022-03-18T18:00:38Z","fieldsType":"FieldsV1","fieldsV1":{"f:metadata":{"f:labels":{".":{},"f:app.kubernetes.io/component":{},"f:app.kubernetes.io/name":{},"f:app.kubernetes.io/part-of":{}},"f:ownerReferences":{".":{},"k:{\"uid\":\"18d9928b-0d1c-47be-80ec-20960d053827\"}":{".":{},"f:apiVersion":{},"f:blockOwnerDeletion":{},"f:controller":{},"f:kind":{},"f:name":{},"f:uid":{}}}},"f:spec":{"f:podManagementPolicy":{},"f:replicas":{},"f:revisionHistoryLimit":{},"f:selector":{"f:matchLabels":{".":{},"f:app.kubernetes.io/name":{}}},"f:serviceName":{},"f:template":{"f:metadata":{"f:annotations":{".":{},"f:prometheus.io/port":{},"f:prometheus.io/scrape":{}},"f:labels":{".":{},"f:app.kubernetes.io/component":{},"f:app.kubernetes.io/name":{},"f:app.kubernetes.io/part-of":{}}},"f:spec":{"f:automountServiceAccountToken":{},"f:containers":{"k:{\"name\":\"rabbitmq\"}":{".":{},"f:env":{".":{},"k:{\"name\":\"K8S_HOSTNAME_SUFFIX\"}":{".":{},"f:name":{},"f:value":{}},"k:{\"name\":\"K8S_SERVICE_NAME\"}":{".":{},"f:name":{},"f:value":{}},"k:{\"name\":\"MY_POD_NAME\"}":{".":{},"f:name":{},"f:valueFrom":{".":{},"f:fieldRef":{".":{},"f:apiVersion":{},"f:fieldPath":{}}}},"k:{\"name\":\"MY_POD_NAMESPACE\"}":{".":{},"f:name":{},"f:valueFrom":{".":{},"f:fieldRef":{".":{},"f:apiVersion":{},"f:fieldPath":{}}}},"k:{\"name\":\"RABBITMQ_ENABLED_PLUGINS_FILE\"}":{".":{},"f:name":{},"f:value":{}},"k:{\"name\":\"RABBITMQ_NODENAME\"}":{".":{},"f:name":{},"f:value":{}},"k:{\"name\":\"RABBITMQ_USE_LONGNAME\"}":{".":{},"f:name":{},"f:value":{}}},"f:image":{},"f:imagePullPolicy":{},"f:lifecycle":{".":{},"f:preStop":{".":{},"f:exec":{".":{},"f:command":{}}}},"f:name":{},"f:ports":{".":{},"k:{\"containerPort\":4369,\"protocol\":\"TCP\"}":{".":{},"f:containerPort":{},"f:name":{},"f:protocol":{}},"k:{\"containerPort\":5672,\"protocol\":\"TCP\"}":{".":{},"f:containerPort":{},"f:name":{},"f:protocol":{}},"k:{\"containerPort\":15672,\"protocol\":\"TCP\"}":{".":{},"f:containerPort":{},"f:name":{},"f:protocol":{}},"k:{\"containerPort\":15692,\"protocol\":\"TCP\"}":{".":{},"f:containerPort":{},"f:name":{},"f:protocol":{}}},"f:readinessProbe":{".":{},"f:failureThreshold":{},"f:initialDelaySeconds":{},"f:periodSeconds":{},"f:successThreshold":{},"f:tcpSocket":{".":{},"f:port":{}},"f:timeoutSeconds":{}},"f:resources":{".":{},"f:limits":{".":{},"f:cpu":{},"f:memory":{}},"f:requests":{".":{},"f:cpu":{},"f:memory":{}}},"f:terminationMessagePath":{},"f:terminationMessagePolicy":{},"f:volumeMounts":{".":{},"k:{\"mountPath\":\"/etc/pod-info/\"}":{".":{},"f:mountPath":{},"f:name":{}},"k:{\"mountPath\":\"/etc/rabbitmq/conf.d/10-operatorDefaults.conf\"}":{".":{},"f:mountPath":{},"f:name":{},"f:subPath":{}},"k:{\"mountPath\":\"/etc/rabbitmq/conf.d/11-default_user.conf\"}":{".":{},"f:mountPath":{},"f:name":{},"f:subPath":{}},"k:{\"mountPath\":\"/etc/rabbitmq/conf.d/90-userDefinedConfiguration.conf\"}":{".":{},"f:mountPath":{},"f:name":{},"f:subPath":{}},"k:{\"mountPath\":\"/operator\"}":{".":{},"f:mountPath":{},"f:name":{}},"k:{\"mountPath\":\"/var/lib/rabbitmq/\"}":{".":{},"f:mountPath":{},"f:name":{}},"k:{\"mountPath\":\"/var/lib/rabbitmq/mnesia/\"}":{".":{},"f:mountPath":{},"f:name":{}}}}},"f:dnsPolicy":{},"f:initContainers":{".":{},"k:{\"name\":\"setup-container\"}":{".":{},"f:command":{},"f:image":{},"f:imagePullPolicy":{},"f:name":{},"f:resources":{".":{},"f:limits":{".":{},"f:cpu":{},"f:memory":{}},"f:requests":{".":{},"f:cpu":{},"f:memory":{}}},"f:securityContext":{".":{},"f:capabilities":{".":{},"f:drop":{}},"f:runAsUser":{}},"f:terminationMessagePath":{},"f:terminationMessagePolicy":{},"f:volumeMounts":{".":{},"k:{\"mountPath\":\"/operator\"}":{".":{},"f:mountPath":{},"f:name":{}},"k:{\"mountPath\":\"/tmp/default_user.conf\"}":{".":{},"f:mountPath":{},"f:name":{},"f:subPath":{}},"k:{\"mountPath\":\"/tmp/erlang-cookie-secret/\"}":{".":{},"f:mountPath":{},"f:name":{}},"k:{\"mountPath\":\"/tmp/rabbitmq-plugins/\"}":{".":{},"f:mountPath":{},"f:name":{}},"k:{\"mountPath\":\"/var/lib/rabbitmq/\"}":{".":{},"f:mountPath":{},"f:name":{}},"k:{\"mountPath\":\"/var/lib/rabbitmq/mnesia/\"}":{".":{},"f:mountPath":{},"f:name":{}}}}},"f:restartPolicy":{},"f:schedulerName":{},"f:securityContext":{".":{},"f:fsGroup":{},"f:runAsGroup":{},"f:runAsUser":{}},"f:serviceAccount":{},"f:serviceAccountName":{},"f:terminationGracePeriodSeconds":{},"f:topologySpreadConstraints":{".":{},"k:{\"topologyKey\":\"topology.kubernetes.io/zone\",\"whenUnsatisfiable\":\"ScheduleAnyway\"}":{".":{},"f:labelSelector":{".":{},"f:matchLabels":{".":{},"f:app.kubernetes.io/name":{}}},"f:maxSkew":{},"f:topologyKey":{},"f:whenUnsatisfiable":{}}},"f:volumes":{".":{},"k:{\"name\":\"erlang-cookie-secret\"}":{".":{},"f:name":{},"f:secret":{".":{},"f:defaultMode":{},"f:secretName":{}}},"k:{\"name\":\"plugins-conf\"}":{".":{},"f:configMap":{".":{},"f:defaultMode":{},"f:name":{}},"f:name":{}},"k:{\"name\":\"pod-info\"}":{".":{},"f:downwardAPI":{".":{},"f:defaultMode":{},"f:items":{}},"f:name":{}},"k:{\"name\":\"rabbitmq-confd\"}":{".":{},"f:name":{},"f:projected":{".":{},"f:defaultMode":{},"f:sources":{}}},"k:{\"name\":\"rabbitmq-erlang-cookie\"}":{".":{},"f:emptyDir":{},"f:name":{}},"k:{\"name\":\"rabbitmq-plugins\"}":{".":{},"f:emptyDir":{},"f:name":{}}}}},"f:updateStrategy":{"f:rollingUpdate":{".":{},"f:partition":{}},"f:type":{}},"f:volumeClaimTemplates":{}}}},{"manager":"kube-controller-manager","operation":"Update","apiVersion":"apps/v1","time":"2022-03-18T18:01:17Z","fieldsType":"FieldsV1","fieldsV1":{"f:status":{"f:collisionCount":{},"f:currentReplicas":{},"f:currentRevision":{},"f:observedGeneration":{},"f:readyReplicas":{},"f:replicas":{},"f:updateRevision":{},"f:updatedReplicas":{}}}}]},"spec":{"replicas":1,"selector":{"matchLabels":{"app.kubernetes.io/name":"rabbitmq-cluster"}},"template":{"metadata":{"creationTimestamp":null,"labels":{"app.kubernetes.io/component":"rabbitmq","app.kubernetes.io/name":"rabbitmq-cluster","app.kubernetes.io/part-of":"rabbitmq"},"annotations":{"prometheus.io/port":"15692","prometheus.io/scrape":"true"}},"spec":{"volumes":[{"name":"plugins-conf","configMap":{"name":"rabbitmq-cluster-plugins-conf","defaultMode":420}},{"name":"rabbitmq-confd","projected":{"sources":[{"secret":{"name":"rabbitmq-cluster-default-user","items":[{"key":"default_user.conf","path":"default_user.conf"}]}},{"configMap":{"name":"rabbitmq-cluster-server-conf","items":[{"key":"operatorDefaults.conf","path":"operatorDefaults.conf"},{"key":"userDefinedConfiguration.conf","path":"userDefinedConfiguration.conf"}]}}],"defaultMode":420}},{"name":"rabbitmq-erlang-cookie","emptyDir":{}},{"name":"erlang-cookie-secret","secret":{"secretName":"rabbitmq-cluster-erlang-cookie","defaultMode":420}},{"name":"rabbitmq-plugins","emptyDir":{}},{"name":"pod-info","downwardAPI":{"items":[{"path":"skipPreStopChecks","fieldRef":{"apiVersion":"v1","fieldPath":"metadata.labels['skipPreStopChecks']"}}],"defaultMode":420}}],"initContainers":[{"name":"setup-container","image":"rabbitmq:3.8.12-management","command":["sh","-c","cp /tmp/erlang-cookie-secret/.erlang.cookie /var/lib/rabbitmq/.erlang.cookie \u0026\u0026 chown 999:999 /var/lib/rabbitmq/.erlang.cookie \u0026\u0026 chmod 600 /var/lib/rabbitmq/.erlang.cookie ; cp /tmp/rabbitmq-plugins/enabled_plugins /operator/enabled_plugins \u0026\u0026 chown 999:999 /operator/enabled_plugins ; chown 999:999 /var/lib/rabbitmq/mnesia/ ; echo '[default]' \u003e /var/lib/rabbitmq/.rabbitmqadmin.conf \u0026\u0026 sed -e 's/default_user/username/' -e 's/default_pass/password/' /tmp/default_user.conf \u003e\u003e /var/lib/rabbitmq/.rabbitmqadmin.conf \u0026\u0026 chown 999:999 /var/lib/rabbitmq/.rabbitmqadmin.conf \u0026\u0026 chmod 600 /var/lib/rabbitmq/.rabbitmqadmin.conf"],"resources":{"limits":{"cpu":"100m","memory":"500Mi"},"requests":{"cpu":"100m","memory":"500Mi"}},"volumeMounts":[{"name":"plugins-conf","mountPath":"/tmp/rabbitmq-plugins/"},{"name":"rabbitmq-erlang-cookie","mountPath":"/var/lib/rabbitmq/"},{"name":"erlang-cookie-secret","mountPath":"/tmp/erlang-cookie-secret/"},{"name":"rabbitmq-plugins","mountPath":"/operator"},{"name":"persistence","mountPath":"/var/lib/rabbitmq/mnesia/"},{"name":"rabbitmq-confd","mountPath":"/tmp/default_user.conf","subPath":"default_user.conf"}],"terminationMessagePath":"/dev/termination-log","terminationMessagePolicy":"File","imagePullPolicy":"IfNotPresent","securityContext":{"capabilities":{"drop":["FSETID","KILL","SETGID","SETUID","SETPCAP","NET_BIND_SERVICE","NET_RAW","SYS_CHROOT","MKNOD","AUDIT_WRITE","SETFCAP"]},"runAsUser":0}}],"containers":[{"name":"rabbitmq","image":"rabbitmq:3.8.12-management","ports":[{"name":"epmd","containerPort":4369,"protocol":"TCP"},{"name":"amqp","containerPort":5672,"protocol":"TCP"},{"name":"management","containerPort":15672,"protocol":"TCP"},{"name":"prometheus","containerPort":15692,"protocol":"TCP"}],"env":[{"name":"MY_POD_NAME","valueFrom":{"fieldRef":{"apiVersion":"v1","fieldPath":"metadata.name"}}},{"name":"MY_POD_NAMESPACE","valueFrom":{"fieldRef":{"apiVersion":"v1","fieldPath":"metadata.namespace"}}},{"name":"RABBITMQ_ENABLED_PLUGINS_FILE","value":"/operator/enabled_plugins"},{"name":"K8S_SERVICE_NAME","value":"rabbitmq-cluster-nodes"},{"name":"RABBITMQ_USE_LONGNAME","value":"true"},{"name":"RABBITMQ_NODENAME","value":"rabbit@$(MY_POD_NAME).$(K8S_SERVICE_NAME).$(MY_POD_NAMESPACE)"},{"name":"K8S_HOSTNAME_SUFFIX","value":".$(K8S_SERVICE_NAME).$(MY_POD_NAMESPACE)"}],"resources":{"limits":{"cpu":"2","memory":"2Gi"},"requests":{"cpu":"1","memory":"2Gi"}},"volumeMounts":[{"name":"rabbitmq-erlang-cookie","mountPath":"/var/lib/rabbitmq/"},{"name":"persistence","mountPath":"/var/lib/rabbitmq/mnesia/"},{"name":"rabbitmq-plugins","mountPath":"/operator"},{"name":"rabbitmq-confd","mountPath":"/etc/rabbitmq/conf.d/10-operatorDefaults.conf","subPath":"operatorDefaults.conf"},{"name":"rabbitmq-confd","mountPath":"/etc/rabbitmq/conf.d/11-default_user.conf","subPath":"default_user.conf"},{"name":"rabbitmq-confd","mountPath":"/etc/rabbitmq/conf.d/90-userDefinedConfiguration.conf","subPath":"userDefinedConfiguration.conf"},{"name":"pod-info","mountPath":"/etc/pod-info/"}],"readinessProbe":{"tcpSocket":{"port":"amqp"},"initialDelaySeconds":10,"timeoutSeconds":5,"periodSeconds":10,"successThreshold":1,"failureThreshold":3},"lifecycle":{"preStop":{"exec":{"command":["/bin/bash","-c","if [ ! -z \"$(cat /etc/pod-info/skipPreStopChecks)\" ]; then exit 0; fi; rabbitmq-upgrade await_online_quorum_plus_one -t 604800; rabbitmq-upgrade await_online_synchronized_mirror -t 604800; rabbitmq-upgrade drain -t 604800"]}}},"terminationMessagePath":"/dev/termination-log","terminationMessagePolicy":"File","imagePullPolicy":"IfNotPresent"}],"restartPolicy":"Always","terminationGracePeriodSeconds":604800,"dnsPolicy":"ClusterFirst","serviceAccountName":"rabbitmq-cluster-server","serviceAccount":"rabbitmq-cluster-server","automountServiceAccountToken":true,"securityContext":{"runAsUser":999,"runAsGroup":999,"fsGroup":999},"schedulerName":"default-scheduler","topologySpreadConstraints":[{"maxSkew":1,"topologyKey":"topology.kubernetes.io/zone","whenUnsatisfiable":"ScheduleAnyway","labelSelector":{"matchLabels":{"app.kubernetes.io/name":"rabbitmq-cluster"}}}]}},"volumeClaimTemplates":[{"metadata":{"name":"persistence","namespace":"default","creationTimestamp":null,"labels":{"app.kubernetes.io/component":"rabbitmq","app.kubernetes.io/name":"rabbitmq-cluster","app.kubernetes.io/part-of":"rabbitmq"},"ownerReferences":[{"apiVersion":"rabbitmq.com/v1beta1","kind":"RabbitmqCluster","name":"rabbitmq-cluster","uid":"18d9928b-0d1c-47be-80ec-20960d053827","controller":true,"blockOwnerDeletion":false}]},"spec":{"accessModes":["ReadWriteOnce"],"resources":{"requests":{"storage":"10Gi"}},"volumeMode":"Filesystem"},"status":{"phase":"Pending"}}],"serviceName":"rabbitmq-cluster-nodes","podManagementPolicy":"Parallel","updateStrategy":{"type":"RollingUpdate","rollingUpdate":{"partition":0}},"revisionHistoryLimit":10},"status":{"observedGeneration":1,"replicas":1,"readyReplicas":1,"currentReplicas":1,"updatedReplicas":1,"currentRevision":"rabbitmq-cluster-server-5f8b8665fb","updateRevision":"rabbitmq-cluster-server-5f8b8665fb","collisionCount":0}}
2022/03/18 18:01:23 learn_server.go:291: [SIEVE-AFTER-READ]	Get	true	endpoints	default	rabbitmq-cluster	github.com/rabbitmq/cluster-operator/controllers.(*RabbitmqClusterReconciler)	NoError	{"kind":"Endpoints","apiVersion":"v1","metadata":{"name":"rabbitmq-cluster","namespace":"default","selfLink":"/api/v1/namespaces/default/endpoints/rabbitmq-cluster","uid":"5c4723ad-f4fe-442d-9135-44879a2a8183","resourceVersion":"939","creationTimestamp":"2022-03-18T18:00:38Z","labels":{"app.kubernetes.io/component":"rabbitmq","app.kubernetes.io/name":"rabbitmq-cluster","app.kubernetes.io/part-of":"rabbitmq"},"annotations":{"endpoints.kubernetes.io/last-change-trigger-time":"2022-03-18T18:01:17Z"},"managedFields":[{"manager":"kube-controller-manager","operation":"Update","apiVersion":"v1","time":"2022-03-18T18:01:17Z","fieldsType":"FieldsV1","fieldsV1":{"f:metadata":{"f:annotations":{".":{},"f:endpoints.kubernetes.io/last-change-trigger-time":{}},"f:labels":{".":{},"f:app.kubernetes.io/component":{},"f:app.kubernetes.io/name":{},"f:app.kubernetes.io/part-of":{}}},"f:subsets":{}}}]},"subsets":[{"addresses":[{"ip":"10.244.1.4","nodeName":"kind-worker2","targetRef":{"kind":"Pod","namespace":"default","name":"rabbitmq-cluster-server-0","uid":"e7faffc5-b656-4e69-9777-92d12cb6ec5a","resourceVersion":"938"}}],"ports":[{"name":"amqp","port":5672,"protocol":"TCP"},{"name":"management","port":15672,"protocol":"TCP"}]}]}
2022/03/18 18:01:23 learn_server.go:291: [SIEVE-AFTER-READ]	Get	true	statefulset	default	rabbitmq-cluster-server	github.com/rabbitmq/cluster-operator/controllers.(*RabbitmqClusterReconciler)	NoError	{"kind":"StatefulSet","apiVersion":"apps/v1","metadata":{"name":"rabbitmq-cluster-server","namespace":"default","selfLink":"/apis/apps/v1/namespaces/default/statefulsets/rabbitmq-cluster-server","uid":"cb5c43bc-6ee7-481c-ab01-6f3acffdd3c8","resourceVersion":"948","generation":1,"creationTimestamp":"2022-03-18T18:00:38Z","labels":{"app.kubernetes.io/component":"rabbitmq","app.kubernetes.io/name":"rabbitmq-cluster","app.kubernetes.io/part-of":"rabbitmq"},"ownerReferences":[{"apiVersion":"rabbitmq.com/v1beta1","kind":"RabbitmqCluster","name":"rabbitmq-cluster","uid":"18d9928b-0d1c-47be-80ec-20960d053827","controller":true,"blockOwnerDeletion":true}],"managedFields":[{"manager":"manager","operation":"Update","apiVersion":"apps/v1","time":"2022-03-18T18:00:38Z","fieldsType":"FieldsV1","fieldsV1":{"f:metadata":{"f:labels":{".":{},"f:app.kubernetes.io/component":{},"f:app.kubernetes.io/name":{},"f:app.kubernetes.io/part-of":{}},"f:ownerReferences":{".":{},"k:{\"uid\":\"18d9928b-0d1c-47be-80ec-20960d053827\"}":{".":{},"f:apiVersion":{},"f:blockOwnerDeletion":{},"f:controller":{},"f:kind":{},"f:name":{},"f:uid":{}}}},"f:spec":{"f:podManagementPolicy":{},"f:replicas":{},"f:revisionHistoryLimit":{},"f:selector":{"f:matchLabels":{".":{},"f:app.kubernetes.io/name":{}}},"f:serviceName":{},"f:template":{"f:metadata":{"f:annotations":{".":{},"f:prometheus.io/port":{},"f:prometheus.io/scrape":{}},"f:labels":{".":{},"f:app.kubernetes.io/component":{},"f:app.kubernetes.io/name":{},"f:app.kubernetes.io/part-of":{}}},"f:spec":{"f:automountServiceAccountToken":{},"f:containers":{"k:{\"name\":\"rabbitmq\"}":{".":{},"f:env":{".":{},"k:{\"name\":\"K8S_HOSTNAME_SUFFIX\"}":{".":{},"f:name":{},"f:value":{}},"k:{\"name\":\"K8S_SERVICE_NAME\"}":{".":{},"f:name":{},"f:value":{}},"k:{\"name\":\"MY_POD_NAME\"}":{".":{},"f:name":{},"f:valueFrom":{".":{},"f:fieldRef":{".":{},"f:apiVersion":{},"f:fieldPath":{}}}},"k:{\"name\":\"MY_POD_NAMESPACE\"}":{".":{},"f:name":{},"f:valueFrom":{".":{},"f:fieldRef":{".":{},"f:apiVersion":{},"f:fieldPath":{}}}},"k:{\"name\":\"RABBITMQ_ENABLED_PLUGINS_FILE\"}":{".":{},"f:name":{},"f:value":{}},"k:{\"name\":\"RABBITMQ_NODENAME\"}":{".":{},"f:name":{},"f:value":{}},"k:{\"name\":\"RABBITMQ_USE_LONGNAME\"}":{".":{},"f:name":{},"f:value":{}}},"f:image":{},"f:imagePullPolicy":{},"f:lifecycle":{".":{},"f:preStop":{".":{},"f:exec":{".":{},"f:command":{}}}},"f:name":{},"f:ports":{".":{},"k:{\"containerPort\":4369,\"protocol\":\"TCP\"}":{".":{},"f:containerPort":{},"f:name":{},"f:protocol":{}},"k:{\"containerPort\":5672,\"protocol\":\"TCP\"}":{".":{},"f:containerPort":{},"f:name":{},"f:protocol":{}},"k:{\"containerPort\":15672,\"protocol\":\"TCP\"}":{".":{},"f:containerPort":{},"f:name":{},"f:protocol":{}},"k:{\"containerPort\":15692,\"protocol\":\"TCP\"}":{".":{},"f:containerPort":{},"f:name":{},"f:protocol":{}}},"f:readinessProbe":{".":{},"f:failureThreshold":{},"f:initialDelaySeconds":{},"f:periodSeconds":{},"f:successThreshold":{},"f:tcpSocket":{".":{},"f:port":{}},"f:timeoutSeconds":{}},"f:resources":{".":{},"f:limits":{".":{},"f:cpu":{},"f:memory":{}},"f:requests":{".":{},"f:cpu":{},"f:memory":{}}},"f:terminationMessagePath":{},"f:terminationMessagePolicy":{},"f:volumeMounts":{".":{},"k:{\"mountPath\":\"/etc/pod-info/\"}":{".":{},"f:mountPath":{},"f:name":{}},"k:{\"mountPath\":\"/etc/rabbitmq/conf.d/10-operatorDefaults.conf\"}":{".":{},"f:mountPath":{},"f:name":{},"f:subPath":{}},"k:{\"mountPath\":\"/etc/rabbitmq/conf.d/11-default_user.conf\"}":{".":{},"f:mountPath":{},"f:name":{},"f:subPath":{}},"k:{\"mountPath\":\"/etc/rabbitmq/conf.d/90-userDefinedConfiguration.conf\"}":{".":{},"f:mountPath":{},"f:name":{},"f:subPath":{}},"k:{\"mountPath\":\"/operator\"}":{".":{},"f:mountPath":{},"f:name":{}},"k:{\"mountPath\":\"/var/lib/rabbitmq/\"}":{".":{},"f:mountPath":{},"f:name":{}},"k:{\"mountPath\":\"/var/lib/rabbitmq/mnesia/\"}":{".":{},"f:mountPath":{},"f:name":{}}}}},"f:dnsPolicy":{},"f:initContainers":{".":{},"k:{\"name\":\"setup-container\"}":{".":{},"f:command":{},"f:image":{},"f:imagePullPolicy":{},"f:name":{},"f:resources":{".":{},"f:limits":{".":{},"f:cpu":{},"f:memory":{}},"f:requests":{".":{},"f:cpu":{},"f:memory":{}}},"f:securityContext":{".":{},"f:capabilities":{".":{},"f:drop":{}},"f:runAsUser":{}},"f:terminationMessagePath":{},"f:terminationMessagePolicy":{},"f:volumeMounts":{".":{},"k:{\"mountPath\":\"/operator\"}":{".":{},"f:mountPath":{},"f:name":{}},"k:{\"mountPath\":\"/tmp/default_user.conf\"}":{".":{},"f:mountPath":{},"f:name":{},"f:subPath":{}},"k:{\"mountPath\":\"/tmp/erlang-cookie-secret/\"}":{".":{},"f:mountPath":{},"f:name":{}},"k:{\"mountPath\":\"/tmp/rabbitmq-plugins/\"}":{".":{},"f:mountPath":{},"f:name":{}},"k:{\"mountPath\":\"/var/lib/rabbitmq/\"}":{".":{},"f:mountPath":{},"f:name":{}},"k:{\"mountPath\":\"/var/lib/rabbitmq/mnesia/\"}":{".":{},"f:mountPath":{},"f:name":{}}}}},"f:restartPolicy":{},"f:schedulerName":{},"f:securityContext":{".":{},"f:fsGroup":{},"f:runAsGroup":{},"f:runAsUser":{}},"f:serviceAccount":{},"f:serviceAccountName":{},"f:terminationGracePeriodSeconds":{},"f:topologySpreadConstraints":{".":{},"k:{\"topologyKey\":\"topology.kubernetes.io/zone\",\"whenUnsatisfiable\":\"ScheduleAnyway\"}":{".":{},"f:labelSelector":{".":{},"f:matchLabels":{".":{},"f:app.kubernetes.io/name":{}}},"f:maxSkew":{},"f:topologyKey":{},"f:whenUnsatisfiable":{}}},"f:volumes":{".":{},"k:{\"name\":\"erlang-cookie-secret\"}":{".":{},"f:name":{},"f:secret":{".":{},"f:defaultMode":{},"f:secretName":{}}},"k:{\"name\":\"plugins-conf\"}":{".":{},"f:configMap":{".":{},"f:defaultMode":{},"f:name":{}},"f:name":{}},"k:{\"name\":\"pod-info\"}":{".":{},"f:downwardAPI":{".":{},"f:defaultMode":{},"f:items":{}},"f:name":{}},"k:{\"name\":\"rabbitmq-confd\"}":{".":{},"f:name":{},"f:projected":{".":{},"f:defaultMode":{},"f:sources":{}}},"k:{\"name\":\"rabbitmq-erlang-cookie\"}":{".":{},"f:emptyDir":{},"f:name":{}},"k:{\"name\":\"rabbitmq-plugins\"}":{".":{},"f:emptyDir":{},"f:name":{}}}}},"f:updateStrategy":{"f:rollingUpdate":{".":{},"f:partition":{}},"f:type":{}},"f:volumeClaimTemplates":{}}}},{"manager":"kube-controller-manager","operation":"Update","apiVersion":"apps/v1","time":"2022-03-18T18:01:17Z","fieldsType":"FieldsV1","fieldsV1":{"f:status":{"f:collisionCount":{},"f:currentReplicas":{},"f:currentRevision":{},"f:observedGeneration":{},"f:readyReplicas":{},"f:replicas":{},"f:updateRevision":{},"f:updatedReplicas":{}}}}]},"spec":{"replicas":1,"selector":{"matchLabels":{"app.kubernetes.io/name":"rabbitmq-cluster"}},"template":{"metadata":{"creationTimestamp":null,"labels":{"app.kubernetes.io/component":"rabbitmq","app.kubernetes.io/name":"rabbitmq-cluster","app.kubernetes.io/part-of":"rabbitmq"},"annotations":{"prometheus.io/port":"15692","prometheus.io/scrape":"true"}},"spec":{"volumes":[{"name":"plugins-conf","configMap":{"name":"rabbitmq-cluster-plugins-conf","defaultMode":420}},{"name":"rabbitmq-confd","projected":{"sources":[{"secret":{"name":"rabbitmq-cluster-default-user","items":[{"key":"default_user.conf","path":"default_user.conf"}]}},{"configMap":{"name":"rabbitmq-cluster-server-conf","items":[{"key":"operatorDefaults.conf","path":"operatorDefaults.conf"},{"key":"userDefinedConfiguration.conf","path":"userDefinedConfiguration.conf"}]}}],"defaultMode":420}},{"name":"rabbitmq-erlang-cookie","emptyDir":{}},{"name":"erlang-cookie-secret","secret":{"secretName":"rabbitmq-cluster-erlang-cookie","defaultMode":420}},{"name":"rabbitmq-plugins","emptyDir":{}},{"name":"pod-info","downwardAPI":{"items":[{"path":"skipPreStopChecks","fieldRef":{"apiVersion":"v1","fieldPath":"metadata.labels['skipPreStopChecks']"}}],"defaultMode":420}}],"initContainers":[{"name":"setup-container","image":"rabbitmq:3.8.12-management","command":["sh","-c","cp /tmp/erlang-cookie-secret/.erlang.cookie /var/lib/rabbitmq/.erlang.cookie \u0026\u0026 chown 999:999 /var/lib/rabbitmq/.erlang.cookie \u0026\u0026 chmod 600 /var/lib/rabbitmq/.erlang.cookie ; cp /tmp/rabbitmq-plugins/enabled_plugins /operator/enabled_plugins \u0026\u0026 chown 999:999 /operator/enabled_plugins ; chown 999:999 /var/lib/rabbitmq/mnesia/ ; echo '[default]' \u003e /var/lib/rabbitmq/.rabbitmqadmin.conf \u0026\u0026 sed -e 's/default_user/username/' -e 's/default_pass/password/' /tmp/default_user.conf \u003e\u003e /var/lib/rabbitmq/.rabbitmqadmin.conf \u0026\u0026 chown 999:999 /var/lib/rabbitmq/.rabbitmqadmin.conf \u0026\u0026 chmod 600 /var/lib/rabbitmq/.rabbitmqadmin.conf"],"resources":{"limits":{"cpu":"100m","memory":"500Mi"},"requests":{"cpu":"100m","memory":"500Mi"}},"volumeMounts":[{"name":"plugins-conf","mountPath":"/tmp/rabbitmq-plugins/"},{"name":"rabbitmq-erlang-cookie","mountPath":"/var/lib/rabbitmq/"},{"name":"erlang-cookie-secret","mountPath":"/tmp/erlang-cookie-secret/"},{"name":"rabbitmq-plugins","mountPath":"/operator"},{"name":"persistence","mountPath":"/var/lib/rabbitmq/mnesia/"},{"name":"rabbitmq-confd","mountPath":"/tmp/default_user.conf","subPath":"default_user.conf"}],"terminationMessagePath":"/dev/termination-log","terminationMessagePolicy":"File","imagePullPolicy":"IfNotPresent","securityContext":{"capabilities":{"drop":["FSETID","KILL","SETGID","SETUID","SETPCAP","NET_BIND_SERVICE","NET_RAW","SYS_CHROOT","MKNOD","AUDIT_WRITE","SETFCAP"]},"runAsUser":0}}],"containers":[{"name":"rabbitmq","image":"rabbitmq:3.8.12-management","ports":[{"name":"epmd","containerPort":4369,"protocol":"TCP"},{"name":"amqp","containerPort":5672,"protocol":"TCP"},{"name":"management","containerPort":15672,"protocol":"TCP"},{"name":"prometheus","containerPort":15692,"protocol":"TCP"}],"env":[{"name":"MY_POD_NAME","valueFrom":{"fieldRef":{"apiVersion":"v1","fieldPath":"metadata.name"}}},{"name":"MY_POD_NAMESPACE","valueFrom":{"fieldRef":{"apiVersion":"v1","fieldPath":"metadata.namespace"}}},{"name":"RABBITMQ_ENABLED_PLUGINS_FILE","value":"/operator/enabled_plugins"},{"name":"K8S_SERVICE_NAME","value":"rabbitmq-cluster-nodes"},{"name":"RABBITMQ_USE_LONGNAME","value":"true"},{"name":"RABBITMQ_NODENAME","value":"rabbit@$(MY_POD_NAME).$(K8S_SERVICE_NAME).$(MY_POD_NAMESPACE)"},{"name":"K8S_HOSTNAME_SUFFIX","value":".$(K8S_SERVICE_NAME).$(MY_POD_NAMESPACE)"}],"resources":{"limits":{"cpu":"2","memory":"2Gi"},"requests":{"cpu":"1","memory":"2Gi"}},"volumeMounts":[{"name":"rabbitmq-erlang-cookie","mountPath":"/var/lib/rabbitmq/"},{"name":"persistence","mountPath":"/var/lib/rabbitmq/mnesia/"},{"name":"rabbitmq-plugins","mountPath":"/operator"},{"name":"rabbitmq-confd","mountPath":"/etc/rabbitmq/conf.d/10-operatorDefaults.conf","subPath":"operatorDefaults.conf"},{"name":"rabbitmq-confd","mountPath":"/etc/rabbitmq/conf.d/11-default_user.conf","subPath":"default_user.conf"},{"name":"rabbitmq-confd","mountPath":"/etc/rabbitmq/conf.d/90-userDefinedConfiguration.conf","subPath":"userDefinedConfiguration.conf"},{"name":"pod-info","mountPath":"/etc/pod-info/"}],"readinessProbe":{"tcpSocket":{"port":"amqp"},"initialDelaySeconds":10,"timeoutSeconds":5,"periodSeconds":10,"successThreshold":1,"failureThreshold":3},"lifecycle":{"preStop":{"exec":{"command":["/bin/bash","-c","if [ ! -z \"$(cat /etc/pod-info/skipPreStopChecks)\" ]; then exit 0; fi; rabbitmq-upgrade await_online_quorum_plus_one -t 604800; rabbitmq-upgrade await_online_synchronized_mirror -t 604800; rabbitmq-upgrade drain -t 604800"]}}},"terminationMessagePath":"/dev/termination-log","terminationMessagePolicy":"File","imagePullPolicy":"IfNotPresent"}],"restartPolicy":"Always","terminationGracePeriodSeconds":604800,"dnsPolicy":"ClusterFirst","serviceAccountName":"rabbitmq-cluster-server","serviceAccount":"rabbitmq-cluster-server","automountServiceAccountToken":true,"securityContext":{"runAsUser":999,"runAsGroup":999,"fsGroup":999},"schedulerName":"default-scheduler","topologySpreadConstraints":[{"maxSkew":1,"topologyKey":"topology.kubernetes.io/zone","whenUnsatisfiable":"ScheduleAnyway","labelSelector":{"matchLabels":{"app.kubernetes.io/name":"rabbitmq-cluster"}}}]}},"volumeClaimTemplates":[{"metadata":{"name":"persistence","namespace":"default","creationTimestamp":null,"labels":{"app.kubernetes.io/component":"rabbitmq","app.kubernetes.io/name":"rabbitmq-cluster","app.kubernetes.io/part-of":"rabbitmq"},"ownerReferences":[{"apiVersion":"rabbitmq.com/v1beta1","kind":"RabbitmqCluster","name":"rabbitmq-cluster","uid":"18d9928b-0d1c-47be-80ec-20960d053827","controller":true,"blockOwnerDeletion":false}]},"spec":{"accessModes":["ReadWriteOnce"],"resources":{"requests":{"storage":"10Gi"}},"volumeMode":"Filesystem"},"status":{"phase":"Pending"}}],"serviceName":"rabbitmq-cluster-nodes","podManagementPolicy":"Parallel","updateStrategy":{"type":"RollingUpdate","rollingUpdate":{"partition":0}},"revisionHistoryLimit":10},"status":{"observedGeneration":1,"replicas":1,"readyReplicas":1,"currentReplicas":1,"updatedReplicas":1,"currentRevision":"rabbitmq-cluster-server-5f8b8665fb","updateRevision":"rabbitmq-cluster-server-5f8b8665fb","collisionCount":0}}
2022/03/18 18:01:23 learn_server.go:291: [SIEVE-AFTER-READ]	Get	true	service	default	rabbitmq-cluster-nodes	github.com/rabbitmq/cluster-operator/controllers.(*RabbitmqClusterReconciler)	NoError	{"kind":"Service","apiVersion":"v1","metadata":{"name":"rabbitmq-cluster-nodes","namespace":"default","selfLink":"/api/v1/namespaces/default/services/rabbitmq-cluster-nodes","uid":"67c7eea9-1b87-4fd7-82e6-5bfe31fd1b52","resourceVersion":"696","creationTimestamp":"2022-03-18T18:00:38Z","labels":{"app.kubernetes.io/component":"rabbitmq","app.kubernetes.io/name":"rabbitmq-cluster","app.kubernetes.io/part-of":"rabbitmq"},"ownerReferences":[{"apiVersion":"rabbitmq.com/v1beta1","kind":"RabbitmqCluster","name":"rabbitmq-cluster","uid":"18d9928b-0d1c-47be-80ec-20960d053827","controller":true,"blockOwnerDeletion":true}],"managedFields":[{"manager":"manager","operation":"Update","apiVersion":"v1","time":"2022-03-18T18:00:38Z","fieldsType":"FieldsV1","fieldsV1":{"f:metadata":{"f:labels":{".":{},"f:app.kubernetes.io/component":{},"f:app.kubernetes.io/name":{},"f:app.kubernetes.io/part-of":{}},"f:ownerReferences":{".":{},"k:{\"uid\":\"18d9928b-0d1c-47be-80ec-20960d053827\"}":{".":{},"f:apiVersion":{},"f:blockOwnerDeletion":{},"f:controller":{},"f:kind":{},"f:name":{},"f:uid":{}}}},"f:spec":{"f:clusterIP":{},"f:ports":{".":{},"k:{\"port\":4369,\"protocol\":\"TCP\"}":{".":{},"f:name":{},"f:port":{},"f:protocol":{},"f:targetPort":{}},"k:{\"port\":25672,\"protocol\":\"TCP\"}":{".":{},"f:name":{},"f:port":{},"f:protocol":{},"f:targetPort":{}}},"f:publishNotReadyAddresses":{},"f:selector":{".":{},"f:app.kubernetes.io/name":{}},"f:sessionAffinity":{},"f:type":{}}}}]},"spec":{"ports":[{"name":"epmd","protocol":"TCP","port":4369,"targetPort":4369},{"name":"cluster-rpc","protocol":"TCP","port":25672,"targetPort":25672}],"selector":{"app.kubernetes.io/name":"rabbitmq-cluster"},"clusterIP":"None","type":"ClusterIP","sessionAffinity":"None","publishNotReadyAddresses":true},"status":{"loadBalancer":{}}}
2022/03/18 18:01:23 learn_server.go:291: [SIEVE-AFTER-READ]	Get	true	service	default	rabbitmq-cluster	github.com/rabbitmq/cluster-operator/controllers.(*RabbitmqClusterReconciler)	NoError	{"kind":"Service","apiVersion":"v1","metadata":{"name":"rabbitmq-cluster","namespace":"default","selfLink":"/api/v1/namespaces/default/services/rabbitmq-cluster","uid":"56b50671-1945-458b-adac-05619b783392","resourceVersion":"701","creationTimestamp":"2022-03-18T18:00:38Z","labels":{"app.kubernetes.io/component":"rabbitmq","app.kubernetes.io/name":"rabbitmq-cluster","app.kubernetes.io/part-of":"rabbitmq"},"ownerReferences":[{"apiVersion":"rabbitmq.com/v1beta1","kind":"RabbitmqCluster","name":"rabbitmq-cluster","uid":"18d9928b-0d1c-47be-80ec-20960d053827","controller":true,"blockOwnerDeletion":true}],"managedFields":[{"manager":"manager","operation":"Update","apiVersion":"v1","time":"2022-03-18T18:00:38Z","fieldsType":"FieldsV1","fieldsV1":{"f:metadata":{"f:labels":{".":{},"f:app.kubernetes.io/component":{},"f:app.kubernetes.io/name":{},"f:app.kubernetes.io/part-of":{}},"f:ownerReferences":{".":{},"k:{\"uid\":\"18d9928b-0d1c-47be-80ec-20960d053827\"}":{".":{},"f:apiVersion":{},"f:blockOwnerDeletion":{},"f:controller":{},"f:kind":{},"f:name":{},"f:uid":{}}}},"f:spec":{"f:ports":{".":{},"k:{\"port\":5672,\"protocol\":\"TCP\"}":{".":{},"f:name":{},"f:port":{},"f:protocol":{},"f:targetPort":{}},"k:{\"port\":15672,\"protocol\":\"TCP\"}":{".":{},"f:name":{},"f:port":{},"f:protocol":{},"f:targetPort":{}}},"f:selector":{".":{},"f:app.kubernetes.io/name":{}},"f:sessionAffinity":{},"f:type":{}}}}]},"spec":{"ports":[{"name":"amqp","protocol":"TCP","port":5672,"targetPort":5672},{"name":"management","protocol":"TCP","port":15672,"targetPort":15672}],"selector":{"app.kubernetes.io/name":"rabbitmq-cluster"},"clusterIP":"10.96.254.158","type":"ClusterIP","sessionAffinity":"None"},"status":{"loadBalancer":{}}}
2022/03/18 18:01:23 learn_server.go:291: [SIEVE-AFTER-READ]	Get	true	secret	default	rabbitmq-cluster-erlang-cookie	github.com/rabbitmq/cluster-operator/controllers.(*RabbitmqClusterReconciler)	NoError	{"kind":"Secret","apiVersion":"v1","metadata":{"name":"rabbitmq-cluster-erlang-cookie","namespace":"default","selfLink":"/api/v1/namespaces/default/secrets/rabbitmq-cluster-erlang-cookie","uid":"f8fbe8a6-0f40-4e13-960b-ab78b8ba75b0","resourceVersion":"705","creationTimestamp":"2022-03-18T18:00:38Z","labels":{"app.kubernetes.io/component":"rabbitmq","app.kubernetes.io/name":"rabbitmq-cluster","app.kubernetes.io/part-of":"rabbitmq"},"ownerReferences":[{"apiVersion":"rabbitmq.com/v1beta1","kind":"RabbitmqCluster","name":"rabbitmq-cluster","uid":"18d9928b-0d1c-47be-80ec-20960d053827","controller":true,"blockOwnerDeletion":true}],"managedFields":[{"manager":"manager","operation":"Update","apiVersion":"v1","time":"2022-03-18T18:00:38Z","fieldsType":"FieldsV1","fieldsV1":{"f:data":{".":{},"f:.erlang.cookie":{}},"f:metadata":{"f:labels":{".":{},"f:app.kubernetes.io/component":{},"f:app.kubernetes.io/name":{},"f:app.kubernetes.io/part-of":{}},"f:ownerReferences":{".":{},"k:{\"uid\":\"18d9928b-0d1c-47be-80ec-20960d053827\"}":{".":{},"f:apiVersion":{},"f:blockOwnerDeletion":{},"f:controller":{},"f:kind":{},"f:name":{},"f:uid":{}}}},"f:type":{}}}]},"data":{".erlang.cookie":"QW9hMkpWU0tlYS1FUGdWTUhrelNMNnFoMFZ0ZmRGNUY="},"type":"Opaque"}
2022/03/18 18:01:23 learn_server.go:291: [SIEVE-AFTER-READ]	Get	true	secret	default	rabbitmq-cluster-default-user	github.com/rabbitmq/cluster-operator/controllers.(*RabbitmqClusterReconciler)	NoError	{"kind":"Secret","apiVersion":"v1","metadata":{"name":"rabbitmq-cluster-default-user","namespace":"default","selfLink":"/api/v1/namespaces/default/secrets/rabbitmq-cluster-default-user","uid":"0d9f460b-a23c-402b-8273-f541ed39023f","resourceVersion":"708","creationTimestamp":"2022-03-18T18:00:38Z","labels":{"app.kubernetes.io/component":"rabbitmq","app.kubernetes.io/name":"rabbitmq-cluster","app.kubernetes.io/part-of":"rabbitmq"},"ownerReferences":[{"apiVersion":"rabbitmq.com/v1beta1","kind":"RabbitmqCluster","name":"rabbitmq-cluster","uid":"18d9928b-0d1c-47be-80ec-20960d053827","controller":true,"blockOwnerDeletion":true}],"managedFields":[{"manager":"manager","operation":"Update","apiVersion":"v1","time":"2022-03-18T18:00:38Z","fieldsType":"FieldsV1","fieldsV1":{"f:data":{".":{},"f:default_user.conf":{},"f:password":{},"f:provider":{},"f:type":{},"f:username":{}},"f:metadata":{"f:labels":{".":{},"f:app.kubernetes.io/component":{},"f:app.kubernetes.io/name":{},"f:app.kubernetes.io/part-of":{}},"f:ownerReferences":{".":{},"k:{\"uid\":\"18d9928b-0d1c-47be-80ec-20960d053827\"}":{".":{},"f:apiVersion":{},"f:blockOwnerDeletion":{},"f:controller":{},"f:kind":{},"f:name":{},"f:uid":{}}}},"f:type":{}}}]},"data":{"default_user.conf":"ZGVmYXVsdF91c2VyID0gcTMxRmh3MGtjWW9SZUl5X3BPTXp2ZVBOUnNVU3I1Mk8KZGVmYXVsdF9wYXNzID0gY0dBX19jNTJHX05hVURpTGhraWZ6UDBOVVlNLTE2MWQK","password":"Y0dBX19jNTJHX05hVURpTGhraWZ6UDBOVVlNLTE2MWQ=","provider":"cmFiYml0bXE=","type":"cmFiYml0bXE=","username":"cTMxRmh3MGtjWW9SZUl5X3BPTXp2ZVBOUnNVU3I1Mk8="},"type":"Opaque"}
2022/03/18 18:01:23 learn_server.go:291: [SIEVE-AFTER-READ]	Get	true	configmap	default	rabbitmq-cluster-plugins-conf	github.com/rabbitmq/cluster-operator/controllers.(*RabbitmqClusterReconciler)	NoError	{"kind":"ConfigMap","apiVersion":"v1","metadata":{"name":"rabbitmq-cluster-plugins-conf","namespace":"default","selfLink":"/api/v1/namespaces/default/configmaps/rabbitmq-cluster-plugins-conf","uid":"a164075b-0562-47ac-a577-99aa8651ec40","resourceVersion":"709","creationTimestamp":"2022-03-18T18:00:38Z","labels":{"app.kubernetes.io/component":"rabbitmq","app.kubernetes.io/name":"rabbitmq-cluster","app.kubernetes.io/part-of":"rabbitmq"},"ownerReferences":[{"apiVersion":"rabbitmq.com/v1beta1","kind":"RabbitmqCluster","name":"rabbitmq-cluster","uid":"18d9928b-0d1c-47be-80ec-20960d053827","controller":true,"blockOwnerDeletion":true}],"managedFields":[{"manager":"manager","operation":"Update","apiVersion":"v1","time":"2022-03-18T18:00:38Z","fieldsType":"FieldsV1","fieldsV1":{"f:data":{".":{},"f:enabled_plugins":{}},"f:metadata":{"f:labels":{".":{},"f:app.kubernetes.io/component":{},"f:app.kubernetes.io/name":{},"f:app.kubernetes.io/part-of":{}},"f:ownerReferences":{".":{},"k:{\"uid\":\"18d9928b-0d1c-47be-80ec-20960d053827\"}":{".":{},"f:apiVersion":{},"f:blockOwnerDeletion":{},"f:controller":{},"f:kind":{},"f:name":{},"f:uid":{}}}}}}]},"data":{"enabled_plugins":"[rabbitmq_peer_discovery_k8s,rabbitmq_prometheus,rabbitmq_management]."}}
2022/03/18 18:01:23 learn_server.go:291: [SIEVE-AFTER-READ]	Get	true	configmap	default	rabbitmq-cluster-server-conf	github.com/rabbitmq/cluster-operator/controllers.(*RabbitmqClusterReconciler)	NoError	{"kind":"ConfigMap","apiVersion":"v1","metadata":{"name":"rabbitmq-cluster-server-conf","namespace":"default","selfLink":"/api/v1/namespaces/default/configmaps/rabbitmq-cluster-server-conf","uid":"22474f2b-8454-44b7-8079-8990223969cc","resourceVersion":"714","creationTimestamp":"2022-03-18T18:00:38Z","labels":{"app.kubernetes.io/component":"rabbitmq","app.kubernetes.io/name":"rabbitmq-cluster","app.kubernetes.io/part-of":"rabbitmq"},"ownerReferences":[{"apiVersion":"rabbitmq.com/v1beta1","kind":"RabbitmqCluster","name":"rabbitmq-cluster","uid":"18d9928b-0d1c-47be-80ec-20960d053827","controller":true,"blockOwnerDeletion":true}],"managedFields":[{"manager":"manager","operation":"Update","apiVersion":"v1","time":"2022-03-18T18:00:38Z","fieldsType":"FieldsV1","fieldsV1":{"f:data":{".":{},"f:operatorDefaults.conf":{},"f:userDefinedConfiguration.conf":{}},"f:metadata":{"f:labels":{".":{},"f:app.kubernetes.io/component":{},"f:app.kubernetes.io/name":{},"f:app.kubernetes.io/part-of":{}},"f:ownerReferences":{".":{},"k:{\"uid\":\"18d9928b-0d1c-47be-80ec-20960d053827\"}":{".":{},"f:apiVersion":{},"f:blockOwnerDeletion":{},"f:controller":{},"f:kind":{},"f:name":{},"f:uid":{}}}}}}]},"data":{"operatorDefaults.conf":"cluster_formation.peer_discovery_backend             = rabbit_peer_discovery_k8s\ncluster_formation.k8s.host                           = kubernetes.default\ncluster_formation.k8s.address_type                   = hostname\ncluster_partition_handling                           = pause_minority\nqueue_master_locator                                 = min-masters\ndisk_free_limit.absolute                             = 2GB\ncluster_formation.randomized_startup_delay_range.min = 5\ncluster_formation.randomized_startup_delay_range.max = 30\ncluster_name                                         = rabbitmq-cluster\n","userDefinedConfiguration.conf":"total_memory_available_override_value = 1717986919\n"}}
2022/03/18 18:01:23 learn_server.go:291: [SIEVE-AFTER-READ]	Get	true	serviceaccount	default	rabbitmq-cluster-server	github.com/rabbitmq/cluster-operator/controllers.(*RabbitmqClusterReconciler)	NoError	{"kind":"ServiceAccount","apiVersion":"v1","metadata":{"name":"rabbitmq-cluster-server","namespace":"default","selfLink":"/api/v1/namespaces/default/serviceaccounts/rabbitmq-cluster-server","uid":"731589b5-ac97-4774-bee4-008949b54734","resourceVersion":"722","creationTimestamp":"2022-03-18T18:00:38Z","labels":{"app.kubernetes.io/component":"rabbitmq","app.kubernetes.io/name":"rabbitmq-cluster","app.kubernetes.io/part-of":"rabbitmq"},"ownerReferences":[{"apiVersion":"rabbitmq.com/v1beta1","kind":"RabbitmqCluster","name":"rabbitmq-cluster","uid":"18d9928b-0d1c-47be-80ec-20960d053827","controller":true,"blockOwnerDeletion":true}],"managedFields":[{"manager":"kube-controller-manager","operation":"Update","apiVersion":"v1","time":"2022-03-18T18:00:38Z","fieldsType":"FieldsV1","fieldsV1":{"f:secrets":{".":{},"k:{\"name\":\"rabbitmq-cluster-server-token-rhzq9\"}":{".":{},"f:name":{}}}}},{"manager":"manager","operation":"Update","apiVersion":"v1","time":"2022-03-18T18:00:38Z","fieldsType":"FieldsV1","fieldsV1":{"f:metadata":{"f:labels":{".":{},"f:app.kubernetes.io/component":{},"f:app.kubernetes.io/name":{},"f:app.kubernetes.io/part-of":{}},"f:ownerReferences":{".":{},"k:{\"uid\":\"18d9928b-0d1c-47be-80ec-20960d053827\"}":{".":{},"f:apiVersion":{},"f:blockOwnerDeletion":{},"f:controller":{},"f:kind":{},"f:name":{},"f:uid":{}}}}}}]},"secrets":[{"name":"rabbitmq-cluster-server-token-rhzq9"}]}
2022/03/18 18:01:23 learn_server.go:291: [SIEVE-AFTER-READ]	Get	true	role	default	rabbitmq-cluster-peer-discovery	github.com/rabbitmq/cluster-operator/controllers.(*RabbitmqClusterReconciler)	NoError	{"kind":"Role","apiVersion":"rbac.authorization.k8s.io/v1","metadata":{"name":"rabbitmq-cluster-peer-discovery","namespace":"default","selfLink":"/apis/rbac.authorization.k8s.io/v1/namespaces/default/roles/rabbitmq-cluster-peer-discovery","uid":"52c80b50-4fdd-4089-bbfd-9756465953f2","resourceVersion":"723","creationTimestamp":"2022-03-18T18:00:38Z","labels":{"app.kubernetes.io/component":"rabbitmq","app.kubernetes.io/name":"rabbitmq-cluster","app.kubernetes.io/part-of":"rabbitmq"},"ownerReferences":[{"apiVersion":"rabbitmq.com/v1beta1","kind":"RabbitmqCluster","name":"rabbitmq-cluster","uid":"18d9928b-0d1c-47be-80ec-20960d053827","controller":true,"blockOwnerDeletion":true}],"managedFields":[{"manager":"manager","operation":"Update","apiVersion":"rbac.authorization.k8s.io/v1","time":"2022-03-18T18:00:38Z","fieldsType":"FieldsV1","fieldsV1":{"f:metadata":{"f:labels":{".":{},"f:app.kubernetes.io/component":{},"f:app.kubernetes.io/name":{},"f:app.kubernetes.io/part-of":{}},"f:ownerReferences":{".":{},"k:{\"uid\":\"18d9928b-0d1c-47be-80ec-20960d053827\"}":{".":{},"f:apiVersion":{},"f:blockOwnerDeletion":{},"f:controller":{},"f:kind":{},"f:name":{},"f:uid":{}}}},"f:rules":{}}}]},"rules":[{"verbs":["get"],"apiGroups":[""],"resources":["endpoints"]},{"verbs":["create"],"apiGroups":[""],"resources":["events"]}]}
2022/03/18 18:01:23 learn_server.go:291: [SIEVE-AFTER-READ]	Get	true	rolebinding	default	rabbitmq-cluster-server	github.com/rabbitmq/cluster-operator/controllers.(*RabbitmqClusterReconciler)	NoError	{"kind":"RoleBinding","apiVersion":"rbac.authorization.k8s.io/v1","metadata":{"name":"rabbitmq-cluster-server","namespace":"default","selfLink":"/apis/rbac.authorization.k8s.io/v1/namespaces/default/rolebindings/rabbitmq-cluster-server","uid":"495e9f7c-a20d-4515-86b0-34149a855034","resourceVersion":"725","creationTimestamp":"2022-03-18T18:00:38Z","labels":{"app.kubernetes.io/component":"rabbitmq","app.kubernetes.io/name":"rabbitmq-cluster","app.kubernetes.io/part-of":"rabbitmq"},"ownerReferences":[{"apiVersion":"rabbitmq.com/v1beta1","kind":"RabbitmqCluster","name":"rabbitmq-cluster","uid":"18d9928b-0d1c-47be-80ec-20960d053827","controller":true,"blockOwnerDeletion":true}],"managedFields":[{"manager":"manager","operation":"Update","apiVersion":"rbac.authorization.k8s.io/v1","time":"2022-03-18T18:00:38Z","fieldsType":"FieldsV1","fieldsV1":{"f:metadata":{"f:labels":{".":{},"f:app.kubernetes.io/component":{},"f:app.kubernetes.io/name":{},"f:app.kubernetes.io/part-of":{}},"f:ownerReferences":{".":{},"k:{\"uid\":\"18d9928b-0d1c-47be-80ec-20960d053827\"}":{".":{},"f:apiVersion":{},"f:blockOwnerDeletion":{},"f:controller":{},"f:kind":{},"f:name":{},"f:uid":{}}}},"f:roleRef":{"f:apiGroup":{},"f:kind":{},"f:name":{}},"f:subjects":{}}}]},"subjects":[{"kind":"ServiceAccount","name":"rabbitmq-cluster-server"}],"roleRef":{"apiGroup":"rbac.authorization.k8s.io","kind":"Role","name":"rabbitmq-cluster-peer-discovery"}}
2022/03/18 18:01:23 learn_server.go:291: [SIEVE-AFTER-READ]	Get	true	statefulset	default	rabbitmq-cluster-server	github.com/rabbitmq/cluster-operator/controllers.(*RabbitmqClusterReconciler)	NoError	{"kind":"StatefulSet","apiVersion":"apps/v1","metadata":{"name":"rabbitmq-cluster-server","namespace":"default","selfLink":"/apis/apps/v1/namespaces/default/statefulsets/rabbitmq-cluster-server","uid":"cb5c43bc-6ee7-481c-ab01-6f3acffdd3c8","resourceVersion":"948","generation":1,"creationTimestamp":"2022-03-18T18:00:38Z","labels":{"app.kubernetes.io/component":"rabbitmq","app.kubernetes.io/name":"rabbitmq-cluster","app.kubernetes.io/part-of":"rabbitmq"},"ownerReferences":[{"apiVersion":"rabbitmq.com/v1beta1","kind":"RabbitmqCluster","name":"rabbitmq-cluster","uid":"18d9928b-0d1c-47be-80ec-20960d053827","controller":true,"blockOwnerDeletion":true}],"managedFields":[{"manager":"manager","operation":"Update","apiVersion":"apps/v1","time":"2022-03-18T18:00:38Z","fieldsType":"FieldsV1","fieldsV1":{"f:metadata":{"f:labels":{".":{},"f:app.kubernetes.io/component":{},"f:app.kubernetes.io/name":{},"f:app.kubernetes.io/part-of":{}},"f:ownerReferences":{".":{},"k:{\"uid\":\"18d9928b-0d1c-47be-80ec-20960d053827\"}":{".":{},"f:apiVersion":{},"f:blockOwnerDeletion":{},"f:controller":{},"f:kind":{},"f:name":{},"f:uid":{}}}},"f:spec":{"f:podManagementPolicy":{},"f:replicas":{},"f:revisionHistoryLimit":{},"f:selector":{"f:matchLabels":{".":{},"f:app.kubernetes.io/name":{}}},"f:serviceName":{},"f:template":{"f:metadata":{"f:annotations":{".":{},"f:prometheus.io/port":{},"f:prometheus.io/scrape":{}},"f:labels":{".":{},"f:app.kubernetes.io/component":{},"f:app.kubernetes.io/name":{},"f:app.kubernetes.io/part-of":{}}},"f:spec":{"f:automountServiceAccountToken":{},"f:containers":{"k:{\"name\":\"rabbitmq\"}":{".":{},"f:env":{".":{},"k:{\"name\":\"K8S_HOSTNAME_SUFFIX\"}":{".":{},"f:name":{},"f:value":{}},"k:{\"name\":\"K8S_SERVICE_NAME\"}":{".":{},"f:name":{},"f:value":{}},"k:{\"name\":\"MY_POD_NAME\"}":{".":{},"f:name":{},"f:valueFrom":{".":{},"f:fieldRef":{".":{},"f:apiVersion":{},"f:fieldPath":{}}}},"k:{\"name\":\"MY_POD_NAMESPACE\"}":{".":{},"f:name":{},"f:valueFrom":{".":{},"f:fieldRef":{".":{},"f:apiVersion":{},"f:fieldPath":{}}}},"k:{\"name\":\"RABBITMQ_ENABLED_PLUGINS_FILE\"}":{".":{},"f:name":{},"f:value":{}},"k:{\"name\":\"RABBITMQ_NODENAME\"}":{".":{},"f:name":{},"f:value":{}},"k:{\"name\":\"RABBITMQ_USE_LONGNAME\"}":{".":{},"f:name":{},"f:value":{}}},"f:image":{},"f:imagePullPolicy":{},"f:lifecycle":{".":{},"f:preStop":{".":{},"f:exec":{".":{},"f:command":{}}}},"f:name":{},"f:ports":{".":{},"k:{\"containerPort\":4369,\"protocol\":\"TCP\"}":{".":{},"f:containerPort":{},"f:name":{},"f:protocol":{}},"k:{\"containerPort\":5672,\"protocol\":\"TCP\"}":{".":{},"f:containerPort":{},"f:name":{},"f:protocol":{}},"k:{\"containerPort\":15672,\"protocol\":\"TCP\"}":{".":{},"f:containerPort":{},"f:name":{},"f:protocol":{}},"k:{\"containerPort\":15692,\"protocol\":\"TCP\"}":{".":{},"f:containerPort":{},"f:name":{},"f:protocol":{}}},"f:readinessProbe":{".":{},"f:failureThreshold":{},"f:initialDelaySeconds":{},"f:periodSeconds":{},"f:successThreshold":{},"f:tcpSocket":{".":{},"f:port":{}},"f:timeoutSeconds":{}},"f:resources":{".":{},"f:limits":{".":{},"f:cpu":{},"f:memory":{}},"f:requests":{".":{},"f:cpu":{},"f:memory":{}}},"f:terminationMessagePath":{},"f:terminationMessagePolicy":{},"f:volumeMounts":{".":{},"k:{\"mountPath\":\"/etc/pod-info/\"}":{".":{},"f:mountPath":{},"f:name":{}},"k:{\"mountPath\":\"/etc/rabbitmq/conf.d/10-operatorDefaults.conf\"}":{".":{},"f:mountPath":{},"f:name":{},"f:subPath":{}},"k:{\"mountPath\":\"/etc/rabbitmq/conf.d/11-default_user.conf\"}":{".":{},"f:mountPath":{},"f:name":{},"f:subPath":{}},"k:{\"mountPath\":\"/etc/rabbitmq/conf.d/90-userDefinedConfiguration.conf\"}":{".":{},"f:mountPath":{},"f:name":{},"f:subPath":{}},"k:{\"mountPath\":\"/operator\"}":{".":{},"f:mountPath":{},"f:name":{}},"k:{\"mountPath\":\"/var/lib/rabbitmq/\"}":{".":{},"f:mountPath":{},"f:name":{}},"k:{\"mountPath\":\"/var/lib/rabbitmq/mnesia/\"}":{".":{},"f:mountPath":{},"f:name":{}}}}},"f:dnsPolicy":{},"f:initContainers":{".":{},"k:{\"name\":\"setup-container\"}":{".":{},"f:command":{},"f:image":{},"f:imagePullPolicy":{},"f:name":{},"f:resources":{".":{},"f:limits":{".":{},"f:cpu":{},"f:memory":{}},"f:requests":{".":{},"f:cpu":{},"f:memory":{}}},"f:securityContext":{".":{},"f:capabilities":{".":{},"f:drop":{}},"f:runAsUser":{}},"f:terminationMessagePath":{},"f:terminationMessagePolicy":{},"f:volumeMounts":{".":{},"k:{\"mountPath\":\"/operator\"}":{".":{},"f:mountPath":{},"f:name":{}},"k:{\"mountPath\":\"/tmp/default_user.conf\"}":{".":{},"f:mountPath":{},"f:name":{},"f:subPath":{}},"k:{\"mountPath\":\"/tmp/erlang-cookie-secret/\"}":{".":{},"f:mountPath":{},"f:name":{}},"k:{\"mountPath\":\"/tmp/rabbitmq-plugins/\"}":{".":{},"f:mountPath":{},"f:name":{}},"k:{\"mountPath\":\"/var/lib/rabbitmq/\"}":{".":{},"f:mountPath":{},"f:name":{}},"k:{\"mountPath\":\"/var/lib/rabbitmq/mnesia/\"}":{".":{},"f:mountPath":{},"f:name":{}}}}},"f:restartPolicy":{},"f:schedulerName":{},"f:securityContext":{".":{},"f:fsGroup":{},"f:runAsGroup":{},"f:runAsUser":{}},"f:serviceAccount":{},"f:serviceAccountName":{},"f:terminationGracePeriodSeconds":{},"f:topologySpreadConstraints":{".":{},"k:{\"topologyKey\":\"topology.kubernetes.io/zone\",\"whenUnsatisfiable\":\"ScheduleAnyway\"}":{".":{},"f:labelSelector":{".":{},"f:matchLabels":{".":{},"f:app.kubernetes.io/name":{}}},"f:maxSkew":{},"f:topologyKey":{},"f:whenUnsatisfiable":{}}},"f:volumes":{".":{},"k:{\"name\":\"erlang-cookie-secret\"}":{".":{},"f:name":{},"f:secret":{".":{},"f:defaultMode":{},"f:secretName":{}}},"k:{\"name\":\"plugins-conf\"}":{".":{},"f:configMap":{".":{},"f:defaultMode":{},"f:name":{}},"f:name":{}},"k:{\"name\":\"pod-info\"}":{".":{},"f:downwardAPI":{".":{},"f:defaultMode":{},"f:items":{}},"f:name":{}},"k:{\"name\":\"rabbitmq-confd\"}":{".":{},"f:name":{},"f:projected":{".":{},"f:defaultMode":{},"f:sources":{}}},"k:{\"name\":\"rabbitmq-erlang-cookie\"}":{".":{},"f:emptyDir":{},"f:name":{}},"k:{\"name\":\"rabbitmq-plugins\"}":{".":{},"f:emptyDir":{},"f:name":{}}}}},"f:updateStrategy":{"f:rollingUpdate":{".":{},"f:partition":{}},"f:type":{}},"f:volumeClaimTemplates":{}}}},{"manager":"kube-controller-manager","operation":"Update","apiVersion":"apps/v1","time":"2022-03-18T18:01:17Z","fieldsType":"FieldsV1","fieldsV1":{"f:status":{"f:collisionCount":{},"f:currentReplicas":{},"f:currentRevision":{},"f:observedGeneration":{},"f:readyReplicas":{},"f:replicas":{},"f:updateRevision":{},"f:updatedReplicas":{}}}}]},"spec":{"replicas":1,"selector":{"matchLabels":{"app.kubernetes.io/name":"rabbitmq-cluster"}},"template":{"metadata":{"creationTimestamp":null,"labels":{"app.kubernetes.io/component":"rabbitmq","app.kubernetes.io/name":"rabbitmq-cluster","app.kubernetes.io/part-of":"rabbitmq"},"annotations":{"prometheus.io/port":"15692","prometheus.io/scrape":"true"}},"spec":{"volumes":[{"name":"plugins-conf","configMap":{"name":"rabbitmq-cluster-plugins-conf","defaultMode":420}},{"name":"rabbitmq-confd","projected":{"sources":[{"secret":{"name":"rabbitmq-cluster-default-user","items":[{"key":"default_user.conf","path":"default_user.conf"}]}},{"configMap":{"name":"rabbitmq-cluster-server-conf","items":[{"key":"operatorDefaults.conf","path":"operatorDefaults.conf"},{"key":"userDefinedConfiguration.conf","path":"userDefinedConfiguration.conf"}]}}],"defaultMode":420}},{"name":"rabbitmq-erlang-cookie","emptyDir":{}},{"name":"erlang-cookie-secret","secret":{"secretName":"rabbitmq-cluster-erlang-cookie","defaultMode":420}},{"name":"rabbitmq-plugins","emptyDir":{}},{"name":"pod-info","downwardAPI":{"items":[{"path":"skipPreStopChecks","fieldRef":{"apiVersion":"v1","fieldPath":"metadata.labels['skipPreStopChecks']"}}],"defaultMode":420}}],"initContainers":[{"name":"setup-container","image":"rabbitmq:3.8.12-management","command":["sh","-c","cp /tmp/erlang-cookie-secret/.erlang.cookie /var/lib/rabbitmq/.erlang.cookie \u0026\u0026 chown 999:999 /var/lib/rabbitmq/.erlang.cookie \u0026\u0026 chmod 600 /var/lib/rabbitmq/.erlang.cookie ; cp /tmp/rabbitmq-plugins/enabled_plugins /operator/enabled_plugins \u0026\u0026 chown 999:999 /operator/enabled_plugins ; chown 999:999 /var/lib/rabbitmq/mnesia/ ; echo '[default]' \u003e /var/lib/rabbitmq/.rabbitmqadmin.conf \u0026\u0026 sed -e 's/default_user/username/' -e 's/default_pass/password/' /tmp/default_user.conf \u003e\u003e /var/lib/rabbitmq/.rabbitmqadmin.conf \u0026\u0026 chown 999:999 /var/lib/rabbitmq/.rabbitmqadmin.conf \u0026\u0026 chmod 600 /var/lib/rabbitmq/.rabbitmqadmin.conf"],"resources":{"limits":{"cpu":"100m","memory":"500Mi"},"requests":{"cpu":"100m","memory":"500Mi"}},"volumeMounts":[{"name":"plugins-conf","mountPath":"/tmp/rabbitmq-plugins/"},{"name":"rabbitmq-erlang-cookie","mountPath":"/var/lib/rabbitmq/"},{"name":"erlang-cookie-secret","mountPath":"/tmp/erlang-cookie-secret/"},{"name":"rabbitmq-plugins","mountPath":"/operator"},{"name":"persistence","mountPath":"/var/lib/rabbitmq/mnesia/"},{"name":"rabbitmq-confd","mountPath":"/tmp/default_user.conf","subPath":"default_user.conf"}],"terminationMessagePath":"/dev/termination-log","terminationMessagePolicy":"File","imagePullPolicy":"IfNotPresent","securityContext":{"capabilities":{"drop":["FSETID","KILL","SETGID","SETUID","SETPCAP","NET_BIND_SERVICE","NET_RAW","SYS_CHROOT","MKNOD","AUDIT_WRITE","SETFCAP"]},"runAsUser":0}}],"containers":[{"name":"rabbitmq","image":"rabbitmq:3.8.12-management","ports":[{"name":"epmd","containerPort":4369,"protocol":"TCP"},{"name":"amqp","containerPort":5672,"protocol":"TCP"},{"name":"management","containerPort":15672,"protocol":"TCP"},{"name":"prometheus","containerPort":15692,"protocol":"TCP"}],"env":[{"name":"MY_POD_NAME","valueFrom":{"fieldRef":{"apiVersion":"v1","fieldPath":"metadata.name"}}},{"name":"MY_POD_NAMESPACE","valueFrom":{"fieldRef":{"apiVersion":"v1","fieldPath":"metadata.namespace"}}},{"name":"RABBITMQ_ENABLED_PLUGINS_FILE","value":"/operator/enabled_plugins"},{"name":"K8S_SERVICE_NAME","value":"rabbitmq-cluster-nodes"},{"name":"RABBITMQ_USE_LONGNAME","value":"true"},{"name":"RABBITMQ_NODENAME","value":"rabbit@$(MY_POD_NAME).$(K8S_SERVICE_NAME).$(MY_POD_NAMESPACE)"},{"name":"K8S_HOSTNAME_SUFFIX","value":".$(K8S_SERVICE_NAME).$(MY_POD_NAMESPACE)"}],"resources":{"limits":{"cpu":"2","memory":"2Gi"},"requests":{"cpu":"1","memory":"2Gi"}},"volumeMounts":[{"name":"rabbitmq-erlang-cookie","mountPath":"/var/lib/rabbitmq/"},{"name":"persistence","mountPath":"/var/lib/rabbitmq/mnesia/"},{"name":"rabbitmq-plugins","mountPath":"/operator"},{"name":"rabbitmq-confd","mountPath":"/etc/rabbitmq/conf.d/10-operatorDefaults.conf","subPath":"operatorDefaults.conf"},{"name":"rabbitmq-confd","mountPath":"/etc/rabbitmq/conf.d/11-default_user.conf","subPath":"default_user.conf"},{"name":"rabbitmq-confd","mountPath":"/etc/rabbitmq/conf.d/90-userDefinedConfiguration.conf","subPath":"userDefinedConfiguration.conf"},{"name":"pod-info","mountPath":"/etc/pod-info/"}],"readinessProbe":{"tcpSocket":{"port":"amqp"},"initialDelaySeconds":10,"timeoutSeconds":5,"periodSeconds":10,"successThreshold":1,"failureThreshold":3},"lifecycle":{"preStop":{"exec":{"command":["/bin/bash","-c","if [ ! -z \"$(cat /etc/pod-info/skipPreStopChecks)\" ]; then exit 0; fi; rabbitmq-upgrade await_online_quorum_plus_one -t 604800; rabbitmq-upgrade await_online_synchronized_mirror -t 604800; rabbitmq-upgrade drain -t 604800"]}}},"terminationMessagePath":"/dev/termination-log","terminationMessagePolicy":"File","imagePullPolicy":"IfNotPresent"}],"restartPolicy":"Always","terminationGracePeriodSeconds":604800,"dnsPolicy":"ClusterFirst","serviceAccountName":"rabbitmq-cluster-server","serviceAccount":"rabbitmq-cluster-server","automountServiceAccountToken":true,"securityContext":{"runAsUser":999,"runAsGroup":999,"fsGroup":999},"schedulerName":"default-scheduler","topologySpreadConstraints":[{"maxSkew":1,"topologyKey":"topology.kubernetes.io/zone","whenUnsatisfiable":"ScheduleAnyway","labelSelector":{"matchLabels":{"app.kubernetes.io/name":"rabbitmq-cluster"}}}]}},"volumeClaimTemplates":[{"metadata":{"name":"persistence","namespace":"default","creationTimestamp":null,"labels":{"app.kubernetes.io/component":"rabbitmq","app.kubernetes.io/name":"rabbitmq-cluster","app.kubernetes.io/part-of":"rabbitmq"},"ownerReferences":[{"apiVersion":"rabbitmq.com/v1beta1","kind":"RabbitmqCluster","name":"rabbitmq-cluster","uid":"18d9928b-0d1c-47be-80ec-20960d053827","controller":true,"blockOwnerDeletion":false}]},"spec":{"accessModes":["ReadWriteOnce"],"resources":{"requests":{"storage":"10Gi"}},"volumeMode":"Filesystem"},"status":{"phase":"Pending"}}],"serviceName":"rabbitmq-cluster-nodes","podManagementPolicy":"Parallel","updateStrategy":{"type":"RollingUpdate","rollingUpdate":{"partition":0}},"revisionHistoryLimit":10},"status":{"observedGeneration":1,"replicas":1,"readyReplicas":1,"currentReplicas":1,"updatedReplicas":1,"currentRevision":"rabbitmq-cluster-server-5f8b8665fb","updateRevision":"rabbitmq-cluster-server-5f8b8665fb","collisionCount":0}}
2022/03/18 18:01:23 learn_server.go:291: [SIEVE-AFTER-READ]	Get	true	statefulset	default	rabbitmq-cluster-server	github.com/rabbitmq/cluster-operator/controllers.(*RabbitmqClusterReconciler)	NoError	{"kind":"StatefulSet","apiVersion":"apps/v1","metadata":{"name":"rabbitmq-cluster-server","namespace":"default","selfLink":"/apis/apps/v1/namespaces/default/statefulsets/rabbitmq-cluster-server","uid":"cb5c43bc-6ee7-481c-ab01-6f3acffdd3c8","resourceVersion":"948","generation":1,"creationTimestamp":"2022-03-18T18:00:38Z","labels":{"app.kubernetes.io/component":"rabbitmq","app.kubernetes.io/name":"rabbitmq-cluster","app.kubernetes.io/part-of":"rabbitmq"},"ownerReferences":[{"apiVersion":"rabbitmq.com/v1beta1","kind":"RabbitmqCluster","name":"rabbitmq-cluster","uid":"18d9928b-0d1c-47be-80ec-20960d053827","controller":true,"blockOwnerDeletion":true}],"managedFields":[{"manager":"manager","operation":"Update","apiVersion":"apps/v1","time":"2022-03-18T18:00:38Z","fieldsType":"FieldsV1","fieldsV1":{"f:metadata":{"f:labels":{".":{},"f:app.kubernetes.io/component":{},"f:app.kubernetes.io/name":{},"f:app.kubernetes.io/part-of":{}},"f:ownerReferences":{".":{},"k:{\"uid\":\"18d9928b-0d1c-47be-80ec-20960d053827\"}":{".":{},"f:apiVersion":{},"f:blockOwnerDeletion":{},"f:controller":{},"f:kind":{},"f:name":{},"f:uid":{}}}},"f:spec":{"f:podManagementPolicy":{},"f:replicas":{},"f:revisionHistoryLimit":{},"f:selector":{"f:matchLabels":{".":{},"f:app.kubernetes.io/name":{}}},"f:serviceName":{},"f:template":{"f:metadata":{"f:annotations":{".":{},"f:prometheus.io/port":{},"f:prometheus.io/scrape":{}},"f:labels":{".":{},"f:app.kubernetes.io/component":{},"f:app.kubernetes.io/name":{},"f:app.kubernetes.io/part-of":{}}},"f:spec":{"f:automountServiceAccountToken":{},"f:containers":{"k:{\"name\":\"rabbitmq\"}":{".":{},"f:env":{".":{},"k:{\"name\":\"K8S_HOSTNAME_SUFFIX\"}":{".":{},"f:name":{},"f:value":{}},"k:{\"name\":\"K8S_SERVICE_NAME\"}":{".":{},"f:name":{},"f:value":{}},"k:{\"name\":\"MY_POD_NAME\"}":{".":{},"f:name":{},"f:valueFrom":{".":{},"f:fieldRef":{".":{},"f:apiVersion":{},"f:fieldPath":{}}}},"k:{\"name\":\"MY_POD_NAMESPACE\"}":{".":{},"f:name":{},"f:valueFrom":{".":{},"f:fieldRef":{".":{},"f:apiVersion":{},"f:fieldPath":{}}}},"k:{\"name\":\"RABBITMQ_ENABLED_PLUGINS_FILE\"}":{".":{},"f:name":{},"f:value":{}},"k:{\"name\":\"RABBITMQ_NODENAME\"}":{".":{},"f:name":{},"f:value":{}},"k:{\"name\":\"RABBITMQ_USE_LONGNAME\"}":{".":{},"f:name":{},"f:value":{}}},"f:image":{},"f:imagePullPolicy":{},"f:lifecycle":{".":{},"f:preStop":{".":{},"f:exec":{".":{},"f:command":{}}}},"f:name":{},"f:ports":{".":{},"k:{\"containerPort\":4369,\"protocol\":\"TCP\"}":{".":{},"f:containerPort":{},"f:name":{},"f:protocol":{}},"k:{\"containerPort\":5672,\"protocol\":\"TCP\"}":{".":{},"f:containerPort":{},"f:name":{},"f:protocol":{}},"k:{\"containerPort\":15672,\"protocol\":\"TCP\"}":{".":{},"f:containerPort":{},"f:name":{},"f:protocol":{}},"k:{\"containerPort\":15692,\"protocol\":\"TCP\"}":{".":{},"f:containerPort":{},"f:name":{},"f:protocol":{}}},"f:readinessProbe":{".":{},"f:failureThreshold":{},"f:initialDelaySeconds":{},"f:periodSeconds":{},"f:successThreshold":{},"f:tcpSocket":{".":{},"f:port":{}},"f:timeoutSeconds":{}},"f:resources":{".":{},"f:limits":{".":{},"f:cpu":{},"f:memory":{}},"f:requests":{".":{},"f:cpu":{},"f:memory":{}}},"f:terminationMessagePath":{},"f:terminationMessagePolicy":{},"f:volumeMounts":{".":{},"k:{\"mountPath\":\"/etc/pod-info/\"}":{".":{},"f:mountPath":{},"f:name":{}},"k:{\"mountPath\":\"/etc/rabbitmq/conf.d/10-operatorDefaults.conf\"}":{".":{},"f:mountPath":{},"f:name":{},"f:subPath":{}},"k:{\"mountPath\":\"/etc/rabbitmq/conf.d/11-default_user.conf\"}":{".":{},"f:mountPath":{},"f:name":{},"f:subPath":{}},"k:{\"mountPath\":\"/etc/rabbitmq/conf.d/90-userDefinedConfiguration.conf\"}":{".":{},"f:mountPath":{},"f:name":{},"f:subPath":{}},"k:{\"mountPath\":\"/operator\"}":{".":{},"f:mountPath":{},"f:name":{}},"k:{\"mountPath\":\"/var/lib/rabbitmq/\"}":{".":{},"f:mountPath":{},"f:name":{}},"k:{\"mountPath\":\"/var/lib/rabbitmq/mnesia/\"}":{".":{},"f:mountPath":{},"f:name":{}}}}},"f:dnsPolicy":{},"f:initContainers":{".":{},"k:{\"name\":\"setup-container\"}":{".":{},"f:command":{},"f:image":{},"f:imagePullPolicy":{},"f:name":{},"f:resources":{".":{},"f:limits":{".":{},"f:cpu":{},"f:memory":{}},"f:requests":{".":{},"f:cpu":{},"f:memory":{}}},"f:securityContext":{".":{},"f:capabilities":{".":{},"f:drop":{}},"f:runAsUser":{}},"f:terminationMessagePath":{},"f:terminationMessagePolicy":{},"f:volumeMounts":{".":{},"k:{\"mountPath\":\"/operator\"}":{".":{},"f:mountPath":{},"f:name":{}},"k:{\"mountPath\":\"/tmp/default_user.conf\"}":{".":{},"f:mountPath":{},"f:name":{},"f:subPath":{}},"k:{\"mountPath\":\"/tmp/erlang-cookie-secret/\"}":{".":{},"f:mountPath":{},"f:name":{}},"k:{\"mountPath\":\"/tmp/rabbitmq-plugins/\"}":{".":{},"f:mountPath":{},"f:name":{}},"k:{\"mountPath\":\"/var/lib/rabbitmq/\"}":{".":{},"f:mountPath":{},"f:name":{}},"k:{\"mountPath\":\"/var/lib/rabbitmq/mnesia/\"}":{".":{},"f:mountPath":{},"f:name":{}}}}},"f:restartPolicy":{},"f:schedulerName":{},"f:securityContext":{".":{},"f:fsGroup":{},"f:runAsGroup":{},"f:runAsUser":{}},"f:serviceAccount":{},"f:serviceAccountName":{},"f:terminationGracePeriodSeconds":{},"f:topologySpreadConstraints":{".":{},"k:{\"topologyKey\":\"topology.kubernetes.io/zone\",\"whenUnsatisfiable\":\"ScheduleAnyway\"}":{".":{},"f:labelSelector":{".":{},"f:matchLabels":{".":{},"f:app.kubernetes.io/name":{}}},"f:maxSkew":{},"f:topologyKey":{},"f:whenUnsatisfiable":{}}},"f:volumes":{".":{},"k:{\"name\":\"erlang-cookie-secret\"}":{".":{},"f:name":{},"f:secret":{".":{},"f:defaultMode":{},"f:secretName":{}}},"k:{\"name\":\"plugins-conf\"}":{".":{},"f:configMap":{".":{},"f:defaultMode":{},"f:name":{}},"f:name":{}},"k:{\"name\":\"pod-info\"}":{".":{},"f:downwardAPI":{".":{},"f:defaultMode":{},"f:items":{}},"f:name":{}},"k:{\"name\":\"rabbitmq-confd\"}":{".":{},"f:name":{},"f:projected":{".":{},"f:defaultMode":{},"f:sources":{}}},"k:{\"name\":\"rabbitmq-erlang-cookie\"}":{".":{},"f:emptyDir":{},"f:name":{}},"k:{\"name\":\"rabbitmq-plugins\"}":{".":{},"f:emptyDir":{},"f:name":{}}}}},"f:updateStrategy":{"f:rollingUpdate":{".":{},"f:partition":{}},"f:type":{}},"f:volumeClaimTemplates":{}}}},{"manager":"kube-controller-manager","operation":"Update","apiVersion":"apps/v1","time":"2022-03-18T18:01:17Z","fieldsType":"FieldsV1","fieldsV1":{"f:status":{"f:collisionCount":{},"f:currentReplicas":{},"f:currentRevision":{},"f:observedGeneration":{},"f:readyReplicas":{},"f:replicas":{},"f:updateRevision":{},"f:updatedReplicas":{}}}}]},"spec":{"replicas":1,"selector":{"matchLabels":{"app.kubernetes.io/name":"rabbitmq-cluster"}},"template":{"metadata":{"creationTimestamp":null,"labels":{"app.kubernetes.io/component":"rabbitmq","app.kubernetes.io/name":"rabbitmq-cluster","app.kubernetes.io/part-of":"rabbitmq"},"annotations":{"prometheus.io/port":"15692","prometheus.io/scrape":"true"}},"spec":{"volumes":[{"name":"plugins-conf","configMap":{"name":"rabbitmq-cluster-plugins-conf","defaultMode":420}},{"name":"rabbitmq-confd","projected":{"sources":[{"secret":{"name":"rabbitmq-cluster-default-user","items":[{"key":"default_user.conf","path":"default_user.conf"}]}},{"configMap":{"name":"rabbitmq-cluster-server-conf","items":[{"key":"operatorDefaults.conf","path":"operatorDefaults.conf"},{"key":"userDefinedConfiguration.conf","path":"userDefinedConfiguration.conf"}]}}],"defaultMode":420}},{"name":"rabbitmq-erlang-cookie","emptyDir":{}},{"name":"erlang-cookie-secret","secret":{"secretName":"rabbitmq-cluster-erlang-cookie","defaultMode":420}},{"name":"rabbitmq-plugins","emptyDir":{}},{"name":"pod-info","downwardAPI":{"items":[{"path":"skipPreStopChecks","fieldRef":{"apiVersion":"v1","fieldPath":"metadata.labels['skipPreStopChecks']"}}],"defaultMode":420}}],"initContainers":[{"name":"setup-container","image":"rabbitmq:3.8.12-management","command":["sh","-c","cp /tmp/erlang-cookie-secret/.erlang.cookie /var/lib/rabbitmq/.erlang.cookie \u0026\u0026 chown 999:999 /var/lib/rabbitmq/.erlang.cookie \u0026\u0026 chmod 600 /var/lib/rabbitmq/.erlang.cookie ; cp /tmp/rabbitmq-plugins/enabled_plugins /operator/enabled_plugins \u0026\u0026 chown 999:999 /operator/enabled_plugins ; chown 999:999 /var/lib/rabbitmq/mnesia/ ; echo '[default]' \u003e /var/lib/rabbitmq/.rabbitmqadmin.conf \u0026\u0026 sed -e 's/default_user/username/' -e 's/default_pass/password/' /tmp/default_user.conf \u003e\u003e /var/lib/rabbitmq/.rabbitmqadmin.conf \u0026\u0026 chown 999:999 /var/lib/rabbitmq/.rabbitmqadmin.conf \u0026\u0026 chmod 600 /var/lib/rabbitmq/.rabbitmqadmin.conf"],"resources":{"limits":{"cpu":"100m","memory":"500Mi"},"requests":{"cpu":"100m","memory":"500Mi"}},"volumeMounts":[{"name":"plugins-conf","mountPath":"/tmp/rabbitmq-plugins/"},{"name":"rabbitmq-erlang-cookie","mountPath":"/var/lib/rabbitmq/"},{"name":"erlang-cookie-secret","mountPath":"/tmp/erlang-cookie-secret/"},{"name":"rabbitmq-plugins","mountPath":"/operator"},{"name":"persistence","mountPath":"/var/lib/rabbitmq/mnesia/"},{"name":"rabbitmq-confd","mountPath":"/tmp/default_user.conf","subPath":"default_user.conf"}],"terminationMessagePath":"/dev/termination-log","terminationMessagePolicy":"File","imagePullPolicy":"IfNotPresent","securityContext":{"capabilities":{"drop":["FSETID","KILL","SETGID","SETUID","SETPCAP","NET_BIND_SERVICE","NET_RAW","SYS_CHROOT","MKNOD","AUDIT_WRITE","SETFCAP"]},"runAsUser":0}}],"containers":[{"name":"rabbitmq","image":"rabbitmq:3.8.12-management","ports":[{"name":"epmd","containerPort":4369,"protocol":"TCP"},{"name":"amqp","containerPort":5672,"protocol":"TCP"},{"name":"management","containerPort":15672,"protocol":"TCP"},{"name":"prometheus","containerPort":15692,"protocol":"TCP"}],"env":[{"name":"MY_POD_NAME","valueFrom":{"fieldRef":{"apiVersion":"v1","fieldPath":"metadata.name"}}},{"name":"MY_POD_NAMESPACE","valueFrom":{"fieldRef":{"apiVersion":"v1","fieldPath":"metadata.namespace"}}},{"name":"RABBITMQ_ENABLED_PLUGINS_FILE","value":"/operator/enabled_plugins"},{"name":"K8S_SERVICE_NAME","value":"rabbitmq-cluster-nodes"},{"name":"RABBITMQ_USE_LONGNAME","value":"true"},{"name":"RABBITMQ_NODENAME","value":"rabbit@$(MY_POD_NAME).$(K8S_SERVICE_NAME).$(MY_POD_NAMESPACE)"},{"name":"K8S_HOSTNAME_SUFFIX","value":".$(K8S_SERVICE_NAME).$(MY_POD_NAMESPACE)"}],"resources":{"limits":{"cpu":"2","memory":"2Gi"},"requests":{"cpu":"1","memory":"2Gi"}},"volumeMounts":[{"name":"rabbitmq-erlang-cookie","mountPath":"/var/lib/rabbitmq/"},{"name":"persistence","mountPath":"/var/lib/rabbitmq/mnesia/"},{"name":"rabbitmq-plugins","mountPath":"/operator"},{"name":"rabbitmq-confd","mountPath":"/etc/rabbitmq/conf.d/10-operatorDefaults.conf","subPath":"operatorDefaults.conf"},{"name":"rabbitmq-confd","mountPath":"/etc/rabbitmq/conf.d/11-default_user.conf","subPath":"default_user.conf"},{"name":"rabbitmq-confd","mountPath":"/etc/rabbitmq/conf.d/90-userDefinedConfiguration.conf","subPath":"userDefinedConfiguration.conf"},{"name":"pod-info","mountPath":"/etc/pod-info/"}],"readinessProbe":{"tcpSocket":{"port":"amqp"},"initialDelaySeconds":10,"timeoutSeconds":5,"periodSeconds":10,"successThreshold":1,"failureThreshold":3},"lifecycle":{"preStop":{"exec":{"command":["/bin/bash","-c","if [ ! -z \"$(cat /etc/pod-info/skipPreStopChecks)\" ]; then exit 0; fi; rabbitmq-upgrade await_online_quorum_plus_one -t 604800; rabbitmq-upgrade await_online_synchronized_mirror -t 604800; rabbitmq-upgrade drain -t 604800"]}}},"terminationMessagePath":"/dev/termination-log","terminationMessagePolicy":"File","imagePullPolicy":"IfNotPresent"}],"restartPolicy":"Always","terminationGracePeriodSeconds":604800,"dnsPolicy":"ClusterFirst","serviceAccountName":"rabbitmq-cluster-server","serviceAccount":"rabbitmq-cluster-server","automountServiceAccountToken":true,"securityContext":{"runAsUser":999,"runAsGroup":999,"fsGroup":999},"schedulerName":"default-scheduler","topologySpreadConstraints":[{"maxSkew":1,"topologyKey":"topology.kubernetes.io/zone","whenUnsatisfiable":"ScheduleAnyway","labelSelector":{"matchLabels":{"app.kubernetes.io/name":"rabbitmq-cluster"}}}]}},"volumeClaimTemplates":[{"metadata":{"name":"persistence","namespace":"default","creationTimestamp":null,"labels":{"app.kubernetes.io/component":"rabbitmq","app.kubernetes.io/name":"rabbitmq-cluster","app.kubernetes.io/part-of":"rabbitmq"},"ownerReferences":[{"apiVersion":"rabbitmq.com/v1beta1","kind":"RabbitmqCluster","name":"rabbitmq-cluster","uid":"18d9928b-0d1c-47be-80ec-20960d053827","controller":true,"blockOwnerDeletion":false}]},"spec":{"accessModes":["ReadWriteOnce"],"resources":{"requests":{"storage":"10Gi"}},"volumeMode":"Filesystem"},"status":{"phase":"Pending"}}],"serviceName":"rabbitmq-cluster-nodes","podManagementPolicy":"Parallel","updateStrategy":{"type":"RollingUpdate","rollingUpdate":{"partition":0}},"revisionHistoryLimit":10},"status":{"observedGeneration":1,"replicas":1,"readyReplicas":1,"currentReplicas":1,"updatedReplicas":1,"currentRevision":"rabbitmq-cluster-server-5f8b8665fb","updateRevision":"rabbitmq-cluster-server-5f8b8665fb","collisionCount":0}}
2022/03/18 18:01:23 learn_server.go:256: [SIEVE-BEFORE-WRITE]	38
2022/03/18 18:01:23 learn_server.go:279: [SIEVE-BEFORE-HEAR]	23	Updated	statefulset	{"metadata":{"name":"rabbitmq-cluster-server","namespace":"default","selfLink":"/apis/apps/v1/namespaces/default/statefulsets/rabbitmq-cluster-server","uid":"cb5c43bc-6ee7-481c-ab01-6f3acffdd3c8","resourceVersion":"974","generation":2,"creationTimestamp":"2022-03-18T18:00:38Z","labels":{"app.kubernetes.io/component":"rabbitmq","app.kubernetes.io/name":"rabbitmq-cluster","app.kubernetes.io/part-of":"rabbitmq"},"ownerReferences":[{"apiVersion":"rabbitmq.com/v1beta1","kind":"RabbitmqCluster","name":"rabbitmq-cluster","uid":"18d9928b-0d1c-47be-80ec-20960d053827","controller":true,"blockOwnerDeletion":true}],"managedFields":[{"manager":"kube-controller-manager","operation":"Update","apiVersion":"apps/v1","time":"2022-03-18T18:01:17Z","fieldsType":"FieldsV1","fieldsV1":{"f:status":{"f:collisionCount":{},"f:currentReplicas":{},"f:currentRevision":{},"f:observedGeneration":{},"f:readyReplicas":{},"f:replicas":{},"f:updateRevision":{},"f:updatedReplicas":{}}}},{"manager":"manager","operation":"Update","apiVersion":"apps/v1","time":"2022-03-18T18:01:23Z","fieldsType":"FieldsV1","fieldsV1":{"f:metadata":{"f:labels":{".":{},"f:app.kubernetes.io/component":{},"f:app.kubernetes.io/name":{},"f:app.kubernetes.io/part-of":{}},"f:ownerReferences":{".":{},"k:{\"uid\":\"18d9928b-0d1c-47be-80ec-20960d053827\"}":{".":{},"f:apiVersion":{},"f:blockOwnerDeletion":{},"f:controller":{},"f:kind":{},"f:name":{},"f:uid":{}}}},"f:spec":{"f:podManagementPolicy":{},"f:replicas":{},"f:revisionHistoryLimit":{},"f:selector":{"f:matchLabels":{".":{},"f:app.kubernetes.io/name":{}}},"f:serviceName":{},"f:template":{"f:metadata":{"f:annotations":{".":{},"f:prometheus.io/port":{},"f:prometheus.io/scrape":{}},"f:labels":{".":{},"f:app.kubernetes.io/component":{},"f:app.kubernetes.io/name":{},"f:app.kubernetes.io/part-of":{}}},"f:spec":{"f:automountServiceAccountToken":{},"f:containers":{"k:{\"name\":\"rabbitmq\"}":{".":{},"f:env":{".":{},"k:{\"name\":\"K8S_HOSTNAME_SUFFIX\"}":{".":{},"f:name":{},"f:value":{}},"k:{\"name\":\"K8S_SERVICE_NAME\"}":{".":{},"f:name":{},"f:value":{}},"k:{\"name\":\"MY_POD_NAME\"}":{".":{},"f:name":{},"f:valueFrom":{".":{},"f:fieldRef":{".":{},"f:apiVersion":{},"f:fieldPath":{}}}},"k:{\"name\":\"MY_POD_NAMESPACE\"}":{".":{},"f:name":{},"f:valueFrom":{".":{},"f:fieldRef":{".":{},"f:apiVersion":{},"f:fieldPath":{}}}},"k:{\"name\":\"RABBITMQ_ENABLED_PLUGINS_FILE\"}":{".":{},"f:name":{},"f:value":{}},"k:{\"name\":\"RABBITMQ_NODENAME\"}":{".":{},"f:name":{},"f:value":{}},"k:{\"name\":\"RABBITMQ_USE_LONGNAME\"}":{".":{},"f:name":{},"f:value":{}}},"f:image":{},"f:imagePullPolicy":{},"f:lifecycle":{".":{},"f:preStop":{".":{},"f:exec":{".":{},"f:command":{}}}},"f:name":{},"f:ports":{".":{},"k:{\"containerPort\":4369,\"protocol\":\"TCP\"}":{".":{},"f:containerPort":{},"f:name":{},"f:protocol":{}},"k:{\"containerPort\":5672,\"protocol\":\"TCP\"}":{".":{},"f:containerPort":{},"f:name":{},"f:protocol":{}},"k:{\"containerPort\":15672,\"protocol\":\"TCP\"}":{".":{},"f:containerPort":{},"f:name":{},"f:protocol":{}},"k:{\"containerPort\":15692,\"protocol\":\"TCP\"}":{".":{},"f:containerPort":{},"f:name":{},"f:protocol":{}}},"f:readinessProbe":{".":{},"f:failureThreshold":{},"f:initialDelaySeconds":{},"f:periodSeconds":{},"f:successThreshold":{},"f:tcpSocket":{".":{},"f:port":{}},"f:timeoutSeconds":{}},"f:resources":{".":{},"f:limits":{".":{},"f:cpu":{},"f:memory":{}},"f:requests":{".":{},"f:cpu":{},"f:memory":{}}},"f:terminationMessagePath":{},"f:terminationMessagePolicy":{},"f:volumeMounts":{".":{},"k:{\"mountPath\":\"/etc/pod-info/\"}":{".":{},"f:mountPath":{},"f:name":{}},"k:{\"mountPath\":\"/etc/rabbitmq/conf.d/10-operatorDefaults.conf\"}":{".":{},"f:mountPath":{},"f:name":{},"f:subPath":{}},"k:{\"mountPath\":\"/etc/rabbitmq/conf.d/11-default_user.conf\"}":{".":{},"f:mountPath":{},"f:name":{},"f:subPath":{}},"k:{\"mountPath\":\"/etc/rabbitmq/conf.d/90-userDefinedConfiguration.conf\"}":{".":{},"f:mountPath":{},"f:name":{},"f:subPath":{}},"k:{\"mountPath\":\"/operator\"}":{".":{},"f:mountPath":{},"f:name":{}},"k:{\"mountPath\":\"/var/lib/rabbitmq/\"}":{".":{},"f:mountPath":{},"f:name":{}},"k:{\"mountPath\":\"/var/lib/rabbitmq/mnesia/\"}":{".":{},"f:mountPath":{},"f:name":{}}}}},"f:dnsPolicy":{},"f:initContainers":{".":{},"k:{\"name\":\"setup-container\"}":{".":{},"f:command":{},"f:image":{},"f:imagePullPolicy":{},"f:name":{},"f:resources":{".":{},"f:limits":{".":{},"f:cpu":{},"f:memory":{}},"f:requests":{".":{},"f:cpu":{},"f:memory":{}}},"f:securityContext":{".":{},"f:capabilities":{".":{},"f:drop":{}},"f:runAsUser":{}},"f:terminationMessagePath":{},"f:terminationMessagePolicy":{},"f:volumeMounts":{".":{},"k:{\"mountPath\":\"/operator\"}":{".":{},"f:mountPath":{},"f:name":{}},"k:{\"mountPath\":\"/tmp/default_user.conf\"}":{".":{},"f:mountPath":{},"f:name":{},"f:subPath":{}},"k:{\"mountPath\":\"/tmp/erlang-cookie-secret/\"}":{".":{},"f:mountPath":{},"f:name":{}},"k:{\"mountPath\":\"/tmp/rabbitmq-plugins/\"}":{".":{},"f:mountPath":{},"f:name":{}},"k:{\"mountPath\":\"/var/lib/rabbitmq/\"}":{".":{},"f:mountPath":{},"f:name":{}},"k:{\"mountPath\":\"/var/lib/rabbitmq/mnesia/\"}":{".":{},"f:mountPath":{},"f:name":{}}}}},"f:restartPolicy":{},"f:schedulerName":{},"f:securityContext":{".":{},"f:fsGroup":{},"f:runAsGroup":{},"f:runAsUser":{}},"f:serviceAccount":{},"f:serviceAccountName":{},"f:terminationGracePeriodSeconds":{},"f:topologySpreadConstraints":{".":{},"k:{\"topologyKey\":\"topology.kubernetes.io/zone\",\"whenUnsatisfiable\":\"ScheduleAnyway\"}":{".":{},"f:labelSelector":{".":{},"f:matchLabels":{".":{},"f:app.kubernetes.io/name":{}}},"f:maxSkew":{},"f:topologyKey":{},"f:whenUnsatisfiable":{}}},"f:volumes":{".":{},"k:{\"name\":\"erlang-cookie-secret\"}":{".":{},"f:name":{},"f:secret":{".":{},"f:defaultMode":{},"f:secretName":{}}},"k:{\"name\":\"plugins-conf\"}":{".":{},"f:configMap":{".":{},"f:defaultMode":{},"f:name":{}},"f:name":{}},"k:{\"name\":\"pod-info\"}":{".":{},"f:downwardAPI":{".":{},"f:defaultMode":{},"f:items":{}},"f:name":{}},"k:{\"name\":\"rabbitmq-confd\"}":{".":{},"f:name":{},"f:projected":{".":{},"f:defaultMode":{},"f:sources":{}}},"k:{\"name\":\"rabbitmq-erlang-cookie\"}":{".":{},"f:emptyDir":{},"f:name":{}},"k:{\"name\":\"rabbitmq-plugins\"}":{".":{},"f:emptyDir":{},"f:name":{}}}}},"f:updateStrategy":{"f:rollingUpdate":{".":{},"f:partition":{}},"f:type":{}},"f:volumeClaimTemplates":{}}}}]},"spec":{"replicas":3,"selector":{"matchLabels":{"app.kubernetes.io/name":"rabbitmq-cluster"}},"template":{"metadata":{"creationTimestamp":null,"labels":{"app.kubernetes.io/component":"rabbitmq","app.kubernetes.io/name":"rabbitmq-cluster","app.kubernetes.io/part-of":"rabbitmq"},"annotations":{"prometheus.io/port":"15692","prometheus.io/scrape":"true"}},"spec":{"volumes":[{"name":"plugins-conf","configMap":{"name":"rabbitmq-cluster-plugins-conf","defaultMode":420}},{"name":"rabbitmq-confd","projected":{"sources":[{"secret":{"name":"rabbitmq-cluster-default-user","items":[{"key":"default_user.conf","path":"default_user.conf"}]}},{"configMap":{"name":"rabbitmq-cluster-server-conf","items":[{"key":"operatorDefaults.conf","path":"operatorDefaults.conf"},{"key":"userDefinedConfiguration.conf","path":"userDefinedConfiguration.conf"}]}}],"defaultMode":420}},{"name":"rabbitmq-erlang-cookie","emptyDir":{}},{"name":"erlang-cookie-secret","secret":{"secretName":"rabbitmq-cluster-erlang-cookie","defaultMode":420}},{"name":"rabbitmq-plugins","emptyDir":{}},{"name":"pod-info","downwardAPI":{"items":[{"path":"skipPreStopChecks","fieldRef":{"apiVersion":"v1","fieldPath":"metadata.labels['skipPreStopChecks']"}}],"defaultMode":420}}],"initContainers":[{"name":"setup-container","image":"rabbitmq:3.8.12-management","command":["sh","-c","cp /tmp/erlang-cookie-secret/.erlang.cookie /var/lib/rabbitmq/.erlang.cookie \u0026\u0026 chown 999:999 /var/lib/rabbitmq/.erlang.cookie \u0026\u0026 chmod 600 /var/lib/rabbitmq/.erlang.cookie ; cp /tmp/rabbitmq-plugins/enabled_plugins /operator/enabled_plugins \u0026\u0026 chown 999:999 /operator/enabled_plugins ; chown 999:999 /var/lib/rabbitmq/mnesia/ ; echo '[default]' \u003e /var/lib/rabbitmq/.rabbitmqadmin.conf \u0026\u0026 sed -e 's/default_user/username/' -e 's/default_pass/password/' /tmp/default_user.conf \u003e\u003e /var/lib/rabbitmq/.rabbitmqadmin.conf \u0026\u0026 chown 999:999 /var/lib/rabbitmq/.rabbitmqadmin.conf \u0026\u0026 chmod 600 /var/lib/rabbitmq/.rabbitmqadmin.conf"],"resources":{"limits":{"cpu":"100m","memory":"500Mi"},"requests":{"cpu":"100m","memory":"500Mi"}},"volumeMounts":[{"name":"plugins-conf","mountPath":"/tmp/rabbitmq-plugins/"},{"name":"rabbitmq-erlang-cookie","mountPath":"/var/lib/rabbitmq/"},{"name":"erlang-cookie-secret","mountPath":"/tmp/erlang-cookie-secret/"},{"name":"rabbitmq-plugins","mountPath":"/operator"},{"name":"persistence","mountPath":"/var/lib/rabbitmq/mnesia/"},{"name":"rabbitmq-confd","mountPath":"/tmp/default_user.conf","subPath":"default_user.conf"}],"terminationMessagePath":"/dev/termination-log","terminationMessagePolicy":"File","imagePullPolicy":"IfNotPresent","securityContext":{"capabilities":{"drop":["FSETID","KILL","SETGID","SETUID","SETPCAP","NET_BIND_SERVICE","NET_RAW","SYS_CHROOT","MKNOD","AUDIT_WRITE","SETFCAP"]},"runAsUser":0}}],"containers":[{"name":"rabbitmq","image":"rabbitmq:3.8.12-management","ports":[{"name":"epmd","containerPort":4369,"protocol":"TCP"},{"name":"amqp","containerPort":5672,"protocol":"TCP"},{"name":"management","containerPort":15672,"protocol":"TCP"},{"name":"prometheus","containerPort":15692,"protocol":"TCP"}],"env":[{"name":"MY_POD_NAME","valueFrom":{"fieldRef":{"apiVersion":"v1","fieldPath":"metadata.name"}}},{"name":"MY_POD_NAMESPACE","valueFrom":{"fieldRef":{"apiVersion":"v1","fieldPath":"metadata.namespace"}}},{"name":"RABBITMQ_ENABLED_PLUGINS_FILE","value":"/operator/enabled_plugins"},{"name":"K8S_SERVICE_NAME","value":"rabbitmq-cluster-nodes"},{"name":"RABBITMQ_USE_LONGNAME","value":"true"},{"name":"RABBITMQ_NODENAME","value":"rabbit@$(MY_POD_NAME).$(K8S_SERVICE_NAME).$(MY_POD_NAMESPACE)"},{"name":"K8S_HOSTNAME_SUFFIX","value":".$(K8S_SERVICE_NAME).$(MY_POD_NAMESPACE)"}],"resources":{"limits":{"cpu":"2","memory":"2Gi"},"requests":{"cpu":"1","memory":"2Gi"}},"volumeMounts":[{"name":"rabbitmq-erlang-cookie","mountPath":"/var/lib/rabbitmq/"},{"name":"persistence","mountPath":"/var/lib/rabbitmq/mnesia/"},{"name":"rabbitmq-plugins","mountPath":"/operator"},{"name":"rabbitmq-confd","mountPath":"/etc/rabbitmq/conf.d/10-operatorDefaults.conf","subPath":"operatorDefaults.conf"},{"name":"rabbitmq-confd","mountPath":"/etc/rabbitmq/conf.d/11-default_user.conf","subPath":"default_user.conf"},{"name":"rabbitmq-confd","mountPath":"/etc/rabbitmq/conf.d/90-userDefinedConfiguration.conf","subPath":"userDefinedConfiguration.conf"},{"name":"pod-info","mountPath":"/etc/pod-info/"}],"readinessProbe":{"tcpSocket":{"port":"amqp"},"initialDelaySeconds":10,"timeoutSeconds":5,"periodSeconds":10,"successThreshold":1,"failureThreshold":3},"lifecycle":{"preStop":{"exec":{"command":["/bin/bash","-c","if [ ! -z \"$(cat /etc/pod-info/skipPreStopChecks)\" ]; then exit 0; fi; rabbitmq-upgrade await_online_quorum_plus_one -t 604800; rabbitmq-upgrade await_online_synchronized_mirror -t 604800; rabbitmq-upgrade drain -t 604800"]}}},"terminationMessagePath":"/dev/termination-log","terminationMessagePolicy":"File","imagePullPolicy":"IfNotPresent"}],"restartPolicy":"Always","terminationGracePeriodSeconds":604800,"dnsPolicy":"ClusterFirst","serviceAccountName":"rabbitmq-cluster-server","serviceAccount":"rabbitmq-cluster-server","automountServiceAccountToken":true,"securityContext":{"runAsUser":999,"runAsGroup":999,"fsGroup":999},"schedulerName":"default-scheduler","topologySpreadConstraints":[{"maxSkew":1,"topologyKey":"topology.kubernetes.io/zone","whenUnsatisfiable":"ScheduleAnyway","labelSelector":{"matchLabels":{"app.kubernetes.io/name":"rabbitmq-cluster"}}}]}},"volumeClaimTemplates":[{"metadata":{"name":"persistence","namespace":"default","creationTimestamp":null,"labels":{"app.kubernetes.io/component":"rabbitmq","app.kubernetes.io/name":"rabbitmq-cluster","app.kubernetes.io/part-of":"rabbitmq"},"ownerReferences":[{"apiVersion":"rabbitmq.com/v1beta1","kind":"RabbitmqCluster","name":"rabbitmq-cluster","uid":"18d9928b-0d1c-47be-80ec-20960d053827","controller":true,"blockOwnerDeletion":false}]},"spec":{"accessModes":["ReadWriteOnce"],"resources":{"requests":{"storage":"10Gi"}},"volumeMode":"Filesystem"},"status":{"phase":"Pending"}}],"serviceName":"rabbitmq-cluster-nodes","podManagementPolicy":"Parallel","updateStrategy":{"type":"RollingUpdate","rollingUpdate":{"partition":0}},"revisionHistoryLimit":10},"status":{"observedGeneration":1,"replicas":1,"readyReplicas":1,"currentReplicas":1,"updatedReplicas":1,"currentRevision":"rabbitmq-cluster-server-5f8b8665fb","updateRevision":"rabbitmq-cluster-server-5f8b8665fb","collisionCount":0}}
2022/03/18 18:01:23 learn_server.go:263: [SIEVE-AFTER-WRITE]	38	Update	statefulset	github.com/rabbitmq/cluster-operator/controllers.(*RabbitmqClusterReconciler)	NoError	{"metadata":{"name":"rabbitmq-cluster-server","namespace":"default","selfLink":"/apis/apps/v1/namespaces/default/statefulsets/rabbitmq-cluster-server","uid":"cb5c43bc-6ee7-481c-ab01-6f3acffdd3c8","resourceVersion":"974","generation":2,"creationTimestamp":"2022-03-18T18:00:38Z","labels":{"app.kubernetes.io/component":"rabbitmq","app.kubernetes.io/name":"rabbitmq-cluster","app.kubernetes.io/part-of":"rabbitmq"},"ownerReferences":[{"apiVersion":"rabbitmq.com/v1beta1","kind":"RabbitmqCluster","name":"rabbitmq-cluster","uid":"18d9928b-0d1c-47be-80ec-20960d053827","controller":true,"blockOwnerDeletion":true}],"managedFields":[{"manager":"kube-controller-manager","operation":"Update","apiVersion":"apps/v1","time":"2022-03-18T18:01:17Z","fieldsType":"FieldsV1","fieldsV1":{"f:status":{"f:collisionCount":{},"f:currentReplicas":{},"f:currentRevision":{},"f:observedGeneration":{},"f:readyReplicas":{},"f:replicas":{},"f:updateRevision":{},"f:updatedReplicas":{}}}},{"manager":"manager","operation":"Update","apiVersion":"apps/v1","time":"2022-03-18T18:01:23Z","fieldsType":"FieldsV1","fieldsV1":{"f:metadata":{"f:labels":{".":{},"f:app.kubernetes.io/component":{},"f:app.kubernetes.io/name":{},"f:app.kubernetes.io/part-of":{}},"f:ownerReferences":{".":{},"k:{\"uid\":\"18d9928b-0d1c-47be-80ec-20960d053827\"}":{".":{},"f:apiVersion":{},"f:blockOwnerDeletion":{},"f:controller":{},"f:kind":{},"f:name":{},"f:uid":{}}}},"f:spec":{"f:podManagementPolicy":{},"f:replicas":{},"f:revisionHistoryLimit":{},"f:selector":{"f:matchLabels":{".":{},"f:app.kubernetes.io/name":{}}},"f:serviceName":{},"f:template":{"f:metadata":{"f:annotations":{".":{},"f:prometheus.io/port":{},"f:prometheus.io/scrape":{}},"f:labels":{".":{},"f:app.kubernetes.io/component":{},"f:app.kubernetes.io/name":{},"f:app.kubernetes.io/part-of":{}}},"f:spec":{"f:automountServiceAccountToken":{},"f:containers":{"k:{\"name\":\"rabbitmq\"}":{".":{},"f:env":{".":{},"k:{\"name\":\"K8S_HOSTNAME_SUFFIX\"}":{".":{},"f:name":{},"f:value":{}},"k:{\"name\":\"K8S_SERVICE_NAME\"}":{".":{},"f:name":{},"f:value":{}},"k:{\"name\":\"MY_POD_NAME\"}":{".":{},"f:name":{},"f:valueFrom":{".":{},"f:fieldRef":{".":{},"f:apiVersion":{},"f:fieldPath":{}}}},"k:{\"name\":\"MY_POD_NAMESPACE\"}":{".":{},"f:name":{},"f:valueFrom":{".":{},"f:fieldRef":{".":{},"f:apiVersion":{},"f:fieldPath":{}}}},"k:{\"name\":\"RABBITMQ_ENABLED_PLUGINS_FILE\"}":{".":{},"f:name":{},"f:value":{}},"k:{\"name\":\"RABBITMQ_NODENAME\"}":{".":{},"f:name":{},"f:value":{}},"k:{\"name\":\"RABBITMQ_USE_LONGNAME\"}":{".":{},"f:name":{},"f:value":{}}},"f:image":{},"f:imagePullPolicy":{},"f:lifecycle":{".":{},"f:preStop":{".":{},"f:exec":{".":{},"f:command":{}}}},"f:name":{},"f:ports":{".":{},"k:{\"containerPort\":4369,\"protocol\":\"TCP\"}":{".":{},"f:containerPort":{},"f:name":{},"f:protocol":{}},"k:{\"containerPort\":5672,\"protocol\":\"TCP\"}":{".":{},"f:containerPort":{},"f:name":{},"f:protocol":{}},"k:{\"containerPort\":15672,\"protocol\":\"TCP\"}":{".":{},"f:containerPort":{},"f:name":{},"f:protocol":{}},"k:{\"containerPort\":15692,\"protocol\":\"TCP\"}":{".":{},"f:containerPort":{},"f:name":{},"f:protocol":{}}},"f:readinessProbe":{".":{},"f:failureThreshold":{},"f:initialDelaySeconds":{},"f:periodSeconds":{},"f:successThreshold":{},"f:tcpSocket":{".":{},"f:port":{}},"f:timeoutSeconds":{}},"f:resources":{".":{},"f:limits":{".":{},"f:cpu":{},"f:memory":{}},"f:requests":{".":{},"f:cpu":{},"f:memory":{}}},"f:terminationMessagePath":{},"f:terminationMessagePolicy":{},"f:volumeMounts":{".":{},"k:{\"mountPath\":\"/etc/pod-info/\"}":{".":{},"f:mountPath":{},"f:name":{}},"k:{\"mountPath\":\"/etc/rabbitmq/conf.d/10-operatorDefaults.conf\"}":{".":{},"f:mountPath":{},"f:name":{},"f:subPath":{}},"k:{\"mountPath\":\"/etc/rabbitmq/conf.d/11-default_user.conf\"}":{".":{},"f:mountPath":{},"f:name":{},"f:subPath":{}},"k:{\"mountPath\":\"/etc/rabbitmq/conf.d/90-userDefinedConfiguration.conf\"}":{".":{},"f:mountPath":{},"f:name":{},"f:subPath":{}},"k:{\"mountPath\":\"/operator\"}":{".":{},"f:mountPath":{},"f:name":{}},"k:{\"mountPath\":\"/var/lib/rabbitmq/\"}":{".":{},"f:mountPath":{},"f:name":{}},"k:{\"mountPath\":\"/var/lib/rabbitmq/mnesia/\"}":{".":{},"f:mountPath":{},"f:name":{}}}}},"f:dnsPolicy":{},"f:initContainers":{".":{},"k:{\"name\":\"setup-container\"}":{".":{},"f:command":{},"f:image":{},"f:imagePullPolicy":{},"f:name":{},"f:resources":{".":{},"f:limits":{".":{},"f:cpu":{},"f:memory":{}},"f:requests":{".":{},"f:cpu":{},"f:memory":{}}},"f:securityContext":{".":{},"f:capabilities":{".":{},"f:drop":{}},"f:runAsUser":{}},"f:terminationMessagePath":{},"f:terminationMessagePolicy":{},"f:volumeMounts":{".":{},"k:{\"mountPath\":\"/operator\"}":{".":{},"f:mountPath":{},"f:name":{}},"k:{\"mountPath\":\"/tmp/default_user.conf\"}":{".":{},"f:mountPath":{},"f:name":{},"f:subPath":{}},"k:{\"mountPath\":\"/tmp/erlang-cookie-secret/\"}":{".":{},"f:mountPath":{},"f:name":{}},"k:{\"mountPath\":\"/tmp/rabbitmq-plugins/\"}":{".":{},"f:mountPath":{},"f:name":{}},"k:{\"mountPath\":\"/var/lib/rabbitmq/\"}":{".":{},"f:mountPath":{},"f:name":{}},"k:{\"mountPath\":\"/var/lib/rabbitmq/mnesia/\"}":{".":{},"f:mountPath":{},"f:name":{}}}}},"f:restartPolicy":{},"f:schedulerName":{},"f:securityContext":{".":{},"f:fsGroup":{},"f:runAsGroup":{},"f:runAsUser":{}},"f:serviceAccount":{},"f:serviceAccountName":{},"f:terminationGracePeriodSeconds":{},"f:topologySpreadConstraints":{".":{},"k:{\"topologyKey\":\"topology.kubernetes.io/zone\",\"whenUnsatisfiable\":\"ScheduleAnyway\"}":{".":{},"f:labelSelector":{".":{},"f:matchLabels":{".":{},"f:app.kubernetes.io/name":{}}},"f:maxSkew":{},"f:topologyKey":{},"f:whenUnsatisfiable":{}}},"f:volumes":{".":{},"k:{\"name\":\"erlang-cookie-secret\"}":{".":{},"f:name":{},"f:secret":{".":{},"f:defaultMode":{},"f:secretName":{}}},"k:{\"name\":\"plugins-conf\"}":{".":{},"f:configMap":{".":{},"f:defaultMode":{},"f:name":{}},"f:name":{}},"k:{\"name\":\"pod-info\"}":{".":{},"f:downwardAPI":{".":{},"f:defaultMode":{},"f:items":{}},"f:name":{}},"k:{\"name\":\"rabbitmq-confd\"}":{".":{},"f:name":{},"f:projected":{".":{},"f:defaultMode":{},"f:sources":{}}},"k:{\"name\":\"rabbitmq-erlang-cookie\"}":{".":{},"f:emptyDir":{},"f:name":{}},"k:{\"name\":\"rabbitmq-plugins\"}":{".":{},"f:emptyDir":{},"f:name":{}}}}},"f:updateStrategy":{"f:rollingUpdate":{".":{},"f:partition":{}},"f:type":{}},"f:volumeClaimTemplates":{}}}}]},"spec":{"replicas":3,"selector":{"matchLabels":{"app.kubernetes.io/name":"rabbitmq-cluster"}},"template":{"metadata":{"creationTimestamp":null,"labels":{"app.kubernetes.io/component":"rabbitmq","app.kubernetes.io/name":"rabbitmq-cluster","app.kubernetes.io/part-of":"rabbitmq"},"annotations":{"prometheus.io/port":"15692","prometheus.io/scrape":"true"}},"spec":{"volumes":[{"name":"plugins-conf","configMap":{"name":"rabbitmq-cluster-plugins-conf","defaultMode":420}},{"name":"rabbitmq-confd","projected":{"sources":[{"secret":{"name":"rabbitmq-cluster-default-user","items":[{"key":"default_user.conf","path":"default_user.conf"}]}},{"configMap":{"name":"rabbitmq-cluster-server-conf","items":[{"key":"operatorDefaults.conf","path":"operatorDefaults.conf"},{"key":"userDefinedConfiguration.conf","path":"userDefinedConfiguration.conf"}]}}],"defaultMode":420}},{"name":"rabbitmq-erlang-cookie","emptyDir":{}},{"name":"erlang-cookie-secret","secret":{"secretName":"rabbitmq-cluster-erlang-cookie","defaultMode":420}},{"name":"rabbitmq-plugins","emptyDir":{}},{"name":"pod-info","downwardAPI":{"items":[{"path":"skipPreStopChecks","fieldRef":{"apiVersion":"v1","fieldPath":"metadata.labels['skipPreStopChecks']"}}],"defaultMode":420}}],"initContainers":[{"name":"setup-container","image":"rabbitmq:3.8.12-management","command":["sh","-c","cp /tmp/erlang-cookie-secret/.erlang.cookie /var/lib/rabbitmq/.erlang.cookie \u0026\u0026 chown 999:999 /var/lib/rabbitmq/.erlang.cookie \u0026\u0026 chmod 600 /var/lib/rabbitmq/.erlang.cookie ; cp /tmp/rabbitmq-plugins/enabled_plugins /operator/enabled_plugins \u0026\u0026 chown 999:999 /operator/enabled_plugins ; chown 999:999 /var/lib/rabbitmq/mnesia/ ; echo '[default]' \u003e /var/lib/rabbitmq/.rabbitmqadmin.conf \u0026\u0026 sed -e 's/default_user/username/' -e 's/default_pass/password/' /tmp/default_user.conf \u003e\u003e /var/lib/rabbitmq/.rabbitmqadmin.conf \u0026\u0026 chown 999:999 /var/lib/rabbitmq/.rabbitmqadmin.conf \u0026\u0026 chmod 600 /var/lib/rabbitmq/.rabbitmqadmin.conf"],"resources":{"limits":{"cpu":"100m","memory":"500Mi"},"requests":{"cpu":"100m","memory":"500Mi"}},"volumeMounts":[{"name":"plugins-conf","mountPath":"/tmp/rabbitmq-plugins/"},{"name":"rabbitmq-erlang-cookie","mountPath":"/var/lib/rabbitmq/"},{"name":"erlang-cookie-secret","mountPath":"/tmp/erlang-cookie-secret/"},{"name":"rabbitmq-plugins","mountPath":"/operator"},{"name":"persistence","mountPath":"/var/lib/rabbitmq/mnesia/"},{"name":"rabbitmq-confd","mountPath":"/tmp/default_user.conf","subPath":"default_user.conf"}],"terminationMessagePath":"/dev/termination-log","terminationMessagePolicy":"File","imagePullPolicy":"IfNotPresent","securityContext":{"capabilities":{"drop":["FSETID","KILL","SETGID","SETUID","SETPCAP","NET_BIND_SERVICE","NET_RAW","SYS_CHROOT","MKNOD","AUDIT_WRITE","SETFCAP"]},"runAsUser":0}}],"containers":[{"name":"rabbitmq","image":"rabbitmq:3.8.12-management","ports":[{"name":"epmd","containerPort":4369,"protocol":"TCP"},{"name":"amqp","containerPort":5672,"protocol":"TCP"},{"name":"management","containerPort":15672,"protocol":"TCP"},{"name":"prometheus","containerPort":15692,"protocol":"TCP"}],"env":[{"name":"MY_POD_NAME","valueFrom":{"fieldRef":{"apiVersion":"v1","fieldPath":"metadata.name"}}},{"name":"MY_POD_NAMESPACE","valueFrom":{"fieldRef":{"apiVersion":"v1","fieldPath":"metadata.namespace"}}},{"name":"RABBITMQ_ENABLED_PLUGINS_FILE","value":"/operator/enabled_plugins"},{"name":"K8S_SERVICE_NAME","value":"rabbitmq-cluster-nodes"},{"name":"RABBITMQ_USE_LONGNAME","value":"true"},{"name":"RABBITMQ_NODENAME","value":"rabbit@$(MY_POD_NAME).$(K8S_SERVICE_NAME).$(MY_POD_NAMESPACE)"},{"name":"K8S_HOSTNAME_SUFFIX","value":".$(K8S_SERVICE_NAME).$(MY_POD_NAMESPACE)"}],"resources":{"limits":{"cpu":"2","memory":"2Gi"},"requests":{"cpu":"1","memory":"2Gi"}},"volumeMounts":[{"name":"rabbitmq-erlang-cookie","mountPath":"/var/lib/rabbitmq/"},{"name":"persistence","mountPath":"/var/lib/rabbitmq/mnesia/"},{"name":"rabbitmq-plugins","mountPath":"/operator"},{"name":"rabbitmq-confd","mountPath":"/etc/rabbitmq/conf.d/10-operatorDefaults.conf","subPath":"operatorDefaults.conf"},{"name":"rabbitmq-confd","mountPath":"/etc/rabbitmq/conf.d/11-default_user.conf","subPath":"default_user.conf"},{"name":"rabbitmq-confd","mountPath":"/etc/rabbitmq/conf.d/90-userDefinedConfiguration.conf","subPath":"userDefinedConfiguration.conf"},{"name":"pod-info","mountPath":"/etc/pod-info/"}],"readinessProbe":{"tcpSocket":{"port":"amqp"},"initialDelaySeconds":10,"timeoutSeconds":5,"periodSeconds":10,"successThreshold":1,"failureThreshold":3},"lifecycle":{"preStop":{"exec":{"command":["/bin/bash","-c","if [ ! -z \"$(cat /etc/pod-info/skipPreStopChecks)\" ]; then exit 0; fi; rabbitmq-upgrade await_online_quorum_plus_one -t 604800; rabbitmq-upgrade await_online_synchronized_mirror -t 604800; rabbitmq-upgrade drain -t 604800"]}}},"terminationMessagePath":"/dev/termination-log","terminationMessagePolicy":"File","imagePullPolicy":"IfNotPresent"}],"restartPolicy":"Always","terminationGracePeriodSeconds":604800,"dnsPolicy":"ClusterFirst","serviceAccountName":"rabbitmq-cluster-server","serviceAccount":"rabbitmq-cluster-server","automountServiceAccountToken":true,"securityContext":{"runAsUser":999,"runAsGroup":999,"fsGroup":999},"schedulerName":"default-scheduler","topologySpreadConstraints":[{"maxSkew":1,"topologyKey":"topology.kubernetes.io/zone","whenUnsatisfiable":"ScheduleAnyway","labelSelector":{"matchLabels":{"app.kubernetes.io/name":"rabbitmq-cluster"}}}]}},"volumeClaimTemplates":[{"metadata":{"name":"persistence","namespace":"default","creationTimestamp":null,"labels":{"app.kubernetes.io/component":"rabbitmq","app.kubernetes.io/name":"rabbitmq-cluster","app.kubernetes.io/part-of":"rabbitmq"},"ownerReferences":[{"apiVersion":"rabbitmq.com/v1beta1","kind":"RabbitmqCluster","name":"rabbitmq-cluster","uid":"18d9928b-0d1c-47be-80ec-20960d053827","controller":true,"blockOwnerDeletion":false}]},"spec":{"accessModes":["ReadWriteOnce"],"resources":{"requests":{"storage":"10Gi"}},"volumeMode":"Filesystem"},"status":{"phase":"Pending"}}],"serviceName":"rabbitmq-cluster-nodes","podManagementPolicy":"Parallel","updateStrategy":{"type":"RollingUpdate","rollingUpdate":{"partition":0}},"revisionHistoryLimit":10},"status":{"observedGeneration":1,"replicas":1,"readyReplicas":1,"currentReplicas":1,"updatedReplicas":1,"currentRevision":"rabbitmq-cluster-server-5f8b8665fb","updateRevision":"rabbitmq-cluster-server-5f8b8665fb","collisionCount":0}}
2022/03/18 18:01:23 learn_server.go:289: [SIEVE-AFTER-HEAR]	23
2022/03/18 18:01:23 learn_server.go:291: [SIEVE-AFTER-READ]	Get	true	configmap	default	rabbitmq-cluster-server-conf	github.com/rabbitmq/cluster-operator/controllers.(*RabbitmqClusterReconciler)	NoError	{"kind":"ConfigMap","apiVersion":"v1","metadata":{"name":"rabbitmq-cluster-server-conf","namespace":"default","selfLink":"/api/v1/namespaces/default/configmaps/rabbitmq-cluster-server-conf","uid":"22474f2b-8454-44b7-8079-8990223969cc","resourceVersion":"714","creationTimestamp":"2022-03-18T18:00:38Z","labels":{"app.kubernetes.io/component":"rabbitmq","app.kubernetes.io/name":"rabbitmq-cluster","app.kubernetes.io/part-of":"rabbitmq"},"ownerReferences":[{"apiVersion":"rabbitmq.com/v1beta1","kind":"RabbitmqCluster","name":"rabbitmq-cluster","uid":"18d9928b-0d1c-47be-80ec-20960d053827","controller":true,"blockOwnerDeletion":true}],"managedFields":[{"manager":"manager","operation":"Update","apiVersion":"v1","time":"2022-03-18T18:00:38Z","fieldsType":"FieldsV1","fieldsV1":{"f:data":{".":{},"f:operatorDefaults.conf":{},"f:userDefinedConfiguration.conf":{}},"f:metadata":{"f:labels":{".":{},"f:app.kubernetes.io/component":{},"f:app.kubernetes.io/name":{},"f:app.kubernetes.io/part-of":{}},"f:ownerReferences":{".":{},"k:{\"uid\":\"18d9928b-0d1c-47be-80ec-20960d053827\"}":{".":{},"f:apiVersion":{},"f:blockOwnerDeletion":{},"f:controller":{},"f:kind":{},"f:name":{},"f:uid":{}}}}}}]},"data":{"operatorDefaults.conf":"cluster_formation.peer_discovery_backend             = rabbit_peer_discovery_k8s\ncluster_formation.k8s.host                           = kubernetes.default\ncluster_formation.k8s.address_type                   = hostname\ncluster_partition_handling                           = pause_minority\nqueue_master_locator                                 = min-masters\ndisk_free_limit.absolute                             = 2GB\ncluster_formation.randomized_startup_delay_range.min = 5\ncluster_formation.randomized_startup_delay_range.max = 30\ncluster_name                                         = rabbitmq-cluster\n","userDefinedConfiguration.conf":"total_memory_available_override_value = 1717986919\n"}}
2022/03/18 18:01:23 learn_server.go:256: [SIEVE-BEFORE-WRITE]	39
2022/03/18 18:01:23 learn_server.go:263: [SIEVE-AFTER-WRITE]	39	StatusUpdate	rabbitmqcluster	github.com/rabbitmq/cluster-operator/controllers.(*RabbitmqClusterReconciler)	NoError	{"metadata":{"name":"rabbitmq-cluster","namespace":"default","selfLink":"/apis/rabbitmq.com/v1beta1/namespaces/default/rabbitmqclusters/rabbitmq-cluster/status","uid":"18d9928b-0d1c-47be-80ec-20960d053827","resourceVersion":"973","generation":3,"creationTimestamp":"2022-03-18T18:00:38Z","annotations":{"kubectl.kubernetes.io/last-applied-configuration":"{\"apiVersion\":\"rabbitmq.com/v1beta1\",\"kind\":\"RabbitmqCluster\",\"metadata\":{\"annotations\":{},\"name\":\"rabbitmq-cluster\",\"namespace\":\"default\"},\"spec\":{\"persistence\":{\"storage\":\"10Gi\"},\"replicas\":1}}\n"},"finalizers":["deletion.finalizers.rabbitmqclusters.rabbitmq.com"],"managedFields":[{"manager":"kubectl-client-side-apply","operation":"Update","apiVersion":"rabbitmq.com/v1beta1","time":"2022-03-18T18:00:38Z","fieldsType":"FieldsV1","fieldsV1":{"f:metadata":{"f:annotations":{".":{},"f:kubectl.kubernetes.io/last-applied-configuration":{}}},"f:spec":{".":{},"f:image":{},"f:persistence":{".":{},"f:storage":{}},"f:resources":{".":{},"f:limits":{".":{},"f:memory":{}},"f:requests":{".":{},"f:memory":{}}},"f:service":{".":{},"f:type":{}},"f:terminationGracePeriodSeconds":{}}}},{"manager":"manager","operation":"Update","apiVersion":"rabbitmq.com/v1beta1","time":"2022-03-18T18:01:18Z","fieldsType":"FieldsV1","fieldsV1":{"f:metadata":{"f:finalizers":{}},"f:spec":{"f:override":{},"f:rabbitmq":{},"f:resources":{"f:limits":{"f:cpu":{}},"f:requests":{"f:cpu":{}}},"f:tls":{}},"f:status":{".":{},"f:conditions":{},"f:defaultUser":{".":{},"f:secretReference":{".":{},"f:keys":{".":{},"f:password":{},"f:username":{}},"f:name":{},"f:namespace":{}},"f:serviceReference":{".":{},"f:name":{},"f:namespace":{}}}}}},{"manager":"kubectl-patch","operation":"Update","apiVersion":"rabbitmq.com/v1beta1","time":"2022-03-18T18:01:23Z","fieldsType":"FieldsV1","fieldsV1":{"f:spec":{"f:replicas":{}}}}]},"spec":{"replicas":3,"image":"rabbitmq:3.8.12-management","service":{"type":"ClusterIP"},"persistence":{"storage":"10Gi"},"resources":{"limits":{"cpu":"2","memory":"2Gi"},"requests":{"cpu":"1","memory":"2Gi"}},"rabbitmq":{},"tls":{},"override":{},"terminationGracePeriodSeconds":604800},"status":{"conditions":[{"type":"AllReplicasReady","status":"True","lastTransitionTime":"2022-03-18T18:01:17Z","reason":"AllPodsAreReady"},{"type":"ClusterAvailable","status":"True","lastTransitionTime":"2022-03-18T18:01:17Z","reason":"AtLeastOneEndpointAvailable"},{"type":"NoWarnings","status":"True","lastTransitionTime":"2022-03-18T18:00:38Z","reason":"NoWarnings"},{"type":"ReconcileSuccess","status":"True","lastTransitionTime":"2022-03-18T18:01:18Z","reason":"Success","message":"Finish reconciling"}],"defaultUser":{"secretReference":{"name":"rabbitmq-cluster-default-user","namespace":"default","keys":{"password":"password","username":"username"}},"serviceReference":{"name":"rabbitmq-cluster","namespace":"default"}},"binding":{"name":"rabbitmq-cluster-default-user"}}}
2022/03/18 18:01:23 learn_server.go:291: [SIEVE-AFTER-READ]	Get	true	statefulset	default	rabbitmq-cluster-server	github.com/rabbitmq/cluster-operator/controllers.(*RabbitmqClusterReconciler)	NoError	{"kind":"StatefulSet","apiVersion":"apps/v1","metadata":{"name":"rabbitmq-cluster-server","namespace":"default","selfLink":"/apis/apps/v1/namespaces/default/statefulsets/rabbitmq-cluster-server","uid":"cb5c43bc-6ee7-481c-ab01-6f3acffdd3c8","resourceVersion":"974","generation":2,"creationTimestamp":"2022-03-18T18:00:38Z","labels":{"app.kubernetes.io/component":"rabbitmq","app.kubernetes.io/name":"rabbitmq-cluster","app.kubernetes.io/part-of":"rabbitmq"},"ownerReferences":[{"apiVersion":"rabbitmq.com/v1beta1","kind":"RabbitmqCluster","name":"rabbitmq-cluster","uid":"18d9928b-0d1c-47be-80ec-20960d053827","controller":true,"blockOwnerDeletion":true}],"managedFields":[{"manager":"kube-controller-manager","operation":"Update","apiVersion":"apps/v1","time":"2022-03-18T18:01:17Z","fieldsType":"FieldsV1","fieldsV1":{"f:status":{"f:collisionCount":{},"f:currentReplicas":{},"f:currentRevision":{},"f:observedGeneration":{},"f:readyReplicas":{},"f:replicas":{},"f:updateRevision":{},"f:updatedReplicas":{}}}},{"manager":"manager","operation":"Update","apiVersion":"apps/v1","time":"2022-03-18T18:01:23Z","fieldsType":"FieldsV1","fieldsV1":{"f:metadata":{"f:labels":{".":{},"f:app.kubernetes.io/component":{},"f:app.kubernetes.io/name":{},"f:app.kubernetes.io/part-of":{}},"f:ownerReferences":{".":{},"k:{\"uid\":\"18d9928b-0d1c-47be-80ec-20960d053827\"}":{".":{},"f:apiVersion":{},"f:blockOwnerDeletion":{},"f:controller":{},"f:kind":{},"f:name":{},"f:uid":{}}}},"f:spec":{"f:podManagementPolicy":{},"f:replicas":{},"f:revisionHistoryLimit":{},"f:selector":{"f:matchLabels":{".":{},"f:app.kubernetes.io/name":{}}},"f:serviceName":{},"f:template":{"f:metadata":{"f:annotations":{".":{},"f:prometheus.io/port":{},"f:prometheus.io/scrape":{}},"f:labels":{".":{},"f:app.kubernetes.io/component":{},"f:app.kubernetes.io/name":{},"f:app.kubernetes.io/part-of":{}}},"f:spec":{"f:automountServiceAccountToken":{},"f:containers":{"k:{\"name\":\"rabbitmq\"}":{".":{},"f:env":{".":{},"k:{\"name\":\"K8S_HOSTNAME_SUFFIX\"}":{".":{},"f:name":{},"f:value":{}},"k:{\"name\":\"K8S_SERVICE_NAME\"}":{".":{},"f:name":{},"f:value":{}},"k:{\"name\":\"MY_POD_NAME\"}":{".":{},"f:name":{},"f:valueFrom":{".":{},"f:fieldRef":{".":{},"f:apiVersion":{},"f:fieldPath":{}}}},"k:{\"name\":\"MY_POD_NAMESPACE\"}":{".":{},"f:name":{},"f:valueFrom":{".":{},"f:fieldRef":{".":{},"f:apiVersion":{},"f:fieldPath":{}}}},"k:{\"name\":\"RABBITMQ_ENABLED_PLUGINS_FILE\"}":{".":{},"f:name":{},"f:value":{}},"k:{\"name\":\"RABBITMQ_NODENAME\"}":{".":{},"f:name":{},"f:value":{}},"k:{\"name\":\"RABBITMQ_USE_LONGNAME\"}":{".":{},"f:name":{},"f:value":{}}},"f:image":{},"f:imagePullPolicy":{},"f:lifecycle":{".":{},"f:preStop":{".":{},"f:exec":{".":{},"f:command":{}}}},"f:name":{},"f:ports":{".":{},"k:{\"containerPort\":4369,\"protocol\":\"TCP\"}":{".":{},"f:containerPort":{},"f:name":{},"f:protocol":{}},"k:{\"containerPort\":5672,\"protocol\":\"TCP\"}":{".":{},"f:containerPort":{},"f:name":{},"f:protocol":{}},"k:{\"containerPort\":15672,\"protocol\":\"TCP\"}":{".":{},"f:containerPort":{},"f:name":{},"f:protocol":{}},"k:{\"containerPort\":15692,\"protocol\":\"TCP\"}":{".":{},"f:containerPort":{},"f:name":{},"f:protocol":{}}},"f:readinessProbe":{".":{},"f:failureThreshold":{},"f:initialDelaySeconds":{},"f:periodSeconds":{},"f:successThreshold":{},"f:tcpSocket":{".":{},"f:port":{}},"f:timeoutSeconds":{}},"f:resources":{".":{},"f:limits":{".":{},"f:cpu":{},"f:memory":{}},"f:requests":{".":{},"f:cpu":{},"f:memory":{}}},"f:terminationMessagePath":{},"f:terminationMessagePolicy":{},"f:volumeMounts":{".":{},"k:{\"mountPath\":\"/etc/pod-info/\"}":{".":{},"f:mountPath":{},"f:name":{}},"k:{\"mountPath\":\"/etc/rabbitmq/conf.d/10-operatorDefaults.conf\"}":{".":{},"f:mountPath":{},"f:name":{},"f:subPath":{}},"k:{\"mountPath\":\"/etc/rabbitmq/conf.d/11-default_user.conf\"}":{".":{},"f:mountPath":{},"f:name":{},"f:subPath":{}},"k:{\"mountPath\":\"/etc/rabbitmq/conf.d/90-userDefinedConfiguration.conf\"}":{".":{},"f:mountPath":{},"f:name":{},"f:subPath":{}},"k:{\"mountPath\":\"/operator\"}":{".":{},"f:mountPath":{},"f:name":{}},"k:{\"mountPath\":\"/var/lib/rabbitmq/\"}":{".":{},"f:mountPath":{},"f:name":{}},"k:{\"mountPath\":\"/var/lib/rabbitmq/mnesia/\"}":{".":{},"f:mountPath":{},"f:name":{}}}}},"f:dnsPolicy":{},"f:initContainers":{".":{},"k:{\"name\":\"setup-container\"}":{".":{},"f:command":{},"f:image":{},"f:imagePullPolicy":{},"f:name":{},"f:resources":{".":{},"f:limits":{".":{},"f:cpu":{},"f:memory":{}},"f:requests":{".":{},"f:cpu":{},"f:memory":{}}},"f:securityContext":{".":{},"f:capabilities":{".":{},"f:drop":{}},"f:runAsUser":{}},"f:terminationMessagePath":{},"f:terminationMessagePolicy":{},"f:volumeMounts":{".":{},"k:{\"mountPath\":\"/operator\"}":{".":{},"f:mountPath":{},"f:name":{}},"k:{\"mountPath\":\"/tmp/default_user.conf\"}":{".":{},"f:mountPath":{},"f:name":{},"f:subPath":{}},"k:{\"mountPath\":\"/tmp/erlang-cookie-secret/\"}":{".":{},"f:mountPath":{},"f:name":{}},"k:{\"mountPath\":\"/tmp/rabbitmq-plugins/\"}":{".":{},"f:mountPath":{},"f:name":{}},"k:{\"mountPath\":\"/var/lib/rabbitmq/\"}":{".":{},"f:mountPath":{},"f:name":{}},"k:{\"mountPath\":\"/var/lib/rabbitmq/mnesia/\"}":{".":{},"f:mountPath":{},"f:name":{}}}}},"f:restartPolicy":{},"f:schedulerName":{},"f:securityContext":{".":{},"f:fsGroup":{},"f:runAsGroup":{},"f:runAsUser":{}},"f:serviceAccount":{},"f:serviceAccountName":{},"f:terminationGracePeriodSeconds":{},"f:topologySpreadConstraints":{".":{},"k:{\"topologyKey\":\"topology.kubernetes.io/zone\",\"whenUnsatisfiable\":\"ScheduleAnyway\"}":{".":{},"f:labelSelector":{".":{},"f:matchLabels":{".":{},"f:app.kubernetes.io/name":{}}},"f:maxSkew":{},"f:topologyKey":{},"f:whenUnsatisfiable":{}}},"f:volumes":{".":{},"k:{\"name\":\"erlang-cookie-secret\"}":{".":{},"f:name":{},"f:secret":{".":{},"f:defaultMode":{},"f:secretName":{}}},"k:{\"name\":\"plugins-conf\"}":{".":{},"f:configMap":{".":{},"f:defaultMode":{},"f:name":{}},"f:name":{}},"k:{\"name\":\"pod-info\"}":{".":{},"f:downwardAPI":{".":{},"f:defaultMode":{},"f:items":{}},"f:name":{}},"k:{\"name\":\"rabbitmq-confd\"}":{".":{},"f:name":{},"f:projected":{".":{},"f:defaultMode":{},"f:sources":{}}},"k:{\"name\":\"rabbitmq-erlang-cookie\"}":{".":{},"f:emptyDir":{},"f:name":{}},"k:{\"name\":\"rabbitmq-plugins\"}":{".":{},"f:emptyDir":{},"f:name":{}}}}},"f:updateStrategy":{"f:rollingUpdate":{".":{},"f:partition":{}},"f:type":{}},"f:volumeClaimTemplates":{}}}}]},"spec":{"replicas":3,"selector":{"matchLabels":{"app.kubernetes.io/name":"rabbitmq-cluster"}},"template":{"metadata":{"creationTimestamp":null,"labels":{"app.kubernetes.io/component":"rabbitmq","app.kubernetes.io/name":"rabbitmq-cluster","app.kubernetes.io/part-of":"rabbitmq"},"annotations":{"prometheus.io/port":"15692","prometheus.io/scrape":"true"}},"spec":{"volumes":[{"name":"plugins-conf","configMap":{"name":"rabbitmq-cluster-plugins-conf","defaultMode":420}},{"name":"rabbitmq-confd","projected":{"sources":[{"secret":{"name":"rabbitmq-cluster-default-user","items":[{"key":"default_user.conf","path":"default_user.conf"}]}},{"configMap":{"name":"rabbitmq-cluster-server-conf","items":[{"key":"operatorDefaults.conf","path":"operatorDefaults.conf"},{"key":"userDefinedConfiguration.conf","path":"userDefinedConfiguration.conf"}]}}],"defaultMode":420}},{"name":"rabbitmq-erlang-cookie","emptyDir":{}},{"name":"erlang-cookie-secret","secret":{"secretName":"rabbitmq-cluster-erlang-cookie","defaultMode":420}},{"name":"rabbitmq-plugins","emptyDir":{}},{"name":"pod-info","downwardAPI":{"items":[{"path":"skipPreStopChecks","fieldRef":{"apiVersion":"v1","fieldPath":"metadata.labels['skipPreStopChecks']"}}],"defaultMode":420}}],"initContainers":[{"name":"setup-container","image":"rabbitmq:3.8.12-management","command":["sh","-c","cp /tmp/erlang-cookie-secret/.erlang.cookie /var/lib/rabbitmq/.erlang.cookie \u0026\u0026 chown 999:999 /var/lib/rabbitmq/.erlang.cookie \u0026\u0026 chmod 600 /var/lib/rabbitmq/.erlang.cookie ; cp /tmp/rabbitmq-plugins/enabled_plugins /operator/enabled_plugins \u0026\u0026 chown 999:999 /operator/enabled_plugins ; chown 999:999 /var/lib/rabbitmq/mnesia/ ; echo '[default]' \u003e /var/lib/rabbitmq/.rabbitmqadmin.conf \u0026\u0026 sed -e 's/default_user/username/' -e 's/default_pass/password/' /tmp/default_user.conf \u003e\u003e /var/lib/rabbitmq/.rabbitmqadmin.conf \u0026\u0026 chown 999:999 /var/lib/rabbitmq/.rabbitmqadmin.conf \u0026\u0026 chmod 600 /var/lib/rabbitmq/.rabbitmqadmin.conf"],"resources":{"limits":{"cpu":"100m","memory":"500Mi"},"requests":{"cpu":"100m","memory":"500Mi"}},"volumeMounts":[{"name":"plugins-conf","mountPath":"/tmp/rabbitmq-plugins/"},{"name":"rabbitmq-erlang-cookie","mountPath":"/var/lib/rabbitmq/"},{"name":"erlang-cookie-secret","mountPath":"/tmp/erlang-cookie-secret/"},{"name":"rabbitmq-plugins","mountPath":"/operator"},{"name":"persistence","mountPath":"/var/lib/rabbitmq/mnesia/"},{"name":"rabbitmq-confd","mountPath":"/tmp/default_user.conf","subPath":"default_user.conf"}],"terminationMessagePath":"/dev/termination-log","terminationMessagePolicy":"File","imagePullPolicy":"IfNotPresent","securityContext":{"capabilities":{"drop":["FSETID","KILL","SETGID","SETUID","SETPCAP","NET_BIND_SERVICE","NET_RAW","SYS_CHROOT","MKNOD","AUDIT_WRITE","SETFCAP"]},"runAsUser":0}}],"containers":[{"name":"rabbitmq","image":"rabbitmq:3.8.12-management","ports":[{"name":"epmd","containerPort":4369,"protocol":"TCP"},{"name":"amqp","containerPort":5672,"protocol":"TCP"},{"name":"management","containerPort":15672,"protocol":"TCP"},{"name":"prometheus","containerPort":15692,"protocol":"TCP"}],"env":[{"name":"MY_POD_NAME","valueFrom":{"fieldRef":{"apiVersion":"v1","fieldPath":"metadata.name"}}},{"name":"MY_POD_NAMESPACE","valueFrom":{"fieldRef":{"apiVersion":"v1","fieldPath":"metadata.namespace"}}},{"name":"RABBITMQ_ENABLED_PLUGINS_FILE","value":"/operator/enabled_plugins"},{"name":"K8S_SERVICE_NAME","value":"rabbitmq-cluster-nodes"},{"name":"RABBITMQ_USE_LONGNAME","value":"true"},{"name":"RABBITMQ_NODENAME","value":"rabbit@$(MY_POD_NAME).$(K8S_SERVICE_NAME).$(MY_POD_NAMESPACE)"},{"name":"K8S_HOSTNAME_SUFFIX","value":".$(K8S_SERVICE_NAME).$(MY_POD_NAMESPACE)"}],"resources":{"limits":{"cpu":"2","memory":"2Gi"},"requests":{"cpu":"1","memory":"2Gi"}},"volumeMounts":[{"name":"rabbitmq-erlang-cookie","mountPath":"/var/lib/rabbitmq/"},{"name":"persistence","mountPath":"/var/lib/rabbitmq/mnesia/"},{"name":"rabbitmq-plugins","mountPath":"/operator"},{"name":"rabbitmq-confd","mountPath":"/etc/rabbitmq/conf.d/10-operatorDefaults.conf","subPath":"operatorDefaults.conf"},{"name":"rabbitmq-confd","mountPath":"/etc/rabbitmq/conf.d/11-default_user.conf","subPath":"default_user.conf"},{"name":"rabbitmq-confd","mountPath":"/etc/rabbitmq/conf.d/90-userDefinedConfiguration.conf","subPath":"userDefinedConfiguration.conf"},{"name":"pod-info","mountPath":"/etc/pod-info/"}],"readinessProbe":{"tcpSocket":{"port":"amqp"},"initialDelaySeconds":10,"timeoutSeconds":5,"periodSeconds":10,"successThreshold":1,"failureThreshold":3},"lifecycle":{"preStop":{"exec":{"command":["/bin/bash","-c","if [ ! -z \"$(cat /etc/pod-info/skipPreStopChecks)\" ]; then exit 0; fi; rabbitmq-upgrade await_online_quorum_plus_one -t 604800; rabbitmq-upgrade await_online_synchronized_mirror -t 604800; rabbitmq-upgrade drain -t 604800"]}}},"terminationMessagePath":"/dev/termination-log","terminationMessagePolicy":"File","imagePullPolicy":"IfNotPresent"}],"restartPolicy":"Always","terminationGracePeriodSeconds":604800,"dnsPolicy":"ClusterFirst","serviceAccountName":"rabbitmq-cluster-server","serviceAccount":"rabbitmq-cluster-server","automountServiceAccountToken":true,"securityContext":{"runAsUser":999,"runAsGroup":999,"fsGroup":999},"schedulerName":"default-scheduler","topologySpreadConstraints":[{"maxSkew":1,"topologyKey":"topology.kubernetes.io/zone","whenUnsatisfiable":"ScheduleAnyway","labelSelector":{"matchLabels":{"app.kubernetes.io/name":"rabbitmq-cluster"}}}]}},"volumeClaimTemplates":[{"metadata":{"name":"persistence","namespace":"default","creationTimestamp":null,"labels":{"app.kubernetes.io/component":"rabbitmq","app.kubernetes.io/name":"rabbitmq-cluster","app.kubernetes.io/part-of":"rabbitmq"},"ownerReferences":[{"apiVersion":"rabbitmq.com/v1beta1","kind":"RabbitmqCluster","name":"rabbitmq-cluster","uid":"18d9928b-0d1c-47be-80ec-20960d053827","controller":true,"blockOwnerDeletion":false}]},"spec":{"accessModes":["ReadWriteOnce"],"resources":{"requests":{"storage":"10Gi"}},"volumeMode":"Filesystem"},"status":{"phase":"Pending"}}],"serviceName":"rabbitmq-cluster-nodes","podManagementPolicy":"Parallel","updateStrategy":{"type":"RollingUpdate","rollingUpdate":{"partition":0}},"revisionHistoryLimit":10},"status":{"observedGeneration":1,"replicas":1,"readyReplicas":1,"currentReplicas":1,"updatedReplicas":1,"currentRevision":"rabbitmq-cluster-server-5f8b8665fb","updateRevision":"rabbitmq-cluster-server-5f8b8665fb","collisionCount":0}}
2022/03/18 18:01:23 learn_server.go:253: [SIEVE-AFTER-RECONCILE]	github.com/rabbitmq/cluster-operator/controllers.(*RabbitmqClusterReconciler)	9
2022/03/18 18:01:23 learn_server.go:238: [SIEVE-BEFORE-RECONCILE]	github.com/rabbitmq/cluster-operator/controllers.(*RabbitmqClusterReconciler)	10
2022/03/18 18:01:23 learn_server.go:291: [SIEVE-AFTER-READ]	Get	true	rabbitmqcluster	default	rabbitmq-cluster	github.com/rabbitmq/cluster-operator/controllers.(*RabbitmqClusterReconciler)	NoError	{"kind":"RabbitmqCluster","apiVersion":"rabbitmq.com/v1beta1","metadata":{"name":"rabbitmq-cluster","namespace":"default","selfLink":"/apis/rabbitmq.com/v1beta1/namespaces/default/rabbitmqclusters/rabbitmq-cluster","uid":"18d9928b-0d1c-47be-80ec-20960d053827","resourceVersion":"973","generation":3,"creationTimestamp":"2022-03-18T18:00:38Z","annotations":{"kubectl.kubernetes.io/last-applied-configuration":"{\"apiVersion\":\"rabbitmq.com/v1beta1\",\"kind\":\"RabbitmqCluster\",\"metadata\":{\"annotations\":{},\"name\":\"rabbitmq-cluster\",\"namespace\":\"default\"},\"spec\":{\"persistence\":{\"storage\":\"10Gi\"},\"replicas\":1}}\n"},"finalizers":["deletion.finalizers.rabbitmqclusters.rabbitmq.com"],"managedFields":[{"manager":"kubectl-client-side-apply","operation":"Update","apiVersion":"rabbitmq.com/v1beta1","time":"2022-03-18T18:00:38Z","fieldsType":"FieldsV1","fieldsV1":{"f:metadata":{"f:annotations":{".":{},"f:kubectl.kubernetes.io/last-applied-configuration":{}}},"f:spec":{".":{},"f:image":{},"f:persistence":{".":{},"f:storage":{}},"f:resources":{".":{},"f:limits":{".":{},"f:memory":{}},"f:requests":{".":{},"f:memory":{}}},"f:service":{".":{},"f:type":{}},"f:terminationGracePeriodSeconds":{}}}},{"manager":"manager","operation":"Update","apiVersion":"rabbitmq.com/v1beta1","time":"2022-03-18T18:01:18Z","fieldsType":"FieldsV1","fieldsV1":{"f:metadata":{"f:finalizers":{}},"f:spec":{"f:override":{},"f:rabbitmq":{},"f:resources":{"f:limits":{"f:cpu":{}},"f:requests":{"f:cpu":{}}},"f:tls":{}},"f:status":{".":{},"f:conditions":{},"f:defaultUser":{".":{},"f:secretReference":{".":{},"f:keys":{".":{},"f:password":{},"f:username":{}},"f:name":{},"f:namespace":{}},"f:serviceReference":{".":{},"f:name":{},"f:namespace":{}}}}}},{"manager":"kubectl-patch","operation":"Update","apiVersion":"rabbitmq.com/v1beta1","time":"2022-03-18T18:01:23Z","fieldsType":"FieldsV1","fieldsV1":{"f:spec":{"f:replicas":{}}}}]},"spec":{"replicas":3,"image":"rabbitmq:3.8.12-management","service":{"type":"ClusterIP"},"persistence":{"storage":"10Gi"},"resources":{"limits":{"cpu":"2","memory":"2Gi"},"requests":{"cpu":"1","memory":"2Gi"}},"rabbitmq":{},"tls":{},"override":{},"terminationGracePeriodSeconds":604800},"status":{"conditions":[{"type":"AllReplicasReady","status":"True","lastTransitionTime":"2022-03-18T18:01:17Z","reason":"AllPodsAreReady"},{"type":"ClusterAvailable","status":"True","lastTransitionTime":"2022-03-18T18:01:17Z","reason":"AtLeastOneEndpointAvailable"},{"type":"NoWarnings","status":"True","lastTransitionTime":"2022-03-18T18:00:38Z","reason":"NoWarnings"},{"type":"ReconcileSuccess","status":"True","lastTransitionTime":"2022-03-18T18:01:18Z","reason":"Success","message":"Finish reconciling"}],"defaultUser":{"secretReference":{"name":"rabbitmq-cluster-default-user","namespace":"default","keys":{"password":"password","username":"username"}},"serviceReference":{"name":"rabbitmq-cluster","namespace":"default"}}}}
2022/03/18 18:01:23 learn_server.go:291: [SIEVE-AFTER-READ]	Get	true	statefulset	default	rabbitmq-cluster-server	github.com/rabbitmq/cluster-operator/controllers.(*RabbitmqClusterReconciler)	NoError	{"kind":"StatefulSet","apiVersion":"apps/v1","metadata":{"name":"rabbitmq-cluster-server","namespace":"default","selfLink":"/apis/apps/v1/namespaces/default/statefulsets/rabbitmq-cluster-server","uid":"cb5c43bc-6ee7-481c-ab01-6f3acffdd3c8","resourceVersion":"974","generation":2,"creationTimestamp":"2022-03-18T18:00:38Z","labels":{"app.kubernetes.io/component":"rabbitmq","app.kubernetes.io/name":"rabbitmq-cluster","app.kubernetes.io/part-of":"rabbitmq"},"ownerReferences":[{"apiVersion":"rabbitmq.com/v1beta1","kind":"RabbitmqCluster","name":"rabbitmq-cluster","uid":"18d9928b-0d1c-47be-80ec-20960d053827","controller":true,"blockOwnerDeletion":true}],"managedFields":[{"manager":"kube-controller-manager","operation":"Update","apiVersion":"apps/v1","time":"2022-03-18T18:01:17Z","fieldsType":"FieldsV1","fieldsV1":{"f:status":{"f:collisionCount":{},"f:currentReplicas":{},"f:currentRevision":{},"f:observedGeneration":{},"f:readyReplicas":{},"f:replicas":{},"f:updateRevision":{},"f:updatedReplicas":{}}}},{"manager":"manager","operation":"Update","apiVersion":"apps/v1","time":"2022-03-18T18:01:23Z","fieldsType":"FieldsV1","fieldsV1":{"f:metadata":{"f:labels":{".":{},"f:app.kubernetes.io/component":{},"f:app.kubernetes.io/name":{},"f:app.kubernetes.io/part-of":{}},"f:ownerReferences":{".":{},"k:{\"uid\":\"18d9928b-0d1c-47be-80ec-20960d053827\"}":{".":{},"f:apiVersion":{},"f:blockOwnerDeletion":{},"f:controller":{},"f:kind":{},"f:name":{},"f:uid":{}}}},"f:spec":{"f:podManagementPolicy":{},"f:replicas":{},"f:revisionHistoryLimit":{},"f:selector":{"f:matchLabels":{".":{},"f:app.kubernetes.io/name":{}}},"f:serviceName":{},"f:template":{"f:metadata":{"f:annotations":{".":{},"f:prometheus.io/port":{},"f:prometheus.io/scrape":{}},"f:labels":{".":{},"f:app.kubernetes.io/component":{},"f:app.kubernetes.io/name":{},"f:app.kubernetes.io/part-of":{}}},"f:spec":{"f:automountServiceAccountToken":{},"f:containers":{"k:{\"name\":\"rabbitmq\"}":{".":{},"f:env":{".":{},"k:{\"name\":\"K8S_HOSTNAME_SUFFIX\"}":{".":{},"f:name":{},"f:value":{}},"k:{\"name\":\"K8S_SERVICE_NAME\"}":{".":{},"f:name":{},"f:value":{}},"k:{\"name\":\"MY_POD_NAME\"}":{".":{},"f:name":{},"f:valueFrom":{".":{},"f:fieldRef":{".":{},"f:apiVersion":{},"f:fieldPath":{}}}},"k:{\"name\":\"MY_POD_NAMESPACE\"}":{".":{},"f:name":{},"f:valueFrom":{".":{},"f:fieldRef":{".":{},"f:apiVersion":{},"f:fieldPath":{}}}},"k:{\"name\":\"RABBITMQ_ENABLED_PLUGINS_FILE\"}":{".":{},"f:name":{},"f:value":{}},"k:{\"name\":\"RABBITMQ_NODENAME\"}":{".":{},"f:name":{},"f:value":{}},"k:{\"name\":\"RABBITMQ_USE_LONGNAME\"}":{".":{},"f:name":{},"f:value":{}}},"f:image":{},"f:imagePullPolicy":{},"f:lifecycle":{".":{},"f:preStop":{".":{},"f:exec":{".":{},"f:command":{}}}},"f:name":{},"f:ports":{".":{},"k:{\"containerPort\":4369,\"protocol\":\"TCP\"}":{".":{},"f:containerPort":{},"f:name":{},"f:protocol":{}},"k:{\"containerPort\":5672,\"protocol\":\"TCP\"}":{".":{},"f:containerPort":{},"f:name":{},"f:protocol":{}},"k:{\"containerPort\":15672,\"protocol\":\"TCP\"}":{".":{},"f:containerPort":{},"f:name":{},"f:protocol":{}},"k:{\"containerPort\":15692,\"protocol\":\"TCP\"}":{".":{},"f:containerPort":{},"f:name":{},"f:protocol":{}}},"f:readinessProbe":{".":{},"f:failureThreshold":{},"f:initialDelaySeconds":{},"f:periodSeconds":{},"f:successThreshold":{},"f:tcpSocket":{".":{},"f:port":{}},"f:timeoutSeconds":{}},"f:resources":{".":{},"f:limits":{".":{},"f:cpu":{},"f:memory":{}},"f:requests":{".":{},"f:cpu":{},"f:memory":{}}},"f:terminationMessagePath":{},"f:terminationMessagePolicy":{},"f:volumeMounts":{".":{},"k:{\"mountPath\":\"/etc/pod-info/\"}":{".":{},"f:mountPath":{},"f:name":{}},"k:{\"mountPath\":\"/etc/rabbitmq/conf.d/10-operatorDefaults.conf\"}":{".":{},"f:mountPath":{},"f:name":{},"f:subPath":{}},"k:{\"mountPath\":\"/etc/rabbitmq/conf.d/11-default_user.conf\"}":{".":{},"f:mountPath":{},"f:name":{},"f:subPath":{}},"k:{\"mountPath\":\"/etc/rabbitmq/conf.d/90-userDefinedConfiguration.conf\"}":{".":{},"f:mountPath":{},"f:name":{},"f:subPath":{}},"k:{\"mountPath\":\"/operator\"}":{".":{},"f:mountPath":{},"f:name":{}},"k:{\"mountPath\":\"/var/lib/rabbitmq/\"}":{".":{},"f:mountPath":{},"f:name":{}},"k:{\"mountPath\":\"/var/lib/rabbitmq/mnesia/\"}":{".":{},"f:mountPath":{},"f:name":{}}}}},"f:dnsPolicy":{},"f:initContainers":{".":{},"k:{\"name\":\"setup-container\"}":{".":{},"f:command":{},"f:image":{},"f:imagePullPolicy":{},"f:name":{},"f:resources":{".":{},"f:limits":{".":{},"f:cpu":{},"f:memory":{}},"f:requests":{".":{},"f:cpu":{},"f:memory":{}}},"f:securityContext":{".":{},"f:capabilities":{".":{},"f:drop":{}},"f:runAsUser":{}},"f:terminationMessagePath":{},"f:terminationMessagePolicy":{},"f:volumeMounts":{".":{},"k:{\"mountPath\":\"/operator\"}":{".":{},"f:mountPath":{},"f:name":{}},"k:{\"mountPath\":\"/tmp/default_user.conf\"}":{".":{},"f:mountPath":{},"f:name":{},"f:subPath":{}},"k:{\"mountPath\":\"/tmp/erlang-cookie-secret/\"}":{".":{},"f:mountPath":{},"f:name":{}},"k:{\"mountPath\":\"/tmp/rabbitmq-plugins/\"}":{".":{},"f:mountPath":{},"f:name":{}},"k:{\"mountPath\":\"/var/lib/rabbitmq/\"}":{".":{},"f:mountPath":{},"f:name":{}},"k:{\"mountPath\":\"/var/lib/rabbitmq/mnesia/\"}":{".":{},"f:mountPath":{},"f:name":{}}}}},"f:restartPolicy":{},"f:schedulerName":{},"f:securityContext":{".":{},"f:fsGroup":{},"f:runAsGroup":{},"f:runAsUser":{}},"f:serviceAccount":{},"f:serviceAccountName":{},"f:terminationGracePeriodSeconds":{},"f:topologySpreadConstraints":{".":{},"k:{\"topologyKey\":\"topology.kubernetes.io/zone\",\"whenUnsatisfiable\":\"ScheduleAnyway\"}":{".":{},"f:labelSelector":{".":{},"f:matchLabels":{".":{},"f:app.kubernetes.io/name":{}}},"f:maxSkew":{},"f:topologyKey":{},"f:whenUnsatisfiable":{}}},"f:volumes":{".":{},"k:{\"name\":\"erlang-cookie-secret\"}":{".":{},"f:name":{},"f:secret":{".":{},"f:defaultMode":{},"f:secretName":{}}},"k:{\"name\":\"plugins-conf\"}":{".":{},"f:configMap":{".":{},"f:defaultMode":{},"f:name":{}},"f:name":{}},"k:{\"name\":\"pod-info\"}":{".":{},"f:downwardAPI":{".":{},"f:defaultMode":{},"f:items":{}},"f:name":{}},"k:{\"name\":\"rabbitmq-confd\"}":{".":{},"f:name":{},"f:projected":{".":{},"f:defaultMode":{},"f:sources":{}}},"k:{\"name\":\"rabbitmq-erlang-cookie\"}":{".":{},"f:emptyDir":{},"f:name":{}},"k:{\"name\":\"rabbitmq-plugins\"}":{".":{},"f:emptyDir":{},"f:name":{}}}}},"f:updateStrategy":{"f:rollingUpdate":{".":{},"f:partition":{}},"f:type":{}},"f:volumeClaimTemplates":{}}}}]},"spec":{"replicas":3,"selector":{"matchLabels":{"app.kubernetes.io/name":"rabbitmq-cluster"}},"template":{"metadata":{"creationTimestamp":null,"labels":{"app.kubernetes.io/component":"rabbitmq","app.kubernetes.io/name":"rabbitmq-cluster","app.kubernetes.io/part-of":"rabbitmq"},"annotations":{"prometheus.io/port":"15692","prometheus.io/scrape":"true"}},"spec":{"volumes":[{"name":"plugins-conf","configMap":{"name":"rabbitmq-cluster-plugins-conf","defaultMode":420}},{"name":"rabbitmq-confd","projected":{"sources":[{"secret":{"name":"rabbitmq-cluster-default-user","items":[{"key":"default_user.conf","path":"default_user.conf"}]}},{"configMap":{"name":"rabbitmq-cluster-server-conf","items":[{"key":"operatorDefaults.conf","path":"operatorDefaults.conf"},{"key":"userDefinedConfiguration.conf","path":"userDefinedConfiguration.conf"}]}}],"defaultMode":420}},{"name":"rabbitmq-erlang-cookie","emptyDir":{}},{"name":"erlang-cookie-secret","secret":{"secretName":"rabbitmq-cluster-erlang-cookie","defaultMode":420}},{"name":"rabbitmq-plugins","emptyDir":{}},{"name":"pod-info","downwardAPI":{"items":[{"path":"skipPreStopChecks","fieldRef":{"apiVersion":"v1","fieldPath":"metadata.labels['skipPreStopChecks']"}}],"defaultMode":420}}],"initContainers":[{"name":"setup-container","image":"rabbitmq:3.8.12-management","command":["sh","-c","cp /tmp/erlang-cookie-secret/.erlang.cookie /var/lib/rabbitmq/.erlang.cookie \u0026\u0026 chown 999:999 /var/lib/rabbitmq/.erlang.cookie \u0026\u0026 chmod 600 /var/lib/rabbitmq/.erlang.cookie ; cp /tmp/rabbitmq-plugins/enabled_plugins /operator/enabled_plugins \u0026\u0026 chown 999:999 /operator/enabled_plugins ; chown 999:999 /var/lib/rabbitmq/mnesia/ ; echo '[default]' \u003e /var/lib/rabbitmq/.rabbitmqadmin.conf \u0026\u0026 sed -e 's/default_user/username/' -e 's/default_pass/password/' /tmp/default_user.conf \u003e\u003e /var/lib/rabbitmq/.rabbitmqadmin.conf \u0026\u0026 chown 999:999 /var/lib/rabbitmq/.rabbitmqadmin.conf \u0026\u0026 chmod 600 /var/lib/rabbitmq/.rabbitmqadmin.conf"],"resources":{"limits":{"cpu":"100m","memory":"500Mi"},"requests":{"cpu":"100m","memory":"500Mi"}},"volumeMounts":[{"name":"plugins-conf","mountPath":"/tmp/rabbitmq-plugins/"},{"name":"rabbitmq-erlang-cookie","mountPath":"/var/lib/rabbitmq/"},{"name":"erlang-cookie-secret","mountPath":"/tmp/erlang-cookie-secret/"},{"name":"rabbitmq-plugins","mountPath":"/operator"},{"name":"persistence","mountPath":"/var/lib/rabbitmq/mnesia/"},{"name":"rabbitmq-confd","mountPath":"/tmp/default_user.conf","subPath":"default_user.conf"}],"terminationMessagePath":"/dev/termination-log","terminationMessagePolicy":"File","imagePullPolicy":"IfNotPresent","securityContext":{"capabilities":{"drop":["FSETID","KILL","SETGID","SETUID","SETPCAP","NET_BIND_SERVICE","NET_RAW","SYS_CHROOT","MKNOD","AUDIT_WRITE","SETFCAP"]},"runAsUser":0}}],"containers":[{"name":"rabbitmq","image":"rabbitmq:3.8.12-management","ports":[{"name":"epmd","containerPort":4369,"protocol":"TCP"},{"name":"amqp","containerPort":5672,"protocol":"TCP"},{"name":"management","containerPort":15672,"protocol":"TCP"},{"name":"prometheus","containerPort":15692,"protocol":"TCP"}],"env":[{"name":"MY_POD_NAME","valueFrom":{"fieldRef":{"apiVersion":"v1","fieldPath":"metadata.name"}}},{"name":"MY_POD_NAMESPACE","valueFrom":{"fieldRef":{"apiVersion":"v1","fieldPath":"metadata.namespace"}}},{"name":"RABBITMQ_ENABLED_PLUGINS_FILE","value":"/operator/enabled_plugins"},{"name":"K8S_SERVICE_NAME","value":"rabbitmq-cluster-nodes"},{"name":"RABBITMQ_USE_LONGNAME","value":"true"},{"name":"RABBITMQ_NODENAME","value":"rabbit@$(MY_POD_NAME).$(K8S_SERVICE_NAME).$(MY_POD_NAMESPACE)"},{"name":"K8S_HOSTNAME_SUFFIX","value":".$(K8S_SERVICE_NAME).$(MY_POD_NAMESPACE)"}],"resources":{"limits":{"cpu":"2","memory":"2Gi"},"requests":{"cpu":"1","memory":"2Gi"}},"volumeMounts":[{"name":"rabbitmq-erlang-cookie","mountPath":"/var/lib/rabbitmq/"},{"name":"persistence","mountPath":"/var/lib/rabbitmq/mnesia/"},{"name":"rabbitmq-plugins","mountPath":"/operator"},{"name":"rabbitmq-confd","mountPath":"/etc/rabbitmq/conf.d/10-operatorDefaults.conf","subPath":"operatorDefaults.conf"},{"name":"rabbitmq-confd","mountPath":"/etc/rabbitmq/conf.d/11-default_user.conf","subPath":"default_user.conf"},{"name":"rabbitmq-confd","mountPath":"/etc/rabbitmq/conf.d/90-userDefinedConfiguration.conf","subPath":"userDefinedConfiguration.conf"},{"name":"pod-info","mountPath":"/etc/pod-info/"}],"readinessProbe":{"tcpSocket":{"port":"amqp"},"initialDelaySeconds":10,"timeoutSeconds":5,"periodSeconds":10,"successThreshold":1,"failureThreshold":3},"lifecycle":{"preStop":{"exec":{"command":["/bin/bash","-c","if [ ! -z \"$(cat /etc/pod-info/skipPreStopChecks)\" ]; then exit 0; fi; rabbitmq-upgrade await_online_quorum_plus_one -t 604800; rabbitmq-upgrade await_online_synchronized_mirror -t 604800; rabbitmq-upgrade drain -t 604800"]}}},"terminationMessagePath":"/dev/termination-log","terminationMessagePolicy":"File","imagePullPolicy":"IfNotPresent"}],"restartPolicy":"Always","terminationGracePeriodSeconds":604800,"dnsPolicy":"ClusterFirst","serviceAccountName":"rabbitmq-cluster-server","serviceAccount":"rabbitmq-cluster-server","automountServiceAccountToken":true,"securityContext":{"runAsUser":999,"runAsGroup":999,"fsGroup":999},"schedulerName":"default-scheduler","topologySpreadConstraints":[{"maxSkew":1,"topologyKey":"topology.kubernetes.io/zone","whenUnsatisfiable":"ScheduleAnyway","labelSelector":{"matchLabels":{"app.kubernetes.io/name":"rabbitmq-cluster"}}}]}},"volumeClaimTemplates":[{"metadata":{"name":"persistence","namespace":"default","creationTimestamp":null,"labels":{"app.kubernetes.io/component":"rabbitmq","app.kubernetes.io/name":"rabbitmq-cluster","app.kubernetes.io/part-of":"rabbitmq"},"ownerReferences":[{"apiVersion":"rabbitmq.com/v1beta1","kind":"RabbitmqCluster","name":"rabbitmq-cluster","uid":"18d9928b-0d1c-47be-80ec-20960d053827","controller":true,"blockOwnerDeletion":false}]},"spec":{"accessModes":["ReadWriteOnce"],"resources":{"requests":{"storage":"10Gi"}},"volumeMode":"Filesystem"},"status":{"phase":"Pending"}}],"serviceName":"rabbitmq-cluster-nodes","podManagementPolicy":"Parallel","updateStrategy":{"type":"RollingUpdate","rollingUpdate":{"partition":0}},"revisionHistoryLimit":10},"status":{"observedGeneration":1,"replicas":1,"readyReplicas":1,"currentReplicas":1,"updatedReplicas":1,"currentRevision":"rabbitmq-cluster-server-5f8b8665fb","updateRevision":"rabbitmq-cluster-server-5f8b8665fb","collisionCount":0}}
2022/03/18 18:01:23 learn_server.go:291: [SIEVE-AFTER-READ]	Get	true	endpoints	default	rabbitmq-cluster	github.com/rabbitmq/cluster-operator/controllers.(*RabbitmqClusterReconciler)	NoError	{"kind":"Endpoints","apiVersion":"v1","metadata":{"name":"rabbitmq-cluster","namespace":"default","selfLink":"/api/v1/namespaces/default/endpoints/rabbitmq-cluster","uid":"5c4723ad-f4fe-442d-9135-44879a2a8183","resourceVersion":"939","creationTimestamp":"2022-03-18T18:00:38Z","labels":{"app.kubernetes.io/component":"rabbitmq","app.kubernetes.io/name":"rabbitmq-cluster","app.kubernetes.io/part-of":"rabbitmq"},"annotations":{"endpoints.kubernetes.io/last-change-trigger-time":"2022-03-18T18:01:17Z"},"managedFields":[{"manager":"kube-controller-manager","operation":"Update","apiVersion":"v1","time":"2022-03-18T18:01:17Z","fieldsType":"FieldsV1","fieldsV1":{"f:metadata":{"f:annotations":{".":{},"f:endpoints.kubernetes.io/last-change-trigger-time":{}},"f:labels":{".":{},"f:app.kubernetes.io/component":{},"f:app.kubernetes.io/name":{},"f:app.kubernetes.io/part-of":{}}},"f:subsets":{}}}]},"subsets":[{"addresses":[{"ip":"10.244.1.4","nodeName":"kind-worker2","targetRef":{"kind":"Pod","namespace":"default","name":"rabbitmq-cluster-server-0","uid":"e7faffc5-b656-4e69-9777-92d12cb6ec5a","resourceVersion":"938"}}],"ports":[{"name":"amqp","port":5672,"protocol":"TCP"},{"name":"management","port":15672,"protocol":"TCP"}]}]}
2022/03/18 18:01:23 learn_server.go:256: [SIEVE-BEFORE-WRITE]	40
2022/03/18 18:01:23 learn_server.go:279: [SIEVE-BEFORE-HEAR]	24	Updated	rabbitmqcluster	{"metadata":{"name":"rabbitmq-cluster","namespace":"default","selfLink":"/apis/rabbitmq.com/v1beta1/namespaces/default/rabbitmqclusters/rabbitmq-cluster","uid":"18d9928b-0d1c-47be-80ec-20960d053827","resourceVersion":"977","generation":3,"creationTimestamp":"2022-03-18T18:00:38Z","annotations":{"kubectl.kubernetes.io/last-applied-configuration":"{\"apiVersion\":\"rabbitmq.com/v1beta1\",\"kind\":\"RabbitmqCluster\",\"metadata\":{\"annotations\":{},\"name\":\"rabbitmq-cluster\",\"namespace\":\"default\"},\"spec\":{\"persistence\":{\"storage\":\"10Gi\"},\"replicas\":1}}\n"},"finalizers":["deletion.finalizers.rabbitmqclusters.rabbitmq.com"],"managedFields":[{"manager":"kubectl-client-side-apply","operation":"Update","apiVersion":"rabbitmq.com/v1beta1","time":"2022-03-18T18:00:38Z","fieldsType":"FieldsV1","fieldsV1":{"f:metadata":{"f:annotations":{".":{},"f:kubectl.kubernetes.io/last-applied-configuration":{}}},"f:spec":{".":{},"f:image":{},"f:persistence":{".":{},"f:storage":{}},"f:resources":{".":{},"f:limits":{".":{},"f:memory":{}},"f:requests":{".":{},"f:memory":{}}},"f:service":{".":{},"f:type":{}},"f:terminationGracePeriodSeconds":{}}}},{"manager":"kubectl-patch","operation":"Update","apiVersion":"rabbitmq.com/v1beta1","time":"2022-03-18T18:01:23Z","fieldsType":"FieldsV1","fieldsV1":{"f:spec":{"f:replicas":{}}}},{"manager":"manager","operation":"Update","apiVersion":"rabbitmq.com/v1beta1","time":"2022-03-18T18:01:23Z","fieldsType":"FieldsV1","fieldsV1":{"f:metadata":{"f:finalizers":{}},"f:spec":{"f:override":{},"f:rabbitmq":{},"f:resources":{"f:limits":{"f:cpu":{}},"f:requests":{"f:cpu":{}}},"f:tls":{}},"f:status":{".":{},"f:conditions":{},"f:defaultUser":{".":{},"f:secretReference":{".":{},"f:keys":{".":{},"f:password":{},"f:username":{}},"f:name":{},"f:namespace":{}},"f:serviceReference":{".":{},"f:name":{},"f:namespace":{}}}}}}]},"spec":{"replicas":3,"image":"rabbitmq:3.8.12-management","service":{"type":"ClusterIP"},"persistence":{"storage":"10Gi"},"resources":{"limits":{"cpu":"2","memory":"2Gi"},"requests":{"cpu":"1","memory":"2Gi"}},"rabbitmq":{},"tls":{},"override":{},"terminationGracePeriodSeconds":604800},"status":{"conditions":[{"type":"AllReplicasReady","status":"False","lastTransitionTime":"2022-03-18T18:01:23Z","reason":"NotAllPodsReady","message":"1/3 Pods ready"},{"type":"ClusterAvailable","status":"True","lastTransitionTime":"2022-03-18T18:01:17Z","reason":"AtLeastOneEndpointAvailable"},{"type":"NoWarnings","status":"True","lastTransitionTime":"2022-03-18T18:00:38Z","reason":"NoWarnings"},{"type":"ReconcileSuccess","status":"True","lastTransitionTime":"2022-03-18T18:01:18Z","reason":"Success","message":"Finish reconciling"}],"defaultUser":{"secretReference":{"name":"rabbitmq-cluster-default-user","namespace":"default","keys":{"password":"password","username":"username"}},"serviceReference":{"name":"rabbitmq-cluster","namespace":"default"}}}}
2022/03/18 18:01:23 learn_server.go:289: [SIEVE-AFTER-HEAR]	24
2022/03/18 18:01:23 learn_server.go:263: [SIEVE-AFTER-WRITE]	40	StatusUpdate	rabbitmqcluster	github.com/rabbitmq/cluster-operator/controllers.(*RabbitmqClusterReconciler)	NoError	{"metadata":{"name":"rabbitmq-cluster","namespace":"default","selfLink":"/apis/rabbitmq.com/v1beta1/namespaces/default/rabbitmqclusters/rabbitmq-cluster/status","uid":"18d9928b-0d1c-47be-80ec-20960d053827","resourceVersion":"977","generation":3,"creationTimestamp":"2022-03-18T18:00:38Z","annotations":{"kubectl.kubernetes.io/last-applied-configuration":"{\"apiVersion\":\"rabbitmq.com/v1beta1\",\"kind\":\"RabbitmqCluster\",\"metadata\":{\"annotations\":{},\"name\":\"rabbitmq-cluster\",\"namespace\":\"default\"},\"spec\":{\"persistence\":{\"storage\":\"10Gi\"},\"replicas\":1}}\n"},"finalizers":["deletion.finalizers.rabbitmqclusters.rabbitmq.com"],"managedFields":[{"manager":"kubectl-client-side-apply","operation":"Update","apiVersion":"rabbitmq.com/v1beta1","time":"2022-03-18T18:00:38Z","fieldsType":"FieldsV1","fieldsV1":{"f:metadata":{"f:annotations":{".":{},"f:kubectl.kubernetes.io/last-applied-configuration":{}}},"f:spec":{".":{},"f:image":{},"f:persistence":{".":{},"f:storage":{}},"f:resources":{".":{},"f:limits":{".":{},"f:memory":{}},"f:requests":{".":{},"f:memory":{}}},"f:service":{".":{},"f:type":{}},"f:terminationGracePeriodSeconds":{}}}},{"manager":"kubectl-patch","operation":"Update","apiVersion":"rabbitmq.com/v1beta1","time":"2022-03-18T18:01:23Z","fieldsType":"FieldsV1","fieldsV1":{"f:spec":{"f:replicas":{}}}},{"manager":"manager","operation":"Update","apiVersion":"rabbitmq.com/v1beta1","time":"2022-03-18T18:01:23Z","fieldsType":"FieldsV1","fieldsV1":{"f:metadata":{"f:finalizers":{}},"f:spec":{"f:override":{},"f:rabbitmq":{},"f:resources":{"f:limits":{"f:cpu":{}},"f:requests":{"f:cpu":{}}},"f:tls":{}},"f:status":{".":{},"f:conditions":{},"f:defaultUser":{".":{},"f:secretReference":{".":{},"f:keys":{".":{},"f:password":{},"f:username":{}},"f:name":{},"f:namespace":{}},"f:serviceReference":{".":{},"f:name":{},"f:namespace":{}}}}}}]},"spec":{"replicas":3,"image":"rabbitmq:3.8.12-management","service":{"type":"ClusterIP"},"persistence":{"storage":"10Gi"},"resources":{"limits":{"cpu":"2","memory":"2Gi"},"requests":{"cpu":"1","memory":"2Gi"}},"rabbitmq":{},"tls":{},"override":{},"terminationGracePeriodSeconds":604800},"status":{"conditions":[{"type":"AllReplicasReady","status":"False","lastTransitionTime":"2022-03-18T18:01:23Z","reason":"NotAllPodsReady","message":"1/3 Pods ready"},{"type":"ClusterAvailable","status":"True","lastTransitionTime":"2022-03-18T18:01:17Z","reason":"AtLeastOneEndpointAvailable"},{"type":"NoWarnings","status":"True","lastTransitionTime":"2022-03-18T18:00:38Z","reason":"NoWarnings"},{"type":"ReconcileSuccess","status":"True","lastTransitionTime":"2022-03-18T18:01:18Z","reason":"Success","message":"Finish reconciling"}],"defaultUser":{"secretReference":{"name":"rabbitmq-cluster-default-user","namespace":"default","keys":{"password":"password","username":"username"}},"serviceReference":{"name":"rabbitmq-cluster","namespace":"default"}}}}
2022/03/18 18:01:23 learn_server.go:291: [SIEVE-AFTER-READ]	Get	true	statefulset	default	rabbitmq-cluster-server	github.com/rabbitmq/cluster-operator/controllers.(*RabbitmqClusterReconciler)	NoError	{"kind":"StatefulSet","apiVersion":"apps/v1","metadata":{"name":"rabbitmq-cluster-server","namespace":"default","selfLink":"/apis/apps/v1/namespaces/default/statefulsets/rabbitmq-cluster-server","uid":"cb5c43bc-6ee7-481c-ab01-6f3acffdd3c8","resourceVersion":"974","generation":2,"creationTimestamp":"2022-03-18T18:00:38Z","labels":{"app.kubernetes.io/component":"rabbitmq","app.kubernetes.io/name":"rabbitmq-cluster","app.kubernetes.io/part-of":"rabbitmq"},"ownerReferences":[{"apiVersion":"rabbitmq.com/v1beta1","kind":"RabbitmqCluster","name":"rabbitmq-cluster","uid":"18d9928b-0d1c-47be-80ec-20960d053827","controller":true,"blockOwnerDeletion":true}],"managedFields":[{"manager":"kube-controller-manager","operation":"Update","apiVersion":"apps/v1","time":"2022-03-18T18:01:17Z","fieldsType":"FieldsV1","fieldsV1":{"f:status":{"f:collisionCount":{},"f:currentReplicas":{},"f:currentRevision":{},"f:observedGeneration":{},"f:readyReplicas":{},"f:replicas":{},"f:updateRevision":{},"f:updatedReplicas":{}}}},{"manager":"manager","operation":"Update","apiVersion":"apps/v1","time":"2022-03-18T18:01:23Z","fieldsType":"FieldsV1","fieldsV1":{"f:metadata":{"f:labels":{".":{},"f:app.kubernetes.io/component":{},"f:app.kubernetes.io/name":{},"f:app.kubernetes.io/part-of":{}},"f:ownerReferences":{".":{},"k:{\"uid\":\"18d9928b-0d1c-47be-80ec-20960d053827\"}":{".":{},"f:apiVersion":{},"f:blockOwnerDeletion":{},"f:controller":{},"f:kind":{},"f:name":{},"f:uid":{}}}},"f:spec":{"f:podManagementPolicy":{},"f:replicas":{},"f:revisionHistoryLimit":{},"f:selector":{"f:matchLabels":{".":{},"f:app.kubernetes.io/name":{}}},"f:serviceName":{},"f:template":{"f:metadata":{"f:annotations":{".":{},"f:prometheus.io/port":{},"f:prometheus.io/scrape":{}},"f:labels":{".":{},"f:app.kubernetes.io/component":{},"f:app.kubernetes.io/name":{},"f:app.kubernetes.io/part-of":{}}},"f:spec":{"f:automountServiceAccountToken":{},"f:containers":{"k:{\"name\":\"rabbitmq\"}":{".":{},"f:env":{".":{},"k:{\"name\":\"K8S_HOSTNAME_SUFFIX\"}":{".":{},"f:name":{},"f:value":{}},"k:{\"name\":\"K8S_SERVICE_NAME\"}":{".":{},"f:name":{},"f:value":{}},"k:{\"name\":\"MY_POD_NAME\"}":{".":{},"f:name":{},"f:valueFrom":{".":{},"f:fieldRef":{".":{},"f:apiVersion":{},"f:fieldPath":{}}}},"k:{\"name\":\"MY_POD_NAMESPACE\"}":{".":{},"f:name":{},"f:valueFrom":{".":{},"f:fieldRef":{".":{},"f:apiVersion":{},"f:fieldPath":{}}}},"k:{\"name\":\"RABBITMQ_ENABLED_PLUGINS_FILE\"}":{".":{},"f:name":{},"f:value":{}},"k:{\"name\":\"RABBITMQ_NODENAME\"}":{".":{},"f:name":{},"f:value":{}},"k:{\"name\":\"RABBITMQ_USE_LONGNAME\"}":{".":{},"f:name":{},"f:value":{}}},"f:image":{},"f:imagePullPolicy":{},"f:lifecycle":{".":{},"f:preStop":{".":{},"f:exec":{".":{},"f:command":{}}}},"f:name":{},"f:ports":{".":{},"k:{\"containerPort\":4369,\"protocol\":\"TCP\"}":{".":{},"f:containerPort":{},"f:name":{},"f:protocol":{}},"k:{\"containerPort\":5672,\"protocol\":\"TCP\"}":{".":{},"f:containerPort":{},"f:name":{},"f:protocol":{}},"k:{\"containerPort\":15672,\"protocol\":\"TCP\"}":{".":{},"f:containerPort":{},"f:name":{},"f:protocol":{}},"k:{\"containerPort\":15692,\"protocol\":\"TCP\"}":{".":{},"f:containerPort":{},"f:name":{},"f:protocol":{}}},"f:readinessProbe":{".":{},"f:failureThreshold":{},"f:initialDelaySeconds":{},"f:periodSeconds":{},"f:successThreshold":{},"f:tcpSocket":{".":{},"f:port":{}},"f:timeoutSeconds":{}},"f:resources":{".":{},"f:limits":{".":{},"f:cpu":{},"f:memory":{}},"f:requests":{".":{},"f:cpu":{},"f:memory":{}}},"f:terminationMessagePath":{},"f:terminationMessagePolicy":{},"f:volumeMounts":{".":{},"k:{\"mountPath\":\"/etc/pod-info/\"}":{".":{},"f:mountPath":{},"f:name":{}},"k:{\"mountPath\":\"/etc/rabbitmq/conf.d/10-operatorDefaults.conf\"}":{".":{},"f:mountPath":{},"f:name":{},"f:subPath":{}},"k:{\"mountPath\":\"/etc/rabbitmq/conf.d/11-default_user.conf\"}":{".":{},"f:mountPath":{},"f:name":{},"f:subPath":{}},"k:{\"mountPath\":\"/etc/rabbitmq/conf.d/90-userDefinedConfiguration.conf\"}":{".":{},"f:mountPath":{},"f:name":{},"f:subPath":{}},"k:{\"mountPath\":\"/operator\"}":{".":{},"f:mountPath":{},"f:name":{}},"k:{\"mountPath\":\"/var/lib/rabbitmq/\"}":{".":{},"f:mountPath":{},"f:name":{}},"k:{\"mountPath\":\"/var/lib/rabbitmq/mnesia/\"}":{".":{},"f:mountPath":{},"f:name":{}}}}},"f:dnsPolicy":{},"f:initContainers":{".":{},"k:{\"name\":\"setup-container\"}":{".":{},"f:command":{},"f:image":{},"f:imagePullPolicy":{},"f:name":{},"f:resources":{".":{},"f:limits":{".":{},"f:cpu":{},"f:memory":{}},"f:requests":{".":{},"f:cpu":{},"f:memory":{}}},"f:securityContext":{".":{},"f:capabilities":{".":{},"f:drop":{}},"f:runAsUser":{}},"f:terminationMessagePath":{},"f:terminationMessagePolicy":{},"f:volumeMounts":{".":{},"k:{\"mountPath\":\"/operator\"}":{".":{},"f:mountPath":{},"f:name":{}},"k:{\"mountPath\":\"/tmp/default_user.conf\"}":{".":{},"f:mountPath":{},"f:name":{},"f:subPath":{}},"k:{\"mountPath\":\"/tmp/erlang-cookie-secret/\"}":{".":{},"f:mountPath":{},"f:name":{}},"k:{\"mountPath\":\"/tmp/rabbitmq-plugins/\"}":{".":{},"f:mountPath":{},"f:name":{}},"k:{\"mountPath\":\"/var/lib/rabbitmq/\"}":{".":{},"f:mountPath":{},"f:name":{}},"k:{\"mountPath\":\"/var/lib/rabbitmq/mnesia/\"}":{".":{},"f:mountPath":{},"f:name":{}}}}},"f:restartPolicy":{},"f:schedulerName":{},"f:securityContext":{".":{},"f:fsGroup":{},"f:runAsGroup":{},"f:runAsUser":{}},"f:serviceAccount":{},"f:serviceAccountName":{},"f:terminationGracePeriodSeconds":{},"f:topologySpreadConstraints":{".":{},"k:{\"topologyKey\":\"topology.kubernetes.io/zone\",\"whenUnsatisfiable\":\"ScheduleAnyway\"}":{".":{},"f:labelSelector":{".":{},"f:matchLabels":{".":{},"f:app.kubernetes.io/name":{}}},"f:maxSkew":{},"f:topologyKey":{},"f:whenUnsatisfiable":{}}},"f:volumes":{".":{},"k:{\"name\":\"erlang-cookie-secret\"}":{".":{},"f:name":{},"f:secret":{".":{},"f:defaultMode":{},"f:secretName":{}}},"k:{\"name\":\"plugins-conf\"}":{".":{},"f:configMap":{".":{},"f:defaultMode":{},"f:name":{}},"f:name":{}},"k:{\"name\":\"pod-info\"}":{".":{},"f:downwardAPI":{".":{},"f:defaultMode":{},"f:items":{}},"f:name":{}},"k:{\"name\":\"rabbitmq-confd\"}":{".":{},"f:name":{},"f:projected":{".":{},"f:defaultMode":{},"f:sources":{}}},"k:{\"name\":\"rabbitmq-erlang-cookie\"}":{".":{},"f:emptyDir":{},"f:name":{}},"k:{\"name\":\"rabbitmq-plugins\"}":{".":{},"f:emptyDir":{},"f:name":{}}}}},"f:updateStrategy":{"f:rollingUpdate":{".":{},"f:partition":{}},"f:type":{}},"f:volumeClaimTemplates":{}}}}]},"spec":{"replicas":3,"selector":{"matchLabels":{"app.kubernetes.io/name":"rabbitmq-cluster"}},"template":{"metadata":{"creationTimestamp":null,"labels":{"app.kubernetes.io/component":"rabbitmq","app.kubernetes.io/name":"rabbitmq-cluster","app.kubernetes.io/part-of":"rabbitmq"},"annotations":{"prometheus.io/port":"15692","prometheus.io/scrape":"true"}},"spec":{"volumes":[{"name":"plugins-conf","configMap":{"name":"rabbitmq-cluster-plugins-conf","defaultMode":420}},{"name":"rabbitmq-confd","projected":{"sources":[{"secret":{"name":"rabbitmq-cluster-default-user","items":[{"key":"default_user.conf","path":"default_user.conf"}]}},{"configMap":{"name":"rabbitmq-cluster-server-conf","items":[{"key":"operatorDefaults.conf","path":"operatorDefaults.conf"},{"key":"userDefinedConfiguration.conf","path":"userDefinedConfiguration.conf"}]}}],"defaultMode":420}},{"name":"rabbitmq-erlang-cookie","emptyDir":{}},{"name":"erlang-cookie-secret","secret":{"secretName":"rabbitmq-cluster-erlang-cookie","defaultMode":420}},{"name":"rabbitmq-plugins","emptyDir":{}},{"name":"pod-info","downwardAPI":{"items":[{"path":"skipPreStopChecks","fieldRef":{"apiVersion":"v1","fieldPath":"metadata.labels['skipPreStopChecks']"}}],"defaultMode":420}}],"initContainers":[{"name":"setup-container","image":"rabbitmq:3.8.12-management","command":["sh","-c","cp /tmp/erlang-cookie-secret/.erlang.cookie /var/lib/rabbitmq/.erlang.cookie \u0026\u0026 chown 999:999 /var/lib/rabbitmq/.erlang.cookie \u0026\u0026 chmod 600 /var/lib/rabbitmq/.erlang.cookie ; cp /tmp/rabbitmq-plugins/enabled_plugins /operator/enabled_plugins \u0026\u0026 chown 999:999 /operator/enabled_plugins ; chown 999:999 /var/lib/rabbitmq/mnesia/ ; echo '[default]' \u003e /var/lib/rabbitmq/.rabbitmqadmin.conf \u0026\u0026 sed -e 's/default_user/username/' -e 's/default_pass/password/' /tmp/default_user.conf \u003e\u003e /var/lib/rabbitmq/.rabbitmqadmin.conf \u0026\u0026 chown 999:999 /var/lib/rabbitmq/.rabbitmqadmin.conf \u0026\u0026 chmod 600 /var/lib/rabbitmq/.rabbitmqadmin.conf"],"resources":{"limits":{"cpu":"100m","memory":"500Mi"},"requests":{"cpu":"100m","memory":"500Mi"}},"volumeMounts":[{"name":"plugins-conf","mountPath":"/tmp/rabbitmq-plugins/"},{"name":"rabbitmq-erlang-cookie","mountPath":"/var/lib/rabbitmq/"},{"name":"erlang-cookie-secret","mountPath":"/tmp/erlang-cookie-secret/"},{"name":"rabbitmq-plugins","mountPath":"/operator"},{"name":"persistence","mountPath":"/var/lib/rabbitmq/mnesia/"},{"name":"rabbitmq-confd","mountPath":"/tmp/default_user.conf","subPath":"default_user.conf"}],"terminationMessagePath":"/dev/termination-log","terminationMessagePolicy":"File","imagePullPolicy":"IfNotPresent","securityContext":{"capabilities":{"drop":["FSETID","KILL","SETGID","SETUID","SETPCAP","NET_BIND_SERVICE","NET_RAW","SYS_CHROOT","MKNOD","AUDIT_WRITE","SETFCAP"]},"runAsUser":0}}],"containers":[{"name":"rabbitmq","image":"rabbitmq:3.8.12-management","ports":[{"name":"epmd","containerPort":4369,"protocol":"TCP"},{"name":"amqp","containerPort":5672,"protocol":"TCP"},{"name":"management","containerPort":15672,"protocol":"TCP"},{"name":"prometheus","containerPort":15692,"protocol":"TCP"}],"env":[{"name":"MY_POD_NAME","valueFrom":{"fieldRef":{"apiVersion":"v1","fieldPath":"metadata.name"}}},{"name":"MY_POD_NAMESPACE","valueFrom":{"fieldRef":{"apiVersion":"v1","fieldPath":"metadata.namespace"}}},{"name":"RABBITMQ_ENABLED_PLUGINS_FILE","value":"/operator/enabled_plugins"},{"name":"K8S_SERVICE_NAME","value":"rabbitmq-cluster-nodes"},{"name":"RABBITMQ_USE_LONGNAME","value":"true"},{"name":"RABBITMQ_NODENAME","value":"rabbit@$(MY_POD_NAME).$(K8S_SERVICE_NAME).$(MY_POD_NAMESPACE)"},{"name":"K8S_HOSTNAME_SUFFIX","value":".$(K8S_SERVICE_NAME).$(MY_POD_NAMESPACE)"}],"resources":{"limits":{"cpu":"2","memory":"2Gi"},"requests":{"cpu":"1","memory":"2Gi"}},"volumeMounts":[{"name":"rabbitmq-erlang-cookie","mountPath":"/var/lib/rabbitmq/"},{"name":"persistence","mountPath":"/var/lib/rabbitmq/mnesia/"},{"name":"rabbitmq-plugins","mountPath":"/operator"},{"name":"rabbitmq-confd","mountPath":"/etc/rabbitmq/conf.d/10-operatorDefaults.conf","subPath":"operatorDefaults.conf"},{"name":"rabbitmq-confd","mountPath":"/etc/rabbitmq/conf.d/11-default_user.conf","subPath":"default_user.conf"},{"name":"rabbitmq-confd","mountPath":"/etc/rabbitmq/conf.d/90-userDefinedConfiguration.conf","subPath":"userDefinedConfiguration.conf"},{"name":"pod-info","mountPath":"/etc/pod-info/"}],"readinessProbe":{"tcpSocket":{"port":"amqp"},"initialDelaySeconds":10,"timeoutSeconds":5,"periodSeconds":10,"successThreshold":1,"failureThreshold":3},"lifecycle":{"preStop":{"exec":{"command":["/bin/bash","-c","if [ ! -z \"$(cat /etc/pod-info/skipPreStopChecks)\" ]; then exit 0; fi; rabbitmq-upgrade await_online_quorum_plus_one -t 604800; rabbitmq-upgrade await_online_synchronized_mirror -t 604800; rabbitmq-upgrade drain -t 604800"]}}},"terminationMessagePath":"/dev/termination-log","terminationMessagePolicy":"File","imagePullPolicy":"IfNotPresent"}],"restartPolicy":"Always","terminationGracePeriodSeconds":604800,"dnsPolicy":"ClusterFirst","serviceAccountName":"rabbitmq-cluster-server","serviceAccount":"rabbitmq-cluster-server","automountServiceAccountToken":true,"securityContext":{"runAsUser":999,"runAsGroup":999,"fsGroup":999},"schedulerName":"default-scheduler","topologySpreadConstraints":[{"maxSkew":1,"topologyKey":"topology.kubernetes.io/zone","whenUnsatisfiable":"ScheduleAnyway","labelSelector":{"matchLabels":{"app.kubernetes.io/name":"rabbitmq-cluster"}}}]}},"volumeClaimTemplates":[{"metadata":{"name":"persistence","namespace":"default","creationTimestamp":null,"labels":{"app.kubernetes.io/component":"rabbitmq","app.kubernetes.io/name":"rabbitmq-cluster","app.kubernetes.io/part-of":"rabbitmq"},"ownerReferences":[{"apiVersion":"rabbitmq.com/v1beta1","kind":"RabbitmqCluster","name":"rabbitmq-cluster","uid":"18d9928b-0d1c-47be-80ec-20960d053827","controller":true,"blockOwnerDeletion":false}]},"spec":{"accessModes":["ReadWriteOnce"],"resources":{"requests":{"storage":"10Gi"}},"volumeMode":"Filesystem"},"status":{"phase":"Pending"}}],"serviceName":"rabbitmq-cluster-nodes","podManagementPolicy":"Parallel","updateStrategy":{"type":"RollingUpdate","rollingUpdate":{"partition":0}},"revisionHistoryLimit":10},"status":{"observedGeneration":1,"replicas":1,"readyReplicas":1,"currentReplicas":1,"updatedReplicas":1,"currentRevision":"rabbitmq-cluster-server-5f8b8665fb","updateRevision":"rabbitmq-cluster-server-5f8b8665fb","collisionCount":0}}
2022/03/18 18:01:23 learn_server.go:291: [SIEVE-AFTER-READ]	Get	true	service	default	rabbitmq-cluster-nodes	github.com/rabbitmq/cluster-operator/controllers.(*RabbitmqClusterReconciler)	NoError	{"kind":"Service","apiVersion":"v1","metadata":{"name":"rabbitmq-cluster-nodes","namespace":"default","selfLink":"/api/v1/namespaces/default/services/rabbitmq-cluster-nodes","uid":"67c7eea9-1b87-4fd7-82e6-5bfe31fd1b52","resourceVersion":"696","creationTimestamp":"2022-03-18T18:00:38Z","labels":{"app.kubernetes.io/component":"rabbitmq","app.kubernetes.io/name":"rabbitmq-cluster","app.kubernetes.io/part-of":"rabbitmq"},"ownerReferences":[{"apiVersion":"rabbitmq.com/v1beta1","kind":"RabbitmqCluster","name":"rabbitmq-cluster","uid":"18d9928b-0d1c-47be-80ec-20960d053827","controller":true,"blockOwnerDeletion":true}],"managedFields":[{"manager":"manager","operation":"Update","apiVersion":"v1","time":"2022-03-18T18:00:38Z","fieldsType":"FieldsV1","fieldsV1":{"f:metadata":{"f:labels":{".":{},"f:app.kubernetes.io/component":{},"f:app.kubernetes.io/name":{},"f:app.kubernetes.io/part-of":{}},"f:ownerReferences":{".":{},"k:{\"uid\":\"18d9928b-0d1c-47be-80ec-20960d053827\"}":{".":{},"f:apiVersion":{},"f:blockOwnerDeletion":{},"f:controller":{},"f:kind":{},"f:name":{},"f:uid":{}}}},"f:spec":{"f:clusterIP":{},"f:ports":{".":{},"k:{\"port\":4369,\"protocol\":\"TCP\"}":{".":{},"f:name":{},"f:port":{},"f:protocol":{},"f:targetPort":{}},"k:{\"port\":25672,\"protocol\":\"TCP\"}":{".":{},"f:name":{},"f:port":{},"f:protocol":{},"f:targetPort":{}}},"f:publishNotReadyAddresses":{},"f:selector":{".":{},"f:app.kubernetes.io/name":{}},"f:sessionAffinity":{},"f:type":{}}}}]},"spec":{"ports":[{"name":"epmd","protocol":"TCP","port":4369,"targetPort":4369},{"name":"cluster-rpc","protocol":"TCP","port":25672,"targetPort":25672}],"selector":{"app.kubernetes.io/name":"rabbitmq-cluster"},"clusterIP":"None","type":"ClusterIP","sessionAffinity":"None","publishNotReadyAddresses":true},"status":{"loadBalancer":{}}}
2022/03/18 18:01:23 learn_server.go:279: [SIEVE-BEFORE-HEAR]	25	Updated	statefulset	{"metadata":{"name":"rabbitmq-cluster-server","namespace":"default","selfLink":"/apis/apps/v1/namespaces/default/statefulsets/rabbitmq-cluster-server","uid":"cb5c43bc-6ee7-481c-ab01-6f3acffdd3c8","resourceVersion":"989","generation":2,"creationTimestamp":"2022-03-18T18:00:38Z","labels":{"app.kubernetes.io/component":"rabbitmq","app.kubernetes.io/name":"rabbitmq-cluster","app.kubernetes.io/part-of":"rabbitmq"},"ownerReferences":[{"apiVersion":"rabbitmq.com/v1beta1","kind":"RabbitmqCluster","name":"rabbitmq-cluster","uid":"18d9928b-0d1c-47be-80ec-20960d053827","controller":true,"blockOwnerDeletion":true}],"managedFields":[{"manager":"kube-controller-manager","operation":"Update","apiVersion":"apps/v1","time":"2022-03-18T18:01:23Z","fieldsType":"FieldsV1","fieldsV1":{"f:status":{"f:collisionCount":{},"f:currentReplicas":{},"f:currentRevision":{},"f:observedGeneration":{},"f:readyReplicas":{},"f:replicas":{},"f:updateRevision":{},"f:updatedReplicas":{}}}},{"manager":"manager","operation":"Update","apiVersion":"apps/v1","time":"2022-03-18T18:01:23Z","fieldsType":"FieldsV1","fieldsV1":{"f:metadata":{"f:labels":{".":{},"f:app.kubernetes.io/component":{},"f:app.kubernetes.io/name":{},"f:app.kubernetes.io/part-of":{}},"f:ownerReferences":{".":{},"k:{\"uid\":\"18d9928b-0d1c-47be-80ec-20960d053827\"}":{".":{},"f:apiVersion":{},"f:blockOwnerDeletion":{},"f:controller":{},"f:kind":{},"f:name":{},"f:uid":{}}}},"f:spec":{"f:podManagementPolicy":{},"f:replicas":{},"f:revisionHistoryLimit":{},"f:selector":{"f:matchLabels":{".":{},"f:app.kubernetes.io/name":{}}},"f:serviceName":{},"f:template":{"f:metadata":{"f:annotations":{".":{},"f:prometheus.io/port":{},"f:prometheus.io/scrape":{}},"f:labels":{".":{},"f:app.kubernetes.io/component":{},"f:app.kubernetes.io/name":{},"f:app.kubernetes.io/part-of":{}}},"f:spec":{"f:automountServiceAccountToken":{},"f:containers":{"k:{\"name\":\"rabbitmq\"}":{".":{},"f:env":{".":{},"k:{\"name\":\"K8S_HOSTNAME_SUFFIX\"}":{".":{},"f:name":{},"f:value":{}},"k:{\"name\":\"K8S_SERVICE_NAME\"}":{".":{},"f:name":{},"f:value":{}},"k:{\"name\":\"MY_POD_NAME\"}":{".":{},"f:name":{},"f:valueFrom":{".":{},"f:fieldRef":{".":{},"f:apiVersion":{},"f:fieldPath":{}}}},"k:{\"name\":\"MY_POD_NAMESPACE\"}":{".":{},"f:name":{},"f:valueFrom":{".":{},"f:fieldRef":{".":{},"f:apiVersion":{},"f:fieldPath":{}}}},"k:{\"name\":\"RABBITMQ_ENABLED_PLUGINS_FILE\"}":{".":{},"f:name":{},"f:value":{}},"k:{\"name\":\"RABBITMQ_NODENAME\"}":{".":{},"f:name":{},"f:value":{}},"k:{\"name\":\"RABBITMQ_USE_LONGNAME\"}":{".":{},"f:name":{},"f:value":{}}},"f:image":{},"f:imagePullPolicy":{},"f:lifecycle":{".":{},"f:preStop":{".":{},"f:exec":{".":{},"f:command":{}}}},"f:name":{},"f:ports":{".":{},"k:{\"containerPort\":4369,\"protocol\":\"TCP\"}":{".":{},"f:containerPort":{},"f:name":{},"f:protocol":{}},"k:{\"containerPort\":5672,\"protocol\":\"TCP\"}":{".":{},"f:containerPort":{},"f:name":{},"f:protocol":{}},"k:{\"containerPort\":15672,\"protocol\":\"TCP\"}":{".":{},"f:containerPort":{},"f:name":{},"f:protocol":{}},"k:{\"containerPort\":15692,\"protocol\":\"TCP\"}":{".":{},"f:containerPort":{},"f:name":{},"f:protocol":{}}},"f:readinessProbe":{".":{},"f:failureThreshold":{},"f:initialDelaySeconds":{},"f:periodSeconds":{},"f:successThreshold":{},"f:tcpSocket":{".":{},"f:port":{}},"f:timeoutSeconds":{}},"f:resources":{".":{},"f:limits":{".":{},"f:cpu":{},"f:memory":{}},"f:requests":{".":{},"f:cpu":{},"f:memory":{}}},"f:terminationMessagePath":{},"f:terminationMessagePolicy":{},"f:volumeMounts":{".":{},"k:{\"mountPath\":\"/etc/pod-info/\"}":{".":{},"f:mountPath":{},"f:name":{}},"k:{\"mountPath\":\"/etc/rabbitmq/conf.d/10-operatorDefaults.conf\"}":{".":{},"f:mountPath":{},"f:name":{},"f:subPath":{}},"k:{\"mountPath\":\"/etc/rabbitmq/conf.d/11-default_user.conf\"}":{".":{},"f:mountPath":{},"f:name":{},"f:subPath":{}},"k:{\"mountPath\":\"/etc/rabbitmq/conf.d/90-userDefinedConfiguration.conf\"}":{".":{},"f:mountPath":{},"f:name":{},"f:subPath":{}},"k:{\"mountPath\":\"/operator\"}":{".":{},"f:mountPath":{},"f:name":{}},"k:{\"mountPath\":\"/var/lib/rabbitmq/\"}":{".":{},"f:mountPath":{},"f:name":{}},"k:{\"mountPath\":\"/var/lib/rabbitmq/mnesia/\"}":{".":{},"f:mountPath":{},"f:name":{}}}}},"f:dnsPolicy":{},"f:initContainers":{".":{},"k:{\"name\":\"setup-container\"}":{".":{},"f:command":{},"f:image":{},"f:imagePullPolicy":{},"f:name":{},"f:resources":{".":{},"f:limits":{".":{},"f:cpu":{},"f:memory":{}},"f:requests":{".":{},"f:cpu":{},"f:memory":{}}},"f:securityContext":{".":{},"f:capabilities":{".":{},"f:drop":{}},"f:runAsUser":{}},"f:terminationMessagePath":{},"f:terminationMessagePolicy":{},"f:volumeMounts":{".":{},"k:{\"mountPath\":\"/operator\"}":{".":{},"f:mountPath":{},"f:name":{}},"k:{\"mountPath\":\"/tmp/default_user.conf\"}":{".":{},"f:mountPath":{},"f:name":{},"f:subPath":{}},"k:{\"mountPath\":\"/tmp/erlang-cookie-secret/\"}":{".":{},"f:mountPath":{},"f:name":{}},"k:{\"mountPath\":\"/tmp/rabbitmq-plugins/\"}":{".":{},"f:mountPath":{},"f:name":{}},"k:{\"mountPath\":\"/var/lib/rabbitmq/\"}":{".":{},"f:mountPath":{},"f:name":{}},"k:{\"mountPath\":\"/var/lib/rabbitmq/mnesia/\"}":{".":{},"f:mountPath":{},"f:name":{}}}}},"f:restartPolicy":{},"f:schedulerName":{},"f:securityContext":{".":{},"f:fsGroup":{},"f:runAsGroup":{},"f:runAsUser":{}},"f:serviceAccount":{},"f:serviceAccountName":{},"f:terminationGracePeriodSeconds":{},"f:topologySpreadConstraints":{".":{},"k:{\"topologyKey\":\"topology.kubernetes.io/zone\",\"whenUnsatisfiable\":\"ScheduleAnyway\"}":{".":{},"f:labelSelector":{".":{},"f:matchLabels":{".":{},"f:app.kubernetes.io/name":{}}},"f:maxSkew":{},"f:topologyKey":{},"f:whenUnsatisfiable":{}}},"f:volumes":{".":{},"k:{\"name\":\"erlang-cookie-secret\"}":{".":{},"f:name":{},"f:secret":{".":{},"f:defaultMode":{},"f:secretName":{}}},"k:{\"name\":\"plugins-conf\"}":{".":{},"f:configMap":{".":{},"f:defaultMode":{},"f:name":{}},"f:name":{}},"k:{\"name\":\"pod-info\"}":{".":{},"f:downwardAPI":{".":{},"f:defaultMode":{},"f:items":{}},"f:name":{}},"k:{\"name\":\"rabbitmq-confd\"}":{".":{},"f:name":{},"f:projected":{".":{},"f:defaultMode":{},"f:sources":{}}},"k:{\"name\":\"rabbitmq-erlang-cookie\"}":{".":{},"f:emptyDir":{},"f:name":{}},"k:{\"name\":\"rabbitmq-plugins\"}":{".":{},"f:emptyDir":{},"f:name":{}}}}},"f:updateStrategy":{"f:rollingUpdate":{".":{},"f:partition":{}},"f:type":{}},"f:volumeClaimTemplates":{}}}}]},"spec":{"replicas":3,"selector":{"matchLabels":{"app.kubernetes.io/name":"rabbitmq-cluster"}},"template":{"metadata":{"creationTimestamp":null,"labels":{"app.kubernetes.io/component":"rabbitmq","app.kubernetes.io/name":"rabbitmq-cluster","app.kubernetes.io/part-of":"rabbitmq"},"annotations":{"prometheus.io/port":"15692","prometheus.io/scrape":"true"}},"spec":{"volumes":[{"name":"plugins-conf","configMap":{"name":"rabbitmq-cluster-plugins-conf","defaultMode":420}},{"name":"rabbitmq-confd","projected":{"sources":[{"secret":{"name":"rabbitmq-cluster-default-user","items":[{"key":"default_user.conf","path":"default_user.conf"}]}},{"configMap":{"name":"rabbitmq-cluster-server-conf","items":[{"key":"operatorDefaults.conf","path":"operatorDefaults.conf"},{"key":"userDefinedConfiguration.conf","path":"userDefinedConfiguration.conf"}]}}],"defaultMode":420}},{"name":"rabbitmq-erlang-cookie","emptyDir":{}},{"name":"erlang-cookie-secret","secret":{"secretName":"rabbitmq-cluster-erlang-cookie","defaultMode":420}},{"name":"rabbitmq-plugins","emptyDir":{}},{"name":"pod-info","downwardAPI":{"items":[{"path":"skipPreStopChecks","fieldRef":{"apiVersion":"v1","fieldPath":"metadata.labels['skipPreStopChecks']"}}],"defaultMode":420}}],"initContainers":[{"name":"setup-container","image":"rabbitmq:3.8.12-management","command":["sh","-c","cp /tmp/erlang-cookie-secret/.erlang.cookie /var/lib/rabbitmq/.erlang.cookie \u0026\u0026 chown 999:999 /var/lib/rabbitmq/.erlang.cookie \u0026\u0026 chmod 600 /var/lib/rabbitmq/.erlang.cookie ; cp /tmp/rabbitmq-plugins/enabled_plugins /operator/enabled_plugins \u0026\u0026 chown 999:999 /operator/enabled_plugins ; chown 999:999 /var/lib/rabbitmq/mnesia/ ; echo '[default]' \u003e /var/lib/rabbitmq/.rabbitmqadmin.conf \u0026\u0026 sed -e 's/default_user/username/' -e 's/default_pass/password/' /tmp/default_user.conf \u003e\u003e /var/lib/rabbitmq/.rabbitmqadmin.conf \u0026\u0026 chown 999:999 /var/lib/rabbitmq/.rabbitmqadmin.conf \u0026\u0026 chmod 600 /var/lib/rabbitmq/.rabbitmqadmin.conf"],"resources":{"limits":{"cpu":"100m","memory":"500Mi"},"requests":{"cpu":"100m","memory":"500Mi"}},"volumeMounts":[{"name":"plugins-conf","mountPath":"/tmp/rabbitmq-plugins/"},{"name":"rabbitmq-erlang-cookie","mountPath":"/var/lib/rabbitmq/"},{"name":"erlang-cookie-secret","mountPath":"/tmp/erlang-cookie-secret/"},{"name":"rabbitmq-plugins","mountPath":"/operator"},{"name":"persistence","mountPath":"/var/lib/rabbitmq/mnesia/"},{"name":"rabbitmq-confd","mountPath":"/tmp/default_user.conf","subPath":"default_user.conf"}],"terminationMessagePath":"/dev/termination-log","terminationMessagePolicy":"File","imagePullPolicy":"IfNotPresent","securityContext":{"capabilities":{"drop":["FSETID","KILL","SETGID","SETUID","SETPCAP","NET_BIND_SERVICE","NET_RAW","SYS_CHROOT","MKNOD","AUDIT_WRITE","SETFCAP"]},"runAsUser":0}}],"containers":[{"name":"rabbitmq","image":"rabbitmq:3.8.12-management","ports":[{"name":"epmd","containerPort":4369,"protocol":"TCP"},{"name":"amqp","containerPort":5672,"protocol":"TCP"},{"name":"management","containerPort":15672,"protocol":"TCP"},{"name":"prometheus","containerPort":15692,"protocol":"TCP"}],"env":[{"name":"MY_POD_NAME","valueFrom":{"fieldRef":{"apiVersion":"v1","fieldPath":"metadata.name"}}},{"name":"MY_POD_NAMESPACE","valueFrom":{"fieldRef":{"apiVersion":"v1","fieldPath":"metadata.namespace"}}},{"name":"RABBITMQ_ENABLED_PLUGINS_FILE","value":"/operator/enabled_plugins"},{"name":"K8S_SERVICE_NAME","value":"rabbitmq-cluster-nodes"},{"name":"RABBITMQ_USE_LONGNAME","value":"true"},{"name":"RABBITMQ_NODENAME","value":"rabbit@$(MY_POD_NAME).$(K8S_SERVICE_NAME).$(MY_POD_NAMESPACE)"},{"name":"K8S_HOSTNAME_SUFFIX","value":".$(K8S_SERVICE_NAME).$(MY_POD_NAMESPACE)"}],"resources":{"limits":{"cpu":"2","memory":"2Gi"},"requests":{"cpu":"1","memory":"2Gi"}},"volumeMounts":[{"name":"rabbitmq-erlang-cookie","mountPath":"/var/lib/rabbitmq/"},{"name":"persistence","mountPath":"/var/lib/rabbitmq/mnesia/"},{"name":"rabbitmq-plugins","mountPath":"/operator"},{"name":"rabbitmq-confd","mountPath":"/etc/rabbitmq/conf.d/10-operatorDefaults.conf","subPath":"operatorDefaults.conf"},{"name":"rabbitmq-confd","mountPath":"/etc/rabbitmq/conf.d/11-default_user.conf","subPath":"default_user.conf"},{"name":"rabbitmq-confd","mountPath":"/etc/rabbitmq/conf.d/90-userDefinedConfiguration.conf","subPath":"userDefinedConfiguration.conf"},{"name":"pod-info","mountPath":"/etc/pod-info/"}],"readinessProbe":{"tcpSocket":{"port":"amqp"},"initialDelaySeconds":10,"timeoutSeconds":5,"periodSeconds":10,"successThreshold":1,"failureThreshold":3},"lifecycle":{"preStop":{"exec":{"command":["/bin/bash","-c","if [ ! -z \"$(cat /etc/pod-info/skipPreStopChecks)\" ]; then exit 0; fi; rabbitmq-upgrade await_online_quorum_plus_one -t 604800; rabbitmq-upgrade await_online_synchronized_mirror -t 604800; rabbitmq-upgrade drain -t 604800"]}}},"terminationMessagePath":"/dev/termination-log","terminationMessagePolicy":"File","imagePullPolicy":"IfNotPresent"}],"restartPolicy":"Always","terminationGracePeriodSeconds":604800,"dnsPolicy":"ClusterFirst","serviceAccountName":"rabbitmq-cluster-server","serviceAccount":"rabbitmq-cluster-server","automountServiceAccountToken":true,"securityContext":{"runAsUser":999,"runAsGroup":999,"fsGroup":999},"schedulerName":"default-scheduler","topologySpreadConstraints":[{"maxSkew":1,"topologyKey":"topology.kubernetes.io/zone","whenUnsatisfiable":"ScheduleAnyway","labelSelector":{"matchLabels":{"app.kubernetes.io/name":"rabbitmq-cluster"}}}]}},"volumeClaimTemplates":[{"metadata":{"name":"persistence","namespace":"default","creationTimestamp":null,"labels":{"app.kubernetes.io/component":"rabbitmq","app.kubernetes.io/name":"rabbitmq-cluster","app.kubernetes.io/part-of":"rabbitmq"},"ownerReferences":[{"apiVersion":"rabbitmq.com/v1beta1","kind":"RabbitmqCluster","name":"rabbitmq-cluster","uid":"18d9928b-0d1c-47be-80ec-20960d053827","controller":true,"blockOwnerDeletion":false}]},"spec":{"accessModes":["ReadWriteOnce"],"resources":{"requests":{"storage":"10Gi"}},"volumeMode":"Filesystem"},"status":{"phase":"Pending"}}],"serviceName":"rabbitmq-cluster-nodes","podManagementPolicy":"Parallel","updateStrategy":{"type":"RollingUpdate","rollingUpdate":{"partition":0}},"revisionHistoryLimit":10},"status":{"observedGeneration":2,"replicas":3,"readyReplicas":1,"currentReplicas":3,"updatedReplicas":3,"currentRevision":"rabbitmq-cluster-server-5f8b8665fb","updateRevision":"rabbitmq-cluster-server-5f8b8665fb","collisionCount":0}}
2022/03/18 18:01:23 learn_server.go:289: [SIEVE-AFTER-HEAR]	25
2022/03/18 18:01:23 learn_server.go:291: [SIEVE-AFTER-READ]	Get	true	service	default	rabbitmq-cluster	github.com/rabbitmq/cluster-operator/controllers.(*RabbitmqClusterReconciler)	NoError	{"kind":"Service","apiVersion":"v1","metadata":{"name":"rabbitmq-cluster","namespace":"default","selfLink":"/api/v1/namespaces/default/services/rabbitmq-cluster","uid":"56b50671-1945-458b-adac-05619b783392","resourceVersion":"701","creationTimestamp":"2022-03-18T18:00:38Z","labels":{"app.kubernetes.io/component":"rabbitmq","app.kubernetes.io/name":"rabbitmq-cluster","app.kubernetes.io/part-of":"rabbitmq"},"ownerReferences":[{"apiVersion":"rabbitmq.com/v1beta1","kind":"RabbitmqCluster","name":"rabbitmq-cluster","uid":"18d9928b-0d1c-47be-80ec-20960d053827","controller":true,"blockOwnerDeletion":true}],"managedFields":[{"manager":"manager","operation":"Update","apiVersion":"v1","time":"2022-03-18T18:00:38Z","fieldsType":"FieldsV1","fieldsV1":{"f:metadata":{"f:labels":{".":{},"f:app.kubernetes.io/component":{},"f:app.kubernetes.io/name":{},"f:app.kubernetes.io/part-of":{}},"f:ownerReferences":{".":{},"k:{\"uid\":\"18d9928b-0d1c-47be-80ec-20960d053827\"}":{".":{},"f:apiVersion":{},"f:blockOwnerDeletion":{},"f:controller":{},"f:kind":{},"f:name":{},"f:uid":{}}}},"f:spec":{"f:ports":{".":{},"k:{\"port\":5672,\"protocol\":\"TCP\"}":{".":{},"f:name":{},"f:port":{},"f:protocol":{},"f:targetPort":{}},"k:{\"port\":15672,\"protocol\":\"TCP\"}":{".":{},"f:name":{},"f:port":{},"f:protocol":{},"f:targetPort":{}}},"f:selector":{".":{},"f:app.kubernetes.io/name":{}},"f:sessionAffinity":{},"f:type":{}}}}]},"spec":{"ports":[{"name":"amqp","protocol":"TCP","port":5672,"targetPort":5672},{"name":"management","protocol":"TCP","port":15672,"targetPort":15672}],"selector":{"app.kubernetes.io/name":"rabbitmq-cluster"},"clusterIP":"10.96.254.158","type":"ClusterIP","sessionAffinity":"None"},"status":{"loadBalancer":{}}}
2022/03/18 18:01:23 learn_server.go:291: [SIEVE-AFTER-READ]	Get	true	secret	default	rabbitmq-cluster-erlang-cookie	github.com/rabbitmq/cluster-operator/controllers.(*RabbitmqClusterReconciler)	NoError	{"kind":"Secret","apiVersion":"v1","metadata":{"name":"rabbitmq-cluster-erlang-cookie","namespace":"default","selfLink":"/api/v1/namespaces/default/secrets/rabbitmq-cluster-erlang-cookie","uid":"f8fbe8a6-0f40-4e13-960b-ab78b8ba75b0","resourceVersion":"705","creationTimestamp":"2022-03-18T18:00:38Z","labels":{"app.kubernetes.io/component":"rabbitmq","app.kubernetes.io/name":"rabbitmq-cluster","app.kubernetes.io/part-of":"rabbitmq"},"ownerReferences":[{"apiVersion":"rabbitmq.com/v1beta1","kind":"RabbitmqCluster","name":"rabbitmq-cluster","uid":"18d9928b-0d1c-47be-80ec-20960d053827","controller":true,"blockOwnerDeletion":true}],"managedFields":[{"manager":"manager","operation":"Update","apiVersion":"v1","time":"2022-03-18T18:00:38Z","fieldsType":"FieldsV1","fieldsV1":{"f:data":{".":{},"f:.erlang.cookie":{}},"f:metadata":{"f:labels":{".":{},"f:app.kubernetes.io/component":{},"f:app.kubernetes.io/name":{},"f:app.kubernetes.io/part-of":{}},"f:ownerReferences":{".":{},"k:{\"uid\":\"18d9928b-0d1c-47be-80ec-20960d053827\"}":{".":{},"f:apiVersion":{},"f:blockOwnerDeletion":{},"f:controller":{},"f:kind":{},"f:name":{},"f:uid":{}}}},"f:type":{}}}]},"data":{".erlang.cookie":"QW9hMkpWU0tlYS1FUGdWTUhrelNMNnFoMFZ0ZmRGNUY="},"type":"Opaque"}
2022/03/18 18:01:23 learn_server.go:291: [SIEVE-AFTER-READ]	Get	true	secret	default	rabbitmq-cluster-default-user	github.com/rabbitmq/cluster-operator/controllers.(*RabbitmqClusterReconciler)	NoError	{"kind":"Secret","apiVersion":"v1","metadata":{"name":"rabbitmq-cluster-default-user","namespace":"default","selfLink":"/api/v1/namespaces/default/secrets/rabbitmq-cluster-default-user","uid":"0d9f460b-a23c-402b-8273-f541ed39023f","resourceVersion":"708","creationTimestamp":"2022-03-18T18:00:38Z","labels":{"app.kubernetes.io/component":"rabbitmq","app.kubernetes.io/name":"rabbitmq-cluster","app.kubernetes.io/part-of":"rabbitmq"},"ownerReferences":[{"apiVersion":"rabbitmq.com/v1beta1","kind":"RabbitmqCluster","name":"rabbitmq-cluster","uid":"18d9928b-0d1c-47be-80ec-20960d053827","controller":true,"blockOwnerDeletion":true}],"managedFields":[{"manager":"manager","operation":"Update","apiVersion":"v1","time":"2022-03-18T18:00:38Z","fieldsType":"FieldsV1","fieldsV1":{"f:data":{".":{},"f:default_user.conf":{},"f:password":{},"f:provider":{},"f:type":{},"f:username":{}},"f:metadata":{"f:labels":{".":{},"f:app.kubernetes.io/component":{},"f:app.kubernetes.io/name":{},"f:app.kubernetes.io/part-of":{}},"f:ownerReferences":{".":{},"k:{\"uid\":\"18d9928b-0d1c-47be-80ec-20960d053827\"}":{".":{},"f:apiVersion":{},"f:blockOwnerDeletion":{},"f:controller":{},"f:kind":{},"f:name":{},"f:uid":{}}}},"f:type":{}}}]},"data":{"default_user.conf":"ZGVmYXVsdF91c2VyID0gcTMxRmh3MGtjWW9SZUl5X3BPTXp2ZVBOUnNVU3I1Mk8KZGVmYXVsdF9wYXNzID0gY0dBX19jNTJHX05hVURpTGhraWZ6UDBOVVlNLTE2MWQK","password":"Y0dBX19jNTJHX05hVURpTGhraWZ6UDBOVVlNLTE2MWQ=","provider":"cmFiYml0bXE=","type":"cmFiYml0bXE=","username":"cTMxRmh3MGtjWW9SZUl5X3BPTXp2ZVBOUnNVU3I1Mk8="},"type":"Opaque"}
2022/03/18 18:01:23 learn_server.go:291: [SIEVE-AFTER-READ]	Get	true	configmap	default	rabbitmq-cluster-plugins-conf	github.com/rabbitmq/cluster-operator/controllers.(*RabbitmqClusterReconciler)	NoError	{"kind":"ConfigMap","apiVersion":"v1","metadata":{"name":"rabbitmq-cluster-plugins-conf","namespace":"default","selfLink":"/api/v1/namespaces/default/configmaps/rabbitmq-cluster-plugins-conf","uid":"a164075b-0562-47ac-a577-99aa8651ec40","resourceVersion":"709","creationTimestamp":"2022-03-18T18:00:38Z","labels":{"app.kubernetes.io/component":"rabbitmq","app.kubernetes.io/name":"rabbitmq-cluster","app.kubernetes.io/part-of":"rabbitmq"},"ownerReferences":[{"apiVersion":"rabbitmq.com/v1beta1","kind":"RabbitmqCluster","name":"rabbitmq-cluster","uid":"18d9928b-0d1c-47be-80ec-20960d053827","controller":true,"blockOwnerDeletion":true}],"managedFields":[{"manager":"manager","operation":"Update","apiVersion":"v1","time":"2022-03-18T18:00:38Z","fieldsType":"FieldsV1","fieldsV1":{"f:data":{".":{},"f:enabled_plugins":{}},"f:metadata":{"f:labels":{".":{},"f:app.kubernetes.io/component":{},"f:app.kubernetes.io/name":{},"f:app.kubernetes.io/part-of":{}},"f:ownerReferences":{".":{},"k:{\"uid\":\"18d9928b-0d1c-47be-80ec-20960d053827\"}":{".":{},"f:apiVersion":{},"f:blockOwnerDeletion":{},"f:controller":{},"f:kind":{},"f:name":{},"f:uid":{}}}}}}]},"data":{"enabled_plugins":"[rabbitmq_peer_discovery_k8s,rabbitmq_prometheus,rabbitmq_management]."}}
2022/03/18 18:01:23 learn_server.go:291: [SIEVE-AFTER-READ]	Get	true	configmap	default	rabbitmq-cluster-server-conf	github.com/rabbitmq/cluster-operator/controllers.(*RabbitmqClusterReconciler)	NoError	{"kind":"ConfigMap","apiVersion":"v1","metadata":{"name":"rabbitmq-cluster-server-conf","namespace":"default","selfLink":"/api/v1/namespaces/default/configmaps/rabbitmq-cluster-server-conf","uid":"22474f2b-8454-44b7-8079-8990223969cc","resourceVersion":"714","creationTimestamp":"2022-03-18T18:00:38Z","labels":{"app.kubernetes.io/component":"rabbitmq","app.kubernetes.io/name":"rabbitmq-cluster","app.kubernetes.io/part-of":"rabbitmq"},"ownerReferences":[{"apiVersion":"rabbitmq.com/v1beta1","kind":"RabbitmqCluster","name":"rabbitmq-cluster","uid":"18d9928b-0d1c-47be-80ec-20960d053827","controller":true,"blockOwnerDeletion":true}],"managedFields":[{"manager":"manager","operation":"Update","apiVersion":"v1","time":"2022-03-18T18:00:38Z","fieldsType":"FieldsV1","fieldsV1":{"f:data":{".":{},"f:operatorDefaults.conf":{},"f:userDefinedConfiguration.conf":{}},"f:metadata":{"f:labels":{".":{},"f:app.kubernetes.io/component":{},"f:app.kubernetes.io/name":{},"f:app.kubernetes.io/part-of":{}},"f:ownerReferences":{".":{},"k:{\"uid\":\"18d9928b-0d1c-47be-80ec-20960d053827\"}":{".":{},"f:apiVersion":{},"f:blockOwnerDeletion":{},"f:controller":{},"f:kind":{},"f:name":{},"f:uid":{}}}}}}]},"data":{"operatorDefaults.conf":"cluster_formation.peer_discovery_backend             = rabbit_peer_discovery_k8s\ncluster_formation.k8s.host                           = kubernetes.default\ncluster_formation.k8s.address_type                   = hostname\ncluster_partition_handling                           = pause_minority\nqueue_master_locator                                 = min-masters\ndisk_free_limit.absolute                             = 2GB\ncluster_formation.randomized_startup_delay_range.min = 5\ncluster_formation.randomized_startup_delay_range.max = 30\ncluster_name                                         = rabbitmq-cluster\n","userDefinedConfiguration.conf":"total_memory_available_override_value = 1717986919\n"}}
2022/03/18 18:01:23 learn_server.go:291: [SIEVE-AFTER-READ]	Get	true	serviceaccount	default	rabbitmq-cluster-server	github.com/rabbitmq/cluster-operator/controllers.(*RabbitmqClusterReconciler)	NoError	{"kind":"ServiceAccount","apiVersion":"v1","metadata":{"name":"rabbitmq-cluster-server","namespace":"default","selfLink":"/api/v1/namespaces/default/serviceaccounts/rabbitmq-cluster-server","uid":"731589b5-ac97-4774-bee4-008949b54734","resourceVersion":"722","creationTimestamp":"2022-03-18T18:00:38Z","labels":{"app.kubernetes.io/component":"rabbitmq","app.kubernetes.io/name":"rabbitmq-cluster","app.kubernetes.io/part-of":"rabbitmq"},"ownerReferences":[{"apiVersion":"rabbitmq.com/v1beta1","kind":"RabbitmqCluster","name":"rabbitmq-cluster","uid":"18d9928b-0d1c-47be-80ec-20960d053827","controller":true,"blockOwnerDeletion":true}],"managedFields":[{"manager":"kube-controller-manager","operation":"Update","apiVersion":"v1","time":"2022-03-18T18:00:38Z","fieldsType":"FieldsV1","fieldsV1":{"f:secrets":{".":{},"k:{\"name\":\"rabbitmq-cluster-server-token-rhzq9\"}":{".":{},"f:name":{}}}}},{"manager":"manager","operation":"Update","apiVersion":"v1","time":"2022-03-18T18:00:38Z","fieldsType":"FieldsV1","fieldsV1":{"f:metadata":{"f:labels":{".":{},"f:app.kubernetes.io/component":{},"f:app.kubernetes.io/name":{},"f:app.kubernetes.io/part-of":{}},"f:ownerReferences":{".":{},"k:{\"uid\":\"18d9928b-0d1c-47be-80ec-20960d053827\"}":{".":{},"f:apiVersion":{},"f:blockOwnerDeletion":{},"f:controller":{},"f:kind":{},"f:name":{},"f:uid":{}}}}}}]},"secrets":[{"name":"rabbitmq-cluster-server-token-rhzq9"}]}
2022/03/18 18:01:23 learn_server.go:291: [SIEVE-AFTER-READ]	Get	true	role	default	rabbitmq-cluster-peer-discovery	github.com/rabbitmq/cluster-operator/controllers.(*RabbitmqClusterReconciler)	NoError	{"kind":"Role","apiVersion":"rbac.authorization.k8s.io/v1","metadata":{"name":"rabbitmq-cluster-peer-discovery","namespace":"default","selfLink":"/apis/rbac.authorization.k8s.io/v1/namespaces/default/roles/rabbitmq-cluster-peer-discovery","uid":"52c80b50-4fdd-4089-bbfd-9756465953f2","resourceVersion":"723","creationTimestamp":"2022-03-18T18:00:38Z","labels":{"app.kubernetes.io/component":"rabbitmq","app.kubernetes.io/name":"rabbitmq-cluster","app.kubernetes.io/part-of":"rabbitmq"},"ownerReferences":[{"apiVersion":"rabbitmq.com/v1beta1","kind":"RabbitmqCluster","name":"rabbitmq-cluster","uid":"18d9928b-0d1c-47be-80ec-20960d053827","controller":true,"blockOwnerDeletion":true}],"managedFields":[{"manager":"manager","operation":"Update","apiVersion":"rbac.authorization.k8s.io/v1","time":"2022-03-18T18:00:38Z","fieldsType":"FieldsV1","fieldsV1":{"f:metadata":{"f:labels":{".":{},"f:app.kubernetes.io/component":{},"f:app.kubernetes.io/name":{},"f:app.kubernetes.io/part-of":{}},"f:ownerReferences":{".":{},"k:{\"uid\":\"18d9928b-0d1c-47be-80ec-20960d053827\"}":{".":{},"f:apiVersion":{},"f:blockOwnerDeletion":{},"f:controller":{},"f:kind":{},"f:name":{},"f:uid":{}}}},"f:rules":{}}}]},"rules":[{"verbs":["get"],"apiGroups":[""],"resources":["endpoints"]},{"verbs":["create"],"apiGroups":[""],"resources":["events"]}]}
2022/03/18 18:01:23 learn_server.go:291: [SIEVE-AFTER-READ]	Get	true	rolebinding	default	rabbitmq-cluster-server	github.com/rabbitmq/cluster-operator/controllers.(*RabbitmqClusterReconciler)	NoError	{"kind":"RoleBinding","apiVersion":"rbac.authorization.k8s.io/v1","metadata":{"name":"rabbitmq-cluster-server","namespace":"default","selfLink":"/apis/rbac.authorization.k8s.io/v1/namespaces/default/rolebindings/rabbitmq-cluster-server","uid":"495e9f7c-a20d-4515-86b0-34149a855034","resourceVersion":"725","creationTimestamp":"2022-03-18T18:00:38Z","labels":{"app.kubernetes.io/component":"rabbitmq","app.kubernetes.io/name":"rabbitmq-cluster","app.kubernetes.io/part-of":"rabbitmq"},"ownerReferences":[{"apiVersion":"rabbitmq.com/v1beta1","kind":"RabbitmqCluster","name":"rabbitmq-cluster","uid":"18d9928b-0d1c-47be-80ec-20960d053827","controller":true,"blockOwnerDeletion":true}],"managedFields":[{"manager":"manager","operation":"Update","apiVersion":"rbac.authorization.k8s.io/v1","time":"2022-03-18T18:00:38Z","fieldsType":"FieldsV1","fieldsV1":{"f:metadata":{"f:labels":{".":{},"f:app.kubernetes.io/component":{},"f:app.kubernetes.io/name":{},"f:app.kubernetes.io/part-of":{}},"f:ownerReferences":{".":{},"k:{\"uid\":\"18d9928b-0d1c-47be-80ec-20960d053827\"}":{".":{},"f:apiVersion":{},"f:blockOwnerDeletion":{},"f:controller":{},"f:kind":{},"f:name":{},"f:uid":{}}}},"f:roleRef":{"f:apiGroup":{},"f:kind":{},"f:name":{}},"f:subjects":{}}}]},"subjects":[{"kind":"ServiceAccount","name":"rabbitmq-cluster-server"}],"roleRef":{"apiGroup":"rbac.authorization.k8s.io","kind":"Role","name":"rabbitmq-cluster-peer-discovery"}}
2022/03/18 18:01:23 learn_server.go:291: [SIEVE-AFTER-READ]	Get	true	statefulset	default	rabbitmq-cluster-server	github.com/rabbitmq/cluster-operator/controllers.(*RabbitmqClusterReconciler)	NoError	{"kind":"StatefulSet","apiVersion":"apps/v1","metadata":{"name":"rabbitmq-cluster-server","namespace":"default","selfLink":"/apis/apps/v1/namespaces/default/statefulsets/rabbitmq-cluster-server","uid":"cb5c43bc-6ee7-481c-ab01-6f3acffdd3c8","resourceVersion":"989","generation":2,"creationTimestamp":"2022-03-18T18:00:38Z","labels":{"app.kubernetes.io/component":"rabbitmq","app.kubernetes.io/name":"rabbitmq-cluster","app.kubernetes.io/part-of":"rabbitmq"},"ownerReferences":[{"apiVersion":"rabbitmq.com/v1beta1","kind":"RabbitmqCluster","name":"rabbitmq-cluster","uid":"18d9928b-0d1c-47be-80ec-20960d053827","controller":true,"blockOwnerDeletion":true}],"managedFields":[{"manager":"kube-controller-manager","operation":"Update","apiVersion":"apps/v1","time":"2022-03-18T18:01:23Z","fieldsType":"FieldsV1","fieldsV1":{"f:status":{"f:collisionCount":{},"f:currentReplicas":{},"f:currentRevision":{},"f:observedGeneration":{},"f:readyReplicas":{},"f:replicas":{},"f:updateRevision":{},"f:updatedReplicas":{}}}},{"manager":"manager","operation":"Update","apiVersion":"apps/v1","time":"2022-03-18T18:01:23Z","fieldsType":"FieldsV1","fieldsV1":{"f:metadata":{"f:labels":{".":{},"f:app.kubernetes.io/component":{},"f:app.kubernetes.io/name":{},"f:app.kubernetes.io/part-of":{}},"f:ownerReferences":{".":{},"k:{\"uid\":\"18d9928b-0d1c-47be-80ec-20960d053827\"}":{".":{},"f:apiVersion":{},"f:blockOwnerDeletion":{},"f:controller":{},"f:kind":{},"f:name":{},"f:uid":{}}}},"f:spec":{"f:podManagementPolicy":{},"f:replicas":{},"f:revisionHistoryLimit":{},"f:selector":{"f:matchLabels":{".":{},"f:app.kubernetes.io/name":{}}},"f:serviceName":{},"f:template":{"f:metadata":{"f:annotations":{".":{},"f:prometheus.io/port":{},"f:prometheus.io/scrape":{}},"f:labels":{".":{},"f:app.kubernetes.io/component":{},"f:app.kubernetes.io/name":{},"f:app.kubernetes.io/part-of":{}}},"f:spec":{"f:automountServiceAccountToken":{},"f:containers":{"k:{\"name\":\"rabbitmq\"}":{".":{},"f:env":{".":{},"k:{\"name\":\"K8S_HOSTNAME_SUFFIX\"}":{".":{},"f:name":{},"f:value":{}},"k:{\"name\":\"K8S_SERVICE_NAME\"}":{".":{},"f:name":{},"f:value":{}},"k:{\"name\":\"MY_POD_NAME\"}":{".":{},"f:name":{},"f:valueFrom":{".":{},"f:fieldRef":{".":{},"f:apiVersion":{},"f:fieldPath":{}}}},"k:{\"name\":\"MY_POD_NAMESPACE\"}":{".":{},"f:name":{},"f:valueFrom":{".":{},"f:fieldRef":{".":{},"f:apiVersion":{},"f:fieldPath":{}}}},"k:{\"name\":\"RABBITMQ_ENABLED_PLUGINS_FILE\"}":{".":{},"f:name":{},"f:value":{}},"k:{\"name\":\"RABBITMQ_NODENAME\"}":{".":{},"f:name":{},"f:value":{}},"k:{\"name\":\"RABBITMQ_USE_LONGNAME\"}":{".":{},"f:name":{},"f:value":{}}},"f:image":{},"f:imagePullPolicy":{},"f:lifecycle":{".":{},"f:preStop":{".":{},"f:exec":{".":{},"f:command":{}}}},"f:name":{},"f:ports":{".":{},"k:{\"containerPort\":4369,\"protocol\":\"TCP\"}":{".":{},"f:containerPort":{},"f:name":{},"f:protocol":{}},"k:{\"containerPort\":5672,\"protocol\":\"TCP\"}":{".":{},"f:containerPort":{},"f:name":{},"f:protocol":{}},"k:{\"containerPort\":15672,\"protocol\":\"TCP\"}":{".":{},"f:containerPort":{},"f:name":{},"f:protocol":{}},"k:{\"containerPort\":15692,\"protocol\":\"TCP\"}":{".":{},"f:containerPort":{},"f:name":{},"f:protocol":{}}},"f:readinessProbe":{".":{},"f:failureThreshold":{},"f:initialDelaySeconds":{},"f:periodSeconds":{},"f:successThreshold":{},"f:tcpSocket":{".":{},"f:port":{}},"f:timeoutSeconds":{}},"f:resources":{".":{},"f:limits":{".":{},"f:cpu":{},"f:memory":{}},"f:requests":{".":{},"f:cpu":{},"f:memory":{}}},"f:terminationMessagePath":{},"f:terminationMessagePolicy":{},"f:volumeMounts":{".":{},"k:{\"mountPath\":\"/etc/pod-info/\"}":{".":{},"f:mountPath":{},"f:name":{}},"k:{\"mountPath\":\"/etc/rabbitmq/conf.d/10-operatorDefaults.conf\"}":{".":{},"f:mountPath":{},"f:name":{},"f:subPath":{}},"k:{\"mountPath\":\"/etc/rabbitmq/conf.d/11-default_user.conf\"}":{".":{},"f:mountPath":{},"f:name":{},"f:subPath":{}},"k:{\"mountPath\":\"/etc/rabbitmq/conf.d/90-userDefinedConfiguration.conf\"}":{".":{},"f:mountPath":{},"f:name":{},"f:subPath":{}},"k:{\"mountPath\":\"/operator\"}":{".":{},"f:mountPath":{},"f:name":{}},"k:{\"mountPath\":\"/var/lib/rabbitmq/\"}":{".":{},"f:mountPath":{},"f:name":{}},"k:{\"mountPath\":\"/var/lib/rabbitmq/mnesia/\"}":{".":{},"f:mountPath":{},"f:name":{}}}}},"f:dnsPolicy":{},"f:initContainers":{".":{},"k:{\"name\":\"setup-container\"}":{".":{},"f:command":{},"f:image":{},"f:imagePullPolicy":{},"f:name":{},"f:resources":{".":{},"f:limits":{".":{},"f:cpu":{},"f:memory":{}},"f:requests":{".":{},"f:cpu":{},"f:memory":{}}},"f:securityContext":{".":{},"f:capabilities":{".":{},"f:drop":{}},"f:runAsUser":{}},"f:terminationMessagePath":{},"f:terminationMessagePolicy":{},"f:volumeMounts":{".":{},"k:{\"mountPath\":\"/operator\"}":{".":{},"f:mountPath":{},"f:name":{}},"k:{\"mountPath\":\"/tmp/default_user.conf\"}":{".":{},"f:mountPath":{},"f:name":{},"f:subPath":{}},"k:{\"mountPath\":\"/tmp/erlang-cookie-secret/\"}":{".":{},"f:mountPath":{},"f:name":{}},"k:{\"mountPath\":\"/tmp/rabbitmq-plugins/\"}":{".":{},"f:mountPath":{},"f:name":{}},"k:{\"mountPath\":\"/var/lib/rabbitmq/\"}":{".":{},"f:mountPath":{},"f:name":{}},"k:{\"mountPath\":\"/var/lib/rabbitmq/mnesia/\"}":{".":{},"f:mountPath":{},"f:name":{}}}}},"f:restartPolicy":{},"f:schedulerName":{},"f:securityContext":{".":{},"f:fsGroup":{},"f:runAsGroup":{},"f:runAsUser":{}},"f:serviceAccount":{},"f:serviceAccountName":{},"f:terminationGracePeriodSeconds":{},"f:topologySpreadConstraints":{".":{},"k:{\"topologyKey\":\"topology.kubernetes.io/zone\",\"whenUnsatisfiable\":\"ScheduleAnyway\"}":{".":{},"f:labelSelector":{".":{},"f:matchLabels":{".":{},"f:app.kubernetes.io/name":{}}},"f:maxSkew":{},"f:topologyKey":{},"f:whenUnsatisfiable":{}}},"f:volumes":{".":{},"k:{\"name\":\"erlang-cookie-secret\"}":{".":{},"f:name":{},"f:secret":{".":{},"f:defaultMode":{},"f:secretName":{}}},"k:{\"name\":\"plugins-conf\"}":{".":{},"f:configMap":{".":{},"f:defaultMode":{},"f:name":{}},"f:name":{}},"k:{\"name\":\"pod-info\"}":{".":{},"f:downwardAPI":{".":{},"f:defaultMode":{},"f:items":{}},"f:name":{}},"k:{\"name\":\"rabbitmq-confd\"}":{".":{},"f:name":{},"f:projected":{".":{},"f:defaultMode":{},"f:sources":{}}},"k:{\"name\":\"rabbitmq-erlang-cookie\"}":{".":{},"f:emptyDir":{},"f:name":{}},"k:{\"name\":\"rabbitmq-plugins\"}":{".":{},"f:emptyDir":{},"f:name":{}}}}},"f:updateStrategy":{"f:rollingUpdate":{".":{},"f:partition":{}},"f:type":{}},"f:volumeClaimTemplates":{}}}}]},"spec":{"replicas":3,"selector":{"matchLabels":{"app.kubernetes.io/name":"rabbitmq-cluster"}},"template":{"metadata":{"creationTimestamp":null,"labels":{"app.kubernetes.io/component":"rabbitmq","app.kubernetes.io/name":"rabbitmq-cluster","app.kubernetes.io/part-of":"rabbitmq"},"annotations":{"prometheus.io/port":"15692","prometheus.io/scrape":"true"}},"spec":{"volumes":[{"name":"plugins-conf","configMap":{"name":"rabbitmq-cluster-plugins-conf","defaultMode":420}},{"name":"rabbitmq-confd","projected":{"sources":[{"secret":{"name":"rabbitmq-cluster-default-user","items":[{"key":"default_user.conf","path":"default_user.conf"}]}},{"configMap":{"name":"rabbitmq-cluster-server-conf","items":[{"key":"operatorDefaults.conf","path":"operatorDefaults.conf"},{"key":"userDefinedConfiguration.conf","path":"userDefinedConfiguration.conf"}]}}],"defaultMode":420}},{"name":"rabbitmq-erlang-cookie","emptyDir":{}},{"name":"erlang-cookie-secret","secret":{"secretName":"rabbitmq-cluster-erlang-cookie","defaultMode":420}},{"name":"rabbitmq-plugins","emptyDir":{}},{"name":"pod-info","downwardAPI":{"items":[{"path":"skipPreStopChecks","fieldRef":{"apiVersion":"v1","fieldPath":"metadata.labels['skipPreStopChecks']"}}],"defaultMode":420}}],"initContainers":[{"name":"setup-container","image":"rabbitmq:3.8.12-management","command":["sh","-c","cp /tmp/erlang-cookie-secret/.erlang.cookie /var/lib/rabbitmq/.erlang.cookie \u0026\u0026 chown 999:999 /var/lib/rabbitmq/.erlang.cookie \u0026\u0026 chmod 600 /var/lib/rabbitmq/.erlang.cookie ; cp /tmp/rabbitmq-plugins/enabled_plugins /operator/enabled_plugins \u0026\u0026 chown 999:999 /operator/enabled_plugins ; chown 999:999 /var/lib/rabbitmq/mnesia/ ; echo '[default]' \u003e /var/lib/rabbitmq/.rabbitmqadmin.conf \u0026\u0026 sed -e 's/default_user/username/' -e 's/default_pass/password/' /tmp/default_user.conf \u003e\u003e /var/lib/rabbitmq/.rabbitmqadmin.conf \u0026\u0026 chown 999:999 /var/lib/rabbitmq/.rabbitmqadmin.conf \u0026\u0026 chmod 600 /var/lib/rabbitmq/.rabbitmqadmin.conf"],"resources":{"limits":{"cpu":"100m","memory":"500Mi"},"requests":{"cpu":"100m","memory":"500Mi"}},"volumeMounts":[{"name":"plugins-conf","mountPath":"/tmp/rabbitmq-plugins/"},{"name":"rabbitmq-erlang-cookie","mountPath":"/var/lib/rabbitmq/"},{"name":"erlang-cookie-secret","mountPath":"/tmp/erlang-cookie-secret/"},{"name":"rabbitmq-plugins","mountPath":"/operator"},{"name":"persistence","mountPath":"/var/lib/rabbitmq/mnesia/"},{"name":"rabbitmq-confd","mountPath":"/tmp/default_user.conf","subPath":"default_user.conf"}],"terminationMessagePath":"/dev/termination-log","terminationMessagePolicy":"File","imagePullPolicy":"IfNotPresent","securityContext":{"capabilities":{"drop":["FSETID","KILL","SETGID","SETUID","SETPCAP","NET_BIND_SERVICE","NET_RAW","SYS_CHROOT","MKNOD","AUDIT_WRITE","SETFCAP"]},"runAsUser":0}}],"containers":[{"name":"rabbitmq","image":"rabbitmq:3.8.12-management","ports":[{"name":"epmd","containerPort":4369,"protocol":"TCP"},{"name":"amqp","containerPort":5672,"protocol":"TCP"},{"name":"management","containerPort":15672,"protocol":"TCP"},{"name":"prometheus","containerPort":15692,"protocol":"TCP"}],"env":[{"name":"MY_POD_NAME","valueFrom":{"fieldRef":{"apiVersion":"v1","fieldPath":"metadata.name"}}},{"name":"MY_POD_NAMESPACE","valueFrom":{"fieldRef":{"apiVersion":"v1","fieldPath":"metadata.namespace"}}},{"name":"RABBITMQ_ENABLED_PLUGINS_FILE","value":"/operator/enabled_plugins"},{"name":"K8S_SERVICE_NAME","value":"rabbitmq-cluster-nodes"},{"name":"RABBITMQ_USE_LONGNAME","value":"true"},{"name":"RABBITMQ_NODENAME","value":"rabbit@$(MY_POD_NAME).$(K8S_SERVICE_NAME).$(MY_POD_NAMESPACE)"},{"name":"K8S_HOSTNAME_SUFFIX","value":".$(K8S_SERVICE_NAME).$(MY_POD_NAMESPACE)"}],"resources":{"limits":{"cpu":"2","memory":"2Gi"},"requests":{"cpu":"1","memory":"2Gi"}},"volumeMounts":[{"name":"rabbitmq-erlang-cookie","mountPath":"/var/lib/rabbitmq/"},{"name":"persistence","mountPath":"/var/lib/rabbitmq/mnesia/"},{"name":"rabbitmq-plugins","mountPath":"/operator"},{"name":"rabbitmq-confd","mountPath":"/etc/rabbitmq/conf.d/10-operatorDefaults.conf","subPath":"operatorDefaults.conf"},{"name":"rabbitmq-confd","mountPath":"/etc/rabbitmq/conf.d/11-default_user.conf","subPath":"default_user.conf"},{"name":"rabbitmq-confd","mountPath":"/etc/rabbitmq/conf.d/90-userDefinedConfiguration.conf","subPath":"userDefinedConfiguration.conf"},{"name":"pod-info","mountPath":"/etc/pod-info/"}],"readinessProbe":{"tcpSocket":{"port":"amqp"},"initialDelaySeconds":10,"timeoutSeconds":5,"periodSeconds":10,"successThreshold":1,"failureThreshold":3},"lifecycle":{"preStop":{"exec":{"command":["/bin/bash","-c","if [ ! -z \"$(cat /etc/pod-info/skipPreStopChecks)\" ]; then exit 0; fi; rabbitmq-upgrade await_online_quorum_plus_one -t 604800; rabbitmq-upgrade await_online_synchronized_mirror -t 604800; rabbitmq-upgrade drain -t 604800"]}}},"terminationMessagePath":"/dev/termination-log","terminationMessagePolicy":"File","imagePullPolicy":"IfNotPresent"}],"restartPolicy":"Always","terminationGracePeriodSeconds":604800,"dnsPolicy":"ClusterFirst","serviceAccountName":"rabbitmq-cluster-server","serviceAccount":"rabbitmq-cluster-server","automountServiceAccountToken":true,"securityContext":{"runAsUser":999,"runAsGroup":999,"fsGroup":999},"schedulerName":"default-scheduler","topologySpreadConstraints":[{"maxSkew":1,"topologyKey":"topology.kubernetes.io/zone","whenUnsatisfiable":"ScheduleAnyway","labelSelector":{"matchLabels":{"app.kubernetes.io/name":"rabbitmq-cluster"}}}]}},"volumeClaimTemplates":[{"metadata":{"name":"persistence","namespace":"default","creationTimestamp":null,"labels":{"app.kubernetes.io/component":"rabbitmq","app.kubernetes.io/name":"rabbitmq-cluster","app.kubernetes.io/part-of":"rabbitmq"},"ownerReferences":[{"apiVersion":"rabbitmq.com/v1beta1","kind":"RabbitmqCluster","name":"rabbitmq-cluster","uid":"18d9928b-0d1c-47be-80ec-20960d053827","controller":true,"blockOwnerDeletion":false}]},"spec":{"accessModes":["ReadWriteOnce"],"resources":{"requests":{"storage":"10Gi"}},"volumeMode":"Filesystem"},"status":{"phase":"Pending"}}],"serviceName":"rabbitmq-cluster-nodes","podManagementPolicy":"Parallel","updateStrategy":{"type":"RollingUpdate","rollingUpdate":{"partition":0}},"revisionHistoryLimit":10},"status":{"observedGeneration":2,"replicas":3,"readyReplicas":1,"currentReplicas":3,"updatedReplicas":3,"currentRevision":"rabbitmq-cluster-server-5f8b8665fb","updateRevision":"rabbitmq-cluster-server-5f8b8665fb","collisionCount":0}}
2022/03/18 18:01:23 learn_server.go:291: [SIEVE-AFTER-READ]	Get	true	statefulset	default	rabbitmq-cluster-server	github.com/rabbitmq/cluster-operator/controllers.(*RabbitmqClusterReconciler)	NoError	{"kind":"StatefulSet","apiVersion":"apps/v1","metadata":{"name":"rabbitmq-cluster-server","namespace":"default","selfLink":"/apis/apps/v1/namespaces/default/statefulsets/rabbitmq-cluster-server","uid":"cb5c43bc-6ee7-481c-ab01-6f3acffdd3c8","resourceVersion":"989","generation":2,"creationTimestamp":"2022-03-18T18:00:38Z","labels":{"app.kubernetes.io/component":"rabbitmq","app.kubernetes.io/name":"rabbitmq-cluster","app.kubernetes.io/part-of":"rabbitmq"},"ownerReferences":[{"apiVersion":"rabbitmq.com/v1beta1","kind":"RabbitmqCluster","name":"rabbitmq-cluster","uid":"18d9928b-0d1c-47be-80ec-20960d053827","controller":true,"blockOwnerDeletion":true}],"managedFields":[{"manager":"kube-controller-manager","operation":"Update","apiVersion":"apps/v1","time":"2022-03-18T18:01:23Z","fieldsType":"FieldsV1","fieldsV1":{"f:status":{"f:collisionCount":{},"f:currentReplicas":{},"f:currentRevision":{},"f:observedGeneration":{},"f:readyReplicas":{},"f:replicas":{},"f:updateRevision":{},"f:updatedReplicas":{}}}},{"manager":"manager","operation":"Update","apiVersion":"apps/v1","time":"2022-03-18T18:01:23Z","fieldsType":"FieldsV1","fieldsV1":{"f:metadata":{"f:labels":{".":{},"f:app.kubernetes.io/component":{},"f:app.kubernetes.io/name":{},"f:app.kubernetes.io/part-of":{}},"f:ownerReferences":{".":{},"k:{\"uid\":\"18d9928b-0d1c-47be-80ec-20960d053827\"}":{".":{},"f:apiVersion":{},"f:blockOwnerDeletion":{},"f:controller":{},"f:kind":{},"f:name":{},"f:uid":{}}}},"f:spec":{"f:podManagementPolicy":{},"f:replicas":{},"f:revisionHistoryLimit":{},"f:selector":{"f:matchLabels":{".":{},"f:app.kubernetes.io/name":{}}},"f:serviceName":{},"f:template":{"f:metadata":{"f:annotations":{".":{},"f:prometheus.io/port":{},"f:prometheus.io/scrape":{}},"f:labels":{".":{},"f:app.kubernetes.io/component":{},"f:app.kubernetes.io/name":{},"f:app.kubernetes.io/part-of":{}}},"f:spec":{"f:automountServiceAccountToken":{},"f:containers":{"k:{\"name\":\"rabbitmq\"}":{".":{},"f:env":{".":{},"k:{\"name\":\"K8S_HOSTNAME_SUFFIX\"}":{".":{},"f:name":{},"f:value":{}},"k:{\"name\":\"K8S_SERVICE_NAME\"}":{".":{},"f:name":{},"f:value":{}},"k:{\"name\":\"MY_POD_NAME\"}":{".":{},"f:name":{},"f:valueFrom":{".":{},"f:fieldRef":{".":{},"f:apiVersion":{},"f:fieldPath":{}}}},"k:{\"name\":\"MY_POD_NAMESPACE\"}":{".":{},"f:name":{},"f:valueFrom":{".":{},"f:fieldRef":{".":{},"f:apiVersion":{},"f:fieldPath":{}}}},"k:{\"name\":\"RABBITMQ_ENABLED_PLUGINS_FILE\"}":{".":{},"f:name":{},"f:value":{}},"k:{\"name\":\"RABBITMQ_NODENAME\"}":{".":{},"f:name":{},"f:value":{}},"k:{\"name\":\"RABBITMQ_USE_LONGNAME\"}":{".":{},"f:name":{},"f:value":{}}},"f:image":{},"f:imagePullPolicy":{},"f:lifecycle":{".":{},"f:preStop":{".":{},"f:exec":{".":{},"f:command":{}}}},"f:name":{},"f:ports":{".":{},"k:{\"containerPort\":4369,\"protocol\":\"TCP\"}":{".":{},"f:containerPort":{},"f:name":{},"f:protocol":{}},"k:{\"containerPort\":5672,\"protocol\":\"TCP\"}":{".":{},"f:containerPort":{},"f:name":{},"f:protocol":{}},"k:{\"containerPort\":15672,\"protocol\":\"TCP\"}":{".":{},"f:containerPort":{},"f:name":{},"f:protocol":{}},"k:{\"containerPort\":15692,\"protocol\":\"TCP\"}":{".":{},"f:containerPort":{},"f:name":{},"f:protocol":{}}},"f:readinessProbe":{".":{},"f:failureThreshold":{},"f:initialDelaySeconds":{},"f:periodSeconds":{},"f:successThreshold":{},"f:tcpSocket":{".":{},"f:port":{}},"f:timeoutSeconds":{}},"f:resources":{".":{},"f:limits":{".":{},"f:cpu":{},"f:memory":{}},"f:requests":{".":{},"f:cpu":{},"f:memory":{}}},"f:terminationMessagePath":{},"f:terminationMessagePolicy":{},"f:volumeMounts":{".":{},"k:{\"mountPath\":\"/etc/pod-info/\"}":{".":{},"f:mountPath":{},"f:name":{}},"k:{\"mountPath\":\"/etc/rabbitmq/conf.d/10-operatorDefaults.conf\"}":{".":{},"f:mountPath":{},"f:name":{},"f:subPath":{}},"k:{\"mountPath\":\"/etc/rabbitmq/conf.d/11-default_user.conf\"}":{".":{},"f:mountPath":{},"f:name":{},"f:subPath":{}},"k:{\"mountPath\":\"/etc/rabbitmq/conf.d/90-userDefinedConfiguration.conf\"}":{".":{},"f:mountPath":{},"f:name":{},"f:subPath":{}},"k:{\"mountPath\":\"/operator\"}":{".":{},"f:mountPath":{},"f:name":{}},"k:{\"mountPath\":\"/var/lib/rabbitmq/\"}":{".":{},"f:mountPath":{},"f:name":{}},"k:{\"mountPath\":\"/var/lib/rabbitmq/mnesia/\"}":{".":{},"f:mountPath":{},"f:name":{}}}}},"f:dnsPolicy":{},"f:initContainers":{".":{},"k:{\"name\":\"setup-container\"}":{".":{},"f:command":{},"f:image":{},"f:imagePullPolicy":{},"f:name":{},"f:resources":{".":{},"f:limits":{".":{},"f:cpu":{},"f:memory":{}},"f:requests":{".":{},"f:cpu":{},"f:memory":{}}},"f:securityContext":{".":{},"f:capabilities":{".":{},"f:drop":{}},"f:runAsUser":{}},"f:terminationMessagePath":{},"f:terminationMessagePolicy":{},"f:volumeMounts":{".":{},"k:{\"mountPath\":\"/operator\"}":{".":{},"f:mountPath":{},"f:name":{}},"k:{\"mountPath\":\"/tmp/default_user.conf\"}":{".":{},"f:mountPath":{},"f:name":{},"f:subPath":{}},"k:{\"mountPath\":\"/tmp/erlang-cookie-secret/\"}":{".":{},"f:mountPath":{},"f:name":{}},"k:{\"mountPath\":\"/tmp/rabbitmq-plugins/\"}":{".":{},"f:mountPath":{},"f:name":{}},"k:{\"mountPath\":\"/var/lib/rabbitmq/\"}":{".":{},"f:mountPath":{},"f:name":{}},"k:{\"mountPath\":\"/var/lib/rabbitmq/mnesia/\"}":{".":{},"f:mountPath":{},"f:name":{}}}}},"f:restartPolicy":{},"f:schedulerName":{},"f:securityContext":{".":{},"f:fsGroup":{},"f:runAsGroup":{},"f:runAsUser":{}},"f:serviceAccount":{},"f:serviceAccountName":{},"f:terminationGracePeriodSeconds":{},"f:topologySpreadConstraints":{".":{},"k:{\"topologyKey\":\"topology.kubernetes.io/zone\",\"whenUnsatisfiable\":\"ScheduleAnyway\"}":{".":{},"f:labelSelector":{".":{},"f:matchLabels":{".":{},"f:app.kubernetes.io/name":{}}},"f:maxSkew":{},"f:topologyKey":{},"f:whenUnsatisfiable":{}}},"f:volumes":{".":{},"k:{\"name\":\"erlang-cookie-secret\"}":{".":{},"f:name":{},"f:secret":{".":{},"f:defaultMode":{},"f:secretName":{}}},"k:{\"name\":\"plugins-conf\"}":{".":{},"f:configMap":{".":{},"f:defaultMode":{},"f:name":{}},"f:name":{}},"k:{\"name\":\"pod-info\"}":{".":{},"f:downwardAPI":{".":{},"f:defaultMode":{},"f:items":{}},"f:name":{}},"k:{\"name\":\"rabbitmq-confd\"}":{".":{},"f:name":{},"f:projected":{".":{},"f:defaultMode":{},"f:sources":{}}},"k:{\"name\":\"rabbitmq-erlang-cookie\"}":{".":{},"f:emptyDir":{},"f:name":{}},"k:{\"name\":\"rabbitmq-plugins\"}":{".":{},"f:emptyDir":{},"f:name":{}}}}},"f:updateStrategy":{"f:rollingUpdate":{".":{},"f:partition":{}},"f:type":{}},"f:volumeClaimTemplates":{}}}}]},"spec":{"replicas":3,"selector":{"matchLabels":{"app.kubernetes.io/name":"rabbitmq-cluster"}},"template":{"metadata":{"creationTimestamp":null,"labels":{"app.kubernetes.io/component":"rabbitmq","app.kubernetes.io/name":"rabbitmq-cluster","app.kubernetes.io/part-of":"rabbitmq"},"annotations":{"prometheus.io/port":"15692","prometheus.io/scrape":"true"}},"spec":{"volumes":[{"name":"plugins-conf","configMap":{"name":"rabbitmq-cluster-plugins-conf","defaultMode":420}},{"name":"rabbitmq-confd","projected":{"sources":[{"secret":{"name":"rabbitmq-cluster-default-user","items":[{"key":"default_user.conf","path":"default_user.conf"}]}},{"configMap":{"name":"rabbitmq-cluster-server-conf","items":[{"key":"operatorDefaults.conf","path":"operatorDefaults.conf"},{"key":"userDefinedConfiguration.conf","path":"userDefinedConfiguration.conf"}]}}],"defaultMode":420}},{"name":"rabbitmq-erlang-cookie","emptyDir":{}},{"name":"erlang-cookie-secret","secret":{"secretName":"rabbitmq-cluster-erlang-cookie","defaultMode":420}},{"name":"rabbitmq-plugins","emptyDir":{}},{"name":"pod-info","downwardAPI":{"items":[{"path":"skipPreStopChecks","fieldRef":{"apiVersion":"v1","fieldPath":"metadata.labels['skipPreStopChecks']"}}],"defaultMode":420}}],"initContainers":[{"name":"setup-container","image":"rabbitmq:3.8.12-management","command":["sh","-c","cp /tmp/erlang-cookie-secret/.erlang.cookie /var/lib/rabbitmq/.erlang.cookie \u0026\u0026 chown 999:999 /var/lib/rabbitmq/.erlang.cookie \u0026\u0026 chmod 600 /var/lib/rabbitmq/.erlang.cookie ; cp /tmp/rabbitmq-plugins/enabled_plugins /operator/enabled_plugins \u0026\u0026 chown 999:999 /operator/enabled_plugins ; chown 999:999 /var/lib/rabbitmq/mnesia/ ; echo '[default]' \u003e /var/lib/rabbitmq/.rabbitmqadmin.conf \u0026\u0026 sed -e 's/default_user/username/' -e 's/default_pass/password/' /tmp/default_user.conf \u003e\u003e /var/lib/rabbitmq/.rabbitmqadmin.conf \u0026\u0026 chown 999:999 /var/lib/rabbitmq/.rabbitmqadmin.conf \u0026\u0026 chmod 600 /var/lib/rabbitmq/.rabbitmqadmin.conf"],"resources":{"limits":{"cpu":"100m","memory":"500Mi"},"requests":{"cpu":"100m","memory":"500Mi"}},"volumeMounts":[{"name":"plugins-conf","mountPath":"/tmp/rabbitmq-plugins/"},{"name":"rabbitmq-erlang-cookie","mountPath":"/var/lib/rabbitmq/"},{"name":"erlang-cookie-secret","mountPath":"/tmp/erlang-cookie-secret/"},{"name":"rabbitmq-plugins","mountPath":"/operator"},{"name":"persistence","mountPath":"/var/lib/rabbitmq/mnesia/"},{"name":"rabbitmq-confd","mountPath":"/tmp/default_user.conf","subPath":"default_user.conf"}],"terminationMessagePath":"/dev/termination-log","terminationMessagePolicy":"File","imagePullPolicy":"IfNotPresent","securityContext":{"capabilities":{"drop":["FSETID","KILL","SETGID","SETUID","SETPCAP","NET_BIND_SERVICE","NET_RAW","SYS_CHROOT","MKNOD","AUDIT_WRITE","SETFCAP"]},"runAsUser":0}}],"containers":[{"name":"rabbitmq","image":"rabbitmq:3.8.12-management","ports":[{"name":"epmd","containerPort":4369,"protocol":"TCP"},{"name":"amqp","containerPort":5672,"protocol":"TCP"},{"name":"management","containerPort":15672,"protocol":"TCP"},{"name":"prometheus","containerPort":15692,"protocol":"TCP"}],"env":[{"name":"MY_POD_NAME","valueFrom":{"fieldRef":{"apiVersion":"v1","fieldPath":"metadata.name"}}},{"name":"MY_POD_NAMESPACE","valueFrom":{"fieldRef":{"apiVersion":"v1","fieldPath":"metadata.namespace"}}},{"name":"RABBITMQ_ENABLED_PLUGINS_FILE","value":"/operator/enabled_plugins"},{"name":"K8S_SERVICE_NAME","value":"rabbitmq-cluster-nodes"},{"name":"RABBITMQ_USE_LONGNAME","value":"true"},{"name":"RABBITMQ_NODENAME","value":"rabbit@$(MY_POD_NAME).$(K8S_SERVICE_NAME).$(MY_POD_NAMESPACE)"},{"name":"K8S_HOSTNAME_SUFFIX","value":".$(K8S_SERVICE_NAME).$(MY_POD_NAMESPACE)"}],"resources":{"limits":{"cpu":"2","memory":"2Gi"},"requests":{"cpu":"1","memory":"2Gi"}},"volumeMounts":[{"name":"rabbitmq-erlang-cookie","mountPath":"/var/lib/rabbitmq/"},{"name":"persistence","mountPath":"/var/lib/rabbitmq/mnesia/"},{"name":"rabbitmq-plugins","mountPath":"/operator"},{"name":"rabbitmq-confd","mountPath":"/etc/rabbitmq/conf.d/10-operatorDefaults.conf","subPath":"operatorDefaults.conf"},{"name":"rabbitmq-confd","mountPath":"/etc/rabbitmq/conf.d/11-default_user.conf","subPath":"default_user.conf"},{"name":"rabbitmq-confd","mountPath":"/etc/rabbitmq/conf.d/90-userDefinedConfiguration.conf","subPath":"userDefinedConfiguration.conf"},{"name":"pod-info","mountPath":"/etc/pod-info/"}],"readinessProbe":{"tcpSocket":{"port":"amqp"},"initialDelaySeconds":10,"timeoutSeconds":5,"periodSeconds":10,"successThreshold":1,"failureThreshold":3},"lifecycle":{"preStop":{"exec":{"command":["/bin/bash","-c","if [ ! -z \"$(cat /etc/pod-info/skipPreStopChecks)\" ]; then exit 0; fi; rabbitmq-upgrade await_online_quorum_plus_one -t 604800; rabbitmq-upgrade await_online_synchronized_mirror -t 604800; rabbitmq-upgrade drain -t 604800"]}}},"terminationMessagePath":"/dev/termination-log","terminationMessagePolicy":"File","imagePullPolicy":"IfNotPresent"}],"restartPolicy":"Always","terminationGracePeriodSeconds":604800,"dnsPolicy":"ClusterFirst","serviceAccountName":"rabbitmq-cluster-server","serviceAccount":"rabbitmq-cluster-server","automountServiceAccountToken":true,"securityContext":{"runAsUser":999,"runAsGroup":999,"fsGroup":999},"schedulerName":"default-scheduler","topologySpreadConstraints":[{"maxSkew":1,"topologyKey":"topology.kubernetes.io/zone","whenUnsatisfiable":"ScheduleAnyway","labelSelector":{"matchLabels":{"app.kubernetes.io/name":"rabbitmq-cluster"}}}]}},"volumeClaimTemplates":[{"metadata":{"name":"persistence","namespace":"default","creationTimestamp":null,"labels":{"app.kubernetes.io/component":"rabbitmq","app.kubernetes.io/name":"rabbitmq-cluster","app.kubernetes.io/part-of":"rabbitmq"},"ownerReferences":[{"apiVersion":"rabbitmq.com/v1beta1","kind":"RabbitmqCluster","name":"rabbitmq-cluster","uid":"18d9928b-0d1c-47be-80ec-20960d053827","controller":true,"blockOwnerDeletion":false}]},"spec":{"accessModes":["ReadWriteOnce"],"resources":{"requests":{"storage":"10Gi"}},"volumeMode":"Filesystem"},"status":{"phase":"Pending"}}],"serviceName":"rabbitmq-cluster-nodes","podManagementPolicy":"Parallel","updateStrategy":{"type":"RollingUpdate","rollingUpdate":{"partition":0}},"revisionHistoryLimit":10},"status":{"observedGeneration":2,"replicas":3,"readyReplicas":1,"currentReplicas":3,"updatedReplicas":3,"currentRevision":"rabbitmq-cluster-server-5f8b8665fb","updateRevision":"rabbitmq-cluster-server-5f8b8665fb","collisionCount":0}}
2022/03/18 18:01:23 learn_server.go:256: [SIEVE-BEFORE-WRITE]	41
2022/03/18 18:01:23 learn_server.go:263: [SIEVE-AFTER-WRITE]	41	Update	statefulset	github.com/rabbitmq/cluster-operator/controllers.(*RabbitmqClusterReconciler)	NoError	{"metadata":{"name":"rabbitmq-cluster-server","namespace":"default","selfLink":"/apis/apps/v1/namespaces/default/statefulsets/rabbitmq-cluster-server","uid":"cb5c43bc-6ee7-481c-ab01-6f3acffdd3c8","resourceVersion":"989","generation":2,"creationTimestamp":"2022-03-18T18:00:38Z","labels":{"app.kubernetes.io/component":"rabbitmq","app.kubernetes.io/name":"rabbitmq-cluster","app.kubernetes.io/part-of":"rabbitmq"},"ownerReferences":[{"apiVersion":"rabbitmq.com/v1beta1","kind":"RabbitmqCluster","name":"rabbitmq-cluster","uid":"18d9928b-0d1c-47be-80ec-20960d053827","controller":true,"blockOwnerDeletion":true}],"managedFields":[{"manager":"kube-controller-manager","operation":"Update","apiVersion":"apps/v1","time":"2022-03-18T18:01:23Z","fieldsType":"FieldsV1","fieldsV1":{"f:status":{"f:collisionCount":{},"f:currentReplicas":{},"f:currentRevision":{},"f:observedGeneration":{},"f:readyReplicas":{},"f:replicas":{},"f:updateRevision":{},"f:updatedReplicas":{}}}},{"manager":"manager","operation":"Update","apiVersion":"apps/v1","time":"2022-03-18T18:01:23Z","fieldsType":"FieldsV1","fieldsV1":{"f:metadata":{"f:labels":{".":{},"f:app.kubernetes.io/component":{},"f:app.kubernetes.io/name":{},"f:app.kubernetes.io/part-of":{}},"f:ownerReferences":{".":{},"k:{\"uid\":\"18d9928b-0d1c-47be-80ec-20960d053827\"}":{".":{},"f:apiVersion":{},"f:blockOwnerDeletion":{},"f:controller":{},"f:kind":{},"f:name":{},"f:uid":{}}}},"f:spec":{"f:podManagementPolicy":{},"f:replicas":{},"f:revisionHistoryLimit":{},"f:selector":{"f:matchLabels":{".":{},"f:app.kubernetes.io/name":{}}},"f:serviceName":{},"f:template":{"f:metadata":{"f:annotations":{".":{},"f:prometheus.io/port":{},"f:prometheus.io/scrape":{}},"f:labels":{".":{},"f:app.kubernetes.io/component":{},"f:app.kubernetes.io/name":{},"f:app.kubernetes.io/part-of":{}}},"f:spec":{"f:automountServiceAccountToken":{},"f:containers":{"k:{\"name\":\"rabbitmq\"}":{".":{},"f:env":{".":{},"k:{\"name\":\"K8S_HOSTNAME_SUFFIX\"}":{".":{},"f:name":{},"f:value":{}},"k:{\"name\":\"K8S_SERVICE_NAME\"}":{".":{},"f:name":{},"f:value":{}},"k:{\"name\":\"MY_POD_NAME\"}":{".":{},"f:name":{},"f:valueFrom":{".":{},"f:fieldRef":{".":{},"f:apiVersion":{},"f:fieldPath":{}}}},"k:{\"name\":\"MY_POD_NAMESPACE\"}":{".":{},"f:name":{},"f:valueFrom":{".":{},"f:fieldRef":{".":{},"f:apiVersion":{},"f:fieldPath":{}}}},"k:{\"name\":\"RABBITMQ_ENABLED_PLUGINS_FILE\"}":{".":{},"f:name":{},"f:value":{}},"k:{\"name\":\"RABBITMQ_NODENAME\"}":{".":{},"f:name":{},"f:value":{}},"k:{\"name\":\"RABBITMQ_USE_LONGNAME\"}":{".":{},"f:name":{},"f:value":{}}},"f:image":{},"f:imagePullPolicy":{},"f:lifecycle":{".":{},"f:preStop":{".":{},"f:exec":{".":{},"f:command":{}}}},"f:name":{},"f:ports":{".":{},"k:{\"containerPort\":4369,\"protocol\":\"TCP\"}":{".":{},"f:containerPort":{},"f:name":{},"f:protocol":{}},"k:{\"containerPort\":5672,\"protocol\":\"TCP\"}":{".":{},"f:containerPort":{},"f:name":{},"f:protocol":{}},"k:{\"containerPort\":15672,\"protocol\":\"TCP\"}":{".":{},"f:containerPort":{},"f:name":{},"f:protocol":{}},"k:{\"containerPort\":15692,\"protocol\":\"TCP\"}":{".":{},"f:containerPort":{},"f:name":{},"f:protocol":{}}},"f:readinessProbe":{".":{},"f:failureThreshold":{},"f:initialDelaySeconds":{},"f:periodSeconds":{},"f:successThreshold":{},"f:tcpSocket":{".":{},"f:port":{}},"f:timeoutSeconds":{}},"f:resources":{".":{},"f:limits":{".":{},"f:cpu":{},"f:memory":{}},"f:requests":{".":{},"f:cpu":{},"f:memory":{}}},"f:terminationMessagePath":{},"f:terminationMessagePolicy":{},"f:volumeMounts":{".":{},"k:{\"mountPath\":\"/etc/pod-info/\"}":{".":{},"f:mountPath":{},"f:name":{}},"k:{\"mountPath\":\"/etc/rabbitmq/conf.d/10-operatorDefaults.conf\"}":{".":{},"f:mountPath":{},"f:name":{},"f:subPath":{}},"k:{\"mountPath\":\"/etc/rabbitmq/conf.d/11-default_user.conf\"}":{".":{},"f:mountPath":{},"f:name":{},"f:subPath":{}},"k:{\"mountPath\":\"/etc/rabbitmq/conf.d/90-userDefinedConfiguration.conf\"}":{".":{},"f:mountPath":{},"f:name":{},"f:subPath":{}},"k:{\"mountPath\":\"/operator\"}":{".":{},"f:mountPath":{},"f:name":{}},"k:{\"mountPath\":\"/var/lib/rabbitmq/\"}":{".":{},"f:mountPath":{},"f:name":{}},"k:{\"mountPath\":\"/var/lib/rabbitmq/mnesia/\"}":{".":{},"f:mountPath":{},"f:name":{}}}}},"f:dnsPolicy":{},"f:initContainers":{".":{},"k:{\"name\":\"setup-container\"}":{".":{},"f:command":{},"f:image":{},"f:imagePullPolicy":{},"f:name":{},"f:resources":{".":{},"f:limits":{".":{},"f:cpu":{},"f:memory":{}},"f:requests":{".":{},"f:cpu":{},"f:memory":{}}},"f:securityContext":{".":{},"f:capabilities":{".":{},"f:drop":{}},"f:runAsUser":{}},"f:terminationMessagePath":{},"f:terminationMessagePolicy":{},"f:volumeMounts":{".":{},"k:{\"mountPath\":\"/operator\"}":{".":{},"f:mountPath":{},"f:name":{}},"k:{\"mountPath\":\"/tmp/default_user.conf\"}":{".":{},"f:mountPath":{},"f:name":{},"f:subPath":{}},"k:{\"mountPath\":\"/tmp/erlang-cookie-secret/\"}":{".":{},"f:mountPath":{},"f:name":{}},"k:{\"mountPath\":\"/tmp/rabbitmq-plugins/\"}":{".":{},"f:mountPath":{},"f:name":{}},"k:{\"mountPath\":\"/var/lib/rabbitmq/\"}":{".":{},"f:mountPath":{},"f:name":{}},"k:{\"mountPath\":\"/var/lib/rabbitmq/mnesia/\"}":{".":{},"f:mountPath":{},"f:name":{}}}}},"f:restartPolicy":{},"f:schedulerName":{},"f:securityContext":{".":{},"f:fsGroup":{},"f:runAsGroup":{},"f:runAsUser":{}},"f:serviceAccount":{},"f:serviceAccountName":{},"f:terminationGracePeriodSeconds":{},"f:topologySpreadConstraints":{".":{},"k:{\"topologyKey\":\"topology.kubernetes.io/zone\",\"whenUnsatisfiable\":\"ScheduleAnyway\"}":{".":{},"f:labelSelector":{".":{},"f:matchLabels":{".":{},"f:app.kubernetes.io/name":{}}},"f:maxSkew":{},"f:topologyKey":{},"f:whenUnsatisfiable":{}}},"f:volumes":{".":{},"k:{\"name\":\"erlang-cookie-secret\"}":{".":{},"f:name":{},"f:secret":{".":{},"f:defaultMode":{},"f:secretName":{}}},"k:{\"name\":\"plugins-conf\"}":{".":{},"f:configMap":{".":{},"f:defaultMode":{},"f:name":{}},"f:name":{}},"k:{\"name\":\"pod-info\"}":{".":{},"f:downwardAPI":{".":{},"f:defaultMode":{},"f:items":{}},"f:name":{}},"k:{\"name\":\"rabbitmq-confd\"}":{".":{},"f:name":{},"f:projected":{".":{},"f:defaultMode":{},"f:sources":{}}},"k:{\"name\":\"rabbitmq-erlang-cookie\"}":{".":{},"f:emptyDir":{},"f:name":{}},"k:{\"name\":\"rabbitmq-plugins\"}":{".":{},"f:emptyDir":{},"f:name":{}}}}},"f:updateStrategy":{"f:rollingUpdate":{".":{},"f:partition":{}},"f:type":{}},"f:volumeClaimTemplates":{}}}}]},"spec":{"replicas":3,"selector":{"matchLabels":{"app.kubernetes.io/name":"rabbitmq-cluster"}},"template":{"metadata":{"creationTimestamp":null,"labels":{"app.kubernetes.io/component":"rabbitmq","app.kubernetes.io/name":"rabbitmq-cluster","app.kubernetes.io/part-of":"rabbitmq"},"annotations":{"prometheus.io/port":"15692","prometheus.io/scrape":"true"}},"spec":{"volumes":[{"name":"plugins-conf","configMap":{"name":"rabbitmq-cluster-plugins-conf","defaultMode":420}},{"name":"rabbitmq-confd","projected":{"sources":[{"secret":{"name":"rabbitmq-cluster-default-user","items":[{"key":"default_user.conf","path":"default_user.conf"}]}},{"configMap":{"name":"rabbitmq-cluster-server-conf","items":[{"key":"operatorDefaults.conf","path":"operatorDefaults.conf"},{"key":"userDefinedConfiguration.conf","path":"userDefinedConfiguration.conf"}]}}],"defaultMode":420}},{"name":"rabbitmq-erlang-cookie","emptyDir":{}},{"name":"erlang-cookie-secret","secret":{"secretName":"rabbitmq-cluster-erlang-cookie","defaultMode":420}},{"name":"rabbitmq-plugins","emptyDir":{}},{"name":"pod-info","downwardAPI":{"items":[{"path":"skipPreStopChecks","fieldRef":{"apiVersion":"v1","fieldPath":"metadata.labels['skipPreStopChecks']"}}],"defaultMode":420}}],"initContainers":[{"name":"setup-container","image":"rabbitmq:3.8.12-management","command":["sh","-c","cp /tmp/erlang-cookie-secret/.erlang.cookie /var/lib/rabbitmq/.erlang.cookie \u0026\u0026 chown 999:999 /var/lib/rabbitmq/.erlang.cookie \u0026\u0026 chmod 600 /var/lib/rabbitmq/.erlang.cookie ; cp /tmp/rabbitmq-plugins/enabled_plugins /operator/enabled_plugins \u0026\u0026 chown 999:999 /operator/enabled_plugins ; chown 999:999 /var/lib/rabbitmq/mnesia/ ; echo '[default]' \u003e /var/lib/rabbitmq/.rabbitmqadmin.conf \u0026\u0026 sed -e 's/default_user/username/' -e 's/default_pass/password/' /tmp/default_user.conf \u003e\u003e /var/lib/rabbitmq/.rabbitmqadmin.conf \u0026\u0026 chown 999:999 /var/lib/rabbitmq/.rabbitmqadmin.conf \u0026\u0026 chmod 600 /var/lib/rabbitmq/.rabbitmqadmin.conf"],"resources":{"limits":{"cpu":"100m","memory":"500Mi"},"requests":{"cpu":"100m","memory":"500Mi"}},"volumeMounts":[{"name":"plugins-conf","mountPath":"/tmp/rabbitmq-plugins/"},{"name":"rabbitmq-erlang-cookie","mountPath":"/var/lib/rabbitmq/"},{"name":"erlang-cookie-secret","mountPath":"/tmp/erlang-cookie-secret/"},{"name":"rabbitmq-plugins","mountPath":"/operator"},{"name":"persistence","mountPath":"/var/lib/rabbitmq/mnesia/"},{"name":"rabbitmq-confd","mountPath":"/tmp/default_user.conf","subPath":"default_user.conf"}],"terminationMessagePath":"/dev/termination-log","terminationMessagePolicy":"File","imagePullPolicy":"IfNotPresent","securityContext":{"capabilities":{"drop":["FSETID","KILL","SETGID","SETUID","SETPCAP","NET_BIND_SERVICE","NET_RAW","SYS_CHROOT","MKNOD","AUDIT_WRITE","SETFCAP"]},"runAsUser":0}}],"containers":[{"name":"rabbitmq","image":"rabbitmq:3.8.12-management","ports":[{"name":"epmd","containerPort":4369,"protocol":"TCP"},{"name":"amqp","containerPort":5672,"protocol":"TCP"},{"name":"management","containerPort":15672,"protocol":"TCP"},{"name":"prometheus","containerPort":15692,"protocol":"TCP"}],"env":[{"name":"MY_POD_NAME","valueFrom":{"fieldRef":{"apiVersion":"v1","fieldPath":"metadata.name"}}},{"name":"MY_POD_NAMESPACE","valueFrom":{"fieldRef":{"apiVersion":"v1","fieldPath":"metadata.namespace"}}},{"name":"RABBITMQ_ENABLED_PLUGINS_FILE","value":"/operator/enabled_plugins"},{"name":"K8S_SERVICE_NAME","value":"rabbitmq-cluster-nodes"},{"name":"RABBITMQ_USE_LONGNAME","value":"true"},{"name":"RABBITMQ_NODENAME","value":"rabbit@$(MY_POD_NAME).$(K8S_SERVICE_NAME).$(MY_POD_NAMESPACE)"},{"name":"K8S_HOSTNAME_SUFFIX","value":".$(K8S_SERVICE_NAME).$(MY_POD_NAMESPACE)"}],"resources":{"limits":{"cpu":"2","memory":"2Gi"},"requests":{"cpu":"1","memory":"2Gi"}},"volumeMounts":[{"name":"rabbitmq-erlang-cookie","mountPath":"/var/lib/rabbitmq/"},{"name":"persistence","mountPath":"/var/lib/rabbitmq/mnesia/"},{"name":"rabbitmq-plugins","mountPath":"/operator"},{"name":"rabbitmq-confd","mountPath":"/etc/rabbitmq/conf.d/10-operatorDefaults.conf","subPath":"operatorDefaults.conf"},{"name":"rabbitmq-confd","mountPath":"/etc/rabbitmq/conf.d/11-default_user.conf","subPath":"default_user.conf"},{"name":"rabbitmq-confd","mountPath":"/etc/rabbitmq/conf.d/90-userDefinedConfiguration.conf","subPath":"userDefinedConfiguration.conf"},{"name":"pod-info","mountPath":"/etc/pod-info/"}],"readinessProbe":{"tcpSocket":{"port":"amqp"},"initialDelaySeconds":10,"timeoutSeconds":5,"periodSeconds":10,"successThreshold":1,"failureThreshold":3},"lifecycle":{"preStop":{"exec":{"command":["/bin/bash","-c","if [ ! -z \"$(cat /etc/pod-info/skipPreStopChecks)\" ]; then exit 0; fi; rabbitmq-upgrade await_online_quorum_plus_one -t 604800; rabbitmq-upgrade await_online_synchronized_mirror -t 604800; rabbitmq-upgrade drain -t 604800"]}}},"terminationMessagePath":"/dev/termination-log","terminationMessagePolicy":"File","imagePullPolicy":"IfNotPresent"}],"restartPolicy":"Always","terminationGracePeriodSeconds":604800,"dnsPolicy":"ClusterFirst","serviceAccountName":"rabbitmq-cluster-server","serviceAccount":"rabbitmq-cluster-server","automountServiceAccountToken":true,"securityContext":{"runAsUser":999,"runAsGroup":999,"fsGroup":999},"schedulerName":"default-scheduler","topologySpreadConstraints":[{"maxSkew":1,"topologyKey":"topology.kubernetes.io/zone","whenUnsatisfiable":"ScheduleAnyway","labelSelector":{"matchLabels":{"app.kubernetes.io/name":"rabbitmq-cluster"}}}]}},"volumeClaimTemplates":[{"metadata":{"name":"persistence","namespace":"default","creationTimestamp":null,"labels":{"app.kubernetes.io/component":"rabbitmq","app.kubernetes.io/name":"rabbitmq-cluster","app.kubernetes.io/part-of":"rabbitmq"},"ownerReferences":[{"apiVersion":"rabbitmq.com/v1beta1","kind":"RabbitmqCluster","name":"rabbitmq-cluster","uid":"18d9928b-0d1c-47be-80ec-20960d053827","controller":true,"blockOwnerDeletion":false}]},"spec":{"accessModes":["ReadWriteOnce"],"resources":{"requests":{"storage":"10Gi"}},"volumeMode":"Filesystem"},"status":{"phase":"Pending"}}],"serviceName":"rabbitmq-cluster-nodes","podManagementPolicy":"Parallel","updateStrategy":{"type":"RollingUpdate","rollingUpdate":{"partition":0}},"revisionHistoryLimit":10},"status":{"observedGeneration":2,"replicas":3,"readyReplicas":1,"currentReplicas":3,"updatedReplicas":3,"currentRevision":"rabbitmq-cluster-server-5f8b8665fb","updateRevision":"rabbitmq-cluster-server-5f8b8665fb","collisionCount":0}}
2022/03/18 18:01:23 learn_server.go:291: [SIEVE-AFTER-READ]	Get	true	configmap	default	rabbitmq-cluster-server-conf	github.com/rabbitmq/cluster-operator/controllers.(*RabbitmqClusterReconciler)	NoError	{"kind":"ConfigMap","apiVersion":"v1","metadata":{"name":"rabbitmq-cluster-server-conf","namespace":"default","selfLink":"/api/v1/namespaces/default/configmaps/rabbitmq-cluster-server-conf","uid":"22474f2b-8454-44b7-8079-8990223969cc","resourceVersion":"714","creationTimestamp":"2022-03-18T18:00:38Z","labels":{"app.kubernetes.io/component":"rabbitmq","app.kubernetes.io/name":"rabbitmq-cluster","app.kubernetes.io/part-of":"rabbitmq"},"ownerReferences":[{"apiVersion":"rabbitmq.com/v1beta1","kind":"RabbitmqCluster","name":"rabbitmq-cluster","uid":"18d9928b-0d1c-47be-80ec-20960d053827","controller":true,"blockOwnerDeletion":true}],"managedFields":[{"manager":"manager","operation":"Update","apiVersion":"v1","time":"2022-03-18T18:00:38Z","fieldsType":"FieldsV1","fieldsV1":{"f:data":{".":{},"f:operatorDefaults.conf":{},"f:userDefinedConfiguration.conf":{}},"f:metadata":{"f:labels":{".":{},"f:app.kubernetes.io/component":{},"f:app.kubernetes.io/name":{},"f:app.kubernetes.io/part-of":{}},"f:ownerReferences":{".":{},"k:{\"uid\":\"18d9928b-0d1c-47be-80ec-20960d053827\"}":{".":{},"f:apiVersion":{},"f:blockOwnerDeletion":{},"f:controller":{},"f:kind":{},"f:name":{},"f:uid":{}}}}}}]},"data":{"operatorDefaults.conf":"cluster_formation.peer_discovery_backend             = rabbit_peer_discovery_k8s\ncluster_formation.k8s.host                           = kubernetes.default\ncluster_formation.k8s.address_type                   = hostname\ncluster_partition_handling                           = pause_minority\nqueue_master_locator                                 = min-masters\ndisk_free_limit.absolute                             = 2GB\ncluster_formation.randomized_startup_delay_range.min = 5\ncluster_formation.randomized_startup_delay_range.max = 30\ncluster_name                                         = rabbitmq-cluster\n","userDefinedConfiguration.conf":"total_memory_available_override_value = 1717986919\n"}}
2022/03/18 18:01:23 learn_server.go:256: [SIEVE-BEFORE-WRITE]	42
2022/03/18 18:01:23 learn_server.go:263: [SIEVE-AFTER-WRITE]	42	StatusUpdate	rabbitmqcluster	github.com/rabbitmq/cluster-operator/controllers.(*RabbitmqClusterReconciler)	NoError	{"metadata":{"name":"rabbitmq-cluster","namespace":"default","selfLink":"/apis/rabbitmq.com/v1beta1/namespaces/default/rabbitmqclusters/rabbitmq-cluster/status","uid":"18d9928b-0d1c-47be-80ec-20960d053827","resourceVersion":"977","generation":3,"creationTimestamp":"2022-03-18T18:00:38Z","annotations":{"kubectl.kubernetes.io/last-applied-configuration":"{\"apiVersion\":\"rabbitmq.com/v1beta1\",\"kind\":\"RabbitmqCluster\",\"metadata\":{\"annotations\":{},\"name\":\"rabbitmq-cluster\",\"namespace\":\"default\"},\"spec\":{\"persistence\":{\"storage\":\"10Gi\"},\"replicas\":1}}\n"},"finalizers":["deletion.finalizers.rabbitmqclusters.rabbitmq.com"],"managedFields":[{"manager":"kubectl-client-side-apply","operation":"Update","apiVersion":"rabbitmq.com/v1beta1","time":"2022-03-18T18:00:38Z","fieldsType":"FieldsV1","fieldsV1":{"f:metadata":{"f:annotations":{".":{},"f:kubectl.kubernetes.io/last-applied-configuration":{}}},"f:spec":{".":{},"f:image":{},"f:persistence":{".":{},"f:storage":{}},"f:resources":{".":{},"f:limits":{".":{},"f:memory":{}},"f:requests":{".":{},"f:memory":{}}},"f:service":{".":{},"f:type":{}},"f:terminationGracePeriodSeconds":{}}}},{"manager":"kubectl-patch","operation":"Update","apiVersion":"rabbitmq.com/v1beta1","time":"2022-03-18T18:01:23Z","fieldsType":"FieldsV1","fieldsV1":{"f:spec":{"f:replicas":{}}}},{"manager":"manager","operation":"Update","apiVersion":"rabbitmq.com/v1beta1","time":"2022-03-18T18:01:23Z","fieldsType":"FieldsV1","fieldsV1":{"f:metadata":{"f:finalizers":{}},"f:spec":{"f:override":{},"f:rabbitmq":{},"f:resources":{"f:limits":{"f:cpu":{}},"f:requests":{"f:cpu":{}}},"f:tls":{}},"f:status":{".":{},"f:conditions":{},"f:defaultUser":{".":{},"f:secretReference":{".":{},"f:keys":{".":{},"f:password":{},"f:username":{}},"f:name":{},"f:namespace":{}},"f:serviceReference":{".":{},"f:name":{},"f:namespace":{}}}}}}]},"spec":{"replicas":3,"image":"rabbitmq:3.8.12-management","service":{"type":"ClusterIP"},"persistence":{"storage":"10Gi"},"resources":{"limits":{"cpu":"2","memory":"2Gi"},"requests":{"cpu":"1","memory":"2Gi"}},"rabbitmq":{},"tls":{},"override":{},"terminationGracePeriodSeconds":604800},"status":{"conditions":[{"type":"AllReplicasReady","status":"False","lastTransitionTime":"2022-03-18T18:01:23Z","reason":"NotAllPodsReady","message":"1/3 Pods ready"},{"type":"ClusterAvailable","status":"True","lastTransitionTime":"2022-03-18T18:01:17Z","reason":"AtLeastOneEndpointAvailable"},{"type":"NoWarnings","status":"True","lastTransitionTime":"2022-03-18T18:00:38Z","reason":"NoWarnings"},{"type":"ReconcileSuccess","status":"True","lastTransitionTime":"2022-03-18T18:01:18Z","reason":"Success","message":"Finish reconciling"}],"defaultUser":{"secretReference":{"name":"rabbitmq-cluster-default-user","namespace":"default","keys":{"password":"password","username":"username"}},"serviceReference":{"name":"rabbitmq-cluster","namespace":"default"}},"binding":{"name":"rabbitmq-cluster-default-user"}}}
2022/03/18 18:01:23 learn_server.go:291: [SIEVE-AFTER-READ]	Get	true	statefulset	default	rabbitmq-cluster-server	github.com/rabbitmq/cluster-operator/controllers.(*RabbitmqClusterReconciler)	NoError	{"kind":"StatefulSet","apiVersion":"apps/v1","metadata":{"name":"rabbitmq-cluster-server","namespace":"default","selfLink":"/apis/apps/v1/namespaces/default/statefulsets/rabbitmq-cluster-server","uid":"cb5c43bc-6ee7-481c-ab01-6f3acffdd3c8","resourceVersion":"989","generation":2,"creationTimestamp":"2022-03-18T18:00:38Z","labels":{"app.kubernetes.io/component":"rabbitmq","app.kubernetes.io/name":"rabbitmq-cluster","app.kubernetes.io/part-of":"rabbitmq"},"ownerReferences":[{"apiVersion":"rabbitmq.com/v1beta1","kind":"RabbitmqCluster","name":"rabbitmq-cluster","uid":"18d9928b-0d1c-47be-80ec-20960d053827","controller":true,"blockOwnerDeletion":true}],"managedFields":[{"manager":"kube-controller-manager","operation":"Update","apiVersion":"apps/v1","time":"2022-03-18T18:01:23Z","fieldsType":"FieldsV1","fieldsV1":{"f:status":{"f:collisionCount":{},"f:currentReplicas":{},"f:currentRevision":{},"f:observedGeneration":{},"f:readyReplicas":{},"f:replicas":{},"f:updateRevision":{},"f:updatedReplicas":{}}}},{"manager":"manager","operation":"Update","apiVersion":"apps/v1","time":"2022-03-18T18:01:23Z","fieldsType":"FieldsV1","fieldsV1":{"f:metadata":{"f:labels":{".":{},"f:app.kubernetes.io/component":{},"f:app.kubernetes.io/name":{},"f:app.kubernetes.io/part-of":{}},"f:ownerReferences":{".":{},"k:{\"uid\":\"18d9928b-0d1c-47be-80ec-20960d053827\"}":{".":{},"f:apiVersion":{},"f:blockOwnerDeletion":{},"f:controller":{},"f:kind":{},"f:name":{},"f:uid":{}}}},"f:spec":{"f:podManagementPolicy":{},"f:replicas":{},"f:revisionHistoryLimit":{},"f:selector":{"f:matchLabels":{".":{},"f:app.kubernetes.io/name":{}}},"f:serviceName":{},"f:template":{"f:metadata":{"f:annotations":{".":{},"f:prometheus.io/port":{},"f:prometheus.io/scrape":{}},"f:labels":{".":{},"f:app.kubernetes.io/component":{},"f:app.kubernetes.io/name":{},"f:app.kubernetes.io/part-of":{}}},"f:spec":{"f:automountServiceAccountToken":{},"f:containers":{"k:{\"name\":\"rabbitmq\"}":{".":{},"f:env":{".":{},"k:{\"name\":\"K8S_HOSTNAME_SUFFIX\"}":{".":{},"f:name":{},"f:value":{}},"k:{\"name\":\"K8S_SERVICE_NAME\"}":{".":{},"f:name":{},"f:value":{}},"k:{\"name\":\"MY_POD_NAME\"}":{".":{},"f:name":{},"f:valueFrom":{".":{},"f:fieldRef":{".":{},"f:apiVersion":{},"f:fieldPath":{}}}},"k:{\"name\":\"MY_POD_NAMESPACE\"}":{".":{},"f:name":{},"f:valueFrom":{".":{},"f:fieldRef":{".":{},"f:apiVersion":{},"f:fieldPath":{}}}},"k:{\"name\":\"RABBITMQ_ENABLED_PLUGINS_FILE\"}":{".":{},"f:name":{},"f:value":{}},"k:{\"name\":\"RABBITMQ_NODENAME\"}":{".":{},"f:name":{},"f:value":{}},"k:{\"name\":\"RABBITMQ_USE_LONGNAME\"}":{".":{},"f:name":{},"f:value":{}}},"f:image":{},"f:imagePullPolicy":{},"f:lifecycle":{".":{},"f:preStop":{".":{},"f:exec":{".":{},"f:command":{}}}},"f:name":{},"f:ports":{".":{},"k:{\"containerPort\":4369,\"protocol\":\"TCP\"}":{".":{},"f:containerPort":{},"f:name":{},"f:protocol":{}},"k:{\"containerPort\":5672,\"protocol\":\"TCP\"}":{".":{},"f:containerPort":{},"f:name":{},"f:protocol":{}},"k:{\"containerPort\":15672,\"protocol\":\"TCP\"}":{".":{},"f:containerPort":{},"f:name":{},"f:protocol":{}},"k:{\"containerPort\":15692,\"protocol\":\"TCP\"}":{".":{},"f:containerPort":{},"f:name":{},"f:protocol":{}}},"f:readinessProbe":{".":{},"f:failureThreshold":{},"f:initialDelaySeconds":{},"f:periodSeconds":{},"f:successThreshold":{},"f:tcpSocket":{".":{},"f:port":{}},"f:timeoutSeconds":{}},"f:resources":{".":{},"f:limits":{".":{},"f:cpu":{},"f:memory":{}},"f:requests":{".":{},"f:cpu":{},"f:memory":{}}},"f:terminationMessagePath":{},"f:terminationMessagePolicy":{},"f:volumeMounts":{".":{},"k:{\"mountPath\":\"/etc/pod-info/\"}":{".":{},"f:mountPath":{},"f:name":{}},"k:{\"mountPath\":\"/etc/rabbitmq/conf.d/10-operatorDefaults.conf\"}":{".":{},"f:mountPath":{},"f:name":{},"f:subPath":{}},"k:{\"mountPath\":\"/etc/rabbitmq/conf.d/11-default_user.conf\"}":{".":{},"f:mountPath":{},"f:name":{},"f:subPath":{}},"k:{\"mountPath\":\"/etc/rabbitmq/conf.d/90-userDefinedConfiguration.conf\"}":{".":{},"f:mountPath":{},"f:name":{},"f:subPath":{}},"k:{\"mountPath\":\"/operator\"}":{".":{},"f:mountPath":{},"f:name":{}},"k:{\"mountPath\":\"/var/lib/rabbitmq/\"}":{".":{},"f:mountPath":{},"f:name":{}},"k:{\"mountPath\":\"/var/lib/rabbitmq/mnesia/\"}":{".":{},"f:mountPath":{},"f:name":{}}}}},"f:dnsPolicy":{},"f:initContainers":{".":{},"k:{\"name\":\"setup-container\"}":{".":{},"f:command":{},"f:image":{},"f:imagePullPolicy":{},"f:name":{},"f:resources":{".":{},"f:limits":{".":{},"f:cpu":{},"f:memory":{}},"f:requests":{".":{},"f:cpu":{},"f:memory":{}}},"f:securityContext":{".":{},"f:capabilities":{".":{},"f:drop":{}},"f:runAsUser":{}},"f:terminationMessagePath":{},"f:terminationMessagePolicy":{},"f:volumeMounts":{".":{},"k:{\"mountPath\":\"/operator\"}":{".":{},"f:mountPath":{},"f:name":{}},"k:{\"mountPath\":\"/tmp/default_user.conf\"}":{".":{},"f:mountPath":{},"f:name":{},"f:subPath":{}},"k:{\"mountPath\":\"/tmp/erlang-cookie-secret/\"}":{".":{},"f:mountPath":{},"f:name":{}},"k:{\"mountPath\":\"/tmp/rabbitmq-plugins/\"}":{".":{},"f:mountPath":{},"f:name":{}},"k:{\"mountPath\":\"/var/lib/rabbitmq/\"}":{".":{},"f:mountPath":{},"f:name":{}},"k:{\"mountPath\":\"/var/lib/rabbitmq/mnesia/\"}":{".":{},"f:mountPath":{},"f:name":{}}}}},"f:restartPolicy":{},"f:schedulerName":{},"f:securityContext":{".":{},"f:fsGroup":{},"f:runAsGroup":{},"f:runAsUser":{}},"f:serviceAccount":{},"f:serviceAccountName":{},"f:terminationGracePeriodSeconds":{},"f:topologySpreadConstraints":{".":{},"k:{\"topologyKey\":\"topology.kubernetes.io/zone\",\"whenUnsatisfiable\":\"ScheduleAnyway\"}":{".":{},"f:labelSelector":{".":{},"f:matchLabels":{".":{},"f:app.kubernetes.io/name":{}}},"f:maxSkew":{},"f:topologyKey":{},"f:whenUnsatisfiable":{}}},"f:volumes":{".":{},"k:{\"name\":\"erlang-cookie-secret\"}":{".":{},"f:name":{},"f:secret":{".":{},"f:defaultMode":{},"f:secretName":{}}},"k:{\"name\":\"plugins-conf\"}":{".":{},"f:configMap":{".":{},"f:defaultMode":{},"f:name":{}},"f:name":{}},"k:{\"name\":\"pod-info\"}":{".":{},"f:downwardAPI":{".":{},"f:defaultMode":{},"f:items":{}},"f:name":{}},"k:{\"name\":\"rabbitmq-confd\"}":{".":{},"f:name":{},"f:projected":{".":{},"f:defaultMode":{},"f:sources":{}}},"k:{\"name\":\"rabbitmq-erlang-cookie\"}":{".":{},"f:emptyDir":{},"f:name":{}},"k:{\"name\":\"rabbitmq-plugins\"}":{".":{},"f:emptyDir":{},"f:name":{}}}}},"f:updateStrategy":{"f:rollingUpdate":{".":{},"f:partition":{}},"f:type":{}},"f:volumeClaimTemplates":{}}}}]},"spec":{"replicas":3,"selector":{"matchLabels":{"app.kubernetes.io/name":"rabbitmq-cluster"}},"template":{"metadata":{"creationTimestamp":null,"labels":{"app.kubernetes.io/component":"rabbitmq","app.kubernetes.io/name":"rabbitmq-cluster","app.kubernetes.io/part-of":"rabbitmq"},"annotations":{"prometheus.io/port":"15692","prometheus.io/scrape":"true"}},"spec":{"volumes":[{"name":"plugins-conf","configMap":{"name":"rabbitmq-cluster-plugins-conf","defaultMode":420}},{"name":"rabbitmq-confd","projected":{"sources":[{"secret":{"name":"rabbitmq-cluster-default-user","items":[{"key":"default_user.conf","path":"default_user.conf"}]}},{"configMap":{"name":"rabbitmq-cluster-server-conf","items":[{"key":"operatorDefaults.conf","path":"operatorDefaults.conf"},{"key":"userDefinedConfiguration.conf","path":"userDefinedConfiguration.conf"}]}}],"defaultMode":420}},{"name":"rabbitmq-erlang-cookie","emptyDir":{}},{"name":"erlang-cookie-secret","secret":{"secretName":"rabbitmq-cluster-erlang-cookie","defaultMode":420}},{"name":"rabbitmq-plugins","emptyDir":{}},{"name":"pod-info","downwardAPI":{"items":[{"path":"skipPreStopChecks","fieldRef":{"apiVersion":"v1","fieldPath":"metadata.labels['skipPreStopChecks']"}}],"defaultMode":420}}],"initContainers":[{"name":"setup-container","image":"rabbitmq:3.8.12-management","command":["sh","-c","cp /tmp/erlang-cookie-secret/.erlang.cookie /var/lib/rabbitmq/.erlang.cookie \u0026\u0026 chown 999:999 /var/lib/rabbitmq/.erlang.cookie \u0026\u0026 chmod 600 /var/lib/rabbitmq/.erlang.cookie ; cp /tmp/rabbitmq-plugins/enabled_plugins /operator/enabled_plugins \u0026\u0026 chown 999:999 /operator/enabled_plugins ; chown 999:999 /var/lib/rabbitmq/mnesia/ ; echo '[default]' \u003e /var/lib/rabbitmq/.rabbitmqadmin.conf \u0026\u0026 sed -e 's/default_user/username/' -e 's/default_pass/password/' /tmp/default_user.conf \u003e\u003e /var/lib/rabbitmq/.rabbitmqadmin.conf \u0026\u0026 chown 999:999 /var/lib/rabbitmq/.rabbitmqadmin.conf \u0026\u0026 chmod 600 /var/lib/rabbitmq/.rabbitmqadmin.conf"],"resources":{"limits":{"cpu":"100m","memory":"500Mi"},"requests":{"cpu":"100m","memory":"500Mi"}},"volumeMounts":[{"name":"plugins-conf","mountPath":"/tmp/rabbitmq-plugins/"},{"name":"rabbitmq-erlang-cookie","mountPath":"/var/lib/rabbitmq/"},{"name":"erlang-cookie-secret","mountPath":"/tmp/erlang-cookie-secret/"},{"name":"rabbitmq-plugins","mountPath":"/operator"},{"name":"persistence","mountPath":"/var/lib/rabbitmq/mnesia/"},{"name":"rabbitmq-confd","mountPath":"/tmp/default_user.conf","subPath":"default_user.conf"}],"terminationMessagePath":"/dev/termination-log","terminationMessagePolicy":"File","imagePullPolicy":"IfNotPresent","securityContext":{"capabilities":{"drop":["FSETID","KILL","SETGID","SETUID","SETPCAP","NET_BIND_SERVICE","NET_RAW","SYS_CHROOT","MKNOD","AUDIT_WRITE","SETFCAP"]},"runAsUser":0}}],"containers":[{"name":"rabbitmq","image":"rabbitmq:3.8.12-management","ports":[{"name":"epmd","containerPort":4369,"protocol":"TCP"},{"name":"amqp","containerPort":5672,"protocol":"TCP"},{"name":"management","containerPort":15672,"protocol":"TCP"},{"name":"prometheus","containerPort":15692,"protocol":"TCP"}],"env":[{"name":"MY_POD_NAME","valueFrom":{"fieldRef":{"apiVersion":"v1","fieldPath":"metadata.name"}}},{"name":"MY_POD_NAMESPACE","valueFrom":{"fieldRef":{"apiVersion":"v1","fieldPath":"metadata.namespace"}}},{"name":"RABBITMQ_ENABLED_PLUGINS_FILE","value":"/operator/enabled_plugins"},{"name":"K8S_SERVICE_NAME","value":"rabbitmq-cluster-nodes"},{"name":"RABBITMQ_USE_LONGNAME","value":"true"},{"name":"RABBITMQ_NODENAME","value":"rabbit@$(MY_POD_NAME).$(K8S_SERVICE_NAME).$(MY_POD_NAMESPACE)"},{"name":"K8S_HOSTNAME_SUFFIX","value":".$(K8S_SERVICE_NAME).$(MY_POD_NAMESPACE)"}],"resources":{"limits":{"cpu":"2","memory":"2Gi"},"requests":{"cpu":"1","memory":"2Gi"}},"volumeMounts":[{"name":"rabbitmq-erlang-cookie","mountPath":"/var/lib/rabbitmq/"},{"name":"persistence","mountPath":"/var/lib/rabbitmq/mnesia/"},{"name":"rabbitmq-plugins","mountPath":"/operator"},{"name":"rabbitmq-confd","mountPath":"/etc/rabbitmq/conf.d/10-operatorDefaults.conf","subPath":"operatorDefaults.conf"},{"name":"rabbitmq-confd","mountPath":"/etc/rabbitmq/conf.d/11-default_user.conf","subPath":"default_user.conf"},{"name":"rabbitmq-confd","mountPath":"/etc/rabbitmq/conf.d/90-userDefinedConfiguration.conf","subPath":"userDefinedConfiguration.conf"},{"name":"pod-info","mountPath":"/etc/pod-info/"}],"readinessProbe":{"tcpSocket":{"port":"amqp"},"initialDelaySeconds":10,"timeoutSeconds":5,"periodSeconds":10,"successThreshold":1,"failureThreshold":3},"lifecycle":{"preStop":{"exec":{"command":["/bin/bash","-c","if [ ! -z \"$(cat /etc/pod-info/skipPreStopChecks)\" ]; then exit 0; fi; rabbitmq-upgrade await_online_quorum_plus_one -t 604800; rabbitmq-upgrade await_online_synchronized_mirror -t 604800; rabbitmq-upgrade drain -t 604800"]}}},"terminationMessagePath":"/dev/termination-log","terminationMessagePolicy":"File","imagePullPolicy":"IfNotPresent"}],"restartPolicy":"Always","terminationGracePeriodSeconds":604800,"dnsPolicy":"ClusterFirst","serviceAccountName":"rabbitmq-cluster-server","serviceAccount":"rabbitmq-cluster-server","automountServiceAccountToken":true,"securityContext":{"runAsUser":999,"runAsGroup":999,"fsGroup":999},"schedulerName":"default-scheduler","topologySpreadConstraints":[{"maxSkew":1,"topologyKey":"topology.kubernetes.io/zone","whenUnsatisfiable":"ScheduleAnyway","labelSelector":{"matchLabels":{"app.kubernetes.io/name":"rabbitmq-cluster"}}}]}},"volumeClaimTemplates":[{"metadata":{"name":"persistence","namespace":"default","creationTimestamp":null,"labels":{"app.kubernetes.io/component":"rabbitmq","app.kubernetes.io/name":"rabbitmq-cluster","app.kubernetes.io/part-of":"rabbitmq"},"ownerReferences":[{"apiVersion":"rabbitmq.com/v1beta1","kind":"RabbitmqCluster","name":"rabbitmq-cluster","uid":"18d9928b-0d1c-47be-80ec-20960d053827","controller":true,"blockOwnerDeletion":false}]},"spec":{"accessModes":["ReadWriteOnce"],"resources":{"requests":{"storage":"10Gi"}},"volumeMode":"Filesystem"},"status":{"phase":"Pending"}}],"serviceName":"rabbitmq-cluster-nodes","podManagementPolicy":"Parallel","updateStrategy":{"type":"RollingUpdate","rollingUpdate":{"partition":0}},"revisionHistoryLimit":10},"status":{"observedGeneration":2,"replicas":3,"readyReplicas":1,"currentReplicas":3,"updatedReplicas":3,"currentRevision":"rabbitmq-cluster-server-5f8b8665fb","updateRevision":"rabbitmq-cluster-server-5f8b8665fb","collisionCount":0}}
2022/03/18 18:01:23 learn_server.go:253: [SIEVE-AFTER-RECONCILE]	github.com/rabbitmq/cluster-operator/controllers.(*RabbitmqClusterReconciler)	10
2022/03/18 18:01:23 learn_server.go:238: [SIEVE-BEFORE-RECONCILE]	github.com/rabbitmq/cluster-operator/controllers.(*RabbitmqClusterReconciler)	11
2022/03/18 18:01:23 learn_server.go:291: [SIEVE-AFTER-READ]	Get	true	rabbitmqcluster	default	rabbitmq-cluster	github.com/rabbitmq/cluster-operator/controllers.(*RabbitmqClusterReconciler)	NoError	{"kind":"RabbitmqCluster","apiVersion":"rabbitmq.com/v1beta1","metadata":{"name":"rabbitmq-cluster","namespace":"default","selfLink":"/apis/rabbitmq.com/v1beta1/namespaces/default/rabbitmqclusters/rabbitmq-cluster","uid":"18d9928b-0d1c-47be-80ec-20960d053827","resourceVersion":"977","generation":3,"creationTimestamp":"2022-03-18T18:00:38Z","annotations":{"kubectl.kubernetes.io/last-applied-configuration":"{\"apiVersion\":\"rabbitmq.com/v1beta1\",\"kind\":\"RabbitmqCluster\",\"metadata\":{\"annotations\":{},\"name\":\"rabbitmq-cluster\",\"namespace\":\"default\"},\"spec\":{\"persistence\":{\"storage\":\"10Gi\"},\"replicas\":1}}\n"},"finalizers":["deletion.finalizers.rabbitmqclusters.rabbitmq.com"],"managedFields":[{"manager":"kubectl-client-side-apply","operation":"Update","apiVersion":"rabbitmq.com/v1beta1","time":"2022-03-18T18:00:38Z","fieldsType":"FieldsV1","fieldsV1":{"f:metadata":{"f:annotations":{".":{},"f:kubectl.kubernetes.io/last-applied-configuration":{}}},"f:spec":{".":{},"f:image":{},"f:persistence":{".":{},"f:storage":{}},"f:resources":{".":{},"f:limits":{".":{},"f:memory":{}},"f:requests":{".":{},"f:memory":{}}},"f:service":{".":{},"f:type":{}},"f:terminationGracePeriodSeconds":{}}}},{"manager":"kubectl-patch","operation":"Update","apiVersion":"rabbitmq.com/v1beta1","time":"2022-03-18T18:01:23Z","fieldsType":"FieldsV1","fieldsV1":{"f:spec":{"f:replicas":{}}}},{"manager":"manager","operation":"Update","apiVersion":"rabbitmq.com/v1beta1","time":"2022-03-18T18:01:23Z","fieldsType":"FieldsV1","fieldsV1":{"f:metadata":{"f:finalizers":{}},"f:spec":{"f:override":{},"f:rabbitmq":{},"f:resources":{"f:limits":{"f:cpu":{}},"f:requests":{"f:cpu":{}}},"f:tls":{}},"f:status":{".":{},"f:conditions":{},"f:defaultUser":{".":{},"f:secretReference":{".":{},"f:keys":{".":{},"f:password":{},"f:username":{}},"f:name":{},"f:namespace":{}},"f:serviceReference":{".":{},"f:name":{},"f:namespace":{}}}}}}]},"spec":{"replicas":3,"image":"rabbitmq:3.8.12-management","service":{"type":"ClusterIP"},"persistence":{"storage":"10Gi"},"resources":{"limits":{"cpu":"2","memory":"2Gi"},"requests":{"cpu":"1","memory":"2Gi"}},"rabbitmq":{},"tls":{},"override":{},"terminationGracePeriodSeconds":604800},"status":{"conditions":[{"type":"AllReplicasReady","status":"False","lastTransitionTime":"2022-03-18T18:01:23Z","reason":"NotAllPodsReady","message":"1/3 Pods ready"},{"type":"ClusterAvailable","status":"True","lastTransitionTime":"2022-03-18T18:01:17Z","reason":"AtLeastOneEndpointAvailable"},{"type":"NoWarnings","status":"True","lastTransitionTime":"2022-03-18T18:00:38Z","reason":"NoWarnings"},{"type":"ReconcileSuccess","status":"True","lastTransitionTime":"2022-03-18T18:01:18Z","reason":"Success","message":"Finish reconciling"}],"defaultUser":{"secretReference":{"name":"rabbitmq-cluster-default-user","namespace":"default","keys":{"password":"password","username":"username"}},"serviceReference":{"name":"rabbitmq-cluster","namespace":"default"}}}}
2022/03/18 18:01:23 learn_server.go:291: [SIEVE-AFTER-READ]	Get	true	statefulset	default	rabbitmq-cluster-server	github.com/rabbitmq/cluster-operator/controllers.(*RabbitmqClusterReconciler)	NoError	{"kind":"StatefulSet","apiVersion":"apps/v1","metadata":{"name":"rabbitmq-cluster-server","namespace":"default","selfLink":"/apis/apps/v1/namespaces/default/statefulsets/rabbitmq-cluster-server","uid":"cb5c43bc-6ee7-481c-ab01-6f3acffdd3c8","resourceVersion":"989","generation":2,"creationTimestamp":"2022-03-18T18:00:38Z","labels":{"app.kubernetes.io/component":"rabbitmq","app.kubernetes.io/name":"rabbitmq-cluster","app.kubernetes.io/part-of":"rabbitmq"},"ownerReferences":[{"apiVersion":"rabbitmq.com/v1beta1","kind":"RabbitmqCluster","name":"rabbitmq-cluster","uid":"18d9928b-0d1c-47be-80ec-20960d053827","controller":true,"blockOwnerDeletion":true}],"managedFields":[{"manager":"kube-controller-manager","operation":"Update","apiVersion":"apps/v1","time":"2022-03-18T18:01:23Z","fieldsType":"FieldsV1","fieldsV1":{"f:status":{"f:collisionCount":{},"f:currentReplicas":{},"f:currentRevision":{},"f:observedGeneration":{},"f:readyReplicas":{},"f:replicas":{},"f:updateRevision":{},"f:updatedReplicas":{}}}},{"manager":"manager","operation":"Update","apiVersion":"apps/v1","time":"2022-03-18T18:01:23Z","fieldsType":"FieldsV1","fieldsV1":{"f:metadata":{"f:labels":{".":{},"f:app.kubernetes.io/component":{},"f:app.kubernetes.io/name":{},"f:app.kubernetes.io/part-of":{}},"f:ownerReferences":{".":{},"k:{\"uid\":\"18d9928b-0d1c-47be-80ec-20960d053827\"}":{".":{},"f:apiVersion":{},"f:blockOwnerDeletion":{},"f:controller":{},"f:kind":{},"f:name":{},"f:uid":{}}}},"f:spec":{"f:podManagementPolicy":{},"f:replicas":{},"f:revisionHistoryLimit":{},"f:selector":{"f:matchLabels":{".":{},"f:app.kubernetes.io/name":{}}},"f:serviceName":{},"f:template":{"f:metadata":{"f:annotations":{".":{},"f:prometheus.io/port":{},"f:prometheus.io/scrape":{}},"f:labels":{".":{},"f:app.kubernetes.io/component":{},"f:app.kubernetes.io/name":{},"f:app.kubernetes.io/part-of":{}}},"f:spec":{"f:automountServiceAccountToken":{},"f:containers":{"k:{\"name\":\"rabbitmq\"}":{".":{},"f:env":{".":{},"k:{\"name\":\"K8S_HOSTNAME_SUFFIX\"}":{".":{},"f:name":{},"f:value":{}},"k:{\"name\":\"K8S_SERVICE_NAME\"}":{".":{},"f:name":{},"f:value":{}},"k:{\"name\":\"MY_POD_NAME\"}":{".":{},"f:name":{},"f:valueFrom":{".":{},"f:fieldRef":{".":{},"f:apiVersion":{},"f:fieldPath":{}}}},"k:{\"name\":\"MY_POD_NAMESPACE\"}":{".":{},"f:name":{},"f:valueFrom":{".":{},"f:fieldRef":{".":{},"f:apiVersion":{},"f:fieldPath":{}}}},"k:{\"name\":\"RABBITMQ_ENABLED_PLUGINS_FILE\"}":{".":{},"f:name":{},"f:value":{}},"k:{\"name\":\"RABBITMQ_NODENAME\"}":{".":{},"f:name":{},"f:value":{}},"k:{\"name\":\"RABBITMQ_USE_LONGNAME\"}":{".":{},"f:name":{},"f:value":{}}},"f:image":{},"f:imagePullPolicy":{},"f:lifecycle":{".":{},"f:preStop":{".":{},"f:exec":{".":{},"f:command":{}}}},"f:name":{},"f:ports":{".":{},"k:{\"containerPort\":4369,\"protocol\":\"TCP\"}":{".":{},"f:containerPort":{},"f:name":{},"f:protocol":{}},"k:{\"containerPort\":5672,\"protocol\":\"TCP\"}":{".":{},"f:containerPort":{},"f:name":{},"f:protocol":{}},"k:{\"containerPort\":15672,\"protocol\":\"TCP\"}":{".":{},"f:containerPort":{},"f:name":{},"f:protocol":{}},"k:{\"containerPort\":15692,\"protocol\":\"TCP\"}":{".":{},"f:containerPort":{},"f:name":{},"f:protocol":{}}},"f:readinessProbe":{".":{},"f:failureThreshold":{},"f:initialDelaySeconds":{},"f:periodSeconds":{},"f:successThreshold":{},"f:tcpSocket":{".":{},"f:port":{}},"f:timeoutSeconds":{}},"f:resources":{".":{},"f:limits":{".":{},"f:cpu":{},"f:memory":{}},"f:requests":{".":{},"f:cpu":{},"f:memory":{}}},"f:terminationMessagePath":{},"f:terminationMessagePolicy":{},"f:volumeMounts":{".":{},"k:{\"mountPath\":\"/etc/pod-info/\"}":{".":{},"f:mountPath":{},"f:name":{}},"k:{\"mountPath\":\"/etc/rabbitmq/conf.d/10-operatorDefaults.conf\"}":{".":{},"f:mountPath":{},"f:name":{},"f:subPath":{}},"k:{\"mountPath\":\"/etc/rabbitmq/conf.d/11-default_user.conf\"}":{".":{},"f:mountPath":{},"f:name":{},"f:subPath":{}},"k:{\"mountPath\":\"/etc/rabbitmq/conf.d/90-userDefinedConfiguration.conf\"}":{".":{},"f:mountPath":{},"f:name":{},"f:subPath":{}},"k:{\"mountPath\":\"/operator\"}":{".":{},"f:mountPath":{},"f:name":{}},"k:{\"mountPath\":\"/var/lib/rabbitmq/\"}":{".":{},"f:mountPath":{},"f:name":{}},"k:{\"mountPath\":\"/var/lib/rabbitmq/mnesia/\"}":{".":{},"f:mountPath":{},"f:name":{}}}}},"f:dnsPolicy":{},"f:initContainers":{".":{},"k:{\"name\":\"setup-container\"}":{".":{},"f:command":{},"f:image":{},"f:imagePullPolicy":{},"f:name":{},"f:resources":{".":{},"f:limits":{".":{},"f:cpu":{},"f:memory":{}},"f:requests":{".":{},"f:cpu":{},"f:memory":{}}},"f:securityContext":{".":{},"f:capabilities":{".":{},"f:drop":{}},"f:runAsUser":{}},"f:terminationMessagePath":{},"f:terminationMessagePolicy":{},"f:volumeMounts":{".":{},"k:{\"mountPath\":\"/operator\"}":{".":{},"f:mountPath":{},"f:name":{}},"k:{\"mountPath\":\"/tmp/default_user.conf\"}":{".":{},"f:mountPath":{},"f:name":{},"f:subPath":{}},"k:{\"mountPath\":\"/tmp/erlang-cookie-secret/\"}":{".":{},"f:mountPath":{},"f:name":{}},"k:{\"mountPath\":\"/tmp/rabbitmq-plugins/\"}":{".":{},"f:mountPath":{},"f:name":{}},"k:{\"mountPath\":\"/var/lib/rabbitmq/\"}":{".":{},"f:mountPath":{},"f:name":{}},"k:{\"mountPath\":\"/var/lib/rabbitmq/mnesia/\"}":{".":{},"f:mountPath":{},"f:name":{}}}}},"f:restartPolicy":{},"f:schedulerName":{},"f:securityContext":{".":{},"f:fsGroup":{},"f:runAsGroup":{},"f:runAsUser":{}},"f:serviceAccount":{},"f:serviceAccountName":{},"f:terminationGracePeriodSeconds":{},"f:topologySpreadConstraints":{".":{},"k:{\"topologyKey\":\"topology.kubernetes.io/zone\",\"whenUnsatisfiable\":\"ScheduleAnyway\"}":{".":{},"f:labelSelector":{".":{},"f:matchLabels":{".":{},"f:app.kubernetes.io/name":{}}},"f:maxSkew":{},"f:topologyKey":{},"f:whenUnsatisfiable":{}}},"f:volumes":{".":{},"k:{\"name\":\"erlang-cookie-secret\"}":{".":{},"f:name":{},"f:secret":{".":{},"f:defaultMode":{},"f:secretName":{}}},"k:{\"name\":\"plugins-conf\"}":{".":{},"f:configMap":{".":{},"f:defaultMode":{},"f:name":{}},"f:name":{}},"k:{\"name\":\"pod-info\"}":{".":{},"f:downwardAPI":{".":{},"f:defaultMode":{},"f:items":{}},"f:name":{}},"k:{\"name\":\"rabbitmq-confd\"}":{".":{},"f:name":{},"f:projected":{".":{},"f:defaultMode":{},"f:sources":{}}},"k:{\"name\":\"rabbitmq-erlang-cookie\"}":{".":{},"f:emptyDir":{},"f:name":{}},"k:{\"name\":\"rabbitmq-plugins\"}":{".":{},"f:emptyDir":{},"f:name":{}}}}},"f:updateStrategy":{"f:rollingUpdate":{".":{},"f:partition":{}},"f:type":{}},"f:volumeClaimTemplates":{}}}}]},"spec":{"replicas":3,"selector":{"matchLabels":{"app.kubernetes.io/name":"rabbitmq-cluster"}},"template":{"metadata":{"creationTimestamp":null,"labels":{"app.kubernetes.io/component":"rabbitmq","app.kubernetes.io/name":"rabbitmq-cluster","app.kubernetes.io/part-of":"rabbitmq"},"annotations":{"prometheus.io/port":"15692","prometheus.io/scrape":"true"}},"spec":{"volumes":[{"name":"plugins-conf","configMap":{"name":"rabbitmq-cluster-plugins-conf","defaultMode":420}},{"name":"rabbitmq-confd","projected":{"sources":[{"secret":{"name":"rabbitmq-cluster-default-user","items":[{"key":"default_user.conf","path":"default_user.conf"}]}},{"configMap":{"name":"rabbitmq-cluster-server-conf","items":[{"key":"operatorDefaults.conf","path":"operatorDefaults.conf"},{"key":"userDefinedConfiguration.conf","path":"userDefinedConfiguration.conf"}]}}],"defaultMode":420}},{"name":"rabbitmq-erlang-cookie","emptyDir":{}},{"name":"erlang-cookie-secret","secret":{"secretName":"rabbitmq-cluster-erlang-cookie","defaultMode":420}},{"name":"rabbitmq-plugins","emptyDir":{}},{"name":"pod-info","downwardAPI":{"items":[{"path":"skipPreStopChecks","fieldRef":{"apiVersion":"v1","fieldPath":"metadata.labels['skipPreStopChecks']"}}],"defaultMode":420}}],"initContainers":[{"name":"setup-container","image":"rabbitmq:3.8.12-management","command":["sh","-c","cp /tmp/erlang-cookie-secret/.erlang.cookie /var/lib/rabbitmq/.erlang.cookie \u0026\u0026 chown 999:999 /var/lib/rabbitmq/.erlang.cookie \u0026\u0026 chmod 600 /var/lib/rabbitmq/.erlang.cookie ; cp /tmp/rabbitmq-plugins/enabled_plugins /operator/enabled_plugins \u0026\u0026 chown 999:999 /operator/enabled_plugins ; chown 999:999 /var/lib/rabbitmq/mnesia/ ; echo '[default]' \u003e /var/lib/rabbitmq/.rabbitmqadmin.conf \u0026\u0026 sed -e 's/default_user/username/' -e 's/default_pass/password/' /tmp/default_user.conf \u003e\u003e /var/lib/rabbitmq/.rabbitmqadmin.conf \u0026\u0026 chown 999:999 /var/lib/rabbitmq/.rabbitmqadmin.conf \u0026\u0026 chmod 600 /var/lib/rabbitmq/.rabbitmqadmin.conf"],"resources":{"limits":{"cpu":"100m","memory":"500Mi"},"requests":{"cpu":"100m","memory":"500Mi"}},"volumeMounts":[{"name":"plugins-conf","mountPath":"/tmp/rabbitmq-plugins/"},{"name":"rabbitmq-erlang-cookie","mountPath":"/var/lib/rabbitmq/"},{"name":"erlang-cookie-secret","mountPath":"/tmp/erlang-cookie-secret/"},{"name":"rabbitmq-plugins","mountPath":"/operator"},{"name":"persistence","mountPath":"/var/lib/rabbitmq/mnesia/"},{"name":"rabbitmq-confd","mountPath":"/tmp/default_user.conf","subPath":"default_user.conf"}],"terminationMessagePath":"/dev/termination-log","terminationMessagePolicy":"File","imagePullPolicy":"IfNotPresent","securityContext":{"capabilities":{"drop":["FSETID","KILL","SETGID","SETUID","SETPCAP","NET_BIND_SERVICE","NET_RAW","SYS_CHROOT","MKNOD","AUDIT_WRITE","SETFCAP"]},"runAsUser":0}}],"containers":[{"name":"rabbitmq","image":"rabbitmq:3.8.12-management","ports":[{"name":"epmd","containerPort":4369,"protocol":"TCP"},{"name":"amqp","containerPort":5672,"protocol":"TCP"},{"name":"management","containerPort":15672,"protocol":"TCP"},{"name":"prometheus","containerPort":15692,"protocol":"TCP"}],"env":[{"name":"MY_POD_NAME","valueFrom":{"fieldRef":{"apiVersion":"v1","fieldPath":"metadata.name"}}},{"name":"MY_POD_NAMESPACE","valueFrom":{"fieldRef":{"apiVersion":"v1","fieldPath":"metadata.namespace"}}},{"name":"RABBITMQ_ENABLED_PLUGINS_FILE","value":"/operator/enabled_plugins"},{"name":"K8S_SERVICE_NAME","value":"rabbitmq-cluster-nodes"},{"name":"RABBITMQ_USE_LONGNAME","value":"true"},{"name":"RABBITMQ_NODENAME","value":"rabbit@$(MY_POD_NAME).$(K8S_SERVICE_NAME).$(MY_POD_NAMESPACE)"},{"name":"K8S_HOSTNAME_SUFFIX","value":".$(K8S_SERVICE_NAME).$(MY_POD_NAMESPACE)"}],"resources":{"limits":{"cpu":"2","memory":"2Gi"},"requests":{"cpu":"1","memory":"2Gi"}},"volumeMounts":[{"name":"rabbitmq-erlang-cookie","mountPath":"/var/lib/rabbitmq/"},{"name":"persistence","mountPath":"/var/lib/rabbitmq/mnesia/"},{"name":"rabbitmq-plugins","mountPath":"/operator"},{"name":"rabbitmq-confd","mountPath":"/etc/rabbitmq/conf.d/10-operatorDefaults.conf","subPath":"operatorDefaults.conf"},{"name":"rabbitmq-confd","mountPath":"/etc/rabbitmq/conf.d/11-default_user.conf","subPath":"default_user.conf"},{"name":"rabbitmq-confd","mountPath":"/etc/rabbitmq/conf.d/90-userDefinedConfiguration.conf","subPath":"userDefinedConfiguration.conf"},{"name":"pod-info","mountPath":"/etc/pod-info/"}],"readinessProbe":{"tcpSocket":{"port":"amqp"},"initialDelaySeconds":10,"timeoutSeconds":5,"periodSeconds":10,"successThreshold":1,"failureThreshold":3},"lifecycle":{"preStop":{"exec":{"command":["/bin/bash","-c","if [ ! -z \"$(cat /etc/pod-info/skipPreStopChecks)\" ]; then exit 0; fi; rabbitmq-upgrade await_online_quorum_plus_one -t 604800; rabbitmq-upgrade await_online_synchronized_mirror -t 604800; rabbitmq-upgrade drain -t 604800"]}}},"terminationMessagePath":"/dev/termination-log","terminationMessagePolicy":"File","imagePullPolicy":"IfNotPresent"}],"restartPolicy":"Always","terminationGracePeriodSeconds":604800,"dnsPolicy":"ClusterFirst","serviceAccountName":"rabbitmq-cluster-server","serviceAccount":"rabbitmq-cluster-server","automountServiceAccountToken":true,"securityContext":{"runAsUser":999,"runAsGroup":999,"fsGroup":999},"schedulerName":"default-scheduler","topologySpreadConstraints":[{"maxSkew":1,"topologyKey":"topology.kubernetes.io/zone","whenUnsatisfiable":"ScheduleAnyway","labelSelector":{"matchLabels":{"app.kubernetes.io/name":"rabbitmq-cluster"}}}]}},"volumeClaimTemplates":[{"metadata":{"name":"persistence","namespace":"default","creationTimestamp":null,"labels":{"app.kubernetes.io/component":"rabbitmq","app.kubernetes.io/name":"rabbitmq-cluster","app.kubernetes.io/part-of":"rabbitmq"},"ownerReferences":[{"apiVersion":"rabbitmq.com/v1beta1","kind":"RabbitmqCluster","name":"rabbitmq-cluster","uid":"18d9928b-0d1c-47be-80ec-20960d053827","controller":true,"blockOwnerDeletion":false}]},"spec":{"accessModes":["ReadWriteOnce"],"resources":{"requests":{"storage":"10Gi"}},"volumeMode":"Filesystem"},"status":{"phase":"Pending"}}],"serviceName":"rabbitmq-cluster-nodes","podManagementPolicy":"Parallel","updateStrategy":{"type":"RollingUpdate","rollingUpdate":{"partition":0}},"revisionHistoryLimit":10},"status":{"observedGeneration":2,"replicas":3,"readyReplicas":1,"currentReplicas":3,"updatedReplicas":3,"currentRevision":"rabbitmq-cluster-server-5f8b8665fb","updateRevision":"rabbitmq-cluster-server-5f8b8665fb","collisionCount":0}}
2022/03/18 18:01:23 learn_server.go:291: [SIEVE-AFTER-READ]	Get	true	endpoints	default	rabbitmq-cluster	github.com/rabbitmq/cluster-operator/controllers.(*RabbitmqClusterReconciler)	NoError	{"kind":"Endpoints","apiVersion":"v1","metadata":{"name":"rabbitmq-cluster","namespace":"default","selfLink":"/api/v1/namespaces/default/endpoints/rabbitmq-cluster","uid":"5c4723ad-f4fe-442d-9135-44879a2a8183","resourceVersion":"939","creationTimestamp":"2022-03-18T18:00:38Z","labels":{"app.kubernetes.io/component":"rabbitmq","app.kubernetes.io/name":"rabbitmq-cluster","app.kubernetes.io/part-of":"rabbitmq"},"annotations":{"endpoints.kubernetes.io/last-change-trigger-time":"2022-03-18T18:01:17Z"},"managedFields":[{"manager":"kube-controller-manager","operation":"Update","apiVersion":"v1","time":"2022-03-18T18:01:17Z","fieldsType":"FieldsV1","fieldsV1":{"f:metadata":{"f:annotations":{".":{},"f:endpoints.kubernetes.io/last-change-trigger-time":{}},"f:labels":{".":{},"f:app.kubernetes.io/component":{},"f:app.kubernetes.io/name":{},"f:app.kubernetes.io/part-of":{}}},"f:subsets":{}}}]},"subsets":[{"addresses":[{"ip":"10.244.1.4","nodeName":"kind-worker2","targetRef":{"kind":"Pod","namespace":"default","name":"rabbitmq-cluster-server-0","uid":"e7faffc5-b656-4e69-9777-92d12cb6ec5a","resourceVersion":"938"}}],"ports":[{"name":"amqp","port":5672,"protocol":"TCP"},{"name":"management","port":15672,"protocol":"TCP"}]}]}
2022/03/18 18:01:23 learn_server.go:291: [SIEVE-AFTER-READ]	Get	true	statefulset	default	rabbitmq-cluster-server	github.com/rabbitmq/cluster-operator/controllers.(*RabbitmqClusterReconciler)	NoError	{"kind":"StatefulSet","apiVersion":"apps/v1","metadata":{"name":"rabbitmq-cluster-server","namespace":"default","selfLink":"/apis/apps/v1/namespaces/default/statefulsets/rabbitmq-cluster-server","uid":"cb5c43bc-6ee7-481c-ab01-6f3acffdd3c8","resourceVersion":"989","generation":2,"creationTimestamp":"2022-03-18T18:00:38Z","labels":{"app.kubernetes.io/component":"rabbitmq","app.kubernetes.io/name":"rabbitmq-cluster","app.kubernetes.io/part-of":"rabbitmq"},"ownerReferences":[{"apiVersion":"rabbitmq.com/v1beta1","kind":"RabbitmqCluster","name":"rabbitmq-cluster","uid":"18d9928b-0d1c-47be-80ec-20960d053827","controller":true,"blockOwnerDeletion":true}],"managedFields":[{"manager":"kube-controller-manager","operation":"Update","apiVersion":"apps/v1","time":"2022-03-18T18:01:23Z","fieldsType":"FieldsV1","fieldsV1":{"f:status":{"f:collisionCount":{},"f:currentReplicas":{},"f:currentRevision":{},"f:observedGeneration":{},"f:readyReplicas":{},"f:replicas":{},"f:updateRevision":{},"f:updatedReplicas":{}}}},{"manager":"manager","operation":"Update","apiVersion":"apps/v1","time":"2022-03-18T18:01:23Z","fieldsType":"FieldsV1","fieldsV1":{"f:metadata":{"f:labels":{".":{},"f:app.kubernetes.io/component":{},"f:app.kubernetes.io/name":{},"f:app.kubernetes.io/part-of":{}},"f:ownerReferences":{".":{},"k:{\"uid\":\"18d9928b-0d1c-47be-80ec-20960d053827\"}":{".":{},"f:apiVersion":{},"f:blockOwnerDeletion":{},"f:controller":{},"f:kind":{},"f:name":{},"f:uid":{}}}},"f:spec":{"f:podManagementPolicy":{},"f:replicas":{},"f:revisionHistoryLimit":{},"f:selector":{"f:matchLabels":{".":{},"f:app.kubernetes.io/name":{}}},"f:serviceName":{},"f:template":{"f:metadata":{"f:annotations":{".":{},"f:prometheus.io/port":{},"f:prometheus.io/scrape":{}},"f:labels":{".":{},"f:app.kubernetes.io/component":{},"f:app.kubernetes.io/name":{},"f:app.kubernetes.io/part-of":{}}},"f:spec":{"f:automountServiceAccountToken":{},"f:containers":{"k:{\"name\":\"rabbitmq\"}":{".":{},"f:env":{".":{},"k:{\"name\":\"K8S_HOSTNAME_SUFFIX\"}":{".":{},"f:name":{},"f:value":{}},"k:{\"name\":\"K8S_SERVICE_NAME\"}":{".":{},"f:name":{},"f:value":{}},"k:{\"name\":\"MY_POD_NAME\"}":{".":{},"f:name":{},"f:valueFrom":{".":{},"f:fieldRef":{".":{},"f:apiVersion":{},"f:fieldPath":{}}}},"k:{\"name\":\"MY_POD_NAMESPACE\"}":{".":{},"f:name":{},"f:valueFrom":{".":{},"f:fieldRef":{".":{},"f:apiVersion":{},"f:fieldPath":{}}}},"k:{\"name\":\"RABBITMQ_ENABLED_PLUGINS_FILE\"}":{".":{},"f:name":{},"f:value":{}},"k:{\"name\":\"RABBITMQ_NODENAME\"}":{".":{},"f:name":{},"f:value":{}},"k:{\"name\":\"RABBITMQ_USE_LONGNAME\"}":{".":{},"f:name":{},"f:value":{}}},"f:image":{},"f:imagePullPolicy":{},"f:lifecycle":{".":{},"f:preStop":{".":{},"f:exec":{".":{},"f:command":{}}}},"f:name":{},"f:ports":{".":{},"k:{\"containerPort\":4369,\"protocol\":\"TCP\"}":{".":{},"f:containerPort":{},"f:name":{},"f:protocol":{}},"k:{\"containerPort\":5672,\"protocol\":\"TCP\"}":{".":{},"f:containerPort":{},"f:name":{},"f:protocol":{}},"k:{\"containerPort\":15672,\"protocol\":\"TCP\"}":{".":{},"f:containerPort":{},"f:name":{},"f:protocol":{}},"k:{\"containerPort\":15692,\"protocol\":\"TCP\"}":{".":{},"f:containerPort":{},"f:name":{},"f:protocol":{}}},"f:readinessProbe":{".":{},"f:failureThreshold":{},"f:initialDelaySeconds":{},"f:periodSeconds":{},"f:successThreshold":{},"f:tcpSocket":{".":{},"f:port":{}},"f:timeoutSeconds":{}},"f:resources":{".":{},"f:limits":{".":{},"f:cpu":{},"f:memory":{}},"f:requests":{".":{},"f:cpu":{},"f:memory":{}}},"f:terminationMessagePath":{},"f:terminationMessagePolicy":{},"f:volumeMounts":{".":{},"k:{\"mountPath\":\"/etc/pod-info/\"}":{".":{},"f:mountPath":{},"f:name":{}},"k:{\"mountPath\":\"/etc/rabbitmq/conf.d/10-operatorDefaults.conf\"}":{".":{},"f:mountPath":{},"f:name":{},"f:subPath":{}},"k:{\"mountPath\":\"/etc/rabbitmq/conf.d/11-default_user.conf\"}":{".":{},"f:mountPath":{},"f:name":{},"f:subPath":{}},"k:{\"mountPath\":\"/etc/rabbitmq/conf.d/90-userDefinedConfiguration.conf\"}":{".":{},"f:mountPath":{},"f:name":{},"f:subPath":{}},"k:{\"mountPath\":\"/operator\"}":{".":{},"f:mountPath":{},"f:name":{}},"k:{\"mountPath\":\"/var/lib/rabbitmq/\"}":{".":{},"f:mountPath":{},"f:name":{}},"k:{\"mountPath\":\"/var/lib/rabbitmq/mnesia/\"}":{".":{},"f:mountPath":{},"f:name":{}}}}},"f:dnsPolicy":{},"f:initContainers":{".":{},"k:{\"name\":\"setup-container\"}":{".":{},"f:command":{},"f:image":{},"f:imagePullPolicy":{},"f:name":{},"f:resources":{".":{},"f:limits":{".":{},"f:cpu":{},"f:memory":{}},"f:requests":{".":{},"f:cpu":{},"f:memory":{}}},"f:securityContext":{".":{},"f:capabilities":{".":{},"f:drop":{}},"f:runAsUser":{}},"f:terminationMessagePath":{},"f:terminationMessagePolicy":{},"f:volumeMounts":{".":{},"k:{\"mountPath\":\"/operator\"}":{".":{},"f:mountPath":{},"f:name":{}},"k:{\"mountPath\":\"/tmp/default_user.conf\"}":{".":{},"f:mountPath":{},"f:name":{},"f:subPath":{}},"k:{\"mountPath\":\"/tmp/erlang-cookie-secret/\"}":{".":{},"f:mountPath":{},"f:name":{}},"k:{\"mountPath\":\"/tmp/rabbitmq-plugins/\"}":{".":{},"f:mountPath":{},"f:name":{}},"k:{\"mountPath\":\"/var/lib/rabbitmq/\"}":{".":{},"f:mountPath":{},"f:name":{}},"k:{\"mountPath\":\"/var/lib/rabbitmq/mnesia/\"}":{".":{},"f:mountPath":{},"f:name":{}}}}},"f:restartPolicy":{},"f:schedulerName":{},"f:securityContext":{".":{},"f:fsGroup":{},"f:runAsGroup":{},"f:runAsUser":{}},"f:serviceAccount":{},"f:serviceAccountName":{},"f:terminationGracePeriodSeconds":{},"f:topologySpreadConstraints":{".":{},"k:{\"topologyKey\":\"topology.kubernetes.io/zone\",\"whenUnsatisfiable\":\"ScheduleAnyway\"}":{".":{},"f:labelSelector":{".":{},"f:matchLabels":{".":{},"f:app.kubernetes.io/name":{}}},"f:maxSkew":{},"f:topologyKey":{},"f:whenUnsatisfiable":{}}},"f:volumes":{".":{},"k:{\"name\":\"erlang-cookie-secret\"}":{".":{},"f:name":{},"f:secret":{".":{},"f:defaultMode":{},"f:secretName":{}}},"k:{\"name\":\"plugins-conf\"}":{".":{},"f:configMap":{".":{},"f:defaultMode":{},"f:name":{}},"f:name":{}},"k:{\"name\":\"pod-info\"}":{".":{},"f:downwardAPI":{".":{},"f:defaultMode":{},"f:items":{}},"f:name":{}},"k:{\"name\":\"rabbitmq-confd\"}":{".":{},"f:name":{},"f:projected":{".":{},"f:defaultMode":{},"f:sources":{}}},"k:{\"name\":\"rabbitmq-erlang-cookie\"}":{".":{},"f:emptyDir":{},"f:name":{}},"k:{\"name\":\"rabbitmq-plugins\"}":{".":{},"f:emptyDir":{},"f:name":{}}}}},"f:updateStrategy":{"f:rollingUpdate":{".":{},"f:partition":{}},"f:type":{}},"f:volumeClaimTemplates":{}}}}]},"spec":{"replicas":3,"selector":{"matchLabels":{"app.kubernetes.io/name":"rabbitmq-cluster"}},"template":{"metadata":{"creationTimestamp":null,"labels":{"app.kubernetes.io/component":"rabbitmq","app.kubernetes.io/name":"rabbitmq-cluster","app.kubernetes.io/part-of":"rabbitmq"},"annotations":{"prometheus.io/port":"15692","prometheus.io/scrape":"true"}},"spec":{"volumes":[{"name":"plugins-conf","configMap":{"name":"rabbitmq-cluster-plugins-conf","defaultMode":420}},{"name":"rabbitmq-confd","projected":{"sources":[{"secret":{"name":"rabbitmq-cluster-default-user","items":[{"key":"default_user.conf","path":"default_user.conf"}]}},{"configMap":{"name":"rabbitmq-cluster-server-conf","items":[{"key":"operatorDefaults.conf","path":"operatorDefaults.conf"},{"key":"userDefinedConfiguration.conf","path":"userDefinedConfiguration.conf"}]}}],"defaultMode":420}},{"name":"rabbitmq-erlang-cookie","emptyDir":{}},{"name":"erlang-cookie-secret","secret":{"secretName":"rabbitmq-cluster-erlang-cookie","defaultMode":420}},{"name":"rabbitmq-plugins","emptyDir":{}},{"name":"pod-info","downwardAPI":{"items":[{"path":"skipPreStopChecks","fieldRef":{"apiVersion":"v1","fieldPath":"metadata.labels['skipPreStopChecks']"}}],"defaultMode":420}}],"initContainers":[{"name":"setup-container","image":"rabbitmq:3.8.12-management","command":["sh","-c","cp /tmp/erlang-cookie-secret/.erlang.cookie /var/lib/rabbitmq/.erlang.cookie \u0026\u0026 chown 999:999 /var/lib/rabbitmq/.erlang.cookie \u0026\u0026 chmod 600 /var/lib/rabbitmq/.erlang.cookie ; cp /tmp/rabbitmq-plugins/enabled_plugins /operator/enabled_plugins \u0026\u0026 chown 999:999 /operator/enabled_plugins ; chown 999:999 /var/lib/rabbitmq/mnesia/ ; echo '[default]' \u003e /var/lib/rabbitmq/.rabbitmqadmin.conf \u0026\u0026 sed -e 's/default_user/username/' -e 's/default_pass/password/' /tmp/default_user.conf \u003e\u003e /var/lib/rabbitmq/.rabbitmqadmin.conf \u0026\u0026 chown 999:999 /var/lib/rabbitmq/.rabbitmqadmin.conf \u0026\u0026 chmod 600 /var/lib/rabbitmq/.rabbitmqadmin.conf"],"resources":{"limits":{"cpu":"100m","memory":"500Mi"},"requests":{"cpu":"100m","memory":"500Mi"}},"volumeMounts":[{"name":"plugins-conf","mountPath":"/tmp/rabbitmq-plugins/"},{"name":"rabbitmq-erlang-cookie","mountPath":"/var/lib/rabbitmq/"},{"name":"erlang-cookie-secret","mountPath":"/tmp/erlang-cookie-secret/"},{"name":"rabbitmq-plugins","mountPath":"/operator"},{"name":"persistence","mountPath":"/var/lib/rabbitmq/mnesia/"},{"name":"rabbitmq-confd","mountPath":"/tmp/default_user.conf","subPath":"default_user.conf"}],"terminationMessagePath":"/dev/termination-log","terminationMessagePolicy":"File","imagePullPolicy":"IfNotPresent","securityContext":{"capabilities":{"drop":["FSETID","KILL","SETGID","SETUID","SETPCAP","NET_BIND_SERVICE","NET_RAW","SYS_CHROOT","MKNOD","AUDIT_WRITE","SETFCAP"]},"runAsUser":0}}],"containers":[{"name":"rabbitmq","image":"rabbitmq:3.8.12-management","ports":[{"name":"epmd","containerPort":4369,"protocol":"TCP"},{"name":"amqp","containerPort":5672,"protocol":"TCP"},{"name":"management","containerPort":15672,"protocol":"TCP"},{"name":"prometheus","containerPort":15692,"protocol":"TCP"}],"env":[{"name":"MY_POD_NAME","valueFrom":{"fieldRef":{"apiVersion":"v1","fieldPath":"metadata.name"}}},{"name":"MY_POD_NAMESPACE","valueFrom":{"fieldRef":{"apiVersion":"v1","fieldPath":"metadata.namespace"}}},{"name":"RABBITMQ_ENABLED_PLUGINS_FILE","value":"/operator/enabled_plugins"},{"name":"K8S_SERVICE_NAME","value":"rabbitmq-cluster-nodes"},{"name":"RABBITMQ_USE_LONGNAME","value":"true"},{"name":"RABBITMQ_NODENAME","value":"rabbit@$(MY_POD_NAME).$(K8S_SERVICE_NAME).$(MY_POD_NAMESPACE)"},{"name":"K8S_HOSTNAME_SUFFIX","value":".$(K8S_SERVICE_NAME).$(MY_POD_NAMESPACE)"}],"resources":{"limits":{"cpu":"2","memory":"2Gi"},"requests":{"cpu":"1","memory":"2Gi"}},"volumeMounts":[{"name":"rabbitmq-erlang-cookie","mountPath":"/var/lib/rabbitmq/"},{"name":"persistence","mountPath":"/var/lib/rabbitmq/mnesia/"},{"name":"rabbitmq-plugins","mountPath":"/operator"},{"name":"rabbitmq-confd","mountPath":"/etc/rabbitmq/conf.d/10-operatorDefaults.conf","subPath":"operatorDefaults.conf"},{"name":"rabbitmq-confd","mountPath":"/etc/rabbitmq/conf.d/11-default_user.conf","subPath":"default_user.conf"},{"name":"rabbitmq-confd","mountPath":"/etc/rabbitmq/conf.d/90-userDefinedConfiguration.conf","subPath":"userDefinedConfiguration.conf"},{"name":"pod-info","mountPath":"/etc/pod-info/"}],"readinessProbe":{"tcpSocket":{"port":"amqp"},"initialDelaySeconds":10,"timeoutSeconds":5,"periodSeconds":10,"successThreshold":1,"failureThreshold":3},"lifecycle":{"preStop":{"exec":{"command":["/bin/bash","-c","if [ ! -z \"$(cat /etc/pod-info/skipPreStopChecks)\" ]; then exit 0; fi; rabbitmq-upgrade await_online_quorum_plus_one -t 604800; rabbitmq-upgrade await_online_synchronized_mirror -t 604800; rabbitmq-upgrade drain -t 604800"]}}},"terminationMessagePath":"/dev/termination-log","terminationMessagePolicy":"File","imagePullPolicy":"IfNotPresent"}],"restartPolicy":"Always","terminationGracePeriodSeconds":604800,"dnsPolicy":"ClusterFirst","serviceAccountName":"rabbitmq-cluster-server","serviceAccount":"rabbitmq-cluster-server","automountServiceAccountToken":true,"securityContext":{"runAsUser":999,"runAsGroup":999,"fsGroup":999},"schedulerName":"default-scheduler","topologySpreadConstraints":[{"maxSkew":1,"topologyKey":"topology.kubernetes.io/zone","whenUnsatisfiable":"ScheduleAnyway","labelSelector":{"matchLabels":{"app.kubernetes.io/name":"rabbitmq-cluster"}}}]}},"volumeClaimTemplates":[{"metadata":{"name":"persistence","namespace":"default","creationTimestamp":null,"labels":{"app.kubernetes.io/component":"rabbitmq","app.kubernetes.io/name":"rabbitmq-cluster","app.kubernetes.io/part-of":"rabbitmq"},"ownerReferences":[{"apiVersion":"rabbitmq.com/v1beta1","kind":"RabbitmqCluster","name":"rabbitmq-cluster","uid":"18d9928b-0d1c-47be-80ec-20960d053827","controller":true,"blockOwnerDeletion":false}]},"spec":{"accessModes":["ReadWriteOnce"],"resources":{"requests":{"storage":"10Gi"}},"volumeMode":"Filesystem"},"status":{"phase":"Pending"}}],"serviceName":"rabbitmq-cluster-nodes","podManagementPolicy":"Parallel","updateStrategy":{"type":"RollingUpdate","rollingUpdate":{"partition":0}},"revisionHistoryLimit":10},"status":{"observedGeneration":2,"replicas":3,"readyReplicas":1,"currentReplicas":3,"updatedReplicas":3,"currentRevision":"rabbitmq-cluster-server-5f8b8665fb","updateRevision":"rabbitmq-cluster-server-5f8b8665fb","collisionCount":0}}
2022/03/18 18:01:23 learn_server.go:291: [SIEVE-AFTER-READ]	Get	true	service	default	rabbitmq-cluster-nodes	github.com/rabbitmq/cluster-operator/controllers.(*RabbitmqClusterReconciler)	NoError	{"kind":"Service","apiVersion":"v1","metadata":{"name":"rabbitmq-cluster-nodes","namespace":"default","selfLink":"/api/v1/namespaces/default/services/rabbitmq-cluster-nodes","uid":"67c7eea9-1b87-4fd7-82e6-5bfe31fd1b52","resourceVersion":"696","creationTimestamp":"2022-03-18T18:00:38Z","labels":{"app.kubernetes.io/component":"rabbitmq","app.kubernetes.io/name":"rabbitmq-cluster","app.kubernetes.io/part-of":"rabbitmq"},"ownerReferences":[{"apiVersion":"rabbitmq.com/v1beta1","kind":"RabbitmqCluster","name":"rabbitmq-cluster","uid":"18d9928b-0d1c-47be-80ec-20960d053827","controller":true,"blockOwnerDeletion":true}],"managedFields":[{"manager":"manager","operation":"Update","apiVersion":"v1","time":"2022-03-18T18:00:38Z","fieldsType":"FieldsV1","fieldsV1":{"f:metadata":{"f:labels":{".":{},"f:app.kubernetes.io/component":{},"f:app.kubernetes.io/name":{},"f:app.kubernetes.io/part-of":{}},"f:ownerReferences":{".":{},"k:{\"uid\":\"18d9928b-0d1c-47be-80ec-20960d053827\"}":{".":{},"f:apiVersion":{},"f:blockOwnerDeletion":{},"f:controller":{},"f:kind":{},"f:name":{},"f:uid":{}}}},"f:spec":{"f:clusterIP":{},"f:ports":{".":{},"k:{\"port\":4369,\"protocol\":\"TCP\"}":{".":{},"f:name":{},"f:port":{},"f:protocol":{},"f:targetPort":{}},"k:{\"port\":25672,\"protocol\":\"TCP\"}":{".":{},"f:name":{},"f:port":{},"f:protocol":{},"f:targetPort":{}}},"f:publishNotReadyAddresses":{},"f:selector":{".":{},"f:app.kubernetes.io/name":{}},"f:sessionAffinity":{},"f:type":{}}}}]},"spec":{"ports":[{"name":"epmd","protocol":"TCP","port":4369,"targetPort":4369},{"name":"cluster-rpc","protocol":"TCP","port":25672,"targetPort":25672}],"selector":{"app.kubernetes.io/name":"rabbitmq-cluster"},"clusterIP":"None","type":"ClusterIP","sessionAffinity":"None","publishNotReadyAddresses":true},"status":{"loadBalancer":{}}}
2022/03/18 18:01:23 learn_server.go:291: [SIEVE-AFTER-READ]	Get	true	service	default	rabbitmq-cluster	github.com/rabbitmq/cluster-operator/controllers.(*RabbitmqClusterReconciler)	NoError	{"kind":"Service","apiVersion":"v1","metadata":{"name":"rabbitmq-cluster","namespace":"default","selfLink":"/api/v1/namespaces/default/services/rabbitmq-cluster","uid":"56b50671-1945-458b-adac-05619b783392","resourceVersion":"701","creationTimestamp":"2022-03-18T18:00:38Z","labels":{"app.kubernetes.io/component":"rabbitmq","app.kubernetes.io/name":"rabbitmq-cluster","app.kubernetes.io/part-of":"rabbitmq"},"ownerReferences":[{"apiVersion":"rabbitmq.com/v1beta1","kind":"RabbitmqCluster","name":"rabbitmq-cluster","uid":"18d9928b-0d1c-47be-80ec-20960d053827","controller":true,"blockOwnerDeletion":true}],"managedFields":[{"manager":"manager","operation":"Update","apiVersion":"v1","time":"2022-03-18T18:00:38Z","fieldsType":"FieldsV1","fieldsV1":{"f:metadata":{"f:labels":{".":{},"f:app.kubernetes.io/component":{},"f:app.kubernetes.io/name":{},"f:app.kubernetes.io/part-of":{}},"f:ownerReferences":{".":{},"k:{\"uid\":\"18d9928b-0d1c-47be-80ec-20960d053827\"}":{".":{},"f:apiVersion":{},"f:blockOwnerDeletion":{},"f:controller":{},"f:kind":{},"f:name":{},"f:uid":{}}}},"f:spec":{"f:ports":{".":{},"k:{\"port\":5672,\"protocol\":\"TCP\"}":{".":{},"f:name":{},"f:port":{},"f:protocol":{},"f:targetPort":{}},"k:{\"port\":15672,\"protocol\":\"TCP\"}":{".":{},"f:name":{},"f:port":{},"f:protocol":{},"f:targetPort":{}}},"f:selector":{".":{},"f:app.kubernetes.io/name":{}},"f:sessionAffinity":{},"f:type":{}}}}]},"spec":{"ports":[{"name":"amqp","protocol":"TCP","port":5672,"targetPort":5672},{"name":"management","protocol":"TCP","port":15672,"targetPort":15672}],"selector":{"app.kubernetes.io/name":"rabbitmq-cluster"},"clusterIP":"10.96.254.158","type":"ClusterIP","sessionAffinity":"None"},"status":{"loadBalancer":{}}}
2022/03/18 18:01:23 learn_server.go:291: [SIEVE-AFTER-READ]	Get	true	secret	default	rabbitmq-cluster-erlang-cookie	github.com/rabbitmq/cluster-operator/controllers.(*RabbitmqClusterReconciler)	NoError	{"kind":"Secret","apiVersion":"v1","metadata":{"name":"rabbitmq-cluster-erlang-cookie","namespace":"default","selfLink":"/api/v1/namespaces/default/secrets/rabbitmq-cluster-erlang-cookie","uid":"f8fbe8a6-0f40-4e13-960b-ab78b8ba75b0","resourceVersion":"705","creationTimestamp":"2022-03-18T18:00:38Z","labels":{"app.kubernetes.io/component":"rabbitmq","app.kubernetes.io/name":"rabbitmq-cluster","app.kubernetes.io/part-of":"rabbitmq"},"ownerReferences":[{"apiVersion":"rabbitmq.com/v1beta1","kind":"RabbitmqCluster","name":"rabbitmq-cluster","uid":"18d9928b-0d1c-47be-80ec-20960d053827","controller":true,"blockOwnerDeletion":true}],"managedFields":[{"manager":"manager","operation":"Update","apiVersion":"v1","time":"2022-03-18T18:00:38Z","fieldsType":"FieldsV1","fieldsV1":{"f:data":{".":{},"f:.erlang.cookie":{}},"f:metadata":{"f:labels":{".":{},"f:app.kubernetes.io/component":{},"f:app.kubernetes.io/name":{},"f:app.kubernetes.io/part-of":{}},"f:ownerReferences":{".":{},"k:{\"uid\":\"18d9928b-0d1c-47be-80ec-20960d053827\"}":{".":{},"f:apiVersion":{},"f:blockOwnerDeletion":{},"f:controller":{},"f:kind":{},"f:name":{},"f:uid":{}}}},"f:type":{}}}]},"data":{".erlang.cookie":"QW9hMkpWU0tlYS1FUGdWTUhrelNMNnFoMFZ0ZmRGNUY="},"type":"Opaque"}
2022/03/18 18:01:23 learn_server.go:291: [SIEVE-AFTER-READ]	Get	true	secret	default	rabbitmq-cluster-default-user	github.com/rabbitmq/cluster-operator/controllers.(*RabbitmqClusterReconciler)	NoError	{"kind":"Secret","apiVersion":"v1","metadata":{"name":"rabbitmq-cluster-default-user","namespace":"default","selfLink":"/api/v1/namespaces/default/secrets/rabbitmq-cluster-default-user","uid":"0d9f460b-a23c-402b-8273-f541ed39023f","resourceVersion":"708","creationTimestamp":"2022-03-18T18:00:38Z","labels":{"app.kubernetes.io/component":"rabbitmq","app.kubernetes.io/name":"rabbitmq-cluster","app.kubernetes.io/part-of":"rabbitmq"},"ownerReferences":[{"apiVersion":"rabbitmq.com/v1beta1","kind":"RabbitmqCluster","name":"rabbitmq-cluster","uid":"18d9928b-0d1c-47be-80ec-20960d053827","controller":true,"blockOwnerDeletion":true}],"managedFields":[{"manager":"manager","operation":"Update","apiVersion":"v1","time":"2022-03-18T18:00:38Z","fieldsType":"FieldsV1","fieldsV1":{"f:data":{".":{},"f:default_user.conf":{},"f:password":{},"f:provider":{},"f:type":{},"f:username":{}},"f:metadata":{"f:labels":{".":{},"f:app.kubernetes.io/component":{},"f:app.kubernetes.io/name":{},"f:app.kubernetes.io/part-of":{}},"f:ownerReferences":{".":{},"k:{\"uid\":\"18d9928b-0d1c-47be-80ec-20960d053827\"}":{".":{},"f:apiVersion":{},"f:blockOwnerDeletion":{},"f:controller":{},"f:kind":{},"f:name":{},"f:uid":{}}}},"f:type":{}}}]},"data":{"default_user.conf":"ZGVmYXVsdF91c2VyID0gcTMxRmh3MGtjWW9SZUl5X3BPTXp2ZVBOUnNVU3I1Mk8KZGVmYXVsdF9wYXNzID0gY0dBX19jNTJHX05hVURpTGhraWZ6UDBOVVlNLTE2MWQK","password":"Y0dBX19jNTJHX05hVURpTGhraWZ6UDBOVVlNLTE2MWQ=","provider":"cmFiYml0bXE=","type":"cmFiYml0bXE=","username":"cTMxRmh3MGtjWW9SZUl5X3BPTXp2ZVBOUnNVU3I1Mk8="},"type":"Opaque"}
2022/03/18 18:01:23 learn_server.go:291: [SIEVE-AFTER-READ]	Get	true	configmap	default	rabbitmq-cluster-plugins-conf	github.com/rabbitmq/cluster-operator/controllers.(*RabbitmqClusterReconciler)	NoError	{"kind":"ConfigMap","apiVersion":"v1","metadata":{"name":"rabbitmq-cluster-plugins-conf","namespace":"default","selfLink":"/api/v1/namespaces/default/configmaps/rabbitmq-cluster-plugins-conf","uid":"a164075b-0562-47ac-a577-99aa8651ec40","resourceVersion":"709","creationTimestamp":"2022-03-18T18:00:38Z","labels":{"app.kubernetes.io/component":"rabbitmq","app.kubernetes.io/name":"rabbitmq-cluster","app.kubernetes.io/part-of":"rabbitmq"},"ownerReferences":[{"apiVersion":"rabbitmq.com/v1beta1","kind":"RabbitmqCluster","name":"rabbitmq-cluster","uid":"18d9928b-0d1c-47be-80ec-20960d053827","controller":true,"blockOwnerDeletion":true}],"managedFields":[{"manager":"manager","operation":"Update","apiVersion":"v1","time":"2022-03-18T18:00:38Z","fieldsType":"FieldsV1","fieldsV1":{"f:data":{".":{},"f:enabled_plugins":{}},"f:metadata":{"f:labels":{".":{},"f:app.kubernetes.io/component":{},"f:app.kubernetes.io/name":{},"f:app.kubernetes.io/part-of":{}},"f:ownerReferences":{".":{},"k:{\"uid\":\"18d9928b-0d1c-47be-80ec-20960d053827\"}":{".":{},"f:apiVersion":{},"f:blockOwnerDeletion":{},"f:controller":{},"f:kind":{},"f:name":{},"f:uid":{}}}}}}]},"data":{"enabled_plugins":"[rabbitmq_peer_discovery_k8s,rabbitmq_prometheus,rabbitmq_management]."}}
2022/03/18 18:01:23 learn_server.go:291: [SIEVE-AFTER-READ]	Get	true	configmap	default	rabbitmq-cluster-server-conf	github.com/rabbitmq/cluster-operator/controllers.(*RabbitmqClusterReconciler)	NoError	{"kind":"ConfigMap","apiVersion":"v1","metadata":{"name":"rabbitmq-cluster-server-conf","namespace":"default","selfLink":"/api/v1/namespaces/default/configmaps/rabbitmq-cluster-server-conf","uid":"22474f2b-8454-44b7-8079-8990223969cc","resourceVersion":"714","creationTimestamp":"2022-03-18T18:00:38Z","labels":{"app.kubernetes.io/component":"rabbitmq","app.kubernetes.io/name":"rabbitmq-cluster","app.kubernetes.io/part-of":"rabbitmq"},"ownerReferences":[{"apiVersion":"rabbitmq.com/v1beta1","kind":"RabbitmqCluster","name":"rabbitmq-cluster","uid":"18d9928b-0d1c-47be-80ec-20960d053827","controller":true,"blockOwnerDeletion":true}],"managedFields":[{"manager":"manager","operation":"Update","apiVersion":"v1","time":"2022-03-18T18:00:38Z","fieldsType":"FieldsV1","fieldsV1":{"f:data":{".":{},"f:operatorDefaults.conf":{},"f:userDefinedConfiguration.conf":{}},"f:metadata":{"f:labels":{".":{},"f:app.kubernetes.io/component":{},"f:app.kubernetes.io/name":{},"f:app.kubernetes.io/part-of":{}},"f:ownerReferences":{".":{},"k:{\"uid\":\"18d9928b-0d1c-47be-80ec-20960d053827\"}":{".":{},"f:apiVersion":{},"f:blockOwnerDeletion":{},"f:controller":{},"f:kind":{},"f:name":{},"f:uid":{}}}}}}]},"data":{"operatorDefaults.conf":"cluster_formation.peer_discovery_backend             = rabbit_peer_discovery_k8s\ncluster_formation.k8s.host                           = kubernetes.default\ncluster_formation.k8s.address_type                   = hostname\ncluster_partition_handling                           = pause_minority\nqueue_master_locator                                 = min-masters\ndisk_free_limit.absolute                             = 2GB\ncluster_formation.randomized_startup_delay_range.min = 5\ncluster_formation.randomized_startup_delay_range.max = 30\ncluster_name                                         = rabbitmq-cluster\n","userDefinedConfiguration.conf":"total_memory_available_override_value = 1717986919\n"}}
2022/03/18 18:01:23 learn_server.go:291: [SIEVE-AFTER-READ]	Get	true	serviceaccount	default	rabbitmq-cluster-server	github.com/rabbitmq/cluster-operator/controllers.(*RabbitmqClusterReconciler)	NoError	{"kind":"ServiceAccount","apiVersion":"v1","metadata":{"name":"rabbitmq-cluster-server","namespace":"default","selfLink":"/api/v1/namespaces/default/serviceaccounts/rabbitmq-cluster-server","uid":"731589b5-ac97-4774-bee4-008949b54734","resourceVersion":"722","creationTimestamp":"2022-03-18T18:00:38Z","labels":{"app.kubernetes.io/component":"rabbitmq","app.kubernetes.io/name":"rabbitmq-cluster","app.kubernetes.io/part-of":"rabbitmq"},"ownerReferences":[{"apiVersion":"rabbitmq.com/v1beta1","kind":"RabbitmqCluster","name":"rabbitmq-cluster","uid":"18d9928b-0d1c-47be-80ec-20960d053827","controller":true,"blockOwnerDeletion":true}],"managedFields":[{"manager":"kube-controller-manager","operation":"Update","apiVersion":"v1","time":"2022-03-18T18:00:38Z","fieldsType":"FieldsV1","fieldsV1":{"f:secrets":{".":{},"k:{\"name\":\"rabbitmq-cluster-server-token-rhzq9\"}":{".":{},"f:name":{}}}}},{"manager":"manager","operation":"Update","apiVersion":"v1","time":"2022-03-18T18:00:38Z","fieldsType":"FieldsV1","fieldsV1":{"f:metadata":{"f:labels":{".":{},"f:app.kubernetes.io/component":{},"f:app.kubernetes.io/name":{},"f:app.kubernetes.io/part-of":{}},"f:ownerReferences":{".":{},"k:{\"uid\":\"18d9928b-0d1c-47be-80ec-20960d053827\"}":{".":{},"f:apiVersion":{},"f:blockOwnerDeletion":{},"f:controller":{},"f:kind":{},"f:name":{},"f:uid":{}}}}}}]},"secrets":[{"name":"rabbitmq-cluster-server-token-rhzq9"}]}
2022/03/18 18:01:23 learn_server.go:291: [SIEVE-AFTER-READ]	Get	true	role	default	rabbitmq-cluster-peer-discovery	github.com/rabbitmq/cluster-operator/controllers.(*RabbitmqClusterReconciler)	NoError	{"kind":"Role","apiVersion":"rbac.authorization.k8s.io/v1","metadata":{"name":"rabbitmq-cluster-peer-discovery","namespace":"default","selfLink":"/apis/rbac.authorization.k8s.io/v1/namespaces/default/roles/rabbitmq-cluster-peer-discovery","uid":"52c80b50-4fdd-4089-bbfd-9756465953f2","resourceVersion":"723","creationTimestamp":"2022-03-18T18:00:38Z","labels":{"app.kubernetes.io/component":"rabbitmq","app.kubernetes.io/name":"rabbitmq-cluster","app.kubernetes.io/part-of":"rabbitmq"},"ownerReferences":[{"apiVersion":"rabbitmq.com/v1beta1","kind":"RabbitmqCluster","name":"rabbitmq-cluster","uid":"18d9928b-0d1c-47be-80ec-20960d053827","controller":true,"blockOwnerDeletion":true}],"managedFields":[{"manager":"manager","operation":"Update","apiVersion":"rbac.authorization.k8s.io/v1","time":"2022-03-18T18:00:38Z","fieldsType":"FieldsV1","fieldsV1":{"f:metadata":{"f:labels":{".":{},"f:app.kubernetes.io/component":{},"f:app.kubernetes.io/name":{},"f:app.kubernetes.io/part-of":{}},"f:ownerReferences":{".":{},"k:{\"uid\":\"18d9928b-0d1c-47be-80ec-20960d053827\"}":{".":{},"f:apiVersion":{},"f:blockOwnerDeletion":{},"f:controller":{},"f:kind":{},"f:name":{},"f:uid":{}}}},"f:rules":{}}}]},"rules":[{"verbs":["get"],"apiGroups":[""],"resources":["endpoints"]},{"verbs":["create"],"apiGroups":[""],"resources":["events"]}]}
2022/03/18 18:01:23 learn_server.go:291: [SIEVE-AFTER-READ]	Get	true	rolebinding	default	rabbitmq-cluster-server	github.com/rabbitmq/cluster-operator/controllers.(*RabbitmqClusterReconciler)	NoError	{"kind":"RoleBinding","apiVersion":"rbac.authorization.k8s.io/v1","metadata":{"name":"rabbitmq-cluster-server","namespace":"default","selfLink":"/apis/rbac.authorization.k8s.io/v1/namespaces/default/rolebindings/rabbitmq-cluster-server","uid":"495e9f7c-a20d-4515-86b0-34149a855034","resourceVersion":"725","creationTimestamp":"2022-03-18T18:00:38Z","labels":{"app.kubernetes.io/component":"rabbitmq","app.kubernetes.io/name":"rabbitmq-cluster","app.kubernetes.io/part-of":"rabbitmq"},"ownerReferences":[{"apiVersion":"rabbitmq.com/v1beta1","kind":"RabbitmqCluster","name":"rabbitmq-cluster","uid":"18d9928b-0d1c-47be-80ec-20960d053827","controller":true,"blockOwnerDeletion":true}],"managedFields":[{"manager":"manager","operation":"Update","apiVersion":"rbac.authorization.k8s.io/v1","time":"2022-03-18T18:00:38Z","fieldsType":"FieldsV1","fieldsV1":{"f:metadata":{"f:labels":{".":{},"f:app.kubernetes.io/component":{},"f:app.kubernetes.io/name":{},"f:app.kubernetes.io/part-of":{}},"f:ownerReferences":{".":{},"k:{\"uid\":\"18d9928b-0d1c-47be-80ec-20960d053827\"}":{".":{},"f:apiVersion":{},"f:blockOwnerDeletion":{},"f:controller":{},"f:kind":{},"f:name":{},"f:uid":{}}}},"f:roleRef":{"f:apiGroup":{},"f:kind":{},"f:name":{}},"f:subjects":{}}}]},"subjects":[{"kind":"ServiceAccount","name":"rabbitmq-cluster-server"}],"roleRef":{"apiGroup":"rbac.authorization.k8s.io","kind":"Role","name":"rabbitmq-cluster-peer-discovery"}}
2022/03/18 18:01:23 learn_server.go:291: [SIEVE-AFTER-READ]	Get	true	statefulset	default	rabbitmq-cluster-server	github.com/rabbitmq/cluster-operator/controllers.(*RabbitmqClusterReconciler)	NoError	{"kind":"StatefulSet","apiVersion":"apps/v1","metadata":{"name":"rabbitmq-cluster-server","namespace":"default","selfLink":"/apis/apps/v1/namespaces/default/statefulsets/rabbitmq-cluster-server","uid":"cb5c43bc-6ee7-481c-ab01-6f3acffdd3c8","resourceVersion":"989","generation":2,"creationTimestamp":"2022-03-18T18:00:38Z","labels":{"app.kubernetes.io/component":"rabbitmq","app.kubernetes.io/name":"rabbitmq-cluster","app.kubernetes.io/part-of":"rabbitmq"},"ownerReferences":[{"apiVersion":"rabbitmq.com/v1beta1","kind":"RabbitmqCluster","name":"rabbitmq-cluster","uid":"18d9928b-0d1c-47be-80ec-20960d053827","controller":true,"blockOwnerDeletion":true}],"managedFields":[{"manager":"kube-controller-manager","operation":"Update","apiVersion":"apps/v1","time":"2022-03-18T18:01:23Z","fieldsType":"FieldsV1","fieldsV1":{"f:status":{"f:collisionCount":{},"f:currentReplicas":{},"f:currentRevision":{},"f:observedGeneration":{},"f:readyReplicas":{},"f:replicas":{},"f:updateRevision":{},"f:updatedReplicas":{}}}},{"manager":"manager","operation":"Update","apiVersion":"apps/v1","time":"2022-03-18T18:01:23Z","fieldsType":"FieldsV1","fieldsV1":{"f:metadata":{"f:labels":{".":{},"f:app.kubernetes.io/component":{},"f:app.kubernetes.io/name":{},"f:app.kubernetes.io/part-of":{}},"f:ownerReferences":{".":{},"k:{\"uid\":\"18d9928b-0d1c-47be-80ec-20960d053827\"}":{".":{},"f:apiVersion":{},"f:blockOwnerDeletion":{},"f:controller":{},"f:kind":{},"f:name":{},"f:uid":{}}}},"f:spec":{"f:podManagementPolicy":{},"f:replicas":{},"f:revisionHistoryLimit":{},"f:selector":{"f:matchLabels":{".":{},"f:app.kubernetes.io/name":{}}},"f:serviceName":{},"f:template":{"f:metadata":{"f:annotations":{".":{},"f:prometheus.io/port":{},"f:prometheus.io/scrape":{}},"f:labels":{".":{},"f:app.kubernetes.io/component":{},"f:app.kubernetes.io/name":{},"f:app.kubernetes.io/part-of":{}}},"f:spec":{"f:automountServiceAccountToken":{},"f:containers":{"k:{\"name\":\"rabbitmq\"}":{".":{},"f:env":{".":{},"k:{\"name\":\"K8S_HOSTNAME_SUFFIX\"}":{".":{},"f:name":{},"f:value":{}},"k:{\"name\":\"K8S_SERVICE_NAME\"}":{".":{},"f:name":{},"f:value":{}},"k:{\"name\":\"MY_POD_NAME\"}":{".":{},"f:name":{},"f:valueFrom":{".":{},"f:fieldRef":{".":{},"f:apiVersion":{},"f:fieldPath":{}}}},"k:{\"name\":\"MY_POD_NAMESPACE\"}":{".":{},"f:name":{},"f:valueFrom":{".":{},"f:fieldRef":{".":{},"f:apiVersion":{},"f:fieldPath":{}}}},"k:{\"name\":\"RABBITMQ_ENABLED_PLUGINS_FILE\"}":{".":{},"f:name":{},"f:value":{}},"k:{\"name\":\"RABBITMQ_NODENAME\"}":{".":{},"f:name":{},"f:value":{}},"k:{\"name\":\"RABBITMQ_USE_LONGNAME\"}":{".":{},"f:name":{},"f:value":{}}},"f:image":{},"f:imagePullPolicy":{},"f:lifecycle":{".":{},"f:preStop":{".":{},"f:exec":{".":{},"f:command":{}}}},"f:name":{},"f:ports":{".":{},"k:{\"containerPort\":4369,\"protocol\":\"TCP\"}":{".":{},"f:containerPort":{},"f:name":{},"f:protocol":{}},"k:{\"containerPort\":5672,\"protocol\":\"TCP\"}":{".":{},"f:containerPort":{},"f:name":{},"f:protocol":{}},"k:{\"containerPort\":15672,\"protocol\":\"TCP\"}":{".":{},"f:containerPort":{},"f:name":{},"f:protocol":{}},"k:{\"containerPort\":15692,\"protocol\":\"TCP\"}":{".":{},"f:containerPort":{},"f:name":{},"f:protocol":{}}},"f:readinessProbe":{".":{},"f:failureThreshold":{},"f:initialDelaySeconds":{},"f:periodSeconds":{},"f:successThreshold":{},"f:tcpSocket":{".":{},"f:port":{}},"f:timeoutSeconds":{}},"f:resources":{".":{},"f:limits":{".":{},"f:cpu":{},"f:memory":{}},"f:requests":{".":{},"f:cpu":{},"f:memory":{}}},"f:terminationMessagePath":{},"f:terminationMessagePolicy":{},"f:volumeMounts":{".":{},"k:{\"mountPath\":\"/etc/pod-info/\"}":{".":{},"f:mountPath":{},"f:name":{}},"k:{\"mountPath\":\"/etc/rabbitmq/conf.d/10-operatorDefaults.conf\"}":{".":{},"f:mountPath":{},"f:name":{},"f:subPath":{}},"k:{\"mountPath\":\"/etc/rabbitmq/conf.d/11-default_user.conf\"}":{".":{},"f:mountPath":{},"f:name":{},"f:subPath":{}},"k:{\"mountPath\":\"/etc/rabbitmq/conf.d/90-userDefinedConfiguration.conf\"}":{".":{},"f:mountPath":{},"f:name":{},"f:subPath":{}},"k:{\"mountPath\":\"/operator\"}":{".":{},"f:mountPath":{},"f:name":{}},"k:{\"mountPath\":\"/var/lib/rabbitmq/\"}":{".":{},"f:mountPath":{},"f:name":{}},"k:{\"mountPath\":\"/var/lib/rabbitmq/mnesia/\"}":{".":{},"f:mountPath":{},"f:name":{}}}}},"f:dnsPolicy":{},"f:initContainers":{".":{},"k:{\"name\":\"setup-container\"}":{".":{},"f:command":{},"f:image":{},"f:imagePullPolicy":{},"f:name":{},"f:resources":{".":{},"f:limits":{".":{},"f:cpu":{},"f:memory":{}},"f:requests":{".":{},"f:cpu":{},"f:memory":{}}},"f:securityContext":{".":{},"f:capabilities":{".":{},"f:drop":{}},"f:runAsUser":{}},"f:terminationMessagePath":{},"f:terminationMessagePolicy":{},"f:volumeMounts":{".":{},"k:{\"mountPath\":\"/operator\"}":{".":{},"f:mountPath":{},"f:name":{}},"k:{\"mountPath\":\"/tmp/default_user.conf\"}":{".":{},"f:mountPath":{},"f:name":{},"f:subPath":{}},"k:{\"mountPath\":\"/tmp/erlang-cookie-secret/\"}":{".":{},"f:mountPath":{},"f:name":{}},"k:{\"mountPath\":\"/tmp/rabbitmq-plugins/\"}":{".":{},"f:mountPath":{},"f:name":{}},"k:{\"mountPath\":\"/var/lib/rabbitmq/\"}":{".":{},"f:mountPath":{},"f:name":{}},"k:{\"mountPath\":\"/var/lib/rabbitmq/mnesia/\"}":{".":{},"f:mountPath":{},"f:name":{}}}}},"f:restartPolicy":{},"f:schedulerName":{},"f:securityContext":{".":{},"f:fsGroup":{},"f:runAsGroup":{},"f:runAsUser":{}},"f:serviceAccount":{},"f:serviceAccountName":{},"f:terminationGracePeriodSeconds":{},"f:topologySpreadConstraints":{".":{},"k:{\"topologyKey\":\"topology.kubernetes.io/zone\",\"whenUnsatisfiable\":\"ScheduleAnyway\"}":{".":{},"f:labelSelector":{".":{},"f:matchLabels":{".":{},"f:app.kubernetes.io/name":{}}},"f:maxSkew":{},"f:topologyKey":{},"f:whenUnsatisfiable":{}}},"f:volumes":{".":{},"k:{\"name\":\"erlang-cookie-secret\"}":{".":{},"f:name":{},"f:secret":{".":{},"f:defaultMode":{},"f:secretName":{}}},"k:{\"name\":\"plugins-conf\"}":{".":{},"f:configMap":{".":{},"f:defaultMode":{},"f:name":{}},"f:name":{}},"k:{\"name\":\"pod-info\"}":{".":{},"f:downwardAPI":{".":{},"f:defaultMode":{},"f:items":{}},"f:name":{}},"k:{\"name\":\"rabbitmq-confd\"}":{".":{},"f:name":{},"f:projected":{".":{},"f:defaultMode":{},"f:sources":{}}},"k:{\"name\":\"rabbitmq-erlang-cookie\"}":{".":{},"f:emptyDir":{},"f:name":{}},"k:{\"name\":\"rabbitmq-plugins\"}":{".":{},"f:emptyDir":{},"f:name":{}}}}},"f:updateStrategy":{"f:rollingUpdate":{".":{},"f:partition":{}},"f:type":{}},"f:volumeClaimTemplates":{}}}}]},"spec":{"replicas":3,"selector":{"matchLabels":{"app.kubernetes.io/name":"rabbitmq-cluster"}},"template":{"metadata":{"creationTimestamp":null,"labels":{"app.kubernetes.io/component":"rabbitmq","app.kubernetes.io/name":"rabbitmq-cluster","app.kubernetes.io/part-of":"rabbitmq"},"annotations":{"prometheus.io/port":"15692","prometheus.io/scrape":"true"}},"spec":{"volumes":[{"name":"plugins-conf","configMap":{"name":"rabbitmq-cluster-plugins-conf","defaultMode":420}},{"name":"rabbitmq-confd","projected":{"sources":[{"secret":{"name":"rabbitmq-cluster-default-user","items":[{"key":"default_user.conf","path":"default_user.conf"}]}},{"configMap":{"name":"rabbitmq-cluster-server-conf","items":[{"key":"operatorDefaults.conf","path":"operatorDefaults.conf"},{"key":"userDefinedConfiguration.conf","path":"userDefinedConfiguration.conf"}]}}],"defaultMode":420}},{"name":"rabbitmq-erlang-cookie","emptyDir":{}},{"name":"erlang-cookie-secret","secret":{"secretName":"rabbitmq-cluster-erlang-cookie","defaultMode":420}},{"name":"rabbitmq-plugins","emptyDir":{}},{"name":"pod-info","downwardAPI":{"items":[{"path":"skipPreStopChecks","fieldRef":{"apiVersion":"v1","fieldPath":"metadata.labels['skipPreStopChecks']"}}],"defaultMode":420}}],"initContainers":[{"name":"setup-container","image":"rabbitmq:3.8.12-management","command":["sh","-c","cp /tmp/erlang-cookie-secret/.erlang.cookie /var/lib/rabbitmq/.erlang.cookie \u0026\u0026 chown 999:999 /var/lib/rabbitmq/.erlang.cookie \u0026\u0026 chmod 600 /var/lib/rabbitmq/.erlang.cookie ; cp /tmp/rabbitmq-plugins/enabled_plugins /operator/enabled_plugins \u0026\u0026 chown 999:999 /operator/enabled_plugins ; chown 999:999 /var/lib/rabbitmq/mnesia/ ; echo '[default]' \u003e /var/lib/rabbitmq/.rabbitmqadmin.conf \u0026\u0026 sed -e 's/default_user/username/' -e 's/default_pass/password/' /tmp/default_user.conf \u003e\u003e /var/lib/rabbitmq/.rabbitmqadmin.conf \u0026\u0026 chown 999:999 /var/lib/rabbitmq/.rabbitmqadmin.conf \u0026\u0026 chmod 600 /var/lib/rabbitmq/.rabbitmqadmin.conf"],"resources":{"limits":{"cpu":"100m","memory":"500Mi"},"requests":{"cpu":"100m","memory":"500Mi"}},"volumeMounts":[{"name":"plugins-conf","mountPath":"/tmp/rabbitmq-plugins/"},{"name":"rabbitmq-erlang-cookie","mountPath":"/var/lib/rabbitmq/"},{"name":"erlang-cookie-secret","mountPath":"/tmp/erlang-cookie-secret/"},{"name":"rabbitmq-plugins","mountPath":"/operator"},{"name":"persistence","mountPath":"/var/lib/rabbitmq/mnesia/"},{"name":"rabbitmq-confd","mountPath":"/tmp/default_user.conf","subPath":"default_user.conf"}],"terminationMessagePath":"/dev/termination-log","terminationMessagePolicy":"File","imagePullPolicy":"IfNotPresent","securityContext":{"capabilities":{"drop":["FSETID","KILL","SETGID","SETUID","SETPCAP","NET_BIND_SERVICE","NET_RAW","SYS_CHROOT","MKNOD","AUDIT_WRITE","SETFCAP"]},"runAsUser":0}}],"containers":[{"name":"rabbitmq","image":"rabbitmq:3.8.12-management","ports":[{"name":"epmd","containerPort":4369,"protocol":"TCP"},{"name":"amqp","containerPort":5672,"protocol":"TCP"},{"name":"management","containerPort":15672,"protocol":"TCP"},{"name":"prometheus","containerPort":15692,"protocol":"TCP"}],"env":[{"name":"MY_POD_NAME","valueFrom":{"fieldRef":{"apiVersion":"v1","fieldPath":"metadata.name"}}},{"name":"MY_POD_NAMESPACE","valueFrom":{"fieldRef":{"apiVersion":"v1","fieldPath":"metadata.namespace"}}},{"name":"RABBITMQ_ENABLED_PLUGINS_FILE","value":"/operator/enabled_plugins"},{"name":"K8S_SERVICE_NAME","value":"rabbitmq-cluster-nodes"},{"name":"RABBITMQ_USE_LONGNAME","value":"true"},{"name":"RABBITMQ_NODENAME","value":"rabbit@$(MY_POD_NAME).$(K8S_SERVICE_NAME).$(MY_POD_NAMESPACE)"},{"name":"K8S_HOSTNAME_SUFFIX","value":".$(K8S_SERVICE_NAME).$(MY_POD_NAMESPACE)"}],"resources":{"limits":{"cpu":"2","memory":"2Gi"},"requests":{"cpu":"1","memory":"2Gi"}},"volumeMounts":[{"name":"rabbitmq-erlang-cookie","mountPath":"/var/lib/rabbitmq/"},{"name":"persistence","mountPath":"/var/lib/rabbitmq/mnesia/"},{"name":"rabbitmq-plugins","mountPath":"/operator"},{"name":"rabbitmq-confd","mountPath":"/etc/rabbitmq/conf.d/10-operatorDefaults.conf","subPath":"operatorDefaults.conf"},{"name":"rabbitmq-confd","mountPath":"/etc/rabbitmq/conf.d/11-default_user.conf","subPath":"default_user.conf"},{"name":"rabbitmq-confd","mountPath":"/etc/rabbitmq/conf.d/90-userDefinedConfiguration.conf","subPath":"userDefinedConfiguration.conf"},{"name":"pod-info","mountPath":"/etc/pod-info/"}],"readinessProbe":{"tcpSocket":{"port":"amqp"},"initialDelaySeconds":10,"timeoutSeconds":5,"periodSeconds":10,"successThreshold":1,"failureThreshold":3},"lifecycle":{"preStop":{"exec":{"command":["/bin/bash","-c","if [ ! -z \"$(cat /etc/pod-info/skipPreStopChecks)\" ]; then exit 0; fi; rabbitmq-upgrade await_online_quorum_plus_one -t 604800; rabbitmq-upgrade await_online_synchronized_mirror -t 604800; rabbitmq-upgrade drain -t 604800"]}}},"terminationMessagePath":"/dev/termination-log","terminationMessagePolicy":"File","imagePullPolicy":"IfNotPresent"}],"restartPolicy":"Always","terminationGracePeriodSeconds":604800,"dnsPolicy":"ClusterFirst","serviceAccountName":"rabbitmq-cluster-server","serviceAccount":"rabbitmq-cluster-server","automountServiceAccountToken":true,"securityContext":{"runAsUser":999,"runAsGroup":999,"fsGroup":999},"schedulerName":"default-scheduler","topologySpreadConstraints":[{"maxSkew":1,"topologyKey":"topology.kubernetes.io/zone","whenUnsatisfiable":"ScheduleAnyway","labelSelector":{"matchLabels":{"app.kubernetes.io/name":"rabbitmq-cluster"}}}]}},"volumeClaimTemplates":[{"metadata":{"name":"persistence","namespace":"default","creationTimestamp":null,"labels":{"app.kubernetes.io/component":"rabbitmq","app.kubernetes.io/name":"rabbitmq-cluster","app.kubernetes.io/part-of":"rabbitmq"},"ownerReferences":[{"apiVersion":"rabbitmq.com/v1beta1","kind":"RabbitmqCluster","name":"rabbitmq-cluster","uid":"18d9928b-0d1c-47be-80ec-20960d053827","controller":true,"blockOwnerDeletion":false}]},"spec":{"accessModes":["ReadWriteOnce"],"resources":{"requests":{"storage":"10Gi"}},"volumeMode":"Filesystem"},"status":{"phase":"Pending"}}],"serviceName":"rabbitmq-cluster-nodes","podManagementPolicy":"Parallel","updateStrategy":{"type":"RollingUpdate","rollingUpdate":{"partition":0}},"revisionHistoryLimit":10},"status":{"observedGeneration":2,"replicas":3,"readyReplicas":1,"currentReplicas":3,"updatedReplicas":3,"currentRevision":"rabbitmq-cluster-server-5f8b8665fb","updateRevision":"rabbitmq-cluster-server-5f8b8665fb","collisionCount":0}}
2022/03/18 18:01:23 learn_server.go:291: [SIEVE-AFTER-READ]	Get	true	statefulset	default	rabbitmq-cluster-server	github.com/rabbitmq/cluster-operator/controllers.(*RabbitmqClusterReconciler)	NoError	{"kind":"StatefulSet","apiVersion":"apps/v1","metadata":{"name":"rabbitmq-cluster-server","namespace":"default","selfLink":"/apis/apps/v1/namespaces/default/statefulsets/rabbitmq-cluster-server","uid":"cb5c43bc-6ee7-481c-ab01-6f3acffdd3c8","resourceVersion":"989","generation":2,"creationTimestamp":"2022-03-18T18:00:38Z","labels":{"app.kubernetes.io/component":"rabbitmq","app.kubernetes.io/name":"rabbitmq-cluster","app.kubernetes.io/part-of":"rabbitmq"},"ownerReferences":[{"apiVersion":"rabbitmq.com/v1beta1","kind":"RabbitmqCluster","name":"rabbitmq-cluster","uid":"18d9928b-0d1c-47be-80ec-20960d053827","controller":true,"blockOwnerDeletion":true}],"managedFields":[{"manager":"kube-controller-manager","operation":"Update","apiVersion":"apps/v1","time":"2022-03-18T18:01:23Z","fieldsType":"FieldsV1","fieldsV1":{"f:status":{"f:collisionCount":{},"f:currentReplicas":{},"f:currentRevision":{},"f:observedGeneration":{},"f:readyReplicas":{},"f:replicas":{},"f:updateRevision":{},"f:updatedReplicas":{}}}},{"manager":"manager","operation":"Update","apiVersion":"apps/v1","time":"2022-03-18T18:01:23Z","fieldsType":"FieldsV1","fieldsV1":{"f:metadata":{"f:labels":{".":{},"f:app.kubernetes.io/component":{},"f:app.kubernetes.io/name":{},"f:app.kubernetes.io/part-of":{}},"f:ownerReferences":{".":{},"k:{\"uid\":\"18d9928b-0d1c-47be-80ec-20960d053827\"}":{".":{},"f:apiVersion":{},"f:blockOwnerDeletion":{},"f:controller":{},"f:kind":{},"f:name":{},"f:uid":{}}}},"f:spec":{"f:podManagementPolicy":{},"f:replicas":{},"f:revisionHistoryLimit":{},"f:selector":{"f:matchLabels":{".":{},"f:app.kubernetes.io/name":{}}},"f:serviceName":{},"f:template":{"f:metadata":{"f:annotations":{".":{},"f:prometheus.io/port":{},"f:prometheus.io/scrape":{}},"f:labels":{".":{},"f:app.kubernetes.io/component":{},"f:app.kubernetes.io/name":{},"f:app.kubernetes.io/part-of":{}}},"f:spec":{"f:automountServiceAccountToken":{},"f:containers":{"k:{\"name\":\"rabbitmq\"}":{".":{},"f:env":{".":{},"k:{\"name\":\"K8S_HOSTNAME_SUFFIX\"}":{".":{},"f:name":{},"f:value":{}},"k:{\"name\":\"K8S_SERVICE_NAME\"}":{".":{},"f:name":{},"f:value":{}},"k:{\"name\":\"MY_POD_NAME\"}":{".":{},"f:name":{},"f:valueFrom":{".":{},"f:fieldRef":{".":{},"f:apiVersion":{},"f:fieldPath":{}}}},"k:{\"name\":\"MY_POD_NAMESPACE\"}":{".":{},"f:name":{},"f:valueFrom":{".":{},"f:fieldRef":{".":{},"f:apiVersion":{},"f:fieldPath":{}}}},"k:{\"name\":\"RABBITMQ_ENABLED_PLUGINS_FILE\"}":{".":{},"f:name":{},"f:value":{}},"k:{\"name\":\"RABBITMQ_NODENAME\"}":{".":{},"f:name":{},"f:value":{}},"k:{\"name\":\"RABBITMQ_USE_LONGNAME\"}":{".":{},"f:name":{},"f:value":{}}},"f:image":{},"f:imagePullPolicy":{},"f:lifecycle":{".":{},"f:preStop":{".":{},"f:exec":{".":{},"f:command":{}}}},"f:name":{},"f:ports":{".":{},"k:{\"containerPort\":4369,\"protocol\":\"TCP\"}":{".":{},"f:containerPort":{},"f:name":{},"f:protocol":{}},"k:{\"containerPort\":5672,\"protocol\":\"TCP\"}":{".":{},"f:containerPort":{},"f:name":{},"f:protocol":{}},"k:{\"containerPort\":15672,\"protocol\":\"TCP\"}":{".":{},"f:containerPort":{},"f:name":{},"f:protocol":{}},"k:{\"containerPort\":15692,\"protocol\":\"TCP\"}":{".":{},"f:containerPort":{},"f:name":{},"f:protocol":{}}},"f:readinessProbe":{".":{},"f:failureThreshold":{},"f:initialDelaySeconds":{},"f:periodSeconds":{},"f:successThreshold":{},"f:tcpSocket":{".":{},"f:port":{}},"f:timeoutSeconds":{}},"f:resources":{".":{},"f:limits":{".":{},"f:cpu":{},"f:memory":{}},"f:requests":{".":{},"f:cpu":{},"f:memory":{}}},"f:terminationMessagePath":{},"f:terminationMessagePolicy":{},"f:volumeMounts":{".":{},"k:{\"mountPath\":\"/etc/pod-info/\"}":{".":{},"f:mountPath":{},"f:name":{}},"k:{\"mountPath\":\"/etc/rabbitmq/conf.d/10-operatorDefaults.conf\"}":{".":{},"f:mountPath":{},"f:name":{},"f:subPath":{}},"k:{\"mountPath\":\"/etc/rabbitmq/conf.d/11-default_user.conf\"}":{".":{},"f:mountPath":{},"f:name":{},"f:subPath":{}},"k:{\"mountPath\":\"/etc/rabbitmq/conf.d/90-userDefinedConfiguration.conf\"}":{".":{},"f:mountPath":{},"f:name":{},"f:subPath":{}},"k:{\"mountPath\":\"/operator\"}":{".":{},"f:mountPath":{},"f:name":{}},"k:{\"mountPath\":\"/var/lib/rabbitmq/\"}":{".":{},"f:mountPath":{},"f:name":{}},"k:{\"mountPath\":\"/var/lib/rabbitmq/mnesia/\"}":{".":{},"f:mountPath":{},"f:name":{}}}}},"f:dnsPolicy":{},"f:initContainers":{".":{},"k:{\"name\":\"setup-container\"}":{".":{},"f:command":{},"f:image":{},"f:imagePullPolicy":{},"f:name":{},"f:resources":{".":{},"f:limits":{".":{},"f:cpu":{},"f:memory":{}},"f:requests":{".":{},"f:cpu":{},"f:memory":{}}},"f:securityContext":{".":{},"f:capabilities":{".":{},"f:drop":{}},"f:runAsUser":{}},"f:terminationMessagePath":{},"f:terminationMessagePolicy":{},"f:volumeMounts":{".":{},"k:{\"mountPath\":\"/operator\"}":{".":{},"f:mountPath":{},"f:name":{}},"k:{\"mountPath\":\"/tmp/default_user.conf\"}":{".":{},"f:mountPath":{},"f:name":{},"f:subPath":{}},"k:{\"mountPath\":\"/tmp/erlang-cookie-secret/\"}":{".":{},"f:mountPath":{},"f:name":{}},"k:{\"mountPath\":\"/tmp/rabbitmq-plugins/\"}":{".":{},"f:mountPath":{},"f:name":{}},"k:{\"mountPath\":\"/var/lib/rabbitmq/\"}":{".":{},"f:mountPath":{},"f:name":{}},"k:{\"mountPath\":\"/var/lib/rabbitmq/mnesia/\"}":{".":{},"f:mountPath":{},"f:name":{}}}}},"f:restartPolicy":{},"f:schedulerName":{},"f:securityContext":{".":{},"f:fsGroup":{},"f:runAsGroup":{},"f:runAsUser":{}},"f:serviceAccount":{},"f:serviceAccountName":{},"f:terminationGracePeriodSeconds":{},"f:topologySpreadConstraints":{".":{},"k:{\"topologyKey\":\"topology.kubernetes.io/zone\",\"whenUnsatisfiable\":\"ScheduleAnyway\"}":{".":{},"f:labelSelector":{".":{},"f:matchLabels":{".":{},"f:app.kubernetes.io/name":{}}},"f:maxSkew":{},"f:topologyKey":{},"f:whenUnsatisfiable":{}}},"f:volumes":{".":{},"k:{\"name\":\"erlang-cookie-secret\"}":{".":{},"f:name":{},"f:secret":{".":{},"f:defaultMode":{},"f:secretName":{}}},"k:{\"name\":\"plugins-conf\"}":{".":{},"f:configMap":{".":{},"f:defaultMode":{},"f:name":{}},"f:name":{}},"k:{\"name\":\"pod-info\"}":{".":{},"f:downwardAPI":{".":{},"f:defaultMode":{},"f:items":{}},"f:name":{}},"k:{\"name\":\"rabbitmq-confd\"}":{".":{},"f:name":{},"f:projected":{".":{},"f:defaultMode":{},"f:sources":{}}},"k:{\"name\":\"rabbitmq-erlang-cookie\"}":{".":{},"f:emptyDir":{},"f:name":{}},"k:{\"name\":\"rabbitmq-plugins\"}":{".":{},"f:emptyDir":{},"f:name":{}}}}},"f:updateStrategy":{"f:rollingUpdate":{".":{},"f:partition":{}},"f:type":{}},"f:volumeClaimTemplates":{}}}}]},"spec":{"replicas":3,"selector":{"matchLabels":{"app.kubernetes.io/name":"rabbitmq-cluster"}},"template":{"metadata":{"creationTimestamp":null,"labels":{"app.kubernetes.io/component":"rabbitmq","app.kubernetes.io/name":"rabbitmq-cluster","app.kubernetes.io/part-of":"rabbitmq"},"annotations":{"prometheus.io/port":"15692","prometheus.io/scrape":"true"}},"spec":{"volumes":[{"name":"plugins-conf","configMap":{"name":"rabbitmq-cluster-plugins-conf","defaultMode":420}},{"name":"rabbitmq-confd","projected":{"sources":[{"secret":{"name":"rabbitmq-cluster-default-user","items":[{"key":"default_user.conf","path":"default_user.conf"}]}},{"configMap":{"name":"rabbitmq-cluster-server-conf","items":[{"key":"operatorDefaults.conf","path":"operatorDefaults.conf"},{"key":"userDefinedConfiguration.conf","path":"userDefinedConfiguration.conf"}]}}],"defaultMode":420}},{"name":"rabbitmq-erlang-cookie","emptyDir":{}},{"name":"erlang-cookie-secret","secret":{"secretName":"rabbitmq-cluster-erlang-cookie","defaultMode":420}},{"name":"rabbitmq-plugins","emptyDir":{}},{"name":"pod-info","downwardAPI":{"items":[{"path":"skipPreStopChecks","fieldRef":{"apiVersion":"v1","fieldPath":"metadata.labels['skipPreStopChecks']"}}],"defaultMode":420}}],"initContainers":[{"name":"setup-container","image":"rabbitmq:3.8.12-management","command":["sh","-c","cp /tmp/erlang-cookie-secret/.erlang.cookie /var/lib/rabbitmq/.erlang.cookie \u0026\u0026 chown 999:999 /var/lib/rabbitmq/.erlang.cookie \u0026\u0026 chmod 600 /var/lib/rabbitmq/.erlang.cookie ; cp /tmp/rabbitmq-plugins/enabled_plugins /operator/enabled_plugins \u0026\u0026 chown 999:999 /operator/enabled_plugins ; chown 999:999 /var/lib/rabbitmq/mnesia/ ; echo '[default]' \u003e /var/lib/rabbitmq/.rabbitmqadmin.conf \u0026\u0026 sed -e 's/default_user/username/' -e 's/default_pass/password/' /tmp/default_user.conf \u003e\u003e /var/lib/rabbitmq/.rabbitmqadmin.conf \u0026\u0026 chown 999:999 /var/lib/rabbitmq/.rabbitmqadmin.conf \u0026\u0026 chmod 600 /var/lib/rabbitmq/.rabbitmqadmin.conf"],"resources":{"limits":{"cpu":"100m","memory":"500Mi"},"requests":{"cpu":"100m","memory":"500Mi"}},"volumeMounts":[{"name":"plugins-conf","mountPath":"/tmp/rabbitmq-plugins/"},{"name":"rabbitmq-erlang-cookie","mountPath":"/var/lib/rabbitmq/"},{"name":"erlang-cookie-secret","mountPath":"/tmp/erlang-cookie-secret/"},{"name":"rabbitmq-plugins","mountPath":"/operator"},{"name":"persistence","mountPath":"/var/lib/rabbitmq/mnesia/"},{"name":"rabbitmq-confd","mountPath":"/tmp/default_user.conf","subPath":"default_user.conf"}],"terminationMessagePath":"/dev/termination-log","terminationMessagePolicy":"File","imagePullPolicy":"IfNotPresent","securityContext":{"capabilities":{"drop":["FSETID","KILL","SETGID","SETUID","SETPCAP","NET_BIND_SERVICE","NET_RAW","SYS_CHROOT","MKNOD","AUDIT_WRITE","SETFCAP"]},"runAsUser":0}}],"containers":[{"name":"rabbitmq","image":"rabbitmq:3.8.12-management","ports":[{"name":"epmd","containerPort":4369,"protocol":"TCP"},{"name":"amqp","containerPort":5672,"protocol":"TCP"},{"name":"management","containerPort":15672,"protocol":"TCP"},{"name":"prometheus","containerPort":15692,"protocol":"TCP"}],"env":[{"name":"MY_POD_NAME","valueFrom":{"fieldRef":{"apiVersion":"v1","fieldPath":"metadata.name"}}},{"name":"MY_POD_NAMESPACE","valueFrom":{"fieldRef":{"apiVersion":"v1","fieldPath":"metadata.namespace"}}},{"name":"RABBITMQ_ENABLED_PLUGINS_FILE","value":"/operator/enabled_plugins"},{"name":"K8S_SERVICE_NAME","value":"rabbitmq-cluster-nodes"},{"name":"RABBITMQ_USE_LONGNAME","value":"true"},{"name":"RABBITMQ_NODENAME","value":"rabbit@$(MY_POD_NAME).$(K8S_SERVICE_NAME).$(MY_POD_NAMESPACE)"},{"name":"K8S_HOSTNAME_SUFFIX","value":".$(K8S_SERVICE_NAME).$(MY_POD_NAMESPACE)"}],"resources":{"limits":{"cpu":"2","memory":"2Gi"},"requests":{"cpu":"1","memory":"2Gi"}},"volumeMounts":[{"name":"rabbitmq-erlang-cookie","mountPath":"/var/lib/rabbitmq/"},{"name":"persistence","mountPath":"/var/lib/rabbitmq/mnesia/"},{"name":"rabbitmq-plugins","mountPath":"/operator"},{"name":"rabbitmq-confd","mountPath":"/etc/rabbitmq/conf.d/10-operatorDefaults.conf","subPath":"operatorDefaults.conf"},{"name":"rabbitmq-confd","mountPath":"/etc/rabbitmq/conf.d/11-default_user.conf","subPath":"default_user.conf"},{"name":"rabbitmq-confd","mountPath":"/etc/rabbitmq/conf.d/90-userDefinedConfiguration.conf","subPath":"userDefinedConfiguration.conf"},{"name":"pod-info","mountPath":"/etc/pod-info/"}],"readinessProbe":{"tcpSocket":{"port":"amqp"},"initialDelaySeconds":10,"timeoutSeconds":5,"periodSeconds":10,"successThreshold":1,"failureThreshold":3},"lifecycle":{"preStop":{"exec":{"command":["/bin/bash","-c","if [ ! -z \"$(cat /etc/pod-info/skipPreStopChecks)\" ]; then exit 0; fi; rabbitmq-upgrade await_online_quorum_plus_one -t 604800; rabbitmq-upgrade await_online_synchronized_mirror -t 604800; rabbitmq-upgrade drain -t 604800"]}}},"terminationMessagePath":"/dev/termination-log","terminationMessagePolicy":"File","imagePullPolicy":"IfNotPresent"}],"restartPolicy":"Always","terminationGracePeriodSeconds":604800,"dnsPolicy":"ClusterFirst","serviceAccountName":"rabbitmq-cluster-server","serviceAccount":"rabbitmq-cluster-server","automountServiceAccountToken":true,"securityContext":{"runAsUser":999,"runAsGroup":999,"fsGroup":999},"schedulerName":"default-scheduler","topologySpreadConstraints":[{"maxSkew":1,"topologyKey":"topology.kubernetes.io/zone","whenUnsatisfiable":"ScheduleAnyway","labelSelector":{"matchLabels":{"app.kubernetes.io/name":"rabbitmq-cluster"}}}]}},"volumeClaimTemplates":[{"metadata":{"name":"persistence","namespace":"default","creationTimestamp":null,"labels":{"app.kubernetes.io/component":"rabbitmq","app.kubernetes.io/name":"rabbitmq-cluster","app.kubernetes.io/part-of":"rabbitmq"},"ownerReferences":[{"apiVersion":"rabbitmq.com/v1beta1","kind":"RabbitmqCluster","name":"rabbitmq-cluster","uid":"18d9928b-0d1c-47be-80ec-20960d053827","controller":true,"blockOwnerDeletion":false}]},"spec":{"accessModes":["ReadWriteOnce"],"resources":{"requests":{"storage":"10Gi"}},"volumeMode":"Filesystem"},"status":{"phase":"Pending"}}],"serviceName":"rabbitmq-cluster-nodes","podManagementPolicy":"Parallel","updateStrategy":{"type":"RollingUpdate","rollingUpdate":{"partition":0}},"revisionHistoryLimit":10},"status":{"observedGeneration":2,"replicas":3,"readyReplicas":1,"currentReplicas":3,"updatedReplicas":3,"currentRevision":"rabbitmq-cluster-server-5f8b8665fb","updateRevision":"rabbitmq-cluster-server-5f8b8665fb","collisionCount":0}}
2022/03/18 18:01:23 learn_server.go:256: [SIEVE-BEFORE-WRITE]	43
2022/03/18 18:01:23 learn_server.go:263: [SIEVE-AFTER-WRITE]	43	Update	statefulset	github.com/rabbitmq/cluster-operator/controllers.(*RabbitmqClusterReconciler)	NoError	{"metadata":{"name":"rabbitmq-cluster-server","namespace":"default","selfLink":"/apis/apps/v1/namespaces/default/statefulsets/rabbitmq-cluster-server","uid":"cb5c43bc-6ee7-481c-ab01-6f3acffdd3c8","resourceVersion":"989","generation":2,"creationTimestamp":"2022-03-18T18:00:38Z","labels":{"app.kubernetes.io/component":"rabbitmq","app.kubernetes.io/name":"rabbitmq-cluster","app.kubernetes.io/part-of":"rabbitmq"},"ownerReferences":[{"apiVersion":"rabbitmq.com/v1beta1","kind":"RabbitmqCluster","name":"rabbitmq-cluster","uid":"18d9928b-0d1c-47be-80ec-20960d053827","controller":true,"blockOwnerDeletion":true}],"managedFields":[{"manager":"kube-controller-manager","operation":"Update","apiVersion":"apps/v1","time":"2022-03-18T18:01:23Z","fieldsType":"FieldsV1","fieldsV1":{"f:status":{"f:collisionCount":{},"f:currentReplicas":{},"f:currentRevision":{},"f:observedGeneration":{},"f:readyReplicas":{},"f:replicas":{},"f:updateRevision":{},"f:updatedReplicas":{}}}},{"manager":"manager","operation":"Update","apiVersion":"apps/v1","time":"2022-03-18T18:01:23Z","fieldsType":"FieldsV1","fieldsV1":{"f:metadata":{"f:labels":{".":{},"f:app.kubernetes.io/component":{},"f:app.kubernetes.io/name":{},"f:app.kubernetes.io/part-of":{}},"f:ownerReferences":{".":{},"k:{\"uid\":\"18d9928b-0d1c-47be-80ec-20960d053827\"}":{".":{},"f:apiVersion":{},"f:blockOwnerDeletion":{},"f:controller":{},"f:kind":{},"f:name":{},"f:uid":{}}}},"f:spec":{"f:podManagementPolicy":{},"f:replicas":{},"f:revisionHistoryLimit":{},"f:selector":{"f:matchLabels":{".":{},"f:app.kubernetes.io/name":{}}},"f:serviceName":{},"f:template":{"f:metadata":{"f:annotations":{".":{},"f:prometheus.io/port":{},"f:prometheus.io/scrape":{}},"f:labels":{".":{},"f:app.kubernetes.io/component":{},"f:app.kubernetes.io/name":{},"f:app.kubernetes.io/part-of":{}}},"f:spec":{"f:automountServiceAccountToken":{},"f:containers":{"k:{\"name\":\"rabbitmq\"}":{".":{},"f:env":{".":{},"k:{\"name\":\"K8S_HOSTNAME_SUFFIX\"}":{".":{},"f:name":{},"f:value":{}},"k:{\"name\":\"K8S_SERVICE_NAME\"}":{".":{},"f:name":{},"f:value":{}},"k:{\"name\":\"MY_POD_NAME\"}":{".":{},"f:name":{},"f:valueFrom":{".":{},"f:fieldRef":{".":{},"f:apiVersion":{},"f:fieldPath":{}}}},"k:{\"name\":\"MY_POD_NAMESPACE\"}":{".":{},"f:name":{},"f:valueFrom":{".":{},"f:fieldRef":{".":{},"f:apiVersion":{},"f:fieldPath":{}}}},"k:{\"name\":\"RABBITMQ_ENABLED_PLUGINS_FILE\"}":{".":{},"f:name":{},"f:value":{}},"k:{\"name\":\"RABBITMQ_NODENAME\"}":{".":{},"f:name":{},"f:value":{}},"k:{\"name\":\"RABBITMQ_USE_LONGNAME\"}":{".":{},"f:name":{},"f:value":{}}},"f:image":{},"f:imagePullPolicy":{},"f:lifecycle":{".":{},"f:preStop":{".":{},"f:exec":{".":{},"f:command":{}}}},"f:name":{},"f:ports":{".":{},"k:{\"containerPort\":4369,\"protocol\":\"TCP\"}":{".":{},"f:containerPort":{},"f:name":{},"f:protocol":{}},"k:{\"containerPort\":5672,\"protocol\":\"TCP\"}":{".":{},"f:containerPort":{},"f:name":{},"f:protocol":{}},"k:{\"containerPort\":15672,\"protocol\":\"TCP\"}":{".":{},"f:containerPort":{},"f:name":{},"f:protocol":{}},"k:{\"containerPort\":15692,\"protocol\":\"TCP\"}":{".":{},"f:containerPort":{},"f:name":{},"f:protocol":{}}},"f:readinessProbe":{".":{},"f:failureThreshold":{},"f:initialDelaySeconds":{},"f:periodSeconds":{},"f:successThreshold":{},"f:tcpSocket":{".":{},"f:port":{}},"f:timeoutSeconds":{}},"f:resources":{".":{},"f:limits":{".":{},"f:cpu":{},"f:memory":{}},"f:requests":{".":{},"f:cpu":{},"f:memory":{}}},"f:terminationMessagePath":{},"f:terminationMessagePolicy":{},"f:volumeMounts":{".":{},"k:{\"mountPath\":\"/etc/pod-info/\"}":{".":{},"f:mountPath":{},"f:name":{}},"k:{\"mountPath\":\"/etc/rabbitmq/conf.d/10-operatorDefaults.conf\"}":{".":{},"f:mountPath":{},"f:name":{},"f:subPath":{}},"k:{\"mountPath\":\"/etc/rabbitmq/conf.d/11-default_user.conf\"}":{".":{},"f:mountPath":{},"f:name":{},"f:subPath":{}},"k:{\"mountPath\":\"/etc/rabbitmq/conf.d/90-userDefinedConfiguration.conf\"}":{".":{},"f:mountPath":{},"f:name":{},"f:subPath":{}},"k:{\"mountPath\":\"/operator\"}":{".":{},"f:mountPath":{},"f:name":{}},"k:{\"mountPath\":\"/var/lib/rabbitmq/\"}":{".":{},"f:mountPath":{},"f:name":{}},"k:{\"mountPath\":\"/var/lib/rabbitmq/mnesia/\"}":{".":{},"f:mountPath":{},"f:name":{}}}}},"f:dnsPolicy":{},"f:initContainers":{".":{},"k:{\"name\":\"setup-container\"}":{".":{},"f:command":{},"f:image":{},"f:imagePullPolicy":{},"f:name":{},"f:resources":{".":{},"f:limits":{".":{},"f:cpu":{},"f:memory":{}},"f:requests":{".":{},"f:cpu":{},"f:memory":{}}},"f:securityContext":{".":{},"f:capabilities":{".":{},"f:drop":{}},"f:runAsUser":{}},"f:terminationMessagePath":{},"f:terminationMessagePolicy":{},"f:volumeMounts":{".":{},"k:{\"mountPath\":\"/operator\"}":{".":{},"f:mountPath":{},"f:name":{}},"k:{\"mountPath\":\"/tmp/default_user.conf\"}":{".":{},"f:mountPath":{},"f:name":{},"f:subPath":{}},"k:{\"mountPath\":\"/tmp/erlang-cookie-secret/\"}":{".":{},"f:mountPath":{},"f:name":{}},"k:{\"mountPath\":\"/tmp/rabbitmq-plugins/\"}":{".":{},"f:mountPath":{},"f:name":{}},"k:{\"mountPath\":\"/var/lib/rabbitmq/\"}":{".":{},"f:mountPath":{},"f:name":{}},"k:{\"mountPath\":\"/var/lib/rabbitmq/mnesia/\"}":{".":{},"f:mountPath":{},"f:name":{}}}}},"f:restartPolicy":{},"f:schedulerName":{},"f:securityContext":{".":{},"f:fsGroup":{},"f:runAsGroup":{},"f:runAsUser":{}},"f:serviceAccount":{},"f:serviceAccountName":{},"f:terminationGracePeriodSeconds":{},"f:topologySpreadConstraints":{".":{},"k:{\"topologyKey\":\"topology.kubernetes.io/zone\",\"whenUnsatisfiable\":\"ScheduleAnyway\"}":{".":{},"f:labelSelector":{".":{},"f:matchLabels":{".":{},"f:app.kubernetes.io/name":{}}},"f:maxSkew":{},"f:topologyKey":{},"f:whenUnsatisfiable":{}}},"f:volumes":{".":{},"k:{\"name\":\"erlang-cookie-secret\"}":{".":{},"f:name":{},"f:secret":{".":{},"f:defaultMode":{},"f:secretName":{}}},"k:{\"name\":\"plugins-conf\"}":{".":{},"f:configMap":{".":{},"f:defaultMode":{},"f:name":{}},"f:name":{}},"k:{\"name\":\"pod-info\"}":{".":{},"f:downwardAPI":{".":{},"f:defaultMode":{},"f:items":{}},"f:name":{}},"k:{\"name\":\"rabbitmq-confd\"}":{".":{},"f:name":{},"f:projected":{".":{},"f:defaultMode":{},"f:sources":{}}},"k:{\"name\":\"rabbitmq-erlang-cookie\"}":{".":{},"f:emptyDir":{},"f:name":{}},"k:{\"name\":\"rabbitmq-plugins\"}":{".":{},"f:emptyDir":{},"f:name":{}}}}},"f:updateStrategy":{"f:rollingUpdate":{".":{},"f:partition":{}},"f:type":{}},"f:volumeClaimTemplates":{}}}}]},"spec":{"replicas":3,"selector":{"matchLabels":{"app.kubernetes.io/name":"rabbitmq-cluster"}},"template":{"metadata":{"creationTimestamp":null,"labels":{"app.kubernetes.io/component":"rabbitmq","app.kubernetes.io/name":"rabbitmq-cluster","app.kubernetes.io/part-of":"rabbitmq"},"annotations":{"prometheus.io/port":"15692","prometheus.io/scrape":"true"}},"spec":{"volumes":[{"name":"plugins-conf","configMap":{"name":"rabbitmq-cluster-plugins-conf","defaultMode":420}},{"name":"rabbitmq-confd","projected":{"sources":[{"secret":{"name":"rabbitmq-cluster-default-user","items":[{"key":"default_user.conf","path":"default_user.conf"}]}},{"configMap":{"name":"rabbitmq-cluster-server-conf","items":[{"key":"operatorDefaults.conf","path":"operatorDefaults.conf"},{"key":"userDefinedConfiguration.conf","path":"userDefinedConfiguration.conf"}]}}],"defaultMode":420}},{"name":"rabbitmq-erlang-cookie","emptyDir":{}},{"name":"erlang-cookie-secret","secret":{"secretName":"rabbitmq-cluster-erlang-cookie","defaultMode":420}},{"name":"rabbitmq-plugins","emptyDir":{}},{"name":"pod-info","downwardAPI":{"items":[{"path":"skipPreStopChecks","fieldRef":{"apiVersion":"v1","fieldPath":"metadata.labels['skipPreStopChecks']"}}],"defaultMode":420}}],"initContainers":[{"name":"setup-container","image":"rabbitmq:3.8.12-management","command":["sh","-c","cp /tmp/erlang-cookie-secret/.erlang.cookie /var/lib/rabbitmq/.erlang.cookie \u0026\u0026 chown 999:999 /var/lib/rabbitmq/.erlang.cookie \u0026\u0026 chmod 600 /var/lib/rabbitmq/.erlang.cookie ; cp /tmp/rabbitmq-plugins/enabled_plugins /operator/enabled_plugins \u0026\u0026 chown 999:999 /operator/enabled_plugins ; chown 999:999 /var/lib/rabbitmq/mnesia/ ; echo '[default]' \u003e /var/lib/rabbitmq/.rabbitmqadmin.conf \u0026\u0026 sed -e 's/default_user/username/' -e 's/default_pass/password/' /tmp/default_user.conf \u003e\u003e /var/lib/rabbitmq/.rabbitmqadmin.conf \u0026\u0026 chown 999:999 /var/lib/rabbitmq/.rabbitmqadmin.conf \u0026\u0026 chmod 600 /var/lib/rabbitmq/.rabbitmqadmin.conf"],"resources":{"limits":{"cpu":"100m","memory":"500Mi"},"requests":{"cpu":"100m","memory":"500Mi"}},"volumeMounts":[{"name":"plugins-conf","mountPath":"/tmp/rabbitmq-plugins/"},{"name":"rabbitmq-erlang-cookie","mountPath":"/var/lib/rabbitmq/"},{"name":"erlang-cookie-secret","mountPath":"/tmp/erlang-cookie-secret/"},{"name":"rabbitmq-plugins","mountPath":"/operator"},{"name":"persistence","mountPath":"/var/lib/rabbitmq/mnesia/"},{"name":"rabbitmq-confd","mountPath":"/tmp/default_user.conf","subPath":"default_user.conf"}],"terminationMessagePath":"/dev/termination-log","terminationMessagePolicy":"File","imagePullPolicy":"IfNotPresent","securityContext":{"capabilities":{"drop":["FSETID","KILL","SETGID","SETUID","SETPCAP","NET_BIND_SERVICE","NET_RAW","SYS_CHROOT","MKNOD","AUDIT_WRITE","SETFCAP"]},"runAsUser":0}}],"containers":[{"name":"rabbitmq","image":"rabbitmq:3.8.12-management","ports":[{"name":"epmd","containerPort":4369,"protocol":"TCP"},{"name":"amqp","containerPort":5672,"protocol":"TCP"},{"name":"management","containerPort":15672,"protocol":"TCP"},{"name":"prometheus","containerPort":15692,"protocol":"TCP"}],"env":[{"name":"MY_POD_NAME","valueFrom":{"fieldRef":{"apiVersion":"v1","fieldPath":"metadata.name"}}},{"name":"MY_POD_NAMESPACE","valueFrom":{"fieldRef":{"apiVersion":"v1","fieldPath":"metadata.namespace"}}},{"name":"RABBITMQ_ENABLED_PLUGINS_FILE","value":"/operator/enabled_plugins"},{"name":"K8S_SERVICE_NAME","value":"rabbitmq-cluster-nodes"},{"name":"RABBITMQ_USE_LONGNAME","value":"true"},{"name":"RABBITMQ_NODENAME","value":"rabbit@$(MY_POD_NAME).$(K8S_SERVICE_NAME).$(MY_POD_NAMESPACE)"},{"name":"K8S_HOSTNAME_SUFFIX","value":".$(K8S_SERVICE_NAME).$(MY_POD_NAMESPACE)"}],"resources":{"limits":{"cpu":"2","memory":"2Gi"},"requests":{"cpu":"1","memory":"2Gi"}},"volumeMounts":[{"name":"rabbitmq-erlang-cookie","mountPath":"/var/lib/rabbitmq/"},{"name":"persistence","mountPath":"/var/lib/rabbitmq/mnesia/"},{"name":"rabbitmq-plugins","mountPath":"/operator"},{"name":"rabbitmq-confd","mountPath":"/etc/rabbitmq/conf.d/10-operatorDefaults.conf","subPath":"operatorDefaults.conf"},{"name":"rabbitmq-confd","mountPath":"/etc/rabbitmq/conf.d/11-default_user.conf","subPath":"default_user.conf"},{"name":"rabbitmq-confd","mountPath":"/etc/rabbitmq/conf.d/90-userDefinedConfiguration.conf","subPath":"userDefinedConfiguration.conf"},{"name":"pod-info","mountPath":"/etc/pod-info/"}],"readinessProbe":{"tcpSocket":{"port":"amqp"},"initialDelaySeconds":10,"timeoutSeconds":5,"periodSeconds":10,"successThreshold":1,"failureThreshold":3},"lifecycle":{"preStop":{"exec":{"command":["/bin/bash","-c","if [ ! -z \"$(cat /etc/pod-info/skipPreStopChecks)\" ]; then exit 0; fi; rabbitmq-upgrade await_online_quorum_plus_one -t 604800; rabbitmq-upgrade await_online_synchronized_mirror -t 604800; rabbitmq-upgrade drain -t 604800"]}}},"terminationMessagePath":"/dev/termination-log","terminationMessagePolicy":"File","imagePullPolicy":"IfNotPresent"}],"restartPolicy":"Always","terminationGracePeriodSeconds":604800,"dnsPolicy":"ClusterFirst","serviceAccountName":"rabbitmq-cluster-server","serviceAccount":"rabbitmq-cluster-server","automountServiceAccountToken":true,"securityContext":{"runAsUser":999,"runAsGroup":999,"fsGroup":999},"schedulerName":"default-scheduler","topologySpreadConstraints":[{"maxSkew":1,"topologyKey":"topology.kubernetes.io/zone","whenUnsatisfiable":"ScheduleAnyway","labelSelector":{"matchLabels":{"app.kubernetes.io/name":"rabbitmq-cluster"}}}]}},"volumeClaimTemplates":[{"metadata":{"name":"persistence","namespace":"default","creationTimestamp":null,"labels":{"app.kubernetes.io/component":"rabbitmq","app.kubernetes.io/name":"rabbitmq-cluster","app.kubernetes.io/part-of":"rabbitmq"},"ownerReferences":[{"apiVersion":"rabbitmq.com/v1beta1","kind":"RabbitmqCluster","name":"rabbitmq-cluster","uid":"18d9928b-0d1c-47be-80ec-20960d053827","controller":true,"blockOwnerDeletion":false}]},"spec":{"accessModes":["ReadWriteOnce"],"resources":{"requests":{"storage":"10Gi"}},"volumeMode":"Filesystem"},"status":{"phase":"Pending"}}],"serviceName":"rabbitmq-cluster-nodes","podManagementPolicy":"Parallel","updateStrategy":{"type":"RollingUpdate","rollingUpdate":{"partition":0}},"revisionHistoryLimit":10},"status":{"observedGeneration":2,"replicas":3,"readyReplicas":1,"currentReplicas":3,"updatedReplicas":3,"currentRevision":"rabbitmq-cluster-server-5f8b8665fb","updateRevision":"rabbitmq-cluster-server-5f8b8665fb","collisionCount":0}}
2022/03/18 18:01:23 learn_server.go:291: [SIEVE-AFTER-READ]	Get	true	configmap	default	rabbitmq-cluster-server-conf	github.com/rabbitmq/cluster-operator/controllers.(*RabbitmqClusterReconciler)	NoError	{"kind":"ConfigMap","apiVersion":"v1","metadata":{"name":"rabbitmq-cluster-server-conf","namespace":"default","selfLink":"/api/v1/namespaces/default/configmaps/rabbitmq-cluster-server-conf","uid":"22474f2b-8454-44b7-8079-8990223969cc","resourceVersion":"714","creationTimestamp":"2022-03-18T18:00:38Z","labels":{"app.kubernetes.io/component":"rabbitmq","app.kubernetes.io/name":"rabbitmq-cluster","app.kubernetes.io/part-of":"rabbitmq"},"ownerReferences":[{"apiVersion":"rabbitmq.com/v1beta1","kind":"RabbitmqCluster","name":"rabbitmq-cluster","uid":"18d9928b-0d1c-47be-80ec-20960d053827","controller":true,"blockOwnerDeletion":true}],"managedFields":[{"manager":"manager","operation":"Update","apiVersion":"v1","time":"2022-03-18T18:00:38Z","fieldsType":"FieldsV1","fieldsV1":{"f:data":{".":{},"f:operatorDefaults.conf":{},"f:userDefinedConfiguration.conf":{}},"f:metadata":{"f:labels":{".":{},"f:app.kubernetes.io/component":{},"f:app.kubernetes.io/name":{},"f:app.kubernetes.io/part-of":{}},"f:ownerReferences":{".":{},"k:{\"uid\":\"18d9928b-0d1c-47be-80ec-20960d053827\"}":{".":{},"f:apiVersion":{},"f:blockOwnerDeletion":{},"f:controller":{},"f:kind":{},"f:name":{},"f:uid":{}}}}}}]},"data":{"operatorDefaults.conf":"cluster_formation.peer_discovery_backend             = rabbit_peer_discovery_k8s\ncluster_formation.k8s.host                           = kubernetes.default\ncluster_formation.k8s.address_type                   = hostname\ncluster_partition_handling                           = pause_minority\nqueue_master_locator                                 = min-masters\ndisk_free_limit.absolute                             = 2GB\ncluster_formation.randomized_startup_delay_range.min = 5\ncluster_formation.randomized_startup_delay_range.max = 30\ncluster_name                                         = rabbitmq-cluster\n","userDefinedConfiguration.conf":"total_memory_available_override_value = 1717986919\n"}}
2022/03/18 18:01:23 learn_server.go:256: [SIEVE-BEFORE-WRITE]	44
2022/03/18 18:01:23 learn_server.go:263: [SIEVE-AFTER-WRITE]	44	StatusUpdate	rabbitmqcluster	github.com/rabbitmq/cluster-operator/controllers.(*RabbitmqClusterReconciler)	NoError	{"metadata":{"name":"rabbitmq-cluster","namespace":"default","selfLink":"/apis/rabbitmq.com/v1beta1/namespaces/default/rabbitmqclusters/rabbitmq-cluster/status","uid":"18d9928b-0d1c-47be-80ec-20960d053827","resourceVersion":"977","generation":3,"creationTimestamp":"2022-03-18T18:00:38Z","annotations":{"kubectl.kubernetes.io/last-applied-configuration":"{\"apiVersion\":\"rabbitmq.com/v1beta1\",\"kind\":\"RabbitmqCluster\",\"metadata\":{\"annotations\":{},\"name\":\"rabbitmq-cluster\",\"namespace\":\"default\"},\"spec\":{\"persistence\":{\"storage\":\"10Gi\"},\"replicas\":1}}\n"},"finalizers":["deletion.finalizers.rabbitmqclusters.rabbitmq.com"],"managedFields":[{"manager":"kubectl-client-side-apply","operation":"Update","apiVersion":"rabbitmq.com/v1beta1","time":"2022-03-18T18:00:38Z","fieldsType":"FieldsV1","fieldsV1":{"f:metadata":{"f:annotations":{".":{},"f:kubectl.kubernetes.io/last-applied-configuration":{}}},"f:spec":{".":{},"f:image":{},"f:persistence":{".":{},"f:storage":{}},"f:resources":{".":{},"f:limits":{".":{},"f:memory":{}},"f:requests":{".":{},"f:memory":{}}},"f:service":{".":{},"f:type":{}},"f:terminationGracePeriodSeconds":{}}}},{"manager":"kubectl-patch","operation":"Update","apiVersion":"rabbitmq.com/v1beta1","time":"2022-03-18T18:01:23Z","fieldsType":"FieldsV1","fieldsV1":{"f:spec":{"f:replicas":{}}}},{"manager":"manager","operation":"Update","apiVersion":"rabbitmq.com/v1beta1","time":"2022-03-18T18:01:23Z","fieldsType":"FieldsV1","fieldsV1":{"f:metadata":{"f:finalizers":{}},"f:spec":{"f:override":{},"f:rabbitmq":{},"f:resources":{"f:limits":{"f:cpu":{}},"f:requests":{"f:cpu":{}}},"f:tls":{}},"f:status":{".":{},"f:conditions":{},"f:defaultUser":{".":{},"f:secretReference":{".":{},"f:keys":{".":{},"f:password":{},"f:username":{}},"f:name":{},"f:namespace":{}},"f:serviceReference":{".":{},"f:name":{},"f:namespace":{}}}}}}]},"spec":{"replicas":3,"image":"rabbitmq:3.8.12-management","service":{"type":"ClusterIP"},"persistence":{"storage":"10Gi"},"resources":{"limits":{"cpu":"2","memory":"2Gi"},"requests":{"cpu":"1","memory":"2Gi"}},"rabbitmq":{},"tls":{},"override":{},"terminationGracePeriodSeconds":604800},"status":{"conditions":[{"type":"AllReplicasReady","status":"False","lastTransitionTime":"2022-03-18T18:01:23Z","reason":"NotAllPodsReady","message":"1/3 Pods ready"},{"type":"ClusterAvailable","status":"True","lastTransitionTime":"2022-03-18T18:01:17Z","reason":"AtLeastOneEndpointAvailable"},{"type":"NoWarnings","status":"True","lastTransitionTime":"2022-03-18T18:00:38Z","reason":"NoWarnings"},{"type":"ReconcileSuccess","status":"True","lastTransitionTime":"2022-03-18T18:01:18Z","reason":"Success","message":"Finish reconciling"}],"defaultUser":{"secretReference":{"name":"rabbitmq-cluster-default-user","namespace":"default","keys":{"password":"password","username":"username"}},"serviceReference":{"name":"rabbitmq-cluster","namespace":"default"}},"binding":{"name":"rabbitmq-cluster-default-user"}}}
2022/03/18 18:01:23 learn_server.go:291: [SIEVE-AFTER-READ]	Get	true	statefulset	default	rabbitmq-cluster-server	github.com/rabbitmq/cluster-operator/controllers.(*RabbitmqClusterReconciler)	NoError	{"kind":"StatefulSet","apiVersion":"apps/v1","metadata":{"name":"rabbitmq-cluster-server","namespace":"default","selfLink":"/apis/apps/v1/namespaces/default/statefulsets/rabbitmq-cluster-server","uid":"cb5c43bc-6ee7-481c-ab01-6f3acffdd3c8","resourceVersion":"989","generation":2,"creationTimestamp":"2022-03-18T18:00:38Z","labels":{"app.kubernetes.io/component":"rabbitmq","app.kubernetes.io/name":"rabbitmq-cluster","app.kubernetes.io/part-of":"rabbitmq"},"ownerReferences":[{"apiVersion":"rabbitmq.com/v1beta1","kind":"RabbitmqCluster","name":"rabbitmq-cluster","uid":"18d9928b-0d1c-47be-80ec-20960d053827","controller":true,"blockOwnerDeletion":true}],"managedFields":[{"manager":"kube-controller-manager","operation":"Update","apiVersion":"apps/v1","time":"2022-03-18T18:01:23Z","fieldsType":"FieldsV1","fieldsV1":{"f:status":{"f:collisionCount":{},"f:currentReplicas":{},"f:currentRevision":{},"f:observedGeneration":{},"f:readyReplicas":{},"f:replicas":{},"f:updateRevision":{},"f:updatedReplicas":{}}}},{"manager":"manager","operation":"Update","apiVersion":"apps/v1","time":"2022-03-18T18:01:23Z","fieldsType":"FieldsV1","fieldsV1":{"f:metadata":{"f:labels":{".":{},"f:app.kubernetes.io/component":{},"f:app.kubernetes.io/name":{},"f:app.kubernetes.io/part-of":{}},"f:ownerReferences":{".":{},"k:{\"uid\":\"18d9928b-0d1c-47be-80ec-20960d053827\"}":{".":{},"f:apiVersion":{},"f:blockOwnerDeletion":{},"f:controller":{},"f:kind":{},"f:name":{},"f:uid":{}}}},"f:spec":{"f:podManagementPolicy":{},"f:replicas":{},"f:revisionHistoryLimit":{},"f:selector":{"f:matchLabels":{".":{},"f:app.kubernetes.io/name":{}}},"f:serviceName":{},"f:template":{"f:metadata":{"f:annotations":{".":{},"f:prometheus.io/port":{},"f:prometheus.io/scrape":{}},"f:labels":{".":{},"f:app.kubernetes.io/component":{},"f:app.kubernetes.io/name":{},"f:app.kubernetes.io/part-of":{}}},"f:spec":{"f:automountServiceAccountToken":{},"f:containers":{"k:{\"name\":\"rabbitmq\"}":{".":{},"f:env":{".":{},"k:{\"name\":\"K8S_HOSTNAME_SUFFIX\"}":{".":{},"f:name":{},"f:value":{}},"k:{\"name\":\"K8S_SERVICE_NAME\"}":{".":{},"f:name":{},"f:value":{}},"k:{\"name\":\"MY_POD_NAME\"}":{".":{},"f:name":{},"f:valueFrom":{".":{},"f:fieldRef":{".":{},"f:apiVersion":{},"f:fieldPath":{}}}},"k:{\"name\":\"MY_POD_NAMESPACE\"}":{".":{},"f:name":{},"f:valueFrom":{".":{},"f:fieldRef":{".":{},"f:apiVersion":{},"f:fieldPath":{}}}},"k:{\"name\":\"RABBITMQ_ENABLED_PLUGINS_FILE\"}":{".":{},"f:name":{},"f:value":{}},"k:{\"name\":\"RABBITMQ_NODENAME\"}":{".":{},"f:name":{},"f:value":{}},"k:{\"name\":\"RABBITMQ_USE_LONGNAME\"}":{".":{},"f:name":{},"f:value":{}}},"f:image":{},"f:imagePullPolicy":{},"f:lifecycle":{".":{},"f:preStop":{".":{},"f:exec":{".":{},"f:command":{}}}},"f:name":{},"f:ports":{".":{},"k:{\"containerPort\":4369,\"protocol\":\"TCP\"}":{".":{},"f:containerPort":{},"f:name":{},"f:protocol":{}},"k:{\"containerPort\":5672,\"protocol\":\"TCP\"}":{".":{},"f:containerPort":{},"f:name":{},"f:protocol":{}},"k:{\"containerPort\":15672,\"protocol\":\"TCP\"}":{".":{},"f:containerPort":{},"f:name":{},"f:protocol":{}},"k:{\"containerPort\":15692,\"protocol\":\"TCP\"}":{".":{},"f:containerPort":{},"f:name":{},"f:protocol":{}}},"f:readinessProbe":{".":{},"f:failureThreshold":{},"f:initialDelaySeconds":{},"f:periodSeconds":{},"f:successThreshold":{},"f:tcpSocket":{".":{},"f:port":{}},"f:timeoutSeconds":{}},"f:resources":{".":{},"f:limits":{".":{},"f:cpu":{},"f:memory":{}},"f:requests":{".":{},"f:cpu":{},"f:memory":{}}},"f:terminationMessagePath":{},"f:terminationMessagePolicy":{},"f:volumeMounts":{".":{},"k:{\"mountPath\":\"/etc/pod-info/\"}":{".":{},"f:mountPath":{},"f:name":{}},"k:{\"mountPath\":\"/etc/rabbitmq/conf.d/10-operatorDefaults.conf\"}":{".":{},"f:mountPath":{},"f:name":{},"f:subPath":{}},"k:{\"mountPath\":\"/etc/rabbitmq/conf.d/11-default_user.conf\"}":{".":{},"f:mountPath":{},"f:name":{},"f:subPath":{}},"k:{\"mountPath\":\"/etc/rabbitmq/conf.d/90-userDefinedConfiguration.conf\"}":{".":{},"f:mountPath":{},"f:name":{},"f:subPath":{}},"k:{\"mountPath\":\"/operator\"}":{".":{},"f:mountPath":{},"f:name":{}},"k:{\"mountPath\":\"/var/lib/rabbitmq/\"}":{".":{},"f:mountPath":{},"f:name":{}},"k:{\"mountPath\":\"/var/lib/rabbitmq/mnesia/\"}":{".":{},"f:mountPath":{},"f:name":{}}}}},"f:dnsPolicy":{},"f:initContainers":{".":{},"k:{\"name\":\"setup-container\"}":{".":{},"f:command":{},"f:image":{},"f:imagePullPolicy":{},"f:name":{},"f:resources":{".":{},"f:limits":{".":{},"f:cpu":{},"f:memory":{}},"f:requests":{".":{},"f:cpu":{},"f:memory":{}}},"f:securityContext":{".":{},"f:capabilities":{".":{},"f:drop":{}},"f:runAsUser":{}},"f:terminationMessagePath":{},"f:terminationMessagePolicy":{},"f:volumeMounts":{".":{},"k:{\"mountPath\":\"/operator\"}":{".":{},"f:mountPath":{},"f:name":{}},"k:{\"mountPath\":\"/tmp/default_user.conf\"}":{".":{},"f:mountPath":{},"f:name":{},"f:subPath":{}},"k:{\"mountPath\":\"/tmp/erlang-cookie-secret/\"}":{".":{},"f:mountPath":{},"f:name":{}},"k:{\"mountPath\":\"/tmp/rabbitmq-plugins/\"}":{".":{},"f:mountPath":{},"f:name":{}},"k:{\"mountPath\":\"/var/lib/rabbitmq/\"}":{".":{},"f:mountPath":{},"f:name":{}},"k:{\"mountPath\":\"/var/lib/rabbitmq/mnesia/\"}":{".":{},"f:mountPath":{},"f:name":{}}}}},"f:restartPolicy":{},"f:schedulerName":{},"f:securityContext":{".":{},"f:fsGroup":{},"f:runAsGroup":{},"f:runAsUser":{}},"f:serviceAccount":{},"f:serviceAccountName":{},"f:terminationGracePeriodSeconds":{},"f:topologySpreadConstraints":{".":{},"k:{\"topologyKey\":\"topology.kubernetes.io/zone\",\"whenUnsatisfiable\":\"ScheduleAnyway\"}":{".":{},"f:labelSelector":{".":{},"f:matchLabels":{".":{},"f:app.kubernetes.io/name":{}}},"f:maxSkew":{},"f:topologyKey":{},"f:whenUnsatisfiable":{}}},"f:volumes":{".":{},"k:{\"name\":\"erlang-cookie-secret\"}":{".":{},"f:name":{},"f:secret":{".":{},"f:defaultMode":{},"f:secretName":{}}},"k:{\"name\":\"plugins-conf\"}":{".":{},"f:configMap":{".":{},"f:defaultMode":{},"f:name":{}},"f:name":{}},"k:{\"name\":\"pod-info\"}":{".":{},"f:downwardAPI":{".":{},"f:defaultMode":{},"f:items":{}},"f:name":{}},"k:{\"name\":\"rabbitmq-confd\"}":{".":{},"f:name":{},"f:projected":{".":{},"f:defaultMode":{},"f:sources":{}}},"k:{\"name\":\"rabbitmq-erlang-cookie\"}":{".":{},"f:emptyDir":{},"f:name":{}},"k:{\"name\":\"rabbitmq-plugins\"}":{".":{},"f:emptyDir":{},"f:name":{}}}}},"f:updateStrategy":{"f:rollingUpdate":{".":{},"f:partition":{}},"f:type":{}},"f:volumeClaimTemplates":{}}}}]},"spec":{"replicas":3,"selector":{"matchLabels":{"app.kubernetes.io/name":"rabbitmq-cluster"}},"template":{"metadata":{"creationTimestamp":null,"labels":{"app.kubernetes.io/component":"rabbitmq","app.kubernetes.io/name":"rabbitmq-cluster","app.kubernetes.io/part-of":"rabbitmq"},"annotations":{"prometheus.io/port":"15692","prometheus.io/scrape":"true"}},"spec":{"volumes":[{"name":"plugins-conf","configMap":{"name":"rabbitmq-cluster-plugins-conf","defaultMode":420}},{"name":"rabbitmq-confd","projected":{"sources":[{"secret":{"name":"rabbitmq-cluster-default-user","items":[{"key":"default_user.conf","path":"default_user.conf"}]}},{"configMap":{"name":"rabbitmq-cluster-server-conf","items":[{"key":"operatorDefaults.conf","path":"operatorDefaults.conf"},{"key":"userDefinedConfiguration.conf","path":"userDefinedConfiguration.conf"}]}}],"defaultMode":420}},{"name":"rabbitmq-erlang-cookie","emptyDir":{}},{"name":"erlang-cookie-secret","secret":{"secretName":"rabbitmq-cluster-erlang-cookie","defaultMode":420}},{"name":"rabbitmq-plugins","emptyDir":{}},{"name":"pod-info","downwardAPI":{"items":[{"path":"skipPreStopChecks","fieldRef":{"apiVersion":"v1","fieldPath":"metadata.labels['skipPreStopChecks']"}}],"defaultMode":420}}],"initContainers":[{"name":"setup-container","image":"rabbitmq:3.8.12-management","command":["sh","-c","cp /tmp/erlang-cookie-secret/.erlang.cookie /var/lib/rabbitmq/.erlang.cookie \u0026\u0026 chown 999:999 /var/lib/rabbitmq/.erlang.cookie \u0026\u0026 chmod 600 /var/lib/rabbitmq/.erlang.cookie ; cp /tmp/rabbitmq-plugins/enabled_plugins /operator/enabled_plugins \u0026\u0026 chown 999:999 /operator/enabled_plugins ; chown 999:999 /var/lib/rabbitmq/mnesia/ ; echo '[default]' \u003e /var/lib/rabbitmq/.rabbitmqadmin.conf \u0026\u0026 sed -e 's/default_user/username/' -e 's/default_pass/password/' /tmp/default_user.conf \u003e\u003e /var/lib/rabbitmq/.rabbitmqadmin.conf \u0026\u0026 chown 999:999 /var/lib/rabbitmq/.rabbitmqadmin.conf \u0026\u0026 chmod 600 /var/lib/rabbitmq/.rabbitmqadmin.conf"],"resources":{"limits":{"cpu":"100m","memory":"500Mi"},"requests":{"cpu":"100m","memory":"500Mi"}},"volumeMounts":[{"name":"plugins-conf","mountPath":"/tmp/rabbitmq-plugins/"},{"name":"rabbitmq-erlang-cookie","mountPath":"/var/lib/rabbitmq/"},{"name":"erlang-cookie-secret","mountPath":"/tmp/erlang-cookie-secret/"},{"name":"rabbitmq-plugins","mountPath":"/operator"},{"name":"persistence","mountPath":"/var/lib/rabbitmq/mnesia/"},{"name":"rabbitmq-confd","mountPath":"/tmp/default_user.conf","subPath":"default_user.conf"}],"terminationMessagePath":"/dev/termination-log","terminationMessagePolicy":"File","imagePullPolicy":"IfNotPresent","securityContext":{"capabilities":{"drop":["FSETID","KILL","SETGID","SETUID","SETPCAP","NET_BIND_SERVICE","NET_RAW","SYS_CHROOT","MKNOD","AUDIT_WRITE","SETFCAP"]},"runAsUser":0}}],"containers":[{"name":"rabbitmq","image":"rabbitmq:3.8.12-management","ports":[{"name":"epmd","containerPort":4369,"protocol":"TCP"},{"name":"amqp","containerPort":5672,"protocol":"TCP"},{"name":"management","containerPort":15672,"protocol":"TCP"},{"name":"prometheus","containerPort":15692,"protocol":"TCP"}],"env":[{"name":"MY_POD_NAME","valueFrom":{"fieldRef":{"apiVersion":"v1","fieldPath":"metadata.name"}}},{"name":"MY_POD_NAMESPACE","valueFrom":{"fieldRef":{"apiVersion":"v1","fieldPath":"metadata.namespace"}}},{"name":"RABBITMQ_ENABLED_PLUGINS_FILE","value":"/operator/enabled_plugins"},{"name":"K8S_SERVICE_NAME","value":"rabbitmq-cluster-nodes"},{"name":"RABBITMQ_USE_LONGNAME","value":"true"},{"name":"RABBITMQ_NODENAME","value":"rabbit@$(MY_POD_NAME).$(K8S_SERVICE_NAME).$(MY_POD_NAMESPACE)"},{"name":"K8S_HOSTNAME_SUFFIX","value":".$(K8S_SERVICE_NAME).$(MY_POD_NAMESPACE)"}],"resources":{"limits":{"cpu":"2","memory":"2Gi"},"requests":{"cpu":"1","memory":"2Gi"}},"volumeMounts":[{"name":"rabbitmq-erlang-cookie","mountPath":"/var/lib/rabbitmq/"},{"name":"persistence","mountPath":"/var/lib/rabbitmq/mnesia/"},{"name":"rabbitmq-plugins","mountPath":"/operator"},{"name":"rabbitmq-confd","mountPath":"/etc/rabbitmq/conf.d/10-operatorDefaults.conf","subPath":"operatorDefaults.conf"},{"name":"rabbitmq-confd","mountPath":"/etc/rabbitmq/conf.d/11-default_user.conf","subPath":"default_user.conf"},{"name":"rabbitmq-confd","mountPath":"/etc/rabbitmq/conf.d/90-userDefinedConfiguration.conf","subPath":"userDefinedConfiguration.conf"},{"name":"pod-info","mountPath":"/etc/pod-info/"}],"readinessProbe":{"tcpSocket":{"port":"amqp"},"initialDelaySeconds":10,"timeoutSeconds":5,"periodSeconds":10,"successThreshold":1,"failureThreshold":3},"lifecycle":{"preStop":{"exec":{"command":["/bin/bash","-c","if [ ! -z \"$(cat /etc/pod-info/skipPreStopChecks)\" ]; then exit 0; fi; rabbitmq-upgrade await_online_quorum_plus_one -t 604800; rabbitmq-upgrade await_online_synchronized_mirror -t 604800; rabbitmq-upgrade drain -t 604800"]}}},"terminationMessagePath":"/dev/termination-log","terminationMessagePolicy":"File","imagePullPolicy":"IfNotPresent"}],"restartPolicy":"Always","terminationGracePeriodSeconds":604800,"dnsPolicy":"ClusterFirst","serviceAccountName":"rabbitmq-cluster-server","serviceAccount":"rabbitmq-cluster-server","automountServiceAccountToken":true,"securityContext":{"runAsUser":999,"runAsGroup":999,"fsGroup":999},"schedulerName":"default-scheduler","topologySpreadConstraints":[{"maxSkew":1,"topologyKey":"topology.kubernetes.io/zone","whenUnsatisfiable":"ScheduleAnyway","labelSelector":{"matchLabels":{"app.kubernetes.io/name":"rabbitmq-cluster"}}}]}},"volumeClaimTemplates":[{"metadata":{"name":"persistence","namespace":"default","creationTimestamp":null,"labels":{"app.kubernetes.io/component":"rabbitmq","app.kubernetes.io/name":"rabbitmq-cluster","app.kubernetes.io/part-of":"rabbitmq"},"ownerReferences":[{"apiVersion":"rabbitmq.com/v1beta1","kind":"RabbitmqCluster","name":"rabbitmq-cluster","uid":"18d9928b-0d1c-47be-80ec-20960d053827","controller":true,"blockOwnerDeletion":false}]},"spec":{"accessModes":["ReadWriteOnce"],"resources":{"requests":{"storage":"10Gi"}},"volumeMode":"Filesystem"},"status":{"phase":"Pending"}}],"serviceName":"rabbitmq-cluster-nodes","podManagementPolicy":"Parallel","updateStrategy":{"type":"RollingUpdate","rollingUpdate":{"partition":0}},"revisionHistoryLimit":10},"status":{"observedGeneration":2,"replicas":3,"readyReplicas":1,"currentReplicas":3,"updatedReplicas":3,"currentRevision":"rabbitmq-cluster-server-5f8b8665fb","updateRevision":"rabbitmq-cluster-server-5f8b8665fb","collisionCount":0}}
2022/03/18 18:01:23 learn_server.go:253: [SIEVE-AFTER-RECONCILE]	github.com/rabbitmq/cluster-operator/controllers.(*RabbitmqClusterReconciler)	11
2022/03/18 18:01:38 learn_server.go:238: [SIEVE-BEFORE-RECONCILE]	github.com/rabbitmq/cluster-operator/controllers.(*RabbitmqClusterReconciler)	12
2022/03/18 18:01:38 learn_server.go:291: [SIEVE-AFTER-READ]	Get	true	rabbitmqcluster	default	rabbitmq-cluster	github.com/rabbitmq/cluster-operator/controllers.(*RabbitmqClusterReconciler)	NoError	{"kind":"RabbitmqCluster","apiVersion":"rabbitmq.com/v1beta1","metadata":{"name":"rabbitmq-cluster","namespace":"default","selfLink":"/apis/rabbitmq.com/v1beta1/namespaces/default/rabbitmqclusters/rabbitmq-cluster","uid":"18d9928b-0d1c-47be-80ec-20960d053827","resourceVersion":"977","generation":3,"creationTimestamp":"2022-03-18T18:00:38Z","annotations":{"kubectl.kubernetes.io/last-applied-configuration":"{\"apiVersion\":\"rabbitmq.com/v1beta1\",\"kind\":\"RabbitmqCluster\",\"metadata\":{\"annotations\":{},\"name\":\"rabbitmq-cluster\",\"namespace\":\"default\"},\"spec\":{\"persistence\":{\"storage\":\"10Gi\"},\"replicas\":1}}\n"},"finalizers":["deletion.finalizers.rabbitmqclusters.rabbitmq.com"],"managedFields":[{"manager":"kubectl-client-side-apply","operation":"Update","apiVersion":"rabbitmq.com/v1beta1","time":"2022-03-18T18:00:38Z","fieldsType":"FieldsV1","fieldsV1":{"f:metadata":{"f:annotations":{".":{},"f:kubectl.kubernetes.io/last-applied-configuration":{}}},"f:spec":{".":{},"f:image":{},"f:persistence":{".":{},"f:storage":{}},"f:resources":{".":{},"f:limits":{".":{},"f:memory":{}},"f:requests":{".":{},"f:memory":{}}},"f:service":{".":{},"f:type":{}},"f:terminationGracePeriodSeconds":{}}}},{"manager":"kubectl-patch","operation":"Update","apiVersion":"rabbitmq.com/v1beta1","time":"2022-03-18T18:01:23Z","fieldsType":"FieldsV1","fieldsV1":{"f:spec":{"f:replicas":{}}}},{"manager":"manager","operation":"Update","apiVersion":"rabbitmq.com/v1beta1","time":"2022-03-18T18:01:23Z","fieldsType":"FieldsV1","fieldsV1":{"f:metadata":{"f:finalizers":{}},"f:spec":{"f:override":{},"f:rabbitmq":{},"f:resources":{"f:limits":{"f:cpu":{}},"f:requests":{"f:cpu":{}}},"f:tls":{}},"f:status":{".":{},"f:conditions":{},"f:defaultUser":{".":{},"f:secretReference":{".":{},"f:keys":{".":{},"f:password":{},"f:username":{}},"f:name":{},"f:namespace":{}},"f:serviceReference":{".":{},"f:name":{},"f:namespace":{}}}}}}]},"spec":{"replicas":3,"image":"rabbitmq:3.8.12-management","service":{"type":"ClusterIP"},"persistence":{"storage":"10Gi"},"resources":{"limits":{"cpu":"2","memory":"2Gi"},"requests":{"cpu":"1","memory":"2Gi"}},"rabbitmq":{},"tls":{},"override":{},"terminationGracePeriodSeconds":604800},"status":{"conditions":[{"type":"AllReplicasReady","status":"False","lastTransitionTime":"2022-03-18T18:01:23Z","reason":"NotAllPodsReady","message":"1/3 Pods ready"},{"type":"ClusterAvailable","status":"True","lastTransitionTime":"2022-03-18T18:01:17Z","reason":"AtLeastOneEndpointAvailable"},{"type":"NoWarnings","status":"True","lastTransitionTime":"2022-03-18T18:00:38Z","reason":"NoWarnings"},{"type":"ReconcileSuccess","status":"True","lastTransitionTime":"2022-03-18T18:01:18Z","reason":"Success","message":"Finish reconciling"}],"defaultUser":{"secretReference":{"name":"rabbitmq-cluster-default-user","namespace":"default","keys":{"password":"password","username":"username"}},"serviceReference":{"name":"rabbitmq-cluster","namespace":"default"}}}}
2022/03/18 18:01:38 learn_server.go:291: [SIEVE-AFTER-READ]	Get	true	statefulset	default	rabbitmq-cluster-server	github.com/rabbitmq/cluster-operator/controllers.(*RabbitmqClusterReconciler)	NoError	{"kind":"StatefulSet","apiVersion":"apps/v1","metadata":{"name":"rabbitmq-cluster-server","namespace":"default","selfLink":"/apis/apps/v1/namespaces/default/statefulsets/rabbitmq-cluster-server","uid":"cb5c43bc-6ee7-481c-ab01-6f3acffdd3c8","resourceVersion":"989","generation":2,"creationTimestamp":"2022-03-18T18:00:38Z","labels":{"app.kubernetes.io/component":"rabbitmq","app.kubernetes.io/name":"rabbitmq-cluster","app.kubernetes.io/part-of":"rabbitmq"},"ownerReferences":[{"apiVersion":"rabbitmq.com/v1beta1","kind":"RabbitmqCluster","name":"rabbitmq-cluster","uid":"18d9928b-0d1c-47be-80ec-20960d053827","controller":true,"blockOwnerDeletion":true}],"managedFields":[{"manager":"kube-controller-manager","operation":"Update","apiVersion":"apps/v1","time":"2022-03-18T18:01:23Z","fieldsType":"FieldsV1","fieldsV1":{"f:status":{"f:collisionCount":{},"f:currentReplicas":{},"f:currentRevision":{},"f:observedGeneration":{},"f:readyReplicas":{},"f:replicas":{},"f:updateRevision":{},"f:updatedReplicas":{}}}},{"manager":"manager","operation":"Update","apiVersion":"apps/v1","time":"2022-03-18T18:01:23Z","fieldsType":"FieldsV1","fieldsV1":{"f:metadata":{"f:labels":{".":{},"f:app.kubernetes.io/component":{},"f:app.kubernetes.io/name":{},"f:app.kubernetes.io/part-of":{}},"f:ownerReferences":{".":{},"k:{\"uid\":\"18d9928b-0d1c-47be-80ec-20960d053827\"}":{".":{},"f:apiVersion":{},"f:blockOwnerDeletion":{},"f:controller":{},"f:kind":{},"f:name":{},"f:uid":{}}}},"f:spec":{"f:podManagementPolicy":{},"f:replicas":{},"f:revisionHistoryLimit":{},"f:selector":{"f:matchLabels":{".":{},"f:app.kubernetes.io/name":{}}},"f:serviceName":{},"f:template":{"f:metadata":{"f:annotations":{".":{},"f:prometheus.io/port":{},"f:prometheus.io/scrape":{}},"f:labels":{".":{},"f:app.kubernetes.io/component":{},"f:app.kubernetes.io/name":{},"f:app.kubernetes.io/part-of":{}}},"f:spec":{"f:automountServiceAccountToken":{},"f:containers":{"k:{\"name\":\"rabbitmq\"}":{".":{},"f:env":{".":{},"k:{\"name\":\"K8S_HOSTNAME_SUFFIX\"}":{".":{},"f:name":{},"f:value":{}},"k:{\"name\":\"K8S_SERVICE_NAME\"}":{".":{},"f:name":{},"f:value":{}},"k:{\"name\":\"MY_POD_NAME\"}":{".":{},"f:name":{},"f:valueFrom":{".":{},"f:fieldRef":{".":{},"f:apiVersion":{},"f:fieldPath":{}}}},"k:{\"name\":\"MY_POD_NAMESPACE\"}":{".":{},"f:name":{},"f:valueFrom":{".":{},"f:fieldRef":{".":{},"f:apiVersion":{},"f:fieldPath":{}}}},"k:{\"name\":\"RABBITMQ_ENABLED_PLUGINS_FILE\"}":{".":{},"f:name":{},"f:value":{}},"k:{\"name\":\"RABBITMQ_NODENAME\"}":{".":{},"f:name":{},"f:value":{}},"k:{\"name\":\"RABBITMQ_USE_LONGNAME\"}":{".":{},"f:name":{},"f:value":{}}},"f:image":{},"f:imagePullPolicy":{},"f:lifecycle":{".":{},"f:preStop":{".":{},"f:exec":{".":{},"f:command":{}}}},"f:name":{},"f:ports":{".":{},"k:{\"containerPort\":4369,\"protocol\":\"TCP\"}":{".":{},"f:containerPort":{},"f:name":{},"f:protocol":{}},"k:{\"containerPort\":5672,\"protocol\":\"TCP\"}":{".":{},"f:containerPort":{},"f:name":{},"f:protocol":{}},"k:{\"containerPort\":15672,\"protocol\":\"TCP\"}":{".":{},"f:containerPort":{},"f:name":{},"f:protocol":{}},"k:{\"containerPort\":15692,\"protocol\":\"TCP\"}":{".":{},"f:containerPort":{},"f:name":{},"f:protocol":{}}},"f:readinessProbe":{".":{},"f:failureThreshold":{},"f:initialDelaySeconds":{},"f:periodSeconds":{},"f:successThreshold":{},"f:tcpSocket":{".":{},"f:port":{}},"f:timeoutSeconds":{}},"f:resources":{".":{},"f:limits":{".":{},"f:cpu":{},"f:memory":{}},"f:requests":{".":{},"f:cpu":{},"f:memory":{}}},"f:terminationMessagePath":{},"f:terminationMessagePolicy":{},"f:volumeMounts":{".":{},"k:{\"mountPath\":\"/etc/pod-info/\"}":{".":{},"f:mountPath":{},"f:name":{}},"k:{\"mountPath\":\"/etc/rabbitmq/conf.d/10-operatorDefaults.conf\"}":{".":{},"f:mountPath":{},"f:name":{},"f:subPath":{}},"k:{\"mountPath\":\"/etc/rabbitmq/conf.d/11-default_user.conf\"}":{".":{},"f:mountPath":{},"f:name":{},"f:subPath":{}},"k:{\"mountPath\":\"/etc/rabbitmq/conf.d/90-userDefinedConfiguration.conf\"}":{".":{},"f:mountPath":{},"f:name":{},"f:subPath":{}},"k:{\"mountPath\":\"/operator\"}":{".":{},"f:mountPath":{},"f:name":{}},"k:{\"mountPath\":\"/var/lib/rabbitmq/\"}":{".":{},"f:mountPath":{},"f:name":{}},"k:{\"mountPath\":\"/var/lib/rabbitmq/mnesia/\"}":{".":{},"f:mountPath":{},"f:name":{}}}}},"f:dnsPolicy":{},"f:initContainers":{".":{},"k:{\"name\":\"setup-container\"}":{".":{},"f:command":{},"f:image":{},"f:imagePullPolicy":{},"f:name":{},"f:resources":{".":{},"f:limits":{".":{},"f:cpu":{},"f:memory":{}},"f:requests":{".":{},"f:cpu":{},"f:memory":{}}},"f:securityContext":{".":{},"f:capabilities":{".":{},"f:drop":{}},"f:runAsUser":{}},"f:terminationMessagePath":{},"f:terminationMessagePolicy":{},"f:volumeMounts":{".":{},"k:{\"mountPath\":\"/operator\"}":{".":{},"f:mountPath":{},"f:name":{}},"k:{\"mountPath\":\"/tmp/default_user.conf\"}":{".":{},"f:mountPath":{},"f:name":{},"f:subPath":{}},"k:{\"mountPath\":\"/tmp/erlang-cookie-secret/\"}":{".":{},"f:mountPath":{},"f:name":{}},"k:{\"mountPath\":\"/tmp/rabbitmq-plugins/\"}":{".":{},"f:mountPath":{},"f:name":{}},"k:{\"mountPath\":\"/var/lib/rabbitmq/\"}":{".":{},"f:mountPath":{},"f:name":{}},"k:{\"mountPath\":\"/var/lib/rabbitmq/mnesia/\"}":{".":{},"f:mountPath":{},"f:name":{}}}}},"f:restartPolicy":{},"f:schedulerName":{},"f:securityContext":{".":{},"f:fsGroup":{},"f:runAsGroup":{},"f:runAsUser":{}},"f:serviceAccount":{},"f:serviceAccountName":{},"f:terminationGracePeriodSeconds":{},"f:topologySpreadConstraints":{".":{},"k:{\"topologyKey\":\"topology.kubernetes.io/zone\",\"whenUnsatisfiable\":\"ScheduleAnyway\"}":{".":{},"f:labelSelector":{".":{},"f:matchLabels":{".":{},"f:app.kubernetes.io/name":{}}},"f:maxSkew":{},"f:topologyKey":{},"f:whenUnsatisfiable":{}}},"f:volumes":{".":{},"k:{\"name\":\"erlang-cookie-secret\"}":{".":{},"f:name":{},"f:secret":{".":{},"f:defaultMode":{},"f:secretName":{}}},"k:{\"name\":\"plugins-conf\"}":{".":{},"f:configMap":{".":{},"f:defaultMode":{},"f:name":{}},"f:name":{}},"k:{\"name\":\"pod-info\"}":{".":{},"f:downwardAPI":{".":{},"f:defaultMode":{},"f:items":{}},"f:name":{}},"k:{\"name\":\"rabbitmq-confd\"}":{".":{},"f:name":{},"f:projected":{".":{},"f:defaultMode":{},"f:sources":{}}},"k:{\"name\":\"rabbitmq-erlang-cookie\"}":{".":{},"f:emptyDir":{},"f:name":{}},"k:{\"name\":\"rabbitmq-plugins\"}":{".":{},"f:emptyDir":{},"f:name":{}}}}},"f:updateStrategy":{"f:rollingUpdate":{".":{},"f:partition":{}},"f:type":{}},"f:volumeClaimTemplates":{}}}}]},"spec":{"replicas":3,"selector":{"matchLabels":{"app.kubernetes.io/name":"rabbitmq-cluster"}},"template":{"metadata":{"creationTimestamp":null,"labels":{"app.kubernetes.io/component":"rabbitmq","app.kubernetes.io/name":"rabbitmq-cluster","app.kubernetes.io/part-of":"rabbitmq"},"annotations":{"prometheus.io/port":"15692","prometheus.io/scrape":"true"}},"spec":{"volumes":[{"name":"plugins-conf","configMap":{"name":"rabbitmq-cluster-plugins-conf","defaultMode":420}},{"name":"rabbitmq-confd","projected":{"sources":[{"secret":{"name":"rabbitmq-cluster-default-user","items":[{"key":"default_user.conf","path":"default_user.conf"}]}},{"configMap":{"name":"rabbitmq-cluster-server-conf","items":[{"key":"operatorDefaults.conf","path":"operatorDefaults.conf"},{"key":"userDefinedConfiguration.conf","path":"userDefinedConfiguration.conf"}]}}],"defaultMode":420}},{"name":"rabbitmq-erlang-cookie","emptyDir":{}},{"name":"erlang-cookie-secret","secret":{"secretName":"rabbitmq-cluster-erlang-cookie","defaultMode":420}},{"name":"rabbitmq-plugins","emptyDir":{}},{"name":"pod-info","downwardAPI":{"items":[{"path":"skipPreStopChecks","fieldRef":{"apiVersion":"v1","fieldPath":"metadata.labels['skipPreStopChecks']"}}],"defaultMode":420}}],"initContainers":[{"name":"setup-container","image":"rabbitmq:3.8.12-management","command":["sh","-c","cp /tmp/erlang-cookie-secret/.erlang.cookie /var/lib/rabbitmq/.erlang.cookie \u0026\u0026 chown 999:999 /var/lib/rabbitmq/.erlang.cookie \u0026\u0026 chmod 600 /var/lib/rabbitmq/.erlang.cookie ; cp /tmp/rabbitmq-plugins/enabled_plugins /operator/enabled_plugins \u0026\u0026 chown 999:999 /operator/enabled_plugins ; chown 999:999 /var/lib/rabbitmq/mnesia/ ; echo '[default]' \u003e /var/lib/rabbitmq/.rabbitmqadmin.conf \u0026\u0026 sed -e 's/default_user/username/' -e 's/default_pass/password/' /tmp/default_user.conf \u003e\u003e /var/lib/rabbitmq/.rabbitmqadmin.conf \u0026\u0026 chown 999:999 /var/lib/rabbitmq/.rabbitmqadmin.conf \u0026\u0026 chmod 600 /var/lib/rabbitmq/.rabbitmqadmin.conf"],"resources":{"limits":{"cpu":"100m","memory":"500Mi"},"requests":{"cpu":"100m","memory":"500Mi"}},"volumeMounts":[{"name":"plugins-conf","mountPath":"/tmp/rabbitmq-plugins/"},{"name":"rabbitmq-erlang-cookie","mountPath":"/var/lib/rabbitmq/"},{"name":"erlang-cookie-secret","mountPath":"/tmp/erlang-cookie-secret/"},{"name":"rabbitmq-plugins","mountPath":"/operator"},{"name":"persistence","mountPath":"/var/lib/rabbitmq/mnesia/"},{"name":"rabbitmq-confd","mountPath":"/tmp/default_user.conf","subPath":"default_user.conf"}],"terminationMessagePath":"/dev/termination-log","terminationMessagePolicy":"File","imagePullPolicy":"IfNotPresent","securityContext":{"capabilities":{"drop":["FSETID","KILL","SETGID","SETUID","SETPCAP","NET_BIND_SERVICE","NET_RAW","SYS_CHROOT","MKNOD","AUDIT_WRITE","SETFCAP"]},"runAsUser":0}}],"containers":[{"name":"rabbitmq","image":"rabbitmq:3.8.12-management","ports":[{"name":"epmd","containerPort":4369,"protocol":"TCP"},{"name":"amqp","containerPort":5672,"protocol":"TCP"},{"name":"management","containerPort":15672,"protocol":"TCP"},{"name":"prometheus","containerPort":15692,"protocol":"TCP"}],"env":[{"name":"MY_POD_NAME","valueFrom":{"fieldRef":{"apiVersion":"v1","fieldPath":"metadata.name"}}},{"name":"MY_POD_NAMESPACE","valueFrom":{"fieldRef":{"apiVersion":"v1","fieldPath":"metadata.namespace"}}},{"name":"RABBITMQ_ENABLED_PLUGINS_FILE","value":"/operator/enabled_plugins"},{"name":"K8S_SERVICE_NAME","value":"rabbitmq-cluster-nodes"},{"name":"RABBITMQ_USE_LONGNAME","value":"true"},{"name":"RABBITMQ_NODENAME","value":"rabbit@$(MY_POD_NAME).$(K8S_SERVICE_NAME).$(MY_POD_NAMESPACE)"},{"name":"K8S_HOSTNAME_SUFFIX","value":".$(K8S_SERVICE_NAME).$(MY_POD_NAMESPACE)"}],"resources":{"limits":{"cpu":"2","memory":"2Gi"},"requests":{"cpu":"1","memory":"2Gi"}},"volumeMounts":[{"name":"rabbitmq-erlang-cookie","mountPath":"/var/lib/rabbitmq/"},{"name":"persistence","mountPath":"/var/lib/rabbitmq/mnesia/"},{"name":"rabbitmq-plugins","mountPath":"/operator"},{"name":"rabbitmq-confd","mountPath":"/etc/rabbitmq/conf.d/10-operatorDefaults.conf","subPath":"operatorDefaults.conf"},{"name":"rabbitmq-confd","mountPath":"/etc/rabbitmq/conf.d/11-default_user.conf","subPath":"default_user.conf"},{"name":"rabbitmq-confd","mountPath":"/etc/rabbitmq/conf.d/90-userDefinedConfiguration.conf","subPath":"userDefinedConfiguration.conf"},{"name":"pod-info","mountPath":"/etc/pod-info/"}],"readinessProbe":{"tcpSocket":{"port":"amqp"},"initialDelaySeconds":10,"timeoutSeconds":5,"periodSeconds":10,"successThreshold":1,"failureThreshold":3},"lifecycle":{"preStop":{"exec":{"command":["/bin/bash","-c","if [ ! -z \"$(cat /etc/pod-info/skipPreStopChecks)\" ]; then exit 0; fi; rabbitmq-upgrade await_online_quorum_plus_one -t 604800; rabbitmq-upgrade await_online_synchronized_mirror -t 604800; rabbitmq-upgrade drain -t 604800"]}}},"terminationMessagePath":"/dev/termination-log","terminationMessagePolicy":"File","imagePullPolicy":"IfNotPresent"}],"restartPolicy":"Always","terminationGracePeriodSeconds":604800,"dnsPolicy":"ClusterFirst","serviceAccountName":"rabbitmq-cluster-server","serviceAccount":"rabbitmq-cluster-server","automountServiceAccountToken":true,"securityContext":{"runAsUser":999,"runAsGroup":999,"fsGroup":999},"schedulerName":"default-scheduler","topologySpreadConstraints":[{"maxSkew":1,"topologyKey":"topology.kubernetes.io/zone","whenUnsatisfiable":"ScheduleAnyway","labelSelector":{"matchLabels":{"app.kubernetes.io/name":"rabbitmq-cluster"}}}]}},"volumeClaimTemplates":[{"metadata":{"name":"persistence","namespace":"default","creationTimestamp":null,"labels":{"app.kubernetes.io/component":"rabbitmq","app.kubernetes.io/name":"rabbitmq-cluster","app.kubernetes.io/part-of":"rabbitmq"},"ownerReferences":[{"apiVersion":"rabbitmq.com/v1beta1","kind":"RabbitmqCluster","name":"rabbitmq-cluster","uid":"18d9928b-0d1c-47be-80ec-20960d053827","controller":true,"blockOwnerDeletion":false}]},"spec":{"accessModes":["ReadWriteOnce"],"resources":{"requests":{"storage":"10Gi"}},"volumeMode":"Filesystem"},"status":{"phase":"Pending"}}],"serviceName":"rabbitmq-cluster-nodes","podManagementPolicy":"Parallel","updateStrategy":{"type":"RollingUpdate","rollingUpdate":{"partition":0}},"revisionHistoryLimit":10},"status":{"observedGeneration":2,"replicas":3,"readyReplicas":1,"currentReplicas":3,"updatedReplicas":3,"currentRevision":"rabbitmq-cluster-server-5f8b8665fb","updateRevision":"rabbitmq-cluster-server-5f8b8665fb","collisionCount":0}}
2022/03/18 18:01:38 learn_server.go:291: [SIEVE-AFTER-READ]	Get	true	endpoints	default	rabbitmq-cluster	github.com/rabbitmq/cluster-operator/controllers.(*RabbitmqClusterReconciler)	NoError	{"kind":"Endpoints","apiVersion":"v1","metadata":{"name":"rabbitmq-cluster","namespace":"default","selfLink":"/api/v1/namespaces/default/endpoints/rabbitmq-cluster","uid":"5c4723ad-f4fe-442d-9135-44879a2a8183","resourceVersion":"1088","creationTimestamp":"2022-03-18T18:00:38Z","labels":{"app.kubernetes.io/component":"rabbitmq","app.kubernetes.io/name":"rabbitmq-cluster","app.kubernetes.io/part-of":"rabbitmq"},"managedFields":[{"manager":"kube-controller-manager","operation":"Update","apiVersion":"v1","time":"2022-03-18T18:01:33Z","fieldsType":"FieldsV1","fieldsV1":{"f:metadata":{"f:labels":{".":{},"f:app.kubernetes.io/component":{},"f:app.kubernetes.io/name":{},"f:app.kubernetes.io/part-of":{}}},"f:subsets":{}}}]},"subsets":[{"addresses":[{"ip":"10.244.1.4","nodeName":"kind-worker2","targetRef":{"kind":"Pod","namespace":"default","name":"rabbitmq-cluster-server-0","uid":"e7faffc5-b656-4e69-9777-92d12cb6ec5a","resourceVersion":"938"}}],"notReadyAddresses":[{"ip":"10.244.2.4","nodeName":"kind-worker","targetRef":{"kind":"Pod","namespace":"default","name":"rabbitmq-cluster-server-1","uid":"7a37da00-25d1-48b6-a659-4390fb7a02cb","resourceVersion":"1086"}},{"ip":"10.244.2.5","nodeName":"kind-worker","targetRef":{"kind":"Pod","namespace":"default","name":"rabbitmq-cluster-server-2","uid":"2a54a659-a979-4e10-8e74-1e0b83d532ba","resourceVersion":"1081"}}],"ports":[{"name":"amqp","port":5672,"protocol":"TCP"},{"name":"management","port":15672,"protocol":"TCP"}]}]}
2022/03/18 18:01:38 learn_server.go:291: [SIEVE-AFTER-READ]	Get	true	statefulset	default	rabbitmq-cluster-server	github.com/rabbitmq/cluster-operator/controllers.(*RabbitmqClusterReconciler)	NoError	{"kind":"StatefulSet","apiVersion":"apps/v1","metadata":{"name":"rabbitmq-cluster-server","namespace":"default","selfLink":"/apis/apps/v1/namespaces/default/statefulsets/rabbitmq-cluster-server","uid":"cb5c43bc-6ee7-481c-ab01-6f3acffdd3c8","resourceVersion":"989","generation":2,"creationTimestamp":"2022-03-18T18:00:38Z","labels":{"app.kubernetes.io/component":"rabbitmq","app.kubernetes.io/name":"rabbitmq-cluster","app.kubernetes.io/part-of":"rabbitmq"},"ownerReferences":[{"apiVersion":"rabbitmq.com/v1beta1","kind":"RabbitmqCluster","name":"rabbitmq-cluster","uid":"18d9928b-0d1c-47be-80ec-20960d053827","controller":true,"blockOwnerDeletion":true}],"managedFields":[{"manager":"kube-controller-manager","operation":"Update","apiVersion":"apps/v1","time":"2022-03-18T18:01:23Z","fieldsType":"FieldsV1","fieldsV1":{"f:status":{"f:collisionCount":{},"f:currentReplicas":{},"f:currentRevision":{},"f:observedGeneration":{},"f:readyReplicas":{},"f:replicas":{},"f:updateRevision":{},"f:updatedReplicas":{}}}},{"manager":"manager","operation":"Update","apiVersion":"apps/v1","time":"2022-03-18T18:01:23Z","fieldsType":"FieldsV1","fieldsV1":{"f:metadata":{"f:labels":{".":{},"f:app.kubernetes.io/component":{},"f:app.kubernetes.io/name":{},"f:app.kubernetes.io/part-of":{}},"f:ownerReferences":{".":{},"k:{\"uid\":\"18d9928b-0d1c-47be-80ec-20960d053827\"}":{".":{},"f:apiVersion":{},"f:blockOwnerDeletion":{},"f:controller":{},"f:kind":{},"f:name":{},"f:uid":{}}}},"f:spec":{"f:podManagementPolicy":{},"f:replicas":{},"f:revisionHistoryLimit":{},"f:selector":{"f:matchLabels":{".":{},"f:app.kubernetes.io/name":{}}},"f:serviceName":{},"f:template":{"f:metadata":{"f:annotations":{".":{},"f:prometheus.io/port":{},"f:prometheus.io/scrape":{}},"f:labels":{".":{},"f:app.kubernetes.io/component":{},"f:app.kubernetes.io/name":{},"f:app.kubernetes.io/part-of":{}}},"f:spec":{"f:automountServiceAccountToken":{},"f:containers":{"k:{\"name\":\"rabbitmq\"}":{".":{},"f:env":{".":{},"k:{\"name\":\"K8S_HOSTNAME_SUFFIX\"}":{".":{},"f:name":{},"f:value":{}},"k:{\"name\":\"K8S_SERVICE_NAME\"}":{".":{},"f:name":{},"f:value":{}},"k:{\"name\":\"MY_POD_NAME\"}":{".":{},"f:name":{},"f:valueFrom":{".":{},"f:fieldRef":{".":{},"f:apiVersion":{},"f:fieldPath":{}}}},"k:{\"name\":\"MY_POD_NAMESPACE\"}":{".":{},"f:name":{},"f:valueFrom":{".":{},"f:fieldRef":{".":{},"f:apiVersion":{},"f:fieldPath":{}}}},"k:{\"name\":\"RABBITMQ_ENABLED_PLUGINS_FILE\"}":{".":{},"f:name":{},"f:value":{}},"k:{\"name\":\"RABBITMQ_NODENAME\"}":{".":{},"f:name":{},"f:value":{}},"k:{\"name\":\"RABBITMQ_USE_LONGNAME\"}":{".":{},"f:name":{},"f:value":{}}},"f:image":{},"f:imagePullPolicy":{},"f:lifecycle":{".":{},"f:preStop":{".":{},"f:exec":{".":{},"f:command":{}}}},"f:name":{},"f:ports":{".":{},"k:{\"containerPort\":4369,\"protocol\":\"TCP\"}":{".":{},"f:containerPort":{},"f:name":{},"f:protocol":{}},"k:{\"containerPort\":5672,\"protocol\":\"TCP\"}":{".":{},"f:containerPort":{},"f:name":{},"f:protocol":{}},"k:{\"containerPort\":15672,\"protocol\":\"TCP\"}":{".":{},"f:containerPort":{},"f:name":{},"f:protocol":{}},"k:{\"containerPort\":15692,\"protocol\":\"TCP\"}":{".":{},"f:containerPort":{},"f:name":{},"f:protocol":{}}},"f:readinessProbe":{".":{},"f:failureThreshold":{},"f:initialDelaySeconds":{},"f:periodSeconds":{},"f:successThreshold":{},"f:tcpSocket":{".":{},"f:port":{}},"f:timeoutSeconds":{}},"f:resources":{".":{},"f:limits":{".":{},"f:cpu":{},"f:memory":{}},"f:requests":{".":{},"f:cpu":{},"f:memory":{}}},"f:terminationMessagePath":{},"f:terminationMessagePolicy":{},"f:volumeMounts":{".":{},"k:{\"mountPath\":\"/etc/pod-info/\"}":{".":{},"f:mountPath":{},"f:name":{}},"k:{\"mountPath\":\"/etc/rabbitmq/conf.d/10-operatorDefaults.conf\"}":{".":{},"f:mountPath":{},"f:name":{},"f:subPath":{}},"k:{\"mountPath\":\"/etc/rabbitmq/conf.d/11-default_user.conf\"}":{".":{},"f:mountPath":{},"f:name":{},"f:subPath":{}},"k:{\"mountPath\":\"/etc/rabbitmq/conf.d/90-userDefinedConfiguration.conf\"}":{".":{},"f:mountPath":{},"f:name":{},"f:subPath":{}},"k:{\"mountPath\":\"/operator\"}":{".":{},"f:mountPath":{},"f:name":{}},"k:{\"mountPath\":\"/var/lib/rabbitmq/\"}":{".":{},"f:mountPath":{},"f:name":{}},"k:{\"mountPath\":\"/var/lib/rabbitmq/mnesia/\"}":{".":{},"f:mountPath":{},"f:name":{}}}}},"f:dnsPolicy":{},"f:initContainers":{".":{},"k:{\"name\":\"setup-container\"}":{".":{},"f:command":{},"f:image":{},"f:imagePullPolicy":{},"f:name":{},"f:resources":{".":{},"f:limits":{".":{},"f:cpu":{},"f:memory":{}},"f:requests":{".":{},"f:cpu":{},"f:memory":{}}},"f:securityContext":{".":{},"f:capabilities":{".":{},"f:drop":{}},"f:runAsUser":{}},"f:terminationMessagePath":{},"f:terminationMessagePolicy":{},"f:volumeMounts":{".":{},"k:{\"mountPath\":\"/operator\"}":{".":{},"f:mountPath":{},"f:name":{}},"k:{\"mountPath\":\"/tmp/default_user.conf\"}":{".":{},"f:mountPath":{},"f:name":{},"f:subPath":{}},"k:{\"mountPath\":\"/tmp/erlang-cookie-secret/\"}":{".":{},"f:mountPath":{},"f:name":{}},"k:{\"mountPath\":\"/tmp/rabbitmq-plugins/\"}":{".":{},"f:mountPath":{},"f:name":{}},"k:{\"mountPath\":\"/var/lib/rabbitmq/\"}":{".":{},"f:mountPath":{},"f:name":{}},"k:{\"mountPath\":\"/var/lib/rabbitmq/mnesia/\"}":{".":{},"f:mountPath":{},"f:name":{}}}}},"f:restartPolicy":{},"f:schedulerName":{},"f:securityContext":{".":{},"f:fsGroup":{},"f:runAsGroup":{},"f:runAsUser":{}},"f:serviceAccount":{},"f:serviceAccountName":{},"f:terminationGracePeriodSeconds":{},"f:topologySpreadConstraints":{".":{},"k:{\"topologyKey\":\"topology.kubernetes.io/zone\",\"whenUnsatisfiable\":\"ScheduleAnyway\"}":{".":{},"f:labelSelector":{".":{},"f:matchLabels":{".":{},"f:app.kubernetes.io/name":{}}},"f:maxSkew":{},"f:topologyKey":{},"f:whenUnsatisfiable":{}}},"f:volumes":{".":{},"k:{\"name\":\"erlang-cookie-secret\"}":{".":{},"f:name":{},"f:secret":{".":{},"f:defaultMode":{},"f:secretName":{}}},"k:{\"name\":\"plugins-conf\"}":{".":{},"f:configMap":{".":{},"f:defaultMode":{},"f:name":{}},"f:name":{}},"k:{\"name\":\"pod-info\"}":{".":{},"f:downwardAPI":{".":{},"f:defaultMode":{},"f:items":{}},"f:name":{}},"k:{\"name\":\"rabbitmq-confd\"}":{".":{},"f:name":{},"f:projected":{".":{},"f:defaultMode":{},"f:sources":{}}},"k:{\"name\":\"rabbitmq-erlang-cookie\"}":{".":{},"f:emptyDir":{},"f:name":{}},"k:{\"name\":\"rabbitmq-plugins\"}":{".":{},"f:emptyDir":{},"f:name":{}}}}},"f:updateStrategy":{"f:rollingUpdate":{".":{},"f:partition":{}},"f:type":{}},"f:volumeClaimTemplates":{}}}}]},"spec":{"replicas":3,"selector":{"matchLabels":{"app.kubernetes.io/name":"rabbitmq-cluster"}},"template":{"metadata":{"creationTimestamp":null,"labels":{"app.kubernetes.io/component":"rabbitmq","app.kubernetes.io/name":"rabbitmq-cluster","app.kubernetes.io/part-of":"rabbitmq"},"annotations":{"prometheus.io/port":"15692","prometheus.io/scrape":"true"}},"spec":{"volumes":[{"name":"plugins-conf","configMap":{"name":"rabbitmq-cluster-plugins-conf","defaultMode":420}},{"name":"rabbitmq-confd","projected":{"sources":[{"secret":{"name":"rabbitmq-cluster-default-user","items":[{"key":"default_user.conf","path":"default_user.conf"}]}},{"configMap":{"name":"rabbitmq-cluster-server-conf","items":[{"key":"operatorDefaults.conf","path":"operatorDefaults.conf"},{"key":"userDefinedConfiguration.conf","path":"userDefinedConfiguration.conf"}]}}],"defaultMode":420}},{"name":"rabbitmq-erlang-cookie","emptyDir":{}},{"name":"erlang-cookie-secret","secret":{"secretName":"rabbitmq-cluster-erlang-cookie","defaultMode":420}},{"name":"rabbitmq-plugins","emptyDir":{}},{"name":"pod-info","downwardAPI":{"items":[{"path":"skipPreStopChecks","fieldRef":{"apiVersion":"v1","fieldPath":"metadata.labels['skipPreStopChecks']"}}],"defaultMode":420}}],"initContainers":[{"name":"setup-container","image":"rabbitmq:3.8.12-management","command":["sh","-c","cp /tmp/erlang-cookie-secret/.erlang.cookie /var/lib/rabbitmq/.erlang.cookie \u0026\u0026 chown 999:999 /var/lib/rabbitmq/.erlang.cookie \u0026\u0026 chmod 600 /var/lib/rabbitmq/.erlang.cookie ; cp /tmp/rabbitmq-plugins/enabled_plugins /operator/enabled_plugins \u0026\u0026 chown 999:999 /operator/enabled_plugins ; chown 999:999 /var/lib/rabbitmq/mnesia/ ; echo '[default]' \u003e /var/lib/rabbitmq/.rabbitmqadmin.conf \u0026\u0026 sed -e 's/default_user/username/' -e 's/default_pass/password/' /tmp/default_user.conf \u003e\u003e /var/lib/rabbitmq/.rabbitmqadmin.conf \u0026\u0026 chown 999:999 /var/lib/rabbitmq/.rabbitmqadmin.conf \u0026\u0026 chmod 600 /var/lib/rabbitmq/.rabbitmqadmin.conf"],"resources":{"limits":{"cpu":"100m","memory":"500Mi"},"requests":{"cpu":"100m","memory":"500Mi"}},"volumeMounts":[{"name":"plugins-conf","mountPath":"/tmp/rabbitmq-plugins/"},{"name":"rabbitmq-erlang-cookie","mountPath":"/var/lib/rabbitmq/"},{"name":"erlang-cookie-secret","mountPath":"/tmp/erlang-cookie-secret/"},{"name":"rabbitmq-plugins","mountPath":"/operator"},{"name":"persistence","mountPath":"/var/lib/rabbitmq/mnesia/"},{"name":"rabbitmq-confd","mountPath":"/tmp/default_user.conf","subPath":"default_user.conf"}],"terminationMessagePath":"/dev/termination-log","terminationMessagePolicy":"File","imagePullPolicy":"IfNotPresent","securityContext":{"capabilities":{"drop":["FSETID","KILL","SETGID","SETUID","SETPCAP","NET_BIND_SERVICE","NET_RAW","SYS_CHROOT","MKNOD","AUDIT_WRITE","SETFCAP"]},"runAsUser":0}}],"containers":[{"name":"rabbitmq","image":"rabbitmq:3.8.12-management","ports":[{"name":"epmd","containerPort":4369,"protocol":"TCP"},{"name":"amqp","containerPort":5672,"protocol":"TCP"},{"name":"management","containerPort":15672,"protocol":"TCP"},{"name":"prometheus","containerPort":15692,"protocol":"TCP"}],"env":[{"name":"MY_POD_NAME","valueFrom":{"fieldRef":{"apiVersion":"v1","fieldPath":"metadata.name"}}},{"name":"MY_POD_NAMESPACE","valueFrom":{"fieldRef":{"apiVersion":"v1","fieldPath":"metadata.namespace"}}},{"name":"RABBITMQ_ENABLED_PLUGINS_FILE","value":"/operator/enabled_plugins"},{"name":"K8S_SERVICE_NAME","value":"rabbitmq-cluster-nodes"},{"name":"RABBITMQ_USE_LONGNAME","value":"true"},{"name":"RABBITMQ_NODENAME","value":"rabbit@$(MY_POD_NAME).$(K8S_SERVICE_NAME).$(MY_POD_NAMESPACE)"},{"name":"K8S_HOSTNAME_SUFFIX","value":".$(K8S_SERVICE_NAME).$(MY_POD_NAMESPACE)"}],"resources":{"limits":{"cpu":"2","memory":"2Gi"},"requests":{"cpu":"1","memory":"2Gi"}},"volumeMounts":[{"name":"rabbitmq-erlang-cookie","mountPath":"/var/lib/rabbitmq/"},{"name":"persistence","mountPath":"/var/lib/rabbitmq/mnesia/"},{"name":"rabbitmq-plugins","mountPath":"/operator"},{"name":"rabbitmq-confd","mountPath":"/etc/rabbitmq/conf.d/10-operatorDefaults.conf","subPath":"operatorDefaults.conf"},{"name":"rabbitmq-confd","mountPath":"/etc/rabbitmq/conf.d/11-default_user.conf","subPath":"default_user.conf"},{"name":"rabbitmq-confd","mountPath":"/etc/rabbitmq/conf.d/90-userDefinedConfiguration.conf","subPath":"userDefinedConfiguration.conf"},{"name":"pod-info","mountPath":"/etc/pod-info/"}],"readinessProbe":{"tcpSocket":{"port":"amqp"},"initialDelaySeconds":10,"timeoutSeconds":5,"periodSeconds":10,"successThreshold":1,"failureThreshold":3},"lifecycle":{"preStop":{"exec":{"command":["/bin/bash","-c","if [ ! -z \"$(cat /etc/pod-info/skipPreStopChecks)\" ]; then exit 0; fi; rabbitmq-upgrade await_online_quorum_plus_one -t 604800; rabbitmq-upgrade await_online_synchronized_mirror -t 604800; rabbitmq-upgrade drain -t 604800"]}}},"terminationMessagePath":"/dev/termination-log","terminationMessagePolicy":"File","imagePullPolicy":"IfNotPresent"}],"restartPolicy":"Always","terminationGracePeriodSeconds":604800,"dnsPolicy":"ClusterFirst","serviceAccountName":"rabbitmq-cluster-server","serviceAccount":"rabbitmq-cluster-server","automountServiceAccountToken":true,"securityContext":{"runAsUser":999,"runAsGroup":999,"fsGroup":999},"schedulerName":"default-scheduler","topologySpreadConstraints":[{"maxSkew":1,"topologyKey":"topology.kubernetes.io/zone","whenUnsatisfiable":"ScheduleAnyway","labelSelector":{"matchLabels":{"app.kubernetes.io/name":"rabbitmq-cluster"}}}]}},"volumeClaimTemplates":[{"metadata":{"name":"persistence","namespace":"default","creationTimestamp":null,"labels":{"app.kubernetes.io/component":"rabbitmq","app.kubernetes.io/name":"rabbitmq-cluster","app.kubernetes.io/part-of":"rabbitmq"},"ownerReferences":[{"apiVersion":"rabbitmq.com/v1beta1","kind":"RabbitmqCluster","name":"rabbitmq-cluster","uid":"18d9928b-0d1c-47be-80ec-20960d053827","controller":true,"blockOwnerDeletion":false}]},"spec":{"accessModes":["ReadWriteOnce"],"resources":{"requests":{"storage":"10Gi"}},"volumeMode":"Filesystem"},"status":{"phase":"Pending"}}],"serviceName":"rabbitmq-cluster-nodes","podManagementPolicy":"Parallel","updateStrategy":{"type":"RollingUpdate","rollingUpdate":{"partition":0}},"revisionHistoryLimit":10},"status":{"observedGeneration":2,"replicas":3,"readyReplicas":1,"currentReplicas":3,"updatedReplicas":3,"currentRevision":"rabbitmq-cluster-server-5f8b8665fb","updateRevision":"rabbitmq-cluster-server-5f8b8665fb","collisionCount":0}}
2022/03/18 18:01:38 learn_server.go:291: [SIEVE-AFTER-READ]	Get	true	service	default	rabbitmq-cluster-nodes	github.com/rabbitmq/cluster-operator/controllers.(*RabbitmqClusterReconciler)	NoError	{"kind":"Service","apiVersion":"v1","metadata":{"name":"rabbitmq-cluster-nodes","namespace":"default","selfLink":"/api/v1/namespaces/default/services/rabbitmq-cluster-nodes","uid":"67c7eea9-1b87-4fd7-82e6-5bfe31fd1b52","resourceVersion":"696","creationTimestamp":"2022-03-18T18:00:38Z","labels":{"app.kubernetes.io/component":"rabbitmq","app.kubernetes.io/name":"rabbitmq-cluster","app.kubernetes.io/part-of":"rabbitmq"},"ownerReferences":[{"apiVersion":"rabbitmq.com/v1beta1","kind":"RabbitmqCluster","name":"rabbitmq-cluster","uid":"18d9928b-0d1c-47be-80ec-20960d053827","controller":true,"blockOwnerDeletion":true}],"managedFields":[{"manager":"manager","operation":"Update","apiVersion":"v1","time":"2022-03-18T18:00:38Z","fieldsType":"FieldsV1","fieldsV1":{"f:metadata":{"f:labels":{".":{},"f:app.kubernetes.io/component":{},"f:app.kubernetes.io/name":{},"f:app.kubernetes.io/part-of":{}},"f:ownerReferences":{".":{},"k:{\"uid\":\"18d9928b-0d1c-47be-80ec-20960d053827\"}":{".":{},"f:apiVersion":{},"f:blockOwnerDeletion":{},"f:controller":{},"f:kind":{},"f:name":{},"f:uid":{}}}},"f:spec":{"f:clusterIP":{},"f:ports":{".":{},"k:{\"port\":4369,\"protocol\":\"TCP\"}":{".":{},"f:name":{},"f:port":{},"f:protocol":{},"f:targetPort":{}},"k:{\"port\":25672,\"protocol\":\"TCP\"}":{".":{},"f:name":{},"f:port":{},"f:protocol":{},"f:targetPort":{}}},"f:publishNotReadyAddresses":{},"f:selector":{".":{},"f:app.kubernetes.io/name":{}},"f:sessionAffinity":{},"f:type":{}}}}]},"spec":{"ports":[{"name":"epmd","protocol":"TCP","port":4369,"targetPort":4369},{"name":"cluster-rpc","protocol":"TCP","port":25672,"targetPort":25672}],"selector":{"app.kubernetes.io/name":"rabbitmq-cluster"},"clusterIP":"None","type":"ClusterIP","sessionAffinity":"None","publishNotReadyAddresses":true},"status":{"loadBalancer":{}}}
2022/03/18 18:01:38 learn_server.go:291: [SIEVE-AFTER-READ]	Get	true	service	default	rabbitmq-cluster	github.com/rabbitmq/cluster-operator/controllers.(*RabbitmqClusterReconciler)	NoError	{"kind":"Service","apiVersion":"v1","metadata":{"name":"rabbitmq-cluster","namespace":"default","selfLink":"/api/v1/namespaces/default/services/rabbitmq-cluster","uid":"56b50671-1945-458b-adac-05619b783392","resourceVersion":"701","creationTimestamp":"2022-03-18T18:00:38Z","labels":{"app.kubernetes.io/component":"rabbitmq","app.kubernetes.io/name":"rabbitmq-cluster","app.kubernetes.io/part-of":"rabbitmq"},"ownerReferences":[{"apiVersion":"rabbitmq.com/v1beta1","kind":"RabbitmqCluster","name":"rabbitmq-cluster","uid":"18d9928b-0d1c-47be-80ec-20960d053827","controller":true,"blockOwnerDeletion":true}],"managedFields":[{"manager":"manager","operation":"Update","apiVersion":"v1","time":"2022-03-18T18:00:38Z","fieldsType":"FieldsV1","fieldsV1":{"f:metadata":{"f:labels":{".":{},"f:app.kubernetes.io/component":{},"f:app.kubernetes.io/name":{},"f:app.kubernetes.io/part-of":{}},"f:ownerReferences":{".":{},"k:{\"uid\":\"18d9928b-0d1c-47be-80ec-20960d053827\"}":{".":{},"f:apiVersion":{},"f:blockOwnerDeletion":{},"f:controller":{},"f:kind":{},"f:name":{},"f:uid":{}}}},"f:spec":{"f:ports":{".":{},"k:{\"port\":5672,\"protocol\":\"TCP\"}":{".":{},"f:name":{},"f:port":{},"f:protocol":{},"f:targetPort":{}},"k:{\"port\":15672,\"protocol\":\"TCP\"}":{".":{},"f:name":{},"f:port":{},"f:protocol":{},"f:targetPort":{}}},"f:selector":{".":{},"f:app.kubernetes.io/name":{}},"f:sessionAffinity":{},"f:type":{}}}}]},"spec":{"ports":[{"name":"amqp","protocol":"TCP","port":5672,"targetPort":5672},{"name":"management","protocol":"TCP","port":15672,"targetPort":15672}],"selector":{"app.kubernetes.io/name":"rabbitmq-cluster"},"clusterIP":"10.96.254.158","type":"ClusterIP","sessionAffinity":"None"},"status":{"loadBalancer":{}}}
2022/03/18 18:01:38 learn_server.go:291: [SIEVE-AFTER-READ]	Get	true	secret	default	rabbitmq-cluster-erlang-cookie	github.com/rabbitmq/cluster-operator/controllers.(*RabbitmqClusterReconciler)	NoError	{"kind":"Secret","apiVersion":"v1","metadata":{"name":"rabbitmq-cluster-erlang-cookie","namespace":"default","selfLink":"/api/v1/namespaces/default/secrets/rabbitmq-cluster-erlang-cookie","uid":"f8fbe8a6-0f40-4e13-960b-ab78b8ba75b0","resourceVersion":"705","creationTimestamp":"2022-03-18T18:00:38Z","labels":{"app.kubernetes.io/component":"rabbitmq","app.kubernetes.io/name":"rabbitmq-cluster","app.kubernetes.io/part-of":"rabbitmq"},"ownerReferences":[{"apiVersion":"rabbitmq.com/v1beta1","kind":"RabbitmqCluster","name":"rabbitmq-cluster","uid":"18d9928b-0d1c-47be-80ec-20960d053827","controller":true,"blockOwnerDeletion":true}],"managedFields":[{"manager":"manager","operation":"Update","apiVersion":"v1","time":"2022-03-18T18:00:38Z","fieldsType":"FieldsV1","fieldsV1":{"f:data":{".":{},"f:.erlang.cookie":{}},"f:metadata":{"f:labels":{".":{},"f:app.kubernetes.io/component":{},"f:app.kubernetes.io/name":{},"f:app.kubernetes.io/part-of":{}},"f:ownerReferences":{".":{},"k:{\"uid\":\"18d9928b-0d1c-47be-80ec-20960d053827\"}":{".":{},"f:apiVersion":{},"f:blockOwnerDeletion":{},"f:controller":{},"f:kind":{},"f:name":{},"f:uid":{}}}},"f:type":{}}}]},"data":{".erlang.cookie":"QW9hMkpWU0tlYS1FUGdWTUhrelNMNnFoMFZ0ZmRGNUY="},"type":"Opaque"}
2022/03/18 18:01:38 learn_server.go:291: [SIEVE-AFTER-READ]	Get	true	secret	default	rabbitmq-cluster-default-user	github.com/rabbitmq/cluster-operator/controllers.(*RabbitmqClusterReconciler)	NoError	{"kind":"Secret","apiVersion":"v1","metadata":{"name":"rabbitmq-cluster-default-user","namespace":"default","selfLink":"/api/v1/namespaces/default/secrets/rabbitmq-cluster-default-user","uid":"0d9f460b-a23c-402b-8273-f541ed39023f","resourceVersion":"708","creationTimestamp":"2022-03-18T18:00:38Z","labels":{"app.kubernetes.io/component":"rabbitmq","app.kubernetes.io/name":"rabbitmq-cluster","app.kubernetes.io/part-of":"rabbitmq"},"ownerReferences":[{"apiVersion":"rabbitmq.com/v1beta1","kind":"RabbitmqCluster","name":"rabbitmq-cluster","uid":"18d9928b-0d1c-47be-80ec-20960d053827","controller":true,"blockOwnerDeletion":true}],"managedFields":[{"manager":"manager","operation":"Update","apiVersion":"v1","time":"2022-03-18T18:00:38Z","fieldsType":"FieldsV1","fieldsV1":{"f:data":{".":{},"f:default_user.conf":{},"f:password":{},"f:provider":{},"f:type":{},"f:username":{}},"f:metadata":{"f:labels":{".":{},"f:app.kubernetes.io/component":{},"f:app.kubernetes.io/name":{},"f:app.kubernetes.io/part-of":{}},"f:ownerReferences":{".":{},"k:{\"uid\":\"18d9928b-0d1c-47be-80ec-20960d053827\"}":{".":{},"f:apiVersion":{},"f:blockOwnerDeletion":{},"f:controller":{},"f:kind":{},"f:name":{},"f:uid":{}}}},"f:type":{}}}]},"data":{"default_user.conf":"ZGVmYXVsdF91c2VyID0gcTMxRmh3MGtjWW9SZUl5X3BPTXp2ZVBOUnNVU3I1Mk8KZGVmYXVsdF9wYXNzID0gY0dBX19jNTJHX05hVURpTGhraWZ6UDBOVVlNLTE2MWQK","password":"Y0dBX19jNTJHX05hVURpTGhraWZ6UDBOVVlNLTE2MWQ=","provider":"cmFiYml0bXE=","type":"cmFiYml0bXE=","username":"cTMxRmh3MGtjWW9SZUl5X3BPTXp2ZVBOUnNVU3I1Mk8="},"type":"Opaque"}
2022/03/18 18:01:38 learn_server.go:291: [SIEVE-AFTER-READ]	Get	true	configmap	default	rabbitmq-cluster-plugins-conf	github.com/rabbitmq/cluster-operator/controllers.(*RabbitmqClusterReconciler)	NoError	{"kind":"ConfigMap","apiVersion":"v1","metadata":{"name":"rabbitmq-cluster-plugins-conf","namespace":"default","selfLink":"/api/v1/namespaces/default/configmaps/rabbitmq-cluster-plugins-conf","uid":"a164075b-0562-47ac-a577-99aa8651ec40","resourceVersion":"709","creationTimestamp":"2022-03-18T18:00:38Z","labels":{"app.kubernetes.io/component":"rabbitmq","app.kubernetes.io/name":"rabbitmq-cluster","app.kubernetes.io/part-of":"rabbitmq"},"ownerReferences":[{"apiVersion":"rabbitmq.com/v1beta1","kind":"RabbitmqCluster","name":"rabbitmq-cluster","uid":"18d9928b-0d1c-47be-80ec-20960d053827","controller":true,"blockOwnerDeletion":true}],"managedFields":[{"manager":"manager","operation":"Update","apiVersion":"v1","time":"2022-03-18T18:00:38Z","fieldsType":"FieldsV1","fieldsV1":{"f:data":{".":{},"f:enabled_plugins":{}},"f:metadata":{"f:labels":{".":{},"f:app.kubernetes.io/component":{},"f:app.kubernetes.io/name":{},"f:app.kubernetes.io/part-of":{}},"f:ownerReferences":{".":{},"k:{\"uid\":\"18d9928b-0d1c-47be-80ec-20960d053827\"}":{".":{},"f:apiVersion":{},"f:blockOwnerDeletion":{},"f:controller":{},"f:kind":{},"f:name":{},"f:uid":{}}}}}}]},"data":{"enabled_plugins":"[rabbitmq_peer_discovery_k8s,rabbitmq_prometheus,rabbitmq_management]."}}
2022/03/18 18:01:38 learn_server.go:291: [SIEVE-AFTER-READ]	Get	true	configmap	default	rabbitmq-cluster-server-conf	github.com/rabbitmq/cluster-operator/controllers.(*RabbitmqClusterReconciler)	NoError	{"kind":"ConfigMap","apiVersion":"v1","metadata":{"name":"rabbitmq-cluster-server-conf","namespace":"default","selfLink":"/api/v1/namespaces/default/configmaps/rabbitmq-cluster-server-conf","uid":"22474f2b-8454-44b7-8079-8990223969cc","resourceVersion":"714","creationTimestamp":"2022-03-18T18:00:38Z","labels":{"app.kubernetes.io/component":"rabbitmq","app.kubernetes.io/name":"rabbitmq-cluster","app.kubernetes.io/part-of":"rabbitmq"},"ownerReferences":[{"apiVersion":"rabbitmq.com/v1beta1","kind":"RabbitmqCluster","name":"rabbitmq-cluster","uid":"18d9928b-0d1c-47be-80ec-20960d053827","controller":true,"blockOwnerDeletion":true}],"managedFields":[{"manager":"manager","operation":"Update","apiVersion":"v1","time":"2022-03-18T18:00:38Z","fieldsType":"FieldsV1","fieldsV1":{"f:data":{".":{},"f:operatorDefaults.conf":{},"f:userDefinedConfiguration.conf":{}},"f:metadata":{"f:labels":{".":{},"f:app.kubernetes.io/component":{},"f:app.kubernetes.io/name":{},"f:app.kubernetes.io/part-of":{}},"f:ownerReferences":{".":{},"k:{\"uid\":\"18d9928b-0d1c-47be-80ec-20960d053827\"}":{".":{},"f:apiVersion":{},"f:blockOwnerDeletion":{},"f:controller":{},"f:kind":{},"f:name":{},"f:uid":{}}}}}}]},"data":{"operatorDefaults.conf":"cluster_formation.peer_discovery_backend             = rabbit_peer_discovery_k8s\ncluster_formation.k8s.host                           = kubernetes.default\ncluster_formation.k8s.address_type                   = hostname\ncluster_partition_handling                           = pause_minority\nqueue_master_locator                                 = min-masters\ndisk_free_limit.absolute                             = 2GB\ncluster_formation.randomized_startup_delay_range.min = 5\ncluster_formation.randomized_startup_delay_range.max = 30\ncluster_name                                         = rabbitmq-cluster\n","userDefinedConfiguration.conf":"total_memory_available_override_value = 1717986919\n"}}
2022/03/18 18:01:38 learn_server.go:291: [SIEVE-AFTER-READ]	Get	true	serviceaccount	default	rabbitmq-cluster-server	github.com/rabbitmq/cluster-operator/controllers.(*RabbitmqClusterReconciler)	NoError	{"kind":"ServiceAccount","apiVersion":"v1","metadata":{"name":"rabbitmq-cluster-server","namespace":"default","selfLink":"/api/v1/namespaces/default/serviceaccounts/rabbitmq-cluster-server","uid":"731589b5-ac97-4774-bee4-008949b54734","resourceVersion":"722","creationTimestamp":"2022-03-18T18:00:38Z","labels":{"app.kubernetes.io/component":"rabbitmq","app.kubernetes.io/name":"rabbitmq-cluster","app.kubernetes.io/part-of":"rabbitmq"},"ownerReferences":[{"apiVersion":"rabbitmq.com/v1beta1","kind":"RabbitmqCluster","name":"rabbitmq-cluster","uid":"18d9928b-0d1c-47be-80ec-20960d053827","controller":true,"blockOwnerDeletion":true}],"managedFields":[{"manager":"kube-controller-manager","operation":"Update","apiVersion":"v1","time":"2022-03-18T18:00:38Z","fieldsType":"FieldsV1","fieldsV1":{"f:secrets":{".":{},"k:{\"name\":\"rabbitmq-cluster-server-token-rhzq9\"}":{".":{},"f:name":{}}}}},{"manager":"manager","operation":"Update","apiVersion":"v1","time":"2022-03-18T18:00:38Z","fieldsType":"FieldsV1","fieldsV1":{"f:metadata":{"f:labels":{".":{},"f:app.kubernetes.io/component":{},"f:app.kubernetes.io/name":{},"f:app.kubernetes.io/part-of":{}},"f:ownerReferences":{".":{},"k:{\"uid\":\"18d9928b-0d1c-47be-80ec-20960d053827\"}":{".":{},"f:apiVersion":{},"f:blockOwnerDeletion":{},"f:controller":{},"f:kind":{},"f:name":{},"f:uid":{}}}}}}]},"secrets":[{"name":"rabbitmq-cluster-server-token-rhzq9"}]}
2022/03/18 18:01:38 learn_server.go:291: [SIEVE-AFTER-READ]	Get	true	role	default	rabbitmq-cluster-peer-discovery	github.com/rabbitmq/cluster-operator/controllers.(*RabbitmqClusterReconciler)	NoError	{"kind":"Role","apiVersion":"rbac.authorization.k8s.io/v1","metadata":{"name":"rabbitmq-cluster-peer-discovery","namespace":"default","selfLink":"/apis/rbac.authorization.k8s.io/v1/namespaces/default/roles/rabbitmq-cluster-peer-discovery","uid":"52c80b50-4fdd-4089-bbfd-9756465953f2","resourceVersion":"723","creationTimestamp":"2022-03-18T18:00:38Z","labels":{"app.kubernetes.io/component":"rabbitmq","app.kubernetes.io/name":"rabbitmq-cluster","app.kubernetes.io/part-of":"rabbitmq"},"ownerReferences":[{"apiVersion":"rabbitmq.com/v1beta1","kind":"RabbitmqCluster","name":"rabbitmq-cluster","uid":"18d9928b-0d1c-47be-80ec-20960d053827","controller":true,"blockOwnerDeletion":true}],"managedFields":[{"manager":"manager","operation":"Update","apiVersion":"rbac.authorization.k8s.io/v1","time":"2022-03-18T18:00:38Z","fieldsType":"FieldsV1","fieldsV1":{"f:metadata":{"f:labels":{".":{},"f:app.kubernetes.io/component":{},"f:app.kubernetes.io/name":{},"f:app.kubernetes.io/part-of":{}},"f:ownerReferences":{".":{},"k:{\"uid\":\"18d9928b-0d1c-47be-80ec-20960d053827\"}":{".":{},"f:apiVersion":{},"f:blockOwnerDeletion":{},"f:controller":{},"f:kind":{},"f:name":{},"f:uid":{}}}},"f:rules":{}}}]},"rules":[{"verbs":["get"],"apiGroups":[""],"resources":["endpoints"]},{"verbs":["create"],"apiGroups":[""],"resources":["events"]}]}
2022/03/18 18:01:38 learn_server.go:291: [SIEVE-AFTER-READ]	Get	true	rolebinding	default	rabbitmq-cluster-server	github.com/rabbitmq/cluster-operator/controllers.(*RabbitmqClusterReconciler)	NoError	{"kind":"RoleBinding","apiVersion":"rbac.authorization.k8s.io/v1","metadata":{"name":"rabbitmq-cluster-server","namespace":"default","selfLink":"/apis/rbac.authorization.k8s.io/v1/namespaces/default/rolebindings/rabbitmq-cluster-server","uid":"495e9f7c-a20d-4515-86b0-34149a855034","resourceVersion":"725","creationTimestamp":"2022-03-18T18:00:38Z","labels":{"app.kubernetes.io/component":"rabbitmq","app.kubernetes.io/name":"rabbitmq-cluster","app.kubernetes.io/part-of":"rabbitmq"},"ownerReferences":[{"apiVersion":"rabbitmq.com/v1beta1","kind":"RabbitmqCluster","name":"rabbitmq-cluster","uid":"18d9928b-0d1c-47be-80ec-20960d053827","controller":true,"blockOwnerDeletion":true}],"managedFields":[{"manager":"manager","operation":"Update","apiVersion":"rbac.authorization.k8s.io/v1","time":"2022-03-18T18:00:38Z","fieldsType":"FieldsV1","fieldsV1":{"f:metadata":{"f:labels":{".":{},"f:app.kubernetes.io/component":{},"f:app.kubernetes.io/name":{},"f:app.kubernetes.io/part-of":{}},"f:ownerReferences":{".":{},"k:{\"uid\":\"18d9928b-0d1c-47be-80ec-20960d053827\"}":{".":{},"f:apiVersion":{},"f:blockOwnerDeletion":{},"f:controller":{},"f:kind":{},"f:name":{},"f:uid":{}}}},"f:roleRef":{"f:apiGroup":{},"f:kind":{},"f:name":{}},"f:subjects":{}}}]},"subjects":[{"kind":"ServiceAccount","name":"rabbitmq-cluster-server"}],"roleRef":{"apiGroup":"rbac.authorization.k8s.io","kind":"Role","name":"rabbitmq-cluster-peer-discovery"}}
2022/03/18 18:01:38 learn_server.go:291: [SIEVE-AFTER-READ]	Get	true	statefulset	default	rabbitmq-cluster-server	github.com/rabbitmq/cluster-operator/controllers.(*RabbitmqClusterReconciler)	NoError	{"kind":"StatefulSet","apiVersion":"apps/v1","metadata":{"name":"rabbitmq-cluster-server","namespace":"default","selfLink":"/apis/apps/v1/namespaces/default/statefulsets/rabbitmq-cluster-server","uid":"cb5c43bc-6ee7-481c-ab01-6f3acffdd3c8","resourceVersion":"989","generation":2,"creationTimestamp":"2022-03-18T18:00:38Z","labels":{"app.kubernetes.io/component":"rabbitmq","app.kubernetes.io/name":"rabbitmq-cluster","app.kubernetes.io/part-of":"rabbitmq"},"ownerReferences":[{"apiVersion":"rabbitmq.com/v1beta1","kind":"RabbitmqCluster","name":"rabbitmq-cluster","uid":"18d9928b-0d1c-47be-80ec-20960d053827","controller":true,"blockOwnerDeletion":true}],"managedFields":[{"manager":"kube-controller-manager","operation":"Update","apiVersion":"apps/v1","time":"2022-03-18T18:01:23Z","fieldsType":"FieldsV1","fieldsV1":{"f:status":{"f:collisionCount":{},"f:currentReplicas":{},"f:currentRevision":{},"f:observedGeneration":{},"f:readyReplicas":{},"f:replicas":{},"f:updateRevision":{},"f:updatedReplicas":{}}}},{"manager":"manager","operation":"Update","apiVersion":"apps/v1","time":"2022-03-18T18:01:23Z","fieldsType":"FieldsV1","fieldsV1":{"f:metadata":{"f:labels":{".":{},"f:app.kubernetes.io/component":{},"f:app.kubernetes.io/name":{},"f:app.kubernetes.io/part-of":{}},"f:ownerReferences":{".":{},"k:{\"uid\":\"18d9928b-0d1c-47be-80ec-20960d053827\"}":{".":{},"f:apiVersion":{},"f:blockOwnerDeletion":{},"f:controller":{},"f:kind":{},"f:name":{},"f:uid":{}}}},"f:spec":{"f:podManagementPolicy":{},"f:replicas":{},"f:revisionHistoryLimit":{},"f:selector":{"f:matchLabels":{".":{},"f:app.kubernetes.io/name":{}}},"f:serviceName":{},"f:template":{"f:metadata":{"f:annotations":{".":{},"f:prometheus.io/port":{},"f:prometheus.io/scrape":{}},"f:labels":{".":{},"f:app.kubernetes.io/component":{},"f:app.kubernetes.io/name":{},"f:app.kubernetes.io/part-of":{}}},"f:spec":{"f:automountServiceAccountToken":{},"f:containers":{"k:{\"name\":\"rabbitmq\"}":{".":{},"f:env":{".":{},"k:{\"name\":\"K8S_HOSTNAME_SUFFIX\"}":{".":{},"f:name":{},"f:value":{}},"k:{\"name\":\"K8S_SERVICE_NAME\"}":{".":{},"f:name":{},"f:value":{}},"k:{\"name\":\"MY_POD_NAME\"}":{".":{},"f:name":{},"f:valueFrom":{".":{},"f:fieldRef":{".":{},"f:apiVersion":{},"f:fieldPath":{}}}},"k:{\"name\":\"MY_POD_NAMESPACE\"}":{".":{},"f:name":{},"f:valueFrom":{".":{},"f:fieldRef":{".":{},"f:apiVersion":{},"f:fieldPath":{}}}},"k:{\"name\":\"RABBITMQ_ENABLED_PLUGINS_FILE\"}":{".":{},"f:name":{},"f:value":{}},"k:{\"name\":\"RABBITMQ_NODENAME\"}":{".":{},"f:name":{},"f:value":{}},"k:{\"name\":\"RABBITMQ_USE_LONGNAME\"}":{".":{},"f:name":{},"f:value":{}}},"f:image":{},"f:imagePullPolicy":{},"f:lifecycle":{".":{},"f:preStop":{".":{},"f:exec":{".":{},"f:command":{}}}},"f:name":{},"f:ports":{".":{},"k:{\"containerPort\":4369,\"protocol\":\"TCP\"}":{".":{},"f:containerPort":{},"f:name":{},"f:protocol":{}},"k:{\"containerPort\":5672,\"protocol\":\"TCP\"}":{".":{},"f:containerPort":{},"f:name":{},"f:protocol":{}},"k:{\"containerPort\":15672,\"protocol\":\"TCP\"}":{".":{},"f:containerPort":{},"f:name":{},"f:protocol":{}},"k:{\"containerPort\":15692,\"protocol\":\"TCP\"}":{".":{},"f:containerPort":{},"f:name":{},"f:protocol":{}}},"f:readinessProbe":{".":{},"f:failureThreshold":{},"f:initialDelaySeconds":{},"f:periodSeconds":{},"f:successThreshold":{},"f:tcpSocket":{".":{},"f:port":{}},"f:timeoutSeconds":{}},"f:resources":{".":{},"f:limits":{".":{},"f:cpu":{},"f:memory":{}},"f:requests":{".":{},"f:cpu":{},"f:memory":{}}},"f:terminationMessagePath":{},"f:terminationMessagePolicy":{},"f:volumeMounts":{".":{},"k:{\"mountPath\":\"/etc/pod-info/\"}":{".":{},"f:mountPath":{},"f:name":{}},"k:{\"mountPath\":\"/etc/rabbitmq/conf.d/10-operatorDefaults.conf\"}":{".":{},"f:mountPath":{},"f:name":{},"f:subPath":{}},"k:{\"mountPath\":\"/etc/rabbitmq/conf.d/11-default_user.conf\"}":{".":{},"f:mountPath":{},"f:name":{},"f:subPath":{}},"k:{\"mountPath\":\"/etc/rabbitmq/conf.d/90-userDefinedConfiguration.conf\"}":{".":{},"f:mountPath":{},"f:name":{},"f:subPath":{}},"k:{\"mountPath\":\"/operator\"}":{".":{},"f:mountPath":{},"f:name":{}},"k:{\"mountPath\":\"/var/lib/rabbitmq/\"}":{".":{},"f:mountPath":{},"f:name":{}},"k:{\"mountPath\":\"/var/lib/rabbitmq/mnesia/\"}":{".":{},"f:mountPath":{},"f:name":{}}}}},"f:dnsPolicy":{},"f:initContainers":{".":{},"k:{\"name\":\"setup-container\"}":{".":{},"f:command":{},"f:image":{},"f:imagePullPolicy":{},"f:name":{},"f:resources":{".":{},"f:limits":{".":{},"f:cpu":{},"f:memory":{}},"f:requests":{".":{},"f:cpu":{},"f:memory":{}}},"f:securityContext":{".":{},"f:capabilities":{".":{},"f:drop":{}},"f:runAsUser":{}},"f:terminationMessagePath":{},"f:terminationMessagePolicy":{},"f:volumeMounts":{".":{},"k:{\"mountPath\":\"/operator\"}":{".":{},"f:mountPath":{},"f:name":{}},"k:{\"mountPath\":\"/tmp/default_user.conf\"}":{".":{},"f:mountPath":{},"f:name":{},"f:subPath":{}},"k:{\"mountPath\":\"/tmp/erlang-cookie-secret/\"}":{".":{},"f:mountPath":{},"f:name":{}},"k:{\"mountPath\":\"/tmp/rabbitmq-plugins/\"}":{".":{},"f:mountPath":{},"f:name":{}},"k:{\"mountPath\":\"/var/lib/rabbitmq/\"}":{".":{},"f:mountPath":{},"f:name":{}},"k:{\"mountPath\":\"/var/lib/rabbitmq/mnesia/\"}":{".":{},"f:mountPath":{},"f:name":{}}}}},"f:restartPolicy":{},"f:schedulerName":{},"f:securityContext":{".":{},"f:fsGroup":{},"f:runAsGroup":{},"f:runAsUser":{}},"f:serviceAccount":{},"f:serviceAccountName":{},"f:terminationGracePeriodSeconds":{},"f:topologySpreadConstraints":{".":{},"k:{\"topologyKey\":\"topology.kubernetes.io/zone\",\"whenUnsatisfiable\":\"ScheduleAnyway\"}":{".":{},"f:labelSelector":{".":{},"f:matchLabels":{".":{},"f:app.kubernetes.io/name":{}}},"f:maxSkew":{},"f:topologyKey":{},"f:whenUnsatisfiable":{}}},"f:volumes":{".":{},"k:{\"name\":\"erlang-cookie-secret\"}":{".":{},"f:name":{},"f:secret":{".":{},"f:defaultMode":{},"f:secretName":{}}},"k:{\"name\":\"plugins-conf\"}":{".":{},"f:configMap":{".":{},"f:defaultMode":{},"f:name":{}},"f:name":{}},"k:{\"name\":\"pod-info\"}":{".":{},"f:downwardAPI":{".":{},"f:defaultMode":{},"f:items":{}},"f:name":{}},"k:{\"name\":\"rabbitmq-confd\"}":{".":{},"f:name":{},"f:projected":{".":{},"f:defaultMode":{},"f:sources":{}}},"k:{\"name\":\"rabbitmq-erlang-cookie\"}":{".":{},"f:emptyDir":{},"f:name":{}},"k:{\"name\":\"rabbitmq-plugins\"}":{".":{},"f:emptyDir":{},"f:name":{}}}}},"f:updateStrategy":{"f:rollingUpdate":{".":{},"f:partition":{}},"f:type":{}},"f:volumeClaimTemplates":{}}}}]},"spec":{"replicas":3,"selector":{"matchLabels":{"app.kubernetes.io/name":"rabbitmq-cluster"}},"template":{"metadata":{"creationTimestamp":null,"labels":{"app.kubernetes.io/component":"rabbitmq","app.kubernetes.io/name":"rabbitmq-cluster","app.kubernetes.io/part-of":"rabbitmq"},"annotations":{"prometheus.io/port":"15692","prometheus.io/scrape":"true"}},"spec":{"volumes":[{"name":"plugins-conf","configMap":{"name":"rabbitmq-cluster-plugins-conf","defaultMode":420}},{"name":"rabbitmq-confd","projected":{"sources":[{"secret":{"name":"rabbitmq-cluster-default-user","items":[{"key":"default_user.conf","path":"default_user.conf"}]}},{"configMap":{"name":"rabbitmq-cluster-server-conf","items":[{"key":"operatorDefaults.conf","path":"operatorDefaults.conf"},{"key":"userDefinedConfiguration.conf","path":"userDefinedConfiguration.conf"}]}}],"defaultMode":420}},{"name":"rabbitmq-erlang-cookie","emptyDir":{}},{"name":"erlang-cookie-secret","secret":{"secretName":"rabbitmq-cluster-erlang-cookie","defaultMode":420}},{"name":"rabbitmq-plugins","emptyDir":{}},{"name":"pod-info","downwardAPI":{"items":[{"path":"skipPreStopChecks","fieldRef":{"apiVersion":"v1","fieldPath":"metadata.labels['skipPreStopChecks']"}}],"defaultMode":420}}],"initContainers":[{"name":"setup-container","image":"rabbitmq:3.8.12-management","command":["sh","-c","cp /tmp/erlang-cookie-secret/.erlang.cookie /var/lib/rabbitmq/.erlang.cookie \u0026\u0026 chown 999:999 /var/lib/rabbitmq/.erlang.cookie \u0026\u0026 chmod 600 /var/lib/rabbitmq/.erlang.cookie ; cp /tmp/rabbitmq-plugins/enabled_plugins /operator/enabled_plugins \u0026\u0026 chown 999:999 /operator/enabled_plugins ; chown 999:999 /var/lib/rabbitmq/mnesia/ ; echo '[default]' \u003e /var/lib/rabbitmq/.rabbitmqadmin.conf \u0026\u0026 sed -e 's/default_user/username/' -e 's/default_pass/password/' /tmp/default_user.conf \u003e\u003e /var/lib/rabbitmq/.rabbitmqadmin.conf \u0026\u0026 chown 999:999 /var/lib/rabbitmq/.rabbitmqadmin.conf \u0026\u0026 chmod 600 /var/lib/rabbitmq/.rabbitmqadmin.conf"],"resources":{"limits":{"cpu":"100m","memory":"500Mi"},"requests":{"cpu":"100m","memory":"500Mi"}},"volumeMounts":[{"name":"plugins-conf","mountPath":"/tmp/rabbitmq-plugins/"},{"name":"rabbitmq-erlang-cookie","mountPath":"/var/lib/rabbitmq/"},{"name":"erlang-cookie-secret","mountPath":"/tmp/erlang-cookie-secret/"},{"name":"rabbitmq-plugins","mountPath":"/operator"},{"name":"persistence","mountPath":"/var/lib/rabbitmq/mnesia/"},{"name":"rabbitmq-confd","mountPath":"/tmp/default_user.conf","subPath":"default_user.conf"}],"terminationMessagePath":"/dev/termination-log","terminationMessagePolicy":"File","imagePullPolicy":"IfNotPresent","securityContext":{"capabilities":{"drop":["FSETID","KILL","SETGID","SETUID","SETPCAP","NET_BIND_SERVICE","NET_RAW","SYS_CHROOT","MKNOD","AUDIT_WRITE","SETFCAP"]},"runAsUser":0}}],"containers":[{"name":"rabbitmq","image":"rabbitmq:3.8.12-management","ports":[{"name":"epmd","containerPort":4369,"protocol":"TCP"},{"name":"amqp","containerPort":5672,"protocol":"TCP"},{"name":"management","containerPort":15672,"protocol":"TCP"},{"name":"prometheus","containerPort":15692,"protocol":"TCP"}],"env":[{"name":"MY_POD_NAME","valueFrom":{"fieldRef":{"apiVersion":"v1","fieldPath":"metadata.name"}}},{"name":"MY_POD_NAMESPACE","valueFrom":{"fieldRef":{"apiVersion":"v1","fieldPath":"metadata.namespace"}}},{"name":"RABBITMQ_ENABLED_PLUGINS_FILE","value":"/operator/enabled_plugins"},{"name":"K8S_SERVICE_NAME","value":"rabbitmq-cluster-nodes"},{"name":"RABBITMQ_USE_LONGNAME","value":"true"},{"name":"RABBITMQ_NODENAME","value":"rabbit@$(MY_POD_NAME).$(K8S_SERVICE_NAME).$(MY_POD_NAMESPACE)"},{"name":"K8S_HOSTNAME_SUFFIX","value":".$(K8S_SERVICE_NAME).$(MY_POD_NAMESPACE)"}],"resources":{"limits":{"cpu":"2","memory":"2Gi"},"requests":{"cpu":"1","memory":"2Gi"}},"volumeMounts":[{"name":"rabbitmq-erlang-cookie","mountPath":"/var/lib/rabbitmq/"},{"name":"persistence","mountPath":"/var/lib/rabbitmq/mnesia/"},{"name":"rabbitmq-plugins","mountPath":"/operator"},{"name":"rabbitmq-confd","mountPath":"/etc/rabbitmq/conf.d/10-operatorDefaults.conf","subPath":"operatorDefaults.conf"},{"name":"rabbitmq-confd","mountPath":"/etc/rabbitmq/conf.d/11-default_user.conf","subPath":"default_user.conf"},{"name":"rabbitmq-confd","mountPath":"/etc/rabbitmq/conf.d/90-userDefinedConfiguration.conf","subPath":"userDefinedConfiguration.conf"},{"name":"pod-info","mountPath":"/etc/pod-info/"}],"readinessProbe":{"tcpSocket":{"port":"amqp"},"initialDelaySeconds":10,"timeoutSeconds":5,"periodSeconds":10,"successThreshold":1,"failureThreshold":3},"lifecycle":{"preStop":{"exec":{"command":["/bin/bash","-c","if [ ! -z \"$(cat /etc/pod-info/skipPreStopChecks)\" ]; then exit 0; fi; rabbitmq-upgrade await_online_quorum_plus_one -t 604800; rabbitmq-upgrade await_online_synchronized_mirror -t 604800; rabbitmq-upgrade drain -t 604800"]}}},"terminationMessagePath":"/dev/termination-log","terminationMessagePolicy":"File","imagePullPolicy":"IfNotPresent"}],"restartPolicy":"Always","terminationGracePeriodSeconds":604800,"dnsPolicy":"ClusterFirst","serviceAccountName":"rabbitmq-cluster-server","serviceAccount":"rabbitmq-cluster-server","automountServiceAccountToken":true,"securityContext":{"runAsUser":999,"runAsGroup":999,"fsGroup":999},"schedulerName":"default-scheduler","topologySpreadConstraints":[{"maxSkew":1,"topologyKey":"topology.kubernetes.io/zone","whenUnsatisfiable":"ScheduleAnyway","labelSelector":{"matchLabels":{"app.kubernetes.io/name":"rabbitmq-cluster"}}}]}},"volumeClaimTemplates":[{"metadata":{"name":"persistence","namespace":"default","creationTimestamp":null,"labels":{"app.kubernetes.io/component":"rabbitmq","app.kubernetes.io/name":"rabbitmq-cluster","app.kubernetes.io/part-of":"rabbitmq"},"ownerReferences":[{"apiVersion":"rabbitmq.com/v1beta1","kind":"RabbitmqCluster","name":"rabbitmq-cluster","uid":"18d9928b-0d1c-47be-80ec-20960d053827","controller":true,"blockOwnerDeletion":false}]},"spec":{"accessModes":["ReadWriteOnce"],"resources":{"requests":{"storage":"10Gi"}},"volumeMode":"Filesystem"},"status":{"phase":"Pending"}}],"serviceName":"rabbitmq-cluster-nodes","podManagementPolicy":"Parallel","updateStrategy":{"type":"RollingUpdate","rollingUpdate":{"partition":0}},"revisionHistoryLimit":10},"status":{"observedGeneration":2,"replicas":3,"readyReplicas":1,"currentReplicas":3,"updatedReplicas":3,"currentRevision":"rabbitmq-cluster-server-5f8b8665fb","updateRevision":"rabbitmq-cluster-server-5f8b8665fb","collisionCount":0}}
2022/03/18 18:01:38 learn_server.go:291: [SIEVE-AFTER-READ]	Get	true	statefulset	default	rabbitmq-cluster-server	github.com/rabbitmq/cluster-operator/controllers.(*RabbitmqClusterReconciler)	NoError	{"kind":"StatefulSet","apiVersion":"apps/v1","metadata":{"name":"rabbitmq-cluster-server","namespace":"default","selfLink":"/apis/apps/v1/namespaces/default/statefulsets/rabbitmq-cluster-server","uid":"cb5c43bc-6ee7-481c-ab01-6f3acffdd3c8","resourceVersion":"989","generation":2,"creationTimestamp":"2022-03-18T18:00:38Z","labels":{"app.kubernetes.io/component":"rabbitmq","app.kubernetes.io/name":"rabbitmq-cluster","app.kubernetes.io/part-of":"rabbitmq"},"ownerReferences":[{"apiVersion":"rabbitmq.com/v1beta1","kind":"RabbitmqCluster","name":"rabbitmq-cluster","uid":"18d9928b-0d1c-47be-80ec-20960d053827","controller":true,"blockOwnerDeletion":true}],"managedFields":[{"manager":"kube-controller-manager","operation":"Update","apiVersion":"apps/v1","time":"2022-03-18T18:01:23Z","fieldsType":"FieldsV1","fieldsV1":{"f:status":{"f:collisionCount":{},"f:currentReplicas":{},"f:currentRevision":{},"f:observedGeneration":{},"f:readyReplicas":{},"f:replicas":{},"f:updateRevision":{},"f:updatedReplicas":{}}}},{"manager":"manager","operation":"Update","apiVersion":"apps/v1","time":"2022-03-18T18:01:23Z","fieldsType":"FieldsV1","fieldsV1":{"f:metadata":{"f:labels":{".":{},"f:app.kubernetes.io/component":{},"f:app.kubernetes.io/name":{},"f:app.kubernetes.io/part-of":{}},"f:ownerReferences":{".":{},"k:{\"uid\":\"18d9928b-0d1c-47be-80ec-20960d053827\"}":{".":{},"f:apiVersion":{},"f:blockOwnerDeletion":{},"f:controller":{},"f:kind":{},"f:name":{},"f:uid":{}}}},"f:spec":{"f:podManagementPolicy":{},"f:replicas":{},"f:revisionHistoryLimit":{},"f:selector":{"f:matchLabels":{".":{},"f:app.kubernetes.io/name":{}}},"f:serviceName":{},"f:template":{"f:metadata":{"f:annotations":{".":{},"f:prometheus.io/port":{},"f:prometheus.io/scrape":{}},"f:labels":{".":{},"f:app.kubernetes.io/component":{},"f:app.kubernetes.io/name":{},"f:app.kubernetes.io/part-of":{}}},"f:spec":{"f:automountServiceAccountToken":{},"f:containers":{"k:{\"name\":\"rabbitmq\"}":{".":{},"f:env":{".":{},"k:{\"name\":\"K8S_HOSTNAME_SUFFIX\"}":{".":{},"f:name":{},"f:value":{}},"k:{\"name\":\"K8S_SERVICE_NAME\"}":{".":{},"f:name":{},"f:value":{}},"k:{\"name\":\"MY_POD_NAME\"}":{".":{},"f:name":{},"f:valueFrom":{".":{},"f:fieldRef":{".":{},"f:apiVersion":{},"f:fieldPath":{}}}},"k:{\"name\":\"MY_POD_NAMESPACE\"}":{".":{},"f:name":{},"f:valueFrom":{".":{},"f:fieldRef":{".":{},"f:apiVersion":{},"f:fieldPath":{}}}},"k:{\"name\":\"RABBITMQ_ENABLED_PLUGINS_FILE\"}":{".":{},"f:name":{},"f:value":{}},"k:{\"name\":\"RABBITMQ_NODENAME\"}":{".":{},"f:name":{},"f:value":{}},"k:{\"name\":\"RABBITMQ_USE_LONGNAME\"}":{".":{},"f:name":{},"f:value":{}}},"f:image":{},"f:imagePullPolicy":{},"f:lifecycle":{".":{},"f:preStop":{".":{},"f:exec":{".":{},"f:command":{}}}},"f:name":{},"f:ports":{".":{},"k:{\"containerPort\":4369,\"protocol\":\"TCP\"}":{".":{},"f:containerPort":{},"f:name":{},"f:protocol":{}},"k:{\"containerPort\":5672,\"protocol\":\"TCP\"}":{".":{},"f:containerPort":{},"f:name":{},"f:protocol":{}},"k:{\"containerPort\":15672,\"protocol\":\"TCP\"}":{".":{},"f:containerPort":{},"f:name":{},"f:protocol":{}},"k:{\"containerPort\":15692,\"protocol\":\"TCP\"}":{".":{},"f:containerPort":{},"f:name":{},"f:protocol":{}}},"f:readinessProbe":{".":{},"f:failureThreshold":{},"f:initialDelaySeconds":{},"f:periodSeconds":{},"f:successThreshold":{},"f:tcpSocket":{".":{},"f:port":{}},"f:timeoutSeconds":{}},"f:resources":{".":{},"f:limits":{".":{},"f:cpu":{},"f:memory":{}},"f:requests":{".":{},"f:cpu":{},"f:memory":{}}},"f:terminationMessagePath":{},"f:terminationMessagePolicy":{},"f:volumeMounts":{".":{},"k:{\"mountPath\":\"/etc/pod-info/\"}":{".":{},"f:mountPath":{},"f:name":{}},"k:{\"mountPath\":\"/etc/rabbitmq/conf.d/10-operatorDefaults.conf\"}":{".":{},"f:mountPath":{},"f:name":{},"f:subPath":{}},"k:{\"mountPath\":\"/etc/rabbitmq/conf.d/11-default_user.conf\"}":{".":{},"f:mountPath":{},"f:name":{},"f:subPath":{}},"k:{\"mountPath\":\"/etc/rabbitmq/conf.d/90-userDefinedConfiguration.conf\"}":{".":{},"f:mountPath":{},"f:name":{},"f:subPath":{}},"k:{\"mountPath\":\"/operator\"}":{".":{},"f:mountPath":{},"f:name":{}},"k:{\"mountPath\":\"/var/lib/rabbitmq/\"}":{".":{},"f:mountPath":{},"f:name":{}},"k:{\"mountPath\":\"/var/lib/rabbitmq/mnesia/\"}":{".":{},"f:mountPath":{},"f:name":{}}}}},"f:dnsPolicy":{},"f:initContainers":{".":{},"k:{\"name\":\"setup-container\"}":{".":{},"f:command":{},"f:image":{},"f:imagePullPolicy":{},"f:name":{},"f:resources":{".":{},"f:limits":{".":{},"f:cpu":{},"f:memory":{}},"f:requests":{".":{},"f:cpu":{},"f:memory":{}}},"f:securityContext":{".":{},"f:capabilities":{".":{},"f:drop":{}},"f:runAsUser":{}},"f:terminationMessagePath":{},"f:terminationMessagePolicy":{},"f:volumeMounts":{".":{},"k:{\"mountPath\":\"/operator\"}":{".":{},"f:mountPath":{},"f:name":{}},"k:{\"mountPath\":\"/tmp/default_user.conf\"}":{".":{},"f:mountPath":{},"f:name":{},"f:subPath":{}},"k:{\"mountPath\":\"/tmp/erlang-cookie-secret/\"}":{".":{},"f:mountPath":{},"f:name":{}},"k:{\"mountPath\":\"/tmp/rabbitmq-plugins/\"}":{".":{},"f:mountPath":{},"f:name":{}},"k:{\"mountPath\":\"/var/lib/rabbitmq/\"}":{".":{},"f:mountPath":{},"f:name":{}},"k:{\"mountPath\":\"/var/lib/rabbitmq/mnesia/\"}":{".":{},"f:mountPath":{},"f:name":{}}}}},"f:restartPolicy":{},"f:schedulerName":{},"f:securityContext":{".":{},"f:fsGroup":{},"f:runAsGroup":{},"f:runAsUser":{}},"f:serviceAccount":{},"f:serviceAccountName":{},"f:terminationGracePeriodSeconds":{},"f:topologySpreadConstraints":{".":{},"k:{\"topologyKey\":\"topology.kubernetes.io/zone\",\"whenUnsatisfiable\":\"ScheduleAnyway\"}":{".":{},"f:labelSelector":{".":{},"f:matchLabels":{".":{},"f:app.kubernetes.io/name":{}}},"f:maxSkew":{},"f:topologyKey":{},"f:whenUnsatisfiable":{}}},"f:volumes":{".":{},"k:{\"name\":\"erlang-cookie-secret\"}":{".":{},"f:name":{},"f:secret":{".":{},"f:defaultMode":{},"f:secretName":{}}},"k:{\"name\":\"plugins-conf\"}":{".":{},"f:configMap":{".":{},"f:defaultMode":{},"f:name":{}},"f:name":{}},"k:{\"name\":\"pod-info\"}":{".":{},"f:downwardAPI":{".":{},"f:defaultMode":{},"f:items":{}},"f:name":{}},"k:{\"name\":\"rabbitmq-confd\"}":{".":{},"f:name":{},"f:projected":{".":{},"f:defaultMode":{},"f:sources":{}}},"k:{\"name\":\"rabbitmq-erlang-cookie\"}":{".":{},"f:emptyDir":{},"f:name":{}},"k:{\"name\":\"rabbitmq-plugins\"}":{".":{},"f:emptyDir":{},"f:name":{}}}}},"f:updateStrategy":{"f:rollingUpdate":{".":{},"f:partition":{}},"f:type":{}},"f:volumeClaimTemplates":{}}}}]},"spec":{"replicas":3,"selector":{"matchLabels":{"app.kubernetes.io/name":"rabbitmq-cluster"}},"template":{"metadata":{"creationTimestamp":null,"labels":{"app.kubernetes.io/component":"rabbitmq","app.kubernetes.io/name":"rabbitmq-cluster","app.kubernetes.io/part-of":"rabbitmq"},"annotations":{"prometheus.io/port":"15692","prometheus.io/scrape":"true"}},"spec":{"volumes":[{"name":"plugins-conf","configMap":{"name":"rabbitmq-cluster-plugins-conf","defaultMode":420}},{"name":"rabbitmq-confd","projected":{"sources":[{"secret":{"name":"rabbitmq-cluster-default-user","items":[{"key":"default_user.conf","path":"default_user.conf"}]}},{"configMap":{"name":"rabbitmq-cluster-server-conf","items":[{"key":"operatorDefaults.conf","path":"operatorDefaults.conf"},{"key":"userDefinedConfiguration.conf","path":"userDefinedConfiguration.conf"}]}}],"defaultMode":420}},{"name":"rabbitmq-erlang-cookie","emptyDir":{}},{"name":"erlang-cookie-secret","secret":{"secretName":"rabbitmq-cluster-erlang-cookie","defaultMode":420}},{"name":"rabbitmq-plugins","emptyDir":{}},{"name":"pod-info","downwardAPI":{"items":[{"path":"skipPreStopChecks","fieldRef":{"apiVersion":"v1","fieldPath":"metadata.labels['skipPreStopChecks']"}}],"defaultMode":420}}],"initContainers":[{"name":"setup-container","image":"rabbitmq:3.8.12-management","command":["sh","-c","cp /tmp/erlang-cookie-secret/.erlang.cookie /var/lib/rabbitmq/.erlang.cookie \u0026\u0026 chown 999:999 /var/lib/rabbitmq/.erlang.cookie \u0026\u0026 chmod 600 /var/lib/rabbitmq/.erlang.cookie ; cp /tmp/rabbitmq-plugins/enabled_plugins /operator/enabled_plugins \u0026\u0026 chown 999:999 /operator/enabled_plugins ; chown 999:999 /var/lib/rabbitmq/mnesia/ ; echo '[default]' \u003e /var/lib/rabbitmq/.rabbitmqadmin.conf \u0026\u0026 sed -e 's/default_user/username/' -e 's/default_pass/password/' /tmp/default_user.conf \u003e\u003e /var/lib/rabbitmq/.rabbitmqadmin.conf \u0026\u0026 chown 999:999 /var/lib/rabbitmq/.rabbitmqadmin.conf \u0026\u0026 chmod 600 /var/lib/rabbitmq/.rabbitmqadmin.conf"],"resources":{"limits":{"cpu":"100m","memory":"500Mi"},"requests":{"cpu":"100m","memory":"500Mi"}},"volumeMounts":[{"name":"plugins-conf","mountPath":"/tmp/rabbitmq-plugins/"},{"name":"rabbitmq-erlang-cookie","mountPath":"/var/lib/rabbitmq/"},{"name":"erlang-cookie-secret","mountPath":"/tmp/erlang-cookie-secret/"},{"name":"rabbitmq-plugins","mountPath":"/operator"},{"name":"persistence","mountPath":"/var/lib/rabbitmq/mnesia/"},{"name":"rabbitmq-confd","mountPath":"/tmp/default_user.conf","subPath":"default_user.conf"}],"terminationMessagePath":"/dev/termination-log","terminationMessagePolicy":"File","imagePullPolicy":"IfNotPresent","securityContext":{"capabilities":{"drop":["FSETID","KILL","SETGID","SETUID","SETPCAP","NET_BIND_SERVICE","NET_RAW","SYS_CHROOT","MKNOD","AUDIT_WRITE","SETFCAP"]},"runAsUser":0}}],"containers":[{"name":"rabbitmq","image":"rabbitmq:3.8.12-management","ports":[{"name":"epmd","containerPort":4369,"protocol":"TCP"},{"name":"amqp","containerPort":5672,"protocol":"TCP"},{"name":"management","containerPort":15672,"protocol":"TCP"},{"name":"prometheus","containerPort":15692,"protocol":"TCP"}],"env":[{"name":"MY_POD_NAME","valueFrom":{"fieldRef":{"apiVersion":"v1","fieldPath":"metadata.name"}}},{"name":"MY_POD_NAMESPACE","valueFrom":{"fieldRef":{"apiVersion":"v1","fieldPath":"metadata.namespace"}}},{"name":"RABBITMQ_ENABLED_PLUGINS_FILE","value":"/operator/enabled_plugins"},{"name":"K8S_SERVICE_NAME","value":"rabbitmq-cluster-nodes"},{"name":"RABBITMQ_USE_LONGNAME","value":"true"},{"name":"RABBITMQ_NODENAME","value":"rabbit@$(MY_POD_NAME).$(K8S_SERVICE_NAME).$(MY_POD_NAMESPACE)"},{"name":"K8S_HOSTNAME_SUFFIX","value":".$(K8S_SERVICE_NAME).$(MY_POD_NAMESPACE)"}],"resources":{"limits":{"cpu":"2","memory":"2Gi"},"requests":{"cpu":"1","memory":"2Gi"}},"volumeMounts":[{"name":"rabbitmq-erlang-cookie","mountPath":"/var/lib/rabbitmq/"},{"name":"persistence","mountPath":"/var/lib/rabbitmq/mnesia/"},{"name":"rabbitmq-plugins","mountPath":"/operator"},{"name":"rabbitmq-confd","mountPath":"/etc/rabbitmq/conf.d/10-operatorDefaults.conf","subPath":"operatorDefaults.conf"},{"name":"rabbitmq-confd","mountPath":"/etc/rabbitmq/conf.d/11-default_user.conf","subPath":"default_user.conf"},{"name":"rabbitmq-confd","mountPath":"/etc/rabbitmq/conf.d/90-userDefinedConfiguration.conf","subPath":"userDefinedConfiguration.conf"},{"name":"pod-info","mountPath":"/etc/pod-info/"}],"readinessProbe":{"tcpSocket":{"port":"amqp"},"initialDelaySeconds":10,"timeoutSeconds":5,"periodSeconds":10,"successThreshold":1,"failureThreshold":3},"lifecycle":{"preStop":{"exec":{"command":["/bin/bash","-c","if [ ! -z \"$(cat /etc/pod-info/skipPreStopChecks)\" ]; then exit 0; fi; rabbitmq-upgrade await_online_quorum_plus_one -t 604800; rabbitmq-upgrade await_online_synchronized_mirror -t 604800; rabbitmq-upgrade drain -t 604800"]}}},"terminationMessagePath":"/dev/termination-log","terminationMessagePolicy":"File","imagePullPolicy":"IfNotPresent"}],"restartPolicy":"Always","terminationGracePeriodSeconds":604800,"dnsPolicy":"ClusterFirst","serviceAccountName":"rabbitmq-cluster-server","serviceAccount":"rabbitmq-cluster-server","automountServiceAccountToken":true,"securityContext":{"runAsUser":999,"runAsGroup":999,"fsGroup":999},"schedulerName":"default-scheduler","topologySpreadConstraints":[{"maxSkew":1,"topologyKey":"topology.kubernetes.io/zone","whenUnsatisfiable":"ScheduleAnyway","labelSelector":{"matchLabels":{"app.kubernetes.io/name":"rabbitmq-cluster"}}}]}},"volumeClaimTemplates":[{"metadata":{"name":"persistence","namespace":"default","creationTimestamp":null,"labels":{"app.kubernetes.io/component":"rabbitmq","app.kubernetes.io/name":"rabbitmq-cluster","app.kubernetes.io/part-of":"rabbitmq"},"ownerReferences":[{"apiVersion":"rabbitmq.com/v1beta1","kind":"RabbitmqCluster","name":"rabbitmq-cluster","uid":"18d9928b-0d1c-47be-80ec-20960d053827","controller":true,"blockOwnerDeletion":false}]},"spec":{"accessModes":["ReadWriteOnce"],"resources":{"requests":{"storage":"10Gi"}},"volumeMode":"Filesystem"},"status":{"phase":"Pending"}}],"serviceName":"rabbitmq-cluster-nodes","podManagementPolicy":"Parallel","updateStrategy":{"type":"RollingUpdate","rollingUpdate":{"partition":0}},"revisionHistoryLimit":10},"status":{"observedGeneration":2,"replicas":3,"readyReplicas":1,"currentReplicas":3,"updatedReplicas":3,"currentRevision":"rabbitmq-cluster-server-5f8b8665fb","updateRevision":"rabbitmq-cluster-server-5f8b8665fb","collisionCount":0}}
2022/03/18 18:01:38 learn_server.go:256: [SIEVE-BEFORE-WRITE]	45
2022/03/18 18:01:38 learn_server.go:263: [SIEVE-AFTER-WRITE]	45	Update	statefulset	github.com/rabbitmq/cluster-operator/controllers.(*RabbitmqClusterReconciler)	NoError	{"metadata":{"name":"rabbitmq-cluster-server","namespace":"default","selfLink":"/apis/apps/v1/namespaces/default/statefulsets/rabbitmq-cluster-server","uid":"cb5c43bc-6ee7-481c-ab01-6f3acffdd3c8","resourceVersion":"989","generation":2,"creationTimestamp":"2022-03-18T18:00:38Z","labels":{"app.kubernetes.io/component":"rabbitmq","app.kubernetes.io/name":"rabbitmq-cluster","app.kubernetes.io/part-of":"rabbitmq"},"ownerReferences":[{"apiVersion":"rabbitmq.com/v1beta1","kind":"RabbitmqCluster","name":"rabbitmq-cluster","uid":"18d9928b-0d1c-47be-80ec-20960d053827","controller":true,"blockOwnerDeletion":true}],"managedFields":[{"manager":"kube-controller-manager","operation":"Update","apiVersion":"apps/v1","time":"2022-03-18T18:01:23Z","fieldsType":"FieldsV1","fieldsV1":{"f:status":{"f:collisionCount":{},"f:currentReplicas":{},"f:currentRevision":{},"f:observedGeneration":{},"f:readyReplicas":{},"f:replicas":{},"f:updateRevision":{},"f:updatedReplicas":{}}}},{"manager":"manager","operation":"Update","apiVersion":"apps/v1","time":"2022-03-18T18:01:23Z","fieldsType":"FieldsV1","fieldsV1":{"f:metadata":{"f:labels":{".":{},"f:app.kubernetes.io/component":{},"f:app.kubernetes.io/name":{},"f:app.kubernetes.io/part-of":{}},"f:ownerReferences":{".":{},"k:{\"uid\":\"18d9928b-0d1c-47be-80ec-20960d053827\"}":{".":{},"f:apiVersion":{},"f:blockOwnerDeletion":{},"f:controller":{},"f:kind":{},"f:name":{},"f:uid":{}}}},"f:spec":{"f:podManagementPolicy":{},"f:replicas":{},"f:revisionHistoryLimit":{},"f:selector":{"f:matchLabels":{".":{},"f:app.kubernetes.io/name":{}}},"f:serviceName":{},"f:template":{"f:metadata":{"f:annotations":{".":{},"f:prometheus.io/port":{},"f:prometheus.io/scrape":{}},"f:labels":{".":{},"f:app.kubernetes.io/component":{},"f:app.kubernetes.io/name":{},"f:app.kubernetes.io/part-of":{}}},"f:spec":{"f:automountServiceAccountToken":{},"f:containers":{"k:{\"name\":\"rabbitmq\"}":{".":{},"f:env":{".":{},"k:{\"name\":\"K8S_HOSTNAME_SUFFIX\"}":{".":{},"f:name":{},"f:value":{}},"k:{\"name\":\"K8S_SERVICE_NAME\"}":{".":{},"f:name":{},"f:value":{}},"k:{\"name\":\"MY_POD_NAME\"}":{".":{},"f:name":{},"f:valueFrom":{".":{},"f:fieldRef":{".":{},"f:apiVersion":{},"f:fieldPath":{}}}},"k:{\"name\":\"MY_POD_NAMESPACE\"}":{".":{},"f:name":{},"f:valueFrom":{".":{},"f:fieldRef":{".":{},"f:apiVersion":{},"f:fieldPath":{}}}},"k:{\"name\":\"RABBITMQ_ENABLED_PLUGINS_FILE\"}":{".":{},"f:name":{},"f:value":{}},"k:{\"name\":\"RABBITMQ_NODENAME\"}":{".":{},"f:name":{},"f:value":{}},"k:{\"name\":\"RABBITMQ_USE_LONGNAME\"}":{".":{},"f:name":{},"f:value":{}}},"f:image":{},"f:imagePullPolicy":{},"f:lifecycle":{".":{},"f:preStop":{".":{},"f:exec":{".":{},"f:command":{}}}},"f:name":{},"f:ports":{".":{},"k:{\"containerPort\":4369,\"protocol\":\"TCP\"}":{".":{},"f:containerPort":{},"f:name":{},"f:protocol":{}},"k:{\"containerPort\":5672,\"protocol\":\"TCP\"}":{".":{},"f:containerPort":{},"f:name":{},"f:protocol":{}},"k:{\"containerPort\":15672,\"protocol\":\"TCP\"}":{".":{},"f:containerPort":{},"f:name":{},"f:protocol":{}},"k:{\"containerPort\":15692,\"protocol\":\"TCP\"}":{".":{},"f:containerPort":{},"f:name":{},"f:protocol":{}}},"f:readinessProbe":{".":{},"f:failureThreshold":{},"f:initialDelaySeconds":{},"f:periodSeconds":{},"f:successThreshold":{},"f:tcpSocket":{".":{},"f:port":{}},"f:timeoutSeconds":{}},"f:resources":{".":{},"f:limits":{".":{},"f:cpu":{},"f:memory":{}},"f:requests":{".":{},"f:cpu":{},"f:memory":{}}},"f:terminationMessagePath":{},"f:terminationMessagePolicy":{},"f:volumeMounts":{".":{},"k:{\"mountPath\":\"/etc/pod-info/\"}":{".":{},"f:mountPath":{},"f:name":{}},"k:{\"mountPath\":\"/etc/rabbitmq/conf.d/10-operatorDefaults.conf\"}":{".":{},"f:mountPath":{},"f:name":{},"f:subPath":{}},"k:{\"mountPath\":\"/etc/rabbitmq/conf.d/11-default_user.conf\"}":{".":{},"f:mountPath":{},"f:name":{},"f:subPath":{}},"k:{\"mountPath\":\"/etc/rabbitmq/conf.d/90-userDefinedConfiguration.conf\"}":{".":{},"f:mountPath":{},"f:name":{},"f:subPath":{}},"k:{\"mountPath\":\"/operator\"}":{".":{},"f:mountPath":{},"f:name":{}},"k:{\"mountPath\":\"/var/lib/rabbitmq/\"}":{".":{},"f:mountPath":{},"f:name":{}},"k:{\"mountPath\":\"/var/lib/rabbitmq/mnesia/\"}":{".":{},"f:mountPath":{},"f:name":{}}}}},"f:dnsPolicy":{},"f:initContainers":{".":{},"k:{\"name\":\"setup-container\"}":{".":{},"f:command":{},"f:image":{},"f:imagePullPolicy":{},"f:name":{},"f:resources":{".":{},"f:limits":{".":{},"f:cpu":{},"f:memory":{}},"f:requests":{".":{},"f:cpu":{},"f:memory":{}}},"f:securityContext":{".":{},"f:capabilities":{".":{},"f:drop":{}},"f:runAsUser":{}},"f:terminationMessagePath":{},"f:terminationMessagePolicy":{},"f:volumeMounts":{".":{},"k:{\"mountPath\":\"/operator\"}":{".":{},"f:mountPath":{},"f:name":{}},"k:{\"mountPath\":\"/tmp/default_user.conf\"}":{".":{},"f:mountPath":{},"f:name":{},"f:subPath":{}},"k:{\"mountPath\":\"/tmp/erlang-cookie-secret/\"}":{".":{},"f:mountPath":{},"f:name":{}},"k:{\"mountPath\":\"/tmp/rabbitmq-plugins/\"}":{".":{},"f:mountPath":{},"f:name":{}},"k:{\"mountPath\":\"/var/lib/rabbitmq/\"}":{".":{},"f:mountPath":{},"f:name":{}},"k:{\"mountPath\":\"/var/lib/rabbitmq/mnesia/\"}":{".":{},"f:mountPath":{},"f:name":{}}}}},"f:restartPolicy":{},"f:schedulerName":{},"f:securityContext":{".":{},"f:fsGroup":{},"f:runAsGroup":{},"f:runAsUser":{}},"f:serviceAccount":{},"f:serviceAccountName":{},"f:terminationGracePeriodSeconds":{},"f:topologySpreadConstraints":{".":{},"k:{\"topologyKey\":\"topology.kubernetes.io/zone\",\"whenUnsatisfiable\":\"ScheduleAnyway\"}":{".":{},"f:labelSelector":{".":{},"f:matchLabels":{".":{},"f:app.kubernetes.io/name":{}}},"f:maxSkew":{},"f:topologyKey":{},"f:whenUnsatisfiable":{}}},"f:volumes":{".":{},"k:{\"name\":\"erlang-cookie-secret\"}":{".":{},"f:name":{},"f:secret":{".":{},"f:defaultMode":{},"f:secretName":{}}},"k:{\"name\":\"plugins-conf\"}":{".":{},"f:configMap":{".":{},"f:defaultMode":{},"f:name":{}},"f:name":{}},"k:{\"name\":\"pod-info\"}":{".":{},"f:downwardAPI":{".":{},"f:defaultMode":{},"f:items":{}},"f:name":{}},"k:{\"name\":\"rabbitmq-confd\"}":{".":{},"f:name":{},"f:projected":{".":{},"f:defaultMode":{},"f:sources":{}}},"k:{\"name\":\"rabbitmq-erlang-cookie\"}":{".":{},"f:emptyDir":{},"f:name":{}},"k:{\"name\":\"rabbitmq-plugins\"}":{".":{},"f:emptyDir":{},"f:name":{}}}}},"f:updateStrategy":{"f:rollingUpdate":{".":{},"f:partition":{}},"f:type":{}},"f:volumeClaimTemplates":{}}}}]},"spec":{"replicas":3,"selector":{"matchLabels":{"app.kubernetes.io/name":"rabbitmq-cluster"}},"template":{"metadata":{"creationTimestamp":null,"labels":{"app.kubernetes.io/component":"rabbitmq","app.kubernetes.io/name":"rabbitmq-cluster","app.kubernetes.io/part-of":"rabbitmq"},"annotations":{"prometheus.io/port":"15692","prometheus.io/scrape":"true"}},"spec":{"volumes":[{"name":"plugins-conf","configMap":{"name":"rabbitmq-cluster-plugins-conf","defaultMode":420}},{"name":"rabbitmq-confd","projected":{"sources":[{"secret":{"name":"rabbitmq-cluster-default-user","items":[{"key":"default_user.conf","path":"default_user.conf"}]}},{"configMap":{"name":"rabbitmq-cluster-server-conf","items":[{"key":"operatorDefaults.conf","path":"operatorDefaults.conf"},{"key":"userDefinedConfiguration.conf","path":"userDefinedConfiguration.conf"}]}}],"defaultMode":420}},{"name":"rabbitmq-erlang-cookie","emptyDir":{}},{"name":"erlang-cookie-secret","secret":{"secretName":"rabbitmq-cluster-erlang-cookie","defaultMode":420}},{"name":"rabbitmq-plugins","emptyDir":{}},{"name":"pod-info","downwardAPI":{"items":[{"path":"skipPreStopChecks","fieldRef":{"apiVersion":"v1","fieldPath":"metadata.labels['skipPreStopChecks']"}}],"defaultMode":420}}],"initContainers":[{"name":"setup-container","image":"rabbitmq:3.8.12-management","command":["sh","-c","cp /tmp/erlang-cookie-secret/.erlang.cookie /var/lib/rabbitmq/.erlang.cookie \u0026\u0026 chown 999:999 /var/lib/rabbitmq/.erlang.cookie \u0026\u0026 chmod 600 /var/lib/rabbitmq/.erlang.cookie ; cp /tmp/rabbitmq-plugins/enabled_plugins /operator/enabled_plugins \u0026\u0026 chown 999:999 /operator/enabled_plugins ; chown 999:999 /var/lib/rabbitmq/mnesia/ ; echo '[default]' \u003e /var/lib/rabbitmq/.rabbitmqadmin.conf \u0026\u0026 sed -e 's/default_user/username/' -e 's/default_pass/password/' /tmp/default_user.conf \u003e\u003e /var/lib/rabbitmq/.rabbitmqadmin.conf \u0026\u0026 chown 999:999 /var/lib/rabbitmq/.rabbitmqadmin.conf \u0026\u0026 chmod 600 /var/lib/rabbitmq/.rabbitmqadmin.conf"],"resources":{"limits":{"cpu":"100m","memory":"500Mi"},"requests":{"cpu":"100m","memory":"500Mi"}},"volumeMounts":[{"name":"plugins-conf","mountPath":"/tmp/rabbitmq-plugins/"},{"name":"rabbitmq-erlang-cookie","mountPath":"/var/lib/rabbitmq/"},{"name":"erlang-cookie-secret","mountPath":"/tmp/erlang-cookie-secret/"},{"name":"rabbitmq-plugins","mountPath":"/operator"},{"name":"persistence","mountPath":"/var/lib/rabbitmq/mnesia/"},{"name":"rabbitmq-confd","mountPath":"/tmp/default_user.conf","subPath":"default_user.conf"}],"terminationMessagePath":"/dev/termination-log","terminationMessagePolicy":"File","imagePullPolicy":"IfNotPresent","securityContext":{"capabilities":{"drop":["FSETID","KILL","SETGID","SETUID","SETPCAP","NET_BIND_SERVICE","NET_RAW","SYS_CHROOT","MKNOD","AUDIT_WRITE","SETFCAP"]},"runAsUser":0}}],"containers":[{"name":"rabbitmq","image":"rabbitmq:3.8.12-management","ports":[{"name":"epmd","containerPort":4369,"protocol":"TCP"},{"name":"amqp","containerPort":5672,"protocol":"TCP"},{"name":"management","containerPort":15672,"protocol":"TCP"},{"name":"prometheus","containerPort":15692,"protocol":"TCP"}],"env":[{"name":"MY_POD_NAME","valueFrom":{"fieldRef":{"apiVersion":"v1","fieldPath":"metadata.name"}}},{"name":"MY_POD_NAMESPACE","valueFrom":{"fieldRef":{"apiVersion":"v1","fieldPath":"metadata.namespace"}}},{"name":"RABBITMQ_ENABLED_PLUGINS_FILE","value":"/operator/enabled_plugins"},{"name":"K8S_SERVICE_NAME","value":"rabbitmq-cluster-nodes"},{"name":"RABBITMQ_USE_LONGNAME","value":"true"},{"name":"RABBITMQ_NODENAME","value":"rabbit@$(MY_POD_NAME).$(K8S_SERVICE_NAME).$(MY_POD_NAMESPACE)"},{"name":"K8S_HOSTNAME_SUFFIX","value":".$(K8S_SERVICE_NAME).$(MY_POD_NAMESPACE)"}],"resources":{"limits":{"cpu":"2","memory":"2Gi"},"requests":{"cpu":"1","memory":"2Gi"}},"volumeMounts":[{"name":"rabbitmq-erlang-cookie","mountPath":"/var/lib/rabbitmq/"},{"name":"persistence","mountPath":"/var/lib/rabbitmq/mnesia/"},{"name":"rabbitmq-plugins","mountPath":"/operator"},{"name":"rabbitmq-confd","mountPath":"/etc/rabbitmq/conf.d/10-operatorDefaults.conf","subPath":"operatorDefaults.conf"},{"name":"rabbitmq-confd","mountPath":"/etc/rabbitmq/conf.d/11-default_user.conf","subPath":"default_user.conf"},{"name":"rabbitmq-confd","mountPath":"/etc/rabbitmq/conf.d/90-userDefinedConfiguration.conf","subPath":"userDefinedConfiguration.conf"},{"name":"pod-info","mountPath":"/etc/pod-info/"}],"readinessProbe":{"tcpSocket":{"port":"amqp"},"initialDelaySeconds":10,"timeoutSeconds":5,"periodSeconds":10,"successThreshold":1,"failureThreshold":3},"lifecycle":{"preStop":{"exec":{"command":["/bin/bash","-c","if [ ! -z \"$(cat /etc/pod-info/skipPreStopChecks)\" ]; then exit 0; fi; rabbitmq-upgrade await_online_quorum_plus_one -t 604800; rabbitmq-upgrade await_online_synchronized_mirror -t 604800; rabbitmq-upgrade drain -t 604800"]}}},"terminationMessagePath":"/dev/termination-log","terminationMessagePolicy":"File","imagePullPolicy":"IfNotPresent"}],"restartPolicy":"Always","terminationGracePeriodSeconds":604800,"dnsPolicy":"ClusterFirst","serviceAccountName":"rabbitmq-cluster-server","serviceAccount":"rabbitmq-cluster-server","automountServiceAccountToken":true,"securityContext":{"runAsUser":999,"runAsGroup":999,"fsGroup":999},"schedulerName":"default-scheduler","topologySpreadConstraints":[{"maxSkew":1,"topologyKey":"topology.kubernetes.io/zone","whenUnsatisfiable":"ScheduleAnyway","labelSelector":{"matchLabels":{"app.kubernetes.io/name":"rabbitmq-cluster"}}}]}},"volumeClaimTemplates":[{"metadata":{"name":"persistence","namespace":"default","creationTimestamp":null,"labels":{"app.kubernetes.io/component":"rabbitmq","app.kubernetes.io/name":"rabbitmq-cluster","app.kubernetes.io/part-of":"rabbitmq"},"ownerReferences":[{"apiVersion":"rabbitmq.com/v1beta1","kind":"RabbitmqCluster","name":"rabbitmq-cluster","uid":"18d9928b-0d1c-47be-80ec-20960d053827","controller":true,"blockOwnerDeletion":false}]},"spec":{"accessModes":["ReadWriteOnce"],"resources":{"requests":{"storage":"10Gi"}},"volumeMode":"Filesystem"},"status":{"phase":"Pending"}}],"serviceName":"rabbitmq-cluster-nodes","podManagementPolicy":"Parallel","updateStrategy":{"type":"RollingUpdate","rollingUpdate":{"partition":0}},"revisionHistoryLimit":10},"status":{"observedGeneration":2,"replicas":3,"readyReplicas":1,"currentReplicas":3,"updatedReplicas":3,"currentRevision":"rabbitmq-cluster-server-5f8b8665fb","updateRevision":"rabbitmq-cluster-server-5f8b8665fb","collisionCount":0}}
2022/03/18 18:01:38 learn_server.go:291: [SIEVE-AFTER-READ]	Get	true	configmap	default	rabbitmq-cluster-server-conf	github.com/rabbitmq/cluster-operator/controllers.(*RabbitmqClusterReconciler)	NoError	{"kind":"ConfigMap","apiVersion":"v1","metadata":{"name":"rabbitmq-cluster-server-conf","namespace":"default","selfLink":"/api/v1/namespaces/default/configmaps/rabbitmq-cluster-server-conf","uid":"22474f2b-8454-44b7-8079-8990223969cc","resourceVersion":"714","creationTimestamp":"2022-03-18T18:00:38Z","labels":{"app.kubernetes.io/component":"rabbitmq","app.kubernetes.io/name":"rabbitmq-cluster","app.kubernetes.io/part-of":"rabbitmq"},"ownerReferences":[{"apiVersion":"rabbitmq.com/v1beta1","kind":"RabbitmqCluster","name":"rabbitmq-cluster","uid":"18d9928b-0d1c-47be-80ec-20960d053827","controller":true,"blockOwnerDeletion":true}],"managedFields":[{"manager":"manager","operation":"Update","apiVersion":"v1","time":"2022-03-18T18:00:38Z","fieldsType":"FieldsV1","fieldsV1":{"f:data":{".":{},"f:operatorDefaults.conf":{},"f:userDefinedConfiguration.conf":{}},"f:metadata":{"f:labels":{".":{},"f:app.kubernetes.io/component":{},"f:app.kubernetes.io/name":{},"f:app.kubernetes.io/part-of":{}},"f:ownerReferences":{".":{},"k:{\"uid\":\"18d9928b-0d1c-47be-80ec-20960d053827\"}":{".":{},"f:apiVersion":{},"f:blockOwnerDeletion":{},"f:controller":{},"f:kind":{},"f:name":{},"f:uid":{}}}}}}]},"data":{"operatorDefaults.conf":"cluster_formation.peer_discovery_backend             = rabbit_peer_discovery_k8s\ncluster_formation.k8s.host                           = kubernetes.default\ncluster_formation.k8s.address_type                   = hostname\ncluster_partition_handling                           = pause_minority\nqueue_master_locator                                 = min-masters\ndisk_free_limit.absolute                             = 2GB\ncluster_formation.randomized_startup_delay_range.min = 5\ncluster_formation.randomized_startup_delay_range.max = 30\ncluster_name                                         = rabbitmq-cluster\n","userDefinedConfiguration.conf":"total_memory_available_override_value = 1717986919\n"}}
2022/03/18 18:01:38 learn_server.go:256: [SIEVE-BEFORE-WRITE]	46
2022/03/18 18:01:38 learn_server.go:263: [SIEVE-AFTER-WRITE]	46	StatusUpdate	rabbitmqcluster	github.com/rabbitmq/cluster-operator/controllers.(*RabbitmqClusterReconciler)	NoError	{"metadata":{"name":"rabbitmq-cluster","namespace":"default","selfLink":"/apis/rabbitmq.com/v1beta1/namespaces/default/rabbitmqclusters/rabbitmq-cluster/status","uid":"18d9928b-0d1c-47be-80ec-20960d053827","resourceVersion":"977","generation":3,"creationTimestamp":"2022-03-18T18:00:38Z","annotations":{"kubectl.kubernetes.io/last-applied-configuration":"{\"apiVersion\":\"rabbitmq.com/v1beta1\",\"kind\":\"RabbitmqCluster\",\"metadata\":{\"annotations\":{},\"name\":\"rabbitmq-cluster\",\"namespace\":\"default\"},\"spec\":{\"persistence\":{\"storage\":\"10Gi\"},\"replicas\":1}}\n"},"finalizers":["deletion.finalizers.rabbitmqclusters.rabbitmq.com"],"managedFields":[{"manager":"kubectl-client-side-apply","operation":"Update","apiVersion":"rabbitmq.com/v1beta1","time":"2022-03-18T18:00:38Z","fieldsType":"FieldsV1","fieldsV1":{"f:metadata":{"f:annotations":{".":{},"f:kubectl.kubernetes.io/last-applied-configuration":{}}},"f:spec":{".":{},"f:image":{},"f:persistence":{".":{},"f:storage":{}},"f:resources":{".":{},"f:limits":{".":{},"f:memory":{}},"f:requests":{".":{},"f:memory":{}}},"f:service":{".":{},"f:type":{}},"f:terminationGracePeriodSeconds":{}}}},{"manager":"kubectl-patch","operation":"Update","apiVersion":"rabbitmq.com/v1beta1","time":"2022-03-18T18:01:23Z","fieldsType":"FieldsV1","fieldsV1":{"f:spec":{"f:replicas":{}}}},{"manager":"manager","operation":"Update","apiVersion":"rabbitmq.com/v1beta1","time":"2022-03-18T18:01:23Z","fieldsType":"FieldsV1","fieldsV1":{"f:metadata":{"f:finalizers":{}},"f:spec":{"f:override":{},"f:rabbitmq":{},"f:resources":{"f:limits":{"f:cpu":{}},"f:requests":{"f:cpu":{}}},"f:tls":{}},"f:status":{".":{},"f:conditions":{},"f:defaultUser":{".":{},"f:secretReference":{".":{},"f:keys":{".":{},"f:password":{},"f:username":{}},"f:name":{},"f:namespace":{}},"f:serviceReference":{".":{},"f:name":{},"f:namespace":{}}}}}}]},"spec":{"replicas":3,"image":"rabbitmq:3.8.12-management","service":{"type":"ClusterIP"},"persistence":{"storage":"10Gi"},"resources":{"limits":{"cpu":"2","memory":"2Gi"},"requests":{"cpu":"1","memory":"2Gi"}},"rabbitmq":{},"tls":{},"override":{},"terminationGracePeriodSeconds":604800},"status":{"conditions":[{"type":"AllReplicasReady","status":"False","lastTransitionTime":"2022-03-18T18:01:23Z","reason":"NotAllPodsReady","message":"1/3 Pods ready"},{"type":"ClusterAvailable","status":"True","lastTransitionTime":"2022-03-18T18:01:17Z","reason":"AtLeastOneEndpointAvailable"},{"type":"NoWarnings","status":"True","lastTransitionTime":"2022-03-18T18:00:38Z","reason":"NoWarnings"},{"type":"ReconcileSuccess","status":"True","lastTransitionTime":"2022-03-18T18:01:18Z","reason":"Success","message":"Finish reconciling"}],"defaultUser":{"secretReference":{"name":"rabbitmq-cluster-default-user","namespace":"default","keys":{"password":"password","username":"username"}},"serviceReference":{"name":"rabbitmq-cluster","namespace":"default"}},"binding":{"name":"rabbitmq-cluster-default-user"}}}
2022/03/18 18:01:38 learn_server.go:291: [SIEVE-AFTER-READ]	Get	true	statefulset	default	rabbitmq-cluster-server	github.com/rabbitmq/cluster-operator/controllers.(*RabbitmqClusterReconciler)	NoError	{"kind":"StatefulSet","apiVersion":"apps/v1","metadata":{"name":"rabbitmq-cluster-server","namespace":"default","selfLink":"/apis/apps/v1/namespaces/default/statefulsets/rabbitmq-cluster-server","uid":"cb5c43bc-6ee7-481c-ab01-6f3acffdd3c8","resourceVersion":"989","generation":2,"creationTimestamp":"2022-03-18T18:00:38Z","labels":{"app.kubernetes.io/component":"rabbitmq","app.kubernetes.io/name":"rabbitmq-cluster","app.kubernetes.io/part-of":"rabbitmq"},"ownerReferences":[{"apiVersion":"rabbitmq.com/v1beta1","kind":"RabbitmqCluster","name":"rabbitmq-cluster","uid":"18d9928b-0d1c-47be-80ec-20960d053827","controller":true,"blockOwnerDeletion":true}],"managedFields":[{"manager":"kube-controller-manager","operation":"Update","apiVersion":"apps/v1","time":"2022-03-18T18:01:23Z","fieldsType":"FieldsV1","fieldsV1":{"f:status":{"f:collisionCount":{},"f:currentReplicas":{},"f:currentRevision":{},"f:observedGeneration":{},"f:readyReplicas":{},"f:replicas":{},"f:updateRevision":{},"f:updatedReplicas":{}}}},{"manager":"manager","operation":"Update","apiVersion":"apps/v1","time":"2022-03-18T18:01:23Z","fieldsType":"FieldsV1","fieldsV1":{"f:metadata":{"f:labels":{".":{},"f:app.kubernetes.io/component":{},"f:app.kubernetes.io/name":{},"f:app.kubernetes.io/part-of":{}},"f:ownerReferences":{".":{},"k:{\"uid\":\"18d9928b-0d1c-47be-80ec-20960d053827\"}":{".":{},"f:apiVersion":{},"f:blockOwnerDeletion":{},"f:controller":{},"f:kind":{},"f:name":{},"f:uid":{}}}},"f:spec":{"f:podManagementPolicy":{},"f:replicas":{},"f:revisionHistoryLimit":{},"f:selector":{"f:matchLabels":{".":{},"f:app.kubernetes.io/name":{}}},"f:serviceName":{},"f:template":{"f:metadata":{"f:annotations":{".":{},"f:prometheus.io/port":{},"f:prometheus.io/scrape":{}},"f:labels":{".":{},"f:app.kubernetes.io/component":{},"f:app.kubernetes.io/name":{},"f:app.kubernetes.io/part-of":{}}},"f:spec":{"f:automountServiceAccountToken":{},"f:containers":{"k:{\"name\":\"rabbitmq\"}":{".":{},"f:env":{".":{},"k:{\"name\":\"K8S_HOSTNAME_SUFFIX\"}":{".":{},"f:name":{},"f:value":{}},"k:{\"name\":\"K8S_SERVICE_NAME\"}":{".":{},"f:name":{},"f:value":{}},"k:{\"name\":\"MY_POD_NAME\"}":{".":{},"f:name":{},"f:valueFrom":{".":{},"f:fieldRef":{".":{},"f:apiVersion":{},"f:fieldPath":{}}}},"k:{\"name\":\"MY_POD_NAMESPACE\"}":{".":{},"f:name":{},"f:valueFrom":{".":{},"f:fieldRef":{".":{},"f:apiVersion":{},"f:fieldPath":{}}}},"k:{\"name\":\"RABBITMQ_ENABLED_PLUGINS_FILE\"}":{".":{},"f:name":{},"f:value":{}},"k:{\"name\":\"RABBITMQ_NODENAME\"}":{".":{},"f:name":{},"f:value":{}},"k:{\"name\":\"RABBITMQ_USE_LONGNAME\"}":{".":{},"f:name":{},"f:value":{}}},"f:image":{},"f:imagePullPolicy":{},"f:lifecycle":{".":{},"f:preStop":{".":{},"f:exec":{".":{},"f:command":{}}}},"f:name":{},"f:ports":{".":{},"k:{\"containerPort\":4369,\"protocol\":\"TCP\"}":{".":{},"f:containerPort":{},"f:name":{},"f:protocol":{}},"k:{\"containerPort\":5672,\"protocol\":\"TCP\"}":{".":{},"f:containerPort":{},"f:name":{},"f:protocol":{}},"k:{\"containerPort\":15672,\"protocol\":\"TCP\"}":{".":{},"f:containerPort":{},"f:name":{},"f:protocol":{}},"k:{\"containerPort\":15692,\"protocol\":\"TCP\"}":{".":{},"f:containerPort":{},"f:name":{},"f:protocol":{}}},"f:readinessProbe":{".":{},"f:failureThreshold":{},"f:initialDelaySeconds":{},"f:periodSeconds":{},"f:successThreshold":{},"f:tcpSocket":{".":{},"f:port":{}},"f:timeoutSeconds":{}},"f:resources":{".":{},"f:limits":{".":{},"f:cpu":{},"f:memory":{}},"f:requests":{".":{},"f:cpu":{},"f:memory":{}}},"f:terminationMessagePath":{},"f:terminationMessagePolicy":{},"f:volumeMounts":{".":{},"k:{\"mountPath\":\"/etc/pod-info/\"}":{".":{},"f:mountPath":{},"f:name":{}},"k:{\"mountPath\":\"/etc/rabbitmq/conf.d/10-operatorDefaults.conf\"}":{".":{},"f:mountPath":{},"f:name":{},"f:subPath":{}},"k:{\"mountPath\":\"/etc/rabbitmq/conf.d/11-default_user.conf\"}":{".":{},"f:mountPath":{},"f:name":{},"f:subPath":{}},"k:{\"mountPath\":\"/etc/rabbitmq/conf.d/90-userDefinedConfiguration.conf\"}":{".":{},"f:mountPath":{},"f:name":{},"f:subPath":{}},"k:{\"mountPath\":\"/operator\"}":{".":{},"f:mountPath":{},"f:name":{}},"k:{\"mountPath\":\"/var/lib/rabbitmq/\"}":{".":{},"f:mountPath":{},"f:name":{}},"k:{\"mountPath\":\"/var/lib/rabbitmq/mnesia/\"}":{".":{},"f:mountPath":{},"f:name":{}}}}},"f:dnsPolicy":{},"f:initContainers":{".":{},"k:{\"name\":\"setup-container\"}":{".":{},"f:command":{},"f:image":{},"f:imagePullPolicy":{},"f:name":{},"f:resources":{".":{},"f:limits":{".":{},"f:cpu":{},"f:memory":{}},"f:requests":{".":{},"f:cpu":{},"f:memory":{}}},"f:securityContext":{".":{},"f:capabilities":{".":{},"f:drop":{}},"f:runAsUser":{}},"f:terminationMessagePath":{},"f:terminationMessagePolicy":{},"f:volumeMounts":{".":{},"k:{\"mountPath\":\"/operator\"}":{".":{},"f:mountPath":{},"f:name":{}},"k:{\"mountPath\":\"/tmp/default_user.conf\"}":{".":{},"f:mountPath":{},"f:name":{},"f:subPath":{}},"k:{\"mountPath\":\"/tmp/erlang-cookie-secret/\"}":{".":{},"f:mountPath":{},"f:name":{}},"k:{\"mountPath\":\"/tmp/rabbitmq-plugins/\"}":{".":{},"f:mountPath":{},"f:name":{}},"k:{\"mountPath\":\"/var/lib/rabbitmq/\"}":{".":{},"f:mountPath":{},"f:name":{}},"k:{\"mountPath\":\"/var/lib/rabbitmq/mnesia/\"}":{".":{},"f:mountPath":{},"f:name":{}}}}},"f:restartPolicy":{},"f:schedulerName":{},"f:securityContext":{".":{},"f:fsGroup":{},"f:runAsGroup":{},"f:runAsUser":{}},"f:serviceAccount":{},"f:serviceAccountName":{},"f:terminationGracePeriodSeconds":{},"f:topologySpreadConstraints":{".":{},"k:{\"topologyKey\":\"topology.kubernetes.io/zone\",\"whenUnsatisfiable\":\"ScheduleAnyway\"}":{".":{},"f:labelSelector":{".":{},"f:matchLabels":{".":{},"f:app.kubernetes.io/name":{}}},"f:maxSkew":{},"f:topologyKey":{},"f:whenUnsatisfiable":{}}},"f:volumes":{".":{},"k:{\"name\":\"erlang-cookie-secret\"}":{".":{},"f:name":{},"f:secret":{".":{},"f:defaultMode":{},"f:secretName":{}}},"k:{\"name\":\"plugins-conf\"}":{".":{},"f:configMap":{".":{},"f:defaultMode":{},"f:name":{}},"f:name":{}},"k:{\"name\":\"pod-info\"}":{".":{},"f:downwardAPI":{".":{},"f:defaultMode":{},"f:items":{}},"f:name":{}},"k:{\"name\":\"rabbitmq-confd\"}":{".":{},"f:name":{},"f:projected":{".":{},"f:defaultMode":{},"f:sources":{}}},"k:{\"name\":\"rabbitmq-erlang-cookie\"}":{".":{},"f:emptyDir":{},"f:name":{}},"k:{\"name\":\"rabbitmq-plugins\"}":{".":{},"f:emptyDir":{},"f:name":{}}}}},"f:updateStrategy":{"f:rollingUpdate":{".":{},"f:partition":{}},"f:type":{}},"f:volumeClaimTemplates":{}}}}]},"spec":{"replicas":3,"selector":{"matchLabels":{"app.kubernetes.io/name":"rabbitmq-cluster"}},"template":{"metadata":{"creationTimestamp":null,"labels":{"app.kubernetes.io/component":"rabbitmq","app.kubernetes.io/name":"rabbitmq-cluster","app.kubernetes.io/part-of":"rabbitmq"},"annotations":{"prometheus.io/port":"15692","prometheus.io/scrape":"true"}},"spec":{"volumes":[{"name":"plugins-conf","configMap":{"name":"rabbitmq-cluster-plugins-conf","defaultMode":420}},{"name":"rabbitmq-confd","projected":{"sources":[{"secret":{"name":"rabbitmq-cluster-default-user","items":[{"key":"default_user.conf","path":"default_user.conf"}]}},{"configMap":{"name":"rabbitmq-cluster-server-conf","items":[{"key":"operatorDefaults.conf","path":"operatorDefaults.conf"},{"key":"userDefinedConfiguration.conf","path":"userDefinedConfiguration.conf"}]}}],"defaultMode":420}},{"name":"rabbitmq-erlang-cookie","emptyDir":{}},{"name":"erlang-cookie-secret","secret":{"secretName":"rabbitmq-cluster-erlang-cookie","defaultMode":420}},{"name":"rabbitmq-plugins","emptyDir":{}},{"name":"pod-info","downwardAPI":{"items":[{"path":"skipPreStopChecks","fieldRef":{"apiVersion":"v1","fieldPath":"metadata.labels['skipPreStopChecks']"}}],"defaultMode":420}}],"initContainers":[{"name":"setup-container","image":"rabbitmq:3.8.12-management","command":["sh","-c","cp /tmp/erlang-cookie-secret/.erlang.cookie /var/lib/rabbitmq/.erlang.cookie \u0026\u0026 chown 999:999 /var/lib/rabbitmq/.erlang.cookie \u0026\u0026 chmod 600 /var/lib/rabbitmq/.erlang.cookie ; cp /tmp/rabbitmq-plugins/enabled_plugins /operator/enabled_plugins \u0026\u0026 chown 999:999 /operator/enabled_plugins ; chown 999:999 /var/lib/rabbitmq/mnesia/ ; echo '[default]' \u003e /var/lib/rabbitmq/.rabbitmqadmin.conf \u0026\u0026 sed -e 's/default_user/username/' -e 's/default_pass/password/' /tmp/default_user.conf \u003e\u003e /var/lib/rabbitmq/.rabbitmqadmin.conf \u0026\u0026 chown 999:999 /var/lib/rabbitmq/.rabbitmqadmin.conf \u0026\u0026 chmod 600 /var/lib/rabbitmq/.rabbitmqadmin.conf"],"resources":{"limits":{"cpu":"100m","memory":"500Mi"},"requests":{"cpu":"100m","memory":"500Mi"}},"volumeMounts":[{"name":"plugins-conf","mountPath":"/tmp/rabbitmq-plugins/"},{"name":"rabbitmq-erlang-cookie","mountPath":"/var/lib/rabbitmq/"},{"name":"erlang-cookie-secret","mountPath":"/tmp/erlang-cookie-secret/"},{"name":"rabbitmq-plugins","mountPath":"/operator"},{"name":"persistence","mountPath":"/var/lib/rabbitmq/mnesia/"},{"name":"rabbitmq-confd","mountPath":"/tmp/default_user.conf","subPath":"default_user.conf"}],"terminationMessagePath":"/dev/termination-log","terminationMessagePolicy":"File","imagePullPolicy":"IfNotPresent","securityContext":{"capabilities":{"drop":["FSETID","KILL","SETGID","SETUID","SETPCAP","NET_BIND_SERVICE","NET_RAW","SYS_CHROOT","MKNOD","AUDIT_WRITE","SETFCAP"]},"runAsUser":0}}],"containers":[{"name":"rabbitmq","image":"rabbitmq:3.8.12-management","ports":[{"name":"epmd","containerPort":4369,"protocol":"TCP"},{"name":"amqp","containerPort":5672,"protocol":"TCP"},{"name":"management","containerPort":15672,"protocol":"TCP"},{"name":"prometheus","containerPort":15692,"protocol":"TCP"}],"env":[{"name":"MY_POD_NAME","valueFrom":{"fieldRef":{"apiVersion":"v1","fieldPath":"metadata.name"}}},{"name":"MY_POD_NAMESPACE","valueFrom":{"fieldRef":{"apiVersion":"v1","fieldPath":"metadata.namespace"}}},{"name":"RABBITMQ_ENABLED_PLUGINS_FILE","value":"/operator/enabled_plugins"},{"name":"K8S_SERVICE_NAME","value":"rabbitmq-cluster-nodes"},{"name":"RABBITMQ_USE_LONGNAME","value":"true"},{"name":"RABBITMQ_NODENAME","value":"rabbit@$(MY_POD_NAME).$(K8S_SERVICE_NAME).$(MY_POD_NAMESPACE)"},{"name":"K8S_HOSTNAME_SUFFIX","value":".$(K8S_SERVICE_NAME).$(MY_POD_NAMESPACE)"}],"resources":{"limits":{"cpu":"2","memory":"2Gi"},"requests":{"cpu":"1","memory":"2Gi"}},"volumeMounts":[{"name":"rabbitmq-erlang-cookie","mountPath":"/var/lib/rabbitmq/"},{"name":"persistence","mountPath":"/var/lib/rabbitmq/mnesia/"},{"name":"rabbitmq-plugins","mountPath":"/operator"},{"name":"rabbitmq-confd","mountPath":"/etc/rabbitmq/conf.d/10-operatorDefaults.conf","subPath":"operatorDefaults.conf"},{"name":"rabbitmq-confd","mountPath":"/etc/rabbitmq/conf.d/11-default_user.conf","subPath":"default_user.conf"},{"name":"rabbitmq-confd","mountPath":"/etc/rabbitmq/conf.d/90-userDefinedConfiguration.conf","subPath":"userDefinedConfiguration.conf"},{"name":"pod-info","mountPath":"/etc/pod-info/"}],"readinessProbe":{"tcpSocket":{"port":"amqp"},"initialDelaySeconds":10,"timeoutSeconds":5,"periodSeconds":10,"successThreshold":1,"failureThreshold":3},"lifecycle":{"preStop":{"exec":{"command":["/bin/bash","-c","if [ ! -z \"$(cat /etc/pod-info/skipPreStopChecks)\" ]; then exit 0; fi; rabbitmq-upgrade await_online_quorum_plus_one -t 604800; rabbitmq-upgrade await_online_synchronized_mirror -t 604800; rabbitmq-upgrade drain -t 604800"]}}},"terminationMessagePath":"/dev/termination-log","terminationMessagePolicy":"File","imagePullPolicy":"IfNotPresent"}],"restartPolicy":"Always","terminationGracePeriodSeconds":604800,"dnsPolicy":"ClusterFirst","serviceAccountName":"rabbitmq-cluster-server","serviceAccount":"rabbitmq-cluster-server","automountServiceAccountToken":true,"securityContext":{"runAsUser":999,"runAsGroup":999,"fsGroup":999},"schedulerName":"default-scheduler","topologySpreadConstraints":[{"maxSkew":1,"topologyKey":"topology.kubernetes.io/zone","whenUnsatisfiable":"ScheduleAnyway","labelSelector":{"matchLabels":{"app.kubernetes.io/name":"rabbitmq-cluster"}}}]}},"volumeClaimTemplates":[{"metadata":{"name":"persistence","namespace":"default","creationTimestamp":null,"labels":{"app.kubernetes.io/component":"rabbitmq","app.kubernetes.io/name":"rabbitmq-cluster","app.kubernetes.io/part-of":"rabbitmq"},"ownerReferences":[{"apiVersion":"rabbitmq.com/v1beta1","kind":"RabbitmqCluster","name":"rabbitmq-cluster","uid":"18d9928b-0d1c-47be-80ec-20960d053827","controller":true,"blockOwnerDeletion":false}]},"spec":{"accessModes":["ReadWriteOnce"],"resources":{"requests":{"storage":"10Gi"}},"volumeMode":"Filesystem"},"status":{"phase":"Pending"}}],"serviceName":"rabbitmq-cluster-nodes","podManagementPolicy":"Parallel","updateStrategy":{"type":"RollingUpdate","rollingUpdate":{"partition":0}},"revisionHistoryLimit":10},"status":{"observedGeneration":2,"replicas":3,"readyReplicas":1,"currentReplicas":3,"updatedReplicas":3,"currentRevision":"rabbitmq-cluster-server-5f8b8665fb","updateRevision":"rabbitmq-cluster-server-5f8b8665fb","collisionCount":0}}
2022/03/18 18:01:38 learn_server.go:253: [SIEVE-AFTER-RECONCILE]	github.com/rabbitmq/cluster-operator/controllers.(*RabbitmqClusterReconciler)	12
2022/03/18 18:01:53 learn_server.go:238: [SIEVE-BEFORE-RECONCILE]	github.com/rabbitmq/cluster-operator/controllers.(*RabbitmqClusterReconciler)	13
2022/03/18 18:01:53 learn_server.go:291: [SIEVE-AFTER-READ]	Get	true	rabbitmqcluster	default	rabbitmq-cluster	github.com/rabbitmq/cluster-operator/controllers.(*RabbitmqClusterReconciler)	NoError	{"kind":"RabbitmqCluster","apiVersion":"rabbitmq.com/v1beta1","metadata":{"name":"rabbitmq-cluster","namespace":"default","selfLink":"/apis/rabbitmq.com/v1beta1/namespaces/default/rabbitmqclusters/rabbitmq-cluster","uid":"18d9928b-0d1c-47be-80ec-20960d053827","resourceVersion":"977","generation":3,"creationTimestamp":"2022-03-18T18:00:38Z","annotations":{"kubectl.kubernetes.io/last-applied-configuration":"{\"apiVersion\":\"rabbitmq.com/v1beta1\",\"kind\":\"RabbitmqCluster\",\"metadata\":{\"annotations\":{},\"name\":\"rabbitmq-cluster\",\"namespace\":\"default\"},\"spec\":{\"persistence\":{\"storage\":\"10Gi\"},\"replicas\":1}}\n"},"finalizers":["deletion.finalizers.rabbitmqclusters.rabbitmq.com"],"managedFields":[{"manager":"kubectl-client-side-apply","operation":"Update","apiVersion":"rabbitmq.com/v1beta1","time":"2022-03-18T18:00:38Z","fieldsType":"FieldsV1","fieldsV1":{"f:metadata":{"f:annotations":{".":{},"f:kubectl.kubernetes.io/last-applied-configuration":{}}},"f:spec":{".":{},"f:image":{},"f:persistence":{".":{},"f:storage":{}},"f:resources":{".":{},"f:limits":{".":{},"f:memory":{}},"f:requests":{".":{},"f:memory":{}}},"f:service":{".":{},"f:type":{}},"f:terminationGracePeriodSeconds":{}}}},{"manager":"kubectl-patch","operation":"Update","apiVersion":"rabbitmq.com/v1beta1","time":"2022-03-18T18:01:23Z","fieldsType":"FieldsV1","fieldsV1":{"f:spec":{"f:replicas":{}}}},{"manager":"manager","operation":"Update","apiVersion":"rabbitmq.com/v1beta1","time":"2022-03-18T18:01:23Z","fieldsType":"FieldsV1","fieldsV1":{"f:metadata":{"f:finalizers":{}},"f:spec":{"f:override":{},"f:rabbitmq":{},"f:resources":{"f:limits":{"f:cpu":{}},"f:requests":{"f:cpu":{}}},"f:tls":{}},"f:status":{".":{},"f:conditions":{},"f:defaultUser":{".":{},"f:secretReference":{".":{},"f:keys":{".":{},"f:password":{},"f:username":{}},"f:name":{},"f:namespace":{}},"f:serviceReference":{".":{},"f:name":{},"f:namespace":{}}}}}}]},"spec":{"replicas":3,"image":"rabbitmq:3.8.12-management","service":{"type":"ClusterIP"},"persistence":{"storage":"10Gi"},"resources":{"limits":{"cpu":"2","memory":"2Gi"},"requests":{"cpu":"1","memory":"2Gi"}},"rabbitmq":{},"tls":{},"override":{},"terminationGracePeriodSeconds":604800},"status":{"conditions":[{"type":"AllReplicasReady","status":"False","lastTransitionTime":"2022-03-18T18:01:23Z","reason":"NotAllPodsReady","message":"1/3 Pods ready"},{"type":"ClusterAvailable","status":"True","lastTransitionTime":"2022-03-18T18:01:17Z","reason":"AtLeastOneEndpointAvailable"},{"type":"NoWarnings","status":"True","lastTransitionTime":"2022-03-18T18:00:38Z","reason":"NoWarnings"},{"type":"ReconcileSuccess","status":"True","lastTransitionTime":"2022-03-18T18:01:18Z","reason":"Success","message":"Finish reconciling"}],"defaultUser":{"secretReference":{"name":"rabbitmq-cluster-default-user","namespace":"default","keys":{"password":"password","username":"username"}},"serviceReference":{"name":"rabbitmq-cluster","namespace":"default"}}}}
2022/03/18 18:01:53 learn_server.go:291: [SIEVE-AFTER-READ]	Get	true	statefulset	default	rabbitmq-cluster-server	github.com/rabbitmq/cluster-operator/controllers.(*RabbitmqClusterReconciler)	NoError	{"kind":"StatefulSet","apiVersion":"apps/v1","metadata":{"name":"rabbitmq-cluster-server","namespace":"default","selfLink":"/apis/apps/v1/namespaces/default/statefulsets/rabbitmq-cluster-server","uid":"cb5c43bc-6ee7-481c-ab01-6f3acffdd3c8","resourceVersion":"989","generation":2,"creationTimestamp":"2022-03-18T18:00:38Z","labels":{"app.kubernetes.io/component":"rabbitmq","app.kubernetes.io/name":"rabbitmq-cluster","app.kubernetes.io/part-of":"rabbitmq"},"ownerReferences":[{"apiVersion":"rabbitmq.com/v1beta1","kind":"RabbitmqCluster","name":"rabbitmq-cluster","uid":"18d9928b-0d1c-47be-80ec-20960d053827","controller":true,"blockOwnerDeletion":true}],"managedFields":[{"manager":"kube-controller-manager","operation":"Update","apiVersion":"apps/v1","time":"2022-03-18T18:01:23Z","fieldsType":"FieldsV1","fieldsV1":{"f:status":{"f:collisionCount":{},"f:currentReplicas":{},"f:currentRevision":{},"f:observedGeneration":{},"f:readyReplicas":{},"f:replicas":{},"f:updateRevision":{},"f:updatedReplicas":{}}}},{"manager":"manager","operation":"Update","apiVersion":"apps/v1","time":"2022-03-18T18:01:23Z","fieldsType":"FieldsV1","fieldsV1":{"f:metadata":{"f:labels":{".":{},"f:app.kubernetes.io/component":{},"f:app.kubernetes.io/name":{},"f:app.kubernetes.io/part-of":{}},"f:ownerReferences":{".":{},"k:{\"uid\":\"18d9928b-0d1c-47be-80ec-20960d053827\"}":{".":{},"f:apiVersion":{},"f:blockOwnerDeletion":{},"f:controller":{},"f:kind":{},"f:name":{},"f:uid":{}}}},"f:spec":{"f:podManagementPolicy":{},"f:replicas":{},"f:revisionHistoryLimit":{},"f:selector":{"f:matchLabels":{".":{},"f:app.kubernetes.io/name":{}}},"f:serviceName":{},"f:template":{"f:metadata":{"f:annotations":{".":{},"f:prometheus.io/port":{},"f:prometheus.io/scrape":{}},"f:labels":{".":{},"f:app.kubernetes.io/component":{},"f:app.kubernetes.io/name":{},"f:app.kubernetes.io/part-of":{}}},"f:spec":{"f:automountServiceAccountToken":{},"f:containers":{"k:{\"name\":\"rabbitmq\"}":{".":{},"f:env":{".":{},"k:{\"name\":\"K8S_HOSTNAME_SUFFIX\"}":{".":{},"f:name":{},"f:value":{}},"k:{\"name\":\"K8S_SERVICE_NAME\"}":{".":{},"f:name":{},"f:value":{}},"k:{\"name\":\"MY_POD_NAME\"}":{".":{},"f:name":{},"f:valueFrom":{".":{},"f:fieldRef":{".":{},"f:apiVersion":{},"f:fieldPath":{}}}},"k:{\"name\":\"MY_POD_NAMESPACE\"}":{".":{},"f:name":{},"f:valueFrom":{".":{},"f:fieldRef":{".":{},"f:apiVersion":{},"f:fieldPath":{}}}},"k:{\"name\":\"RABBITMQ_ENABLED_PLUGINS_FILE\"}":{".":{},"f:name":{},"f:value":{}},"k:{\"name\":\"RABBITMQ_NODENAME\"}":{".":{},"f:name":{},"f:value":{}},"k:{\"name\":\"RABBITMQ_USE_LONGNAME\"}":{".":{},"f:name":{},"f:value":{}}},"f:image":{},"f:imagePullPolicy":{},"f:lifecycle":{".":{},"f:preStop":{".":{},"f:exec":{".":{},"f:command":{}}}},"f:name":{},"f:ports":{".":{},"k:{\"containerPort\":4369,\"protocol\":\"TCP\"}":{".":{},"f:containerPort":{},"f:name":{},"f:protocol":{}},"k:{\"containerPort\":5672,\"protocol\":\"TCP\"}":{".":{},"f:containerPort":{},"f:name":{},"f:protocol":{}},"k:{\"containerPort\":15672,\"protocol\":\"TCP\"}":{".":{},"f:containerPort":{},"f:name":{},"f:protocol":{}},"k:{\"containerPort\":15692,\"protocol\":\"TCP\"}":{".":{},"f:containerPort":{},"f:name":{},"f:protocol":{}}},"f:readinessProbe":{".":{},"f:failureThreshold":{},"f:initialDelaySeconds":{},"f:periodSeconds":{},"f:successThreshold":{},"f:tcpSocket":{".":{},"f:port":{}},"f:timeoutSeconds":{}},"f:resources":{".":{},"f:limits":{".":{},"f:cpu":{},"f:memory":{}},"f:requests":{".":{},"f:cpu":{},"f:memory":{}}},"f:terminationMessagePath":{},"f:terminationMessagePolicy":{},"f:volumeMounts":{".":{},"k:{\"mountPath\":\"/etc/pod-info/\"}":{".":{},"f:mountPath":{},"f:name":{}},"k:{\"mountPath\":\"/etc/rabbitmq/conf.d/10-operatorDefaults.conf\"}":{".":{},"f:mountPath":{},"f:name":{},"f:subPath":{}},"k:{\"mountPath\":\"/etc/rabbitmq/conf.d/11-default_user.conf\"}":{".":{},"f:mountPath":{},"f:name":{},"f:subPath":{}},"k:{\"mountPath\":\"/etc/rabbitmq/conf.d/90-userDefinedConfiguration.conf\"}":{".":{},"f:mountPath":{},"f:name":{},"f:subPath":{}},"k:{\"mountPath\":\"/operator\"}":{".":{},"f:mountPath":{},"f:name":{}},"k:{\"mountPath\":\"/var/lib/rabbitmq/\"}":{".":{},"f:mountPath":{},"f:name":{}},"k:{\"mountPath\":\"/var/lib/rabbitmq/mnesia/\"}":{".":{},"f:mountPath":{},"f:name":{}}}}},"f:dnsPolicy":{},"f:initContainers":{".":{},"k:{\"name\":\"setup-container\"}":{".":{},"f:command":{},"f:image":{},"f:imagePullPolicy":{},"f:name":{},"f:resources":{".":{},"f:limits":{".":{},"f:cpu":{},"f:memory":{}},"f:requests":{".":{},"f:cpu":{},"f:memory":{}}},"f:securityContext":{".":{},"f:capabilities":{".":{},"f:drop":{}},"f:runAsUser":{}},"f:terminationMessagePath":{},"f:terminationMessagePolicy":{},"f:volumeMounts":{".":{},"k:{\"mountPath\":\"/operator\"}":{".":{},"f:mountPath":{},"f:name":{}},"k:{\"mountPath\":\"/tmp/default_user.conf\"}":{".":{},"f:mountPath":{},"f:name":{},"f:subPath":{}},"k:{\"mountPath\":\"/tmp/erlang-cookie-secret/\"}":{".":{},"f:mountPath":{},"f:name":{}},"k:{\"mountPath\":\"/tmp/rabbitmq-plugins/\"}":{".":{},"f:mountPath":{},"f:name":{}},"k:{\"mountPath\":\"/var/lib/rabbitmq/\"}":{".":{},"f:mountPath":{},"f:name":{}},"k:{\"mountPath\":\"/var/lib/rabbitmq/mnesia/\"}":{".":{},"f:mountPath":{},"f:name":{}}}}},"f:restartPolicy":{},"f:schedulerName":{},"f:securityContext":{".":{},"f:fsGroup":{},"f:runAsGroup":{},"f:runAsUser":{}},"f:serviceAccount":{},"f:serviceAccountName":{},"f:terminationGracePeriodSeconds":{},"f:topologySpreadConstraints":{".":{},"k:{\"topologyKey\":\"topology.kubernetes.io/zone\",\"whenUnsatisfiable\":\"ScheduleAnyway\"}":{".":{},"f:labelSelector":{".":{},"f:matchLabels":{".":{},"f:app.kubernetes.io/name":{}}},"f:maxSkew":{},"f:topologyKey":{},"f:whenUnsatisfiable":{}}},"f:volumes":{".":{},"k:{\"name\":\"erlang-cookie-secret\"}":{".":{},"f:name":{},"f:secret":{".":{},"f:defaultMode":{},"f:secretName":{}}},"k:{\"name\":\"plugins-conf\"}":{".":{},"f:configMap":{".":{},"f:defaultMode":{},"f:name":{}},"f:name":{}},"k:{\"name\":\"pod-info\"}":{".":{},"f:downwardAPI":{".":{},"f:defaultMode":{},"f:items":{}},"f:name":{}},"k:{\"name\":\"rabbitmq-confd\"}":{".":{},"f:name":{},"f:projected":{".":{},"f:defaultMode":{},"f:sources":{}}},"k:{\"name\":\"rabbitmq-erlang-cookie\"}":{".":{},"f:emptyDir":{},"f:name":{}},"k:{\"name\":\"rabbitmq-plugins\"}":{".":{},"f:emptyDir":{},"f:name":{}}}}},"f:updateStrategy":{"f:rollingUpdate":{".":{},"f:partition":{}},"f:type":{}},"f:volumeClaimTemplates":{}}}}]},"spec":{"replicas":3,"selector":{"matchLabels":{"app.kubernetes.io/name":"rabbitmq-cluster"}},"template":{"metadata":{"creationTimestamp":null,"labels":{"app.kubernetes.io/component":"rabbitmq","app.kubernetes.io/name":"rabbitmq-cluster","app.kubernetes.io/part-of":"rabbitmq"},"annotations":{"prometheus.io/port":"15692","prometheus.io/scrape":"true"}},"spec":{"volumes":[{"name":"plugins-conf","configMap":{"name":"rabbitmq-cluster-plugins-conf","defaultMode":420}},{"name":"rabbitmq-confd","projected":{"sources":[{"secret":{"name":"rabbitmq-cluster-default-user","items":[{"key":"default_user.conf","path":"default_user.conf"}]}},{"configMap":{"name":"rabbitmq-cluster-server-conf","items":[{"key":"operatorDefaults.conf","path":"operatorDefaults.conf"},{"key":"userDefinedConfiguration.conf","path":"userDefinedConfiguration.conf"}]}}],"defaultMode":420}},{"name":"rabbitmq-erlang-cookie","emptyDir":{}},{"name":"erlang-cookie-secret","secret":{"secretName":"rabbitmq-cluster-erlang-cookie","defaultMode":420}},{"name":"rabbitmq-plugins","emptyDir":{}},{"name":"pod-info","downwardAPI":{"items":[{"path":"skipPreStopChecks","fieldRef":{"apiVersion":"v1","fieldPath":"metadata.labels['skipPreStopChecks']"}}],"defaultMode":420}}],"initContainers":[{"name":"setup-container","image":"rabbitmq:3.8.12-management","command":["sh","-c","cp /tmp/erlang-cookie-secret/.erlang.cookie /var/lib/rabbitmq/.erlang.cookie \u0026\u0026 chown 999:999 /var/lib/rabbitmq/.erlang.cookie \u0026\u0026 chmod 600 /var/lib/rabbitmq/.erlang.cookie ; cp /tmp/rabbitmq-plugins/enabled_plugins /operator/enabled_plugins \u0026\u0026 chown 999:999 /operator/enabled_plugins ; chown 999:999 /var/lib/rabbitmq/mnesia/ ; echo '[default]' \u003e /var/lib/rabbitmq/.rabbitmqadmin.conf \u0026\u0026 sed -e 's/default_user/username/' -e 's/default_pass/password/' /tmp/default_user.conf \u003e\u003e /var/lib/rabbitmq/.rabbitmqadmin.conf \u0026\u0026 chown 999:999 /var/lib/rabbitmq/.rabbitmqadmin.conf \u0026\u0026 chmod 600 /var/lib/rabbitmq/.rabbitmqadmin.conf"],"resources":{"limits":{"cpu":"100m","memory":"500Mi"},"requests":{"cpu":"100m","memory":"500Mi"}},"volumeMounts":[{"name":"plugins-conf","mountPath":"/tmp/rabbitmq-plugins/"},{"name":"rabbitmq-erlang-cookie","mountPath":"/var/lib/rabbitmq/"},{"name":"erlang-cookie-secret","mountPath":"/tmp/erlang-cookie-secret/"},{"name":"rabbitmq-plugins","mountPath":"/operator"},{"name":"persistence","mountPath":"/var/lib/rabbitmq/mnesia/"},{"name":"rabbitmq-confd","mountPath":"/tmp/default_user.conf","subPath":"default_user.conf"}],"terminationMessagePath":"/dev/termination-log","terminationMessagePolicy":"File","imagePullPolicy":"IfNotPresent","securityContext":{"capabilities":{"drop":["FSETID","KILL","SETGID","SETUID","SETPCAP","NET_BIND_SERVICE","NET_RAW","SYS_CHROOT","MKNOD","AUDIT_WRITE","SETFCAP"]},"runAsUser":0}}],"containers":[{"name":"rabbitmq","image":"rabbitmq:3.8.12-management","ports":[{"name":"epmd","containerPort":4369,"protocol":"TCP"},{"name":"amqp","containerPort":5672,"protocol":"TCP"},{"name":"management","containerPort":15672,"protocol":"TCP"},{"name":"prometheus","containerPort":15692,"protocol":"TCP"}],"env":[{"name":"MY_POD_NAME","valueFrom":{"fieldRef":{"apiVersion":"v1","fieldPath":"metadata.name"}}},{"name":"MY_POD_NAMESPACE","valueFrom":{"fieldRef":{"apiVersion":"v1","fieldPath":"metadata.namespace"}}},{"name":"RABBITMQ_ENABLED_PLUGINS_FILE","value":"/operator/enabled_plugins"},{"name":"K8S_SERVICE_NAME","value":"rabbitmq-cluster-nodes"},{"name":"RABBITMQ_USE_LONGNAME","value":"true"},{"name":"RABBITMQ_NODENAME","value":"rabbit@$(MY_POD_NAME).$(K8S_SERVICE_NAME).$(MY_POD_NAMESPACE)"},{"name":"K8S_HOSTNAME_SUFFIX","value":".$(K8S_SERVICE_NAME).$(MY_POD_NAMESPACE)"}],"resources":{"limits":{"cpu":"2","memory":"2Gi"},"requests":{"cpu":"1","memory":"2Gi"}},"volumeMounts":[{"name":"rabbitmq-erlang-cookie","mountPath":"/var/lib/rabbitmq/"},{"name":"persistence","mountPath":"/var/lib/rabbitmq/mnesia/"},{"name":"rabbitmq-plugins","mountPath":"/operator"},{"name":"rabbitmq-confd","mountPath":"/etc/rabbitmq/conf.d/10-operatorDefaults.conf","subPath":"operatorDefaults.conf"},{"name":"rabbitmq-confd","mountPath":"/etc/rabbitmq/conf.d/11-default_user.conf","subPath":"default_user.conf"},{"name":"rabbitmq-confd","mountPath":"/etc/rabbitmq/conf.d/90-userDefinedConfiguration.conf","subPath":"userDefinedConfiguration.conf"},{"name":"pod-info","mountPath":"/etc/pod-info/"}],"readinessProbe":{"tcpSocket":{"port":"amqp"},"initialDelaySeconds":10,"timeoutSeconds":5,"periodSeconds":10,"successThreshold":1,"failureThreshold":3},"lifecycle":{"preStop":{"exec":{"command":["/bin/bash","-c","if [ ! -z \"$(cat /etc/pod-info/skipPreStopChecks)\" ]; then exit 0; fi; rabbitmq-upgrade await_online_quorum_plus_one -t 604800; rabbitmq-upgrade await_online_synchronized_mirror -t 604800; rabbitmq-upgrade drain -t 604800"]}}},"terminationMessagePath":"/dev/termination-log","terminationMessagePolicy":"File","imagePullPolicy":"IfNotPresent"}],"restartPolicy":"Always","terminationGracePeriodSeconds":604800,"dnsPolicy":"ClusterFirst","serviceAccountName":"rabbitmq-cluster-server","serviceAccount":"rabbitmq-cluster-server","automountServiceAccountToken":true,"securityContext":{"runAsUser":999,"runAsGroup":999,"fsGroup":999},"schedulerName":"default-scheduler","topologySpreadConstraints":[{"maxSkew":1,"topologyKey":"topology.kubernetes.io/zone","whenUnsatisfiable":"ScheduleAnyway","labelSelector":{"matchLabels":{"app.kubernetes.io/name":"rabbitmq-cluster"}}}]}},"volumeClaimTemplates":[{"metadata":{"name":"persistence","namespace":"default","creationTimestamp":null,"labels":{"app.kubernetes.io/component":"rabbitmq","app.kubernetes.io/name":"rabbitmq-cluster","app.kubernetes.io/part-of":"rabbitmq"},"ownerReferences":[{"apiVersion":"rabbitmq.com/v1beta1","kind":"RabbitmqCluster","name":"rabbitmq-cluster","uid":"18d9928b-0d1c-47be-80ec-20960d053827","controller":true,"blockOwnerDeletion":false}]},"spec":{"accessModes":["ReadWriteOnce"],"resources":{"requests":{"storage":"10Gi"}},"volumeMode":"Filesystem"},"status":{"phase":"Pending"}}],"serviceName":"rabbitmq-cluster-nodes","podManagementPolicy":"Parallel","updateStrategy":{"type":"RollingUpdate","rollingUpdate":{"partition":0}},"revisionHistoryLimit":10},"status":{"observedGeneration":2,"replicas":3,"readyReplicas":1,"currentReplicas":3,"updatedReplicas":3,"currentRevision":"rabbitmq-cluster-server-5f8b8665fb","updateRevision":"rabbitmq-cluster-server-5f8b8665fb","collisionCount":0}}
2022/03/18 18:01:53 learn_server.go:291: [SIEVE-AFTER-READ]	Get	true	endpoints	default	rabbitmq-cluster	github.com/rabbitmq/cluster-operator/controllers.(*RabbitmqClusterReconciler)	NoError	{"kind":"Endpoints","apiVersion":"v1","metadata":{"name":"rabbitmq-cluster","namespace":"default","selfLink":"/api/v1/namespaces/default/endpoints/rabbitmq-cluster","uid":"5c4723ad-f4fe-442d-9135-44879a2a8183","resourceVersion":"1088","creationTimestamp":"2022-03-18T18:00:38Z","labels":{"app.kubernetes.io/component":"rabbitmq","app.kubernetes.io/name":"rabbitmq-cluster","app.kubernetes.io/part-of":"rabbitmq"},"managedFields":[{"manager":"kube-controller-manager","operation":"Update","apiVersion":"v1","time":"2022-03-18T18:01:33Z","fieldsType":"FieldsV1","fieldsV1":{"f:metadata":{"f:labels":{".":{},"f:app.kubernetes.io/component":{},"f:app.kubernetes.io/name":{},"f:app.kubernetes.io/part-of":{}}},"f:subsets":{}}}]},"subsets":[{"addresses":[{"ip":"10.244.1.4","nodeName":"kind-worker2","targetRef":{"kind":"Pod","namespace":"default","name":"rabbitmq-cluster-server-0","uid":"e7faffc5-b656-4e69-9777-92d12cb6ec5a","resourceVersion":"938"}}],"notReadyAddresses":[{"ip":"10.244.2.4","nodeName":"kind-worker","targetRef":{"kind":"Pod","namespace":"default","name":"rabbitmq-cluster-server-1","uid":"7a37da00-25d1-48b6-a659-4390fb7a02cb","resourceVersion":"1086"}},{"ip":"10.244.2.5","nodeName":"kind-worker","targetRef":{"kind":"Pod","namespace":"default","name":"rabbitmq-cluster-server-2","uid":"2a54a659-a979-4e10-8e74-1e0b83d532ba","resourceVersion":"1081"}}],"ports":[{"name":"amqp","port":5672,"protocol":"TCP"},{"name":"management","port":15672,"protocol":"TCP"}]}]}
2022/03/18 18:01:53 learn_server.go:291: [SIEVE-AFTER-READ]	Get	true	statefulset	default	rabbitmq-cluster-server	github.com/rabbitmq/cluster-operator/controllers.(*RabbitmqClusterReconciler)	NoError	{"kind":"StatefulSet","apiVersion":"apps/v1","metadata":{"name":"rabbitmq-cluster-server","namespace":"default","selfLink":"/apis/apps/v1/namespaces/default/statefulsets/rabbitmq-cluster-server","uid":"cb5c43bc-6ee7-481c-ab01-6f3acffdd3c8","resourceVersion":"989","generation":2,"creationTimestamp":"2022-03-18T18:00:38Z","labels":{"app.kubernetes.io/component":"rabbitmq","app.kubernetes.io/name":"rabbitmq-cluster","app.kubernetes.io/part-of":"rabbitmq"},"ownerReferences":[{"apiVersion":"rabbitmq.com/v1beta1","kind":"RabbitmqCluster","name":"rabbitmq-cluster","uid":"18d9928b-0d1c-47be-80ec-20960d053827","controller":true,"blockOwnerDeletion":true}],"managedFields":[{"manager":"kube-controller-manager","operation":"Update","apiVersion":"apps/v1","time":"2022-03-18T18:01:23Z","fieldsType":"FieldsV1","fieldsV1":{"f:status":{"f:collisionCount":{},"f:currentReplicas":{},"f:currentRevision":{},"f:observedGeneration":{},"f:readyReplicas":{},"f:replicas":{},"f:updateRevision":{},"f:updatedReplicas":{}}}},{"manager":"manager","operation":"Update","apiVersion":"apps/v1","time":"2022-03-18T18:01:23Z","fieldsType":"FieldsV1","fieldsV1":{"f:metadata":{"f:labels":{".":{},"f:app.kubernetes.io/component":{},"f:app.kubernetes.io/name":{},"f:app.kubernetes.io/part-of":{}},"f:ownerReferences":{".":{},"k:{\"uid\":\"18d9928b-0d1c-47be-80ec-20960d053827\"}":{".":{},"f:apiVersion":{},"f:blockOwnerDeletion":{},"f:controller":{},"f:kind":{},"f:name":{},"f:uid":{}}}},"f:spec":{"f:podManagementPolicy":{},"f:replicas":{},"f:revisionHistoryLimit":{},"f:selector":{"f:matchLabels":{".":{},"f:app.kubernetes.io/name":{}}},"f:serviceName":{},"f:template":{"f:metadata":{"f:annotations":{".":{},"f:prometheus.io/port":{},"f:prometheus.io/scrape":{}},"f:labels":{".":{},"f:app.kubernetes.io/component":{},"f:app.kubernetes.io/name":{},"f:app.kubernetes.io/part-of":{}}},"f:spec":{"f:automountServiceAccountToken":{},"f:containers":{"k:{\"name\":\"rabbitmq\"}":{".":{},"f:env":{".":{},"k:{\"name\":\"K8S_HOSTNAME_SUFFIX\"}":{".":{},"f:name":{},"f:value":{}},"k:{\"name\":\"K8S_SERVICE_NAME\"}":{".":{},"f:name":{},"f:value":{}},"k:{\"name\":\"MY_POD_NAME\"}":{".":{},"f:name":{},"f:valueFrom":{".":{},"f:fieldRef":{".":{},"f:apiVersion":{},"f:fieldPath":{}}}},"k:{\"name\":\"MY_POD_NAMESPACE\"}":{".":{},"f:name":{},"f:valueFrom":{".":{},"f:fieldRef":{".":{},"f:apiVersion":{},"f:fieldPath":{}}}},"k:{\"name\":\"RABBITMQ_ENABLED_PLUGINS_FILE\"}":{".":{},"f:name":{},"f:value":{}},"k:{\"name\":\"RABBITMQ_NODENAME\"}":{".":{},"f:name":{},"f:value":{}},"k:{\"name\":\"RABBITMQ_USE_LONGNAME\"}":{".":{},"f:name":{},"f:value":{}}},"f:image":{},"f:imagePullPolicy":{},"f:lifecycle":{".":{},"f:preStop":{".":{},"f:exec":{".":{},"f:command":{}}}},"f:name":{},"f:ports":{".":{},"k:{\"containerPort\":4369,\"protocol\":\"TCP\"}":{".":{},"f:containerPort":{},"f:name":{},"f:protocol":{}},"k:{\"containerPort\":5672,\"protocol\":\"TCP\"}":{".":{},"f:containerPort":{},"f:name":{},"f:protocol":{}},"k:{\"containerPort\":15672,\"protocol\":\"TCP\"}":{".":{},"f:containerPort":{},"f:name":{},"f:protocol":{}},"k:{\"containerPort\":15692,\"protocol\":\"TCP\"}":{".":{},"f:containerPort":{},"f:name":{},"f:protocol":{}}},"f:readinessProbe":{".":{},"f:failureThreshold":{},"f:initialDelaySeconds":{},"f:periodSeconds":{},"f:successThreshold":{},"f:tcpSocket":{".":{},"f:port":{}},"f:timeoutSeconds":{}},"f:resources":{".":{},"f:limits":{".":{},"f:cpu":{},"f:memory":{}},"f:requests":{".":{},"f:cpu":{},"f:memory":{}}},"f:terminationMessagePath":{},"f:terminationMessagePolicy":{},"f:volumeMounts":{".":{},"k:{\"mountPath\":\"/etc/pod-info/\"}":{".":{},"f:mountPath":{},"f:name":{}},"k:{\"mountPath\":\"/etc/rabbitmq/conf.d/10-operatorDefaults.conf\"}":{".":{},"f:mountPath":{},"f:name":{},"f:subPath":{}},"k:{\"mountPath\":\"/etc/rabbitmq/conf.d/11-default_user.conf\"}":{".":{},"f:mountPath":{},"f:name":{},"f:subPath":{}},"k:{\"mountPath\":\"/etc/rabbitmq/conf.d/90-userDefinedConfiguration.conf\"}":{".":{},"f:mountPath":{},"f:name":{},"f:subPath":{}},"k:{\"mountPath\":\"/operator\"}":{".":{},"f:mountPath":{},"f:name":{}},"k:{\"mountPath\":\"/var/lib/rabbitmq/\"}":{".":{},"f:mountPath":{},"f:name":{}},"k:{\"mountPath\":\"/var/lib/rabbitmq/mnesia/\"}":{".":{},"f:mountPath":{},"f:name":{}}}}},"f:dnsPolicy":{},"f:initContainers":{".":{},"k:{\"name\":\"setup-container\"}":{".":{},"f:command":{},"f:image":{},"f:imagePullPolicy":{},"f:name":{},"f:resources":{".":{},"f:limits":{".":{},"f:cpu":{},"f:memory":{}},"f:requests":{".":{},"f:cpu":{},"f:memory":{}}},"f:securityContext":{".":{},"f:capabilities":{".":{},"f:drop":{}},"f:runAsUser":{}},"f:terminationMessagePath":{},"f:terminationMessagePolicy":{},"f:volumeMounts":{".":{},"k:{\"mountPath\":\"/operator\"}":{".":{},"f:mountPath":{},"f:name":{}},"k:{\"mountPath\":\"/tmp/default_user.conf\"}":{".":{},"f:mountPath":{},"f:name":{},"f:subPath":{}},"k:{\"mountPath\":\"/tmp/erlang-cookie-secret/\"}":{".":{},"f:mountPath":{},"f:name":{}},"k:{\"mountPath\":\"/tmp/rabbitmq-plugins/\"}":{".":{},"f:mountPath":{},"f:name":{}},"k:{\"mountPath\":\"/var/lib/rabbitmq/\"}":{".":{},"f:mountPath":{},"f:name":{}},"k:{\"mountPath\":\"/var/lib/rabbitmq/mnesia/\"}":{".":{},"f:mountPath":{},"f:name":{}}}}},"f:restartPolicy":{},"f:schedulerName":{},"f:securityContext":{".":{},"f:fsGroup":{},"f:runAsGroup":{},"f:runAsUser":{}},"f:serviceAccount":{},"f:serviceAccountName":{},"f:terminationGracePeriodSeconds":{},"f:topologySpreadConstraints":{".":{},"k:{\"topologyKey\":\"topology.kubernetes.io/zone\",\"whenUnsatisfiable\":\"ScheduleAnyway\"}":{".":{},"f:labelSelector":{".":{},"f:matchLabels":{".":{},"f:app.kubernetes.io/name":{}}},"f:maxSkew":{},"f:topologyKey":{},"f:whenUnsatisfiable":{}}},"f:volumes":{".":{},"k:{\"name\":\"erlang-cookie-secret\"}":{".":{},"f:name":{},"f:secret":{".":{},"f:defaultMode":{},"f:secretName":{}}},"k:{\"name\":\"plugins-conf\"}":{".":{},"f:configMap":{".":{},"f:defaultMode":{},"f:name":{}},"f:name":{}},"k:{\"name\":\"pod-info\"}":{".":{},"f:downwardAPI":{".":{},"f:defaultMode":{},"f:items":{}},"f:name":{}},"k:{\"name\":\"rabbitmq-confd\"}":{".":{},"f:name":{},"f:projected":{".":{},"f:defaultMode":{},"f:sources":{}}},"k:{\"name\":\"rabbitmq-erlang-cookie\"}":{".":{},"f:emptyDir":{},"f:name":{}},"k:{\"name\":\"rabbitmq-plugins\"}":{".":{},"f:emptyDir":{},"f:name":{}}}}},"f:updateStrategy":{"f:rollingUpdate":{".":{},"f:partition":{}},"f:type":{}},"f:volumeClaimTemplates":{}}}}]},"spec":{"replicas":3,"selector":{"matchLabels":{"app.kubernetes.io/name":"rabbitmq-cluster"}},"template":{"metadata":{"creationTimestamp":null,"labels":{"app.kubernetes.io/component":"rabbitmq","app.kubernetes.io/name":"rabbitmq-cluster","app.kubernetes.io/part-of":"rabbitmq"},"annotations":{"prometheus.io/port":"15692","prometheus.io/scrape":"true"}},"spec":{"volumes":[{"name":"plugins-conf","configMap":{"name":"rabbitmq-cluster-plugins-conf","defaultMode":420}},{"name":"rabbitmq-confd","projected":{"sources":[{"secret":{"name":"rabbitmq-cluster-default-user","items":[{"key":"default_user.conf","path":"default_user.conf"}]}},{"configMap":{"name":"rabbitmq-cluster-server-conf","items":[{"key":"operatorDefaults.conf","path":"operatorDefaults.conf"},{"key":"userDefinedConfiguration.conf","path":"userDefinedConfiguration.conf"}]}}],"defaultMode":420}},{"name":"rabbitmq-erlang-cookie","emptyDir":{}},{"name":"erlang-cookie-secret","secret":{"secretName":"rabbitmq-cluster-erlang-cookie","defaultMode":420}},{"name":"rabbitmq-plugins","emptyDir":{}},{"name":"pod-info","downwardAPI":{"items":[{"path":"skipPreStopChecks","fieldRef":{"apiVersion":"v1","fieldPath":"metadata.labels['skipPreStopChecks']"}}],"defaultMode":420}}],"initContainers":[{"name":"setup-container","image":"rabbitmq:3.8.12-management","command":["sh","-c","cp /tmp/erlang-cookie-secret/.erlang.cookie /var/lib/rabbitmq/.erlang.cookie \u0026\u0026 chown 999:999 /var/lib/rabbitmq/.erlang.cookie \u0026\u0026 chmod 600 /var/lib/rabbitmq/.erlang.cookie ; cp /tmp/rabbitmq-plugins/enabled_plugins /operator/enabled_plugins \u0026\u0026 chown 999:999 /operator/enabled_plugins ; chown 999:999 /var/lib/rabbitmq/mnesia/ ; echo '[default]' \u003e /var/lib/rabbitmq/.rabbitmqadmin.conf \u0026\u0026 sed -e 's/default_user/username/' -e 's/default_pass/password/' /tmp/default_user.conf \u003e\u003e /var/lib/rabbitmq/.rabbitmqadmin.conf \u0026\u0026 chown 999:999 /var/lib/rabbitmq/.rabbitmqadmin.conf \u0026\u0026 chmod 600 /var/lib/rabbitmq/.rabbitmqadmin.conf"],"resources":{"limits":{"cpu":"100m","memory":"500Mi"},"requests":{"cpu":"100m","memory":"500Mi"}},"volumeMounts":[{"name":"plugins-conf","mountPath":"/tmp/rabbitmq-plugins/"},{"name":"rabbitmq-erlang-cookie","mountPath":"/var/lib/rabbitmq/"},{"name":"erlang-cookie-secret","mountPath":"/tmp/erlang-cookie-secret/"},{"name":"rabbitmq-plugins","mountPath":"/operator"},{"name":"persistence","mountPath":"/var/lib/rabbitmq/mnesia/"},{"name":"rabbitmq-confd","mountPath":"/tmp/default_user.conf","subPath":"default_user.conf"}],"terminationMessagePath":"/dev/termination-log","terminationMessagePolicy":"File","imagePullPolicy":"IfNotPresent","securityContext":{"capabilities":{"drop":["FSETID","KILL","SETGID","SETUID","SETPCAP","NET_BIND_SERVICE","NET_RAW","SYS_CHROOT","MKNOD","AUDIT_WRITE","SETFCAP"]},"runAsUser":0}}],"containers":[{"name":"rabbitmq","image":"rabbitmq:3.8.12-management","ports":[{"name":"epmd","containerPort":4369,"protocol":"TCP"},{"name":"amqp","containerPort":5672,"protocol":"TCP"},{"name":"management","containerPort":15672,"protocol":"TCP"},{"name":"prometheus","containerPort":15692,"protocol":"TCP"}],"env":[{"name":"MY_POD_NAME","valueFrom":{"fieldRef":{"apiVersion":"v1","fieldPath":"metadata.name"}}},{"name":"MY_POD_NAMESPACE","valueFrom":{"fieldRef":{"apiVersion":"v1","fieldPath":"metadata.namespace"}}},{"name":"RABBITMQ_ENABLED_PLUGINS_FILE","value":"/operator/enabled_plugins"},{"name":"K8S_SERVICE_NAME","value":"rabbitmq-cluster-nodes"},{"name":"RABBITMQ_USE_LONGNAME","value":"true"},{"name":"RABBITMQ_NODENAME","value":"rabbit@$(MY_POD_NAME).$(K8S_SERVICE_NAME).$(MY_POD_NAMESPACE)"},{"name":"K8S_HOSTNAME_SUFFIX","value":".$(K8S_SERVICE_NAME).$(MY_POD_NAMESPACE)"}],"resources":{"limits":{"cpu":"2","memory":"2Gi"},"requests":{"cpu":"1","memory":"2Gi"}},"volumeMounts":[{"name":"rabbitmq-erlang-cookie","mountPath":"/var/lib/rabbitmq/"},{"name":"persistence","mountPath":"/var/lib/rabbitmq/mnesia/"},{"name":"rabbitmq-plugins","mountPath":"/operator"},{"name":"rabbitmq-confd","mountPath":"/etc/rabbitmq/conf.d/10-operatorDefaults.conf","subPath":"operatorDefaults.conf"},{"name":"rabbitmq-confd","mountPath":"/etc/rabbitmq/conf.d/11-default_user.conf","subPath":"default_user.conf"},{"name":"rabbitmq-confd","mountPath":"/etc/rabbitmq/conf.d/90-userDefinedConfiguration.conf","subPath":"userDefinedConfiguration.conf"},{"name":"pod-info","mountPath":"/etc/pod-info/"}],"readinessProbe":{"tcpSocket":{"port":"amqp"},"initialDelaySeconds":10,"timeoutSeconds":5,"periodSeconds":10,"successThreshold":1,"failureThreshold":3},"lifecycle":{"preStop":{"exec":{"command":["/bin/bash","-c","if [ ! -z \"$(cat /etc/pod-info/skipPreStopChecks)\" ]; then exit 0; fi; rabbitmq-upgrade await_online_quorum_plus_one -t 604800; rabbitmq-upgrade await_online_synchronized_mirror -t 604800; rabbitmq-upgrade drain -t 604800"]}}},"terminationMessagePath":"/dev/termination-log","terminationMessagePolicy":"File","imagePullPolicy":"IfNotPresent"}],"restartPolicy":"Always","terminationGracePeriodSeconds":604800,"dnsPolicy":"ClusterFirst","serviceAccountName":"rabbitmq-cluster-server","serviceAccount":"rabbitmq-cluster-server","automountServiceAccountToken":true,"securityContext":{"runAsUser":999,"runAsGroup":999,"fsGroup":999},"schedulerName":"default-scheduler","topologySpreadConstraints":[{"maxSkew":1,"topologyKey":"topology.kubernetes.io/zone","whenUnsatisfiable":"ScheduleAnyway","labelSelector":{"matchLabels":{"app.kubernetes.io/name":"rabbitmq-cluster"}}}]}},"volumeClaimTemplates":[{"metadata":{"name":"persistence","namespace":"default","creationTimestamp":null,"labels":{"app.kubernetes.io/component":"rabbitmq","app.kubernetes.io/name":"rabbitmq-cluster","app.kubernetes.io/part-of":"rabbitmq"},"ownerReferences":[{"apiVersion":"rabbitmq.com/v1beta1","kind":"RabbitmqCluster","name":"rabbitmq-cluster","uid":"18d9928b-0d1c-47be-80ec-20960d053827","controller":true,"blockOwnerDeletion":false}]},"spec":{"accessModes":["ReadWriteOnce"],"resources":{"requests":{"storage":"10Gi"}},"volumeMode":"Filesystem"},"status":{"phase":"Pending"}}],"serviceName":"rabbitmq-cluster-nodes","podManagementPolicy":"Parallel","updateStrategy":{"type":"RollingUpdate","rollingUpdate":{"partition":0}},"revisionHistoryLimit":10},"status":{"observedGeneration":2,"replicas":3,"readyReplicas":1,"currentReplicas":3,"updatedReplicas":3,"currentRevision":"rabbitmq-cluster-server-5f8b8665fb","updateRevision":"rabbitmq-cluster-server-5f8b8665fb","collisionCount":0}}
2022/03/18 18:01:53 learn_server.go:291: [SIEVE-AFTER-READ]	Get	true	service	default	rabbitmq-cluster-nodes	github.com/rabbitmq/cluster-operator/controllers.(*RabbitmqClusterReconciler)	NoError	{"kind":"Service","apiVersion":"v1","metadata":{"name":"rabbitmq-cluster-nodes","namespace":"default","selfLink":"/api/v1/namespaces/default/services/rabbitmq-cluster-nodes","uid":"67c7eea9-1b87-4fd7-82e6-5bfe31fd1b52","resourceVersion":"696","creationTimestamp":"2022-03-18T18:00:38Z","labels":{"app.kubernetes.io/component":"rabbitmq","app.kubernetes.io/name":"rabbitmq-cluster","app.kubernetes.io/part-of":"rabbitmq"},"ownerReferences":[{"apiVersion":"rabbitmq.com/v1beta1","kind":"RabbitmqCluster","name":"rabbitmq-cluster","uid":"18d9928b-0d1c-47be-80ec-20960d053827","controller":true,"blockOwnerDeletion":true}],"managedFields":[{"manager":"manager","operation":"Update","apiVersion":"v1","time":"2022-03-18T18:00:38Z","fieldsType":"FieldsV1","fieldsV1":{"f:metadata":{"f:labels":{".":{},"f:app.kubernetes.io/component":{},"f:app.kubernetes.io/name":{},"f:app.kubernetes.io/part-of":{}},"f:ownerReferences":{".":{},"k:{\"uid\":\"18d9928b-0d1c-47be-80ec-20960d053827\"}":{".":{},"f:apiVersion":{},"f:blockOwnerDeletion":{},"f:controller":{},"f:kind":{},"f:name":{},"f:uid":{}}}},"f:spec":{"f:clusterIP":{},"f:ports":{".":{},"k:{\"port\":4369,\"protocol\":\"TCP\"}":{".":{},"f:name":{},"f:port":{},"f:protocol":{},"f:targetPort":{}},"k:{\"port\":25672,\"protocol\":\"TCP\"}":{".":{},"f:name":{},"f:port":{},"f:protocol":{},"f:targetPort":{}}},"f:publishNotReadyAddresses":{},"f:selector":{".":{},"f:app.kubernetes.io/name":{}},"f:sessionAffinity":{},"f:type":{}}}}]},"spec":{"ports":[{"name":"epmd","protocol":"TCP","port":4369,"targetPort":4369},{"name":"cluster-rpc","protocol":"TCP","port":25672,"targetPort":25672}],"selector":{"app.kubernetes.io/name":"rabbitmq-cluster"},"clusterIP":"None","type":"ClusterIP","sessionAffinity":"None","publishNotReadyAddresses":true},"status":{"loadBalancer":{}}}
2022/03/18 18:01:53 learn_server.go:291: [SIEVE-AFTER-READ]	Get	true	service	default	rabbitmq-cluster	github.com/rabbitmq/cluster-operator/controllers.(*RabbitmqClusterReconciler)	NoError	{"kind":"Service","apiVersion":"v1","metadata":{"name":"rabbitmq-cluster","namespace":"default","selfLink":"/api/v1/namespaces/default/services/rabbitmq-cluster","uid":"56b50671-1945-458b-adac-05619b783392","resourceVersion":"701","creationTimestamp":"2022-03-18T18:00:38Z","labels":{"app.kubernetes.io/component":"rabbitmq","app.kubernetes.io/name":"rabbitmq-cluster","app.kubernetes.io/part-of":"rabbitmq"},"ownerReferences":[{"apiVersion":"rabbitmq.com/v1beta1","kind":"RabbitmqCluster","name":"rabbitmq-cluster","uid":"18d9928b-0d1c-47be-80ec-20960d053827","controller":true,"blockOwnerDeletion":true}],"managedFields":[{"manager":"manager","operation":"Update","apiVersion":"v1","time":"2022-03-18T18:00:38Z","fieldsType":"FieldsV1","fieldsV1":{"f:metadata":{"f:labels":{".":{},"f:app.kubernetes.io/component":{},"f:app.kubernetes.io/name":{},"f:app.kubernetes.io/part-of":{}},"f:ownerReferences":{".":{},"k:{\"uid\":\"18d9928b-0d1c-47be-80ec-20960d053827\"}":{".":{},"f:apiVersion":{},"f:blockOwnerDeletion":{},"f:controller":{},"f:kind":{},"f:name":{},"f:uid":{}}}},"f:spec":{"f:ports":{".":{},"k:{\"port\":5672,\"protocol\":\"TCP\"}":{".":{},"f:name":{},"f:port":{},"f:protocol":{},"f:targetPort":{}},"k:{\"port\":15672,\"protocol\":\"TCP\"}":{".":{},"f:name":{},"f:port":{},"f:protocol":{},"f:targetPort":{}}},"f:selector":{".":{},"f:app.kubernetes.io/name":{}},"f:sessionAffinity":{},"f:type":{}}}}]},"spec":{"ports":[{"name":"amqp","protocol":"TCP","port":5672,"targetPort":5672},{"name":"management","protocol":"TCP","port":15672,"targetPort":15672}],"selector":{"app.kubernetes.io/name":"rabbitmq-cluster"},"clusterIP":"10.96.254.158","type":"ClusterIP","sessionAffinity":"None"},"status":{"loadBalancer":{}}}
2022/03/18 18:01:53 learn_server.go:291: [SIEVE-AFTER-READ]	Get	true	secret	default	rabbitmq-cluster-erlang-cookie	github.com/rabbitmq/cluster-operator/controllers.(*RabbitmqClusterReconciler)	NoError	{"kind":"Secret","apiVersion":"v1","metadata":{"name":"rabbitmq-cluster-erlang-cookie","namespace":"default","selfLink":"/api/v1/namespaces/default/secrets/rabbitmq-cluster-erlang-cookie","uid":"f8fbe8a6-0f40-4e13-960b-ab78b8ba75b0","resourceVersion":"705","creationTimestamp":"2022-03-18T18:00:38Z","labels":{"app.kubernetes.io/component":"rabbitmq","app.kubernetes.io/name":"rabbitmq-cluster","app.kubernetes.io/part-of":"rabbitmq"},"ownerReferences":[{"apiVersion":"rabbitmq.com/v1beta1","kind":"RabbitmqCluster","name":"rabbitmq-cluster","uid":"18d9928b-0d1c-47be-80ec-20960d053827","controller":true,"blockOwnerDeletion":true}],"managedFields":[{"manager":"manager","operation":"Update","apiVersion":"v1","time":"2022-03-18T18:00:38Z","fieldsType":"FieldsV1","fieldsV1":{"f:data":{".":{},"f:.erlang.cookie":{}},"f:metadata":{"f:labels":{".":{},"f:app.kubernetes.io/component":{},"f:app.kubernetes.io/name":{},"f:app.kubernetes.io/part-of":{}},"f:ownerReferences":{".":{},"k:{\"uid\":\"18d9928b-0d1c-47be-80ec-20960d053827\"}":{".":{},"f:apiVersion":{},"f:blockOwnerDeletion":{},"f:controller":{},"f:kind":{},"f:name":{},"f:uid":{}}}},"f:type":{}}}]},"data":{".erlang.cookie":"QW9hMkpWU0tlYS1FUGdWTUhrelNMNnFoMFZ0ZmRGNUY="},"type":"Opaque"}
2022/03/18 18:01:53 learn_server.go:291: [SIEVE-AFTER-READ]	Get	true	secret	default	rabbitmq-cluster-default-user	github.com/rabbitmq/cluster-operator/controllers.(*RabbitmqClusterReconciler)	NoError	{"kind":"Secret","apiVersion":"v1","metadata":{"name":"rabbitmq-cluster-default-user","namespace":"default","selfLink":"/api/v1/namespaces/default/secrets/rabbitmq-cluster-default-user","uid":"0d9f460b-a23c-402b-8273-f541ed39023f","resourceVersion":"708","creationTimestamp":"2022-03-18T18:00:38Z","labels":{"app.kubernetes.io/component":"rabbitmq","app.kubernetes.io/name":"rabbitmq-cluster","app.kubernetes.io/part-of":"rabbitmq"},"ownerReferences":[{"apiVersion":"rabbitmq.com/v1beta1","kind":"RabbitmqCluster","name":"rabbitmq-cluster","uid":"18d9928b-0d1c-47be-80ec-20960d053827","controller":true,"blockOwnerDeletion":true}],"managedFields":[{"manager":"manager","operation":"Update","apiVersion":"v1","time":"2022-03-18T18:00:38Z","fieldsType":"FieldsV1","fieldsV1":{"f:data":{".":{},"f:default_user.conf":{},"f:password":{},"f:provider":{},"f:type":{},"f:username":{}},"f:metadata":{"f:labels":{".":{},"f:app.kubernetes.io/component":{},"f:app.kubernetes.io/name":{},"f:app.kubernetes.io/part-of":{}},"f:ownerReferences":{".":{},"k:{\"uid\":\"18d9928b-0d1c-47be-80ec-20960d053827\"}":{".":{},"f:apiVersion":{},"f:blockOwnerDeletion":{},"f:controller":{},"f:kind":{},"f:name":{},"f:uid":{}}}},"f:type":{}}}]},"data":{"default_user.conf":"ZGVmYXVsdF91c2VyID0gcTMxRmh3MGtjWW9SZUl5X3BPTXp2ZVBOUnNVU3I1Mk8KZGVmYXVsdF9wYXNzID0gY0dBX19jNTJHX05hVURpTGhraWZ6UDBOVVlNLTE2MWQK","password":"Y0dBX19jNTJHX05hVURpTGhraWZ6UDBOVVlNLTE2MWQ=","provider":"cmFiYml0bXE=","type":"cmFiYml0bXE=","username":"cTMxRmh3MGtjWW9SZUl5X3BPTXp2ZVBOUnNVU3I1Mk8="},"type":"Opaque"}
2022/03/18 18:01:53 learn_server.go:291: [SIEVE-AFTER-READ]	Get	true	configmap	default	rabbitmq-cluster-plugins-conf	github.com/rabbitmq/cluster-operator/controllers.(*RabbitmqClusterReconciler)	NoError	{"kind":"ConfigMap","apiVersion":"v1","metadata":{"name":"rabbitmq-cluster-plugins-conf","namespace":"default","selfLink":"/api/v1/namespaces/default/configmaps/rabbitmq-cluster-plugins-conf","uid":"a164075b-0562-47ac-a577-99aa8651ec40","resourceVersion":"709","creationTimestamp":"2022-03-18T18:00:38Z","labels":{"app.kubernetes.io/component":"rabbitmq","app.kubernetes.io/name":"rabbitmq-cluster","app.kubernetes.io/part-of":"rabbitmq"},"ownerReferences":[{"apiVersion":"rabbitmq.com/v1beta1","kind":"RabbitmqCluster","name":"rabbitmq-cluster","uid":"18d9928b-0d1c-47be-80ec-20960d053827","controller":true,"blockOwnerDeletion":true}],"managedFields":[{"manager":"manager","operation":"Update","apiVersion":"v1","time":"2022-03-18T18:00:38Z","fieldsType":"FieldsV1","fieldsV1":{"f:data":{".":{},"f:enabled_plugins":{}},"f:metadata":{"f:labels":{".":{},"f:app.kubernetes.io/component":{},"f:app.kubernetes.io/name":{},"f:app.kubernetes.io/part-of":{}},"f:ownerReferences":{".":{},"k:{\"uid\":\"18d9928b-0d1c-47be-80ec-20960d053827\"}":{".":{},"f:apiVersion":{},"f:blockOwnerDeletion":{},"f:controller":{},"f:kind":{},"f:name":{},"f:uid":{}}}}}}]},"data":{"enabled_plugins":"[rabbitmq_peer_discovery_k8s,rabbitmq_prometheus,rabbitmq_management]."}}
2022/03/18 18:01:53 learn_server.go:291: [SIEVE-AFTER-READ]	Get	true	configmap	default	rabbitmq-cluster-server-conf	github.com/rabbitmq/cluster-operator/controllers.(*RabbitmqClusterReconciler)	NoError	{"kind":"ConfigMap","apiVersion":"v1","metadata":{"name":"rabbitmq-cluster-server-conf","namespace":"default","selfLink":"/api/v1/namespaces/default/configmaps/rabbitmq-cluster-server-conf","uid":"22474f2b-8454-44b7-8079-8990223969cc","resourceVersion":"714","creationTimestamp":"2022-03-18T18:00:38Z","labels":{"app.kubernetes.io/component":"rabbitmq","app.kubernetes.io/name":"rabbitmq-cluster","app.kubernetes.io/part-of":"rabbitmq"},"ownerReferences":[{"apiVersion":"rabbitmq.com/v1beta1","kind":"RabbitmqCluster","name":"rabbitmq-cluster","uid":"18d9928b-0d1c-47be-80ec-20960d053827","controller":true,"blockOwnerDeletion":true}],"managedFields":[{"manager":"manager","operation":"Update","apiVersion":"v1","time":"2022-03-18T18:00:38Z","fieldsType":"FieldsV1","fieldsV1":{"f:data":{".":{},"f:operatorDefaults.conf":{},"f:userDefinedConfiguration.conf":{}},"f:metadata":{"f:labels":{".":{},"f:app.kubernetes.io/component":{},"f:app.kubernetes.io/name":{},"f:app.kubernetes.io/part-of":{}},"f:ownerReferences":{".":{},"k:{\"uid\":\"18d9928b-0d1c-47be-80ec-20960d053827\"}":{".":{},"f:apiVersion":{},"f:blockOwnerDeletion":{},"f:controller":{},"f:kind":{},"f:name":{},"f:uid":{}}}}}}]},"data":{"operatorDefaults.conf":"cluster_formation.peer_discovery_backend             = rabbit_peer_discovery_k8s\ncluster_formation.k8s.host                           = kubernetes.default\ncluster_formation.k8s.address_type                   = hostname\ncluster_partition_handling                           = pause_minority\nqueue_master_locator                                 = min-masters\ndisk_free_limit.absolute                             = 2GB\ncluster_formation.randomized_startup_delay_range.min = 5\ncluster_formation.randomized_startup_delay_range.max = 30\ncluster_name                                         = rabbitmq-cluster\n","userDefinedConfiguration.conf":"total_memory_available_override_value = 1717986919\n"}}
2022/03/18 18:01:53 learn_server.go:291: [SIEVE-AFTER-READ]	Get	true	serviceaccount	default	rabbitmq-cluster-server	github.com/rabbitmq/cluster-operator/controllers.(*RabbitmqClusterReconciler)	NoError	{"kind":"ServiceAccount","apiVersion":"v1","metadata":{"name":"rabbitmq-cluster-server","namespace":"default","selfLink":"/api/v1/namespaces/default/serviceaccounts/rabbitmq-cluster-server","uid":"731589b5-ac97-4774-bee4-008949b54734","resourceVersion":"722","creationTimestamp":"2022-03-18T18:00:38Z","labels":{"app.kubernetes.io/component":"rabbitmq","app.kubernetes.io/name":"rabbitmq-cluster","app.kubernetes.io/part-of":"rabbitmq"},"ownerReferences":[{"apiVersion":"rabbitmq.com/v1beta1","kind":"RabbitmqCluster","name":"rabbitmq-cluster","uid":"18d9928b-0d1c-47be-80ec-20960d053827","controller":true,"blockOwnerDeletion":true}],"managedFields":[{"manager":"kube-controller-manager","operation":"Update","apiVersion":"v1","time":"2022-03-18T18:00:38Z","fieldsType":"FieldsV1","fieldsV1":{"f:secrets":{".":{},"k:{\"name\":\"rabbitmq-cluster-server-token-rhzq9\"}":{".":{},"f:name":{}}}}},{"manager":"manager","operation":"Update","apiVersion":"v1","time":"2022-03-18T18:00:38Z","fieldsType":"FieldsV1","fieldsV1":{"f:metadata":{"f:labels":{".":{},"f:app.kubernetes.io/component":{},"f:app.kubernetes.io/name":{},"f:app.kubernetes.io/part-of":{}},"f:ownerReferences":{".":{},"k:{\"uid\":\"18d9928b-0d1c-47be-80ec-20960d053827\"}":{".":{},"f:apiVersion":{},"f:blockOwnerDeletion":{},"f:controller":{},"f:kind":{},"f:name":{},"f:uid":{}}}}}}]},"secrets":[{"name":"rabbitmq-cluster-server-token-rhzq9"}]}
2022/03/18 18:01:53 learn_server.go:291: [SIEVE-AFTER-READ]	Get	true	role	default	rabbitmq-cluster-peer-discovery	github.com/rabbitmq/cluster-operator/controllers.(*RabbitmqClusterReconciler)	NoError	{"kind":"Role","apiVersion":"rbac.authorization.k8s.io/v1","metadata":{"name":"rabbitmq-cluster-peer-discovery","namespace":"default","selfLink":"/apis/rbac.authorization.k8s.io/v1/namespaces/default/roles/rabbitmq-cluster-peer-discovery","uid":"52c80b50-4fdd-4089-bbfd-9756465953f2","resourceVersion":"723","creationTimestamp":"2022-03-18T18:00:38Z","labels":{"app.kubernetes.io/component":"rabbitmq","app.kubernetes.io/name":"rabbitmq-cluster","app.kubernetes.io/part-of":"rabbitmq"},"ownerReferences":[{"apiVersion":"rabbitmq.com/v1beta1","kind":"RabbitmqCluster","name":"rabbitmq-cluster","uid":"18d9928b-0d1c-47be-80ec-20960d053827","controller":true,"blockOwnerDeletion":true}],"managedFields":[{"manager":"manager","operation":"Update","apiVersion":"rbac.authorization.k8s.io/v1","time":"2022-03-18T18:00:38Z","fieldsType":"FieldsV1","fieldsV1":{"f:metadata":{"f:labels":{".":{},"f:app.kubernetes.io/component":{},"f:app.kubernetes.io/name":{},"f:app.kubernetes.io/part-of":{}},"f:ownerReferences":{".":{},"k:{\"uid\":\"18d9928b-0d1c-47be-80ec-20960d053827\"}":{".":{},"f:apiVersion":{},"f:blockOwnerDeletion":{},"f:controller":{},"f:kind":{},"f:name":{},"f:uid":{}}}},"f:rules":{}}}]},"rules":[{"verbs":["get"],"apiGroups":[""],"resources":["endpoints"]},{"verbs":["create"],"apiGroups":[""],"resources":["events"]}]}
2022/03/18 18:01:53 learn_server.go:291: [SIEVE-AFTER-READ]	Get	true	rolebinding	default	rabbitmq-cluster-server	github.com/rabbitmq/cluster-operator/controllers.(*RabbitmqClusterReconciler)	NoError	{"kind":"RoleBinding","apiVersion":"rbac.authorization.k8s.io/v1","metadata":{"name":"rabbitmq-cluster-server","namespace":"default","selfLink":"/apis/rbac.authorization.k8s.io/v1/namespaces/default/rolebindings/rabbitmq-cluster-server","uid":"495e9f7c-a20d-4515-86b0-34149a855034","resourceVersion":"725","creationTimestamp":"2022-03-18T18:00:38Z","labels":{"app.kubernetes.io/component":"rabbitmq","app.kubernetes.io/name":"rabbitmq-cluster","app.kubernetes.io/part-of":"rabbitmq"},"ownerReferences":[{"apiVersion":"rabbitmq.com/v1beta1","kind":"RabbitmqCluster","name":"rabbitmq-cluster","uid":"18d9928b-0d1c-47be-80ec-20960d053827","controller":true,"blockOwnerDeletion":true}],"managedFields":[{"manager":"manager","operation":"Update","apiVersion":"rbac.authorization.k8s.io/v1","time":"2022-03-18T18:00:38Z","fieldsType":"FieldsV1","fieldsV1":{"f:metadata":{"f:labels":{".":{},"f:app.kubernetes.io/component":{},"f:app.kubernetes.io/name":{},"f:app.kubernetes.io/part-of":{}},"f:ownerReferences":{".":{},"k:{\"uid\":\"18d9928b-0d1c-47be-80ec-20960d053827\"}":{".":{},"f:apiVersion":{},"f:blockOwnerDeletion":{},"f:controller":{},"f:kind":{},"f:name":{},"f:uid":{}}}},"f:roleRef":{"f:apiGroup":{},"f:kind":{},"f:name":{}},"f:subjects":{}}}]},"subjects":[{"kind":"ServiceAccount","name":"rabbitmq-cluster-server"}],"roleRef":{"apiGroup":"rbac.authorization.k8s.io","kind":"Role","name":"rabbitmq-cluster-peer-discovery"}}
2022/03/18 18:01:53 learn_server.go:291: [SIEVE-AFTER-READ]	Get	true	statefulset	default	rabbitmq-cluster-server	github.com/rabbitmq/cluster-operator/controllers.(*RabbitmqClusterReconciler)	NoError	{"kind":"StatefulSet","apiVersion":"apps/v1","metadata":{"name":"rabbitmq-cluster-server","namespace":"default","selfLink":"/apis/apps/v1/namespaces/default/statefulsets/rabbitmq-cluster-server","uid":"cb5c43bc-6ee7-481c-ab01-6f3acffdd3c8","resourceVersion":"989","generation":2,"creationTimestamp":"2022-03-18T18:00:38Z","labels":{"app.kubernetes.io/component":"rabbitmq","app.kubernetes.io/name":"rabbitmq-cluster","app.kubernetes.io/part-of":"rabbitmq"},"ownerReferences":[{"apiVersion":"rabbitmq.com/v1beta1","kind":"RabbitmqCluster","name":"rabbitmq-cluster","uid":"18d9928b-0d1c-47be-80ec-20960d053827","controller":true,"blockOwnerDeletion":true}],"managedFields":[{"manager":"kube-controller-manager","operation":"Update","apiVersion":"apps/v1","time":"2022-03-18T18:01:23Z","fieldsType":"FieldsV1","fieldsV1":{"f:status":{"f:collisionCount":{},"f:currentReplicas":{},"f:currentRevision":{},"f:observedGeneration":{},"f:readyReplicas":{},"f:replicas":{},"f:updateRevision":{},"f:updatedReplicas":{}}}},{"manager":"manager","operation":"Update","apiVersion":"apps/v1","time":"2022-03-18T18:01:23Z","fieldsType":"FieldsV1","fieldsV1":{"f:metadata":{"f:labels":{".":{},"f:app.kubernetes.io/component":{},"f:app.kubernetes.io/name":{},"f:app.kubernetes.io/part-of":{}},"f:ownerReferences":{".":{},"k:{\"uid\":\"18d9928b-0d1c-47be-80ec-20960d053827\"}":{".":{},"f:apiVersion":{},"f:blockOwnerDeletion":{},"f:controller":{},"f:kind":{},"f:name":{},"f:uid":{}}}},"f:spec":{"f:podManagementPolicy":{},"f:replicas":{},"f:revisionHistoryLimit":{},"f:selector":{"f:matchLabels":{".":{},"f:app.kubernetes.io/name":{}}},"f:serviceName":{},"f:template":{"f:metadata":{"f:annotations":{".":{},"f:prometheus.io/port":{},"f:prometheus.io/scrape":{}},"f:labels":{".":{},"f:app.kubernetes.io/component":{},"f:app.kubernetes.io/name":{},"f:app.kubernetes.io/part-of":{}}},"f:spec":{"f:automountServiceAccountToken":{},"f:containers":{"k:{\"name\":\"rabbitmq\"}":{".":{},"f:env":{".":{},"k:{\"name\":\"K8S_HOSTNAME_SUFFIX\"}":{".":{},"f:name":{},"f:value":{}},"k:{\"name\":\"K8S_SERVICE_NAME\"}":{".":{},"f:name":{},"f:value":{}},"k:{\"name\":\"MY_POD_NAME\"}":{".":{},"f:name":{},"f:valueFrom":{".":{},"f:fieldRef":{".":{},"f:apiVersion":{},"f:fieldPath":{}}}},"k:{\"name\":\"MY_POD_NAMESPACE\"}":{".":{},"f:name":{},"f:valueFrom":{".":{},"f:fieldRef":{".":{},"f:apiVersion":{},"f:fieldPath":{}}}},"k:{\"name\":\"RABBITMQ_ENABLED_PLUGINS_FILE\"}":{".":{},"f:name":{},"f:value":{}},"k:{\"name\":\"RABBITMQ_NODENAME\"}":{".":{},"f:name":{},"f:value":{}},"k:{\"name\":\"RABBITMQ_USE_LONGNAME\"}":{".":{},"f:name":{},"f:value":{}}},"f:image":{},"f:imagePullPolicy":{},"f:lifecycle":{".":{},"f:preStop":{".":{},"f:exec":{".":{},"f:command":{}}}},"f:name":{},"f:ports":{".":{},"k:{\"containerPort\":4369,\"protocol\":\"TCP\"}":{".":{},"f:containerPort":{},"f:name":{},"f:protocol":{}},"k:{\"containerPort\":5672,\"protocol\":\"TCP\"}":{".":{},"f:containerPort":{},"f:name":{},"f:protocol":{}},"k:{\"containerPort\":15672,\"protocol\":\"TCP\"}":{".":{},"f:containerPort":{},"f:name":{},"f:protocol":{}},"k:{\"containerPort\":15692,\"protocol\":\"TCP\"}":{".":{},"f:containerPort":{},"f:name":{},"f:protocol":{}}},"f:readinessProbe":{".":{},"f:failureThreshold":{},"f:initialDelaySeconds":{},"f:periodSeconds":{},"f:successThreshold":{},"f:tcpSocket":{".":{},"f:port":{}},"f:timeoutSeconds":{}},"f:resources":{".":{},"f:limits":{".":{},"f:cpu":{},"f:memory":{}},"f:requests":{".":{},"f:cpu":{},"f:memory":{}}},"f:terminationMessagePath":{},"f:terminationMessagePolicy":{},"f:volumeMounts":{".":{},"k:{\"mountPath\":\"/etc/pod-info/\"}":{".":{},"f:mountPath":{},"f:name":{}},"k:{\"mountPath\":\"/etc/rabbitmq/conf.d/10-operatorDefaults.conf\"}":{".":{},"f:mountPath":{},"f:name":{},"f:subPath":{}},"k:{\"mountPath\":\"/etc/rabbitmq/conf.d/11-default_user.conf\"}":{".":{},"f:mountPath":{},"f:name":{},"f:subPath":{}},"k:{\"mountPath\":\"/etc/rabbitmq/conf.d/90-userDefinedConfiguration.conf\"}":{".":{},"f:mountPath":{},"f:name":{},"f:subPath":{}},"k:{\"mountPath\":\"/operator\"}":{".":{},"f:mountPath":{},"f:name":{}},"k:{\"mountPath\":\"/var/lib/rabbitmq/\"}":{".":{},"f:mountPath":{},"f:name":{}},"k:{\"mountPath\":\"/var/lib/rabbitmq/mnesia/\"}":{".":{},"f:mountPath":{},"f:name":{}}}}},"f:dnsPolicy":{},"f:initContainers":{".":{},"k:{\"name\":\"setup-container\"}":{".":{},"f:command":{},"f:image":{},"f:imagePullPolicy":{},"f:name":{},"f:resources":{".":{},"f:limits":{".":{},"f:cpu":{},"f:memory":{}},"f:requests":{".":{},"f:cpu":{},"f:memory":{}}},"f:securityContext":{".":{},"f:capabilities":{".":{},"f:drop":{}},"f:runAsUser":{}},"f:terminationMessagePath":{},"f:terminationMessagePolicy":{},"f:volumeMounts":{".":{},"k:{\"mountPath\":\"/operator\"}":{".":{},"f:mountPath":{},"f:name":{}},"k:{\"mountPath\":\"/tmp/default_user.conf\"}":{".":{},"f:mountPath":{},"f:name":{},"f:subPath":{}},"k:{\"mountPath\":\"/tmp/erlang-cookie-secret/\"}":{".":{},"f:mountPath":{},"f:name":{}},"k:{\"mountPath\":\"/tmp/rabbitmq-plugins/\"}":{".":{},"f:mountPath":{},"f:name":{}},"k:{\"mountPath\":\"/var/lib/rabbitmq/\"}":{".":{},"f:mountPath":{},"f:name":{}},"k:{\"mountPath\":\"/var/lib/rabbitmq/mnesia/\"}":{".":{},"f:mountPath":{},"f:name":{}}}}},"f:restartPolicy":{},"f:schedulerName":{},"f:securityContext":{".":{},"f:fsGroup":{},"f:runAsGroup":{},"f:runAsUser":{}},"f:serviceAccount":{},"f:serviceAccountName":{},"f:terminationGracePeriodSeconds":{},"f:topologySpreadConstraints":{".":{},"k:{\"topologyKey\":\"topology.kubernetes.io/zone\",\"whenUnsatisfiable\":\"ScheduleAnyway\"}":{".":{},"f:labelSelector":{".":{},"f:matchLabels":{".":{},"f:app.kubernetes.io/name":{}}},"f:maxSkew":{},"f:topologyKey":{},"f:whenUnsatisfiable":{}}},"f:volumes":{".":{},"k:{\"name\":\"erlang-cookie-secret\"}":{".":{},"f:name":{},"f:secret":{".":{},"f:defaultMode":{},"f:secretName":{}}},"k:{\"name\":\"plugins-conf\"}":{".":{},"f:configMap":{".":{},"f:defaultMode":{},"f:name":{}},"f:name":{}},"k:{\"name\":\"pod-info\"}":{".":{},"f:downwardAPI":{".":{},"f:defaultMode":{},"f:items":{}},"f:name":{}},"k:{\"name\":\"rabbitmq-confd\"}":{".":{},"f:name":{},"f:projected":{".":{},"f:defaultMode":{},"f:sources":{}}},"k:{\"name\":\"rabbitmq-erlang-cookie\"}":{".":{},"f:emptyDir":{},"f:name":{}},"k:{\"name\":\"rabbitmq-plugins\"}":{".":{},"f:emptyDir":{},"f:name":{}}}}},"f:updateStrategy":{"f:rollingUpdate":{".":{},"f:partition":{}},"f:type":{}},"f:volumeClaimTemplates":{}}}}]},"spec":{"replicas":3,"selector":{"matchLabels":{"app.kubernetes.io/name":"rabbitmq-cluster"}},"template":{"metadata":{"creationTimestamp":null,"labels":{"app.kubernetes.io/component":"rabbitmq","app.kubernetes.io/name":"rabbitmq-cluster","app.kubernetes.io/part-of":"rabbitmq"},"annotations":{"prometheus.io/port":"15692","prometheus.io/scrape":"true"}},"spec":{"volumes":[{"name":"plugins-conf","configMap":{"name":"rabbitmq-cluster-plugins-conf","defaultMode":420}},{"name":"rabbitmq-confd","projected":{"sources":[{"secret":{"name":"rabbitmq-cluster-default-user","items":[{"key":"default_user.conf","path":"default_user.conf"}]}},{"configMap":{"name":"rabbitmq-cluster-server-conf","items":[{"key":"operatorDefaults.conf","path":"operatorDefaults.conf"},{"key":"userDefinedConfiguration.conf","path":"userDefinedConfiguration.conf"}]}}],"defaultMode":420}},{"name":"rabbitmq-erlang-cookie","emptyDir":{}},{"name":"erlang-cookie-secret","secret":{"secretName":"rabbitmq-cluster-erlang-cookie","defaultMode":420}},{"name":"rabbitmq-plugins","emptyDir":{}},{"name":"pod-info","downwardAPI":{"items":[{"path":"skipPreStopChecks","fieldRef":{"apiVersion":"v1","fieldPath":"metadata.labels['skipPreStopChecks']"}}],"defaultMode":420}}],"initContainers":[{"name":"setup-container","image":"rabbitmq:3.8.12-management","command":["sh","-c","cp /tmp/erlang-cookie-secret/.erlang.cookie /var/lib/rabbitmq/.erlang.cookie \u0026\u0026 chown 999:999 /var/lib/rabbitmq/.erlang.cookie \u0026\u0026 chmod 600 /var/lib/rabbitmq/.erlang.cookie ; cp /tmp/rabbitmq-plugins/enabled_plugins /operator/enabled_plugins \u0026\u0026 chown 999:999 /operator/enabled_plugins ; chown 999:999 /var/lib/rabbitmq/mnesia/ ; echo '[default]' \u003e /var/lib/rabbitmq/.rabbitmqadmin.conf \u0026\u0026 sed -e 's/default_user/username/' -e 's/default_pass/password/' /tmp/default_user.conf \u003e\u003e /var/lib/rabbitmq/.rabbitmqadmin.conf \u0026\u0026 chown 999:999 /var/lib/rabbitmq/.rabbitmqadmin.conf \u0026\u0026 chmod 600 /var/lib/rabbitmq/.rabbitmqadmin.conf"],"resources":{"limits":{"cpu":"100m","memory":"500Mi"},"requests":{"cpu":"100m","memory":"500Mi"}},"volumeMounts":[{"name":"plugins-conf","mountPath":"/tmp/rabbitmq-plugins/"},{"name":"rabbitmq-erlang-cookie","mountPath":"/var/lib/rabbitmq/"},{"name":"erlang-cookie-secret","mountPath":"/tmp/erlang-cookie-secret/"},{"name":"rabbitmq-plugins","mountPath":"/operator"},{"name":"persistence","mountPath":"/var/lib/rabbitmq/mnesia/"},{"name":"rabbitmq-confd","mountPath":"/tmp/default_user.conf","subPath":"default_user.conf"}],"terminationMessagePath":"/dev/termination-log","terminationMessagePolicy":"File","imagePullPolicy":"IfNotPresent","securityContext":{"capabilities":{"drop":["FSETID","KILL","SETGID","SETUID","SETPCAP","NET_BIND_SERVICE","NET_RAW","SYS_CHROOT","MKNOD","AUDIT_WRITE","SETFCAP"]},"runAsUser":0}}],"containers":[{"name":"rabbitmq","image":"rabbitmq:3.8.12-management","ports":[{"name":"epmd","containerPort":4369,"protocol":"TCP"},{"name":"amqp","containerPort":5672,"protocol":"TCP"},{"name":"management","containerPort":15672,"protocol":"TCP"},{"name":"prometheus","containerPort":15692,"protocol":"TCP"}],"env":[{"name":"MY_POD_NAME","valueFrom":{"fieldRef":{"apiVersion":"v1","fieldPath":"metadata.name"}}},{"name":"MY_POD_NAMESPACE","valueFrom":{"fieldRef":{"apiVersion":"v1","fieldPath":"metadata.namespace"}}},{"name":"RABBITMQ_ENABLED_PLUGINS_FILE","value":"/operator/enabled_plugins"},{"name":"K8S_SERVICE_NAME","value":"rabbitmq-cluster-nodes"},{"name":"RABBITMQ_USE_LONGNAME","value":"true"},{"name":"RABBITMQ_NODENAME","value":"rabbit@$(MY_POD_NAME).$(K8S_SERVICE_NAME).$(MY_POD_NAMESPACE)"},{"name":"K8S_HOSTNAME_SUFFIX","value":".$(K8S_SERVICE_NAME).$(MY_POD_NAMESPACE)"}],"resources":{"limits":{"cpu":"2","memory":"2Gi"},"requests":{"cpu":"1","memory":"2Gi"}},"volumeMounts":[{"name":"rabbitmq-erlang-cookie","mountPath":"/var/lib/rabbitmq/"},{"name":"persistence","mountPath":"/var/lib/rabbitmq/mnesia/"},{"name":"rabbitmq-plugins","mountPath":"/operator"},{"name":"rabbitmq-confd","mountPath":"/etc/rabbitmq/conf.d/10-operatorDefaults.conf","subPath":"operatorDefaults.conf"},{"name":"rabbitmq-confd","mountPath":"/etc/rabbitmq/conf.d/11-default_user.conf","subPath":"default_user.conf"},{"name":"rabbitmq-confd","mountPath":"/etc/rabbitmq/conf.d/90-userDefinedConfiguration.conf","subPath":"userDefinedConfiguration.conf"},{"name":"pod-info","mountPath":"/etc/pod-info/"}],"readinessProbe":{"tcpSocket":{"port":"amqp"},"initialDelaySeconds":10,"timeoutSeconds":5,"periodSeconds":10,"successThreshold":1,"failureThreshold":3},"lifecycle":{"preStop":{"exec":{"command":["/bin/bash","-c","if [ ! -z \"$(cat /etc/pod-info/skipPreStopChecks)\" ]; then exit 0; fi; rabbitmq-upgrade await_online_quorum_plus_one -t 604800; rabbitmq-upgrade await_online_synchronized_mirror -t 604800; rabbitmq-upgrade drain -t 604800"]}}},"terminationMessagePath":"/dev/termination-log","terminationMessagePolicy":"File","imagePullPolicy":"IfNotPresent"}],"restartPolicy":"Always","terminationGracePeriodSeconds":604800,"dnsPolicy":"ClusterFirst","serviceAccountName":"rabbitmq-cluster-server","serviceAccount":"rabbitmq-cluster-server","automountServiceAccountToken":true,"securityContext":{"runAsUser":999,"runAsGroup":999,"fsGroup":999},"schedulerName":"default-scheduler","topologySpreadConstraints":[{"maxSkew":1,"topologyKey":"topology.kubernetes.io/zone","whenUnsatisfiable":"ScheduleAnyway","labelSelector":{"matchLabels":{"app.kubernetes.io/name":"rabbitmq-cluster"}}}]}},"volumeClaimTemplates":[{"metadata":{"name":"persistence","namespace":"default","creationTimestamp":null,"labels":{"app.kubernetes.io/component":"rabbitmq","app.kubernetes.io/name":"rabbitmq-cluster","app.kubernetes.io/part-of":"rabbitmq"},"ownerReferences":[{"apiVersion":"rabbitmq.com/v1beta1","kind":"RabbitmqCluster","name":"rabbitmq-cluster","uid":"18d9928b-0d1c-47be-80ec-20960d053827","controller":true,"blockOwnerDeletion":false}]},"spec":{"accessModes":["ReadWriteOnce"],"resources":{"requests":{"storage":"10Gi"}},"volumeMode":"Filesystem"},"status":{"phase":"Pending"}}],"serviceName":"rabbitmq-cluster-nodes","podManagementPolicy":"Parallel","updateStrategy":{"type":"RollingUpdate","rollingUpdate":{"partition":0}},"revisionHistoryLimit":10},"status":{"observedGeneration":2,"replicas":3,"readyReplicas":1,"currentReplicas":3,"updatedReplicas":3,"currentRevision":"rabbitmq-cluster-server-5f8b8665fb","updateRevision":"rabbitmq-cluster-server-5f8b8665fb","collisionCount":0}}
2022/03/18 18:01:53 learn_server.go:291: [SIEVE-AFTER-READ]	Get	true	statefulset	default	rabbitmq-cluster-server	github.com/rabbitmq/cluster-operator/controllers.(*RabbitmqClusterReconciler)	NoError	{"kind":"StatefulSet","apiVersion":"apps/v1","metadata":{"name":"rabbitmq-cluster-server","namespace":"default","selfLink":"/apis/apps/v1/namespaces/default/statefulsets/rabbitmq-cluster-server","uid":"cb5c43bc-6ee7-481c-ab01-6f3acffdd3c8","resourceVersion":"989","generation":2,"creationTimestamp":"2022-03-18T18:00:38Z","labels":{"app.kubernetes.io/component":"rabbitmq","app.kubernetes.io/name":"rabbitmq-cluster","app.kubernetes.io/part-of":"rabbitmq"},"ownerReferences":[{"apiVersion":"rabbitmq.com/v1beta1","kind":"RabbitmqCluster","name":"rabbitmq-cluster","uid":"18d9928b-0d1c-47be-80ec-20960d053827","controller":true,"blockOwnerDeletion":true}],"managedFields":[{"manager":"kube-controller-manager","operation":"Update","apiVersion":"apps/v1","time":"2022-03-18T18:01:23Z","fieldsType":"FieldsV1","fieldsV1":{"f:status":{"f:collisionCount":{},"f:currentReplicas":{},"f:currentRevision":{},"f:observedGeneration":{},"f:readyReplicas":{},"f:replicas":{},"f:updateRevision":{},"f:updatedReplicas":{}}}},{"manager":"manager","operation":"Update","apiVersion":"apps/v1","time":"2022-03-18T18:01:23Z","fieldsType":"FieldsV1","fieldsV1":{"f:metadata":{"f:labels":{".":{},"f:app.kubernetes.io/component":{},"f:app.kubernetes.io/name":{},"f:app.kubernetes.io/part-of":{}},"f:ownerReferences":{".":{},"k:{\"uid\":\"18d9928b-0d1c-47be-80ec-20960d053827\"}":{".":{},"f:apiVersion":{},"f:blockOwnerDeletion":{},"f:controller":{},"f:kind":{},"f:name":{},"f:uid":{}}}},"f:spec":{"f:podManagementPolicy":{},"f:replicas":{},"f:revisionHistoryLimit":{},"f:selector":{"f:matchLabels":{".":{},"f:app.kubernetes.io/name":{}}},"f:serviceName":{},"f:template":{"f:metadata":{"f:annotations":{".":{},"f:prometheus.io/port":{},"f:prometheus.io/scrape":{}},"f:labels":{".":{},"f:app.kubernetes.io/component":{},"f:app.kubernetes.io/name":{},"f:app.kubernetes.io/part-of":{}}},"f:spec":{"f:automountServiceAccountToken":{},"f:containers":{"k:{\"name\":\"rabbitmq\"}":{".":{},"f:env":{".":{},"k:{\"name\":\"K8S_HOSTNAME_SUFFIX\"}":{".":{},"f:name":{},"f:value":{}},"k:{\"name\":\"K8S_SERVICE_NAME\"}":{".":{},"f:name":{},"f:value":{}},"k:{\"name\":\"MY_POD_NAME\"}":{".":{},"f:name":{},"f:valueFrom":{".":{},"f:fieldRef":{".":{},"f:apiVersion":{},"f:fieldPath":{}}}},"k:{\"name\":\"MY_POD_NAMESPACE\"}":{".":{},"f:name":{},"f:valueFrom":{".":{},"f:fieldRef":{".":{},"f:apiVersion":{},"f:fieldPath":{}}}},"k:{\"name\":\"RABBITMQ_ENABLED_PLUGINS_FILE\"}":{".":{},"f:name":{},"f:value":{}},"k:{\"name\":\"RABBITMQ_NODENAME\"}":{".":{},"f:name":{},"f:value":{}},"k:{\"name\":\"RABBITMQ_USE_LONGNAME\"}":{".":{},"f:name":{},"f:value":{}}},"f:image":{},"f:imagePullPolicy":{},"f:lifecycle":{".":{},"f:preStop":{".":{},"f:exec":{".":{},"f:command":{}}}},"f:name":{},"f:ports":{".":{},"k:{\"containerPort\":4369,\"protocol\":\"TCP\"}":{".":{},"f:containerPort":{},"f:name":{},"f:protocol":{}},"k:{\"containerPort\":5672,\"protocol\":\"TCP\"}":{".":{},"f:containerPort":{},"f:name":{},"f:protocol":{}},"k:{\"containerPort\":15672,\"protocol\":\"TCP\"}":{".":{},"f:containerPort":{},"f:name":{},"f:protocol":{}},"k:{\"containerPort\":15692,\"protocol\":\"TCP\"}":{".":{},"f:containerPort":{},"f:name":{},"f:protocol":{}}},"f:readinessProbe":{".":{},"f:failureThreshold":{},"f:initialDelaySeconds":{},"f:periodSeconds":{},"f:successThreshold":{},"f:tcpSocket":{".":{},"f:port":{}},"f:timeoutSeconds":{}},"f:resources":{".":{},"f:limits":{".":{},"f:cpu":{},"f:memory":{}},"f:requests":{".":{},"f:cpu":{},"f:memory":{}}},"f:terminationMessagePath":{},"f:terminationMessagePolicy":{},"f:volumeMounts":{".":{},"k:{\"mountPath\":\"/etc/pod-info/\"}":{".":{},"f:mountPath":{},"f:name":{}},"k:{\"mountPath\":\"/etc/rabbitmq/conf.d/10-operatorDefaults.conf\"}":{".":{},"f:mountPath":{},"f:name":{},"f:subPath":{}},"k:{\"mountPath\":\"/etc/rabbitmq/conf.d/11-default_user.conf\"}":{".":{},"f:mountPath":{},"f:name":{},"f:subPath":{}},"k:{\"mountPath\":\"/etc/rabbitmq/conf.d/90-userDefinedConfiguration.conf\"}":{".":{},"f:mountPath":{},"f:name":{},"f:subPath":{}},"k:{\"mountPath\":\"/operator\"}":{".":{},"f:mountPath":{},"f:name":{}},"k:{\"mountPath\":\"/var/lib/rabbitmq/\"}":{".":{},"f:mountPath":{},"f:name":{}},"k:{\"mountPath\":\"/var/lib/rabbitmq/mnesia/\"}":{".":{},"f:mountPath":{},"f:name":{}}}}},"f:dnsPolicy":{},"f:initContainers":{".":{},"k:{\"name\":\"setup-container\"}":{".":{},"f:command":{},"f:image":{},"f:imagePullPolicy":{},"f:name":{},"f:resources":{".":{},"f:limits":{".":{},"f:cpu":{},"f:memory":{}},"f:requests":{".":{},"f:cpu":{},"f:memory":{}}},"f:securityContext":{".":{},"f:capabilities":{".":{},"f:drop":{}},"f:runAsUser":{}},"f:terminationMessagePath":{},"f:terminationMessagePolicy":{},"f:volumeMounts":{".":{},"k:{\"mountPath\":\"/operator\"}":{".":{},"f:mountPath":{},"f:name":{}},"k:{\"mountPath\":\"/tmp/default_user.conf\"}":{".":{},"f:mountPath":{},"f:name":{},"f:subPath":{}},"k:{\"mountPath\":\"/tmp/erlang-cookie-secret/\"}":{".":{},"f:mountPath":{},"f:name":{}},"k:{\"mountPath\":\"/tmp/rabbitmq-plugins/\"}":{".":{},"f:mountPath":{},"f:name":{}},"k:{\"mountPath\":\"/var/lib/rabbitmq/\"}":{".":{},"f:mountPath":{},"f:name":{}},"k:{\"mountPath\":\"/var/lib/rabbitmq/mnesia/\"}":{".":{},"f:mountPath":{},"f:name":{}}}}},"f:restartPolicy":{},"f:schedulerName":{},"f:securityContext":{".":{},"f:fsGroup":{},"f:runAsGroup":{},"f:runAsUser":{}},"f:serviceAccount":{},"f:serviceAccountName":{},"f:terminationGracePeriodSeconds":{},"f:topologySpreadConstraints":{".":{},"k:{\"topologyKey\":\"topology.kubernetes.io/zone\",\"whenUnsatisfiable\":\"ScheduleAnyway\"}":{".":{},"f:labelSelector":{".":{},"f:matchLabels":{".":{},"f:app.kubernetes.io/name":{}}},"f:maxSkew":{},"f:topologyKey":{},"f:whenUnsatisfiable":{}}},"f:volumes":{".":{},"k:{\"name\":\"erlang-cookie-secret\"}":{".":{},"f:name":{},"f:secret":{".":{},"f:defaultMode":{},"f:secretName":{}}},"k:{\"name\":\"plugins-conf\"}":{".":{},"f:configMap":{".":{},"f:defaultMode":{},"f:name":{}},"f:name":{}},"k:{\"name\":\"pod-info\"}":{".":{},"f:downwardAPI":{".":{},"f:defaultMode":{},"f:items":{}},"f:name":{}},"k:{\"name\":\"rabbitmq-confd\"}":{".":{},"f:name":{},"f:projected":{".":{},"f:defaultMode":{},"f:sources":{}}},"k:{\"name\":\"rabbitmq-erlang-cookie\"}":{".":{},"f:emptyDir":{},"f:name":{}},"k:{\"name\":\"rabbitmq-plugins\"}":{".":{},"f:emptyDir":{},"f:name":{}}}}},"f:updateStrategy":{"f:rollingUpdate":{".":{},"f:partition":{}},"f:type":{}},"f:volumeClaimTemplates":{}}}}]},"spec":{"replicas":3,"selector":{"matchLabels":{"app.kubernetes.io/name":"rabbitmq-cluster"}},"template":{"metadata":{"creationTimestamp":null,"labels":{"app.kubernetes.io/component":"rabbitmq","app.kubernetes.io/name":"rabbitmq-cluster","app.kubernetes.io/part-of":"rabbitmq"},"annotations":{"prometheus.io/port":"15692","prometheus.io/scrape":"true"}},"spec":{"volumes":[{"name":"plugins-conf","configMap":{"name":"rabbitmq-cluster-plugins-conf","defaultMode":420}},{"name":"rabbitmq-confd","projected":{"sources":[{"secret":{"name":"rabbitmq-cluster-default-user","items":[{"key":"default_user.conf","path":"default_user.conf"}]}},{"configMap":{"name":"rabbitmq-cluster-server-conf","items":[{"key":"operatorDefaults.conf","path":"operatorDefaults.conf"},{"key":"userDefinedConfiguration.conf","path":"userDefinedConfiguration.conf"}]}}],"defaultMode":420}},{"name":"rabbitmq-erlang-cookie","emptyDir":{}},{"name":"erlang-cookie-secret","secret":{"secretName":"rabbitmq-cluster-erlang-cookie","defaultMode":420}},{"name":"rabbitmq-plugins","emptyDir":{}},{"name":"pod-info","downwardAPI":{"items":[{"path":"skipPreStopChecks","fieldRef":{"apiVersion":"v1","fieldPath":"metadata.labels['skipPreStopChecks']"}}],"defaultMode":420}}],"initContainers":[{"name":"setup-container","image":"rabbitmq:3.8.12-management","command":["sh","-c","cp /tmp/erlang-cookie-secret/.erlang.cookie /var/lib/rabbitmq/.erlang.cookie \u0026\u0026 chown 999:999 /var/lib/rabbitmq/.erlang.cookie \u0026\u0026 chmod 600 /var/lib/rabbitmq/.erlang.cookie ; cp /tmp/rabbitmq-plugins/enabled_plugins /operator/enabled_plugins \u0026\u0026 chown 999:999 /operator/enabled_plugins ; chown 999:999 /var/lib/rabbitmq/mnesia/ ; echo '[default]' \u003e /var/lib/rabbitmq/.rabbitmqadmin.conf \u0026\u0026 sed -e 's/default_user/username/' -e 's/default_pass/password/' /tmp/default_user.conf \u003e\u003e /var/lib/rabbitmq/.rabbitmqadmin.conf \u0026\u0026 chown 999:999 /var/lib/rabbitmq/.rabbitmqadmin.conf \u0026\u0026 chmod 600 /var/lib/rabbitmq/.rabbitmqadmin.conf"],"resources":{"limits":{"cpu":"100m","memory":"500Mi"},"requests":{"cpu":"100m","memory":"500Mi"}},"volumeMounts":[{"name":"plugins-conf","mountPath":"/tmp/rabbitmq-plugins/"},{"name":"rabbitmq-erlang-cookie","mountPath":"/var/lib/rabbitmq/"},{"name":"erlang-cookie-secret","mountPath":"/tmp/erlang-cookie-secret/"},{"name":"rabbitmq-plugins","mountPath":"/operator"},{"name":"persistence","mountPath":"/var/lib/rabbitmq/mnesia/"},{"name":"rabbitmq-confd","mountPath":"/tmp/default_user.conf","subPath":"default_user.conf"}],"terminationMessagePath":"/dev/termination-log","terminationMessagePolicy":"File","imagePullPolicy":"IfNotPresent","securityContext":{"capabilities":{"drop":["FSETID","KILL","SETGID","SETUID","SETPCAP","NET_BIND_SERVICE","NET_RAW","SYS_CHROOT","MKNOD","AUDIT_WRITE","SETFCAP"]},"runAsUser":0}}],"containers":[{"name":"rabbitmq","image":"rabbitmq:3.8.12-management","ports":[{"name":"epmd","containerPort":4369,"protocol":"TCP"},{"name":"amqp","containerPort":5672,"protocol":"TCP"},{"name":"management","containerPort":15672,"protocol":"TCP"},{"name":"prometheus","containerPort":15692,"protocol":"TCP"}],"env":[{"name":"MY_POD_NAME","valueFrom":{"fieldRef":{"apiVersion":"v1","fieldPath":"metadata.name"}}},{"name":"MY_POD_NAMESPACE","valueFrom":{"fieldRef":{"apiVersion":"v1","fieldPath":"metadata.namespace"}}},{"name":"RABBITMQ_ENABLED_PLUGINS_FILE","value":"/operator/enabled_plugins"},{"name":"K8S_SERVICE_NAME","value":"rabbitmq-cluster-nodes"},{"name":"RABBITMQ_USE_LONGNAME","value":"true"},{"name":"RABBITMQ_NODENAME","value":"rabbit@$(MY_POD_NAME).$(K8S_SERVICE_NAME).$(MY_POD_NAMESPACE)"},{"name":"K8S_HOSTNAME_SUFFIX","value":".$(K8S_SERVICE_NAME).$(MY_POD_NAMESPACE)"}],"resources":{"limits":{"cpu":"2","memory":"2Gi"},"requests":{"cpu":"1","memory":"2Gi"}},"volumeMounts":[{"name":"rabbitmq-erlang-cookie","mountPath":"/var/lib/rabbitmq/"},{"name":"persistence","mountPath":"/var/lib/rabbitmq/mnesia/"},{"name":"rabbitmq-plugins","mountPath":"/operator"},{"name":"rabbitmq-confd","mountPath":"/etc/rabbitmq/conf.d/10-operatorDefaults.conf","subPath":"operatorDefaults.conf"},{"name":"rabbitmq-confd","mountPath":"/etc/rabbitmq/conf.d/11-default_user.conf","subPath":"default_user.conf"},{"name":"rabbitmq-confd","mountPath":"/etc/rabbitmq/conf.d/90-userDefinedConfiguration.conf","subPath":"userDefinedConfiguration.conf"},{"name":"pod-info","mountPath":"/etc/pod-info/"}],"readinessProbe":{"tcpSocket":{"port":"amqp"},"initialDelaySeconds":10,"timeoutSeconds":5,"periodSeconds":10,"successThreshold":1,"failureThreshold":3},"lifecycle":{"preStop":{"exec":{"command":["/bin/bash","-c","if [ ! -z \"$(cat /etc/pod-info/skipPreStopChecks)\" ]; then exit 0; fi; rabbitmq-upgrade await_online_quorum_plus_one -t 604800; rabbitmq-upgrade await_online_synchronized_mirror -t 604800; rabbitmq-upgrade drain -t 604800"]}}},"terminationMessagePath":"/dev/termination-log","terminationMessagePolicy":"File","imagePullPolicy":"IfNotPresent"}],"restartPolicy":"Always","terminationGracePeriodSeconds":604800,"dnsPolicy":"ClusterFirst","serviceAccountName":"rabbitmq-cluster-server","serviceAccount":"rabbitmq-cluster-server","automountServiceAccountToken":true,"securityContext":{"runAsUser":999,"runAsGroup":999,"fsGroup":999},"schedulerName":"default-scheduler","topologySpreadConstraints":[{"maxSkew":1,"topologyKey":"topology.kubernetes.io/zone","whenUnsatisfiable":"ScheduleAnyway","labelSelector":{"matchLabels":{"app.kubernetes.io/name":"rabbitmq-cluster"}}}]}},"volumeClaimTemplates":[{"metadata":{"name":"persistence","namespace":"default","creationTimestamp":null,"labels":{"app.kubernetes.io/component":"rabbitmq","app.kubernetes.io/name":"rabbitmq-cluster","app.kubernetes.io/part-of":"rabbitmq"},"ownerReferences":[{"apiVersion":"rabbitmq.com/v1beta1","kind":"RabbitmqCluster","name":"rabbitmq-cluster","uid":"18d9928b-0d1c-47be-80ec-20960d053827","controller":true,"blockOwnerDeletion":false}]},"spec":{"accessModes":["ReadWriteOnce"],"resources":{"requests":{"storage":"10Gi"}},"volumeMode":"Filesystem"},"status":{"phase":"Pending"}}],"serviceName":"rabbitmq-cluster-nodes","podManagementPolicy":"Parallel","updateStrategy":{"type":"RollingUpdate","rollingUpdate":{"partition":0}},"revisionHistoryLimit":10},"status":{"observedGeneration":2,"replicas":3,"readyReplicas":1,"currentReplicas":3,"updatedReplicas":3,"currentRevision":"rabbitmq-cluster-server-5f8b8665fb","updateRevision":"rabbitmq-cluster-server-5f8b8665fb","collisionCount":0}}
2022/03/18 18:01:53 learn_server.go:256: [SIEVE-BEFORE-WRITE]	47
2022/03/18 18:01:53 learn_server.go:263: [SIEVE-AFTER-WRITE]	47	Update	statefulset	github.com/rabbitmq/cluster-operator/controllers.(*RabbitmqClusterReconciler)	NoError	{"metadata":{"name":"rabbitmq-cluster-server","namespace":"default","selfLink":"/apis/apps/v1/namespaces/default/statefulsets/rabbitmq-cluster-server","uid":"cb5c43bc-6ee7-481c-ab01-6f3acffdd3c8","resourceVersion":"989","generation":2,"creationTimestamp":"2022-03-18T18:00:38Z","labels":{"app.kubernetes.io/component":"rabbitmq","app.kubernetes.io/name":"rabbitmq-cluster","app.kubernetes.io/part-of":"rabbitmq"},"ownerReferences":[{"apiVersion":"rabbitmq.com/v1beta1","kind":"RabbitmqCluster","name":"rabbitmq-cluster","uid":"18d9928b-0d1c-47be-80ec-20960d053827","controller":true,"blockOwnerDeletion":true}],"managedFields":[{"manager":"kube-controller-manager","operation":"Update","apiVersion":"apps/v1","time":"2022-03-18T18:01:23Z","fieldsType":"FieldsV1","fieldsV1":{"f:status":{"f:collisionCount":{},"f:currentReplicas":{},"f:currentRevision":{},"f:observedGeneration":{},"f:readyReplicas":{},"f:replicas":{},"f:updateRevision":{},"f:updatedReplicas":{}}}},{"manager":"manager","operation":"Update","apiVersion":"apps/v1","time":"2022-03-18T18:01:23Z","fieldsType":"FieldsV1","fieldsV1":{"f:metadata":{"f:labels":{".":{},"f:app.kubernetes.io/component":{},"f:app.kubernetes.io/name":{},"f:app.kubernetes.io/part-of":{}},"f:ownerReferences":{".":{},"k:{\"uid\":\"18d9928b-0d1c-47be-80ec-20960d053827\"}":{".":{},"f:apiVersion":{},"f:blockOwnerDeletion":{},"f:controller":{},"f:kind":{},"f:name":{},"f:uid":{}}}},"f:spec":{"f:podManagementPolicy":{},"f:replicas":{},"f:revisionHistoryLimit":{},"f:selector":{"f:matchLabels":{".":{},"f:app.kubernetes.io/name":{}}},"f:serviceName":{},"f:template":{"f:metadata":{"f:annotations":{".":{},"f:prometheus.io/port":{},"f:prometheus.io/scrape":{}},"f:labels":{".":{},"f:app.kubernetes.io/component":{},"f:app.kubernetes.io/name":{},"f:app.kubernetes.io/part-of":{}}},"f:spec":{"f:automountServiceAccountToken":{},"f:containers":{"k:{\"name\":\"rabbitmq\"}":{".":{},"f:env":{".":{},"k:{\"name\":\"K8S_HOSTNAME_SUFFIX\"}":{".":{},"f:name":{},"f:value":{}},"k:{\"name\":\"K8S_SERVICE_NAME\"}":{".":{},"f:name":{},"f:value":{}},"k:{\"name\":\"MY_POD_NAME\"}":{".":{},"f:name":{},"f:valueFrom":{".":{},"f:fieldRef":{".":{},"f:apiVersion":{},"f:fieldPath":{}}}},"k:{\"name\":\"MY_POD_NAMESPACE\"}":{".":{},"f:name":{},"f:valueFrom":{".":{},"f:fieldRef":{".":{},"f:apiVersion":{},"f:fieldPath":{}}}},"k:{\"name\":\"RABBITMQ_ENABLED_PLUGINS_FILE\"}":{".":{},"f:name":{},"f:value":{}},"k:{\"name\":\"RABBITMQ_NODENAME\"}":{".":{},"f:name":{},"f:value":{}},"k:{\"name\":\"RABBITMQ_USE_LONGNAME\"}":{".":{},"f:name":{},"f:value":{}}},"f:image":{},"f:imagePullPolicy":{},"f:lifecycle":{".":{},"f:preStop":{".":{},"f:exec":{".":{},"f:command":{}}}},"f:name":{},"f:ports":{".":{},"k:{\"containerPort\":4369,\"protocol\":\"TCP\"}":{".":{},"f:containerPort":{},"f:name":{},"f:protocol":{}},"k:{\"containerPort\":5672,\"protocol\":\"TCP\"}":{".":{},"f:containerPort":{},"f:name":{},"f:protocol":{}},"k:{\"containerPort\":15672,\"protocol\":\"TCP\"}":{".":{},"f:containerPort":{},"f:name":{},"f:protocol":{}},"k:{\"containerPort\":15692,\"protocol\":\"TCP\"}":{".":{},"f:containerPort":{},"f:name":{},"f:protocol":{}}},"f:readinessProbe":{".":{},"f:failureThreshold":{},"f:initialDelaySeconds":{},"f:periodSeconds":{},"f:successThreshold":{},"f:tcpSocket":{".":{},"f:port":{}},"f:timeoutSeconds":{}},"f:resources":{".":{},"f:limits":{".":{},"f:cpu":{},"f:memory":{}},"f:requests":{".":{},"f:cpu":{},"f:memory":{}}},"f:terminationMessagePath":{},"f:terminationMessagePolicy":{},"f:volumeMounts":{".":{},"k:{\"mountPath\":\"/etc/pod-info/\"}":{".":{},"f:mountPath":{},"f:name":{}},"k:{\"mountPath\":\"/etc/rabbitmq/conf.d/10-operatorDefaults.conf\"}":{".":{},"f:mountPath":{},"f:name":{},"f:subPath":{}},"k:{\"mountPath\":\"/etc/rabbitmq/conf.d/11-default_user.conf\"}":{".":{},"f:mountPath":{},"f:name":{},"f:subPath":{}},"k:{\"mountPath\":\"/etc/rabbitmq/conf.d/90-userDefinedConfiguration.conf\"}":{".":{},"f:mountPath":{},"f:name":{},"f:subPath":{}},"k:{\"mountPath\":\"/operator\"}":{".":{},"f:mountPath":{},"f:name":{}},"k:{\"mountPath\":\"/var/lib/rabbitmq/\"}":{".":{},"f:mountPath":{},"f:name":{}},"k:{\"mountPath\":\"/var/lib/rabbitmq/mnesia/\"}":{".":{},"f:mountPath":{},"f:name":{}}}}},"f:dnsPolicy":{},"f:initContainers":{".":{},"k:{\"name\":\"setup-container\"}":{".":{},"f:command":{},"f:image":{},"f:imagePullPolicy":{},"f:name":{},"f:resources":{".":{},"f:limits":{".":{},"f:cpu":{},"f:memory":{}},"f:requests":{".":{},"f:cpu":{},"f:memory":{}}},"f:securityContext":{".":{},"f:capabilities":{".":{},"f:drop":{}},"f:runAsUser":{}},"f:terminationMessagePath":{},"f:terminationMessagePolicy":{},"f:volumeMounts":{".":{},"k:{\"mountPath\":\"/operator\"}":{".":{},"f:mountPath":{},"f:name":{}},"k:{\"mountPath\":\"/tmp/default_user.conf\"}":{".":{},"f:mountPath":{},"f:name":{},"f:subPath":{}},"k:{\"mountPath\":\"/tmp/erlang-cookie-secret/\"}":{".":{},"f:mountPath":{},"f:name":{}},"k:{\"mountPath\":\"/tmp/rabbitmq-plugins/\"}":{".":{},"f:mountPath":{},"f:name":{}},"k:{\"mountPath\":\"/var/lib/rabbitmq/\"}":{".":{},"f:mountPath":{},"f:name":{}},"k:{\"mountPath\":\"/var/lib/rabbitmq/mnesia/\"}":{".":{},"f:mountPath":{},"f:name":{}}}}},"f:restartPolicy":{},"f:schedulerName":{},"f:securityContext":{".":{},"f:fsGroup":{},"f:runAsGroup":{},"f:runAsUser":{}},"f:serviceAccount":{},"f:serviceAccountName":{},"f:terminationGracePeriodSeconds":{},"f:topologySpreadConstraints":{".":{},"k:{\"topologyKey\":\"topology.kubernetes.io/zone\",\"whenUnsatisfiable\":\"ScheduleAnyway\"}":{".":{},"f:labelSelector":{".":{},"f:matchLabels":{".":{},"f:app.kubernetes.io/name":{}}},"f:maxSkew":{},"f:topologyKey":{},"f:whenUnsatisfiable":{}}},"f:volumes":{".":{},"k:{\"name\":\"erlang-cookie-secret\"}":{".":{},"f:name":{},"f:secret":{".":{},"f:defaultMode":{},"f:secretName":{}}},"k:{\"name\":\"plugins-conf\"}":{".":{},"f:configMap":{".":{},"f:defaultMode":{},"f:name":{}},"f:name":{}},"k:{\"name\":\"pod-info\"}":{".":{},"f:downwardAPI":{".":{},"f:defaultMode":{},"f:items":{}},"f:name":{}},"k:{\"name\":\"rabbitmq-confd\"}":{".":{},"f:name":{},"f:projected":{".":{},"f:defaultMode":{},"f:sources":{}}},"k:{\"name\":\"rabbitmq-erlang-cookie\"}":{".":{},"f:emptyDir":{},"f:name":{}},"k:{\"name\":\"rabbitmq-plugins\"}":{".":{},"f:emptyDir":{},"f:name":{}}}}},"f:updateStrategy":{"f:rollingUpdate":{".":{},"f:partition":{}},"f:type":{}},"f:volumeClaimTemplates":{}}}}]},"spec":{"replicas":3,"selector":{"matchLabels":{"app.kubernetes.io/name":"rabbitmq-cluster"}},"template":{"metadata":{"creationTimestamp":null,"labels":{"app.kubernetes.io/component":"rabbitmq","app.kubernetes.io/name":"rabbitmq-cluster","app.kubernetes.io/part-of":"rabbitmq"},"annotations":{"prometheus.io/port":"15692","prometheus.io/scrape":"true"}},"spec":{"volumes":[{"name":"plugins-conf","configMap":{"name":"rabbitmq-cluster-plugins-conf","defaultMode":420}},{"name":"rabbitmq-confd","projected":{"sources":[{"secret":{"name":"rabbitmq-cluster-default-user","items":[{"key":"default_user.conf","path":"default_user.conf"}]}},{"configMap":{"name":"rabbitmq-cluster-server-conf","items":[{"key":"operatorDefaults.conf","path":"operatorDefaults.conf"},{"key":"userDefinedConfiguration.conf","path":"userDefinedConfiguration.conf"}]}}],"defaultMode":420}},{"name":"rabbitmq-erlang-cookie","emptyDir":{}},{"name":"erlang-cookie-secret","secret":{"secretName":"rabbitmq-cluster-erlang-cookie","defaultMode":420}},{"name":"rabbitmq-plugins","emptyDir":{}},{"name":"pod-info","downwardAPI":{"items":[{"path":"skipPreStopChecks","fieldRef":{"apiVersion":"v1","fieldPath":"metadata.labels['skipPreStopChecks']"}}],"defaultMode":420}}],"initContainers":[{"name":"setup-container","image":"rabbitmq:3.8.12-management","command":["sh","-c","cp /tmp/erlang-cookie-secret/.erlang.cookie /var/lib/rabbitmq/.erlang.cookie \u0026\u0026 chown 999:999 /var/lib/rabbitmq/.erlang.cookie \u0026\u0026 chmod 600 /var/lib/rabbitmq/.erlang.cookie ; cp /tmp/rabbitmq-plugins/enabled_plugins /operator/enabled_plugins \u0026\u0026 chown 999:999 /operator/enabled_plugins ; chown 999:999 /var/lib/rabbitmq/mnesia/ ; echo '[default]' \u003e /var/lib/rabbitmq/.rabbitmqadmin.conf \u0026\u0026 sed -e 's/default_user/username/' -e 's/default_pass/password/' /tmp/default_user.conf \u003e\u003e /var/lib/rabbitmq/.rabbitmqadmin.conf \u0026\u0026 chown 999:999 /var/lib/rabbitmq/.rabbitmqadmin.conf \u0026\u0026 chmod 600 /var/lib/rabbitmq/.rabbitmqadmin.conf"],"resources":{"limits":{"cpu":"100m","memory":"500Mi"},"requests":{"cpu":"100m","memory":"500Mi"}},"volumeMounts":[{"name":"plugins-conf","mountPath":"/tmp/rabbitmq-plugins/"},{"name":"rabbitmq-erlang-cookie","mountPath":"/var/lib/rabbitmq/"},{"name":"erlang-cookie-secret","mountPath":"/tmp/erlang-cookie-secret/"},{"name":"rabbitmq-plugins","mountPath":"/operator"},{"name":"persistence","mountPath":"/var/lib/rabbitmq/mnesia/"},{"name":"rabbitmq-confd","mountPath":"/tmp/default_user.conf","subPath":"default_user.conf"}],"terminationMessagePath":"/dev/termination-log","terminationMessagePolicy":"File","imagePullPolicy":"IfNotPresent","securityContext":{"capabilities":{"drop":["FSETID","KILL","SETGID","SETUID","SETPCAP","NET_BIND_SERVICE","NET_RAW","SYS_CHROOT","MKNOD","AUDIT_WRITE","SETFCAP"]},"runAsUser":0}}],"containers":[{"name":"rabbitmq","image":"rabbitmq:3.8.12-management","ports":[{"name":"epmd","containerPort":4369,"protocol":"TCP"},{"name":"amqp","containerPort":5672,"protocol":"TCP"},{"name":"management","containerPort":15672,"protocol":"TCP"},{"name":"prometheus","containerPort":15692,"protocol":"TCP"}],"env":[{"name":"MY_POD_NAME","valueFrom":{"fieldRef":{"apiVersion":"v1","fieldPath":"metadata.name"}}},{"name":"MY_POD_NAMESPACE","valueFrom":{"fieldRef":{"apiVersion":"v1","fieldPath":"metadata.namespace"}}},{"name":"RABBITMQ_ENABLED_PLUGINS_FILE","value":"/operator/enabled_plugins"},{"name":"K8S_SERVICE_NAME","value":"rabbitmq-cluster-nodes"},{"name":"RABBITMQ_USE_LONGNAME","value":"true"},{"name":"RABBITMQ_NODENAME","value":"rabbit@$(MY_POD_NAME).$(K8S_SERVICE_NAME).$(MY_POD_NAMESPACE)"},{"name":"K8S_HOSTNAME_SUFFIX","value":".$(K8S_SERVICE_NAME).$(MY_POD_NAMESPACE)"}],"resources":{"limits":{"cpu":"2","memory":"2Gi"},"requests":{"cpu":"1","memory":"2Gi"}},"volumeMounts":[{"name":"rabbitmq-erlang-cookie","mountPath":"/var/lib/rabbitmq/"},{"name":"persistence","mountPath":"/var/lib/rabbitmq/mnesia/"},{"name":"rabbitmq-plugins","mountPath":"/operator"},{"name":"rabbitmq-confd","mountPath":"/etc/rabbitmq/conf.d/10-operatorDefaults.conf","subPath":"operatorDefaults.conf"},{"name":"rabbitmq-confd","mountPath":"/etc/rabbitmq/conf.d/11-default_user.conf","subPath":"default_user.conf"},{"name":"rabbitmq-confd","mountPath":"/etc/rabbitmq/conf.d/90-userDefinedConfiguration.conf","subPath":"userDefinedConfiguration.conf"},{"name":"pod-info","mountPath":"/etc/pod-info/"}],"readinessProbe":{"tcpSocket":{"port":"amqp"},"initialDelaySeconds":10,"timeoutSeconds":5,"periodSeconds":10,"successThreshold":1,"failureThreshold":3},"lifecycle":{"preStop":{"exec":{"command":["/bin/bash","-c","if [ ! -z \"$(cat /etc/pod-info/skipPreStopChecks)\" ]; then exit 0; fi; rabbitmq-upgrade await_online_quorum_plus_one -t 604800; rabbitmq-upgrade await_online_synchronized_mirror -t 604800; rabbitmq-upgrade drain -t 604800"]}}},"terminationMessagePath":"/dev/termination-log","terminationMessagePolicy":"File","imagePullPolicy":"IfNotPresent"}],"restartPolicy":"Always","terminationGracePeriodSeconds":604800,"dnsPolicy":"ClusterFirst","serviceAccountName":"rabbitmq-cluster-server","serviceAccount":"rabbitmq-cluster-server","automountServiceAccountToken":true,"securityContext":{"runAsUser":999,"runAsGroup":999,"fsGroup":999},"schedulerName":"default-scheduler","topologySpreadConstraints":[{"maxSkew":1,"topologyKey":"topology.kubernetes.io/zone","whenUnsatisfiable":"ScheduleAnyway","labelSelector":{"matchLabels":{"app.kubernetes.io/name":"rabbitmq-cluster"}}}]}},"volumeClaimTemplates":[{"metadata":{"name":"persistence","namespace":"default","creationTimestamp":null,"labels":{"app.kubernetes.io/component":"rabbitmq","app.kubernetes.io/name":"rabbitmq-cluster","app.kubernetes.io/part-of":"rabbitmq"},"ownerReferences":[{"apiVersion":"rabbitmq.com/v1beta1","kind":"RabbitmqCluster","name":"rabbitmq-cluster","uid":"18d9928b-0d1c-47be-80ec-20960d053827","controller":true,"blockOwnerDeletion":false}]},"spec":{"accessModes":["ReadWriteOnce"],"resources":{"requests":{"storage":"10Gi"}},"volumeMode":"Filesystem"},"status":{"phase":"Pending"}}],"serviceName":"rabbitmq-cluster-nodes","podManagementPolicy":"Parallel","updateStrategy":{"type":"RollingUpdate","rollingUpdate":{"partition":0}},"revisionHistoryLimit":10},"status":{"observedGeneration":2,"replicas":3,"readyReplicas":1,"currentReplicas":3,"updatedReplicas":3,"currentRevision":"rabbitmq-cluster-server-5f8b8665fb","updateRevision":"rabbitmq-cluster-server-5f8b8665fb","collisionCount":0}}
2022/03/18 18:01:53 learn_server.go:291: [SIEVE-AFTER-READ]	Get	true	configmap	default	rabbitmq-cluster-server-conf	github.com/rabbitmq/cluster-operator/controllers.(*RabbitmqClusterReconciler)	NoError	{"kind":"ConfigMap","apiVersion":"v1","metadata":{"name":"rabbitmq-cluster-server-conf","namespace":"default","selfLink":"/api/v1/namespaces/default/configmaps/rabbitmq-cluster-server-conf","uid":"22474f2b-8454-44b7-8079-8990223969cc","resourceVersion":"714","creationTimestamp":"2022-03-18T18:00:38Z","labels":{"app.kubernetes.io/component":"rabbitmq","app.kubernetes.io/name":"rabbitmq-cluster","app.kubernetes.io/part-of":"rabbitmq"},"ownerReferences":[{"apiVersion":"rabbitmq.com/v1beta1","kind":"RabbitmqCluster","name":"rabbitmq-cluster","uid":"18d9928b-0d1c-47be-80ec-20960d053827","controller":true,"blockOwnerDeletion":true}],"managedFields":[{"manager":"manager","operation":"Update","apiVersion":"v1","time":"2022-03-18T18:00:38Z","fieldsType":"FieldsV1","fieldsV1":{"f:data":{".":{},"f:operatorDefaults.conf":{},"f:userDefinedConfiguration.conf":{}},"f:metadata":{"f:labels":{".":{},"f:app.kubernetes.io/component":{},"f:app.kubernetes.io/name":{},"f:app.kubernetes.io/part-of":{}},"f:ownerReferences":{".":{},"k:{\"uid\":\"18d9928b-0d1c-47be-80ec-20960d053827\"}":{".":{},"f:apiVersion":{},"f:blockOwnerDeletion":{},"f:controller":{},"f:kind":{},"f:name":{},"f:uid":{}}}}}}]},"data":{"operatorDefaults.conf":"cluster_formation.peer_discovery_backend             = rabbit_peer_discovery_k8s\ncluster_formation.k8s.host                           = kubernetes.default\ncluster_formation.k8s.address_type                   = hostname\ncluster_partition_handling                           = pause_minority\nqueue_master_locator                                 = min-masters\ndisk_free_limit.absolute                             = 2GB\ncluster_formation.randomized_startup_delay_range.min = 5\ncluster_formation.randomized_startup_delay_range.max = 30\ncluster_name                                         = rabbitmq-cluster\n","userDefinedConfiguration.conf":"total_memory_available_override_value = 1717986919\n"}}
2022/03/18 18:01:53 learn_server.go:256: [SIEVE-BEFORE-WRITE]	48
2022/03/18 18:01:53 learn_server.go:263: [SIEVE-AFTER-WRITE]	48	StatusUpdate	rabbitmqcluster	github.com/rabbitmq/cluster-operator/controllers.(*RabbitmqClusterReconciler)	NoError	{"metadata":{"name":"rabbitmq-cluster","namespace":"default","selfLink":"/apis/rabbitmq.com/v1beta1/namespaces/default/rabbitmqclusters/rabbitmq-cluster/status","uid":"18d9928b-0d1c-47be-80ec-20960d053827","resourceVersion":"977","generation":3,"creationTimestamp":"2022-03-18T18:00:38Z","annotations":{"kubectl.kubernetes.io/last-applied-configuration":"{\"apiVersion\":\"rabbitmq.com/v1beta1\",\"kind\":\"RabbitmqCluster\",\"metadata\":{\"annotations\":{},\"name\":\"rabbitmq-cluster\",\"namespace\":\"default\"},\"spec\":{\"persistence\":{\"storage\":\"10Gi\"},\"replicas\":1}}\n"},"finalizers":["deletion.finalizers.rabbitmqclusters.rabbitmq.com"],"managedFields":[{"manager":"kubectl-client-side-apply","operation":"Update","apiVersion":"rabbitmq.com/v1beta1","time":"2022-03-18T18:00:38Z","fieldsType":"FieldsV1","fieldsV1":{"f:metadata":{"f:annotations":{".":{},"f:kubectl.kubernetes.io/last-applied-configuration":{}}},"f:spec":{".":{},"f:image":{},"f:persistence":{".":{},"f:storage":{}},"f:resources":{".":{},"f:limits":{".":{},"f:memory":{}},"f:requests":{".":{},"f:memory":{}}},"f:service":{".":{},"f:type":{}},"f:terminationGracePeriodSeconds":{}}}},{"manager":"kubectl-patch","operation":"Update","apiVersion":"rabbitmq.com/v1beta1","time":"2022-03-18T18:01:23Z","fieldsType":"FieldsV1","fieldsV1":{"f:spec":{"f:replicas":{}}}},{"manager":"manager","operation":"Update","apiVersion":"rabbitmq.com/v1beta1","time":"2022-03-18T18:01:23Z","fieldsType":"FieldsV1","fieldsV1":{"f:metadata":{"f:finalizers":{}},"f:spec":{"f:override":{},"f:rabbitmq":{},"f:resources":{"f:limits":{"f:cpu":{}},"f:requests":{"f:cpu":{}}},"f:tls":{}},"f:status":{".":{},"f:conditions":{},"f:defaultUser":{".":{},"f:secretReference":{".":{},"f:keys":{".":{},"f:password":{},"f:username":{}},"f:name":{},"f:namespace":{}},"f:serviceReference":{".":{},"f:name":{},"f:namespace":{}}}}}}]},"spec":{"replicas":3,"image":"rabbitmq:3.8.12-management","service":{"type":"ClusterIP"},"persistence":{"storage":"10Gi"},"resources":{"limits":{"cpu":"2","memory":"2Gi"},"requests":{"cpu":"1","memory":"2Gi"}},"rabbitmq":{},"tls":{},"override":{},"terminationGracePeriodSeconds":604800},"status":{"conditions":[{"type":"AllReplicasReady","status":"False","lastTransitionTime":"2022-03-18T18:01:23Z","reason":"NotAllPodsReady","message":"1/3 Pods ready"},{"type":"ClusterAvailable","status":"True","lastTransitionTime":"2022-03-18T18:01:17Z","reason":"AtLeastOneEndpointAvailable"},{"type":"NoWarnings","status":"True","lastTransitionTime":"2022-03-18T18:00:38Z","reason":"NoWarnings"},{"type":"ReconcileSuccess","status":"True","lastTransitionTime":"2022-03-18T18:01:18Z","reason":"Success","message":"Finish reconciling"}],"defaultUser":{"secretReference":{"name":"rabbitmq-cluster-default-user","namespace":"default","keys":{"password":"password","username":"username"}},"serviceReference":{"name":"rabbitmq-cluster","namespace":"default"}},"binding":{"name":"rabbitmq-cluster-default-user"}}}
2022/03/18 18:01:53 learn_server.go:291: [SIEVE-AFTER-READ]	Get	true	statefulset	default	rabbitmq-cluster-server	github.com/rabbitmq/cluster-operator/controllers.(*RabbitmqClusterReconciler)	NoError	{"kind":"StatefulSet","apiVersion":"apps/v1","metadata":{"name":"rabbitmq-cluster-server","namespace":"default","selfLink":"/apis/apps/v1/namespaces/default/statefulsets/rabbitmq-cluster-server","uid":"cb5c43bc-6ee7-481c-ab01-6f3acffdd3c8","resourceVersion":"989","generation":2,"creationTimestamp":"2022-03-18T18:00:38Z","labels":{"app.kubernetes.io/component":"rabbitmq","app.kubernetes.io/name":"rabbitmq-cluster","app.kubernetes.io/part-of":"rabbitmq"},"ownerReferences":[{"apiVersion":"rabbitmq.com/v1beta1","kind":"RabbitmqCluster","name":"rabbitmq-cluster","uid":"18d9928b-0d1c-47be-80ec-20960d053827","controller":true,"blockOwnerDeletion":true}],"managedFields":[{"manager":"kube-controller-manager","operation":"Update","apiVersion":"apps/v1","time":"2022-03-18T18:01:23Z","fieldsType":"FieldsV1","fieldsV1":{"f:status":{"f:collisionCount":{},"f:currentReplicas":{},"f:currentRevision":{},"f:observedGeneration":{},"f:readyReplicas":{},"f:replicas":{},"f:updateRevision":{},"f:updatedReplicas":{}}}},{"manager":"manager","operation":"Update","apiVersion":"apps/v1","time":"2022-03-18T18:01:23Z","fieldsType":"FieldsV1","fieldsV1":{"f:metadata":{"f:labels":{".":{},"f:app.kubernetes.io/component":{},"f:app.kubernetes.io/name":{},"f:app.kubernetes.io/part-of":{}},"f:ownerReferences":{".":{},"k:{\"uid\":\"18d9928b-0d1c-47be-80ec-20960d053827\"}":{".":{},"f:apiVersion":{},"f:blockOwnerDeletion":{},"f:controller":{},"f:kind":{},"f:name":{},"f:uid":{}}}},"f:spec":{"f:podManagementPolicy":{},"f:replicas":{},"f:revisionHistoryLimit":{},"f:selector":{"f:matchLabels":{".":{},"f:app.kubernetes.io/name":{}}},"f:serviceName":{},"f:template":{"f:metadata":{"f:annotations":{".":{},"f:prometheus.io/port":{},"f:prometheus.io/scrape":{}},"f:labels":{".":{},"f:app.kubernetes.io/component":{},"f:app.kubernetes.io/name":{},"f:app.kubernetes.io/part-of":{}}},"f:spec":{"f:automountServiceAccountToken":{},"f:containers":{"k:{\"name\":\"rabbitmq\"}":{".":{},"f:env":{".":{},"k:{\"name\":\"K8S_HOSTNAME_SUFFIX\"}":{".":{},"f:name":{},"f:value":{}},"k:{\"name\":\"K8S_SERVICE_NAME\"}":{".":{},"f:name":{},"f:value":{}},"k:{\"name\":\"MY_POD_NAME\"}":{".":{},"f:name":{},"f:valueFrom":{".":{},"f:fieldRef":{".":{},"f:apiVersion":{},"f:fieldPath":{}}}},"k:{\"name\":\"MY_POD_NAMESPACE\"}":{".":{},"f:name":{},"f:valueFrom":{".":{},"f:fieldRef":{".":{},"f:apiVersion":{},"f:fieldPath":{}}}},"k:{\"name\":\"RABBITMQ_ENABLED_PLUGINS_FILE\"}":{".":{},"f:name":{},"f:value":{}},"k:{\"name\":\"RABBITMQ_NODENAME\"}":{".":{},"f:name":{},"f:value":{}},"k:{\"name\":\"RABBITMQ_USE_LONGNAME\"}":{".":{},"f:name":{},"f:value":{}}},"f:image":{},"f:imagePullPolicy":{},"f:lifecycle":{".":{},"f:preStop":{".":{},"f:exec":{".":{},"f:command":{}}}},"f:name":{},"f:ports":{".":{},"k:{\"containerPort\":4369,\"protocol\":\"TCP\"}":{".":{},"f:containerPort":{},"f:name":{},"f:protocol":{}},"k:{\"containerPort\":5672,\"protocol\":\"TCP\"}":{".":{},"f:containerPort":{},"f:name":{},"f:protocol":{}},"k:{\"containerPort\":15672,\"protocol\":\"TCP\"}":{".":{},"f:containerPort":{},"f:name":{},"f:protocol":{}},"k:{\"containerPort\":15692,\"protocol\":\"TCP\"}":{".":{},"f:containerPort":{},"f:name":{},"f:protocol":{}}},"f:readinessProbe":{".":{},"f:failureThreshold":{},"f:initialDelaySeconds":{},"f:periodSeconds":{},"f:successThreshold":{},"f:tcpSocket":{".":{},"f:port":{}},"f:timeoutSeconds":{}},"f:resources":{".":{},"f:limits":{".":{},"f:cpu":{},"f:memory":{}},"f:requests":{".":{},"f:cpu":{},"f:memory":{}}},"f:terminationMessagePath":{},"f:terminationMessagePolicy":{},"f:volumeMounts":{".":{},"k:{\"mountPath\":\"/etc/pod-info/\"}":{".":{},"f:mountPath":{},"f:name":{}},"k:{\"mountPath\":\"/etc/rabbitmq/conf.d/10-operatorDefaults.conf\"}":{".":{},"f:mountPath":{},"f:name":{},"f:subPath":{}},"k:{\"mountPath\":\"/etc/rabbitmq/conf.d/11-default_user.conf\"}":{".":{},"f:mountPath":{},"f:name":{},"f:subPath":{}},"k:{\"mountPath\":\"/etc/rabbitmq/conf.d/90-userDefinedConfiguration.conf\"}":{".":{},"f:mountPath":{},"f:name":{},"f:subPath":{}},"k:{\"mountPath\":\"/operator\"}":{".":{},"f:mountPath":{},"f:name":{}},"k:{\"mountPath\":\"/var/lib/rabbitmq/\"}":{".":{},"f:mountPath":{},"f:name":{}},"k:{\"mountPath\":\"/var/lib/rabbitmq/mnesia/\"}":{".":{},"f:mountPath":{},"f:name":{}}}}},"f:dnsPolicy":{},"f:initContainers":{".":{},"k:{\"name\":\"setup-container\"}":{".":{},"f:command":{},"f:image":{},"f:imagePullPolicy":{},"f:name":{},"f:resources":{".":{},"f:limits":{".":{},"f:cpu":{},"f:memory":{}},"f:requests":{".":{},"f:cpu":{},"f:memory":{}}},"f:securityContext":{".":{},"f:capabilities":{".":{},"f:drop":{}},"f:runAsUser":{}},"f:terminationMessagePath":{},"f:terminationMessagePolicy":{},"f:volumeMounts":{".":{},"k:{\"mountPath\":\"/operator\"}":{".":{},"f:mountPath":{},"f:name":{}},"k:{\"mountPath\":\"/tmp/default_user.conf\"}":{".":{},"f:mountPath":{},"f:name":{},"f:subPath":{}},"k:{\"mountPath\":\"/tmp/erlang-cookie-secret/\"}":{".":{},"f:mountPath":{},"f:name":{}},"k:{\"mountPath\":\"/tmp/rabbitmq-plugins/\"}":{".":{},"f:mountPath":{},"f:name":{}},"k:{\"mountPath\":\"/var/lib/rabbitmq/\"}":{".":{},"f:mountPath":{},"f:name":{}},"k:{\"mountPath\":\"/var/lib/rabbitmq/mnesia/\"}":{".":{},"f:mountPath":{},"f:name":{}}}}},"f:restartPolicy":{},"f:schedulerName":{},"f:securityContext":{".":{},"f:fsGroup":{},"f:runAsGroup":{},"f:runAsUser":{}},"f:serviceAccount":{},"f:serviceAccountName":{},"f:terminationGracePeriodSeconds":{},"f:topologySpreadConstraints":{".":{},"k:{\"topologyKey\":\"topology.kubernetes.io/zone\",\"whenUnsatisfiable\":\"ScheduleAnyway\"}":{".":{},"f:labelSelector":{".":{},"f:matchLabels":{".":{},"f:app.kubernetes.io/name":{}}},"f:maxSkew":{},"f:topologyKey":{},"f:whenUnsatisfiable":{}}},"f:volumes":{".":{},"k:{\"name\":\"erlang-cookie-secret\"}":{".":{},"f:name":{},"f:secret":{".":{},"f:defaultMode":{},"f:secretName":{}}},"k:{\"name\":\"plugins-conf\"}":{".":{},"f:configMap":{".":{},"f:defaultMode":{},"f:name":{}},"f:name":{}},"k:{\"name\":\"pod-info\"}":{".":{},"f:downwardAPI":{".":{},"f:defaultMode":{},"f:items":{}},"f:name":{}},"k:{\"name\":\"rabbitmq-confd\"}":{".":{},"f:name":{},"f:projected":{".":{},"f:defaultMode":{},"f:sources":{}}},"k:{\"name\":\"rabbitmq-erlang-cookie\"}":{".":{},"f:emptyDir":{},"f:name":{}},"k:{\"name\":\"rabbitmq-plugins\"}":{".":{},"f:emptyDir":{},"f:name":{}}}}},"f:updateStrategy":{"f:rollingUpdate":{".":{},"f:partition":{}},"f:type":{}},"f:volumeClaimTemplates":{}}}}]},"spec":{"replicas":3,"selector":{"matchLabels":{"app.kubernetes.io/name":"rabbitmq-cluster"}},"template":{"metadata":{"creationTimestamp":null,"labels":{"app.kubernetes.io/component":"rabbitmq","app.kubernetes.io/name":"rabbitmq-cluster","app.kubernetes.io/part-of":"rabbitmq"},"annotations":{"prometheus.io/port":"15692","prometheus.io/scrape":"true"}},"spec":{"volumes":[{"name":"plugins-conf","configMap":{"name":"rabbitmq-cluster-plugins-conf","defaultMode":420}},{"name":"rabbitmq-confd","projected":{"sources":[{"secret":{"name":"rabbitmq-cluster-default-user","items":[{"key":"default_user.conf","path":"default_user.conf"}]}},{"configMap":{"name":"rabbitmq-cluster-server-conf","items":[{"key":"operatorDefaults.conf","path":"operatorDefaults.conf"},{"key":"userDefinedConfiguration.conf","path":"userDefinedConfiguration.conf"}]}}],"defaultMode":420}},{"name":"rabbitmq-erlang-cookie","emptyDir":{}},{"name":"erlang-cookie-secret","secret":{"secretName":"rabbitmq-cluster-erlang-cookie","defaultMode":420}},{"name":"rabbitmq-plugins","emptyDir":{}},{"name":"pod-info","downwardAPI":{"items":[{"path":"skipPreStopChecks","fieldRef":{"apiVersion":"v1","fieldPath":"metadata.labels['skipPreStopChecks']"}}],"defaultMode":420}}],"initContainers":[{"name":"setup-container","image":"rabbitmq:3.8.12-management","command":["sh","-c","cp /tmp/erlang-cookie-secret/.erlang.cookie /var/lib/rabbitmq/.erlang.cookie \u0026\u0026 chown 999:999 /var/lib/rabbitmq/.erlang.cookie \u0026\u0026 chmod 600 /var/lib/rabbitmq/.erlang.cookie ; cp /tmp/rabbitmq-plugins/enabled_plugins /operator/enabled_plugins \u0026\u0026 chown 999:999 /operator/enabled_plugins ; chown 999:999 /var/lib/rabbitmq/mnesia/ ; echo '[default]' \u003e /var/lib/rabbitmq/.rabbitmqadmin.conf \u0026\u0026 sed -e 's/default_user/username/' -e 's/default_pass/password/' /tmp/default_user.conf \u003e\u003e /var/lib/rabbitmq/.rabbitmqadmin.conf \u0026\u0026 chown 999:999 /var/lib/rabbitmq/.rabbitmqadmin.conf \u0026\u0026 chmod 600 /var/lib/rabbitmq/.rabbitmqadmin.conf"],"resources":{"limits":{"cpu":"100m","memory":"500Mi"},"requests":{"cpu":"100m","memory":"500Mi"}},"volumeMounts":[{"name":"plugins-conf","mountPath":"/tmp/rabbitmq-plugins/"},{"name":"rabbitmq-erlang-cookie","mountPath":"/var/lib/rabbitmq/"},{"name":"erlang-cookie-secret","mountPath":"/tmp/erlang-cookie-secret/"},{"name":"rabbitmq-plugins","mountPath":"/operator"},{"name":"persistence","mountPath":"/var/lib/rabbitmq/mnesia/"},{"name":"rabbitmq-confd","mountPath":"/tmp/default_user.conf","subPath":"default_user.conf"}],"terminationMessagePath":"/dev/termination-log","terminationMessagePolicy":"File","imagePullPolicy":"IfNotPresent","securityContext":{"capabilities":{"drop":["FSETID","KILL","SETGID","SETUID","SETPCAP","NET_BIND_SERVICE","NET_RAW","SYS_CHROOT","MKNOD","AUDIT_WRITE","SETFCAP"]},"runAsUser":0}}],"containers":[{"name":"rabbitmq","image":"rabbitmq:3.8.12-management","ports":[{"name":"epmd","containerPort":4369,"protocol":"TCP"},{"name":"amqp","containerPort":5672,"protocol":"TCP"},{"name":"management","containerPort":15672,"protocol":"TCP"},{"name":"prometheus","containerPort":15692,"protocol":"TCP"}],"env":[{"name":"MY_POD_NAME","valueFrom":{"fieldRef":{"apiVersion":"v1","fieldPath":"metadata.name"}}},{"name":"MY_POD_NAMESPACE","valueFrom":{"fieldRef":{"apiVersion":"v1","fieldPath":"metadata.namespace"}}},{"name":"RABBITMQ_ENABLED_PLUGINS_FILE","value":"/operator/enabled_plugins"},{"name":"K8S_SERVICE_NAME","value":"rabbitmq-cluster-nodes"},{"name":"RABBITMQ_USE_LONGNAME","value":"true"},{"name":"RABBITMQ_NODENAME","value":"rabbit@$(MY_POD_NAME).$(K8S_SERVICE_NAME).$(MY_POD_NAMESPACE)"},{"name":"K8S_HOSTNAME_SUFFIX","value":".$(K8S_SERVICE_NAME).$(MY_POD_NAMESPACE)"}],"resources":{"limits":{"cpu":"2","memory":"2Gi"},"requests":{"cpu":"1","memory":"2Gi"}},"volumeMounts":[{"name":"rabbitmq-erlang-cookie","mountPath":"/var/lib/rabbitmq/"},{"name":"persistence","mountPath":"/var/lib/rabbitmq/mnesia/"},{"name":"rabbitmq-plugins","mountPath":"/operator"},{"name":"rabbitmq-confd","mountPath":"/etc/rabbitmq/conf.d/10-operatorDefaults.conf","subPath":"operatorDefaults.conf"},{"name":"rabbitmq-confd","mountPath":"/etc/rabbitmq/conf.d/11-default_user.conf","subPath":"default_user.conf"},{"name":"rabbitmq-confd","mountPath":"/etc/rabbitmq/conf.d/90-userDefinedConfiguration.conf","subPath":"userDefinedConfiguration.conf"},{"name":"pod-info","mountPath":"/etc/pod-info/"}],"readinessProbe":{"tcpSocket":{"port":"amqp"},"initialDelaySeconds":10,"timeoutSeconds":5,"periodSeconds":10,"successThreshold":1,"failureThreshold":3},"lifecycle":{"preStop":{"exec":{"command":["/bin/bash","-c","if [ ! -z \"$(cat /etc/pod-info/skipPreStopChecks)\" ]; then exit 0; fi; rabbitmq-upgrade await_online_quorum_plus_one -t 604800; rabbitmq-upgrade await_online_synchronized_mirror -t 604800; rabbitmq-upgrade drain -t 604800"]}}},"terminationMessagePath":"/dev/termination-log","terminationMessagePolicy":"File","imagePullPolicy":"IfNotPresent"}],"restartPolicy":"Always","terminationGracePeriodSeconds":604800,"dnsPolicy":"ClusterFirst","serviceAccountName":"rabbitmq-cluster-server","serviceAccount":"rabbitmq-cluster-server","automountServiceAccountToken":true,"securityContext":{"runAsUser":999,"runAsGroup":999,"fsGroup":999},"schedulerName":"default-scheduler","topologySpreadConstraints":[{"maxSkew":1,"topologyKey":"topology.kubernetes.io/zone","whenUnsatisfiable":"ScheduleAnyway","labelSelector":{"matchLabels":{"app.kubernetes.io/name":"rabbitmq-cluster"}}}]}},"volumeClaimTemplates":[{"metadata":{"name":"persistence","namespace":"default","creationTimestamp":null,"labels":{"app.kubernetes.io/component":"rabbitmq","app.kubernetes.io/name":"rabbitmq-cluster","app.kubernetes.io/part-of":"rabbitmq"},"ownerReferences":[{"apiVersion":"rabbitmq.com/v1beta1","kind":"RabbitmqCluster","name":"rabbitmq-cluster","uid":"18d9928b-0d1c-47be-80ec-20960d053827","controller":true,"blockOwnerDeletion":false}]},"spec":{"accessModes":["ReadWriteOnce"],"resources":{"requests":{"storage":"10Gi"}},"volumeMode":"Filesystem"},"status":{"phase":"Pending"}}],"serviceName":"rabbitmq-cluster-nodes","podManagementPolicy":"Parallel","updateStrategy":{"type":"RollingUpdate","rollingUpdate":{"partition":0}},"revisionHistoryLimit":10},"status":{"observedGeneration":2,"replicas":3,"readyReplicas":1,"currentReplicas":3,"updatedReplicas":3,"currentRevision":"rabbitmq-cluster-server-5f8b8665fb","updateRevision":"rabbitmq-cluster-server-5f8b8665fb","collisionCount":0}}
2022/03/18 18:01:53 learn_server.go:253: [SIEVE-AFTER-RECONCILE]	github.com/rabbitmq/cluster-operator/controllers.(*RabbitmqClusterReconciler)	13
2022/03/18 18:01:59 learn_server.go:279: [SIEVE-BEFORE-HEAR]	26	Updated	statefulset	{"metadata":{"name":"rabbitmq-cluster-server","namespace":"default","selfLink":"/apis/apps/v1/namespaces/default/statefulsets/rabbitmq-cluster-server","uid":"cb5c43bc-6ee7-481c-ab01-6f3acffdd3c8","resourceVersion":"1214","generation":2,"creationTimestamp":"2022-03-18T18:00:38Z","labels":{"app.kubernetes.io/component":"rabbitmq","app.kubernetes.io/name":"rabbitmq-cluster","app.kubernetes.io/part-of":"rabbitmq"},"ownerReferences":[{"apiVersion":"rabbitmq.com/v1beta1","kind":"RabbitmqCluster","name":"rabbitmq-cluster","uid":"18d9928b-0d1c-47be-80ec-20960d053827","controller":true,"blockOwnerDeletion":true}],"managedFields":[{"manager":"manager","operation":"Update","apiVersion":"apps/v1","time":"2022-03-18T18:01:23Z","fieldsType":"FieldsV1","fieldsV1":{"f:metadata":{"f:labels":{".":{},"f:app.kubernetes.io/component":{},"f:app.kubernetes.io/name":{},"f:app.kubernetes.io/part-of":{}},"f:ownerReferences":{".":{},"k:{\"uid\":\"18d9928b-0d1c-47be-80ec-20960d053827\"}":{".":{},"f:apiVersion":{},"f:blockOwnerDeletion":{},"f:controller":{},"f:kind":{},"f:name":{},"f:uid":{}}}},"f:spec":{"f:podManagementPolicy":{},"f:replicas":{},"f:revisionHistoryLimit":{},"f:selector":{"f:matchLabels":{".":{},"f:app.kubernetes.io/name":{}}},"f:serviceName":{},"f:template":{"f:metadata":{"f:annotations":{".":{},"f:prometheus.io/port":{},"f:prometheus.io/scrape":{}},"f:labels":{".":{},"f:app.kubernetes.io/component":{},"f:app.kubernetes.io/name":{},"f:app.kubernetes.io/part-of":{}}},"f:spec":{"f:automountServiceAccountToken":{},"f:containers":{"k:{\"name\":\"rabbitmq\"}":{".":{},"f:env":{".":{},"k:{\"name\":\"K8S_HOSTNAME_SUFFIX\"}":{".":{},"f:name":{},"f:value":{}},"k:{\"name\":\"K8S_SERVICE_NAME\"}":{".":{},"f:name":{},"f:value":{}},"k:{\"name\":\"MY_POD_NAME\"}":{".":{},"f:name":{},"f:valueFrom":{".":{},"f:fieldRef":{".":{},"f:apiVersion":{},"f:fieldPath":{}}}},"k:{\"name\":\"MY_POD_NAMESPACE\"}":{".":{},"f:name":{},"f:valueFrom":{".":{},"f:fieldRef":{".":{},"f:apiVersion":{},"f:fieldPath":{}}}},"k:{\"name\":\"RABBITMQ_ENABLED_PLUGINS_FILE\"}":{".":{},"f:name":{},"f:value":{}},"k:{\"name\":\"RABBITMQ_NODENAME\"}":{".":{},"f:name":{},"f:value":{}},"k:{\"name\":\"RABBITMQ_USE_LONGNAME\"}":{".":{},"f:name":{},"f:value":{}}},"f:image":{},"f:imagePullPolicy":{},"f:lifecycle":{".":{},"f:preStop":{".":{},"f:exec":{".":{},"f:command":{}}}},"f:name":{},"f:ports":{".":{},"k:{\"containerPort\":4369,\"protocol\":\"TCP\"}":{".":{},"f:containerPort":{},"f:name":{},"f:protocol":{}},"k:{\"containerPort\":5672,\"protocol\":\"TCP\"}":{".":{},"f:containerPort":{},"f:name":{},"f:protocol":{}},"k:{\"containerPort\":15672,\"protocol\":\"TCP\"}":{".":{},"f:containerPort":{},"f:name":{},"f:protocol":{}},"k:{\"containerPort\":15692,\"protocol\":\"TCP\"}":{".":{},"f:containerPort":{},"f:name":{},"f:protocol":{}}},"f:readinessProbe":{".":{},"f:failureThreshold":{},"f:initialDelaySeconds":{},"f:periodSeconds":{},"f:successThreshold":{},"f:tcpSocket":{".":{},"f:port":{}},"f:timeoutSeconds":{}},"f:resources":{".":{},"f:limits":{".":{},"f:cpu":{},"f:memory":{}},"f:requests":{".":{},"f:cpu":{},"f:memory":{}}},"f:terminationMessagePath":{},"f:terminationMessagePolicy":{},"f:volumeMounts":{".":{},"k:{\"mountPath\":\"/etc/pod-info/\"}":{".":{},"f:mountPath":{},"f:name":{}},"k:{\"mountPath\":\"/etc/rabbitmq/conf.d/10-operatorDefaults.conf\"}":{".":{},"f:mountPath":{},"f:name":{},"f:subPath":{}},"k:{\"mountPath\":\"/etc/rabbitmq/conf.d/11-default_user.conf\"}":{".":{},"f:mountPath":{},"f:name":{},"f:subPath":{}},"k:{\"mountPath\":\"/etc/rabbitmq/conf.d/90-userDefinedConfiguration.conf\"}":{".":{},"f:mountPath":{},"f:name":{},"f:subPath":{}},"k:{\"mountPath\":\"/operator\"}":{".":{},"f:mountPath":{},"f:name":{}},"k:{\"mountPath\":\"/var/lib/rabbitmq/\"}":{".":{},"f:mountPath":{},"f:name":{}},"k:{\"mountPath\":\"/var/lib/rabbitmq/mnesia/\"}":{".":{},"f:mountPath":{},"f:name":{}}}}},"f:dnsPolicy":{},"f:initContainers":{".":{},"k:{\"name\":\"setup-container\"}":{".":{},"f:command":{},"f:image":{},"f:imagePullPolicy":{},"f:name":{},"f:resources":{".":{},"f:limits":{".":{},"f:cpu":{},"f:memory":{}},"f:requests":{".":{},"f:cpu":{},"f:memory":{}}},"f:securityContext":{".":{},"f:capabilities":{".":{},"f:drop":{}},"f:runAsUser":{}},"f:terminationMessagePath":{},"f:terminationMessagePolicy":{},"f:volumeMounts":{".":{},"k:{\"mountPath\":\"/operator\"}":{".":{},"f:mountPath":{},"f:name":{}},"k:{\"mountPath\":\"/tmp/default_user.conf\"}":{".":{},"f:mountPath":{},"f:name":{},"f:subPath":{}},"k:{\"mountPath\":\"/tmp/erlang-cookie-secret/\"}":{".":{},"f:mountPath":{},"f:name":{}},"k:{\"mountPath\":\"/tmp/rabbitmq-plugins/\"}":{".":{},"f:mountPath":{},"f:name":{}},"k:{\"mountPath\":\"/var/lib/rabbitmq/\"}":{".":{},"f:mountPath":{},"f:name":{}},"k:{\"mountPath\":\"/var/lib/rabbitmq/mnesia/\"}":{".":{},"f:mountPath":{},"f:name":{}}}}},"f:restartPolicy":{},"f:schedulerName":{},"f:securityContext":{".":{},"f:fsGroup":{},"f:runAsGroup":{},"f:runAsUser":{}},"f:serviceAccount":{},"f:serviceAccountName":{},"f:terminationGracePeriodSeconds":{},"f:topologySpreadConstraints":{".":{},"k:{\"topologyKey\":\"topology.kubernetes.io/zone\",\"whenUnsatisfiable\":\"ScheduleAnyway\"}":{".":{},"f:labelSelector":{".":{},"f:matchLabels":{".":{},"f:app.kubernetes.io/name":{}}},"f:maxSkew":{},"f:topologyKey":{},"f:whenUnsatisfiable":{}}},"f:volumes":{".":{},"k:{\"name\":\"erlang-cookie-secret\"}":{".":{},"f:name":{},"f:secret":{".":{},"f:defaultMode":{},"f:secretName":{}}},"k:{\"name\":\"plugins-conf\"}":{".":{},"f:configMap":{".":{},"f:defaultMode":{},"f:name":{}},"f:name":{}},"k:{\"name\":\"pod-info\"}":{".":{},"f:downwardAPI":{".":{},"f:defaultMode":{},"f:items":{}},"f:name":{}},"k:{\"name\":\"rabbitmq-confd\"}":{".":{},"f:name":{},"f:projected":{".":{},"f:defaultMode":{},"f:sources":{}}},"k:{\"name\":\"rabbitmq-erlang-cookie\"}":{".":{},"f:emptyDir":{},"f:name":{}},"k:{\"name\":\"rabbitmq-plugins\"}":{".":{},"f:emptyDir":{},"f:name":{}}}}},"f:updateStrategy":{"f:rollingUpdate":{".":{},"f:partition":{}},"f:type":{}},"f:volumeClaimTemplates":{}}}},{"manager":"kube-controller-manager","operation":"Update","apiVersion":"apps/v1","time":"2022-03-18T18:01:59Z","fieldsType":"FieldsV1","fieldsV1":{"f:status":{"f:collisionCount":{},"f:currentReplicas":{},"f:currentRevision":{},"f:observedGeneration":{},"f:readyReplicas":{},"f:replicas":{},"f:updateRevision":{},"f:updatedReplicas":{}}}}]},"spec":{"replicas":3,"selector":{"matchLabels":{"app.kubernetes.io/name":"rabbitmq-cluster"}},"template":{"metadata":{"creationTimestamp":null,"labels":{"app.kubernetes.io/component":"rabbitmq","app.kubernetes.io/name":"rabbitmq-cluster","app.kubernetes.io/part-of":"rabbitmq"},"annotations":{"prometheus.io/port":"15692","prometheus.io/scrape":"true"}},"spec":{"volumes":[{"name":"plugins-conf","configMap":{"name":"rabbitmq-cluster-plugins-conf","defaultMode":420}},{"name":"rabbitmq-confd","projected":{"sources":[{"secret":{"name":"rabbitmq-cluster-default-user","items":[{"key":"default_user.conf","path":"default_user.conf"}]}},{"configMap":{"name":"rabbitmq-cluster-server-conf","items":[{"key":"operatorDefaults.conf","path":"operatorDefaults.conf"},{"key":"userDefinedConfiguration.conf","path":"userDefinedConfiguration.conf"}]}}],"defaultMode":420}},{"name":"rabbitmq-erlang-cookie","emptyDir":{}},{"name":"erlang-cookie-secret","secret":{"secretName":"rabbitmq-cluster-erlang-cookie","defaultMode":420}},{"name":"rabbitmq-plugins","emptyDir":{}},{"name":"pod-info","downwardAPI":{"items":[{"path":"skipPreStopChecks","fieldRef":{"apiVersion":"v1","fieldPath":"metadata.labels['skipPreStopChecks']"}}],"defaultMode":420}}],"initContainers":[{"name":"setup-container","image":"rabbitmq:3.8.12-management","command":["sh","-c","cp /tmp/erlang-cookie-secret/.erlang.cookie /var/lib/rabbitmq/.erlang.cookie \u0026\u0026 chown 999:999 /var/lib/rabbitmq/.erlang.cookie \u0026\u0026 chmod 600 /var/lib/rabbitmq/.erlang.cookie ; cp /tmp/rabbitmq-plugins/enabled_plugins /operator/enabled_plugins \u0026\u0026 chown 999:999 /operator/enabled_plugins ; chown 999:999 /var/lib/rabbitmq/mnesia/ ; echo '[default]' \u003e /var/lib/rabbitmq/.rabbitmqadmin.conf \u0026\u0026 sed -e 's/default_user/username/' -e 's/default_pass/password/' /tmp/default_user.conf \u003e\u003e /var/lib/rabbitmq/.rabbitmqadmin.conf \u0026\u0026 chown 999:999 /var/lib/rabbitmq/.rabbitmqadmin.conf \u0026\u0026 chmod 600 /var/lib/rabbitmq/.rabbitmqadmin.conf"],"resources":{"limits":{"cpu":"100m","memory":"500Mi"},"requests":{"cpu":"100m","memory":"500Mi"}},"volumeMounts":[{"name":"plugins-conf","mountPath":"/tmp/rabbitmq-plugins/"},{"name":"rabbitmq-erlang-cookie","mountPath":"/var/lib/rabbitmq/"},{"name":"erlang-cookie-secret","mountPath":"/tmp/erlang-cookie-secret/"},{"name":"rabbitmq-plugins","mountPath":"/operator"},{"name":"persistence","mountPath":"/var/lib/rabbitmq/mnesia/"},{"name":"rabbitmq-confd","mountPath":"/tmp/default_user.conf","subPath":"default_user.conf"}],"terminationMessagePath":"/dev/termination-log","terminationMessagePolicy":"File","imagePullPolicy":"IfNotPresent","securityContext":{"capabilities":{"drop":["FSETID","KILL","SETGID","SETUID","SETPCAP","NET_BIND_SERVICE","NET_RAW","SYS_CHROOT","MKNOD","AUDIT_WRITE","SETFCAP"]},"runAsUser":0}}],"containers":[{"name":"rabbitmq","image":"rabbitmq:3.8.12-management","ports":[{"name":"epmd","containerPort":4369,"protocol":"TCP"},{"name":"amqp","containerPort":5672,"protocol":"TCP"},{"name":"management","containerPort":15672,"protocol":"TCP"},{"name":"prometheus","containerPort":15692,"protocol":"TCP"}],"env":[{"name":"MY_POD_NAME","valueFrom":{"fieldRef":{"apiVersion":"v1","fieldPath":"metadata.name"}}},{"name":"MY_POD_NAMESPACE","valueFrom":{"fieldRef":{"apiVersion":"v1","fieldPath":"metadata.namespace"}}},{"name":"RABBITMQ_ENABLED_PLUGINS_FILE","value":"/operator/enabled_plugins"},{"name":"K8S_SERVICE_NAME","value":"rabbitmq-cluster-nodes"},{"name":"RABBITMQ_USE_LONGNAME","value":"true"},{"name":"RABBITMQ_NODENAME","value":"rabbit@$(MY_POD_NAME).$(K8S_SERVICE_NAME).$(MY_POD_NAMESPACE)"},{"name":"K8S_HOSTNAME_SUFFIX","value":".$(K8S_SERVICE_NAME).$(MY_POD_NAMESPACE)"}],"resources":{"limits":{"cpu":"2","memory":"2Gi"},"requests":{"cpu":"1","memory":"2Gi"}},"volumeMounts":[{"name":"rabbitmq-erlang-cookie","mountPath":"/var/lib/rabbitmq/"},{"name":"persistence","mountPath":"/var/lib/rabbitmq/mnesia/"},{"name":"rabbitmq-plugins","mountPath":"/operator"},{"name":"rabbitmq-confd","mountPath":"/etc/rabbitmq/conf.d/10-operatorDefaults.conf","subPath":"operatorDefaults.conf"},{"name":"rabbitmq-confd","mountPath":"/etc/rabbitmq/conf.d/11-default_user.conf","subPath":"default_user.conf"},{"name":"rabbitmq-confd","mountPath":"/etc/rabbitmq/conf.d/90-userDefinedConfiguration.conf","subPath":"userDefinedConfiguration.conf"},{"name":"pod-info","mountPath":"/etc/pod-info/"}],"readinessProbe":{"tcpSocket":{"port":"amqp"},"initialDelaySeconds":10,"timeoutSeconds":5,"periodSeconds":10,"successThreshold":1,"failureThreshold":3},"lifecycle":{"preStop":{"exec":{"command":["/bin/bash","-c","if [ ! -z \"$(cat /etc/pod-info/skipPreStopChecks)\" ]; then exit 0; fi; rabbitmq-upgrade await_online_quorum_plus_one -t 604800; rabbitmq-upgrade await_online_synchronized_mirror -t 604800; rabbitmq-upgrade drain -t 604800"]}}},"terminationMessagePath":"/dev/termination-log","terminationMessagePolicy":"File","imagePullPolicy":"IfNotPresent"}],"restartPolicy":"Always","terminationGracePeriodSeconds":604800,"dnsPolicy":"ClusterFirst","serviceAccountName":"rabbitmq-cluster-server","serviceAccount":"rabbitmq-cluster-server","automountServiceAccountToken":true,"securityContext":{"runAsUser":999,"runAsGroup":999,"fsGroup":999},"schedulerName":"default-scheduler","topologySpreadConstraints":[{"maxSkew":1,"topologyKey":"topology.kubernetes.io/zone","whenUnsatisfiable":"ScheduleAnyway","labelSelector":{"matchLabels":{"app.kubernetes.io/name":"rabbitmq-cluster"}}}]}},"volumeClaimTemplates":[{"metadata":{"name":"persistence","namespace":"default","creationTimestamp":null,"labels":{"app.kubernetes.io/component":"rabbitmq","app.kubernetes.io/name":"rabbitmq-cluster","app.kubernetes.io/part-of":"rabbitmq"},"ownerReferences":[{"apiVersion":"rabbitmq.com/v1beta1","kind":"RabbitmqCluster","name":"rabbitmq-cluster","uid":"18d9928b-0d1c-47be-80ec-20960d053827","controller":true,"blockOwnerDeletion":false}]},"spec":{"accessModes":["ReadWriteOnce"],"resources":{"requests":{"storage":"10Gi"}},"volumeMode":"Filesystem"},"status":{"phase":"Pending"}}],"serviceName":"rabbitmq-cluster-nodes","podManagementPolicy":"Parallel","updateStrategy":{"type":"RollingUpdate","rollingUpdate":{"partition":0}},"revisionHistoryLimit":10},"status":{"observedGeneration":2,"replicas":3,"readyReplicas":2,"currentReplicas":3,"updatedReplicas":3,"currentRevision":"rabbitmq-cluster-server-5f8b8665fb","updateRevision":"rabbitmq-cluster-server-5f8b8665fb","collisionCount":0}}
2022/03/18 18:01:59 learn_server.go:238: [SIEVE-BEFORE-RECONCILE]	github.com/rabbitmq/cluster-operator/controllers.(*RabbitmqClusterReconciler)	14
2022/03/18 18:01:59 learn_server.go:289: [SIEVE-AFTER-HEAR]	26
2022/03/18 18:01:59 learn_server.go:291: [SIEVE-AFTER-READ]	Get	true	rabbitmqcluster	default	rabbitmq-cluster	github.com/rabbitmq/cluster-operator/controllers.(*RabbitmqClusterReconciler)	NoError	{"kind":"RabbitmqCluster","apiVersion":"rabbitmq.com/v1beta1","metadata":{"name":"rabbitmq-cluster","namespace":"default","selfLink":"/apis/rabbitmq.com/v1beta1/namespaces/default/rabbitmqclusters/rabbitmq-cluster","uid":"18d9928b-0d1c-47be-80ec-20960d053827","resourceVersion":"977","generation":3,"creationTimestamp":"2022-03-18T18:00:38Z","annotations":{"kubectl.kubernetes.io/last-applied-configuration":"{\"apiVersion\":\"rabbitmq.com/v1beta1\",\"kind\":\"RabbitmqCluster\",\"metadata\":{\"annotations\":{},\"name\":\"rabbitmq-cluster\",\"namespace\":\"default\"},\"spec\":{\"persistence\":{\"storage\":\"10Gi\"},\"replicas\":1}}\n"},"finalizers":["deletion.finalizers.rabbitmqclusters.rabbitmq.com"],"managedFields":[{"manager":"kubectl-client-side-apply","operation":"Update","apiVersion":"rabbitmq.com/v1beta1","time":"2022-03-18T18:00:38Z","fieldsType":"FieldsV1","fieldsV1":{"f:metadata":{"f:annotations":{".":{},"f:kubectl.kubernetes.io/last-applied-configuration":{}}},"f:spec":{".":{},"f:image":{},"f:persistence":{".":{},"f:storage":{}},"f:resources":{".":{},"f:limits":{".":{},"f:memory":{}},"f:requests":{".":{},"f:memory":{}}},"f:service":{".":{},"f:type":{}},"f:terminationGracePeriodSeconds":{}}}},{"manager":"kubectl-patch","operation":"Update","apiVersion":"rabbitmq.com/v1beta1","time":"2022-03-18T18:01:23Z","fieldsType":"FieldsV1","fieldsV1":{"f:spec":{"f:replicas":{}}}},{"manager":"manager","operation":"Update","apiVersion":"rabbitmq.com/v1beta1","time":"2022-03-18T18:01:23Z","fieldsType":"FieldsV1","fieldsV1":{"f:metadata":{"f:finalizers":{}},"f:spec":{"f:override":{},"f:rabbitmq":{},"f:resources":{"f:limits":{"f:cpu":{}},"f:requests":{"f:cpu":{}}},"f:tls":{}},"f:status":{".":{},"f:conditions":{},"f:defaultUser":{".":{},"f:secretReference":{".":{},"f:keys":{".":{},"f:password":{},"f:username":{}},"f:name":{},"f:namespace":{}},"f:serviceReference":{".":{},"f:name":{},"f:namespace":{}}}}}}]},"spec":{"replicas":3,"image":"rabbitmq:3.8.12-management","service":{"type":"ClusterIP"},"persistence":{"storage":"10Gi"},"resources":{"limits":{"cpu":"2","memory":"2Gi"},"requests":{"cpu":"1","memory":"2Gi"}},"rabbitmq":{},"tls":{},"override":{},"terminationGracePeriodSeconds":604800},"status":{"conditions":[{"type":"AllReplicasReady","status":"False","lastTransitionTime":"2022-03-18T18:01:23Z","reason":"NotAllPodsReady","message":"1/3 Pods ready"},{"type":"ClusterAvailable","status":"True","lastTransitionTime":"2022-03-18T18:01:17Z","reason":"AtLeastOneEndpointAvailable"},{"type":"NoWarnings","status":"True","lastTransitionTime":"2022-03-18T18:00:38Z","reason":"NoWarnings"},{"type":"ReconcileSuccess","status":"True","lastTransitionTime":"2022-03-18T18:01:18Z","reason":"Success","message":"Finish reconciling"}],"defaultUser":{"secretReference":{"name":"rabbitmq-cluster-default-user","namespace":"default","keys":{"password":"password","username":"username"}},"serviceReference":{"name":"rabbitmq-cluster","namespace":"default"}}}}
2022/03/18 18:01:59 learn_server.go:291: [SIEVE-AFTER-READ]	Get	true	statefulset	default	rabbitmq-cluster-server	github.com/rabbitmq/cluster-operator/controllers.(*RabbitmqClusterReconciler)	NoError	{"kind":"StatefulSet","apiVersion":"apps/v1","metadata":{"name":"rabbitmq-cluster-server","namespace":"default","selfLink":"/apis/apps/v1/namespaces/default/statefulsets/rabbitmq-cluster-server","uid":"cb5c43bc-6ee7-481c-ab01-6f3acffdd3c8","resourceVersion":"1214","generation":2,"creationTimestamp":"2022-03-18T18:00:38Z","labels":{"app.kubernetes.io/component":"rabbitmq","app.kubernetes.io/name":"rabbitmq-cluster","app.kubernetes.io/part-of":"rabbitmq"},"ownerReferences":[{"apiVersion":"rabbitmq.com/v1beta1","kind":"RabbitmqCluster","name":"rabbitmq-cluster","uid":"18d9928b-0d1c-47be-80ec-20960d053827","controller":true,"blockOwnerDeletion":true}],"managedFields":[{"manager":"manager","operation":"Update","apiVersion":"apps/v1","time":"2022-03-18T18:01:23Z","fieldsType":"FieldsV1","fieldsV1":{"f:metadata":{"f:labels":{".":{},"f:app.kubernetes.io/component":{},"f:app.kubernetes.io/name":{},"f:app.kubernetes.io/part-of":{}},"f:ownerReferences":{".":{},"k:{\"uid\":\"18d9928b-0d1c-47be-80ec-20960d053827\"}":{".":{},"f:apiVersion":{},"f:blockOwnerDeletion":{},"f:controller":{},"f:kind":{},"f:name":{},"f:uid":{}}}},"f:spec":{"f:podManagementPolicy":{},"f:replicas":{},"f:revisionHistoryLimit":{},"f:selector":{"f:matchLabels":{".":{},"f:app.kubernetes.io/name":{}}},"f:serviceName":{},"f:template":{"f:metadata":{"f:annotations":{".":{},"f:prometheus.io/port":{},"f:prometheus.io/scrape":{}},"f:labels":{".":{},"f:app.kubernetes.io/component":{},"f:app.kubernetes.io/name":{},"f:app.kubernetes.io/part-of":{}}},"f:spec":{"f:automountServiceAccountToken":{},"f:containers":{"k:{\"name\":\"rabbitmq\"}":{".":{},"f:env":{".":{},"k:{\"name\":\"K8S_HOSTNAME_SUFFIX\"}":{".":{},"f:name":{},"f:value":{}},"k:{\"name\":\"K8S_SERVICE_NAME\"}":{".":{},"f:name":{},"f:value":{}},"k:{\"name\":\"MY_POD_NAME\"}":{".":{},"f:name":{},"f:valueFrom":{".":{},"f:fieldRef":{".":{},"f:apiVersion":{},"f:fieldPath":{}}}},"k:{\"name\":\"MY_POD_NAMESPACE\"}":{".":{},"f:name":{},"f:valueFrom":{".":{},"f:fieldRef":{".":{},"f:apiVersion":{},"f:fieldPath":{}}}},"k:{\"name\":\"RABBITMQ_ENABLED_PLUGINS_FILE\"}":{".":{},"f:name":{},"f:value":{}},"k:{\"name\":\"RABBITMQ_NODENAME\"}":{".":{},"f:name":{},"f:value":{}},"k:{\"name\":\"RABBITMQ_USE_LONGNAME\"}":{".":{},"f:name":{},"f:value":{}}},"f:image":{},"f:imagePullPolicy":{},"f:lifecycle":{".":{},"f:preStop":{".":{},"f:exec":{".":{},"f:command":{}}}},"f:name":{},"f:ports":{".":{},"k:{\"containerPort\":4369,\"protocol\":\"TCP\"}":{".":{},"f:containerPort":{},"f:name":{},"f:protocol":{}},"k:{\"containerPort\":5672,\"protocol\":\"TCP\"}":{".":{},"f:containerPort":{},"f:name":{},"f:protocol":{}},"k:{\"containerPort\":15672,\"protocol\":\"TCP\"}":{".":{},"f:containerPort":{},"f:name":{},"f:protocol":{}},"k:{\"containerPort\":15692,\"protocol\":\"TCP\"}":{".":{},"f:containerPort":{},"f:name":{},"f:protocol":{}}},"f:readinessProbe":{".":{},"f:failureThreshold":{},"f:initialDelaySeconds":{},"f:periodSeconds":{},"f:successThreshold":{},"f:tcpSocket":{".":{},"f:port":{}},"f:timeoutSeconds":{}},"f:resources":{".":{},"f:limits":{".":{},"f:cpu":{},"f:memory":{}},"f:requests":{".":{},"f:cpu":{},"f:memory":{}}},"f:terminationMessagePath":{},"f:terminationMessagePolicy":{},"f:volumeMounts":{".":{},"k:{\"mountPath\":\"/etc/pod-info/\"}":{".":{},"f:mountPath":{},"f:name":{}},"k:{\"mountPath\":\"/etc/rabbitmq/conf.d/10-operatorDefaults.conf\"}":{".":{},"f:mountPath":{},"f:name":{},"f:subPath":{}},"k:{\"mountPath\":\"/etc/rabbitmq/conf.d/11-default_user.conf\"}":{".":{},"f:mountPath":{},"f:name":{},"f:subPath":{}},"k:{\"mountPath\":\"/etc/rabbitmq/conf.d/90-userDefinedConfiguration.conf\"}":{".":{},"f:mountPath":{},"f:name":{},"f:subPath":{}},"k:{\"mountPath\":\"/operator\"}":{".":{},"f:mountPath":{},"f:name":{}},"k:{\"mountPath\":\"/var/lib/rabbitmq/\"}":{".":{},"f:mountPath":{},"f:name":{}},"k:{\"mountPath\":\"/var/lib/rabbitmq/mnesia/\"}":{".":{},"f:mountPath":{},"f:name":{}}}}},"f:dnsPolicy":{},"f:initContainers":{".":{},"k:{\"name\":\"setup-container\"}":{".":{},"f:command":{},"f:image":{},"f:imagePullPolicy":{},"f:name":{},"f:resources":{".":{},"f:limits":{".":{},"f:cpu":{},"f:memory":{}},"f:requests":{".":{},"f:cpu":{},"f:memory":{}}},"f:securityContext":{".":{},"f:capabilities":{".":{},"f:drop":{}},"f:runAsUser":{}},"f:terminationMessagePath":{},"f:terminationMessagePolicy":{},"f:volumeMounts":{".":{},"k:{\"mountPath\":\"/operator\"}":{".":{},"f:mountPath":{},"f:name":{}},"k:{\"mountPath\":\"/tmp/default_user.conf\"}":{".":{},"f:mountPath":{},"f:name":{},"f:subPath":{}},"k:{\"mountPath\":\"/tmp/erlang-cookie-secret/\"}":{".":{},"f:mountPath":{},"f:name":{}},"k:{\"mountPath\":\"/tmp/rabbitmq-plugins/\"}":{".":{},"f:mountPath":{},"f:name":{}},"k:{\"mountPath\":\"/var/lib/rabbitmq/\"}":{".":{},"f:mountPath":{},"f:name":{}},"k:{\"mountPath\":\"/var/lib/rabbitmq/mnesia/\"}":{".":{},"f:mountPath":{},"f:name":{}}}}},"f:restartPolicy":{},"f:schedulerName":{},"f:securityContext":{".":{},"f:fsGroup":{},"f:runAsGroup":{},"f:runAsUser":{}},"f:serviceAccount":{},"f:serviceAccountName":{},"f:terminationGracePeriodSeconds":{},"f:topologySpreadConstraints":{".":{},"k:{\"topologyKey\":\"topology.kubernetes.io/zone\",\"whenUnsatisfiable\":\"ScheduleAnyway\"}":{".":{},"f:labelSelector":{".":{},"f:matchLabels":{".":{},"f:app.kubernetes.io/name":{}}},"f:maxSkew":{},"f:topologyKey":{},"f:whenUnsatisfiable":{}}},"f:volumes":{".":{},"k:{\"name\":\"erlang-cookie-secret\"}":{".":{},"f:name":{},"f:secret":{".":{},"f:defaultMode":{},"f:secretName":{}}},"k:{\"name\":\"plugins-conf\"}":{".":{},"f:configMap":{".":{},"f:defaultMode":{},"f:name":{}},"f:name":{}},"k:{\"name\":\"pod-info\"}":{".":{},"f:downwardAPI":{".":{},"f:defaultMode":{},"f:items":{}},"f:name":{}},"k:{\"name\":\"rabbitmq-confd\"}":{".":{},"f:name":{},"f:projected":{".":{},"f:defaultMode":{},"f:sources":{}}},"k:{\"name\":\"rabbitmq-erlang-cookie\"}":{".":{},"f:emptyDir":{},"f:name":{}},"k:{\"name\":\"rabbitmq-plugins\"}":{".":{},"f:emptyDir":{},"f:name":{}}}}},"f:updateStrategy":{"f:rollingUpdate":{".":{},"f:partition":{}},"f:type":{}},"f:volumeClaimTemplates":{}}}},{"manager":"kube-controller-manager","operation":"Update","apiVersion":"apps/v1","time":"2022-03-18T18:01:59Z","fieldsType":"FieldsV1","fieldsV1":{"f:status":{"f:collisionCount":{},"f:currentReplicas":{},"f:currentRevision":{},"f:observedGeneration":{},"f:readyReplicas":{},"f:replicas":{},"f:updateRevision":{},"f:updatedReplicas":{}}}}]},"spec":{"replicas":3,"selector":{"matchLabels":{"app.kubernetes.io/name":"rabbitmq-cluster"}},"template":{"metadata":{"creationTimestamp":null,"labels":{"app.kubernetes.io/component":"rabbitmq","app.kubernetes.io/name":"rabbitmq-cluster","app.kubernetes.io/part-of":"rabbitmq"},"annotations":{"prometheus.io/port":"15692","prometheus.io/scrape":"true"}},"spec":{"volumes":[{"name":"plugins-conf","configMap":{"name":"rabbitmq-cluster-plugins-conf","defaultMode":420}},{"name":"rabbitmq-confd","projected":{"sources":[{"secret":{"name":"rabbitmq-cluster-default-user","items":[{"key":"default_user.conf","path":"default_user.conf"}]}},{"configMap":{"name":"rabbitmq-cluster-server-conf","items":[{"key":"operatorDefaults.conf","path":"operatorDefaults.conf"},{"key":"userDefinedConfiguration.conf","path":"userDefinedConfiguration.conf"}]}}],"defaultMode":420}},{"name":"rabbitmq-erlang-cookie","emptyDir":{}},{"name":"erlang-cookie-secret","secret":{"secretName":"rabbitmq-cluster-erlang-cookie","defaultMode":420}},{"name":"rabbitmq-plugins","emptyDir":{}},{"name":"pod-info","downwardAPI":{"items":[{"path":"skipPreStopChecks","fieldRef":{"apiVersion":"v1","fieldPath":"metadata.labels['skipPreStopChecks']"}}],"defaultMode":420}}],"initContainers":[{"name":"setup-container","image":"rabbitmq:3.8.12-management","command":["sh","-c","cp /tmp/erlang-cookie-secret/.erlang.cookie /var/lib/rabbitmq/.erlang.cookie \u0026\u0026 chown 999:999 /var/lib/rabbitmq/.erlang.cookie \u0026\u0026 chmod 600 /var/lib/rabbitmq/.erlang.cookie ; cp /tmp/rabbitmq-plugins/enabled_plugins /operator/enabled_plugins \u0026\u0026 chown 999:999 /operator/enabled_plugins ; chown 999:999 /var/lib/rabbitmq/mnesia/ ; echo '[default]' \u003e /var/lib/rabbitmq/.rabbitmqadmin.conf \u0026\u0026 sed -e 's/default_user/username/' -e 's/default_pass/password/' /tmp/default_user.conf \u003e\u003e /var/lib/rabbitmq/.rabbitmqadmin.conf \u0026\u0026 chown 999:999 /var/lib/rabbitmq/.rabbitmqadmin.conf \u0026\u0026 chmod 600 /var/lib/rabbitmq/.rabbitmqadmin.conf"],"resources":{"limits":{"cpu":"100m","memory":"500Mi"},"requests":{"cpu":"100m","memory":"500Mi"}},"volumeMounts":[{"name":"plugins-conf","mountPath":"/tmp/rabbitmq-plugins/"},{"name":"rabbitmq-erlang-cookie","mountPath":"/var/lib/rabbitmq/"},{"name":"erlang-cookie-secret","mountPath":"/tmp/erlang-cookie-secret/"},{"name":"rabbitmq-plugins","mountPath":"/operator"},{"name":"persistence","mountPath":"/var/lib/rabbitmq/mnesia/"},{"name":"rabbitmq-confd","mountPath":"/tmp/default_user.conf","subPath":"default_user.conf"}],"terminationMessagePath":"/dev/termination-log","terminationMessagePolicy":"File","imagePullPolicy":"IfNotPresent","securityContext":{"capabilities":{"drop":["FSETID","KILL","SETGID","SETUID","SETPCAP","NET_BIND_SERVICE","NET_RAW","SYS_CHROOT","MKNOD","AUDIT_WRITE","SETFCAP"]},"runAsUser":0}}],"containers":[{"name":"rabbitmq","image":"rabbitmq:3.8.12-management","ports":[{"name":"epmd","containerPort":4369,"protocol":"TCP"},{"name":"amqp","containerPort":5672,"protocol":"TCP"},{"name":"management","containerPort":15672,"protocol":"TCP"},{"name":"prometheus","containerPort":15692,"protocol":"TCP"}],"env":[{"name":"MY_POD_NAME","valueFrom":{"fieldRef":{"apiVersion":"v1","fieldPath":"metadata.name"}}},{"name":"MY_POD_NAMESPACE","valueFrom":{"fieldRef":{"apiVersion":"v1","fieldPath":"metadata.namespace"}}},{"name":"RABBITMQ_ENABLED_PLUGINS_FILE","value":"/operator/enabled_plugins"},{"name":"K8S_SERVICE_NAME","value":"rabbitmq-cluster-nodes"},{"name":"RABBITMQ_USE_LONGNAME","value":"true"},{"name":"RABBITMQ_NODENAME","value":"rabbit@$(MY_POD_NAME).$(K8S_SERVICE_NAME).$(MY_POD_NAMESPACE)"},{"name":"K8S_HOSTNAME_SUFFIX","value":".$(K8S_SERVICE_NAME).$(MY_POD_NAMESPACE)"}],"resources":{"limits":{"cpu":"2","memory":"2Gi"},"requests":{"cpu":"1","memory":"2Gi"}},"volumeMounts":[{"name":"rabbitmq-erlang-cookie","mountPath":"/var/lib/rabbitmq/"},{"name":"persistence","mountPath":"/var/lib/rabbitmq/mnesia/"},{"name":"rabbitmq-plugins","mountPath":"/operator"},{"name":"rabbitmq-confd","mountPath":"/etc/rabbitmq/conf.d/10-operatorDefaults.conf","subPath":"operatorDefaults.conf"},{"name":"rabbitmq-confd","mountPath":"/etc/rabbitmq/conf.d/11-default_user.conf","subPath":"default_user.conf"},{"name":"rabbitmq-confd","mountPath":"/etc/rabbitmq/conf.d/90-userDefinedConfiguration.conf","subPath":"userDefinedConfiguration.conf"},{"name":"pod-info","mountPath":"/etc/pod-info/"}],"readinessProbe":{"tcpSocket":{"port":"amqp"},"initialDelaySeconds":10,"timeoutSeconds":5,"periodSeconds":10,"successThreshold":1,"failureThreshold":3},"lifecycle":{"preStop":{"exec":{"command":["/bin/bash","-c","if [ ! -z \"$(cat /etc/pod-info/skipPreStopChecks)\" ]; then exit 0; fi; rabbitmq-upgrade await_online_quorum_plus_one -t 604800; rabbitmq-upgrade await_online_synchronized_mirror -t 604800; rabbitmq-upgrade drain -t 604800"]}}},"terminationMessagePath":"/dev/termination-log","terminationMessagePolicy":"File","imagePullPolicy":"IfNotPresent"}],"restartPolicy":"Always","terminationGracePeriodSeconds":604800,"dnsPolicy":"ClusterFirst","serviceAccountName":"rabbitmq-cluster-server","serviceAccount":"rabbitmq-cluster-server","automountServiceAccountToken":true,"securityContext":{"runAsUser":999,"runAsGroup":999,"fsGroup":999},"schedulerName":"default-scheduler","topologySpreadConstraints":[{"maxSkew":1,"topologyKey":"topology.kubernetes.io/zone","whenUnsatisfiable":"ScheduleAnyway","labelSelector":{"matchLabels":{"app.kubernetes.io/name":"rabbitmq-cluster"}}}]}},"volumeClaimTemplates":[{"metadata":{"name":"persistence","namespace":"default","creationTimestamp":null,"labels":{"app.kubernetes.io/component":"rabbitmq","app.kubernetes.io/name":"rabbitmq-cluster","app.kubernetes.io/part-of":"rabbitmq"},"ownerReferences":[{"apiVersion":"rabbitmq.com/v1beta1","kind":"RabbitmqCluster","name":"rabbitmq-cluster","uid":"18d9928b-0d1c-47be-80ec-20960d053827","controller":true,"blockOwnerDeletion":false}]},"spec":{"accessModes":["ReadWriteOnce"],"resources":{"requests":{"storage":"10Gi"}},"volumeMode":"Filesystem"},"status":{"phase":"Pending"}}],"serviceName":"rabbitmq-cluster-nodes","podManagementPolicy":"Parallel","updateStrategy":{"type":"RollingUpdate","rollingUpdate":{"partition":0}},"revisionHistoryLimit":10},"status":{"observedGeneration":2,"replicas":3,"readyReplicas":2,"currentReplicas":3,"updatedReplicas":3,"currentRevision":"rabbitmq-cluster-server-5f8b8665fb","updateRevision":"rabbitmq-cluster-server-5f8b8665fb","collisionCount":0}}
2022/03/18 18:01:59 learn_server.go:291: [SIEVE-AFTER-READ]	Get	true	endpoints	default	rabbitmq-cluster	github.com/rabbitmq/cluster-operator/controllers.(*RabbitmqClusterReconciler)	NoError	{"kind":"Endpoints","apiVersion":"v1","metadata":{"name":"rabbitmq-cluster","namespace":"default","selfLink":"/api/v1/namespaces/default/endpoints/rabbitmq-cluster","uid":"5c4723ad-f4fe-442d-9135-44879a2a8183","resourceVersion":"1210","creationTimestamp":"2022-03-18T18:00:38Z","labels":{"app.kubernetes.io/component":"rabbitmq","app.kubernetes.io/name":"rabbitmq-cluster","app.kubernetes.io/part-of":"rabbitmq"},"annotations":{"endpoints.kubernetes.io/last-change-trigger-time":"2022-03-18T18:01:59Z"},"managedFields":[{"manager":"kube-controller-manager","operation":"Update","apiVersion":"v1","time":"2022-03-18T18:01:59Z","fieldsType":"FieldsV1","fieldsV1":{"f:metadata":{"f:annotations":{".":{},"f:endpoints.kubernetes.io/last-change-trigger-time":{}},"f:labels":{".":{},"f:app.kubernetes.io/component":{},"f:app.kubernetes.io/name":{},"f:app.kubernetes.io/part-of":{}}},"f:subsets":{}}}]},"subsets":[{"addresses":[{"ip":"10.244.1.4","nodeName":"kind-worker2","targetRef":{"kind":"Pod","namespace":"default","name":"rabbitmq-cluster-server-0","uid":"e7faffc5-b656-4e69-9777-92d12cb6ec5a","resourceVersion":"938"}},{"ip":"10.244.2.5","nodeName":"kind-worker","targetRef":{"kind":"Pod","namespace":"default","name":"rabbitmq-cluster-server-2","uid":"2a54a659-a979-4e10-8e74-1e0b83d532ba","resourceVersion":"1209"}}],"notReadyAddresses":[{"ip":"10.244.2.4","nodeName":"kind-worker","targetRef":{"kind":"Pod","namespace":"default","name":"rabbitmq-cluster-server-1","uid":"7a37da00-25d1-48b6-a659-4390fb7a02cb","resourceVersion":"1099"}}],"ports":[{"name":"amqp","port":5672,"protocol":"TCP"},{"name":"management","port":15672,"protocol":"TCP"}]}]}
2022/03/18 18:01:59 learn_server.go:256: [SIEVE-BEFORE-WRITE]	49
2022/03/18 18:01:59 learn_server.go:279: [SIEVE-BEFORE-HEAR]	27	Updated	rabbitmqcluster	{"metadata":{"name":"rabbitmq-cluster","namespace":"default","selfLink":"/apis/rabbitmq.com/v1beta1/namespaces/default/rabbitmqclusters/rabbitmq-cluster","uid":"18d9928b-0d1c-47be-80ec-20960d053827","resourceVersion":"1215","generation":3,"creationTimestamp":"2022-03-18T18:00:38Z","annotations":{"kubectl.kubernetes.io/last-applied-configuration":"{\"apiVersion\":\"rabbitmq.com/v1beta1\",\"kind\":\"RabbitmqCluster\",\"metadata\":{\"annotations\":{},\"name\":\"rabbitmq-cluster\",\"namespace\":\"default\"},\"spec\":{\"persistence\":{\"storage\":\"10Gi\"},\"replicas\":1}}\n"},"finalizers":["deletion.finalizers.rabbitmqclusters.rabbitmq.com"],"managedFields":[{"manager":"kubectl-client-side-apply","operation":"Update","apiVersion":"rabbitmq.com/v1beta1","time":"2022-03-18T18:00:38Z","fieldsType":"FieldsV1","fieldsV1":{"f:metadata":{"f:annotations":{".":{},"f:kubectl.kubernetes.io/last-applied-configuration":{}}},"f:spec":{".":{},"f:image":{},"f:persistence":{".":{},"f:storage":{}},"f:resources":{".":{},"f:limits":{".":{},"f:memory":{}},"f:requests":{".":{},"f:memory":{}}},"f:service":{".":{},"f:type":{}},"f:terminationGracePeriodSeconds":{}}}},{"manager":"kubectl-patch","operation":"Update","apiVersion":"rabbitmq.com/v1beta1","time":"2022-03-18T18:01:23Z","fieldsType":"FieldsV1","fieldsV1":{"f:spec":{"f:replicas":{}}}},{"manager":"manager","operation":"Update","apiVersion":"rabbitmq.com/v1beta1","time":"2022-03-18T18:01:59Z","fieldsType":"FieldsV1","fieldsV1":{"f:metadata":{"f:finalizers":{}},"f:spec":{"f:override":{},"f:rabbitmq":{},"f:resources":{"f:limits":{"f:cpu":{}},"f:requests":{"f:cpu":{}}},"f:tls":{}},"f:status":{".":{},"f:conditions":{},"f:defaultUser":{".":{},"f:secretReference":{".":{},"f:keys":{".":{},"f:password":{},"f:username":{}},"f:name":{},"f:namespace":{}},"f:serviceReference":{".":{},"f:name":{},"f:namespace":{}}}}}}]},"spec":{"replicas":3,"image":"rabbitmq:3.8.12-management","service":{"type":"ClusterIP"},"persistence":{"storage":"10Gi"},"resources":{"limits":{"cpu":"2","memory":"2Gi"},"requests":{"cpu":"1","memory":"2Gi"}},"rabbitmq":{},"tls":{},"override":{},"terminationGracePeriodSeconds":604800},"status":{"conditions":[{"type":"AllReplicasReady","status":"False","lastTransitionTime":"2022-03-18T18:01:23Z","reason":"NotAllPodsReady","message":"2/3 Pods ready"},{"type":"ClusterAvailable","status":"True","lastTransitionTime":"2022-03-18T18:01:17Z","reason":"AtLeastOneEndpointAvailable"},{"type":"NoWarnings","status":"True","lastTransitionTime":"2022-03-18T18:00:38Z","reason":"NoWarnings"},{"type":"ReconcileSuccess","status":"True","lastTransitionTime":"2022-03-18T18:01:18Z","reason":"Success","message":"Finish reconciling"}],"defaultUser":{"secretReference":{"name":"rabbitmq-cluster-default-user","namespace":"default","keys":{"password":"password","username":"username"}},"serviceReference":{"name":"rabbitmq-cluster","namespace":"default"}}}}
2022/03/18 18:01:59 learn_server.go:289: [SIEVE-AFTER-HEAR]	27
2022/03/18 18:01:59 learn_server.go:263: [SIEVE-AFTER-WRITE]	49	StatusUpdate	rabbitmqcluster	github.com/rabbitmq/cluster-operator/controllers.(*RabbitmqClusterReconciler)	NoError	{"metadata":{"name":"rabbitmq-cluster","namespace":"default","selfLink":"/apis/rabbitmq.com/v1beta1/namespaces/default/rabbitmqclusters/rabbitmq-cluster/status","uid":"18d9928b-0d1c-47be-80ec-20960d053827","resourceVersion":"1215","generation":3,"creationTimestamp":"2022-03-18T18:00:38Z","annotations":{"kubectl.kubernetes.io/last-applied-configuration":"{\"apiVersion\":\"rabbitmq.com/v1beta1\",\"kind\":\"RabbitmqCluster\",\"metadata\":{\"annotations\":{},\"name\":\"rabbitmq-cluster\",\"namespace\":\"default\"},\"spec\":{\"persistence\":{\"storage\":\"10Gi\"},\"replicas\":1}}\n"},"finalizers":["deletion.finalizers.rabbitmqclusters.rabbitmq.com"],"managedFields":[{"manager":"kubectl-client-side-apply","operation":"Update","apiVersion":"rabbitmq.com/v1beta1","time":"2022-03-18T18:00:38Z","fieldsType":"FieldsV1","fieldsV1":{"f:metadata":{"f:annotations":{".":{},"f:kubectl.kubernetes.io/last-applied-configuration":{}}},"f:spec":{".":{},"f:image":{},"f:persistence":{".":{},"f:storage":{}},"f:resources":{".":{},"f:limits":{".":{},"f:memory":{}},"f:requests":{".":{},"f:memory":{}}},"f:service":{".":{},"f:type":{}},"f:terminationGracePeriodSeconds":{}}}},{"manager":"kubectl-patch","operation":"Update","apiVersion":"rabbitmq.com/v1beta1","time":"2022-03-18T18:01:23Z","fieldsType":"FieldsV1","fieldsV1":{"f:spec":{"f:replicas":{}}}},{"manager":"manager","operation":"Update","apiVersion":"rabbitmq.com/v1beta1","time":"2022-03-18T18:01:59Z","fieldsType":"FieldsV1","fieldsV1":{"f:metadata":{"f:finalizers":{}},"f:spec":{"f:override":{},"f:rabbitmq":{},"f:resources":{"f:limits":{"f:cpu":{}},"f:requests":{"f:cpu":{}}},"f:tls":{}},"f:status":{".":{},"f:conditions":{},"f:defaultUser":{".":{},"f:secretReference":{".":{},"f:keys":{".":{},"f:password":{},"f:username":{}},"f:name":{},"f:namespace":{}},"f:serviceReference":{".":{},"f:name":{},"f:namespace":{}}}}}}]},"spec":{"replicas":3,"image":"rabbitmq:3.8.12-management","service":{"type":"ClusterIP"},"persistence":{"storage":"10Gi"},"resources":{"limits":{"cpu":"2","memory":"2Gi"},"requests":{"cpu":"1","memory":"2Gi"}},"rabbitmq":{},"tls":{},"override":{},"terminationGracePeriodSeconds":604800},"status":{"conditions":[{"type":"AllReplicasReady","status":"False","lastTransitionTime":"2022-03-18T18:01:23Z","reason":"NotAllPodsReady","message":"2/3 Pods ready"},{"type":"ClusterAvailable","status":"True","lastTransitionTime":"2022-03-18T18:01:17Z","reason":"AtLeastOneEndpointAvailable"},{"type":"NoWarnings","status":"True","lastTransitionTime":"2022-03-18T18:00:38Z","reason":"NoWarnings"},{"type":"ReconcileSuccess","status":"True","lastTransitionTime":"2022-03-18T18:01:18Z","reason":"Success","message":"Finish reconciling"}],"defaultUser":{"secretReference":{"name":"rabbitmq-cluster-default-user","namespace":"default","keys":{"password":"password","username":"username"}},"serviceReference":{"name":"rabbitmq-cluster","namespace":"default"}}}}
2022/03/18 18:01:59 learn_server.go:291: [SIEVE-AFTER-READ]	Get	true	statefulset	default	rabbitmq-cluster-server	github.com/rabbitmq/cluster-operator/controllers.(*RabbitmqClusterReconciler)	NoError	{"kind":"StatefulSet","apiVersion":"apps/v1","metadata":{"name":"rabbitmq-cluster-server","namespace":"default","selfLink":"/apis/apps/v1/namespaces/default/statefulsets/rabbitmq-cluster-server","uid":"cb5c43bc-6ee7-481c-ab01-6f3acffdd3c8","resourceVersion":"1214","generation":2,"creationTimestamp":"2022-03-18T18:00:38Z","labels":{"app.kubernetes.io/component":"rabbitmq","app.kubernetes.io/name":"rabbitmq-cluster","app.kubernetes.io/part-of":"rabbitmq"},"ownerReferences":[{"apiVersion":"rabbitmq.com/v1beta1","kind":"RabbitmqCluster","name":"rabbitmq-cluster","uid":"18d9928b-0d1c-47be-80ec-20960d053827","controller":true,"blockOwnerDeletion":true}],"managedFields":[{"manager":"manager","operation":"Update","apiVersion":"apps/v1","time":"2022-03-18T18:01:23Z","fieldsType":"FieldsV1","fieldsV1":{"f:metadata":{"f:labels":{".":{},"f:app.kubernetes.io/component":{},"f:app.kubernetes.io/name":{},"f:app.kubernetes.io/part-of":{}},"f:ownerReferences":{".":{},"k:{\"uid\":\"18d9928b-0d1c-47be-80ec-20960d053827\"}":{".":{},"f:apiVersion":{},"f:blockOwnerDeletion":{},"f:controller":{},"f:kind":{},"f:name":{},"f:uid":{}}}},"f:spec":{"f:podManagementPolicy":{},"f:replicas":{},"f:revisionHistoryLimit":{},"f:selector":{"f:matchLabels":{".":{},"f:app.kubernetes.io/name":{}}},"f:serviceName":{},"f:template":{"f:metadata":{"f:annotations":{".":{},"f:prometheus.io/port":{},"f:prometheus.io/scrape":{}},"f:labels":{".":{},"f:app.kubernetes.io/component":{},"f:app.kubernetes.io/name":{},"f:app.kubernetes.io/part-of":{}}},"f:spec":{"f:automountServiceAccountToken":{},"f:containers":{"k:{\"name\":\"rabbitmq\"}":{".":{},"f:env":{".":{},"k:{\"name\":\"K8S_HOSTNAME_SUFFIX\"}":{".":{},"f:name":{},"f:value":{}},"k:{\"name\":\"K8S_SERVICE_NAME\"}":{".":{},"f:name":{},"f:value":{}},"k:{\"name\":\"MY_POD_NAME\"}":{".":{},"f:name":{},"f:valueFrom":{".":{},"f:fieldRef":{".":{},"f:apiVersion":{},"f:fieldPath":{}}}},"k:{\"name\":\"MY_POD_NAMESPACE\"}":{".":{},"f:name":{},"f:valueFrom":{".":{},"f:fieldRef":{".":{},"f:apiVersion":{},"f:fieldPath":{}}}},"k:{\"name\":\"RABBITMQ_ENABLED_PLUGINS_FILE\"}":{".":{},"f:name":{},"f:value":{}},"k:{\"name\":\"RABBITMQ_NODENAME\"}":{".":{},"f:name":{},"f:value":{}},"k:{\"name\":\"RABBITMQ_USE_LONGNAME\"}":{".":{},"f:name":{},"f:value":{}}},"f:image":{},"f:imagePullPolicy":{},"f:lifecycle":{".":{},"f:preStop":{".":{},"f:exec":{".":{},"f:command":{}}}},"f:name":{},"f:ports":{".":{},"k:{\"containerPort\":4369,\"protocol\":\"TCP\"}":{".":{},"f:containerPort":{},"f:name":{},"f:protocol":{}},"k:{\"containerPort\":5672,\"protocol\":\"TCP\"}":{".":{},"f:containerPort":{},"f:name":{},"f:protocol":{}},"k:{\"containerPort\":15672,\"protocol\":\"TCP\"}":{".":{},"f:containerPort":{},"f:name":{},"f:protocol":{}},"k:{\"containerPort\":15692,\"protocol\":\"TCP\"}":{".":{},"f:containerPort":{},"f:name":{},"f:protocol":{}}},"f:readinessProbe":{".":{},"f:failureThreshold":{},"f:initialDelaySeconds":{},"f:periodSeconds":{},"f:successThreshold":{},"f:tcpSocket":{".":{},"f:port":{}},"f:timeoutSeconds":{}},"f:resources":{".":{},"f:limits":{".":{},"f:cpu":{},"f:memory":{}},"f:requests":{".":{},"f:cpu":{},"f:memory":{}}},"f:terminationMessagePath":{},"f:terminationMessagePolicy":{},"f:volumeMounts":{".":{},"k:{\"mountPath\":\"/etc/pod-info/\"}":{".":{},"f:mountPath":{},"f:name":{}},"k:{\"mountPath\":\"/etc/rabbitmq/conf.d/10-operatorDefaults.conf\"}":{".":{},"f:mountPath":{},"f:name":{},"f:subPath":{}},"k:{\"mountPath\":\"/etc/rabbitmq/conf.d/11-default_user.conf\"}":{".":{},"f:mountPath":{},"f:name":{},"f:subPath":{}},"k:{\"mountPath\":\"/etc/rabbitmq/conf.d/90-userDefinedConfiguration.conf\"}":{".":{},"f:mountPath":{},"f:name":{},"f:subPath":{}},"k:{\"mountPath\":\"/operator\"}":{".":{},"f:mountPath":{},"f:name":{}},"k:{\"mountPath\":\"/var/lib/rabbitmq/\"}":{".":{},"f:mountPath":{},"f:name":{}},"k:{\"mountPath\":\"/var/lib/rabbitmq/mnesia/\"}":{".":{},"f:mountPath":{},"f:name":{}}}}},"f:dnsPolicy":{},"f:initContainers":{".":{},"k:{\"name\":\"setup-container\"}":{".":{},"f:command":{},"f:image":{},"f:imagePullPolicy":{},"f:name":{},"f:resources":{".":{},"f:limits":{".":{},"f:cpu":{},"f:memory":{}},"f:requests":{".":{},"f:cpu":{},"f:memory":{}}},"f:securityContext":{".":{},"f:capabilities":{".":{},"f:drop":{}},"f:runAsUser":{}},"f:terminationMessagePath":{},"f:terminationMessagePolicy":{},"f:volumeMounts":{".":{},"k:{\"mountPath\":\"/operator\"}":{".":{},"f:mountPath":{},"f:name":{}},"k:{\"mountPath\":\"/tmp/default_user.conf\"}":{".":{},"f:mountPath":{},"f:name":{},"f:subPath":{}},"k:{\"mountPath\":\"/tmp/erlang-cookie-secret/\"}":{".":{},"f:mountPath":{},"f:name":{}},"k:{\"mountPath\":\"/tmp/rabbitmq-plugins/\"}":{".":{},"f:mountPath":{},"f:name":{}},"k:{\"mountPath\":\"/var/lib/rabbitmq/\"}":{".":{},"f:mountPath":{},"f:name":{}},"k:{\"mountPath\":\"/var/lib/rabbitmq/mnesia/\"}":{".":{},"f:mountPath":{},"f:name":{}}}}},"f:restartPolicy":{},"f:schedulerName":{},"f:securityContext":{".":{},"f:fsGroup":{},"f:runAsGroup":{},"f:runAsUser":{}},"f:serviceAccount":{},"f:serviceAccountName":{},"f:terminationGracePeriodSeconds":{},"f:topologySpreadConstraints":{".":{},"k:{\"topologyKey\":\"topology.kubernetes.io/zone\",\"whenUnsatisfiable\":\"ScheduleAnyway\"}":{".":{},"f:labelSelector":{".":{},"f:matchLabels":{".":{},"f:app.kubernetes.io/name":{}}},"f:maxSkew":{},"f:topologyKey":{},"f:whenUnsatisfiable":{}}},"f:volumes":{".":{},"k:{\"name\":\"erlang-cookie-secret\"}":{".":{},"f:name":{},"f:secret":{".":{},"f:defaultMode":{},"f:secretName":{}}},"k:{\"name\":\"plugins-conf\"}":{".":{},"f:configMap":{".":{},"f:defaultMode":{},"f:name":{}},"f:name":{}},"k:{\"name\":\"pod-info\"}":{".":{},"f:downwardAPI":{".":{},"f:defaultMode":{},"f:items":{}},"f:name":{}},"k:{\"name\":\"rabbitmq-confd\"}":{".":{},"f:name":{},"f:projected":{".":{},"f:defaultMode":{},"f:sources":{}}},"k:{\"name\":\"rabbitmq-erlang-cookie\"}":{".":{},"f:emptyDir":{},"f:name":{}},"k:{\"name\":\"rabbitmq-plugins\"}":{".":{},"f:emptyDir":{},"f:name":{}}}}},"f:updateStrategy":{"f:rollingUpdate":{".":{},"f:partition":{}},"f:type":{}},"f:volumeClaimTemplates":{}}}},{"manager":"kube-controller-manager","operation":"Update","apiVersion":"apps/v1","time":"2022-03-18T18:01:59Z","fieldsType":"FieldsV1","fieldsV1":{"f:status":{"f:collisionCount":{},"f:currentReplicas":{},"f:currentRevision":{},"f:observedGeneration":{},"f:readyReplicas":{},"f:replicas":{},"f:updateRevision":{},"f:updatedReplicas":{}}}}]},"spec":{"replicas":3,"selector":{"matchLabels":{"app.kubernetes.io/name":"rabbitmq-cluster"}},"template":{"metadata":{"creationTimestamp":null,"labels":{"app.kubernetes.io/component":"rabbitmq","app.kubernetes.io/name":"rabbitmq-cluster","app.kubernetes.io/part-of":"rabbitmq"},"annotations":{"prometheus.io/port":"15692","prometheus.io/scrape":"true"}},"spec":{"volumes":[{"name":"plugins-conf","configMap":{"name":"rabbitmq-cluster-plugins-conf","defaultMode":420}},{"name":"rabbitmq-confd","projected":{"sources":[{"secret":{"name":"rabbitmq-cluster-default-user","items":[{"key":"default_user.conf","path":"default_user.conf"}]}},{"configMap":{"name":"rabbitmq-cluster-server-conf","items":[{"key":"operatorDefaults.conf","path":"operatorDefaults.conf"},{"key":"userDefinedConfiguration.conf","path":"userDefinedConfiguration.conf"}]}}],"defaultMode":420}},{"name":"rabbitmq-erlang-cookie","emptyDir":{}},{"name":"erlang-cookie-secret","secret":{"secretName":"rabbitmq-cluster-erlang-cookie","defaultMode":420}},{"name":"rabbitmq-plugins","emptyDir":{}},{"name":"pod-info","downwardAPI":{"items":[{"path":"skipPreStopChecks","fieldRef":{"apiVersion":"v1","fieldPath":"metadata.labels['skipPreStopChecks']"}}],"defaultMode":420}}],"initContainers":[{"name":"setup-container","image":"rabbitmq:3.8.12-management","command":["sh","-c","cp /tmp/erlang-cookie-secret/.erlang.cookie /var/lib/rabbitmq/.erlang.cookie \u0026\u0026 chown 999:999 /var/lib/rabbitmq/.erlang.cookie \u0026\u0026 chmod 600 /var/lib/rabbitmq/.erlang.cookie ; cp /tmp/rabbitmq-plugins/enabled_plugins /operator/enabled_plugins \u0026\u0026 chown 999:999 /operator/enabled_plugins ; chown 999:999 /var/lib/rabbitmq/mnesia/ ; echo '[default]' \u003e /var/lib/rabbitmq/.rabbitmqadmin.conf \u0026\u0026 sed -e 's/default_user/username/' -e 's/default_pass/password/' /tmp/default_user.conf \u003e\u003e /var/lib/rabbitmq/.rabbitmqadmin.conf \u0026\u0026 chown 999:999 /var/lib/rabbitmq/.rabbitmqadmin.conf \u0026\u0026 chmod 600 /var/lib/rabbitmq/.rabbitmqadmin.conf"],"resources":{"limits":{"cpu":"100m","memory":"500Mi"},"requests":{"cpu":"100m","memory":"500Mi"}},"volumeMounts":[{"name":"plugins-conf","mountPath":"/tmp/rabbitmq-plugins/"},{"name":"rabbitmq-erlang-cookie","mountPath":"/var/lib/rabbitmq/"},{"name":"erlang-cookie-secret","mountPath":"/tmp/erlang-cookie-secret/"},{"name":"rabbitmq-plugins","mountPath":"/operator"},{"name":"persistence","mountPath":"/var/lib/rabbitmq/mnesia/"},{"name":"rabbitmq-confd","mountPath":"/tmp/default_user.conf","subPath":"default_user.conf"}],"terminationMessagePath":"/dev/termination-log","terminationMessagePolicy":"File","imagePullPolicy":"IfNotPresent","securityContext":{"capabilities":{"drop":["FSETID","KILL","SETGID","SETUID","SETPCAP","NET_BIND_SERVICE","NET_RAW","SYS_CHROOT","MKNOD","AUDIT_WRITE","SETFCAP"]},"runAsUser":0}}],"containers":[{"name":"rabbitmq","image":"rabbitmq:3.8.12-management","ports":[{"name":"epmd","containerPort":4369,"protocol":"TCP"},{"name":"amqp","containerPort":5672,"protocol":"TCP"},{"name":"management","containerPort":15672,"protocol":"TCP"},{"name":"prometheus","containerPort":15692,"protocol":"TCP"}],"env":[{"name":"MY_POD_NAME","valueFrom":{"fieldRef":{"apiVersion":"v1","fieldPath":"metadata.name"}}},{"name":"MY_POD_NAMESPACE","valueFrom":{"fieldRef":{"apiVersion":"v1","fieldPath":"metadata.namespace"}}},{"name":"RABBITMQ_ENABLED_PLUGINS_FILE","value":"/operator/enabled_plugins"},{"name":"K8S_SERVICE_NAME","value":"rabbitmq-cluster-nodes"},{"name":"RABBITMQ_USE_LONGNAME","value":"true"},{"name":"RABBITMQ_NODENAME","value":"rabbit@$(MY_POD_NAME).$(K8S_SERVICE_NAME).$(MY_POD_NAMESPACE)"},{"name":"K8S_HOSTNAME_SUFFIX","value":".$(K8S_SERVICE_NAME).$(MY_POD_NAMESPACE)"}],"resources":{"limits":{"cpu":"2","memory":"2Gi"},"requests":{"cpu":"1","memory":"2Gi"}},"volumeMounts":[{"name":"rabbitmq-erlang-cookie","mountPath":"/var/lib/rabbitmq/"},{"name":"persistence","mountPath":"/var/lib/rabbitmq/mnesia/"},{"name":"rabbitmq-plugins","mountPath":"/operator"},{"name":"rabbitmq-confd","mountPath":"/etc/rabbitmq/conf.d/10-operatorDefaults.conf","subPath":"operatorDefaults.conf"},{"name":"rabbitmq-confd","mountPath":"/etc/rabbitmq/conf.d/11-default_user.conf","subPath":"default_user.conf"},{"name":"rabbitmq-confd","mountPath":"/etc/rabbitmq/conf.d/90-userDefinedConfiguration.conf","subPath":"userDefinedConfiguration.conf"},{"name":"pod-info","mountPath":"/etc/pod-info/"}],"readinessProbe":{"tcpSocket":{"port":"amqp"},"initialDelaySeconds":10,"timeoutSeconds":5,"periodSeconds":10,"successThreshold":1,"failureThreshold":3},"lifecycle":{"preStop":{"exec":{"command":["/bin/bash","-c","if [ ! -z \"$(cat /etc/pod-info/skipPreStopChecks)\" ]; then exit 0; fi; rabbitmq-upgrade await_online_quorum_plus_one -t 604800; rabbitmq-upgrade await_online_synchronized_mirror -t 604800; rabbitmq-upgrade drain -t 604800"]}}},"terminationMessagePath":"/dev/termination-log","terminationMessagePolicy":"File","imagePullPolicy":"IfNotPresent"}],"restartPolicy":"Always","terminationGracePeriodSeconds":604800,"dnsPolicy":"ClusterFirst","serviceAccountName":"rabbitmq-cluster-server","serviceAccount":"rabbitmq-cluster-server","automountServiceAccountToken":true,"securityContext":{"runAsUser":999,"runAsGroup":999,"fsGroup":999},"schedulerName":"default-scheduler","topologySpreadConstraints":[{"maxSkew":1,"topologyKey":"topology.kubernetes.io/zone","whenUnsatisfiable":"ScheduleAnyway","labelSelector":{"matchLabels":{"app.kubernetes.io/name":"rabbitmq-cluster"}}}]}},"volumeClaimTemplates":[{"metadata":{"name":"persistence","namespace":"default","creationTimestamp":null,"labels":{"app.kubernetes.io/component":"rabbitmq","app.kubernetes.io/name":"rabbitmq-cluster","app.kubernetes.io/part-of":"rabbitmq"},"ownerReferences":[{"apiVersion":"rabbitmq.com/v1beta1","kind":"RabbitmqCluster","name":"rabbitmq-cluster","uid":"18d9928b-0d1c-47be-80ec-20960d053827","controller":true,"blockOwnerDeletion":false}]},"spec":{"accessModes":["ReadWriteOnce"],"resources":{"requests":{"storage":"10Gi"}},"volumeMode":"Filesystem"},"status":{"phase":"Pending"}}],"serviceName":"rabbitmq-cluster-nodes","podManagementPolicy":"Parallel","updateStrategy":{"type":"RollingUpdate","rollingUpdate":{"partition":0}},"revisionHistoryLimit":10},"status":{"observedGeneration":2,"replicas":3,"readyReplicas":2,"currentReplicas":3,"updatedReplicas":3,"currentRevision":"rabbitmq-cluster-server-5f8b8665fb","updateRevision":"rabbitmq-cluster-server-5f8b8665fb","collisionCount":0}}
2022/03/18 18:01:59 learn_server.go:291: [SIEVE-AFTER-READ]	Get	true	service	default	rabbitmq-cluster-nodes	github.com/rabbitmq/cluster-operator/controllers.(*RabbitmqClusterReconciler)	NoError	{"kind":"Service","apiVersion":"v1","metadata":{"name":"rabbitmq-cluster-nodes","namespace":"default","selfLink":"/api/v1/namespaces/default/services/rabbitmq-cluster-nodes","uid":"67c7eea9-1b87-4fd7-82e6-5bfe31fd1b52","resourceVersion":"696","creationTimestamp":"2022-03-18T18:00:38Z","labels":{"app.kubernetes.io/component":"rabbitmq","app.kubernetes.io/name":"rabbitmq-cluster","app.kubernetes.io/part-of":"rabbitmq"},"ownerReferences":[{"apiVersion":"rabbitmq.com/v1beta1","kind":"RabbitmqCluster","name":"rabbitmq-cluster","uid":"18d9928b-0d1c-47be-80ec-20960d053827","controller":true,"blockOwnerDeletion":true}],"managedFields":[{"manager":"manager","operation":"Update","apiVersion":"v1","time":"2022-03-18T18:00:38Z","fieldsType":"FieldsV1","fieldsV1":{"f:metadata":{"f:labels":{".":{},"f:app.kubernetes.io/component":{},"f:app.kubernetes.io/name":{},"f:app.kubernetes.io/part-of":{}},"f:ownerReferences":{".":{},"k:{\"uid\":\"18d9928b-0d1c-47be-80ec-20960d053827\"}":{".":{},"f:apiVersion":{},"f:blockOwnerDeletion":{},"f:controller":{},"f:kind":{},"f:name":{},"f:uid":{}}}},"f:spec":{"f:clusterIP":{},"f:ports":{".":{},"k:{\"port\":4369,\"protocol\":\"TCP\"}":{".":{},"f:name":{},"f:port":{},"f:protocol":{},"f:targetPort":{}},"k:{\"port\":25672,\"protocol\":\"TCP\"}":{".":{},"f:name":{},"f:port":{},"f:protocol":{},"f:targetPort":{}}},"f:publishNotReadyAddresses":{},"f:selector":{".":{},"f:app.kubernetes.io/name":{}},"f:sessionAffinity":{},"f:type":{}}}}]},"spec":{"ports":[{"name":"epmd","protocol":"TCP","port":4369,"targetPort":4369},{"name":"cluster-rpc","protocol":"TCP","port":25672,"targetPort":25672}],"selector":{"app.kubernetes.io/name":"rabbitmq-cluster"},"clusterIP":"None","type":"ClusterIP","sessionAffinity":"None","publishNotReadyAddresses":true},"status":{"loadBalancer":{}}}
2022/03/18 18:01:59 learn_server.go:291: [SIEVE-AFTER-READ]	Get	true	service	default	rabbitmq-cluster	github.com/rabbitmq/cluster-operator/controllers.(*RabbitmqClusterReconciler)	NoError	{"kind":"Service","apiVersion":"v1","metadata":{"name":"rabbitmq-cluster","namespace":"default","selfLink":"/api/v1/namespaces/default/services/rabbitmq-cluster","uid":"56b50671-1945-458b-adac-05619b783392","resourceVersion":"701","creationTimestamp":"2022-03-18T18:00:38Z","labels":{"app.kubernetes.io/component":"rabbitmq","app.kubernetes.io/name":"rabbitmq-cluster","app.kubernetes.io/part-of":"rabbitmq"},"ownerReferences":[{"apiVersion":"rabbitmq.com/v1beta1","kind":"RabbitmqCluster","name":"rabbitmq-cluster","uid":"18d9928b-0d1c-47be-80ec-20960d053827","controller":true,"blockOwnerDeletion":true}],"managedFields":[{"manager":"manager","operation":"Update","apiVersion":"v1","time":"2022-03-18T18:00:38Z","fieldsType":"FieldsV1","fieldsV1":{"f:metadata":{"f:labels":{".":{},"f:app.kubernetes.io/component":{},"f:app.kubernetes.io/name":{},"f:app.kubernetes.io/part-of":{}},"f:ownerReferences":{".":{},"k:{\"uid\":\"18d9928b-0d1c-47be-80ec-20960d053827\"}":{".":{},"f:apiVersion":{},"f:blockOwnerDeletion":{},"f:controller":{},"f:kind":{},"f:name":{},"f:uid":{}}}},"f:spec":{"f:ports":{".":{},"k:{\"port\":5672,\"protocol\":\"TCP\"}":{".":{},"f:name":{},"f:port":{},"f:protocol":{},"f:targetPort":{}},"k:{\"port\":15672,\"protocol\":\"TCP\"}":{".":{},"f:name":{},"f:port":{},"f:protocol":{},"f:targetPort":{}}},"f:selector":{".":{},"f:app.kubernetes.io/name":{}},"f:sessionAffinity":{},"f:type":{}}}}]},"spec":{"ports":[{"name":"amqp","protocol":"TCP","port":5672,"targetPort":5672},{"name":"management","protocol":"TCP","port":15672,"targetPort":15672}],"selector":{"app.kubernetes.io/name":"rabbitmq-cluster"},"clusterIP":"10.96.254.158","type":"ClusterIP","sessionAffinity":"None"},"status":{"loadBalancer":{}}}
2022/03/18 18:01:59 learn_server.go:291: [SIEVE-AFTER-READ]	Get	true	secret	default	rabbitmq-cluster-erlang-cookie	github.com/rabbitmq/cluster-operator/controllers.(*RabbitmqClusterReconciler)	NoError	{"kind":"Secret","apiVersion":"v1","metadata":{"name":"rabbitmq-cluster-erlang-cookie","namespace":"default","selfLink":"/api/v1/namespaces/default/secrets/rabbitmq-cluster-erlang-cookie","uid":"f8fbe8a6-0f40-4e13-960b-ab78b8ba75b0","resourceVersion":"705","creationTimestamp":"2022-03-18T18:00:38Z","labels":{"app.kubernetes.io/component":"rabbitmq","app.kubernetes.io/name":"rabbitmq-cluster","app.kubernetes.io/part-of":"rabbitmq"},"ownerReferences":[{"apiVersion":"rabbitmq.com/v1beta1","kind":"RabbitmqCluster","name":"rabbitmq-cluster","uid":"18d9928b-0d1c-47be-80ec-20960d053827","controller":true,"blockOwnerDeletion":true}],"managedFields":[{"manager":"manager","operation":"Update","apiVersion":"v1","time":"2022-03-18T18:00:38Z","fieldsType":"FieldsV1","fieldsV1":{"f:data":{".":{},"f:.erlang.cookie":{}},"f:metadata":{"f:labels":{".":{},"f:app.kubernetes.io/component":{},"f:app.kubernetes.io/name":{},"f:app.kubernetes.io/part-of":{}},"f:ownerReferences":{".":{},"k:{\"uid\":\"18d9928b-0d1c-47be-80ec-20960d053827\"}":{".":{},"f:apiVersion":{},"f:blockOwnerDeletion":{},"f:controller":{},"f:kind":{},"f:name":{},"f:uid":{}}}},"f:type":{}}}]},"data":{".erlang.cookie":"QW9hMkpWU0tlYS1FUGdWTUhrelNMNnFoMFZ0ZmRGNUY="},"type":"Opaque"}
2022/03/18 18:01:59 learn_server.go:291: [SIEVE-AFTER-READ]	Get	true	secret	default	rabbitmq-cluster-default-user	github.com/rabbitmq/cluster-operator/controllers.(*RabbitmqClusterReconciler)	NoError	{"kind":"Secret","apiVersion":"v1","metadata":{"name":"rabbitmq-cluster-default-user","namespace":"default","selfLink":"/api/v1/namespaces/default/secrets/rabbitmq-cluster-default-user","uid":"0d9f460b-a23c-402b-8273-f541ed39023f","resourceVersion":"708","creationTimestamp":"2022-03-18T18:00:38Z","labels":{"app.kubernetes.io/component":"rabbitmq","app.kubernetes.io/name":"rabbitmq-cluster","app.kubernetes.io/part-of":"rabbitmq"},"ownerReferences":[{"apiVersion":"rabbitmq.com/v1beta1","kind":"RabbitmqCluster","name":"rabbitmq-cluster","uid":"18d9928b-0d1c-47be-80ec-20960d053827","controller":true,"blockOwnerDeletion":true}],"managedFields":[{"manager":"manager","operation":"Update","apiVersion":"v1","time":"2022-03-18T18:00:38Z","fieldsType":"FieldsV1","fieldsV1":{"f:data":{".":{},"f:default_user.conf":{},"f:password":{},"f:provider":{},"f:type":{},"f:username":{}},"f:metadata":{"f:labels":{".":{},"f:app.kubernetes.io/component":{},"f:app.kubernetes.io/name":{},"f:app.kubernetes.io/part-of":{}},"f:ownerReferences":{".":{},"k:{\"uid\":\"18d9928b-0d1c-47be-80ec-20960d053827\"}":{".":{},"f:apiVersion":{},"f:blockOwnerDeletion":{},"f:controller":{},"f:kind":{},"f:name":{},"f:uid":{}}}},"f:type":{}}}]},"data":{"default_user.conf":"ZGVmYXVsdF91c2VyID0gcTMxRmh3MGtjWW9SZUl5X3BPTXp2ZVBOUnNVU3I1Mk8KZGVmYXVsdF9wYXNzID0gY0dBX19jNTJHX05hVURpTGhraWZ6UDBOVVlNLTE2MWQK","password":"Y0dBX19jNTJHX05hVURpTGhraWZ6UDBOVVlNLTE2MWQ=","provider":"cmFiYml0bXE=","type":"cmFiYml0bXE=","username":"cTMxRmh3MGtjWW9SZUl5X3BPTXp2ZVBOUnNVU3I1Mk8="},"type":"Opaque"}
2022/03/18 18:01:59 learn_server.go:291: [SIEVE-AFTER-READ]	Get	true	configmap	default	rabbitmq-cluster-plugins-conf	github.com/rabbitmq/cluster-operator/controllers.(*RabbitmqClusterReconciler)	NoError	{"kind":"ConfigMap","apiVersion":"v1","metadata":{"name":"rabbitmq-cluster-plugins-conf","namespace":"default","selfLink":"/api/v1/namespaces/default/configmaps/rabbitmq-cluster-plugins-conf","uid":"a164075b-0562-47ac-a577-99aa8651ec40","resourceVersion":"709","creationTimestamp":"2022-03-18T18:00:38Z","labels":{"app.kubernetes.io/component":"rabbitmq","app.kubernetes.io/name":"rabbitmq-cluster","app.kubernetes.io/part-of":"rabbitmq"},"ownerReferences":[{"apiVersion":"rabbitmq.com/v1beta1","kind":"RabbitmqCluster","name":"rabbitmq-cluster","uid":"18d9928b-0d1c-47be-80ec-20960d053827","controller":true,"blockOwnerDeletion":true}],"managedFields":[{"manager":"manager","operation":"Update","apiVersion":"v1","time":"2022-03-18T18:00:38Z","fieldsType":"FieldsV1","fieldsV1":{"f:data":{".":{},"f:enabled_plugins":{}},"f:metadata":{"f:labels":{".":{},"f:app.kubernetes.io/component":{},"f:app.kubernetes.io/name":{},"f:app.kubernetes.io/part-of":{}},"f:ownerReferences":{".":{},"k:{\"uid\":\"18d9928b-0d1c-47be-80ec-20960d053827\"}":{".":{},"f:apiVersion":{},"f:blockOwnerDeletion":{},"f:controller":{},"f:kind":{},"f:name":{},"f:uid":{}}}}}}]},"data":{"enabled_plugins":"[rabbitmq_peer_discovery_k8s,rabbitmq_prometheus,rabbitmq_management]."}}
2022/03/18 18:01:59 learn_server.go:291: [SIEVE-AFTER-READ]	Get	true	configmap	default	rabbitmq-cluster-server-conf	github.com/rabbitmq/cluster-operator/controllers.(*RabbitmqClusterReconciler)	NoError	{"kind":"ConfigMap","apiVersion":"v1","metadata":{"name":"rabbitmq-cluster-server-conf","namespace":"default","selfLink":"/api/v1/namespaces/default/configmaps/rabbitmq-cluster-server-conf","uid":"22474f2b-8454-44b7-8079-8990223969cc","resourceVersion":"714","creationTimestamp":"2022-03-18T18:00:38Z","labels":{"app.kubernetes.io/component":"rabbitmq","app.kubernetes.io/name":"rabbitmq-cluster","app.kubernetes.io/part-of":"rabbitmq"},"ownerReferences":[{"apiVersion":"rabbitmq.com/v1beta1","kind":"RabbitmqCluster","name":"rabbitmq-cluster","uid":"18d9928b-0d1c-47be-80ec-20960d053827","controller":true,"blockOwnerDeletion":true}],"managedFields":[{"manager":"manager","operation":"Update","apiVersion":"v1","time":"2022-03-18T18:00:38Z","fieldsType":"FieldsV1","fieldsV1":{"f:data":{".":{},"f:operatorDefaults.conf":{},"f:userDefinedConfiguration.conf":{}},"f:metadata":{"f:labels":{".":{},"f:app.kubernetes.io/component":{},"f:app.kubernetes.io/name":{},"f:app.kubernetes.io/part-of":{}},"f:ownerReferences":{".":{},"k:{\"uid\":\"18d9928b-0d1c-47be-80ec-20960d053827\"}":{".":{},"f:apiVersion":{},"f:blockOwnerDeletion":{},"f:controller":{},"f:kind":{},"f:name":{},"f:uid":{}}}}}}]},"data":{"operatorDefaults.conf":"cluster_formation.peer_discovery_backend             = rabbit_peer_discovery_k8s\ncluster_formation.k8s.host                           = kubernetes.default\ncluster_formation.k8s.address_type                   = hostname\ncluster_partition_handling                           = pause_minority\nqueue_master_locator                                 = min-masters\ndisk_free_limit.absolute                             = 2GB\ncluster_formation.randomized_startup_delay_range.min = 5\ncluster_formation.randomized_startup_delay_range.max = 30\ncluster_name                                         = rabbitmq-cluster\n","userDefinedConfiguration.conf":"total_memory_available_override_value = 1717986919\n"}}
2022/03/18 18:01:59 learn_server.go:291: [SIEVE-AFTER-READ]	Get	true	serviceaccount	default	rabbitmq-cluster-server	github.com/rabbitmq/cluster-operator/controllers.(*RabbitmqClusterReconciler)	NoError	{"kind":"ServiceAccount","apiVersion":"v1","metadata":{"name":"rabbitmq-cluster-server","namespace":"default","selfLink":"/api/v1/namespaces/default/serviceaccounts/rabbitmq-cluster-server","uid":"731589b5-ac97-4774-bee4-008949b54734","resourceVersion":"722","creationTimestamp":"2022-03-18T18:00:38Z","labels":{"app.kubernetes.io/component":"rabbitmq","app.kubernetes.io/name":"rabbitmq-cluster","app.kubernetes.io/part-of":"rabbitmq"},"ownerReferences":[{"apiVersion":"rabbitmq.com/v1beta1","kind":"RabbitmqCluster","name":"rabbitmq-cluster","uid":"18d9928b-0d1c-47be-80ec-20960d053827","controller":true,"blockOwnerDeletion":true}],"managedFields":[{"manager":"kube-controller-manager","operation":"Update","apiVersion":"v1","time":"2022-03-18T18:00:38Z","fieldsType":"FieldsV1","fieldsV1":{"f:secrets":{".":{},"k:{\"name\":\"rabbitmq-cluster-server-token-rhzq9\"}":{".":{},"f:name":{}}}}},{"manager":"manager","operation":"Update","apiVersion":"v1","time":"2022-03-18T18:00:38Z","fieldsType":"FieldsV1","fieldsV1":{"f:metadata":{"f:labels":{".":{},"f:app.kubernetes.io/component":{},"f:app.kubernetes.io/name":{},"f:app.kubernetes.io/part-of":{}},"f:ownerReferences":{".":{},"k:{\"uid\":\"18d9928b-0d1c-47be-80ec-20960d053827\"}":{".":{},"f:apiVersion":{},"f:blockOwnerDeletion":{},"f:controller":{},"f:kind":{},"f:name":{},"f:uid":{}}}}}}]},"secrets":[{"name":"rabbitmq-cluster-server-token-rhzq9"}]}
2022/03/18 18:01:59 learn_server.go:291: [SIEVE-AFTER-READ]	Get	true	role	default	rabbitmq-cluster-peer-discovery	github.com/rabbitmq/cluster-operator/controllers.(*RabbitmqClusterReconciler)	NoError	{"kind":"Role","apiVersion":"rbac.authorization.k8s.io/v1","metadata":{"name":"rabbitmq-cluster-peer-discovery","namespace":"default","selfLink":"/apis/rbac.authorization.k8s.io/v1/namespaces/default/roles/rabbitmq-cluster-peer-discovery","uid":"52c80b50-4fdd-4089-bbfd-9756465953f2","resourceVersion":"723","creationTimestamp":"2022-03-18T18:00:38Z","labels":{"app.kubernetes.io/component":"rabbitmq","app.kubernetes.io/name":"rabbitmq-cluster","app.kubernetes.io/part-of":"rabbitmq"},"ownerReferences":[{"apiVersion":"rabbitmq.com/v1beta1","kind":"RabbitmqCluster","name":"rabbitmq-cluster","uid":"18d9928b-0d1c-47be-80ec-20960d053827","controller":true,"blockOwnerDeletion":true}],"managedFields":[{"manager":"manager","operation":"Update","apiVersion":"rbac.authorization.k8s.io/v1","time":"2022-03-18T18:00:38Z","fieldsType":"FieldsV1","fieldsV1":{"f:metadata":{"f:labels":{".":{},"f:app.kubernetes.io/component":{},"f:app.kubernetes.io/name":{},"f:app.kubernetes.io/part-of":{}},"f:ownerReferences":{".":{},"k:{\"uid\":\"18d9928b-0d1c-47be-80ec-20960d053827\"}":{".":{},"f:apiVersion":{},"f:blockOwnerDeletion":{},"f:controller":{},"f:kind":{},"f:name":{},"f:uid":{}}}},"f:rules":{}}}]},"rules":[{"verbs":["get"],"apiGroups":[""],"resources":["endpoints"]},{"verbs":["create"],"apiGroups":[""],"resources":["events"]}]}
2022/03/18 18:01:59 learn_server.go:291: [SIEVE-AFTER-READ]	Get	true	rolebinding	default	rabbitmq-cluster-server	github.com/rabbitmq/cluster-operator/controllers.(*RabbitmqClusterReconciler)	NoError	{"kind":"RoleBinding","apiVersion":"rbac.authorization.k8s.io/v1","metadata":{"name":"rabbitmq-cluster-server","namespace":"default","selfLink":"/apis/rbac.authorization.k8s.io/v1/namespaces/default/rolebindings/rabbitmq-cluster-server","uid":"495e9f7c-a20d-4515-86b0-34149a855034","resourceVersion":"725","creationTimestamp":"2022-03-18T18:00:38Z","labels":{"app.kubernetes.io/component":"rabbitmq","app.kubernetes.io/name":"rabbitmq-cluster","app.kubernetes.io/part-of":"rabbitmq"},"ownerReferences":[{"apiVersion":"rabbitmq.com/v1beta1","kind":"RabbitmqCluster","name":"rabbitmq-cluster","uid":"18d9928b-0d1c-47be-80ec-20960d053827","controller":true,"blockOwnerDeletion":true}],"managedFields":[{"manager":"manager","operation":"Update","apiVersion":"rbac.authorization.k8s.io/v1","time":"2022-03-18T18:00:38Z","fieldsType":"FieldsV1","fieldsV1":{"f:metadata":{"f:labels":{".":{},"f:app.kubernetes.io/component":{},"f:app.kubernetes.io/name":{},"f:app.kubernetes.io/part-of":{}},"f:ownerReferences":{".":{},"k:{\"uid\":\"18d9928b-0d1c-47be-80ec-20960d053827\"}":{".":{},"f:apiVersion":{},"f:blockOwnerDeletion":{},"f:controller":{},"f:kind":{},"f:name":{},"f:uid":{}}}},"f:roleRef":{"f:apiGroup":{},"f:kind":{},"f:name":{}},"f:subjects":{}}}]},"subjects":[{"kind":"ServiceAccount","name":"rabbitmq-cluster-server"}],"roleRef":{"apiGroup":"rbac.authorization.k8s.io","kind":"Role","name":"rabbitmq-cluster-peer-discovery"}}
2022/03/18 18:01:59 learn_server.go:291: [SIEVE-AFTER-READ]	Get	true	statefulset	default	rabbitmq-cluster-server	github.com/rabbitmq/cluster-operator/controllers.(*RabbitmqClusterReconciler)	NoError	{"kind":"StatefulSet","apiVersion":"apps/v1","metadata":{"name":"rabbitmq-cluster-server","namespace":"default","selfLink":"/apis/apps/v1/namespaces/default/statefulsets/rabbitmq-cluster-server","uid":"cb5c43bc-6ee7-481c-ab01-6f3acffdd3c8","resourceVersion":"1214","generation":2,"creationTimestamp":"2022-03-18T18:00:38Z","labels":{"app.kubernetes.io/component":"rabbitmq","app.kubernetes.io/name":"rabbitmq-cluster","app.kubernetes.io/part-of":"rabbitmq"},"ownerReferences":[{"apiVersion":"rabbitmq.com/v1beta1","kind":"RabbitmqCluster","name":"rabbitmq-cluster","uid":"18d9928b-0d1c-47be-80ec-20960d053827","controller":true,"blockOwnerDeletion":true}],"managedFields":[{"manager":"manager","operation":"Update","apiVersion":"apps/v1","time":"2022-03-18T18:01:23Z","fieldsType":"FieldsV1","fieldsV1":{"f:metadata":{"f:labels":{".":{},"f:app.kubernetes.io/component":{},"f:app.kubernetes.io/name":{},"f:app.kubernetes.io/part-of":{}},"f:ownerReferences":{".":{},"k:{\"uid\":\"18d9928b-0d1c-47be-80ec-20960d053827\"}":{".":{},"f:apiVersion":{},"f:blockOwnerDeletion":{},"f:controller":{},"f:kind":{},"f:name":{},"f:uid":{}}}},"f:spec":{"f:podManagementPolicy":{},"f:replicas":{},"f:revisionHistoryLimit":{},"f:selector":{"f:matchLabels":{".":{},"f:app.kubernetes.io/name":{}}},"f:serviceName":{},"f:template":{"f:metadata":{"f:annotations":{".":{},"f:prometheus.io/port":{},"f:prometheus.io/scrape":{}},"f:labels":{".":{},"f:app.kubernetes.io/component":{},"f:app.kubernetes.io/name":{},"f:app.kubernetes.io/part-of":{}}},"f:spec":{"f:automountServiceAccountToken":{},"f:containers":{"k:{\"name\":\"rabbitmq\"}":{".":{},"f:env":{".":{},"k:{\"name\":\"K8S_HOSTNAME_SUFFIX\"}":{".":{},"f:name":{},"f:value":{}},"k:{\"name\":\"K8S_SERVICE_NAME\"}":{".":{},"f:name":{},"f:value":{}},"k:{\"name\":\"MY_POD_NAME\"}":{".":{},"f:name":{},"f:valueFrom":{".":{},"f:fieldRef":{".":{},"f:apiVersion":{},"f:fieldPath":{}}}},"k:{\"name\":\"MY_POD_NAMESPACE\"}":{".":{},"f:name":{},"f:valueFrom":{".":{},"f:fieldRef":{".":{},"f:apiVersion":{},"f:fieldPath":{}}}},"k:{\"name\":\"RABBITMQ_ENABLED_PLUGINS_FILE\"}":{".":{},"f:name":{},"f:value":{}},"k:{\"name\":\"RABBITMQ_NODENAME\"}":{".":{},"f:name":{},"f:value":{}},"k:{\"name\":\"RABBITMQ_USE_LONGNAME\"}":{".":{},"f:name":{},"f:value":{}}},"f:image":{},"f:imagePullPolicy":{},"f:lifecycle":{".":{},"f:preStop":{".":{},"f:exec":{".":{},"f:command":{}}}},"f:name":{},"f:ports":{".":{},"k:{\"containerPort\":4369,\"protocol\":\"TCP\"}":{".":{},"f:containerPort":{},"f:name":{},"f:protocol":{}},"k:{\"containerPort\":5672,\"protocol\":\"TCP\"}":{".":{},"f:containerPort":{},"f:name":{},"f:protocol":{}},"k:{\"containerPort\":15672,\"protocol\":\"TCP\"}":{".":{},"f:containerPort":{},"f:name":{},"f:protocol":{}},"k:{\"containerPort\":15692,\"protocol\":\"TCP\"}":{".":{},"f:containerPort":{},"f:name":{},"f:protocol":{}}},"f:readinessProbe":{".":{},"f:failureThreshold":{},"f:initialDelaySeconds":{},"f:periodSeconds":{},"f:successThreshold":{},"f:tcpSocket":{".":{},"f:port":{}},"f:timeoutSeconds":{}},"f:resources":{".":{},"f:limits":{".":{},"f:cpu":{},"f:memory":{}},"f:requests":{".":{},"f:cpu":{},"f:memory":{}}},"f:terminationMessagePath":{},"f:terminationMessagePolicy":{},"f:volumeMounts":{".":{},"k:{\"mountPath\":\"/etc/pod-info/\"}":{".":{},"f:mountPath":{},"f:name":{}},"k:{\"mountPath\":\"/etc/rabbitmq/conf.d/10-operatorDefaults.conf\"}":{".":{},"f:mountPath":{},"f:name":{},"f:subPath":{}},"k:{\"mountPath\":\"/etc/rabbitmq/conf.d/11-default_user.conf\"}":{".":{},"f:mountPath":{},"f:name":{},"f:subPath":{}},"k:{\"mountPath\":\"/etc/rabbitmq/conf.d/90-userDefinedConfiguration.conf\"}":{".":{},"f:mountPath":{},"f:name":{},"f:subPath":{}},"k:{\"mountPath\":\"/operator\"}":{".":{},"f:mountPath":{},"f:name":{}},"k:{\"mountPath\":\"/var/lib/rabbitmq/\"}":{".":{},"f:mountPath":{},"f:name":{}},"k:{\"mountPath\":\"/var/lib/rabbitmq/mnesia/\"}":{".":{},"f:mountPath":{},"f:name":{}}}}},"f:dnsPolicy":{},"f:initContainers":{".":{},"k:{\"name\":\"setup-container\"}":{".":{},"f:command":{},"f:image":{},"f:imagePullPolicy":{},"f:name":{},"f:resources":{".":{},"f:limits":{".":{},"f:cpu":{},"f:memory":{}},"f:requests":{".":{},"f:cpu":{},"f:memory":{}}},"f:securityContext":{".":{},"f:capabilities":{".":{},"f:drop":{}},"f:runAsUser":{}},"f:terminationMessagePath":{},"f:terminationMessagePolicy":{},"f:volumeMounts":{".":{},"k:{\"mountPath\":\"/operator\"}":{".":{},"f:mountPath":{},"f:name":{}},"k:{\"mountPath\":\"/tmp/default_user.conf\"}":{".":{},"f:mountPath":{},"f:name":{},"f:subPath":{}},"k:{\"mountPath\":\"/tmp/erlang-cookie-secret/\"}":{".":{},"f:mountPath":{},"f:name":{}},"k:{\"mountPath\":\"/tmp/rabbitmq-plugins/\"}":{".":{},"f:mountPath":{},"f:name":{}},"k:{\"mountPath\":\"/var/lib/rabbitmq/\"}":{".":{},"f:mountPath":{},"f:name":{}},"k:{\"mountPath\":\"/var/lib/rabbitmq/mnesia/\"}":{".":{},"f:mountPath":{},"f:name":{}}}}},"f:restartPolicy":{},"f:schedulerName":{},"f:securityContext":{".":{},"f:fsGroup":{},"f:runAsGroup":{},"f:runAsUser":{}},"f:serviceAccount":{},"f:serviceAccountName":{},"f:terminationGracePeriodSeconds":{},"f:topologySpreadConstraints":{".":{},"k:{\"topologyKey\":\"topology.kubernetes.io/zone\",\"whenUnsatisfiable\":\"ScheduleAnyway\"}":{".":{},"f:labelSelector":{".":{},"f:matchLabels":{".":{},"f:app.kubernetes.io/name":{}}},"f:maxSkew":{},"f:topologyKey":{},"f:whenUnsatisfiable":{}}},"f:volumes":{".":{},"k:{\"name\":\"erlang-cookie-secret\"}":{".":{},"f:name":{},"f:secret":{".":{},"f:defaultMode":{},"f:secretName":{}}},"k:{\"name\":\"plugins-conf\"}":{".":{},"f:configMap":{".":{},"f:defaultMode":{},"f:name":{}},"f:name":{}},"k:{\"name\":\"pod-info\"}":{".":{},"f:downwardAPI":{".":{},"f:defaultMode":{},"f:items":{}},"f:name":{}},"k:{\"name\":\"rabbitmq-confd\"}":{".":{},"f:name":{},"f:projected":{".":{},"f:defaultMode":{},"f:sources":{}}},"k:{\"name\":\"rabbitmq-erlang-cookie\"}":{".":{},"f:emptyDir":{},"f:name":{}},"k:{\"name\":\"rabbitmq-plugins\"}":{".":{},"f:emptyDir":{},"f:name":{}}}}},"f:updateStrategy":{"f:rollingUpdate":{".":{},"f:partition":{}},"f:type":{}},"f:volumeClaimTemplates":{}}}},{"manager":"kube-controller-manager","operation":"Update","apiVersion":"apps/v1","time":"2022-03-18T18:01:59Z","fieldsType":"FieldsV1","fieldsV1":{"f:status":{"f:collisionCount":{},"f:currentReplicas":{},"f:currentRevision":{},"f:observedGeneration":{},"f:readyReplicas":{},"f:replicas":{},"f:updateRevision":{},"f:updatedReplicas":{}}}}]},"spec":{"replicas":3,"selector":{"matchLabels":{"app.kubernetes.io/name":"rabbitmq-cluster"}},"template":{"metadata":{"creationTimestamp":null,"labels":{"app.kubernetes.io/component":"rabbitmq","app.kubernetes.io/name":"rabbitmq-cluster","app.kubernetes.io/part-of":"rabbitmq"},"annotations":{"prometheus.io/port":"15692","prometheus.io/scrape":"true"}},"spec":{"volumes":[{"name":"plugins-conf","configMap":{"name":"rabbitmq-cluster-plugins-conf","defaultMode":420}},{"name":"rabbitmq-confd","projected":{"sources":[{"secret":{"name":"rabbitmq-cluster-default-user","items":[{"key":"default_user.conf","path":"default_user.conf"}]}},{"configMap":{"name":"rabbitmq-cluster-server-conf","items":[{"key":"operatorDefaults.conf","path":"operatorDefaults.conf"},{"key":"userDefinedConfiguration.conf","path":"userDefinedConfiguration.conf"}]}}],"defaultMode":420}},{"name":"rabbitmq-erlang-cookie","emptyDir":{}},{"name":"erlang-cookie-secret","secret":{"secretName":"rabbitmq-cluster-erlang-cookie","defaultMode":420}},{"name":"rabbitmq-plugins","emptyDir":{}},{"name":"pod-info","downwardAPI":{"items":[{"path":"skipPreStopChecks","fieldRef":{"apiVersion":"v1","fieldPath":"metadata.labels['skipPreStopChecks']"}}],"defaultMode":420}}],"initContainers":[{"name":"setup-container","image":"rabbitmq:3.8.12-management","command":["sh","-c","cp /tmp/erlang-cookie-secret/.erlang.cookie /var/lib/rabbitmq/.erlang.cookie \u0026\u0026 chown 999:999 /var/lib/rabbitmq/.erlang.cookie \u0026\u0026 chmod 600 /var/lib/rabbitmq/.erlang.cookie ; cp /tmp/rabbitmq-plugins/enabled_plugins /operator/enabled_plugins \u0026\u0026 chown 999:999 /operator/enabled_plugins ; chown 999:999 /var/lib/rabbitmq/mnesia/ ; echo '[default]' \u003e /var/lib/rabbitmq/.rabbitmqadmin.conf \u0026\u0026 sed -e 's/default_user/username/' -e 's/default_pass/password/' /tmp/default_user.conf \u003e\u003e /var/lib/rabbitmq/.rabbitmqadmin.conf \u0026\u0026 chown 999:999 /var/lib/rabbitmq/.rabbitmqadmin.conf \u0026\u0026 chmod 600 /var/lib/rabbitmq/.rabbitmqadmin.conf"],"resources":{"limits":{"cpu":"100m","memory":"500Mi"},"requests":{"cpu":"100m","memory":"500Mi"}},"volumeMounts":[{"name":"plugins-conf","mountPath":"/tmp/rabbitmq-plugins/"},{"name":"rabbitmq-erlang-cookie","mountPath":"/var/lib/rabbitmq/"},{"name":"erlang-cookie-secret","mountPath":"/tmp/erlang-cookie-secret/"},{"name":"rabbitmq-plugins","mountPath":"/operator"},{"name":"persistence","mountPath":"/var/lib/rabbitmq/mnesia/"},{"name":"rabbitmq-confd","mountPath":"/tmp/default_user.conf","subPath":"default_user.conf"}],"terminationMessagePath":"/dev/termination-log","terminationMessagePolicy":"File","imagePullPolicy":"IfNotPresent","securityContext":{"capabilities":{"drop":["FSETID","KILL","SETGID","SETUID","SETPCAP","NET_BIND_SERVICE","NET_RAW","SYS_CHROOT","MKNOD","AUDIT_WRITE","SETFCAP"]},"runAsUser":0}}],"containers":[{"name":"rabbitmq","image":"rabbitmq:3.8.12-management","ports":[{"name":"epmd","containerPort":4369,"protocol":"TCP"},{"name":"amqp","containerPort":5672,"protocol":"TCP"},{"name":"management","containerPort":15672,"protocol":"TCP"},{"name":"prometheus","containerPort":15692,"protocol":"TCP"}],"env":[{"name":"MY_POD_NAME","valueFrom":{"fieldRef":{"apiVersion":"v1","fieldPath":"metadata.name"}}},{"name":"MY_POD_NAMESPACE","valueFrom":{"fieldRef":{"apiVersion":"v1","fieldPath":"metadata.namespace"}}},{"name":"RABBITMQ_ENABLED_PLUGINS_FILE","value":"/operator/enabled_plugins"},{"name":"K8S_SERVICE_NAME","value":"rabbitmq-cluster-nodes"},{"name":"RABBITMQ_USE_LONGNAME","value":"true"},{"name":"RABBITMQ_NODENAME","value":"rabbit@$(MY_POD_NAME).$(K8S_SERVICE_NAME).$(MY_POD_NAMESPACE)"},{"name":"K8S_HOSTNAME_SUFFIX","value":".$(K8S_SERVICE_NAME).$(MY_POD_NAMESPACE)"}],"resources":{"limits":{"cpu":"2","memory":"2Gi"},"requests":{"cpu":"1","memory":"2Gi"}},"volumeMounts":[{"name":"rabbitmq-erlang-cookie","mountPath":"/var/lib/rabbitmq/"},{"name":"persistence","mountPath":"/var/lib/rabbitmq/mnesia/"},{"name":"rabbitmq-plugins","mountPath":"/operator"},{"name":"rabbitmq-confd","mountPath":"/etc/rabbitmq/conf.d/10-operatorDefaults.conf","subPath":"operatorDefaults.conf"},{"name":"rabbitmq-confd","mountPath":"/etc/rabbitmq/conf.d/11-default_user.conf","subPath":"default_user.conf"},{"name":"rabbitmq-confd","mountPath":"/etc/rabbitmq/conf.d/90-userDefinedConfiguration.conf","subPath":"userDefinedConfiguration.conf"},{"name":"pod-info","mountPath":"/etc/pod-info/"}],"readinessProbe":{"tcpSocket":{"port":"amqp"},"initialDelaySeconds":10,"timeoutSeconds":5,"periodSeconds":10,"successThreshold":1,"failureThreshold":3},"lifecycle":{"preStop":{"exec":{"command":["/bin/bash","-c","if [ ! -z \"$(cat /etc/pod-info/skipPreStopChecks)\" ]; then exit 0; fi; rabbitmq-upgrade await_online_quorum_plus_one -t 604800; rabbitmq-upgrade await_online_synchronized_mirror -t 604800; rabbitmq-upgrade drain -t 604800"]}}},"terminationMessagePath":"/dev/termination-log","terminationMessagePolicy":"File","imagePullPolicy":"IfNotPresent"}],"restartPolicy":"Always","terminationGracePeriodSeconds":604800,"dnsPolicy":"ClusterFirst","serviceAccountName":"rabbitmq-cluster-server","serviceAccount":"rabbitmq-cluster-server","automountServiceAccountToken":true,"securityContext":{"runAsUser":999,"runAsGroup":999,"fsGroup":999},"schedulerName":"default-scheduler","topologySpreadConstraints":[{"maxSkew":1,"topologyKey":"topology.kubernetes.io/zone","whenUnsatisfiable":"ScheduleAnyway","labelSelector":{"matchLabels":{"app.kubernetes.io/name":"rabbitmq-cluster"}}}]}},"volumeClaimTemplates":[{"metadata":{"name":"persistence","namespace":"default","creationTimestamp":null,"labels":{"app.kubernetes.io/component":"rabbitmq","app.kubernetes.io/name":"rabbitmq-cluster","app.kubernetes.io/part-of":"rabbitmq"},"ownerReferences":[{"apiVersion":"rabbitmq.com/v1beta1","kind":"RabbitmqCluster","name":"rabbitmq-cluster","uid":"18d9928b-0d1c-47be-80ec-20960d053827","controller":true,"blockOwnerDeletion":false}]},"spec":{"accessModes":["ReadWriteOnce"],"resources":{"requests":{"storage":"10Gi"}},"volumeMode":"Filesystem"},"status":{"phase":"Pending"}}],"serviceName":"rabbitmq-cluster-nodes","podManagementPolicy":"Parallel","updateStrategy":{"type":"RollingUpdate","rollingUpdate":{"partition":0}},"revisionHistoryLimit":10},"status":{"observedGeneration":2,"replicas":3,"readyReplicas":2,"currentReplicas":3,"updatedReplicas":3,"currentRevision":"rabbitmq-cluster-server-5f8b8665fb","updateRevision":"rabbitmq-cluster-server-5f8b8665fb","collisionCount":0}}
2022/03/18 18:01:59 learn_server.go:291: [SIEVE-AFTER-READ]	Get	true	statefulset	default	rabbitmq-cluster-server	github.com/rabbitmq/cluster-operator/controllers.(*RabbitmqClusterReconciler)	NoError	{"kind":"StatefulSet","apiVersion":"apps/v1","metadata":{"name":"rabbitmq-cluster-server","namespace":"default","selfLink":"/apis/apps/v1/namespaces/default/statefulsets/rabbitmq-cluster-server","uid":"cb5c43bc-6ee7-481c-ab01-6f3acffdd3c8","resourceVersion":"1214","generation":2,"creationTimestamp":"2022-03-18T18:00:38Z","labels":{"app.kubernetes.io/component":"rabbitmq","app.kubernetes.io/name":"rabbitmq-cluster","app.kubernetes.io/part-of":"rabbitmq"},"ownerReferences":[{"apiVersion":"rabbitmq.com/v1beta1","kind":"RabbitmqCluster","name":"rabbitmq-cluster","uid":"18d9928b-0d1c-47be-80ec-20960d053827","controller":true,"blockOwnerDeletion":true}],"managedFields":[{"manager":"manager","operation":"Update","apiVersion":"apps/v1","time":"2022-03-18T18:01:23Z","fieldsType":"FieldsV1","fieldsV1":{"f:metadata":{"f:labels":{".":{},"f:app.kubernetes.io/component":{},"f:app.kubernetes.io/name":{},"f:app.kubernetes.io/part-of":{}},"f:ownerReferences":{".":{},"k:{\"uid\":\"18d9928b-0d1c-47be-80ec-20960d053827\"}":{".":{},"f:apiVersion":{},"f:blockOwnerDeletion":{},"f:controller":{},"f:kind":{},"f:name":{},"f:uid":{}}}},"f:spec":{"f:podManagementPolicy":{},"f:replicas":{},"f:revisionHistoryLimit":{},"f:selector":{"f:matchLabels":{".":{},"f:app.kubernetes.io/name":{}}},"f:serviceName":{},"f:template":{"f:metadata":{"f:annotations":{".":{},"f:prometheus.io/port":{},"f:prometheus.io/scrape":{}},"f:labels":{".":{},"f:app.kubernetes.io/component":{},"f:app.kubernetes.io/name":{},"f:app.kubernetes.io/part-of":{}}},"f:spec":{"f:automountServiceAccountToken":{},"f:containers":{"k:{\"name\":\"rabbitmq\"}":{".":{},"f:env":{".":{},"k:{\"name\":\"K8S_HOSTNAME_SUFFIX\"}":{".":{},"f:name":{},"f:value":{}},"k:{\"name\":\"K8S_SERVICE_NAME\"}":{".":{},"f:name":{},"f:value":{}},"k:{\"name\":\"MY_POD_NAME\"}":{".":{},"f:name":{},"f:valueFrom":{".":{},"f:fieldRef":{".":{},"f:apiVersion":{},"f:fieldPath":{}}}},"k:{\"name\":\"MY_POD_NAMESPACE\"}":{".":{},"f:name":{},"f:valueFrom":{".":{},"f:fieldRef":{".":{},"f:apiVersion":{},"f:fieldPath":{}}}},"k:{\"name\":\"RABBITMQ_ENABLED_PLUGINS_FILE\"}":{".":{},"f:name":{},"f:value":{}},"k:{\"name\":\"RABBITMQ_NODENAME\"}":{".":{},"f:name":{},"f:value":{}},"k:{\"name\":\"RABBITMQ_USE_LONGNAME\"}":{".":{},"f:name":{},"f:value":{}}},"f:image":{},"f:imagePullPolicy":{},"f:lifecycle":{".":{},"f:preStop":{".":{},"f:exec":{".":{},"f:command":{}}}},"f:name":{},"f:ports":{".":{},"k:{\"containerPort\":4369,\"protocol\":\"TCP\"}":{".":{},"f:containerPort":{},"f:name":{},"f:protocol":{}},"k:{\"containerPort\":5672,\"protocol\":\"TCP\"}":{".":{},"f:containerPort":{},"f:name":{},"f:protocol":{}},"k:{\"containerPort\":15672,\"protocol\":\"TCP\"}":{".":{},"f:containerPort":{},"f:name":{},"f:protocol":{}},"k:{\"containerPort\":15692,\"protocol\":\"TCP\"}":{".":{},"f:containerPort":{},"f:name":{},"f:protocol":{}}},"f:readinessProbe":{".":{},"f:failureThreshold":{},"f:initialDelaySeconds":{},"f:periodSeconds":{},"f:successThreshold":{},"f:tcpSocket":{".":{},"f:port":{}},"f:timeoutSeconds":{}},"f:resources":{".":{},"f:limits":{".":{},"f:cpu":{},"f:memory":{}},"f:requests":{".":{},"f:cpu":{},"f:memory":{}}},"f:terminationMessagePath":{},"f:terminationMessagePolicy":{},"f:volumeMounts":{".":{},"k:{\"mountPath\":\"/etc/pod-info/\"}":{".":{},"f:mountPath":{},"f:name":{}},"k:{\"mountPath\":\"/etc/rabbitmq/conf.d/10-operatorDefaults.conf\"}":{".":{},"f:mountPath":{},"f:name":{},"f:subPath":{}},"k:{\"mountPath\":\"/etc/rabbitmq/conf.d/11-default_user.conf\"}":{".":{},"f:mountPath":{},"f:name":{},"f:subPath":{}},"k:{\"mountPath\":\"/etc/rabbitmq/conf.d/90-userDefinedConfiguration.conf\"}":{".":{},"f:mountPath":{},"f:name":{},"f:subPath":{}},"k:{\"mountPath\":\"/operator\"}":{".":{},"f:mountPath":{},"f:name":{}},"k:{\"mountPath\":\"/var/lib/rabbitmq/\"}":{".":{},"f:mountPath":{},"f:name":{}},"k:{\"mountPath\":\"/var/lib/rabbitmq/mnesia/\"}":{".":{},"f:mountPath":{},"f:name":{}}}}},"f:dnsPolicy":{},"f:initContainers":{".":{},"k:{\"name\":\"setup-container\"}":{".":{},"f:command":{},"f:image":{},"f:imagePullPolicy":{},"f:name":{},"f:resources":{".":{},"f:limits":{".":{},"f:cpu":{},"f:memory":{}},"f:requests":{".":{},"f:cpu":{},"f:memory":{}}},"f:securityContext":{".":{},"f:capabilities":{".":{},"f:drop":{}},"f:runAsUser":{}},"f:terminationMessagePath":{},"f:terminationMessagePolicy":{},"f:volumeMounts":{".":{},"k:{\"mountPath\":\"/operator\"}":{".":{},"f:mountPath":{},"f:name":{}},"k:{\"mountPath\":\"/tmp/default_user.conf\"}":{".":{},"f:mountPath":{},"f:name":{},"f:subPath":{}},"k:{\"mountPath\":\"/tmp/erlang-cookie-secret/\"}":{".":{},"f:mountPath":{},"f:name":{}},"k:{\"mountPath\":\"/tmp/rabbitmq-plugins/\"}":{".":{},"f:mountPath":{},"f:name":{}},"k:{\"mountPath\":\"/var/lib/rabbitmq/\"}":{".":{},"f:mountPath":{},"f:name":{}},"k:{\"mountPath\":\"/var/lib/rabbitmq/mnesia/\"}":{".":{},"f:mountPath":{},"f:name":{}}}}},"f:restartPolicy":{},"f:schedulerName":{},"f:securityContext":{".":{},"f:fsGroup":{},"f:runAsGroup":{},"f:runAsUser":{}},"f:serviceAccount":{},"f:serviceAccountName":{},"f:terminationGracePeriodSeconds":{},"f:topologySpreadConstraints":{".":{},"k:{\"topologyKey\":\"topology.kubernetes.io/zone\",\"whenUnsatisfiable\":\"ScheduleAnyway\"}":{".":{},"f:labelSelector":{".":{},"f:matchLabels":{".":{},"f:app.kubernetes.io/name":{}}},"f:maxSkew":{},"f:topologyKey":{},"f:whenUnsatisfiable":{}}},"f:volumes":{".":{},"k:{\"name\":\"erlang-cookie-secret\"}":{".":{},"f:name":{},"f:secret":{".":{},"f:defaultMode":{},"f:secretName":{}}},"k:{\"name\":\"plugins-conf\"}":{".":{},"f:configMap":{".":{},"f:defaultMode":{},"f:name":{}},"f:name":{}},"k:{\"name\":\"pod-info\"}":{".":{},"f:downwardAPI":{".":{},"f:defaultMode":{},"f:items":{}},"f:name":{}},"k:{\"name\":\"rabbitmq-confd\"}":{".":{},"f:name":{},"f:projected":{".":{},"f:defaultMode":{},"f:sources":{}}},"k:{\"name\":\"rabbitmq-erlang-cookie\"}":{".":{},"f:emptyDir":{},"f:name":{}},"k:{\"name\":\"rabbitmq-plugins\"}":{".":{},"f:emptyDir":{},"f:name":{}}}}},"f:updateStrategy":{"f:rollingUpdate":{".":{},"f:partition":{}},"f:type":{}},"f:volumeClaimTemplates":{}}}},{"manager":"kube-controller-manager","operation":"Update","apiVersion":"apps/v1","time":"2022-03-18T18:01:59Z","fieldsType":"FieldsV1","fieldsV1":{"f:status":{"f:collisionCount":{},"f:currentReplicas":{},"f:currentRevision":{},"f:observedGeneration":{},"f:readyReplicas":{},"f:replicas":{},"f:updateRevision":{},"f:updatedReplicas":{}}}}]},"spec":{"replicas":3,"selector":{"matchLabels":{"app.kubernetes.io/name":"rabbitmq-cluster"}},"template":{"metadata":{"creationTimestamp":null,"labels":{"app.kubernetes.io/component":"rabbitmq","app.kubernetes.io/name":"rabbitmq-cluster","app.kubernetes.io/part-of":"rabbitmq"},"annotations":{"prometheus.io/port":"15692","prometheus.io/scrape":"true"}},"spec":{"volumes":[{"name":"plugins-conf","configMap":{"name":"rabbitmq-cluster-plugins-conf","defaultMode":420}},{"name":"rabbitmq-confd","projected":{"sources":[{"secret":{"name":"rabbitmq-cluster-default-user","items":[{"key":"default_user.conf","path":"default_user.conf"}]}},{"configMap":{"name":"rabbitmq-cluster-server-conf","items":[{"key":"operatorDefaults.conf","path":"operatorDefaults.conf"},{"key":"userDefinedConfiguration.conf","path":"userDefinedConfiguration.conf"}]}}],"defaultMode":420}},{"name":"rabbitmq-erlang-cookie","emptyDir":{}},{"name":"erlang-cookie-secret","secret":{"secretName":"rabbitmq-cluster-erlang-cookie","defaultMode":420}},{"name":"rabbitmq-plugins","emptyDir":{}},{"name":"pod-info","downwardAPI":{"items":[{"path":"skipPreStopChecks","fieldRef":{"apiVersion":"v1","fieldPath":"metadata.labels['skipPreStopChecks']"}}],"defaultMode":420}}],"initContainers":[{"name":"setup-container","image":"rabbitmq:3.8.12-management","command":["sh","-c","cp /tmp/erlang-cookie-secret/.erlang.cookie /var/lib/rabbitmq/.erlang.cookie \u0026\u0026 chown 999:999 /var/lib/rabbitmq/.erlang.cookie \u0026\u0026 chmod 600 /var/lib/rabbitmq/.erlang.cookie ; cp /tmp/rabbitmq-plugins/enabled_plugins /operator/enabled_plugins \u0026\u0026 chown 999:999 /operator/enabled_plugins ; chown 999:999 /var/lib/rabbitmq/mnesia/ ; echo '[default]' \u003e /var/lib/rabbitmq/.rabbitmqadmin.conf \u0026\u0026 sed -e 's/default_user/username/' -e 's/default_pass/password/' /tmp/default_user.conf \u003e\u003e /var/lib/rabbitmq/.rabbitmqadmin.conf \u0026\u0026 chown 999:999 /var/lib/rabbitmq/.rabbitmqadmin.conf \u0026\u0026 chmod 600 /var/lib/rabbitmq/.rabbitmqadmin.conf"],"resources":{"limits":{"cpu":"100m","memory":"500Mi"},"requests":{"cpu":"100m","memory":"500Mi"}},"volumeMounts":[{"name":"plugins-conf","mountPath":"/tmp/rabbitmq-plugins/"},{"name":"rabbitmq-erlang-cookie","mountPath":"/var/lib/rabbitmq/"},{"name":"erlang-cookie-secret","mountPath":"/tmp/erlang-cookie-secret/"},{"name":"rabbitmq-plugins","mountPath":"/operator"},{"name":"persistence","mountPath":"/var/lib/rabbitmq/mnesia/"},{"name":"rabbitmq-confd","mountPath":"/tmp/default_user.conf","subPath":"default_user.conf"}],"terminationMessagePath":"/dev/termination-log","terminationMessagePolicy":"File","imagePullPolicy":"IfNotPresent","securityContext":{"capabilities":{"drop":["FSETID","KILL","SETGID","SETUID","SETPCAP","NET_BIND_SERVICE","NET_RAW","SYS_CHROOT","MKNOD","AUDIT_WRITE","SETFCAP"]},"runAsUser":0}}],"containers":[{"name":"rabbitmq","image":"rabbitmq:3.8.12-management","ports":[{"name":"epmd","containerPort":4369,"protocol":"TCP"},{"name":"amqp","containerPort":5672,"protocol":"TCP"},{"name":"management","containerPort":15672,"protocol":"TCP"},{"name":"prometheus","containerPort":15692,"protocol":"TCP"}],"env":[{"name":"MY_POD_NAME","valueFrom":{"fieldRef":{"apiVersion":"v1","fieldPath":"metadata.name"}}},{"name":"MY_POD_NAMESPACE","valueFrom":{"fieldRef":{"apiVersion":"v1","fieldPath":"metadata.namespace"}}},{"name":"RABBITMQ_ENABLED_PLUGINS_FILE","value":"/operator/enabled_plugins"},{"name":"K8S_SERVICE_NAME","value":"rabbitmq-cluster-nodes"},{"name":"RABBITMQ_USE_LONGNAME","value":"true"},{"name":"RABBITMQ_NODENAME","value":"rabbit@$(MY_POD_NAME).$(K8S_SERVICE_NAME).$(MY_POD_NAMESPACE)"},{"name":"K8S_HOSTNAME_SUFFIX","value":".$(K8S_SERVICE_NAME).$(MY_POD_NAMESPACE)"}],"resources":{"limits":{"cpu":"2","memory":"2Gi"},"requests":{"cpu":"1","memory":"2Gi"}},"volumeMounts":[{"name":"rabbitmq-erlang-cookie","mountPath":"/var/lib/rabbitmq/"},{"name":"persistence","mountPath":"/var/lib/rabbitmq/mnesia/"},{"name":"rabbitmq-plugins","mountPath":"/operator"},{"name":"rabbitmq-confd","mountPath":"/etc/rabbitmq/conf.d/10-operatorDefaults.conf","subPath":"operatorDefaults.conf"},{"name":"rabbitmq-confd","mountPath":"/etc/rabbitmq/conf.d/11-default_user.conf","subPath":"default_user.conf"},{"name":"rabbitmq-confd","mountPath":"/etc/rabbitmq/conf.d/90-userDefinedConfiguration.conf","subPath":"userDefinedConfiguration.conf"},{"name":"pod-info","mountPath":"/etc/pod-info/"}],"readinessProbe":{"tcpSocket":{"port":"amqp"},"initialDelaySeconds":10,"timeoutSeconds":5,"periodSeconds":10,"successThreshold":1,"failureThreshold":3},"lifecycle":{"preStop":{"exec":{"command":["/bin/bash","-c","if [ ! -z \"$(cat /etc/pod-info/skipPreStopChecks)\" ]; then exit 0; fi; rabbitmq-upgrade await_online_quorum_plus_one -t 604800; rabbitmq-upgrade await_online_synchronized_mirror -t 604800; rabbitmq-upgrade drain -t 604800"]}}},"terminationMessagePath":"/dev/termination-log","terminationMessagePolicy":"File","imagePullPolicy":"IfNotPresent"}],"restartPolicy":"Always","terminationGracePeriodSeconds":604800,"dnsPolicy":"ClusterFirst","serviceAccountName":"rabbitmq-cluster-server","serviceAccount":"rabbitmq-cluster-server","automountServiceAccountToken":true,"securityContext":{"runAsUser":999,"runAsGroup":999,"fsGroup":999},"schedulerName":"default-scheduler","topologySpreadConstraints":[{"maxSkew":1,"topologyKey":"topology.kubernetes.io/zone","whenUnsatisfiable":"ScheduleAnyway","labelSelector":{"matchLabels":{"app.kubernetes.io/name":"rabbitmq-cluster"}}}]}},"volumeClaimTemplates":[{"metadata":{"name":"persistence","namespace":"default","creationTimestamp":null,"labels":{"app.kubernetes.io/component":"rabbitmq","app.kubernetes.io/name":"rabbitmq-cluster","app.kubernetes.io/part-of":"rabbitmq"},"ownerReferences":[{"apiVersion":"rabbitmq.com/v1beta1","kind":"RabbitmqCluster","name":"rabbitmq-cluster","uid":"18d9928b-0d1c-47be-80ec-20960d053827","controller":true,"blockOwnerDeletion":false}]},"spec":{"accessModes":["ReadWriteOnce"],"resources":{"requests":{"storage":"10Gi"}},"volumeMode":"Filesystem"},"status":{"phase":"Pending"}}],"serviceName":"rabbitmq-cluster-nodes","podManagementPolicy":"Parallel","updateStrategy":{"type":"RollingUpdate","rollingUpdate":{"partition":0}},"revisionHistoryLimit":10},"status":{"observedGeneration":2,"replicas":3,"readyReplicas":2,"currentReplicas":3,"updatedReplicas":3,"currentRevision":"rabbitmq-cluster-server-5f8b8665fb","updateRevision":"rabbitmq-cluster-server-5f8b8665fb","collisionCount":0}}
2022/03/18 18:01:59 learn_server.go:256: [SIEVE-BEFORE-WRITE]	50
2022/03/18 18:01:59 learn_server.go:263: [SIEVE-AFTER-WRITE]	50	Update	statefulset	github.com/rabbitmq/cluster-operator/controllers.(*RabbitmqClusterReconciler)	NoError	{"metadata":{"name":"rabbitmq-cluster-server","namespace":"default","selfLink":"/apis/apps/v1/namespaces/default/statefulsets/rabbitmq-cluster-server","uid":"cb5c43bc-6ee7-481c-ab01-6f3acffdd3c8","resourceVersion":"1214","generation":2,"creationTimestamp":"2022-03-18T18:00:38Z","labels":{"app.kubernetes.io/component":"rabbitmq","app.kubernetes.io/name":"rabbitmq-cluster","app.kubernetes.io/part-of":"rabbitmq"},"ownerReferences":[{"apiVersion":"rabbitmq.com/v1beta1","kind":"RabbitmqCluster","name":"rabbitmq-cluster","uid":"18d9928b-0d1c-47be-80ec-20960d053827","controller":true,"blockOwnerDeletion":true}],"managedFields":[{"manager":"manager","operation":"Update","apiVersion":"apps/v1","time":"2022-03-18T18:01:23Z","fieldsType":"FieldsV1","fieldsV1":{"f:metadata":{"f:labels":{".":{},"f:app.kubernetes.io/component":{},"f:app.kubernetes.io/name":{},"f:app.kubernetes.io/part-of":{}},"f:ownerReferences":{".":{},"k:{\"uid\":\"18d9928b-0d1c-47be-80ec-20960d053827\"}":{".":{},"f:apiVersion":{},"f:blockOwnerDeletion":{},"f:controller":{},"f:kind":{},"f:name":{},"f:uid":{}}}},"f:spec":{"f:podManagementPolicy":{},"f:replicas":{},"f:revisionHistoryLimit":{},"f:selector":{"f:matchLabels":{".":{},"f:app.kubernetes.io/name":{}}},"f:serviceName":{},"f:template":{"f:metadata":{"f:annotations":{".":{},"f:prometheus.io/port":{},"f:prometheus.io/scrape":{}},"f:labels":{".":{},"f:app.kubernetes.io/component":{},"f:app.kubernetes.io/name":{},"f:app.kubernetes.io/part-of":{}}},"f:spec":{"f:automountServiceAccountToken":{},"f:containers":{"k:{\"name\":\"rabbitmq\"}":{".":{},"f:env":{".":{},"k:{\"name\":\"K8S_HOSTNAME_SUFFIX\"}":{".":{},"f:name":{},"f:value":{}},"k:{\"name\":\"K8S_SERVICE_NAME\"}":{".":{},"f:name":{},"f:value":{}},"k:{\"name\":\"MY_POD_NAME\"}":{".":{},"f:name":{},"f:valueFrom":{".":{},"f:fieldRef":{".":{},"f:apiVersion":{},"f:fieldPath":{}}}},"k:{\"name\":\"MY_POD_NAMESPACE\"}":{".":{},"f:name":{},"f:valueFrom":{".":{},"f:fieldRef":{".":{},"f:apiVersion":{},"f:fieldPath":{}}}},"k:{\"name\":\"RABBITMQ_ENABLED_PLUGINS_FILE\"}":{".":{},"f:name":{},"f:value":{}},"k:{\"name\":\"RABBITMQ_NODENAME\"}":{".":{},"f:name":{},"f:value":{}},"k:{\"name\":\"RABBITMQ_USE_LONGNAME\"}":{".":{},"f:name":{},"f:value":{}}},"f:image":{},"f:imagePullPolicy":{},"f:lifecycle":{".":{},"f:preStop":{".":{},"f:exec":{".":{},"f:command":{}}}},"f:name":{},"f:ports":{".":{},"k:{\"containerPort\":4369,\"protocol\":\"TCP\"}":{".":{},"f:containerPort":{},"f:name":{},"f:protocol":{}},"k:{\"containerPort\":5672,\"protocol\":\"TCP\"}":{".":{},"f:containerPort":{},"f:name":{},"f:protocol":{}},"k:{\"containerPort\":15672,\"protocol\":\"TCP\"}":{".":{},"f:containerPort":{},"f:name":{},"f:protocol":{}},"k:{\"containerPort\":15692,\"protocol\":\"TCP\"}":{".":{},"f:containerPort":{},"f:name":{},"f:protocol":{}}},"f:readinessProbe":{".":{},"f:failureThreshold":{},"f:initialDelaySeconds":{},"f:periodSeconds":{},"f:successThreshold":{},"f:tcpSocket":{".":{},"f:port":{}},"f:timeoutSeconds":{}},"f:resources":{".":{},"f:limits":{".":{},"f:cpu":{},"f:memory":{}},"f:requests":{".":{},"f:cpu":{},"f:memory":{}}},"f:terminationMessagePath":{},"f:terminationMessagePolicy":{},"f:volumeMounts":{".":{},"k:{\"mountPath\":\"/etc/pod-info/\"}":{".":{},"f:mountPath":{},"f:name":{}},"k:{\"mountPath\":\"/etc/rabbitmq/conf.d/10-operatorDefaults.conf\"}":{".":{},"f:mountPath":{},"f:name":{},"f:subPath":{}},"k:{\"mountPath\":\"/etc/rabbitmq/conf.d/11-default_user.conf\"}":{".":{},"f:mountPath":{},"f:name":{},"f:subPath":{}},"k:{\"mountPath\":\"/etc/rabbitmq/conf.d/90-userDefinedConfiguration.conf\"}":{".":{},"f:mountPath":{},"f:name":{},"f:subPath":{}},"k:{\"mountPath\":\"/operator\"}":{".":{},"f:mountPath":{},"f:name":{}},"k:{\"mountPath\":\"/var/lib/rabbitmq/\"}":{".":{},"f:mountPath":{},"f:name":{}},"k:{\"mountPath\":\"/var/lib/rabbitmq/mnesia/\"}":{".":{},"f:mountPath":{},"f:name":{}}}}},"f:dnsPolicy":{},"f:initContainers":{".":{},"k:{\"name\":\"setup-container\"}":{".":{},"f:command":{},"f:image":{},"f:imagePullPolicy":{},"f:name":{},"f:resources":{".":{},"f:limits":{".":{},"f:cpu":{},"f:memory":{}},"f:requests":{".":{},"f:cpu":{},"f:memory":{}}},"f:securityContext":{".":{},"f:capabilities":{".":{},"f:drop":{}},"f:runAsUser":{}},"f:terminationMessagePath":{},"f:terminationMessagePolicy":{},"f:volumeMounts":{".":{},"k:{\"mountPath\":\"/operator\"}":{".":{},"f:mountPath":{},"f:name":{}},"k:{\"mountPath\":\"/tmp/default_user.conf\"}":{".":{},"f:mountPath":{},"f:name":{},"f:subPath":{}},"k:{\"mountPath\":\"/tmp/erlang-cookie-secret/\"}":{".":{},"f:mountPath":{},"f:name":{}},"k:{\"mountPath\":\"/tmp/rabbitmq-plugins/\"}":{".":{},"f:mountPath":{},"f:name":{}},"k:{\"mountPath\":\"/var/lib/rabbitmq/\"}":{".":{},"f:mountPath":{},"f:name":{}},"k:{\"mountPath\":\"/var/lib/rabbitmq/mnesia/\"}":{".":{},"f:mountPath":{},"f:name":{}}}}},"f:restartPolicy":{},"f:schedulerName":{},"f:securityContext":{".":{},"f:fsGroup":{},"f:runAsGroup":{},"f:runAsUser":{}},"f:serviceAccount":{},"f:serviceAccountName":{},"f:terminationGracePeriodSeconds":{},"f:topologySpreadConstraints":{".":{},"k:{\"topologyKey\":\"topology.kubernetes.io/zone\",\"whenUnsatisfiable\":\"ScheduleAnyway\"}":{".":{},"f:labelSelector":{".":{},"f:matchLabels":{".":{},"f:app.kubernetes.io/name":{}}},"f:maxSkew":{},"f:topologyKey":{},"f:whenUnsatisfiable":{}}},"f:volumes":{".":{},"k:{\"name\":\"erlang-cookie-secret\"}":{".":{},"f:name":{},"f:secret":{".":{},"f:defaultMode":{},"f:secretName":{}}},"k:{\"name\":\"plugins-conf\"}":{".":{},"f:configMap":{".":{},"f:defaultMode":{},"f:name":{}},"f:name":{}},"k:{\"name\":\"pod-info\"}":{".":{},"f:downwardAPI":{".":{},"f:defaultMode":{},"f:items":{}},"f:name":{}},"k:{\"name\":\"rabbitmq-confd\"}":{".":{},"f:name":{},"f:projected":{".":{},"f:defaultMode":{},"f:sources":{}}},"k:{\"name\":\"rabbitmq-erlang-cookie\"}":{".":{},"f:emptyDir":{},"f:name":{}},"k:{\"name\":\"rabbitmq-plugins\"}":{".":{},"f:emptyDir":{},"f:name":{}}}}},"f:updateStrategy":{"f:rollingUpdate":{".":{},"f:partition":{}},"f:type":{}},"f:volumeClaimTemplates":{}}}},{"manager":"kube-controller-manager","operation":"Update","apiVersion":"apps/v1","time":"2022-03-18T18:01:59Z","fieldsType":"FieldsV1","fieldsV1":{"f:status":{"f:collisionCount":{},"f:currentReplicas":{},"f:currentRevision":{},"f:observedGeneration":{},"f:readyReplicas":{},"f:replicas":{},"f:updateRevision":{},"f:updatedReplicas":{}}}}]},"spec":{"replicas":3,"selector":{"matchLabels":{"app.kubernetes.io/name":"rabbitmq-cluster"}},"template":{"metadata":{"creationTimestamp":null,"labels":{"app.kubernetes.io/component":"rabbitmq","app.kubernetes.io/name":"rabbitmq-cluster","app.kubernetes.io/part-of":"rabbitmq"},"annotations":{"prometheus.io/port":"15692","prometheus.io/scrape":"true"}},"spec":{"volumes":[{"name":"plugins-conf","configMap":{"name":"rabbitmq-cluster-plugins-conf","defaultMode":420}},{"name":"rabbitmq-confd","projected":{"sources":[{"secret":{"name":"rabbitmq-cluster-default-user","items":[{"key":"default_user.conf","path":"default_user.conf"}]}},{"configMap":{"name":"rabbitmq-cluster-server-conf","items":[{"key":"operatorDefaults.conf","path":"operatorDefaults.conf"},{"key":"userDefinedConfiguration.conf","path":"userDefinedConfiguration.conf"}]}}],"defaultMode":420}},{"name":"rabbitmq-erlang-cookie","emptyDir":{}},{"name":"erlang-cookie-secret","secret":{"secretName":"rabbitmq-cluster-erlang-cookie","defaultMode":420}},{"name":"rabbitmq-plugins","emptyDir":{}},{"name":"pod-info","downwardAPI":{"items":[{"path":"skipPreStopChecks","fieldRef":{"apiVersion":"v1","fieldPath":"metadata.labels['skipPreStopChecks']"}}],"defaultMode":420}}],"initContainers":[{"name":"setup-container","image":"rabbitmq:3.8.12-management","command":["sh","-c","cp /tmp/erlang-cookie-secret/.erlang.cookie /var/lib/rabbitmq/.erlang.cookie \u0026\u0026 chown 999:999 /var/lib/rabbitmq/.erlang.cookie \u0026\u0026 chmod 600 /var/lib/rabbitmq/.erlang.cookie ; cp /tmp/rabbitmq-plugins/enabled_plugins /operator/enabled_plugins \u0026\u0026 chown 999:999 /operator/enabled_plugins ; chown 999:999 /var/lib/rabbitmq/mnesia/ ; echo '[default]' \u003e /var/lib/rabbitmq/.rabbitmqadmin.conf \u0026\u0026 sed -e 's/default_user/username/' -e 's/default_pass/password/' /tmp/default_user.conf \u003e\u003e /var/lib/rabbitmq/.rabbitmqadmin.conf \u0026\u0026 chown 999:999 /var/lib/rabbitmq/.rabbitmqadmin.conf \u0026\u0026 chmod 600 /var/lib/rabbitmq/.rabbitmqadmin.conf"],"resources":{"limits":{"cpu":"100m","memory":"500Mi"},"requests":{"cpu":"100m","memory":"500Mi"}},"volumeMounts":[{"name":"plugins-conf","mountPath":"/tmp/rabbitmq-plugins/"},{"name":"rabbitmq-erlang-cookie","mountPath":"/var/lib/rabbitmq/"},{"name":"erlang-cookie-secret","mountPath":"/tmp/erlang-cookie-secret/"},{"name":"rabbitmq-plugins","mountPath":"/operator"},{"name":"persistence","mountPath":"/var/lib/rabbitmq/mnesia/"},{"name":"rabbitmq-confd","mountPath":"/tmp/default_user.conf","subPath":"default_user.conf"}],"terminationMessagePath":"/dev/termination-log","terminationMessagePolicy":"File","imagePullPolicy":"IfNotPresent","securityContext":{"capabilities":{"drop":["FSETID","KILL","SETGID","SETUID","SETPCAP","NET_BIND_SERVICE","NET_RAW","SYS_CHROOT","MKNOD","AUDIT_WRITE","SETFCAP"]},"runAsUser":0}}],"containers":[{"name":"rabbitmq","image":"rabbitmq:3.8.12-management","ports":[{"name":"epmd","containerPort":4369,"protocol":"TCP"},{"name":"amqp","containerPort":5672,"protocol":"TCP"},{"name":"management","containerPort":15672,"protocol":"TCP"},{"name":"prometheus","containerPort":15692,"protocol":"TCP"}],"env":[{"name":"MY_POD_NAME","valueFrom":{"fieldRef":{"apiVersion":"v1","fieldPath":"metadata.name"}}},{"name":"MY_POD_NAMESPACE","valueFrom":{"fieldRef":{"apiVersion":"v1","fieldPath":"metadata.namespace"}}},{"name":"RABBITMQ_ENABLED_PLUGINS_FILE","value":"/operator/enabled_plugins"},{"name":"K8S_SERVICE_NAME","value":"rabbitmq-cluster-nodes"},{"name":"RABBITMQ_USE_LONGNAME","value":"true"},{"name":"RABBITMQ_NODENAME","value":"rabbit@$(MY_POD_NAME).$(K8S_SERVICE_NAME).$(MY_POD_NAMESPACE)"},{"name":"K8S_HOSTNAME_SUFFIX","value":".$(K8S_SERVICE_NAME).$(MY_POD_NAMESPACE)"}],"resources":{"limits":{"cpu":"2","memory":"2Gi"},"requests":{"cpu":"1","memory":"2Gi"}},"volumeMounts":[{"name":"rabbitmq-erlang-cookie","mountPath":"/var/lib/rabbitmq/"},{"name":"persistence","mountPath":"/var/lib/rabbitmq/mnesia/"},{"name":"rabbitmq-plugins","mountPath":"/operator"},{"name":"rabbitmq-confd","mountPath":"/etc/rabbitmq/conf.d/10-operatorDefaults.conf","subPath":"operatorDefaults.conf"},{"name":"rabbitmq-confd","mountPath":"/etc/rabbitmq/conf.d/11-default_user.conf","subPath":"default_user.conf"},{"name":"rabbitmq-confd","mountPath":"/etc/rabbitmq/conf.d/90-userDefinedConfiguration.conf","subPath":"userDefinedConfiguration.conf"},{"name":"pod-info","mountPath":"/etc/pod-info/"}],"readinessProbe":{"tcpSocket":{"port":"amqp"},"initialDelaySeconds":10,"timeoutSeconds":5,"periodSeconds":10,"successThreshold":1,"failureThreshold":3},"lifecycle":{"preStop":{"exec":{"command":["/bin/bash","-c","if [ ! -z \"$(cat /etc/pod-info/skipPreStopChecks)\" ]; then exit 0; fi; rabbitmq-upgrade await_online_quorum_plus_one -t 604800; rabbitmq-upgrade await_online_synchronized_mirror -t 604800; rabbitmq-upgrade drain -t 604800"]}}},"terminationMessagePath":"/dev/termination-log","terminationMessagePolicy":"File","imagePullPolicy":"IfNotPresent"}],"restartPolicy":"Always","terminationGracePeriodSeconds":604800,"dnsPolicy":"ClusterFirst","serviceAccountName":"rabbitmq-cluster-server","serviceAccount":"rabbitmq-cluster-server","automountServiceAccountToken":true,"securityContext":{"runAsUser":999,"runAsGroup":999,"fsGroup":999},"schedulerName":"default-scheduler","topologySpreadConstraints":[{"maxSkew":1,"topologyKey":"topology.kubernetes.io/zone","whenUnsatisfiable":"ScheduleAnyway","labelSelector":{"matchLabels":{"app.kubernetes.io/name":"rabbitmq-cluster"}}}]}},"volumeClaimTemplates":[{"metadata":{"name":"persistence","namespace":"default","creationTimestamp":null,"labels":{"app.kubernetes.io/component":"rabbitmq","app.kubernetes.io/name":"rabbitmq-cluster","app.kubernetes.io/part-of":"rabbitmq"},"ownerReferences":[{"apiVersion":"rabbitmq.com/v1beta1","kind":"RabbitmqCluster","name":"rabbitmq-cluster","uid":"18d9928b-0d1c-47be-80ec-20960d053827","controller":true,"blockOwnerDeletion":false}]},"spec":{"accessModes":["ReadWriteOnce"],"resources":{"requests":{"storage":"10Gi"}},"volumeMode":"Filesystem"},"status":{"phase":"Pending"}}],"serviceName":"rabbitmq-cluster-nodes","podManagementPolicy":"Parallel","updateStrategy":{"type":"RollingUpdate","rollingUpdate":{"partition":0}},"revisionHistoryLimit":10},"status":{"observedGeneration":2,"replicas":3,"readyReplicas":2,"currentReplicas":3,"updatedReplicas":3,"currentRevision":"rabbitmq-cluster-server-5f8b8665fb","updateRevision":"rabbitmq-cluster-server-5f8b8665fb","collisionCount":0}}
2022/03/18 18:01:59 learn_server.go:291: [SIEVE-AFTER-READ]	Get	true	configmap	default	rabbitmq-cluster-server-conf	github.com/rabbitmq/cluster-operator/controllers.(*RabbitmqClusterReconciler)	NoError	{"kind":"ConfigMap","apiVersion":"v1","metadata":{"name":"rabbitmq-cluster-server-conf","namespace":"default","selfLink":"/api/v1/namespaces/default/configmaps/rabbitmq-cluster-server-conf","uid":"22474f2b-8454-44b7-8079-8990223969cc","resourceVersion":"714","creationTimestamp":"2022-03-18T18:00:38Z","labels":{"app.kubernetes.io/component":"rabbitmq","app.kubernetes.io/name":"rabbitmq-cluster","app.kubernetes.io/part-of":"rabbitmq"},"ownerReferences":[{"apiVersion":"rabbitmq.com/v1beta1","kind":"RabbitmqCluster","name":"rabbitmq-cluster","uid":"18d9928b-0d1c-47be-80ec-20960d053827","controller":true,"blockOwnerDeletion":true}],"managedFields":[{"manager":"manager","operation":"Update","apiVersion":"v1","time":"2022-03-18T18:00:38Z","fieldsType":"FieldsV1","fieldsV1":{"f:data":{".":{},"f:operatorDefaults.conf":{},"f:userDefinedConfiguration.conf":{}},"f:metadata":{"f:labels":{".":{},"f:app.kubernetes.io/component":{},"f:app.kubernetes.io/name":{},"f:app.kubernetes.io/part-of":{}},"f:ownerReferences":{".":{},"k:{\"uid\":\"18d9928b-0d1c-47be-80ec-20960d053827\"}":{".":{},"f:apiVersion":{},"f:blockOwnerDeletion":{},"f:controller":{},"f:kind":{},"f:name":{},"f:uid":{}}}}}}]},"data":{"operatorDefaults.conf":"cluster_formation.peer_discovery_backend             = rabbit_peer_discovery_k8s\ncluster_formation.k8s.host                           = kubernetes.default\ncluster_formation.k8s.address_type                   = hostname\ncluster_partition_handling                           = pause_minority\nqueue_master_locator                                 = min-masters\ndisk_free_limit.absolute                             = 2GB\ncluster_formation.randomized_startup_delay_range.min = 5\ncluster_formation.randomized_startup_delay_range.max = 30\ncluster_name                                         = rabbitmq-cluster\n","userDefinedConfiguration.conf":"total_memory_available_override_value = 1717986919\n"}}
2022/03/18 18:01:59 learn_server.go:256: [SIEVE-BEFORE-WRITE]	51
2022/03/18 18:01:59 learn_server.go:263: [SIEVE-AFTER-WRITE]	51	StatusUpdate	rabbitmqcluster	github.com/rabbitmq/cluster-operator/controllers.(*RabbitmqClusterReconciler)	NoError	{"metadata":{"name":"rabbitmq-cluster","namespace":"default","selfLink":"/apis/rabbitmq.com/v1beta1/namespaces/default/rabbitmqclusters/rabbitmq-cluster/status","uid":"18d9928b-0d1c-47be-80ec-20960d053827","resourceVersion":"1215","generation":3,"creationTimestamp":"2022-03-18T18:00:38Z","annotations":{"kubectl.kubernetes.io/last-applied-configuration":"{\"apiVersion\":\"rabbitmq.com/v1beta1\",\"kind\":\"RabbitmqCluster\",\"metadata\":{\"annotations\":{},\"name\":\"rabbitmq-cluster\",\"namespace\":\"default\"},\"spec\":{\"persistence\":{\"storage\":\"10Gi\"},\"replicas\":1}}\n"},"finalizers":["deletion.finalizers.rabbitmqclusters.rabbitmq.com"],"managedFields":[{"manager":"kubectl-client-side-apply","operation":"Update","apiVersion":"rabbitmq.com/v1beta1","time":"2022-03-18T18:00:38Z","fieldsType":"FieldsV1","fieldsV1":{"f:metadata":{"f:annotations":{".":{},"f:kubectl.kubernetes.io/last-applied-configuration":{}}},"f:spec":{".":{},"f:image":{},"f:persistence":{".":{},"f:storage":{}},"f:resources":{".":{},"f:limits":{".":{},"f:memory":{}},"f:requests":{".":{},"f:memory":{}}},"f:service":{".":{},"f:type":{}},"f:terminationGracePeriodSeconds":{}}}},{"manager":"kubectl-patch","operation":"Update","apiVersion":"rabbitmq.com/v1beta1","time":"2022-03-18T18:01:23Z","fieldsType":"FieldsV1","fieldsV1":{"f:spec":{"f:replicas":{}}}},{"manager":"manager","operation":"Update","apiVersion":"rabbitmq.com/v1beta1","time":"2022-03-18T18:01:59Z","fieldsType":"FieldsV1","fieldsV1":{"f:metadata":{"f:finalizers":{}},"f:spec":{"f:override":{},"f:rabbitmq":{},"f:resources":{"f:limits":{"f:cpu":{}},"f:requests":{"f:cpu":{}}},"f:tls":{}},"f:status":{".":{},"f:conditions":{},"f:defaultUser":{".":{},"f:secretReference":{".":{},"f:keys":{".":{},"f:password":{},"f:username":{}},"f:name":{},"f:namespace":{}},"f:serviceReference":{".":{},"f:name":{},"f:namespace":{}}}}}}]},"spec":{"replicas":3,"image":"rabbitmq:3.8.12-management","service":{"type":"ClusterIP"},"persistence":{"storage":"10Gi"},"resources":{"limits":{"cpu":"2","memory":"2Gi"},"requests":{"cpu":"1","memory":"2Gi"}},"rabbitmq":{},"tls":{},"override":{},"terminationGracePeriodSeconds":604800},"status":{"conditions":[{"type":"AllReplicasReady","status":"False","lastTransitionTime":"2022-03-18T18:01:23Z","reason":"NotAllPodsReady","message":"2/3 Pods ready"},{"type":"ClusterAvailable","status":"True","lastTransitionTime":"2022-03-18T18:01:17Z","reason":"AtLeastOneEndpointAvailable"},{"type":"NoWarnings","status":"True","lastTransitionTime":"2022-03-18T18:00:38Z","reason":"NoWarnings"},{"type":"ReconcileSuccess","status":"True","lastTransitionTime":"2022-03-18T18:01:18Z","reason":"Success","message":"Finish reconciling"}],"defaultUser":{"secretReference":{"name":"rabbitmq-cluster-default-user","namespace":"default","keys":{"password":"password","username":"username"}},"serviceReference":{"name":"rabbitmq-cluster","namespace":"default"}},"binding":{"name":"rabbitmq-cluster-default-user"}}}
2022/03/18 18:01:59 learn_server.go:291: [SIEVE-AFTER-READ]	Get	true	statefulset	default	rabbitmq-cluster-server	github.com/rabbitmq/cluster-operator/controllers.(*RabbitmqClusterReconciler)	NoError	{"kind":"StatefulSet","apiVersion":"apps/v1","metadata":{"name":"rabbitmq-cluster-server","namespace":"default","selfLink":"/apis/apps/v1/namespaces/default/statefulsets/rabbitmq-cluster-server","uid":"cb5c43bc-6ee7-481c-ab01-6f3acffdd3c8","resourceVersion":"1214","generation":2,"creationTimestamp":"2022-03-18T18:00:38Z","labels":{"app.kubernetes.io/component":"rabbitmq","app.kubernetes.io/name":"rabbitmq-cluster","app.kubernetes.io/part-of":"rabbitmq"},"ownerReferences":[{"apiVersion":"rabbitmq.com/v1beta1","kind":"RabbitmqCluster","name":"rabbitmq-cluster","uid":"18d9928b-0d1c-47be-80ec-20960d053827","controller":true,"blockOwnerDeletion":true}],"managedFields":[{"manager":"manager","operation":"Update","apiVersion":"apps/v1","time":"2022-03-18T18:01:23Z","fieldsType":"FieldsV1","fieldsV1":{"f:metadata":{"f:labels":{".":{},"f:app.kubernetes.io/component":{},"f:app.kubernetes.io/name":{},"f:app.kubernetes.io/part-of":{}},"f:ownerReferences":{".":{},"k:{\"uid\":\"18d9928b-0d1c-47be-80ec-20960d053827\"}":{".":{},"f:apiVersion":{},"f:blockOwnerDeletion":{},"f:controller":{},"f:kind":{},"f:name":{},"f:uid":{}}}},"f:spec":{"f:podManagementPolicy":{},"f:replicas":{},"f:revisionHistoryLimit":{},"f:selector":{"f:matchLabels":{".":{},"f:app.kubernetes.io/name":{}}},"f:serviceName":{},"f:template":{"f:metadata":{"f:annotations":{".":{},"f:prometheus.io/port":{},"f:prometheus.io/scrape":{}},"f:labels":{".":{},"f:app.kubernetes.io/component":{},"f:app.kubernetes.io/name":{},"f:app.kubernetes.io/part-of":{}}},"f:spec":{"f:automountServiceAccountToken":{},"f:containers":{"k:{\"name\":\"rabbitmq\"}":{".":{},"f:env":{".":{},"k:{\"name\":\"K8S_HOSTNAME_SUFFIX\"}":{".":{},"f:name":{},"f:value":{}},"k:{\"name\":\"K8S_SERVICE_NAME\"}":{".":{},"f:name":{},"f:value":{}},"k:{\"name\":\"MY_POD_NAME\"}":{".":{},"f:name":{},"f:valueFrom":{".":{},"f:fieldRef":{".":{},"f:apiVersion":{},"f:fieldPath":{}}}},"k:{\"name\":\"MY_POD_NAMESPACE\"}":{".":{},"f:name":{},"f:valueFrom":{".":{},"f:fieldRef":{".":{},"f:apiVersion":{},"f:fieldPath":{}}}},"k:{\"name\":\"RABBITMQ_ENABLED_PLUGINS_FILE\"}":{".":{},"f:name":{},"f:value":{}},"k:{\"name\":\"RABBITMQ_NODENAME\"}":{".":{},"f:name":{},"f:value":{}},"k:{\"name\":\"RABBITMQ_USE_LONGNAME\"}":{".":{},"f:name":{},"f:value":{}}},"f:image":{},"f:imagePullPolicy":{},"f:lifecycle":{".":{},"f:preStop":{".":{},"f:exec":{".":{},"f:command":{}}}},"f:name":{},"f:ports":{".":{},"k:{\"containerPort\":4369,\"protocol\":\"TCP\"}":{".":{},"f:containerPort":{},"f:name":{},"f:protocol":{}},"k:{\"containerPort\":5672,\"protocol\":\"TCP\"}":{".":{},"f:containerPort":{},"f:name":{},"f:protocol":{}},"k:{\"containerPort\":15672,\"protocol\":\"TCP\"}":{".":{},"f:containerPort":{},"f:name":{},"f:protocol":{}},"k:{\"containerPort\":15692,\"protocol\":\"TCP\"}":{".":{},"f:containerPort":{},"f:name":{},"f:protocol":{}}},"f:readinessProbe":{".":{},"f:failureThreshold":{},"f:initialDelaySeconds":{},"f:periodSeconds":{},"f:successThreshold":{},"f:tcpSocket":{".":{},"f:port":{}},"f:timeoutSeconds":{}},"f:resources":{".":{},"f:limits":{".":{},"f:cpu":{},"f:memory":{}},"f:requests":{".":{},"f:cpu":{},"f:memory":{}}},"f:terminationMessagePath":{},"f:terminationMessagePolicy":{},"f:volumeMounts":{".":{},"k:{\"mountPath\":\"/etc/pod-info/\"}":{".":{},"f:mountPath":{},"f:name":{}},"k:{\"mountPath\":\"/etc/rabbitmq/conf.d/10-operatorDefaults.conf\"}":{".":{},"f:mountPath":{},"f:name":{},"f:subPath":{}},"k:{\"mountPath\":\"/etc/rabbitmq/conf.d/11-default_user.conf\"}":{".":{},"f:mountPath":{},"f:name":{},"f:subPath":{}},"k:{\"mountPath\":\"/etc/rabbitmq/conf.d/90-userDefinedConfiguration.conf\"}":{".":{},"f:mountPath":{},"f:name":{},"f:subPath":{}},"k:{\"mountPath\":\"/operator\"}":{".":{},"f:mountPath":{},"f:name":{}},"k:{\"mountPath\":\"/var/lib/rabbitmq/\"}":{".":{},"f:mountPath":{},"f:name":{}},"k:{\"mountPath\":\"/var/lib/rabbitmq/mnesia/\"}":{".":{},"f:mountPath":{},"f:name":{}}}}},"f:dnsPolicy":{},"f:initContainers":{".":{},"k:{\"name\":\"setup-container\"}":{".":{},"f:command":{},"f:image":{},"f:imagePullPolicy":{},"f:name":{},"f:resources":{".":{},"f:limits":{".":{},"f:cpu":{},"f:memory":{}},"f:requests":{".":{},"f:cpu":{},"f:memory":{}}},"f:securityContext":{".":{},"f:capabilities":{".":{},"f:drop":{}},"f:runAsUser":{}},"f:terminationMessagePath":{},"f:terminationMessagePolicy":{},"f:volumeMounts":{".":{},"k:{\"mountPath\":\"/operator\"}":{".":{},"f:mountPath":{},"f:name":{}},"k:{\"mountPath\":\"/tmp/default_user.conf\"}":{".":{},"f:mountPath":{},"f:name":{},"f:subPath":{}},"k:{\"mountPath\":\"/tmp/erlang-cookie-secret/\"}":{".":{},"f:mountPath":{},"f:name":{}},"k:{\"mountPath\":\"/tmp/rabbitmq-plugins/\"}":{".":{},"f:mountPath":{},"f:name":{}},"k:{\"mountPath\":\"/var/lib/rabbitmq/\"}":{".":{},"f:mountPath":{},"f:name":{}},"k:{\"mountPath\":\"/var/lib/rabbitmq/mnesia/\"}":{".":{},"f:mountPath":{},"f:name":{}}}}},"f:restartPolicy":{},"f:schedulerName":{},"f:securityContext":{".":{},"f:fsGroup":{},"f:runAsGroup":{},"f:runAsUser":{}},"f:serviceAccount":{},"f:serviceAccountName":{},"f:terminationGracePeriodSeconds":{},"f:topologySpreadConstraints":{".":{},"k:{\"topologyKey\":\"topology.kubernetes.io/zone\",\"whenUnsatisfiable\":\"ScheduleAnyway\"}":{".":{},"f:labelSelector":{".":{},"f:matchLabels":{".":{},"f:app.kubernetes.io/name":{}}},"f:maxSkew":{},"f:topologyKey":{},"f:whenUnsatisfiable":{}}},"f:volumes":{".":{},"k:{\"name\":\"erlang-cookie-secret\"}":{".":{},"f:name":{},"f:secret":{".":{},"f:defaultMode":{},"f:secretName":{}}},"k:{\"name\":\"plugins-conf\"}":{".":{},"f:configMap":{".":{},"f:defaultMode":{},"f:name":{}},"f:name":{}},"k:{\"name\":\"pod-info\"}":{".":{},"f:downwardAPI":{".":{},"f:defaultMode":{},"f:items":{}},"f:name":{}},"k:{\"name\":\"rabbitmq-confd\"}":{".":{},"f:name":{},"f:projected":{".":{},"f:defaultMode":{},"f:sources":{}}},"k:{\"name\":\"rabbitmq-erlang-cookie\"}":{".":{},"f:emptyDir":{},"f:name":{}},"k:{\"name\":\"rabbitmq-plugins\"}":{".":{},"f:emptyDir":{},"f:name":{}}}}},"f:updateStrategy":{"f:rollingUpdate":{".":{},"f:partition":{}},"f:type":{}},"f:volumeClaimTemplates":{}}}},{"manager":"kube-controller-manager","operation":"Update","apiVersion":"apps/v1","time":"2022-03-18T18:01:59Z","fieldsType":"FieldsV1","fieldsV1":{"f:status":{"f:collisionCount":{},"f:currentReplicas":{},"f:currentRevision":{},"f:observedGeneration":{},"f:readyReplicas":{},"f:replicas":{},"f:updateRevision":{},"f:updatedReplicas":{}}}}]},"spec":{"replicas":3,"selector":{"matchLabels":{"app.kubernetes.io/name":"rabbitmq-cluster"}},"template":{"metadata":{"creationTimestamp":null,"labels":{"app.kubernetes.io/component":"rabbitmq","app.kubernetes.io/name":"rabbitmq-cluster","app.kubernetes.io/part-of":"rabbitmq"},"annotations":{"prometheus.io/port":"15692","prometheus.io/scrape":"true"}},"spec":{"volumes":[{"name":"plugins-conf","configMap":{"name":"rabbitmq-cluster-plugins-conf","defaultMode":420}},{"name":"rabbitmq-confd","projected":{"sources":[{"secret":{"name":"rabbitmq-cluster-default-user","items":[{"key":"default_user.conf","path":"default_user.conf"}]}},{"configMap":{"name":"rabbitmq-cluster-server-conf","items":[{"key":"operatorDefaults.conf","path":"operatorDefaults.conf"},{"key":"userDefinedConfiguration.conf","path":"userDefinedConfiguration.conf"}]}}],"defaultMode":420}},{"name":"rabbitmq-erlang-cookie","emptyDir":{}},{"name":"erlang-cookie-secret","secret":{"secretName":"rabbitmq-cluster-erlang-cookie","defaultMode":420}},{"name":"rabbitmq-plugins","emptyDir":{}},{"name":"pod-info","downwardAPI":{"items":[{"path":"skipPreStopChecks","fieldRef":{"apiVersion":"v1","fieldPath":"metadata.labels['skipPreStopChecks']"}}],"defaultMode":420}}],"initContainers":[{"name":"setup-container","image":"rabbitmq:3.8.12-management","command":["sh","-c","cp /tmp/erlang-cookie-secret/.erlang.cookie /var/lib/rabbitmq/.erlang.cookie \u0026\u0026 chown 999:999 /var/lib/rabbitmq/.erlang.cookie \u0026\u0026 chmod 600 /var/lib/rabbitmq/.erlang.cookie ; cp /tmp/rabbitmq-plugins/enabled_plugins /operator/enabled_plugins \u0026\u0026 chown 999:999 /operator/enabled_plugins ; chown 999:999 /var/lib/rabbitmq/mnesia/ ; echo '[default]' \u003e /var/lib/rabbitmq/.rabbitmqadmin.conf \u0026\u0026 sed -e 's/default_user/username/' -e 's/default_pass/password/' /tmp/default_user.conf \u003e\u003e /var/lib/rabbitmq/.rabbitmqadmin.conf \u0026\u0026 chown 999:999 /var/lib/rabbitmq/.rabbitmqadmin.conf \u0026\u0026 chmod 600 /var/lib/rabbitmq/.rabbitmqadmin.conf"],"resources":{"limits":{"cpu":"100m","memory":"500Mi"},"requests":{"cpu":"100m","memory":"500Mi"}},"volumeMounts":[{"name":"plugins-conf","mountPath":"/tmp/rabbitmq-plugins/"},{"name":"rabbitmq-erlang-cookie","mountPath":"/var/lib/rabbitmq/"},{"name":"erlang-cookie-secret","mountPath":"/tmp/erlang-cookie-secret/"},{"name":"rabbitmq-plugins","mountPath":"/operator"},{"name":"persistence","mountPath":"/var/lib/rabbitmq/mnesia/"},{"name":"rabbitmq-confd","mountPath":"/tmp/default_user.conf","subPath":"default_user.conf"}],"terminationMessagePath":"/dev/termination-log","terminationMessagePolicy":"File","imagePullPolicy":"IfNotPresent","securityContext":{"capabilities":{"drop":["FSETID","KILL","SETGID","SETUID","SETPCAP","NET_BIND_SERVICE","NET_RAW","SYS_CHROOT","MKNOD","AUDIT_WRITE","SETFCAP"]},"runAsUser":0}}],"containers":[{"name":"rabbitmq","image":"rabbitmq:3.8.12-management","ports":[{"name":"epmd","containerPort":4369,"protocol":"TCP"},{"name":"amqp","containerPort":5672,"protocol":"TCP"},{"name":"management","containerPort":15672,"protocol":"TCP"},{"name":"prometheus","containerPort":15692,"protocol":"TCP"}],"env":[{"name":"MY_POD_NAME","valueFrom":{"fieldRef":{"apiVersion":"v1","fieldPath":"metadata.name"}}},{"name":"MY_POD_NAMESPACE","valueFrom":{"fieldRef":{"apiVersion":"v1","fieldPath":"metadata.namespace"}}},{"name":"RABBITMQ_ENABLED_PLUGINS_FILE","value":"/operator/enabled_plugins"},{"name":"K8S_SERVICE_NAME","value":"rabbitmq-cluster-nodes"},{"name":"RABBITMQ_USE_LONGNAME","value":"true"},{"name":"RABBITMQ_NODENAME","value":"rabbit@$(MY_POD_NAME).$(K8S_SERVICE_NAME).$(MY_POD_NAMESPACE)"},{"name":"K8S_HOSTNAME_SUFFIX","value":".$(K8S_SERVICE_NAME).$(MY_POD_NAMESPACE)"}],"resources":{"limits":{"cpu":"2","memory":"2Gi"},"requests":{"cpu":"1","memory":"2Gi"}},"volumeMounts":[{"name":"rabbitmq-erlang-cookie","mountPath":"/var/lib/rabbitmq/"},{"name":"persistence","mountPath":"/var/lib/rabbitmq/mnesia/"},{"name":"rabbitmq-plugins","mountPath":"/operator"},{"name":"rabbitmq-confd","mountPath":"/etc/rabbitmq/conf.d/10-operatorDefaults.conf","subPath":"operatorDefaults.conf"},{"name":"rabbitmq-confd","mountPath":"/etc/rabbitmq/conf.d/11-default_user.conf","subPath":"default_user.conf"},{"name":"rabbitmq-confd","mountPath":"/etc/rabbitmq/conf.d/90-userDefinedConfiguration.conf","subPath":"userDefinedConfiguration.conf"},{"name":"pod-info","mountPath":"/etc/pod-info/"}],"readinessProbe":{"tcpSocket":{"port":"amqp"},"initialDelaySeconds":10,"timeoutSeconds":5,"periodSeconds":10,"successThreshold":1,"failureThreshold":3},"lifecycle":{"preStop":{"exec":{"command":["/bin/bash","-c","if [ ! -z \"$(cat /etc/pod-info/skipPreStopChecks)\" ]; then exit 0; fi; rabbitmq-upgrade await_online_quorum_plus_one -t 604800; rabbitmq-upgrade await_online_synchronized_mirror -t 604800; rabbitmq-upgrade drain -t 604800"]}}},"terminationMessagePath":"/dev/termination-log","terminationMessagePolicy":"File","imagePullPolicy":"IfNotPresent"}],"restartPolicy":"Always","terminationGracePeriodSeconds":604800,"dnsPolicy":"ClusterFirst","serviceAccountName":"rabbitmq-cluster-server","serviceAccount":"rabbitmq-cluster-server","automountServiceAccountToken":true,"securityContext":{"runAsUser":999,"runAsGroup":999,"fsGroup":999},"schedulerName":"default-scheduler","topologySpreadConstraints":[{"maxSkew":1,"topologyKey":"topology.kubernetes.io/zone","whenUnsatisfiable":"ScheduleAnyway","labelSelector":{"matchLabels":{"app.kubernetes.io/name":"rabbitmq-cluster"}}}]}},"volumeClaimTemplates":[{"metadata":{"name":"persistence","namespace":"default","creationTimestamp":null,"labels":{"app.kubernetes.io/component":"rabbitmq","app.kubernetes.io/name":"rabbitmq-cluster","app.kubernetes.io/part-of":"rabbitmq"},"ownerReferences":[{"apiVersion":"rabbitmq.com/v1beta1","kind":"RabbitmqCluster","name":"rabbitmq-cluster","uid":"18d9928b-0d1c-47be-80ec-20960d053827","controller":true,"blockOwnerDeletion":false}]},"spec":{"accessModes":["ReadWriteOnce"],"resources":{"requests":{"storage":"10Gi"}},"volumeMode":"Filesystem"},"status":{"phase":"Pending"}}],"serviceName":"rabbitmq-cluster-nodes","podManagementPolicy":"Parallel","updateStrategy":{"type":"RollingUpdate","rollingUpdate":{"partition":0}},"revisionHistoryLimit":10},"status":{"observedGeneration":2,"replicas":3,"readyReplicas":2,"currentReplicas":3,"updatedReplicas":3,"currentRevision":"rabbitmq-cluster-server-5f8b8665fb","updateRevision":"rabbitmq-cluster-server-5f8b8665fb","collisionCount":0}}
2022/03/18 18:01:59 learn_server.go:253: [SIEVE-AFTER-RECONCILE]	github.com/rabbitmq/cluster-operator/controllers.(*RabbitmqClusterReconciler)	14
2022/03/18 18:01:59 learn_server.go:238: [SIEVE-BEFORE-RECONCILE]	github.com/rabbitmq/cluster-operator/controllers.(*RabbitmqClusterReconciler)	15
2022/03/18 18:01:59 learn_server.go:291: [SIEVE-AFTER-READ]	Get	true	rabbitmqcluster	default	rabbitmq-cluster	github.com/rabbitmq/cluster-operator/controllers.(*RabbitmqClusterReconciler)	NoError	{"kind":"RabbitmqCluster","apiVersion":"rabbitmq.com/v1beta1","metadata":{"name":"rabbitmq-cluster","namespace":"default","selfLink":"/apis/rabbitmq.com/v1beta1/namespaces/default/rabbitmqclusters/rabbitmq-cluster","uid":"18d9928b-0d1c-47be-80ec-20960d053827","resourceVersion":"1215","generation":3,"creationTimestamp":"2022-03-18T18:00:38Z","annotations":{"kubectl.kubernetes.io/last-applied-configuration":"{\"apiVersion\":\"rabbitmq.com/v1beta1\",\"kind\":\"RabbitmqCluster\",\"metadata\":{\"annotations\":{},\"name\":\"rabbitmq-cluster\",\"namespace\":\"default\"},\"spec\":{\"persistence\":{\"storage\":\"10Gi\"},\"replicas\":1}}\n"},"finalizers":["deletion.finalizers.rabbitmqclusters.rabbitmq.com"],"managedFields":[{"manager":"kubectl-client-side-apply","operation":"Update","apiVersion":"rabbitmq.com/v1beta1","time":"2022-03-18T18:00:38Z","fieldsType":"FieldsV1","fieldsV1":{"f:metadata":{"f:annotations":{".":{},"f:kubectl.kubernetes.io/last-applied-configuration":{}}},"f:spec":{".":{},"f:image":{},"f:persistence":{".":{},"f:storage":{}},"f:resources":{".":{},"f:limits":{".":{},"f:memory":{}},"f:requests":{".":{},"f:memory":{}}},"f:service":{".":{},"f:type":{}},"f:terminationGracePeriodSeconds":{}}}},{"manager":"kubectl-patch","operation":"Update","apiVersion":"rabbitmq.com/v1beta1","time":"2022-03-18T18:01:23Z","fieldsType":"FieldsV1","fieldsV1":{"f:spec":{"f:replicas":{}}}},{"manager":"manager","operation":"Update","apiVersion":"rabbitmq.com/v1beta1","time":"2022-03-18T18:01:59Z","fieldsType":"FieldsV1","fieldsV1":{"f:metadata":{"f:finalizers":{}},"f:spec":{"f:override":{},"f:rabbitmq":{},"f:resources":{"f:limits":{"f:cpu":{}},"f:requests":{"f:cpu":{}}},"f:tls":{}},"f:status":{".":{},"f:conditions":{},"f:defaultUser":{".":{},"f:secretReference":{".":{},"f:keys":{".":{},"f:password":{},"f:username":{}},"f:name":{},"f:namespace":{}},"f:serviceReference":{".":{},"f:name":{},"f:namespace":{}}}}}}]},"spec":{"replicas":3,"image":"rabbitmq:3.8.12-management","service":{"type":"ClusterIP"},"persistence":{"storage":"10Gi"},"resources":{"limits":{"cpu":"2","memory":"2Gi"},"requests":{"cpu":"1","memory":"2Gi"}},"rabbitmq":{},"tls":{},"override":{},"terminationGracePeriodSeconds":604800},"status":{"conditions":[{"type":"AllReplicasReady","status":"False","lastTransitionTime":"2022-03-18T18:01:23Z","reason":"NotAllPodsReady","message":"2/3 Pods ready"},{"type":"ClusterAvailable","status":"True","lastTransitionTime":"2022-03-18T18:01:17Z","reason":"AtLeastOneEndpointAvailable"},{"type":"NoWarnings","status":"True","lastTransitionTime":"2022-03-18T18:00:38Z","reason":"NoWarnings"},{"type":"ReconcileSuccess","status":"True","lastTransitionTime":"2022-03-18T18:01:18Z","reason":"Success","message":"Finish reconciling"}],"defaultUser":{"secretReference":{"name":"rabbitmq-cluster-default-user","namespace":"default","keys":{"password":"password","username":"username"}},"serviceReference":{"name":"rabbitmq-cluster","namespace":"default"}}}}
2022/03/18 18:01:59 learn_server.go:291: [SIEVE-AFTER-READ]	Get	true	statefulset	default	rabbitmq-cluster-server	github.com/rabbitmq/cluster-operator/controllers.(*RabbitmqClusterReconciler)	NoError	{"kind":"StatefulSet","apiVersion":"apps/v1","metadata":{"name":"rabbitmq-cluster-server","namespace":"default","selfLink":"/apis/apps/v1/namespaces/default/statefulsets/rabbitmq-cluster-server","uid":"cb5c43bc-6ee7-481c-ab01-6f3acffdd3c8","resourceVersion":"1214","generation":2,"creationTimestamp":"2022-03-18T18:00:38Z","labels":{"app.kubernetes.io/component":"rabbitmq","app.kubernetes.io/name":"rabbitmq-cluster","app.kubernetes.io/part-of":"rabbitmq"},"ownerReferences":[{"apiVersion":"rabbitmq.com/v1beta1","kind":"RabbitmqCluster","name":"rabbitmq-cluster","uid":"18d9928b-0d1c-47be-80ec-20960d053827","controller":true,"blockOwnerDeletion":true}],"managedFields":[{"manager":"manager","operation":"Update","apiVersion":"apps/v1","time":"2022-03-18T18:01:23Z","fieldsType":"FieldsV1","fieldsV1":{"f:metadata":{"f:labels":{".":{},"f:app.kubernetes.io/component":{},"f:app.kubernetes.io/name":{},"f:app.kubernetes.io/part-of":{}},"f:ownerReferences":{".":{},"k:{\"uid\":\"18d9928b-0d1c-47be-80ec-20960d053827\"}":{".":{},"f:apiVersion":{},"f:blockOwnerDeletion":{},"f:controller":{},"f:kind":{},"f:name":{},"f:uid":{}}}},"f:spec":{"f:podManagementPolicy":{},"f:replicas":{},"f:revisionHistoryLimit":{},"f:selector":{"f:matchLabels":{".":{},"f:app.kubernetes.io/name":{}}},"f:serviceName":{},"f:template":{"f:metadata":{"f:annotations":{".":{},"f:prometheus.io/port":{},"f:prometheus.io/scrape":{}},"f:labels":{".":{},"f:app.kubernetes.io/component":{},"f:app.kubernetes.io/name":{},"f:app.kubernetes.io/part-of":{}}},"f:spec":{"f:automountServiceAccountToken":{},"f:containers":{"k:{\"name\":\"rabbitmq\"}":{".":{},"f:env":{".":{},"k:{\"name\":\"K8S_HOSTNAME_SUFFIX\"}":{".":{},"f:name":{},"f:value":{}},"k:{\"name\":\"K8S_SERVICE_NAME\"}":{".":{},"f:name":{},"f:value":{}},"k:{\"name\":\"MY_POD_NAME\"}":{".":{},"f:name":{},"f:valueFrom":{".":{},"f:fieldRef":{".":{},"f:apiVersion":{},"f:fieldPath":{}}}},"k:{\"name\":\"MY_POD_NAMESPACE\"}":{".":{},"f:name":{},"f:valueFrom":{".":{},"f:fieldRef":{".":{},"f:apiVersion":{},"f:fieldPath":{}}}},"k:{\"name\":\"RABBITMQ_ENABLED_PLUGINS_FILE\"}":{".":{},"f:name":{},"f:value":{}},"k:{\"name\":\"RABBITMQ_NODENAME\"}":{".":{},"f:name":{},"f:value":{}},"k:{\"name\":\"RABBITMQ_USE_LONGNAME\"}":{".":{},"f:name":{},"f:value":{}}},"f:image":{},"f:imagePullPolicy":{},"f:lifecycle":{".":{},"f:preStop":{".":{},"f:exec":{".":{},"f:command":{}}}},"f:name":{},"f:ports":{".":{},"k:{\"containerPort\":4369,\"protocol\":\"TCP\"}":{".":{},"f:containerPort":{},"f:name":{},"f:protocol":{}},"k:{\"containerPort\":5672,\"protocol\":\"TCP\"}":{".":{},"f:containerPort":{},"f:name":{},"f:protocol":{}},"k:{\"containerPort\":15672,\"protocol\":\"TCP\"}":{".":{},"f:containerPort":{},"f:name":{},"f:protocol":{}},"k:{\"containerPort\":15692,\"protocol\":\"TCP\"}":{".":{},"f:containerPort":{},"f:name":{},"f:protocol":{}}},"f:readinessProbe":{".":{},"f:failureThreshold":{},"f:initialDelaySeconds":{},"f:periodSeconds":{},"f:successThreshold":{},"f:tcpSocket":{".":{},"f:port":{}},"f:timeoutSeconds":{}},"f:resources":{".":{},"f:limits":{".":{},"f:cpu":{},"f:memory":{}},"f:requests":{".":{},"f:cpu":{},"f:memory":{}}},"f:terminationMessagePath":{},"f:terminationMessagePolicy":{},"f:volumeMounts":{".":{},"k:{\"mountPath\":\"/etc/pod-info/\"}":{".":{},"f:mountPath":{},"f:name":{}},"k:{\"mountPath\":\"/etc/rabbitmq/conf.d/10-operatorDefaults.conf\"}":{".":{},"f:mountPath":{},"f:name":{},"f:subPath":{}},"k:{\"mountPath\":\"/etc/rabbitmq/conf.d/11-default_user.conf\"}":{".":{},"f:mountPath":{},"f:name":{},"f:subPath":{}},"k:{\"mountPath\":\"/etc/rabbitmq/conf.d/90-userDefinedConfiguration.conf\"}":{".":{},"f:mountPath":{},"f:name":{},"f:subPath":{}},"k:{\"mountPath\":\"/operator\"}":{".":{},"f:mountPath":{},"f:name":{}},"k:{\"mountPath\":\"/var/lib/rabbitmq/\"}":{".":{},"f:mountPath":{},"f:name":{}},"k:{\"mountPath\":\"/var/lib/rabbitmq/mnesia/\"}":{".":{},"f:mountPath":{},"f:name":{}}}}},"f:dnsPolicy":{},"f:initContainers":{".":{},"k:{\"name\":\"setup-container\"}":{".":{},"f:command":{},"f:image":{},"f:imagePullPolicy":{},"f:name":{},"f:resources":{".":{},"f:limits":{".":{},"f:cpu":{},"f:memory":{}},"f:requests":{".":{},"f:cpu":{},"f:memory":{}}},"f:securityContext":{".":{},"f:capabilities":{".":{},"f:drop":{}},"f:runAsUser":{}},"f:terminationMessagePath":{},"f:terminationMessagePolicy":{},"f:volumeMounts":{".":{},"k:{\"mountPath\":\"/operator\"}":{".":{},"f:mountPath":{},"f:name":{}},"k:{\"mountPath\":\"/tmp/default_user.conf\"}":{".":{},"f:mountPath":{},"f:name":{},"f:subPath":{}},"k:{\"mountPath\":\"/tmp/erlang-cookie-secret/\"}":{".":{},"f:mountPath":{},"f:name":{}},"k:{\"mountPath\":\"/tmp/rabbitmq-plugins/\"}":{".":{},"f:mountPath":{},"f:name":{}},"k:{\"mountPath\":\"/var/lib/rabbitmq/\"}":{".":{},"f:mountPath":{},"f:name":{}},"k:{\"mountPath\":\"/var/lib/rabbitmq/mnesia/\"}":{".":{},"f:mountPath":{},"f:name":{}}}}},"f:restartPolicy":{},"f:schedulerName":{},"f:securityContext":{".":{},"f:fsGroup":{},"f:runAsGroup":{},"f:runAsUser":{}},"f:serviceAccount":{},"f:serviceAccountName":{},"f:terminationGracePeriodSeconds":{},"f:topologySpreadConstraints":{".":{},"k:{\"topologyKey\":\"topology.kubernetes.io/zone\",\"whenUnsatisfiable\":\"ScheduleAnyway\"}":{".":{},"f:labelSelector":{".":{},"f:matchLabels":{".":{},"f:app.kubernetes.io/name":{}}},"f:maxSkew":{},"f:topologyKey":{},"f:whenUnsatisfiable":{}}},"f:volumes":{".":{},"k:{\"name\":\"erlang-cookie-secret\"}":{".":{},"f:name":{},"f:secret":{".":{},"f:defaultMode":{},"f:secretName":{}}},"k:{\"name\":\"plugins-conf\"}":{".":{},"f:configMap":{".":{},"f:defaultMode":{},"f:name":{}},"f:name":{}},"k:{\"name\":\"pod-info\"}":{".":{},"f:downwardAPI":{".":{},"f:defaultMode":{},"f:items":{}},"f:name":{}},"k:{\"name\":\"rabbitmq-confd\"}":{".":{},"f:name":{},"f:projected":{".":{},"f:defaultMode":{},"f:sources":{}}},"k:{\"name\":\"rabbitmq-erlang-cookie\"}":{".":{},"f:emptyDir":{},"f:name":{}},"k:{\"name\":\"rabbitmq-plugins\"}":{".":{},"f:emptyDir":{},"f:name":{}}}}},"f:updateStrategy":{"f:rollingUpdate":{".":{},"f:partition":{}},"f:type":{}},"f:volumeClaimTemplates":{}}}},{"manager":"kube-controller-manager","operation":"Update","apiVersion":"apps/v1","time":"2022-03-18T18:01:59Z","fieldsType":"FieldsV1","fieldsV1":{"f:status":{"f:collisionCount":{},"f:currentReplicas":{},"f:currentRevision":{},"f:observedGeneration":{},"f:readyReplicas":{},"f:replicas":{},"f:updateRevision":{},"f:updatedReplicas":{}}}}]},"spec":{"replicas":3,"selector":{"matchLabels":{"app.kubernetes.io/name":"rabbitmq-cluster"}},"template":{"metadata":{"creationTimestamp":null,"labels":{"app.kubernetes.io/component":"rabbitmq","app.kubernetes.io/name":"rabbitmq-cluster","app.kubernetes.io/part-of":"rabbitmq"},"annotations":{"prometheus.io/port":"15692","prometheus.io/scrape":"true"}},"spec":{"volumes":[{"name":"plugins-conf","configMap":{"name":"rabbitmq-cluster-plugins-conf","defaultMode":420}},{"name":"rabbitmq-confd","projected":{"sources":[{"secret":{"name":"rabbitmq-cluster-default-user","items":[{"key":"default_user.conf","path":"default_user.conf"}]}},{"configMap":{"name":"rabbitmq-cluster-server-conf","items":[{"key":"operatorDefaults.conf","path":"operatorDefaults.conf"},{"key":"userDefinedConfiguration.conf","path":"userDefinedConfiguration.conf"}]}}],"defaultMode":420}},{"name":"rabbitmq-erlang-cookie","emptyDir":{}},{"name":"erlang-cookie-secret","secret":{"secretName":"rabbitmq-cluster-erlang-cookie","defaultMode":420}},{"name":"rabbitmq-plugins","emptyDir":{}},{"name":"pod-info","downwardAPI":{"items":[{"path":"skipPreStopChecks","fieldRef":{"apiVersion":"v1","fieldPath":"metadata.labels['skipPreStopChecks']"}}],"defaultMode":420}}],"initContainers":[{"name":"setup-container","image":"rabbitmq:3.8.12-management","command":["sh","-c","cp /tmp/erlang-cookie-secret/.erlang.cookie /var/lib/rabbitmq/.erlang.cookie \u0026\u0026 chown 999:999 /var/lib/rabbitmq/.erlang.cookie \u0026\u0026 chmod 600 /var/lib/rabbitmq/.erlang.cookie ; cp /tmp/rabbitmq-plugins/enabled_plugins /operator/enabled_plugins \u0026\u0026 chown 999:999 /operator/enabled_plugins ; chown 999:999 /var/lib/rabbitmq/mnesia/ ; echo '[default]' \u003e /var/lib/rabbitmq/.rabbitmqadmin.conf \u0026\u0026 sed -e 's/default_user/username/' -e 's/default_pass/password/' /tmp/default_user.conf \u003e\u003e /var/lib/rabbitmq/.rabbitmqadmin.conf \u0026\u0026 chown 999:999 /var/lib/rabbitmq/.rabbitmqadmin.conf \u0026\u0026 chmod 600 /var/lib/rabbitmq/.rabbitmqadmin.conf"],"resources":{"limits":{"cpu":"100m","memory":"500Mi"},"requests":{"cpu":"100m","memory":"500Mi"}},"volumeMounts":[{"name":"plugins-conf","mountPath":"/tmp/rabbitmq-plugins/"},{"name":"rabbitmq-erlang-cookie","mountPath":"/var/lib/rabbitmq/"},{"name":"erlang-cookie-secret","mountPath":"/tmp/erlang-cookie-secret/"},{"name":"rabbitmq-plugins","mountPath":"/operator"},{"name":"persistence","mountPath":"/var/lib/rabbitmq/mnesia/"},{"name":"rabbitmq-confd","mountPath":"/tmp/default_user.conf","subPath":"default_user.conf"}],"terminationMessagePath":"/dev/termination-log","terminationMessagePolicy":"File","imagePullPolicy":"IfNotPresent","securityContext":{"capabilities":{"drop":["FSETID","KILL","SETGID","SETUID","SETPCAP","NET_BIND_SERVICE","NET_RAW","SYS_CHROOT","MKNOD","AUDIT_WRITE","SETFCAP"]},"runAsUser":0}}],"containers":[{"name":"rabbitmq","image":"rabbitmq:3.8.12-management","ports":[{"name":"epmd","containerPort":4369,"protocol":"TCP"},{"name":"amqp","containerPort":5672,"protocol":"TCP"},{"name":"management","containerPort":15672,"protocol":"TCP"},{"name":"prometheus","containerPort":15692,"protocol":"TCP"}],"env":[{"name":"MY_POD_NAME","valueFrom":{"fieldRef":{"apiVersion":"v1","fieldPath":"metadata.name"}}},{"name":"MY_POD_NAMESPACE","valueFrom":{"fieldRef":{"apiVersion":"v1","fieldPath":"metadata.namespace"}}},{"name":"RABBITMQ_ENABLED_PLUGINS_FILE","value":"/operator/enabled_plugins"},{"name":"K8S_SERVICE_NAME","value":"rabbitmq-cluster-nodes"},{"name":"RABBITMQ_USE_LONGNAME","value":"true"},{"name":"RABBITMQ_NODENAME","value":"rabbit@$(MY_POD_NAME).$(K8S_SERVICE_NAME).$(MY_POD_NAMESPACE)"},{"name":"K8S_HOSTNAME_SUFFIX","value":".$(K8S_SERVICE_NAME).$(MY_POD_NAMESPACE)"}],"resources":{"limits":{"cpu":"2","memory":"2Gi"},"requests":{"cpu":"1","memory":"2Gi"}},"volumeMounts":[{"name":"rabbitmq-erlang-cookie","mountPath":"/var/lib/rabbitmq/"},{"name":"persistence","mountPath":"/var/lib/rabbitmq/mnesia/"},{"name":"rabbitmq-plugins","mountPath":"/operator"},{"name":"rabbitmq-confd","mountPath":"/etc/rabbitmq/conf.d/10-operatorDefaults.conf","subPath":"operatorDefaults.conf"},{"name":"rabbitmq-confd","mountPath":"/etc/rabbitmq/conf.d/11-default_user.conf","subPath":"default_user.conf"},{"name":"rabbitmq-confd","mountPath":"/etc/rabbitmq/conf.d/90-userDefinedConfiguration.conf","subPath":"userDefinedConfiguration.conf"},{"name":"pod-info","mountPath":"/etc/pod-info/"}],"readinessProbe":{"tcpSocket":{"port":"amqp"},"initialDelaySeconds":10,"timeoutSeconds":5,"periodSeconds":10,"successThreshold":1,"failureThreshold":3},"lifecycle":{"preStop":{"exec":{"command":["/bin/bash","-c","if [ ! -z \"$(cat /etc/pod-info/skipPreStopChecks)\" ]; then exit 0; fi; rabbitmq-upgrade await_online_quorum_plus_one -t 604800; rabbitmq-upgrade await_online_synchronized_mirror -t 604800; rabbitmq-upgrade drain -t 604800"]}}},"terminationMessagePath":"/dev/termination-log","terminationMessagePolicy":"File","imagePullPolicy":"IfNotPresent"}],"restartPolicy":"Always","terminationGracePeriodSeconds":604800,"dnsPolicy":"ClusterFirst","serviceAccountName":"rabbitmq-cluster-server","serviceAccount":"rabbitmq-cluster-server","automountServiceAccountToken":true,"securityContext":{"runAsUser":999,"runAsGroup":999,"fsGroup":999},"schedulerName":"default-scheduler","topologySpreadConstraints":[{"maxSkew":1,"topologyKey":"topology.kubernetes.io/zone","whenUnsatisfiable":"ScheduleAnyway","labelSelector":{"matchLabels":{"app.kubernetes.io/name":"rabbitmq-cluster"}}}]}},"volumeClaimTemplates":[{"metadata":{"name":"persistence","namespace":"default","creationTimestamp":null,"labels":{"app.kubernetes.io/component":"rabbitmq","app.kubernetes.io/name":"rabbitmq-cluster","app.kubernetes.io/part-of":"rabbitmq"},"ownerReferences":[{"apiVersion":"rabbitmq.com/v1beta1","kind":"RabbitmqCluster","name":"rabbitmq-cluster","uid":"18d9928b-0d1c-47be-80ec-20960d053827","controller":true,"blockOwnerDeletion":false}]},"spec":{"accessModes":["ReadWriteOnce"],"resources":{"requests":{"storage":"10Gi"}},"volumeMode":"Filesystem"},"status":{"phase":"Pending"}}],"serviceName":"rabbitmq-cluster-nodes","podManagementPolicy":"Parallel","updateStrategy":{"type":"RollingUpdate","rollingUpdate":{"partition":0}},"revisionHistoryLimit":10},"status":{"observedGeneration":2,"replicas":3,"readyReplicas":2,"currentReplicas":3,"updatedReplicas":3,"currentRevision":"rabbitmq-cluster-server-5f8b8665fb","updateRevision":"rabbitmq-cluster-server-5f8b8665fb","collisionCount":0}}
2022/03/18 18:01:59 learn_server.go:291: [SIEVE-AFTER-READ]	Get	true	endpoints	default	rabbitmq-cluster	github.com/rabbitmq/cluster-operator/controllers.(*RabbitmqClusterReconciler)	NoError	{"kind":"Endpoints","apiVersion":"v1","metadata":{"name":"rabbitmq-cluster","namespace":"default","selfLink":"/api/v1/namespaces/default/endpoints/rabbitmq-cluster","uid":"5c4723ad-f4fe-442d-9135-44879a2a8183","resourceVersion":"1210","creationTimestamp":"2022-03-18T18:00:38Z","labels":{"app.kubernetes.io/component":"rabbitmq","app.kubernetes.io/name":"rabbitmq-cluster","app.kubernetes.io/part-of":"rabbitmq"},"annotations":{"endpoints.kubernetes.io/last-change-trigger-time":"2022-03-18T18:01:59Z"},"managedFields":[{"manager":"kube-controller-manager","operation":"Update","apiVersion":"v1","time":"2022-03-18T18:01:59Z","fieldsType":"FieldsV1","fieldsV1":{"f:metadata":{"f:annotations":{".":{},"f:endpoints.kubernetes.io/last-change-trigger-time":{}},"f:labels":{".":{},"f:app.kubernetes.io/component":{},"f:app.kubernetes.io/name":{},"f:app.kubernetes.io/part-of":{}}},"f:subsets":{}}}]},"subsets":[{"addresses":[{"ip":"10.244.1.4","nodeName":"kind-worker2","targetRef":{"kind":"Pod","namespace":"default","name":"rabbitmq-cluster-server-0","uid":"e7faffc5-b656-4e69-9777-92d12cb6ec5a","resourceVersion":"938"}},{"ip":"10.244.2.5","nodeName":"kind-worker","targetRef":{"kind":"Pod","namespace":"default","name":"rabbitmq-cluster-server-2","uid":"2a54a659-a979-4e10-8e74-1e0b83d532ba","resourceVersion":"1209"}}],"notReadyAddresses":[{"ip":"10.244.2.4","nodeName":"kind-worker","targetRef":{"kind":"Pod","namespace":"default","name":"rabbitmq-cluster-server-1","uid":"7a37da00-25d1-48b6-a659-4390fb7a02cb","resourceVersion":"1099"}}],"ports":[{"name":"amqp","port":5672,"protocol":"TCP"},{"name":"management","port":15672,"protocol":"TCP"}]}]}
2022/03/18 18:01:59 learn_server.go:291: [SIEVE-AFTER-READ]	Get	true	statefulset	default	rabbitmq-cluster-server	github.com/rabbitmq/cluster-operator/controllers.(*RabbitmqClusterReconciler)	NoError	{"kind":"StatefulSet","apiVersion":"apps/v1","metadata":{"name":"rabbitmq-cluster-server","namespace":"default","selfLink":"/apis/apps/v1/namespaces/default/statefulsets/rabbitmq-cluster-server","uid":"cb5c43bc-6ee7-481c-ab01-6f3acffdd3c8","resourceVersion":"1214","generation":2,"creationTimestamp":"2022-03-18T18:00:38Z","labels":{"app.kubernetes.io/component":"rabbitmq","app.kubernetes.io/name":"rabbitmq-cluster","app.kubernetes.io/part-of":"rabbitmq"},"ownerReferences":[{"apiVersion":"rabbitmq.com/v1beta1","kind":"RabbitmqCluster","name":"rabbitmq-cluster","uid":"18d9928b-0d1c-47be-80ec-20960d053827","controller":true,"blockOwnerDeletion":true}],"managedFields":[{"manager":"manager","operation":"Update","apiVersion":"apps/v1","time":"2022-03-18T18:01:23Z","fieldsType":"FieldsV1","fieldsV1":{"f:metadata":{"f:labels":{".":{},"f:app.kubernetes.io/component":{},"f:app.kubernetes.io/name":{},"f:app.kubernetes.io/part-of":{}},"f:ownerReferences":{".":{},"k:{\"uid\":\"18d9928b-0d1c-47be-80ec-20960d053827\"}":{".":{},"f:apiVersion":{},"f:blockOwnerDeletion":{},"f:controller":{},"f:kind":{},"f:name":{},"f:uid":{}}}},"f:spec":{"f:podManagementPolicy":{},"f:replicas":{},"f:revisionHistoryLimit":{},"f:selector":{"f:matchLabels":{".":{},"f:app.kubernetes.io/name":{}}},"f:serviceName":{},"f:template":{"f:metadata":{"f:annotations":{".":{},"f:prometheus.io/port":{},"f:prometheus.io/scrape":{}},"f:labels":{".":{},"f:app.kubernetes.io/component":{},"f:app.kubernetes.io/name":{},"f:app.kubernetes.io/part-of":{}}},"f:spec":{"f:automountServiceAccountToken":{},"f:containers":{"k:{\"name\":\"rabbitmq\"}":{".":{},"f:env":{".":{},"k:{\"name\":\"K8S_HOSTNAME_SUFFIX\"}":{".":{},"f:name":{},"f:value":{}},"k:{\"name\":\"K8S_SERVICE_NAME\"}":{".":{},"f:name":{},"f:value":{}},"k:{\"name\":\"MY_POD_NAME\"}":{".":{},"f:name":{},"f:valueFrom":{".":{},"f:fieldRef":{".":{},"f:apiVersion":{},"f:fieldPath":{}}}},"k:{\"name\":\"MY_POD_NAMESPACE\"}":{".":{},"f:name":{},"f:valueFrom":{".":{},"f:fieldRef":{".":{},"f:apiVersion":{},"f:fieldPath":{}}}},"k:{\"name\":\"RABBITMQ_ENABLED_PLUGINS_FILE\"}":{".":{},"f:name":{},"f:value":{}},"k:{\"name\":\"RABBITMQ_NODENAME\"}":{".":{},"f:name":{},"f:value":{}},"k:{\"name\":\"RABBITMQ_USE_LONGNAME\"}":{".":{},"f:name":{},"f:value":{}}},"f:image":{},"f:imagePullPolicy":{},"f:lifecycle":{".":{},"f:preStop":{".":{},"f:exec":{".":{},"f:command":{}}}},"f:name":{},"f:ports":{".":{},"k:{\"containerPort\":4369,\"protocol\":\"TCP\"}":{".":{},"f:containerPort":{},"f:name":{},"f:protocol":{}},"k:{\"containerPort\":5672,\"protocol\":\"TCP\"}":{".":{},"f:containerPort":{},"f:name":{},"f:protocol":{}},"k:{\"containerPort\":15672,\"protocol\":\"TCP\"}":{".":{},"f:containerPort":{},"f:name":{},"f:protocol":{}},"k:{\"containerPort\":15692,\"protocol\":\"TCP\"}":{".":{},"f:containerPort":{},"f:name":{},"f:protocol":{}}},"f:readinessProbe":{".":{},"f:failureThreshold":{},"f:initialDelaySeconds":{},"f:periodSeconds":{},"f:successThreshold":{},"f:tcpSocket":{".":{},"f:port":{}},"f:timeoutSeconds":{}},"f:resources":{".":{},"f:limits":{".":{},"f:cpu":{},"f:memory":{}},"f:requests":{".":{},"f:cpu":{},"f:memory":{}}},"f:terminationMessagePath":{},"f:terminationMessagePolicy":{},"f:volumeMounts":{".":{},"k:{\"mountPath\":\"/etc/pod-info/\"}":{".":{},"f:mountPath":{},"f:name":{}},"k:{\"mountPath\":\"/etc/rabbitmq/conf.d/10-operatorDefaults.conf\"}":{".":{},"f:mountPath":{},"f:name":{},"f:subPath":{}},"k:{\"mountPath\":\"/etc/rabbitmq/conf.d/11-default_user.conf\"}":{".":{},"f:mountPath":{},"f:name":{},"f:subPath":{}},"k:{\"mountPath\":\"/etc/rabbitmq/conf.d/90-userDefinedConfiguration.conf\"}":{".":{},"f:mountPath":{},"f:name":{},"f:subPath":{}},"k:{\"mountPath\":\"/operator\"}":{".":{},"f:mountPath":{},"f:name":{}},"k:{\"mountPath\":\"/var/lib/rabbitmq/\"}":{".":{},"f:mountPath":{},"f:name":{}},"k:{\"mountPath\":\"/var/lib/rabbitmq/mnesia/\"}":{".":{},"f:mountPath":{},"f:name":{}}}}},"f:dnsPolicy":{},"f:initContainers":{".":{},"k:{\"name\":\"setup-container\"}":{".":{},"f:command":{},"f:image":{},"f:imagePullPolicy":{},"f:name":{},"f:resources":{".":{},"f:limits":{".":{},"f:cpu":{},"f:memory":{}},"f:requests":{".":{},"f:cpu":{},"f:memory":{}}},"f:securityContext":{".":{},"f:capabilities":{".":{},"f:drop":{}},"f:runAsUser":{}},"f:terminationMessagePath":{},"f:terminationMessagePolicy":{},"f:volumeMounts":{".":{},"k:{\"mountPath\":\"/operator\"}":{".":{},"f:mountPath":{},"f:name":{}},"k:{\"mountPath\":\"/tmp/default_user.conf\"}":{".":{},"f:mountPath":{},"f:name":{},"f:subPath":{}},"k:{\"mountPath\":\"/tmp/erlang-cookie-secret/\"}":{".":{},"f:mountPath":{},"f:name":{}},"k:{\"mountPath\":\"/tmp/rabbitmq-plugins/\"}":{".":{},"f:mountPath":{},"f:name":{}},"k:{\"mountPath\":\"/var/lib/rabbitmq/\"}":{".":{},"f:mountPath":{},"f:name":{}},"k:{\"mountPath\":\"/var/lib/rabbitmq/mnesia/\"}":{".":{},"f:mountPath":{},"f:name":{}}}}},"f:restartPolicy":{},"f:schedulerName":{},"f:securityContext":{".":{},"f:fsGroup":{},"f:runAsGroup":{},"f:runAsUser":{}},"f:serviceAccount":{},"f:serviceAccountName":{},"f:terminationGracePeriodSeconds":{},"f:topologySpreadConstraints":{".":{},"k:{\"topologyKey\":\"topology.kubernetes.io/zone\",\"whenUnsatisfiable\":\"ScheduleAnyway\"}":{".":{},"f:labelSelector":{".":{},"f:matchLabels":{".":{},"f:app.kubernetes.io/name":{}}},"f:maxSkew":{},"f:topologyKey":{},"f:whenUnsatisfiable":{}}},"f:volumes":{".":{},"k:{\"name\":\"erlang-cookie-secret\"}":{".":{},"f:name":{},"f:secret":{".":{},"f:defaultMode":{},"f:secretName":{}}},"k:{\"name\":\"plugins-conf\"}":{".":{},"f:configMap":{".":{},"f:defaultMode":{},"f:name":{}},"f:name":{}},"k:{\"name\":\"pod-info\"}":{".":{},"f:downwardAPI":{".":{},"f:defaultMode":{},"f:items":{}},"f:name":{}},"k:{\"name\":\"rabbitmq-confd\"}":{".":{},"f:name":{},"f:projected":{".":{},"f:defaultMode":{},"f:sources":{}}},"k:{\"name\":\"rabbitmq-erlang-cookie\"}":{".":{},"f:emptyDir":{},"f:name":{}},"k:{\"name\":\"rabbitmq-plugins\"}":{".":{},"f:emptyDir":{},"f:name":{}}}}},"f:updateStrategy":{"f:rollingUpdate":{".":{},"f:partition":{}},"f:type":{}},"f:volumeClaimTemplates":{}}}},{"manager":"kube-controller-manager","operation":"Update","apiVersion":"apps/v1","time":"2022-03-18T18:01:59Z","fieldsType":"FieldsV1","fieldsV1":{"f:status":{"f:collisionCount":{},"f:currentReplicas":{},"f:currentRevision":{},"f:observedGeneration":{},"f:readyReplicas":{},"f:replicas":{},"f:updateRevision":{},"f:updatedReplicas":{}}}}]},"spec":{"replicas":3,"selector":{"matchLabels":{"app.kubernetes.io/name":"rabbitmq-cluster"}},"template":{"metadata":{"creationTimestamp":null,"labels":{"app.kubernetes.io/component":"rabbitmq","app.kubernetes.io/name":"rabbitmq-cluster","app.kubernetes.io/part-of":"rabbitmq"},"annotations":{"prometheus.io/port":"15692","prometheus.io/scrape":"true"}},"spec":{"volumes":[{"name":"plugins-conf","configMap":{"name":"rabbitmq-cluster-plugins-conf","defaultMode":420}},{"name":"rabbitmq-confd","projected":{"sources":[{"secret":{"name":"rabbitmq-cluster-default-user","items":[{"key":"default_user.conf","path":"default_user.conf"}]}},{"configMap":{"name":"rabbitmq-cluster-server-conf","items":[{"key":"operatorDefaults.conf","path":"operatorDefaults.conf"},{"key":"userDefinedConfiguration.conf","path":"userDefinedConfiguration.conf"}]}}],"defaultMode":420}},{"name":"rabbitmq-erlang-cookie","emptyDir":{}},{"name":"erlang-cookie-secret","secret":{"secretName":"rabbitmq-cluster-erlang-cookie","defaultMode":420}},{"name":"rabbitmq-plugins","emptyDir":{}},{"name":"pod-info","downwardAPI":{"items":[{"path":"skipPreStopChecks","fieldRef":{"apiVersion":"v1","fieldPath":"metadata.labels['skipPreStopChecks']"}}],"defaultMode":420}}],"initContainers":[{"name":"setup-container","image":"rabbitmq:3.8.12-management","command":["sh","-c","cp /tmp/erlang-cookie-secret/.erlang.cookie /var/lib/rabbitmq/.erlang.cookie \u0026\u0026 chown 999:999 /var/lib/rabbitmq/.erlang.cookie \u0026\u0026 chmod 600 /var/lib/rabbitmq/.erlang.cookie ; cp /tmp/rabbitmq-plugins/enabled_plugins /operator/enabled_plugins \u0026\u0026 chown 999:999 /operator/enabled_plugins ; chown 999:999 /var/lib/rabbitmq/mnesia/ ; echo '[default]' \u003e /var/lib/rabbitmq/.rabbitmqadmin.conf \u0026\u0026 sed -e 's/default_user/username/' -e 's/default_pass/password/' /tmp/default_user.conf \u003e\u003e /var/lib/rabbitmq/.rabbitmqadmin.conf \u0026\u0026 chown 999:999 /var/lib/rabbitmq/.rabbitmqadmin.conf \u0026\u0026 chmod 600 /var/lib/rabbitmq/.rabbitmqadmin.conf"],"resources":{"limits":{"cpu":"100m","memory":"500Mi"},"requests":{"cpu":"100m","memory":"500Mi"}},"volumeMounts":[{"name":"plugins-conf","mountPath":"/tmp/rabbitmq-plugins/"},{"name":"rabbitmq-erlang-cookie","mountPath":"/var/lib/rabbitmq/"},{"name":"erlang-cookie-secret","mountPath":"/tmp/erlang-cookie-secret/"},{"name":"rabbitmq-plugins","mountPath":"/operator"},{"name":"persistence","mountPath":"/var/lib/rabbitmq/mnesia/"},{"name":"rabbitmq-confd","mountPath":"/tmp/default_user.conf","subPath":"default_user.conf"}],"terminationMessagePath":"/dev/termination-log","terminationMessagePolicy":"File","imagePullPolicy":"IfNotPresent","securityContext":{"capabilities":{"drop":["FSETID","KILL","SETGID","SETUID","SETPCAP","NET_BIND_SERVICE","NET_RAW","SYS_CHROOT","MKNOD","AUDIT_WRITE","SETFCAP"]},"runAsUser":0}}],"containers":[{"name":"rabbitmq","image":"rabbitmq:3.8.12-management","ports":[{"name":"epmd","containerPort":4369,"protocol":"TCP"},{"name":"amqp","containerPort":5672,"protocol":"TCP"},{"name":"management","containerPort":15672,"protocol":"TCP"},{"name":"prometheus","containerPort":15692,"protocol":"TCP"}],"env":[{"name":"MY_POD_NAME","valueFrom":{"fieldRef":{"apiVersion":"v1","fieldPath":"metadata.name"}}},{"name":"MY_POD_NAMESPACE","valueFrom":{"fieldRef":{"apiVersion":"v1","fieldPath":"metadata.namespace"}}},{"name":"RABBITMQ_ENABLED_PLUGINS_FILE","value":"/operator/enabled_plugins"},{"name":"K8S_SERVICE_NAME","value":"rabbitmq-cluster-nodes"},{"name":"RABBITMQ_USE_LONGNAME","value":"true"},{"name":"RABBITMQ_NODENAME","value":"rabbit@$(MY_POD_NAME).$(K8S_SERVICE_NAME).$(MY_POD_NAMESPACE)"},{"name":"K8S_HOSTNAME_SUFFIX","value":".$(K8S_SERVICE_NAME).$(MY_POD_NAMESPACE)"}],"resources":{"limits":{"cpu":"2","memory":"2Gi"},"requests":{"cpu":"1","memory":"2Gi"}},"volumeMounts":[{"name":"rabbitmq-erlang-cookie","mountPath":"/var/lib/rabbitmq/"},{"name":"persistence","mountPath":"/var/lib/rabbitmq/mnesia/"},{"name":"rabbitmq-plugins","mountPath":"/operator"},{"name":"rabbitmq-confd","mountPath":"/etc/rabbitmq/conf.d/10-operatorDefaults.conf","subPath":"operatorDefaults.conf"},{"name":"rabbitmq-confd","mountPath":"/etc/rabbitmq/conf.d/11-default_user.conf","subPath":"default_user.conf"},{"name":"rabbitmq-confd","mountPath":"/etc/rabbitmq/conf.d/90-userDefinedConfiguration.conf","subPath":"userDefinedConfiguration.conf"},{"name":"pod-info","mountPath":"/etc/pod-info/"}],"readinessProbe":{"tcpSocket":{"port":"amqp"},"initialDelaySeconds":10,"timeoutSeconds":5,"periodSeconds":10,"successThreshold":1,"failureThreshold":3},"lifecycle":{"preStop":{"exec":{"command":["/bin/bash","-c","if [ ! -z \"$(cat /etc/pod-info/skipPreStopChecks)\" ]; then exit 0; fi; rabbitmq-upgrade await_online_quorum_plus_one -t 604800; rabbitmq-upgrade await_online_synchronized_mirror -t 604800; rabbitmq-upgrade drain -t 604800"]}}},"terminationMessagePath":"/dev/termination-log","terminationMessagePolicy":"File","imagePullPolicy":"IfNotPresent"}],"restartPolicy":"Always","terminationGracePeriodSeconds":604800,"dnsPolicy":"ClusterFirst","serviceAccountName":"rabbitmq-cluster-server","serviceAccount":"rabbitmq-cluster-server","automountServiceAccountToken":true,"securityContext":{"runAsUser":999,"runAsGroup":999,"fsGroup":999},"schedulerName":"default-scheduler","topologySpreadConstraints":[{"maxSkew":1,"topologyKey":"topology.kubernetes.io/zone","whenUnsatisfiable":"ScheduleAnyway","labelSelector":{"matchLabels":{"app.kubernetes.io/name":"rabbitmq-cluster"}}}]}},"volumeClaimTemplates":[{"metadata":{"name":"persistence","namespace":"default","creationTimestamp":null,"labels":{"app.kubernetes.io/component":"rabbitmq","app.kubernetes.io/name":"rabbitmq-cluster","app.kubernetes.io/part-of":"rabbitmq"},"ownerReferences":[{"apiVersion":"rabbitmq.com/v1beta1","kind":"RabbitmqCluster","name":"rabbitmq-cluster","uid":"18d9928b-0d1c-47be-80ec-20960d053827","controller":true,"blockOwnerDeletion":false}]},"spec":{"accessModes":["ReadWriteOnce"],"resources":{"requests":{"storage":"10Gi"}},"volumeMode":"Filesystem"},"status":{"phase":"Pending"}}],"serviceName":"rabbitmq-cluster-nodes","podManagementPolicy":"Parallel","updateStrategy":{"type":"RollingUpdate","rollingUpdate":{"partition":0}},"revisionHistoryLimit":10},"status":{"observedGeneration":2,"replicas":3,"readyReplicas":2,"currentReplicas":3,"updatedReplicas":3,"currentRevision":"rabbitmq-cluster-server-5f8b8665fb","updateRevision":"rabbitmq-cluster-server-5f8b8665fb","collisionCount":0}}
2022/03/18 18:01:59 learn_server.go:291: [SIEVE-AFTER-READ]	Get	true	service	default	rabbitmq-cluster-nodes	github.com/rabbitmq/cluster-operator/controllers.(*RabbitmqClusterReconciler)	NoError	{"kind":"Service","apiVersion":"v1","metadata":{"name":"rabbitmq-cluster-nodes","namespace":"default","selfLink":"/api/v1/namespaces/default/services/rabbitmq-cluster-nodes","uid":"67c7eea9-1b87-4fd7-82e6-5bfe31fd1b52","resourceVersion":"696","creationTimestamp":"2022-03-18T18:00:38Z","labels":{"app.kubernetes.io/component":"rabbitmq","app.kubernetes.io/name":"rabbitmq-cluster","app.kubernetes.io/part-of":"rabbitmq"},"ownerReferences":[{"apiVersion":"rabbitmq.com/v1beta1","kind":"RabbitmqCluster","name":"rabbitmq-cluster","uid":"18d9928b-0d1c-47be-80ec-20960d053827","controller":true,"blockOwnerDeletion":true}],"managedFields":[{"manager":"manager","operation":"Update","apiVersion":"v1","time":"2022-03-18T18:00:38Z","fieldsType":"FieldsV1","fieldsV1":{"f:metadata":{"f:labels":{".":{},"f:app.kubernetes.io/component":{},"f:app.kubernetes.io/name":{},"f:app.kubernetes.io/part-of":{}},"f:ownerReferences":{".":{},"k:{\"uid\":\"18d9928b-0d1c-47be-80ec-20960d053827\"}":{".":{},"f:apiVersion":{},"f:blockOwnerDeletion":{},"f:controller":{},"f:kind":{},"f:name":{},"f:uid":{}}}},"f:spec":{"f:clusterIP":{},"f:ports":{".":{},"k:{\"port\":4369,\"protocol\":\"TCP\"}":{".":{},"f:name":{},"f:port":{},"f:protocol":{},"f:targetPort":{}},"k:{\"port\":25672,\"protocol\":\"TCP\"}":{".":{},"f:name":{},"f:port":{},"f:protocol":{},"f:targetPort":{}}},"f:publishNotReadyAddresses":{},"f:selector":{".":{},"f:app.kubernetes.io/name":{}},"f:sessionAffinity":{},"f:type":{}}}}]},"spec":{"ports":[{"name":"epmd","protocol":"TCP","port":4369,"targetPort":4369},{"name":"cluster-rpc","protocol":"TCP","port":25672,"targetPort":25672}],"selector":{"app.kubernetes.io/name":"rabbitmq-cluster"},"clusterIP":"None","type":"ClusterIP","sessionAffinity":"None","publishNotReadyAddresses":true},"status":{"loadBalancer":{}}}
2022/03/18 18:01:59 learn_server.go:291: [SIEVE-AFTER-READ]	Get	true	service	default	rabbitmq-cluster	github.com/rabbitmq/cluster-operator/controllers.(*RabbitmqClusterReconciler)	NoError	{"kind":"Service","apiVersion":"v1","metadata":{"name":"rabbitmq-cluster","namespace":"default","selfLink":"/api/v1/namespaces/default/services/rabbitmq-cluster","uid":"56b50671-1945-458b-adac-05619b783392","resourceVersion":"701","creationTimestamp":"2022-03-18T18:00:38Z","labels":{"app.kubernetes.io/component":"rabbitmq","app.kubernetes.io/name":"rabbitmq-cluster","app.kubernetes.io/part-of":"rabbitmq"},"ownerReferences":[{"apiVersion":"rabbitmq.com/v1beta1","kind":"RabbitmqCluster","name":"rabbitmq-cluster","uid":"18d9928b-0d1c-47be-80ec-20960d053827","controller":true,"blockOwnerDeletion":true}],"managedFields":[{"manager":"manager","operation":"Update","apiVersion":"v1","time":"2022-03-18T18:00:38Z","fieldsType":"FieldsV1","fieldsV1":{"f:metadata":{"f:labels":{".":{},"f:app.kubernetes.io/component":{},"f:app.kubernetes.io/name":{},"f:app.kubernetes.io/part-of":{}},"f:ownerReferences":{".":{},"k:{\"uid\":\"18d9928b-0d1c-47be-80ec-20960d053827\"}":{".":{},"f:apiVersion":{},"f:blockOwnerDeletion":{},"f:controller":{},"f:kind":{},"f:name":{},"f:uid":{}}}},"f:spec":{"f:ports":{".":{},"k:{\"port\":5672,\"protocol\":\"TCP\"}":{".":{},"f:name":{},"f:port":{},"f:protocol":{},"f:targetPort":{}},"k:{\"port\":15672,\"protocol\":\"TCP\"}":{".":{},"f:name":{},"f:port":{},"f:protocol":{},"f:targetPort":{}}},"f:selector":{".":{},"f:app.kubernetes.io/name":{}},"f:sessionAffinity":{},"f:type":{}}}}]},"spec":{"ports":[{"name":"amqp","protocol":"TCP","port":5672,"targetPort":5672},{"name":"management","protocol":"TCP","port":15672,"targetPort":15672}],"selector":{"app.kubernetes.io/name":"rabbitmq-cluster"},"clusterIP":"10.96.254.158","type":"ClusterIP","sessionAffinity":"None"},"status":{"loadBalancer":{}}}
2022/03/18 18:01:59 learn_server.go:291: [SIEVE-AFTER-READ]	Get	true	secret	default	rabbitmq-cluster-erlang-cookie	github.com/rabbitmq/cluster-operator/controllers.(*RabbitmqClusterReconciler)	NoError	{"kind":"Secret","apiVersion":"v1","metadata":{"name":"rabbitmq-cluster-erlang-cookie","namespace":"default","selfLink":"/api/v1/namespaces/default/secrets/rabbitmq-cluster-erlang-cookie","uid":"f8fbe8a6-0f40-4e13-960b-ab78b8ba75b0","resourceVersion":"705","creationTimestamp":"2022-03-18T18:00:38Z","labels":{"app.kubernetes.io/component":"rabbitmq","app.kubernetes.io/name":"rabbitmq-cluster","app.kubernetes.io/part-of":"rabbitmq"},"ownerReferences":[{"apiVersion":"rabbitmq.com/v1beta1","kind":"RabbitmqCluster","name":"rabbitmq-cluster","uid":"18d9928b-0d1c-47be-80ec-20960d053827","controller":true,"blockOwnerDeletion":true}],"managedFields":[{"manager":"manager","operation":"Update","apiVersion":"v1","time":"2022-03-18T18:00:38Z","fieldsType":"FieldsV1","fieldsV1":{"f:data":{".":{},"f:.erlang.cookie":{}},"f:metadata":{"f:labels":{".":{},"f:app.kubernetes.io/component":{},"f:app.kubernetes.io/name":{},"f:app.kubernetes.io/part-of":{}},"f:ownerReferences":{".":{},"k:{\"uid\":\"18d9928b-0d1c-47be-80ec-20960d053827\"}":{".":{},"f:apiVersion":{},"f:blockOwnerDeletion":{},"f:controller":{},"f:kind":{},"f:name":{},"f:uid":{}}}},"f:type":{}}}]},"data":{".erlang.cookie":"QW9hMkpWU0tlYS1FUGdWTUhrelNMNnFoMFZ0ZmRGNUY="},"type":"Opaque"}
2022/03/18 18:01:59 learn_server.go:291: [SIEVE-AFTER-READ]	Get	true	secret	default	rabbitmq-cluster-default-user	github.com/rabbitmq/cluster-operator/controllers.(*RabbitmqClusterReconciler)	NoError	{"kind":"Secret","apiVersion":"v1","metadata":{"name":"rabbitmq-cluster-default-user","namespace":"default","selfLink":"/api/v1/namespaces/default/secrets/rabbitmq-cluster-default-user","uid":"0d9f460b-a23c-402b-8273-f541ed39023f","resourceVersion":"708","creationTimestamp":"2022-03-18T18:00:38Z","labels":{"app.kubernetes.io/component":"rabbitmq","app.kubernetes.io/name":"rabbitmq-cluster","app.kubernetes.io/part-of":"rabbitmq"},"ownerReferences":[{"apiVersion":"rabbitmq.com/v1beta1","kind":"RabbitmqCluster","name":"rabbitmq-cluster","uid":"18d9928b-0d1c-47be-80ec-20960d053827","controller":true,"blockOwnerDeletion":true}],"managedFields":[{"manager":"manager","operation":"Update","apiVersion":"v1","time":"2022-03-18T18:00:38Z","fieldsType":"FieldsV1","fieldsV1":{"f:data":{".":{},"f:default_user.conf":{},"f:password":{},"f:provider":{},"f:type":{},"f:username":{}},"f:metadata":{"f:labels":{".":{},"f:app.kubernetes.io/component":{},"f:app.kubernetes.io/name":{},"f:app.kubernetes.io/part-of":{}},"f:ownerReferences":{".":{},"k:{\"uid\":\"18d9928b-0d1c-47be-80ec-20960d053827\"}":{".":{},"f:apiVersion":{},"f:blockOwnerDeletion":{},"f:controller":{},"f:kind":{},"f:name":{},"f:uid":{}}}},"f:type":{}}}]},"data":{"default_user.conf":"ZGVmYXVsdF91c2VyID0gcTMxRmh3MGtjWW9SZUl5X3BPTXp2ZVBOUnNVU3I1Mk8KZGVmYXVsdF9wYXNzID0gY0dBX19jNTJHX05hVURpTGhraWZ6UDBOVVlNLTE2MWQK","password":"Y0dBX19jNTJHX05hVURpTGhraWZ6UDBOVVlNLTE2MWQ=","provider":"cmFiYml0bXE=","type":"cmFiYml0bXE=","username":"cTMxRmh3MGtjWW9SZUl5X3BPTXp2ZVBOUnNVU3I1Mk8="},"type":"Opaque"}
2022/03/18 18:01:59 learn_server.go:291: [SIEVE-AFTER-READ]	Get	true	configmap	default	rabbitmq-cluster-plugins-conf	github.com/rabbitmq/cluster-operator/controllers.(*RabbitmqClusterReconciler)	NoError	{"kind":"ConfigMap","apiVersion":"v1","metadata":{"name":"rabbitmq-cluster-plugins-conf","namespace":"default","selfLink":"/api/v1/namespaces/default/configmaps/rabbitmq-cluster-plugins-conf","uid":"a164075b-0562-47ac-a577-99aa8651ec40","resourceVersion":"709","creationTimestamp":"2022-03-18T18:00:38Z","labels":{"app.kubernetes.io/component":"rabbitmq","app.kubernetes.io/name":"rabbitmq-cluster","app.kubernetes.io/part-of":"rabbitmq"},"ownerReferences":[{"apiVersion":"rabbitmq.com/v1beta1","kind":"RabbitmqCluster","name":"rabbitmq-cluster","uid":"18d9928b-0d1c-47be-80ec-20960d053827","controller":true,"blockOwnerDeletion":true}],"managedFields":[{"manager":"manager","operation":"Update","apiVersion":"v1","time":"2022-03-18T18:00:38Z","fieldsType":"FieldsV1","fieldsV1":{"f:data":{".":{},"f:enabled_plugins":{}},"f:metadata":{"f:labels":{".":{},"f:app.kubernetes.io/component":{},"f:app.kubernetes.io/name":{},"f:app.kubernetes.io/part-of":{}},"f:ownerReferences":{".":{},"k:{\"uid\":\"18d9928b-0d1c-47be-80ec-20960d053827\"}":{".":{},"f:apiVersion":{},"f:blockOwnerDeletion":{},"f:controller":{},"f:kind":{},"f:name":{},"f:uid":{}}}}}}]},"data":{"enabled_plugins":"[rabbitmq_peer_discovery_k8s,rabbitmq_prometheus,rabbitmq_management]."}}
2022/03/18 18:01:59 learn_server.go:291: [SIEVE-AFTER-READ]	Get	true	configmap	default	rabbitmq-cluster-server-conf	github.com/rabbitmq/cluster-operator/controllers.(*RabbitmqClusterReconciler)	NoError	{"kind":"ConfigMap","apiVersion":"v1","metadata":{"name":"rabbitmq-cluster-server-conf","namespace":"default","selfLink":"/api/v1/namespaces/default/configmaps/rabbitmq-cluster-server-conf","uid":"22474f2b-8454-44b7-8079-8990223969cc","resourceVersion":"714","creationTimestamp":"2022-03-18T18:00:38Z","labels":{"app.kubernetes.io/component":"rabbitmq","app.kubernetes.io/name":"rabbitmq-cluster","app.kubernetes.io/part-of":"rabbitmq"},"ownerReferences":[{"apiVersion":"rabbitmq.com/v1beta1","kind":"RabbitmqCluster","name":"rabbitmq-cluster","uid":"18d9928b-0d1c-47be-80ec-20960d053827","controller":true,"blockOwnerDeletion":true}],"managedFields":[{"manager":"manager","operation":"Update","apiVersion":"v1","time":"2022-03-18T18:00:38Z","fieldsType":"FieldsV1","fieldsV1":{"f:data":{".":{},"f:operatorDefaults.conf":{},"f:userDefinedConfiguration.conf":{}},"f:metadata":{"f:labels":{".":{},"f:app.kubernetes.io/component":{},"f:app.kubernetes.io/name":{},"f:app.kubernetes.io/part-of":{}},"f:ownerReferences":{".":{},"k:{\"uid\":\"18d9928b-0d1c-47be-80ec-20960d053827\"}":{".":{},"f:apiVersion":{},"f:blockOwnerDeletion":{},"f:controller":{},"f:kind":{},"f:name":{},"f:uid":{}}}}}}]},"data":{"operatorDefaults.conf":"cluster_formation.peer_discovery_backend             = rabbit_peer_discovery_k8s\ncluster_formation.k8s.host                           = kubernetes.default\ncluster_formation.k8s.address_type                   = hostname\ncluster_partition_handling                           = pause_minority\nqueue_master_locator                                 = min-masters\ndisk_free_limit.absolute                             = 2GB\ncluster_formation.randomized_startup_delay_range.min = 5\ncluster_formation.randomized_startup_delay_range.max = 30\ncluster_name                                         = rabbitmq-cluster\n","userDefinedConfiguration.conf":"total_memory_available_override_value = 1717986919\n"}}
2022/03/18 18:01:59 learn_server.go:291: [SIEVE-AFTER-READ]	Get	true	serviceaccount	default	rabbitmq-cluster-server	github.com/rabbitmq/cluster-operator/controllers.(*RabbitmqClusterReconciler)	NoError	{"kind":"ServiceAccount","apiVersion":"v1","metadata":{"name":"rabbitmq-cluster-server","namespace":"default","selfLink":"/api/v1/namespaces/default/serviceaccounts/rabbitmq-cluster-server","uid":"731589b5-ac97-4774-bee4-008949b54734","resourceVersion":"722","creationTimestamp":"2022-03-18T18:00:38Z","labels":{"app.kubernetes.io/component":"rabbitmq","app.kubernetes.io/name":"rabbitmq-cluster","app.kubernetes.io/part-of":"rabbitmq"},"ownerReferences":[{"apiVersion":"rabbitmq.com/v1beta1","kind":"RabbitmqCluster","name":"rabbitmq-cluster","uid":"18d9928b-0d1c-47be-80ec-20960d053827","controller":true,"blockOwnerDeletion":true}],"managedFields":[{"manager":"kube-controller-manager","operation":"Update","apiVersion":"v1","time":"2022-03-18T18:00:38Z","fieldsType":"FieldsV1","fieldsV1":{"f:secrets":{".":{},"k:{\"name\":\"rabbitmq-cluster-server-token-rhzq9\"}":{".":{},"f:name":{}}}}},{"manager":"manager","operation":"Update","apiVersion":"v1","time":"2022-03-18T18:00:38Z","fieldsType":"FieldsV1","fieldsV1":{"f:metadata":{"f:labels":{".":{},"f:app.kubernetes.io/component":{},"f:app.kubernetes.io/name":{},"f:app.kubernetes.io/part-of":{}},"f:ownerReferences":{".":{},"k:{\"uid\":\"18d9928b-0d1c-47be-80ec-20960d053827\"}":{".":{},"f:apiVersion":{},"f:blockOwnerDeletion":{},"f:controller":{},"f:kind":{},"f:name":{},"f:uid":{}}}}}}]},"secrets":[{"name":"rabbitmq-cluster-server-token-rhzq9"}]}
2022/03/18 18:01:59 learn_server.go:291: [SIEVE-AFTER-READ]	Get	true	role	default	rabbitmq-cluster-peer-discovery	github.com/rabbitmq/cluster-operator/controllers.(*RabbitmqClusterReconciler)	NoError	{"kind":"Role","apiVersion":"rbac.authorization.k8s.io/v1","metadata":{"name":"rabbitmq-cluster-peer-discovery","namespace":"default","selfLink":"/apis/rbac.authorization.k8s.io/v1/namespaces/default/roles/rabbitmq-cluster-peer-discovery","uid":"52c80b50-4fdd-4089-bbfd-9756465953f2","resourceVersion":"723","creationTimestamp":"2022-03-18T18:00:38Z","labels":{"app.kubernetes.io/component":"rabbitmq","app.kubernetes.io/name":"rabbitmq-cluster","app.kubernetes.io/part-of":"rabbitmq"},"ownerReferences":[{"apiVersion":"rabbitmq.com/v1beta1","kind":"RabbitmqCluster","name":"rabbitmq-cluster","uid":"18d9928b-0d1c-47be-80ec-20960d053827","controller":true,"blockOwnerDeletion":true}],"managedFields":[{"manager":"manager","operation":"Update","apiVersion":"rbac.authorization.k8s.io/v1","time":"2022-03-18T18:00:38Z","fieldsType":"FieldsV1","fieldsV1":{"f:metadata":{"f:labels":{".":{},"f:app.kubernetes.io/component":{},"f:app.kubernetes.io/name":{},"f:app.kubernetes.io/part-of":{}},"f:ownerReferences":{".":{},"k:{\"uid\":\"18d9928b-0d1c-47be-80ec-20960d053827\"}":{".":{},"f:apiVersion":{},"f:blockOwnerDeletion":{},"f:controller":{},"f:kind":{},"f:name":{},"f:uid":{}}}},"f:rules":{}}}]},"rules":[{"verbs":["get"],"apiGroups":[""],"resources":["endpoints"]},{"verbs":["create"],"apiGroups":[""],"resources":["events"]}]}
2022/03/18 18:01:59 learn_server.go:291: [SIEVE-AFTER-READ]	Get	true	rolebinding	default	rabbitmq-cluster-server	github.com/rabbitmq/cluster-operator/controllers.(*RabbitmqClusterReconciler)	NoError	{"kind":"RoleBinding","apiVersion":"rbac.authorization.k8s.io/v1","metadata":{"name":"rabbitmq-cluster-server","namespace":"default","selfLink":"/apis/rbac.authorization.k8s.io/v1/namespaces/default/rolebindings/rabbitmq-cluster-server","uid":"495e9f7c-a20d-4515-86b0-34149a855034","resourceVersion":"725","creationTimestamp":"2022-03-18T18:00:38Z","labels":{"app.kubernetes.io/component":"rabbitmq","app.kubernetes.io/name":"rabbitmq-cluster","app.kubernetes.io/part-of":"rabbitmq"},"ownerReferences":[{"apiVersion":"rabbitmq.com/v1beta1","kind":"RabbitmqCluster","name":"rabbitmq-cluster","uid":"18d9928b-0d1c-47be-80ec-20960d053827","controller":true,"blockOwnerDeletion":true}],"managedFields":[{"manager":"manager","operation":"Update","apiVersion":"rbac.authorization.k8s.io/v1","time":"2022-03-18T18:00:38Z","fieldsType":"FieldsV1","fieldsV1":{"f:metadata":{"f:labels":{".":{},"f:app.kubernetes.io/component":{},"f:app.kubernetes.io/name":{},"f:app.kubernetes.io/part-of":{}},"f:ownerReferences":{".":{},"k:{\"uid\":\"18d9928b-0d1c-47be-80ec-20960d053827\"}":{".":{},"f:apiVersion":{},"f:blockOwnerDeletion":{},"f:controller":{},"f:kind":{},"f:name":{},"f:uid":{}}}},"f:roleRef":{"f:apiGroup":{},"f:kind":{},"f:name":{}},"f:subjects":{}}}]},"subjects":[{"kind":"ServiceAccount","name":"rabbitmq-cluster-server"}],"roleRef":{"apiGroup":"rbac.authorization.k8s.io","kind":"Role","name":"rabbitmq-cluster-peer-discovery"}}
2022/03/18 18:01:59 learn_server.go:291: [SIEVE-AFTER-READ]	Get	true	statefulset	default	rabbitmq-cluster-server	github.com/rabbitmq/cluster-operator/controllers.(*RabbitmqClusterReconciler)	NoError	{"kind":"StatefulSet","apiVersion":"apps/v1","metadata":{"name":"rabbitmq-cluster-server","namespace":"default","selfLink":"/apis/apps/v1/namespaces/default/statefulsets/rabbitmq-cluster-server","uid":"cb5c43bc-6ee7-481c-ab01-6f3acffdd3c8","resourceVersion":"1214","generation":2,"creationTimestamp":"2022-03-18T18:00:38Z","labels":{"app.kubernetes.io/component":"rabbitmq","app.kubernetes.io/name":"rabbitmq-cluster","app.kubernetes.io/part-of":"rabbitmq"},"ownerReferences":[{"apiVersion":"rabbitmq.com/v1beta1","kind":"RabbitmqCluster","name":"rabbitmq-cluster","uid":"18d9928b-0d1c-47be-80ec-20960d053827","controller":true,"blockOwnerDeletion":true}],"managedFields":[{"manager":"manager","operation":"Update","apiVersion":"apps/v1","time":"2022-03-18T18:01:23Z","fieldsType":"FieldsV1","fieldsV1":{"f:metadata":{"f:labels":{".":{},"f:app.kubernetes.io/component":{},"f:app.kubernetes.io/name":{},"f:app.kubernetes.io/part-of":{}},"f:ownerReferences":{".":{},"k:{\"uid\":\"18d9928b-0d1c-47be-80ec-20960d053827\"}":{".":{},"f:apiVersion":{},"f:blockOwnerDeletion":{},"f:controller":{},"f:kind":{},"f:name":{},"f:uid":{}}}},"f:spec":{"f:podManagementPolicy":{},"f:replicas":{},"f:revisionHistoryLimit":{},"f:selector":{"f:matchLabels":{".":{},"f:app.kubernetes.io/name":{}}},"f:serviceName":{},"f:template":{"f:metadata":{"f:annotations":{".":{},"f:prometheus.io/port":{},"f:prometheus.io/scrape":{}},"f:labels":{".":{},"f:app.kubernetes.io/component":{},"f:app.kubernetes.io/name":{},"f:app.kubernetes.io/part-of":{}}},"f:spec":{"f:automountServiceAccountToken":{},"f:containers":{"k:{\"name\":\"rabbitmq\"}":{".":{},"f:env":{".":{},"k:{\"name\":\"K8S_HOSTNAME_SUFFIX\"}":{".":{},"f:name":{},"f:value":{}},"k:{\"name\":\"K8S_SERVICE_NAME\"}":{".":{},"f:name":{},"f:value":{}},"k:{\"name\":\"MY_POD_NAME\"}":{".":{},"f:name":{},"f:valueFrom":{".":{},"f:fieldRef":{".":{},"f:apiVersion":{},"f:fieldPath":{}}}},"k:{\"name\":\"MY_POD_NAMESPACE\"}":{".":{},"f:name":{},"f:valueFrom":{".":{},"f:fieldRef":{".":{},"f:apiVersion":{},"f:fieldPath":{}}}},"k:{\"name\":\"RABBITMQ_ENABLED_PLUGINS_FILE\"}":{".":{},"f:name":{},"f:value":{}},"k:{\"name\":\"RABBITMQ_NODENAME\"}":{".":{},"f:name":{},"f:value":{}},"k:{\"name\":\"RABBITMQ_USE_LONGNAME\"}":{".":{},"f:name":{},"f:value":{}}},"f:image":{},"f:imagePullPolicy":{},"f:lifecycle":{".":{},"f:preStop":{".":{},"f:exec":{".":{},"f:command":{}}}},"f:name":{},"f:ports":{".":{},"k:{\"containerPort\":4369,\"protocol\":\"TCP\"}":{".":{},"f:containerPort":{},"f:name":{},"f:protocol":{}},"k:{\"containerPort\":5672,\"protocol\":\"TCP\"}":{".":{},"f:containerPort":{},"f:name":{},"f:protocol":{}},"k:{\"containerPort\":15672,\"protocol\":\"TCP\"}":{".":{},"f:containerPort":{},"f:name":{},"f:protocol":{}},"k:{\"containerPort\":15692,\"protocol\":\"TCP\"}":{".":{},"f:containerPort":{},"f:name":{},"f:protocol":{}}},"f:readinessProbe":{".":{},"f:failureThreshold":{},"f:initialDelaySeconds":{},"f:periodSeconds":{},"f:successThreshold":{},"f:tcpSocket":{".":{},"f:port":{}},"f:timeoutSeconds":{}},"f:resources":{".":{},"f:limits":{".":{},"f:cpu":{},"f:memory":{}},"f:requests":{".":{},"f:cpu":{},"f:memory":{}}},"f:terminationMessagePath":{},"f:terminationMessagePolicy":{},"f:volumeMounts":{".":{},"k:{\"mountPath\":\"/etc/pod-info/\"}":{".":{},"f:mountPath":{},"f:name":{}},"k:{\"mountPath\":\"/etc/rabbitmq/conf.d/10-operatorDefaults.conf\"}":{".":{},"f:mountPath":{},"f:name":{},"f:subPath":{}},"k:{\"mountPath\":\"/etc/rabbitmq/conf.d/11-default_user.conf\"}":{".":{},"f:mountPath":{},"f:name":{},"f:subPath":{}},"k:{\"mountPath\":\"/etc/rabbitmq/conf.d/90-userDefinedConfiguration.conf\"}":{".":{},"f:mountPath":{},"f:name":{},"f:subPath":{}},"k:{\"mountPath\":\"/operator\"}":{".":{},"f:mountPath":{},"f:name":{}},"k:{\"mountPath\":\"/var/lib/rabbitmq/\"}":{".":{},"f:mountPath":{},"f:name":{}},"k:{\"mountPath\":\"/var/lib/rabbitmq/mnesia/\"}":{".":{},"f:mountPath":{},"f:name":{}}}}},"f:dnsPolicy":{},"f:initContainers":{".":{},"k:{\"name\":\"setup-container\"}":{".":{},"f:command":{},"f:image":{},"f:imagePullPolicy":{},"f:name":{},"f:resources":{".":{},"f:limits":{".":{},"f:cpu":{},"f:memory":{}},"f:requests":{".":{},"f:cpu":{},"f:memory":{}}},"f:securityContext":{".":{},"f:capabilities":{".":{},"f:drop":{}},"f:runAsUser":{}},"f:terminationMessagePath":{},"f:terminationMessagePolicy":{},"f:volumeMounts":{".":{},"k:{\"mountPath\":\"/operator\"}":{".":{},"f:mountPath":{},"f:name":{}},"k:{\"mountPath\":\"/tmp/default_user.conf\"}":{".":{},"f:mountPath":{},"f:name":{},"f:subPath":{}},"k:{\"mountPath\":\"/tmp/erlang-cookie-secret/\"}":{".":{},"f:mountPath":{},"f:name":{}},"k:{\"mountPath\":\"/tmp/rabbitmq-plugins/\"}":{".":{},"f:mountPath":{},"f:name":{}},"k:{\"mountPath\":\"/var/lib/rabbitmq/\"}":{".":{},"f:mountPath":{},"f:name":{}},"k:{\"mountPath\":\"/var/lib/rabbitmq/mnesia/\"}":{".":{},"f:mountPath":{},"f:name":{}}}}},"f:restartPolicy":{},"f:schedulerName":{},"f:securityContext":{".":{},"f:fsGroup":{},"f:runAsGroup":{},"f:runAsUser":{}},"f:serviceAccount":{},"f:serviceAccountName":{},"f:terminationGracePeriodSeconds":{},"f:topologySpreadConstraints":{".":{},"k:{\"topologyKey\":\"topology.kubernetes.io/zone\",\"whenUnsatisfiable\":\"ScheduleAnyway\"}":{".":{},"f:labelSelector":{".":{},"f:matchLabels":{".":{},"f:app.kubernetes.io/name":{}}},"f:maxSkew":{},"f:topologyKey":{},"f:whenUnsatisfiable":{}}},"f:volumes":{".":{},"k:{\"name\":\"erlang-cookie-secret\"}":{".":{},"f:name":{},"f:secret":{".":{},"f:defaultMode":{},"f:secretName":{}}},"k:{\"name\":\"plugins-conf\"}":{".":{},"f:configMap":{".":{},"f:defaultMode":{},"f:name":{}},"f:name":{}},"k:{\"name\":\"pod-info\"}":{".":{},"f:downwardAPI":{".":{},"f:defaultMode":{},"f:items":{}},"f:name":{}},"k:{\"name\":\"rabbitmq-confd\"}":{".":{},"f:name":{},"f:projected":{".":{},"f:defaultMode":{},"f:sources":{}}},"k:{\"name\":\"rabbitmq-erlang-cookie\"}":{".":{},"f:emptyDir":{},"f:name":{}},"k:{\"name\":\"rabbitmq-plugins\"}":{".":{},"f:emptyDir":{},"f:name":{}}}}},"f:updateStrategy":{"f:rollingUpdate":{".":{},"f:partition":{}},"f:type":{}},"f:volumeClaimTemplates":{}}}},{"manager":"kube-controller-manager","operation":"Update","apiVersion":"apps/v1","time":"2022-03-18T18:01:59Z","fieldsType":"FieldsV1","fieldsV1":{"f:status":{"f:collisionCount":{},"f:currentReplicas":{},"f:currentRevision":{},"f:observedGeneration":{},"f:readyReplicas":{},"f:replicas":{},"f:updateRevision":{},"f:updatedReplicas":{}}}}]},"spec":{"replicas":3,"selector":{"matchLabels":{"app.kubernetes.io/name":"rabbitmq-cluster"}},"template":{"metadata":{"creationTimestamp":null,"labels":{"app.kubernetes.io/component":"rabbitmq","app.kubernetes.io/name":"rabbitmq-cluster","app.kubernetes.io/part-of":"rabbitmq"},"annotations":{"prometheus.io/port":"15692","prometheus.io/scrape":"true"}},"spec":{"volumes":[{"name":"plugins-conf","configMap":{"name":"rabbitmq-cluster-plugins-conf","defaultMode":420}},{"name":"rabbitmq-confd","projected":{"sources":[{"secret":{"name":"rabbitmq-cluster-default-user","items":[{"key":"default_user.conf","path":"default_user.conf"}]}},{"configMap":{"name":"rabbitmq-cluster-server-conf","items":[{"key":"operatorDefaults.conf","path":"operatorDefaults.conf"},{"key":"userDefinedConfiguration.conf","path":"userDefinedConfiguration.conf"}]}}],"defaultMode":420}},{"name":"rabbitmq-erlang-cookie","emptyDir":{}},{"name":"erlang-cookie-secret","secret":{"secretName":"rabbitmq-cluster-erlang-cookie","defaultMode":420}},{"name":"rabbitmq-plugins","emptyDir":{}},{"name":"pod-info","downwardAPI":{"items":[{"path":"skipPreStopChecks","fieldRef":{"apiVersion":"v1","fieldPath":"metadata.labels['skipPreStopChecks']"}}],"defaultMode":420}}],"initContainers":[{"name":"setup-container","image":"rabbitmq:3.8.12-management","command":["sh","-c","cp /tmp/erlang-cookie-secret/.erlang.cookie /var/lib/rabbitmq/.erlang.cookie \u0026\u0026 chown 999:999 /var/lib/rabbitmq/.erlang.cookie \u0026\u0026 chmod 600 /var/lib/rabbitmq/.erlang.cookie ; cp /tmp/rabbitmq-plugins/enabled_plugins /operator/enabled_plugins \u0026\u0026 chown 999:999 /operator/enabled_plugins ; chown 999:999 /var/lib/rabbitmq/mnesia/ ; echo '[default]' \u003e /var/lib/rabbitmq/.rabbitmqadmin.conf \u0026\u0026 sed -e 's/default_user/username/' -e 's/default_pass/password/' /tmp/default_user.conf \u003e\u003e /var/lib/rabbitmq/.rabbitmqadmin.conf \u0026\u0026 chown 999:999 /var/lib/rabbitmq/.rabbitmqadmin.conf \u0026\u0026 chmod 600 /var/lib/rabbitmq/.rabbitmqadmin.conf"],"resources":{"limits":{"cpu":"100m","memory":"500Mi"},"requests":{"cpu":"100m","memory":"500Mi"}},"volumeMounts":[{"name":"plugins-conf","mountPath":"/tmp/rabbitmq-plugins/"},{"name":"rabbitmq-erlang-cookie","mountPath":"/var/lib/rabbitmq/"},{"name":"erlang-cookie-secret","mountPath":"/tmp/erlang-cookie-secret/"},{"name":"rabbitmq-plugins","mountPath":"/operator"},{"name":"persistence","mountPath":"/var/lib/rabbitmq/mnesia/"},{"name":"rabbitmq-confd","mountPath":"/tmp/default_user.conf","subPath":"default_user.conf"}],"terminationMessagePath":"/dev/termination-log","terminationMessagePolicy":"File","imagePullPolicy":"IfNotPresent","securityContext":{"capabilities":{"drop":["FSETID","KILL","SETGID","SETUID","SETPCAP","NET_BIND_SERVICE","NET_RAW","SYS_CHROOT","MKNOD","AUDIT_WRITE","SETFCAP"]},"runAsUser":0}}],"containers":[{"name":"rabbitmq","image":"rabbitmq:3.8.12-management","ports":[{"name":"epmd","containerPort":4369,"protocol":"TCP"},{"name":"amqp","containerPort":5672,"protocol":"TCP"},{"name":"management","containerPort":15672,"protocol":"TCP"},{"name":"prometheus","containerPort":15692,"protocol":"TCP"}],"env":[{"name":"MY_POD_NAME","valueFrom":{"fieldRef":{"apiVersion":"v1","fieldPath":"metadata.name"}}},{"name":"MY_POD_NAMESPACE","valueFrom":{"fieldRef":{"apiVersion":"v1","fieldPath":"metadata.namespace"}}},{"name":"RABBITMQ_ENABLED_PLUGINS_FILE","value":"/operator/enabled_plugins"},{"name":"K8S_SERVICE_NAME","value":"rabbitmq-cluster-nodes"},{"name":"RABBITMQ_USE_LONGNAME","value":"true"},{"name":"RABBITMQ_NODENAME","value":"rabbit@$(MY_POD_NAME).$(K8S_SERVICE_NAME).$(MY_POD_NAMESPACE)"},{"name":"K8S_HOSTNAME_SUFFIX","value":".$(K8S_SERVICE_NAME).$(MY_POD_NAMESPACE)"}],"resources":{"limits":{"cpu":"2","memory":"2Gi"},"requests":{"cpu":"1","memory":"2Gi"}},"volumeMounts":[{"name":"rabbitmq-erlang-cookie","mountPath":"/var/lib/rabbitmq/"},{"name":"persistence","mountPath":"/var/lib/rabbitmq/mnesia/"},{"name":"rabbitmq-plugins","mountPath":"/operator"},{"name":"rabbitmq-confd","mountPath":"/etc/rabbitmq/conf.d/10-operatorDefaults.conf","subPath":"operatorDefaults.conf"},{"name":"rabbitmq-confd","mountPath":"/etc/rabbitmq/conf.d/11-default_user.conf","subPath":"default_user.conf"},{"name":"rabbitmq-confd","mountPath":"/etc/rabbitmq/conf.d/90-userDefinedConfiguration.conf","subPath":"userDefinedConfiguration.conf"},{"name":"pod-info","mountPath":"/etc/pod-info/"}],"readinessProbe":{"tcpSocket":{"port":"amqp"},"initialDelaySeconds":10,"timeoutSeconds":5,"periodSeconds":10,"successThreshold":1,"failureThreshold":3},"lifecycle":{"preStop":{"exec":{"command":["/bin/bash","-c","if [ ! -z \"$(cat /etc/pod-info/skipPreStopChecks)\" ]; then exit 0; fi; rabbitmq-upgrade await_online_quorum_plus_one -t 604800; rabbitmq-upgrade await_online_synchronized_mirror -t 604800; rabbitmq-upgrade drain -t 604800"]}}},"terminationMessagePath":"/dev/termination-log","terminationMessagePolicy":"File","imagePullPolicy":"IfNotPresent"}],"restartPolicy":"Always","terminationGracePeriodSeconds":604800,"dnsPolicy":"ClusterFirst","serviceAccountName":"rabbitmq-cluster-server","serviceAccount":"rabbitmq-cluster-server","automountServiceAccountToken":true,"securityContext":{"runAsUser":999,"runAsGroup":999,"fsGroup":999},"schedulerName":"default-scheduler","topologySpreadConstraints":[{"maxSkew":1,"topologyKey":"topology.kubernetes.io/zone","whenUnsatisfiable":"ScheduleAnyway","labelSelector":{"matchLabels":{"app.kubernetes.io/name":"rabbitmq-cluster"}}}]}},"volumeClaimTemplates":[{"metadata":{"name":"persistence","namespace":"default","creationTimestamp":null,"labels":{"app.kubernetes.io/component":"rabbitmq","app.kubernetes.io/name":"rabbitmq-cluster","app.kubernetes.io/part-of":"rabbitmq"},"ownerReferences":[{"apiVersion":"rabbitmq.com/v1beta1","kind":"RabbitmqCluster","name":"rabbitmq-cluster","uid":"18d9928b-0d1c-47be-80ec-20960d053827","controller":true,"blockOwnerDeletion":false}]},"spec":{"accessModes":["ReadWriteOnce"],"resources":{"requests":{"storage":"10Gi"}},"volumeMode":"Filesystem"},"status":{"phase":"Pending"}}],"serviceName":"rabbitmq-cluster-nodes","podManagementPolicy":"Parallel","updateStrategy":{"type":"RollingUpdate","rollingUpdate":{"partition":0}},"revisionHistoryLimit":10},"status":{"observedGeneration":2,"replicas":3,"readyReplicas":2,"currentReplicas":3,"updatedReplicas":3,"currentRevision":"rabbitmq-cluster-server-5f8b8665fb","updateRevision":"rabbitmq-cluster-server-5f8b8665fb","collisionCount":0}}
2022/03/18 18:01:59 learn_server.go:291: [SIEVE-AFTER-READ]	Get	true	statefulset	default	rabbitmq-cluster-server	github.com/rabbitmq/cluster-operator/controllers.(*RabbitmqClusterReconciler)	NoError	{"kind":"StatefulSet","apiVersion":"apps/v1","metadata":{"name":"rabbitmq-cluster-server","namespace":"default","selfLink":"/apis/apps/v1/namespaces/default/statefulsets/rabbitmq-cluster-server","uid":"cb5c43bc-6ee7-481c-ab01-6f3acffdd3c8","resourceVersion":"1214","generation":2,"creationTimestamp":"2022-03-18T18:00:38Z","labels":{"app.kubernetes.io/component":"rabbitmq","app.kubernetes.io/name":"rabbitmq-cluster","app.kubernetes.io/part-of":"rabbitmq"},"ownerReferences":[{"apiVersion":"rabbitmq.com/v1beta1","kind":"RabbitmqCluster","name":"rabbitmq-cluster","uid":"18d9928b-0d1c-47be-80ec-20960d053827","controller":true,"blockOwnerDeletion":true}],"managedFields":[{"manager":"manager","operation":"Update","apiVersion":"apps/v1","time":"2022-03-18T18:01:23Z","fieldsType":"FieldsV1","fieldsV1":{"f:metadata":{"f:labels":{".":{},"f:app.kubernetes.io/component":{},"f:app.kubernetes.io/name":{},"f:app.kubernetes.io/part-of":{}},"f:ownerReferences":{".":{},"k:{\"uid\":\"18d9928b-0d1c-47be-80ec-20960d053827\"}":{".":{},"f:apiVersion":{},"f:blockOwnerDeletion":{},"f:controller":{},"f:kind":{},"f:name":{},"f:uid":{}}}},"f:spec":{"f:podManagementPolicy":{},"f:replicas":{},"f:revisionHistoryLimit":{},"f:selector":{"f:matchLabels":{".":{},"f:app.kubernetes.io/name":{}}},"f:serviceName":{},"f:template":{"f:metadata":{"f:annotations":{".":{},"f:prometheus.io/port":{},"f:prometheus.io/scrape":{}},"f:labels":{".":{},"f:app.kubernetes.io/component":{},"f:app.kubernetes.io/name":{},"f:app.kubernetes.io/part-of":{}}},"f:spec":{"f:automountServiceAccountToken":{},"f:containers":{"k:{\"name\":\"rabbitmq\"}":{".":{},"f:env":{".":{},"k:{\"name\":\"K8S_HOSTNAME_SUFFIX\"}":{".":{},"f:name":{},"f:value":{}},"k:{\"name\":\"K8S_SERVICE_NAME\"}":{".":{},"f:name":{},"f:value":{}},"k:{\"name\":\"MY_POD_NAME\"}":{".":{},"f:name":{},"f:valueFrom":{".":{},"f:fieldRef":{".":{},"f:apiVersion":{},"f:fieldPath":{}}}},"k:{\"name\":\"MY_POD_NAMESPACE\"}":{".":{},"f:name":{},"f:valueFrom":{".":{},"f:fieldRef":{".":{},"f:apiVersion":{},"f:fieldPath":{}}}},"k:{\"name\":\"RABBITMQ_ENABLED_PLUGINS_FILE\"}":{".":{},"f:name":{},"f:value":{}},"k:{\"name\":\"RABBITMQ_NODENAME\"}":{".":{},"f:name":{},"f:value":{}},"k:{\"name\":\"RABBITMQ_USE_LONGNAME\"}":{".":{},"f:name":{},"f:value":{}}},"f:image":{},"f:imagePullPolicy":{},"f:lifecycle":{".":{},"f:preStop":{".":{},"f:exec":{".":{},"f:command":{}}}},"f:name":{},"f:ports":{".":{},"k:{\"containerPort\":4369,\"protocol\":\"TCP\"}":{".":{},"f:containerPort":{},"f:name":{},"f:protocol":{}},"k:{\"containerPort\":5672,\"protocol\":\"TCP\"}":{".":{},"f:containerPort":{},"f:name":{},"f:protocol":{}},"k:{\"containerPort\":15672,\"protocol\":\"TCP\"}":{".":{},"f:containerPort":{},"f:name":{},"f:protocol":{}},"k:{\"containerPort\":15692,\"protocol\":\"TCP\"}":{".":{},"f:containerPort":{},"f:name":{},"f:protocol":{}}},"f:readinessProbe":{".":{},"f:failureThreshold":{},"f:initialDelaySeconds":{},"f:periodSeconds":{},"f:successThreshold":{},"f:tcpSocket":{".":{},"f:port":{}},"f:timeoutSeconds":{}},"f:resources":{".":{},"f:limits":{".":{},"f:cpu":{},"f:memory":{}},"f:requests":{".":{},"f:cpu":{},"f:memory":{}}},"f:terminationMessagePath":{},"f:terminationMessagePolicy":{},"f:volumeMounts":{".":{},"k:{\"mountPath\":\"/etc/pod-info/\"}":{".":{},"f:mountPath":{},"f:name":{}},"k:{\"mountPath\":\"/etc/rabbitmq/conf.d/10-operatorDefaults.conf\"}":{".":{},"f:mountPath":{},"f:name":{},"f:subPath":{}},"k:{\"mountPath\":\"/etc/rabbitmq/conf.d/11-default_user.conf\"}":{".":{},"f:mountPath":{},"f:name":{},"f:subPath":{}},"k:{\"mountPath\":\"/etc/rabbitmq/conf.d/90-userDefinedConfiguration.conf\"}":{".":{},"f:mountPath":{},"f:name":{},"f:subPath":{}},"k:{\"mountPath\":\"/operator\"}":{".":{},"f:mountPath":{},"f:name":{}},"k:{\"mountPath\":\"/var/lib/rabbitmq/\"}":{".":{},"f:mountPath":{},"f:name":{}},"k:{\"mountPath\":\"/var/lib/rabbitmq/mnesia/\"}":{".":{},"f:mountPath":{},"f:name":{}}}}},"f:dnsPolicy":{},"f:initContainers":{".":{},"k:{\"name\":\"setup-container\"}":{".":{},"f:command":{},"f:image":{},"f:imagePullPolicy":{},"f:name":{},"f:resources":{".":{},"f:limits":{".":{},"f:cpu":{},"f:memory":{}},"f:requests":{".":{},"f:cpu":{},"f:memory":{}}},"f:securityContext":{".":{},"f:capabilities":{".":{},"f:drop":{}},"f:runAsUser":{}},"f:terminationMessagePath":{},"f:terminationMessagePolicy":{},"f:volumeMounts":{".":{},"k:{\"mountPath\":\"/operator\"}":{".":{},"f:mountPath":{},"f:name":{}},"k:{\"mountPath\":\"/tmp/default_user.conf\"}":{".":{},"f:mountPath":{},"f:name":{},"f:subPath":{}},"k:{\"mountPath\":\"/tmp/erlang-cookie-secret/\"}":{".":{},"f:mountPath":{},"f:name":{}},"k:{\"mountPath\":\"/tmp/rabbitmq-plugins/\"}":{".":{},"f:mountPath":{},"f:name":{}},"k:{\"mountPath\":\"/var/lib/rabbitmq/\"}":{".":{},"f:mountPath":{},"f:name":{}},"k:{\"mountPath\":\"/var/lib/rabbitmq/mnesia/\"}":{".":{},"f:mountPath":{},"f:name":{}}}}},"f:restartPolicy":{},"f:schedulerName":{},"f:securityContext":{".":{},"f:fsGroup":{},"f:runAsGroup":{},"f:runAsUser":{}},"f:serviceAccount":{},"f:serviceAccountName":{},"f:terminationGracePeriodSeconds":{},"f:topologySpreadConstraints":{".":{},"k:{\"topologyKey\":\"topology.kubernetes.io/zone\",\"whenUnsatisfiable\":\"ScheduleAnyway\"}":{".":{},"f:labelSelector":{".":{},"f:matchLabels":{".":{},"f:app.kubernetes.io/name":{}}},"f:maxSkew":{},"f:topologyKey":{},"f:whenUnsatisfiable":{}}},"f:volumes":{".":{},"k:{\"name\":\"erlang-cookie-secret\"}":{".":{},"f:name":{},"f:secret":{".":{},"f:defaultMode":{},"f:secretName":{}}},"k:{\"name\":\"plugins-conf\"}":{".":{},"f:configMap":{".":{},"f:defaultMode":{},"f:name":{}},"f:name":{}},"k:{\"name\":\"pod-info\"}":{".":{},"f:downwardAPI":{".":{},"f:defaultMode":{},"f:items":{}},"f:name":{}},"k:{\"name\":\"rabbitmq-confd\"}":{".":{},"f:name":{},"f:projected":{".":{},"f:defaultMode":{},"f:sources":{}}},"k:{\"name\":\"rabbitmq-erlang-cookie\"}":{".":{},"f:emptyDir":{},"f:name":{}},"k:{\"name\":\"rabbitmq-plugins\"}":{".":{},"f:emptyDir":{},"f:name":{}}}}},"f:updateStrategy":{"f:rollingUpdate":{".":{},"f:partition":{}},"f:type":{}},"f:volumeClaimTemplates":{}}}},{"manager":"kube-controller-manager","operation":"Update","apiVersion":"apps/v1","time":"2022-03-18T18:01:59Z","fieldsType":"FieldsV1","fieldsV1":{"f:status":{"f:collisionCount":{},"f:currentReplicas":{},"f:currentRevision":{},"f:observedGeneration":{},"f:readyReplicas":{},"f:replicas":{},"f:updateRevision":{},"f:updatedReplicas":{}}}}]},"spec":{"replicas":3,"selector":{"matchLabels":{"app.kubernetes.io/name":"rabbitmq-cluster"}},"template":{"metadata":{"creationTimestamp":null,"labels":{"app.kubernetes.io/component":"rabbitmq","app.kubernetes.io/name":"rabbitmq-cluster","app.kubernetes.io/part-of":"rabbitmq"},"annotations":{"prometheus.io/port":"15692","prometheus.io/scrape":"true"}},"spec":{"volumes":[{"name":"plugins-conf","configMap":{"name":"rabbitmq-cluster-plugins-conf","defaultMode":420}},{"name":"rabbitmq-confd","projected":{"sources":[{"secret":{"name":"rabbitmq-cluster-default-user","items":[{"key":"default_user.conf","path":"default_user.conf"}]}},{"configMap":{"name":"rabbitmq-cluster-server-conf","items":[{"key":"operatorDefaults.conf","path":"operatorDefaults.conf"},{"key":"userDefinedConfiguration.conf","path":"userDefinedConfiguration.conf"}]}}],"defaultMode":420}},{"name":"rabbitmq-erlang-cookie","emptyDir":{}},{"name":"erlang-cookie-secret","secret":{"secretName":"rabbitmq-cluster-erlang-cookie","defaultMode":420}},{"name":"rabbitmq-plugins","emptyDir":{}},{"name":"pod-info","downwardAPI":{"items":[{"path":"skipPreStopChecks","fieldRef":{"apiVersion":"v1","fieldPath":"metadata.labels['skipPreStopChecks']"}}],"defaultMode":420}}],"initContainers":[{"name":"setup-container","image":"rabbitmq:3.8.12-management","command":["sh","-c","cp /tmp/erlang-cookie-secret/.erlang.cookie /var/lib/rabbitmq/.erlang.cookie \u0026\u0026 chown 999:999 /var/lib/rabbitmq/.erlang.cookie \u0026\u0026 chmod 600 /var/lib/rabbitmq/.erlang.cookie ; cp /tmp/rabbitmq-plugins/enabled_plugins /operator/enabled_plugins \u0026\u0026 chown 999:999 /operator/enabled_plugins ; chown 999:999 /var/lib/rabbitmq/mnesia/ ; echo '[default]' \u003e /var/lib/rabbitmq/.rabbitmqadmin.conf \u0026\u0026 sed -e 's/default_user/username/' -e 's/default_pass/password/' /tmp/default_user.conf \u003e\u003e /var/lib/rabbitmq/.rabbitmqadmin.conf \u0026\u0026 chown 999:999 /var/lib/rabbitmq/.rabbitmqadmin.conf \u0026\u0026 chmod 600 /var/lib/rabbitmq/.rabbitmqadmin.conf"],"resources":{"limits":{"cpu":"100m","memory":"500Mi"},"requests":{"cpu":"100m","memory":"500Mi"}},"volumeMounts":[{"name":"plugins-conf","mountPath":"/tmp/rabbitmq-plugins/"},{"name":"rabbitmq-erlang-cookie","mountPath":"/var/lib/rabbitmq/"},{"name":"erlang-cookie-secret","mountPath":"/tmp/erlang-cookie-secret/"},{"name":"rabbitmq-plugins","mountPath":"/operator"},{"name":"persistence","mountPath":"/var/lib/rabbitmq/mnesia/"},{"name":"rabbitmq-confd","mountPath":"/tmp/default_user.conf","subPath":"default_user.conf"}],"terminationMessagePath":"/dev/termination-log","terminationMessagePolicy":"File","imagePullPolicy":"IfNotPresent","securityContext":{"capabilities":{"drop":["FSETID","KILL","SETGID","SETUID","SETPCAP","NET_BIND_SERVICE","NET_RAW","SYS_CHROOT","MKNOD","AUDIT_WRITE","SETFCAP"]},"runAsUser":0}}],"containers":[{"name":"rabbitmq","image":"rabbitmq:3.8.12-management","ports":[{"name":"epmd","containerPort":4369,"protocol":"TCP"},{"name":"amqp","containerPort":5672,"protocol":"TCP"},{"name":"management","containerPort":15672,"protocol":"TCP"},{"name":"prometheus","containerPort":15692,"protocol":"TCP"}],"env":[{"name":"MY_POD_NAME","valueFrom":{"fieldRef":{"apiVersion":"v1","fieldPath":"metadata.name"}}},{"name":"MY_POD_NAMESPACE","valueFrom":{"fieldRef":{"apiVersion":"v1","fieldPath":"metadata.namespace"}}},{"name":"RABBITMQ_ENABLED_PLUGINS_FILE","value":"/operator/enabled_plugins"},{"name":"K8S_SERVICE_NAME","value":"rabbitmq-cluster-nodes"},{"name":"RABBITMQ_USE_LONGNAME","value":"true"},{"name":"RABBITMQ_NODENAME","value":"rabbit@$(MY_POD_NAME).$(K8S_SERVICE_NAME).$(MY_POD_NAMESPACE)"},{"name":"K8S_HOSTNAME_SUFFIX","value":".$(K8S_SERVICE_NAME).$(MY_POD_NAMESPACE)"}],"resources":{"limits":{"cpu":"2","memory":"2Gi"},"requests":{"cpu":"1","memory":"2Gi"}},"volumeMounts":[{"name":"rabbitmq-erlang-cookie","mountPath":"/var/lib/rabbitmq/"},{"name":"persistence","mountPath":"/var/lib/rabbitmq/mnesia/"},{"name":"rabbitmq-plugins","mountPath":"/operator"},{"name":"rabbitmq-confd","mountPath":"/etc/rabbitmq/conf.d/10-operatorDefaults.conf","subPath":"operatorDefaults.conf"},{"name":"rabbitmq-confd","mountPath":"/etc/rabbitmq/conf.d/11-default_user.conf","subPath":"default_user.conf"},{"name":"rabbitmq-confd","mountPath":"/etc/rabbitmq/conf.d/90-userDefinedConfiguration.conf","subPath":"userDefinedConfiguration.conf"},{"name":"pod-info","mountPath":"/etc/pod-info/"}],"readinessProbe":{"tcpSocket":{"port":"amqp"},"initialDelaySeconds":10,"timeoutSeconds":5,"periodSeconds":10,"successThreshold":1,"failureThreshold":3},"lifecycle":{"preStop":{"exec":{"command":["/bin/bash","-c","if [ ! -z \"$(cat /etc/pod-info/skipPreStopChecks)\" ]; then exit 0; fi; rabbitmq-upgrade await_online_quorum_plus_one -t 604800; rabbitmq-upgrade await_online_synchronized_mirror -t 604800; rabbitmq-upgrade drain -t 604800"]}}},"terminationMessagePath":"/dev/termination-log","terminationMessagePolicy":"File","imagePullPolicy":"IfNotPresent"}],"restartPolicy":"Always","terminationGracePeriodSeconds":604800,"dnsPolicy":"ClusterFirst","serviceAccountName":"rabbitmq-cluster-server","serviceAccount":"rabbitmq-cluster-server","automountServiceAccountToken":true,"securityContext":{"runAsUser":999,"runAsGroup":999,"fsGroup":999},"schedulerName":"default-scheduler","topologySpreadConstraints":[{"maxSkew":1,"topologyKey":"topology.kubernetes.io/zone","whenUnsatisfiable":"ScheduleAnyway","labelSelector":{"matchLabels":{"app.kubernetes.io/name":"rabbitmq-cluster"}}}]}},"volumeClaimTemplates":[{"metadata":{"name":"persistence","namespace":"default","creationTimestamp":null,"labels":{"app.kubernetes.io/component":"rabbitmq","app.kubernetes.io/name":"rabbitmq-cluster","app.kubernetes.io/part-of":"rabbitmq"},"ownerReferences":[{"apiVersion":"rabbitmq.com/v1beta1","kind":"RabbitmqCluster","name":"rabbitmq-cluster","uid":"18d9928b-0d1c-47be-80ec-20960d053827","controller":true,"blockOwnerDeletion":false}]},"spec":{"accessModes":["ReadWriteOnce"],"resources":{"requests":{"storage":"10Gi"}},"volumeMode":"Filesystem"},"status":{"phase":"Pending"}}],"serviceName":"rabbitmq-cluster-nodes","podManagementPolicy":"Parallel","updateStrategy":{"type":"RollingUpdate","rollingUpdate":{"partition":0}},"revisionHistoryLimit":10},"status":{"observedGeneration":2,"replicas":3,"readyReplicas":2,"currentReplicas":3,"updatedReplicas":3,"currentRevision":"rabbitmq-cluster-server-5f8b8665fb","updateRevision":"rabbitmq-cluster-server-5f8b8665fb","collisionCount":0}}
2022/03/18 18:01:59 learn_server.go:256: [SIEVE-BEFORE-WRITE]	52
2022/03/18 18:01:59 learn_server.go:263: [SIEVE-AFTER-WRITE]	52	Update	statefulset	github.com/rabbitmq/cluster-operator/controllers.(*RabbitmqClusterReconciler)	NoError	{"metadata":{"name":"rabbitmq-cluster-server","namespace":"default","selfLink":"/apis/apps/v1/namespaces/default/statefulsets/rabbitmq-cluster-server","uid":"cb5c43bc-6ee7-481c-ab01-6f3acffdd3c8","resourceVersion":"1214","generation":2,"creationTimestamp":"2022-03-18T18:00:38Z","labels":{"app.kubernetes.io/component":"rabbitmq","app.kubernetes.io/name":"rabbitmq-cluster","app.kubernetes.io/part-of":"rabbitmq"},"ownerReferences":[{"apiVersion":"rabbitmq.com/v1beta1","kind":"RabbitmqCluster","name":"rabbitmq-cluster","uid":"18d9928b-0d1c-47be-80ec-20960d053827","controller":true,"blockOwnerDeletion":true}],"managedFields":[{"manager":"manager","operation":"Update","apiVersion":"apps/v1","time":"2022-03-18T18:01:23Z","fieldsType":"FieldsV1","fieldsV1":{"f:metadata":{"f:labels":{".":{},"f:app.kubernetes.io/component":{},"f:app.kubernetes.io/name":{},"f:app.kubernetes.io/part-of":{}},"f:ownerReferences":{".":{},"k:{\"uid\":\"18d9928b-0d1c-47be-80ec-20960d053827\"}":{".":{},"f:apiVersion":{},"f:blockOwnerDeletion":{},"f:controller":{},"f:kind":{},"f:name":{},"f:uid":{}}}},"f:spec":{"f:podManagementPolicy":{},"f:replicas":{},"f:revisionHistoryLimit":{},"f:selector":{"f:matchLabels":{".":{},"f:app.kubernetes.io/name":{}}},"f:serviceName":{},"f:template":{"f:metadata":{"f:annotations":{".":{},"f:prometheus.io/port":{},"f:prometheus.io/scrape":{}},"f:labels":{".":{},"f:app.kubernetes.io/component":{},"f:app.kubernetes.io/name":{},"f:app.kubernetes.io/part-of":{}}},"f:spec":{"f:automountServiceAccountToken":{},"f:containers":{"k:{\"name\":\"rabbitmq\"}":{".":{},"f:env":{".":{},"k:{\"name\":\"K8S_HOSTNAME_SUFFIX\"}":{".":{},"f:name":{},"f:value":{}},"k:{\"name\":\"K8S_SERVICE_NAME\"}":{".":{},"f:name":{},"f:value":{}},"k:{\"name\":\"MY_POD_NAME\"}":{".":{},"f:name":{},"f:valueFrom":{".":{},"f:fieldRef":{".":{},"f:apiVersion":{},"f:fieldPath":{}}}},"k:{\"name\":\"MY_POD_NAMESPACE\"}":{".":{},"f:name":{},"f:valueFrom":{".":{},"f:fieldRef":{".":{},"f:apiVersion":{},"f:fieldPath":{}}}},"k:{\"name\":\"RABBITMQ_ENABLED_PLUGINS_FILE\"}":{".":{},"f:name":{},"f:value":{}},"k:{\"name\":\"RABBITMQ_NODENAME\"}":{".":{},"f:name":{},"f:value":{}},"k:{\"name\":\"RABBITMQ_USE_LONGNAME\"}":{".":{},"f:name":{},"f:value":{}}},"f:image":{},"f:imagePullPolicy":{},"f:lifecycle":{".":{},"f:preStop":{".":{},"f:exec":{".":{},"f:command":{}}}},"f:name":{},"f:ports":{".":{},"k:{\"containerPort\":4369,\"protocol\":\"TCP\"}":{".":{},"f:containerPort":{},"f:name":{},"f:protocol":{}},"k:{\"containerPort\":5672,\"protocol\":\"TCP\"}":{".":{},"f:containerPort":{},"f:name":{},"f:protocol":{}},"k:{\"containerPort\":15672,\"protocol\":\"TCP\"}":{".":{},"f:containerPort":{},"f:name":{},"f:protocol":{}},"k:{\"containerPort\":15692,\"protocol\":\"TCP\"}":{".":{},"f:containerPort":{},"f:name":{},"f:protocol":{}}},"f:readinessProbe":{".":{},"f:failureThreshold":{},"f:initialDelaySeconds":{},"f:periodSeconds":{},"f:successThreshold":{},"f:tcpSocket":{".":{},"f:port":{}},"f:timeoutSeconds":{}},"f:resources":{".":{},"f:limits":{".":{},"f:cpu":{},"f:memory":{}},"f:requests":{".":{},"f:cpu":{},"f:memory":{}}},"f:terminationMessagePath":{},"f:terminationMessagePolicy":{},"f:volumeMounts":{".":{},"k:{\"mountPath\":\"/etc/pod-info/\"}":{".":{},"f:mountPath":{},"f:name":{}},"k:{\"mountPath\":\"/etc/rabbitmq/conf.d/10-operatorDefaults.conf\"}":{".":{},"f:mountPath":{},"f:name":{},"f:subPath":{}},"k:{\"mountPath\":\"/etc/rabbitmq/conf.d/11-default_user.conf\"}":{".":{},"f:mountPath":{},"f:name":{},"f:subPath":{}},"k:{\"mountPath\":\"/etc/rabbitmq/conf.d/90-userDefinedConfiguration.conf\"}":{".":{},"f:mountPath":{},"f:name":{},"f:subPath":{}},"k:{\"mountPath\":\"/operator\"}":{".":{},"f:mountPath":{},"f:name":{}},"k:{\"mountPath\":\"/var/lib/rabbitmq/\"}":{".":{},"f:mountPath":{},"f:name":{}},"k:{\"mountPath\":\"/var/lib/rabbitmq/mnesia/\"}":{".":{},"f:mountPath":{},"f:name":{}}}}},"f:dnsPolicy":{},"f:initContainers":{".":{},"k:{\"name\":\"setup-container\"}":{".":{},"f:command":{},"f:image":{},"f:imagePullPolicy":{},"f:name":{},"f:resources":{".":{},"f:limits":{".":{},"f:cpu":{},"f:memory":{}},"f:requests":{".":{},"f:cpu":{},"f:memory":{}}},"f:securityContext":{".":{},"f:capabilities":{".":{},"f:drop":{}},"f:runAsUser":{}},"f:terminationMessagePath":{},"f:terminationMessagePolicy":{},"f:volumeMounts":{".":{},"k:{\"mountPath\":\"/operator\"}":{".":{},"f:mountPath":{},"f:name":{}},"k:{\"mountPath\":\"/tmp/default_user.conf\"}":{".":{},"f:mountPath":{},"f:name":{},"f:subPath":{}},"k:{\"mountPath\":\"/tmp/erlang-cookie-secret/\"}":{".":{},"f:mountPath":{},"f:name":{}},"k:{\"mountPath\":\"/tmp/rabbitmq-plugins/\"}":{".":{},"f:mountPath":{},"f:name":{}},"k:{\"mountPath\":\"/var/lib/rabbitmq/\"}":{".":{},"f:mountPath":{},"f:name":{}},"k:{\"mountPath\":\"/var/lib/rabbitmq/mnesia/\"}":{".":{},"f:mountPath":{},"f:name":{}}}}},"f:restartPolicy":{},"f:schedulerName":{},"f:securityContext":{".":{},"f:fsGroup":{},"f:runAsGroup":{},"f:runAsUser":{}},"f:serviceAccount":{},"f:serviceAccountName":{},"f:terminationGracePeriodSeconds":{},"f:topologySpreadConstraints":{".":{},"k:{\"topologyKey\":\"topology.kubernetes.io/zone\",\"whenUnsatisfiable\":\"ScheduleAnyway\"}":{".":{},"f:labelSelector":{".":{},"f:matchLabels":{".":{},"f:app.kubernetes.io/name":{}}},"f:maxSkew":{},"f:topologyKey":{},"f:whenUnsatisfiable":{}}},"f:volumes":{".":{},"k:{\"name\":\"erlang-cookie-secret\"}":{".":{},"f:name":{},"f:secret":{".":{},"f:defaultMode":{},"f:secretName":{}}},"k:{\"name\":\"plugins-conf\"}":{".":{},"f:configMap":{".":{},"f:defaultMode":{},"f:name":{}},"f:name":{}},"k:{\"name\":\"pod-info\"}":{".":{},"f:downwardAPI":{".":{},"f:defaultMode":{},"f:items":{}},"f:name":{}},"k:{\"name\":\"rabbitmq-confd\"}":{".":{},"f:name":{},"f:projected":{".":{},"f:defaultMode":{},"f:sources":{}}},"k:{\"name\":\"rabbitmq-erlang-cookie\"}":{".":{},"f:emptyDir":{},"f:name":{}},"k:{\"name\":\"rabbitmq-plugins\"}":{".":{},"f:emptyDir":{},"f:name":{}}}}},"f:updateStrategy":{"f:rollingUpdate":{".":{},"f:partition":{}},"f:type":{}},"f:volumeClaimTemplates":{}}}},{"manager":"kube-controller-manager","operation":"Update","apiVersion":"apps/v1","time":"2022-03-18T18:01:59Z","fieldsType":"FieldsV1","fieldsV1":{"f:status":{"f:collisionCount":{},"f:currentReplicas":{},"f:currentRevision":{},"f:observedGeneration":{},"f:readyReplicas":{},"f:replicas":{},"f:updateRevision":{},"f:updatedReplicas":{}}}}]},"spec":{"replicas":3,"selector":{"matchLabels":{"app.kubernetes.io/name":"rabbitmq-cluster"}},"template":{"metadata":{"creationTimestamp":null,"labels":{"app.kubernetes.io/component":"rabbitmq","app.kubernetes.io/name":"rabbitmq-cluster","app.kubernetes.io/part-of":"rabbitmq"},"annotations":{"prometheus.io/port":"15692","prometheus.io/scrape":"true"}},"spec":{"volumes":[{"name":"plugins-conf","configMap":{"name":"rabbitmq-cluster-plugins-conf","defaultMode":420}},{"name":"rabbitmq-confd","projected":{"sources":[{"secret":{"name":"rabbitmq-cluster-default-user","items":[{"key":"default_user.conf","path":"default_user.conf"}]}},{"configMap":{"name":"rabbitmq-cluster-server-conf","items":[{"key":"operatorDefaults.conf","path":"operatorDefaults.conf"},{"key":"userDefinedConfiguration.conf","path":"userDefinedConfiguration.conf"}]}}],"defaultMode":420}},{"name":"rabbitmq-erlang-cookie","emptyDir":{}},{"name":"erlang-cookie-secret","secret":{"secretName":"rabbitmq-cluster-erlang-cookie","defaultMode":420}},{"name":"rabbitmq-plugins","emptyDir":{}},{"name":"pod-info","downwardAPI":{"items":[{"path":"skipPreStopChecks","fieldRef":{"apiVersion":"v1","fieldPath":"metadata.labels['skipPreStopChecks']"}}],"defaultMode":420}}],"initContainers":[{"name":"setup-container","image":"rabbitmq:3.8.12-management","command":["sh","-c","cp /tmp/erlang-cookie-secret/.erlang.cookie /var/lib/rabbitmq/.erlang.cookie \u0026\u0026 chown 999:999 /var/lib/rabbitmq/.erlang.cookie \u0026\u0026 chmod 600 /var/lib/rabbitmq/.erlang.cookie ; cp /tmp/rabbitmq-plugins/enabled_plugins /operator/enabled_plugins \u0026\u0026 chown 999:999 /operator/enabled_plugins ; chown 999:999 /var/lib/rabbitmq/mnesia/ ; echo '[default]' \u003e /var/lib/rabbitmq/.rabbitmqadmin.conf \u0026\u0026 sed -e 's/default_user/username/' -e 's/default_pass/password/' /tmp/default_user.conf \u003e\u003e /var/lib/rabbitmq/.rabbitmqadmin.conf \u0026\u0026 chown 999:999 /var/lib/rabbitmq/.rabbitmqadmin.conf \u0026\u0026 chmod 600 /var/lib/rabbitmq/.rabbitmqadmin.conf"],"resources":{"limits":{"cpu":"100m","memory":"500Mi"},"requests":{"cpu":"100m","memory":"500Mi"}},"volumeMounts":[{"name":"plugins-conf","mountPath":"/tmp/rabbitmq-plugins/"},{"name":"rabbitmq-erlang-cookie","mountPath":"/var/lib/rabbitmq/"},{"name":"erlang-cookie-secret","mountPath":"/tmp/erlang-cookie-secret/"},{"name":"rabbitmq-plugins","mountPath":"/operator"},{"name":"persistence","mountPath":"/var/lib/rabbitmq/mnesia/"},{"name":"rabbitmq-confd","mountPath":"/tmp/default_user.conf","subPath":"default_user.conf"}],"terminationMessagePath":"/dev/termination-log","terminationMessagePolicy":"File","imagePullPolicy":"IfNotPresent","securityContext":{"capabilities":{"drop":["FSETID","KILL","SETGID","SETUID","SETPCAP","NET_BIND_SERVICE","NET_RAW","SYS_CHROOT","MKNOD","AUDIT_WRITE","SETFCAP"]},"runAsUser":0}}],"containers":[{"name":"rabbitmq","image":"rabbitmq:3.8.12-management","ports":[{"name":"epmd","containerPort":4369,"protocol":"TCP"},{"name":"amqp","containerPort":5672,"protocol":"TCP"},{"name":"management","containerPort":15672,"protocol":"TCP"},{"name":"prometheus","containerPort":15692,"protocol":"TCP"}],"env":[{"name":"MY_POD_NAME","valueFrom":{"fieldRef":{"apiVersion":"v1","fieldPath":"metadata.name"}}},{"name":"MY_POD_NAMESPACE","valueFrom":{"fieldRef":{"apiVersion":"v1","fieldPath":"metadata.namespace"}}},{"name":"RABBITMQ_ENABLED_PLUGINS_FILE","value":"/operator/enabled_plugins"},{"name":"K8S_SERVICE_NAME","value":"rabbitmq-cluster-nodes"},{"name":"RABBITMQ_USE_LONGNAME","value":"true"},{"name":"RABBITMQ_NODENAME","value":"rabbit@$(MY_POD_NAME).$(K8S_SERVICE_NAME).$(MY_POD_NAMESPACE)"},{"name":"K8S_HOSTNAME_SUFFIX","value":".$(K8S_SERVICE_NAME).$(MY_POD_NAMESPACE)"}],"resources":{"limits":{"cpu":"2","memory":"2Gi"},"requests":{"cpu":"1","memory":"2Gi"}},"volumeMounts":[{"name":"rabbitmq-erlang-cookie","mountPath":"/var/lib/rabbitmq/"},{"name":"persistence","mountPath":"/var/lib/rabbitmq/mnesia/"},{"name":"rabbitmq-plugins","mountPath":"/operator"},{"name":"rabbitmq-confd","mountPath":"/etc/rabbitmq/conf.d/10-operatorDefaults.conf","subPath":"operatorDefaults.conf"},{"name":"rabbitmq-confd","mountPath":"/etc/rabbitmq/conf.d/11-default_user.conf","subPath":"default_user.conf"},{"name":"rabbitmq-confd","mountPath":"/etc/rabbitmq/conf.d/90-userDefinedConfiguration.conf","subPath":"userDefinedConfiguration.conf"},{"name":"pod-info","mountPath":"/etc/pod-info/"}],"readinessProbe":{"tcpSocket":{"port":"amqp"},"initialDelaySeconds":10,"timeoutSeconds":5,"periodSeconds":10,"successThreshold":1,"failureThreshold":3},"lifecycle":{"preStop":{"exec":{"command":["/bin/bash","-c","if [ ! -z \"$(cat /etc/pod-info/skipPreStopChecks)\" ]; then exit 0; fi; rabbitmq-upgrade await_online_quorum_plus_one -t 604800; rabbitmq-upgrade await_online_synchronized_mirror -t 604800; rabbitmq-upgrade drain -t 604800"]}}},"terminationMessagePath":"/dev/termination-log","terminationMessagePolicy":"File","imagePullPolicy":"IfNotPresent"}],"restartPolicy":"Always","terminationGracePeriodSeconds":604800,"dnsPolicy":"ClusterFirst","serviceAccountName":"rabbitmq-cluster-server","serviceAccount":"rabbitmq-cluster-server","automountServiceAccountToken":true,"securityContext":{"runAsUser":999,"runAsGroup":999,"fsGroup":999},"schedulerName":"default-scheduler","topologySpreadConstraints":[{"maxSkew":1,"topologyKey":"topology.kubernetes.io/zone","whenUnsatisfiable":"ScheduleAnyway","labelSelector":{"matchLabels":{"app.kubernetes.io/name":"rabbitmq-cluster"}}}]}},"volumeClaimTemplates":[{"metadata":{"name":"persistence","namespace":"default","creationTimestamp":null,"labels":{"app.kubernetes.io/component":"rabbitmq","app.kubernetes.io/name":"rabbitmq-cluster","app.kubernetes.io/part-of":"rabbitmq"},"ownerReferences":[{"apiVersion":"rabbitmq.com/v1beta1","kind":"RabbitmqCluster","name":"rabbitmq-cluster","uid":"18d9928b-0d1c-47be-80ec-20960d053827","controller":true,"blockOwnerDeletion":false}]},"spec":{"accessModes":["ReadWriteOnce"],"resources":{"requests":{"storage":"10Gi"}},"volumeMode":"Filesystem"},"status":{"phase":"Pending"}}],"serviceName":"rabbitmq-cluster-nodes","podManagementPolicy":"Parallel","updateStrategy":{"type":"RollingUpdate","rollingUpdate":{"partition":0}},"revisionHistoryLimit":10},"status":{"observedGeneration":2,"replicas":3,"readyReplicas":2,"currentReplicas":3,"updatedReplicas":3,"currentRevision":"rabbitmq-cluster-server-5f8b8665fb","updateRevision":"rabbitmq-cluster-server-5f8b8665fb","collisionCount":0}}
2022/03/18 18:01:59 learn_server.go:291: [SIEVE-AFTER-READ]	Get	true	configmap	default	rabbitmq-cluster-server-conf	github.com/rabbitmq/cluster-operator/controllers.(*RabbitmqClusterReconciler)	NoError	{"kind":"ConfigMap","apiVersion":"v1","metadata":{"name":"rabbitmq-cluster-server-conf","namespace":"default","selfLink":"/api/v1/namespaces/default/configmaps/rabbitmq-cluster-server-conf","uid":"22474f2b-8454-44b7-8079-8990223969cc","resourceVersion":"714","creationTimestamp":"2022-03-18T18:00:38Z","labels":{"app.kubernetes.io/component":"rabbitmq","app.kubernetes.io/name":"rabbitmq-cluster","app.kubernetes.io/part-of":"rabbitmq"},"ownerReferences":[{"apiVersion":"rabbitmq.com/v1beta1","kind":"RabbitmqCluster","name":"rabbitmq-cluster","uid":"18d9928b-0d1c-47be-80ec-20960d053827","controller":true,"blockOwnerDeletion":true}],"managedFields":[{"manager":"manager","operation":"Update","apiVersion":"v1","time":"2022-03-18T18:00:38Z","fieldsType":"FieldsV1","fieldsV1":{"f:data":{".":{},"f:operatorDefaults.conf":{},"f:userDefinedConfiguration.conf":{}},"f:metadata":{"f:labels":{".":{},"f:app.kubernetes.io/component":{},"f:app.kubernetes.io/name":{},"f:app.kubernetes.io/part-of":{}},"f:ownerReferences":{".":{},"k:{\"uid\":\"18d9928b-0d1c-47be-80ec-20960d053827\"}":{".":{},"f:apiVersion":{},"f:blockOwnerDeletion":{},"f:controller":{},"f:kind":{},"f:name":{},"f:uid":{}}}}}}]},"data":{"operatorDefaults.conf":"cluster_formation.peer_discovery_backend             = rabbit_peer_discovery_k8s\ncluster_formation.k8s.host                           = kubernetes.default\ncluster_formation.k8s.address_type                   = hostname\ncluster_partition_handling                           = pause_minority\nqueue_master_locator                                 = min-masters\ndisk_free_limit.absolute                             = 2GB\ncluster_formation.randomized_startup_delay_range.min = 5\ncluster_formation.randomized_startup_delay_range.max = 30\ncluster_name                                         = rabbitmq-cluster\n","userDefinedConfiguration.conf":"total_memory_available_override_value = 1717986919\n"}}
2022/03/18 18:01:59 learn_server.go:256: [SIEVE-BEFORE-WRITE]	53
2022/03/18 18:01:59 learn_server.go:263: [SIEVE-AFTER-WRITE]	53	StatusUpdate	rabbitmqcluster	github.com/rabbitmq/cluster-operator/controllers.(*RabbitmqClusterReconciler)	NoError	{"metadata":{"name":"rabbitmq-cluster","namespace":"default","selfLink":"/apis/rabbitmq.com/v1beta1/namespaces/default/rabbitmqclusters/rabbitmq-cluster/status","uid":"18d9928b-0d1c-47be-80ec-20960d053827","resourceVersion":"1215","generation":3,"creationTimestamp":"2022-03-18T18:00:38Z","annotations":{"kubectl.kubernetes.io/last-applied-configuration":"{\"apiVersion\":\"rabbitmq.com/v1beta1\",\"kind\":\"RabbitmqCluster\",\"metadata\":{\"annotations\":{},\"name\":\"rabbitmq-cluster\",\"namespace\":\"default\"},\"spec\":{\"persistence\":{\"storage\":\"10Gi\"},\"replicas\":1}}\n"},"finalizers":["deletion.finalizers.rabbitmqclusters.rabbitmq.com"],"managedFields":[{"manager":"kubectl-client-side-apply","operation":"Update","apiVersion":"rabbitmq.com/v1beta1","time":"2022-03-18T18:00:38Z","fieldsType":"FieldsV1","fieldsV1":{"f:metadata":{"f:annotations":{".":{},"f:kubectl.kubernetes.io/last-applied-configuration":{}}},"f:spec":{".":{},"f:image":{},"f:persistence":{".":{},"f:storage":{}},"f:resources":{".":{},"f:limits":{".":{},"f:memory":{}},"f:requests":{".":{},"f:memory":{}}},"f:service":{".":{},"f:type":{}},"f:terminationGracePeriodSeconds":{}}}},{"manager":"kubectl-patch","operation":"Update","apiVersion":"rabbitmq.com/v1beta1","time":"2022-03-18T18:01:23Z","fieldsType":"FieldsV1","fieldsV1":{"f:spec":{"f:replicas":{}}}},{"manager":"manager","operation":"Update","apiVersion":"rabbitmq.com/v1beta1","time":"2022-03-18T18:01:59Z","fieldsType":"FieldsV1","fieldsV1":{"f:metadata":{"f:finalizers":{}},"f:spec":{"f:override":{},"f:rabbitmq":{},"f:resources":{"f:limits":{"f:cpu":{}},"f:requests":{"f:cpu":{}}},"f:tls":{}},"f:status":{".":{},"f:conditions":{},"f:defaultUser":{".":{},"f:secretReference":{".":{},"f:keys":{".":{},"f:password":{},"f:username":{}},"f:name":{},"f:namespace":{}},"f:serviceReference":{".":{},"f:name":{},"f:namespace":{}}}}}}]},"spec":{"replicas":3,"image":"rabbitmq:3.8.12-management","service":{"type":"ClusterIP"},"persistence":{"storage":"10Gi"},"resources":{"limits":{"cpu":"2","memory":"2Gi"},"requests":{"cpu":"1","memory":"2Gi"}},"rabbitmq":{},"tls":{},"override":{},"terminationGracePeriodSeconds":604800},"status":{"conditions":[{"type":"AllReplicasReady","status":"False","lastTransitionTime":"2022-03-18T18:01:23Z","reason":"NotAllPodsReady","message":"2/3 Pods ready"},{"type":"ClusterAvailable","status":"True","lastTransitionTime":"2022-03-18T18:01:17Z","reason":"AtLeastOneEndpointAvailable"},{"type":"NoWarnings","status":"True","lastTransitionTime":"2022-03-18T18:00:38Z","reason":"NoWarnings"},{"type":"ReconcileSuccess","status":"True","lastTransitionTime":"2022-03-18T18:01:18Z","reason":"Success","message":"Finish reconciling"}],"defaultUser":{"secretReference":{"name":"rabbitmq-cluster-default-user","namespace":"default","keys":{"password":"password","username":"username"}},"serviceReference":{"name":"rabbitmq-cluster","namespace":"default"}},"binding":{"name":"rabbitmq-cluster-default-user"}}}
2022/03/18 18:01:59 learn_server.go:291: [SIEVE-AFTER-READ]	Get	true	statefulset	default	rabbitmq-cluster-server	github.com/rabbitmq/cluster-operator/controllers.(*RabbitmqClusterReconciler)	NoError	{"kind":"StatefulSet","apiVersion":"apps/v1","metadata":{"name":"rabbitmq-cluster-server","namespace":"default","selfLink":"/apis/apps/v1/namespaces/default/statefulsets/rabbitmq-cluster-server","uid":"cb5c43bc-6ee7-481c-ab01-6f3acffdd3c8","resourceVersion":"1214","generation":2,"creationTimestamp":"2022-03-18T18:00:38Z","labels":{"app.kubernetes.io/component":"rabbitmq","app.kubernetes.io/name":"rabbitmq-cluster","app.kubernetes.io/part-of":"rabbitmq"},"ownerReferences":[{"apiVersion":"rabbitmq.com/v1beta1","kind":"RabbitmqCluster","name":"rabbitmq-cluster","uid":"18d9928b-0d1c-47be-80ec-20960d053827","controller":true,"blockOwnerDeletion":true}],"managedFields":[{"manager":"manager","operation":"Update","apiVersion":"apps/v1","time":"2022-03-18T18:01:23Z","fieldsType":"FieldsV1","fieldsV1":{"f:metadata":{"f:labels":{".":{},"f:app.kubernetes.io/component":{},"f:app.kubernetes.io/name":{},"f:app.kubernetes.io/part-of":{}},"f:ownerReferences":{".":{},"k:{\"uid\":\"18d9928b-0d1c-47be-80ec-20960d053827\"}":{".":{},"f:apiVersion":{},"f:blockOwnerDeletion":{},"f:controller":{},"f:kind":{},"f:name":{},"f:uid":{}}}},"f:spec":{"f:podManagementPolicy":{},"f:replicas":{},"f:revisionHistoryLimit":{},"f:selector":{"f:matchLabels":{".":{},"f:app.kubernetes.io/name":{}}},"f:serviceName":{},"f:template":{"f:metadata":{"f:annotations":{".":{},"f:prometheus.io/port":{},"f:prometheus.io/scrape":{}},"f:labels":{".":{},"f:app.kubernetes.io/component":{},"f:app.kubernetes.io/name":{},"f:app.kubernetes.io/part-of":{}}},"f:spec":{"f:automountServiceAccountToken":{},"f:containers":{"k:{\"name\":\"rabbitmq\"}":{".":{},"f:env":{".":{},"k:{\"name\":\"K8S_HOSTNAME_SUFFIX\"}":{".":{},"f:name":{},"f:value":{}},"k:{\"name\":\"K8S_SERVICE_NAME\"}":{".":{},"f:name":{},"f:value":{}},"k:{\"name\":\"MY_POD_NAME\"}":{".":{},"f:name":{},"f:valueFrom":{".":{},"f:fieldRef":{".":{},"f:apiVersion":{},"f:fieldPath":{}}}},"k:{\"name\":\"MY_POD_NAMESPACE\"}":{".":{},"f:name":{},"f:valueFrom":{".":{},"f:fieldRef":{".":{},"f:apiVersion":{},"f:fieldPath":{}}}},"k:{\"name\":\"RABBITMQ_ENABLED_PLUGINS_FILE\"}":{".":{},"f:name":{},"f:value":{}},"k:{\"name\":\"RABBITMQ_NODENAME\"}":{".":{},"f:name":{},"f:value":{}},"k:{\"name\":\"RABBITMQ_USE_LONGNAME\"}":{".":{},"f:name":{},"f:value":{}}},"f:image":{},"f:imagePullPolicy":{},"f:lifecycle":{".":{},"f:preStop":{".":{},"f:exec":{".":{},"f:command":{}}}},"f:name":{},"f:ports":{".":{},"k:{\"containerPort\":4369,\"protocol\":\"TCP\"}":{".":{},"f:containerPort":{},"f:name":{},"f:protocol":{}},"k:{\"containerPort\":5672,\"protocol\":\"TCP\"}":{".":{},"f:containerPort":{},"f:name":{},"f:protocol":{}},"k:{\"containerPort\":15672,\"protocol\":\"TCP\"}":{".":{},"f:containerPort":{},"f:name":{},"f:protocol":{}},"k:{\"containerPort\":15692,\"protocol\":\"TCP\"}":{".":{},"f:containerPort":{},"f:name":{},"f:protocol":{}}},"f:readinessProbe":{".":{},"f:failureThreshold":{},"f:initialDelaySeconds":{},"f:periodSeconds":{},"f:successThreshold":{},"f:tcpSocket":{".":{},"f:port":{}},"f:timeoutSeconds":{}},"f:resources":{".":{},"f:limits":{".":{},"f:cpu":{},"f:memory":{}},"f:requests":{".":{},"f:cpu":{},"f:memory":{}}},"f:terminationMessagePath":{},"f:terminationMessagePolicy":{},"f:volumeMounts":{".":{},"k:{\"mountPath\":\"/etc/pod-info/\"}":{".":{},"f:mountPath":{},"f:name":{}},"k:{\"mountPath\":\"/etc/rabbitmq/conf.d/10-operatorDefaults.conf\"}":{".":{},"f:mountPath":{},"f:name":{},"f:subPath":{}},"k:{\"mountPath\":\"/etc/rabbitmq/conf.d/11-default_user.conf\"}":{".":{},"f:mountPath":{},"f:name":{},"f:subPath":{}},"k:{\"mountPath\":\"/etc/rabbitmq/conf.d/90-userDefinedConfiguration.conf\"}":{".":{},"f:mountPath":{},"f:name":{},"f:subPath":{}},"k:{\"mountPath\":\"/operator\"}":{".":{},"f:mountPath":{},"f:name":{}},"k:{\"mountPath\":\"/var/lib/rabbitmq/\"}":{".":{},"f:mountPath":{},"f:name":{}},"k:{\"mountPath\":\"/var/lib/rabbitmq/mnesia/\"}":{".":{},"f:mountPath":{},"f:name":{}}}}},"f:dnsPolicy":{},"f:initContainers":{".":{},"k:{\"name\":\"setup-container\"}":{".":{},"f:command":{},"f:image":{},"f:imagePullPolicy":{},"f:name":{},"f:resources":{".":{},"f:limits":{".":{},"f:cpu":{},"f:memory":{}},"f:requests":{".":{},"f:cpu":{},"f:memory":{}}},"f:securityContext":{".":{},"f:capabilities":{".":{},"f:drop":{}},"f:runAsUser":{}},"f:terminationMessagePath":{},"f:terminationMessagePolicy":{},"f:volumeMounts":{".":{},"k:{\"mountPath\":\"/operator\"}":{".":{},"f:mountPath":{},"f:name":{}},"k:{\"mountPath\":\"/tmp/default_user.conf\"}":{".":{},"f:mountPath":{},"f:name":{},"f:subPath":{}},"k:{\"mountPath\":\"/tmp/erlang-cookie-secret/\"}":{".":{},"f:mountPath":{},"f:name":{}},"k:{\"mountPath\":\"/tmp/rabbitmq-plugins/\"}":{".":{},"f:mountPath":{},"f:name":{}},"k:{\"mountPath\":\"/var/lib/rabbitmq/\"}":{".":{},"f:mountPath":{},"f:name":{}},"k:{\"mountPath\":\"/var/lib/rabbitmq/mnesia/\"}":{".":{},"f:mountPath":{},"f:name":{}}}}},"f:restartPolicy":{},"f:schedulerName":{},"f:securityContext":{".":{},"f:fsGroup":{},"f:runAsGroup":{},"f:runAsUser":{}},"f:serviceAccount":{},"f:serviceAccountName":{},"f:terminationGracePeriodSeconds":{},"f:topologySpreadConstraints":{".":{},"k:{\"topologyKey\":\"topology.kubernetes.io/zone\",\"whenUnsatisfiable\":\"ScheduleAnyway\"}":{".":{},"f:labelSelector":{".":{},"f:matchLabels":{".":{},"f:app.kubernetes.io/name":{}}},"f:maxSkew":{},"f:topologyKey":{},"f:whenUnsatisfiable":{}}},"f:volumes":{".":{},"k:{\"name\":\"erlang-cookie-secret\"}":{".":{},"f:name":{},"f:secret":{".":{},"f:defaultMode":{},"f:secretName":{}}},"k:{\"name\":\"plugins-conf\"}":{".":{},"f:configMap":{".":{},"f:defaultMode":{},"f:name":{}},"f:name":{}},"k:{\"name\":\"pod-info\"}":{".":{},"f:downwardAPI":{".":{},"f:defaultMode":{},"f:items":{}},"f:name":{}},"k:{\"name\":\"rabbitmq-confd\"}":{".":{},"f:name":{},"f:projected":{".":{},"f:defaultMode":{},"f:sources":{}}},"k:{\"name\":\"rabbitmq-erlang-cookie\"}":{".":{},"f:emptyDir":{},"f:name":{}},"k:{\"name\":\"rabbitmq-plugins\"}":{".":{},"f:emptyDir":{},"f:name":{}}}}},"f:updateStrategy":{"f:rollingUpdate":{".":{},"f:partition":{}},"f:type":{}},"f:volumeClaimTemplates":{}}}},{"manager":"kube-controller-manager","operation":"Update","apiVersion":"apps/v1","time":"2022-03-18T18:01:59Z","fieldsType":"FieldsV1","fieldsV1":{"f:status":{"f:collisionCount":{},"f:currentReplicas":{},"f:currentRevision":{},"f:observedGeneration":{},"f:readyReplicas":{},"f:replicas":{},"f:updateRevision":{},"f:updatedReplicas":{}}}}]},"spec":{"replicas":3,"selector":{"matchLabels":{"app.kubernetes.io/name":"rabbitmq-cluster"}},"template":{"metadata":{"creationTimestamp":null,"labels":{"app.kubernetes.io/component":"rabbitmq","app.kubernetes.io/name":"rabbitmq-cluster","app.kubernetes.io/part-of":"rabbitmq"},"annotations":{"prometheus.io/port":"15692","prometheus.io/scrape":"true"}},"spec":{"volumes":[{"name":"plugins-conf","configMap":{"name":"rabbitmq-cluster-plugins-conf","defaultMode":420}},{"name":"rabbitmq-confd","projected":{"sources":[{"secret":{"name":"rabbitmq-cluster-default-user","items":[{"key":"default_user.conf","path":"default_user.conf"}]}},{"configMap":{"name":"rabbitmq-cluster-server-conf","items":[{"key":"operatorDefaults.conf","path":"operatorDefaults.conf"},{"key":"userDefinedConfiguration.conf","path":"userDefinedConfiguration.conf"}]}}],"defaultMode":420}},{"name":"rabbitmq-erlang-cookie","emptyDir":{}},{"name":"erlang-cookie-secret","secret":{"secretName":"rabbitmq-cluster-erlang-cookie","defaultMode":420}},{"name":"rabbitmq-plugins","emptyDir":{}},{"name":"pod-info","downwardAPI":{"items":[{"path":"skipPreStopChecks","fieldRef":{"apiVersion":"v1","fieldPath":"metadata.labels['skipPreStopChecks']"}}],"defaultMode":420}}],"initContainers":[{"name":"setup-container","image":"rabbitmq:3.8.12-management","command":["sh","-c","cp /tmp/erlang-cookie-secret/.erlang.cookie /var/lib/rabbitmq/.erlang.cookie \u0026\u0026 chown 999:999 /var/lib/rabbitmq/.erlang.cookie \u0026\u0026 chmod 600 /var/lib/rabbitmq/.erlang.cookie ; cp /tmp/rabbitmq-plugins/enabled_plugins /operator/enabled_plugins \u0026\u0026 chown 999:999 /operator/enabled_plugins ; chown 999:999 /var/lib/rabbitmq/mnesia/ ; echo '[default]' \u003e /var/lib/rabbitmq/.rabbitmqadmin.conf \u0026\u0026 sed -e 's/default_user/username/' -e 's/default_pass/password/' /tmp/default_user.conf \u003e\u003e /var/lib/rabbitmq/.rabbitmqadmin.conf \u0026\u0026 chown 999:999 /var/lib/rabbitmq/.rabbitmqadmin.conf \u0026\u0026 chmod 600 /var/lib/rabbitmq/.rabbitmqadmin.conf"],"resources":{"limits":{"cpu":"100m","memory":"500Mi"},"requests":{"cpu":"100m","memory":"500Mi"}},"volumeMounts":[{"name":"plugins-conf","mountPath":"/tmp/rabbitmq-plugins/"},{"name":"rabbitmq-erlang-cookie","mountPath":"/var/lib/rabbitmq/"},{"name":"erlang-cookie-secret","mountPath":"/tmp/erlang-cookie-secret/"},{"name":"rabbitmq-plugins","mountPath":"/operator"},{"name":"persistence","mountPath":"/var/lib/rabbitmq/mnesia/"},{"name":"rabbitmq-confd","mountPath":"/tmp/default_user.conf","subPath":"default_user.conf"}],"terminationMessagePath":"/dev/termination-log","terminationMessagePolicy":"File","imagePullPolicy":"IfNotPresent","securityContext":{"capabilities":{"drop":["FSETID","KILL","SETGID","SETUID","SETPCAP","NET_BIND_SERVICE","NET_RAW","SYS_CHROOT","MKNOD","AUDIT_WRITE","SETFCAP"]},"runAsUser":0}}],"containers":[{"name":"rabbitmq","image":"rabbitmq:3.8.12-management","ports":[{"name":"epmd","containerPort":4369,"protocol":"TCP"},{"name":"amqp","containerPort":5672,"protocol":"TCP"},{"name":"management","containerPort":15672,"protocol":"TCP"},{"name":"prometheus","containerPort":15692,"protocol":"TCP"}],"env":[{"name":"MY_POD_NAME","valueFrom":{"fieldRef":{"apiVersion":"v1","fieldPath":"metadata.name"}}},{"name":"MY_POD_NAMESPACE","valueFrom":{"fieldRef":{"apiVersion":"v1","fieldPath":"metadata.namespace"}}},{"name":"RABBITMQ_ENABLED_PLUGINS_FILE","value":"/operator/enabled_plugins"},{"name":"K8S_SERVICE_NAME","value":"rabbitmq-cluster-nodes"},{"name":"RABBITMQ_USE_LONGNAME","value":"true"},{"name":"RABBITMQ_NODENAME","value":"rabbit@$(MY_POD_NAME).$(K8S_SERVICE_NAME).$(MY_POD_NAMESPACE)"},{"name":"K8S_HOSTNAME_SUFFIX","value":".$(K8S_SERVICE_NAME).$(MY_POD_NAMESPACE)"}],"resources":{"limits":{"cpu":"2","memory":"2Gi"},"requests":{"cpu":"1","memory":"2Gi"}},"volumeMounts":[{"name":"rabbitmq-erlang-cookie","mountPath":"/var/lib/rabbitmq/"},{"name":"persistence","mountPath":"/var/lib/rabbitmq/mnesia/"},{"name":"rabbitmq-plugins","mountPath":"/operator"},{"name":"rabbitmq-confd","mountPath":"/etc/rabbitmq/conf.d/10-operatorDefaults.conf","subPath":"operatorDefaults.conf"},{"name":"rabbitmq-confd","mountPath":"/etc/rabbitmq/conf.d/11-default_user.conf","subPath":"default_user.conf"},{"name":"rabbitmq-confd","mountPath":"/etc/rabbitmq/conf.d/90-userDefinedConfiguration.conf","subPath":"userDefinedConfiguration.conf"},{"name":"pod-info","mountPath":"/etc/pod-info/"}],"readinessProbe":{"tcpSocket":{"port":"amqp"},"initialDelaySeconds":10,"timeoutSeconds":5,"periodSeconds":10,"successThreshold":1,"failureThreshold":3},"lifecycle":{"preStop":{"exec":{"command":["/bin/bash","-c","if [ ! -z \"$(cat /etc/pod-info/skipPreStopChecks)\" ]; then exit 0; fi; rabbitmq-upgrade await_online_quorum_plus_one -t 604800; rabbitmq-upgrade await_online_synchronized_mirror -t 604800; rabbitmq-upgrade drain -t 604800"]}}},"terminationMessagePath":"/dev/termination-log","terminationMessagePolicy":"File","imagePullPolicy":"IfNotPresent"}],"restartPolicy":"Always","terminationGracePeriodSeconds":604800,"dnsPolicy":"ClusterFirst","serviceAccountName":"rabbitmq-cluster-server","serviceAccount":"rabbitmq-cluster-server","automountServiceAccountToken":true,"securityContext":{"runAsUser":999,"runAsGroup":999,"fsGroup":999},"schedulerName":"default-scheduler","topologySpreadConstraints":[{"maxSkew":1,"topologyKey":"topology.kubernetes.io/zone","whenUnsatisfiable":"ScheduleAnyway","labelSelector":{"matchLabels":{"app.kubernetes.io/name":"rabbitmq-cluster"}}}]}},"volumeClaimTemplates":[{"metadata":{"name":"persistence","namespace":"default","creationTimestamp":null,"labels":{"app.kubernetes.io/component":"rabbitmq","app.kubernetes.io/name":"rabbitmq-cluster","app.kubernetes.io/part-of":"rabbitmq"},"ownerReferences":[{"apiVersion":"rabbitmq.com/v1beta1","kind":"RabbitmqCluster","name":"rabbitmq-cluster","uid":"18d9928b-0d1c-47be-80ec-20960d053827","controller":true,"blockOwnerDeletion":false}]},"spec":{"accessModes":["ReadWriteOnce"],"resources":{"requests":{"storage":"10Gi"}},"volumeMode":"Filesystem"},"status":{"phase":"Pending"}}],"serviceName":"rabbitmq-cluster-nodes","podManagementPolicy":"Parallel","updateStrategy":{"type":"RollingUpdate","rollingUpdate":{"partition":0}},"revisionHistoryLimit":10},"status":{"observedGeneration":2,"replicas":3,"readyReplicas":2,"currentReplicas":3,"updatedReplicas":3,"currentRevision":"rabbitmq-cluster-server-5f8b8665fb","updateRevision":"rabbitmq-cluster-server-5f8b8665fb","collisionCount":0}}
2022/03/18 18:01:59 learn_server.go:253: [SIEVE-AFTER-RECONCILE]	github.com/rabbitmq/cluster-operator/controllers.(*RabbitmqClusterReconciler)	15
2022/03/18 18:02:01 learn_server.go:279: [SIEVE-BEFORE-HEAR]	28	Updated	statefulset	{"metadata":{"name":"rabbitmq-cluster-server","namespace":"default","selfLink":"/apis/apps/v1/namespaces/default/statefulsets/rabbitmq-cluster-server","uid":"cb5c43bc-6ee7-481c-ab01-6f3acffdd3c8","resourceVersion":"1231","generation":2,"creationTimestamp":"2022-03-18T18:00:38Z","labels":{"app.kubernetes.io/component":"rabbitmq","app.kubernetes.io/name":"rabbitmq-cluster","app.kubernetes.io/part-of":"rabbitmq"},"ownerReferences":[{"apiVersion":"rabbitmq.com/v1beta1","kind":"RabbitmqCluster","name":"rabbitmq-cluster","uid":"18d9928b-0d1c-47be-80ec-20960d053827","controller":true,"blockOwnerDeletion":true}],"managedFields":[{"manager":"manager","operation":"Update","apiVersion":"apps/v1","time":"2022-03-18T18:01:23Z","fieldsType":"FieldsV1","fieldsV1":{"f:metadata":{"f:labels":{".":{},"f:app.kubernetes.io/component":{},"f:app.kubernetes.io/name":{},"f:app.kubernetes.io/part-of":{}},"f:ownerReferences":{".":{},"k:{\"uid\":\"18d9928b-0d1c-47be-80ec-20960d053827\"}":{".":{},"f:apiVersion":{},"f:blockOwnerDeletion":{},"f:controller":{},"f:kind":{},"f:name":{},"f:uid":{}}}},"f:spec":{"f:podManagementPolicy":{},"f:replicas":{},"f:revisionHistoryLimit":{},"f:selector":{"f:matchLabels":{".":{},"f:app.kubernetes.io/name":{}}},"f:serviceName":{},"f:template":{"f:metadata":{"f:annotations":{".":{},"f:prometheus.io/port":{},"f:prometheus.io/scrape":{}},"f:labels":{".":{},"f:app.kubernetes.io/component":{},"f:app.kubernetes.io/name":{},"f:app.kubernetes.io/part-of":{}}},"f:spec":{"f:automountServiceAccountToken":{},"f:containers":{"k:{\"name\":\"rabbitmq\"}":{".":{},"f:env":{".":{},"k:{\"name\":\"K8S_HOSTNAME_SUFFIX\"}":{".":{},"f:name":{},"f:value":{}},"k:{\"name\":\"K8S_SERVICE_NAME\"}":{".":{},"f:name":{},"f:value":{}},"k:{\"name\":\"MY_POD_NAME\"}":{".":{},"f:name":{},"f:valueFrom":{".":{},"f:fieldRef":{".":{},"f:apiVersion":{},"f:fieldPath":{}}}},"k:{\"name\":\"MY_POD_NAMESPACE\"}":{".":{},"f:name":{},"f:valueFrom":{".":{},"f:fieldRef":{".":{},"f:apiVersion":{},"f:fieldPath":{}}}},"k:{\"name\":\"RABBITMQ_ENABLED_PLUGINS_FILE\"}":{".":{},"f:name":{},"f:value":{}},"k:{\"name\":\"RABBITMQ_NODENAME\"}":{".":{},"f:name":{},"f:value":{}},"k:{\"name\":\"RABBITMQ_USE_LONGNAME\"}":{".":{},"f:name":{},"f:value":{}}},"f:image":{},"f:imagePullPolicy":{},"f:lifecycle":{".":{},"f:preStop":{".":{},"f:exec":{".":{},"f:command":{}}}},"f:name":{},"f:ports":{".":{},"k:{\"containerPort\":4369,\"protocol\":\"TCP\"}":{".":{},"f:containerPort":{},"f:name":{},"f:protocol":{}},"k:{\"containerPort\":5672,\"protocol\":\"TCP\"}":{".":{},"f:containerPort":{},"f:name":{},"f:protocol":{}},"k:{\"containerPort\":15672,\"protocol\":\"TCP\"}":{".":{},"f:containerPort":{},"f:name":{},"f:protocol":{}},"k:{\"containerPort\":15692,\"protocol\":\"TCP\"}":{".":{},"f:containerPort":{},"f:name":{},"f:protocol":{}}},"f:readinessProbe":{".":{},"f:failureThreshold":{},"f:initialDelaySeconds":{},"f:periodSeconds":{},"f:successThreshold":{},"f:tcpSocket":{".":{},"f:port":{}},"f:timeoutSeconds":{}},"f:resources":{".":{},"f:limits":{".":{},"f:cpu":{},"f:memory":{}},"f:requests":{".":{},"f:cpu":{},"f:memory":{}}},"f:terminationMessagePath":{},"f:terminationMessagePolicy":{},"f:volumeMounts":{".":{},"k:{\"mountPath\":\"/etc/pod-info/\"}":{".":{},"f:mountPath":{},"f:name":{}},"k:{\"mountPath\":\"/etc/rabbitmq/conf.d/10-operatorDefaults.conf\"}":{".":{},"f:mountPath":{},"f:name":{},"f:subPath":{}},"k:{\"mountPath\":\"/etc/rabbitmq/conf.d/11-default_user.conf\"}":{".":{},"f:mountPath":{},"f:name":{},"f:subPath":{}},"k:{\"mountPath\":\"/etc/rabbitmq/conf.d/90-userDefinedConfiguration.conf\"}":{".":{},"f:mountPath":{},"f:name":{},"f:subPath":{}},"k:{\"mountPath\":\"/operator\"}":{".":{},"f:mountPath":{},"f:name":{}},"k:{\"mountPath\":\"/var/lib/rabbitmq/\"}":{".":{},"f:mountPath":{},"f:name":{}},"k:{\"mountPath\":\"/var/lib/rabbitmq/mnesia/\"}":{".":{},"f:mountPath":{},"f:name":{}}}}},"f:dnsPolicy":{},"f:initContainers":{".":{},"k:{\"name\":\"setup-container\"}":{".":{},"f:command":{},"f:image":{},"f:imagePullPolicy":{},"f:name":{},"f:resources":{".":{},"f:limits":{".":{},"f:cpu":{},"f:memory":{}},"f:requests":{".":{},"f:cpu":{},"f:memory":{}}},"f:securityContext":{".":{},"f:capabilities":{".":{},"f:drop":{}},"f:runAsUser":{}},"f:terminationMessagePath":{},"f:terminationMessagePolicy":{},"f:volumeMounts":{".":{},"k:{\"mountPath\":\"/operator\"}":{".":{},"f:mountPath":{},"f:name":{}},"k:{\"mountPath\":\"/tmp/default_user.conf\"}":{".":{},"f:mountPath":{},"f:name":{},"f:subPath":{}},"k:{\"mountPath\":\"/tmp/erlang-cookie-secret/\"}":{".":{},"f:mountPath":{},"f:name":{}},"k:{\"mountPath\":\"/tmp/rabbitmq-plugins/\"}":{".":{},"f:mountPath":{},"f:name":{}},"k:{\"mountPath\":\"/var/lib/rabbitmq/\"}":{".":{},"f:mountPath":{},"f:name":{}},"k:{\"mountPath\":\"/var/lib/rabbitmq/mnesia/\"}":{".":{},"f:mountPath":{},"f:name":{}}}}},"f:restartPolicy":{},"f:schedulerName":{},"f:securityContext":{".":{},"f:fsGroup":{},"f:runAsGroup":{},"f:runAsUser":{}},"f:serviceAccount":{},"f:serviceAccountName":{},"f:terminationGracePeriodSeconds":{},"f:topologySpreadConstraints":{".":{},"k:{\"topologyKey\":\"topology.kubernetes.io/zone\",\"whenUnsatisfiable\":\"ScheduleAnyway\"}":{".":{},"f:labelSelector":{".":{},"f:matchLabels":{".":{},"f:app.kubernetes.io/name":{}}},"f:maxSkew":{},"f:topologyKey":{},"f:whenUnsatisfiable":{}}},"f:volumes":{".":{},"k:{\"name\":\"erlang-cookie-secret\"}":{".":{},"f:name":{},"f:secret":{".":{},"f:defaultMode":{},"f:secretName":{}}},"k:{\"name\":\"plugins-conf\"}":{".":{},"f:configMap":{".":{},"f:defaultMode":{},"f:name":{}},"f:name":{}},"k:{\"name\":\"pod-info\"}":{".":{},"f:downwardAPI":{".":{},"f:defaultMode":{},"f:items":{}},"f:name":{}},"k:{\"name\":\"rabbitmq-confd\"}":{".":{},"f:name":{},"f:projected":{".":{},"f:defaultMode":{},"f:sources":{}}},"k:{\"name\":\"rabbitmq-erlang-cookie\"}":{".":{},"f:emptyDir":{},"f:name":{}},"k:{\"name\":\"rabbitmq-plugins\"}":{".":{},"f:emptyDir":{},"f:name":{}}}}},"f:updateStrategy":{"f:rollingUpdate":{".":{},"f:partition":{}},"f:type":{}},"f:volumeClaimTemplates":{}}}},{"manager":"kube-controller-manager","operation":"Update","apiVersion":"apps/v1","time":"2022-03-18T18:02:01Z","fieldsType":"FieldsV1","fieldsV1":{"f:status":{"f:collisionCount":{},"f:currentReplicas":{},"f:currentRevision":{},"f:observedGeneration":{},"f:readyReplicas":{},"f:replicas":{},"f:updateRevision":{},"f:updatedReplicas":{}}}}]},"spec":{"replicas":3,"selector":{"matchLabels":{"app.kubernetes.io/name":"rabbitmq-cluster"}},"template":{"metadata":{"creationTimestamp":null,"labels":{"app.kubernetes.io/component":"rabbitmq","app.kubernetes.io/name":"rabbitmq-cluster","app.kubernetes.io/part-of":"rabbitmq"},"annotations":{"prometheus.io/port":"15692","prometheus.io/scrape":"true"}},"spec":{"volumes":[{"name":"plugins-conf","configMap":{"name":"rabbitmq-cluster-plugins-conf","defaultMode":420}},{"name":"rabbitmq-confd","projected":{"sources":[{"secret":{"name":"rabbitmq-cluster-default-user","items":[{"key":"default_user.conf","path":"default_user.conf"}]}},{"configMap":{"name":"rabbitmq-cluster-server-conf","items":[{"key":"operatorDefaults.conf","path":"operatorDefaults.conf"},{"key":"userDefinedConfiguration.conf","path":"userDefinedConfiguration.conf"}]}}],"defaultMode":420}},{"name":"rabbitmq-erlang-cookie","emptyDir":{}},{"name":"erlang-cookie-secret","secret":{"secretName":"rabbitmq-cluster-erlang-cookie","defaultMode":420}},{"name":"rabbitmq-plugins","emptyDir":{}},{"name":"pod-info","downwardAPI":{"items":[{"path":"skipPreStopChecks","fieldRef":{"apiVersion":"v1","fieldPath":"metadata.labels['skipPreStopChecks']"}}],"defaultMode":420}}],"initContainers":[{"name":"setup-container","image":"rabbitmq:3.8.12-management","command":["sh","-c","cp /tmp/erlang-cookie-secret/.erlang.cookie /var/lib/rabbitmq/.erlang.cookie \u0026\u0026 chown 999:999 /var/lib/rabbitmq/.erlang.cookie \u0026\u0026 chmod 600 /var/lib/rabbitmq/.erlang.cookie ; cp /tmp/rabbitmq-plugins/enabled_plugins /operator/enabled_plugins \u0026\u0026 chown 999:999 /operator/enabled_plugins ; chown 999:999 /var/lib/rabbitmq/mnesia/ ; echo '[default]' \u003e /var/lib/rabbitmq/.rabbitmqadmin.conf \u0026\u0026 sed -e 's/default_user/username/' -e 's/default_pass/password/' /tmp/default_user.conf \u003e\u003e /var/lib/rabbitmq/.rabbitmqadmin.conf \u0026\u0026 chown 999:999 /var/lib/rabbitmq/.rabbitmqadmin.conf \u0026\u0026 chmod 600 /var/lib/rabbitmq/.rabbitmqadmin.conf"],"resources":{"limits":{"cpu":"100m","memory":"500Mi"},"requests":{"cpu":"100m","memory":"500Mi"}},"volumeMounts":[{"name":"plugins-conf","mountPath":"/tmp/rabbitmq-plugins/"},{"name":"rabbitmq-erlang-cookie","mountPath":"/var/lib/rabbitmq/"},{"name":"erlang-cookie-secret","mountPath":"/tmp/erlang-cookie-secret/"},{"name":"rabbitmq-plugins","mountPath":"/operator"},{"name":"persistence","mountPath":"/var/lib/rabbitmq/mnesia/"},{"name":"rabbitmq-confd","mountPath":"/tmp/default_user.conf","subPath":"default_user.conf"}],"terminationMessagePath":"/dev/termination-log","terminationMessagePolicy":"File","imagePullPolicy":"IfNotPresent","securityContext":{"capabilities":{"drop":["FSETID","KILL","SETGID","SETUID","SETPCAP","NET_BIND_SERVICE","NET_RAW","SYS_CHROOT","MKNOD","AUDIT_WRITE","SETFCAP"]},"runAsUser":0}}],"containers":[{"name":"rabbitmq","image":"rabbitmq:3.8.12-management","ports":[{"name":"epmd","containerPort":4369,"protocol":"TCP"},{"name":"amqp","containerPort":5672,"protocol":"TCP"},{"name":"management","containerPort":15672,"protocol":"TCP"},{"name":"prometheus","containerPort":15692,"protocol":"TCP"}],"env":[{"name":"MY_POD_NAME","valueFrom":{"fieldRef":{"apiVersion":"v1","fieldPath":"metadata.name"}}},{"name":"MY_POD_NAMESPACE","valueFrom":{"fieldRef":{"apiVersion":"v1","fieldPath":"metadata.namespace"}}},{"name":"RABBITMQ_ENABLED_PLUGINS_FILE","value":"/operator/enabled_plugins"},{"name":"K8S_SERVICE_NAME","value":"rabbitmq-cluster-nodes"},{"name":"RABBITMQ_USE_LONGNAME","value":"true"},{"name":"RABBITMQ_NODENAME","value":"rabbit@$(MY_POD_NAME).$(K8S_SERVICE_NAME).$(MY_POD_NAMESPACE)"},{"name":"K8S_HOSTNAME_SUFFIX","value":".$(K8S_SERVICE_NAME).$(MY_POD_NAMESPACE)"}],"resources":{"limits":{"cpu":"2","memory":"2Gi"},"requests":{"cpu":"1","memory":"2Gi"}},"volumeMounts":[{"name":"rabbitmq-erlang-cookie","mountPath":"/var/lib/rabbitmq/"},{"name":"persistence","mountPath":"/var/lib/rabbitmq/mnesia/"},{"name":"rabbitmq-plugins","mountPath":"/operator"},{"name":"rabbitmq-confd","mountPath":"/etc/rabbitmq/conf.d/10-operatorDefaults.conf","subPath":"operatorDefaults.conf"},{"name":"rabbitmq-confd","mountPath":"/etc/rabbitmq/conf.d/11-default_user.conf","subPath":"default_user.conf"},{"name":"rabbitmq-confd","mountPath":"/etc/rabbitmq/conf.d/90-userDefinedConfiguration.conf","subPath":"userDefinedConfiguration.conf"},{"name":"pod-info","mountPath":"/etc/pod-info/"}],"readinessProbe":{"tcpSocket":{"port":"amqp"},"initialDelaySeconds":10,"timeoutSeconds":5,"periodSeconds":10,"successThreshold":1,"failureThreshold":3},"lifecycle":{"preStop":{"exec":{"command":["/bin/bash","-c","if [ ! -z \"$(cat /etc/pod-info/skipPreStopChecks)\" ]; then exit 0; fi; rabbitmq-upgrade await_online_quorum_plus_one -t 604800; rabbitmq-upgrade await_online_synchronized_mirror -t 604800; rabbitmq-upgrade drain -t 604800"]}}},"terminationMessagePath":"/dev/termination-log","terminationMessagePolicy":"File","imagePullPolicy":"IfNotPresent"}],"restartPolicy":"Always","terminationGracePeriodSeconds":604800,"dnsPolicy":"ClusterFirst","serviceAccountName":"rabbitmq-cluster-server","serviceAccount":"rabbitmq-cluster-server","automountServiceAccountToken":true,"securityContext":{"runAsUser":999,"runAsGroup":999,"fsGroup":999},"schedulerName":"default-scheduler","topologySpreadConstraints":[{"maxSkew":1,"topologyKey":"topology.kubernetes.io/zone","whenUnsatisfiable":"ScheduleAnyway","labelSelector":{"matchLabels":{"app.kubernetes.io/name":"rabbitmq-cluster"}}}]}},"volumeClaimTemplates":[{"metadata":{"name":"persistence","namespace":"default","creationTimestamp":null,"labels":{"app.kubernetes.io/component":"rabbitmq","app.kubernetes.io/name":"rabbitmq-cluster","app.kubernetes.io/part-of":"rabbitmq"},"ownerReferences":[{"apiVersion":"rabbitmq.com/v1beta1","kind":"RabbitmqCluster","name":"rabbitmq-cluster","uid":"18d9928b-0d1c-47be-80ec-20960d053827","controller":true,"blockOwnerDeletion":false}]},"spec":{"accessModes":["ReadWriteOnce"],"resources":{"requests":{"storage":"10Gi"}},"volumeMode":"Filesystem"},"status":{"phase":"Pending"}}],"serviceName":"rabbitmq-cluster-nodes","podManagementPolicy":"Parallel","updateStrategy":{"type":"RollingUpdate","rollingUpdate":{"partition":0}},"revisionHistoryLimit":10},"status":{"observedGeneration":2,"replicas":3,"readyReplicas":3,"currentReplicas":3,"updatedReplicas":3,"currentRevision":"rabbitmq-cluster-server-5f8b8665fb","updateRevision":"rabbitmq-cluster-server-5f8b8665fb","collisionCount":0}}
2022/03/18 18:02:01 learn_server.go:238: [SIEVE-BEFORE-RECONCILE]	github.com/rabbitmq/cluster-operator/controllers.(*RabbitmqClusterReconciler)	16
2022/03/18 18:02:01 learn_server.go:289: [SIEVE-AFTER-HEAR]	28
2022/03/18 18:02:01 learn_server.go:291: [SIEVE-AFTER-READ]	Get	true	rabbitmqcluster	default	rabbitmq-cluster	github.com/rabbitmq/cluster-operator/controllers.(*RabbitmqClusterReconciler)	NoError	{"kind":"RabbitmqCluster","apiVersion":"rabbitmq.com/v1beta1","metadata":{"name":"rabbitmq-cluster","namespace":"default","selfLink":"/apis/rabbitmq.com/v1beta1/namespaces/default/rabbitmqclusters/rabbitmq-cluster","uid":"18d9928b-0d1c-47be-80ec-20960d053827","resourceVersion":"1215","generation":3,"creationTimestamp":"2022-03-18T18:00:38Z","annotations":{"kubectl.kubernetes.io/last-applied-configuration":"{\"apiVersion\":\"rabbitmq.com/v1beta1\",\"kind\":\"RabbitmqCluster\",\"metadata\":{\"annotations\":{},\"name\":\"rabbitmq-cluster\",\"namespace\":\"default\"},\"spec\":{\"persistence\":{\"storage\":\"10Gi\"},\"replicas\":1}}\n"},"finalizers":["deletion.finalizers.rabbitmqclusters.rabbitmq.com"],"managedFields":[{"manager":"kubectl-client-side-apply","operation":"Update","apiVersion":"rabbitmq.com/v1beta1","time":"2022-03-18T18:00:38Z","fieldsType":"FieldsV1","fieldsV1":{"f:metadata":{"f:annotations":{".":{},"f:kubectl.kubernetes.io/last-applied-configuration":{}}},"f:spec":{".":{},"f:image":{},"f:persistence":{".":{},"f:storage":{}},"f:resources":{".":{},"f:limits":{".":{},"f:memory":{}},"f:requests":{".":{},"f:memory":{}}},"f:service":{".":{},"f:type":{}},"f:terminationGracePeriodSeconds":{}}}},{"manager":"kubectl-patch","operation":"Update","apiVersion":"rabbitmq.com/v1beta1","time":"2022-03-18T18:01:23Z","fieldsType":"FieldsV1","fieldsV1":{"f:spec":{"f:replicas":{}}}},{"manager":"manager","operation":"Update","apiVersion":"rabbitmq.com/v1beta1","time":"2022-03-18T18:01:59Z","fieldsType":"FieldsV1","fieldsV1":{"f:metadata":{"f:finalizers":{}},"f:spec":{"f:override":{},"f:rabbitmq":{},"f:resources":{"f:limits":{"f:cpu":{}},"f:requests":{"f:cpu":{}}},"f:tls":{}},"f:status":{".":{},"f:conditions":{},"f:defaultUser":{".":{},"f:secretReference":{".":{},"f:keys":{".":{},"f:password":{},"f:username":{}},"f:name":{},"f:namespace":{}},"f:serviceReference":{".":{},"f:name":{},"f:namespace":{}}}}}}]},"spec":{"replicas":3,"image":"rabbitmq:3.8.12-management","service":{"type":"ClusterIP"},"persistence":{"storage":"10Gi"},"resources":{"limits":{"cpu":"2","memory":"2Gi"},"requests":{"cpu":"1","memory":"2Gi"}},"rabbitmq":{},"tls":{},"override":{},"terminationGracePeriodSeconds":604800},"status":{"conditions":[{"type":"AllReplicasReady","status":"False","lastTransitionTime":"2022-03-18T18:01:23Z","reason":"NotAllPodsReady","message":"2/3 Pods ready"},{"type":"ClusterAvailable","status":"True","lastTransitionTime":"2022-03-18T18:01:17Z","reason":"AtLeastOneEndpointAvailable"},{"type":"NoWarnings","status":"True","lastTransitionTime":"2022-03-18T18:00:38Z","reason":"NoWarnings"},{"type":"ReconcileSuccess","status":"True","lastTransitionTime":"2022-03-18T18:01:18Z","reason":"Success","message":"Finish reconciling"}],"defaultUser":{"secretReference":{"name":"rabbitmq-cluster-default-user","namespace":"default","keys":{"password":"password","username":"username"}},"serviceReference":{"name":"rabbitmq-cluster","namespace":"default"}}}}
2022/03/18 18:02:01 learn_server.go:291: [SIEVE-AFTER-READ]	Get	true	statefulset	default	rabbitmq-cluster-server	github.com/rabbitmq/cluster-operator/controllers.(*RabbitmqClusterReconciler)	NoError	{"kind":"StatefulSet","apiVersion":"apps/v1","metadata":{"name":"rabbitmq-cluster-server","namespace":"default","selfLink":"/apis/apps/v1/namespaces/default/statefulsets/rabbitmq-cluster-server","uid":"cb5c43bc-6ee7-481c-ab01-6f3acffdd3c8","resourceVersion":"1231","generation":2,"creationTimestamp":"2022-03-18T18:00:38Z","labels":{"app.kubernetes.io/component":"rabbitmq","app.kubernetes.io/name":"rabbitmq-cluster","app.kubernetes.io/part-of":"rabbitmq"},"ownerReferences":[{"apiVersion":"rabbitmq.com/v1beta1","kind":"RabbitmqCluster","name":"rabbitmq-cluster","uid":"18d9928b-0d1c-47be-80ec-20960d053827","controller":true,"blockOwnerDeletion":true}],"managedFields":[{"manager":"manager","operation":"Update","apiVersion":"apps/v1","time":"2022-03-18T18:01:23Z","fieldsType":"FieldsV1","fieldsV1":{"f:metadata":{"f:labels":{".":{},"f:app.kubernetes.io/component":{},"f:app.kubernetes.io/name":{},"f:app.kubernetes.io/part-of":{}},"f:ownerReferences":{".":{},"k:{\"uid\":\"18d9928b-0d1c-47be-80ec-20960d053827\"}":{".":{},"f:apiVersion":{},"f:blockOwnerDeletion":{},"f:controller":{},"f:kind":{},"f:name":{},"f:uid":{}}}},"f:spec":{"f:podManagementPolicy":{},"f:replicas":{},"f:revisionHistoryLimit":{},"f:selector":{"f:matchLabels":{".":{},"f:app.kubernetes.io/name":{}}},"f:serviceName":{},"f:template":{"f:metadata":{"f:annotations":{".":{},"f:prometheus.io/port":{},"f:prometheus.io/scrape":{}},"f:labels":{".":{},"f:app.kubernetes.io/component":{},"f:app.kubernetes.io/name":{},"f:app.kubernetes.io/part-of":{}}},"f:spec":{"f:automountServiceAccountToken":{},"f:containers":{"k:{\"name\":\"rabbitmq\"}":{".":{},"f:env":{".":{},"k:{\"name\":\"K8S_HOSTNAME_SUFFIX\"}":{".":{},"f:name":{},"f:value":{}},"k:{\"name\":\"K8S_SERVICE_NAME\"}":{".":{},"f:name":{},"f:value":{}},"k:{\"name\":\"MY_POD_NAME\"}":{".":{},"f:name":{},"f:valueFrom":{".":{},"f:fieldRef":{".":{},"f:apiVersion":{},"f:fieldPath":{}}}},"k:{\"name\":\"MY_POD_NAMESPACE\"}":{".":{},"f:name":{},"f:valueFrom":{".":{},"f:fieldRef":{".":{},"f:apiVersion":{},"f:fieldPath":{}}}},"k:{\"name\":\"RABBITMQ_ENABLED_PLUGINS_FILE\"}":{".":{},"f:name":{},"f:value":{}},"k:{\"name\":\"RABBITMQ_NODENAME\"}":{".":{},"f:name":{},"f:value":{}},"k:{\"name\":\"RABBITMQ_USE_LONGNAME\"}":{".":{},"f:name":{},"f:value":{}}},"f:image":{},"f:imagePullPolicy":{},"f:lifecycle":{".":{},"f:preStop":{".":{},"f:exec":{".":{},"f:command":{}}}},"f:name":{},"f:ports":{".":{},"k:{\"containerPort\":4369,\"protocol\":\"TCP\"}":{".":{},"f:containerPort":{},"f:name":{},"f:protocol":{}},"k:{\"containerPort\":5672,\"protocol\":\"TCP\"}":{".":{},"f:containerPort":{},"f:name":{},"f:protocol":{}},"k:{\"containerPort\":15672,\"protocol\":\"TCP\"}":{".":{},"f:containerPort":{},"f:name":{},"f:protocol":{}},"k:{\"containerPort\":15692,\"protocol\":\"TCP\"}":{".":{},"f:containerPort":{},"f:name":{},"f:protocol":{}}},"f:readinessProbe":{".":{},"f:failureThreshold":{},"f:initialDelaySeconds":{},"f:periodSeconds":{},"f:successThreshold":{},"f:tcpSocket":{".":{},"f:port":{}},"f:timeoutSeconds":{}},"f:resources":{".":{},"f:limits":{".":{},"f:cpu":{},"f:memory":{}},"f:requests":{".":{},"f:cpu":{},"f:memory":{}}},"f:terminationMessagePath":{},"f:terminationMessagePolicy":{},"f:volumeMounts":{".":{},"k:{\"mountPath\":\"/etc/pod-info/\"}":{".":{},"f:mountPath":{},"f:name":{}},"k:{\"mountPath\":\"/etc/rabbitmq/conf.d/10-operatorDefaults.conf\"}":{".":{},"f:mountPath":{},"f:name":{},"f:subPath":{}},"k:{\"mountPath\":\"/etc/rabbitmq/conf.d/11-default_user.conf\"}":{".":{},"f:mountPath":{},"f:name":{},"f:subPath":{}},"k:{\"mountPath\":\"/etc/rabbitmq/conf.d/90-userDefinedConfiguration.conf\"}":{".":{},"f:mountPath":{},"f:name":{},"f:subPath":{}},"k:{\"mountPath\":\"/operator\"}":{".":{},"f:mountPath":{},"f:name":{}},"k:{\"mountPath\":\"/var/lib/rabbitmq/\"}":{".":{},"f:mountPath":{},"f:name":{}},"k:{\"mountPath\":\"/var/lib/rabbitmq/mnesia/\"}":{".":{},"f:mountPath":{},"f:name":{}}}}},"f:dnsPolicy":{},"f:initContainers":{".":{},"k:{\"name\":\"setup-container\"}":{".":{},"f:command":{},"f:image":{},"f:imagePullPolicy":{},"f:name":{},"f:resources":{".":{},"f:limits":{".":{},"f:cpu":{},"f:memory":{}},"f:requests":{".":{},"f:cpu":{},"f:memory":{}}},"f:securityContext":{".":{},"f:capabilities":{".":{},"f:drop":{}},"f:runAsUser":{}},"f:terminationMessagePath":{},"f:terminationMessagePolicy":{},"f:volumeMounts":{".":{},"k:{\"mountPath\":\"/operator\"}":{".":{},"f:mountPath":{},"f:name":{}},"k:{\"mountPath\":\"/tmp/default_user.conf\"}":{".":{},"f:mountPath":{},"f:name":{},"f:subPath":{}},"k:{\"mountPath\":\"/tmp/erlang-cookie-secret/\"}":{".":{},"f:mountPath":{},"f:name":{}},"k:{\"mountPath\":\"/tmp/rabbitmq-plugins/\"}":{".":{},"f:mountPath":{},"f:name":{}},"k:{\"mountPath\":\"/var/lib/rabbitmq/\"}":{".":{},"f:mountPath":{},"f:name":{}},"k:{\"mountPath\":\"/var/lib/rabbitmq/mnesia/\"}":{".":{},"f:mountPath":{},"f:name":{}}}}},"f:restartPolicy":{},"f:schedulerName":{},"f:securityContext":{".":{},"f:fsGroup":{},"f:runAsGroup":{},"f:runAsUser":{}},"f:serviceAccount":{},"f:serviceAccountName":{},"f:terminationGracePeriodSeconds":{},"f:topologySpreadConstraints":{".":{},"k:{\"topologyKey\":\"topology.kubernetes.io/zone\",\"whenUnsatisfiable\":\"ScheduleAnyway\"}":{".":{},"f:labelSelector":{".":{},"f:matchLabels":{".":{},"f:app.kubernetes.io/name":{}}},"f:maxSkew":{},"f:topologyKey":{},"f:whenUnsatisfiable":{}}},"f:volumes":{".":{},"k:{\"name\":\"erlang-cookie-secret\"}":{".":{},"f:name":{},"f:secret":{".":{},"f:defaultMode":{},"f:secretName":{}}},"k:{\"name\":\"plugins-conf\"}":{".":{},"f:configMap":{".":{},"f:defaultMode":{},"f:name":{}},"f:name":{}},"k:{\"name\":\"pod-info\"}":{".":{},"f:downwardAPI":{".":{},"f:defaultMode":{},"f:items":{}},"f:name":{}},"k:{\"name\":\"rabbitmq-confd\"}":{".":{},"f:name":{},"f:projected":{".":{},"f:defaultMode":{},"f:sources":{}}},"k:{\"name\":\"rabbitmq-erlang-cookie\"}":{".":{},"f:emptyDir":{},"f:name":{}},"k:{\"name\":\"rabbitmq-plugins\"}":{".":{},"f:emptyDir":{},"f:name":{}}}}},"f:updateStrategy":{"f:rollingUpdate":{".":{},"f:partition":{}},"f:type":{}},"f:volumeClaimTemplates":{}}}},{"manager":"kube-controller-manager","operation":"Update","apiVersion":"apps/v1","time":"2022-03-18T18:02:01Z","fieldsType":"FieldsV1","fieldsV1":{"f:status":{"f:collisionCount":{},"f:currentReplicas":{},"f:currentRevision":{},"f:observedGeneration":{},"f:readyReplicas":{},"f:replicas":{},"f:updateRevision":{},"f:updatedReplicas":{}}}}]},"spec":{"replicas":3,"selector":{"matchLabels":{"app.kubernetes.io/name":"rabbitmq-cluster"}},"template":{"metadata":{"creationTimestamp":null,"labels":{"app.kubernetes.io/component":"rabbitmq","app.kubernetes.io/name":"rabbitmq-cluster","app.kubernetes.io/part-of":"rabbitmq"},"annotations":{"prometheus.io/port":"15692","prometheus.io/scrape":"true"}},"spec":{"volumes":[{"name":"plugins-conf","configMap":{"name":"rabbitmq-cluster-plugins-conf","defaultMode":420}},{"name":"rabbitmq-confd","projected":{"sources":[{"secret":{"name":"rabbitmq-cluster-default-user","items":[{"key":"default_user.conf","path":"default_user.conf"}]}},{"configMap":{"name":"rabbitmq-cluster-server-conf","items":[{"key":"operatorDefaults.conf","path":"operatorDefaults.conf"},{"key":"userDefinedConfiguration.conf","path":"userDefinedConfiguration.conf"}]}}],"defaultMode":420}},{"name":"rabbitmq-erlang-cookie","emptyDir":{}},{"name":"erlang-cookie-secret","secret":{"secretName":"rabbitmq-cluster-erlang-cookie","defaultMode":420}},{"name":"rabbitmq-plugins","emptyDir":{}},{"name":"pod-info","downwardAPI":{"items":[{"path":"skipPreStopChecks","fieldRef":{"apiVersion":"v1","fieldPath":"metadata.labels['skipPreStopChecks']"}}],"defaultMode":420}}],"initContainers":[{"name":"setup-container","image":"rabbitmq:3.8.12-management","command":["sh","-c","cp /tmp/erlang-cookie-secret/.erlang.cookie /var/lib/rabbitmq/.erlang.cookie \u0026\u0026 chown 999:999 /var/lib/rabbitmq/.erlang.cookie \u0026\u0026 chmod 600 /var/lib/rabbitmq/.erlang.cookie ; cp /tmp/rabbitmq-plugins/enabled_plugins /operator/enabled_plugins \u0026\u0026 chown 999:999 /operator/enabled_plugins ; chown 999:999 /var/lib/rabbitmq/mnesia/ ; echo '[default]' \u003e /var/lib/rabbitmq/.rabbitmqadmin.conf \u0026\u0026 sed -e 's/default_user/username/' -e 's/default_pass/password/' /tmp/default_user.conf \u003e\u003e /var/lib/rabbitmq/.rabbitmqadmin.conf \u0026\u0026 chown 999:999 /var/lib/rabbitmq/.rabbitmqadmin.conf \u0026\u0026 chmod 600 /var/lib/rabbitmq/.rabbitmqadmin.conf"],"resources":{"limits":{"cpu":"100m","memory":"500Mi"},"requests":{"cpu":"100m","memory":"500Mi"}},"volumeMounts":[{"name":"plugins-conf","mountPath":"/tmp/rabbitmq-plugins/"},{"name":"rabbitmq-erlang-cookie","mountPath":"/var/lib/rabbitmq/"},{"name":"erlang-cookie-secret","mountPath":"/tmp/erlang-cookie-secret/"},{"name":"rabbitmq-plugins","mountPath":"/operator"},{"name":"persistence","mountPath":"/var/lib/rabbitmq/mnesia/"},{"name":"rabbitmq-confd","mountPath":"/tmp/default_user.conf","subPath":"default_user.conf"}],"terminationMessagePath":"/dev/termination-log","terminationMessagePolicy":"File","imagePullPolicy":"IfNotPresent","securityContext":{"capabilities":{"drop":["FSETID","KILL","SETGID","SETUID","SETPCAP","NET_BIND_SERVICE","NET_RAW","SYS_CHROOT","MKNOD","AUDIT_WRITE","SETFCAP"]},"runAsUser":0}}],"containers":[{"name":"rabbitmq","image":"rabbitmq:3.8.12-management","ports":[{"name":"epmd","containerPort":4369,"protocol":"TCP"},{"name":"amqp","containerPort":5672,"protocol":"TCP"},{"name":"management","containerPort":15672,"protocol":"TCP"},{"name":"prometheus","containerPort":15692,"protocol":"TCP"}],"env":[{"name":"MY_POD_NAME","valueFrom":{"fieldRef":{"apiVersion":"v1","fieldPath":"metadata.name"}}},{"name":"MY_POD_NAMESPACE","valueFrom":{"fieldRef":{"apiVersion":"v1","fieldPath":"metadata.namespace"}}},{"name":"RABBITMQ_ENABLED_PLUGINS_FILE","value":"/operator/enabled_plugins"},{"name":"K8S_SERVICE_NAME","value":"rabbitmq-cluster-nodes"},{"name":"RABBITMQ_USE_LONGNAME","value":"true"},{"name":"RABBITMQ_NODENAME","value":"rabbit@$(MY_POD_NAME).$(K8S_SERVICE_NAME).$(MY_POD_NAMESPACE)"},{"name":"K8S_HOSTNAME_SUFFIX","value":".$(K8S_SERVICE_NAME).$(MY_POD_NAMESPACE)"}],"resources":{"limits":{"cpu":"2","memory":"2Gi"},"requests":{"cpu":"1","memory":"2Gi"}},"volumeMounts":[{"name":"rabbitmq-erlang-cookie","mountPath":"/var/lib/rabbitmq/"},{"name":"persistence","mountPath":"/var/lib/rabbitmq/mnesia/"},{"name":"rabbitmq-plugins","mountPath":"/operator"},{"name":"rabbitmq-confd","mountPath":"/etc/rabbitmq/conf.d/10-operatorDefaults.conf","subPath":"operatorDefaults.conf"},{"name":"rabbitmq-confd","mountPath":"/etc/rabbitmq/conf.d/11-default_user.conf","subPath":"default_user.conf"},{"name":"rabbitmq-confd","mountPath":"/etc/rabbitmq/conf.d/90-userDefinedConfiguration.conf","subPath":"userDefinedConfiguration.conf"},{"name":"pod-info","mountPath":"/etc/pod-info/"}],"readinessProbe":{"tcpSocket":{"port":"amqp"},"initialDelaySeconds":10,"timeoutSeconds":5,"periodSeconds":10,"successThreshold":1,"failureThreshold":3},"lifecycle":{"preStop":{"exec":{"command":["/bin/bash","-c","if [ ! -z \"$(cat /etc/pod-info/skipPreStopChecks)\" ]; then exit 0; fi; rabbitmq-upgrade await_online_quorum_plus_one -t 604800; rabbitmq-upgrade await_online_synchronized_mirror -t 604800; rabbitmq-upgrade drain -t 604800"]}}},"terminationMessagePath":"/dev/termination-log","terminationMessagePolicy":"File","imagePullPolicy":"IfNotPresent"}],"restartPolicy":"Always","terminationGracePeriodSeconds":604800,"dnsPolicy":"ClusterFirst","serviceAccountName":"rabbitmq-cluster-server","serviceAccount":"rabbitmq-cluster-server","automountServiceAccountToken":true,"securityContext":{"runAsUser":999,"runAsGroup":999,"fsGroup":999},"schedulerName":"default-scheduler","topologySpreadConstraints":[{"maxSkew":1,"topologyKey":"topology.kubernetes.io/zone","whenUnsatisfiable":"ScheduleAnyway","labelSelector":{"matchLabels":{"app.kubernetes.io/name":"rabbitmq-cluster"}}}]}},"volumeClaimTemplates":[{"metadata":{"name":"persistence","namespace":"default","creationTimestamp":null,"labels":{"app.kubernetes.io/component":"rabbitmq","app.kubernetes.io/name":"rabbitmq-cluster","app.kubernetes.io/part-of":"rabbitmq"},"ownerReferences":[{"apiVersion":"rabbitmq.com/v1beta1","kind":"RabbitmqCluster","name":"rabbitmq-cluster","uid":"18d9928b-0d1c-47be-80ec-20960d053827","controller":true,"blockOwnerDeletion":false}]},"spec":{"accessModes":["ReadWriteOnce"],"resources":{"requests":{"storage":"10Gi"}},"volumeMode":"Filesystem"},"status":{"phase":"Pending"}}],"serviceName":"rabbitmq-cluster-nodes","podManagementPolicy":"Parallel","updateStrategy":{"type":"RollingUpdate","rollingUpdate":{"partition":0}},"revisionHistoryLimit":10},"status":{"observedGeneration":2,"replicas":3,"readyReplicas":3,"currentReplicas":3,"updatedReplicas":3,"currentRevision":"rabbitmq-cluster-server-5f8b8665fb","updateRevision":"rabbitmq-cluster-server-5f8b8665fb","collisionCount":0}}
2022/03/18 18:02:01 learn_server.go:291: [SIEVE-AFTER-READ]	Get	true	endpoints	default	rabbitmq-cluster	github.com/rabbitmq/cluster-operator/controllers.(*RabbitmqClusterReconciler)	NoError	{"kind":"Endpoints","apiVersion":"v1","metadata":{"name":"rabbitmq-cluster","namespace":"default","selfLink":"/api/v1/namespaces/default/endpoints/rabbitmq-cluster","uid":"5c4723ad-f4fe-442d-9135-44879a2a8183","resourceVersion":"1227","creationTimestamp":"2022-03-18T18:00:38Z","labels":{"app.kubernetes.io/component":"rabbitmq","app.kubernetes.io/name":"rabbitmq-cluster","app.kubernetes.io/part-of":"rabbitmq"},"annotations":{"endpoints.kubernetes.io/last-change-trigger-time":"2022-03-18T18:02:01Z"},"managedFields":[{"manager":"kube-controller-manager","operation":"Update","apiVersion":"v1","time":"2022-03-18T18:02:01Z","fieldsType":"FieldsV1","fieldsV1":{"f:metadata":{"f:annotations":{".":{},"f:endpoints.kubernetes.io/last-change-trigger-time":{}},"f:labels":{".":{},"f:app.kubernetes.io/component":{},"f:app.kubernetes.io/name":{},"f:app.kubernetes.io/part-of":{}}},"f:subsets":{}}}]},"subsets":[{"addresses":[{"ip":"10.244.1.4","nodeName":"kind-worker2","targetRef":{"kind":"Pod","namespace":"default","name":"rabbitmq-cluster-server-0","uid":"e7faffc5-b656-4e69-9777-92d12cb6ec5a","resourceVersion":"938"}},{"ip":"10.244.2.4","nodeName":"kind-worker","targetRef":{"kind":"Pod","namespace":"default","name":"rabbitmq-cluster-server-1","uid":"7a37da00-25d1-48b6-a659-4390fb7a02cb","resourceVersion":"1226"}},{"ip":"10.244.2.5","nodeName":"kind-worker","targetRef":{"kind":"Pod","namespace":"default","name":"rabbitmq-cluster-server-2","uid":"2a54a659-a979-4e10-8e74-1e0b83d532ba","resourceVersion":"1209"}}],"ports":[{"name":"amqp","port":5672,"protocol":"TCP"},{"name":"management","port":15672,"protocol":"TCP"}]}]}
2022/03/18 18:02:01 learn_server.go:256: [SIEVE-BEFORE-WRITE]	54
2022/03/18 18:02:01 learn_server.go:279: [SIEVE-BEFORE-HEAR]	29	Updated	rabbitmqcluster	{"metadata":{"name":"rabbitmq-cluster","namespace":"default","selfLink":"/apis/rabbitmq.com/v1beta1/namespaces/default/rabbitmqclusters/rabbitmq-cluster","uid":"18d9928b-0d1c-47be-80ec-20960d053827","resourceVersion":"1232","generation":3,"creationTimestamp":"2022-03-18T18:00:38Z","annotations":{"kubectl.kubernetes.io/last-applied-configuration":"{\"apiVersion\":\"rabbitmq.com/v1beta1\",\"kind\":\"RabbitmqCluster\",\"metadata\":{\"annotations\":{},\"name\":\"rabbitmq-cluster\",\"namespace\":\"default\"},\"spec\":{\"persistence\":{\"storage\":\"10Gi\"},\"replicas\":1}}\n"},"finalizers":["deletion.finalizers.rabbitmqclusters.rabbitmq.com"],"managedFields":[{"manager":"kubectl-client-side-apply","operation":"Update","apiVersion":"rabbitmq.com/v1beta1","time":"2022-03-18T18:00:38Z","fieldsType":"FieldsV1","fieldsV1":{"f:metadata":{"f:annotations":{".":{},"f:kubectl.kubernetes.io/last-applied-configuration":{}}},"f:spec":{".":{},"f:image":{},"f:persistence":{".":{},"f:storage":{}},"f:resources":{".":{},"f:limits":{".":{},"f:memory":{}},"f:requests":{".":{},"f:memory":{}}},"f:service":{".":{},"f:type":{}},"f:terminationGracePeriodSeconds":{}}}},{"manager":"kubectl-patch","operation":"Update","apiVersion":"rabbitmq.com/v1beta1","time":"2022-03-18T18:01:23Z","fieldsType":"FieldsV1","fieldsV1":{"f:spec":{"f:replicas":{}}}},{"manager":"manager","operation":"Update","apiVersion":"rabbitmq.com/v1beta1","time":"2022-03-18T18:02:01Z","fieldsType":"FieldsV1","fieldsV1":{"f:metadata":{"f:finalizers":{}},"f:spec":{"f:override":{},"f:rabbitmq":{},"f:resources":{"f:limits":{"f:cpu":{}},"f:requests":{"f:cpu":{}}},"f:tls":{}},"f:status":{".":{},"f:conditions":{},"f:defaultUser":{".":{},"f:secretReference":{".":{},"f:keys":{".":{},"f:password":{},"f:username":{}},"f:name":{},"f:namespace":{}},"f:serviceReference":{".":{},"f:name":{},"f:namespace":{}}}}}}]},"spec":{"replicas":3,"image":"rabbitmq:3.8.12-management","service":{"type":"ClusterIP"},"persistence":{"storage":"10Gi"},"resources":{"limits":{"cpu":"2","memory":"2Gi"},"requests":{"cpu":"1","memory":"2Gi"}},"rabbitmq":{},"tls":{},"override":{},"terminationGracePeriodSeconds":604800},"status":{"conditions":[{"type":"AllReplicasReady","status":"True","lastTransitionTime":"2022-03-18T18:02:01Z","reason":"AllPodsAreReady"},{"type":"ClusterAvailable","status":"True","lastTransitionTime":"2022-03-18T18:01:17Z","reason":"AtLeastOneEndpointAvailable"},{"type":"NoWarnings","status":"True","lastTransitionTime":"2022-03-18T18:00:38Z","reason":"NoWarnings"},{"type":"ReconcileSuccess","status":"True","lastTransitionTime":"2022-03-18T18:01:18Z","reason":"Success","message":"Finish reconciling"}],"defaultUser":{"secretReference":{"name":"rabbitmq-cluster-default-user","namespace":"default","keys":{"password":"password","username":"username"}},"serviceReference":{"name":"rabbitmq-cluster","namespace":"default"}}}}
2022/03/18 18:02:01 learn_server.go:289: [SIEVE-AFTER-HEAR]	29
2022/03/18 18:02:01 learn_server.go:263: [SIEVE-AFTER-WRITE]	54	StatusUpdate	rabbitmqcluster	github.com/rabbitmq/cluster-operator/controllers.(*RabbitmqClusterReconciler)	NoError	{"metadata":{"name":"rabbitmq-cluster","namespace":"default","selfLink":"/apis/rabbitmq.com/v1beta1/namespaces/default/rabbitmqclusters/rabbitmq-cluster/status","uid":"18d9928b-0d1c-47be-80ec-20960d053827","resourceVersion":"1232","generation":3,"creationTimestamp":"2022-03-18T18:00:38Z","annotations":{"kubectl.kubernetes.io/last-applied-configuration":"{\"apiVersion\":\"rabbitmq.com/v1beta1\",\"kind\":\"RabbitmqCluster\",\"metadata\":{\"annotations\":{},\"name\":\"rabbitmq-cluster\",\"namespace\":\"default\"},\"spec\":{\"persistence\":{\"storage\":\"10Gi\"},\"replicas\":1}}\n"},"finalizers":["deletion.finalizers.rabbitmqclusters.rabbitmq.com"],"managedFields":[{"manager":"kubectl-client-side-apply","operation":"Update","apiVersion":"rabbitmq.com/v1beta1","time":"2022-03-18T18:00:38Z","fieldsType":"FieldsV1","fieldsV1":{"f:metadata":{"f:annotations":{".":{},"f:kubectl.kubernetes.io/last-applied-configuration":{}}},"f:spec":{".":{},"f:image":{},"f:persistence":{".":{},"f:storage":{}},"f:resources":{".":{},"f:limits":{".":{},"f:memory":{}},"f:requests":{".":{},"f:memory":{}}},"f:service":{".":{},"f:type":{}},"f:terminationGracePeriodSeconds":{}}}},{"manager":"kubectl-patch","operation":"Update","apiVersion":"rabbitmq.com/v1beta1","time":"2022-03-18T18:01:23Z","fieldsType":"FieldsV1","fieldsV1":{"f:spec":{"f:replicas":{}}}},{"manager":"manager","operation":"Update","apiVersion":"rabbitmq.com/v1beta1","time":"2022-03-18T18:02:01Z","fieldsType":"FieldsV1","fieldsV1":{"f:metadata":{"f:finalizers":{}},"f:spec":{"f:override":{},"f:rabbitmq":{},"f:resources":{"f:limits":{"f:cpu":{}},"f:requests":{"f:cpu":{}}},"f:tls":{}},"f:status":{".":{},"f:conditions":{},"f:defaultUser":{".":{},"f:secretReference":{".":{},"f:keys":{".":{},"f:password":{},"f:username":{}},"f:name":{},"f:namespace":{}},"f:serviceReference":{".":{},"f:name":{},"f:namespace":{}}}}}}]},"spec":{"replicas":3,"image":"rabbitmq:3.8.12-management","service":{"type":"ClusterIP"},"persistence":{"storage":"10Gi"},"resources":{"limits":{"cpu":"2","memory":"2Gi"},"requests":{"cpu":"1","memory":"2Gi"}},"rabbitmq":{},"tls":{},"override":{},"terminationGracePeriodSeconds":604800},"status":{"conditions":[{"type":"AllReplicasReady","status":"True","lastTransitionTime":"2022-03-18T18:02:01Z","reason":"AllPodsAreReady"},{"type":"ClusterAvailable","status":"True","lastTransitionTime":"2022-03-18T18:01:17Z","reason":"AtLeastOneEndpointAvailable"},{"type":"NoWarnings","status":"True","lastTransitionTime":"2022-03-18T18:00:38Z","reason":"NoWarnings"},{"type":"ReconcileSuccess","status":"True","lastTransitionTime":"2022-03-18T18:01:18Z","reason":"Success","message":"Finish reconciling"}],"defaultUser":{"secretReference":{"name":"rabbitmq-cluster-default-user","namespace":"default","keys":{"password":"password","username":"username"}},"serviceReference":{"name":"rabbitmq-cluster","namespace":"default"}}}}
2022/03/18 18:02:01 learn_server.go:291: [SIEVE-AFTER-READ]	Get	true	statefulset	default	rabbitmq-cluster-server	github.com/rabbitmq/cluster-operator/controllers.(*RabbitmqClusterReconciler)	NoError	{"kind":"StatefulSet","apiVersion":"apps/v1","metadata":{"name":"rabbitmq-cluster-server","namespace":"default","selfLink":"/apis/apps/v1/namespaces/default/statefulsets/rabbitmq-cluster-server","uid":"cb5c43bc-6ee7-481c-ab01-6f3acffdd3c8","resourceVersion":"1231","generation":2,"creationTimestamp":"2022-03-18T18:00:38Z","labels":{"app.kubernetes.io/component":"rabbitmq","app.kubernetes.io/name":"rabbitmq-cluster","app.kubernetes.io/part-of":"rabbitmq"},"ownerReferences":[{"apiVersion":"rabbitmq.com/v1beta1","kind":"RabbitmqCluster","name":"rabbitmq-cluster","uid":"18d9928b-0d1c-47be-80ec-20960d053827","controller":true,"blockOwnerDeletion":true}],"managedFields":[{"manager":"manager","operation":"Update","apiVersion":"apps/v1","time":"2022-03-18T18:01:23Z","fieldsType":"FieldsV1","fieldsV1":{"f:metadata":{"f:labels":{".":{},"f:app.kubernetes.io/component":{},"f:app.kubernetes.io/name":{},"f:app.kubernetes.io/part-of":{}},"f:ownerReferences":{".":{},"k:{\"uid\":\"18d9928b-0d1c-47be-80ec-20960d053827\"}":{".":{},"f:apiVersion":{},"f:blockOwnerDeletion":{},"f:controller":{},"f:kind":{},"f:name":{},"f:uid":{}}}},"f:spec":{"f:podManagementPolicy":{},"f:replicas":{},"f:revisionHistoryLimit":{},"f:selector":{"f:matchLabels":{".":{},"f:app.kubernetes.io/name":{}}},"f:serviceName":{},"f:template":{"f:metadata":{"f:annotations":{".":{},"f:prometheus.io/port":{},"f:prometheus.io/scrape":{}},"f:labels":{".":{},"f:app.kubernetes.io/component":{},"f:app.kubernetes.io/name":{},"f:app.kubernetes.io/part-of":{}}},"f:spec":{"f:automountServiceAccountToken":{},"f:containers":{"k:{\"name\":\"rabbitmq\"}":{".":{},"f:env":{".":{},"k:{\"name\":\"K8S_HOSTNAME_SUFFIX\"}":{".":{},"f:name":{},"f:value":{}},"k:{\"name\":\"K8S_SERVICE_NAME\"}":{".":{},"f:name":{},"f:value":{}},"k:{\"name\":\"MY_POD_NAME\"}":{".":{},"f:name":{},"f:valueFrom":{".":{},"f:fieldRef":{".":{},"f:apiVersion":{},"f:fieldPath":{}}}},"k:{\"name\":\"MY_POD_NAMESPACE\"}":{".":{},"f:name":{},"f:valueFrom":{".":{},"f:fieldRef":{".":{},"f:apiVersion":{},"f:fieldPath":{}}}},"k:{\"name\":\"RABBITMQ_ENABLED_PLUGINS_FILE\"}":{".":{},"f:name":{},"f:value":{}},"k:{\"name\":\"RABBITMQ_NODENAME\"}":{".":{},"f:name":{},"f:value":{}},"k:{\"name\":\"RABBITMQ_USE_LONGNAME\"}":{".":{},"f:name":{},"f:value":{}}},"f:image":{},"f:imagePullPolicy":{},"f:lifecycle":{".":{},"f:preStop":{".":{},"f:exec":{".":{},"f:command":{}}}},"f:name":{},"f:ports":{".":{},"k:{\"containerPort\":4369,\"protocol\":\"TCP\"}":{".":{},"f:containerPort":{},"f:name":{},"f:protocol":{}},"k:{\"containerPort\":5672,\"protocol\":\"TCP\"}":{".":{},"f:containerPort":{},"f:name":{},"f:protocol":{}},"k:{\"containerPort\":15672,\"protocol\":\"TCP\"}":{".":{},"f:containerPort":{},"f:name":{},"f:protocol":{}},"k:{\"containerPort\":15692,\"protocol\":\"TCP\"}":{".":{},"f:containerPort":{},"f:name":{},"f:protocol":{}}},"f:readinessProbe":{".":{},"f:failureThreshold":{},"f:initialDelaySeconds":{},"f:periodSeconds":{},"f:successThreshold":{},"f:tcpSocket":{".":{},"f:port":{}},"f:timeoutSeconds":{}},"f:resources":{".":{},"f:limits":{".":{},"f:cpu":{},"f:memory":{}},"f:requests":{".":{},"f:cpu":{},"f:memory":{}}},"f:terminationMessagePath":{},"f:terminationMessagePolicy":{},"f:volumeMounts":{".":{},"k:{\"mountPath\":\"/etc/pod-info/\"}":{".":{},"f:mountPath":{},"f:name":{}},"k:{\"mountPath\":\"/etc/rabbitmq/conf.d/10-operatorDefaults.conf\"}":{".":{},"f:mountPath":{},"f:name":{},"f:subPath":{}},"k:{\"mountPath\":\"/etc/rabbitmq/conf.d/11-default_user.conf\"}":{".":{},"f:mountPath":{},"f:name":{},"f:subPath":{}},"k:{\"mountPath\":\"/etc/rabbitmq/conf.d/90-userDefinedConfiguration.conf\"}":{".":{},"f:mountPath":{},"f:name":{},"f:subPath":{}},"k:{\"mountPath\":\"/operator\"}":{".":{},"f:mountPath":{},"f:name":{}},"k:{\"mountPath\":\"/var/lib/rabbitmq/\"}":{".":{},"f:mountPath":{},"f:name":{}},"k:{\"mountPath\":\"/var/lib/rabbitmq/mnesia/\"}":{".":{},"f:mountPath":{},"f:name":{}}}}},"f:dnsPolicy":{},"f:initContainers":{".":{},"k:{\"name\":\"setup-container\"}":{".":{},"f:command":{},"f:image":{},"f:imagePullPolicy":{},"f:name":{},"f:resources":{".":{},"f:limits":{".":{},"f:cpu":{},"f:memory":{}},"f:requests":{".":{},"f:cpu":{},"f:memory":{}}},"f:securityContext":{".":{},"f:capabilities":{".":{},"f:drop":{}},"f:runAsUser":{}},"f:terminationMessagePath":{},"f:terminationMessagePolicy":{},"f:volumeMounts":{".":{},"k:{\"mountPath\":\"/operator\"}":{".":{},"f:mountPath":{},"f:name":{}},"k:{\"mountPath\":\"/tmp/default_user.conf\"}":{".":{},"f:mountPath":{},"f:name":{},"f:subPath":{}},"k:{\"mountPath\":\"/tmp/erlang-cookie-secret/\"}":{".":{},"f:mountPath":{},"f:name":{}},"k:{\"mountPath\":\"/tmp/rabbitmq-plugins/\"}":{".":{},"f:mountPath":{},"f:name":{}},"k:{\"mountPath\":\"/var/lib/rabbitmq/\"}":{".":{},"f:mountPath":{},"f:name":{}},"k:{\"mountPath\":\"/var/lib/rabbitmq/mnesia/\"}":{".":{},"f:mountPath":{},"f:name":{}}}}},"f:restartPolicy":{},"f:schedulerName":{},"f:securityContext":{".":{},"f:fsGroup":{},"f:runAsGroup":{},"f:runAsUser":{}},"f:serviceAccount":{},"f:serviceAccountName":{},"f:terminationGracePeriodSeconds":{},"f:topologySpreadConstraints":{".":{},"k:{\"topologyKey\":\"topology.kubernetes.io/zone\",\"whenUnsatisfiable\":\"ScheduleAnyway\"}":{".":{},"f:labelSelector":{".":{},"f:matchLabels":{".":{},"f:app.kubernetes.io/name":{}}},"f:maxSkew":{},"f:topologyKey":{},"f:whenUnsatisfiable":{}}},"f:volumes":{".":{},"k:{\"name\":\"erlang-cookie-secret\"}":{".":{},"f:name":{},"f:secret":{".":{},"f:defaultMode":{},"f:secretName":{}}},"k:{\"name\":\"plugins-conf\"}":{".":{},"f:configMap":{".":{},"f:defaultMode":{},"f:name":{}},"f:name":{}},"k:{\"name\":\"pod-info\"}":{".":{},"f:downwardAPI":{".":{},"f:defaultMode":{},"f:items":{}},"f:name":{}},"k:{\"name\":\"rabbitmq-confd\"}":{".":{},"f:name":{},"f:projected":{".":{},"f:defaultMode":{},"f:sources":{}}},"k:{\"name\":\"rabbitmq-erlang-cookie\"}":{".":{},"f:emptyDir":{},"f:name":{}},"k:{\"name\":\"rabbitmq-plugins\"}":{".":{},"f:emptyDir":{},"f:name":{}}}}},"f:updateStrategy":{"f:rollingUpdate":{".":{},"f:partition":{}},"f:type":{}},"f:volumeClaimTemplates":{}}}},{"manager":"kube-controller-manager","operation":"Update","apiVersion":"apps/v1","time":"2022-03-18T18:02:01Z","fieldsType":"FieldsV1","fieldsV1":{"f:status":{"f:collisionCount":{},"f:currentReplicas":{},"f:currentRevision":{},"f:observedGeneration":{},"f:readyReplicas":{},"f:replicas":{},"f:updateRevision":{},"f:updatedReplicas":{}}}}]},"spec":{"replicas":3,"selector":{"matchLabels":{"app.kubernetes.io/name":"rabbitmq-cluster"}},"template":{"metadata":{"creationTimestamp":null,"labels":{"app.kubernetes.io/component":"rabbitmq","app.kubernetes.io/name":"rabbitmq-cluster","app.kubernetes.io/part-of":"rabbitmq"},"annotations":{"prometheus.io/port":"15692","prometheus.io/scrape":"true"}},"spec":{"volumes":[{"name":"plugins-conf","configMap":{"name":"rabbitmq-cluster-plugins-conf","defaultMode":420}},{"name":"rabbitmq-confd","projected":{"sources":[{"secret":{"name":"rabbitmq-cluster-default-user","items":[{"key":"default_user.conf","path":"default_user.conf"}]}},{"configMap":{"name":"rabbitmq-cluster-server-conf","items":[{"key":"operatorDefaults.conf","path":"operatorDefaults.conf"},{"key":"userDefinedConfiguration.conf","path":"userDefinedConfiguration.conf"}]}}],"defaultMode":420}},{"name":"rabbitmq-erlang-cookie","emptyDir":{}},{"name":"erlang-cookie-secret","secret":{"secretName":"rabbitmq-cluster-erlang-cookie","defaultMode":420}},{"name":"rabbitmq-plugins","emptyDir":{}},{"name":"pod-info","downwardAPI":{"items":[{"path":"skipPreStopChecks","fieldRef":{"apiVersion":"v1","fieldPath":"metadata.labels['skipPreStopChecks']"}}],"defaultMode":420}}],"initContainers":[{"name":"setup-container","image":"rabbitmq:3.8.12-management","command":["sh","-c","cp /tmp/erlang-cookie-secret/.erlang.cookie /var/lib/rabbitmq/.erlang.cookie \u0026\u0026 chown 999:999 /var/lib/rabbitmq/.erlang.cookie \u0026\u0026 chmod 600 /var/lib/rabbitmq/.erlang.cookie ; cp /tmp/rabbitmq-plugins/enabled_plugins /operator/enabled_plugins \u0026\u0026 chown 999:999 /operator/enabled_plugins ; chown 999:999 /var/lib/rabbitmq/mnesia/ ; echo '[default]' \u003e /var/lib/rabbitmq/.rabbitmqadmin.conf \u0026\u0026 sed -e 's/default_user/username/' -e 's/default_pass/password/' /tmp/default_user.conf \u003e\u003e /var/lib/rabbitmq/.rabbitmqadmin.conf \u0026\u0026 chown 999:999 /var/lib/rabbitmq/.rabbitmqadmin.conf \u0026\u0026 chmod 600 /var/lib/rabbitmq/.rabbitmqadmin.conf"],"resources":{"limits":{"cpu":"100m","memory":"500Mi"},"requests":{"cpu":"100m","memory":"500Mi"}},"volumeMounts":[{"name":"plugins-conf","mountPath":"/tmp/rabbitmq-plugins/"},{"name":"rabbitmq-erlang-cookie","mountPath":"/var/lib/rabbitmq/"},{"name":"erlang-cookie-secret","mountPath":"/tmp/erlang-cookie-secret/"},{"name":"rabbitmq-plugins","mountPath":"/operator"},{"name":"persistence","mountPath":"/var/lib/rabbitmq/mnesia/"},{"name":"rabbitmq-confd","mountPath":"/tmp/default_user.conf","subPath":"default_user.conf"}],"terminationMessagePath":"/dev/termination-log","terminationMessagePolicy":"File","imagePullPolicy":"IfNotPresent","securityContext":{"capabilities":{"drop":["FSETID","KILL","SETGID","SETUID","SETPCAP","NET_BIND_SERVICE","NET_RAW","SYS_CHROOT","MKNOD","AUDIT_WRITE","SETFCAP"]},"runAsUser":0}}],"containers":[{"name":"rabbitmq","image":"rabbitmq:3.8.12-management","ports":[{"name":"epmd","containerPort":4369,"protocol":"TCP"},{"name":"amqp","containerPort":5672,"protocol":"TCP"},{"name":"management","containerPort":15672,"protocol":"TCP"},{"name":"prometheus","containerPort":15692,"protocol":"TCP"}],"env":[{"name":"MY_POD_NAME","valueFrom":{"fieldRef":{"apiVersion":"v1","fieldPath":"metadata.name"}}},{"name":"MY_POD_NAMESPACE","valueFrom":{"fieldRef":{"apiVersion":"v1","fieldPath":"metadata.namespace"}}},{"name":"RABBITMQ_ENABLED_PLUGINS_FILE","value":"/operator/enabled_plugins"},{"name":"K8S_SERVICE_NAME","value":"rabbitmq-cluster-nodes"},{"name":"RABBITMQ_USE_LONGNAME","value":"true"},{"name":"RABBITMQ_NODENAME","value":"rabbit@$(MY_POD_NAME).$(K8S_SERVICE_NAME).$(MY_POD_NAMESPACE)"},{"name":"K8S_HOSTNAME_SUFFIX","value":".$(K8S_SERVICE_NAME).$(MY_POD_NAMESPACE)"}],"resources":{"limits":{"cpu":"2","memory":"2Gi"},"requests":{"cpu":"1","memory":"2Gi"}},"volumeMounts":[{"name":"rabbitmq-erlang-cookie","mountPath":"/var/lib/rabbitmq/"},{"name":"persistence","mountPath":"/var/lib/rabbitmq/mnesia/"},{"name":"rabbitmq-plugins","mountPath":"/operator"},{"name":"rabbitmq-confd","mountPath":"/etc/rabbitmq/conf.d/10-operatorDefaults.conf","subPath":"operatorDefaults.conf"},{"name":"rabbitmq-confd","mountPath":"/etc/rabbitmq/conf.d/11-default_user.conf","subPath":"default_user.conf"},{"name":"rabbitmq-confd","mountPath":"/etc/rabbitmq/conf.d/90-userDefinedConfiguration.conf","subPath":"userDefinedConfiguration.conf"},{"name":"pod-info","mountPath":"/etc/pod-info/"}],"readinessProbe":{"tcpSocket":{"port":"amqp"},"initialDelaySeconds":10,"timeoutSeconds":5,"periodSeconds":10,"successThreshold":1,"failureThreshold":3},"lifecycle":{"preStop":{"exec":{"command":["/bin/bash","-c","if [ ! -z \"$(cat /etc/pod-info/skipPreStopChecks)\" ]; then exit 0; fi; rabbitmq-upgrade await_online_quorum_plus_one -t 604800; rabbitmq-upgrade await_online_synchronized_mirror -t 604800; rabbitmq-upgrade drain -t 604800"]}}},"terminationMessagePath":"/dev/termination-log","terminationMessagePolicy":"File","imagePullPolicy":"IfNotPresent"}],"restartPolicy":"Always","terminationGracePeriodSeconds":604800,"dnsPolicy":"ClusterFirst","serviceAccountName":"rabbitmq-cluster-server","serviceAccount":"rabbitmq-cluster-server","automountServiceAccountToken":true,"securityContext":{"runAsUser":999,"runAsGroup":999,"fsGroup":999},"schedulerName":"default-scheduler","topologySpreadConstraints":[{"maxSkew":1,"topologyKey":"topology.kubernetes.io/zone","whenUnsatisfiable":"ScheduleAnyway","labelSelector":{"matchLabels":{"app.kubernetes.io/name":"rabbitmq-cluster"}}}]}},"volumeClaimTemplates":[{"metadata":{"name":"persistence","namespace":"default","creationTimestamp":null,"labels":{"app.kubernetes.io/component":"rabbitmq","app.kubernetes.io/name":"rabbitmq-cluster","app.kubernetes.io/part-of":"rabbitmq"},"ownerReferences":[{"apiVersion":"rabbitmq.com/v1beta1","kind":"RabbitmqCluster","name":"rabbitmq-cluster","uid":"18d9928b-0d1c-47be-80ec-20960d053827","controller":true,"blockOwnerDeletion":false}]},"spec":{"accessModes":["ReadWriteOnce"],"resources":{"requests":{"storage":"10Gi"}},"volumeMode":"Filesystem"},"status":{"phase":"Pending"}}],"serviceName":"rabbitmq-cluster-nodes","podManagementPolicy":"Parallel","updateStrategy":{"type":"RollingUpdate","rollingUpdate":{"partition":0}},"revisionHistoryLimit":10},"status":{"observedGeneration":2,"replicas":3,"readyReplicas":3,"currentReplicas":3,"updatedReplicas":3,"currentRevision":"rabbitmq-cluster-server-5f8b8665fb","updateRevision":"rabbitmq-cluster-server-5f8b8665fb","collisionCount":0}}
2022/03/18 18:02:01 learn_server.go:291: [SIEVE-AFTER-READ]	Get	true	service	default	rabbitmq-cluster-nodes	github.com/rabbitmq/cluster-operator/controllers.(*RabbitmqClusterReconciler)	NoError	{"kind":"Service","apiVersion":"v1","metadata":{"name":"rabbitmq-cluster-nodes","namespace":"default","selfLink":"/api/v1/namespaces/default/services/rabbitmq-cluster-nodes","uid":"67c7eea9-1b87-4fd7-82e6-5bfe31fd1b52","resourceVersion":"696","creationTimestamp":"2022-03-18T18:00:38Z","labels":{"app.kubernetes.io/component":"rabbitmq","app.kubernetes.io/name":"rabbitmq-cluster","app.kubernetes.io/part-of":"rabbitmq"},"ownerReferences":[{"apiVersion":"rabbitmq.com/v1beta1","kind":"RabbitmqCluster","name":"rabbitmq-cluster","uid":"18d9928b-0d1c-47be-80ec-20960d053827","controller":true,"blockOwnerDeletion":true}],"managedFields":[{"manager":"manager","operation":"Update","apiVersion":"v1","time":"2022-03-18T18:00:38Z","fieldsType":"FieldsV1","fieldsV1":{"f:metadata":{"f:labels":{".":{},"f:app.kubernetes.io/component":{},"f:app.kubernetes.io/name":{},"f:app.kubernetes.io/part-of":{}},"f:ownerReferences":{".":{},"k:{\"uid\":\"18d9928b-0d1c-47be-80ec-20960d053827\"}":{".":{},"f:apiVersion":{},"f:blockOwnerDeletion":{},"f:controller":{},"f:kind":{},"f:name":{},"f:uid":{}}}},"f:spec":{"f:clusterIP":{},"f:ports":{".":{},"k:{\"port\":4369,\"protocol\":\"TCP\"}":{".":{},"f:name":{},"f:port":{},"f:protocol":{},"f:targetPort":{}},"k:{\"port\":25672,\"protocol\":\"TCP\"}":{".":{},"f:name":{},"f:port":{},"f:protocol":{},"f:targetPort":{}}},"f:publishNotReadyAddresses":{},"f:selector":{".":{},"f:app.kubernetes.io/name":{}},"f:sessionAffinity":{},"f:type":{}}}}]},"spec":{"ports":[{"name":"epmd","protocol":"TCP","port":4369,"targetPort":4369},{"name":"cluster-rpc","protocol":"TCP","port":25672,"targetPort":25672}],"selector":{"app.kubernetes.io/name":"rabbitmq-cluster"},"clusterIP":"None","type":"ClusterIP","sessionAffinity":"None","publishNotReadyAddresses":true},"status":{"loadBalancer":{}}}
2022/03/18 18:02:01 learn_server.go:291: [SIEVE-AFTER-READ]	Get	true	service	default	rabbitmq-cluster	github.com/rabbitmq/cluster-operator/controllers.(*RabbitmqClusterReconciler)	NoError	{"kind":"Service","apiVersion":"v1","metadata":{"name":"rabbitmq-cluster","namespace":"default","selfLink":"/api/v1/namespaces/default/services/rabbitmq-cluster","uid":"56b50671-1945-458b-adac-05619b783392","resourceVersion":"701","creationTimestamp":"2022-03-18T18:00:38Z","labels":{"app.kubernetes.io/component":"rabbitmq","app.kubernetes.io/name":"rabbitmq-cluster","app.kubernetes.io/part-of":"rabbitmq"},"ownerReferences":[{"apiVersion":"rabbitmq.com/v1beta1","kind":"RabbitmqCluster","name":"rabbitmq-cluster","uid":"18d9928b-0d1c-47be-80ec-20960d053827","controller":true,"blockOwnerDeletion":true}],"managedFields":[{"manager":"manager","operation":"Update","apiVersion":"v1","time":"2022-03-18T18:00:38Z","fieldsType":"FieldsV1","fieldsV1":{"f:metadata":{"f:labels":{".":{},"f:app.kubernetes.io/component":{},"f:app.kubernetes.io/name":{},"f:app.kubernetes.io/part-of":{}},"f:ownerReferences":{".":{},"k:{\"uid\":\"18d9928b-0d1c-47be-80ec-20960d053827\"}":{".":{},"f:apiVersion":{},"f:blockOwnerDeletion":{},"f:controller":{},"f:kind":{},"f:name":{},"f:uid":{}}}},"f:spec":{"f:ports":{".":{},"k:{\"port\":5672,\"protocol\":\"TCP\"}":{".":{},"f:name":{},"f:port":{},"f:protocol":{},"f:targetPort":{}},"k:{\"port\":15672,\"protocol\":\"TCP\"}":{".":{},"f:name":{},"f:port":{},"f:protocol":{},"f:targetPort":{}}},"f:selector":{".":{},"f:app.kubernetes.io/name":{}},"f:sessionAffinity":{},"f:type":{}}}}]},"spec":{"ports":[{"name":"amqp","protocol":"TCP","port":5672,"targetPort":5672},{"name":"management","protocol":"TCP","port":15672,"targetPort":15672}],"selector":{"app.kubernetes.io/name":"rabbitmq-cluster"},"clusterIP":"10.96.254.158","type":"ClusterIP","sessionAffinity":"None"},"status":{"loadBalancer":{}}}
2022/03/18 18:02:01 learn_server.go:291: [SIEVE-AFTER-READ]	Get	true	secret	default	rabbitmq-cluster-erlang-cookie	github.com/rabbitmq/cluster-operator/controllers.(*RabbitmqClusterReconciler)	NoError	{"kind":"Secret","apiVersion":"v1","metadata":{"name":"rabbitmq-cluster-erlang-cookie","namespace":"default","selfLink":"/api/v1/namespaces/default/secrets/rabbitmq-cluster-erlang-cookie","uid":"f8fbe8a6-0f40-4e13-960b-ab78b8ba75b0","resourceVersion":"705","creationTimestamp":"2022-03-18T18:00:38Z","labels":{"app.kubernetes.io/component":"rabbitmq","app.kubernetes.io/name":"rabbitmq-cluster","app.kubernetes.io/part-of":"rabbitmq"},"ownerReferences":[{"apiVersion":"rabbitmq.com/v1beta1","kind":"RabbitmqCluster","name":"rabbitmq-cluster","uid":"18d9928b-0d1c-47be-80ec-20960d053827","controller":true,"blockOwnerDeletion":true}],"managedFields":[{"manager":"manager","operation":"Update","apiVersion":"v1","time":"2022-03-18T18:00:38Z","fieldsType":"FieldsV1","fieldsV1":{"f:data":{".":{},"f:.erlang.cookie":{}},"f:metadata":{"f:labels":{".":{},"f:app.kubernetes.io/component":{},"f:app.kubernetes.io/name":{},"f:app.kubernetes.io/part-of":{}},"f:ownerReferences":{".":{},"k:{\"uid\":\"18d9928b-0d1c-47be-80ec-20960d053827\"}":{".":{},"f:apiVersion":{},"f:blockOwnerDeletion":{},"f:controller":{},"f:kind":{},"f:name":{},"f:uid":{}}}},"f:type":{}}}]},"data":{".erlang.cookie":"QW9hMkpWU0tlYS1FUGdWTUhrelNMNnFoMFZ0ZmRGNUY="},"type":"Opaque"}
2022/03/18 18:02:01 learn_server.go:291: [SIEVE-AFTER-READ]	Get	true	secret	default	rabbitmq-cluster-default-user	github.com/rabbitmq/cluster-operator/controllers.(*RabbitmqClusterReconciler)	NoError	{"kind":"Secret","apiVersion":"v1","metadata":{"name":"rabbitmq-cluster-default-user","namespace":"default","selfLink":"/api/v1/namespaces/default/secrets/rabbitmq-cluster-default-user","uid":"0d9f460b-a23c-402b-8273-f541ed39023f","resourceVersion":"708","creationTimestamp":"2022-03-18T18:00:38Z","labels":{"app.kubernetes.io/component":"rabbitmq","app.kubernetes.io/name":"rabbitmq-cluster","app.kubernetes.io/part-of":"rabbitmq"},"ownerReferences":[{"apiVersion":"rabbitmq.com/v1beta1","kind":"RabbitmqCluster","name":"rabbitmq-cluster","uid":"18d9928b-0d1c-47be-80ec-20960d053827","controller":true,"blockOwnerDeletion":true}],"managedFields":[{"manager":"manager","operation":"Update","apiVersion":"v1","time":"2022-03-18T18:00:38Z","fieldsType":"FieldsV1","fieldsV1":{"f:data":{".":{},"f:default_user.conf":{},"f:password":{},"f:provider":{},"f:type":{},"f:username":{}},"f:metadata":{"f:labels":{".":{},"f:app.kubernetes.io/component":{},"f:app.kubernetes.io/name":{},"f:app.kubernetes.io/part-of":{}},"f:ownerReferences":{".":{},"k:{\"uid\":\"18d9928b-0d1c-47be-80ec-20960d053827\"}":{".":{},"f:apiVersion":{},"f:blockOwnerDeletion":{},"f:controller":{},"f:kind":{},"f:name":{},"f:uid":{}}}},"f:type":{}}}]},"data":{"default_user.conf":"ZGVmYXVsdF91c2VyID0gcTMxRmh3MGtjWW9SZUl5X3BPTXp2ZVBOUnNVU3I1Mk8KZGVmYXVsdF9wYXNzID0gY0dBX19jNTJHX05hVURpTGhraWZ6UDBOVVlNLTE2MWQK","password":"Y0dBX19jNTJHX05hVURpTGhraWZ6UDBOVVlNLTE2MWQ=","provider":"cmFiYml0bXE=","type":"cmFiYml0bXE=","username":"cTMxRmh3MGtjWW9SZUl5X3BPTXp2ZVBOUnNVU3I1Mk8="},"type":"Opaque"}
2022/03/18 18:02:01 learn_server.go:291: [SIEVE-AFTER-READ]	Get	true	configmap	default	rabbitmq-cluster-plugins-conf	github.com/rabbitmq/cluster-operator/controllers.(*RabbitmqClusterReconciler)	NoError	{"kind":"ConfigMap","apiVersion":"v1","metadata":{"name":"rabbitmq-cluster-plugins-conf","namespace":"default","selfLink":"/api/v1/namespaces/default/configmaps/rabbitmq-cluster-plugins-conf","uid":"a164075b-0562-47ac-a577-99aa8651ec40","resourceVersion":"709","creationTimestamp":"2022-03-18T18:00:38Z","labels":{"app.kubernetes.io/component":"rabbitmq","app.kubernetes.io/name":"rabbitmq-cluster","app.kubernetes.io/part-of":"rabbitmq"},"ownerReferences":[{"apiVersion":"rabbitmq.com/v1beta1","kind":"RabbitmqCluster","name":"rabbitmq-cluster","uid":"18d9928b-0d1c-47be-80ec-20960d053827","controller":true,"blockOwnerDeletion":true}],"managedFields":[{"manager":"manager","operation":"Update","apiVersion":"v1","time":"2022-03-18T18:00:38Z","fieldsType":"FieldsV1","fieldsV1":{"f:data":{".":{},"f:enabled_plugins":{}},"f:metadata":{"f:labels":{".":{},"f:app.kubernetes.io/component":{},"f:app.kubernetes.io/name":{},"f:app.kubernetes.io/part-of":{}},"f:ownerReferences":{".":{},"k:{\"uid\":\"18d9928b-0d1c-47be-80ec-20960d053827\"}":{".":{},"f:apiVersion":{},"f:blockOwnerDeletion":{},"f:controller":{},"f:kind":{},"f:name":{},"f:uid":{}}}}}}]},"data":{"enabled_plugins":"[rabbitmq_peer_discovery_k8s,rabbitmq_prometheus,rabbitmq_management]."}}
2022/03/18 18:02:01 learn_server.go:291: [SIEVE-AFTER-READ]	Get	true	configmap	default	rabbitmq-cluster-server-conf	github.com/rabbitmq/cluster-operator/controllers.(*RabbitmqClusterReconciler)	NoError	{"kind":"ConfigMap","apiVersion":"v1","metadata":{"name":"rabbitmq-cluster-server-conf","namespace":"default","selfLink":"/api/v1/namespaces/default/configmaps/rabbitmq-cluster-server-conf","uid":"22474f2b-8454-44b7-8079-8990223969cc","resourceVersion":"714","creationTimestamp":"2022-03-18T18:00:38Z","labels":{"app.kubernetes.io/component":"rabbitmq","app.kubernetes.io/name":"rabbitmq-cluster","app.kubernetes.io/part-of":"rabbitmq"},"ownerReferences":[{"apiVersion":"rabbitmq.com/v1beta1","kind":"RabbitmqCluster","name":"rabbitmq-cluster","uid":"18d9928b-0d1c-47be-80ec-20960d053827","controller":true,"blockOwnerDeletion":true}],"managedFields":[{"manager":"manager","operation":"Update","apiVersion":"v1","time":"2022-03-18T18:00:38Z","fieldsType":"FieldsV1","fieldsV1":{"f:data":{".":{},"f:operatorDefaults.conf":{},"f:userDefinedConfiguration.conf":{}},"f:metadata":{"f:labels":{".":{},"f:app.kubernetes.io/component":{},"f:app.kubernetes.io/name":{},"f:app.kubernetes.io/part-of":{}},"f:ownerReferences":{".":{},"k:{\"uid\":\"18d9928b-0d1c-47be-80ec-20960d053827\"}":{".":{},"f:apiVersion":{},"f:blockOwnerDeletion":{},"f:controller":{},"f:kind":{},"f:name":{},"f:uid":{}}}}}}]},"data":{"operatorDefaults.conf":"cluster_formation.peer_discovery_backend             = rabbit_peer_discovery_k8s\ncluster_formation.k8s.host                           = kubernetes.default\ncluster_formation.k8s.address_type                   = hostname\ncluster_partition_handling                           = pause_minority\nqueue_master_locator                                 = min-masters\ndisk_free_limit.absolute                             = 2GB\ncluster_formation.randomized_startup_delay_range.min = 5\ncluster_formation.randomized_startup_delay_range.max = 30\ncluster_name                                         = rabbitmq-cluster\n","userDefinedConfiguration.conf":"total_memory_available_override_value = 1717986919\n"}}
2022/03/18 18:02:01 learn_server.go:291: [SIEVE-AFTER-READ]	Get	true	serviceaccount	default	rabbitmq-cluster-server	github.com/rabbitmq/cluster-operator/controllers.(*RabbitmqClusterReconciler)	NoError	{"kind":"ServiceAccount","apiVersion":"v1","metadata":{"name":"rabbitmq-cluster-server","namespace":"default","selfLink":"/api/v1/namespaces/default/serviceaccounts/rabbitmq-cluster-server","uid":"731589b5-ac97-4774-bee4-008949b54734","resourceVersion":"722","creationTimestamp":"2022-03-18T18:00:38Z","labels":{"app.kubernetes.io/component":"rabbitmq","app.kubernetes.io/name":"rabbitmq-cluster","app.kubernetes.io/part-of":"rabbitmq"},"ownerReferences":[{"apiVersion":"rabbitmq.com/v1beta1","kind":"RabbitmqCluster","name":"rabbitmq-cluster","uid":"18d9928b-0d1c-47be-80ec-20960d053827","controller":true,"blockOwnerDeletion":true}],"managedFields":[{"manager":"kube-controller-manager","operation":"Update","apiVersion":"v1","time":"2022-03-18T18:00:38Z","fieldsType":"FieldsV1","fieldsV1":{"f:secrets":{".":{},"k:{\"name\":\"rabbitmq-cluster-server-token-rhzq9\"}":{".":{},"f:name":{}}}}},{"manager":"manager","operation":"Update","apiVersion":"v1","time":"2022-03-18T18:00:38Z","fieldsType":"FieldsV1","fieldsV1":{"f:metadata":{"f:labels":{".":{},"f:app.kubernetes.io/component":{},"f:app.kubernetes.io/name":{},"f:app.kubernetes.io/part-of":{}},"f:ownerReferences":{".":{},"k:{\"uid\":\"18d9928b-0d1c-47be-80ec-20960d053827\"}":{".":{},"f:apiVersion":{},"f:blockOwnerDeletion":{},"f:controller":{},"f:kind":{},"f:name":{},"f:uid":{}}}}}}]},"secrets":[{"name":"rabbitmq-cluster-server-token-rhzq9"}]}
2022/03/18 18:02:01 learn_server.go:291: [SIEVE-AFTER-READ]	Get	true	role	default	rabbitmq-cluster-peer-discovery	github.com/rabbitmq/cluster-operator/controllers.(*RabbitmqClusterReconciler)	NoError	{"kind":"Role","apiVersion":"rbac.authorization.k8s.io/v1","metadata":{"name":"rabbitmq-cluster-peer-discovery","namespace":"default","selfLink":"/apis/rbac.authorization.k8s.io/v1/namespaces/default/roles/rabbitmq-cluster-peer-discovery","uid":"52c80b50-4fdd-4089-bbfd-9756465953f2","resourceVersion":"723","creationTimestamp":"2022-03-18T18:00:38Z","labels":{"app.kubernetes.io/component":"rabbitmq","app.kubernetes.io/name":"rabbitmq-cluster","app.kubernetes.io/part-of":"rabbitmq"},"ownerReferences":[{"apiVersion":"rabbitmq.com/v1beta1","kind":"RabbitmqCluster","name":"rabbitmq-cluster","uid":"18d9928b-0d1c-47be-80ec-20960d053827","controller":true,"blockOwnerDeletion":true}],"managedFields":[{"manager":"manager","operation":"Update","apiVersion":"rbac.authorization.k8s.io/v1","time":"2022-03-18T18:00:38Z","fieldsType":"FieldsV1","fieldsV1":{"f:metadata":{"f:labels":{".":{},"f:app.kubernetes.io/component":{},"f:app.kubernetes.io/name":{},"f:app.kubernetes.io/part-of":{}},"f:ownerReferences":{".":{},"k:{\"uid\":\"18d9928b-0d1c-47be-80ec-20960d053827\"}":{".":{},"f:apiVersion":{},"f:blockOwnerDeletion":{},"f:controller":{},"f:kind":{},"f:name":{},"f:uid":{}}}},"f:rules":{}}}]},"rules":[{"verbs":["get"],"apiGroups":[""],"resources":["endpoints"]},{"verbs":["create"],"apiGroups":[""],"resources":["events"]}]}
2022/03/18 18:02:01 learn_server.go:291: [SIEVE-AFTER-READ]	Get	true	rolebinding	default	rabbitmq-cluster-server	github.com/rabbitmq/cluster-operator/controllers.(*RabbitmqClusterReconciler)	NoError	{"kind":"RoleBinding","apiVersion":"rbac.authorization.k8s.io/v1","metadata":{"name":"rabbitmq-cluster-server","namespace":"default","selfLink":"/apis/rbac.authorization.k8s.io/v1/namespaces/default/rolebindings/rabbitmq-cluster-server","uid":"495e9f7c-a20d-4515-86b0-34149a855034","resourceVersion":"725","creationTimestamp":"2022-03-18T18:00:38Z","labels":{"app.kubernetes.io/component":"rabbitmq","app.kubernetes.io/name":"rabbitmq-cluster","app.kubernetes.io/part-of":"rabbitmq"},"ownerReferences":[{"apiVersion":"rabbitmq.com/v1beta1","kind":"RabbitmqCluster","name":"rabbitmq-cluster","uid":"18d9928b-0d1c-47be-80ec-20960d053827","controller":true,"blockOwnerDeletion":true}],"managedFields":[{"manager":"manager","operation":"Update","apiVersion":"rbac.authorization.k8s.io/v1","time":"2022-03-18T18:00:38Z","fieldsType":"FieldsV1","fieldsV1":{"f:metadata":{"f:labels":{".":{},"f:app.kubernetes.io/component":{},"f:app.kubernetes.io/name":{},"f:app.kubernetes.io/part-of":{}},"f:ownerReferences":{".":{},"k:{\"uid\":\"18d9928b-0d1c-47be-80ec-20960d053827\"}":{".":{},"f:apiVersion":{},"f:blockOwnerDeletion":{},"f:controller":{},"f:kind":{},"f:name":{},"f:uid":{}}}},"f:roleRef":{"f:apiGroup":{},"f:kind":{},"f:name":{}},"f:subjects":{}}}]},"subjects":[{"kind":"ServiceAccount","name":"rabbitmq-cluster-server"}],"roleRef":{"apiGroup":"rbac.authorization.k8s.io","kind":"Role","name":"rabbitmq-cluster-peer-discovery"}}
2022/03/18 18:02:01 learn_server.go:291: [SIEVE-AFTER-READ]	Get	true	statefulset	default	rabbitmq-cluster-server	github.com/rabbitmq/cluster-operator/controllers.(*RabbitmqClusterReconciler)	NoError	{"kind":"StatefulSet","apiVersion":"apps/v1","metadata":{"name":"rabbitmq-cluster-server","namespace":"default","selfLink":"/apis/apps/v1/namespaces/default/statefulsets/rabbitmq-cluster-server","uid":"cb5c43bc-6ee7-481c-ab01-6f3acffdd3c8","resourceVersion":"1231","generation":2,"creationTimestamp":"2022-03-18T18:00:38Z","labels":{"app.kubernetes.io/component":"rabbitmq","app.kubernetes.io/name":"rabbitmq-cluster","app.kubernetes.io/part-of":"rabbitmq"},"ownerReferences":[{"apiVersion":"rabbitmq.com/v1beta1","kind":"RabbitmqCluster","name":"rabbitmq-cluster","uid":"18d9928b-0d1c-47be-80ec-20960d053827","controller":true,"blockOwnerDeletion":true}],"managedFields":[{"manager":"manager","operation":"Update","apiVersion":"apps/v1","time":"2022-03-18T18:01:23Z","fieldsType":"FieldsV1","fieldsV1":{"f:metadata":{"f:labels":{".":{},"f:app.kubernetes.io/component":{},"f:app.kubernetes.io/name":{},"f:app.kubernetes.io/part-of":{}},"f:ownerReferences":{".":{},"k:{\"uid\":\"18d9928b-0d1c-47be-80ec-20960d053827\"}":{".":{},"f:apiVersion":{},"f:blockOwnerDeletion":{},"f:controller":{},"f:kind":{},"f:name":{},"f:uid":{}}}},"f:spec":{"f:podManagementPolicy":{},"f:replicas":{},"f:revisionHistoryLimit":{},"f:selector":{"f:matchLabels":{".":{},"f:app.kubernetes.io/name":{}}},"f:serviceName":{},"f:template":{"f:metadata":{"f:annotations":{".":{},"f:prometheus.io/port":{},"f:prometheus.io/scrape":{}},"f:labels":{".":{},"f:app.kubernetes.io/component":{},"f:app.kubernetes.io/name":{},"f:app.kubernetes.io/part-of":{}}},"f:spec":{"f:automountServiceAccountToken":{},"f:containers":{"k:{\"name\":\"rabbitmq\"}":{".":{},"f:env":{".":{},"k:{\"name\":\"K8S_HOSTNAME_SUFFIX\"}":{".":{},"f:name":{},"f:value":{}},"k:{\"name\":\"K8S_SERVICE_NAME\"}":{".":{},"f:name":{},"f:value":{}},"k:{\"name\":\"MY_POD_NAME\"}":{".":{},"f:name":{},"f:valueFrom":{".":{},"f:fieldRef":{".":{},"f:apiVersion":{},"f:fieldPath":{}}}},"k:{\"name\":\"MY_POD_NAMESPACE\"}":{".":{},"f:name":{},"f:valueFrom":{".":{},"f:fieldRef":{".":{},"f:apiVersion":{},"f:fieldPath":{}}}},"k:{\"name\":\"RABBITMQ_ENABLED_PLUGINS_FILE\"}":{".":{},"f:name":{},"f:value":{}},"k:{\"name\":\"RABBITMQ_NODENAME\"}":{".":{},"f:name":{},"f:value":{}},"k:{\"name\":\"RABBITMQ_USE_LONGNAME\"}":{".":{},"f:name":{},"f:value":{}}},"f:image":{},"f:imagePullPolicy":{},"f:lifecycle":{".":{},"f:preStop":{".":{},"f:exec":{".":{},"f:command":{}}}},"f:name":{},"f:ports":{".":{},"k:{\"containerPort\":4369,\"protocol\":\"TCP\"}":{".":{},"f:containerPort":{},"f:name":{},"f:protocol":{}},"k:{\"containerPort\":5672,\"protocol\":\"TCP\"}":{".":{},"f:containerPort":{},"f:name":{},"f:protocol":{}},"k:{\"containerPort\":15672,\"protocol\":\"TCP\"}":{".":{},"f:containerPort":{},"f:name":{},"f:protocol":{}},"k:{\"containerPort\":15692,\"protocol\":\"TCP\"}":{".":{},"f:containerPort":{},"f:name":{},"f:protocol":{}}},"f:readinessProbe":{".":{},"f:failureThreshold":{},"f:initialDelaySeconds":{},"f:periodSeconds":{},"f:successThreshold":{},"f:tcpSocket":{".":{},"f:port":{}},"f:timeoutSeconds":{}},"f:resources":{".":{},"f:limits":{".":{},"f:cpu":{},"f:memory":{}},"f:requests":{".":{},"f:cpu":{},"f:memory":{}}},"f:terminationMessagePath":{},"f:terminationMessagePolicy":{},"f:volumeMounts":{".":{},"k:{\"mountPath\":\"/etc/pod-info/\"}":{".":{},"f:mountPath":{},"f:name":{}},"k:{\"mountPath\":\"/etc/rabbitmq/conf.d/10-operatorDefaults.conf\"}":{".":{},"f:mountPath":{},"f:name":{},"f:subPath":{}},"k:{\"mountPath\":\"/etc/rabbitmq/conf.d/11-default_user.conf\"}":{".":{},"f:mountPath":{},"f:name":{},"f:subPath":{}},"k:{\"mountPath\":\"/etc/rabbitmq/conf.d/90-userDefinedConfiguration.conf\"}":{".":{},"f:mountPath":{},"f:name":{},"f:subPath":{}},"k:{\"mountPath\":\"/operator\"}":{".":{},"f:mountPath":{},"f:name":{}},"k:{\"mountPath\":\"/var/lib/rabbitmq/\"}":{".":{},"f:mountPath":{},"f:name":{}},"k:{\"mountPath\":\"/var/lib/rabbitmq/mnesia/\"}":{".":{},"f:mountPath":{},"f:name":{}}}}},"f:dnsPolicy":{},"f:initContainers":{".":{},"k:{\"name\":\"setup-container\"}":{".":{},"f:command":{},"f:image":{},"f:imagePullPolicy":{},"f:name":{},"f:resources":{".":{},"f:limits":{".":{},"f:cpu":{},"f:memory":{}},"f:requests":{".":{},"f:cpu":{},"f:memory":{}}},"f:securityContext":{".":{},"f:capabilities":{".":{},"f:drop":{}},"f:runAsUser":{}},"f:terminationMessagePath":{},"f:terminationMessagePolicy":{},"f:volumeMounts":{".":{},"k:{\"mountPath\":\"/operator\"}":{".":{},"f:mountPath":{},"f:name":{}},"k:{\"mountPath\":\"/tmp/default_user.conf\"}":{".":{},"f:mountPath":{},"f:name":{},"f:subPath":{}},"k:{\"mountPath\":\"/tmp/erlang-cookie-secret/\"}":{".":{},"f:mountPath":{},"f:name":{}},"k:{\"mountPath\":\"/tmp/rabbitmq-plugins/\"}":{".":{},"f:mountPath":{},"f:name":{}},"k:{\"mountPath\":\"/var/lib/rabbitmq/\"}":{".":{},"f:mountPath":{},"f:name":{}},"k:{\"mountPath\":\"/var/lib/rabbitmq/mnesia/\"}":{".":{},"f:mountPath":{},"f:name":{}}}}},"f:restartPolicy":{},"f:schedulerName":{},"f:securityContext":{".":{},"f:fsGroup":{},"f:runAsGroup":{},"f:runAsUser":{}},"f:serviceAccount":{},"f:serviceAccountName":{},"f:terminationGracePeriodSeconds":{},"f:topologySpreadConstraints":{".":{},"k:{\"topologyKey\":\"topology.kubernetes.io/zone\",\"whenUnsatisfiable\":\"ScheduleAnyway\"}":{".":{},"f:labelSelector":{".":{},"f:matchLabels":{".":{},"f:app.kubernetes.io/name":{}}},"f:maxSkew":{},"f:topologyKey":{},"f:whenUnsatisfiable":{}}},"f:volumes":{".":{},"k:{\"name\":\"erlang-cookie-secret\"}":{".":{},"f:name":{},"f:secret":{".":{},"f:defaultMode":{},"f:secretName":{}}},"k:{\"name\":\"plugins-conf\"}":{".":{},"f:configMap":{".":{},"f:defaultMode":{},"f:name":{}},"f:name":{}},"k:{\"name\":\"pod-info\"}":{".":{},"f:downwardAPI":{".":{},"f:defaultMode":{},"f:items":{}},"f:name":{}},"k:{\"name\":\"rabbitmq-confd\"}":{".":{},"f:name":{},"f:projected":{".":{},"f:defaultMode":{},"f:sources":{}}},"k:{\"name\":\"rabbitmq-erlang-cookie\"}":{".":{},"f:emptyDir":{},"f:name":{}},"k:{\"name\":\"rabbitmq-plugins\"}":{".":{},"f:emptyDir":{},"f:name":{}}}}},"f:updateStrategy":{"f:rollingUpdate":{".":{},"f:partition":{}},"f:type":{}},"f:volumeClaimTemplates":{}}}},{"manager":"kube-controller-manager","operation":"Update","apiVersion":"apps/v1","time":"2022-03-18T18:02:01Z","fieldsType":"FieldsV1","fieldsV1":{"f:status":{"f:collisionCount":{},"f:currentReplicas":{},"f:currentRevision":{},"f:observedGeneration":{},"f:readyReplicas":{},"f:replicas":{},"f:updateRevision":{},"f:updatedReplicas":{}}}}]},"spec":{"replicas":3,"selector":{"matchLabels":{"app.kubernetes.io/name":"rabbitmq-cluster"}},"template":{"metadata":{"creationTimestamp":null,"labels":{"app.kubernetes.io/component":"rabbitmq","app.kubernetes.io/name":"rabbitmq-cluster","app.kubernetes.io/part-of":"rabbitmq"},"annotations":{"prometheus.io/port":"15692","prometheus.io/scrape":"true"}},"spec":{"volumes":[{"name":"plugins-conf","configMap":{"name":"rabbitmq-cluster-plugins-conf","defaultMode":420}},{"name":"rabbitmq-confd","projected":{"sources":[{"secret":{"name":"rabbitmq-cluster-default-user","items":[{"key":"default_user.conf","path":"default_user.conf"}]}},{"configMap":{"name":"rabbitmq-cluster-server-conf","items":[{"key":"operatorDefaults.conf","path":"operatorDefaults.conf"},{"key":"userDefinedConfiguration.conf","path":"userDefinedConfiguration.conf"}]}}],"defaultMode":420}},{"name":"rabbitmq-erlang-cookie","emptyDir":{}},{"name":"erlang-cookie-secret","secret":{"secretName":"rabbitmq-cluster-erlang-cookie","defaultMode":420}},{"name":"rabbitmq-plugins","emptyDir":{}},{"name":"pod-info","downwardAPI":{"items":[{"path":"skipPreStopChecks","fieldRef":{"apiVersion":"v1","fieldPath":"metadata.labels['skipPreStopChecks']"}}],"defaultMode":420}}],"initContainers":[{"name":"setup-container","image":"rabbitmq:3.8.12-management","command":["sh","-c","cp /tmp/erlang-cookie-secret/.erlang.cookie /var/lib/rabbitmq/.erlang.cookie \u0026\u0026 chown 999:999 /var/lib/rabbitmq/.erlang.cookie \u0026\u0026 chmod 600 /var/lib/rabbitmq/.erlang.cookie ; cp /tmp/rabbitmq-plugins/enabled_plugins /operator/enabled_plugins \u0026\u0026 chown 999:999 /operator/enabled_plugins ; chown 999:999 /var/lib/rabbitmq/mnesia/ ; echo '[default]' \u003e /var/lib/rabbitmq/.rabbitmqadmin.conf \u0026\u0026 sed -e 's/default_user/username/' -e 's/default_pass/password/' /tmp/default_user.conf \u003e\u003e /var/lib/rabbitmq/.rabbitmqadmin.conf \u0026\u0026 chown 999:999 /var/lib/rabbitmq/.rabbitmqadmin.conf \u0026\u0026 chmod 600 /var/lib/rabbitmq/.rabbitmqadmin.conf"],"resources":{"limits":{"cpu":"100m","memory":"500Mi"},"requests":{"cpu":"100m","memory":"500Mi"}},"volumeMounts":[{"name":"plugins-conf","mountPath":"/tmp/rabbitmq-plugins/"},{"name":"rabbitmq-erlang-cookie","mountPath":"/var/lib/rabbitmq/"},{"name":"erlang-cookie-secret","mountPath":"/tmp/erlang-cookie-secret/"},{"name":"rabbitmq-plugins","mountPath":"/operator"},{"name":"persistence","mountPath":"/var/lib/rabbitmq/mnesia/"},{"name":"rabbitmq-confd","mountPath":"/tmp/default_user.conf","subPath":"default_user.conf"}],"terminationMessagePath":"/dev/termination-log","terminationMessagePolicy":"File","imagePullPolicy":"IfNotPresent","securityContext":{"capabilities":{"drop":["FSETID","KILL","SETGID","SETUID","SETPCAP","NET_BIND_SERVICE","NET_RAW","SYS_CHROOT","MKNOD","AUDIT_WRITE","SETFCAP"]},"runAsUser":0}}],"containers":[{"name":"rabbitmq","image":"rabbitmq:3.8.12-management","ports":[{"name":"epmd","containerPort":4369,"protocol":"TCP"},{"name":"amqp","containerPort":5672,"protocol":"TCP"},{"name":"management","containerPort":15672,"protocol":"TCP"},{"name":"prometheus","containerPort":15692,"protocol":"TCP"}],"env":[{"name":"MY_POD_NAME","valueFrom":{"fieldRef":{"apiVersion":"v1","fieldPath":"metadata.name"}}},{"name":"MY_POD_NAMESPACE","valueFrom":{"fieldRef":{"apiVersion":"v1","fieldPath":"metadata.namespace"}}},{"name":"RABBITMQ_ENABLED_PLUGINS_FILE","value":"/operator/enabled_plugins"},{"name":"K8S_SERVICE_NAME","value":"rabbitmq-cluster-nodes"},{"name":"RABBITMQ_USE_LONGNAME","value":"true"},{"name":"RABBITMQ_NODENAME","value":"rabbit@$(MY_POD_NAME).$(K8S_SERVICE_NAME).$(MY_POD_NAMESPACE)"},{"name":"K8S_HOSTNAME_SUFFIX","value":".$(K8S_SERVICE_NAME).$(MY_POD_NAMESPACE)"}],"resources":{"limits":{"cpu":"2","memory":"2Gi"},"requests":{"cpu":"1","memory":"2Gi"}},"volumeMounts":[{"name":"rabbitmq-erlang-cookie","mountPath":"/var/lib/rabbitmq/"},{"name":"persistence","mountPath":"/var/lib/rabbitmq/mnesia/"},{"name":"rabbitmq-plugins","mountPath":"/operator"},{"name":"rabbitmq-confd","mountPath":"/etc/rabbitmq/conf.d/10-operatorDefaults.conf","subPath":"operatorDefaults.conf"},{"name":"rabbitmq-confd","mountPath":"/etc/rabbitmq/conf.d/11-default_user.conf","subPath":"default_user.conf"},{"name":"rabbitmq-confd","mountPath":"/etc/rabbitmq/conf.d/90-userDefinedConfiguration.conf","subPath":"userDefinedConfiguration.conf"},{"name":"pod-info","mountPath":"/etc/pod-info/"}],"readinessProbe":{"tcpSocket":{"port":"amqp"},"initialDelaySeconds":10,"timeoutSeconds":5,"periodSeconds":10,"successThreshold":1,"failureThreshold":3},"lifecycle":{"preStop":{"exec":{"command":["/bin/bash","-c","if [ ! -z \"$(cat /etc/pod-info/skipPreStopChecks)\" ]; then exit 0; fi; rabbitmq-upgrade await_online_quorum_plus_one -t 604800; rabbitmq-upgrade await_online_synchronized_mirror -t 604800; rabbitmq-upgrade drain -t 604800"]}}},"terminationMessagePath":"/dev/termination-log","terminationMessagePolicy":"File","imagePullPolicy":"IfNotPresent"}],"restartPolicy":"Always","terminationGracePeriodSeconds":604800,"dnsPolicy":"ClusterFirst","serviceAccountName":"rabbitmq-cluster-server","serviceAccount":"rabbitmq-cluster-server","automountServiceAccountToken":true,"securityContext":{"runAsUser":999,"runAsGroup":999,"fsGroup":999},"schedulerName":"default-scheduler","topologySpreadConstraints":[{"maxSkew":1,"topologyKey":"topology.kubernetes.io/zone","whenUnsatisfiable":"ScheduleAnyway","labelSelector":{"matchLabels":{"app.kubernetes.io/name":"rabbitmq-cluster"}}}]}},"volumeClaimTemplates":[{"metadata":{"name":"persistence","namespace":"default","creationTimestamp":null,"labels":{"app.kubernetes.io/component":"rabbitmq","app.kubernetes.io/name":"rabbitmq-cluster","app.kubernetes.io/part-of":"rabbitmq"},"ownerReferences":[{"apiVersion":"rabbitmq.com/v1beta1","kind":"RabbitmqCluster","name":"rabbitmq-cluster","uid":"18d9928b-0d1c-47be-80ec-20960d053827","controller":true,"blockOwnerDeletion":false}]},"spec":{"accessModes":["ReadWriteOnce"],"resources":{"requests":{"storage":"10Gi"}},"volumeMode":"Filesystem"},"status":{"phase":"Pending"}}],"serviceName":"rabbitmq-cluster-nodes","podManagementPolicy":"Parallel","updateStrategy":{"type":"RollingUpdate","rollingUpdate":{"partition":0}},"revisionHistoryLimit":10},"status":{"observedGeneration":2,"replicas":3,"readyReplicas":3,"currentReplicas":3,"updatedReplicas":3,"currentRevision":"rabbitmq-cluster-server-5f8b8665fb","updateRevision":"rabbitmq-cluster-server-5f8b8665fb","collisionCount":0}}
2022/03/18 18:02:01 learn_server.go:291: [SIEVE-AFTER-READ]	Get	true	statefulset	default	rabbitmq-cluster-server	github.com/rabbitmq/cluster-operator/controllers.(*RabbitmqClusterReconciler)	NoError	{"kind":"StatefulSet","apiVersion":"apps/v1","metadata":{"name":"rabbitmq-cluster-server","namespace":"default","selfLink":"/apis/apps/v1/namespaces/default/statefulsets/rabbitmq-cluster-server","uid":"cb5c43bc-6ee7-481c-ab01-6f3acffdd3c8","resourceVersion":"1231","generation":2,"creationTimestamp":"2022-03-18T18:00:38Z","labels":{"app.kubernetes.io/component":"rabbitmq","app.kubernetes.io/name":"rabbitmq-cluster","app.kubernetes.io/part-of":"rabbitmq"},"ownerReferences":[{"apiVersion":"rabbitmq.com/v1beta1","kind":"RabbitmqCluster","name":"rabbitmq-cluster","uid":"18d9928b-0d1c-47be-80ec-20960d053827","controller":true,"blockOwnerDeletion":true}],"managedFields":[{"manager":"manager","operation":"Update","apiVersion":"apps/v1","time":"2022-03-18T18:01:23Z","fieldsType":"FieldsV1","fieldsV1":{"f:metadata":{"f:labels":{".":{},"f:app.kubernetes.io/component":{},"f:app.kubernetes.io/name":{},"f:app.kubernetes.io/part-of":{}},"f:ownerReferences":{".":{},"k:{\"uid\":\"18d9928b-0d1c-47be-80ec-20960d053827\"}":{".":{},"f:apiVersion":{},"f:blockOwnerDeletion":{},"f:controller":{},"f:kind":{},"f:name":{},"f:uid":{}}}},"f:spec":{"f:podManagementPolicy":{},"f:replicas":{},"f:revisionHistoryLimit":{},"f:selector":{"f:matchLabels":{".":{},"f:app.kubernetes.io/name":{}}},"f:serviceName":{},"f:template":{"f:metadata":{"f:annotations":{".":{},"f:prometheus.io/port":{},"f:prometheus.io/scrape":{}},"f:labels":{".":{},"f:app.kubernetes.io/component":{},"f:app.kubernetes.io/name":{},"f:app.kubernetes.io/part-of":{}}},"f:spec":{"f:automountServiceAccountToken":{},"f:containers":{"k:{\"name\":\"rabbitmq\"}":{".":{},"f:env":{".":{},"k:{\"name\":\"K8S_HOSTNAME_SUFFIX\"}":{".":{},"f:name":{},"f:value":{}},"k:{\"name\":\"K8S_SERVICE_NAME\"}":{".":{},"f:name":{},"f:value":{}},"k:{\"name\":\"MY_POD_NAME\"}":{".":{},"f:name":{},"f:valueFrom":{".":{},"f:fieldRef":{".":{},"f:apiVersion":{},"f:fieldPath":{}}}},"k:{\"name\":\"MY_POD_NAMESPACE\"}":{".":{},"f:name":{},"f:valueFrom":{".":{},"f:fieldRef":{".":{},"f:apiVersion":{},"f:fieldPath":{}}}},"k:{\"name\":\"RABBITMQ_ENABLED_PLUGINS_FILE\"}":{".":{},"f:name":{},"f:value":{}},"k:{\"name\":\"RABBITMQ_NODENAME\"}":{".":{},"f:name":{},"f:value":{}},"k:{\"name\":\"RABBITMQ_USE_LONGNAME\"}":{".":{},"f:name":{},"f:value":{}}},"f:image":{},"f:imagePullPolicy":{},"f:lifecycle":{".":{},"f:preStop":{".":{},"f:exec":{".":{},"f:command":{}}}},"f:name":{},"f:ports":{".":{},"k:{\"containerPort\":4369,\"protocol\":\"TCP\"}":{".":{},"f:containerPort":{},"f:name":{},"f:protocol":{}},"k:{\"containerPort\":5672,\"protocol\":\"TCP\"}":{".":{},"f:containerPort":{},"f:name":{},"f:protocol":{}},"k:{\"containerPort\":15672,\"protocol\":\"TCP\"}":{".":{},"f:containerPort":{},"f:name":{},"f:protocol":{}},"k:{\"containerPort\":15692,\"protocol\":\"TCP\"}":{".":{},"f:containerPort":{},"f:name":{},"f:protocol":{}}},"f:readinessProbe":{".":{},"f:failureThreshold":{},"f:initialDelaySeconds":{},"f:periodSeconds":{},"f:successThreshold":{},"f:tcpSocket":{".":{},"f:port":{}},"f:timeoutSeconds":{}},"f:resources":{".":{},"f:limits":{".":{},"f:cpu":{},"f:memory":{}},"f:requests":{".":{},"f:cpu":{},"f:memory":{}}},"f:terminationMessagePath":{},"f:terminationMessagePolicy":{},"f:volumeMounts":{".":{},"k:{\"mountPath\":\"/etc/pod-info/\"}":{".":{},"f:mountPath":{},"f:name":{}},"k:{\"mountPath\":\"/etc/rabbitmq/conf.d/10-operatorDefaults.conf\"}":{".":{},"f:mountPath":{},"f:name":{},"f:subPath":{}},"k:{\"mountPath\":\"/etc/rabbitmq/conf.d/11-default_user.conf\"}":{".":{},"f:mountPath":{},"f:name":{},"f:subPath":{}},"k:{\"mountPath\":\"/etc/rabbitmq/conf.d/90-userDefinedConfiguration.conf\"}":{".":{},"f:mountPath":{},"f:name":{},"f:subPath":{}},"k:{\"mountPath\":\"/operator\"}":{".":{},"f:mountPath":{},"f:name":{}},"k:{\"mountPath\":\"/var/lib/rabbitmq/\"}":{".":{},"f:mountPath":{},"f:name":{}},"k:{\"mountPath\":\"/var/lib/rabbitmq/mnesia/\"}":{".":{},"f:mountPath":{},"f:name":{}}}}},"f:dnsPolicy":{},"f:initContainers":{".":{},"k:{\"name\":\"setup-container\"}":{".":{},"f:command":{},"f:image":{},"f:imagePullPolicy":{},"f:name":{},"f:resources":{".":{},"f:limits":{".":{},"f:cpu":{},"f:memory":{}},"f:requests":{".":{},"f:cpu":{},"f:memory":{}}},"f:securityContext":{".":{},"f:capabilities":{".":{},"f:drop":{}},"f:runAsUser":{}},"f:terminationMessagePath":{},"f:terminationMessagePolicy":{},"f:volumeMounts":{".":{},"k:{\"mountPath\":\"/operator\"}":{".":{},"f:mountPath":{},"f:name":{}},"k:{\"mountPath\":\"/tmp/default_user.conf\"}":{".":{},"f:mountPath":{},"f:name":{},"f:subPath":{}},"k:{\"mountPath\":\"/tmp/erlang-cookie-secret/\"}":{".":{},"f:mountPath":{},"f:name":{}},"k:{\"mountPath\":\"/tmp/rabbitmq-plugins/\"}":{".":{},"f:mountPath":{},"f:name":{}},"k:{\"mountPath\":\"/var/lib/rabbitmq/\"}":{".":{},"f:mountPath":{},"f:name":{}},"k:{\"mountPath\":\"/var/lib/rabbitmq/mnesia/\"}":{".":{},"f:mountPath":{},"f:name":{}}}}},"f:restartPolicy":{},"f:schedulerName":{},"f:securityContext":{".":{},"f:fsGroup":{},"f:runAsGroup":{},"f:runAsUser":{}},"f:serviceAccount":{},"f:serviceAccountName":{},"f:terminationGracePeriodSeconds":{},"f:topologySpreadConstraints":{".":{},"k:{\"topologyKey\":\"topology.kubernetes.io/zone\",\"whenUnsatisfiable\":\"ScheduleAnyway\"}":{".":{},"f:labelSelector":{".":{},"f:matchLabels":{".":{},"f:app.kubernetes.io/name":{}}},"f:maxSkew":{},"f:topologyKey":{},"f:whenUnsatisfiable":{}}},"f:volumes":{".":{},"k:{\"name\":\"erlang-cookie-secret\"}":{".":{},"f:name":{},"f:secret":{".":{},"f:defaultMode":{},"f:secretName":{}}},"k:{\"name\":\"plugins-conf\"}":{".":{},"f:configMap":{".":{},"f:defaultMode":{},"f:name":{}},"f:name":{}},"k:{\"name\":\"pod-info\"}":{".":{},"f:downwardAPI":{".":{},"f:defaultMode":{},"f:items":{}},"f:name":{}},"k:{\"name\":\"rabbitmq-confd\"}":{".":{},"f:name":{},"f:projected":{".":{},"f:defaultMode":{},"f:sources":{}}},"k:{\"name\":\"rabbitmq-erlang-cookie\"}":{".":{},"f:emptyDir":{},"f:name":{}},"k:{\"name\":\"rabbitmq-plugins\"}":{".":{},"f:emptyDir":{},"f:name":{}}}}},"f:updateStrategy":{"f:rollingUpdate":{".":{},"f:partition":{}},"f:type":{}},"f:volumeClaimTemplates":{}}}},{"manager":"kube-controller-manager","operation":"Update","apiVersion":"apps/v1","time":"2022-03-18T18:02:01Z","fieldsType":"FieldsV1","fieldsV1":{"f:status":{"f:collisionCount":{},"f:currentReplicas":{},"f:currentRevision":{},"f:observedGeneration":{},"f:readyReplicas":{},"f:replicas":{},"f:updateRevision":{},"f:updatedReplicas":{}}}}]},"spec":{"replicas":3,"selector":{"matchLabels":{"app.kubernetes.io/name":"rabbitmq-cluster"}},"template":{"metadata":{"creationTimestamp":null,"labels":{"app.kubernetes.io/component":"rabbitmq","app.kubernetes.io/name":"rabbitmq-cluster","app.kubernetes.io/part-of":"rabbitmq"},"annotations":{"prometheus.io/port":"15692","prometheus.io/scrape":"true"}},"spec":{"volumes":[{"name":"plugins-conf","configMap":{"name":"rabbitmq-cluster-plugins-conf","defaultMode":420}},{"name":"rabbitmq-confd","projected":{"sources":[{"secret":{"name":"rabbitmq-cluster-default-user","items":[{"key":"default_user.conf","path":"default_user.conf"}]}},{"configMap":{"name":"rabbitmq-cluster-server-conf","items":[{"key":"operatorDefaults.conf","path":"operatorDefaults.conf"},{"key":"userDefinedConfiguration.conf","path":"userDefinedConfiguration.conf"}]}}],"defaultMode":420}},{"name":"rabbitmq-erlang-cookie","emptyDir":{}},{"name":"erlang-cookie-secret","secret":{"secretName":"rabbitmq-cluster-erlang-cookie","defaultMode":420}},{"name":"rabbitmq-plugins","emptyDir":{}},{"name":"pod-info","downwardAPI":{"items":[{"path":"skipPreStopChecks","fieldRef":{"apiVersion":"v1","fieldPath":"metadata.labels['skipPreStopChecks']"}}],"defaultMode":420}}],"initContainers":[{"name":"setup-container","image":"rabbitmq:3.8.12-management","command":["sh","-c","cp /tmp/erlang-cookie-secret/.erlang.cookie /var/lib/rabbitmq/.erlang.cookie \u0026\u0026 chown 999:999 /var/lib/rabbitmq/.erlang.cookie \u0026\u0026 chmod 600 /var/lib/rabbitmq/.erlang.cookie ; cp /tmp/rabbitmq-plugins/enabled_plugins /operator/enabled_plugins \u0026\u0026 chown 999:999 /operator/enabled_plugins ; chown 999:999 /var/lib/rabbitmq/mnesia/ ; echo '[default]' \u003e /var/lib/rabbitmq/.rabbitmqadmin.conf \u0026\u0026 sed -e 's/default_user/username/' -e 's/default_pass/password/' /tmp/default_user.conf \u003e\u003e /var/lib/rabbitmq/.rabbitmqadmin.conf \u0026\u0026 chown 999:999 /var/lib/rabbitmq/.rabbitmqadmin.conf \u0026\u0026 chmod 600 /var/lib/rabbitmq/.rabbitmqadmin.conf"],"resources":{"limits":{"cpu":"100m","memory":"500Mi"},"requests":{"cpu":"100m","memory":"500Mi"}},"volumeMounts":[{"name":"plugins-conf","mountPath":"/tmp/rabbitmq-plugins/"},{"name":"rabbitmq-erlang-cookie","mountPath":"/var/lib/rabbitmq/"},{"name":"erlang-cookie-secret","mountPath":"/tmp/erlang-cookie-secret/"},{"name":"rabbitmq-plugins","mountPath":"/operator"},{"name":"persistence","mountPath":"/var/lib/rabbitmq/mnesia/"},{"name":"rabbitmq-confd","mountPath":"/tmp/default_user.conf","subPath":"default_user.conf"}],"terminationMessagePath":"/dev/termination-log","terminationMessagePolicy":"File","imagePullPolicy":"IfNotPresent","securityContext":{"capabilities":{"drop":["FSETID","KILL","SETGID","SETUID","SETPCAP","NET_BIND_SERVICE","NET_RAW","SYS_CHROOT","MKNOD","AUDIT_WRITE","SETFCAP"]},"runAsUser":0}}],"containers":[{"name":"rabbitmq","image":"rabbitmq:3.8.12-management","ports":[{"name":"epmd","containerPort":4369,"protocol":"TCP"},{"name":"amqp","containerPort":5672,"protocol":"TCP"},{"name":"management","containerPort":15672,"protocol":"TCP"},{"name":"prometheus","containerPort":15692,"protocol":"TCP"}],"env":[{"name":"MY_POD_NAME","valueFrom":{"fieldRef":{"apiVersion":"v1","fieldPath":"metadata.name"}}},{"name":"MY_POD_NAMESPACE","valueFrom":{"fieldRef":{"apiVersion":"v1","fieldPath":"metadata.namespace"}}},{"name":"RABBITMQ_ENABLED_PLUGINS_FILE","value":"/operator/enabled_plugins"},{"name":"K8S_SERVICE_NAME","value":"rabbitmq-cluster-nodes"},{"name":"RABBITMQ_USE_LONGNAME","value":"true"},{"name":"RABBITMQ_NODENAME","value":"rabbit@$(MY_POD_NAME).$(K8S_SERVICE_NAME).$(MY_POD_NAMESPACE)"},{"name":"K8S_HOSTNAME_SUFFIX","value":".$(K8S_SERVICE_NAME).$(MY_POD_NAMESPACE)"}],"resources":{"limits":{"cpu":"2","memory":"2Gi"},"requests":{"cpu":"1","memory":"2Gi"}},"volumeMounts":[{"name":"rabbitmq-erlang-cookie","mountPath":"/var/lib/rabbitmq/"},{"name":"persistence","mountPath":"/var/lib/rabbitmq/mnesia/"},{"name":"rabbitmq-plugins","mountPath":"/operator"},{"name":"rabbitmq-confd","mountPath":"/etc/rabbitmq/conf.d/10-operatorDefaults.conf","subPath":"operatorDefaults.conf"},{"name":"rabbitmq-confd","mountPath":"/etc/rabbitmq/conf.d/11-default_user.conf","subPath":"default_user.conf"},{"name":"rabbitmq-confd","mountPath":"/etc/rabbitmq/conf.d/90-userDefinedConfiguration.conf","subPath":"userDefinedConfiguration.conf"},{"name":"pod-info","mountPath":"/etc/pod-info/"}],"readinessProbe":{"tcpSocket":{"port":"amqp"},"initialDelaySeconds":10,"timeoutSeconds":5,"periodSeconds":10,"successThreshold":1,"failureThreshold":3},"lifecycle":{"preStop":{"exec":{"command":["/bin/bash","-c","if [ ! -z \"$(cat /etc/pod-info/skipPreStopChecks)\" ]; then exit 0; fi; rabbitmq-upgrade await_online_quorum_plus_one -t 604800; rabbitmq-upgrade await_online_synchronized_mirror -t 604800; rabbitmq-upgrade drain -t 604800"]}}},"terminationMessagePath":"/dev/termination-log","terminationMessagePolicy":"File","imagePullPolicy":"IfNotPresent"}],"restartPolicy":"Always","terminationGracePeriodSeconds":604800,"dnsPolicy":"ClusterFirst","serviceAccountName":"rabbitmq-cluster-server","serviceAccount":"rabbitmq-cluster-server","automountServiceAccountToken":true,"securityContext":{"runAsUser":999,"runAsGroup":999,"fsGroup":999},"schedulerName":"default-scheduler","topologySpreadConstraints":[{"maxSkew":1,"topologyKey":"topology.kubernetes.io/zone","whenUnsatisfiable":"ScheduleAnyway","labelSelector":{"matchLabels":{"app.kubernetes.io/name":"rabbitmq-cluster"}}}]}},"volumeClaimTemplates":[{"metadata":{"name":"persistence","namespace":"default","creationTimestamp":null,"labels":{"app.kubernetes.io/component":"rabbitmq","app.kubernetes.io/name":"rabbitmq-cluster","app.kubernetes.io/part-of":"rabbitmq"},"ownerReferences":[{"apiVersion":"rabbitmq.com/v1beta1","kind":"RabbitmqCluster","name":"rabbitmq-cluster","uid":"18d9928b-0d1c-47be-80ec-20960d053827","controller":true,"blockOwnerDeletion":false}]},"spec":{"accessModes":["ReadWriteOnce"],"resources":{"requests":{"storage":"10Gi"}},"volumeMode":"Filesystem"},"status":{"phase":"Pending"}}],"serviceName":"rabbitmq-cluster-nodes","podManagementPolicy":"Parallel","updateStrategy":{"type":"RollingUpdate","rollingUpdate":{"partition":0}},"revisionHistoryLimit":10},"status":{"observedGeneration":2,"replicas":3,"readyReplicas":3,"currentReplicas":3,"updatedReplicas":3,"currentRevision":"rabbitmq-cluster-server-5f8b8665fb","updateRevision":"rabbitmq-cluster-server-5f8b8665fb","collisionCount":0}}
2022/03/18 18:02:01 learn_server.go:256: [SIEVE-BEFORE-WRITE]	55
2022/03/18 18:02:01 learn_server.go:263: [SIEVE-AFTER-WRITE]	55	Update	statefulset	github.com/rabbitmq/cluster-operator/controllers.(*RabbitmqClusterReconciler)	NoError	{"metadata":{"name":"rabbitmq-cluster-server","namespace":"default","selfLink":"/apis/apps/v1/namespaces/default/statefulsets/rabbitmq-cluster-server","uid":"cb5c43bc-6ee7-481c-ab01-6f3acffdd3c8","resourceVersion":"1231","generation":2,"creationTimestamp":"2022-03-18T18:00:38Z","labels":{"app.kubernetes.io/component":"rabbitmq","app.kubernetes.io/name":"rabbitmq-cluster","app.kubernetes.io/part-of":"rabbitmq"},"ownerReferences":[{"apiVersion":"rabbitmq.com/v1beta1","kind":"RabbitmqCluster","name":"rabbitmq-cluster","uid":"18d9928b-0d1c-47be-80ec-20960d053827","controller":true,"blockOwnerDeletion":true}],"managedFields":[{"manager":"manager","operation":"Update","apiVersion":"apps/v1","time":"2022-03-18T18:01:23Z","fieldsType":"FieldsV1","fieldsV1":{"f:metadata":{"f:labels":{".":{},"f:app.kubernetes.io/component":{},"f:app.kubernetes.io/name":{},"f:app.kubernetes.io/part-of":{}},"f:ownerReferences":{".":{},"k:{\"uid\":\"18d9928b-0d1c-47be-80ec-20960d053827\"}":{".":{},"f:apiVersion":{},"f:blockOwnerDeletion":{},"f:controller":{},"f:kind":{},"f:name":{},"f:uid":{}}}},"f:spec":{"f:podManagementPolicy":{},"f:replicas":{},"f:revisionHistoryLimit":{},"f:selector":{"f:matchLabels":{".":{},"f:app.kubernetes.io/name":{}}},"f:serviceName":{},"f:template":{"f:metadata":{"f:annotations":{".":{},"f:prometheus.io/port":{},"f:prometheus.io/scrape":{}},"f:labels":{".":{},"f:app.kubernetes.io/component":{},"f:app.kubernetes.io/name":{},"f:app.kubernetes.io/part-of":{}}},"f:spec":{"f:automountServiceAccountToken":{},"f:containers":{"k:{\"name\":\"rabbitmq\"}":{".":{},"f:env":{".":{},"k:{\"name\":\"K8S_HOSTNAME_SUFFIX\"}":{".":{},"f:name":{},"f:value":{}},"k:{\"name\":\"K8S_SERVICE_NAME\"}":{".":{},"f:name":{},"f:value":{}},"k:{\"name\":\"MY_POD_NAME\"}":{".":{},"f:name":{},"f:valueFrom":{".":{},"f:fieldRef":{".":{},"f:apiVersion":{},"f:fieldPath":{}}}},"k:{\"name\":\"MY_POD_NAMESPACE\"}":{".":{},"f:name":{},"f:valueFrom":{".":{},"f:fieldRef":{".":{},"f:apiVersion":{},"f:fieldPath":{}}}},"k:{\"name\":\"RABBITMQ_ENABLED_PLUGINS_FILE\"}":{".":{},"f:name":{},"f:value":{}},"k:{\"name\":\"RABBITMQ_NODENAME\"}":{".":{},"f:name":{},"f:value":{}},"k:{\"name\":\"RABBITMQ_USE_LONGNAME\"}":{".":{},"f:name":{},"f:value":{}}},"f:image":{},"f:imagePullPolicy":{},"f:lifecycle":{".":{},"f:preStop":{".":{},"f:exec":{".":{},"f:command":{}}}},"f:name":{},"f:ports":{".":{},"k:{\"containerPort\":4369,\"protocol\":\"TCP\"}":{".":{},"f:containerPort":{},"f:name":{},"f:protocol":{}},"k:{\"containerPort\":5672,\"protocol\":\"TCP\"}":{".":{},"f:containerPort":{},"f:name":{},"f:protocol":{}},"k:{\"containerPort\":15672,\"protocol\":\"TCP\"}":{".":{},"f:containerPort":{},"f:name":{},"f:protocol":{}},"k:{\"containerPort\":15692,\"protocol\":\"TCP\"}":{".":{},"f:containerPort":{},"f:name":{},"f:protocol":{}}},"f:readinessProbe":{".":{},"f:failureThreshold":{},"f:initialDelaySeconds":{},"f:periodSeconds":{},"f:successThreshold":{},"f:tcpSocket":{".":{},"f:port":{}},"f:timeoutSeconds":{}},"f:resources":{".":{},"f:limits":{".":{},"f:cpu":{},"f:memory":{}},"f:requests":{".":{},"f:cpu":{},"f:memory":{}}},"f:terminationMessagePath":{},"f:terminationMessagePolicy":{},"f:volumeMounts":{".":{},"k:{\"mountPath\":\"/etc/pod-info/\"}":{".":{},"f:mountPath":{},"f:name":{}},"k:{\"mountPath\":\"/etc/rabbitmq/conf.d/10-operatorDefaults.conf\"}":{".":{},"f:mountPath":{},"f:name":{},"f:subPath":{}},"k:{\"mountPath\":\"/etc/rabbitmq/conf.d/11-default_user.conf\"}":{".":{},"f:mountPath":{},"f:name":{},"f:subPath":{}},"k:{\"mountPath\":\"/etc/rabbitmq/conf.d/90-userDefinedConfiguration.conf\"}":{".":{},"f:mountPath":{},"f:name":{},"f:subPath":{}},"k:{\"mountPath\":\"/operator\"}":{".":{},"f:mountPath":{},"f:name":{}},"k:{\"mountPath\":\"/var/lib/rabbitmq/\"}":{".":{},"f:mountPath":{},"f:name":{}},"k:{\"mountPath\":\"/var/lib/rabbitmq/mnesia/\"}":{".":{},"f:mountPath":{},"f:name":{}}}}},"f:dnsPolicy":{},"f:initContainers":{".":{},"k:{\"name\":\"setup-container\"}":{".":{},"f:command":{},"f:image":{},"f:imagePullPolicy":{},"f:name":{},"f:resources":{".":{},"f:limits":{".":{},"f:cpu":{},"f:memory":{}},"f:requests":{".":{},"f:cpu":{},"f:memory":{}}},"f:securityContext":{".":{},"f:capabilities":{".":{},"f:drop":{}},"f:runAsUser":{}},"f:terminationMessagePath":{},"f:terminationMessagePolicy":{},"f:volumeMounts":{".":{},"k:{\"mountPath\":\"/operator\"}":{".":{},"f:mountPath":{},"f:name":{}},"k:{\"mountPath\":\"/tmp/default_user.conf\"}":{".":{},"f:mountPath":{},"f:name":{},"f:subPath":{}},"k:{\"mountPath\":\"/tmp/erlang-cookie-secret/\"}":{".":{},"f:mountPath":{},"f:name":{}},"k:{\"mountPath\":\"/tmp/rabbitmq-plugins/\"}":{".":{},"f:mountPath":{},"f:name":{}},"k:{\"mountPath\":\"/var/lib/rabbitmq/\"}":{".":{},"f:mountPath":{},"f:name":{}},"k:{\"mountPath\":\"/var/lib/rabbitmq/mnesia/\"}":{".":{},"f:mountPath":{},"f:name":{}}}}},"f:restartPolicy":{},"f:schedulerName":{},"f:securityContext":{".":{},"f:fsGroup":{},"f:runAsGroup":{},"f:runAsUser":{}},"f:serviceAccount":{},"f:serviceAccountName":{},"f:terminationGracePeriodSeconds":{},"f:topologySpreadConstraints":{".":{},"k:{\"topologyKey\":\"topology.kubernetes.io/zone\",\"whenUnsatisfiable\":\"ScheduleAnyway\"}":{".":{},"f:labelSelector":{".":{},"f:matchLabels":{".":{},"f:app.kubernetes.io/name":{}}},"f:maxSkew":{},"f:topologyKey":{},"f:whenUnsatisfiable":{}}},"f:volumes":{".":{},"k:{\"name\":\"erlang-cookie-secret\"}":{".":{},"f:name":{},"f:secret":{".":{},"f:defaultMode":{},"f:secretName":{}}},"k:{\"name\":\"plugins-conf\"}":{".":{},"f:configMap":{".":{},"f:defaultMode":{},"f:name":{}},"f:name":{}},"k:{\"name\":\"pod-info\"}":{".":{},"f:downwardAPI":{".":{},"f:defaultMode":{},"f:items":{}},"f:name":{}},"k:{\"name\":\"rabbitmq-confd\"}":{".":{},"f:name":{},"f:projected":{".":{},"f:defaultMode":{},"f:sources":{}}},"k:{\"name\":\"rabbitmq-erlang-cookie\"}":{".":{},"f:emptyDir":{},"f:name":{}},"k:{\"name\":\"rabbitmq-plugins\"}":{".":{},"f:emptyDir":{},"f:name":{}}}}},"f:updateStrategy":{"f:rollingUpdate":{".":{},"f:partition":{}},"f:type":{}},"f:volumeClaimTemplates":{}}}},{"manager":"kube-controller-manager","operation":"Update","apiVersion":"apps/v1","time":"2022-03-18T18:02:01Z","fieldsType":"FieldsV1","fieldsV1":{"f:status":{"f:collisionCount":{},"f:currentReplicas":{},"f:currentRevision":{},"f:observedGeneration":{},"f:readyReplicas":{},"f:replicas":{},"f:updateRevision":{},"f:updatedReplicas":{}}}}]},"spec":{"replicas":3,"selector":{"matchLabels":{"app.kubernetes.io/name":"rabbitmq-cluster"}},"template":{"metadata":{"creationTimestamp":null,"labels":{"app.kubernetes.io/component":"rabbitmq","app.kubernetes.io/name":"rabbitmq-cluster","app.kubernetes.io/part-of":"rabbitmq"},"annotations":{"prometheus.io/port":"15692","prometheus.io/scrape":"true"}},"spec":{"volumes":[{"name":"plugins-conf","configMap":{"name":"rabbitmq-cluster-plugins-conf","defaultMode":420}},{"name":"rabbitmq-confd","projected":{"sources":[{"secret":{"name":"rabbitmq-cluster-default-user","items":[{"key":"default_user.conf","path":"default_user.conf"}]}},{"configMap":{"name":"rabbitmq-cluster-server-conf","items":[{"key":"operatorDefaults.conf","path":"operatorDefaults.conf"},{"key":"userDefinedConfiguration.conf","path":"userDefinedConfiguration.conf"}]}}],"defaultMode":420}},{"name":"rabbitmq-erlang-cookie","emptyDir":{}},{"name":"erlang-cookie-secret","secret":{"secretName":"rabbitmq-cluster-erlang-cookie","defaultMode":420}},{"name":"rabbitmq-plugins","emptyDir":{}},{"name":"pod-info","downwardAPI":{"items":[{"path":"skipPreStopChecks","fieldRef":{"apiVersion":"v1","fieldPath":"metadata.labels['skipPreStopChecks']"}}],"defaultMode":420}}],"initContainers":[{"name":"setup-container","image":"rabbitmq:3.8.12-management","command":["sh","-c","cp /tmp/erlang-cookie-secret/.erlang.cookie /var/lib/rabbitmq/.erlang.cookie \u0026\u0026 chown 999:999 /var/lib/rabbitmq/.erlang.cookie \u0026\u0026 chmod 600 /var/lib/rabbitmq/.erlang.cookie ; cp /tmp/rabbitmq-plugins/enabled_plugins /operator/enabled_plugins \u0026\u0026 chown 999:999 /operator/enabled_plugins ; chown 999:999 /var/lib/rabbitmq/mnesia/ ; echo '[default]' \u003e /var/lib/rabbitmq/.rabbitmqadmin.conf \u0026\u0026 sed -e 's/default_user/username/' -e 's/default_pass/password/' /tmp/default_user.conf \u003e\u003e /var/lib/rabbitmq/.rabbitmqadmin.conf \u0026\u0026 chown 999:999 /var/lib/rabbitmq/.rabbitmqadmin.conf \u0026\u0026 chmod 600 /var/lib/rabbitmq/.rabbitmqadmin.conf"],"resources":{"limits":{"cpu":"100m","memory":"500Mi"},"requests":{"cpu":"100m","memory":"500Mi"}},"volumeMounts":[{"name":"plugins-conf","mountPath":"/tmp/rabbitmq-plugins/"},{"name":"rabbitmq-erlang-cookie","mountPath":"/var/lib/rabbitmq/"},{"name":"erlang-cookie-secret","mountPath":"/tmp/erlang-cookie-secret/"},{"name":"rabbitmq-plugins","mountPath":"/operator"},{"name":"persistence","mountPath":"/var/lib/rabbitmq/mnesia/"},{"name":"rabbitmq-confd","mountPath":"/tmp/default_user.conf","subPath":"default_user.conf"}],"terminationMessagePath":"/dev/termination-log","terminationMessagePolicy":"File","imagePullPolicy":"IfNotPresent","securityContext":{"capabilities":{"drop":["FSETID","KILL","SETGID","SETUID","SETPCAP","NET_BIND_SERVICE","NET_RAW","SYS_CHROOT","MKNOD","AUDIT_WRITE","SETFCAP"]},"runAsUser":0}}],"containers":[{"name":"rabbitmq","image":"rabbitmq:3.8.12-management","ports":[{"name":"epmd","containerPort":4369,"protocol":"TCP"},{"name":"amqp","containerPort":5672,"protocol":"TCP"},{"name":"management","containerPort":15672,"protocol":"TCP"},{"name":"prometheus","containerPort":15692,"protocol":"TCP"}],"env":[{"name":"MY_POD_NAME","valueFrom":{"fieldRef":{"apiVersion":"v1","fieldPath":"metadata.name"}}},{"name":"MY_POD_NAMESPACE","valueFrom":{"fieldRef":{"apiVersion":"v1","fieldPath":"metadata.namespace"}}},{"name":"RABBITMQ_ENABLED_PLUGINS_FILE","value":"/operator/enabled_plugins"},{"name":"K8S_SERVICE_NAME","value":"rabbitmq-cluster-nodes"},{"name":"RABBITMQ_USE_LONGNAME","value":"true"},{"name":"RABBITMQ_NODENAME","value":"rabbit@$(MY_POD_NAME).$(K8S_SERVICE_NAME).$(MY_POD_NAMESPACE)"},{"name":"K8S_HOSTNAME_SUFFIX","value":".$(K8S_SERVICE_NAME).$(MY_POD_NAMESPACE)"}],"resources":{"limits":{"cpu":"2","memory":"2Gi"},"requests":{"cpu":"1","memory":"2Gi"}},"volumeMounts":[{"name":"rabbitmq-erlang-cookie","mountPath":"/var/lib/rabbitmq/"},{"name":"persistence","mountPath":"/var/lib/rabbitmq/mnesia/"},{"name":"rabbitmq-plugins","mountPath":"/operator"},{"name":"rabbitmq-confd","mountPath":"/etc/rabbitmq/conf.d/10-operatorDefaults.conf","subPath":"operatorDefaults.conf"},{"name":"rabbitmq-confd","mountPath":"/etc/rabbitmq/conf.d/11-default_user.conf","subPath":"default_user.conf"},{"name":"rabbitmq-confd","mountPath":"/etc/rabbitmq/conf.d/90-userDefinedConfiguration.conf","subPath":"userDefinedConfiguration.conf"},{"name":"pod-info","mountPath":"/etc/pod-info/"}],"readinessProbe":{"tcpSocket":{"port":"amqp"},"initialDelaySeconds":10,"timeoutSeconds":5,"periodSeconds":10,"successThreshold":1,"failureThreshold":3},"lifecycle":{"preStop":{"exec":{"command":["/bin/bash","-c","if [ ! -z \"$(cat /etc/pod-info/skipPreStopChecks)\" ]; then exit 0; fi; rabbitmq-upgrade await_online_quorum_plus_one -t 604800; rabbitmq-upgrade await_online_synchronized_mirror -t 604800; rabbitmq-upgrade drain -t 604800"]}}},"terminationMessagePath":"/dev/termination-log","terminationMessagePolicy":"File","imagePullPolicy":"IfNotPresent"}],"restartPolicy":"Always","terminationGracePeriodSeconds":604800,"dnsPolicy":"ClusterFirst","serviceAccountName":"rabbitmq-cluster-server","serviceAccount":"rabbitmq-cluster-server","automountServiceAccountToken":true,"securityContext":{"runAsUser":999,"runAsGroup":999,"fsGroup":999},"schedulerName":"default-scheduler","topologySpreadConstraints":[{"maxSkew":1,"topologyKey":"topology.kubernetes.io/zone","whenUnsatisfiable":"ScheduleAnyway","labelSelector":{"matchLabels":{"app.kubernetes.io/name":"rabbitmq-cluster"}}}]}},"volumeClaimTemplates":[{"metadata":{"name":"persistence","namespace":"default","creationTimestamp":null,"labels":{"app.kubernetes.io/component":"rabbitmq","app.kubernetes.io/name":"rabbitmq-cluster","app.kubernetes.io/part-of":"rabbitmq"},"ownerReferences":[{"apiVersion":"rabbitmq.com/v1beta1","kind":"RabbitmqCluster","name":"rabbitmq-cluster","uid":"18d9928b-0d1c-47be-80ec-20960d053827","controller":true,"blockOwnerDeletion":false}]},"spec":{"accessModes":["ReadWriteOnce"],"resources":{"requests":{"storage":"10Gi"}},"volumeMode":"Filesystem"},"status":{"phase":"Pending"}}],"serviceName":"rabbitmq-cluster-nodes","podManagementPolicy":"Parallel","updateStrategy":{"type":"RollingUpdate","rollingUpdate":{"partition":0}},"revisionHistoryLimit":10},"status":{"observedGeneration":2,"replicas":3,"readyReplicas":3,"currentReplicas":3,"updatedReplicas":3,"currentRevision":"rabbitmq-cluster-server-5f8b8665fb","updateRevision":"rabbitmq-cluster-server-5f8b8665fb","collisionCount":0}}
2022/03/18 18:02:01 learn_server.go:291: [SIEVE-AFTER-READ]	Get	true	configmap	default	rabbitmq-cluster-server-conf	github.com/rabbitmq/cluster-operator/controllers.(*RabbitmqClusterReconciler)	NoError	{"kind":"ConfigMap","apiVersion":"v1","metadata":{"name":"rabbitmq-cluster-server-conf","namespace":"default","selfLink":"/api/v1/namespaces/default/configmaps/rabbitmq-cluster-server-conf","uid":"22474f2b-8454-44b7-8079-8990223969cc","resourceVersion":"714","creationTimestamp":"2022-03-18T18:00:38Z","labels":{"app.kubernetes.io/component":"rabbitmq","app.kubernetes.io/name":"rabbitmq-cluster","app.kubernetes.io/part-of":"rabbitmq"},"ownerReferences":[{"apiVersion":"rabbitmq.com/v1beta1","kind":"RabbitmqCluster","name":"rabbitmq-cluster","uid":"18d9928b-0d1c-47be-80ec-20960d053827","controller":true,"blockOwnerDeletion":true}],"managedFields":[{"manager":"manager","operation":"Update","apiVersion":"v1","time":"2022-03-18T18:00:38Z","fieldsType":"FieldsV1","fieldsV1":{"f:data":{".":{},"f:operatorDefaults.conf":{},"f:userDefinedConfiguration.conf":{}},"f:metadata":{"f:labels":{".":{},"f:app.kubernetes.io/component":{},"f:app.kubernetes.io/name":{},"f:app.kubernetes.io/part-of":{}},"f:ownerReferences":{".":{},"k:{\"uid\":\"18d9928b-0d1c-47be-80ec-20960d053827\"}":{".":{},"f:apiVersion":{},"f:blockOwnerDeletion":{},"f:controller":{},"f:kind":{},"f:name":{},"f:uid":{}}}}}}]},"data":{"operatorDefaults.conf":"cluster_formation.peer_discovery_backend             = rabbit_peer_discovery_k8s\ncluster_formation.k8s.host                           = kubernetes.default\ncluster_formation.k8s.address_type                   = hostname\ncluster_partition_handling                           = pause_minority\nqueue_master_locator                                 = min-masters\ndisk_free_limit.absolute                             = 2GB\ncluster_formation.randomized_startup_delay_range.min = 5\ncluster_formation.randomized_startup_delay_range.max = 30\ncluster_name                                         = rabbitmq-cluster\n","userDefinedConfiguration.conf":"total_memory_available_override_value = 1717986919\n"}}
2022/03/18 18:02:01 learn_server.go:256: [SIEVE-BEFORE-WRITE]	56
2022/03/18 18:02:01 learn_server.go:263: [SIEVE-AFTER-WRITE]	56	StatusUpdate	rabbitmqcluster	github.com/rabbitmq/cluster-operator/controllers.(*RabbitmqClusterReconciler)	NoError	{"metadata":{"name":"rabbitmq-cluster","namespace":"default","selfLink":"/apis/rabbitmq.com/v1beta1/namespaces/default/rabbitmqclusters/rabbitmq-cluster/status","uid":"18d9928b-0d1c-47be-80ec-20960d053827","resourceVersion":"1232","generation":3,"creationTimestamp":"2022-03-18T18:00:38Z","annotations":{"kubectl.kubernetes.io/last-applied-configuration":"{\"apiVersion\":\"rabbitmq.com/v1beta1\",\"kind\":\"RabbitmqCluster\",\"metadata\":{\"annotations\":{},\"name\":\"rabbitmq-cluster\",\"namespace\":\"default\"},\"spec\":{\"persistence\":{\"storage\":\"10Gi\"},\"replicas\":1}}\n"},"finalizers":["deletion.finalizers.rabbitmqclusters.rabbitmq.com"],"managedFields":[{"manager":"kubectl-client-side-apply","operation":"Update","apiVersion":"rabbitmq.com/v1beta1","time":"2022-03-18T18:00:38Z","fieldsType":"FieldsV1","fieldsV1":{"f:metadata":{"f:annotations":{".":{},"f:kubectl.kubernetes.io/last-applied-configuration":{}}},"f:spec":{".":{},"f:image":{},"f:persistence":{".":{},"f:storage":{}},"f:resources":{".":{},"f:limits":{".":{},"f:memory":{}},"f:requests":{".":{},"f:memory":{}}},"f:service":{".":{},"f:type":{}},"f:terminationGracePeriodSeconds":{}}}},{"manager":"kubectl-patch","operation":"Update","apiVersion":"rabbitmq.com/v1beta1","time":"2022-03-18T18:01:23Z","fieldsType":"FieldsV1","fieldsV1":{"f:spec":{"f:replicas":{}}}},{"manager":"manager","operation":"Update","apiVersion":"rabbitmq.com/v1beta1","time":"2022-03-18T18:02:01Z","fieldsType":"FieldsV1","fieldsV1":{"f:metadata":{"f:finalizers":{}},"f:spec":{"f:override":{},"f:rabbitmq":{},"f:resources":{"f:limits":{"f:cpu":{}},"f:requests":{"f:cpu":{}}},"f:tls":{}},"f:status":{".":{},"f:conditions":{},"f:defaultUser":{".":{},"f:secretReference":{".":{},"f:keys":{".":{},"f:password":{},"f:username":{}},"f:name":{},"f:namespace":{}},"f:serviceReference":{".":{},"f:name":{},"f:namespace":{}}}}}}]},"spec":{"replicas":3,"image":"rabbitmq:3.8.12-management","service":{"type":"ClusterIP"},"persistence":{"storage":"10Gi"},"resources":{"limits":{"cpu":"2","memory":"2Gi"},"requests":{"cpu":"1","memory":"2Gi"}},"rabbitmq":{},"tls":{},"override":{},"terminationGracePeriodSeconds":604800},"status":{"conditions":[{"type":"AllReplicasReady","status":"True","lastTransitionTime":"2022-03-18T18:02:01Z","reason":"AllPodsAreReady"},{"type":"ClusterAvailable","status":"True","lastTransitionTime":"2022-03-18T18:01:17Z","reason":"AtLeastOneEndpointAvailable"},{"type":"NoWarnings","status":"True","lastTransitionTime":"2022-03-18T18:00:38Z","reason":"NoWarnings"},{"type":"ReconcileSuccess","status":"True","lastTransitionTime":"2022-03-18T18:01:18Z","reason":"Success","message":"Finish reconciling"}],"defaultUser":{"secretReference":{"name":"rabbitmq-cluster-default-user","namespace":"default","keys":{"password":"password","username":"username"}},"serviceReference":{"name":"rabbitmq-cluster","namespace":"default"}},"binding":{"name":"rabbitmq-cluster-default-user"}}}
2022/03/18 18:02:01 learn_server.go:291: [SIEVE-AFTER-READ]	Get	true	statefulset	default	rabbitmq-cluster-server	github.com/rabbitmq/cluster-operator/controllers.(*RabbitmqClusterReconciler)	NoError	{"kind":"StatefulSet","apiVersion":"apps/v1","metadata":{"name":"rabbitmq-cluster-server","namespace":"default","selfLink":"/apis/apps/v1/namespaces/default/statefulsets/rabbitmq-cluster-server","uid":"cb5c43bc-6ee7-481c-ab01-6f3acffdd3c8","resourceVersion":"1231","generation":2,"creationTimestamp":"2022-03-18T18:00:38Z","labels":{"app.kubernetes.io/component":"rabbitmq","app.kubernetes.io/name":"rabbitmq-cluster","app.kubernetes.io/part-of":"rabbitmq"},"ownerReferences":[{"apiVersion":"rabbitmq.com/v1beta1","kind":"RabbitmqCluster","name":"rabbitmq-cluster","uid":"18d9928b-0d1c-47be-80ec-20960d053827","controller":true,"blockOwnerDeletion":true}],"managedFields":[{"manager":"manager","operation":"Update","apiVersion":"apps/v1","time":"2022-03-18T18:01:23Z","fieldsType":"FieldsV1","fieldsV1":{"f:metadata":{"f:labels":{".":{},"f:app.kubernetes.io/component":{},"f:app.kubernetes.io/name":{},"f:app.kubernetes.io/part-of":{}},"f:ownerReferences":{".":{},"k:{\"uid\":\"18d9928b-0d1c-47be-80ec-20960d053827\"}":{".":{},"f:apiVersion":{},"f:blockOwnerDeletion":{},"f:controller":{},"f:kind":{},"f:name":{},"f:uid":{}}}},"f:spec":{"f:podManagementPolicy":{},"f:replicas":{},"f:revisionHistoryLimit":{},"f:selector":{"f:matchLabels":{".":{},"f:app.kubernetes.io/name":{}}},"f:serviceName":{},"f:template":{"f:metadata":{"f:annotations":{".":{},"f:prometheus.io/port":{},"f:prometheus.io/scrape":{}},"f:labels":{".":{},"f:app.kubernetes.io/component":{},"f:app.kubernetes.io/name":{},"f:app.kubernetes.io/part-of":{}}},"f:spec":{"f:automountServiceAccountToken":{},"f:containers":{"k:{\"name\":\"rabbitmq\"}":{".":{},"f:env":{".":{},"k:{\"name\":\"K8S_HOSTNAME_SUFFIX\"}":{".":{},"f:name":{},"f:value":{}},"k:{\"name\":\"K8S_SERVICE_NAME\"}":{".":{},"f:name":{},"f:value":{}},"k:{\"name\":\"MY_POD_NAME\"}":{".":{},"f:name":{},"f:valueFrom":{".":{},"f:fieldRef":{".":{},"f:apiVersion":{},"f:fieldPath":{}}}},"k:{\"name\":\"MY_POD_NAMESPACE\"}":{".":{},"f:name":{},"f:valueFrom":{".":{},"f:fieldRef":{".":{},"f:apiVersion":{},"f:fieldPath":{}}}},"k:{\"name\":\"RABBITMQ_ENABLED_PLUGINS_FILE\"}":{".":{},"f:name":{},"f:value":{}},"k:{\"name\":\"RABBITMQ_NODENAME\"}":{".":{},"f:name":{},"f:value":{}},"k:{\"name\":\"RABBITMQ_USE_LONGNAME\"}":{".":{},"f:name":{},"f:value":{}}},"f:image":{},"f:imagePullPolicy":{},"f:lifecycle":{".":{},"f:preStop":{".":{},"f:exec":{".":{},"f:command":{}}}},"f:name":{},"f:ports":{".":{},"k:{\"containerPort\":4369,\"protocol\":\"TCP\"}":{".":{},"f:containerPort":{},"f:name":{},"f:protocol":{}},"k:{\"containerPort\":5672,\"protocol\":\"TCP\"}":{".":{},"f:containerPort":{},"f:name":{},"f:protocol":{}},"k:{\"containerPort\":15672,\"protocol\":\"TCP\"}":{".":{},"f:containerPort":{},"f:name":{},"f:protocol":{}},"k:{\"containerPort\":15692,\"protocol\":\"TCP\"}":{".":{},"f:containerPort":{},"f:name":{},"f:protocol":{}}},"f:readinessProbe":{".":{},"f:failureThreshold":{},"f:initialDelaySeconds":{},"f:periodSeconds":{},"f:successThreshold":{},"f:tcpSocket":{".":{},"f:port":{}},"f:timeoutSeconds":{}},"f:resources":{".":{},"f:limits":{".":{},"f:cpu":{},"f:memory":{}},"f:requests":{".":{},"f:cpu":{},"f:memory":{}}},"f:terminationMessagePath":{},"f:terminationMessagePolicy":{},"f:volumeMounts":{".":{},"k:{\"mountPath\":\"/etc/pod-info/\"}":{".":{},"f:mountPath":{},"f:name":{}},"k:{\"mountPath\":\"/etc/rabbitmq/conf.d/10-operatorDefaults.conf\"}":{".":{},"f:mountPath":{},"f:name":{},"f:subPath":{}},"k:{\"mountPath\":\"/etc/rabbitmq/conf.d/11-default_user.conf\"}":{".":{},"f:mountPath":{},"f:name":{},"f:subPath":{}},"k:{\"mountPath\":\"/etc/rabbitmq/conf.d/90-userDefinedConfiguration.conf\"}":{".":{},"f:mountPath":{},"f:name":{},"f:subPath":{}},"k:{\"mountPath\":\"/operator\"}":{".":{},"f:mountPath":{},"f:name":{}},"k:{\"mountPath\":\"/var/lib/rabbitmq/\"}":{".":{},"f:mountPath":{},"f:name":{}},"k:{\"mountPath\":\"/var/lib/rabbitmq/mnesia/\"}":{".":{},"f:mountPath":{},"f:name":{}}}}},"f:dnsPolicy":{},"f:initContainers":{".":{},"k:{\"name\":\"setup-container\"}":{".":{},"f:command":{},"f:image":{},"f:imagePullPolicy":{},"f:name":{},"f:resources":{".":{},"f:limits":{".":{},"f:cpu":{},"f:memory":{}},"f:requests":{".":{},"f:cpu":{},"f:memory":{}}},"f:securityContext":{".":{},"f:capabilities":{".":{},"f:drop":{}},"f:runAsUser":{}},"f:terminationMessagePath":{},"f:terminationMessagePolicy":{},"f:volumeMounts":{".":{},"k:{\"mountPath\":\"/operator\"}":{".":{},"f:mountPath":{},"f:name":{}},"k:{\"mountPath\":\"/tmp/default_user.conf\"}":{".":{},"f:mountPath":{},"f:name":{},"f:subPath":{}},"k:{\"mountPath\":\"/tmp/erlang-cookie-secret/\"}":{".":{},"f:mountPath":{},"f:name":{}},"k:{\"mountPath\":\"/tmp/rabbitmq-plugins/\"}":{".":{},"f:mountPath":{},"f:name":{}},"k:{\"mountPath\":\"/var/lib/rabbitmq/\"}":{".":{},"f:mountPath":{},"f:name":{}},"k:{\"mountPath\":\"/var/lib/rabbitmq/mnesia/\"}":{".":{},"f:mountPath":{},"f:name":{}}}}},"f:restartPolicy":{},"f:schedulerName":{},"f:securityContext":{".":{},"f:fsGroup":{},"f:runAsGroup":{},"f:runAsUser":{}},"f:serviceAccount":{},"f:serviceAccountName":{},"f:terminationGracePeriodSeconds":{},"f:topologySpreadConstraints":{".":{},"k:{\"topologyKey\":\"topology.kubernetes.io/zone\",\"whenUnsatisfiable\":\"ScheduleAnyway\"}":{".":{},"f:labelSelector":{".":{},"f:matchLabels":{".":{},"f:app.kubernetes.io/name":{}}},"f:maxSkew":{},"f:topologyKey":{},"f:whenUnsatisfiable":{}}},"f:volumes":{".":{},"k:{\"name\":\"erlang-cookie-secret\"}":{".":{},"f:name":{},"f:secret":{".":{},"f:defaultMode":{},"f:secretName":{}}},"k:{\"name\":\"plugins-conf\"}":{".":{},"f:configMap":{".":{},"f:defaultMode":{},"f:name":{}},"f:name":{}},"k:{\"name\":\"pod-info\"}":{".":{},"f:downwardAPI":{".":{},"f:defaultMode":{},"f:items":{}},"f:name":{}},"k:{\"name\":\"rabbitmq-confd\"}":{".":{},"f:name":{},"f:projected":{".":{},"f:defaultMode":{},"f:sources":{}}},"k:{\"name\":\"rabbitmq-erlang-cookie\"}":{".":{},"f:emptyDir":{},"f:name":{}},"k:{\"name\":\"rabbitmq-plugins\"}":{".":{},"f:emptyDir":{},"f:name":{}}}}},"f:updateStrategy":{"f:rollingUpdate":{".":{},"f:partition":{}},"f:type":{}},"f:volumeClaimTemplates":{}}}},{"manager":"kube-controller-manager","operation":"Update","apiVersion":"apps/v1","time":"2022-03-18T18:02:01Z","fieldsType":"FieldsV1","fieldsV1":{"f:status":{"f:collisionCount":{},"f:currentReplicas":{},"f:currentRevision":{},"f:observedGeneration":{},"f:readyReplicas":{},"f:replicas":{},"f:updateRevision":{},"f:updatedReplicas":{}}}}]},"spec":{"replicas":3,"selector":{"matchLabels":{"app.kubernetes.io/name":"rabbitmq-cluster"}},"template":{"metadata":{"creationTimestamp":null,"labels":{"app.kubernetes.io/component":"rabbitmq","app.kubernetes.io/name":"rabbitmq-cluster","app.kubernetes.io/part-of":"rabbitmq"},"annotations":{"prometheus.io/port":"15692","prometheus.io/scrape":"true"}},"spec":{"volumes":[{"name":"plugins-conf","configMap":{"name":"rabbitmq-cluster-plugins-conf","defaultMode":420}},{"name":"rabbitmq-confd","projected":{"sources":[{"secret":{"name":"rabbitmq-cluster-default-user","items":[{"key":"default_user.conf","path":"default_user.conf"}]}},{"configMap":{"name":"rabbitmq-cluster-server-conf","items":[{"key":"operatorDefaults.conf","path":"operatorDefaults.conf"},{"key":"userDefinedConfiguration.conf","path":"userDefinedConfiguration.conf"}]}}],"defaultMode":420}},{"name":"rabbitmq-erlang-cookie","emptyDir":{}},{"name":"erlang-cookie-secret","secret":{"secretName":"rabbitmq-cluster-erlang-cookie","defaultMode":420}},{"name":"rabbitmq-plugins","emptyDir":{}},{"name":"pod-info","downwardAPI":{"items":[{"path":"skipPreStopChecks","fieldRef":{"apiVersion":"v1","fieldPath":"metadata.labels['skipPreStopChecks']"}}],"defaultMode":420}}],"initContainers":[{"name":"setup-container","image":"rabbitmq:3.8.12-management","command":["sh","-c","cp /tmp/erlang-cookie-secret/.erlang.cookie /var/lib/rabbitmq/.erlang.cookie \u0026\u0026 chown 999:999 /var/lib/rabbitmq/.erlang.cookie \u0026\u0026 chmod 600 /var/lib/rabbitmq/.erlang.cookie ; cp /tmp/rabbitmq-plugins/enabled_plugins /operator/enabled_plugins \u0026\u0026 chown 999:999 /operator/enabled_plugins ; chown 999:999 /var/lib/rabbitmq/mnesia/ ; echo '[default]' \u003e /var/lib/rabbitmq/.rabbitmqadmin.conf \u0026\u0026 sed -e 's/default_user/username/' -e 's/default_pass/password/' /tmp/default_user.conf \u003e\u003e /var/lib/rabbitmq/.rabbitmqadmin.conf \u0026\u0026 chown 999:999 /var/lib/rabbitmq/.rabbitmqadmin.conf \u0026\u0026 chmod 600 /var/lib/rabbitmq/.rabbitmqadmin.conf"],"resources":{"limits":{"cpu":"100m","memory":"500Mi"},"requests":{"cpu":"100m","memory":"500Mi"}},"volumeMounts":[{"name":"plugins-conf","mountPath":"/tmp/rabbitmq-plugins/"},{"name":"rabbitmq-erlang-cookie","mountPath":"/var/lib/rabbitmq/"},{"name":"erlang-cookie-secret","mountPath":"/tmp/erlang-cookie-secret/"},{"name":"rabbitmq-plugins","mountPath":"/operator"},{"name":"persistence","mountPath":"/var/lib/rabbitmq/mnesia/"},{"name":"rabbitmq-confd","mountPath":"/tmp/default_user.conf","subPath":"default_user.conf"}],"terminationMessagePath":"/dev/termination-log","terminationMessagePolicy":"File","imagePullPolicy":"IfNotPresent","securityContext":{"capabilities":{"drop":["FSETID","KILL","SETGID","SETUID","SETPCAP","NET_BIND_SERVICE","NET_RAW","SYS_CHROOT","MKNOD","AUDIT_WRITE","SETFCAP"]},"runAsUser":0}}],"containers":[{"name":"rabbitmq","image":"rabbitmq:3.8.12-management","ports":[{"name":"epmd","containerPort":4369,"protocol":"TCP"},{"name":"amqp","containerPort":5672,"protocol":"TCP"},{"name":"management","containerPort":15672,"protocol":"TCP"},{"name":"prometheus","containerPort":15692,"protocol":"TCP"}],"env":[{"name":"MY_POD_NAME","valueFrom":{"fieldRef":{"apiVersion":"v1","fieldPath":"metadata.name"}}},{"name":"MY_POD_NAMESPACE","valueFrom":{"fieldRef":{"apiVersion":"v1","fieldPath":"metadata.namespace"}}},{"name":"RABBITMQ_ENABLED_PLUGINS_FILE","value":"/operator/enabled_plugins"},{"name":"K8S_SERVICE_NAME","value":"rabbitmq-cluster-nodes"},{"name":"RABBITMQ_USE_LONGNAME","value":"true"},{"name":"RABBITMQ_NODENAME","value":"rabbit@$(MY_POD_NAME).$(K8S_SERVICE_NAME).$(MY_POD_NAMESPACE)"},{"name":"K8S_HOSTNAME_SUFFIX","value":".$(K8S_SERVICE_NAME).$(MY_POD_NAMESPACE)"}],"resources":{"limits":{"cpu":"2","memory":"2Gi"},"requests":{"cpu":"1","memory":"2Gi"}},"volumeMounts":[{"name":"rabbitmq-erlang-cookie","mountPath":"/var/lib/rabbitmq/"},{"name":"persistence","mountPath":"/var/lib/rabbitmq/mnesia/"},{"name":"rabbitmq-plugins","mountPath":"/operator"},{"name":"rabbitmq-confd","mountPath":"/etc/rabbitmq/conf.d/10-operatorDefaults.conf","subPath":"operatorDefaults.conf"},{"name":"rabbitmq-confd","mountPath":"/etc/rabbitmq/conf.d/11-default_user.conf","subPath":"default_user.conf"},{"name":"rabbitmq-confd","mountPath":"/etc/rabbitmq/conf.d/90-userDefinedConfiguration.conf","subPath":"userDefinedConfiguration.conf"},{"name":"pod-info","mountPath":"/etc/pod-info/"}],"readinessProbe":{"tcpSocket":{"port":"amqp"},"initialDelaySeconds":10,"timeoutSeconds":5,"periodSeconds":10,"successThreshold":1,"failureThreshold":3},"lifecycle":{"preStop":{"exec":{"command":["/bin/bash","-c","if [ ! -z \"$(cat /etc/pod-info/skipPreStopChecks)\" ]; then exit 0; fi; rabbitmq-upgrade await_online_quorum_plus_one -t 604800; rabbitmq-upgrade await_online_synchronized_mirror -t 604800; rabbitmq-upgrade drain -t 604800"]}}},"terminationMessagePath":"/dev/termination-log","terminationMessagePolicy":"File","imagePullPolicy":"IfNotPresent"}],"restartPolicy":"Always","terminationGracePeriodSeconds":604800,"dnsPolicy":"ClusterFirst","serviceAccountName":"rabbitmq-cluster-server","serviceAccount":"rabbitmq-cluster-server","automountServiceAccountToken":true,"securityContext":{"runAsUser":999,"runAsGroup":999,"fsGroup":999},"schedulerName":"default-scheduler","topologySpreadConstraints":[{"maxSkew":1,"topologyKey":"topology.kubernetes.io/zone","whenUnsatisfiable":"ScheduleAnyway","labelSelector":{"matchLabels":{"app.kubernetes.io/name":"rabbitmq-cluster"}}}]}},"volumeClaimTemplates":[{"metadata":{"name":"persistence","namespace":"default","creationTimestamp":null,"labels":{"app.kubernetes.io/component":"rabbitmq","app.kubernetes.io/name":"rabbitmq-cluster","app.kubernetes.io/part-of":"rabbitmq"},"ownerReferences":[{"apiVersion":"rabbitmq.com/v1beta1","kind":"RabbitmqCluster","name":"rabbitmq-cluster","uid":"18d9928b-0d1c-47be-80ec-20960d053827","controller":true,"blockOwnerDeletion":false}]},"spec":{"accessModes":["ReadWriteOnce"],"resources":{"requests":{"storage":"10Gi"}},"volumeMode":"Filesystem"},"status":{"phase":"Pending"}}],"serviceName":"rabbitmq-cluster-nodes","podManagementPolicy":"Parallel","updateStrategy":{"type":"RollingUpdate","rollingUpdate":{"partition":0}},"revisionHistoryLimit":10},"status":{"observedGeneration":2,"replicas":3,"readyReplicas":3,"currentReplicas":3,"updatedReplicas":3,"currentRevision":"rabbitmq-cluster-server-5f8b8665fb","updateRevision":"rabbitmq-cluster-server-5f8b8665fb","collisionCount":0}}
2022/03/18 18:02:01 learn_server.go:291: [SIEVE-AFTER-READ]	Get	true	configmap	default	rabbitmq-cluster-plugins-conf	github.com/rabbitmq/cluster-operator/controllers.(*RabbitmqClusterReconciler)	NoError	{"kind":"ConfigMap","apiVersion":"v1","metadata":{"name":"rabbitmq-cluster-plugins-conf","namespace":"default","selfLink":"/api/v1/namespaces/default/configmaps/rabbitmq-cluster-plugins-conf","uid":"a164075b-0562-47ac-a577-99aa8651ec40","resourceVersion":"709","creationTimestamp":"2022-03-18T18:00:38Z","labels":{"app.kubernetes.io/component":"rabbitmq","app.kubernetes.io/name":"rabbitmq-cluster","app.kubernetes.io/part-of":"rabbitmq"},"ownerReferences":[{"apiVersion":"rabbitmq.com/v1beta1","kind":"RabbitmqCluster","name":"rabbitmq-cluster","uid":"18d9928b-0d1c-47be-80ec-20960d053827","controller":true,"blockOwnerDeletion":true}],"managedFields":[{"manager":"manager","operation":"Update","apiVersion":"v1","time":"2022-03-18T18:00:38Z","fieldsType":"FieldsV1","fieldsV1":{"f:data":{".":{},"f:enabled_plugins":{}},"f:metadata":{"f:labels":{".":{},"f:app.kubernetes.io/component":{},"f:app.kubernetes.io/name":{},"f:app.kubernetes.io/part-of":{}},"f:ownerReferences":{".":{},"k:{\"uid\":\"18d9928b-0d1c-47be-80ec-20960d053827\"}":{".":{},"f:apiVersion":{},"f:blockOwnerDeletion":{},"f:controller":{},"f:kind":{},"f:name":{},"f:uid":{}}}}}}]},"data":{"enabled_plugins":"[rabbitmq_peer_discovery_k8s,rabbitmq_prometheus,rabbitmq_management]."}}
2022/03/18 18:02:01 learn_server.go:256: [SIEVE-BEFORE-WRITE]	57
2022/03/18 18:02:01 learn_server.go:263: [SIEVE-AFTER-WRITE]	57	StatusUpdate	rabbitmqcluster	github.com/rabbitmq/cluster-operator/controllers.(*RabbitmqClusterReconciler)	NoError	{"metadata":{"name":"rabbitmq-cluster","namespace":"default","selfLink":"/apis/rabbitmq.com/v1beta1/namespaces/default/rabbitmqclusters/rabbitmq-cluster/status","uid":"18d9928b-0d1c-47be-80ec-20960d053827","resourceVersion":"1232","generation":3,"creationTimestamp":"2022-03-18T18:00:38Z","annotations":{"kubectl.kubernetes.io/last-applied-configuration":"{\"apiVersion\":\"rabbitmq.com/v1beta1\",\"kind\":\"RabbitmqCluster\",\"metadata\":{\"annotations\":{},\"name\":\"rabbitmq-cluster\",\"namespace\":\"default\"},\"spec\":{\"persistence\":{\"storage\":\"10Gi\"},\"replicas\":1}}\n"},"finalizers":["deletion.finalizers.rabbitmqclusters.rabbitmq.com"],"managedFields":[{"manager":"kubectl-client-side-apply","operation":"Update","apiVersion":"rabbitmq.com/v1beta1","time":"2022-03-18T18:00:38Z","fieldsType":"FieldsV1","fieldsV1":{"f:metadata":{"f:annotations":{".":{},"f:kubectl.kubernetes.io/last-applied-configuration":{}}},"f:spec":{".":{},"f:image":{},"f:persistence":{".":{},"f:storage":{}},"f:resources":{".":{},"f:limits":{".":{},"f:memory":{}},"f:requests":{".":{},"f:memory":{}}},"f:service":{".":{},"f:type":{}},"f:terminationGracePeriodSeconds":{}}}},{"manager":"kubectl-patch","operation":"Update","apiVersion":"rabbitmq.com/v1beta1","time":"2022-03-18T18:01:23Z","fieldsType":"FieldsV1","fieldsV1":{"f:spec":{"f:replicas":{}}}},{"manager":"manager","operation":"Update","apiVersion":"rabbitmq.com/v1beta1","time":"2022-03-18T18:02:01Z","fieldsType":"FieldsV1","fieldsV1":{"f:metadata":{"f:finalizers":{}},"f:spec":{"f:override":{},"f:rabbitmq":{},"f:resources":{"f:limits":{"f:cpu":{}},"f:requests":{"f:cpu":{}}},"f:tls":{}},"f:status":{".":{},"f:conditions":{},"f:defaultUser":{".":{},"f:secretReference":{".":{},"f:keys":{".":{},"f:password":{},"f:username":{}},"f:name":{},"f:namespace":{}},"f:serviceReference":{".":{},"f:name":{},"f:namespace":{}}}}}}]},"spec":{"replicas":3,"image":"rabbitmq:3.8.12-management","service":{"type":"ClusterIP"},"persistence":{"storage":"10Gi"},"resources":{"limits":{"cpu":"2","memory":"2Gi"},"requests":{"cpu":"1","memory":"2Gi"}},"rabbitmq":{},"tls":{},"override":{},"terminationGracePeriodSeconds":604800},"status":{"conditions":[{"type":"AllReplicasReady","status":"True","lastTransitionTime":"2022-03-18T18:02:01Z","reason":"AllPodsAreReady"},{"type":"ClusterAvailable","status":"True","lastTransitionTime":"2022-03-18T18:01:17Z","reason":"AtLeastOneEndpointAvailable"},{"type":"NoWarnings","status":"True","lastTransitionTime":"2022-03-18T18:00:38Z","reason":"NoWarnings"},{"type":"ReconcileSuccess","status":"True","lastTransitionTime":"2022-03-18T18:01:18Z","reason":"Success","message":"Finish reconciling"}],"defaultUser":{"secretReference":{"name":"rabbitmq-cluster-default-user","namespace":"default","keys":{"password":"password","username":"username"}},"serviceReference":{"name":"rabbitmq-cluster","namespace":"default"}},"binding":{"name":"rabbitmq-cluster-default-user"}}}
2022/03/18 18:02:01 learn_server.go:253: [SIEVE-AFTER-RECONCILE]	github.com/rabbitmq/cluster-operator/controllers.(*RabbitmqClusterReconciler)	16
2022/03/18 18:02:01 learn_server.go:238: [SIEVE-BEFORE-RECONCILE]	github.com/rabbitmq/cluster-operator/controllers.(*RabbitmqClusterReconciler)	17
2022/03/18 18:02:01 learn_server.go:291: [SIEVE-AFTER-READ]	Get	true	rabbitmqcluster	default	rabbitmq-cluster	github.com/rabbitmq/cluster-operator/controllers.(*RabbitmqClusterReconciler)	NoError	{"kind":"RabbitmqCluster","apiVersion":"rabbitmq.com/v1beta1","metadata":{"name":"rabbitmq-cluster","namespace":"default","selfLink":"/apis/rabbitmq.com/v1beta1/namespaces/default/rabbitmqclusters/rabbitmq-cluster","uid":"18d9928b-0d1c-47be-80ec-20960d053827","resourceVersion":"1232","generation":3,"creationTimestamp":"2022-03-18T18:00:38Z","annotations":{"kubectl.kubernetes.io/last-applied-configuration":"{\"apiVersion\":\"rabbitmq.com/v1beta1\",\"kind\":\"RabbitmqCluster\",\"metadata\":{\"annotations\":{},\"name\":\"rabbitmq-cluster\",\"namespace\":\"default\"},\"spec\":{\"persistence\":{\"storage\":\"10Gi\"},\"replicas\":1}}\n"},"finalizers":["deletion.finalizers.rabbitmqclusters.rabbitmq.com"],"managedFields":[{"manager":"kubectl-client-side-apply","operation":"Update","apiVersion":"rabbitmq.com/v1beta1","time":"2022-03-18T18:00:38Z","fieldsType":"FieldsV1","fieldsV1":{"f:metadata":{"f:annotations":{".":{},"f:kubectl.kubernetes.io/last-applied-configuration":{}}},"f:spec":{".":{},"f:image":{},"f:persistence":{".":{},"f:storage":{}},"f:resources":{".":{},"f:limits":{".":{},"f:memory":{}},"f:requests":{".":{},"f:memory":{}}},"f:service":{".":{},"f:type":{}},"f:terminationGracePeriodSeconds":{}}}},{"manager":"kubectl-patch","operation":"Update","apiVersion":"rabbitmq.com/v1beta1","time":"2022-03-18T18:01:23Z","fieldsType":"FieldsV1","fieldsV1":{"f:spec":{"f:replicas":{}}}},{"manager":"manager","operation":"Update","apiVersion":"rabbitmq.com/v1beta1","time":"2022-03-18T18:02:01Z","fieldsType":"FieldsV1","fieldsV1":{"f:metadata":{"f:finalizers":{}},"f:spec":{"f:override":{},"f:rabbitmq":{},"f:resources":{"f:limits":{"f:cpu":{}},"f:requests":{"f:cpu":{}}},"f:tls":{}},"f:status":{".":{},"f:conditions":{},"f:defaultUser":{".":{},"f:secretReference":{".":{},"f:keys":{".":{},"f:password":{},"f:username":{}},"f:name":{},"f:namespace":{}},"f:serviceReference":{".":{},"f:name":{},"f:namespace":{}}}}}}]},"spec":{"replicas":3,"image":"rabbitmq:3.8.12-management","service":{"type":"ClusterIP"},"persistence":{"storage":"10Gi"},"resources":{"limits":{"cpu":"2","memory":"2Gi"},"requests":{"cpu":"1","memory":"2Gi"}},"rabbitmq":{},"tls":{},"override":{},"terminationGracePeriodSeconds":604800},"status":{"conditions":[{"type":"AllReplicasReady","status":"True","lastTransitionTime":"2022-03-18T18:02:01Z","reason":"AllPodsAreReady"},{"type":"ClusterAvailable","status":"True","lastTransitionTime":"2022-03-18T18:01:17Z","reason":"AtLeastOneEndpointAvailable"},{"type":"NoWarnings","status":"True","lastTransitionTime":"2022-03-18T18:00:38Z","reason":"NoWarnings"},{"type":"ReconcileSuccess","status":"True","lastTransitionTime":"2022-03-18T18:01:18Z","reason":"Success","message":"Finish reconciling"}],"defaultUser":{"secretReference":{"name":"rabbitmq-cluster-default-user","namespace":"default","keys":{"password":"password","username":"username"}},"serviceReference":{"name":"rabbitmq-cluster","namespace":"default"}}}}
2022/03/18 18:02:01 learn_server.go:291: [SIEVE-AFTER-READ]	Get	true	statefulset	default	rabbitmq-cluster-server	github.com/rabbitmq/cluster-operator/controllers.(*RabbitmqClusterReconciler)	NoError	{"kind":"StatefulSet","apiVersion":"apps/v1","metadata":{"name":"rabbitmq-cluster-server","namespace":"default","selfLink":"/apis/apps/v1/namespaces/default/statefulsets/rabbitmq-cluster-server","uid":"cb5c43bc-6ee7-481c-ab01-6f3acffdd3c8","resourceVersion":"1231","generation":2,"creationTimestamp":"2022-03-18T18:00:38Z","labels":{"app.kubernetes.io/component":"rabbitmq","app.kubernetes.io/name":"rabbitmq-cluster","app.kubernetes.io/part-of":"rabbitmq"},"ownerReferences":[{"apiVersion":"rabbitmq.com/v1beta1","kind":"RabbitmqCluster","name":"rabbitmq-cluster","uid":"18d9928b-0d1c-47be-80ec-20960d053827","controller":true,"blockOwnerDeletion":true}],"managedFields":[{"manager":"manager","operation":"Update","apiVersion":"apps/v1","time":"2022-03-18T18:01:23Z","fieldsType":"FieldsV1","fieldsV1":{"f:metadata":{"f:labels":{".":{},"f:app.kubernetes.io/component":{},"f:app.kubernetes.io/name":{},"f:app.kubernetes.io/part-of":{}},"f:ownerReferences":{".":{},"k:{\"uid\":\"18d9928b-0d1c-47be-80ec-20960d053827\"}":{".":{},"f:apiVersion":{},"f:blockOwnerDeletion":{},"f:controller":{},"f:kind":{},"f:name":{},"f:uid":{}}}},"f:spec":{"f:podManagementPolicy":{},"f:replicas":{},"f:revisionHistoryLimit":{},"f:selector":{"f:matchLabels":{".":{},"f:app.kubernetes.io/name":{}}},"f:serviceName":{},"f:template":{"f:metadata":{"f:annotations":{".":{},"f:prometheus.io/port":{},"f:prometheus.io/scrape":{}},"f:labels":{".":{},"f:app.kubernetes.io/component":{},"f:app.kubernetes.io/name":{},"f:app.kubernetes.io/part-of":{}}},"f:spec":{"f:automountServiceAccountToken":{},"f:containers":{"k:{\"name\":\"rabbitmq\"}":{".":{},"f:env":{".":{},"k:{\"name\":\"K8S_HOSTNAME_SUFFIX\"}":{".":{},"f:name":{},"f:value":{}},"k:{\"name\":\"K8S_SERVICE_NAME\"}":{".":{},"f:name":{},"f:value":{}},"k:{\"name\":\"MY_POD_NAME\"}":{".":{},"f:name":{},"f:valueFrom":{".":{},"f:fieldRef":{".":{},"f:apiVersion":{},"f:fieldPath":{}}}},"k:{\"name\":\"MY_POD_NAMESPACE\"}":{".":{},"f:name":{},"f:valueFrom":{".":{},"f:fieldRef":{".":{},"f:apiVersion":{},"f:fieldPath":{}}}},"k:{\"name\":\"RABBITMQ_ENABLED_PLUGINS_FILE\"}":{".":{},"f:name":{},"f:value":{}},"k:{\"name\":\"RABBITMQ_NODENAME\"}":{".":{},"f:name":{},"f:value":{}},"k:{\"name\":\"RABBITMQ_USE_LONGNAME\"}":{".":{},"f:name":{},"f:value":{}}},"f:image":{},"f:imagePullPolicy":{},"f:lifecycle":{".":{},"f:preStop":{".":{},"f:exec":{".":{},"f:command":{}}}},"f:name":{},"f:ports":{".":{},"k:{\"containerPort\":4369,\"protocol\":\"TCP\"}":{".":{},"f:containerPort":{},"f:name":{},"f:protocol":{}},"k:{\"containerPort\":5672,\"protocol\":\"TCP\"}":{".":{},"f:containerPort":{},"f:name":{},"f:protocol":{}},"k:{\"containerPort\":15672,\"protocol\":\"TCP\"}":{".":{},"f:containerPort":{},"f:name":{},"f:protocol":{}},"k:{\"containerPort\":15692,\"protocol\":\"TCP\"}":{".":{},"f:containerPort":{},"f:name":{},"f:protocol":{}}},"f:readinessProbe":{".":{},"f:failureThreshold":{},"f:initialDelaySeconds":{},"f:periodSeconds":{},"f:successThreshold":{},"f:tcpSocket":{".":{},"f:port":{}},"f:timeoutSeconds":{}},"f:resources":{".":{},"f:limits":{".":{},"f:cpu":{},"f:memory":{}},"f:requests":{".":{},"f:cpu":{},"f:memory":{}}},"f:terminationMessagePath":{},"f:terminationMessagePolicy":{},"f:volumeMounts":{".":{},"k:{\"mountPath\":\"/etc/pod-info/\"}":{".":{},"f:mountPath":{},"f:name":{}},"k:{\"mountPath\":\"/etc/rabbitmq/conf.d/10-operatorDefaults.conf\"}":{".":{},"f:mountPath":{},"f:name":{},"f:subPath":{}},"k:{\"mountPath\":\"/etc/rabbitmq/conf.d/11-default_user.conf\"}":{".":{},"f:mountPath":{},"f:name":{},"f:subPath":{}},"k:{\"mountPath\":\"/etc/rabbitmq/conf.d/90-userDefinedConfiguration.conf\"}":{".":{},"f:mountPath":{},"f:name":{},"f:subPath":{}},"k:{\"mountPath\":\"/operator\"}":{".":{},"f:mountPath":{},"f:name":{}},"k:{\"mountPath\":\"/var/lib/rabbitmq/\"}":{".":{},"f:mountPath":{},"f:name":{}},"k:{\"mountPath\":\"/var/lib/rabbitmq/mnesia/\"}":{".":{},"f:mountPath":{},"f:name":{}}}}},"f:dnsPolicy":{},"f:initContainers":{".":{},"k:{\"name\":\"setup-container\"}":{".":{},"f:command":{},"f:image":{},"f:imagePullPolicy":{},"f:name":{},"f:resources":{".":{},"f:limits":{".":{},"f:cpu":{},"f:memory":{}},"f:requests":{".":{},"f:cpu":{},"f:memory":{}}},"f:securityContext":{".":{},"f:capabilities":{".":{},"f:drop":{}},"f:runAsUser":{}},"f:terminationMessagePath":{},"f:terminationMessagePolicy":{},"f:volumeMounts":{".":{},"k:{\"mountPath\":\"/operator\"}":{".":{},"f:mountPath":{},"f:name":{}},"k:{\"mountPath\":\"/tmp/default_user.conf\"}":{".":{},"f:mountPath":{},"f:name":{},"f:subPath":{}},"k:{\"mountPath\":\"/tmp/erlang-cookie-secret/\"}":{".":{},"f:mountPath":{},"f:name":{}},"k:{\"mountPath\":\"/tmp/rabbitmq-plugins/\"}":{".":{},"f:mountPath":{},"f:name":{}},"k:{\"mountPath\":\"/var/lib/rabbitmq/\"}":{".":{},"f:mountPath":{},"f:name":{}},"k:{\"mountPath\":\"/var/lib/rabbitmq/mnesia/\"}":{".":{},"f:mountPath":{},"f:name":{}}}}},"f:restartPolicy":{},"f:schedulerName":{},"f:securityContext":{".":{},"f:fsGroup":{},"f:runAsGroup":{},"f:runAsUser":{}},"f:serviceAccount":{},"f:serviceAccountName":{},"f:terminationGracePeriodSeconds":{},"f:topologySpreadConstraints":{".":{},"k:{\"topologyKey\":\"topology.kubernetes.io/zone\",\"whenUnsatisfiable\":\"ScheduleAnyway\"}":{".":{},"f:labelSelector":{".":{},"f:matchLabels":{".":{},"f:app.kubernetes.io/name":{}}},"f:maxSkew":{},"f:topologyKey":{},"f:whenUnsatisfiable":{}}},"f:volumes":{".":{},"k:{\"name\":\"erlang-cookie-secret\"}":{".":{},"f:name":{},"f:secret":{".":{},"f:defaultMode":{},"f:secretName":{}}},"k:{\"name\":\"plugins-conf\"}":{".":{},"f:configMap":{".":{},"f:defaultMode":{},"f:name":{}},"f:name":{}},"k:{\"name\":\"pod-info\"}":{".":{},"f:downwardAPI":{".":{},"f:defaultMode":{},"f:items":{}},"f:name":{}},"k:{\"name\":\"rabbitmq-confd\"}":{".":{},"f:name":{},"f:projected":{".":{},"f:defaultMode":{},"f:sources":{}}},"k:{\"name\":\"rabbitmq-erlang-cookie\"}":{".":{},"f:emptyDir":{},"f:name":{}},"k:{\"name\":\"rabbitmq-plugins\"}":{".":{},"f:emptyDir":{},"f:name":{}}}}},"f:updateStrategy":{"f:rollingUpdate":{".":{},"f:partition":{}},"f:type":{}},"f:volumeClaimTemplates":{}}}},{"manager":"kube-controller-manager","operation":"Update","apiVersion":"apps/v1","time":"2022-03-18T18:02:01Z","fieldsType":"FieldsV1","fieldsV1":{"f:status":{"f:collisionCount":{},"f:currentReplicas":{},"f:currentRevision":{},"f:observedGeneration":{},"f:readyReplicas":{},"f:replicas":{},"f:updateRevision":{},"f:updatedReplicas":{}}}}]},"spec":{"replicas":3,"selector":{"matchLabels":{"app.kubernetes.io/name":"rabbitmq-cluster"}},"template":{"metadata":{"creationTimestamp":null,"labels":{"app.kubernetes.io/component":"rabbitmq","app.kubernetes.io/name":"rabbitmq-cluster","app.kubernetes.io/part-of":"rabbitmq"},"annotations":{"prometheus.io/port":"15692","prometheus.io/scrape":"true"}},"spec":{"volumes":[{"name":"plugins-conf","configMap":{"name":"rabbitmq-cluster-plugins-conf","defaultMode":420}},{"name":"rabbitmq-confd","projected":{"sources":[{"secret":{"name":"rabbitmq-cluster-default-user","items":[{"key":"default_user.conf","path":"default_user.conf"}]}},{"configMap":{"name":"rabbitmq-cluster-server-conf","items":[{"key":"operatorDefaults.conf","path":"operatorDefaults.conf"},{"key":"userDefinedConfiguration.conf","path":"userDefinedConfiguration.conf"}]}}],"defaultMode":420}},{"name":"rabbitmq-erlang-cookie","emptyDir":{}},{"name":"erlang-cookie-secret","secret":{"secretName":"rabbitmq-cluster-erlang-cookie","defaultMode":420}},{"name":"rabbitmq-plugins","emptyDir":{}},{"name":"pod-info","downwardAPI":{"items":[{"path":"skipPreStopChecks","fieldRef":{"apiVersion":"v1","fieldPath":"metadata.labels['skipPreStopChecks']"}}],"defaultMode":420}}],"initContainers":[{"name":"setup-container","image":"rabbitmq:3.8.12-management","command":["sh","-c","cp /tmp/erlang-cookie-secret/.erlang.cookie /var/lib/rabbitmq/.erlang.cookie \u0026\u0026 chown 999:999 /var/lib/rabbitmq/.erlang.cookie \u0026\u0026 chmod 600 /var/lib/rabbitmq/.erlang.cookie ; cp /tmp/rabbitmq-plugins/enabled_plugins /operator/enabled_plugins \u0026\u0026 chown 999:999 /operator/enabled_plugins ; chown 999:999 /var/lib/rabbitmq/mnesia/ ; echo '[default]' \u003e /var/lib/rabbitmq/.rabbitmqadmin.conf \u0026\u0026 sed -e 's/default_user/username/' -e 's/default_pass/password/' /tmp/default_user.conf \u003e\u003e /var/lib/rabbitmq/.rabbitmqadmin.conf \u0026\u0026 chown 999:999 /var/lib/rabbitmq/.rabbitmqadmin.conf \u0026\u0026 chmod 600 /var/lib/rabbitmq/.rabbitmqadmin.conf"],"resources":{"limits":{"cpu":"100m","memory":"500Mi"},"requests":{"cpu":"100m","memory":"500Mi"}},"volumeMounts":[{"name":"plugins-conf","mountPath":"/tmp/rabbitmq-plugins/"},{"name":"rabbitmq-erlang-cookie","mountPath":"/var/lib/rabbitmq/"},{"name":"erlang-cookie-secret","mountPath":"/tmp/erlang-cookie-secret/"},{"name":"rabbitmq-plugins","mountPath":"/operator"},{"name":"persistence","mountPath":"/var/lib/rabbitmq/mnesia/"},{"name":"rabbitmq-confd","mountPath":"/tmp/default_user.conf","subPath":"default_user.conf"}],"terminationMessagePath":"/dev/termination-log","terminationMessagePolicy":"File","imagePullPolicy":"IfNotPresent","securityContext":{"capabilities":{"drop":["FSETID","KILL","SETGID","SETUID","SETPCAP","NET_BIND_SERVICE","NET_RAW","SYS_CHROOT","MKNOD","AUDIT_WRITE","SETFCAP"]},"runAsUser":0}}],"containers":[{"name":"rabbitmq","image":"rabbitmq:3.8.12-management","ports":[{"name":"epmd","containerPort":4369,"protocol":"TCP"},{"name":"amqp","containerPort":5672,"protocol":"TCP"},{"name":"management","containerPort":15672,"protocol":"TCP"},{"name":"prometheus","containerPort":15692,"protocol":"TCP"}],"env":[{"name":"MY_POD_NAME","valueFrom":{"fieldRef":{"apiVersion":"v1","fieldPath":"metadata.name"}}},{"name":"MY_POD_NAMESPACE","valueFrom":{"fieldRef":{"apiVersion":"v1","fieldPath":"metadata.namespace"}}},{"name":"RABBITMQ_ENABLED_PLUGINS_FILE","value":"/operator/enabled_plugins"},{"name":"K8S_SERVICE_NAME","value":"rabbitmq-cluster-nodes"},{"name":"RABBITMQ_USE_LONGNAME","value":"true"},{"name":"RABBITMQ_NODENAME","value":"rabbit@$(MY_POD_NAME).$(K8S_SERVICE_NAME).$(MY_POD_NAMESPACE)"},{"name":"K8S_HOSTNAME_SUFFIX","value":".$(K8S_SERVICE_NAME).$(MY_POD_NAMESPACE)"}],"resources":{"limits":{"cpu":"2","memory":"2Gi"},"requests":{"cpu":"1","memory":"2Gi"}},"volumeMounts":[{"name":"rabbitmq-erlang-cookie","mountPath":"/var/lib/rabbitmq/"},{"name":"persistence","mountPath":"/var/lib/rabbitmq/mnesia/"},{"name":"rabbitmq-plugins","mountPath":"/operator"},{"name":"rabbitmq-confd","mountPath":"/etc/rabbitmq/conf.d/10-operatorDefaults.conf","subPath":"operatorDefaults.conf"},{"name":"rabbitmq-confd","mountPath":"/etc/rabbitmq/conf.d/11-default_user.conf","subPath":"default_user.conf"},{"name":"rabbitmq-confd","mountPath":"/etc/rabbitmq/conf.d/90-userDefinedConfiguration.conf","subPath":"userDefinedConfiguration.conf"},{"name":"pod-info","mountPath":"/etc/pod-info/"}],"readinessProbe":{"tcpSocket":{"port":"amqp"},"initialDelaySeconds":10,"timeoutSeconds":5,"periodSeconds":10,"successThreshold":1,"failureThreshold":3},"lifecycle":{"preStop":{"exec":{"command":["/bin/bash","-c","if [ ! -z \"$(cat /etc/pod-info/skipPreStopChecks)\" ]; then exit 0; fi; rabbitmq-upgrade await_online_quorum_plus_one -t 604800; rabbitmq-upgrade await_online_synchronized_mirror -t 604800; rabbitmq-upgrade drain -t 604800"]}}},"terminationMessagePath":"/dev/termination-log","terminationMessagePolicy":"File","imagePullPolicy":"IfNotPresent"}],"restartPolicy":"Always","terminationGracePeriodSeconds":604800,"dnsPolicy":"ClusterFirst","serviceAccountName":"rabbitmq-cluster-server","serviceAccount":"rabbitmq-cluster-server","automountServiceAccountToken":true,"securityContext":{"runAsUser":999,"runAsGroup":999,"fsGroup":999},"schedulerName":"default-scheduler","topologySpreadConstraints":[{"maxSkew":1,"topologyKey":"topology.kubernetes.io/zone","whenUnsatisfiable":"ScheduleAnyway","labelSelector":{"matchLabels":{"app.kubernetes.io/name":"rabbitmq-cluster"}}}]}},"volumeClaimTemplates":[{"metadata":{"name":"persistence","namespace":"default","creationTimestamp":null,"labels":{"app.kubernetes.io/component":"rabbitmq","app.kubernetes.io/name":"rabbitmq-cluster","app.kubernetes.io/part-of":"rabbitmq"},"ownerReferences":[{"apiVersion":"rabbitmq.com/v1beta1","kind":"RabbitmqCluster","name":"rabbitmq-cluster","uid":"18d9928b-0d1c-47be-80ec-20960d053827","controller":true,"blockOwnerDeletion":false}]},"spec":{"accessModes":["ReadWriteOnce"],"resources":{"requests":{"storage":"10Gi"}},"volumeMode":"Filesystem"},"status":{"phase":"Pending"}}],"serviceName":"rabbitmq-cluster-nodes","podManagementPolicy":"Parallel","updateStrategy":{"type":"RollingUpdate","rollingUpdate":{"partition":0}},"revisionHistoryLimit":10},"status":{"observedGeneration":2,"replicas":3,"readyReplicas":3,"currentReplicas":3,"updatedReplicas":3,"currentRevision":"rabbitmq-cluster-server-5f8b8665fb","updateRevision":"rabbitmq-cluster-server-5f8b8665fb","collisionCount":0}}
2022/03/18 18:02:01 learn_server.go:291: [SIEVE-AFTER-READ]	Get	true	endpoints	default	rabbitmq-cluster	github.com/rabbitmq/cluster-operator/controllers.(*RabbitmqClusterReconciler)	NoError	{"kind":"Endpoints","apiVersion":"v1","metadata":{"name":"rabbitmq-cluster","namespace":"default","selfLink":"/api/v1/namespaces/default/endpoints/rabbitmq-cluster","uid":"5c4723ad-f4fe-442d-9135-44879a2a8183","resourceVersion":"1227","creationTimestamp":"2022-03-18T18:00:38Z","labels":{"app.kubernetes.io/component":"rabbitmq","app.kubernetes.io/name":"rabbitmq-cluster","app.kubernetes.io/part-of":"rabbitmq"},"annotations":{"endpoints.kubernetes.io/last-change-trigger-time":"2022-03-18T18:02:01Z"},"managedFields":[{"manager":"kube-controller-manager","operation":"Update","apiVersion":"v1","time":"2022-03-18T18:02:01Z","fieldsType":"FieldsV1","fieldsV1":{"f:metadata":{"f:annotations":{".":{},"f:endpoints.kubernetes.io/last-change-trigger-time":{}},"f:labels":{".":{},"f:app.kubernetes.io/component":{},"f:app.kubernetes.io/name":{},"f:app.kubernetes.io/part-of":{}}},"f:subsets":{}}}]},"subsets":[{"addresses":[{"ip":"10.244.1.4","nodeName":"kind-worker2","targetRef":{"kind":"Pod","namespace":"default","name":"rabbitmq-cluster-server-0","uid":"e7faffc5-b656-4e69-9777-92d12cb6ec5a","resourceVersion":"938"}},{"ip":"10.244.2.4","nodeName":"kind-worker","targetRef":{"kind":"Pod","namespace":"default","name":"rabbitmq-cluster-server-1","uid":"7a37da00-25d1-48b6-a659-4390fb7a02cb","resourceVersion":"1226"}},{"ip":"10.244.2.5","nodeName":"kind-worker","targetRef":{"kind":"Pod","namespace":"default","name":"rabbitmq-cluster-server-2","uid":"2a54a659-a979-4e10-8e74-1e0b83d532ba","resourceVersion":"1209"}}],"ports":[{"name":"amqp","port":5672,"protocol":"TCP"},{"name":"management","port":15672,"protocol":"TCP"}]}]}
2022/03/18 18:02:01 learn_server.go:291: [SIEVE-AFTER-READ]	Get	true	statefulset	default	rabbitmq-cluster-server	github.com/rabbitmq/cluster-operator/controllers.(*RabbitmqClusterReconciler)	NoError	{"kind":"StatefulSet","apiVersion":"apps/v1","metadata":{"name":"rabbitmq-cluster-server","namespace":"default","selfLink":"/apis/apps/v1/namespaces/default/statefulsets/rabbitmq-cluster-server","uid":"cb5c43bc-6ee7-481c-ab01-6f3acffdd3c8","resourceVersion":"1231","generation":2,"creationTimestamp":"2022-03-18T18:00:38Z","labels":{"app.kubernetes.io/component":"rabbitmq","app.kubernetes.io/name":"rabbitmq-cluster","app.kubernetes.io/part-of":"rabbitmq"},"ownerReferences":[{"apiVersion":"rabbitmq.com/v1beta1","kind":"RabbitmqCluster","name":"rabbitmq-cluster","uid":"18d9928b-0d1c-47be-80ec-20960d053827","controller":true,"blockOwnerDeletion":true}],"managedFields":[{"manager":"manager","operation":"Update","apiVersion":"apps/v1","time":"2022-03-18T18:01:23Z","fieldsType":"FieldsV1","fieldsV1":{"f:metadata":{"f:labels":{".":{},"f:app.kubernetes.io/component":{},"f:app.kubernetes.io/name":{},"f:app.kubernetes.io/part-of":{}},"f:ownerReferences":{".":{},"k:{\"uid\":\"18d9928b-0d1c-47be-80ec-20960d053827\"}":{".":{},"f:apiVersion":{},"f:blockOwnerDeletion":{},"f:controller":{},"f:kind":{},"f:name":{},"f:uid":{}}}},"f:spec":{"f:podManagementPolicy":{},"f:replicas":{},"f:revisionHistoryLimit":{},"f:selector":{"f:matchLabels":{".":{},"f:app.kubernetes.io/name":{}}},"f:serviceName":{},"f:template":{"f:metadata":{"f:annotations":{".":{},"f:prometheus.io/port":{},"f:prometheus.io/scrape":{}},"f:labels":{".":{},"f:app.kubernetes.io/component":{},"f:app.kubernetes.io/name":{},"f:app.kubernetes.io/part-of":{}}},"f:spec":{"f:automountServiceAccountToken":{},"f:containers":{"k:{\"name\":\"rabbitmq\"}":{".":{},"f:env":{".":{},"k:{\"name\":\"K8S_HOSTNAME_SUFFIX\"}":{".":{},"f:name":{},"f:value":{}},"k:{\"name\":\"K8S_SERVICE_NAME\"}":{".":{},"f:name":{},"f:value":{}},"k:{\"name\":\"MY_POD_NAME\"}":{".":{},"f:name":{},"f:valueFrom":{".":{},"f:fieldRef":{".":{},"f:apiVersion":{},"f:fieldPath":{}}}},"k:{\"name\":\"MY_POD_NAMESPACE\"}":{".":{},"f:name":{},"f:valueFrom":{".":{},"f:fieldRef":{".":{},"f:apiVersion":{},"f:fieldPath":{}}}},"k:{\"name\":\"RABBITMQ_ENABLED_PLUGINS_FILE\"}":{".":{},"f:name":{},"f:value":{}},"k:{\"name\":\"RABBITMQ_NODENAME\"}":{".":{},"f:name":{},"f:value":{}},"k:{\"name\":\"RABBITMQ_USE_LONGNAME\"}":{".":{},"f:name":{},"f:value":{}}},"f:image":{},"f:imagePullPolicy":{},"f:lifecycle":{".":{},"f:preStop":{".":{},"f:exec":{".":{},"f:command":{}}}},"f:name":{},"f:ports":{".":{},"k:{\"containerPort\":4369,\"protocol\":\"TCP\"}":{".":{},"f:containerPort":{},"f:name":{},"f:protocol":{}},"k:{\"containerPort\":5672,\"protocol\":\"TCP\"}":{".":{},"f:containerPort":{},"f:name":{},"f:protocol":{}},"k:{\"containerPort\":15672,\"protocol\":\"TCP\"}":{".":{},"f:containerPort":{},"f:name":{},"f:protocol":{}},"k:{\"containerPort\":15692,\"protocol\":\"TCP\"}":{".":{},"f:containerPort":{},"f:name":{},"f:protocol":{}}},"f:readinessProbe":{".":{},"f:failureThreshold":{},"f:initialDelaySeconds":{},"f:periodSeconds":{},"f:successThreshold":{},"f:tcpSocket":{".":{},"f:port":{}},"f:timeoutSeconds":{}},"f:resources":{".":{},"f:limits":{".":{},"f:cpu":{},"f:memory":{}},"f:requests":{".":{},"f:cpu":{},"f:memory":{}}},"f:terminationMessagePath":{},"f:terminationMessagePolicy":{},"f:volumeMounts":{".":{},"k:{\"mountPath\":\"/etc/pod-info/\"}":{".":{},"f:mountPath":{},"f:name":{}},"k:{\"mountPath\":\"/etc/rabbitmq/conf.d/10-operatorDefaults.conf\"}":{".":{},"f:mountPath":{},"f:name":{},"f:subPath":{}},"k:{\"mountPath\":\"/etc/rabbitmq/conf.d/11-default_user.conf\"}":{".":{},"f:mountPath":{},"f:name":{},"f:subPath":{}},"k:{\"mountPath\":\"/etc/rabbitmq/conf.d/90-userDefinedConfiguration.conf\"}":{".":{},"f:mountPath":{},"f:name":{},"f:subPath":{}},"k:{\"mountPath\":\"/operator\"}":{".":{},"f:mountPath":{},"f:name":{}},"k:{\"mountPath\":\"/var/lib/rabbitmq/\"}":{".":{},"f:mountPath":{},"f:name":{}},"k:{\"mountPath\":\"/var/lib/rabbitmq/mnesia/\"}":{".":{},"f:mountPath":{},"f:name":{}}}}},"f:dnsPolicy":{},"f:initContainers":{".":{},"k:{\"name\":\"setup-container\"}":{".":{},"f:command":{},"f:image":{},"f:imagePullPolicy":{},"f:name":{},"f:resources":{".":{},"f:limits":{".":{},"f:cpu":{},"f:memory":{}},"f:requests":{".":{},"f:cpu":{},"f:memory":{}}},"f:securityContext":{".":{},"f:capabilities":{".":{},"f:drop":{}},"f:runAsUser":{}},"f:terminationMessagePath":{},"f:terminationMessagePolicy":{},"f:volumeMounts":{".":{},"k:{\"mountPath\":\"/operator\"}":{".":{},"f:mountPath":{},"f:name":{}},"k:{\"mountPath\":\"/tmp/default_user.conf\"}":{".":{},"f:mountPath":{},"f:name":{},"f:subPath":{}},"k:{\"mountPath\":\"/tmp/erlang-cookie-secret/\"}":{".":{},"f:mountPath":{},"f:name":{}},"k:{\"mountPath\":\"/tmp/rabbitmq-plugins/\"}":{".":{},"f:mountPath":{},"f:name":{}},"k:{\"mountPath\":\"/var/lib/rabbitmq/\"}":{".":{},"f:mountPath":{},"f:name":{}},"k:{\"mountPath\":\"/var/lib/rabbitmq/mnesia/\"}":{".":{},"f:mountPath":{},"f:name":{}}}}},"f:restartPolicy":{},"f:schedulerName":{},"f:securityContext":{".":{},"f:fsGroup":{},"f:runAsGroup":{},"f:runAsUser":{}},"f:serviceAccount":{},"f:serviceAccountName":{},"f:terminationGracePeriodSeconds":{},"f:topologySpreadConstraints":{".":{},"k:{\"topologyKey\":\"topology.kubernetes.io/zone\",\"whenUnsatisfiable\":\"ScheduleAnyway\"}":{".":{},"f:labelSelector":{".":{},"f:matchLabels":{".":{},"f:app.kubernetes.io/name":{}}},"f:maxSkew":{},"f:topologyKey":{},"f:whenUnsatisfiable":{}}},"f:volumes":{".":{},"k:{\"name\":\"erlang-cookie-secret\"}":{".":{},"f:name":{},"f:secret":{".":{},"f:defaultMode":{},"f:secretName":{}}},"k:{\"name\":\"plugins-conf\"}":{".":{},"f:configMap":{".":{},"f:defaultMode":{},"f:name":{}},"f:name":{}},"k:{\"name\":\"pod-info\"}":{".":{},"f:downwardAPI":{".":{},"f:defaultMode":{},"f:items":{}},"f:name":{}},"k:{\"name\":\"rabbitmq-confd\"}":{".":{},"f:name":{},"f:projected":{".":{},"f:defaultMode":{},"f:sources":{}}},"k:{\"name\":\"rabbitmq-erlang-cookie\"}":{".":{},"f:emptyDir":{},"f:name":{}},"k:{\"name\":\"rabbitmq-plugins\"}":{".":{},"f:emptyDir":{},"f:name":{}}}}},"f:updateStrategy":{"f:rollingUpdate":{".":{},"f:partition":{}},"f:type":{}},"f:volumeClaimTemplates":{}}}},{"manager":"kube-controller-manager","operation":"Update","apiVersion":"apps/v1","time":"2022-03-18T18:02:01Z","fieldsType":"FieldsV1","fieldsV1":{"f:status":{"f:collisionCount":{},"f:currentReplicas":{},"f:currentRevision":{},"f:observedGeneration":{},"f:readyReplicas":{},"f:replicas":{},"f:updateRevision":{},"f:updatedReplicas":{}}}}]},"spec":{"replicas":3,"selector":{"matchLabels":{"app.kubernetes.io/name":"rabbitmq-cluster"}},"template":{"metadata":{"creationTimestamp":null,"labels":{"app.kubernetes.io/component":"rabbitmq","app.kubernetes.io/name":"rabbitmq-cluster","app.kubernetes.io/part-of":"rabbitmq"},"annotations":{"prometheus.io/port":"15692","prometheus.io/scrape":"true"}},"spec":{"volumes":[{"name":"plugins-conf","configMap":{"name":"rabbitmq-cluster-plugins-conf","defaultMode":420}},{"name":"rabbitmq-confd","projected":{"sources":[{"secret":{"name":"rabbitmq-cluster-default-user","items":[{"key":"default_user.conf","path":"default_user.conf"}]}},{"configMap":{"name":"rabbitmq-cluster-server-conf","items":[{"key":"operatorDefaults.conf","path":"operatorDefaults.conf"},{"key":"userDefinedConfiguration.conf","path":"userDefinedConfiguration.conf"}]}}],"defaultMode":420}},{"name":"rabbitmq-erlang-cookie","emptyDir":{}},{"name":"erlang-cookie-secret","secret":{"secretName":"rabbitmq-cluster-erlang-cookie","defaultMode":420}},{"name":"rabbitmq-plugins","emptyDir":{}},{"name":"pod-info","downwardAPI":{"items":[{"path":"skipPreStopChecks","fieldRef":{"apiVersion":"v1","fieldPath":"metadata.labels['skipPreStopChecks']"}}],"defaultMode":420}}],"initContainers":[{"name":"setup-container","image":"rabbitmq:3.8.12-management","command":["sh","-c","cp /tmp/erlang-cookie-secret/.erlang.cookie /var/lib/rabbitmq/.erlang.cookie \u0026\u0026 chown 999:999 /var/lib/rabbitmq/.erlang.cookie \u0026\u0026 chmod 600 /var/lib/rabbitmq/.erlang.cookie ; cp /tmp/rabbitmq-plugins/enabled_plugins /operator/enabled_plugins \u0026\u0026 chown 999:999 /operator/enabled_plugins ; chown 999:999 /var/lib/rabbitmq/mnesia/ ; echo '[default]' \u003e /var/lib/rabbitmq/.rabbitmqadmin.conf \u0026\u0026 sed -e 's/default_user/username/' -e 's/default_pass/password/' /tmp/default_user.conf \u003e\u003e /var/lib/rabbitmq/.rabbitmqadmin.conf \u0026\u0026 chown 999:999 /var/lib/rabbitmq/.rabbitmqadmin.conf \u0026\u0026 chmod 600 /var/lib/rabbitmq/.rabbitmqadmin.conf"],"resources":{"limits":{"cpu":"100m","memory":"500Mi"},"requests":{"cpu":"100m","memory":"500Mi"}},"volumeMounts":[{"name":"plugins-conf","mountPath":"/tmp/rabbitmq-plugins/"},{"name":"rabbitmq-erlang-cookie","mountPath":"/var/lib/rabbitmq/"},{"name":"erlang-cookie-secret","mountPath":"/tmp/erlang-cookie-secret/"},{"name":"rabbitmq-plugins","mountPath":"/operator"},{"name":"persistence","mountPath":"/var/lib/rabbitmq/mnesia/"},{"name":"rabbitmq-confd","mountPath":"/tmp/default_user.conf","subPath":"default_user.conf"}],"terminationMessagePath":"/dev/termination-log","terminationMessagePolicy":"File","imagePullPolicy":"IfNotPresent","securityContext":{"capabilities":{"drop":["FSETID","KILL","SETGID","SETUID","SETPCAP","NET_BIND_SERVICE","NET_RAW","SYS_CHROOT","MKNOD","AUDIT_WRITE","SETFCAP"]},"runAsUser":0}}],"containers":[{"name":"rabbitmq","image":"rabbitmq:3.8.12-management","ports":[{"name":"epmd","containerPort":4369,"protocol":"TCP"},{"name":"amqp","containerPort":5672,"protocol":"TCP"},{"name":"management","containerPort":15672,"protocol":"TCP"},{"name":"prometheus","containerPort":15692,"protocol":"TCP"}],"env":[{"name":"MY_POD_NAME","valueFrom":{"fieldRef":{"apiVersion":"v1","fieldPath":"metadata.name"}}},{"name":"MY_POD_NAMESPACE","valueFrom":{"fieldRef":{"apiVersion":"v1","fieldPath":"metadata.namespace"}}},{"name":"RABBITMQ_ENABLED_PLUGINS_FILE","value":"/operator/enabled_plugins"},{"name":"K8S_SERVICE_NAME","value":"rabbitmq-cluster-nodes"},{"name":"RABBITMQ_USE_LONGNAME","value":"true"},{"name":"RABBITMQ_NODENAME","value":"rabbit@$(MY_POD_NAME).$(K8S_SERVICE_NAME).$(MY_POD_NAMESPACE)"},{"name":"K8S_HOSTNAME_SUFFIX","value":".$(K8S_SERVICE_NAME).$(MY_POD_NAMESPACE)"}],"resources":{"limits":{"cpu":"2","memory":"2Gi"},"requests":{"cpu":"1","memory":"2Gi"}},"volumeMounts":[{"name":"rabbitmq-erlang-cookie","mountPath":"/var/lib/rabbitmq/"},{"name":"persistence","mountPath":"/var/lib/rabbitmq/mnesia/"},{"name":"rabbitmq-plugins","mountPath":"/operator"},{"name":"rabbitmq-confd","mountPath":"/etc/rabbitmq/conf.d/10-operatorDefaults.conf","subPath":"operatorDefaults.conf"},{"name":"rabbitmq-confd","mountPath":"/etc/rabbitmq/conf.d/11-default_user.conf","subPath":"default_user.conf"},{"name":"rabbitmq-confd","mountPath":"/etc/rabbitmq/conf.d/90-userDefinedConfiguration.conf","subPath":"userDefinedConfiguration.conf"},{"name":"pod-info","mountPath":"/etc/pod-info/"}],"readinessProbe":{"tcpSocket":{"port":"amqp"},"initialDelaySeconds":10,"timeoutSeconds":5,"periodSeconds":10,"successThreshold":1,"failureThreshold":3},"lifecycle":{"preStop":{"exec":{"command":["/bin/bash","-c","if [ ! -z \"$(cat /etc/pod-info/skipPreStopChecks)\" ]; then exit 0; fi; rabbitmq-upgrade await_online_quorum_plus_one -t 604800; rabbitmq-upgrade await_online_synchronized_mirror -t 604800; rabbitmq-upgrade drain -t 604800"]}}},"terminationMessagePath":"/dev/termination-log","terminationMessagePolicy":"File","imagePullPolicy":"IfNotPresent"}],"restartPolicy":"Always","terminationGracePeriodSeconds":604800,"dnsPolicy":"ClusterFirst","serviceAccountName":"rabbitmq-cluster-server","serviceAccount":"rabbitmq-cluster-server","automountServiceAccountToken":true,"securityContext":{"runAsUser":999,"runAsGroup":999,"fsGroup":999},"schedulerName":"default-scheduler","topologySpreadConstraints":[{"maxSkew":1,"topologyKey":"topology.kubernetes.io/zone","whenUnsatisfiable":"ScheduleAnyway","labelSelector":{"matchLabels":{"app.kubernetes.io/name":"rabbitmq-cluster"}}}]}},"volumeClaimTemplates":[{"metadata":{"name":"persistence","namespace":"default","creationTimestamp":null,"labels":{"app.kubernetes.io/component":"rabbitmq","app.kubernetes.io/name":"rabbitmq-cluster","app.kubernetes.io/part-of":"rabbitmq"},"ownerReferences":[{"apiVersion":"rabbitmq.com/v1beta1","kind":"RabbitmqCluster","name":"rabbitmq-cluster","uid":"18d9928b-0d1c-47be-80ec-20960d053827","controller":true,"blockOwnerDeletion":false}]},"spec":{"accessModes":["ReadWriteOnce"],"resources":{"requests":{"storage":"10Gi"}},"volumeMode":"Filesystem"},"status":{"phase":"Pending"}}],"serviceName":"rabbitmq-cluster-nodes","podManagementPolicy":"Parallel","updateStrategy":{"type":"RollingUpdate","rollingUpdate":{"partition":0}},"revisionHistoryLimit":10},"status":{"observedGeneration":2,"replicas":3,"readyReplicas":3,"currentReplicas":3,"updatedReplicas":3,"currentRevision":"rabbitmq-cluster-server-5f8b8665fb","updateRevision":"rabbitmq-cluster-server-5f8b8665fb","collisionCount":0}}
2022/03/18 18:02:01 learn_server.go:291: [SIEVE-AFTER-READ]	Get	true	service	default	rabbitmq-cluster-nodes	github.com/rabbitmq/cluster-operator/controllers.(*RabbitmqClusterReconciler)	NoError	{"kind":"Service","apiVersion":"v1","metadata":{"name":"rabbitmq-cluster-nodes","namespace":"default","selfLink":"/api/v1/namespaces/default/services/rabbitmq-cluster-nodes","uid":"67c7eea9-1b87-4fd7-82e6-5bfe31fd1b52","resourceVersion":"696","creationTimestamp":"2022-03-18T18:00:38Z","labels":{"app.kubernetes.io/component":"rabbitmq","app.kubernetes.io/name":"rabbitmq-cluster","app.kubernetes.io/part-of":"rabbitmq"},"ownerReferences":[{"apiVersion":"rabbitmq.com/v1beta1","kind":"RabbitmqCluster","name":"rabbitmq-cluster","uid":"18d9928b-0d1c-47be-80ec-20960d053827","controller":true,"blockOwnerDeletion":true}],"managedFields":[{"manager":"manager","operation":"Update","apiVersion":"v1","time":"2022-03-18T18:00:38Z","fieldsType":"FieldsV1","fieldsV1":{"f:metadata":{"f:labels":{".":{},"f:app.kubernetes.io/component":{},"f:app.kubernetes.io/name":{},"f:app.kubernetes.io/part-of":{}},"f:ownerReferences":{".":{},"k:{\"uid\":\"18d9928b-0d1c-47be-80ec-20960d053827\"}":{".":{},"f:apiVersion":{},"f:blockOwnerDeletion":{},"f:controller":{},"f:kind":{},"f:name":{},"f:uid":{}}}},"f:spec":{"f:clusterIP":{},"f:ports":{".":{},"k:{\"port\":4369,\"protocol\":\"TCP\"}":{".":{},"f:name":{},"f:port":{},"f:protocol":{},"f:targetPort":{}},"k:{\"port\":25672,\"protocol\":\"TCP\"}":{".":{},"f:name":{},"f:port":{},"f:protocol":{},"f:targetPort":{}}},"f:publishNotReadyAddresses":{},"f:selector":{".":{},"f:app.kubernetes.io/name":{}},"f:sessionAffinity":{},"f:type":{}}}}]},"spec":{"ports":[{"name":"epmd","protocol":"TCP","port":4369,"targetPort":4369},{"name":"cluster-rpc","protocol":"TCP","port":25672,"targetPort":25672}],"selector":{"app.kubernetes.io/name":"rabbitmq-cluster"},"clusterIP":"None","type":"ClusterIP","sessionAffinity":"None","publishNotReadyAddresses":true},"status":{"loadBalancer":{}}}
2022/03/18 18:02:01 learn_server.go:291: [SIEVE-AFTER-READ]	Get	true	service	default	rabbitmq-cluster	github.com/rabbitmq/cluster-operator/controllers.(*RabbitmqClusterReconciler)	NoError	{"kind":"Service","apiVersion":"v1","metadata":{"name":"rabbitmq-cluster","namespace":"default","selfLink":"/api/v1/namespaces/default/services/rabbitmq-cluster","uid":"56b50671-1945-458b-adac-05619b783392","resourceVersion":"701","creationTimestamp":"2022-03-18T18:00:38Z","labels":{"app.kubernetes.io/component":"rabbitmq","app.kubernetes.io/name":"rabbitmq-cluster","app.kubernetes.io/part-of":"rabbitmq"},"ownerReferences":[{"apiVersion":"rabbitmq.com/v1beta1","kind":"RabbitmqCluster","name":"rabbitmq-cluster","uid":"18d9928b-0d1c-47be-80ec-20960d053827","controller":true,"blockOwnerDeletion":true}],"managedFields":[{"manager":"manager","operation":"Update","apiVersion":"v1","time":"2022-03-18T18:00:38Z","fieldsType":"FieldsV1","fieldsV1":{"f:metadata":{"f:labels":{".":{},"f:app.kubernetes.io/component":{},"f:app.kubernetes.io/name":{},"f:app.kubernetes.io/part-of":{}},"f:ownerReferences":{".":{},"k:{\"uid\":\"18d9928b-0d1c-47be-80ec-20960d053827\"}":{".":{},"f:apiVersion":{},"f:blockOwnerDeletion":{},"f:controller":{},"f:kind":{},"f:name":{},"f:uid":{}}}},"f:spec":{"f:ports":{".":{},"k:{\"port\":5672,\"protocol\":\"TCP\"}":{".":{},"f:name":{},"f:port":{},"f:protocol":{},"f:targetPort":{}},"k:{\"port\":15672,\"protocol\":\"TCP\"}":{".":{},"f:name":{},"f:port":{},"f:protocol":{},"f:targetPort":{}}},"f:selector":{".":{},"f:app.kubernetes.io/name":{}},"f:sessionAffinity":{},"f:type":{}}}}]},"spec":{"ports":[{"name":"amqp","protocol":"TCP","port":5672,"targetPort":5672},{"name":"management","protocol":"TCP","port":15672,"targetPort":15672}],"selector":{"app.kubernetes.io/name":"rabbitmq-cluster"},"clusterIP":"10.96.254.158","type":"ClusterIP","sessionAffinity":"None"},"status":{"loadBalancer":{}}}
2022/03/18 18:02:01 learn_server.go:291: [SIEVE-AFTER-READ]	Get	true	secret	default	rabbitmq-cluster-erlang-cookie	github.com/rabbitmq/cluster-operator/controllers.(*RabbitmqClusterReconciler)	NoError	{"kind":"Secret","apiVersion":"v1","metadata":{"name":"rabbitmq-cluster-erlang-cookie","namespace":"default","selfLink":"/api/v1/namespaces/default/secrets/rabbitmq-cluster-erlang-cookie","uid":"f8fbe8a6-0f40-4e13-960b-ab78b8ba75b0","resourceVersion":"705","creationTimestamp":"2022-03-18T18:00:38Z","labels":{"app.kubernetes.io/component":"rabbitmq","app.kubernetes.io/name":"rabbitmq-cluster","app.kubernetes.io/part-of":"rabbitmq"},"ownerReferences":[{"apiVersion":"rabbitmq.com/v1beta1","kind":"RabbitmqCluster","name":"rabbitmq-cluster","uid":"18d9928b-0d1c-47be-80ec-20960d053827","controller":true,"blockOwnerDeletion":true}],"managedFields":[{"manager":"manager","operation":"Update","apiVersion":"v1","time":"2022-03-18T18:00:38Z","fieldsType":"FieldsV1","fieldsV1":{"f:data":{".":{},"f:.erlang.cookie":{}},"f:metadata":{"f:labels":{".":{},"f:app.kubernetes.io/component":{},"f:app.kubernetes.io/name":{},"f:app.kubernetes.io/part-of":{}},"f:ownerReferences":{".":{},"k:{\"uid\":\"18d9928b-0d1c-47be-80ec-20960d053827\"}":{".":{},"f:apiVersion":{},"f:blockOwnerDeletion":{},"f:controller":{},"f:kind":{},"f:name":{},"f:uid":{}}}},"f:type":{}}}]},"data":{".erlang.cookie":"QW9hMkpWU0tlYS1FUGdWTUhrelNMNnFoMFZ0ZmRGNUY="},"type":"Opaque"}
2022/03/18 18:02:01 learn_server.go:291: [SIEVE-AFTER-READ]	Get	true	secret	default	rabbitmq-cluster-default-user	github.com/rabbitmq/cluster-operator/controllers.(*RabbitmqClusterReconciler)	NoError	{"kind":"Secret","apiVersion":"v1","metadata":{"name":"rabbitmq-cluster-default-user","namespace":"default","selfLink":"/api/v1/namespaces/default/secrets/rabbitmq-cluster-default-user","uid":"0d9f460b-a23c-402b-8273-f541ed39023f","resourceVersion":"708","creationTimestamp":"2022-03-18T18:00:38Z","labels":{"app.kubernetes.io/component":"rabbitmq","app.kubernetes.io/name":"rabbitmq-cluster","app.kubernetes.io/part-of":"rabbitmq"},"ownerReferences":[{"apiVersion":"rabbitmq.com/v1beta1","kind":"RabbitmqCluster","name":"rabbitmq-cluster","uid":"18d9928b-0d1c-47be-80ec-20960d053827","controller":true,"blockOwnerDeletion":true}],"managedFields":[{"manager":"manager","operation":"Update","apiVersion":"v1","time":"2022-03-18T18:00:38Z","fieldsType":"FieldsV1","fieldsV1":{"f:data":{".":{},"f:default_user.conf":{},"f:password":{},"f:provider":{},"f:type":{},"f:username":{}},"f:metadata":{"f:labels":{".":{},"f:app.kubernetes.io/component":{},"f:app.kubernetes.io/name":{},"f:app.kubernetes.io/part-of":{}},"f:ownerReferences":{".":{},"k:{\"uid\":\"18d9928b-0d1c-47be-80ec-20960d053827\"}":{".":{},"f:apiVersion":{},"f:blockOwnerDeletion":{},"f:controller":{},"f:kind":{},"f:name":{},"f:uid":{}}}},"f:type":{}}}]},"data":{"default_user.conf":"ZGVmYXVsdF91c2VyID0gcTMxRmh3MGtjWW9SZUl5X3BPTXp2ZVBOUnNVU3I1Mk8KZGVmYXVsdF9wYXNzID0gY0dBX19jNTJHX05hVURpTGhraWZ6UDBOVVlNLTE2MWQK","password":"Y0dBX19jNTJHX05hVURpTGhraWZ6UDBOVVlNLTE2MWQ=","provider":"cmFiYml0bXE=","type":"cmFiYml0bXE=","username":"cTMxRmh3MGtjWW9SZUl5X3BPTXp2ZVBOUnNVU3I1Mk8="},"type":"Opaque"}
2022/03/18 18:02:01 learn_server.go:291: [SIEVE-AFTER-READ]	Get	true	configmap	default	rabbitmq-cluster-plugins-conf	github.com/rabbitmq/cluster-operator/controllers.(*RabbitmqClusterReconciler)	NoError	{"kind":"ConfigMap","apiVersion":"v1","metadata":{"name":"rabbitmq-cluster-plugins-conf","namespace":"default","selfLink":"/api/v1/namespaces/default/configmaps/rabbitmq-cluster-plugins-conf","uid":"a164075b-0562-47ac-a577-99aa8651ec40","resourceVersion":"709","creationTimestamp":"2022-03-18T18:00:38Z","labels":{"app.kubernetes.io/component":"rabbitmq","app.kubernetes.io/name":"rabbitmq-cluster","app.kubernetes.io/part-of":"rabbitmq"},"ownerReferences":[{"apiVersion":"rabbitmq.com/v1beta1","kind":"RabbitmqCluster","name":"rabbitmq-cluster","uid":"18d9928b-0d1c-47be-80ec-20960d053827","controller":true,"blockOwnerDeletion":true}],"managedFields":[{"manager":"manager","operation":"Update","apiVersion":"v1","time":"2022-03-18T18:00:38Z","fieldsType":"FieldsV1","fieldsV1":{"f:data":{".":{},"f:enabled_plugins":{}},"f:metadata":{"f:labels":{".":{},"f:app.kubernetes.io/component":{},"f:app.kubernetes.io/name":{},"f:app.kubernetes.io/part-of":{}},"f:ownerReferences":{".":{},"k:{\"uid\":\"18d9928b-0d1c-47be-80ec-20960d053827\"}":{".":{},"f:apiVersion":{},"f:blockOwnerDeletion":{},"f:controller":{},"f:kind":{},"f:name":{},"f:uid":{}}}}}}]},"data":{"enabled_plugins":"[rabbitmq_peer_discovery_k8s,rabbitmq_prometheus,rabbitmq_management]."}}
2022/03/18 18:02:01 learn_server.go:291: [SIEVE-AFTER-READ]	Get	true	configmap	default	rabbitmq-cluster-server-conf	github.com/rabbitmq/cluster-operator/controllers.(*RabbitmqClusterReconciler)	NoError	{"kind":"ConfigMap","apiVersion":"v1","metadata":{"name":"rabbitmq-cluster-server-conf","namespace":"default","selfLink":"/api/v1/namespaces/default/configmaps/rabbitmq-cluster-server-conf","uid":"22474f2b-8454-44b7-8079-8990223969cc","resourceVersion":"714","creationTimestamp":"2022-03-18T18:00:38Z","labels":{"app.kubernetes.io/component":"rabbitmq","app.kubernetes.io/name":"rabbitmq-cluster","app.kubernetes.io/part-of":"rabbitmq"},"ownerReferences":[{"apiVersion":"rabbitmq.com/v1beta1","kind":"RabbitmqCluster","name":"rabbitmq-cluster","uid":"18d9928b-0d1c-47be-80ec-20960d053827","controller":true,"blockOwnerDeletion":true}],"managedFields":[{"manager":"manager","operation":"Update","apiVersion":"v1","time":"2022-03-18T18:00:38Z","fieldsType":"FieldsV1","fieldsV1":{"f:data":{".":{},"f:operatorDefaults.conf":{},"f:userDefinedConfiguration.conf":{}},"f:metadata":{"f:labels":{".":{},"f:app.kubernetes.io/component":{},"f:app.kubernetes.io/name":{},"f:app.kubernetes.io/part-of":{}},"f:ownerReferences":{".":{},"k:{\"uid\":\"18d9928b-0d1c-47be-80ec-20960d053827\"}":{".":{},"f:apiVersion":{},"f:blockOwnerDeletion":{},"f:controller":{},"f:kind":{},"f:name":{},"f:uid":{}}}}}}]},"data":{"operatorDefaults.conf":"cluster_formation.peer_discovery_backend             = rabbit_peer_discovery_k8s\ncluster_formation.k8s.host                           = kubernetes.default\ncluster_formation.k8s.address_type                   = hostname\ncluster_partition_handling                           = pause_minority\nqueue_master_locator                                 = min-masters\ndisk_free_limit.absolute                             = 2GB\ncluster_formation.randomized_startup_delay_range.min = 5\ncluster_formation.randomized_startup_delay_range.max = 30\ncluster_name                                         = rabbitmq-cluster\n","userDefinedConfiguration.conf":"total_memory_available_override_value = 1717986919\n"}}
2022/03/18 18:02:01 learn_server.go:291: [SIEVE-AFTER-READ]	Get	true	serviceaccount	default	rabbitmq-cluster-server	github.com/rabbitmq/cluster-operator/controllers.(*RabbitmqClusterReconciler)	NoError	{"kind":"ServiceAccount","apiVersion":"v1","metadata":{"name":"rabbitmq-cluster-server","namespace":"default","selfLink":"/api/v1/namespaces/default/serviceaccounts/rabbitmq-cluster-server","uid":"731589b5-ac97-4774-bee4-008949b54734","resourceVersion":"722","creationTimestamp":"2022-03-18T18:00:38Z","labels":{"app.kubernetes.io/component":"rabbitmq","app.kubernetes.io/name":"rabbitmq-cluster","app.kubernetes.io/part-of":"rabbitmq"},"ownerReferences":[{"apiVersion":"rabbitmq.com/v1beta1","kind":"RabbitmqCluster","name":"rabbitmq-cluster","uid":"18d9928b-0d1c-47be-80ec-20960d053827","controller":true,"blockOwnerDeletion":true}],"managedFields":[{"manager":"kube-controller-manager","operation":"Update","apiVersion":"v1","time":"2022-03-18T18:00:38Z","fieldsType":"FieldsV1","fieldsV1":{"f:secrets":{".":{},"k:{\"name\":\"rabbitmq-cluster-server-token-rhzq9\"}":{".":{},"f:name":{}}}}},{"manager":"manager","operation":"Update","apiVersion":"v1","time":"2022-03-18T18:00:38Z","fieldsType":"FieldsV1","fieldsV1":{"f:metadata":{"f:labels":{".":{},"f:app.kubernetes.io/component":{},"f:app.kubernetes.io/name":{},"f:app.kubernetes.io/part-of":{}},"f:ownerReferences":{".":{},"k:{\"uid\":\"18d9928b-0d1c-47be-80ec-20960d053827\"}":{".":{},"f:apiVersion":{},"f:blockOwnerDeletion":{},"f:controller":{},"f:kind":{},"f:name":{},"f:uid":{}}}}}}]},"secrets":[{"name":"rabbitmq-cluster-server-token-rhzq9"}]}
2022/03/18 18:02:01 learn_server.go:291: [SIEVE-AFTER-READ]	Get	true	role	default	rabbitmq-cluster-peer-discovery	github.com/rabbitmq/cluster-operator/controllers.(*RabbitmqClusterReconciler)	NoError	{"kind":"Role","apiVersion":"rbac.authorization.k8s.io/v1","metadata":{"name":"rabbitmq-cluster-peer-discovery","namespace":"default","selfLink":"/apis/rbac.authorization.k8s.io/v1/namespaces/default/roles/rabbitmq-cluster-peer-discovery","uid":"52c80b50-4fdd-4089-bbfd-9756465953f2","resourceVersion":"723","creationTimestamp":"2022-03-18T18:00:38Z","labels":{"app.kubernetes.io/component":"rabbitmq","app.kubernetes.io/name":"rabbitmq-cluster","app.kubernetes.io/part-of":"rabbitmq"},"ownerReferences":[{"apiVersion":"rabbitmq.com/v1beta1","kind":"RabbitmqCluster","name":"rabbitmq-cluster","uid":"18d9928b-0d1c-47be-80ec-20960d053827","controller":true,"blockOwnerDeletion":true}],"managedFields":[{"manager":"manager","operation":"Update","apiVersion":"rbac.authorization.k8s.io/v1","time":"2022-03-18T18:00:38Z","fieldsType":"FieldsV1","fieldsV1":{"f:metadata":{"f:labels":{".":{},"f:app.kubernetes.io/component":{},"f:app.kubernetes.io/name":{},"f:app.kubernetes.io/part-of":{}},"f:ownerReferences":{".":{},"k:{\"uid\":\"18d9928b-0d1c-47be-80ec-20960d053827\"}":{".":{},"f:apiVersion":{},"f:blockOwnerDeletion":{},"f:controller":{},"f:kind":{},"f:name":{},"f:uid":{}}}},"f:rules":{}}}]},"rules":[{"verbs":["get"],"apiGroups":[""],"resources":["endpoints"]},{"verbs":["create"],"apiGroups":[""],"resources":["events"]}]}
2022/03/18 18:02:01 learn_server.go:291: [SIEVE-AFTER-READ]	Get	true	rolebinding	default	rabbitmq-cluster-server	github.com/rabbitmq/cluster-operator/controllers.(*RabbitmqClusterReconciler)	NoError	{"kind":"RoleBinding","apiVersion":"rbac.authorization.k8s.io/v1","metadata":{"name":"rabbitmq-cluster-server","namespace":"default","selfLink":"/apis/rbac.authorization.k8s.io/v1/namespaces/default/rolebindings/rabbitmq-cluster-server","uid":"495e9f7c-a20d-4515-86b0-34149a855034","resourceVersion":"725","creationTimestamp":"2022-03-18T18:00:38Z","labels":{"app.kubernetes.io/component":"rabbitmq","app.kubernetes.io/name":"rabbitmq-cluster","app.kubernetes.io/part-of":"rabbitmq"},"ownerReferences":[{"apiVersion":"rabbitmq.com/v1beta1","kind":"RabbitmqCluster","name":"rabbitmq-cluster","uid":"18d9928b-0d1c-47be-80ec-20960d053827","controller":true,"blockOwnerDeletion":true}],"managedFields":[{"manager":"manager","operation":"Update","apiVersion":"rbac.authorization.k8s.io/v1","time":"2022-03-18T18:00:38Z","fieldsType":"FieldsV1","fieldsV1":{"f:metadata":{"f:labels":{".":{},"f:app.kubernetes.io/component":{},"f:app.kubernetes.io/name":{},"f:app.kubernetes.io/part-of":{}},"f:ownerReferences":{".":{},"k:{\"uid\":\"18d9928b-0d1c-47be-80ec-20960d053827\"}":{".":{},"f:apiVersion":{},"f:blockOwnerDeletion":{},"f:controller":{},"f:kind":{},"f:name":{},"f:uid":{}}}},"f:roleRef":{"f:apiGroup":{},"f:kind":{},"f:name":{}},"f:subjects":{}}}]},"subjects":[{"kind":"ServiceAccount","name":"rabbitmq-cluster-server"}],"roleRef":{"apiGroup":"rbac.authorization.k8s.io","kind":"Role","name":"rabbitmq-cluster-peer-discovery"}}
2022/03/18 18:02:01 learn_server.go:291: [SIEVE-AFTER-READ]	Get	true	statefulset	default	rabbitmq-cluster-server	github.com/rabbitmq/cluster-operator/controllers.(*RabbitmqClusterReconciler)	NoError	{"kind":"StatefulSet","apiVersion":"apps/v1","metadata":{"name":"rabbitmq-cluster-server","namespace":"default","selfLink":"/apis/apps/v1/namespaces/default/statefulsets/rabbitmq-cluster-server","uid":"cb5c43bc-6ee7-481c-ab01-6f3acffdd3c8","resourceVersion":"1231","generation":2,"creationTimestamp":"2022-03-18T18:00:38Z","labels":{"app.kubernetes.io/component":"rabbitmq","app.kubernetes.io/name":"rabbitmq-cluster","app.kubernetes.io/part-of":"rabbitmq"},"ownerReferences":[{"apiVersion":"rabbitmq.com/v1beta1","kind":"RabbitmqCluster","name":"rabbitmq-cluster","uid":"18d9928b-0d1c-47be-80ec-20960d053827","controller":true,"blockOwnerDeletion":true}],"managedFields":[{"manager":"manager","operation":"Update","apiVersion":"apps/v1","time":"2022-03-18T18:01:23Z","fieldsType":"FieldsV1","fieldsV1":{"f:metadata":{"f:labels":{".":{},"f:app.kubernetes.io/component":{},"f:app.kubernetes.io/name":{},"f:app.kubernetes.io/part-of":{}},"f:ownerReferences":{".":{},"k:{\"uid\":\"18d9928b-0d1c-47be-80ec-20960d053827\"}":{".":{},"f:apiVersion":{},"f:blockOwnerDeletion":{},"f:controller":{},"f:kind":{},"f:name":{},"f:uid":{}}}},"f:spec":{"f:podManagementPolicy":{},"f:replicas":{},"f:revisionHistoryLimit":{},"f:selector":{"f:matchLabels":{".":{},"f:app.kubernetes.io/name":{}}},"f:serviceName":{},"f:template":{"f:metadata":{"f:annotations":{".":{},"f:prometheus.io/port":{},"f:prometheus.io/scrape":{}},"f:labels":{".":{},"f:app.kubernetes.io/component":{},"f:app.kubernetes.io/name":{},"f:app.kubernetes.io/part-of":{}}},"f:spec":{"f:automountServiceAccountToken":{},"f:containers":{"k:{\"name\":\"rabbitmq\"}":{".":{},"f:env":{".":{},"k:{\"name\":\"K8S_HOSTNAME_SUFFIX\"}":{".":{},"f:name":{},"f:value":{}},"k:{\"name\":\"K8S_SERVICE_NAME\"}":{".":{},"f:name":{},"f:value":{}},"k:{\"name\":\"MY_POD_NAME\"}":{".":{},"f:name":{},"f:valueFrom":{".":{},"f:fieldRef":{".":{},"f:apiVersion":{},"f:fieldPath":{}}}},"k:{\"name\":\"MY_POD_NAMESPACE\"}":{".":{},"f:name":{},"f:valueFrom":{".":{},"f:fieldRef":{".":{},"f:apiVersion":{},"f:fieldPath":{}}}},"k:{\"name\":\"RABBITMQ_ENABLED_PLUGINS_FILE\"}":{".":{},"f:name":{},"f:value":{}},"k:{\"name\":\"RABBITMQ_NODENAME\"}":{".":{},"f:name":{},"f:value":{}},"k:{\"name\":\"RABBITMQ_USE_LONGNAME\"}":{".":{},"f:name":{},"f:value":{}}},"f:image":{},"f:imagePullPolicy":{},"f:lifecycle":{".":{},"f:preStop":{".":{},"f:exec":{".":{},"f:command":{}}}},"f:name":{},"f:ports":{".":{},"k:{\"containerPort\":4369,\"protocol\":\"TCP\"}":{".":{},"f:containerPort":{},"f:name":{},"f:protocol":{}},"k:{\"containerPort\":5672,\"protocol\":\"TCP\"}":{".":{},"f:containerPort":{},"f:name":{},"f:protocol":{}},"k:{\"containerPort\":15672,\"protocol\":\"TCP\"}":{".":{},"f:containerPort":{},"f:name":{},"f:protocol":{}},"k:{\"containerPort\":15692,\"protocol\":\"TCP\"}":{".":{},"f:containerPort":{},"f:name":{},"f:protocol":{}}},"f:readinessProbe":{".":{},"f:failureThreshold":{},"f:initialDelaySeconds":{},"f:periodSeconds":{},"f:successThreshold":{},"f:tcpSocket":{".":{},"f:port":{}},"f:timeoutSeconds":{}},"f:resources":{".":{},"f:limits":{".":{},"f:cpu":{},"f:memory":{}},"f:requests":{".":{},"f:cpu":{},"f:memory":{}}},"f:terminationMessagePath":{},"f:terminationMessagePolicy":{},"f:volumeMounts":{".":{},"k:{\"mountPath\":\"/etc/pod-info/\"}":{".":{},"f:mountPath":{},"f:name":{}},"k:{\"mountPath\":\"/etc/rabbitmq/conf.d/10-operatorDefaults.conf\"}":{".":{},"f:mountPath":{},"f:name":{},"f:subPath":{}},"k:{\"mountPath\":\"/etc/rabbitmq/conf.d/11-default_user.conf\"}":{".":{},"f:mountPath":{},"f:name":{},"f:subPath":{}},"k:{\"mountPath\":\"/etc/rabbitmq/conf.d/90-userDefinedConfiguration.conf\"}":{".":{},"f:mountPath":{},"f:name":{},"f:subPath":{}},"k:{\"mountPath\":\"/operator\"}":{".":{},"f:mountPath":{},"f:name":{}},"k:{\"mountPath\":\"/var/lib/rabbitmq/\"}":{".":{},"f:mountPath":{},"f:name":{}},"k:{\"mountPath\":\"/var/lib/rabbitmq/mnesia/\"}":{".":{},"f:mountPath":{},"f:name":{}}}}},"f:dnsPolicy":{},"f:initContainers":{".":{},"k:{\"name\":\"setup-container\"}":{".":{},"f:command":{},"f:image":{},"f:imagePullPolicy":{},"f:name":{},"f:resources":{".":{},"f:limits":{".":{},"f:cpu":{},"f:memory":{}},"f:requests":{".":{},"f:cpu":{},"f:memory":{}}},"f:securityContext":{".":{},"f:capabilities":{".":{},"f:drop":{}},"f:runAsUser":{}},"f:terminationMessagePath":{},"f:terminationMessagePolicy":{},"f:volumeMounts":{".":{},"k:{\"mountPath\":\"/operator\"}":{".":{},"f:mountPath":{},"f:name":{}},"k:{\"mountPath\":\"/tmp/default_user.conf\"}":{".":{},"f:mountPath":{},"f:name":{},"f:subPath":{}},"k:{\"mountPath\":\"/tmp/erlang-cookie-secret/\"}":{".":{},"f:mountPath":{},"f:name":{}},"k:{\"mountPath\":\"/tmp/rabbitmq-plugins/\"}":{".":{},"f:mountPath":{},"f:name":{}},"k:{\"mountPath\":\"/var/lib/rabbitmq/\"}":{".":{},"f:mountPath":{},"f:name":{}},"k:{\"mountPath\":\"/var/lib/rabbitmq/mnesia/\"}":{".":{},"f:mountPath":{},"f:name":{}}}}},"f:restartPolicy":{},"f:schedulerName":{},"f:securityContext":{".":{},"f:fsGroup":{},"f:runAsGroup":{},"f:runAsUser":{}},"f:serviceAccount":{},"f:serviceAccountName":{},"f:terminationGracePeriodSeconds":{},"f:topologySpreadConstraints":{".":{},"k:{\"topologyKey\":\"topology.kubernetes.io/zone\",\"whenUnsatisfiable\":\"ScheduleAnyway\"}":{".":{},"f:labelSelector":{".":{},"f:matchLabels":{".":{},"f:app.kubernetes.io/name":{}}},"f:maxSkew":{},"f:topologyKey":{},"f:whenUnsatisfiable":{}}},"f:volumes":{".":{},"k:{\"name\":\"erlang-cookie-secret\"}":{".":{},"f:name":{},"f:secret":{".":{},"f:defaultMode":{},"f:secretName":{}}},"k:{\"name\":\"plugins-conf\"}":{".":{},"f:configMap":{".":{},"f:defaultMode":{},"f:name":{}},"f:name":{}},"k:{\"name\":\"pod-info\"}":{".":{},"f:downwardAPI":{".":{},"f:defaultMode":{},"f:items":{}},"f:name":{}},"k:{\"name\":\"rabbitmq-confd\"}":{".":{},"f:name":{},"f:projected":{".":{},"f:defaultMode":{},"f:sources":{}}},"k:{\"name\":\"rabbitmq-erlang-cookie\"}":{".":{},"f:emptyDir":{},"f:name":{}},"k:{\"name\":\"rabbitmq-plugins\"}":{".":{},"f:emptyDir":{},"f:name":{}}}}},"f:updateStrategy":{"f:rollingUpdate":{".":{},"f:partition":{}},"f:type":{}},"f:volumeClaimTemplates":{}}}},{"manager":"kube-controller-manager","operation":"Update","apiVersion":"apps/v1","time":"2022-03-18T18:02:01Z","fieldsType":"FieldsV1","fieldsV1":{"f:status":{"f:collisionCount":{},"f:currentReplicas":{},"f:currentRevision":{},"f:observedGeneration":{},"f:readyReplicas":{},"f:replicas":{},"f:updateRevision":{},"f:updatedReplicas":{}}}}]},"spec":{"replicas":3,"selector":{"matchLabels":{"app.kubernetes.io/name":"rabbitmq-cluster"}},"template":{"metadata":{"creationTimestamp":null,"labels":{"app.kubernetes.io/component":"rabbitmq","app.kubernetes.io/name":"rabbitmq-cluster","app.kubernetes.io/part-of":"rabbitmq"},"annotations":{"prometheus.io/port":"15692","prometheus.io/scrape":"true"}},"spec":{"volumes":[{"name":"plugins-conf","configMap":{"name":"rabbitmq-cluster-plugins-conf","defaultMode":420}},{"name":"rabbitmq-confd","projected":{"sources":[{"secret":{"name":"rabbitmq-cluster-default-user","items":[{"key":"default_user.conf","path":"default_user.conf"}]}},{"configMap":{"name":"rabbitmq-cluster-server-conf","items":[{"key":"operatorDefaults.conf","path":"operatorDefaults.conf"},{"key":"userDefinedConfiguration.conf","path":"userDefinedConfiguration.conf"}]}}],"defaultMode":420}},{"name":"rabbitmq-erlang-cookie","emptyDir":{}},{"name":"erlang-cookie-secret","secret":{"secretName":"rabbitmq-cluster-erlang-cookie","defaultMode":420}},{"name":"rabbitmq-plugins","emptyDir":{}},{"name":"pod-info","downwardAPI":{"items":[{"path":"skipPreStopChecks","fieldRef":{"apiVersion":"v1","fieldPath":"metadata.labels['skipPreStopChecks']"}}],"defaultMode":420}}],"initContainers":[{"name":"setup-container","image":"rabbitmq:3.8.12-management","command":["sh","-c","cp /tmp/erlang-cookie-secret/.erlang.cookie /var/lib/rabbitmq/.erlang.cookie \u0026\u0026 chown 999:999 /var/lib/rabbitmq/.erlang.cookie \u0026\u0026 chmod 600 /var/lib/rabbitmq/.erlang.cookie ; cp /tmp/rabbitmq-plugins/enabled_plugins /operator/enabled_plugins \u0026\u0026 chown 999:999 /operator/enabled_plugins ; chown 999:999 /var/lib/rabbitmq/mnesia/ ; echo '[default]' \u003e /var/lib/rabbitmq/.rabbitmqadmin.conf \u0026\u0026 sed -e 's/default_user/username/' -e 's/default_pass/password/' /tmp/default_user.conf \u003e\u003e /var/lib/rabbitmq/.rabbitmqadmin.conf \u0026\u0026 chown 999:999 /var/lib/rabbitmq/.rabbitmqadmin.conf \u0026\u0026 chmod 600 /var/lib/rabbitmq/.rabbitmqadmin.conf"],"resources":{"limits":{"cpu":"100m","memory":"500Mi"},"requests":{"cpu":"100m","memory":"500Mi"}},"volumeMounts":[{"name":"plugins-conf","mountPath":"/tmp/rabbitmq-plugins/"},{"name":"rabbitmq-erlang-cookie","mountPath":"/var/lib/rabbitmq/"},{"name":"erlang-cookie-secret","mountPath":"/tmp/erlang-cookie-secret/"},{"name":"rabbitmq-plugins","mountPath":"/operator"},{"name":"persistence","mountPath":"/var/lib/rabbitmq/mnesia/"},{"name":"rabbitmq-confd","mountPath":"/tmp/default_user.conf","subPath":"default_user.conf"}],"terminationMessagePath":"/dev/termination-log","terminationMessagePolicy":"File","imagePullPolicy":"IfNotPresent","securityContext":{"capabilities":{"drop":["FSETID","KILL","SETGID","SETUID","SETPCAP","NET_BIND_SERVICE","NET_RAW","SYS_CHROOT","MKNOD","AUDIT_WRITE","SETFCAP"]},"runAsUser":0}}],"containers":[{"name":"rabbitmq","image":"rabbitmq:3.8.12-management","ports":[{"name":"epmd","containerPort":4369,"protocol":"TCP"},{"name":"amqp","containerPort":5672,"protocol":"TCP"},{"name":"management","containerPort":15672,"protocol":"TCP"},{"name":"prometheus","containerPort":15692,"protocol":"TCP"}],"env":[{"name":"MY_POD_NAME","valueFrom":{"fieldRef":{"apiVersion":"v1","fieldPath":"metadata.name"}}},{"name":"MY_POD_NAMESPACE","valueFrom":{"fieldRef":{"apiVersion":"v1","fieldPath":"metadata.namespace"}}},{"name":"RABBITMQ_ENABLED_PLUGINS_FILE","value":"/operator/enabled_plugins"},{"name":"K8S_SERVICE_NAME","value":"rabbitmq-cluster-nodes"},{"name":"RABBITMQ_USE_LONGNAME","value":"true"},{"name":"RABBITMQ_NODENAME","value":"rabbit@$(MY_POD_NAME).$(K8S_SERVICE_NAME).$(MY_POD_NAMESPACE)"},{"name":"K8S_HOSTNAME_SUFFIX","value":".$(K8S_SERVICE_NAME).$(MY_POD_NAMESPACE)"}],"resources":{"limits":{"cpu":"2","memory":"2Gi"},"requests":{"cpu":"1","memory":"2Gi"}},"volumeMounts":[{"name":"rabbitmq-erlang-cookie","mountPath":"/var/lib/rabbitmq/"},{"name":"persistence","mountPath":"/var/lib/rabbitmq/mnesia/"},{"name":"rabbitmq-plugins","mountPath":"/operator"},{"name":"rabbitmq-confd","mountPath":"/etc/rabbitmq/conf.d/10-operatorDefaults.conf","subPath":"operatorDefaults.conf"},{"name":"rabbitmq-confd","mountPath":"/etc/rabbitmq/conf.d/11-default_user.conf","subPath":"default_user.conf"},{"name":"rabbitmq-confd","mountPath":"/etc/rabbitmq/conf.d/90-userDefinedConfiguration.conf","subPath":"userDefinedConfiguration.conf"},{"name":"pod-info","mountPath":"/etc/pod-info/"}],"readinessProbe":{"tcpSocket":{"port":"amqp"},"initialDelaySeconds":10,"timeoutSeconds":5,"periodSeconds":10,"successThreshold":1,"failureThreshold":3},"lifecycle":{"preStop":{"exec":{"command":["/bin/bash","-c","if [ ! -z \"$(cat /etc/pod-info/skipPreStopChecks)\" ]; then exit 0; fi; rabbitmq-upgrade await_online_quorum_plus_one -t 604800; rabbitmq-upgrade await_online_synchronized_mirror -t 604800; rabbitmq-upgrade drain -t 604800"]}}},"terminationMessagePath":"/dev/termination-log","terminationMessagePolicy":"File","imagePullPolicy":"IfNotPresent"}],"restartPolicy":"Always","terminationGracePeriodSeconds":604800,"dnsPolicy":"ClusterFirst","serviceAccountName":"rabbitmq-cluster-server","serviceAccount":"rabbitmq-cluster-server","automountServiceAccountToken":true,"securityContext":{"runAsUser":999,"runAsGroup":999,"fsGroup":999},"schedulerName":"default-scheduler","topologySpreadConstraints":[{"maxSkew":1,"topologyKey":"topology.kubernetes.io/zone","whenUnsatisfiable":"ScheduleAnyway","labelSelector":{"matchLabels":{"app.kubernetes.io/name":"rabbitmq-cluster"}}}]}},"volumeClaimTemplates":[{"metadata":{"name":"persistence","namespace":"default","creationTimestamp":null,"labels":{"app.kubernetes.io/component":"rabbitmq","app.kubernetes.io/name":"rabbitmq-cluster","app.kubernetes.io/part-of":"rabbitmq"},"ownerReferences":[{"apiVersion":"rabbitmq.com/v1beta1","kind":"RabbitmqCluster","name":"rabbitmq-cluster","uid":"18d9928b-0d1c-47be-80ec-20960d053827","controller":true,"blockOwnerDeletion":false}]},"spec":{"accessModes":["ReadWriteOnce"],"resources":{"requests":{"storage":"10Gi"}},"volumeMode":"Filesystem"},"status":{"phase":"Pending"}}],"serviceName":"rabbitmq-cluster-nodes","podManagementPolicy":"Parallel","updateStrategy":{"type":"RollingUpdate","rollingUpdate":{"partition":0}},"revisionHistoryLimit":10},"status":{"observedGeneration":2,"replicas":3,"readyReplicas":3,"currentReplicas":3,"updatedReplicas":3,"currentRevision":"rabbitmq-cluster-server-5f8b8665fb","updateRevision":"rabbitmq-cluster-server-5f8b8665fb","collisionCount":0}}
2022/03/18 18:02:01 learn_server.go:291: [SIEVE-AFTER-READ]	Get	true	statefulset	default	rabbitmq-cluster-server	github.com/rabbitmq/cluster-operator/controllers.(*RabbitmqClusterReconciler)	NoError	{"kind":"StatefulSet","apiVersion":"apps/v1","metadata":{"name":"rabbitmq-cluster-server","namespace":"default","selfLink":"/apis/apps/v1/namespaces/default/statefulsets/rabbitmq-cluster-server","uid":"cb5c43bc-6ee7-481c-ab01-6f3acffdd3c8","resourceVersion":"1231","generation":2,"creationTimestamp":"2022-03-18T18:00:38Z","labels":{"app.kubernetes.io/component":"rabbitmq","app.kubernetes.io/name":"rabbitmq-cluster","app.kubernetes.io/part-of":"rabbitmq"},"ownerReferences":[{"apiVersion":"rabbitmq.com/v1beta1","kind":"RabbitmqCluster","name":"rabbitmq-cluster","uid":"18d9928b-0d1c-47be-80ec-20960d053827","controller":true,"blockOwnerDeletion":true}],"managedFields":[{"manager":"manager","operation":"Update","apiVersion":"apps/v1","time":"2022-03-18T18:01:23Z","fieldsType":"FieldsV1","fieldsV1":{"f:metadata":{"f:labels":{".":{},"f:app.kubernetes.io/component":{},"f:app.kubernetes.io/name":{},"f:app.kubernetes.io/part-of":{}},"f:ownerReferences":{".":{},"k:{\"uid\":\"18d9928b-0d1c-47be-80ec-20960d053827\"}":{".":{},"f:apiVersion":{},"f:blockOwnerDeletion":{},"f:controller":{},"f:kind":{},"f:name":{},"f:uid":{}}}},"f:spec":{"f:podManagementPolicy":{},"f:replicas":{},"f:revisionHistoryLimit":{},"f:selector":{"f:matchLabels":{".":{},"f:app.kubernetes.io/name":{}}},"f:serviceName":{},"f:template":{"f:metadata":{"f:annotations":{".":{},"f:prometheus.io/port":{},"f:prometheus.io/scrape":{}},"f:labels":{".":{},"f:app.kubernetes.io/component":{},"f:app.kubernetes.io/name":{},"f:app.kubernetes.io/part-of":{}}},"f:spec":{"f:automountServiceAccountToken":{},"f:containers":{"k:{\"name\":\"rabbitmq\"}":{".":{},"f:env":{".":{},"k:{\"name\":\"K8S_HOSTNAME_SUFFIX\"}":{".":{},"f:name":{},"f:value":{}},"k:{\"name\":\"K8S_SERVICE_NAME\"}":{".":{},"f:name":{},"f:value":{}},"k:{\"name\":\"MY_POD_NAME\"}":{".":{},"f:name":{},"f:valueFrom":{".":{},"f:fieldRef":{".":{},"f:apiVersion":{},"f:fieldPath":{}}}},"k:{\"name\":\"MY_POD_NAMESPACE\"}":{".":{},"f:name":{},"f:valueFrom":{".":{},"f:fieldRef":{".":{},"f:apiVersion":{},"f:fieldPath":{}}}},"k:{\"name\":\"RABBITMQ_ENABLED_PLUGINS_FILE\"}":{".":{},"f:name":{},"f:value":{}},"k:{\"name\":\"RABBITMQ_NODENAME\"}":{".":{},"f:name":{},"f:value":{}},"k:{\"name\":\"RABBITMQ_USE_LONGNAME\"}":{".":{},"f:name":{},"f:value":{}}},"f:image":{},"f:imagePullPolicy":{},"f:lifecycle":{".":{},"f:preStop":{".":{},"f:exec":{".":{},"f:command":{}}}},"f:name":{},"f:ports":{".":{},"k:{\"containerPort\":4369,\"protocol\":\"TCP\"}":{".":{},"f:containerPort":{},"f:name":{},"f:protocol":{}},"k:{\"containerPort\":5672,\"protocol\":\"TCP\"}":{".":{},"f:containerPort":{},"f:name":{},"f:protocol":{}},"k:{\"containerPort\":15672,\"protocol\":\"TCP\"}":{".":{},"f:containerPort":{},"f:name":{},"f:protocol":{}},"k:{\"containerPort\":15692,\"protocol\":\"TCP\"}":{".":{},"f:containerPort":{},"f:name":{},"f:protocol":{}}},"f:readinessProbe":{".":{},"f:failureThreshold":{},"f:initialDelaySeconds":{},"f:periodSeconds":{},"f:successThreshold":{},"f:tcpSocket":{".":{},"f:port":{}},"f:timeoutSeconds":{}},"f:resources":{".":{},"f:limits":{".":{},"f:cpu":{},"f:memory":{}},"f:requests":{".":{},"f:cpu":{},"f:memory":{}}},"f:terminationMessagePath":{},"f:terminationMessagePolicy":{},"f:volumeMounts":{".":{},"k:{\"mountPath\":\"/etc/pod-info/\"}":{".":{},"f:mountPath":{},"f:name":{}},"k:{\"mountPath\":\"/etc/rabbitmq/conf.d/10-operatorDefaults.conf\"}":{".":{},"f:mountPath":{},"f:name":{},"f:subPath":{}},"k:{\"mountPath\":\"/etc/rabbitmq/conf.d/11-default_user.conf\"}":{".":{},"f:mountPath":{},"f:name":{},"f:subPath":{}},"k:{\"mountPath\":\"/etc/rabbitmq/conf.d/90-userDefinedConfiguration.conf\"}":{".":{},"f:mountPath":{},"f:name":{},"f:subPath":{}},"k:{\"mountPath\":\"/operator\"}":{".":{},"f:mountPath":{},"f:name":{}},"k:{\"mountPath\":\"/var/lib/rabbitmq/\"}":{".":{},"f:mountPath":{},"f:name":{}},"k:{\"mountPath\":\"/var/lib/rabbitmq/mnesia/\"}":{".":{},"f:mountPath":{},"f:name":{}}}}},"f:dnsPolicy":{},"f:initContainers":{".":{},"k:{\"name\":\"setup-container\"}":{".":{},"f:command":{},"f:image":{},"f:imagePullPolicy":{},"f:name":{},"f:resources":{".":{},"f:limits":{".":{},"f:cpu":{},"f:memory":{}},"f:requests":{".":{},"f:cpu":{},"f:memory":{}}},"f:securityContext":{".":{},"f:capabilities":{".":{},"f:drop":{}},"f:runAsUser":{}},"f:terminationMessagePath":{},"f:terminationMessagePolicy":{},"f:volumeMounts":{".":{},"k:{\"mountPath\":\"/operator\"}":{".":{},"f:mountPath":{},"f:name":{}},"k:{\"mountPath\":\"/tmp/default_user.conf\"}":{".":{},"f:mountPath":{},"f:name":{},"f:subPath":{}},"k:{\"mountPath\":\"/tmp/erlang-cookie-secret/\"}":{".":{},"f:mountPath":{},"f:name":{}},"k:{\"mountPath\":\"/tmp/rabbitmq-plugins/\"}":{".":{},"f:mountPath":{},"f:name":{}},"k:{\"mountPath\":\"/var/lib/rabbitmq/\"}":{".":{},"f:mountPath":{},"f:name":{}},"k:{\"mountPath\":\"/var/lib/rabbitmq/mnesia/\"}":{".":{},"f:mountPath":{},"f:name":{}}}}},"f:restartPolicy":{},"f:schedulerName":{},"f:securityContext":{".":{},"f:fsGroup":{},"f:runAsGroup":{},"f:runAsUser":{}},"f:serviceAccount":{},"f:serviceAccountName":{},"f:terminationGracePeriodSeconds":{},"f:topologySpreadConstraints":{".":{},"k:{\"topologyKey\":\"topology.kubernetes.io/zone\",\"whenUnsatisfiable\":\"ScheduleAnyway\"}":{".":{},"f:labelSelector":{".":{},"f:matchLabels":{".":{},"f:app.kubernetes.io/name":{}}},"f:maxSkew":{},"f:topologyKey":{},"f:whenUnsatisfiable":{}}},"f:volumes":{".":{},"k:{\"name\":\"erlang-cookie-secret\"}":{".":{},"f:name":{},"f:secret":{".":{},"f:defaultMode":{},"f:secretName":{}}},"k:{\"name\":\"plugins-conf\"}":{".":{},"f:configMap":{".":{},"f:defaultMode":{},"f:name":{}},"f:name":{}},"k:{\"name\":\"pod-info\"}":{".":{},"f:downwardAPI":{".":{},"f:defaultMode":{},"f:items":{}},"f:name":{}},"k:{\"name\":\"rabbitmq-confd\"}":{".":{},"f:name":{},"f:projected":{".":{},"f:defaultMode":{},"f:sources":{}}},"k:{\"name\":\"rabbitmq-erlang-cookie\"}":{".":{},"f:emptyDir":{},"f:name":{}},"k:{\"name\":\"rabbitmq-plugins\"}":{".":{},"f:emptyDir":{},"f:name":{}}}}},"f:updateStrategy":{"f:rollingUpdate":{".":{},"f:partition":{}},"f:type":{}},"f:volumeClaimTemplates":{}}}},{"manager":"kube-controller-manager","operation":"Update","apiVersion":"apps/v1","time":"2022-03-18T18:02:01Z","fieldsType":"FieldsV1","fieldsV1":{"f:status":{"f:collisionCount":{},"f:currentReplicas":{},"f:currentRevision":{},"f:observedGeneration":{},"f:readyReplicas":{},"f:replicas":{},"f:updateRevision":{},"f:updatedReplicas":{}}}}]},"spec":{"replicas":3,"selector":{"matchLabels":{"app.kubernetes.io/name":"rabbitmq-cluster"}},"template":{"metadata":{"creationTimestamp":null,"labels":{"app.kubernetes.io/component":"rabbitmq","app.kubernetes.io/name":"rabbitmq-cluster","app.kubernetes.io/part-of":"rabbitmq"},"annotations":{"prometheus.io/port":"15692","prometheus.io/scrape":"true"}},"spec":{"volumes":[{"name":"plugins-conf","configMap":{"name":"rabbitmq-cluster-plugins-conf","defaultMode":420}},{"name":"rabbitmq-confd","projected":{"sources":[{"secret":{"name":"rabbitmq-cluster-default-user","items":[{"key":"default_user.conf","path":"default_user.conf"}]}},{"configMap":{"name":"rabbitmq-cluster-server-conf","items":[{"key":"operatorDefaults.conf","path":"operatorDefaults.conf"},{"key":"userDefinedConfiguration.conf","path":"userDefinedConfiguration.conf"}]}}],"defaultMode":420}},{"name":"rabbitmq-erlang-cookie","emptyDir":{}},{"name":"erlang-cookie-secret","secret":{"secretName":"rabbitmq-cluster-erlang-cookie","defaultMode":420}},{"name":"rabbitmq-plugins","emptyDir":{}},{"name":"pod-info","downwardAPI":{"items":[{"path":"skipPreStopChecks","fieldRef":{"apiVersion":"v1","fieldPath":"metadata.labels['skipPreStopChecks']"}}],"defaultMode":420}}],"initContainers":[{"name":"setup-container","image":"rabbitmq:3.8.12-management","command":["sh","-c","cp /tmp/erlang-cookie-secret/.erlang.cookie /var/lib/rabbitmq/.erlang.cookie \u0026\u0026 chown 999:999 /var/lib/rabbitmq/.erlang.cookie \u0026\u0026 chmod 600 /var/lib/rabbitmq/.erlang.cookie ; cp /tmp/rabbitmq-plugins/enabled_plugins /operator/enabled_plugins \u0026\u0026 chown 999:999 /operator/enabled_plugins ; chown 999:999 /var/lib/rabbitmq/mnesia/ ; echo '[default]' \u003e /var/lib/rabbitmq/.rabbitmqadmin.conf \u0026\u0026 sed -e 's/default_user/username/' -e 's/default_pass/password/' /tmp/default_user.conf \u003e\u003e /var/lib/rabbitmq/.rabbitmqadmin.conf \u0026\u0026 chown 999:999 /var/lib/rabbitmq/.rabbitmqadmin.conf \u0026\u0026 chmod 600 /var/lib/rabbitmq/.rabbitmqadmin.conf"],"resources":{"limits":{"cpu":"100m","memory":"500Mi"},"requests":{"cpu":"100m","memory":"500Mi"}},"volumeMounts":[{"name":"plugins-conf","mountPath":"/tmp/rabbitmq-plugins/"},{"name":"rabbitmq-erlang-cookie","mountPath":"/var/lib/rabbitmq/"},{"name":"erlang-cookie-secret","mountPath":"/tmp/erlang-cookie-secret/"},{"name":"rabbitmq-plugins","mountPath":"/operator"},{"name":"persistence","mountPath":"/var/lib/rabbitmq/mnesia/"},{"name":"rabbitmq-confd","mountPath":"/tmp/default_user.conf","subPath":"default_user.conf"}],"terminationMessagePath":"/dev/termination-log","terminationMessagePolicy":"File","imagePullPolicy":"IfNotPresent","securityContext":{"capabilities":{"drop":["FSETID","KILL","SETGID","SETUID","SETPCAP","NET_BIND_SERVICE","NET_RAW","SYS_CHROOT","MKNOD","AUDIT_WRITE","SETFCAP"]},"runAsUser":0}}],"containers":[{"name":"rabbitmq","image":"rabbitmq:3.8.12-management","ports":[{"name":"epmd","containerPort":4369,"protocol":"TCP"},{"name":"amqp","containerPort":5672,"protocol":"TCP"},{"name":"management","containerPort":15672,"protocol":"TCP"},{"name":"prometheus","containerPort":15692,"protocol":"TCP"}],"env":[{"name":"MY_POD_NAME","valueFrom":{"fieldRef":{"apiVersion":"v1","fieldPath":"metadata.name"}}},{"name":"MY_POD_NAMESPACE","valueFrom":{"fieldRef":{"apiVersion":"v1","fieldPath":"metadata.namespace"}}},{"name":"RABBITMQ_ENABLED_PLUGINS_FILE","value":"/operator/enabled_plugins"},{"name":"K8S_SERVICE_NAME","value":"rabbitmq-cluster-nodes"},{"name":"RABBITMQ_USE_LONGNAME","value":"true"},{"name":"RABBITMQ_NODENAME","value":"rabbit@$(MY_POD_NAME).$(K8S_SERVICE_NAME).$(MY_POD_NAMESPACE)"},{"name":"K8S_HOSTNAME_SUFFIX","value":".$(K8S_SERVICE_NAME).$(MY_POD_NAMESPACE)"}],"resources":{"limits":{"cpu":"2","memory":"2Gi"},"requests":{"cpu":"1","memory":"2Gi"}},"volumeMounts":[{"name":"rabbitmq-erlang-cookie","mountPath":"/var/lib/rabbitmq/"},{"name":"persistence","mountPath":"/var/lib/rabbitmq/mnesia/"},{"name":"rabbitmq-plugins","mountPath":"/operator"},{"name":"rabbitmq-confd","mountPath":"/etc/rabbitmq/conf.d/10-operatorDefaults.conf","subPath":"operatorDefaults.conf"},{"name":"rabbitmq-confd","mountPath":"/etc/rabbitmq/conf.d/11-default_user.conf","subPath":"default_user.conf"},{"name":"rabbitmq-confd","mountPath":"/etc/rabbitmq/conf.d/90-userDefinedConfiguration.conf","subPath":"userDefinedConfiguration.conf"},{"name":"pod-info","mountPath":"/etc/pod-info/"}],"readinessProbe":{"tcpSocket":{"port":"amqp"},"initialDelaySeconds":10,"timeoutSeconds":5,"periodSeconds":10,"successThreshold":1,"failureThreshold":3},"lifecycle":{"preStop":{"exec":{"command":["/bin/bash","-c","if [ ! -z \"$(cat /etc/pod-info/skipPreStopChecks)\" ]; then exit 0; fi; rabbitmq-upgrade await_online_quorum_plus_one -t 604800; rabbitmq-upgrade await_online_synchronized_mirror -t 604800; rabbitmq-upgrade drain -t 604800"]}}},"terminationMessagePath":"/dev/termination-log","terminationMessagePolicy":"File","imagePullPolicy":"IfNotPresent"}],"restartPolicy":"Always","terminationGracePeriodSeconds":604800,"dnsPolicy":"ClusterFirst","serviceAccountName":"rabbitmq-cluster-server","serviceAccount":"rabbitmq-cluster-server","automountServiceAccountToken":true,"securityContext":{"runAsUser":999,"runAsGroup":999,"fsGroup":999},"schedulerName":"default-scheduler","topologySpreadConstraints":[{"maxSkew":1,"topologyKey":"topology.kubernetes.io/zone","whenUnsatisfiable":"ScheduleAnyway","labelSelector":{"matchLabels":{"app.kubernetes.io/name":"rabbitmq-cluster"}}}]}},"volumeClaimTemplates":[{"metadata":{"name":"persistence","namespace":"default","creationTimestamp":null,"labels":{"app.kubernetes.io/component":"rabbitmq","app.kubernetes.io/name":"rabbitmq-cluster","app.kubernetes.io/part-of":"rabbitmq"},"ownerReferences":[{"apiVersion":"rabbitmq.com/v1beta1","kind":"RabbitmqCluster","name":"rabbitmq-cluster","uid":"18d9928b-0d1c-47be-80ec-20960d053827","controller":true,"blockOwnerDeletion":false}]},"spec":{"accessModes":["ReadWriteOnce"],"resources":{"requests":{"storage":"10Gi"}},"volumeMode":"Filesystem"},"status":{"phase":"Pending"}}],"serviceName":"rabbitmq-cluster-nodes","podManagementPolicy":"Parallel","updateStrategy":{"type":"RollingUpdate","rollingUpdate":{"partition":0}},"revisionHistoryLimit":10},"status":{"observedGeneration":2,"replicas":3,"readyReplicas":3,"currentReplicas":3,"updatedReplicas":3,"currentRevision":"rabbitmq-cluster-server-5f8b8665fb","updateRevision":"rabbitmq-cluster-server-5f8b8665fb","collisionCount":0}}
2022/03/18 18:02:01 learn_server.go:256: [SIEVE-BEFORE-WRITE]	58
2022/03/18 18:02:01 learn_server.go:263: [SIEVE-AFTER-WRITE]	58	Update	statefulset	github.com/rabbitmq/cluster-operator/controllers.(*RabbitmqClusterReconciler)	NoError	{"metadata":{"name":"rabbitmq-cluster-server","namespace":"default","selfLink":"/apis/apps/v1/namespaces/default/statefulsets/rabbitmq-cluster-server","uid":"cb5c43bc-6ee7-481c-ab01-6f3acffdd3c8","resourceVersion":"1231","generation":2,"creationTimestamp":"2022-03-18T18:00:38Z","labels":{"app.kubernetes.io/component":"rabbitmq","app.kubernetes.io/name":"rabbitmq-cluster","app.kubernetes.io/part-of":"rabbitmq"},"ownerReferences":[{"apiVersion":"rabbitmq.com/v1beta1","kind":"RabbitmqCluster","name":"rabbitmq-cluster","uid":"18d9928b-0d1c-47be-80ec-20960d053827","controller":true,"blockOwnerDeletion":true}],"managedFields":[{"manager":"manager","operation":"Update","apiVersion":"apps/v1","time":"2022-03-18T18:01:23Z","fieldsType":"FieldsV1","fieldsV1":{"f:metadata":{"f:labels":{".":{},"f:app.kubernetes.io/component":{},"f:app.kubernetes.io/name":{},"f:app.kubernetes.io/part-of":{}},"f:ownerReferences":{".":{},"k:{\"uid\":\"18d9928b-0d1c-47be-80ec-20960d053827\"}":{".":{},"f:apiVersion":{},"f:blockOwnerDeletion":{},"f:controller":{},"f:kind":{},"f:name":{},"f:uid":{}}}},"f:spec":{"f:podManagementPolicy":{},"f:replicas":{},"f:revisionHistoryLimit":{},"f:selector":{"f:matchLabels":{".":{},"f:app.kubernetes.io/name":{}}},"f:serviceName":{},"f:template":{"f:metadata":{"f:annotations":{".":{},"f:prometheus.io/port":{},"f:prometheus.io/scrape":{}},"f:labels":{".":{},"f:app.kubernetes.io/component":{},"f:app.kubernetes.io/name":{},"f:app.kubernetes.io/part-of":{}}},"f:spec":{"f:automountServiceAccountToken":{},"f:containers":{"k:{\"name\":\"rabbitmq\"}":{".":{},"f:env":{".":{},"k:{\"name\":\"K8S_HOSTNAME_SUFFIX\"}":{".":{},"f:name":{},"f:value":{}},"k:{\"name\":\"K8S_SERVICE_NAME\"}":{".":{},"f:name":{},"f:value":{}},"k:{\"name\":\"MY_POD_NAME\"}":{".":{},"f:name":{},"f:valueFrom":{".":{},"f:fieldRef":{".":{},"f:apiVersion":{},"f:fieldPath":{}}}},"k:{\"name\":\"MY_POD_NAMESPACE\"}":{".":{},"f:name":{},"f:valueFrom":{".":{},"f:fieldRef":{".":{},"f:apiVersion":{},"f:fieldPath":{}}}},"k:{\"name\":\"RABBITMQ_ENABLED_PLUGINS_FILE\"}":{".":{},"f:name":{},"f:value":{}},"k:{\"name\":\"RABBITMQ_NODENAME\"}":{".":{},"f:name":{},"f:value":{}},"k:{\"name\":\"RABBITMQ_USE_LONGNAME\"}":{".":{},"f:name":{},"f:value":{}}},"f:image":{},"f:imagePullPolicy":{},"f:lifecycle":{".":{},"f:preStop":{".":{},"f:exec":{".":{},"f:command":{}}}},"f:name":{},"f:ports":{".":{},"k:{\"containerPort\":4369,\"protocol\":\"TCP\"}":{".":{},"f:containerPort":{},"f:name":{},"f:protocol":{}},"k:{\"containerPort\":5672,\"protocol\":\"TCP\"}":{".":{},"f:containerPort":{},"f:name":{},"f:protocol":{}},"k:{\"containerPort\":15672,\"protocol\":\"TCP\"}":{".":{},"f:containerPort":{},"f:name":{},"f:protocol":{}},"k:{\"containerPort\":15692,\"protocol\":\"TCP\"}":{".":{},"f:containerPort":{},"f:name":{},"f:protocol":{}}},"f:readinessProbe":{".":{},"f:failureThreshold":{},"f:initialDelaySeconds":{},"f:periodSeconds":{},"f:successThreshold":{},"f:tcpSocket":{".":{},"f:port":{}},"f:timeoutSeconds":{}},"f:resources":{".":{},"f:limits":{".":{},"f:cpu":{},"f:memory":{}},"f:requests":{".":{},"f:cpu":{},"f:memory":{}}},"f:terminationMessagePath":{},"f:terminationMessagePolicy":{},"f:volumeMounts":{".":{},"k:{\"mountPath\":\"/etc/pod-info/\"}":{".":{},"f:mountPath":{},"f:name":{}},"k:{\"mountPath\":\"/etc/rabbitmq/conf.d/10-operatorDefaults.conf\"}":{".":{},"f:mountPath":{},"f:name":{},"f:subPath":{}},"k:{\"mountPath\":\"/etc/rabbitmq/conf.d/11-default_user.conf\"}":{".":{},"f:mountPath":{},"f:name":{},"f:subPath":{}},"k:{\"mountPath\":\"/etc/rabbitmq/conf.d/90-userDefinedConfiguration.conf\"}":{".":{},"f:mountPath":{},"f:name":{},"f:subPath":{}},"k:{\"mountPath\":\"/operator\"}":{".":{},"f:mountPath":{},"f:name":{}},"k:{\"mountPath\":\"/var/lib/rabbitmq/\"}":{".":{},"f:mountPath":{},"f:name":{}},"k:{\"mountPath\":\"/var/lib/rabbitmq/mnesia/\"}":{".":{},"f:mountPath":{},"f:name":{}}}}},"f:dnsPolicy":{},"f:initContainers":{".":{},"k:{\"name\":\"setup-container\"}":{".":{},"f:command":{},"f:image":{},"f:imagePullPolicy":{},"f:name":{},"f:resources":{".":{},"f:limits":{".":{},"f:cpu":{},"f:memory":{}},"f:requests":{".":{},"f:cpu":{},"f:memory":{}}},"f:securityContext":{".":{},"f:capabilities":{".":{},"f:drop":{}},"f:runAsUser":{}},"f:terminationMessagePath":{},"f:terminationMessagePolicy":{},"f:volumeMounts":{".":{},"k:{\"mountPath\":\"/operator\"}":{".":{},"f:mountPath":{},"f:name":{}},"k:{\"mountPath\":\"/tmp/default_user.conf\"}":{".":{},"f:mountPath":{},"f:name":{},"f:subPath":{}},"k:{\"mountPath\":\"/tmp/erlang-cookie-secret/\"}":{".":{},"f:mountPath":{},"f:name":{}},"k:{\"mountPath\":\"/tmp/rabbitmq-plugins/\"}":{".":{},"f:mountPath":{},"f:name":{}},"k:{\"mountPath\":\"/var/lib/rabbitmq/\"}":{".":{},"f:mountPath":{},"f:name":{}},"k:{\"mountPath\":\"/var/lib/rabbitmq/mnesia/\"}":{".":{},"f:mountPath":{},"f:name":{}}}}},"f:restartPolicy":{},"f:schedulerName":{},"f:securityContext":{".":{},"f:fsGroup":{},"f:runAsGroup":{},"f:runAsUser":{}},"f:serviceAccount":{},"f:serviceAccountName":{},"f:terminationGracePeriodSeconds":{},"f:topologySpreadConstraints":{".":{},"k:{\"topologyKey\":\"topology.kubernetes.io/zone\",\"whenUnsatisfiable\":\"ScheduleAnyway\"}":{".":{},"f:labelSelector":{".":{},"f:matchLabels":{".":{},"f:app.kubernetes.io/name":{}}},"f:maxSkew":{},"f:topologyKey":{},"f:whenUnsatisfiable":{}}},"f:volumes":{".":{},"k:{\"name\":\"erlang-cookie-secret\"}":{".":{},"f:name":{},"f:secret":{".":{},"f:defaultMode":{},"f:secretName":{}}},"k:{\"name\":\"plugins-conf\"}":{".":{},"f:configMap":{".":{},"f:defaultMode":{},"f:name":{}},"f:name":{}},"k:{\"name\":\"pod-info\"}":{".":{},"f:downwardAPI":{".":{},"f:defaultMode":{},"f:items":{}},"f:name":{}},"k:{\"name\":\"rabbitmq-confd\"}":{".":{},"f:name":{},"f:projected":{".":{},"f:defaultMode":{},"f:sources":{}}},"k:{\"name\":\"rabbitmq-erlang-cookie\"}":{".":{},"f:emptyDir":{},"f:name":{}},"k:{\"name\":\"rabbitmq-plugins\"}":{".":{},"f:emptyDir":{},"f:name":{}}}}},"f:updateStrategy":{"f:rollingUpdate":{".":{},"f:partition":{}},"f:type":{}},"f:volumeClaimTemplates":{}}}},{"manager":"kube-controller-manager","operation":"Update","apiVersion":"apps/v1","time":"2022-03-18T18:02:01Z","fieldsType":"FieldsV1","fieldsV1":{"f:status":{"f:collisionCount":{},"f:currentReplicas":{},"f:currentRevision":{},"f:observedGeneration":{},"f:readyReplicas":{},"f:replicas":{},"f:updateRevision":{},"f:updatedReplicas":{}}}}]},"spec":{"replicas":3,"selector":{"matchLabels":{"app.kubernetes.io/name":"rabbitmq-cluster"}},"template":{"metadata":{"creationTimestamp":null,"labels":{"app.kubernetes.io/component":"rabbitmq","app.kubernetes.io/name":"rabbitmq-cluster","app.kubernetes.io/part-of":"rabbitmq"},"annotations":{"prometheus.io/port":"15692","prometheus.io/scrape":"true"}},"spec":{"volumes":[{"name":"plugins-conf","configMap":{"name":"rabbitmq-cluster-plugins-conf","defaultMode":420}},{"name":"rabbitmq-confd","projected":{"sources":[{"secret":{"name":"rabbitmq-cluster-default-user","items":[{"key":"default_user.conf","path":"default_user.conf"}]}},{"configMap":{"name":"rabbitmq-cluster-server-conf","items":[{"key":"operatorDefaults.conf","path":"operatorDefaults.conf"},{"key":"userDefinedConfiguration.conf","path":"userDefinedConfiguration.conf"}]}}],"defaultMode":420}},{"name":"rabbitmq-erlang-cookie","emptyDir":{}},{"name":"erlang-cookie-secret","secret":{"secretName":"rabbitmq-cluster-erlang-cookie","defaultMode":420}},{"name":"rabbitmq-plugins","emptyDir":{}},{"name":"pod-info","downwardAPI":{"items":[{"path":"skipPreStopChecks","fieldRef":{"apiVersion":"v1","fieldPath":"metadata.labels['skipPreStopChecks']"}}],"defaultMode":420}}],"initContainers":[{"name":"setup-container","image":"rabbitmq:3.8.12-management","command":["sh","-c","cp /tmp/erlang-cookie-secret/.erlang.cookie /var/lib/rabbitmq/.erlang.cookie \u0026\u0026 chown 999:999 /var/lib/rabbitmq/.erlang.cookie \u0026\u0026 chmod 600 /var/lib/rabbitmq/.erlang.cookie ; cp /tmp/rabbitmq-plugins/enabled_plugins /operator/enabled_plugins \u0026\u0026 chown 999:999 /operator/enabled_plugins ; chown 999:999 /var/lib/rabbitmq/mnesia/ ; echo '[default]' \u003e /var/lib/rabbitmq/.rabbitmqadmin.conf \u0026\u0026 sed -e 's/default_user/username/' -e 's/default_pass/password/' /tmp/default_user.conf \u003e\u003e /var/lib/rabbitmq/.rabbitmqadmin.conf \u0026\u0026 chown 999:999 /var/lib/rabbitmq/.rabbitmqadmin.conf \u0026\u0026 chmod 600 /var/lib/rabbitmq/.rabbitmqadmin.conf"],"resources":{"limits":{"cpu":"100m","memory":"500Mi"},"requests":{"cpu":"100m","memory":"500Mi"}},"volumeMounts":[{"name":"plugins-conf","mountPath":"/tmp/rabbitmq-plugins/"},{"name":"rabbitmq-erlang-cookie","mountPath":"/var/lib/rabbitmq/"},{"name":"erlang-cookie-secret","mountPath":"/tmp/erlang-cookie-secret/"},{"name":"rabbitmq-plugins","mountPath":"/operator"},{"name":"persistence","mountPath":"/var/lib/rabbitmq/mnesia/"},{"name":"rabbitmq-confd","mountPath":"/tmp/default_user.conf","subPath":"default_user.conf"}],"terminationMessagePath":"/dev/termination-log","terminationMessagePolicy":"File","imagePullPolicy":"IfNotPresent","securityContext":{"capabilities":{"drop":["FSETID","KILL","SETGID","SETUID","SETPCAP","NET_BIND_SERVICE","NET_RAW","SYS_CHROOT","MKNOD","AUDIT_WRITE","SETFCAP"]},"runAsUser":0}}],"containers":[{"name":"rabbitmq","image":"rabbitmq:3.8.12-management","ports":[{"name":"epmd","containerPort":4369,"protocol":"TCP"},{"name":"amqp","containerPort":5672,"protocol":"TCP"},{"name":"management","containerPort":15672,"protocol":"TCP"},{"name":"prometheus","containerPort":15692,"protocol":"TCP"}],"env":[{"name":"MY_POD_NAME","valueFrom":{"fieldRef":{"apiVersion":"v1","fieldPath":"metadata.name"}}},{"name":"MY_POD_NAMESPACE","valueFrom":{"fieldRef":{"apiVersion":"v1","fieldPath":"metadata.namespace"}}},{"name":"RABBITMQ_ENABLED_PLUGINS_FILE","value":"/operator/enabled_plugins"},{"name":"K8S_SERVICE_NAME","value":"rabbitmq-cluster-nodes"},{"name":"RABBITMQ_USE_LONGNAME","value":"true"},{"name":"RABBITMQ_NODENAME","value":"rabbit@$(MY_POD_NAME).$(K8S_SERVICE_NAME).$(MY_POD_NAMESPACE)"},{"name":"K8S_HOSTNAME_SUFFIX","value":".$(K8S_SERVICE_NAME).$(MY_POD_NAMESPACE)"}],"resources":{"limits":{"cpu":"2","memory":"2Gi"},"requests":{"cpu":"1","memory":"2Gi"}},"volumeMounts":[{"name":"rabbitmq-erlang-cookie","mountPath":"/var/lib/rabbitmq/"},{"name":"persistence","mountPath":"/var/lib/rabbitmq/mnesia/"},{"name":"rabbitmq-plugins","mountPath":"/operator"},{"name":"rabbitmq-confd","mountPath":"/etc/rabbitmq/conf.d/10-operatorDefaults.conf","subPath":"operatorDefaults.conf"},{"name":"rabbitmq-confd","mountPath":"/etc/rabbitmq/conf.d/11-default_user.conf","subPath":"default_user.conf"},{"name":"rabbitmq-confd","mountPath":"/etc/rabbitmq/conf.d/90-userDefinedConfiguration.conf","subPath":"userDefinedConfiguration.conf"},{"name":"pod-info","mountPath":"/etc/pod-info/"}],"readinessProbe":{"tcpSocket":{"port":"amqp"},"initialDelaySeconds":10,"timeoutSeconds":5,"periodSeconds":10,"successThreshold":1,"failureThreshold":3},"lifecycle":{"preStop":{"exec":{"command":["/bin/bash","-c","if [ ! -z \"$(cat /etc/pod-info/skipPreStopChecks)\" ]; then exit 0; fi; rabbitmq-upgrade await_online_quorum_plus_one -t 604800; rabbitmq-upgrade await_online_synchronized_mirror -t 604800; rabbitmq-upgrade drain -t 604800"]}}},"terminationMessagePath":"/dev/termination-log","terminationMessagePolicy":"File","imagePullPolicy":"IfNotPresent"}],"restartPolicy":"Always","terminationGracePeriodSeconds":604800,"dnsPolicy":"ClusterFirst","serviceAccountName":"rabbitmq-cluster-server","serviceAccount":"rabbitmq-cluster-server","automountServiceAccountToken":true,"securityContext":{"runAsUser":999,"runAsGroup":999,"fsGroup":999},"schedulerName":"default-scheduler","topologySpreadConstraints":[{"maxSkew":1,"topologyKey":"topology.kubernetes.io/zone","whenUnsatisfiable":"ScheduleAnyway","labelSelector":{"matchLabels":{"app.kubernetes.io/name":"rabbitmq-cluster"}}}]}},"volumeClaimTemplates":[{"metadata":{"name":"persistence","namespace":"default","creationTimestamp":null,"labels":{"app.kubernetes.io/component":"rabbitmq","app.kubernetes.io/name":"rabbitmq-cluster","app.kubernetes.io/part-of":"rabbitmq"},"ownerReferences":[{"apiVersion":"rabbitmq.com/v1beta1","kind":"RabbitmqCluster","name":"rabbitmq-cluster","uid":"18d9928b-0d1c-47be-80ec-20960d053827","controller":true,"blockOwnerDeletion":false}]},"spec":{"accessModes":["ReadWriteOnce"],"resources":{"requests":{"storage":"10Gi"}},"volumeMode":"Filesystem"},"status":{"phase":"Pending"}}],"serviceName":"rabbitmq-cluster-nodes","podManagementPolicy":"Parallel","updateStrategy":{"type":"RollingUpdate","rollingUpdate":{"partition":0}},"revisionHistoryLimit":10},"status":{"observedGeneration":2,"replicas":3,"readyReplicas":3,"currentReplicas":3,"updatedReplicas":3,"currentRevision":"rabbitmq-cluster-server-5f8b8665fb","updateRevision":"rabbitmq-cluster-server-5f8b8665fb","collisionCount":0}}
2022/03/18 18:02:01 learn_server.go:291: [SIEVE-AFTER-READ]	Get	true	configmap	default	rabbitmq-cluster-server-conf	github.com/rabbitmq/cluster-operator/controllers.(*RabbitmqClusterReconciler)	NoError	{"kind":"ConfigMap","apiVersion":"v1","metadata":{"name":"rabbitmq-cluster-server-conf","namespace":"default","selfLink":"/api/v1/namespaces/default/configmaps/rabbitmq-cluster-server-conf","uid":"22474f2b-8454-44b7-8079-8990223969cc","resourceVersion":"714","creationTimestamp":"2022-03-18T18:00:38Z","labels":{"app.kubernetes.io/component":"rabbitmq","app.kubernetes.io/name":"rabbitmq-cluster","app.kubernetes.io/part-of":"rabbitmq"},"ownerReferences":[{"apiVersion":"rabbitmq.com/v1beta1","kind":"RabbitmqCluster","name":"rabbitmq-cluster","uid":"18d9928b-0d1c-47be-80ec-20960d053827","controller":true,"blockOwnerDeletion":true}],"managedFields":[{"manager":"manager","operation":"Update","apiVersion":"v1","time":"2022-03-18T18:00:38Z","fieldsType":"FieldsV1","fieldsV1":{"f:data":{".":{},"f:operatorDefaults.conf":{},"f:userDefinedConfiguration.conf":{}},"f:metadata":{"f:labels":{".":{},"f:app.kubernetes.io/component":{},"f:app.kubernetes.io/name":{},"f:app.kubernetes.io/part-of":{}},"f:ownerReferences":{".":{},"k:{\"uid\":\"18d9928b-0d1c-47be-80ec-20960d053827\"}":{".":{},"f:apiVersion":{},"f:blockOwnerDeletion":{},"f:controller":{},"f:kind":{},"f:name":{},"f:uid":{}}}}}}]},"data":{"operatorDefaults.conf":"cluster_formation.peer_discovery_backend             = rabbit_peer_discovery_k8s\ncluster_formation.k8s.host                           = kubernetes.default\ncluster_formation.k8s.address_type                   = hostname\ncluster_partition_handling                           = pause_minority\nqueue_master_locator                                 = min-masters\ndisk_free_limit.absolute                             = 2GB\ncluster_formation.randomized_startup_delay_range.min = 5\ncluster_formation.randomized_startup_delay_range.max = 30\ncluster_name                                         = rabbitmq-cluster\n","userDefinedConfiguration.conf":"total_memory_available_override_value = 1717986919\n"}}
2022/03/18 18:02:01 learn_server.go:256: [SIEVE-BEFORE-WRITE]	59
2022/03/18 18:02:01 learn_server.go:263: [SIEVE-AFTER-WRITE]	59	StatusUpdate	rabbitmqcluster	github.com/rabbitmq/cluster-operator/controllers.(*RabbitmqClusterReconciler)	NoError	{"metadata":{"name":"rabbitmq-cluster","namespace":"default","selfLink":"/apis/rabbitmq.com/v1beta1/namespaces/default/rabbitmqclusters/rabbitmq-cluster/status","uid":"18d9928b-0d1c-47be-80ec-20960d053827","resourceVersion":"1232","generation":3,"creationTimestamp":"2022-03-18T18:00:38Z","annotations":{"kubectl.kubernetes.io/last-applied-configuration":"{\"apiVersion\":\"rabbitmq.com/v1beta1\",\"kind\":\"RabbitmqCluster\",\"metadata\":{\"annotations\":{},\"name\":\"rabbitmq-cluster\",\"namespace\":\"default\"},\"spec\":{\"persistence\":{\"storage\":\"10Gi\"},\"replicas\":1}}\n"},"finalizers":["deletion.finalizers.rabbitmqclusters.rabbitmq.com"],"managedFields":[{"manager":"kubectl-client-side-apply","operation":"Update","apiVersion":"rabbitmq.com/v1beta1","time":"2022-03-18T18:00:38Z","fieldsType":"FieldsV1","fieldsV1":{"f:metadata":{"f:annotations":{".":{},"f:kubectl.kubernetes.io/last-applied-configuration":{}}},"f:spec":{".":{},"f:image":{},"f:persistence":{".":{},"f:storage":{}},"f:resources":{".":{},"f:limits":{".":{},"f:memory":{}},"f:requests":{".":{},"f:memory":{}}},"f:service":{".":{},"f:type":{}},"f:terminationGracePeriodSeconds":{}}}},{"manager":"kubectl-patch","operation":"Update","apiVersion":"rabbitmq.com/v1beta1","time":"2022-03-18T18:01:23Z","fieldsType":"FieldsV1","fieldsV1":{"f:spec":{"f:replicas":{}}}},{"manager":"manager","operation":"Update","apiVersion":"rabbitmq.com/v1beta1","time":"2022-03-18T18:02:01Z","fieldsType":"FieldsV1","fieldsV1":{"f:metadata":{"f:finalizers":{}},"f:spec":{"f:override":{},"f:rabbitmq":{},"f:resources":{"f:limits":{"f:cpu":{}},"f:requests":{"f:cpu":{}}},"f:tls":{}},"f:status":{".":{},"f:conditions":{},"f:defaultUser":{".":{},"f:secretReference":{".":{},"f:keys":{".":{},"f:password":{},"f:username":{}},"f:name":{},"f:namespace":{}},"f:serviceReference":{".":{},"f:name":{},"f:namespace":{}}}}}}]},"spec":{"replicas":3,"image":"rabbitmq:3.8.12-management","service":{"type":"ClusterIP"},"persistence":{"storage":"10Gi"},"resources":{"limits":{"cpu":"2","memory":"2Gi"},"requests":{"cpu":"1","memory":"2Gi"}},"rabbitmq":{},"tls":{},"override":{},"terminationGracePeriodSeconds":604800},"status":{"conditions":[{"type":"AllReplicasReady","status":"True","lastTransitionTime":"2022-03-18T18:02:01Z","reason":"AllPodsAreReady"},{"type":"ClusterAvailable","status":"True","lastTransitionTime":"2022-03-18T18:01:17Z","reason":"AtLeastOneEndpointAvailable"},{"type":"NoWarnings","status":"True","lastTransitionTime":"2022-03-18T18:00:38Z","reason":"NoWarnings"},{"type":"ReconcileSuccess","status":"True","lastTransitionTime":"2022-03-18T18:01:18Z","reason":"Success","message":"Finish reconciling"}],"defaultUser":{"secretReference":{"name":"rabbitmq-cluster-default-user","namespace":"default","keys":{"password":"password","username":"username"}},"serviceReference":{"name":"rabbitmq-cluster","namespace":"default"}},"binding":{"name":"rabbitmq-cluster-default-user"}}}
2022/03/18 18:02:01 learn_server.go:291: [SIEVE-AFTER-READ]	Get	true	statefulset	default	rabbitmq-cluster-server	github.com/rabbitmq/cluster-operator/controllers.(*RabbitmqClusterReconciler)	NoError	{"kind":"StatefulSet","apiVersion":"apps/v1","metadata":{"name":"rabbitmq-cluster-server","namespace":"default","selfLink":"/apis/apps/v1/namespaces/default/statefulsets/rabbitmq-cluster-server","uid":"cb5c43bc-6ee7-481c-ab01-6f3acffdd3c8","resourceVersion":"1231","generation":2,"creationTimestamp":"2022-03-18T18:00:38Z","labels":{"app.kubernetes.io/component":"rabbitmq","app.kubernetes.io/name":"rabbitmq-cluster","app.kubernetes.io/part-of":"rabbitmq"},"ownerReferences":[{"apiVersion":"rabbitmq.com/v1beta1","kind":"RabbitmqCluster","name":"rabbitmq-cluster","uid":"18d9928b-0d1c-47be-80ec-20960d053827","controller":true,"blockOwnerDeletion":true}],"managedFields":[{"manager":"manager","operation":"Update","apiVersion":"apps/v1","time":"2022-03-18T18:01:23Z","fieldsType":"FieldsV1","fieldsV1":{"f:metadata":{"f:labels":{".":{},"f:app.kubernetes.io/component":{},"f:app.kubernetes.io/name":{},"f:app.kubernetes.io/part-of":{}},"f:ownerReferences":{".":{},"k:{\"uid\":\"18d9928b-0d1c-47be-80ec-20960d053827\"}":{".":{},"f:apiVersion":{},"f:blockOwnerDeletion":{},"f:controller":{},"f:kind":{},"f:name":{},"f:uid":{}}}},"f:spec":{"f:podManagementPolicy":{},"f:replicas":{},"f:revisionHistoryLimit":{},"f:selector":{"f:matchLabels":{".":{},"f:app.kubernetes.io/name":{}}},"f:serviceName":{},"f:template":{"f:metadata":{"f:annotations":{".":{},"f:prometheus.io/port":{},"f:prometheus.io/scrape":{}},"f:labels":{".":{},"f:app.kubernetes.io/component":{},"f:app.kubernetes.io/name":{},"f:app.kubernetes.io/part-of":{}}},"f:spec":{"f:automountServiceAccountToken":{},"f:containers":{"k:{\"name\":\"rabbitmq\"}":{".":{},"f:env":{".":{},"k:{\"name\":\"K8S_HOSTNAME_SUFFIX\"}":{".":{},"f:name":{},"f:value":{}},"k:{\"name\":\"K8S_SERVICE_NAME\"}":{".":{},"f:name":{},"f:value":{}},"k:{\"name\":\"MY_POD_NAME\"}":{".":{},"f:name":{},"f:valueFrom":{".":{},"f:fieldRef":{".":{},"f:apiVersion":{},"f:fieldPath":{}}}},"k:{\"name\":\"MY_POD_NAMESPACE\"}":{".":{},"f:name":{},"f:valueFrom":{".":{},"f:fieldRef":{".":{},"f:apiVersion":{},"f:fieldPath":{}}}},"k:{\"name\":\"RABBITMQ_ENABLED_PLUGINS_FILE\"}":{".":{},"f:name":{},"f:value":{}},"k:{\"name\":\"RABBITMQ_NODENAME\"}":{".":{},"f:name":{},"f:value":{}},"k:{\"name\":\"RABBITMQ_USE_LONGNAME\"}":{".":{},"f:name":{},"f:value":{}}},"f:image":{},"f:imagePullPolicy":{},"f:lifecycle":{".":{},"f:preStop":{".":{},"f:exec":{".":{},"f:command":{}}}},"f:name":{},"f:ports":{".":{},"k:{\"containerPort\":4369,\"protocol\":\"TCP\"}":{".":{},"f:containerPort":{},"f:name":{},"f:protocol":{}},"k:{\"containerPort\":5672,\"protocol\":\"TCP\"}":{".":{},"f:containerPort":{},"f:name":{},"f:protocol":{}},"k:{\"containerPort\":15672,\"protocol\":\"TCP\"}":{".":{},"f:containerPort":{},"f:name":{},"f:protocol":{}},"k:{\"containerPort\":15692,\"protocol\":\"TCP\"}":{".":{},"f:containerPort":{},"f:name":{},"f:protocol":{}}},"f:readinessProbe":{".":{},"f:failureThreshold":{},"f:initialDelaySeconds":{},"f:periodSeconds":{},"f:successThreshold":{},"f:tcpSocket":{".":{},"f:port":{}},"f:timeoutSeconds":{}},"f:resources":{".":{},"f:limits":{".":{},"f:cpu":{},"f:memory":{}},"f:requests":{".":{},"f:cpu":{},"f:memory":{}}},"f:terminationMessagePath":{},"f:terminationMessagePolicy":{},"f:volumeMounts":{".":{},"k:{\"mountPath\":\"/etc/pod-info/\"}":{".":{},"f:mountPath":{},"f:name":{}},"k:{\"mountPath\":\"/etc/rabbitmq/conf.d/10-operatorDefaults.conf\"}":{".":{},"f:mountPath":{},"f:name":{},"f:subPath":{}},"k:{\"mountPath\":\"/etc/rabbitmq/conf.d/11-default_user.conf\"}":{".":{},"f:mountPath":{},"f:name":{},"f:subPath":{}},"k:{\"mountPath\":\"/etc/rabbitmq/conf.d/90-userDefinedConfiguration.conf\"}":{".":{},"f:mountPath":{},"f:name":{},"f:subPath":{}},"k:{\"mountPath\":\"/operator\"}":{".":{},"f:mountPath":{},"f:name":{}},"k:{\"mountPath\":\"/var/lib/rabbitmq/\"}":{".":{},"f:mountPath":{},"f:name":{}},"k:{\"mountPath\":\"/var/lib/rabbitmq/mnesia/\"}":{".":{},"f:mountPath":{},"f:name":{}}}}},"f:dnsPolicy":{},"f:initContainers":{".":{},"k:{\"name\":\"setup-container\"}":{".":{},"f:command":{},"f:image":{},"f:imagePullPolicy":{},"f:name":{},"f:resources":{".":{},"f:limits":{".":{},"f:cpu":{},"f:memory":{}},"f:requests":{".":{},"f:cpu":{},"f:memory":{}}},"f:securityContext":{".":{},"f:capabilities":{".":{},"f:drop":{}},"f:runAsUser":{}},"f:terminationMessagePath":{},"f:terminationMessagePolicy":{},"f:volumeMounts":{".":{},"k:{\"mountPath\":\"/operator\"}":{".":{},"f:mountPath":{},"f:name":{}},"k:{\"mountPath\":\"/tmp/default_user.conf\"}":{".":{},"f:mountPath":{},"f:name":{},"f:subPath":{}},"k:{\"mountPath\":\"/tmp/erlang-cookie-secret/\"}":{".":{},"f:mountPath":{},"f:name":{}},"k:{\"mountPath\":\"/tmp/rabbitmq-plugins/\"}":{".":{},"f:mountPath":{},"f:name":{}},"k:{\"mountPath\":\"/var/lib/rabbitmq/\"}":{".":{},"f:mountPath":{},"f:name":{}},"k:{\"mountPath\":\"/var/lib/rabbitmq/mnesia/\"}":{".":{},"f:mountPath":{},"f:name":{}}}}},"f:restartPolicy":{},"f:schedulerName":{},"f:securityContext":{".":{},"f:fsGroup":{},"f:runAsGroup":{},"f:runAsUser":{}},"f:serviceAccount":{},"f:serviceAccountName":{},"f:terminationGracePeriodSeconds":{},"f:topologySpreadConstraints":{".":{},"k:{\"topologyKey\":\"topology.kubernetes.io/zone\",\"whenUnsatisfiable\":\"ScheduleAnyway\"}":{".":{},"f:labelSelector":{".":{},"f:matchLabels":{".":{},"f:app.kubernetes.io/name":{}}},"f:maxSkew":{},"f:topologyKey":{},"f:whenUnsatisfiable":{}}},"f:volumes":{".":{},"k:{\"name\":\"erlang-cookie-secret\"}":{".":{},"f:name":{},"f:secret":{".":{},"f:defaultMode":{},"f:secretName":{}}},"k:{\"name\":\"plugins-conf\"}":{".":{},"f:configMap":{".":{},"f:defaultMode":{},"f:name":{}},"f:name":{}},"k:{\"name\":\"pod-info\"}":{".":{},"f:downwardAPI":{".":{},"f:defaultMode":{},"f:items":{}},"f:name":{}},"k:{\"name\":\"rabbitmq-confd\"}":{".":{},"f:name":{},"f:projected":{".":{},"f:defaultMode":{},"f:sources":{}}},"k:{\"name\":\"rabbitmq-erlang-cookie\"}":{".":{},"f:emptyDir":{},"f:name":{}},"k:{\"name\":\"rabbitmq-plugins\"}":{".":{},"f:emptyDir":{},"f:name":{}}}}},"f:updateStrategy":{"f:rollingUpdate":{".":{},"f:partition":{}},"f:type":{}},"f:volumeClaimTemplates":{}}}},{"manager":"kube-controller-manager","operation":"Update","apiVersion":"apps/v1","time":"2022-03-18T18:02:01Z","fieldsType":"FieldsV1","fieldsV1":{"f:status":{"f:collisionCount":{},"f:currentReplicas":{},"f:currentRevision":{},"f:observedGeneration":{},"f:readyReplicas":{},"f:replicas":{},"f:updateRevision":{},"f:updatedReplicas":{}}}}]},"spec":{"replicas":3,"selector":{"matchLabels":{"app.kubernetes.io/name":"rabbitmq-cluster"}},"template":{"metadata":{"creationTimestamp":null,"labels":{"app.kubernetes.io/component":"rabbitmq","app.kubernetes.io/name":"rabbitmq-cluster","app.kubernetes.io/part-of":"rabbitmq"},"annotations":{"prometheus.io/port":"15692","prometheus.io/scrape":"true"}},"spec":{"volumes":[{"name":"plugins-conf","configMap":{"name":"rabbitmq-cluster-plugins-conf","defaultMode":420}},{"name":"rabbitmq-confd","projected":{"sources":[{"secret":{"name":"rabbitmq-cluster-default-user","items":[{"key":"default_user.conf","path":"default_user.conf"}]}},{"configMap":{"name":"rabbitmq-cluster-server-conf","items":[{"key":"operatorDefaults.conf","path":"operatorDefaults.conf"},{"key":"userDefinedConfiguration.conf","path":"userDefinedConfiguration.conf"}]}}],"defaultMode":420}},{"name":"rabbitmq-erlang-cookie","emptyDir":{}},{"name":"erlang-cookie-secret","secret":{"secretName":"rabbitmq-cluster-erlang-cookie","defaultMode":420}},{"name":"rabbitmq-plugins","emptyDir":{}},{"name":"pod-info","downwardAPI":{"items":[{"path":"skipPreStopChecks","fieldRef":{"apiVersion":"v1","fieldPath":"metadata.labels['skipPreStopChecks']"}}],"defaultMode":420}}],"initContainers":[{"name":"setup-container","image":"rabbitmq:3.8.12-management","command":["sh","-c","cp /tmp/erlang-cookie-secret/.erlang.cookie /var/lib/rabbitmq/.erlang.cookie \u0026\u0026 chown 999:999 /var/lib/rabbitmq/.erlang.cookie \u0026\u0026 chmod 600 /var/lib/rabbitmq/.erlang.cookie ; cp /tmp/rabbitmq-plugins/enabled_plugins /operator/enabled_plugins \u0026\u0026 chown 999:999 /operator/enabled_plugins ; chown 999:999 /var/lib/rabbitmq/mnesia/ ; echo '[default]' \u003e /var/lib/rabbitmq/.rabbitmqadmin.conf \u0026\u0026 sed -e 's/default_user/username/' -e 's/default_pass/password/' /tmp/default_user.conf \u003e\u003e /var/lib/rabbitmq/.rabbitmqadmin.conf \u0026\u0026 chown 999:999 /var/lib/rabbitmq/.rabbitmqadmin.conf \u0026\u0026 chmod 600 /var/lib/rabbitmq/.rabbitmqadmin.conf"],"resources":{"limits":{"cpu":"100m","memory":"500Mi"},"requests":{"cpu":"100m","memory":"500Mi"}},"volumeMounts":[{"name":"plugins-conf","mountPath":"/tmp/rabbitmq-plugins/"},{"name":"rabbitmq-erlang-cookie","mountPath":"/var/lib/rabbitmq/"},{"name":"erlang-cookie-secret","mountPath":"/tmp/erlang-cookie-secret/"},{"name":"rabbitmq-plugins","mountPath":"/operator"},{"name":"persistence","mountPath":"/var/lib/rabbitmq/mnesia/"},{"name":"rabbitmq-confd","mountPath":"/tmp/default_user.conf","subPath":"default_user.conf"}],"terminationMessagePath":"/dev/termination-log","terminationMessagePolicy":"File","imagePullPolicy":"IfNotPresent","securityContext":{"capabilities":{"drop":["FSETID","KILL","SETGID","SETUID","SETPCAP","NET_BIND_SERVICE","NET_RAW","SYS_CHROOT","MKNOD","AUDIT_WRITE","SETFCAP"]},"runAsUser":0}}],"containers":[{"name":"rabbitmq","image":"rabbitmq:3.8.12-management","ports":[{"name":"epmd","containerPort":4369,"protocol":"TCP"},{"name":"amqp","containerPort":5672,"protocol":"TCP"},{"name":"management","containerPort":15672,"protocol":"TCP"},{"name":"prometheus","containerPort":15692,"protocol":"TCP"}],"env":[{"name":"MY_POD_NAME","valueFrom":{"fieldRef":{"apiVersion":"v1","fieldPath":"metadata.name"}}},{"name":"MY_POD_NAMESPACE","valueFrom":{"fieldRef":{"apiVersion":"v1","fieldPath":"metadata.namespace"}}},{"name":"RABBITMQ_ENABLED_PLUGINS_FILE","value":"/operator/enabled_plugins"},{"name":"K8S_SERVICE_NAME","value":"rabbitmq-cluster-nodes"},{"name":"RABBITMQ_USE_LONGNAME","value":"true"},{"name":"RABBITMQ_NODENAME","value":"rabbit@$(MY_POD_NAME).$(K8S_SERVICE_NAME).$(MY_POD_NAMESPACE)"},{"name":"K8S_HOSTNAME_SUFFIX","value":".$(K8S_SERVICE_NAME).$(MY_POD_NAMESPACE)"}],"resources":{"limits":{"cpu":"2","memory":"2Gi"},"requests":{"cpu":"1","memory":"2Gi"}},"volumeMounts":[{"name":"rabbitmq-erlang-cookie","mountPath":"/var/lib/rabbitmq/"},{"name":"persistence","mountPath":"/var/lib/rabbitmq/mnesia/"},{"name":"rabbitmq-plugins","mountPath":"/operator"},{"name":"rabbitmq-confd","mountPath":"/etc/rabbitmq/conf.d/10-operatorDefaults.conf","subPath":"operatorDefaults.conf"},{"name":"rabbitmq-confd","mountPath":"/etc/rabbitmq/conf.d/11-default_user.conf","subPath":"default_user.conf"},{"name":"rabbitmq-confd","mountPath":"/etc/rabbitmq/conf.d/90-userDefinedConfiguration.conf","subPath":"userDefinedConfiguration.conf"},{"name":"pod-info","mountPath":"/etc/pod-info/"}],"readinessProbe":{"tcpSocket":{"port":"amqp"},"initialDelaySeconds":10,"timeoutSeconds":5,"periodSeconds":10,"successThreshold":1,"failureThreshold":3},"lifecycle":{"preStop":{"exec":{"command":["/bin/bash","-c","if [ ! -z \"$(cat /etc/pod-info/skipPreStopChecks)\" ]; then exit 0; fi; rabbitmq-upgrade await_online_quorum_plus_one -t 604800; rabbitmq-upgrade await_online_synchronized_mirror -t 604800; rabbitmq-upgrade drain -t 604800"]}}},"terminationMessagePath":"/dev/termination-log","terminationMessagePolicy":"File","imagePullPolicy":"IfNotPresent"}],"restartPolicy":"Always","terminationGracePeriodSeconds":604800,"dnsPolicy":"ClusterFirst","serviceAccountName":"rabbitmq-cluster-server","serviceAccount":"rabbitmq-cluster-server","automountServiceAccountToken":true,"securityContext":{"runAsUser":999,"runAsGroup":999,"fsGroup":999},"schedulerName":"default-scheduler","topologySpreadConstraints":[{"maxSkew":1,"topologyKey":"topology.kubernetes.io/zone","whenUnsatisfiable":"ScheduleAnyway","labelSelector":{"matchLabels":{"app.kubernetes.io/name":"rabbitmq-cluster"}}}]}},"volumeClaimTemplates":[{"metadata":{"name":"persistence","namespace":"default","creationTimestamp":null,"labels":{"app.kubernetes.io/component":"rabbitmq","app.kubernetes.io/name":"rabbitmq-cluster","app.kubernetes.io/part-of":"rabbitmq"},"ownerReferences":[{"apiVersion":"rabbitmq.com/v1beta1","kind":"RabbitmqCluster","name":"rabbitmq-cluster","uid":"18d9928b-0d1c-47be-80ec-20960d053827","controller":true,"blockOwnerDeletion":false}]},"spec":{"accessModes":["ReadWriteOnce"],"resources":{"requests":{"storage":"10Gi"}},"volumeMode":"Filesystem"},"status":{"phase":"Pending"}}],"serviceName":"rabbitmq-cluster-nodes","podManagementPolicy":"Parallel","updateStrategy":{"type":"RollingUpdate","rollingUpdate":{"partition":0}},"revisionHistoryLimit":10},"status":{"observedGeneration":2,"replicas":3,"readyReplicas":3,"currentReplicas":3,"updatedReplicas":3,"currentRevision":"rabbitmq-cluster-server-5f8b8665fb","updateRevision":"rabbitmq-cluster-server-5f8b8665fb","collisionCount":0}}
2022/03/18 18:02:01 learn_server.go:291: [SIEVE-AFTER-READ]	Get	true	configmap	default	rabbitmq-cluster-plugins-conf	github.com/rabbitmq/cluster-operator/controllers.(*RabbitmqClusterReconciler)	NoError	{"kind":"ConfigMap","apiVersion":"v1","metadata":{"name":"rabbitmq-cluster-plugins-conf","namespace":"default","selfLink":"/api/v1/namespaces/default/configmaps/rabbitmq-cluster-plugins-conf","uid":"a164075b-0562-47ac-a577-99aa8651ec40","resourceVersion":"709","creationTimestamp":"2022-03-18T18:00:38Z","labels":{"app.kubernetes.io/component":"rabbitmq","app.kubernetes.io/name":"rabbitmq-cluster","app.kubernetes.io/part-of":"rabbitmq"},"ownerReferences":[{"apiVersion":"rabbitmq.com/v1beta1","kind":"RabbitmqCluster","name":"rabbitmq-cluster","uid":"18d9928b-0d1c-47be-80ec-20960d053827","controller":true,"blockOwnerDeletion":true}],"managedFields":[{"manager":"manager","operation":"Update","apiVersion":"v1","time":"2022-03-18T18:00:38Z","fieldsType":"FieldsV1","fieldsV1":{"f:data":{".":{},"f:enabled_plugins":{}},"f:metadata":{"f:labels":{".":{},"f:app.kubernetes.io/component":{},"f:app.kubernetes.io/name":{},"f:app.kubernetes.io/part-of":{}},"f:ownerReferences":{".":{},"k:{\"uid\":\"18d9928b-0d1c-47be-80ec-20960d053827\"}":{".":{},"f:apiVersion":{},"f:blockOwnerDeletion":{},"f:controller":{},"f:kind":{},"f:name":{},"f:uid":{}}}}}}]},"data":{"enabled_plugins":"[rabbitmq_peer_discovery_k8s,rabbitmq_prometheus,rabbitmq_management]."}}
2022/03/18 18:02:01 learn_server.go:256: [SIEVE-BEFORE-WRITE]	60
2022/03/18 18:02:01 learn_server.go:263: [SIEVE-AFTER-WRITE]	60	StatusUpdate	rabbitmqcluster	github.com/rabbitmq/cluster-operator/controllers.(*RabbitmqClusterReconciler)	NoError	{"metadata":{"name":"rabbitmq-cluster","namespace":"default","selfLink":"/apis/rabbitmq.com/v1beta1/namespaces/default/rabbitmqclusters/rabbitmq-cluster/status","uid":"18d9928b-0d1c-47be-80ec-20960d053827","resourceVersion":"1232","generation":3,"creationTimestamp":"2022-03-18T18:00:38Z","annotations":{"kubectl.kubernetes.io/last-applied-configuration":"{\"apiVersion\":\"rabbitmq.com/v1beta1\",\"kind\":\"RabbitmqCluster\",\"metadata\":{\"annotations\":{},\"name\":\"rabbitmq-cluster\",\"namespace\":\"default\"},\"spec\":{\"persistence\":{\"storage\":\"10Gi\"},\"replicas\":1}}\n"},"finalizers":["deletion.finalizers.rabbitmqclusters.rabbitmq.com"],"managedFields":[{"manager":"kubectl-client-side-apply","operation":"Update","apiVersion":"rabbitmq.com/v1beta1","time":"2022-03-18T18:00:38Z","fieldsType":"FieldsV1","fieldsV1":{"f:metadata":{"f:annotations":{".":{},"f:kubectl.kubernetes.io/last-applied-configuration":{}}},"f:spec":{".":{},"f:image":{},"f:persistence":{".":{},"f:storage":{}},"f:resources":{".":{},"f:limits":{".":{},"f:memory":{}},"f:requests":{".":{},"f:memory":{}}},"f:service":{".":{},"f:type":{}},"f:terminationGracePeriodSeconds":{}}}},{"manager":"kubectl-patch","operation":"Update","apiVersion":"rabbitmq.com/v1beta1","time":"2022-03-18T18:01:23Z","fieldsType":"FieldsV1","fieldsV1":{"f:spec":{"f:replicas":{}}}},{"manager":"manager","operation":"Update","apiVersion":"rabbitmq.com/v1beta1","time":"2022-03-18T18:02:01Z","fieldsType":"FieldsV1","fieldsV1":{"f:metadata":{"f:finalizers":{}},"f:spec":{"f:override":{},"f:rabbitmq":{},"f:resources":{"f:limits":{"f:cpu":{}},"f:requests":{"f:cpu":{}}},"f:tls":{}},"f:status":{".":{},"f:conditions":{},"f:defaultUser":{".":{},"f:secretReference":{".":{},"f:keys":{".":{},"f:password":{},"f:username":{}},"f:name":{},"f:namespace":{}},"f:serviceReference":{".":{},"f:name":{},"f:namespace":{}}}}}}]},"spec":{"replicas":3,"image":"rabbitmq:3.8.12-management","service":{"type":"ClusterIP"},"persistence":{"storage":"10Gi"},"resources":{"limits":{"cpu":"2","memory":"2Gi"},"requests":{"cpu":"1","memory":"2Gi"}},"rabbitmq":{},"tls":{},"override":{},"terminationGracePeriodSeconds":604800},"status":{"conditions":[{"type":"AllReplicasReady","status":"True","lastTransitionTime":"2022-03-18T18:02:01Z","reason":"AllPodsAreReady"},{"type":"ClusterAvailable","status":"True","lastTransitionTime":"2022-03-18T18:01:17Z","reason":"AtLeastOneEndpointAvailable"},{"type":"NoWarnings","status":"True","lastTransitionTime":"2022-03-18T18:00:38Z","reason":"NoWarnings"},{"type":"ReconcileSuccess","status":"True","lastTransitionTime":"2022-03-18T18:01:18Z","reason":"Success","message":"Finish reconciling"}],"defaultUser":{"secretReference":{"name":"rabbitmq-cluster-default-user","namespace":"default","keys":{"password":"password","username":"username"}},"serviceReference":{"name":"rabbitmq-cluster","namespace":"default"}},"binding":{"name":"rabbitmq-cluster-default-user"}}}
2022/03/18 18:02:01 learn_server.go:253: [SIEVE-AFTER-RECONCILE]	github.com/rabbitmq/cluster-operator/controllers.(*RabbitmqClusterReconciler)	17
2022/03/18 18:02:08 learn_server.go:238: [SIEVE-BEFORE-RECONCILE]	github.com/rabbitmq/cluster-operator/controllers.(*RabbitmqClusterReconciler)	18
2022/03/18 18:02:08 learn_server.go:291: [SIEVE-AFTER-READ]	Get	true	rabbitmqcluster	default	rabbitmq-cluster	github.com/rabbitmq/cluster-operator/controllers.(*RabbitmqClusterReconciler)	NoError	{"kind":"RabbitmqCluster","apiVersion":"rabbitmq.com/v1beta1","metadata":{"name":"rabbitmq-cluster","namespace":"default","selfLink":"/apis/rabbitmq.com/v1beta1/namespaces/default/rabbitmqclusters/rabbitmq-cluster","uid":"18d9928b-0d1c-47be-80ec-20960d053827","resourceVersion":"1232","generation":3,"creationTimestamp":"2022-03-18T18:00:38Z","annotations":{"kubectl.kubernetes.io/last-applied-configuration":"{\"apiVersion\":\"rabbitmq.com/v1beta1\",\"kind\":\"RabbitmqCluster\",\"metadata\":{\"annotations\":{},\"name\":\"rabbitmq-cluster\",\"namespace\":\"default\"},\"spec\":{\"persistence\":{\"storage\":\"10Gi\"},\"replicas\":1}}\n"},"finalizers":["deletion.finalizers.rabbitmqclusters.rabbitmq.com"],"managedFields":[{"manager":"kubectl-client-side-apply","operation":"Update","apiVersion":"rabbitmq.com/v1beta1","time":"2022-03-18T18:00:38Z","fieldsType":"FieldsV1","fieldsV1":{"f:metadata":{"f:annotations":{".":{},"f:kubectl.kubernetes.io/last-applied-configuration":{}}},"f:spec":{".":{},"f:image":{},"f:persistence":{".":{},"f:storage":{}},"f:resources":{".":{},"f:limits":{".":{},"f:memory":{}},"f:requests":{".":{},"f:memory":{}}},"f:service":{".":{},"f:type":{}},"f:terminationGracePeriodSeconds":{}}}},{"manager":"kubectl-patch","operation":"Update","apiVersion":"rabbitmq.com/v1beta1","time":"2022-03-18T18:01:23Z","fieldsType":"FieldsV1","fieldsV1":{"f:spec":{"f:replicas":{}}}},{"manager":"manager","operation":"Update","apiVersion":"rabbitmq.com/v1beta1","time":"2022-03-18T18:02:01Z","fieldsType":"FieldsV1","fieldsV1":{"f:metadata":{"f:finalizers":{}},"f:spec":{"f:override":{},"f:rabbitmq":{},"f:resources":{"f:limits":{"f:cpu":{}},"f:requests":{"f:cpu":{}}},"f:tls":{}},"f:status":{".":{},"f:conditions":{},"f:defaultUser":{".":{},"f:secretReference":{".":{},"f:keys":{".":{},"f:password":{},"f:username":{}},"f:name":{},"f:namespace":{}},"f:serviceReference":{".":{},"f:name":{},"f:namespace":{}}}}}}]},"spec":{"replicas":3,"image":"rabbitmq:3.8.12-management","service":{"type":"ClusterIP"},"persistence":{"storage":"10Gi"},"resources":{"limits":{"cpu":"2","memory":"2Gi"},"requests":{"cpu":"1","memory":"2Gi"}},"rabbitmq":{},"tls":{},"override":{},"terminationGracePeriodSeconds":604800},"status":{"conditions":[{"type":"AllReplicasReady","status":"True","lastTransitionTime":"2022-03-18T18:02:01Z","reason":"AllPodsAreReady"},{"type":"ClusterAvailable","status":"True","lastTransitionTime":"2022-03-18T18:01:17Z","reason":"AtLeastOneEndpointAvailable"},{"type":"NoWarnings","status":"True","lastTransitionTime":"2022-03-18T18:00:38Z","reason":"NoWarnings"},{"type":"ReconcileSuccess","status":"True","lastTransitionTime":"2022-03-18T18:01:18Z","reason":"Success","message":"Finish reconciling"}],"defaultUser":{"secretReference":{"name":"rabbitmq-cluster-default-user","namespace":"default","keys":{"password":"password","username":"username"}},"serviceReference":{"name":"rabbitmq-cluster","namespace":"default"}}}}
2022/03/18 18:02:08 learn_server.go:291: [SIEVE-AFTER-READ]	Get	true	statefulset	default	rabbitmq-cluster-server	github.com/rabbitmq/cluster-operator/controllers.(*RabbitmqClusterReconciler)	NoError	{"kind":"StatefulSet","apiVersion":"apps/v1","metadata":{"name":"rabbitmq-cluster-server","namespace":"default","selfLink":"/apis/apps/v1/namespaces/default/statefulsets/rabbitmq-cluster-server","uid":"cb5c43bc-6ee7-481c-ab01-6f3acffdd3c8","resourceVersion":"1231","generation":2,"creationTimestamp":"2022-03-18T18:00:38Z","labels":{"app.kubernetes.io/component":"rabbitmq","app.kubernetes.io/name":"rabbitmq-cluster","app.kubernetes.io/part-of":"rabbitmq"},"ownerReferences":[{"apiVersion":"rabbitmq.com/v1beta1","kind":"RabbitmqCluster","name":"rabbitmq-cluster","uid":"18d9928b-0d1c-47be-80ec-20960d053827","controller":true,"blockOwnerDeletion":true}],"managedFields":[{"manager":"manager","operation":"Update","apiVersion":"apps/v1","time":"2022-03-18T18:01:23Z","fieldsType":"FieldsV1","fieldsV1":{"f:metadata":{"f:labels":{".":{},"f:app.kubernetes.io/component":{},"f:app.kubernetes.io/name":{},"f:app.kubernetes.io/part-of":{}},"f:ownerReferences":{".":{},"k:{\"uid\":\"18d9928b-0d1c-47be-80ec-20960d053827\"}":{".":{},"f:apiVersion":{},"f:blockOwnerDeletion":{},"f:controller":{},"f:kind":{},"f:name":{},"f:uid":{}}}},"f:spec":{"f:podManagementPolicy":{},"f:replicas":{},"f:revisionHistoryLimit":{},"f:selector":{"f:matchLabels":{".":{},"f:app.kubernetes.io/name":{}}},"f:serviceName":{},"f:template":{"f:metadata":{"f:annotations":{".":{},"f:prometheus.io/port":{},"f:prometheus.io/scrape":{}},"f:labels":{".":{},"f:app.kubernetes.io/component":{},"f:app.kubernetes.io/name":{},"f:app.kubernetes.io/part-of":{}}},"f:spec":{"f:automountServiceAccountToken":{},"f:containers":{"k:{\"name\":\"rabbitmq\"}":{".":{},"f:env":{".":{},"k:{\"name\":\"K8S_HOSTNAME_SUFFIX\"}":{".":{},"f:name":{},"f:value":{}},"k:{\"name\":\"K8S_SERVICE_NAME\"}":{".":{},"f:name":{},"f:value":{}},"k:{\"name\":\"MY_POD_NAME\"}":{".":{},"f:name":{},"f:valueFrom":{".":{},"f:fieldRef":{".":{},"f:apiVersion":{},"f:fieldPath":{}}}},"k:{\"name\":\"MY_POD_NAMESPACE\"}":{".":{},"f:name":{},"f:valueFrom":{".":{},"f:fieldRef":{".":{},"f:apiVersion":{},"f:fieldPath":{}}}},"k:{\"name\":\"RABBITMQ_ENABLED_PLUGINS_FILE\"}":{".":{},"f:name":{},"f:value":{}},"k:{\"name\":\"RABBITMQ_NODENAME\"}":{".":{},"f:name":{},"f:value":{}},"k:{\"name\":\"RABBITMQ_USE_LONGNAME\"}":{".":{},"f:name":{},"f:value":{}}},"f:image":{},"f:imagePullPolicy":{},"f:lifecycle":{".":{},"f:preStop":{".":{},"f:exec":{".":{},"f:command":{}}}},"f:name":{},"f:ports":{".":{},"k:{\"containerPort\":4369,\"protocol\":\"TCP\"}":{".":{},"f:containerPort":{},"f:name":{},"f:protocol":{}},"k:{\"containerPort\":5672,\"protocol\":\"TCP\"}":{".":{},"f:containerPort":{},"f:name":{},"f:protocol":{}},"k:{\"containerPort\":15672,\"protocol\":\"TCP\"}":{".":{},"f:containerPort":{},"f:name":{},"f:protocol":{}},"k:{\"containerPort\":15692,\"protocol\":\"TCP\"}":{".":{},"f:containerPort":{},"f:name":{},"f:protocol":{}}},"f:readinessProbe":{".":{},"f:failureThreshold":{},"f:initialDelaySeconds":{},"f:periodSeconds":{},"f:successThreshold":{},"f:tcpSocket":{".":{},"f:port":{}},"f:timeoutSeconds":{}},"f:resources":{".":{},"f:limits":{".":{},"f:cpu":{},"f:memory":{}},"f:requests":{".":{},"f:cpu":{},"f:memory":{}}},"f:terminationMessagePath":{},"f:terminationMessagePolicy":{},"f:volumeMounts":{".":{},"k:{\"mountPath\":\"/etc/pod-info/\"}":{".":{},"f:mountPath":{},"f:name":{}},"k:{\"mountPath\":\"/etc/rabbitmq/conf.d/10-operatorDefaults.conf\"}":{".":{},"f:mountPath":{},"f:name":{},"f:subPath":{}},"k:{\"mountPath\":\"/etc/rabbitmq/conf.d/11-default_user.conf\"}":{".":{},"f:mountPath":{},"f:name":{},"f:subPath":{}},"k:{\"mountPath\":\"/etc/rabbitmq/conf.d/90-userDefinedConfiguration.conf\"}":{".":{},"f:mountPath":{},"f:name":{},"f:subPath":{}},"k:{\"mountPath\":\"/operator\"}":{".":{},"f:mountPath":{},"f:name":{}},"k:{\"mountPath\":\"/var/lib/rabbitmq/\"}":{".":{},"f:mountPath":{},"f:name":{}},"k:{\"mountPath\":\"/var/lib/rabbitmq/mnesia/\"}":{".":{},"f:mountPath":{},"f:name":{}}}}},"f:dnsPolicy":{},"f:initContainers":{".":{},"k:{\"name\":\"setup-container\"}":{".":{},"f:command":{},"f:image":{},"f:imagePullPolicy":{},"f:name":{},"f:resources":{".":{},"f:limits":{".":{},"f:cpu":{},"f:memory":{}},"f:requests":{".":{},"f:cpu":{},"f:memory":{}}},"f:securityContext":{".":{},"f:capabilities":{".":{},"f:drop":{}},"f:runAsUser":{}},"f:terminationMessagePath":{},"f:terminationMessagePolicy":{},"f:volumeMounts":{".":{},"k:{\"mountPath\":\"/operator\"}":{".":{},"f:mountPath":{},"f:name":{}},"k:{\"mountPath\":\"/tmp/default_user.conf\"}":{".":{},"f:mountPath":{},"f:name":{},"f:subPath":{}},"k:{\"mountPath\":\"/tmp/erlang-cookie-secret/\"}":{".":{},"f:mountPath":{},"f:name":{}},"k:{\"mountPath\":\"/tmp/rabbitmq-plugins/\"}":{".":{},"f:mountPath":{},"f:name":{}},"k:{\"mountPath\":\"/var/lib/rabbitmq/\"}":{".":{},"f:mountPath":{},"f:name":{}},"k:{\"mountPath\":\"/var/lib/rabbitmq/mnesia/\"}":{".":{},"f:mountPath":{},"f:name":{}}}}},"f:restartPolicy":{},"f:schedulerName":{},"f:securityContext":{".":{},"f:fsGroup":{},"f:runAsGroup":{},"f:runAsUser":{}},"f:serviceAccount":{},"f:serviceAccountName":{},"f:terminationGracePeriodSeconds":{},"f:topologySpreadConstraints":{".":{},"k:{\"topologyKey\":\"topology.kubernetes.io/zone\",\"whenUnsatisfiable\":\"ScheduleAnyway\"}":{".":{},"f:labelSelector":{".":{},"f:matchLabels":{".":{},"f:app.kubernetes.io/name":{}}},"f:maxSkew":{},"f:topologyKey":{},"f:whenUnsatisfiable":{}}},"f:volumes":{".":{},"k:{\"name\":\"erlang-cookie-secret\"}":{".":{},"f:name":{},"f:secret":{".":{},"f:defaultMode":{},"f:secretName":{}}},"k:{\"name\":\"plugins-conf\"}":{".":{},"f:configMap":{".":{},"f:defaultMode":{},"f:name":{}},"f:name":{}},"k:{\"name\":\"pod-info\"}":{".":{},"f:downwardAPI":{".":{},"f:defaultMode":{},"f:items":{}},"f:name":{}},"k:{\"name\":\"rabbitmq-confd\"}":{".":{},"f:name":{},"f:projected":{".":{},"f:defaultMode":{},"f:sources":{}}},"k:{\"name\":\"rabbitmq-erlang-cookie\"}":{".":{},"f:emptyDir":{},"f:name":{}},"k:{\"name\":\"rabbitmq-plugins\"}":{".":{},"f:emptyDir":{},"f:name":{}}}}},"f:updateStrategy":{"f:rollingUpdate":{".":{},"f:partition":{}},"f:type":{}},"f:volumeClaimTemplates":{}}}},{"manager":"kube-controller-manager","operation":"Update","apiVersion":"apps/v1","time":"2022-03-18T18:02:01Z","fieldsType":"FieldsV1","fieldsV1":{"f:status":{"f:collisionCount":{},"f:currentReplicas":{},"f:currentRevision":{},"f:observedGeneration":{},"f:readyReplicas":{},"f:replicas":{},"f:updateRevision":{},"f:updatedReplicas":{}}}}]},"spec":{"replicas":3,"selector":{"matchLabels":{"app.kubernetes.io/name":"rabbitmq-cluster"}},"template":{"metadata":{"creationTimestamp":null,"labels":{"app.kubernetes.io/component":"rabbitmq","app.kubernetes.io/name":"rabbitmq-cluster","app.kubernetes.io/part-of":"rabbitmq"},"annotations":{"prometheus.io/port":"15692","prometheus.io/scrape":"true"}},"spec":{"volumes":[{"name":"plugins-conf","configMap":{"name":"rabbitmq-cluster-plugins-conf","defaultMode":420}},{"name":"rabbitmq-confd","projected":{"sources":[{"secret":{"name":"rabbitmq-cluster-default-user","items":[{"key":"default_user.conf","path":"default_user.conf"}]}},{"configMap":{"name":"rabbitmq-cluster-server-conf","items":[{"key":"operatorDefaults.conf","path":"operatorDefaults.conf"},{"key":"userDefinedConfiguration.conf","path":"userDefinedConfiguration.conf"}]}}],"defaultMode":420}},{"name":"rabbitmq-erlang-cookie","emptyDir":{}},{"name":"erlang-cookie-secret","secret":{"secretName":"rabbitmq-cluster-erlang-cookie","defaultMode":420}},{"name":"rabbitmq-plugins","emptyDir":{}},{"name":"pod-info","downwardAPI":{"items":[{"path":"skipPreStopChecks","fieldRef":{"apiVersion":"v1","fieldPath":"metadata.labels['skipPreStopChecks']"}}],"defaultMode":420}}],"initContainers":[{"name":"setup-container","image":"rabbitmq:3.8.12-management","command":["sh","-c","cp /tmp/erlang-cookie-secret/.erlang.cookie /var/lib/rabbitmq/.erlang.cookie \u0026\u0026 chown 999:999 /var/lib/rabbitmq/.erlang.cookie \u0026\u0026 chmod 600 /var/lib/rabbitmq/.erlang.cookie ; cp /tmp/rabbitmq-plugins/enabled_plugins /operator/enabled_plugins \u0026\u0026 chown 999:999 /operator/enabled_plugins ; chown 999:999 /var/lib/rabbitmq/mnesia/ ; echo '[default]' \u003e /var/lib/rabbitmq/.rabbitmqadmin.conf \u0026\u0026 sed -e 's/default_user/username/' -e 's/default_pass/password/' /tmp/default_user.conf \u003e\u003e /var/lib/rabbitmq/.rabbitmqadmin.conf \u0026\u0026 chown 999:999 /var/lib/rabbitmq/.rabbitmqadmin.conf \u0026\u0026 chmod 600 /var/lib/rabbitmq/.rabbitmqadmin.conf"],"resources":{"limits":{"cpu":"100m","memory":"500Mi"},"requests":{"cpu":"100m","memory":"500Mi"}},"volumeMounts":[{"name":"plugins-conf","mountPath":"/tmp/rabbitmq-plugins/"},{"name":"rabbitmq-erlang-cookie","mountPath":"/var/lib/rabbitmq/"},{"name":"erlang-cookie-secret","mountPath":"/tmp/erlang-cookie-secret/"},{"name":"rabbitmq-plugins","mountPath":"/operator"},{"name":"persistence","mountPath":"/var/lib/rabbitmq/mnesia/"},{"name":"rabbitmq-confd","mountPath":"/tmp/default_user.conf","subPath":"default_user.conf"}],"terminationMessagePath":"/dev/termination-log","terminationMessagePolicy":"File","imagePullPolicy":"IfNotPresent","securityContext":{"capabilities":{"drop":["FSETID","KILL","SETGID","SETUID","SETPCAP","NET_BIND_SERVICE","NET_RAW","SYS_CHROOT","MKNOD","AUDIT_WRITE","SETFCAP"]},"runAsUser":0}}],"containers":[{"name":"rabbitmq","image":"rabbitmq:3.8.12-management","ports":[{"name":"epmd","containerPort":4369,"protocol":"TCP"},{"name":"amqp","containerPort":5672,"protocol":"TCP"},{"name":"management","containerPort":15672,"protocol":"TCP"},{"name":"prometheus","containerPort":15692,"protocol":"TCP"}],"env":[{"name":"MY_POD_NAME","valueFrom":{"fieldRef":{"apiVersion":"v1","fieldPath":"metadata.name"}}},{"name":"MY_POD_NAMESPACE","valueFrom":{"fieldRef":{"apiVersion":"v1","fieldPath":"metadata.namespace"}}},{"name":"RABBITMQ_ENABLED_PLUGINS_FILE","value":"/operator/enabled_plugins"},{"name":"K8S_SERVICE_NAME","value":"rabbitmq-cluster-nodes"},{"name":"RABBITMQ_USE_LONGNAME","value":"true"},{"name":"RABBITMQ_NODENAME","value":"rabbit@$(MY_POD_NAME).$(K8S_SERVICE_NAME).$(MY_POD_NAMESPACE)"},{"name":"K8S_HOSTNAME_SUFFIX","value":".$(K8S_SERVICE_NAME).$(MY_POD_NAMESPACE)"}],"resources":{"limits":{"cpu":"2","memory":"2Gi"},"requests":{"cpu":"1","memory":"2Gi"}},"volumeMounts":[{"name":"rabbitmq-erlang-cookie","mountPath":"/var/lib/rabbitmq/"},{"name":"persistence","mountPath":"/var/lib/rabbitmq/mnesia/"},{"name":"rabbitmq-plugins","mountPath":"/operator"},{"name":"rabbitmq-confd","mountPath":"/etc/rabbitmq/conf.d/10-operatorDefaults.conf","subPath":"operatorDefaults.conf"},{"name":"rabbitmq-confd","mountPath":"/etc/rabbitmq/conf.d/11-default_user.conf","subPath":"default_user.conf"},{"name":"rabbitmq-confd","mountPath":"/etc/rabbitmq/conf.d/90-userDefinedConfiguration.conf","subPath":"userDefinedConfiguration.conf"},{"name":"pod-info","mountPath":"/etc/pod-info/"}],"readinessProbe":{"tcpSocket":{"port":"amqp"},"initialDelaySeconds":10,"timeoutSeconds":5,"periodSeconds":10,"successThreshold":1,"failureThreshold":3},"lifecycle":{"preStop":{"exec":{"command":["/bin/bash","-c","if [ ! -z \"$(cat /etc/pod-info/skipPreStopChecks)\" ]; then exit 0; fi; rabbitmq-upgrade await_online_quorum_plus_one -t 604800; rabbitmq-upgrade await_online_synchronized_mirror -t 604800; rabbitmq-upgrade drain -t 604800"]}}},"terminationMessagePath":"/dev/termination-log","terminationMessagePolicy":"File","imagePullPolicy":"IfNotPresent"}],"restartPolicy":"Always","terminationGracePeriodSeconds":604800,"dnsPolicy":"ClusterFirst","serviceAccountName":"rabbitmq-cluster-server","serviceAccount":"rabbitmq-cluster-server","automountServiceAccountToken":true,"securityContext":{"runAsUser":999,"runAsGroup":999,"fsGroup":999},"schedulerName":"default-scheduler","topologySpreadConstraints":[{"maxSkew":1,"topologyKey":"topology.kubernetes.io/zone","whenUnsatisfiable":"ScheduleAnyway","labelSelector":{"matchLabels":{"app.kubernetes.io/name":"rabbitmq-cluster"}}}]}},"volumeClaimTemplates":[{"metadata":{"name":"persistence","namespace":"default","creationTimestamp":null,"labels":{"app.kubernetes.io/component":"rabbitmq","app.kubernetes.io/name":"rabbitmq-cluster","app.kubernetes.io/part-of":"rabbitmq"},"ownerReferences":[{"apiVersion":"rabbitmq.com/v1beta1","kind":"RabbitmqCluster","name":"rabbitmq-cluster","uid":"18d9928b-0d1c-47be-80ec-20960d053827","controller":true,"blockOwnerDeletion":false}]},"spec":{"accessModes":["ReadWriteOnce"],"resources":{"requests":{"storage":"10Gi"}},"volumeMode":"Filesystem"},"status":{"phase":"Pending"}}],"serviceName":"rabbitmq-cluster-nodes","podManagementPolicy":"Parallel","updateStrategy":{"type":"RollingUpdate","rollingUpdate":{"partition":0}},"revisionHistoryLimit":10},"status":{"observedGeneration":2,"replicas":3,"readyReplicas":3,"currentReplicas":3,"updatedReplicas":3,"currentRevision":"rabbitmq-cluster-server-5f8b8665fb","updateRevision":"rabbitmq-cluster-server-5f8b8665fb","collisionCount":0}}
2022/03/18 18:02:08 learn_server.go:291: [SIEVE-AFTER-READ]	Get	true	endpoints	default	rabbitmq-cluster	github.com/rabbitmq/cluster-operator/controllers.(*RabbitmqClusterReconciler)	NoError	{"kind":"Endpoints","apiVersion":"v1","metadata":{"name":"rabbitmq-cluster","namespace":"default","selfLink":"/api/v1/namespaces/default/endpoints/rabbitmq-cluster","uid":"5c4723ad-f4fe-442d-9135-44879a2a8183","resourceVersion":"1227","creationTimestamp":"2022-03-18T18:00:38Z","labels":{"app.kubernetes.io/component":"rabbitmq","app.kubernetes.io/name":"rabbitmq-cluster","app.kubernetes.io/part-of":"rabbitmq"},"annotations":{"endpoints.kubernetes.io/last-change-trigger-time":"2022-03-18T18:02:01Z"},"managedFields":[{"manager":"kube-controller-manager","operation":"Update","apiVersion":"v1","time":"2022-03-18T18:02:01Z","fieldsType":"FieldsV1","fieldsV1":{"f:metadata":{"f:annotations":{".":{},"f:endpoints.kubernetes.io/last-change-trigger-time":{}},"f:labels":{".":{},"f:app.kubernetes.io/component":{},"f:app.kubernetes.io/name":{},"f:app.kubernetes.io/part-of":{}}},"f:subsets":{}}}]},"subsets":[{"addresses":[{"ip":"10.244.1.4","nodeName":"kind-worker2","targetRef":{"kind":"Pod","namespace":"default","name":"rabbitmq-cluster-server-0","uid":"e7faffc5-b656-4e69-9777-92d12cb6ec5a","resourceVersion":"938"}},{"ip":"10.244.2.4","nodeName":"kind-worker","targetRef":{"kind":"Pod","namespace":"default","name":"rabbitmq-cluster-server-1","uid":"7a37da00-25d1-48b6-a659-4390fb7a02cb","resourceVersion":"1226"}},{"ip":"10.244.2.5","nodeName":"kind-worker","targetRef":{"kind":"Pod","namespace":"default","name":"rabbitmq-cluster-server-2","uid":"2a54a659-a979-4e10-8e74-1e0b83d532ba","resourceVersion":"1209"}}],"ports":[{"name":"amqp","port":5672,"protocol":"TCP"},{"name":"management","port":15672,"protocol":"TCP"}]}]}
2022/03/18 18:02:08 learn_server.go:291: [SIEVE-AFTER-READ]	Get	true	statefulset	default	rabbitmq-cluster-server	github.com/rabbitmq/cluster-operator/controllers.(*RabbitmqClusterReconciler)	NoError	{"kind":"StatefulSet","apiVersion":"apps/v1","metadata":{"name":"rabbitmq-cluster-server","namespace":"default","selfLink":"/apis/apps/v1/namespaces/default/statefulsets/rabbitmq-cluster-server","uid":"cb5c43bc-6ee7-481c-ab01-6f3acffdd3c8","resourceVersion":"1231","generation":2,"creationTimestamp":"2022-03-18T18:00:38Z","labels":{"app.kubernetes.io/component":"rabbitmq","app.kubernetes.io/name":"rabbitmq-cluster","app.kubernetes.io/part-of":"rabbitmq"},"ownerReferences":[{"apiVersion":"rabbitmq.com/v1beta1","kind":"RabbitmqCluster","name":"rabbitmq-cluster","uid":"18d9928b-0d1c-47be-80ec-20960d053827","controller":true,"blockOwnerDeletion":true}],"managedFields":[{"manager":"manager","operation":"Update","apiVersion":"apps/v1","time":"2022-03-18T18:01:23Z","fieldsType":"FieldsV1","fieldsV1":{"f:metadata":{"f:labels":{".":{},"f:app.kubernetes.io/component":{},"f:app.kubernetes.io/name":{},"f:app.kubernetes.io/part-of":{}},"f:ownerReferences":{".":{},"k:{\"uid\":\"18d9928b-0d1c-47be-80ec-20960d053827\"}":{".":{},"f:apiVersion":{},"f:blockOwnerDeletion":{},"f:controller":{},"f:kind":{},"f:name":{},"f:uid":{}}}},"f:spec":{"f:podManagementPolicy":{},"f:replicas":{},"f:revisionHistoryLimit":{},"f:selector":{"f:matchLabels":{".":{},"f:app.kubernetes.io/name":{}}},"f:serviceName":{},"f:template":{"f:metadata":{"f:annotations":{".":{},"f:prometheus.io/port":{},"f:prometheus.io/scrape":{}},"f:labels":{".":{},"f:app.kubernetes.io/component":{},"f:app.kubernetes.io/name":{},"f:app.kubernetes.io/part-of":{}}},"f:spec":{"f:automountServiceAccountToken":{},"f:containers":{"k:{\"name\":\"rabbitmq\"}":{".":{},"f:env":{".":{},"k:{\"name\":\"K8S_HOSTNAME_SUFFIX\"}":{".":{},"f:name":{},"f:value":{}},"k:{\"name\":\"K8S_SERVICE_NAME\"}":{".":{},"f:name":{},"f:value":{}},"k:{\"name\":\"MY_POD_NAME\"}":{".":{},"f:name":{},"f:valueFrom":{".":{},"f:fieldRef":{".":{},"f:apiVersion":{},"f:fieldPath":{}}}},"k:{\"name\":\"MY_POD_NAMESPACE\"}":{".":{},"f:name":{},"f:valueFrom":{".":{},"f:fieldRef":{".":{},"f:apiVersion":{},"f:fieldPath":{}}}},"k:{\"name\":\"RABBITMQ_ENABLED_PLUGINS_FILE\"}":{".":{},"f:name":{},"f:value":{}},"k:{\"name\":\"RABBITMQ_NODENAME\"}":{".":{},"f:name":{},"f:value":{}},"k:{\"name\":\"RABBITMQ_USE_LONGNAME\"}":{".":{},"f:name":{},"f:value":{}}},"f:image":{},"f:imagePullPolicy":{},"f:lifecycle":{".":{},"f:preStop":{".":{},"f:exec":{".":{},"f:command":{}}}},"f:name":{},"f:ports":{".":{},"k:{\"containerPort\":4369,\"protocol\":\"TCP\"}":{".":{},"f:containerPort":{},"f:name":{},"f:protocol":{}},"k:{\"containerPort\":5672,\"protocol\":\"TCP\"}":{".":{},"f:containerPort":{},"f:name":{},"f:protocol":{}},"k:{\"containerPort\":15672,\"protocol\":\"TCP\"}":{".":{},"f:containerPort":{},"f:name":{},"f:protocol":{}},"k:{\"containerPort\":15692,\"protocol\":\"TCP\"}":{".":{},"f:containerPort":{},"f:name":{},"f:protocol":{}}},"f:readinessProbe":{".":{},"f:failureThreshold":{},"f:initialDelaySeconds":{},"f:periodSeconds":{},"f:successThreshold":{},"f:tcpSocket":{".":{},"f:port":{}},"f:timeoutSeconds":{}},"f:resources":{".":{},"f:limits":{".":{},"f:cpu":{},"f:memory":{}},"f:requests":{".":{},"f:cpu":{},"f:memory":{}}},"f:terminationMessagePath":{},"f:terminationMessagePolicy":{},"f:volumeMounts":{".":{},"k:{\"mountPath\":\"/etc/pod-info/\"}":{".":{},"f:mountPath":{},"f:name":{}},"k:{\"mountPath\":\"/etc/rabbitmq/conf.d/10-operatorDefaults.conf\"}":{".":{},"f:mountPath":{},"f:name":{},"f:subPath":{}},"k:{\"mountPath\":\"/etc/rabbitmq/conf.d/11-default_user.conf\"}":{".":{},"f:mountPath":{},"f:name":{},"f:subPath":{}},"k:{\"mountPath\":\"/etc/rabbitmq/conf.d/90-userDefinedConfiguration.conf\"}":{".":{},"f:mountPath":{},"f:name":{},"f:subPath":{}},"k:{\"mountPath\":\"/operator\"}":{".":{},"f:mountPath":{},"f:name":{}},"k:{\"mountPath\":\"/var/lib/rabbitmq/\"}":{".":{},"f:mountPath":{},"f:name":{}},"k:{\"mountPath\":\"/var/lib/rabbitmq/mnesia/\"}":{".":{},"f:mountPath":{},"f:name":{}}}}},"f:dnsPolicy":{},"f:initContainers":{".":{},"k:{\"name\":\"setup-container\"}":{".":{},"f:command":{},"f:image":{},"f:imagePullPolicy":{},"f:name":{},"f:resources":{".":{},"f:limits":{".":{},"f:cpu":{},"f:memory":{}},"f:requests":{".":{},"f:cpu":{},"f:memory":{}}},"f:securityContext":{".":{},"f:capabilities":{".":{},"f:drop":{}},"f:runAsUser":{}},"f:terminationMessagePath":{},"f:terminationMessagePolicy":{},"f:volumeMounts":{".":{},"k:{\"mountPath\":\"/operator\"}":{".":{},"f:mountPath":{},"f:name":{}},"k:{\"mountPath\":\"/tmp/default_user.conf\"}":{".":{},"f:mountPath":{},"f:name":{},"f:subPath":{}},"k:{\"mountPath\":\"/tmp/erlang-cookie-secret/\"}":{".":{},"f:mountPath":{},"f:name":{}},"k:{\"mountPath\":\"/tmp/rabbitmq-plugins/\"}":{".":{},"f:mountPath":{},"f:name":{}},"k:{\"mountPath\":\"/var/lib/rabbitmq/\"}":{".":{},"f:mountPath":{},"f:name":{}},"k:{\"mountPath\":\"/var/lib/rabbitmq/mnesia/\"}":{".":{},"f:mountPath":{},"f:name":{}}}}},"f:restartPolicy":{},"f:schedulerName":{},"f:securityContext":{".":{},"f:fsGroup":{},"f:runAsGroup":{},"f:runAsUser":{}},"f:serviceAccount":{},"f:serviceAccountName":{},"f:terminationGracePeriodSeconds":{},"f:topologySpreadConstraints":{".":{},"k:{\"topologyKey\":\"topology.kubernetes.io/zone\",\"whenUnsatisfiable\":\"ScheduleAnyway\"}":{".":{},"f:labelSelector":{".":{},"f:matchLabels":{".":{},"f:app.kubernetes.io/name":{}}},"f:maxSkew":{},"f:topologyKey":{},"f:whenUnsatisfiable":{}}},"f:volumes":{".":{},"k:{\"name\":\"erlang-cookie-secret\"}":{".":{},"f:name":{},"f:secret":{".":{},"f:defaultMode":{},"f:secretName":{}}},"k:{\"name\":\"plugins-conf\"}":{".":{},"f:configMap":{".":{},"f:defaultMode":{},"f:name":{}},"f:name":{}},"k:{\"name\":\"pod-info\"}":{".":{},"f:downwardAPI":{".":{},"f:defaultMode":{},"f:items":{}},"f:name":{}},"k:{\"name\":\"rabbitmq-confd\"}":{".":{},"f:name":{},"f:projected":{".":{},"f:defaultMode":{},"f:sources":{}}},"k:{\"name\":\"rabbitmq-erlang-cookie\"}":{".":{},"f:emptyDir":{},"f:name":{}},"k:{\"name\":\"rabbitmq-plugins\"}":{".":{},"f:emptyDir":{},"f:name":{}}}}},"f:updateStrategy":{"f:rollingUpdate":{".":{},"f:partition":{}},"f:type":{}},"f:volumeClaimTemplates":{}}}},{"manager":"kube-controller-manager","operation":"Update","apiVersion":"apps/v1","time":"2022-03-18T18:02:01Z","fieldsType":"FieldsV1","fieldsV1":{"f:status":{"f:collisionCount":{},"f:currentReplicas":{},"f:currentRevision":{},"f:observedGeneration":{},"f:readyReplicas":{},"f:replicas":{},"f:updateRevision":{},"f:updatedReplicas":{}}}}]},"spec":{"replicas":3,"selector":{"matchLabels":{"app.kubernetes.io/name":"rabbitmq-cluster"}},"template":{"metadata":{"creationTimestamp":null,"labels":{"app.kubernetes.io/component":"rabbitmq","app.kubernetes.io/name":"rabbitmq-cluster","app.kubernetes.io/part-of":"rabbitmq"},"annotations":{"prometheus.io/port":"15692","prometheus.io/scrape":"true"}},"spec":{"volumes":[{"name":"plugins-conf","configMap":{"name":"rabbitmq-cluster-plugins-conf","defaultMode":420}},{"name":"rabbitmq-confd","projected":{"sources":[{"secret":{"name":"rabbitmq-cluster-default-user","items":[{"key":"default_user.conf","path":"default_user.conf"}]}},{"configMap":{"name":"rabbitmq-cluster-server-conf","items":[{"key":"operatorDefaults.conf","path":"operatorDefaults.conf"},{"key":"userDefinedConfiguration.conf","path":"userDefinedConfiguration.conf"}]}}],"defaultMode":420}},{"name":"rabbitmq-erlang-cookie","emptyDir":{}},{"name":"erlang-cookie-secret","secret":{"secretName":"rabbitmq-cluster-erlang-cookie","defaultMode":420}},{"name":"rabbitmq-plugins","emptyDir":{}},{"name":"pod-info","downwardAPI":{"items":[{"path":"skipPreStopChecks","fieldRef":{"apiVersion":"v1","fieldPath":"metadata.labels['skipPreStopChecks']"}}],"defaultMode":420}}],"initContainers":[{"name":"setup-container","image":"rabbitmq:3.8.12-management","command":["sh","-c","cp /tmp/erlang-cookie-secret/.erlang.cookie /var/lib/rabbitmq/.erlang.cookie \u0026\u0026 chown 999:999 /var/lib/rabbitmq/.erlang.cookie \u0026\u0026 chmod 600 /var/lib/rabbitmq/.erlang.cookie ; cp /tmp/rabbitmq-plugins/enabled_plugins /operator/enabled_plugins \u0026\u0026 chown 999:999 /operator/enabled_plugins ; chown 999:999 /var/lib/rabbitmq/mnesia/ ; echo '[default]' \u003e /var/lib/rabbitmq/.rabbitmqadmin.conf \u0026\u0026 sed -e 's/default_user/username/' -e 's/default_pass/password/' /tmp/default_user.conf \u003e\u003e /var/lib/rabbitmq/.rabbitmqadmin.conf \u0026\u0026 chown 999:999 /var/lib/rabbitmq/.rabbitmqadmin.conf \u0026\u0026 chmod 600 /var/lib/rabbitmq/.rabbitmqadmin.conf"],"resources":{"limits":{"cpu":"100m","memory":"500Mi"},"requests":{"cpu":"100m","memory":"500Mi"}},"volumeMounts":[{"name":"plugins-conf","mountPath":"/tmp/rabbitmq-plugins/"},{"name":"rabbitmq-erlang-cookie","mountPath":"/var/lib/rabbitmq/"},{"name":"erlang-cookie-secret","mountPath":"/tmp/erlang-cookie-secret/"},{"name":"rabbitmq-plugins","mountPath":"/operator"},{"name":"persistence","mountPath":"/var/lib/rabbitmq/mnesia/"},{"name":"rabbitmq-confd","mountPath":"/tmp/default_user.conf","subPath":"default_user.conf"}],"terminationMessagePath":"/dev/termination-log","terminationMessagePolicy":"File","imagePullPolicy":"IfNotPresent","securityContext":{"capabilities":{"drop":["FSETID","KILL","SETGID","SETUID","SETPCAP","NET_BIND_SERVICE","NET_RAW","SYS_CHROOT","MKNOD","AUDIT_WRITE","SETFCAP"]},"runAsUser":0}}],"containers":[{"name":"rabbitmq","image":"rabbitmq:3.8.12-management","ports":[{"name":"epmd","containerPort":4369,"protocol":"TCP"},{"name":"amqp","containerPort":5672,"protocol":"TCP"},{"name":"management","containerPort":15672,"protocol":"TCP"},{"name":"prometheus","containerPort":15692,"protocol":"TCP"}],"env":[{"name":"MY_POD_NAME","valueFrom":{"fieldRef":{"apiVersion":"v1","fieldPath":"metadata.name"}}},{"name":"MY_POD_NAMESPACE","valueFrom":{"fieldRef":{"apiVersion":"v1","fieldPath":"metadata.namespace"}}},{"name":"RABBITMQ_ENABLED_PLUGINS_FILE","value":"/operator/enabled_plugins"},{"name":"K8S_SERVICE_NAME","value":"rabbitmq-cluster-nodes"},{"name":"RABBITMQ_USE_LONGNAME","value":"true"},{"name":"RABBITMQ_NODENAME","value":"rabbit@$(MY_POD_NAME).$(K8S_SERVICE_NAME).$(MY_POD_NAMESPACE)"},{"name":"K8S_HOSTNAME_SUFFIX","value":".$(K8S_SERVICE_NAME).$(MY_POD_NAMESPACE)"}],"resources":{"limits":{"cpu":"2","memory":"2Gi"},"requests":{"cpu":"1","memory":"2Gi"}},"volumeMounts":[{"name":"rabbitmq-erlang-cookie","mountPath":"/var/lib/rabbitmq/"},{"name":"persistence","mountPath":"/var/lib/rabbitmq/mnesia/"},{"name":"rabbitmq-plugins","mountPath":"/operator"},{"name":"rabbitmq-confd","mountPath":"/etc/rabbitmq/conf.d/10-operatorDefaults.conf","subPath":"operatorDefaults.conf"},{"name":"rabbitmq-confd","mountPath":"/etc/rabbitmq/conf.d/11-default_user.conf","subPath":"default_user.conf"},{"name":"rabbitmq-confd","mountPath":"/etc/rabbitmq/conf.d/90-userDefinedConfiguration.conf","subPath":"userDefinedConfiguration.conf"},{"name":"pod-info","mountPath":"/etc/pod-info/"}],"readinessProbe":{"tcpSocket":{"port":"amqp"},"initialDelaySeconds":10,"timeoutSeconds":5,"periodSeconds":10,"successThreshold":1,"failureThreshold":3},"lifecycle":{"preStop":{"exec":{"command":["/bin/bash","-c","if [ ! -z \"$(cat /etc/pod-info/skipPreStopChecks)\" ]; then exit 0; fi; rabbitmq-upgrade await_online_quorum_plus_one -t 604800; rabbitmq-upgrade await_online_synchronized_mirror -t 604800; rabbitmq-upgrade drain -t 604800"]}}},"terminationMessagePath":"/dev/termination-log","terminationMessagePolicy":"File","imagePullPolicy":"IfNotPresent"}],"restartPolicy":"Always","terminationGracePeriodSeconds":604800,"dnsPolicy":"ClusterFirst","serviceAccountName":"rabbitmq-cluster-server","serviceAccount":"rabbitmq-cluster-server","automountServiceAccountToken":true,"securityContext":{"runAsUser":999,"runAsGroup":999,"fsGroup":999},"schedulerName":"default-scheduler","topologySpreadConstraints":[{"maxSkew":1,"topologyKey":"topology.kubernetes.io/zone","whenUnsatisfiable":"ScheduleAnyway","labelSelector":{"matchLabels":{"app.kubernetes.io/name":"rabbitmq-cluster"}}}]}},"volumeClaimTemplates":[{"metadata":{"name":"persistence","namespace":"default","creationTimestamp":null,"labels":{"app.kubernetes.io/component":"rabbitmq","app.kubernetes.io/name":"rabbitmq-cluster","app.kubernetes.io/part-of":"rabbitmq"},"ownerReferences":[{"apiVersion":"rabbitmq.com/v1beta1","kind":"RabbitmqCluster","name":"rabbitmq-cluster","uid":"18d9928b-0d1c-47be-80ec-20960d053827","controller":true,"blockOwnerDeletion":false}]},"spec":{"accessModes":["ReadWriteOnce"],"resources":{"requests":{"storage":"10Gi"}},"volumeMode":"Filesystem"},"status":{"phase":"Pending"}}],"serviceName":"rabbitmq-cluster-nodes","podManagementPolicy":"Parallel","updateStrategy":{"type":"RollingUpdate","rollingUpdate":{"partition":0}},"revisionHistoryLimit":10},"status":{"observedGeneration":2,"replicas":3,"readyReplicas":3,"currentReplicas":3,"updatedReplicas":3,"currentRevision":"rabbitmq-cluster-server-5f8b8665fb","updateRevision":"rabbitmq-cluster-server-5f8b8665fb","collisionCount":0}}
2022/03/18 18:02:08 learn_server.go:291: [SIEVE-AFTER-READ]	Get	true	service	default	rabbitmq-cluster-nodes	github.com/rabbitmq/cluster-operator/controllers.(*RabbitmqClusterReconciler)	NoError	{"kind":"Service","apiVersion":"v1","metadata":{"name":"rabbitmq-cluster-nodes","namespace":"default","selfLink":"/api/v1/namespaces/default/services/rabbitmq-cluster-nodes","uid":"67c7eea9-1b87-4fd7-82e6-5bfe31fd1b52","resourceVersion":"696","creationTimestamp":"2022-03-18T18:00:38Z","labels":{"app.kubernetes.io/component":"rabbitmq","app.kubernetes.io/name":"rabbitmq-cluster","app.kubernetes.io/part-of":"rabbitmq"},"ownerReferences":[{"apiVersion":"rabbitmq.com/v1beta1","kind":"RabbitmqCluster","name":"rabbitmq-cluster","uid":"18d9928b-0d1c-47be-80ec-20960d053827","controller":true,"blockOwnerDeletion":true}],"managedFields":[{"manager":"manager","operation":"Update","apiVersion":"v1","time":"2022-03-18T18:00:38Z","fieldsType":"FieldsV1","fieldsV1":{"f:metadata":{"f:labels":{".":{},"f:app.kubernetes.io/component":{},"f:app.kubernetes.io/name":{},"f:app.kubernetes.io/part-of":{}},"f:ownerReferences":{".":{},"k:{\"uid\":\"18d9928b-0d1c-47be-80ec-20960d053827\"}":{".":{},"f:apiVersion":{},"f:blockOwnerDeletion":{},"f:controller":{},"f:kind":{},"f:name":{},"f:uid":{}}}},"f:spec":{"f:clusterIP":{},"f:ports":{".":{},"k:{\"port\":4369,\"protocol\":\"TCP\"}":{".":{},"f:name":{},"f:port":{},"f:protocol":{},"f:targetPort":{}},"k:{\"port\":25672,\"protocol\":\"TCP\"}":{".":{},"f:name":{},"f:port":{},"f:protocol":{},"f:targetPort":{}}},"f:publishNotReadyAddresses":{},"f:selector":{".":{},"f:app.kubernetes.io/name":{}},"f:sessionAffinity":{},"f:type":{}}}}]},"spec":{"ports":[{"name":"epmd","protocol":"TCP","port":4369,"targetPort":4369},{"name":"cluster-rpc","protocol":"TCP","port":25672,"targetPort":25672}],"selector":{"app.kubernetes.io/name":"rabbitmq-cluster"},"clusterIP":"None","type":"ClusterIP","sessionAffinity":"None","publishNotReadyAddresses":true},"status":{"loadBalancer":{}}}
2022/03/18 18:02:08 learn_server.go:291: [SIEVE-AFTER-READ]	Get	true	service	default	rabbitmq-cluster	github.com/rabbitmq/cluster-operator/controllers.(*RabbitmqClusterReconciler)	NoError	{"kind":"Service","apiVersion":"v1","metadata":{"name":"rabbitmq-cluster","namespace":"default","selfLink":"/api/v1/namespaces/default/services/rabbitmq-cluster","uid":"56b50671-1945-458b-adac-05619b783392","resourceVersion":"701","creationTimestamp":"2022-03-18T18:00:38Z","labels":{"app.kubernetes.io/component":"rabbitmq","app.kubernetes.io/name":"rabbitmq-cluster","app.kubernetes.io/part-of":"rabbitmq"},"ownerReferences":[{"apiVersion":"rabbitmq.com/v1beta1","kind":"RabbitmqCluster","name":"rabbitmq-cluster","uid":"18d9928b-0d1c-47be-80ec-20960d053827","controller":true,"blockOwnerDeletion":true}],"managedFields":[{"manager":"manager","operation":"Update","apiVersion":"v1","time":"2022-03-18T18:00:38Z","fieldsType":"FieldsV1","fieldsV1":{"f:metadata":{"f:labels":{".":{},"f:app.kubernetes.io/component":{},"f:app.kubernetes.io/name":{},"f:app.kubernetes.io/part-of":{}},"f:ownerReferences":{".":{},"k:{\"uid\":\"18d9928b-0d1c-47be-80ec-20960d053827\"}":{".":{},"f:apiVersion":{},"f:blockOwnerDeletion":{},"f:controller":{},"f:kind":{},"f:name":{},"f:uid":{}}}},"f:spec":{"f:ports":{".":{},"k:{\"port\":5672,\"protocol\":\"TCP\"}":{".":{},"f:name":{},"f:port":{},"f:protocol":{},"f:targetPort":{}},"k:{\"port\":15672,\"protocol\":\"TCP\"}":{".":{},"f:name":{},"f:port":{},"f:protocol":{},"f:targetPort":{}}},"f:selector":{".":{},"f:app.kubernetes.io/name":{}},"f:sessionAffinity":{},"f:type":{}}}}]},"spec":{"ports":[{"name":"amqp","protocol":"TCP","port":5672,"targetPort":5672},{"name":"management","protocol":"TCP","port":15672,"targetPort":15672}],"selector":{"app.kubernetes.io/name":"rabbitmq-cluster"},"clusterIP":"10.96.254.158","type":"ClusterIP","sessionAffinity":"None"},"status":{"loadBalancer":{}}}
2022/03/18 18:02:08 learn_server.go:291: [SIEVE-AFTER-READ]	Get	true	secret	default	rabbitmq-cluster-erlang-cookie	github.com/rabbitmq/cluster-operator/controllers.(*RabbitmqClusterReconciler)	NoError	{"kind":"Secret","apiVersion":"v1","metadata":{"name":"rabbitmq-cluster-erlang-cookie","namespace":"default","selfLink":"/api/v1/namespaces/default/secrets/rabbitmq-cluster-erlang-cookie","uid":"f8fbe8a6-0f40-4e13-960b-ab78b8ba75b0","resourceVersion":"705","creationTimestamp":"2022-03-18T18:00:38Z","labels":{"app.kubernetes.io/component":"rabbitmq","app.kubernetes.io/name":"rabbitmq-cluster","app.kubernetes.io/part-of":"rabbitmq"},"ownerReferences":[{"apiVersion":"rabbitmq.com/v1beta1","kind":"RabbitmqCluster","name":"rabbitmq-cluster","uid":"18d9928b-0d1c-47be-80ec-20960d053827","controller":true,"blockOwnerDeletion":true}],"managedFields":[{"manager":"manager","operation":"Update","apiVersion":"v1","time":"2022-03-18T18:00:38Z","fieldsType":"FieldsV1","fieldsV1":{"f:data":{".":{},"f:.erlang.cookie":{}},"f:metadata":{"f:labels":{".":{},"f:app.kubernetes.io/component":{},"f:app.kubernetes.io/name":{},"f:app.kubernetes.io/part-of":{}},"f:ownerReferences":{".":{},"k:{\"uid\":\"18d9928b-0d1c-47be-80ec-20960d053827\"}":{".":{},"f:apiVersion":{},"f:blockOwnerDeletion":{},"f:controller":{},"f:kind":{},"f:name":{},"f:uid":{}}}},"f:type":{}}}]},"data":{".erlang.cookie":"QW9hMkpWU0tlYS1FUGdWTUhrelNMNnFoMFZ0ZmRGNUY="},"type":"Opaque"}
2022/03/18 18:02:08 learn_server.go:291: [SIEVE-AFTER-READ]	Get	true	secret	default	rabbitmq-cluster-default-user	github.com/rabbitmq/cluster-operator/controllers.(*RabbitmqClusterReconciler)	NoError	{"kind":"Secret","apiVersion":"v1","metadata":{"name":"rabbitmq-cluster-default-user","namespace":"default","selfLink":"/api/v1/namespaces/default/secrets/rabbitmq-cluster-default-user","uid":"0d9f460b-a23c-402b-8273-f541ed39023f","resourceVersion":"708","creationTimestamp":"2022-03-18T18:00:38Z","labels":{"app.kubernetes.io/component":"rabbitmq","app.kubernetes.io/name":"rabbitmq-cluster","app.kubernetes.io/part-of":"rabbitmq"},"ownerReferences":[{"apiVersion":"rabbitmq.com/v1beta1","kind":"RabbitmqCluster","name":"rabbitmq-cluster","uid":"18d9928b-0d1c-47be-80ec-20960d053827","controller":true,"blockOwnerDeletion":true}],"managedFields":[{"manager":"manager","operation":"Update","apiVersion":"v1","time":"2022-03-18T18:00:38Z","fieldsType":"FieldsV1","fieldsV1":{"f:data":{".":{},"f:default_user.conf":{},"f:password":{},"f:provider":{},"f:type":{},"f:username":{}},"f:metadata":{"f:labels":{".":{},"f:app.kubernetes.io/component":{},"f:app.kubernetes.io/name":{},"f:app.kubernetes.io/part-of":{}},"f:ownerReferences":{".":{},"k:{\"uid\":\"18d9928b-0d1c-47be-80ec-20960d053827\"}":{".":{},"f:apiVersion":{},"f:blockOwnerDeletion":{},"f:controller":{},"f:kind":{},"f:name":{},"f:uid":{}}}},"f:type":{}}}]},"data":{"default_user.conf":"ZGVmYXVsdF91c2VyID0gcTMxRmh3MGtjWW9SZUl5X3BPTXp2ZVBOUnNVU3I1Mk8KZGVmYXVsdF9wYXNzID0gY0dBX19jNTJHX05hVURpTGhraWZ6UDBOVVlNLTE2MWQK","password":"Y0dBX19jNTJHX05hVURpTGhraWZ6UDBOVVlNLTE2MWQ=","provider":"cmFiYml0bXE=","type":"cmFiYml0bXE=","username":"cTMxRmh3MGtjWW9SZUl5X3BPTXp2ZVBOUnNVU3I1Mk8="},"type":"Opaque"}
2022/03/18 18:02:08 learn_server.go:291: [SIEVE-AFTER-READ]	Get	true	configmap	default	rabbitmq-cluster-plugins-conf	github.com/rabbitmq/cluster-operator/controllers.(*RabbitmqClusterReconciler)	NoError	{"kind":"ConfigMap","apiVersion":"v1","metadata":{"name":"rabbitmq-cluster-plugins-conf","namespace":"default","selfLink":"/api/v1/namespaces/default/configmaps/rabbitmq-cluster-plugins-conf","uid":"a164075b-0562-47ac-a577-99aa8651ec40","resourceVersion":"709","creationTimestamp":"2022-03-18T18:00:38Z","labels":{"app.kubernetes.io/component":"rabbitmq","app.kubernetes.io/name":"rabbitmq-cluster","app.kubernetes.io/part-of":"rabbitmq"},"ownerReferences":[{"apiVersion":"rabbitmq.com/v1beta1","kind":"RabbitmqCluster","name":"rabbitmq-cluster","uid":"18d9928b-0d1c-47be-80ec-20960d053827","controller":true,"blockOwnerDeletion":true}],"managedFields":[{"manager":"manager","operation":"Update","apiVersion":"v1","time":"2022-03-18T18:00:38Z","fieldsType":"FieldsV1","fieldsV1":{"f:data":{".":{},"f:enabled_plugins":{}},"f:metadata":{"f:labels":{".":{},"f:app.kubernetes.io/component":{},"f:app.kubernetes.io/name":{},"f:app.kubernetes.io/part-of":{}},"f:ownerReferences":{".":{},"k:{\"uid\":\"18d9928b-0d1c-47be-80ec-20960d053827\"}":{".":{},"f:apiVersion":{},"f:blockOwnerDeletion":{},"f:controller":{},"f:kind":{},"f:name":{},"f:uid":{}}}}}}]},"data":{"enabled_plugins":"[rabbitmq_peer_discovery_k8s,rabbitmq_prometheus,rabbitmq_management]."}}
2022/03/18 18:02:08 learn_server.go:291: [SIEVE-AFTER-READ]	Get	true	configmap	default	rabbitmq-cluster-server-conf	github.com/rabbitmq/cluster-operator/controllers.(*RabbitmqClusterReconciler)	NoError	{"kind":"ConfigMap","apiVersion":"v1","metadata":{"name":"rabbitmq-cluster-server-conf","namespace":"default","selfLink":"/api/v1/namespaces/default/configmaps/rabbitmq-cluster-server-conf","uid":"22474f2b-8454-44b7-8079-8990223969cc","resourceVersion":"714","creationTimestamp":"2022-03-18T18:00:38Z","labels":{"app.kubernetes.io/component":"rabbitmq","app.kubernetes.io/name":"rabbitmq-cluster","app.kubernetes.io/part-of":"rabbitmq"},"ownerReferences":[{"apiVersion":"rabbitmq.com/v1beta1","kind":"RabbitmqCluster","name":"rabbitmq-cluster","uid":"18d9928b-0d1c-47be-80ec-20960d053827","controller":true,"blockOwnerDeletion":true}],"managedFields":[{"manager":"manager","operation":"Update","apiVersion":"v1","time":"2022-03-18T18:00:38Z","fieldsType":"FieldsV1","fieldsV1":{"f:data":{".":{},"f:operatorDefaults.conf":{},"f:userDefinedConfiguration.conf":{}},"f:metadata":{"f:labels":{".":{},"f:app.kubernetes.io/component":{},"f:app.kubernetes.io/name":{},"f:app.kubernetes.io/part-of":{}},"f:ownerReferences":{".":{},"k:{\"uid\":\"18d9928b-0d1c-47be-80ec-20960d053827\"}":{".":{},"f:apiVersion":{},"f:blockOwnerDeletion":{},"f:controller":{},"f:kind":{},"f:name":{},"f:uid":{}}}}}}]},"data":{"operatorDefaults.conf":"cluster_formation.peer_discovery_backend             = rabbit_peer_discovery_k8s\ncluster_formation.k8s.host                           = kubernetes.default\ncluster_formation.k8s.address_type                   = hostname\ncluster_partition_handling                           = pause_minority\nqueue_master_locator                                 = min-masters\ndisk_free_limit.absolute                             = 2GB\ncluster_formation.randomized_startup_delay_range.min = 5\ncluster_formation.randomized_startup_delay_range.max = 30\ncluster_name                                         = rabbitmq-cluster\n","userDefinedConfiguration.conf":"total_memory_available_override_value = 1717986919\n"}}
2022/03/18 18:02:08 learn_server.go:291: [SIEVE-AFTER-READ]	Get	true	serviceaccount	default	rabbitmq-cluster-server	github.com/rabbitmq/cluster-operator/controllers.(*RabbitmqClusterReconciler)	NoError	{"kind":"ServiceAccount","apiVersion":"v1","metadata":{"name":"rabbitmq-cluster-server","namespace":"default","selfLink":"/api/v1/namespaces/default/serviceaccounts/rabbitmq-cluster-server","uid":"731589b5-ac97-4774-bee4-008949b54734","resourceVersion":"722","creationTimestamp":"2022-03-18T18:00:38Z","labels":{"app.kubernetes.io/component":"rabbitmq","app.kubernetes.io/name":"rabbitmq-cluster","app.kubernetes.io/part-of":"rabbitmq"},"ownerReferences":[{"apiVersion":"rabbitmq.com/v1beta1","kind":"RabbitmqCluster","name":"rabbitmq-cluster","uid":"18d9928b-0d1c-47be-80ec-20960d053827","controller":true,"blockOwnerDeletion":true}],"managedFields":[{"manager":"kube-controller-manager","operation":"Update","apiVersion":"v1","time":"2022-03-18T18:00:38Z","fieldsType":"FieldsV1","fieldsV1":{"f:secrets":{".":{},"k:{\"name\":\"rabbitmq-cluster-server-token-rhzq9\"}":{".":{},"f:name":{}}}}},{"manager":"manager","operation":"Update","apiVersion":"v1","time":"2022-03-18T18:00:38Z","fieldsType":"FieldsV1","fieldsV1":{"f:metadata":{"f:labels":{".":{},"f:app.kubernetes.io/component":{},"f:app.kubernetes.io/name":{},"f:app.kubernetes.io/part-of":{}},"f:ownerReferences":{".":{},"k:{\"uid\":\"18d9928b-0d1c-47be-80ec-20960d053827\"}":{".":{},"f:apiVersion":{},"f:blockOwnerDeletion":{},"f:controller":{},"f:kind":{},"f:name":{},"f:uid":{}}}}}}]},"secrets":[{"name":"rabbitmq-cluster-server-token-rhzq9"}]}
2022/03/18 18:02:08 learn_server.go:291: [SIEVE-AFTER-READ]	Get	true	role	default	rabbitmq-cluster-peer-discovery	github.com/rabbitmq/cluster-operator/controllers.(*RabbitmqClusterReconciler)	NoError	{"kind":"Role","apiVersion":"rbac.authorization.k8s.io/v1","metadata":{"name":"rabbitmq-cluster-peer-discovery","namespace":"default","selfLink":"/apis/rbac.authorization.k8s.io/v1/namespaces/default/roles/rabbitmq-cluster-peer-discovery","uid":"52c80b50-4fdd-4089-bbfd-9756465953f2","resourceVersion":"723","creationTimestamp":"2022-03-18T18:00:38Z","labels":{"app.kubernetes.io/component":"rabbitmq","app.kubernetes.io/name":"rabbitmq-cluster","app.kubernetes.io/part-of":"rabbitmq"},"ownerReferences":[{"apiVersion":"rabbitmq.com/v1beta1","kind":"RabbitmqCluster","name":"rabbitmq-cluster","uid":"18d9928b-0d1c-47be-80ec-20960d053827","controller":true,"blockOwnerDeletion":true}],"managedFields":[{"manager":"manager","operation":"Update","apiVersion":"rbac.authorization.k8s.io/v1","time":"2022-03-18T18:00:38Z","fieldsType":"FieldsV1","fieldsV1":{"f:metadata":{"f:labels":{".":{},"f:app.kubernetes.io/component":{},"f:app.kubernetes.io/name":{},"f:app.kubernetes.io/part-of":{}},"f:ownerReferences":{".":{},"k:{\"uid\":\"18d9928b-0d1c-47be-80ec-20960d053827\"}":{".":{},"f:apiVersion":{},"f:blockOwnerDeletion":{},"f:controller":{},"f:kind":{},"f:name":{},"f:uid":{}}}},"f:rules":{}}}]},"rules":[{"verbs":["get"],"apiGroups":[""],"resources":["endpoints"]},{"verbs":["create"],"apiGroups":[""],"resources":["events"]}]}
2022/03/18 18:02:08 learn_server.go:291: [SIEVE-AFTER-READ]	Get	true	rolebinding	default	rabbitmq-cluster-server	github.com/rabbitmq/cluster-operator/controllers.(*RabbitmqClusterReconciler)	NoError	{"kind":"RoleBinding","apiVersion":"rbac.authorization.k8s.io/v1","metadata":{"name":"rabbitmq-cluster-server","namespace":"default","selfLink":"/apis/rbac.authorization.k8s.io/v1/namespaces/default/rolebindings/rabbitmq-cluster-server","uid":"495e9f7c-a20d-4515-86b0-34149a855034","resourceVersion":"725","creationTimestamp":"2022-03-18T18:00:38Z","labels":{"app.kubernetes.io/component":"rabbitmq","app.kubernetes.io/name":"rabbitmq-cluster","app.kubernetes.io/part-of":"rabbitmq"},"ownerReferences":[{"apiVersion":"rabbitmq.com/v1beta1","kind":"RabbitmqCluster","name":"rabbitmq-cluster","uid":"18d9928b-0d1c-47be-80ec-20960d053827","controller":true,"blockOwnerDeletion":true}],"managedFields":[{"manager":"manager","operation":"Update","apiVersion":"rbac.authorization.k8s.io/v1","time":"2022-03-18T18:00:38Z","fieldsType":"FieldsV1","fieldsV1":{"f:metadata":{"f:labels":{".":{},"f:app.kubernetes.io/component":{},"f:app.kubernetes.io/name":{},"f:app.kubernetes.io/part-of":{}},"f:ownerReferences":{".":{},"k:{\"uid\":\"18d9928b-0d1c-47be-80ec-20960d053827\"}":{".":{},"f:apiVersion":{},"f:blockOwnerDeletion":{},"f:controller":{},"f:kind":{},"f:name":{},"f:uid":{}}}},"f:roleRef":{"f:apiGroup":{},"f:kind":{},"f:name":{}},"f:subjects":{}}}]},"subjects":[{"kind":"ServiceAccount","name":"rabbitmq-cluster-server"}],"roleRef":{"apiGroup":"rbac.authorization.k8s.io","kind":"Role","name":"rabbitmq-cluster-peer-discovery"}}
2022/03/18 18:02:08 learn_server.go:291: [SIEVE-AFTER-READ]	Get	true	statefulset	default	rabbitmq-cluster-server	github.com/rabbitmq/cluster-operator/controllers.(*RabbitmqClusterReconciler)	NoError	{"kind":"StatefulSet","apiVersion":"apps/v1","metadata":{"name":"rabbitmq-cluster-server","namespace":"default","selfLink":"/apis/apps/v1/namespaces/default/statefulsets/rabbitmq-cluster-server","uid":"cb5c43bc-6ee7-481c-ab01-6f3acffdd3c8","resourceVersion":"1231","generation":2,"creationTimestamp":"2022-03-18T18:00:38Z","labels":{"app.kubernetes.io/component":"rabbitmq","app.kubernetes.io/name":"rabbitmq-cluster","app.kubernetes.io/part-of":"rabbitmq"},"ownerReferences":[{"apiVersion":"rabbitmq.com/v1beta1","kind":"RabbitmqCluster","name":"rabbitmq-cluster","uid":"18d9928b-0d1c-47be-80ec-20960d053827","controller":true,"blockOwnerDeletion":true}],"managedFields":[{"manager":"manager","operation":"Update","apiVersion":"apps/v1","time":"2022-03-18T18:01:23Z","fieldsType":"FieldsV1","fieldsV1":{"f:metadata":{"f:labels":{".":{},"f:app.kubernetes.io/component":{},"f:app.kubernetes.io/name":{},"f:app.kubernetes.io/part-of":{}},"f:ownerReferences":{".":{},"k:{\"uid\":\"18d9928b-0d1c-47be-80ec-20960d053827\"}":{".":{},"f:apiVersion":{},"f:blockOwnerDeletion":{},"f:controller":{},"f:kind":{},"f:name":{},"f:uid":{}}}},"f:spec":{"f:podManagementPolicy":{},"f:replicas":{},"f:revisionHistoryLimit":{},"f:selector":{"f:matchLabels":{".":{},"f:app.kubernetes.io/name":{}}},"f:serviceName":{},"f:template":{"f:metadata":{"f:annotations":{".":{},"f:prometheus.io/port":{},"f:prometheus.io/scrape":{}},"f:labels":{".":{},"f:app.kubernetes.io/component":{},"f:app.kubernetes.io/name":{},"f:app.kubernetes.io/part-of":{}}},"f:spec":{"f:automountServiceAccountToken":{},"f:containers":{"k:{\"name\":\"rabbitmq\"}":{".":{},"f:env":{".":{},"k:{\"name\":\"K8S_HOSTNAME_SUFFIX\"}":{".":{},"f:name":{},"f:value":{}},"k:{\"name\":\"K8S_SERVICE_NAME\"}":{".":{},"f:name":{},"f:value":{}},"k:{\"name\":\"MY_POD_NAME\"}":{".":{},"f:name":{},"f:valueFrom":{".":{},"f:fieldRef":{".":{},"f:apiVersion":{},"f:fieldPath":{}}}},"k:{\"name\":\"MY_POD_NAMESPACE\"}":{".":{},"f:name":{},"f:valueFrom":{".":{},"f:fieldRef":{".":{},"f:apiVersion":{},"f:fieldPath":{}}}},"k:{\"name\":\"RABBITMQ_ENABLED_PLUGINS_FILE\"}":{".":{},"f:name":{},"f:value":{}},"k:{\"name\":\"RABBITMQ_NODENAME\"}":{".":{},"f:name":{},"f:value":{}},"k:{\"name\":\"RABBITMQ_USE_LONGNAME\"}":{".":{},"f:name":{},"f:value":{}}},"f:image":{},"f:imagePullPolicy":{},"f:lifecycle":{".":{},"f:preStop":{".":{},"f:exec":{".":{},"f:command":{}}}},"f:name":{},"f:ports":{".":{},"k:{\"containerPort\":4369,\"protocol\":\"TCP\"}":{".":{},"f:containerPort":{},"f:name":{},"f:protocol":{}},"k:{\"containerPort\":5672,\"protocol\":\"TCP\"}":{".":{},"f:containerPort":{},"f:name":{},"f:protocol":{}},"k:{\"containerPort\":15672,\"protocol\":\"TCP\"}":{".":{},"f:containerPort":{},"f:name":{},"f:protocol":{}},"k:{\"containerPort\":15692,\"protocol\":\"TCP\"}":{".":{},"f:containerPort":{},"f:name":{},"f:protocol":{}}},"f:readinessProbe":{".":{},"f:failureThreshold":{},"f:initialDelaySeconds":{},"f:periodSeconds":{},"f:successThreshold":{},"f:tcpSocket":{".":{},"f:port":{}},"f:timeoutSeconds":{}},"f:resources":{".":{},"f:limits":{".":{},"f:cpu":{},"f:memory":{}},"f:requests":{".":{},"f:cpu":{},"f:memory":{}}},"f:terminationMessagePath":{},"f:terminationMessagePolicy":{},"f:volumeMounts":{".":{},"k:{\"mountPath\":\"/etc/pod-info/\"}":{".":{},"f:mountPath":{},"f:name":{}},"k:{\"mountPath\":\"/etc/rabbitmq/conf.d/10-operatorDefaults.conf\"}":{".":{},"f:mountPath":{},"f:name":{},"f:subPath":{}},"k:{\"mountPath\":\"/etc/rabbitmq/conf.d/11-default_user.conf\"}":{".":{},"f:mountPath":{},"f:name":{},"f:subPath":{}},"k:{\"mountPath\":\"/etc/rabbitmq/conf.d/90-userDefinedConfiguration.conf\"}":{".":{},"f:mountPath":{},"f:name":{},"f:subPath":{}},"k:{\"mountPath\":\"/operator\"}":{".":{},"f:mountPath":{},"f:name":{}},"k:{\"mountPath\":\"/var/lib/rabbitmq/\"}":{".":{},"f:mountPath":{},"f:name":{}},"k:{\"mountPath\":\"/var/lib/rabbitmq/mnesia/\"}":{".":{},"f:mountPath":{},"f:name":{}}}}},"f:dnsPolicy":{},"f:initContainers":{".":{},"k:{\"name\":\"setup-container\"}":{".":{},"f:command":{},"f:image":{},"f:imagePullPolicy":{},"f:name":{},"f:resources":{".":{},"f:limits":{".":{},"f:cpu":{},"f:memory":{}},"f:requests":{".":{},"f:cpu":{},"f:memory":{}}},"f:securityContext":{".":{},"f:capabilities":{".":{},"f:drop":{}},"f:runAsUser":{}},"f:terminationMessagePath":{},"f:terminationMessagePolicy":{},"f:volumeMounts":{".":{},"k:{\"mountPath\":\"/operator\"}":{".":{},"f:mountPath":{},"f:name":{}},"k:{\"mountPath\":\"/tmp/default_user.conf\"}":{".":{},"f:mountPath":{},"f:name":{},"f:subPath":{}},"k:{\"mountPath\":\"/tmp/erlang-cookie-secret/\"}":{".":{},"f:mountPath":{},"f:name":{}},"k:{\"mountPath\":\"/tmp/rabbitmq-plugins/\"}":{".":{},"f:mountPath":{},"f:name":{}},"k:{\"mountPath\":\"/var/lib/rabbitmq/\"}":{".":{},"f:mountPath":{},"f:name":{}},"k:{\"mountPath\":\"/var/lib/rabbitmq/mnesia/\"}":{".":{},"f:mountPath":{},"f:name":{}}}}},"f:restartPolicy":{},"f:schedulerName":{},"f:securityContext":{".":{},"f:fsGroup":{},"f:runAsGroup":{},"f:runAsUser":{}},"f:serviceAccount":{},"f:serviceAccountName":{},"f:terminationGracePeriodSeconds":{},"f:topologySpreadConstraints":{".":{},"k:{\"topologyKey\":\"topology.kubernetes.io/zone\",\"whenUnsatisfiable\":\"ScheduleAnyway\"}":{".":{},"f:labelSelector":{".":{},"f:matchLabels":{".":{},"f:app.kubernetes.io/name":{}}},"f:maxSkew":{},"f:topologyKey":{},"f:whenUnsatisfiable":{}}},"f:volumes":{".":{},"k:{\"name\":\"erlang-cookie-secret\"}":{".":{},"f:name":{},"f:secret":{".":{},"f:defaultMode":{},"f:secretName":{}}},"k:{\"name\":\"plugins-conf\"}":{".":{},"f:configMap":{".":{},"f:defaultMode":{},"f:name":{}},"f:name":{}},"k:{\"name\":\"pod-info\"}":{".":{},"f:downwardAPI":{".":{},"f:defaultMode":{},"f:items":{}},"f:name":{}},"k:{\"name\":\"rabbitmq-confd\"}":{".":{},"f:name":{},"f:projected":{".":{},"f:defaultMode":{},"f:sources":{}}},"k:{\"name\":\"rabbitmq-erlang-cookie\"}":{".":{},"f:emptyDir":{},"f:name":{}},"k:{\"name\":\"rabbitmq-plugins\"}":{".":{},"f:emptyDir":{},"f:name":{}}}}},"f:updateStrategy":{"f:rollingUpdate":{".":{},"f:partition":{}},"f:type":{}},"f:volumeClaimTemplates":{}}}},{"manager":"kube-controller-manager","operation":"Update","apiVersion":"apps/v1","time":"2022-03-18T18:02:01Z","fieldsType":"FieldsV1","fieldsV1":{"f:status":{"f:collisionCount":{},"f:currentReplicas":{},"f:currentRevision":{},"f:observedGeneration":{},"f:readyReplicas":{},"f:replicas":{},"f:updateRevision":{},"f:updatedReplicas":{}}}}]},"spec":{"replicas":3,"selector":{"matchLabels":{"app.kubernetes.io/name":"rabbitmq-cluster"}},"template":{"metadata":{"creationTimestamp":null,"labels":{"app.kubernetes.io/component":"rabbitmq","app.kubernetes.io/name":"rabbitmq-cluster","app.kubernetes.io/part-of":"rabbitmq"},"annotations":{"prometheus.io/port":"15692","prometheus.io/scrape":"true"}},"spec":{"volumes":[{"name":"plugins-conf","configMap":{"name":"rabbitmq-cluster-plugins-conf","defaultMode":420}},{"name":"rabbitmq-confd","projected":{"sources":[{"secret":{"name":"rabbitmq-cluster-default-user","items":[{"key":"default_user.conf","path":"default_user.conf"}]}},{"configMap":{"name":"rabbitmq-cluster-server-conf","items":[{"key":"operatorDefaults.conf","path":"operatorDefaults.conf"},{"key":"userDefinedConfiguration.conf","path":"userDefinedConfiguration.conf"}]}}],"defaultMode":420}},{"name":"rabbitmq-erlang-cookie","emptyDir":{}},{"name":"erlang-cookie-secret","secret":{"secretName":"rabbitmq-cluster-erlang-cookie","defaultMode":420}},{"name":"rabbitmq-plugins","emptyDir":{}},{"name":"pod-info","downwardAPI":{"items":[{"path":"skipPreStopChecks","fieldRef":{"apiVersion":"v1","fieldPath":"metadata.labels['skipPreStopChecks']"}}],"defaultMode":420}}],"initContainers":[{"name":"setup-container","image":"rabbitmq:3.8.12-management","command":["sh","-c","cp /tmp/erlang-cookie-secret/.erlang.cookie /var/lib/rabbitmq/.erlang.cookie \u0026\u0026 chown 999:999 /var/lib/rabbitmq/.erlang.cookie \u0026\u0026 chmod 600 /var/lib/rabbitmq/.erlang.cookie ; cp /tmp/rabbitmq-plugins/enabled_plugins /operator/enabled_plugins \u0026\u0026 chown 999:999 /operator/enabled_plugins ; chown 999:999 /var/lib/rabbitmq/mnesia/ ; echo '[default]' \u003e /var/lib/rabbitmq/.rabbitmqadmin.conf \u0026\u0026 sed -e 's/default_user/username/' -e 's/default_pass/password/' /tmp/default_user.conf \u003e\u003e /var/lib/rabbitmq/.rabbitmqadmin.conf \u0026\u0026 chown 999:999 /var/lib/rabbitmq/.rabbitmqadmin.conf \u0026\u0026 chmod 600 /var/lib/rabbitmq/.rabbitmqadmin.conf"],"resources":{"limits":{"cpu":"100m","memory":"500Mi"},"requests":{"cpu":"100m","memory":"500Mi"}},"volumeMounts":[{"name":"plugins-conf","mountPath":"/tmp/rabbitmq-plugins/"},{"name":"rabbitmq-erlang-cookie","mountPath":"/var/lib/rabbitmq/"},{"name":"erlang-cookie-secret","mountPath":"/tmp/erlang-cookie-secret/"},{"name":"rabbitmq-plugins","mountPath":"/operator"},{"name":"persistence","mountPath":"/var/lib/rabbitmq/mnesia/"},{"name":"rabbitmq-confd","mountPath":"/tmp/default_user.conf","subPath":"default_user.conf"}],"terminationMessagePath":"/dev/termination-log","terminationMessagePolicy":"File","imagePullPolicy":"IfNotPresent","securityContext":{"capabilities":{"drop":["FSETID","KILL","SETGID","SETUID","SETPCAP","NET_BIND_SERVICE","NET_RAW","SYS_CHROOT","MKNOD","AUDIT_WRITE","SETFCAP"]},"runAsUser":0}}],"containers":[{"name":"rabbitmq","image":"rabbitmq:3.8.12-management","ports":[{"name":"epmd","containerPort":4369,"protocol":"TCP"},{"name":"amqp","containerPort":5672,"protocol":"TCP"},{"name":"management","containerPort":15672,"protocol":"TCP"},{"name":"prometheus","containerPort":15692,"protocol":"TCP"}],"env":[{"name":"MY_POD_NAME","valueFrom":{"fieldRef":{"apiVersion":"v1","fieldPath":"metadata.name"}}},{"name":"MY_POD_NAMESPACE","valueFrom":{"fieldRef":{"apiVersion":"v1","fieldPath":"metadata.namespace"}}},{"name":"RABBITMQ_ENABLED_PLUGINS_FILE","value":"/operator/enabled_plugins"},{"name":"K8S_SERVICE_NAME","value":"rabbitmq-cluster-nodes"},{"name":"RABBITMQ_USE_LONGNAME","value":"true"},{"name":"RABBITMQ_NODENAME","value":"rabbit@$(MY_POD_NAME).$(K8S_SERVICE_NAME).$(MY_POD_NAMESPACE)"},{"name":"K8S_HOSTNAME_SUFFIX","value":".$(K8S_SERVICE_NAME).$(MY_POD_NAMESPACE)"}],"resources":{"limits":{"cpu":"2","memory":"2Gi"},"requests":{"cpu":"1","memory":"2Gi"}},"volumeMounts":[{"name":"rabbitmq-erlang-cookie","mountPath":"/var/lib/rabbitmq/"},{"name":"persistence","mountPath":"/var/lib/rabbitmq/mnesia/"},{"name":"rabbitmq-plugins","mountPath":"/operator"},{"name":"rabbitmq-confd","mountPath":"/etc/rabbitmq/conf.d/10-operatorDefaults.conf","subPath":"operatorDefaults.conf"},{"name":"rabbitmq-confd","mountPath":"/etc/rabbitmq/conf.d/11-default_user.conf","subPath":"default_user.conf"},{"name":"rabbitmq-confd","mountPath":"/etc/rabbitmq/conf.d/90-userDefinedConfiguration.conf","subPath":"userDefinedConfiguration.conf"},{"name":"pod-info","mountPath":"/etc/pod-info/"}],"readinessProbe":{"tcpSocket":{"port":"amqp"},"initialDelaySeconds":10,"timeoutSeconds":5,"periodSeconds":10,"successThreshold":1,"failureThreshold":3},"lifecycle":{"preStop":{"exec":{"command":["/bin/bash","-c","if [ ! -z \"$(cat /etc/pod-info/skipPreStopChecks)\" ]; then exit 0; fi; rabbitmq-upgrade await_online_quorum_plus_one -t 604800; rabbitmq-upgrade await_online_synchronized_mirror -t 604800; rabbitmq-upgrade drain -t 604800"]}}},"terminationMessagePath":"/dev/termination-log","terminationMessagePolicy":"File","imagePullPolicy":"IfNotPresent"}],"restartPolicy":"Always","terminationGracePeriodSeconds":604800,"dnsPolicy":"ClusterFirst","serviceAccountName":"rabbitmq-cluster-server","serviceAccount":"rabbitmq-cluster-server","automountServiceAccountToken":true,"securityContext":{"runAsUser":999,"runAsGroup":999,"fsGroup":999},"schedulerName":"default-scheduler","topologySpreadConstraints":[{"maxSkew":1,"topologyKey":"topology.kubernetes.io/zone","whenUnsatisfiable":"ScheduleAnyway","labelSelector":{"matchLabels":{"app.kubernetes.io/name":"rabbitmq-cluster"}}}]}},"volumeClaimTemplates":[{"metadata":{"name":"persistence","namespace":"default","creationTimestamp":null,"labels":{"app.kubernetes.io/component":"rabbitmq","app.kubernetes.io/name":"rabbitmq-cluster","app.kubernetes.io/part-of":"rabbitmq"},"ownerReferences":[{"apiVersion":"rabbitmq.com/v1beta1","kind":"RabbitmqCluster","name":"rabbitmq-cluster","uid":"18d9928b-0d1c-47be-80ec-20960d053827","controller":true,"blockOwnerDeletion":false}]},"spec":{"accessModes":["ReadWriteOnce"],"resources":{"requests":{"storage":"10Gi"}},"volumeMode":"Filesystem"},"status":{"phase":"Pending"}}],"serviceName":"rabbitmq-cluster-nodes","podManagementPolicy":"Parallel","updateStrategy":{"type":"RollingUpdate","rollingUpdate":{"partition":0}},"revisionHistoryLimit":10},"status":{"observedGeneration":2,"replicas":3,"readyReplicas":3,"currentReplicas":3,"updatedReplicas":3,"currentRevision":"rabbitmq-cluster-server-5f8b8665fb","updateRevision":"rabbitmq-cluster-server-5f8b8665fb","collisionCount":0}}
2022/03/18 18:02:08 learn_server.go:291: [SIEVE-AFTER-READ]	Get	true	statefulset	default	rabbitmq-cluster-server	github.com/rabbitmq/cluster-operator/controllers.(*RabbitmqClusterReconciler)	NoError	{"kind":"StatefulSet","apiVersion":"apps/v1","metadata":{"name":"rabbitmq-cluster-server","namespace":"default","selfLink":"/apis/apps/v1/namespaces/default/statefulsets/rabbitmq-cluster-server","uid":"cb5c43bc-6ee7-481c-ab01-6f3acffdd3c8","resourceVersion":"1231","generation":2,"creationTimestamp":"2022-03-18T18:00:38Z","labels":{"app.kubernetes.io/component":"rabbitmq","app.kubernetes.io/name":"rabbitmq-cluster","app.kubernetes.io/part-of":"rabbitmq"},"ownerReferences":[{"apiVersion":"rabbitmq.com/v1beta1","kind":"RabbitmqCluster","name":"rabbitmq-cluster","uid":"18d9928b-0d1c-47be-80ec-20960d053827","controller":true,"blockOwnerDeletion":true}],"managedFields":[{"manager":"manager","operation":"Update","apiVersion":"apps/v1","time":"2022-03-18T18:01:23Z","fieldsType":"FieldsV1","fieldsV1":{"f:metadata":{"f:labels":{".":{},"f:app.kubernetes.io/component":{},"f:app.kubernetes.io/name":{},"f:app.kubernetes.io/part-of":{}},"f:ownerReferences":{".":{},"k:{\"uid\":\"18d9928b-0d1c-47be-80ec-20960d053827\"}":{".":{},"f:apiVersion":{},"f:blockOwnerDeletion":{},"f:controller":{},"f:kind":{},"f:name":{},"f:uid":{}}}},"f:spec":{"f:podManagementPolicy":{},"f:replicas":{},"f:revisionHistoryLimit":{},"f:selector":{"f:matchLabels":{".":{},"f:app.kubernetes.io/name":{}}},"f:serviceName":{},"f:template":{"f:metadata":{"f:annotations":{".":{},"f:prometheus.io/port":{},"f:prometheus.io/scrape":{}},"f:labels":{".":{},"f:app.kubernetes.io/component":{},"f:app.kubernetes.io/name":{},"f:app.kubernetes.io/part-of":{}}},"f:spec":{"f:automountServiceAccountToken":{},"f:containers":{"k:{\"name\":\"rabbitmq\"}":{".":{},"f:env":{".":{},"k:{\"name\":\"K8S_HOSTNAME_SUFFIX\"}":{".":{},"f:name":{},"f:value":{}},"k:{\"name\":\"K8S_SERVICE_NAME\"}":{".":{},"f:name":{},"f:value":{}},"k:{\"name\":\"MY_POD_NAME\"}":{".":{},"f:name":{},"f:valueFrom":{".":{},"f:fieldRef":{".":{},"f:apiVersion":{},"f:fieldPath":{}}}},"k:{\"name\":\"MY_POD_NAMESPACE\"}":{".":{},"f:name":{},"f:valueFrom":{".":{},"f:fieldRef":{".":{},"f:apiVersion":{},"f:fieldPath":{}}}},"k:{\"name\":\"RABBITMQ_ENABLED_PLUGINS_FILE\"}":{".":{},"f:name":{},"f:value":{}},"k:{\"name\":\"RABBITMQ_NODENAME\"}":{".":{},"f:name":{},"f:value":{}},"k:{\"name\":\"RABBITMQ_USE_LONGNAME\"}":{".":{},"f:name":{},"f:value":{}}},"f:image":{},"f:imagePullPolicy":{},"f:lifecycle":{".":{},"f:preStop":{".":{},"f:exec":{".":{},"f:command":{}}}},"f:name":{},"f:ports":{".":{},"k:{\"containerPort\":4369,\"protocol\":\"TCP\"}":{".":{},"f:containerPort":{},"f:name":{},"f:protocol":{}},"k:{\"containerPort\":5672,\"protocol\":\"TCP\"}":{".":{},"f:containerPort":{},"f:name":{},"f:protocol":{}},"k:{\"containerPort\":15672,\"protocol\":\"TCP\"}":{".":{},"f:containerPort":{},"f:name":{},"f:protocol":{}},"k:{\"containerPort\":15692,\"protocol\":\"TCP\"}":{".":{},"f:containerPort":{},"f:name":{},"f:protocol":{}}},"f:readinessProbe":{".":{},"f:failureThreshold":{},"f:initialDelaySeconds":{},"f:periodSeconds":{},"f:successThreshold":{},"f:tcpSocket":{".":{},"f:port":{}},"f:timeoutSeconds":{}},"f:resources":{".":{},"f:limits":{".":{},"f:cpu":{},"f:memory":{}},"f:requests":{".":{},"f:cpu":{},"f:memory":{}}},"f:terminationMessagePath":{},"f:terminationMessagePolicy":{},"f:volumeMounts":{".":{},"k:{\"mountPath\":\"/etc/pod-info/\"}":{".":{},"f:mountPath":{},"f:name":{}},"k:{\"mountPath\":\"/etc/rabbitmq/conf.d/10-operatorDefaults.conf\"}":{".":{},"f:mountPath":{},"f:name":{},"f:subPath":{}},"k:{\"mountPath\":\"/etc/rabbitmq/conf.d/11-default_user.conf\"}":{".":{},"f:mountPath":{},"f:name":{},"f:subPath":{}},"k:{\"mountPath\":\"/etc/rabbitmq/conf.d/90-userDefinedConfiguration.conf\"}":{".":{},"f:mountPath":{},"f:name":{},"f:subPath":{}},"k:{\"mountPath\":\"/operator\"}":{".":{},"f:mountPath":{},"f:name":{}},"k:{\"mountPath\":\"/var/lib/rabbitmq/\"}":{".":{},"f:mountPath":{},"f:name":{}},"k:{\"mountPath\":\"/var/lib/rabbitmq/mnesia/\"}":{".":{},"f:mountPath":{},"f:name":{}}}}},"f:dnsPolicy":{},"f:initContainers":{".":{},"k:{\"name\":\"setup-container\"}":{".":{},"f:command":{},"f:image":{},"f:imagePullPolicy":{},"f:name":{},"f:resources":{".":{},"f:limits":{".":{},"f:cpu":{},"f:memory":{}},"f:requests":{".":{},"f:cpu":{},"f:memory":{}}},"f:securityContext":{".":{},"f:capabilities":{".":{},"f:drop":{}},"f:runAsUser":{}},"f:terminationMessagePath":{},"f:terminationMessagePolicy":{},"f:volumeMounts":{".":{},"k:{\"mountPath\":\"/operator\"}":{".":{},"f:mountPath":{},"f:name":{}},"k:{\"mountPath\":\"/tmp/default_user.conf\"}":{".":{},"f:mountPath":{},"f:name":{},"f:subPath":{}},"k:{\"mountPath\":\"/tmp/erlang-cookie-secret/\"}":{".":{},"f:mountPath":{},"f:name":{}},"k:{\"mountPath\":\"/tmp/rabbitmq-plugins/\"}":{".":{},"f:mountPath":{},"f:name":{}},"k:{\"mountPath\":\"/var/lib/rabbitmq/\"}":{".":{},"f:mountPath":{},"f:name":{}},"k:{\"mountPath\":\"/var/lib/rabbitmq/mnesia/\"}":{".":{},"f:mountPath":{},"f:name":{}}}}},"f:restartPolicy":{},"f:schedulerName":{},"f:securityContext":{".":{},"f:fsGroup":{},"f:runAsGroup":{},"f:runAsUser":{}},"f:serviceAccount":{},"f:serviceAccountName":{},"f:terminationGracePeriodSeconds":{},"f:topologySpreadConstraints":{".":{},"k:{\"topologyKey\":\"topology.kubernetes.io/zone\",\"whenUnsatisfiable\":\"ScheduleAnyway\"}":{".":{},"f:labelSelector":{".":{},"f:matchLabels":{".":{},"f:app.kubernetes.io/name":{}}},"f:maxSkew":{},"f:topologyKey":{},"f:whenUnsatisfiable":{}}},"f:volumes":{".":{},"k:{\"name\":\"erlang-cookie-secret\"}":{".":{},"f:name":{},"f:secret":{".":{},"f:defaultMode":{},"f:secretName":{}}},"k:{\"name\":\"plugins-conf\"}":{".":{},"f:configMap":{".":{},"f:defaultMode":{},"f:name":{}},"f:name":{}},"k:{\"name\":\"pod-info\"}":{".":{},"f:downwardAPI":{".":{},"f:defaultMode":{},"f:items":{}},"f:name":{}},"k:{\"name\":\"rabbitmq-confd\"}":{".":{},"f:name":{},"f:projected":{".":{},"f:defaultMode":{},"f:sources":{}}},"k:{\"name\":\"rabbitmq-erlang-cookie\"}":{".":{},"f:emptyDir":{},"f:name":{}},"k:{\"name\":\"rabbitmq-plugins\"}":{".":{},"f:emptyDir":{},"f:name":{}}}}},"f:updateStrategy":{"f:rollingUpdate":{".":{},"f:partition":{}},"f:type":{}},"f:volumeClaimTemplates":{}}}},{"manager":"kube-controller-manager","operation":"Update","apiVersion":"apps/v1","time":"2022-03-18T18:02:01Z","fieldsType":"FieldsV1","fieldsV1":{"f:status":{"f:collisionCount":{},"f:currentReplicas":{},"f:currentRevision":{},"f:observedGeneration":{},"f:readyReplicas":{},"f:replicas":{},"f:updateRevision":{},"f:updatedReplicas":{}}}}]},"spec":{"replicas":3,"selector":{"matchLabels":{"app.kubernetes.io/name":"rabbitmq-cluster"}},"template":{"metadata":{"creationTimestamp":null,"labels":{"app.kubernetes.io/component":"rabbitmq","app.kubernetes.io/name":"rabbitmq-cluster","app.kubernetes.io/part-of":"rabbitmq"},"annotations":{"prometheus.io/port":"15692","prometheus.io/scrape":"true"}},"spec":{"volumes":[{"name":"plugins-conf","configMap":{"name":"rabbitmq-cluster-plugins-conf","defaultMode":420}},{"name":"rabbitmq-confd","projected":{"sources":[{"secret":{"name":"rabbitmq-cluster-default-user","items":[{"key":"default_user.conf","path":"default_user.conf"}]}},{"configMap":{"name":"rabbitmq-cluster-server-conf","items":[{"key":"operatorDefaults.conf","path":"operatorDefaults.conf"},{"key":"userDefinedConfiguration.conf","path":"userDefinedConfiguration.conf"}]}}],"defaultMode":420}},{"name":"rabbitmq-erlang-cookie","emptyDir":{}},{"name":"erlang-cookie-secret","secret":{"secretName":"rabbitmq-cluster-erlang-cookie","defaultMode":420}},{"name":"rabbitmq-plugins","emptyDir":{}},{"name":"pod-info","downwardAPI":{"items":[{"path":"skipPreStopChecks","fieldRef":{"apiVersion":"v1","fieldPath":"metadata.labels['skipPreStopChecks']"}}],"defaultMode":420}}],"initContainers":[{"name":"setup-container","image":"rabbitmq:3.8.12-management","command":["sh","-c","cp /tmp/erlang-cookie-secret/.erlang.cookie /var/lib/rabbitmq/.erlang.cookie \u0026\u0026 chown 999:999 /var/lib/rabbitmq/.erlang.cookie \u0026\u0026 chmod 600 /var/lib/rabbitmq/.erlang.cookie ; cp /tmp/rabbitmq-plugins/enabled_plugins /operator/enabled_plugins \u0026\u0026 chown 999:999 /operator/enabled_plugins ; chown 999:999 /var/lib/rabbitmq/mnesia/ ; echo '[default]' \u003e /var/lib/rabbitmq/.rabbitmqadmin.conf \u0026\u0026 sed -e 's/default_user/username/' -e 's/default_pass/password/' /tmp/default_user.conf \u003e\u003e /var/lib/rabbitmq/.rabbitmqadmin.conf \u0026\u0026 chown 999:999 /var/lib/rabbitmq/.rabbitmqadmin.conf \u0026\u0026 chmod 600 /var/lib/rabbitmq/.rabbitmqadmin.conf"],"resources":{"limits":{"cpu":"100m","memory":"500Mi"},"requests":{"cpu":"100m","memory":"500Mi"}},"volumeMounts":[{"name":"plugins-conf","mountPath":"/tmp/rabbitmq-plugins/"},{"name":"rabbitmq-erlang-cookie","mountPath":"/var/lib/rabbitmq/"},{"name":"erlang-cookie-secret","mountPath":"/tmp/erlang-cookie-secret/"},{"name":"rabbitmq-plugins","mountPath":"/operator"},{"name":"persistence","mountPath":"/var/lib/rabbitmq/mnesia/"},{"name":"rabbitmq-confd","mountPath":"/tmp/default_user.conf","subPath":"default_user.conf"}],"terminationMessagePath":"/dev/termination-log","terminationMessagePolicy":"File","imagePullPolicy":"IfNotPresent","securityContext":{"capabilities":{"drop":["FSETID","KILL","SETGID","SETUID","SETPCAP","NET_BIND_SERVICE","NET_RAW","SYS_CHROOT","MKNOD","AUDIT_WRITE","SETFCAP"]},"runAsUser":0}}],"containers":[{"name":"rabbitmq","image":"rabbitmq:3.8.12-management","ports":[{"name":"epmd","containerPort":4369,"protocol":"TCP"},{"name":"amqp","containerPort":5672,"protocol":"TCP"},{"name":"management","containerPort":15672,"protocol":"TCP"},{"name":"prometheus","containerPort":15692,"protocol":"TCP"}],"env":[{"name":"MY_POD_NAME","valueFrom":{"fieldRef":{"apiVersion":"v1","fieldPath":"metadata.name"}}},{"name":"MY_POD_NAMESPACE","valueFrom":{"fieldRef":{"apiVersion":"v1","fieldPath":"metadata.namespace"}}},{"name":"RABBITMQ_ENABLED_PLUGINS_FILE","value":"/operator/enabled_plugins"},{"name":"K8S_SERVICE_NAME","value":"rabbitmq-cluster-nodes"},{"name":"RABBITMQ_USE_LONGNAME","value":"true"},{"name":"RABBITMQ_NODENAME","value":"rabbit@$(MY_POD_NAME).$(K8S_SERVICE_NAME).$(MY_POD_NAMESPACE)"},{"name":"K8S_HOSTNAME_SUFFIX","value":".$(K8S_SERVICE_NAME).$(MY_POD_NAMESPACE)"}],"resources":{"limits":{"cpu":"2","memory":"2Gi"},"requests":{"cpu":"1","memory":"2Gi"}},"volumeMounts":[{"name":"rabbitmq-erlang-cookie","mountPath":"/var/lib/rabbitmq/"},{"name":"persistence","mountPath":"/var/lib/rabbitmq/mnesia/"},{"name":"rabbitmq-plugins","mountPath":"/operator"},{"name":"rabbitmq-confd","mountPath":"/etc/rabbitmq/conf.d/10-operatorDefaults.conf","subPath":"operatorDefaults.conf"},{"name":"rabbitmq-confd","mountPath":"/etc/rabbitmq/conf.d/11-default_user.conf","subPath":"default_user.conf"},{"name":"rabbitmq-confd","mountPath":"/etc/rabbitmq/conf.d/90-userDefinedConfiguration.conf","subPath":"userDefinedConfiguration.conf"},{"name":"pod-info","mountPath":"/etc/pod-info/"}],"readinessProbe":{"tcpSocket":{"port":"amqp"},"initialDelaySeconds":10,"timeoutSeconds":5,"periodSeconds":10,"successThreshold":1,"failureThreshold":3},"lifecycle":{"preStop":{"exec":{"command":["/bin/bash","-c","if [ ! -z \"$(cat /etc/pod-info/skipPreStopChecks)\" ]; then exit 0; fi; rabbitmq-upgrade await_online_quorum_plus_one -t 604800; rabbitmq-upgrade await_online_synchronized_mirror -t 604800; rabbitmq-upgrade drain -t 604800"]}}},"terminationMessagePath":"/dev/termination-log","terminationMessagePolicy":"File","imagePullPolicy":"IfNotPresent"}],"restartPolicy":"Always","terminationGracePeriodSeconds":604800,"dnsPolicy":"ClusterFirst","serviceAccountName":"rabbitmq-cluster-server","serviceAccount":"rabbitmq-cluster-server","automountServiceAccountToken":true,"securityContext":{"runAsUser":999,"runAsGroup":999,"fsGroup":999},"schedulerName":"default-scheduler","topologySpreadConstraints":[{"maxSkew":1,"topologyKey":"topology.kubernetes.io/zone","whenUnsatisfiable":"ScheduleAnyway","labelSelector":{"matchLabels":{"app.kubernetes.io/name":"rabbitmq-cluster"}}}]}},"volumeClaimTemplates":[{"metadata":{"name":"persistence","namespace":"default","creationTimestamp":null,"labels":{"app.kubernetes.io/component":"rabbitmq","app.kubernetes.io/name":"rabbitmq-cluster","app.kubernetes.io/part-of":"rabbitmq"},"ownerReferences":[{"apiVersion":"rabbitmq.com/v1beta1","kind":"RabbitmqCluster","name":"rabbitmq-cluster","uid":"18d9928b-0d1c-47be-80ec-20960d053827","controller":true,"blockOwnerDeletion":false}]},"spec":{"accessModes":["ReadWriteOnce"],"resources":{"requests":{"storage":"10Gi"}},"volumeMode":"Filesystem"},"status":{"phase":"Pending"}}],"serviceName":"rabbitmq-cluster-nodes","podManagementPolicy":"Parallel","updateStrategy":{"type":"RollingUpdate","rollingUpdate":{"partition":0}},"revisionHistoryLimit":10},"status":{"observedGeneration":2,"replicas":3,"readyReplicas":3,"currentReplicas":3,"updatedReplicas":3,"currentRevision":"rabbitmq-cluster-server-5f8b8665fb","updateRevision":"rabbitmq-cluster-server-5f8b8665fb","collisionCount":0}}
2022/03/18 18:02:08 learn_server.go:256: [SIEVE-BEFORE-WRITE]	61
2022/03/18 18:02:08 learn_server.go:263: [SIEVE-AFTER-WRITE]	61	Update	statefulset	github.com/rabbitmq/cluster-operator/controllers.(*RabbitmqClusterReconciler)	NoError	{"metadata":{"name":"rabbitmq-cluster-server","namespace":"default","selfLink":"/apis/apps/v1/namespaces/default/statefulsets/rabbitmq-cluster-server","uid":"cb5c43bc-6ee7-481c-ab01-6f3acffdd3c8","resourceVersion":"1231","generation":2,"creationTimestamp":"2022-03-18T18:00:38Z","labels":{"app.kubernetes.io/component":"rabbitmq","app.kubernetes.io/name":"rabbitmq-cluster","app.kubernetes.io/part-of":"rabbitmq"},"ownerReferences":[{"apiVersion":"rabbitmq.com/v1beta1","kind":"RabbitmqCluster","name":"rabbitmq-cluster","uid":"18d9928b-0d1c-47be-80ec-20960d053827","controller":true,"blockOwnerDeletion":true}],"managedFields":[{"manager":"manager","operation":"Update","apiVersion":"apps/v1","time":"2022-03-18T18:01:23Z","fieldsType":"FieldsV1","fieldsV1":{"f:metadata":{"f:labels":{".":{},"f:app.kubernetes.io/component":{},"f:app.kubernetes.io/name":{},"f:app.kubernetes.io/part-of":{}},"f:ownerReferences":{".":{},"k:{\"uid\":\"18d9928b-0d1c-47be-80ec-20960d053827\"}":{".":{},"f:apiVersion":{},"f:blockOwnerDeletion":{},"f:controller":{},"f:kind":{},"f:name":{},"f:uid":{}}}},"f:spec":{"f:podManagementPolicy":{},"f:replicas":{},"f:revisionHistoryLimit":{},"f:selector":{"f:matchLabels":{".":{},"f:app.kubernetes.io/name":{}}},"f:serviceName":{},"f:template":{"f:metadata":{"f:annotations":{".":{},"f:prometheus.io/port":{},"f:prometheus.io/scrape":{}},"f:labels":{".":{},"f:app.kubernetes.io/component":{},"f:app.kubernetes.io/name":{},"f:app.kubernetes.io/part-of":{}}},"f:spec":{"f:automountServiceAccountToken":{},"f:containers":{"k:{\"name\":\"rabbitmq\"}":{".":{},"f:env":{".":{},"k:{\"name\":\"K8S_HOSTNAME_SUFFIX\"}":{".":{},"f:name":{},"f:value":{}},"k:{\"name\":\"K8S_SERVICE_NAME\"}":{".":{},"f:name":{},"f:value":{}},"k:{\"name\":\"MY_POD_NAME\"}":{".":{},"f:name":{},"f:valueFrom":{".":{},"f:fieldRef":{".":{},"f:apiVersion":{},"f:fieldPath":{}}}},"k:{\"name\":\"MY_POD_NAMESPACE\"}":{".":{},"f:name":{},"f:valueFrom":{".":{},"f:fieldRef":{".":{},"f:apiVersion":{},"f:fieldPath":{}}}},"k:{\"name\":\"RABBITMQ_ENABLED_PLUGINS_FILE\"}":{".":{},"f:name":{},"f:value":{}},"k:{\"name\":\"RABBITMQ_NODENAME\"}":{".":{},"f:name":{},"f:value":{}},"k:{\"name\":\"RABBITMQ_USE_LONGNAME\"}":{".":{},"f:name":{},"f:value":{}}},"f:image":{},"f:imagePullPolicy":{},"f:lifecycle":{".":{},"f:preStop":{".":{},"f:exec":{".":{},"f:command":{}}}},"f:name":{},"f:ports":{".":{},"k:{\"containerPort\":4369,\"protocol\":\"TCP\"}":{".":{},"f:containerPort":{},"f:name":{},"f:protocol":{}},"k:{\"containerPort\":5672,\"protocol\":\"TCP\"}":{".":{},"f:containerPort":{},"f:name":{},"f:protocol":{}},"k:{\"containerPort\":15672,\"protocol\":\"TCP\"}":{".":{},"f:containerPort":{},"f:name":{},"f:protocol":{}},"k:{\"containerPort\":15692,\"protocol\":\"TCP\"}":{".":{},"f:containerPort":{},"f:name":{},"f:protocol":{}}},"f:readinessProbe":{".":{},"f:failureThreshold":{},"f:initialDelaySeconds":{},"f:periodSeconds":{},"f:successThreshold":{},"f:tcpSocket":{".":{},"f:port":{}},"f:timeoutSeconds":{}},"f:resources":{".":{},"f:limits":{".":{},"f:cpu":{},"f:memory":{}},"f:requests":{".":{},"f:cpu":{},"f:memory":{}}},"f:terminationMessagePath":{},"f:terminationMessagePolicy":{},"f:volumeMounts":{".":{},"k:{\"mountPath\":\"/etc/pod-info/\"}":{".":{},"f:mountPath":{},"f:name":{}},"k:{\"mountPath\":\"/etc/rabbitmq/conf.d/10-operatorDefaults.conf\"}":{".":{},"f:mountPath":{},"f:name":{},"f:subPath":{}},"k:{\"mountPath\":\"/etc/rabbitmq/conf.d/11-default_user.conf\"}":{".":{},"f:mountPath":{},"f:name":{},"f:subPath":{}},"k:{\"mountPath\":\"/etc/rabbitmq/conf.d/90-userDefinedConfiguration.conf\"}":{".":{},"f:mountPath":{},"f:name":{},"f:subPath":{}},"k:{\"mountPath\":\"/operator\"}":{".":{},"f:mountPath":{},"f:name":{}},"k:{\"mountPath\":\"/var/lib/rabbitmq/\"}":{".":{},"f:mountPath":{},"f:name":{}},"k:{\"mountPath\":\"/var/lib/rabbitmq/mnesia/\"}":{".":{},"f:mountPath":{},"f:name":{}}}}},"f:dnsPolicy":{},"f:initContainers":{".":{},"k:{\"name\":\"setup-container\"}":{".":{},"f:command":{},"f:image":{},"f:imagePullPolicy":{},"f:name":{},"f:resources":{".":{},"f:limits":{".":{},"f:cpu":{},"f:memory":{}},"f:requests":{".":{},"f:cpu":{},"f:memory":{}}},"f:securityContext":{".":{},"f:capabilities":{".":{},"f:drop":{}},"f:runAsUser":{}},"f:terminationMessagePath":{},"f:terminationMessagePolicy":{},"f:volumeMounts":{".":{},"k:{\"mountPath\":\"/operator\"}":{".":{},"f:mountPath":{},"f:name":{}},"k:{\"mountPath\":\"/tmp/default_user.conf\"}":{".":{},"f:mountPath":{},"f:name":{},"f:subPath":{}},"k:{\"mountPath\":\"/tmp/erlang-cookie-secret/\"}":{".":{},"f:mountPath":{},"f:name":{}},"k:{\"mountPath\":\"/tmp/rabbitmq-plugins/\"}":{".":{},"f:mountPath":{},"f:name":{}},"k:{\"mountPath\":\"/var/lib/rabbitmq/\"}":{".":{},"f:mountPath":{},"f:name":{}},"k:{\"mountPath\":\"/var/lib/rabbitmq/mnesia/\"}":{".":{},"f:mountPath":{},"f:name":{}}}}},"f:restartPolicy":{},"f:schedulerName":{},"f:securityContext":{".":{},"f:fsGroup":{},"f:runAsGroup":{},"f:runAsUser":{}},"f:serviceAccount":{},"f:serviceAccountName":{},"f:terminationGracePeriodSeconds":{},"f:topologySpreadConstraints":{".":{},"k:{\"topologyKey\":\"topology.kubernetes.io/zone\",\"whenUnsatisfiable\":\"ScheduleAnyway\"}":{".":{},"f:labelSelector":{".":{},"f:matchLabels":{".":{},"f:app.kubernetes.io/name":{}}},"f:maxSkew":{},"f:topologyKey":{},"f:whenUnsatisfiable":{}}},"f:volumes":{".":{},"k:{\"name\":\"erlang-cookie-secret\"}":{".":{},"f:name":{},"f:secret":{".":{},"f:defaultMode":{},"f:secretName":{}}},"k:{\"name\":\"plugins-conf\"}":{".":{},"f:configMap":{".":{},"f:defaultMode":{},"f:name":{}},"f:name":{}},"k:{\"name\":\"pod-info\"}":{".":{},"f:downwardAPI":{".":{},"f:defaultMode":{},"f:items":{}},"f:name":{}},"k:{\"name\":\"rabbitmq-confd\"}":{".":{},"f:name":{},"f:projected":{".":{},"f:defaultMode":{},"f:sources":{}}},"k:{\"name\":\"rabbitmq-erlang-cookie\"}":{".":{},"f:emptyDir":{},"f:name":{}},"k:{\"name\":\"rabbitmq-plugins\"}":{".":{},"f:emptyDir":{},"f:name":{}}}}},"f:updateStrategy":{"f:rollingUpdate":{".":{},"f:partition":{}},"f:type":{}},"f:volumeClaimTemplates":{}}}},{"manager":"kube-controller-manager","operation":"Update","apiVersion":"apps/v1","time":"2022-03-18T18:02:01Z","fieldsType":"FieldsV1","fieldsV1":{"f:status":{"f:collisionCount":{},"f:currentReplicas":{},"f:currentRevision":{},"f:observedGeneration":{},"f:readyReplicas":{},"f:replicas":{},"f:updateRevision":{},"f:updatedReplicas":{}}}}]},"spec":{"replicas":3,"selector":{"matchLabels":{"app.kubernetes.io/name":"rabbitmq-cluster"}},"template":{"metadata":{"creationTimestamp":null,"labels":{"app.kubernetes.io/component":"rabbitmq","app.kubernetes.io/name":"rabbitmq-cluster","app.kubernetes.io/part-of":"rabbitmq"},"annotations":{"prometheus.io/port":"15692","prometheus.io/scrape":"true"}},"spec":{"volumes":[{"name":"plugins-conf","configMap":{"name":"rabbitmq-cluster-plugins-conf","defaultMode":420}},{"name":"rabbitmq-confd","projected":{"sources":[{"secret":{"name":"rabbitmq-cluster-default-user","items":[{"key":"default_user.conf","path":"default_user.conf"}]}},{"configMap":{"name":"rabbitmq-cluster-server-conf","items":[{"key":"operatorDefaults.conf","path":"operatorDefaults.conf"},{"key":"userDefinedConfiguration.conf","path":"userDefinedConfiguration.conf"}]}}],"defaultMode":420}},{"name":"rabbitmq-erlang-cookie","emptyDir":{}},{"name":"erlang-cookie-secret","secret":{"secretName":"rabbitmq-cluster-erlang-cookie","defaultMode":420}},{"name":"rabbitmq-plugins","emptyDir":{}},{"name":"pod-info","downwardAPI":{"items":[{"path":"skipPreStopChecks","fieldRef":{"apiVersion":"v1","fieldPath":"metadata.labels['skipPreStopChecks']"}}],"defaultMode":420}}],"initContainers":[{"name":"setup-container","image":"rabbitmq:3.8.12-management","command":["sh","-c","cp /tmp/erlang-cookie-secret/.erlang.cookie /var/lib/rabbitmq/.erlang.cookie \u0026\u0026 chown 999:999 /var/lib/rabbitmq/.erlang.cookie \u0026\u0026 chmod 600 /var/lib/rabbitmq/.erlang.cookie ; cp /tmp/rabbitmq-plugins/enabled_plugins /operator/enabled_plugins \u0026\u0026 chown 999:999 /operator/enabled_plugins ; chown 999:999 /var/lib/rabbitmq/mnesia/ ; echo '[default]' \u003e /var/lib/rabbitmq/.rabbitmqadmin.conf \u0026\u0026 sed -e 's/default_user/username/' -e 's/default_pass/password/' /tmp/default_user.conf \u003e\u003e /var/lib/rabbitmq/.rabbitmqadmin.conf \u0026\u0026 chown 999:999 /var/lib/rabbitmq/.rabbitmqadmin.conf \u0026\u0026 chmod 600 /var/lib/rabbitmq/.rabbitmqadmin.conf"],"resources":{"limits":{"cpu":"100m","memory":"500Mi"},"requests":{"cpu":"100m","memory":"500Mi"}},"volumeMounts":[{"name":"plugins-conf","mountPath":"/tmp/rabbitmq-plugins/"},{"name":"rabbitmq-erlang-cookie","mountPath":"/var/lib/rabbitmq/"},{"name":"erlang-cookie-secret","mountPath":"/tmp/erlang-cookie-secret/"},{"name":"rabbitmq-plugins","mountPath":"/operator"},{"name":"persistence","mountPath":"/var/lib/rabbitmq/mnesia/"},{"name":"rabbitmq-confd","mountPath":"/tmp/default_user.conf","subPath":"default_user.conf"}],"terminationMessagePath":"/dev/termination-log","terminationMessagePolicy":"File","imagePullPolicy":"IfNotPresent","securityContext":{"capabilities":{"drop":["FSETID","KILL","SETGID","SETUID","SETPCAP","NET_BIND_SERVICE","NET_RAW","SYS_CHROOT","MKNOD","AUDIT_WRITE","SETFCAP"]},"runAsUser":0}}],"containers":[{"name":"rabbitmq","image":"rabbitmq:3.8.12-management","ports":[{"name":"epmd","containerPort":4369,"protocol":"TCP"},{"name":"amqp","containerPort":5672,"protocol":"TCP"},{"name":"management","containerPort":15672,"protocol":"TCP"},{"name":"prometheus","containerPort":15692,"protocol":"TCP"}],"env":[{"name":"MY_POD_NAME","valueFrom":{"fieldRef":{"apiVersion":"v1","fieldPath":"metadata.name"}}},{"name":"MY_POD_NAMESPACE","valueFrom":{"fieldRef":{"apiVersion":"v1","fieldPath":"metadata.namespace"}}},{"name":"RABBITMQ_ENABLED_PLUGINS_FILE","value":"/operator/enabled_plugins"},{"name":"K8S_SERVICE_NAME","value":"rabbitmq-cluster-nodes"},{"name":"RABBITMQ_USE_LONGNAME","value":"true"},{"name":"RABBITMQ_NODENAME","value":"rabbit@$(MY_POD_NAME).$(K8S_SERVICE_NAME).$(MY_POD_NAMESPACE)"},{"name":"K8S_HOSTNAME_SUFFIX","value":".$(K8S_SERVICE_NAME).$(MY_POD_NAMESPACE)"}],"resources":{"limits":{"cpu":"2","memory":"2Gi"},"requests":{"cpu":"1","memory":"2Gi"}},"volumeMounts":[{"name":"rabbitmq-erlang-cookie","mountPath":"/var/lib/rabbitmq/"},{"name":"persistence","mountPath":"/var/lib/rabbitmq/mnesia/"},{"name":"rabbitmq-plugins","mountPath":"/operator"},{"name":"rabbitmq-confd","mountPath":"/etc/rabbitmq/conf.d/10-operatorDefaults.conf","subPath":"operatorDefaults.conf"},{"name":"rabbitmq-confd","mountPath":"/etc/rabbitmq/conf.d/11-default_user.conf","subPath":"default_user.conf"},{"name":"rabbitmq-confd","mountPath":"/etc/rabbitmq/conf.d/90-userDefinedConfiguration.conf","subPath":"userDefinedConfiguration.conf"},{"name":"pod-info","mountPath":"/etc/pod-info/"}],"readinessProbe":{"tcpSocket":{"port":"amqp"},"initialDelaySeconds":10,"timeoutSeconds":5,"periodSeconds":10,"successThreshold":1,"failureThreshold":3},"lifecycle":{"preStop":{"exec":{"command":["/bin/bash","-c","if [ ! -z \"$(cat /etc/pod-info/skipPreStopChecks)\" ]; then exit 0; fi; rabbitmq-upgrade await_online_quorum_plus_one -t 604800; rabbitmq-upgrade await_online_synchronized_mirror -t 604800; rabbitmq-upgrade drain -t 604800"]}}},"terminationMessagePath":"/dev/termination-log","terminationMessagePolicy":"File","imagePullPolicy":"IfNotPresent"}],"restartPolicy":"Always","terminationGracePeriodSeconds":604800,"dnsPolicy":"ClusterFirst","serviceAccountName":"rabbitmq-cluster-server","serviceAccount":"rabbitmq-cluster-server","automountServiceAccountToken":true,"securityContext":{"runAsUser":999,"runAsGroup":999,"fsGroup":999},"schedulerName":"default-scheduler","topologySpreadConstraints":[{"maxSkew":1,"topologyKey":"topology.kubernetes.io/zone","whenUnsatisfiable":"ScheduleAnyway","labelSelector":{"matchLabels":{"app.kubernetes.io/name":"rabbitmq-cluster"}}}]}},"volumeClaimTemplates":[{"metadata":{"name":"persistence","namespace":"default","creationTimestamp":null,"labels":{"app.kubernetes.io/component":"rabbitmq","app.kubernetes.io/name":"rabbitmq-cluster","app.kubernetes.io/part-of":"rabbitmq"},"ownerReferences":[{"apiVersion":"rabbitmq.com/v1beta1","kind":"RabbitmqCluster","name":"rabbitmq-cluster","uid":"18d9928b-0d1c-47be-80ec-20960d053827","controller":true,"blockOwnerDeletion":false}]},"spec":{"accessModes":["ReadWriteOnce"],"resources":{"requests":{"storage":"10Gi"}},"volumeMode":"Filesystem"},"status":{"phase":"Pending"}}],"serviceName":"rabbitmq-cluster-nodes","podManagementPolicy":"Parallel","updateStrategy":{"type":"RollingUpdate","rollingUpdate":{"partition":0}},"revisionHistoryLimit":10},"status":{"observedGeneration":2,"replicas":3,"readyReplicas":3,"currentReplicas":3,"updatedReplicas":3,"currentRevision":"rabbitmq-cluster-server-5f8b8665fb","updateRevision":"rabbitmq-cluster-server-5f8b8665fb","collisionCount":0}}
2022/03/18 18:02:08 learn_server.go:291: [SIEVE-AFTER-READ]	Get	true	configmap	default	rabbitmq-cluster-server-conf	github.com/rabbitmq/cluster-operator/controllers.(*RabbitmqClusterReconciler)	NoError	{"kind":"ConfigMap","apiVersion":"v1","metadata":{"name":"rabbitmq-cluster-server-conf","namespace":"default","selfLink":"/api/v1/namespaces/default/configmaps/rabbitmq-cluster-server-conf","uid":"22474f2b-8454-44b7-8079-8990223969cc","resourceVersion":"714","creationTimestamp":"2022-03-18T18:00:38Z","labels":{"app.kubernetes.io/component":"rabbitmq","app.kubernetes.io/name":"rabbitmq-cluster","app.kubernetes.io/part-of":"rabbitmq"},"ownerReferences":[{"apiVersion":"rabbitmq.com/v1beta1","kind":"RabbitmqCluster","name":"rabbitmq-cluster","uid":"18d9928b-0d1c-47be-80ec-20960d053827","controller":true,"blockOwnerDeletion":true}],"managedFields":[{"manager":"manager","operation":"Update","apiVersion":"v1","time":"2022-03-18T18:00:38Z","fieldsType":"FieldsV1","fieldsV1":{"f:data":{".":{},"f:operatorDefaults.conf":{},"f:userDefinedConfiguration.conf":{}},"f:metadata":{"f:labels":{".":{},"f:app.kubernetes.io/component":{},"f:app.kubernetes.io/name":{},"f:app.kubernetes.io/part-of":{}},"f:ownerReferences":{".":{},"k:{\"uid\":\"18d9928b-0d1c-47be-80ec-20960d053827\"}":{".":{},"f:apiVersion":{},"f:blockOwnerDeletion":{},"f:controller":{},"f:kind":{},"f:name":{},"f:uid":{}}}}}}]},"data":{"operatorDefaults.conf":"cluster_formation.peer_discovery_backend             = rabbit_peer_discovery_k8s\ncluster_formation.k8s.host                           = kubernetes.default\ncluster_formation.k8s.address_type                   = hostname\ncluster_partition_handling                           = pause_minority\nqueue_master_locator                                 = min-masters\ndisk_free_limit.absolute                             = 2GB\ncluster_formation.randomized_startup_delay_range.min = 5\ncluster_formation.randomized_startup_delay_range.max = 30\ncluster_name                                         = rabbitmq-cluster\n","userDefinedConfiguration.conf":"total_memory_available_override_value = 1717986919\n"}}
2022/03/18 18:02:08 learn_server.go:256: [SIEVE-BEFORE-WRITE]	62
2022/03/18 18:02:08 learn_server.go:263: [SIEVE-AFTER-WRITE]	62	StatusUpdate	rabbitmqcluster	github.com/rabbitmq/cluster-operator/controllers.(*RabbitmqClusterReconciler)	NoError	{"metadata":{"name":"rabbitmq-cluster","namespace":"default","selfLink":"/apis/rabbitmq.com/v1beta1/namespaces/default/rabbitmqclusters/rabbitmq-cluster/status","uid":"18d9928b-0d1c-47be-80ec-20960d053827","resourceVersion":"1232","generation":3,"creationTimestamp":"2022-03-18T18:00:38Z","annotations":{"kubectl.kubernetes.io/last-applied-configuration":"{\"apiVersion\":\"rabbitmq.com/v1beta1\",\"kind\":\"RabbitmqCluster\",\"metadata\":{\"annotations\":{},\"name\":\"rabbitmq-cluster\",\"namespace\":\"default\"},\"spec\":{\"persistence\":{\"storage\":\"10Gi\"},\"replicas\":1}}\n"},"finalizers":["deletion.finalizers.rabbitmqclusters.rabbitmq.com"],"managedFields":[{"manager":"kubectl-client-side-apply","operation":"Update","apiVersion":"rabbitmq.com/v1beta1","time":"2022-03-18T18:00:38Z","fieldsType":"FieldsV1","fieldsV1":{"f:metadata":{"f:annotations":{".":{},"f:kubectl.kubernetes.io/last-applied-configuration":{}}},"f:spec":{".":{},"f:image":{},"f:persistence":{".":{},"f:storage":{}},"f:resources":{".":{},"f:limits":{".":{},"f:memory":{}},"f:requests":{".":{},"f:memory":{}}},"f:service":{".":{},"f:type":{}},"f:terminationGracePeriodSeconds":{}}}},{"manager":"kubectl-patch","operation":"Update","apiVersion":"rabbitmq.com/v1beta1","time":"2022-03-18T18:01:23Z","fieldsType":"FieldsV1","fieldsV1":{"f:spec":{"f:replicas":{}}}},{"manager":"manager","operation":"Update","apiVersion":"rabbitmq.com/v1beta1","time":"2022-03-18T18:02:01Z","fieldsType":"FieldsV1","fieldsV1":{"f:metadata":{"f:finalizers":{}},"f:spec":{"f:override":{},"f:rabbitmq":{},"f:resources":{"f:limits":{"f:cpu":{}},"f:requests":{"f:cpu":{}}},"f:tls":{}},"f:status":{".":{},"f:conditions":{},"f:defaultUser":{".":{},"f:secretReference":{".":{},"f:keys":{".":{},"f:password":{},"f:username":{}},"f:name":{},"f:namespace":{}},"f:serviceReference":{".":{},"f:name":{},"f:namespace":{}}}}}}]},"spec":{"replicas":3,"image":"rabbitmq:3.8.12-management","service":{"type":"ClusterIP"},"persistence":{"storage":"10Gi"},"resources":{"limits":{"cpu":"2","memory":"2Gi"},"requests":{"cpu":"1","memory":"2Gi"}},"rabbitmq":{},"tls":{},"override":{},"terminationGracePeriodSeconds":604800},"status":{"conditions":[{"type":"AllReplicasReady","status":"True","lastTransitionTime":"2022-03-18T18:02:01Z","reason":"AllPodsAreReady"},{"type":"ClusterAvailable","status":"True","lastTransitionTime":"2022-03-18T18:01:17Z","reason":"AtLeastOneEndpointAvailable"},{"type":"NoWarnings","status":"True","lastTransitionTime":"2022-03-18T18:00:38Z","reason":"NoWarnings"},{"type":"ReconcileSuccess","status":"True","lastTransitionTime":"2022-03-18T18:01:18Z","reason":"Success","message":"Finish reconciling"}],"defaultUser":{"secretReference":{"name":"rabbitmq-cluster-default-user","namespace":"default","keys":{"password":"password","username":"username"}},"serviceReference":{"name":"rabbitmq-cluster","namespace":"default"}},"binding":{"name":"rabbitmq-cluster-default-user"}}}
2022/03/18 18:02:08 learn_server.go:291: [SIEVE-AFTER-READ]	Get	true	statefulset	default	rabbitmq-cluster-server	github.com/rabbitmq/cluster-operator/controllers.(*RabbitmqClusterReconciler)	NoError	{"kind":"StatefulSet","apiVersion":"apps/v1","metadata":{"name":"rabbitmq-cluster-server","namespace":"default","selfLink":"/apis/apps/v1/namespaces/default/statefulsets/rabbitmq-cluster-server","uid":"cb5c43bc-6ee7-481c-ab01-6f3acffdd3c8","resourceVersion":"1231","generation":2,"creationTimestamp":"2022-03-18T18:00:38Z","labels":{"app.kubernetes.io/component":"rabbitmq","app.kubernetes.io/name":"rabbitmq-cluster","app.kubernetes.io/part-of":"rabbitmq"},"ownerReferences":[{"apiVersion":"rabbitmq.com/v1beta1","kind":"RabbitmqCluster","name":"rabbitmq-cluster","uid":"18d9928b-0d1c-47be-80ec-20960d053827","controller":true,"blockOwnerDeletion":true}],"managedFields":[{"manager":"manager","operation":"Update","apiVersion":"apps/v1","time":"2022-03-18T18:01:23Z","fieldsType":"FieldsV1","fieldsV1":{"f:metadata":{"f:labels":{".":{},"f:app.kubernetes.io/component":{},"f:app.kubernetes.io/name":{},"f:app.kubernetes.io/part-of":{}},"f:ownerReferences":{".":{},"k:{\"uid\":\"18d9928b-0d1c-47be-80ec-20960d053827\"}":{".":{},"f:apiVersion":{},"f:blockOwnerDeletion":{},"f:controller":{},"f:kind":{},"f:name":{},"f:uid":{}}}},"f:spec":{"f:podManagementPolicy":{},"f:replicas":{},"f:revisionHistoryLimit":{},"f:selector":{"f:matchLabels":{".":{},"f:app.kubernetes.io/name":{}}},"f:serviceName":{},"f:template":{"f:metadata":{"f:annotations":{".":{},"f:prometheus.io/port":{},"f:prometheus.io/scrape":{}},"f:labels":{".":{},"f:app.kubernetes.io/component":{},"f:app.kubernetes.io/name":{},"f:app.kubernetes.io/part-of":{}}},"f:spec":{"f:automountServiceAccountToken":{},"f:containers":{"k:{\"name\":\"rabbitmq\"}":{".":{},"f:env":{".":{},"k:{\"name\":\"K8S_HOSTNAME_SUFFIX\"}":{".":{},"f:name":{},"f:value":{}},"k:{\"name\":\"K8S_SERVICE_NAME\"}":{".":{},"f:name":{},"f:value":{}},"k:{\"name\":\"MY_POD_NAME\"}":{".":{},"f:name":{},"f:valueFrom":{".":{},"f:fieldRef":{".":{},"f:apiVersion":{},"f:fieldPath":{}}}},"k:{\"name\":\"MY_POD_NAMESPACE\"}":{".":{},"f:name":{},"f:valueFrom":{".":{},"f:fieldRef":{".":{},"f:apiVersion":{},"f:fieldPath":{}}}},"k:{\"name\":\"RABBITMQ_ENABLED_PLUGINS_FILE\"}":{".":{},"f:name":{},"f:value":{}},"k:{\"name\":\"RABBITMQ_NODENAME\"}":{".":{},"f:name":{},"f:value":{}},"k:{\"name\":\"RABBITMQ_USE_LONGNAME\"}":{".":{},"f:name":{},"f:value":{}}},"f:image":{},"f:imagePullPolicy":{},"f:lifecycle":{".":{},"f:preStop":{".":{},"f:exec":{".":{},"f:command":{}}}},"f:name":{},"f:ports":{".":{},"k:{\"containerPort\":4369,\"protocol\":\"TCP\"}":{".":{},"f:containerPort":{},"f:name":{},"f:protocol":{}},"k:{\"containerPort\":5672,\"protocol\":\"TCP\"}":{".":{},"f:containerPort":{},"f:name":{},"f:protocol":{}},"k:{\"containerPort\":15672,\"protocol\":\"TCP\"}":{".":{},"f:containerPort":{},"f:name":{},"f:protocol":{}},"k:{\"containerPort\":15692,\"protocol\":\"TCP\"}":{".":{},"f:containerPort":{},"f:name":{},"f:protocol":{}}},"f:readinessProbe":{".":{},"f:failureThreshold":{},"f:initialDelaySeconds":{},"f:periodSeconds":{},"f:successThreshold":{},"f:tcpSocket":{".":{},"f:port":{}},"f:timeoutSeconds":{}},"f:resources":{".":{},"f:limits":{".":{},"f:cpu":{},"f:memory":{}},"f:requests":{".":{},"f:cpu":{},"f:memory":{}}},"f:terminationMessagePath":{},"f:terminationMessagePolicy":{},"f:volumeMounts":{".":{},"k:{\"mountPath\":\"/etc/pod-info/\"}":{".":{},"f:mountPath":{},"f:name":{}},"k:{\"mountPath\":\"/etc/rabbitmq/conf.d/10-operatorDefaults.conf\"}":{".":{},"f:mountPath":{},"f:name":{},"f:subPath":{}},"k:{\"mountPath\":\"/etc/rabbitmq/conf.d/11-default_user.conf\"}":{".":{},"f:mountPath":{},"f:name":{},"f:subPath":{}},"k:{\"mountPath\":\"/etc/rabbitmq/conf.d/90-userDefinedConfiguration.conf\"}":{".":{},"f:mountPath":{},"f:name":{},"f:subPath":{}},"k:{\"mountPath\":\"/operator\"}":{".":{},"f:mountPath":{},"f:name":{}},"k:{\"mountPath\":\"/var/lib/rabbitmq/\"}":{".":{},"f:mountPath":{},"f:name":{}},"k:{\"mountPath\":\"/var/lib/rabbitmq/mnesia/\"}":{".":{},"f:mountPath":{},"f:name":{}}}}},"f:dnsPolicy":{},"f:initContainers":{".":{},"k:{\"name\":\"setup-container\"}":{".":{},"f:command":{},"f:image":{},"f:imagePullPolicy":{},"f:name":{},"f:resources":{".":{},"f:limits":{".":{},"f:cpu":{},"f:memory":{}},"f:requests":{".":{},"f:cpu":{},"f:memory":{}}},"f:securityContext":{".":{},"f:capabilities":{".":{},"f:drop":{}},"f:runAsUser":{}},"f:terminationMessagePath":{},"f:terminationMessagePolicy":{},"f:volumeMounts":{".":{},"k:{\"mountPath\":\"/operator\"}":{".":{},"f:mountPath":{},"f:name":{}},"k:{\"mountPath\":\"/tmp/default_user.conf\"}":{".":{},"f:mountPath":{},"f:name":{},"f:subPath":{}},"k:{\"mountPath\":\"/tmp/erlang-cookie-secret/\"}":{".":{},"f:mountPath":{},"f:name":{}},"k:{\"mountPath\":\"/tmp/rabbitmq-plugins/\"}":{".":{},"f:mountPath":{},"f:name":{}},"k:{\"mountPath\":\"/var/lib/rabbitmq/\"}":{".":{},"f:mountPath":{},"f:name":{}},"k:{\"mountPath\":\"/var/lib/rabbitmq/mnesia/\"}":{".":{},"f:mountPath":{},"f:name":{}}}}},"f:restartPolicy":{},"f:schedulerName":{},"f:securityContext":{".":{},"f:fsGroup":{},"f:runAsGroup":{},"f:runAsUser":{}},"f:serviceAccount":{},"f:serviceAccountName":{},"f:terminationGracePeriodSeconds":{},"f:topologySpreadConstraints":{".":{},"k:{\"topologyKey\":\"topology.kubernetes.io/zone\",\"whenUnsatisfiable\":\"ScheduleAnyway\"}":{".":{},"f:labelSelector":{".":{},"f:matchLabels":{".":{},"f:app.kubernetes.io/name":{}}},"f:maxSkew":{},"f:topologyKey":{},"f:whenUnsatisfiable":{}}},"f:volumes":{".":{},"k:{\"name\":\"erlang-cookie-secret\"}":{".":{},"f:name":{},"f:secret":{".":{},"f:defaultMode":{},"f:secretName":{}}},"k:{\"name\":\"plugins-conf\"}":{".":{},"f:configMap":{".":{},"f:defaultMode":{},"f:name":{}},"f:name":{}},"k:{\"name\":\"pod-info\"}":{".":{},"f:downwardAPI":{".":{},"f:defaultMode":{},"f:items":{}},"f:name":{}},"k:{\"name\":\"rabbitmq-confd\"}":{".":{},"f:name":{},"f:projected":{".":{},"f:defaultMode":{},"f:sources":{}}},"k:{\"name\":\"rabbitmq-erlang-cookie\"}":{".":{},"f:emptyDir":{},"f:name":{}},"k:{\"name\":\"rabbitmq-plugins\"}":{".":{},"f:emptyDir":{},"f:name":{}}}}},"f:updateStrategy":{"f:rollingUpdate":{".":{},"f:partition":{}},"f:type":{}},"f:volumeClaimTemplates":{}}}},{"manager":"kube-controller-manager","operation":"Update","apiVersion":"apps/v1","time":"2022-03-18T18:02:01Z","fieldsType":"FieldsV1","fieldsV1":{"f:status":{"f:collisionCount":{},"f:currentReplicas":{},"f:currentRevision":{},"f:observedGeneration":{},"f:readyReplicas":{},"f:replicas":{},"f:updateRevision":{},"f:updatedReplicas":{}}}}]},"spec":{"replicas":3,"selector":{"matchLabels":{"app.kubernetes.io/name":"rabbitmq-cluster"}},"template":{"metadata":{"creationTimestamp":null,"labels":{"app.kubernetes.io/component":"rabbitmq","app.kubernetes.io/name":"rabbitmq-cluster","app.kubernetes.io/part-of":"rabbitmq"},"annotations":{"prometheus.io/port":"15692","prometheus.io/scrape":"true"}},"spec":{"volumes":[{"name":"plugins-conf","configMap":{"name":"rabbitmq-cluster-plugins-conf","defaultMode":420}},{"name":"rabbitmq-confd","projected":{"sources":[{"secret":{"name":"rabbitmq-cluster-default-user","items":[{"key":"default_user.conf","path":"default_user.conf"}]}},{"configMap":{"name":"rabbitmq-cluster-server-conf","items":[{"key":"operatorDefaults.conf","path":"operatorDefaults.conf"},{"key":"userDefinedConfiguration.conf","path":"userDefinedConfiguration.conf"}]}}],"defaultMode":420}},{"name":"rabbitmq-erlang-cookie","emptyDir":{}},{"name":"erlang-cookie-secret","secret":{"secretName":"rabbitmq-cluster-erlang-cookie","defaultMode":420}},{"name":"rabbitmq-plugins","emptyDir":{}},{"name":"pod-info","downwardAPI":{"items":[{"path":"skipPreStopChecks","fieldRef":{"apiVersion":"v1","fieldPath":"metadata.labels['skipPreStopChecks']"}}],"defaultMode":420}}],"initContainers":[{"name":"setup-container","image":"rabbitmq:3.8.12-management","command":["sh","-c","cp /tmp/erlang-cookie-secret/.erlang.cookie /var/lib/rabbitmq/.erlang.cookie \u0026\u0026 chown 999:999 /var/lib/rabbitmq/.erlang.cookie \u0026\u0026 chmod 600 /var/lib/rabbitmq/.erlang.cookie ; cp /tmp/rabbitmq-plugins/enabled_plugins /operator/enabled_plugins \u0026\u0026 chown 999:999 /operator/enabled_plugins ; chown 999:999 /var/lib/rabbitmq/mnesia/ ; echo '[default]' \u003e /var/lib/rabbitmq/.rabbitmqadmin.conf \u0026\u0026 sed -e 's/default_user/username/' -e 's/default_pass/password/' /tmp/default_user.conf \u003e\u003e /var/lib/rabbitmq/.rabbitmqadmin.conf \u0026\u0026 chown 999:999 /var/lib/rabbitmq/.rabbitmqadmin.conf \u0026\u0026 chmod 600 /var/lib/rabbitmq/.rabbitmqadmin.conf"],"resources":{"limits":{"cpu":"100m","memory":"500Mi"},"requests":{"cpu":"100m","memory":"500Mi"}},"volumeMounts":[{"name":"plugins-conf","mountPath":"/tmp/rabbitmq-plugins/"},{"name":"rabbitmq-erlang-cookie","mountPath":"/var/lib/rabbitmq/"},{"name":"erlang-cookie-secret","mountPath":"/tmp/erlang-cookie-secret/"},{"name":"rabbitmq-plugins","mountPath":"/operator"},{"name":"persistence","mountPath":"/var/lib/rabbitmq/mnesia/"},{"name":"rabbitmq-confd","mountPath":"/tmp/default_user.conf","subPath":"default_user.conf"}],"terminationMessagePath":"/dev/termination-log","terminationMessagePolicy":"File","imagePullPolicy":"IfNotPresent","securityContext":{"capabilities":{"drop":["FSETID","KILL","SETGID","SETUID","SETPCAP","NET_BIND_SERVICE","NET_RAW","SYS_CHROOT","MKNOD","AUDIT_WRITE","SETFCAP"]},"runAsUser":0}}],"containers":[{"name":"rabbitmq","image":"rabbitmq:3.8.12-management","ports":[{"name":"epmd","containerPort":4369,"protocol":"TCP"},{"name":"amqp","containerPort":5672,"protocol":"TCP"},{"name":"management","containerPort":15672,"protocol":"TCP"},{"name":"prometheus","containerPort":15692,"protocol":"TCP"}],"env":[{"name":"MY_POD_NAME","valueFrom":{"fieldRef":{"apiVersion":"v1","fieldPath":"metadata.name"}}},{"name":"MY_POD_NAMESPACE","valueFrom":{"fieldRef":{"apiVersion":"v1","fieldPath":"metadata.namespace"}}},{"name":"RABBITMQ_ENABLED_PLUGINS_FILE","value":"/operator/enabled_plugins"},{"name":"K8S_SERVICE_NAME","value":"rabbitmq-cluster-nodes"},{"name":"RABBITMQ_USE_LONGNAME","value":"true"},{"name":"RABBITMQ_NODENAME","value":"rabbit@$(MY_POD_NAME).$(K8S_SERVICE_NAME).$(MY_POD_NAMESPACE)"},{"name":"K8S_HOSTNAME_SUFFIX","value":".$(K8S_SERVICE_NAME).$(MY_POD_NAMESPACE)"}],"resources":{"limits":{"cpu":"2","memory":"2Gi"},"requests":{"cpu":"1","memory":"2Gi"}},"volumeMounts":[{"name":"rabbitmq-erlang-cookie","mountPath":"/var/lib/rabbitmq/"},{"name":"persistence","mountPath":"/var/lib/rabbitmq/mnesia/"},{"name":"rabbitmq-plugins","mountPath":"/operator"},{"name":"rabbitmq-confd","mountPath":"/etc/rabbitmq/conf.d/10-operatorDefaults.conf","subPath":"operatorDefaults.conf"},{"name":"rabbitmq-confd","mountPath":"/etc/rabbitmq/conf.d/11-default_user.conf","subPath":"default_user.conf"},{"name":"rabbitmq-confd","mountPath":"/etc/rabbitmq/conf.d/90-userDefinedConfiguration.conf","subPath":"userDefinedConfiguration.conf"},{"name":"pod-info","mountPath":"/etc/pod-info/"}],"readinessProbe":{"tcpSocket":{"port":"amqp"},"initialDelaySeconds":10,"timeoutSeconds":5,"periodSeconds":10,"successThreshold":1,"failureThreshold":3},"lifecycle":{"preStop":{"exec":{"command":["/bin/bash","-c","if [ ! -z \"$(cat /etc/pod-info/skipPreStopChecks)\" ]; then exit 0; fi; rabbitmq-upgrade await_online_quorum_plus_one -t 604800; rabbitmq-upgrade await_online_synchronized_mirror -t 604800; rabbitmq-upgrade drain -t 604800"]}}},"terminationMessagePath":"/dev/termination-log","terminationMessagePolicy":"File","imagePullPolicy":"IfNotPresent"}],"restartPolicy":"Always","terminationGracePeriodSeconds":604800,"dnsPolicy":"ClusterFirst","serviceAccountName":"rabbitmq-cluster-server","serviceAccount":"rabbitmq-cluster-server","automountServiceAccountToken":true,"securityContext":{"runAsUser":999,"runAsGroup":999,"fsGroup":999},"schedulerName":"default-scheduler","topologySpreadConstraints":[{"maxSkew":1,"topologyKey":"topology.kubernetes.io/zone","whenUnsatisfiable":"ScheduleAnyway","labelSelector":{"matchLabels":{"app.kubernetes.io/name":"rabbitmq-cluster"}}}]}},"volumeClaimTemplates":[{"metadata":{"name":"persistence","namespace":"default","creationTimestamp":null,"labels":{"app.kubernetes.io/component":"rabbitmq","app.kubernetes.io/name":"rabbitmq-cluster","app.kubernetes.io/part-of":"rabbitmq"},"ownerReferences":[{"apiVersion":"rabbitmq.com/v1beta1","kind":"RabbitmqCluster","name":"rabbitmq-cluster","uid":"18d9928b-0d1c-47be-80ec-20960d053827","controller":true,"blockOwnerDeletion":false}]},"spec":{"accessModes":["ReadWriteOnce"],"resources":{"requests":{"storage":"10Gi"}},"volumeMode":"Filesystem"},"status":{"phase":"Pending"}}],"serviceName":"rabbitmq-cluster-nodes","podManagementPolicy":"Parallel","updateStrategy":{"type":"RollingUpdate","rollingUpdate":{"partition":0}},"revisionHistoryLimit":10},"status":{"observedGeneration":2,"replicas":3,"readyReplicas":3,"currentReplicas":3,"updatedReplicas":3,"currentRevision":"rabbitmq-cluster-server-5f8b8665fb","updateRevision":"rabbitmq-cluster-server-5f8b8665fb","collisionCount":0}}
2022/03/18 18:02:08 learn_server.go:291: [SIEVE-AFTER-READ]	Get	true	configmap	default	rabbitmq-cluster-plugins-conf	github.com/rabbitmq/cluster-operator/controllers.(*RabbitmqClusterReconciler)	NoError	{"kind":"ConfigMap","apiVersion":"v1","metadata":{"name":"rabbitmq-cluster-plugins-conf","namespace":"default","selfLink":"/api/v1/namespaces/default/configmaps/rabbitmq-cluster-plugins-conf","uid":"a164075b-0562-47ac-a577-99aa8651ec40","resourceVersion":"709","creationTimestamp":"2022-03-18T18:00:38Z","labels":{"app.kubernetes.io/component":"rabbitmq","app.kubernetes.io/name":"rabbitmq-cluster","app.kubernetes.io/part-of":"rabbitmq"},"ownerReferences":[{"apiVersion":"rabbitmq.com/v1beta1","kind":"RabbitmqCluster","name":"rabbitmq-cluster","uid":"18d9928b-0d1c-47be-80ec-20960d053827","controller":true,"blockOwnerDeletion":true}],"managedFields":[{"manager":"manager","operation":"Update","apiVersion":"v1","time":"2022-03-18T18:00:38Z","fieldsType":"FieldsV1","fieldsV1":{"f:data":{".":{},"f:enabled_plugins":{}},"f:metadata":{"f:labels":{".":{},"f:app.kubernetes.io/component":{},"f:app.kubernetes.io/name":{},"f:app.kubernetes.io/part-of":{}},"f:ownerReferences":{".":{},"k:{\"uid\":\"18d9928b-0d1c-47be-80ec-20960d053827\"}":{".":{},"f:apiVersion":{},"f:blockOwnerDeletion":{},"f:controller":{},"f:kind":{},"f:name":{},"f:uid":{}}}}}}]},"data":{"enabled_plugins":"[rabbitmq_peer_discovery_k8s,rabbitmq_prometheus,rabbitmq_management]."}}
2022/03/18 18:02:08 learn_server.go:256: [SIEVE-BEFORE-WRITE]	63
2022/03/18 18:02:08 learn_server.go:263: [SIEVE-AFTER-WRITE]	63	StatusUpdate	rabbitmqcluster	github.com/rabbitmq/cluster-operator/controllers.(*RabbitmqClusterReconciler)	NoError	{"metadata":{"name":"rabbitmq-cluster","namespace":"default","selfLink":"/apis/rabbitmq.com/v1beta1/namespaces/default/rabbitmqclusters/rabbitmq-cluster/status","uid":"18d9928b-0d1c-47be-80ec-20960d053827","resourceVersion":"1232","generation":3,"creationTimestamp":"2022-03-18T18:00:38Z","annotations":{"kubectl.kubernetes.io/last-applied-configuration":"{\"apiVersion\":\"rabbitmq.com/v1beta1\",\"kind\":\"RabbitmqCluster\",\"metadata\":{\"annotations\":{},\"name\":\"rabbitmq-cluster\",\"namespace\":\"default\"},\"spec\":{\"persistence\":{\"storage\":\"10Gi\"},\"replicas\":1}}\n"},"finalizers":["deletion.finalizers.rabbitmqclusters.rabbitmq.com"],"managedFields":[{"manager":"kubectl-client-side-apply","operation":"Update","apiVersion":"rabbitmq.com/v1beta1","time":"2022-03-18T18:00:38Z","fieldsType":"FieldsV1","fieldsV1":{"f:metadata":{"f:annotations":{".":{},"f:kubectl.kubernetes.io/last-applied-configuration":{}}},"f:spec":{".":{},"f:image":{},"f:persistence":{".":{},"f:storage":{}},"f:resources":{".":{},"f:limits":{".":{},"f:memory":{}},"f:requests":{".":{},"f:memory":{}}},"f:service":{".":{},"f:type":{}},"f:terminationGracePeriodSeconds":{}}}},{"manager":"kubectl-patch","operation":"Update","apiVersion":"rabbitmq.com/v1beta1","time":"2022-03-18T18:01:23Z","fieldsType":"FieldsV1","fieldsV1":{"f:spec":{"f:replicas":{}}}},{"manager":"manager","operation":"Update","apiVersion":"rabbitmq.com/v1beta1","time":"2022-03-18T18:02:01Z","fieldsType":"FieldsV1","fieldsV1":{"f:metadata":{"f:finalizers":{}},"f:spec":{"f:override":{},"f:rabbitmq":{},"f:resources":{"f:limits":{"f:cpu":{}},"f:requests":{"f:cpu":{}}},"f:tls":{}},"f:status":{".":{},"f:conditions":{},"f:defaultUser":{".":{},"f:secretReference":{".":{},"f:keys":{".":{},"f:password":{},"f:username":{}},"f:name":{},"f:namespace":{}},"f:serviceReference":{".":{},"f:name":{},"f:namespace":{}}}}}}]},"spec":{"replicas":3,"image":"rabbitmq:3.8.12-management","service":{"type":"ClusterIP"},"persistence":{"storage":"10Gi"},"resources":{"limits":{"cpu":"2","memory":"2Gi"},"requests":{"cpu":"1","memory":"2Gi"}},"rabbitmq":{},"tls":{},"override":{},"terminationGracePeriodSeconds":604800},"status":{"conditions":[{"type":"AllReplicasReady","status":"True","lastTransitionTime":"2022-03-18T18:02:01Z","reason":"AllPodsAreReady"},{"type":"ClusterAvailable","status":"True","lastTransitionTime":"2022-03-18T18:01:17Z","reason":"AtLeastOneEndpointAvailable"},{"type":"NoWarnings","status":"True","lastTransitionTime":"2022-03-18T18:00:38Z","reason":"NoWarnings"},{"type":"ReconcileSuccess","status":"True","lastTransitionTime":"2022-03-18T18:01:18Z","reason":"Success","message":"Finish reconciling"}],"defaultUser":{"secretReference":{"name":"rabbitmq-cluster-default-user","namespace":"default","keys":{"password":"password","username":"username"}},"serviceReference":{"name":"rabbitmq-cluster","namespace":"default"}},"binding":{"name":"rabbitmq-cluster-default-user"}}}
2022/03/18 18:02:08 learn_server.go:253: [SIEVE-AFTER-RECONCILE]	github.com/rabbitmq/cluster-operator/controllers.(*RabbitmqClusterReconciler)	18
2022/03/18 18:02:09 learn_server.go:279: [SIEVE-BEFORE-HEAR]	30	Updated	rabbitmqcluster	{"metadata":{"name":"rabbitmq-cluster","namespace":"default","selfLink":"/apis/rabbitmq.com/v1beta1/namespaces/default/rabbitmqclusters/rabbitmq-cluster","uid":"18d9928b-0d1c-47be-80ec-20960d053827","resourceVersion":"1261","generation":4,"creationTimestamp":"2022-03-18T18:00:38Z","annotations":{"kubectl.kubernetes.io/last-applied-configuration":"{\"apiVersion\":\"rabbitmq.com/v1beta1\",\"kind\":\"RabbitmqCluster\",\"metadata\":{\"annotations\":{},\"name\":\"rabbitmq-cluster\",\"namespace\":\"default\"},\"spec\":{\"persistence\":{\"storage\":\"10Gi\"},\"replicas\":1}}\n"},"finalizers":["deletion.finalizers.rabbitmqclusters.rabbitmq.com"],"managedFields":[{"manager":"kubectl-client-side-apply","operation":"Update","apiVersion":"rabbitmq.com/v1beta1","time":"2022-03-18T18:00:38Z","fieldsType":"FieldsV1","fieldsV1":{"f:metadata":{"f:annotations":{".":{},"f:kubectl.kubernetes.io/last-applied-configuration":{}}},"f:spec":{".":{},"f:image":{},"f:persistence":{".":{},"f:storage":{}},"f:resources":{".":{},"f:limits":{".":{},"f:memory":{}},"f:requests":{".":{},"f:memory":{}}},"f:service":{".":{},"f:type":{}},"f:terminationGracePeriodSeconds":{}}}},{"manager":"manager","operation":"Update","apiVersion":"rabbitmq.com/v1beta1","time":"2022-03-18T18:02:01Z","fieldsType":"FieldsV1","fieldsV1":{"f:metadata":{"f:finalizers":{}},"f:spec":{"f:override":{},"f:rabbitmq":{},"f:resources":{"f:limits":{"f:cpu":{}},"f:requests":{"f:cpu":{}}},"f:tls":{}},"f:status":{".":{},"f:conditions":{},"f:defaultUser":{".":{},"f:secretReference":{".":{},"f:keys":{".":{},"f:password":{},"f:username":{}},"f:name":{},"f:namespace":{}},"f:serviceReference":{".":{},"f:name":{},"f:namespace":{}}}}}},{"manager":"kubectl-patch","operation":"Update","apiVersion":"rabbitmq.com/v1beta1","time":"2022-03-18T18:02:09Z","fieldsType":"FieldsV1","fieldsV1":{"f:spec":{"f:replicas":{}}}}]},"spec":{"replicas":2,"image":"rabbitmq:3.8.12-management","service":{"type":"ClusterIP"},"persistence":{"storage":"10Gi"},"resources":{"limits":{"cpu":"2","memory":"2Gi"},"requests":{"cpu":"1","memory":"2Gi"}},"rabbitmq":{},"tls":{},"override":{},"terminationGracePeriodSeconds":604800},"status":{"conditions":[{"type":"AllReplicasReady","status":"True","lastTransitionTime":"2022-03-18T18:02:01Z","reason":"AllPodsAreReady"},{"type":"ClusterAvailable","status":"True","lastTransitionTime":"2022-03-18T18:01:17Z","reason":"AtLeastOneEndpointAvailable"},{"type":"NoWarnings","status":"True","lastTransitionTime":"2022-03-18T18:00:38Z","reason":"NoWarnings"},{"type":"ReconcileSuccess","status":"True","lastTransitionTime":"2022-03-18T18:01:18Z","reason":"Success","message":"Finish reconciling"}],"defaultUser":{"secretReference":{"name":"rabbitmq-cluster-default-user","namespace":"default","keys":{"password":"password","username":"username"}},"serviceReference":{"name":"rabbitmq-cluster","namespace":"default"}}}}
2022/03/18 18:02:09 learn_server.go:289: [SIEVE-AFTER-HEAR]	30
2022/03/18 18:02:09 learn_server.go:238: [SIEVE-BEFORE-RECONCILE]	github.com/rabbitmq/cluster-operator/controllers.(*RabbitmqClusterReconciler)	19
2022/03/18 18:02:09 learn_server.go:291: [SIEVE-AFTER-READ]	Get	true	rabbitmqcluster	default	rabbitmq-cluster	github.com/rabbitmq/cluster-operator/controllers.(*RabbitmqClusterReconciler)	NoError	{"kind":"RabbitmqCluster","apiVersion":"rabbitmq.com/v1beta1","metadata":{"name":"rabbitmq-cluster","namespace":"default","selfLink":"/apis/rabbitmq.com/v1beta1/namespaces/default/rabbitmqclusters/rabbitmq-cluster","uid":"18d9928b-0d1c-47be-80ec-20960d053827","resourceVersion":"1261","generation":4,"creationTimestamp":"2022-03-18T18:00:38Z","annotations":{"kubectl.kubernetes.io/last-applied-configuration":"{\"apiVersion\":\"rabbitmq.com/v1beta1\",\"kind\":\"RabbitmqCluster\",\"metadata\":{\"annotations\":{},\"name\":\"rabbitmq-cluster\",\"namespace\":\"default\"},\"spec\":{\"persistence\":{\"storage\":\"10Gi\"},\"replicas\":1}}\n"},"finalizers":["deletion.finalizers.rabbitmqclusters.rabbitmq.com"],"managedFields":[{"manager":"kubectl-client-side-apply","operation":"Update","apiVersion":"rabbitmq.com/v1beta1","time":"2022-03-18T18:00:38Z","fieldsType":"FieldsV1","fieldsV1":{"f:metadata":{"f:annotations":{".":{},"f:kubectl.kubernetes.io/last-applied-configuration":{}}},"f:spec":{".":{},"f:image":{},"f:persistence":{".":{},"f:storage":{}},"f:resources":{".":{},"f:limits":{".":{},"f:memory":{}},"f:requests":{".":{},"f:memory":{}}},"f:service":{".":{},"f:type":{}},"f:terminationGracePeriodSeconds":{}}}},{"manager":"manager","operation":"Update","apiVersion":"rabbitmq.com/v1beta1","time":"2022-03-18T18:02:01Z","fieldsType":"FieldsV1","fieldsV1":{"f:metadata":{"f:finalizers":{}},"f:spec":{"f:override":{},"f:rabbitmq":{},"f:resources":{"f:limits":{"f:cpu":{}},"f:requests":{"f:cpu":{}}},"f:tls":{}},"f:status":{".":{},"f:conditions":{},"f:defaultUser":{".":{},"f:secretReference":{".":{},"f:keys":{".":{},"f:password":{},"f:username":{}},"f:name":{},"f:namespace":{}},"f:serviceReference":{".":{},"f:name":{},"f:namespace":{}}}}}},{"manager":"kubectl-patch","operation":"Update","apiVersion":"rabbitmq.com/v1beta1","time":"2022-03-18T18:02:09Z","fieldsType":"FieldsV1","fieldsV1":{"f:spec":{"f:replicas":{}}}}]},"spec":{"replicas":2,"image":"rabbitmq:3.8.12-management","service":{"type":"ClusterIP"},"persistence":{"storage":"10Gi"},"resources":{"limits":{"cpu":"2","memory":"2Gi"},"requests":{"cpu":"1","memory":"2Gi"}},"rabbitmq":{},"tls":{},"override":{},"terminationGracePeriodSeconds":604800},"status":{"conditions":[{"type":"AllReplicasReady","status":"True","lastTransitionTime":"2022-03-18T18:02:01Z","reason":"AllPodsAreReady"},{"type":"ClusterAvailable","status":"True","lastTransitionTime":"2022-03-18T18:01:17Z","reason":"AtLeastOneEndpointAvailable"},{"type":"NoWarnings","status":"True","lastTransitionTime":"2022-03-18T18:00:38Z","reason":"NoWarnings"},{"type":"ReconcileSuccess","status":"True","lastTransitionTime":"2022-03-18T18:01:18Z","reason":"Success","message":"Finish reconciling"}],"defaultUser":{"secretReference":{"name":"rabbitmq-cluster-default-user","namespace":"default","keys":{"password":"password","username":"username"}},"serviceReference":{"name":"rabbitmq-cluster","namespace":"default"}}}}
2022/03/18 18:02:09 learn_server.go:291: [SIEVE-AFTER-READ]	Get	true	statefulset	default	rabbitmq-cluster-server	github.com/rabbitmq/cluster-operator/controllers.(*RabbitmqClusterReconciler)	NoError	{"kind":"StatefulSet","apiVersion":"apps/v1","metadata":{"name":"rabbitmq-cluster-server","namespace":"default","selfLink":"/apis/apps/v1/namespaces/default/statefulsets/rabbitmq-cluster-server","uid":"cb5c43bc-6ee7-481c-ab01-6f3acffdd3c8","resourceVersion":"1231","generation":2,"creationTimestamp":"2022-03-18T18:00:38Z","labels":{"app.kubernetes.io/component":"rabbitmq","app.kubernetes.io/name":"rabbitmq-cluster","app.kubernetes.io/part-of":"rabbitmq"},"ownerReferences":[{"apiVersion":"rabbitmq.com/v1beta1","kind":"RabbitmqCluster","name":"rabbitmq-cluster","uid":"18d9928b-0d1c-47be-80ec-20960d053827","controller":true,"blockOwnerDeletion":true}],"managedFields":[{"manager":"manager","operation":"Update","apiVersion":"apps/v1","time":"2022-03-18T18:01:23Z","fieldsType":"FieldsV1","fieldsV1":{"f:metadata":{"f:labels":{".":{},"f:app.kubernetes.io/component":{},"f:app.kubernetes.io/name":{},"f:app.kubernetes.io/part-of":{}},"f:ownerReferences":{".":{},"k:{\"uid\":\"18d9928b-0d1c-47be-80ec-20960d053827\"}":{".":{},"f:apiVersion":{},"f:blockOwnerDeletion":{},"f:controller":{},"f:kind":{},"f:name":{},"f:uid":{}}}},"f:spec":{"f:podManagementPolicy":{},"f:replicas":{},"f:revisionHistoryLimit":{},"f:selector":{"f:matchLabels":{".":{},"f:app.kubernetes.io/name":{}}},"f:serviceName":{},"f:template":{"f:metadata":{"f:annotations":{".":{},"f:prometheus.io/port":{},"f:prometheus.io/scrape":{}},"f:labels":{".":{},"f:app.kubernetes.io/component":{},"f:app.kubernetes.io/name":{},"f:app.kubernetes.io/part-of":{}}},"f:spec":{"f:automountServiceAccountToken":{},"f:containers":{"k:{\"name\":\"rabbitmq\"}":{".":{},"f:env":{".":{},"k:{\"name\":\"K8S_HOSTNAME_SUFFIX\"}":{".":{},"f:name":{},"f:value":{}},"k:{\"name\":\"K8S_SERVICE_NAME\"}":{".":{},"f:name":{},"f:value":{}},"k:{\"name\":\"MY_POD_NAME\"}":{".":{},"f:name":{},"f:valueFrom":{".":{},"f:fieldRef":{".":{},"f:apiVersion":{},"f:fieldPath":{}}}},"k:{\"name\":\"MY_POD_NAMESPACE\"}":{".":{},"f:name":{},"f:valueFrom":{".":{},"f:fieldRef":{".":{},"f:apiVersion":{},"f:fieldPath":{}}}},"k:{\"name\":\"RABBITMQ_ENABLED_PLUGINS_FILE\"}":{".":{},"f:name":{},"f:value":{}},"k:{\"name\":\"RABBITMQ_NODENAME\"}":{".":{},"f:name":{},"f:value":{}},"k:{\"name\":\"RABBITMQ_USE_LONGNAME\"}":{".":{},"f:name":{},"f:value":{}}},"f:image":{},"f:imagePullPolicy":{},"f:lifecycle":{".":{},"f:preStop":{".":{},"f:exec":{".":{},"f:command":{}}}},"f:name":{},"f:ports":{".":{},"k:{\"containerPort\":4369,\"protocol\":\"TCP\"}":{".":{},"f:containerPort":{},"f:name":{},"f:protocol":{}},"k:{\"containerPort\":5672,\"protocol\":\"TCP\"}":{".":{},"f:containerPort":{},"f:name":{},"f:protocol":{}},"k:{\"containerPort\":15672,\"protocol\":\"TCP\"}":{".":{},"f:containerPort":{},"f:name":{},"f:protocol":{}},"k:{\"containerPort\":15692,\"protocol\":\"TCP\"}":{".":{},"f:containerPort":{},"f:name":{},"f:protocol":{}}},"f:readinessProbe":{".":{},"f:failureThreshold":{},"f:initialDelaySeconds":{},"f:periodSeconds":{},"f:successThreshold":{},"f:tcpSocket":{".":{},"f:port":{}},"f:timeoutSeconds":{}},"f:resources":{".":{},"f:limits":{".":{},"f:cpu":{},"f:memory":{}},"f:requests":{".":{},"f:cpu":{},"f:memory":{}}},"f:terminationMessagePath":{},"f:terminationMessagePolicy":{},"f:volumeMounts":{".":{},"k:{\"mountPath\":\"/etc/pod-info/\"}":{".":{},"f:mountPath":{},"f:name":{}},"k:{\"mountPath\":\"/etc/rabbitmq/conf.d/10-operatorDefaults.conf\"}":{".":{},"f:mountPath":{},"f:name":{},"f:subPath":{}},"k:{\"mountPath\":\"/etc/rabbitmq/conf.d/11-default_user.conf\"}":{".":{},"f:mountPath":{},"f:name":{},"f:subPath":{}},"k:{\"mountPath\":\"/etc/rabbitmq/conf.d/90-userDefinedConfiguration.conf\"}":{".":{},"f:mountPath":{},"f:name":{},"f:subPath":{}},"k:{\"mountPath\":\"/operator\"}":{".":{},"f:mountPath":{},"f:name":{}},"k:{\"mountPath\":\"/var/lib/rabbitmq/\"}":{".":{},"f:mountPath":{},"f:name":{}},"k:{\"mountPath\":\"/var/lib/rabbitmq/mnesia/\"}":{".":{},"f:mountPath":{},"f:name":{}}}}},"f:dnsPolicy":{},"f:initContainers":{".":{},"k:{\"name\":\"setup-container\"}":{".":{},"f:command":{},"f:image":{},"f:imagePullPolicy":{},"f:name":{},"f:resources":{".":{},"f:limits":{".":{},"f:cpu":{},"f:memory":{}},"f:requests":{".":{},"f:cpu":{},"f:memory":{}}},"f:securityContext":{".":{},"f:capabilities":{".":{},"f:drop":{}},"f:runAsUser":{}},"f:terminationMessagePath":{},"f:terminationMessagePolicy":{},"f:volumeMounts":{".":{},"k:{\"mountPath\":\"/operator\"}":{".":{},"f:mountPath":{},"f:name":{}},"k:{\"mountPath\":\"/tmp/default_user.conf\"}":{".":{},"f:mountPath":{},"f:name":{},"f:subPath":{}},"k:{\"mountPath\":\"/tmp/erlang-cookie-secret/\"}":{".":{},"f:mountPath":{},"f:name":{}},"k:{\"mountPath\":\"/tmp/rabbitmq-plugins/\"}":{".":{},"f:mountPath":{},"f:name":{}},"k:{\"mountPath\":\"/var/lib/rabbitmq/\"}":{".":{},"f:mountPath":{},"f:name":{}},"k:{\"mountPath\":\"/var/lib/rabbitmq/mnesia/\"}":{".":{},"f:mountPath":{},"f:name":{}}}}},"f:restartPolicy":{},"f:schedulerName":{},"f:securityContext":{".":{},"f:fsGroup":{},"f:runAsGroup":{},"f:runAsUser":{}},"f:serviceAccount":{},"f:serviceAccountName":{},"f:terminationGracePeriodSeconds":{},"f:topologySpreadConstraints":{".":{},"k:{\"topologyKey\":\"topology.kubernetes.io/zone\",\"whenUnsatisfiable\":\"ScheduleAnyway\"}":{".":{},"f:labelSelector":{".":{},"f:matchLabels":{".":{},"f:app.kubernetes.io/name":{}}},"f:maxSkew":{},"f:topologyKey":{},"f:whenUnsatisfiable":{}}},"f:volumes":{".":{},"k:{\"name\":\"erlang-cookie-secret\"}":{".":{},"f:name":{},"f:secret":{".":{},"f:defaultMode":{},"f:secretName":{}}},"k:{\"name\":\"plugins-conf\"}":{".":{},"f:configMap":{".":{},"f:defaultMode":{},"f:name":{}},"f:name":{}},"k:{\"name\":\"pod-info\"}":{".":{},"f:downwardAPI":{".":{},"f:defaultMode":{},"f:items":{}},"f:name":{}},"k:{\"name\":\"rabbitmq-confd\"}":{".":{},"f:name":{},"f:projected":{".":{},"f:defaultMode":{},"f:sources":{}}},"k:{\"name\":\"rabbitmq-erlang-cookie\"}":{".":{},"f:emptyDir":{},"f:name":{}},"k:{\"name\":\"rabbitmq-plugins\"}":{".":{},"f:emptyDir":{},"f:name":{}}}}},"f:updateStrategy":{"f:rollingUpdate":{".":{},"f:partition":{}},"f:type":{}},"f:volumeClaimTemplates":{}}}},{"manager":"kube-controller-manager","operation":"Update","apiVersion":"apps/v1","time":"2022-03-18T18:02:01Z","fieldsType":"FieldsV1","fieldsV1":{"f:status":{"f:collisionCount":{},"f:currentReplicas":{},"f:currentRevision":{},"f:observedGeneration":{},"f:readyReplicas":{},"f:replicas":{},"f:updateRevision":{},"f:updatedReplicas":{}}}}]},"spec":{"replicas":3,"selector":{"matchLabels":{"app.kubernetes.io/name":"rabbitmq-cluster"}},"template":{"metadata":{"creationTimestamp":null,"labels":{"app.kubernetes.io/component":"rabbitmq","app.kubernetes.io/name":"rabbitmq-cluster","app.kubernetes.io/part-of":"rabbitmq"},"annotations":{"prometheus.io/port":"15692","prometheus.io/scrape":"true"}},"spec":{"volumes":[{"name":"plugins-conf","configMap":{"name":"rabbitmq-cluster-plugins-conf","defaultMode":420}},{"name":"rabbitmq-confd","projected":{"sources":[{"secret":{"name":"rabbitmq-cluster-default-user","items":[{"key":"default_user.conf","path":"default_user.conf"}]}},{"configMap":{"name":"rabbitmq-cluster-server-conf","items":[{"key":"operatorDefaults.conf","path":"operatorDefaults.conf"},{"key":"userDefinedConfiguration.conf","path":"userDefinedConfiguration.conf"}]}}],"defaultMode":420}},{"name":"rabbitmq-erlang-cookie","emptyDir":{}},{"name":"erlang-cookie-secret","secret":{"secretName":"rabbitmq-cluster-erlang-cookie","defaultMode":420}},{"name":"rabbitmq-plugins","emptyDir":{}},{"name":"pod-info","downwardAPI":{"items":[{"path":"skipPreStopChecks","fieldRef":{"apiVersion":"v1","fieldPath":"metadata.labels['skipPreStopChecks']"}}],"defaultMode":420}}],"initContainers":[{"name":"setup-container","image":"rabbitmq:3.8.12-management","command":["sh","-c","cp /tmp/erlang-cookie-secret/.erlang.cookie /var/lib/rabbitmq/.erlang.cookie \u0026\u0026 chown 999:999 /var/lib/rabbitmq/.erlang.cookie \u0026\u0026 chmod 600 /var/lib/rabbitmq/.erlang.cookie ; cp /tmp/rabbitmq-plugins/enabled_plugins /operator/enabled_plugins \u0026\u0026 chown 999:999 /operator/enabled_plugins ; chown 999:999 /var/lib/rabbitmq/mnesia/ ; echo '[default]' \u003e /var/lib/rabbitmq/.rabbitmqadmin.conf \u0026\u0026 sed -e 's/default_user/username/' -e 's/default_pass/password/' /tmp/default_user.conf \u003e\u003e /var/lib/rabbitmq/.rabbitmqadmin.conf \u0026\u0026 chown 999:999 /var/lib/rabbitmq/.rabbitmqadmin.conf \u0026\u0026 chmod 600 /var/lib/rabbitmq/.rabbitmqadmin.conf"],"resources":{"limits":{"cpu":"100m","memory":"500Mi"},"requests":{"cpu":"100m","memory":"500Mi"}},"volumeMounts":[{"name":"plugins-conf","mountPath":"/tmp/rabbitmq-plugins/"},{"name":"rabbitmq-erlang-cookie","mountPath":"/var/lib/rabbitmq/"},{"name":"erlang-cookie-secret","mountPath":"/tmp/erlang-cookie-secret/"},{"name":"rabbitmq-plugins","mountPath":"/operator"},{"name":"persistence","mountPath":"/var/lib/rabbitmq/mnesia/"},{"name":"rabbitmq-confd","mountPath":"/tmp/default_user.conf","subPath":"default_user.conf"}],"terminationMessagePath":"/dev/termination-log","terminationMessagePolicy":"File","imagePullPolicy":"IfNotPresent","securityContext":{"capabilities":{"drop":["FSETID","KILL","SETGID","SETUID","SETPCAP","NET_BIND_SERVICE","NET_RAW","SYS_CHROOT","MKNOD","AUDIT_WRITE","SETFCAP"]},"runAsUser":0}}],"containers":[{"name":"rabbitmq","image":"rabbitmq:3.8.12-management","ports":[{"name":"epmd","containerPort":4369,"protocol":"TCP"},{"name":"amqp","containerPort":5672,"protocol":"TCP"},{"name":"management","containerPort":15672,"protocol":"TCP"},{"name":"prometheus","containerPort":15692,"protocol":"TCP"}],"env":[{"name":"MY_POD_NAME","valueFrom":{"fieldRef":{"apiVersion":"v1","fieldPath":"metadata.name"}}},{"name":"MY_POD_NAMESPACE","valueFrom":{"fieldRef":{"apiVersion":"v1","fieldPath":"metadata.namespace"}}},{"name":"RABBITMQ_ENABLED_PLUGINS_FILE","value":"/operator/enabled_plugins"},{"name":"K8S_SERVICE_NAME","value":"rabbitmq-cluster-nodes"},{"name":"RABBITMQ_USE_LONGNAME","value":"true"},{"name":"RABBITMQ_NODENAME","value":"rabbit@$(MY_POD_NAME).$(K8S_SERVICE_NAME).$(MY_POD_NAMESPACE)"},{"name":"K8S_HOSTNAME_SUFFIX","value":".$(K8S_SERVICE_NAME).$(MY_POD_NAMESPACE)"}],"resources":{"limits":{"cpu":"2","memory":"2Gi"},"requests":{"cpu":"1","memory":"2Gi"}},"volumeMounts":[{"name":"rabbitmq-erlang-cookie","mountPath":"/var/lib/rabbitmq/"},{"name":"persistence","mountPath":"/var/lib/rabbitmq/mnesia/"},{"name":"rabbitmq-plugins","mountPath":"/operator"},{"name":"rabbitmq-confd","mountPath":"/etc/rabbitmq/conf.d/10-operatorDefaults.conf","subPath":"operatorDefaults.conf"},{"name":"rabbitmq-confd","mountPath":"/etc/rabbitmq/conf.d/11-default_user.conf","subPath":"default_user.conf"},{"name":"rabbitmq-confd","mountPath":"/etc/rabbitmq/conf.d/90-userDefinedConfiguration.conf","subPath":"userDefinedConfiguration.conf"},{"name":"pod-info","mountPath":"/etc/pod-info/"}],"readinessProbe":{"tcpSocket":{"port":"amqp"},"initialDelaySeconds":10,"timeoutSeconds":5,"periodSeconds":10,"successThreshold":1,"failureThreshold":3},"lifecycle":{"preStop":{"exec":{"command":["/bin/bash","-c","if [ ! -z \"$(cat /etc/pod-info/skipPreStopChecks)\" ]; then exit 0; fi; rabbitmq-upgrade await_online_quorum_plus_one -t 604800; rabbitmq-upgrade await_online_synchronized_mirror -t 604800; rabbitmq-upgrade drain -t 604800"]}}},"terminationMessagePath":"/dev/termination-log","terminationMessagePolicy":"File","imagePullPolicy":"IfNotPresent"}],"restartPolicy":"Always","terminationGracePeriodSeconds":604800,"dnsPolicy":"ClusterFirst","serviceAccountName":"rabbitmq-cluster-server","serviceAccount":"rabbitmq-cluster-server","automountServiceAccountToken":true,"securityContext":{"runAsUser":999,"runAsGroup":999,"fsGroup":999},"schedulerName":"default-scheduler","topologySpreadConstraints":[{"maxSkew":1,"topologyKey":"topology.kubernetes.io/zone","whenUnsatisfiable":"ScheduleAnyway","labelSelector":{"matchLabels":{"app.kubernetes.io/name":"rabbitmq-cluster"}}}]}},"volumeClaimTemplates":[{"metadata":{"name":"persistence","namespace":"default","creationTimestamp":null,"labels":{"app.kubernetes.io/component":"rabbitmq","app.kubernetes.io/name":"rabbitmq-cluster","app.kubernetes.io/part-of":"rabbitmq"},"ownerReferences":[{"apiVersion":"rabbitmq.com/v1beta1","kind":"RabbitmqCluster","name":"rabbitmq-cluster","uid":"18d9928b-0d1c-47be-80ec-20960d053827","controller":true,"blockOwnerDeletion":false}]},"spec":{"accessModes":["ReadWriteOnce"],"resources":{"requests":{"storage":"10Gi"}},"volumeMode":"Filesystem"},"status":{"phase":"Pending"}}],"serviceName":"rabbitmq-cluster-nodes","podManagementPolicy":"Parallel","updateStrategy":{"type":"RollingUpdate","rollingUpdate":{"partition":0}},"revisionHistoryLimit":10},"status":{"observedGeneration":2,"replicas":3,"readyReplicas":3,"currentReplicas":3,"updatedReplicas":3,"currentRevision":"rabbitmq-cluster-server-5f8b8665fb","updateRevision":"rabbitmq-cluster-server-5f8b8665fb","collisionCount":0}}
2022/03/18 18:02:09 learn_server.go:291: [SIEVE-AFTER-READ]	Get	true	endpoints	default	rabbitmq-cluster	github.com/rabbitmq/cluster-operator/controllers.(*RabbitmqClusterReconciler)	NoError	{"kind":"Endpoints","apiVersion":"v1","metadata":{"name":"rabbitmq-cluster","namespace":"default","selfLink":"/api/v1/namespaces/default/endpoints/rabbitmq-cluster","uid":"5c4723ad-f4fe-442d-9135-44879a2a8183","resourceVersion":"1227","creationTimestamp":"2022-03-18T18:00:38Z","labels":{"app.kubernetes.io/component":"rabbitmq","app.kubernetes.io/name":"rabbitmq-cluster","app.kubernetes.io/part-of":"rabbitmq"},"annotations":{"endpoints.kubernetes.io/last-change-trigger-time":"2022-03-18T18:02:01Z"},"managedFields":[{"manager":"kube-controller-manager","operation":"Update","apiVersion":"v1","time":"2022-03-18T18:02:01Z","fieldsType":"FieldsV1","fieldsV1":{"f:metadata":{"f:annotations":{".":{},"f:endpoints.kubernetes.io/last-change-trigger-time":{}},"f:labels":{".":{},"f:app.kubernetes.io/component":{},"f:app.kubernetes.io/name":{},"f:app.kubernetes.io/part-of":{}}},"f:subsets":{}}}]},"subsets":[{"addresses":[{"ip":"10.244.1.4","nodeName":"kind-worker2","targetRef":{"kind":"Pod","namespace":"default","name":"rabbitmq-cluster-server-0","uid":"e7faffc5-b656-4e69-9777-92d12cb6ec5a","resourceVersion":"938"}},{"ip":"10.244.2.4","nodeName":"kind-worker","targetRef":{"kind":"Pod","namespace":"default","name":"rabbitmq-cluster-server-1","uid":"7a37da00-25d1-48b6-a659-4390fb7a02cb","resourceVersion":"1226"}},{"ip":"10.244.2.5","nodeName":"kind-worker","targetRef":{"kind":"Pod","namespace":"default","name":"rabbitmq-cluster-server-2","uid":"2a54a659-a979-4e10-8e74-1e0b83d532ba","resourceVersion":"1209"}}],"ports":[{"name":"amqp","port":5672,"protocol":"TCP"},{"name":"management","port":15672,"protocol":"TCP"}]}]}
2022/03/18 18:02:09 learn_server.go:291: [SIEVE-AFTER-READ]	Get	true	statefulset	default	rabbitmq-cluster-server	github.com/rabbitmq/cluster-operator/controllers.(*RabbitmqClusterReconciler)	NoError	{"kind":"StatefulSet","apiVersion":"apps/v1","metadata":{"name":"rabbitmq-cluster-server","namespace":"default","selfLink":"/apis/apps/v1/namespaces/default/statefulsets/rabbitmq-cluster-server","uid":"cb5c43bc-6ee7-481c-ab01-6f3acffdd3c8","resourceVersion":"1231","generation":2,"creationTimestamp":"2022-03-18T18:00:38Z","labels":{"app.kubernetes.io/component":"rabbitmq","app.kubernetes.io/name":"rabbitmq-cluster","app.kubernetes.io/part-of":"rabbitmq"},"ownerReferences":[{"apiVersion":"rabbitmq.com/v1beta1","kind":"RabbitmqCluster","name":"rabbitmq-cluster","uid":"18d9928b-0d1c-47be-80ec-20960d053827","controller":true,"blockOwnerDeletion":true}],"managedFields":[{"manager":"manager","operation":"Update","apiVersion":"apps/v1","time":"2022-03-18T18:01:23Z","fieldsType":"FieldsV1","fieldsV1":{"f:metadata":{"f:labels":{".":{},"f:app.kubernetes.io/component":{},"f:app.kubernetes.io/name":{},"f:app.kubernetes.io/part-of":{}},"f:ownerReferences":{".":{},"k:{\"uid\":\"18d9928b-0d1c-47be-80ec-20960d053827\"}":{".":{},"f:apiVersion":{},"f:blockOwnerDeletion":{},"f:controller":{},"f:kind":{},"f:name":{},"f:uid":{}}}},"f:spec":{"f:podManagementPolicy":{},"f:replicas":{},"f:revisionHistoryLimit":{},"f:selector":{"f:matchLabels":{".":{},"f:app.kubernetes.io/name":{}}},"f:serviceName":{},"f:template":{"f:metadata":{"f:annotations":{".":{},"f:prometheus.io/port":{},"f:prometheus.io/scrape":{}},"f:labels":{".":{},"f:app.kubernetes.io/component":{},"f:app.kubernetes.io/name":{},"f:app.kubernetes.io/part-of":{}}},"f:spec":{"f:automountServiceAccountToken":{},"f:containers":{"k:{\"name\":\"rabbitmq\"}":{".":{},"f:env":{".":{},"k:{\"name\":\"K8S_HOSTNAME_SUFFIX\"}":{".":{},"f:name":{},"f:value":{}},"k:{\"name\":\"K8S_SERVICE_NAME\"}":{".":{},"f:name":{},"f:value":{}},"k:{\"name\":\"MY_POD_NAME\"}":{".":{},"f:name":{},"f:valueFrom":{".":{},"f:fieldRef":{".":{},"f:apiVersion":{},"f:fieldPath":{}}}},"k:{\"name\":\"MY_POD_NAMESPACE\"}":{".":{},"f:name":{},"f:valueFrom":{".":{},"f:fieldRef":{".":{},"f:apiVersion":{},"f:fieldPath":{}}}},"k:{\"name\":\"RABBITMQ_ENABLED_PLUGINS_FILE\"}":{".":{},"f:name":{},"f:value":{}},"k:{\"name\":\"RABBITMQ_NODENAME\"}":{".":{},"f:name":{},"f:value":{}},"k:{\"name\":\"RABBITMQ_USE_LONGNAME\"}":{".":{},"f:name":{},"f:value":{}}},"f:image":{},"f:imagePullPolicy":{},"f:lifecycle":{".":{},"f:preStop":{".":{},"f:exec":{".":{},"f:command":{}}}},"f:name":{},"f:ports":{".":{},"k:{\"containerPort\":4369,\"protocol\":\"TCP\"}":{".":{},"f:containerPort":{},"f:name":{},"f:protocol":{}},"k:{\"containerPort\":5672,\"protocol\":\"TCP\"}":{".":{},"f:containerPort":{},"f:name":{},"f:protocol":{}},"k:{\"containerPort\":15672,\"protocol\":\"TCP\"}":{".":{},"f:containerPort":{},"f:name":{},"f:protocol":{}},"k:{\"containerPort\":15692,\"protocol\":\"TCP\"}":{".":{},"f:containerPort":{},"f:name":{},"f:protocol":{}}},"f:readinessProbe":{".":{},"f:failureThreshold":{},"f:initialDelaySeconds":{},"f:periodSeconds":{},"f:successThreshold":{},"f:tcpSocket":{".":{},"f:port":{}},"f:timeoutSeconds":{}},"f:resources":{".":{},"f:limits":{".":{},"f:cpu":{},"f:memory":{}},"f:requests":{".":{},"f:cpu":{},"f:memory":{}}},"f:terminationMessagePath":{},"f:terminationMessagePolicy":{},"f:volumeMounts":{".":{},"k:{\"mountPath\":\"/etc/pod-info/\"}":{".":{},"f:mountPath":{},"f:name":{}},"k:{\"mountPath\":\"/etc/rabbitmq/conf.d/10-operatorDefaults.conf\"}":{".":{},"f:mountPath":{},"f:name":{},"f:subPath":{}},"k:{\"mountPath\":\"/etc/rabbitmq/conf.d/11-default_user.conf\"}":{".":{},"f:mountPath":{},"f:name":{},"f:subPath":{}},"k:{\"mountPath\":\"/etc/rabbitmq/conf.d/90-userDefinedConfiguration.conf\"}":{".":{},"f:mountPath":{},"f:name":{},"f:subPath":{}},"k:{\"mountPath\":\"/operator\"}":{".":{},"f:mountPath":{},"f:name":{}},"k:{\"mountPath\":\"/var/lib/rabbitmq/\"}":{".":{},"f:mountPath":{},"f:name":{}},"k:{\"mountPath\":\"/var/lib/rabbitmq/mnesia/\"}":{".":{},"f:mountPath":{},"f:name":{}}}}},"f:dnsPolicy":{},"f:initContainers":{".":{},"k:{\"name\":\"setup-container\"}":{".":{},"f:command":{},"f:image":{},"f:imagePullPolicy":{},"f:name":{},"f:resources":{".":{},"f:limits":{".":{},"f:cpu":{},"f:memory":{}},"f:requests":{".":{},"f:cpu":{},"f:memory":{}}},"f:securityContext":{".":{},"f:capabilities":{".":{},"f:drop":{}},"f:runAsUser":{}},"f:terminationMessagePath":{},"f:terminationMessagePolicy":{},"f:volumeMounts":{".":{},"k:{\"mountPath\":\"/operator\"}":{".":{},"f:mountPath":{},"f:name":{}},"k:{\"mountPath\":\"/tmp/default_user.conf\"}":{".":{},"f:mountPath":{},"f:name":{},"f:subPath":{}},"k:{\"mountPath\":\"/tmp/erlang-cookie-secret/\"}":{".":{},"f:mountPath":{},"f:name":{}},"k:{\"mountPath\":\"/tmp/rabbitmq-plugins/\"}":{".":{},"f:mountPath":{},"f:name":{}},"k:{\"mountPath\":\"/var/lib/rabbitmq/\"}":{".":{},"f:mountPath":{},"f:name":{}},"k:{\"mountPath\":\"/var/lib/rabbitmq/mnesia/\"}":{".":{},"f:mountPath":{},"f:name":{}}}}},"f:restartPolicy":{},"f:schedulerName":{},"f:securityContext":{".":{},"f:fsGroup":{},"f:runAsGroup":{},"f:runAsUser":{}},"f:serviceAccount":{},"f:serviceAccountName":{},"f:terminationGracePeriodSeconds":{},"f:topologySpreadConstraints":{".":{},"k:{\"topologyKey\":\"topology.kubernetes.io/zone\",\"whenUnsatisfiable\":\"ScheduleAnyway\"}":{".":{},"f:labelSelector":{".":{},"f:matchLabels":{".":{},"f:app.kubernetes.io/name":{}}},"f:maxSkew":{},"f:topologyKey":{},"f:whenUnsatisfiable":{}}},"f:volumes":{".":{},"k:{\"name\":\"erlang-cookie-secret\"}":{".":{},"f:name":{},"f:secret":{".":{},"f:defaultMode":{},"f:secretName":{}}},"k:{\"name\":\"plugins-conf\"}":{".":{},"f:configMap":{".":{},"f:defaultMode":{},"f:name":{}},"f:name":{}},"k:{\"name\":\"pod-info\"}":{".":{},"f:downwardAPI":{".":{},"f:defaultMode":{},"f:items":{}},"f:name":{}},"k:{\"name\":\"rabbitmq-confd\"}":{".":{},"f:name":{},"f:projected":{".":{},"f:defaultMode":{},"f:sources":{}}},"k:{\"name\":\"rabbitmq-erlang-cookie\"}":{".":{},"f:emptyDir":{},"f:name":{}},"k:{\"name\":\"rabbitmq-plugins\"}":{".":{},"f:emptyDir":{},"f:name":{}}}}},"f:updateStrategy":{"f:rollingUpdate":{".":{},"f:partition":{}},"f:type":{}},"f:volumeClaimTemplates":{}}}},{"manager":"kube-controller-manager","operation":"Update","apiVersion":"apps/v1","time":"2022-03-18T18:02:01Z","fieldsType":"FieldsV1","fieldsV1":{"f:status":{"f:collisionCount":{},"f:currentReplicas":{},"f:currentRevision":{},"f:observedGeneration":{},"f:readyReplicas":{},"f:replicas":{},"f:updateRevision":{},"f:updatedReplicas":{}}}}]},"spec":{"replicas":3,"selector":{"matchLabels":{"app.kubernetes.io/name":"rabbitmq-cluster"}},"template":{"metadata":{"creationTimestamp":null,"labels":{"app.kubernetes.io/component":"rabbitmq","app.kubernetes.io/name":"rabbitmq-cluster","app.kubernetes.io/part-of":"rabbitmq"},"annotations":{"prometheus.io/port":"15692","prometheus.io/scrape":"true"}},"spec":{"volumes":[{"name":"plugins-conf","configMap":{"name":"rabbitmq-cluster-plugins-conf","defaultMode":420}},{"name":"rabbitmq-confd","projected":{"sources":[{"secret":{"name":"rabbitmq-cluster-default-user","items":[{"key":"default_user.conf","path":"default_user.conf"}]}},{"configMap":{"name":"rabbitmq-cluster-server-conf","items":[{"key":"operatorDefaults.conf","path":"operatorDefaults.conf"},{"key":"userDefinedConfiguration.conf","path":"userDefinedConfiguration.conf"}]}}],"defaultMode":420}},{"name":"rabbitmq-erlang-cookie","emptyDir":{}},{"name":"erlang-cookie-secret","secret":{"secretName":"rabbitmq-cluster-erlang-cookie","defaultMode":420}},{"name":"rabbitmq-plugins","emptyDir":{}},{"name":"pod-info","downwardAPI":{"items":[{"path":"skipPreStopChecks","fieldRef":{"apiVersion":"v1","fieldPath":"metadata.labels['skipPreStopChecks']"}}],"defaultMode":420}}],"initContainers":[{"name":"setup-container","image":"rabbitmq:3.8.12-management","command":["sh","-c","cp /tmp/erlang-cookie-secret/.erlang.cookie /var/lib/rabbitmq/.erlang.cookie \u0026\u0026 chown 999:999 /var/lib/rabbitmq/.erlang.cookie \u0026\u0026 chmod 600 /var/lib/rabbitmq/.erlang.cookie ; cp /tmp/rabbitmq-plugins/enabled_plugins /operator/enabled_plugins \u0026\u0026 chown 999:999 /operator/enabled_plugins ; chown 999:999 /var/lib/rabbitmq/mnesia/ ; echo '[default]' \u003e /var/lib/rabbitmq/.rabbitmqadmin.conf \u0026\u0026 sed -e 's/default_user/username/' -e 's/default_pass/password/' /tmp/default_user.conf \u003e\u003e /var/lib/rabbitmq/.rabbitmqadmin.conf \u0026\u0026 chown 999:999 /var/lib/rabbitmq/.rabbitmqadmin.conf \u0026\u0026 chmod 600 /var/lib/rabbitmq/.rabbitmqadmin.conf"],"resources":{"limits":{"cpu":"100m","memory":"500Mi"},"requests":{"cpu":"100m","memory":"500Mi"}},"volumeMounts":[{"name":"plugins-conf","mountPath":"/tmp/rabbitmq-plugins/"},{"name":"rabbitmq-erlang-cookie","mountPath":"/var/lib/rabbitmq/"},{"name":"erlang-cookie-secret","mountPath":"/tmp/erlang-cookie-secret/"},{"name":"rabbitmq-plugins","mountPath":"/operator"},{"name":"persistence","mountPath":"/var/lib/rabbitmq/mnesia/"},{"name":"rabbitmq-confd","mountPath":"/tmp/default_user.conf","subPath":"default_user.conf"}],"terminationMessagePath":"/dev/termination-log","terminationMessagePolicy":"File","imagePullPolicy":"IfNotPresent","securityContext":{"capabilities":{"drop":["FSETID","KILL","SETGID","SETUID","SETPCAP","NET_BIND_SERVICE","NET_RAW","SYS_CHROOT","MKNOD","AUDIT_WRITE","SETFCAP"]},"runAsUser":0}}],"containers":[{"name":"rabbitmq","image":"rabbitmq:3.8.12-management","ports":[{"name":"epmd","containerPort":4369,"protocol":"TCP"},{"name":"amqp","containerPort":5672,"protocol":"TCP"},{"name":"management","containerPort":15672,"protocol":"TCP"},{"name":"prometheus","containerPort":15692,"protocol":"TCP"}],"env":[{"name":"MY_POD_NAME","valueFrom":{"fieldRef":{"apiVersion":"v1","fieldPath":"metadata.name"}}},{"name":"MY_POD_NAMESPACE","valueFrom":{"fieldRef":{"apiVersion":"v1","fieldPath":"metadata.namespace"}}},{"name":"RABBITMQ_ENABLED_PLUGINS_FILE","value":"/operator/enabled_plugins"},{"name":"K8S_SERVICE_NAME","value":"rabbitmq-cluster-nodes"},{"name":"RABBITMQ_USE_LONGNAME","value":"true"},{"name":"RABBITMQ_NODENAME","value":"rabbit@$(MY_POD_NAME).$(K8S_SERVICE_NAME).$(MY_POD_NAMESPACE)"},{"name":"K8S_HOSTNAME_SUFFIX","value":".$(K8S_SERVICE_NAME).$(MY_POD_NAMESPACE)"}],"resources":{"limits":{"cpu":"2","memory":"2Gi"},"requests":{"cpu":"1","memory":"2Gi"}},"volumeMounts":[{"name":"rabbitmq-erlang-cookie","mountPath":"/var/lib/rabbitmq/"},{"name":"persistence","mountPath":"/var/lib/rabbitmq/mnesia/"},{"name":"rabbitmq-plugins","mountPath":"/operator"},{"name":"rabbitmq-confd","mountPath":"/etc/rabbitmq/conf.d/10-operatorDefaults.conf","subPath":"operatorDefaults.conf"},{"name":"rabbitmq-confd","mountPath":"/etc/rabbitmq/conf.d/11-default_user.conf","subPath":"default_user.conf"},{"name":"rabbitmq-confd","mountPath":"/etc/rabbitmq/conf.d/90-userDefinedConfiguration.conf","subPath":"userDefinedConfiguration.conf"},{"name":"pod-info","mountPath":"/etc/pod-info/"}],"readinessProbe":{"tcpSocket":{"port":"amqp"},"initialDelaySeconds":10,"timeoutSeconds":5,"periodSeconds":10,"successThreshold":1,"failureThreshold":3},"lifecycle":{"preStop":{"exec":{"command":["/bin/bash","-c","if [ ! -z \"$(cat /etc/pod-info/skipPreStopChecks)\" ]; then exit 0; fi; rabbitmq-upgrade await_online_quorum_plus_one -t 604800; rabbitmq-upgrade await_online_synchronized_mirror -t 604800; rabbitmq-upgrade drain -t 604800"]}}},"terminationMessagePath":"/dev/termination-log","terminationMessagePolicy":"File","imagePullPolicy":"IfNotPresent"}],"restartPolicy":"Always","terminationGracePeriodSeconds":604800,"dnsPolicy":"ClusterFirst","serviceAccountName":"rabbitmq-cluster-server","serviceAccount":"rabbitmq-cluster-server","automountServiceAccountToken":true,"securityContext":{"runAsUser":999,"runAsGroup":999,"fsGroup":999},"schedulerName":"default-scheduler","topologySpreadConstraints":[{"maxSkew":1,"topologyKey":"topology.kubernetes.io/zone","whenUnsatisfiable":"ScheduleAnyway","labelSelector":{"matchLabels":{"app.kubernetes.io/name":"rabbitmq-cluster"}}}]}},"volumeClaimTemplates":[{"metadata":{"name":"persistence","namespace":"default","creationTimestamp":null,"labels":{"app.kubernetes.io/component":"rabbitmq","app.kubernetes.io/name":"rabbitmq-cluster","app.kubernetes.io/part-of":"rabbitmq"},"ownerReferences":[{"apiVersion":"rabbitmq.com/v1beta1","kind":"RabbitmqCluster","name":"rabbitmq-cluster","uid":"18d9928b-0d1c-47be-80ec-20960d053827","controller":true,"blockOwnerDeletion":false}]},"spec":{"accessModes":["ReadWriteOnce"],"resources":{"requests":{"storage":"10Gi"}},"volumeMode":"Filesystem"},"status":{"phase":"Pending"}}],"serviceName":"rabbitmq-cluster-nodes","podManagementPolicy":"Parallel","updateStrategy":{"type":"RollingUpdate","rollingUpdate":{"partition":0}},"revisionHistoryLimit":10},"status":{"observedGeneration":2,"replicas":3,"readyReplicas":3,"currentReplicas":3,"updatedReplicas":3,"currentRevision":"rabbitmq-cluster-server-5f8b8665fb","updateRevision":"rabbitmq-cluster-server-5f8b8665fb","collisionCount":0}}
2022/03/18 18:02:09 learn_server.go:291: [SIEVE-AFTER-READ]	Get	true	service	default	rabbitmq-cluster-nodes	github.com/rabbitmq/cluster-operator/controllers.(*RabbitmqClusterReconciler)	NoError	{"kind":"Service","apiVersion":"v1","metadata":{"name":"rabbitmq-cluster-nodes","namespace":"default","selfLink":"/api/v1/namespaces/default/services/rabbitmq-cluster-nodes","uid":"67c7eea9-1b87-4fd7-82e6-5bfe31fd1b52","resourceVersion":"696","creationTimestamp":"2022-03-18T18:00:38Z","labels":{"app.kubernetes.io/component":"rabbitmq","app.kubernetes.io/name":"rabbitmq-cluster","app.kubernetes.io/part-of":"rabbitmq"},"ownerReferences":[{"apiVersion":"rabbitmq.com/v1beta1","kind":"RabbitmqCluster","name":"rabbitmq-cluster","uid":"18d9928b-0d1c-47be-80ec-20960d053827","controller":true,"blockOwnerDeletion":true}],"managedFields":[{"manager":"manager","operation":"Update","apiVersion":"v1","time":"2022-03-18T18:00:38Z","fieldsType":"FieldsV1","fieldsV1":{"f:metadata":{"f:labels":{".":{},"f:app.kubernetes.io/component":{},"f:app.kubernetes.io/name":{},"f:app.kubernetes.io/part-of":{}},"f:ownerReferences":{".":{},"k:{\"uid\":\"18d9928b-0d1c-47be-80ec-20960d053827\"}":{".":{},"f:apiVersion":{},"f:blockOwnerDeletion":{},"f:controller":{},"f:kind":{},"f:name":{},"f:uid":{}}}},"f:spec":{"f:clusterIP":{},"f:ports":{".":{},"k:{\"port\":4369,\"protocol\":\"TCP\"}":{".":{},"f:name":{},"f:port":{},"f:protocol":{},"f:targetPort":{}},"k:{\"port\":25672,\"protocol\":\"TCP\"}":{".":{},"f:name":{},"f:port":{},"f:protocol":{},"f:targetPort":{}}},"f:publishNotReadyAddresses":{},"f:selector":{".":{},"f:app.kubernetes.io/name":{}},"f:sessionAffinity":{},"f:type":{}}}}]},"spec":{"ports":[{"name":"epmd","protocol":"TCP","port":4369,"targetPort":4369},{"name":"cluster-rpc","protocol":"TCP","port":25672,"targetPort":25672}],"selector":{"app.kubernetes.io/name":"rabbitmq-cluster"},"clusterIP":"None","type":"ClusterIP","sessionAffinity":"None","publishNotReadyAddresses":true},"status":{"loadBalancer":{}}}
2022/03/18 18:02:09 learn_server.go:291: [SIEVE-AFTER-READ]	Get	true	service	default	rabbitmq-cluster	github.com/rabbitmq/cluster-operator/controllers.(*RabbitmqClusterReconciler)	NoError	{"kind":"Service","apiVersion":"v1","metadata":{"name":"rabbitmq-cluster","namespace":"default","selfLink":"/api/v1/namespaces/default/services/rabbitmq-cluster","uid":"56b50671-1945-458b-adac-05619b783392","resourceVersion":"701","creationTimestamp":"2022-03-18T18:00:38Z","labels":{"app.kubernetes.io/component":"rabbitmq","app.kubernetes.io/name":"rabbitmq-cluster","app.kubernetes.io/part-of":"rabbitmq"},"ownerReferences":[{"apiVersion":"rabbitmq.com/v1beta1","kind":"RabbitmqCluster","name":"rabbitmq-cluster","uid":"18d9928b-0d1c-47be-80ec-20960d053827","controller":true,"blockOwnerDeletion":true}],"managedFields":[{"manager":"manager","operation":"Update","apiVersion":"v1","time":"2022-03-18T18:00:38Z","fieldsType":"FieldsV1","fieldsV1":{"f:metadata":{"f:labels":{".":{},"f:app.kubernetes.io/component":{},"f:app.kubernetes.io/name":{},"f:app.kubernetes.io/part-of":{}},"f:ownerReferences":{".":{},"k:{\"uid\":\"18d9928b-0d1c-47be-80ec-20960d053827\"}":{".":{},"f:apiVersion":{},"f:blockOwnerDeletion":{},"f:controller":{},"f:kind":{},"f:name":{},"f:uid":{}}}},"f:spec":{"f:ports":{".":{},"k:{\"port\":5672,\"protocol\":\"TCP\"}":{".":{},"f:name":{},"f:port":{},"f:protocol":{},"f:targetPort":{}},"k:{\"port\":15672,\"protocol\":\"TCP\"}":{".":{},"f:name":{},"f:port":{},"f:protocol":{},"f:targetPort":{}}},"f:selector":{".":{},"f:app.kubernetes.io/name":{}},"f:sessionAffinity":{},"f:type":{}}}}]},"spec":{"ports":[{"name":"amqp","protocol":"TCP","port":5672,"targetPort":5672},{"name":"management","protocol":"TCP","port":15672,"targetPort":15672}],"selector":{"app.kubernetes.io/name":"rabbitmq-cluster"},"clusterIP":"10.96.254.158","type":"ClusterIP","sessionAffinity":"None"},"status":{"loadBalancer":{}}}
2022/03/18 18:02:09 learn_server.go:291: [SIEVE-AFTER-READ]	Get	true	secret	default	rabbitmq-cluster-erlang-cookie	github.com/rabbitmq/cluster-operator/controllers.(*RabbitmqClusterReconciler)	NoError	{"kind":"Secret","apiVersion":"v1","metadata":{"name":"rabbitmq-cluster-erlang-cookie","namespace":"default","selfLink":"/api/v1/namespaces/default/secrets/rabbitmq-cluster-erlang-cookie","uid":"f8fbe8a6-0f40-4e13-960b-ab78b8ba75b0","resourceVersion":"705","creationTimestamp":"2022-03-18T18:00:38Z","labels":{"app.kubernetes.io/component":"rabbitmq","app.kubernetes.io/name":"rabbitmq-cluster","app.kubernetes.io/part-of":"rabbitmq"},"ownerReferences":[{"apiVersion":"rabbitmq.com/v1beta1","kind":"RabbitmqCluster","name":"rabbitmq-cluster","uid":"18d9928b-0d1c-47be-80ec-20960d053827","controller":true,"blockOwnerDeletion":true}],"managedFields":[{"manager":"manager","operation":"Update","apiVersion":"v1","time":"2022-03-18T18:00:38Z","fieldsType":"FieldsV1","fieldsV1":{"f:data":{".":{},"f:.erlang.cookie":{}},"f:metadata":{"f:labels":{".":{},"f:app.kubernetes.io/component":{},"f:app.kubernetes.io/name":{},"f:app.kubernetes.io/part-of":{}},"f:ownerReferences":{".":{},"k:{\"uid\":\"18d9928b-0d1c-47be-80ec-20960d053827\"}":{".":{},"f:apiVersion":{},"f:blockOwnerDeletion":{},"f:controller":{},"f:kind":{},"f:name":{},"f:uid":{}}}},"f:type":{}}}]},"data":{".erlang.cookie":"QW9hMkpWU0tlYS1FUGdWTUhrelNMNnFoMFZ0ZmRGNUY="},"type":"Opaque"}
2022/03/18 18:02:09 learn_server.go:291: [SIEVE-AFTER-READ]	Get	true	secret	default	rabbitmq-cluster-default-user	github.com/rabbitmq/cluster-operator/controllers.(*RabbitmqClusterReconciler)	NoError	{"kind":"Secret","apiVersion":"v1","metadata":{"name":"rabbitmq-cluster-default-user","namespace":"default","selfLink":"/api/v1/namespaces/default/secrets/rabbitmq-cluster-default-user","uid":"0d9f460b-a23c-402b-8273-f541ed39023f","resourceVersion":"708","creationTimestamp":"2022-03-18T18:00:38Z","labels":{"app.kubernetes.io/component":"rabbitmq","app.kubernetes.io/name":"rabbitmq-cluster","app.kubernetes.io/part-of":"rabbitmq"},"ownerReferences":[{"apiVersion":"rabbitmq.com/v1beta1","kind":"RabbitmqCluster","name":"rabbitmq-cluster","uid":"18d9928b-0d1c-47be-80ec-20960d053827","controller":true,"blockOwnerDeletion":true}],"managedFields":[{"manager":"manager","operation":"Update","apiVersion":"v1","time":"2022-03-18T18:00:38Z","fieldsType":"FieldsV1","fieldsV1":{"f:data":{".":{},"f:default_user.conf":{},"f:password":{},"f:provider":{},"f:type":{},"f:username":{}},"f:metadata":{"f:labels":{".":{},"f:app.kubernetes.io/component":{},"f:app.kubernetes.io/name":{},"f:app.kubernetes.io/part-of":{}},"f:ownerReferences":{".":{},"k:{\"uid\":\"18d9928b-0d1c-47be-80ec-20960d053827\"}":{".":{},"f:apiVersion":{},"f:blockOwnerDeletion":{},"f:controller":{},"f:kind":{},"f:name":{},"f:uid":{}}}},"f:type":{}}}]},"data":{"default_user.conf":"ZGVmYXVsdF91c2VyID0gcTMxRmh3MGtjWW9SZUl5X3BPTXp2ZVBOUnNVU3I1Mk8KZGVmYXVsdF9wYXNzID0gY0dBX19jNTJHX05hVURpTGhraWZ6UDBOVVlNLTE2MWQK","password":"Y0dBX19jNTJHX05hVURpTGhraWZ6UDBOVVlNLTE2MWQ=","provider":"cmFiYml0bXE=","type":"cmFiYml0bXE=","username":"cTMxRmh3MGtjWW9SZUl5X3BPTXp2ZVBOUnNVU3I1Mk8="},"type":"Opaque"}
2022/03/18 18:02:09 learn_server.go:291: [SIEVE-AFTER-READ]	Get	true	configmap	default	rabbitmq-cluster-plugins-conf	github.com/rabbitmq/cluster-operator/controllers.(*RabbitmqClusterReconciler)	NoError	{"kind":"ConfigMap","apiVersion":"v1","metadata":{"name":"rabbitmq-cluster-plugins-conf","namespace":"default","selfLink":"/api/v1/namespaces/default/configmaps/rabbitmq-cluster-plugins-conf","uid":"a164075b-0562-47ac-a577-99aa8651ec40","resourceVersion":"709","creationTimestamp":"2022-03-18T18:00:38Z","labels":{"app.kubernetes.io/component":"rabbitmq","app.kubernetes.io/name":"rabbitmq-cluster","app.kubernetes.io/part-of":"rabbitmq"},"ownerReferences":[{"apiVersion":"rabbitmq.com/v1beta1","kind":"RabbitmqCluster","name":"rabbitmq-cluster","uid":"18d9928b-0d1c-47be-80ec-20960d053827","controller":true,"blockOwnerDeletion":true}],"managedFields":[{"manager":"manager","operation":"Update","apiVersion":"v1","time":"2022-03-18T18:00:38Z","fieldsType":"FieldsV1","fieldsV1":{"f:data":{".":{},"f:enabled_plugins":{}},"f:metadata":{"f:labels":{".":{},"f:app.kubernetes.io/component":{},"f:app.kubernetes.io/name":{},"f:app.kubernetes.io/part-of":{}},"f:ownerReferences":{".":{},"k:{\"uid\":\"18d9928b-0d1c-47be-80ec-20960d053827\"}":{".":{},"f:apiVersion":{},"f:blockOwnerDeletion":{},"f:controller":{},"f:kind":{},"f:name":{},"f:uid":{}}}}}}]},"data":{"enabled_plugins":"[rabbitmq_peer_discovery_k8s,rabbitmq_prometheus,rabbitmq_management]."}}
2022/03/18 18:02:09 learn_server.go:291: [SIEVE-AFTER-READ]	Get	true	configmap	default	rabbitmq-cluster-server-conf	github.com/rabbitmq/cluster-operator/controllers.(*RabbitmqClusterReconciler)	NoError	{"kind":"ConfigMap","apiVersion":"v1","metadata":{"name":"rabbitmq-cluster-server-conf","namespace":"default","selfLink":"/api/v1/namespaces/default/configmaps/rabbitmq-cluster-server-conf","uid":"22474f2b-8454-44b7-8079-8990223969cc","resourceVersion":"714","creationTimestamp":"2022-03-18T18:00:38Z","labels":{"app.kubernetes.io/component":"rabbitmq","app.kubernetes.io/name":"rabbitmq-cluster","app.kubernetes.io/part-of":"rabbitmq"},"ownerReferences":[{"apiVersion":"rabbitmq.com/v1beta1","kind":"RabbitmqCluster","name":"rabbitmq-cluster","uid":"18d9928b-0d1c-47be-80ec-20960d053827","controller":true,"blockOwnerDeletion":true}],"managedFields":[{"manager":"manager","operation":"Update","apiVersion":"v1","time":"2022-03-18T18:00:38Z","fieldsType":"FieldsV1","fieldsV1":{"f:data":{".":{},"f:operatorDefaults.conf":{},"f:userDefinedConfiguration.conf":{}},"f:metadata":{"f:labels":{".":{},"f:app.kubernetes.io/component":{},"f:app.kubernetes.io/name":{},"f:app.kubernetes.io/part-of":{}},"f:ownerReferences":{".":{},"k:{\"uid\":\"18d9928b-0d1c-47be-80ec-20960d053827\"}":{".":{},"f:apiVersion":{},"f:blockOwnerDeletion":{},"f:controller":{},"f:kind":{},"f:name":{},"f:uid":{}}}}}}]},"data":{"operatorDefaults.conf":"cluster_formation.peer_discovery_backend             = rabbit_peer_discovery_k8s\ncluster_formation.k8s.host                           = kubernetes.default\ncluster_formation.k8s.address_type                   = hostname\ncluster_partition_handling                           = pause_minority\nqueue_master_locator                                 = min-masters\ndisk_free_limit.absolute                             = 2GB\ncluster_formation.randomized_startup_delay_range.min = 5\ncluster_formation.randomized_startup_delay_range.max = 30\ncluster_name                                         = rabbitmq-cluster\n","userDefinedConfiguration.conf":"total_memory_available_override_value = 1717986919\n"}}
2022/03/18 18:02:09 learn_server.go:291: [SIEVE-AFTER-READ]	Get	true	serviceaccount	default	rabbitmq-cluster-server	github.com/rabbitmq/cluster-operator/controllers.(*RabbitmqClusterReconciler)	NoError	{"kind":"ServiceAccount","apiVersion":"v1","metadata":{"name":"rabbitmq-cluster-server","namespace":"default","selfLink":"/api/v1/namespaces/default/serviceaccounts/rabbitmq-cluster-server","uid":"731589b5-ac97-4774-bee4-008949b54734","resourceVersion":"722","creationTimestamp":"2022-03-18T18:00:38Z","labels":{"app.kubernetes.io/component":"rabbitmq","app.kubernetes.io/name":"rabbitmq-cluster","app.kubernetes.io/part-of":"rabbitmq"},"ownerReferences":[{"apiVersion":"rabbitmq.com/v1beta1","kind":"RabbitmqCluster","name":"rabbitmq-cluster","uid":"18d9928b-0d1c-47be-80ec-20960d053827","controller":true,"blockOwnerDeletion":true}],"managedFields":[{"manager":"kube-controller-manager","operation":"Update","apiVersion":"v1","time":"2022-03-18T18:00:38Z","fieldsType":"FieldsV1","fieldsV1":{"f:secrets":{".":{},"k:{\"name\":\"rabbitmq-cluster-server-token-rhzq9\"}":{".":{},"f:name":{}}}}},{"manager":"manager","operation":"Update","apiVersion":"v1","time":"2022-03-18T18:00:38Z","fieldsType":"FieldsV1","fieldsV1":{"f:metadata":{"f:labels":{".":{},"f:app.kubernetes.io/component":{},"f:app.kubernetes.io/name":{},"f:app.kubernetes.io/part-of":{}},"f:ownerReferences":{".":{},"k:{\"uid\":\"18d9928b-0d1c-47be-80ec-20960d053827\"}":{".":{},"f:apiVersion":{},"f:blockOwnerDeletion":{},"f:controller":{},"f:kind":{},"f:name":{},"f:uid":{}}}}}}]},"secrets":[{"name":"rabbitmq-cluster-server-token-rhzq9"}]}
2022/03/18 18:02:09 learn_server.go:291: [SIEVE-AFTER-READ]	Get	true	role	default	rabbitmq-cluster-peer-discovery	github.com/rabbitmq/cluster-operator/controllers.(*RabbitmqClusterReconciler)	NoError	{"kind":"Role","apiVersion":"rbac.authorization.k8s.io/v1","metadata":{"name":"rabbitmq-cluster-peer-discovery","namespace":"default","selfLink":"/apis/rbac.authorization.k8s.io/v1/namespaces/default/roles/rabbitmq-cluster-peer-discovery","uid":"52c80b50-4fdd-4089-bbfd-9756465953f2","resourceVersion":"723","creationTimestamp":"2022-03-18T18:00:38Z","labels":{"app.kubernetes.io/component":"rabbitmq","app.kubernetes.io/name":"rabbitmq-cluster","app.kubernetes.io/part-of":"rabbitmq"},"ownerReferences":[{"apiVersion":"rabbitmq.com/v1beta1","kind":"RabbitmqCluster","name":"rabbitmq-cluster","uid":"18d9928b-0d1c-47be-80ec-20960d053827","controller":true,"blockOwnerDeletion":true}],"managedFields":[{"manager":"manager","operation":"Update","apiVersion":"rbac.authorization.k8s.io/v1","time":"2022-03-18T18:00:38Z","fieldsType":"FieldsV1","fieldsV1":{"f:metadata":{"f:labels":{".":{},"f:app.kubernetes.io/component":{},"f:app.kubernetes.io/name":{},"f:app.kubernetes.io/part-of":{}},"f:ownerReferences":{".":{},"k:{\"uid\":\"18d9928b-0d1c-47be-80ec-20960d053827\"}":{".":{},"f:apiVersion":{},"f:blockOwnerDeletion":{},"f:controller":{},"f:kind":{},"f:name":{},"f:uid":{}}}},"f:rules":{}}}]},"rules":[{"verbs":["get"],"apiGroups":[""],"resources":["endpoints"]},{"verbs":["create"],"apiGroups":[""],"resources":["events"]}]}
2022/03/18 18:02:09 learn_server.go:291: [SIEVE-AFTER-READ]	Get	true	rolebinding	default	rabbitmq-cluster-server	github.com/rabbitmq/cluster-operator/controllers.(*RabbitmqClusterReconciler)	NoError	{"kind":"RoleBinding","apiVersion":"rbac.authorization.k8s.io/v1","metadata":{"name":"rabbitmq-cluster-server","namespace":"default","selfLink":"/apis/rbac.authorization.k8s.io/v1/namespaces/default/rolebindings/rabbitmq-cluster-server","uid":"495e9f7c-a20d-4515-86b0-34149a855034","resourceVersion":"725","creationTimestamp":"2022-03-18T18:00:38Z","labels":{"app.kubernetes.io/component":"rabbitmq","app.kubernetes.io/name":"rabbitmq-cluster","app.kubernetes.io/part-of":"rabbitmq"},"ownerReferences":[{"apiVersion":"rabbitmq.com/v1beta1","kind":"RabbitmqCluster","name":"rabbitmq-cluster","uid":"18d9928b-0d1c-47be-80ec-20960d053827","controller":true,"blockOwnerDeletion":true}],"managedFields":[{"manager":"manager","operation":"Update","apiVersion":"rbac.authorization.k8s.io/v1","time":"2022-03-18T18:00:38Z","fieldsType":"FieldsV1","fieldsV1":{"f:metadata":{"f:labels":{".":{},"f:app.kubernetes.io/component":{},"f:app.kubernetes.io/name":{},"f:app.kubernetes.io/part-of":{}},"f:ownerReferences":{".":{},"k:{\"uid\":\"18d9928b-0d1c-47be-80ec-20960d053827\"}":{".":{},"f:apiVersion":{},"f:blockOwnerDeletion":{},"f:controller":{},"f:kind":{},"f:name":{},"f:uid":{}}}},"f:roleRef":{"f:apiGroup":{},"f:kind":{},"f:name":{}},"f:subjects":{}}}]},"subjects":[{"kind":"ServiceAccount","name":"rabbitmq-cluster-server"}],"roleRef":{"apiGroup":"rbac.authorization.k8s.io","kind":"Role","name":"rabbitmq-cluster-peer-discovery"}}
2022/03/18 18:02:09 learn_server.go:291: [SIEVE-AFTER-READ]	Get	true	statefulset	default	rabbitmq-cluster-server	github.com/rabbitmq/cluster-operator/controllers.(*RabbitmqClusterReconciler)	NoError	{"kind":"StatefulSet","apiVersion":"apps/v1","metadata":{"name":"rabbitmq-cluster-server","namespace":"default","selfLink":"/apis/apps/v1/namespaces/default/statefulsets/rabbitmq-cluster-server","uid":"cb5c43bc-6ee7-481c-ab01-6f3acffdd3c8","resourceVersion":"1231","generation":2,"creationTimestamp":"2022-03-18T18:00:38Z","labels":{"app.kubernetes.io/component":"rabbitmq","app.kubernetes.io/name":"rabbitmq-cluster","app.kubernetes.io/part-of":"rabbitmq"},"ownerReferences":[{"apiVersion":"rabbitmq.com/v1beta1","kind":"RabbitmqCluster","name":"rabbitmq-cluster","uid":"18d9928b-0d1c-47be-80ec-20960d053827","controller":true,"blockOwnerDeletion":true}],"managedFields":[{"manager":"manager","operation":"Update","apiVersion":"apps/v1","time":"2022-03-18T18:01:23Z","fieldsType":"FieldsV1","fieldsV1":{"f:metadata":{"f:labels":{".":{},"f:app.kubernetes.io/component":{},"f:app.kubernetes.io/name":{},"f:app.kubernetes.io/part-of":{}},"f:ownerReferences":{".":{},"k:{\"uid\":\"18d9928b-0d1c-47be-80ec-20960d053827\"}":{".":{},"f:apiVersion":{},"f:blockOwnerDeletion":{},"f:controller":{},"f:kind":{},"f:name":{},"f:uid":{}}}},"f:spec":{"f:podManagementPolicy":{},"f:replicas":{},"f:revisionHistoryLimit":{},"f:selector":{"f:matchLabels":{".":{},"f:app.kubernetes.io/name":{}}},"f:serviceName":{},"f:template":{"f:metadata":{"f:annotations":{".":{},"f:prometheus.io/port":{},"f:prometheus.io/scrape":{}},"f:labels":{".":{},"f:app.kubernetes.io/component":{},"f:app.kubernetes.io/name":{},"f:app.kubernetes.io/part-of":{}}},"f:spec":{"f:automountServiceAccountToken":{},"f:containers":{"k:{\"name\":\"rabbitmq\"}":{".":{},"f:env":{".":{},"k:{\"name\":\"K8S_HOSTNAME_SUFFIX\"}":{".":{},"f:name":{},"f:value":{}},"k:{\"name\":\"K8S_SERVICE_NAME\"}":{".":{},"f:name":{},"f:value":{}},"k:{\"name\":\"MY_POD_NAME\"}":{".":{},"f:name":{},"f:valueFrom":{".":{},"f:fieldRef":{".":{},"f:apiVersion":{},"f:fieldPath":{}}}},"k:{\"name\":\"MY_POD_NAMESPACE\"}":{".":{},"f:name":{},"f:valueFrom":{".":{},"f:fieldRef":{".":{},"f:apiVersion":{},"f:fieldPath":{}}}},"k:{\"name\":\"RABBITMQ_ENABLED_PLUGINS_FILE\"}":{".":{},"f:name":{},"f:value":{}},"k:{\"name\":\"RABBITMQ_NODENAME\"}":{".":{},"f:name":{},"f:value":{}},"k:{\"name\":\"RABBITMQ_USE_LONGNAME\"}":{".":{},"f:name":{},"f:value":{}}},"f:image":{},"f:imagePullPolicy":{},"f:lifecycle":{".":{},"f:preStop":{".":{},"f:exec":{".":{},"f:command":{}}}},"f:name":{},"f:ports":{".":{},"k:{\"containerPort\":4369,\"protocol\":\"TCP\"}":{".":{},"f:containerPort":{},"f:name":{},"f:protocol":{}},"k:{\"containerPort\":5672,\"protocol\":\"TCP\"}":{".":{},"f:containerPort":{},"f:name":{},"f:protocol":{}},"k:{\"containerPort\":15672,\"protocol\":\"TCP\"}":{".":{},"f:containerPort":{},"f:name":{},"f:protocol":{}},"k:{\"containerPort\":15692,\"protocol\":\"TCP\"}":{".":{},"f:containerPort":{},"f:name":{},"f:protocol":{}}},"f:readinessProbe":{".":{},"f:failureThreshold":{},"f:initialDelaySeconds":{},"f:periodSeconds":{},"f:successThreshold":{},"f:tcpSocket":{".":{},"f:port":{}},"f:timeoutSeconds":{}},"f:resources":{".":{},"f:limits":{".":{},"f:cpu":{},"f:memory":{}},"f:requests":{".":{},"f:cpu":{},"f:memory":{}}},"f:terminationMessagePath":{},"f:terminationMessagePolicy":{},"f:volumeMounts":{".":{},"k:{\"mountPath\":\"/etc/pod-info/\"}":{".":{},"f:mountPath":{},"f:name":{}},"k:{\"mountPath\":\"/etc/rabbitmq/conf.d/10-operatorDefaults.conf\"}":{".":{},"f:mountPath":{},"f:name":{},"f:subPath":{}},"k:{\"mountPath\":\"/etc/rabbitmq/conf.d/11-default_user.conf\"}":{".":{},"f:mountPath":{},"f:name":{},"f:subPath":{}},"k:{\"mountPath\":\"/etc/rabbitmq/conf.d/90-userDefinedConfiguration.conf\"}":{".":{},"f:mountPath":{},"f:name":{},"f:subPath":{}},"k:{\"mountPath\":\"/operator\"}":{".":{},"f:mountPath":{},"f:name":{}},"k:{\"mountPath\":\"/var/lib/rabbitmq/\"}":{".":{},"f:mountPath":{},"f:name":{}},"k:{\"mountPath\":\"/var/lib/rabbitmq/mnesia/\"}":{".":{},"f:mountPath":{},"f:name":{}}}}},"f:dnsPolicy":{},"f:initContainers":{".":{},"k:{\"name\":\"setup-container\"}":{".":{},"f:command":{},"f:image":{},"f:imagePullPolicy":{},"f:name":{},"f:resources":{".":{},"f:limits":{".":{},"f:cpu":{},"f:memory":{}},"f:requests":{".":{},"f:cpu":{},"f:memory":{}}},"f:securityContext":{".":{},"f:capabilities":{".":{},"f:drop":{}},"f:runAsUser":{}},"f:terminationMessagePath":{},"f:terminationMessagePolicy":{},"f:volumeMounts":{".":{},"k:{\"mountPath\":\"/operator\"}":{".":{},"f:mountPath":{},"f:name":{}},"k:{\"mountPath\":\"/tmp/default_user.conf\"}":{".":{},"f:mountPath":{},"f:name":{},"f:subPath":{}},"k:{\"mountPath\":\"/tmp/erlang-cookie-secret/\"}":{".":{},"f:mountPath":{},"f:name":{}},"k:{\"mountPath\":\"/tmp/rabbitmq-plugins/\"}":{".":{},"f:mountPath":{},"f:name":{}},"k:{\"mountPath\":\"/var/lib/rabbitmq/\"}":{".":{},"f:mountPath":{},"f:name":{}},"k:{\"mountPath\":\"/var/lib/rabbitmq/mnesia/\"}":{".":{},"f:mountPath":{},"f:name":{}}}}},"f:restartPolicy":{},"f:schedulerName":{},"f:securityContext":{".":{},"f:fsGroup":{},"f:runAsGroup":{},"f:runAsUser":{}},"f:serviceAccount":{},"f:serviceAccountName":{},"f:terminationGracePeriodSeconds":{},"f:topologySpreadConstraints":{".":{},"k:{\"topologyKey\":\"topology.kubernetes.io/zone\",\"whenUnsatisfiable\":\"ScheduleAnyway\"}":{".":{},"f:labelSelector":{".":{},"f:matchLabels":{".":{},"f:app.kubernetes.io/name":{}}},"f:maxSkew":{},"f:topologyKey":{},"f:whenUnsatisfiable":{}}},"f:volumes":{".":{},"k:{\"name\":\"erlang-cookie-secret\"}":{".":{},"f:name":{},"f:secret":{".":{},"f:defaultMode":{},"f:secretName":{}}},"k:{\"name\":\"plugins-conf\"}":{".":{},"f:configMap":{".":{},"f:defaultMode":{},"f:name":{}},"f:name":{}},"k:{\"name\":\"pod-info\"}":{".":{},"f:downwardAPI":{".":{},"f:defaultMode":{},"f:items":{}},"f:name":{}},"k:{\"name\":\"rabbitmq-confd\"}":{".":{},"f:name":{},"f:projected":{".":{},"f:defaultMode":{},"f:sources":{}}},"k:{\"name\":\"rabbitmq-erlang-cookie\"}":{".":{},"f:emptyDir":{},"f:name":{}},"k:{\"name\":\"rabbitmq-plugins\"}":{".":{},"f:emptyDir":{},"f:name":{}}}}},"f:updateStrategy":{"f:rollingUpdate":{".":{},"f:partition":{}},"f:type":{}},"f:volumeClaimTemplates":{}}}},{"manager":"kube-controller-manager","operation":"Update","apiVersion":"apps/v1","time":"2022-03-18T18:02:01Z","fieldsType":"FieldsV1","fieldsV1":{"f:status":{"f:collisionCount":{},"f:currentReplicas":{},"f:currentRevision":{},"f:observedGeneration":{},"f:readyReplicas":{},"f:replicas":{},"f:updateRevision":{},"f:updatedReplicas":{}}}}]},"spec":{"replicas":3,"selector":{"matchLabels":{"app.kubernetes.io/name":"rabbitmq-cluster"}},"template":{"metadata":{"creationTimestamp":null,"labels":{"app.kubernetes.io/component":"rabbitmq","app.kubernetes.io/name":"rabbitmq-cluster","app.kubernetes.io/part-of":"rabbitmq"},"annotations":{"prometheus.io/port":"15692","prometheus.io/scrape":"true"}},"spec":{"volumes":[{"name":"plugins-conf","configMap":{"name":"rabbitmq-cluster-plugins-conf","defaultMode":420}},{"name":"rabbitmq-confd","projected":{"sources":[{"secret":{"name":"rabbitmq-cluster-default-user","items":[{"key":"default_user.conf","path":"default_user.conf"}]}},{"configMap":{"name":"rabbitmq-cluster-server-conf","items":[{"key":"operatorDefaults.conf","path":"operatorDefaults.conf"},{"key":"userDefinedConfiguration.conf","path":"userDefinedConfiguration.conf"}]}}],"defaultMode":420}},{"name":"rabbitmq-erlang-cookie","emptyDir":{}},{"name":"erlang-cookie-secret","secret":{"secretName":"rabbitmq-cluster-erlang-cookie","defaultMode":420}},{"name":"rabbitmq-plugins","emptyDir":{}},{"name":"pod-info","downwardAPI":{"items":[{"path":"skipPreStopChecks","fieldRef":{"apiVersion":"v1","fieldPath":"metadata.labels['skipPreStopChecks']"}}],"defaultMode":420}}],"initContainers":[{"name":"setup-container","image":"rabbitmq:3.8.12-management","command":["sh","-c","cp /tmp/erlang-cookie-secret/.erlang.cookie /var/lib/rabbitmq/.erlang.cookie \u0026\u0026 chown 999:999 /var/lib/rabbitmq/.erlang.cookie \u0026\u0026 chmod 600 /var/lib/rabbitmq/.erlang.cookie ; cp /tmp/rabbitmq-plugins/enabled_plugins /operator/enabled_plugins \u0026\u0026 chown 999:999 /operator/enabled_plugins ; chown 999:999 /var/lib/rabbitmq/mnesia/ ; echo '[default]' \u003e /var/lib/rabbitmq/.rabbitmqadmin.conf \u0026\u0026 sed -e 's/default_user/username/' -e 's/default_pass/password/' /tmp/default_user.conf \u003e\u003e /var/lib/rabbitmq/.rabbitmqadmin.conf \u0026\u0026 chown 999:999 /var/lib/rabbitmq/.rabbitmqadmin.conf \u0026\u0026 chmod 600 /var/lib/rabbitmq/.rabbitmqadmin.conf"],"resources":{"limits":{"cpu":"100m","memory":"500Mi"},"requests":{"cpu":"100m","memory":"500Mi"}},"volumeMounts":[{"name":"plugins-conf","mountPath":"/tmp/rabbitmq-plugins/"},{"name":"rabbitmq-erlang-cookie","mountPath":"/var/lib/rabbitmq/"},{"name":"erlang-cookie-secret","mountPath":"/tmp/erlang-cookie-secret/"},{"name":"rabbitmq-plugins","mountPath":"/operator"},{"name":"persistence","mountPath":"/var/lib/rabbitmq/mnesia/"},{"name":"rabbitmq-confd","mountPath":"/tmp/default_user.conf","subPath":"default_user.conf"}],"terminationMessagePath":"/dev/termination-log","terminationMessagePolicy":"File","imagePullPolicy":"IfNotPresent","securityContext":{"capabilities":{"drop":["FSETID","KILL","SETGID","SETUID","SETPCAP","NET_BIND_SERVICE","NET_RAW","SYS_CHROOT","MKNOD","AUDIT_WRITE","SETFCAP"]},"runAsUser":0}}],"containers":[{"name":"rabbitmq","image":"rabbitmq:3.8.12-management","ports":[{"name":"epmd","containerPort":4369,"protocol":"TCP"},{"name":"amqp","containerPort":5672,"protocol":"TCP"},{"name":"management","containerPort":15672,"protocol":"TCP"},{"name":"prometheus","containerPort":15692,"protocol":"TCP"}],"env":[{"name":"MY_POD_NAME","valueFrom":{"fieldRef":{"apiVersion":"v1","fieldPath":"metadata.name"}}},{"name":"MY_POD_NAMESPACE","valueFrom":{"fieldRef":{"apiVersion":"v1","fieldPath":"metadata.namespace"}}},{"name":"RABBITMQ_ENABLED_PLUGINS_FILE","value":"/operator/enabled_plugins"},{"name":"K8S_SERVICE_NAME","value":"rabbitmq-cluster-nodes"},{"name":"RABBITMQ_USE_LONGNAME","value":"true"},{"name":"RABBITMQ_NODENAME","value":"rabbit@$(MY_POD_NAME).$(K8S_SERVICE_NAME).$(MY_POD_NAMESPACE)"},{"name":"K8S_HOSTNAME_SUFFIX","value":".$(K8S_SERVICE_NAME).$(MY_POD_NAMESPACE)"}],"resources":{"limits":{"cpu":"2","memory":"2Gi"},"requests":{"cpu":"1","memory":"2Gi"}},"volumeMounts":[{"name":"rabbitmq-erlang-cookie","mountPath":"/var/lib/rabbitmq/"},{"name":"persistence","mountPath":"/var/lib/rabbitmq/mnesia/"},{"name":"rabbitmq-plugins","mountPath":"/operator"},{"name":"rabbitmq-confd","mountPath":"/etc/rabbitmq/conf.d/10-operatorDefaults.conf","subPath":"operatorDefaults.conf"},{"name":"rabbitmq-confd","mountPath":"/etc/rabbitmq/conf.d/11-default_user.conf","subPath":"default_user.conf"},{"name":"rabbitmq-confd","mountPath":"/etc/rabbitmq/conf.d/90-userDefinedConfiguration.conf","subPath":"userDefinedConfiguration.conf"},{"name":"pod-info","mountPath":"/etc/pod-info/"}],"readinessProbe":{"tcpSocket":{"port":"amqp"},"initialDelaySeconds":10,"timeoutSeconds":5,"periodSeconds":10,"successThreshold":1,"failureThreshold":3},"lifecycle":{"preStop":{"exec":{"command":["/bin/bash","-c","if [ ! -z \"$(cat /etc/pod-info/skipPreStopChecks)\" ]; then exit 0; fi; rabbitmq-upgrade await_online_quorum_plus_one -t 604800; rabbitmq-upgrade await_online_synchronized_mirror -t 604800; rabbitmq-upgrade drain -t 604800"]}}},"terminationMessagePath":"/dev/termination-log","terminationMessagePolicy":"File","imagePullPolicy":"IfNotPresent"}],"restartPolicy":"Always","terminationGracePeriodSeconds":604800,"dnsPolicy":"ClusterFirst","serviceAccountName":"rabbitmq-cluster-server","serviceAccount":"rabbitmq-cluster-server","automountServiceAccountToken":true,"securityContext":{"runAsUser":999,"runAsGroup":999,"fsGroup":999},"schedulerName":"default-scheduler","topologySpreadConstraints":[{"maxSkew":1,"topologyKey":"topology.kubernetes.io/zone","whenUnsatisfiable":"ScheduleAnyway","labelSelector":{"matchLabels":{"app.kubernetes.io/name":"rabbitmq-cluster"}}}]}},"volumeClaimTemplates":[{"metadata":{"name":"persistence","namespace":"default","creationTimestamp":null,"labels":{"app.kubernetes.io/component":"rabbitmq","app.kubernetes.io/name":"rabbitmq-cluster","app.kubernetes.io/part-of":"rabbitmq"},"ownerReferences":[{"apiVersion":"rabbitmq.com/v1beta1","kind":"RabbitmqCluster","name":"rabbitmq-cluster","uid":"18d9928b-0d1c-47be-80ec-20960d053827","controller":true,"blockOwnerDeletion":false}]},"spec":{"accessModes":["ReadWriteOnce"],"resources":{"requests":{"storage":"10Gi"}},"volumeMode":"Filesystem"},"status":{"phase":"Pending"}}],"serviceName":"rabbitmq-cluster-nodes","podManagementPolicy":"Parallel","updateStrategy":{"type":"RollingUpdate","rollingUpdate":{"partition":0}},"revisionHistoryLimit":10},"status":{"observedGeneration":2,"replicas":3,"readyReplicas":3,"currentReplicas":3,"updatedReplicas":3,"currentRevision":"rabbitmq-cluster-server-5f8b8665fb","updateRevision":"rabbitmq-cluster-server-5f8b8665fb","collisionCount":0}}
2022/03/18 18:02:09 learn_server.go:256: [SIEVE-BEFORE-WRITE]	64
2022/03/18 18:02:09 learn_server.go:263: [SIEVE-AFTER-WRITE]	64	StatusUpdate	rabbitmqcluster	github.com/rabbitmq/cluster-operator/controllers.(*RabbitmqClusterReconciler)	NoError	{"metadata":{"name":"rabbitmq-cluster","namespace":"default","selfLink":"/apis/rabbitmq.com/v1beta1/namespaces/default/rabbitmqclusters/rabbitmq-cluster/status","uid":"18d9928b-0d1c-47be-80ec-20960d053827","resourceVersion":"1264","generation":4,"creationTimestamp":"2022-03-18T18:00:38Z","annotations":{"kubectl.kubernetes.io/last-applied-configuration":"{\"apiVersion\":\"rabbitmq.com/v1beta1\",\"kind\":\"RabbitmqCluster\",\"metadata\":{\"annotations\":{},\"name\":\"rabbitmq-cluster\",\"namespace\":\"default\"},\"spec\":{\"persistence\":{\"storage\":\"10Gi\"},\"replicas\":1}}\n"},"finalizers":["deletion.finalizers.rabbitmqclusters.rabbitmq.com"],"managedFields":[{"manager":"kubectl-client-side-apply","operation":"Update","apiVersion":"rabbitmq.com/v1beta1","time":"2022-03-18T18:00:38Z","fieldsType":"FieldsV1","fieldsV1":{"f:metadata":{"f:annotations":{".":{},"f:kubectl.kubernetes.io/last-applied-configuration":{}}},"f:spec":{".":{},"f:image":{},"f:persistence":{".":{},"f:storage":{}},"f:resources":{".":{},"f:limits":{".":{},"f:memory":{}},"f:requests":{".":{},"f:memory":{}}},"f:service":{".":{},"f:type":{}},"f:terminationGracePeriodSeconds":{}}}},{"manager":"kubectl-patch","operation":"Update","apiVersion":"rabbitmq.com/v1beta1","time":"2022-03-18T18:02:09Z","fieldsType":"FieldsV1","fieldsV1":{"f:spec":{"f:replicas":{}}}},{"manager":"manager","operation":"Update","apiVersion":"rabbitmq.com/v1beta1","time":"2022-03-18T18:02:09Z","fieldsType":"FieldsV1","fieldsV1":{"f:metadata":{"f:finalizers":{}},"f:spec":{"f:override":{},"f:rabbitmq":{},"f:resources":{"f:limits":{"f:cpu":{}},"f:requests":{"f:cpu":{}}},"f:tls":{}},"f:status":{".":{},"f:conditions":{},"f:defaultUser":{".":{},"f:secretReference":{".":{},"f:keys":{".":{},"f:password":{},"f:username":{}},"f:name":{},"f:namespace":{}},"f:serviceReference":{".":{},"f:name":{},"f:namespace":{}}}}}}]},"spec":{"replicas":2,"image":"rabbitmq:3.8.12-management","service":{"type":"ClusterIP"},"persistence":{"storage":"10Gi"},"resources":{"limits":{"cpu":"2","memory":"2Gi"},"requests":{"cpu":"1","memory":"2Gi"}},"rabbitmq":{},"tls":{},"override":{},"terminationGracePeriodSeconds":604800},"status":{"conditions":[{"type":"AllReplicasReady","status":"True","lastTransitionTime":"2022-03-18T18:02:01Z","reason":"AllPodsAreReady"},{"type":"ClusterAvailable","status":"True","lastTransitionTime":"2022-03-18T18:01:17Z","reason":"AtLeastOneEndpointAvailable"},{"type":"NoWarnings","status":"True","lastTransitionTime":"2022-03-18T18:00:38Z","reason":"NoWarnings"},{"type":"ReconcileSuccess","status":"False","lastTransitionTime":"2022-03-18T18:02:09Z","reason":"UnsupportedOperation","message":"Cluster Scale down not supported"}],"defaultUser":{"secretReference":{"name":"rabbitmq-cluster-default-user","namespace":"default","keys":{"password":"password","username":"username"}},"serviceReference":{"name":"rabbitmq-cluster","namespace":"default"}}}}
2022/03/18 18:02:09 learn_server.go:279: [SIEVE-BEFORE-HEAR]	31	Updated	rabbitmqcluster	{"metadata":{"name":"rabbitmq-cluster","namespace":"default","selfLink":"/apis/rabbitmq.com/v1beta1/namespaces/default/rabbitmqclusters/rabbitmq-cluster","uid":"18d9928b-0d1c-47be-80ec-20960d053827","resourceVersion":"1264","generation":4,"creationTimestamp":"2022-03-18T18:00:38Z","annotations":{"kubectl.kubernetes.io/last-applied-configuration":"{\"apiVersion\":\"rabbitmq.com/v1beta1\",\"kind\":\"RabbitmqCluster\",\"metadata\":{\"annotations\":{},\"name\":\"rabbitmq-cluster\",\"namespace\":\"default\"},\"spec\":{\"persistence\":{\"storage\":\"10Gi\"},\"replicas\":1}}\n"},"finalizers":["deletion.finalizers.rabbitmqclusters.rabbitmq.com"],"managedFields":[{"manager":"kubectl-client-side-apply","operation":"Update","apiVersion":"rabbitmq.com/v1beta1","time":"2022-03-18T18:00:38Z","fieldsType":"FieldsV1","fieldsV1":{"f:metadata":{"f:annotations":{".":{},"f:kubectl.kubernetes.io/last-applied-configuration":{}}},"f:spec":{".":{},"f:image":{},"f:persistence":{".":{},"f:storage":{}},"f:resources":{".":{},"f:limits":{".":{},"f:memory":{}},"f:requests":{".":{},"f:memory":{}}},"f:service":{".":{},"f:type":{}},"f:terminationGracePeriodSeconds":{}}}},{"manager":"kubectl-patch","operation":"Update","apiVersion":"rabbitmq.com/v1beta1","time":"2022-03-18T18:02:09Z","fieldsType":"FieldsV1","fieldsV1":{"f:spec":{"f:replicas":{}}}},{"manager":"manager","operation":"Update","apiVersion":"rabbitmq.com/v1beta1","time":"2022-03-18T18:02:09Z","fieldsType":"FieldsV1","fieldsV1":{"f:metadata":{"f:finalizers":{}},"f:spec":{"f:override":{},"f:rabbitmq":{},"f:resources":{"f:limits":{"f:cpu":{}},"f:requests":{"f:cpu":{}}},"f:tls":{}},"f:status":{".":{},"f:conditions":{},"f:defaultUser":{".":{},"f:secretReference":{".":{},"f:keys":{".":{},"f:password":{},"f:username":{}},"f:name":{},"f:namespace":{}},"f:serviceReference":{".":{},"f:name":{},"f:namespace":{}}}}}}]},"spec":{"replicas":2,"image":"rabbitmq:3.8.12-management","service":{"type":"ClusterIP"},"persistence":{"storage":"10Gi"},"resources":{"limits":{"cpu":"2","memory":"2Gi"},"requests":{"cpu":"1","memory":"2Gi"}},"rabbitmq":{},"tls":{},"override":{},"terminationGracePeriodSeconds":604800},"status":{"conditions":[{"type":"AllReplicasReady","status":"True","lastTransitionTime":"2022-03-18T18:02:01Z","reason":"AllPodsAreReady"},{"type":"ClusterAvailable","status":"True","lastTransitionTime":"2022-03-18T18:01:17Z","reason":"AtLeastOneEndpointAvailable"},{"type":"NoWarnings","status":"True","lastTransitionTime":"2022-03-18T18:00:38Z","reason":"NoWarnings"},{"type":"ReconcileSuccess","status":"False","lastTransitionTime":"2022-03-18T18:02:09Z","reason":"UnsupportedOperation","message":"Cluster Scale down not supported"}],"defaultUser":{"secretReference":{"name":"rabbitmq-cluster-default-user","namespace":"default","keys":{"password":"password","username":"username"}},"serviceReference":{"name":"rabbitmq-cluster","namespace":"default"}}}}
2022/03/18 18:02:09 learn_server.go:253: [SIEVE-AFTER-RECONCILE]	github.com/rabbitmq/cluster-operator/controllers.(*RabbitmqClusterReconciler)	19
2022/03/18 18:02:09 learn_server.go:289: [SIEVE-AFTER-HEAR]	31
2022/03/18 18:02:09 learn_server.go:238: [SIEVE-BEFORE-RECONCILE]	github.com/rabbitmq/cluster-operator/controllers.(*RabbitmqClusterReconciler)	20
2022/03/18 18:02:09 learn_server.go:291: [SIEVE-AFTER-READ]	Get	true	rabbitmqcluster	default	rabbitmq-cluster	github.com/rabbitmq/cluster-operator/controllers.(*RabbitmqClusterReconciler)	NoError	{"kind":"RabbitmqCluster","apiVersion":"rabbitmq.com/v1beta1","metadata":{"name":"rabbitmq-cluster","namespace":"default","selfLink":"/apis/rabbitmq.com/v1beta1/namespaces/default/rabbitmqclusters/rabbitmq-cluster","uid":"18d9928b-0d1c-47be-80ec-20960d053827","resourceVersion":"1264","generation":4,"creationTimestamp":"2022-03-18T18:00:38Z","annotations":{"kubectl.kubernetes.io/last-applied-configuration":"{\"apiVersion\":\"rabbitmq.com/v1beta1\",\"kind\":\"RabbitmqCluster\",\"metadata\":{\"annotations\":{},\"name\":\"rabbitmq-cluster\",\"namespace\":\"default\"},\"spec\":{\"persistence\":{\"storage\":\"10Gi\"},\"replicas\":1}}\n"},"finalizers":["deletion.finalizers.rabbitmqclusters.rabbitmq.com"],"managedFields":[{"manager":"kubectl-client-side-apply","operation":"Update","apiVersion":"rabbitmq.com/v1beta1","time":"2022-03-18T18:00:38Z","fieldsType":"FieldsV1","fieldsV1":{"f:metadata":{"f:annotations":{".":{},"f:kubectl.kubernetes.io/last-applied-configuration":{}}},"f:spec":{".":{},"f:image":{},"f:persistence":{".":{},"f:storage":{}},"f:resources":{".":{},"f:limits":{".":{},"f:memory":{}},"f:requests":{".":{},"f:memory":{}}},"f:service":{".":{},"f:type":{}},"f:terminationGracePeriodSeconds":{}}}},{"manager":"kubectl-patch","operation":"Update","apiVersion":"rabbitmq.com/v1beta1","time":"2022-03-18T18:02:09Z","fieldsType":"FieldsV1","fieldsV1":{"f:spec":{"f:replicas":{}}}},{"manager":"manager","operation":"Update","apiVersion":"rabbitmq.com/v1beta1","time":"2022-03-18T18:02:09Z","fieldsType":"FieldsV1","fieldsV1":{"f:metadata":{"f:finalizers":{}},"f:spec":{"f:override":{},"f:rabbitmq":{},"f:resources":{"f:limits":{"f:cpu":{}},"f:requests":{"f:cpu":{}}},"f:tls":{}},"f:status":{".":{},"f:conditions":{},"f:defaultUser":{".":{},"f:secretReference":{".":{},"f:keys":{".":{},"f:password":{},"f:username":{}},"f:name":{},"f:namespace":{}},"f:serviceReference":{".":{},"f:name":{},"f:namespace":{}}}}}}]},"spec":{"replicas":2,"image":"rabbitmq:3.8.12-management","service":{"type":"ClusterIP"},"persistence":{"storage":"10Gi"},"resources":{"limits":{"cpu":"2","memory":"2Gi"},"requests":{"cpu":"1","memory":"2Gi"}},"rabbitmq":{},"tls":{},"override":{},"terminationGracePeriodSeconds":604800},"status":{"conditions":[{"type":"AllReplicasReady","status":"True","lastTransitionTime":"2022-03-18T18:02:01Z","reason":"AllPodsAreReady"},{"type":"ClusterAvailable","status":"True","lastTransitionTime":"2022-03-18T18:01:17Z","reason":"AtLeastOneEndpointAvailable"},{"type":"NoWarnings","status":"True","lastTransitionTime":"2022-03-18T18:00:38Z","reason":"NoWarnings"},{"type":"ReconcileSuccess","status":"False","lastTransitionTime":"2022-03-18T18:02:09Z","reason":"UnsupportedOperation","message":"Cluster Scale down not supported"}],"defaultUser":{"secretReference":{"name":"rabbitmq-cluster-default-user","namespace":"default","keys":{"password":"password","username":"username"}},"serviceReference":{"name":"rabbitmq-cluster","namespace":"default"}}}}
2022/03/18 18:02:09 learn_server.go:291: [SIEVE-AFTER-READ]	Get	true	statefulset	default	rabbitmq-cluster-server	github.com/rabbitmq/cluster-operator/controllers.(*RabbitmqClusterReconciler)	NoError	{"kind":"StatefulSet","apiVersion":"apps/v1","metadata":{"name":"rabbitmq-cluster-server","namespace":"default","selfLink":"/apis/apps/v1/namespaces/default/statefulsets/rabbitmq-cluster-server","uid":"cb5c43bc-6ee7-481c-ab01-6f3acffdd3c8","resourceVersion":"1231","generation":2,"creationTimestamp":"2022-03-18T18:00:38Z","labels":{"app.kubernetes.io/component":"rabbitmq","app.kubernetes.io/name":"rabbitmq-cluster","app.kubernetes.io/part-of":"rabbitmq"},"ownerReferences":[{"apiVersion":"rabbitmq.com/v1beta1","kind":"RabbitmqCluster","name":"rabbitmq-cluster","uid":"18d9928b-0d1c-47be-80ec-20960d053827","controller":true,"blockOwnerDeletion":true}],"managedFields":[{"manager":"manager","operation":"Update","apiVersion":"apps/v1","time":"2022-03-18T18:01:23Z","fieldsType":"FieldsV1","fieldsV1":{"f:metadata":{"f:labels":{".":{},"f:app.kubernetes.io/component":{},"f:app.kubernetes.io/name":{},"f:app.kubernetes.io/part-of":{}},"f:ownerReferences":{".":{},"k:{\"uid\":\"18d9928b-0d1c-47be-80ec-20960d053827\"}":{".":{},"f:apiVersion":{},"f:blockOwnerDeletion":{},"f:controller":{},"f:kind":{},"f:name":{},"f:uid":{}}}},"f:spec":{"f:podManagementPolicy":{},"f:replicas":{},"f:revisionHistoryLimit":{},"f:selector":{"f:matchLabels":{".":{},"f:app.kubernetes.io/name":{}}},"f:serviceName":{},"f:template":{"f:metadata":{"f:annotations":{".":{},"f:prometheus.io/port":{},"f:prometheus.io/scrape":{}},"f:labels":{".":{},"f:app.kubernetes.io/component":{},"f:app.kubernetes.io/name":{},"f:app.kubernetes.io/part-of":{}}},"f:spec":{"f:automountServiceAccountToken":{},"f:containers":{"k:{\"name\":\"rabbitmq\"}":{".":{},"f:env":{".":{},"k:{\"name\":\"K8S_HOSTNAME_SUFFIX\"}":{".":{},"f:name":{},"f:value":{}},"k:{\"name\":\"K8S_SERVICE_NAME\"}":{".":{},"f:name":{},"f:value":{}},"k:{\"name\":\"MY_POD_NAME\"}":{".":{},"f:name":{},"f:valueFrom":{".":{},"f:fieldRef":{".":{},"f:apiVersion":{},"f:fieldPath":{}}}},"k:{\"name\":\"MY_POD_NAMESPACE\"}":{".":{},"f:name":{},"f:valueFrom":{".":{},"f:fieldRef":{".":{},"f:apiVersion":{},"f:fieldPath":{}}}},"k:{\"name\":\"RABBITMQ_ENABLED_PLUGINS_FILE\"}":{".":{},"f:name":{},"f:value":{}},"k:{\"name\":\"RABBITMQ_NODENAME\"}":{".":{},"f:name":{},"f:value":{}},"k:{\"name\":\"RABBITMQ_USE_LONGNAME\"}":{".":{},"f:name":{},"f:value":{}}},"f:image":{},"f:imagePullPolicy":{},"f:lifecycle":{".":{},"f:preStop":{".":{},"f:exec":{".":{},"f:command":{}}}},"f:name":{},"f:ports":{".":{},"k:{\"containerPort\":4369,\"protocol\":\"TCP\"}":{".":{},"f:containerPort":{},"f:name":{},"f:protocol":{}},"k:{\"containerPort\":5672,\"protocol\":\"TCP\"}":{".":{},"f:containerPort":{},"f:name":{},"f:protocol":{}},"k:{\"containerPort\":15672,\"protocol\":\"TCP\"}":{".":{},"f:containerPort":{},"f:name":{},"f:protocol":{}},"k:{\"containerPort\":15692,\"protocol\":\"TCP\"}":{".":{},"f:containerPort":{},"f:name":{},"f:protocol":{}}},"f:readinessProbe":{".":{},"f:failureThreshold":{},"f:initialDelaySeconds":{},"f:periodSeconds":{},"f:successThreshold":{},"f:tcpSocket":{".":{},"f:port":{}},"f:timeoutSeconds":{}},"f:resources":{".":{},"f:limits":{".":{},"f:cpu":{},"f:memory":{}},"f:requests":{".":{},"f:cpu":{},"f:memory":{}}},"f:terminationMessagePath":{},"f:terminationMessagePolicy":{},"f:volumeMounts":{".":{},"k:{\"mountPath\":\"/etc/pod-info/\"}":{".":{},"f:mountPath":{},"f:name":{}},"k:{\"mountPath\":\"/etc/rabbitmq/conf.d/10-operatorDefaults.conf\"}":{".":{},"f:mountPath":{},"f:name":{},"f:subPath":{}},"k:{\"mountPath\":\"/etc/rabbitmq/conf.d/11-default_user.conf\"}":{".":{},"f:mountPath":{},"f:name":{},"f:subPath":{}},"k:{\"mountPath\":\"/etc/rabbitmq/conf.d/90-userDefinedConfiguration.conf\"}":{".":{},"f:mountPath":{},"f:name":{},"f:subPath":{}},"k:{\"mountPath\":\"/operator\"}":{".":{},"f:mountPath":{},"f:name":{}},"k:{\"mountPath\":\"/var/lib/rabbitmq/\"}":{".":{},"f:mountPath":{},"f:name":{}},"k:{\"mountPath\":\"/var/lib/rabbitmq/mnesia/\"}":{".":{},"f:mountPath":{},"f:name":{}}}}},"f:dnsPolicy":{},"f:initContainers":{".":{},"k:{\"name\":\"setup-container\"}":{".":{},"f:command":{},"f:image":{},"f:imagePullPolicy":{},"f:name":{},"f:resources":{".":{},"f:limits":{".":{},"f:cpu":{},"f:memory":{}},"f:requests":{".":{},"f:cpu":{},"f:memory":{}}},"f:securityContext":{".":{},"f:capabilities":{".":{},"f:drop":{}},"f:runAsUser":{}},"f:terminationMessagePath":{},"f:terminationMessagePolicy":{},"f:volumeMounts":{".":{},"k:{\"mountPath\":\"/operator\"}":{".":{},"f:mountPath":{},"f:name":{}},"k:{\"mountPath\":\"/tmp/default_user.conf\"}":{".":{},"f:mountPath":{},"f:name":{},"f:subPath":{}},"k:{\"mountPath\":\"/tmp/erlang-cookie-secret/\"}":{".":{},"f:mountPath":{},"f:name":{}},"k:{\"mountPath\":\"/tmp/rabbitmq-plugins/\"}":{".":{},"f:mountPath":{},"f:name":{}},"k:{\"mountPath\":\"/var/lib/rabbitmq/\"}":{".":{},"f:mountPath":{},"f:name":{}},"k:{\"mountPath\":\"/var/lib/rabbitmq/mnesia/\"}":{".":{},"f:mountPath":{},"f:name":{}}}}},"f:restartPolicy":{},"f:schedulerName":{},"f:securityContext":{".":{},"f:fsGroup":{},"f:runAsGroup":{},"f:runAsUser":{}},"f:serviceAccount":{},"f:serviceAccountName":{},"f:terminationGracePeriodSeconds":{},"f:topologySpreadConstraints":{".":{},"k:{\"topologyKey\":\"topology.kubernetes.io/zone\",\"whenUnsatisfiable\":\"ScheduleAnyway\"}":{".":{},"f:labelSelector":{".":{},"f:matchLabels":{".":{},"f:app.kubernetes.io/name":{}}},"f:maxSkew":{},"f:topologyKey":{},"f:whenUnsatisfiable":{}}},"f:volumes":{".":{},"k:{\"name\":\"erlang-cookie-secret\"}":{".":{},"f:name":{},"f:secret":{".":{},"f:defaultMode":{},"f:secretName":{}}},"k:{\"name\":\"plugins-conf\"}":{".":{},"f:configMap":{".":{},"f:defaultMode":{},"f:name":{}},"f:name":{}},"k:{\"name\":\"pod-info\"}":{".":{},"f:downwardAPI":{".":{},"f:defaultMode":{},"f:items":{}},"f:name":{}},"k:{\"name\":\"rabbitmq-confd\"}":{".":{},"f:name":{},"f:projected":{".":{},"f:defaultMode":{},"f:sources":{}}},"k:{\"name\":\"rabbitmq-erlang-cookie\"}":{".":{},"f:emptyDir":{},"f:name":{}},"k:{\"name\":\"rabbitmq-plugins\"}":{".":{},"f:emptyDir":{},"f:name":{}}}}},"f:updateStrategy":{"f:rollingUpdate":{".":{},"f:partition":{}},"f:type":{}},"f:volumeClaimTemplates":{}}}},{"manager":"kube-controller-manager","operation":"Update","apiVersion":"apps/v1","time":"2022-03-18T18:02:01Z","fieldsType":"FieldsV1","fieldsV1":{"f:status":{"f:collisionCount":{},"f:currentReplicas":{},"f:currentRevision":{},"f:observedGeneration":{},"f:readyReplicas":{},"f:replicas":{},"f:updateRevision":{},"f:updatedReplicas":{}}}}]},"spec":{"replicas":3,"selector":{"matchLabels":{"app.kubernetes.io/name":"rabbitmq-cluster"}},"template":{"metadata":{"creationTimestamp":null,"labels":{"app.kubernetes.io/component":"rabbitmq","app.kubernetes.io/name":"rabbitmq-cluster","app.kubernetes.io/part-of":"rabbitmq"},"annotations":{"prometheus.io/port":"15692","prometheus.io/scrape":"true"}},"spec":{"volumes":[{"name":"plugins-conf","configMap":{"name":"rabbitmq-cluster-plugins-conf","defaultMode":420}},{"name":"rabbitmq-confd","projected":{"sources":[{"secret":{"name":"rabbitmq-cluster-default-user","items":[{"key":"default_user.conf","path":"default_user.conf"}]}},{"configMap":{"name":"rabbitmq-cluster-server-conf","items":[{"key":"operatorDefaults.conf","path":"operatorDefaults.conf"},{"key":"userDefinedConfiguration.conf","path":"userDefinedConfiguration.conf"}]}}],"defaultMode":420}},{"name":"rabbitmq-erlang-cookie","emptyDir":{}},{"name":"erlang-cookie-secret","secret":{"secretName":"rabbitmq-cluster-erlang-cookie","defaultMode":420}},{"name":"rabbitmq-plugins","emptyDir":{}},{"name":"pod-info","downwardAPI":{"items":[{"path":"skipPreStopChecks","fieldRef":{"apiVersion":"v1","fieldPath":"metadata.labels['skipPreStopChecks']"}}],"defaultMode":420}}],"initContainers":[{"name":"setup-container","image":"rabbitmq:3.8.12-management","command":["sh","-c","cp /tmp/erlang-cookie-secret/.erlang.cookie /var/lib/rabbitmq/.erlang.cookie \u0026\u0026 chown 999:999 /var/lib/rabbitmq/.erlang.cookie \u0026\u0026 chmod 600 /var/lib/rabbitmq/.erlang.cookie ; cp /tmp/rabbitmq-plugins/enabled_plugins /operator/enabled_plugins \u0026\u0026 chown 999:999 /operator/enabled_plugins ; chown 999:999 /var/lib/rabbitmq/mnesia/ ; echo '[default]' \u003e /var/lib/rabbitmq/.rabbitmqadmin.conf \u0026\u0026 sed -e 's/default_user/username/' -e 's/default_pass/password/' /tmp/default_user.conf \u003e\u003e /var/lib/rabbitmq/.rabbitmqadmin.conf \u0026\u0026 chown 999:999 /var/lib/rabbitmq/.rabbitmqadmin.conf \u0026\u0026 chmod 600 /var/lib/rabbitmq/.rabbitmqadmin.conf"],"resources":{"limits":{"cpu":"100m","memory":"500Mi"},"requests":{"cpu":"100m","memory":"500Mi"}},"volumeMounts":[{"name":"plugins-conf","mountPath":"/tmp/rabbitmq-plugins/"},{"name":"rabbitmq-erlang-cookie","mountPath":"/var/lib/rabbitmq/"},{"name":"erlang-cookie-secret","mountPath":"/tmp/erlang-cookie-secret/"},{"name":"rabbitmq-plugins","mountPath":"/operator"},{"name":"persistence","mountPath":"/var/lib/rabbitmq/mnesia/"},{"name":"rabbitmq-confd","mountPath":"/tmp/default_user.conf","subPath":"default_user.conf"}],"terminationMessagePath":"/dev/termination-log","terminationMessagePolicy":"File","imagePullPolicy":"IfNotPresent","securityContext":{"capabilities":{"drop":["FSETID","KILL","SETGID","SETUID","SETPCAP","NET_BIND_SERVICE","NET_RAW","SYS_CHROOT","MKNOD","AUDIT_WRITE","SETFCAP"]},"runAsUser":0}}],"containers":[{"name":"rabbitmq","image":"rabbitmq:3.8.12-management","ports":[{"name":"epmd","containerPort":4369,"protocol":"TCP"},{"name":"amqp","containerPort":5672,"protocol":"TCP"},{"name":"management","containerPort":15672,"protocol":"TCP"},{"name":"prometheus","containerPort":15692,"protocol":"TCP"}],"env":[{"name":"MY_POD_NAME","valueFrom":{"fieldRef":{"apiVersion":"v1","fieldPath":"metadata.name"}}},{"name":"MY_POD_NAMESPACE","valueFrom":{"fieldRef":{"apiVersion":"v1","fieldPath":"metadata.namespace"}}},{"name":"RABBITMQ_ENABLED_PLUGINS_FILE","value":"/operator/enabled_plugins"},{"name":"K8S_SERVICE_NAME","value":"rabbitmq-cluster-nodes"},{"name":"RABBITMQ_USE_LONGNAME","value":"true"},{"name":"RABBITMQ_NODENAME","value":"rabbit@$(MY_POD_NAME).$(K8S_SERVICE_NAME).$(MY_POD_NAMESPACE)"},{"name":"K8S_HOSTNAME_SUFFIX","value":".$(K8S_SERVICE_NAME).$(MY_POD_NAMESPACE)"}],"resources":{"limits":{"cpu":"2","memory":"2Gi"},"requests":{"cpu":"1","memory":"2Gi"}},"volumeMounts":[{"name":"rabbitmq-erlang-cookie","mountPath":"/var/lib/rabbitmq/"},{"name":"persistence","mountPath":"/var/lib/rabbitmq/mnesia/"},{"name":"rabbitmq-plugins","mountPath":"/operator"},{"name":"rabbitmq-confd","mountPath":"/etc/rabbitmq/conf.d/10-operatorDefaults.conf","subPath":"operatorDefaults.conf"},{"name":"rabbitmq-confd","mountPath":"/etc/rabbitmq/conf.d/11-default_user.conf","subPath":"default_user.conf"},{"name":"rabbitmq-confd","mountPath":"/etc/rabbitmq/conf.d/90-userDefinedConfiguration.conf","subPath":"userDefinedConfiguration.conf"},{"name":"pod-info","mountPath":"/etc/pod-info/"}],"readinessProbe":{"tcpSocket":{"port":"amqp"},"initialDelaySeconds":10,"timeoutSeconds":5,"periodSeconds":10,"successThreshold":1,"failureThreshold":3},"lifecycle":{"preStop":{"exec":{"command":["/bin/bash","-c","if [ ! -z \"$(cat /etc/pod-info/skipPreStopChecks)\" ]; then exit 0; fi; rabbitmq-upgrade await_online_quorum_plus_one -t 604800; rabbitmq-upgrade await_online_synchronized_mirror -t 604800; rabbitmq-upgrade drain -t 604800"]}}},"terminationMessagePath":"/dev/termination-log","terminationMessagePolicy":"File","imagePullPolicy":"IfNotPresent"}],"restartPolicy":"Always","terminationGracePeriodSeconds":604800,"dnsPolicy":"ClusterFirst","serviceAccountName":"rabbitmq-cluster-server","serviceAccount":"rabbitmq-cluster-server","automountServiceAccountToken":true,"securityContext":{"runAsUser":999,"runAsGroup":999,"fsGroup":999},"schedulerName":"default-scheduler","topologySpreadConstraints":[{"maxSkew":1,"topologyKey":"topology.kubernetes.io/zone","whenUnsatisfiable":"ScheduleAnyway","labelSelector":{"matchLabels":{"app.kubernetes.io/name":"rabbitmq-cluster"}}}]}},"volumeClaimTemplates":[{"metadata":{"name":"persistence","namespace":"default","creationTimestamp":null,"labels":{"app.kubernetes.io/component":"rabbitmq","app.kubernetes.io/name":"rabbitmq-cluster","app.kubernetes.io/part-of":"rabbitmq"},"ownerReferences":[{"apiVersion":"rabbitmq.com/v1beta1","kind":"RabbitmqCluster","name":"rabbitmq-cluster","uid":"18d9928b-0d1c-47be-80ec-20960d053827","controller":true,"blockOwnerDeletion":false}]},"spec":{"accessModes":["ReadWriteOnce"],"resources":{"requests":{"storage":"10Gi"}},"volumeMode":"Filesystem"},"status":{"phase":"Pending"}}],"serviceName":"rabbitmq-cluster-nodes","podManagementPolicy":"Parallel","updateStrategy":{"type":"RollingUpdate","rollingUpdate":{"partition":0}},"revisionHistoryLimit":10},"status":{"observedGeneration":2,"replicas":3,"readyReplicas":3,"currentReplicas":3,"updatedReplicas":3,"currentRevision":"rabbitmq-cluster-server-5f8b8665fb","updateRevision":"rabbitmq-cluster-server-5f8b8665fb","collisionCount":0}}
2022/03/18 18:02:09 learn_server.go:291: [SIEVE-AFTER-READ]	Get	true	endpoints	default	rabbitmq-cluster	github.com/rabbitmq/cluster-operator/controllers.(*RabbitmqClusterReconciler)	NoError	{"kind":"Endpoints","apiVersion":"v1","metadata":{"name":"rabbitmq-cluster","namespace":"default","selfLink":"/api/v1/namespaces/default/endpoints/rabbitmq-cluster","uid":"5c4723ad-f4fe-442d-9135-44879a2a8183","resourceVersion":"1227","creationTimestamp":"2022-03-18T18:00:38Z","labels":{"app.kubernetes.io/component":"rabbitmq","app.kubernetes.io/name":"rabbitmq-cluster","app.kubernetes.io/part-of":"rabbitmq"},"annotations":{"endpoints.kubernetes.io/last-change-trigger-time":"2022-03-18T18:02:01Z"},"managedFields":[{"manager":"kube-controller-manager","operation":"Update","apiVersion":"v1","time":"2022-03-18T18:02:01Z","fieldsType":"FieldsV1","fieldsV1":{"f:metadata":{"f:annotations":{".":{},"f:endpoints.kubernetes.io/last-change-trigger-time":{}},"f:labels":{".":{},"f:app.kubernetes.io/component":{},"f:app.kubernetes.io/name":{},"f:app.kubernetes.io/part-of":{}}},"f:subsets":{}}}]},"subsets":[{"addresses":[{"ip":"10.244.1.4","nodeName":"kind-worker2","targetRef":{"kind":"Pod","namespace":"default","name":"rabbitmq-cluster-server-0","uid":"e7faffc5-b656-4e69-9777-92d12cb6ec5a","resourceVersion":"938"}},{"ip":"10.244.2.4","nodeName":"kind-worker","targetRef":{"kind":"Pod","namespace":"default","name":"rabbitmq-cluster-server-1","uid":"7a37da00-25d1-48b6-a659-4390fb7a02cb","resourceVersion":"1226"}},{"ip":"10.244.2.5","nodeName":"kind-worker","targetRef":{"kind":"Pod","namespace":"default","name":"rabbitmq-cluster-server-2","uid":"2a54a659-a979-4e10-8e74-1e0b83d532ba","resourceVersion":"1209"}}],"ports":[{"name":"amqp","port":5672,"protocol":"TCP"},{"name":"management","port":15672,"protocol":"TCP"}]}]}
2022/03/18 18:02:09 learn_server.go:291: [SIEVE-AFTER-READ]	Get	true	statefulset	default	rabbitmq-cluster-server	github.com/rabbitmq/cluster-operator/controllers.(*RabbitmqClusterReconciler)	NoError	{"kind":"StatefulSet","apiVersion":"apps/v1","metadata":{"name":"rabbitmq-cluster-server","namespace":"default","selfLink":"/apis/apps/v1/namespaces/default/statefulsets/rabbitmq-cluster-server","uid":"cb5c43bc-6ee7-481c-ab01-6f3acffdd3c8","resourceVersion":"1231","generation":2,"creationTimestamp":"2022-03-18T18:00:38Z","labels":{"app.kubernetes.io/component":"rabbitmq","app.kubernetes.io/name":"rabbitmq-cluster","app.kubernetes.io/part-of":"rabbitmq"},"ownerReferences":[{"apiVersion":"rabbitmq.com/v1beta1","kind":"RabbitmqCluster","name":"rabbitmq-cluster","uid":"18d9928b-0d1c-47be-80ec-20960d053827","controller":true,"blockOwnerDeletion":true}],"managedFields":[{"manager":"manager","operation":"Update","apiVersion":"apps/v1","time":"2022-03-18T18:01:23Z","fieldsType":"FieldsV1","fieldsV1":{"f:metadata":{"f:labels":{".":{},"f:app.kubernetes.io/component":{},"f:app.kubernetes.io/name":{},"f:app.kubernetes.io/part-of":{}},"f:ownerReferences":{".":{},"k:{\"uid\":\"18d9928b-0d1c-47be-80ec-20960d053827\"}":{".":{},"f:apiVersion":{},"f:blockOwnerDeletion":{},"f:controller":{},"f:kind":{},"f:name":{},"f:uid":{}}}},"f:spec":{"f:podManagementPolicy":{},"f:replicas":{},"f:revisionHistoryLimit":{},"f:selector":{"f:matchLabels":{".":{},"f:app.kubernetes.io/name":{}}},"f:serviceName":{},"f:template":{"f:metadata":{"f:annotations":{".":{},"f:prometheus.io/port":{},"f:prometheus.io/scrape":{}},"f:labels":{".":{},"f:app.kubernetes.io/component":{},"f:app.kubernetes.io/name":{},"f:app.kubernetes.io/part-of":{}}},"f:spec":{"f:automountServiceAccountToken":{},"f:containers":{"k:{\"name\":\"rabbitmq\"}":{".":{},"f:env":{".":{},"k:{\"name\":\"K8S_HOSTNAME_SUFFIX\"}":{".":{},"f:name":{},"f:value":{}},"k:{\"name\":\"K8S_SERVICE_NAME\"}":{".":{},"f:name":{},"f:value":{}},"k:{\"name\":\"MY_POD_NAME\"}":{".":{},"f:name":{},"f:valueFrom":{".":{},"f:fieldRef":{".":{},"f:apiVersion":{},"f:fieldPath":{}}}},"k:{\"name\":\"MY_POD_NAMESPACE\"}":{".":{},"f:name":{},"f:valueFrom":{".":{},"f:fieldRef":{".":{},"f:apiVersion":{},"f:fieldPath":{}}}},"k:{\"name\":\"RABBITMQ_ENABLED_PLUGINS_FILE\"}":{".":{},"f:name":{},"f:value":{}},"k:{\"name\":\"RABBITMQ_NODENAME\"}":{".":{},"f:name":{},"f:value":{}},"k:{\"name\":\"RABBITMQ_USE_LONGNAME\"}":{".":{},"f:name":{},"f:value":{}}},"f:image":{},"f:imagePullPolicy":{},"f:lifecycle":{".":{},"f:preStop":{".":{},"f:exec":{".":{},"f:command":{}}}},"f:name":{},"f:ports":{".":{},"k:{\"containerPort\":4369,\"protocol\":\"TCP\"}":{".":{},"f:containerPort":{},"f:name":{},"f:protocol":{}},"k:{\"containerPort\":5672,\"protocol\":\"TCP\"}":{".":{},"f:containerPort":{},"f:name":{},"f:protocol":{}},"k:{\"containerPort\":15672,\"protocol\":\"TCP\"}":{".":{},"f:containerPort":{},"f:name":{},"f:protocol":{}},"k:{\"containerPort\":15692,\"protocol\":\"TCP\"}":{".":{},"f:containerPort":{},"f:name":{},"f:protocol":{}}},"f:readinessProbe":{".":{},"f:failureThreshold":{},"f:initialDelaySeconds":{},"f:periodSeconds":{},"f:successThreshold":{},"f:tcpSocket":{".":{},"f:port":{}},"f:timeoutSeconds":{}},"f:resources":{".":{},"f:limits":{".":{},"f:cpu":{},"f:memory":{}},"f:requests":{".":{},"f:cpu":{},"f:memory":{}}},"f:terminationMessagePath":{},"f:terminationMessagePolicy":{},"f:volumeMounts":{".":{},"k:{\"mountPath\":\"/etc/pod-info/\"}":{".":{},"f:mountPath":{},"f:name":{}},"k:{\"mountPath\":\"/etc/rabbitmq/conf.d/10-operatorDefaults.conf\"}":{".":{},"f:mountPath":{},"f:name":{},"f:subPath":{}},"k:{\"mountPath\":\"/etc/rabbitmq/conf.d/11-default_user.conf\"}":{".":{},"f:mountPath":{},"f:name":{},"f:subPath":{}},"k:{\"mountPath\":\"/etc/rabbitmq/conf.d/90-userDefinedConfiguration.conf\"}":{".":{},"f:mountPath":{},"f:name":{},"f:subPath":{}},"k:{\"mountPath\":\"/operator\"}":{".":{},"f:mountPath":{},"f:name":{}},"k:{\"mountPath\":\"/var/lib/rabbitmq/\"}":{".":{},"f:mountPath":{},"f:name":{}},"k:{\"mountPath\":\"/var/lib/rabbitmq/mnesia/\"}":{".":{},"f:mountPath":{},"f:name":{}}}}},"f:dnsPolicy":{},"f:initContainers":{".":{},"k:{\"name\":\"setup-container\"}":{".":{},"f:command":{},"f:image":{},"f:imagePullPolicy":{},"f:name":{},"f:resources":{".":{},"f:limits":{".":{},"f:cpu":{},"f:memory":{}},"f:requests":{".":{},"f:cpu":{},"f:memory":{}}},"f:securityContext":{".":{},"f:capabilities":{".":{},"f:drop":{}},"f:runAsUser":{}},"f:terminationMessagePath":{},"f:terminationMessagePolicy":{},"f:volumeMounts":{".":{},"k:{\"mountPath\":\"/operator\"}":{".":{},"f:mountPath":{},"f:name":{}},"k:{\"mountPath\":\"/tmp/default_user.conf\"}":{".":{},"f:mountPath":{},"f:name":{},"f:subPath":{}},"k:{\"mountPath\":\"/tmp/erlang-cookie-secret/\"}":{".":{},"f:mountPath":{},"f:name":{}},"k:{\"mountPath\":\"/tmp/rabbitmq-plugins/\"}":{".":{},"f:mountPath":{},"f:name":{}},"k:{\"mountPath\":\"/var/lib/rabbitmq/\"}":{".":{},"f:mountPath":{},"f:name":{}},"k:{\"mountPath\":\"/var/lib/rabbitmq/mnesia/\"}":{".":{},"f:mountPath":{},"f:name":{}}}}},"f:restartPolicy":{},"f:schedulerName":{},"f:securityContext":{".":{},"f:fsGroup":{},"f:runAsGroup":{},"f:runAsUser":{}},"f:serviceAccount":{},"f:serviceAccountName":{},"f:terminationGracePeriodSeconds":{},"f:topologySpreadConstraints":{".":{},"k:{\"topologyKey\":\"topology.kubernetes.io/zone\",\"whenUnsatisfiable\":\"ScheduleAnyway\"}":{".":{},"f:labelSelector":{".":{},"f:matchLabels":{".":{},"f:app.kubernetes.io/name":{}}},"f:maxSkew":{},"f:topologyKey":{},"f:whenUnsatisfiable":{}}},"f:volumes":{".":{},"k:{\"name\":\"erlang-cookie-secret\"}":{".":{},"f:name":{},"f:secret":{".":{},"f:defaultMode":{},"f:secretName":{}}},"k:{\"name\":\"plugins-conf\"}":{".":{},"f:configMap":{".":{},"f:defaultMode":{},"f:name":{}},"f:name":{}},"k:{\"name\":\"pod-info\"}":{".":{},"f:downwardAPI":{".":{},"f:defaultMode":{},"f:items":{}},"f:name":{}},"k:{\"name\":\"rabbitmq-confd\"}":{".":{},"f:name":{},"f:projected":{".":{},"f:defaultMode":{},"f:sources":{}}},"k:{\"name\":\"rabbitmq-erlang-cookie\"}":{".":{},"f:emptyDir":{},"f:name":{}},"k:{\"name\":\"rabbitmq-plugins\"}":{".":{},"f:emptyDir":{},"f:name":{}}}}},"f:updateStrategy":{"f:rollingUpdate":{".":{},"f:partition":{}},"f:type":{}},"f:volumeClaimTemplates":{}}}},{"manager":"kube-controller-manager","operation":"Update","apiVersion":"apps/v1","time":"2022-03-18T18:02:01Z","fieldsType":"FieldsV1","fieldsV1":{"f:status":{"f:collisionCount":{},"f:currentReplicas":{},"f:currentRevision":{},"f:observedGeneration":{},"f:readyReplicas":{},"f:replicas":{},"f:updateRevision":{},"f:updatedReplicas":{}}}}]},"spec":{"replicas":3,"selector":{"matchLabels":{"app.kubernetes.io/name":"rabbitmq-cluster"}},"template":{"metadata":{"creationTimestamp":null,"labels":{"app.kubernetes.io/component":"rabbitmq","app.kubernetes.io/name":"rabbitmq-cluster","app.kubernetes.io/part-of":"rabbitmq"},"annotations":{"prometheus.io/port":"15692","prometheus.io/scrape":"true"}},"spec":{"volumes":[{"name":"plugins-conf","configMap":{"name":"rabbitmq-cluster-plugins-conf","defaultMode":420}},{"name":"rabbitmq-confd","projected":{"sources":[{"secret":{"name":"rabbitmq-cluster-default-user","items":[{"key":"default_user.conf","path":"default_user.conf"}]}},{"configMap":{"name":"rabbitmq-cluster-server-conf","items":[{"key":"operatorDefaults.conf","path":"operatorDefaults.conf"},{"key":"userDefinedConfiguration.conf","path":"userDefinedConfiguration.conf"}]}}],"defaultMode":420}},{"name":"rabbitmq-erlang-cookie","emptyDir":{}},{"name":"erlang-cookie-secret","secret":{"secretName":"rabbitmq-cluster-erlang-cookie","defaultMode":420}},{"name":"rabbitmq-plugins","emptyDir":{}},{"name":"pod-info","downwardAPI":{"items":[{"path":"skipPreStopChecks","fieldRef":{"apiVersion":"v1","fieldPath":"metadata.labels['skipPreStopChecks']"}}],"defaultMode":420}}],"initContainers":[{"name":"setup-container","image":"rabbitmq:3.8.12-management","command":["sh","-c","cp /tmp/erlang-cookie-secret/.erlang.cookie /var/lib/rabbitmq/.erlang.cookie \u0026\u0026 chown 999:999 /var/lib/rabbitmq/.erlang.cookie \u0026\u0026 chmod 600 /var/lib/rabbitmq/.erlang.cookie ; cp /tmp/rabbitmq-plugins/enabled_plugins /operator/enabled_plugins \u0026\u0026 chown 999:999 /operator/enabled_plugins ; chown 999:999 /var/lib/rabbitmq/mnesia/ ; echo '[default]' \u003e /var/lib/rabbitmq/.rabbitmqadmin.conf \u0026\u0026 sed -e 's/default_user/username/' -e 's/default_pass/password/' /tmp/default_user.conf \u003e\u003e /var/lib/rabbitmq/.rabbitmqadmin.conf \u0026\u0026 chown 999:999 /var/lib/rabbitmq/.rabbitmqadmin.conf \u0026\u0026 chmod 600 /var/lib/rabbitmq/.rabbitmqadmin.conf"],"resources":{"limits":{"cpu":"100m","memory":"500Mi"},"requests":{"cpu":"100m","memory":"500Mi"}},"volumeMounts":[{"name":"plugins-conf","mountPath":"/tmp/rabbitmq-plugins/"},{"name":"rabbitmq-erlang-cookie","mountPath":"/var/lib/rabbitmq/"},{"name":"erlang-cookie-secret","mountPath":"/tmp/erlang-cookie-secret/"},{"name":"rabbitmq-plugins","mountPath":"/operator"},{"name":"persistence","mountPath":"/var/lib/rabbitmq/mnesia/"},{"name":"rabbitmq-confd","mountPath":"/tmp/default_user.conf","subPath":"default_user.conf"}],"terminationMessagePath":"/dev/termination-log","terminationMessagePolicy":"File","imagePullPolicy":"IfNotPresent","securityContext":{"capabilities":{"drop":["FSETID","KILL","SETGID","SETUID","SETPCAP","NET_BIND_SERVICE","NET_RAW","SYS_CHROOT","MKNOD","AUDIT_WRITE","SETFCAP"]},"runAsUser":0}}],"containers":[{"name":"rabbitmq","image":"rabbitmq:3.8.12-management","ports":[{"name":"epmd","containerPort":4369,"protocol":"TCP"},{"name":"amqp","containerPort":5672,"protocol":"TCP"},{"name":"management","containerPort":15672,"protocol":"TCP"},{"name":"prometheus","containerPort":15692,"protocol":"TCP"}],"env":[{"name":"MY_POD_NAME","valueFrom":{"fieldRef":{"apiVersion":"v1","fieldPath":"metadata.name"}}},{"name":"MY_POD_NAMESPACE","valueFrom":{"fieldRef":{"apiVersion":"v1","fieldPath":"metadata.namespace"}}},{"name":"RABBITMQ_ENABLED_PLUGINS_FILE","value":"/operator/enabled_plugins"},{"name":"K8S_SERVICE_NAME","value":"rabbitmq-cluster-nodes"},{"name":"RABBITMQ_USE_LONGNAME","value":"true"},{"name":"RABBITMQ_NODENAME","value":"rabbit@$(MY_POD_NAME).$(K8S_SERVICE_NAME).$(MY_POD_NAMESPACE)"},{"name":"K8S_HOSTNAME_SUFFIX","value":".$(K8S_SERVICE_NAME).$(MY_POD_NAMESPACE)"}],"resources":{"limits":{"cpu":"2","memory":"2Gi"},"requests":{"cpu":"1","memory":"2Gi"}},"volumeMounts":[{"name":"rabbitmq-erlang-cookie","mountPath":"/var/lib/rabbitmq/"},{"name":"persistence","mountPath":"/var/lib/rabbitmq/mnesia/"},{"name":"rabbitmq-plugins","mountPath":"/operator"},{"name":"rabbitmq-confd","mountPath":"/etc/rabbitmq/conf.d/10-operatorDefaults.conf","subPath":"operatorDefaults.conf"},{"name":"rabbitmq-confd","mountPath":"/etc/rabbitmq/conf.d/11-default_user.conf","subPath":"default_user.conf"},{"name":"rabbitmq-confd","mountPath":"/etc/rabbitmq/conf.d/90-userDefinedConfiguration.conf","subPath":"userDefinedConfiguration.conf"},{"name":"pod-info","mountPath":"/etc/pod-info/"}],"readinessProbe":{"tcpSocket":{"port":"amqp"},"initialDelaySeconds":10,"timeoutSeconds":5,"periodSeconds":10,"successThreshold":1,"failureThreshold":3},"lifecycle":{"preStop":{"exec":{"command":["/bin/bash","-c","if [ ! -z \"$(cat /etc/pod-info/skipPreStopChecks)\" ]; then exit 0; fi; rabbitmq-upgrade await_online_quorum_plus_one -t 604800; rabbitmq-upgrade await_online_synchronized_mirror -t 604800; rabbitmq-upgrade drain -t 604800"]}}},"terminationMessagePath":"/dev/termination-log","terminationMessagePolicy":"File","imagePullPolicy":"IfNotPresent"}],"restartPolicy":"Always","terminationGracePeriodSeconds":604800,"dnsPolicy":"ClusterFirst","serviceAccountName":"rabbitmq-cluster-server","serviceAccount":"rabbitmq-cluster-server","automountServiceAccountToken":true,"securityContext":{"runAsUser":999,"runAsGroup":999,"fsGroup":999},"schedulerName":"default-scheduler","topologySpreadConstraints":[{"maxSkew":1,"topologyKey":"topology.kubernetes.io/zone","whenUnsatisfiable":"ScheduleAnyway","labelSelector":{"matchLabels":{"app.kubernetes.io/name":"rabbitmq-cluster"}}}]}},"volumeClaimTemplates":[{"metadata":{"name":"persistence","namespace":"default","creationTimestamp":null,"labels":{"app.kubernetes.io/component":"rabbitmq","app.kubernetes.io/name":"rabbitmq-cluster","app.kubernetes.io/part-of":"rabbitmq"},"ownerReferences":[{"apiVersion":"rabbitmq.com/v1beta1","kind":"RabbitmqCluster","name":"rabbitmq-cluster","uid":"18d9928b-0d1c-47be-80ec-20960d053827","controller":true,"blockOwnerDeletion":false}]},"spec":{"accessModes":["ReadWriteOnce"],"resources":{"requests":{"storage":"10Gi"}},"volumeMode":"Filesystem"},"status":{"phase":"Pending"}}],"serviceName":"rabbitmq-cluster-nodes","podManagementPolicy":"Parallel","updateStrategy":{"type":"RollingUpdate","rollingUpdate":{"partition":0}},"revisionHistoryLimit":10},"status":{"observedGeneration":2,"replicas":3,"readyReplicas":3,"currentReplicas":3,"updatedReplicas":3,"currentRevision":"rabbitmq-cluster-server-5f8b8665fb","updateRevision":"rabbitmq-cluster-server-5f8b8665fb","collisionCount":0}}
2022/03/18 18:02:09 learn_server.go:291: [SIEVE-AFTER-READ]	Get	true	service	default	rabbitmq-cluster-nodes	github.com/rabbitmq/cluster-operator/controllers.(*RabbitmqClusterReconciler)	NoError	{"kind":"Service","apiVersion":"v1","metadata":{"name":"rabbitmq-cluster-nodes","namespace":"default","selfLink":"/api/v1/namespaces/default/services/rabbitmq-cluster-nodes","uid":"67c7eea9-1b87-4fd7-82e6-5bfe31fd1b52","resourceVersion":"696","creationTimestamp":"2022-03-18T18:00:38Z","labels":{"app.kubernetes.io/component":"rabbitmq","app.kubernetes.io/name":"rabbitmq-cluster","app.kubernetes.io/part-of":"rabbitmq"},"ownerReferences":[{"apiVersion":"rabbitmq.com/v1beta1","kind":"RabbitmqCluster","name":"rabbitmq-cluster","uid":"18d9928b-0d1c-47be-80ec-20960d053827","controller":true,"blockOwnerDeletion":true}],"managedFields":[{"manager":"manager","operation":"Update","apiVersion":"v1","time":"2022-03-18T18:00:38Z","fieldsType":"FieldsV1","fieldsV1":{"f:metadata":{"f:labels":{".":{},"f:app.kubernetes.io/component":{},"f:app.kubernetes.io/name":{},"f:app.kubernetes.io/part-of":{}},"f:ownerReferences":{".":{},"k:{\"uid\":\"18d9928b-0d1c-47be-80ec-20960d053827\"}":{".":{},"f:apiVersion":{},"f:blockOwnerDeletion":{},"f:controller":{},"f:kind":{},"f:name":{},"f:uid":{}}}},"f:spec":{"f:clusterIP":{},"f:ports":{".":{},"k:{\"port\":4369,\"protocol\":\"TCP\"}":{".":{},"f:name":{},"f:port":{},"f:protocol":{},"f:targetPort":{}},"k:{\"port\":25672,\"protocol\":\"TCP\"}":{".":{},"f:name":{},"f:port":{},"f:protocol":{},"f:targetPort":{}}},"f:publishNotReadyAddresses":{},"f:selector":{".":{},"f:app.kubernetes.io/name":{}},"f:sessionAffinity":{},"f:type":{}}}}]},"spec":{"ports":[{"name":"epmd","protocol":"TCP","port":4369,"targetPort":4369},{"name":"cluster-rpc","protocol":"TCP","port":25672,"targetPort":25672}],"selector":{"app.kubernetes.io/name":"rabbitmq-cluster"},"clusterIP":"None","type":"ClusterIP","sessionAffinity":"None","publishNotReadyAddresses":true},"status":{"loadBalancer":{}}}
2022/03/18 18:02:09 learn_server.go:291: [SIEVE-AFTER-READ]	Get	true	service	default	rabbitmq-cluster	github.com/rabbitmq/cluster-operator/controllers.(*RabbitmqClusterReconciler)	NoError	{"kind":"Service","apiVersion":"v1","metadata":{"name":"rabbitmq-cluster","namespace":"default","selfLink":"/api/v1/namespaces/default/services/rabbitmq-cluster","uid":"56b50671-1945-458b-adac-05619b783392","resourceVersion":"701","creationTimestamp":"2022-03-18T18:00:38Z","labels":{"app.kubernetes.io/component":"rabbitmq","app.kubernetes.io/name":"rabbitmq-cluster","app.kubernetes.io/part-of":"rabbitmq"},"ownerReferences":[{"apiVersion":"rabbitmq.com/v1beta1","kind":"RabbitmqCluster","name":"rabbitmq-cluster","uid":"18d9928b-0d1c-47be-80ec-20960d053827","controller":true,"blockOwnerDeletion":true}],"managedFields":[{"manager":"manager","operation":"Update","apiVersion":"v1","time":"2022-03-18T18:00:38Z","fieldsType":"FieldsV1","fieldsV1":{"f:metadata":{"f:labels":{".":{},"f:app.kubernetes.io/component":{},"f:app.kubernetes.io/name":{},"f:app.kubernetes.io/part-of":{}},"f:ownerReferences":{".":{},"k:{\"uid\":\"18d9928b-0d1c-47be-80ec-20960d053827\"}":{".":{},"f:apiVersion":{},"f:blockOwnerDeletion":{},"f:controller":{},"f:kind":{},"f:name":{},"f:uid":{}}}},"f:spec":{"f:ports":{".":{},"k:{\"port\":5672,\"protocol\":\"TCP\"}":{".":{},"f:name":{},"f:port":{},"f:protocol":{},"f:targetPort":{}},"k:{\"port\":15672,\"protocol\":\"TCP\"}":{".":{},"f:name":{},"f:port":{},"f:protocol":{},"f:targetPort":{}}},"f:selector":{".":{},"f:app.kubernetes.io/name":{}},"f:sessionAffinity":{},"f:type":{}}}}]},"spec":{"ports":[{"name":"amqp","protocol":"TCP","port":5672,"targetPort":5672},{"name":"management","protocol":"TCP","port":15672,"targetPort":15672}],"selector":{"app.kubernetes.io/name":"rabbitmq-cluster"},"clusterIP":"10.96.254.158","type":"ClusterIP","sessionAffinity":"None"},"status":{"loadBalancer":{}}}
2022/03/18 18:02:09 learn_server.go:291: [SIEVE-AFTER-READ]	Get	true	secret	default	rabbitmq-cluster-erlang-cookie	github.com/rabbitmq/cluster-operator/controllers.(*RabbitmqClusterReconciler)	NoError	{"kind":"Secret","apiVersion":"v1","metadata":{"name":"rabbitmq-cluster-erlang-cookie","namespace":"default","selfLink":"/api/v1/namespaces/default/secrets/rabbitmq-cluster-erlang-cookie","uid":"f8fbe8a6-0f40-4e13-960b-ab78b8ba75b0","resourceVersion":"705","creationTimestamp":"2022-03-18T18:00:38Z","labels":{"app.kubernetes.io/component":"rabbitmq","app.kubernetes.io/name":"rabbitmq-cluster","app.kubernetes.io/part-of":"rabbitmq"},"ownerReferences":[{"apiVersion":"rabbitmq.com/v1beta1","kind":"RabbitmqCluster","name":"rabbitmq-cluster","uid":"18d9928b-0d1c-47be-80ec-20960d053827","controller":true,"blockOwnerDeletion":true}],"managedFields":[{"manager":"manager","operation":"Update","apiVersion":"v1","time":"2022-03-18T18:00:38Z","fieldsType":"FieldsV1","fieldsV1":{"f:data":{".":{},"f:.erlang.cookie":{}},"f:metadata":{"f:labels":{".":{},"f:app.kubernetes.io/component":{},"f:app.kubernetes.io/name":{},"f:app.kubernetes.io/part-of":{}},"f:ownerReferences":{".":{},"k:{\"uid\":\"18d9928b-0d1c-47be-80ec-20960d053827\"}":{".":{},"f:apiVersion":{},"f:blockOwnerDeletion":{},"f:controller":{},"f:kind":{},"f:name":{},"f:uid":{}}}},"f:type":{}}}]},"data":{".erlang.cookie":"QW9hMkpWU0tlYS1FUGdWTUhrelNMNnFoMFZ0ZmRGNUY="},"type":"Opaque"}
2022/03/18 18:02:09 learn_server.go:291: [SIEVE-AFTER-READ]	Get	true	secret	default	rabbitmq-cluster-default-user	github.com/rabbitmq/cluster-operator/controllers.(*RabbitmqClusterReconciler)	NoError	{"kind":"Secret","apiVersion":"v1","metadata":{"name":"rabbitmq-cluster-default-user","namespace":"default","selfLink":"/api/v1/namespaces/default/secrets/rabbitmq-cluster-default-user","uid":"0d9f460b-a23c-402b-8273-f541ed39023f","resourceVersion":"708","creationTimestamp":"2022-03-18T18:00:38Z","labels":{"app.kubernetes.io/component":"rabbitmq","app.kubernetes.io/name":"rabbitmq-cluster","app.kubernetes.io/part-of":"rabbitmq"},"ownerReferences":[{"apiVersion":"rabbitmq.com/v1beta1","kind":"RabbitmqCluster","name":"rabbitmq-cluster","uid":"18d9928b-0d1c-47be-80ec-20960d053827","controller":true,"blockOwnerDeletion":true}],"managedFields":[{"manager":"manager","operation":"Update","apiVersion":"v1","time":"2022-03-18T18:00:38Z","fieldsType":"FieldsV1","fieldsV1":{"f:data":{".":{},"f:default_user.conf":{},"f:password":{},"f:provider":{},"f:type":{},"f:username":{}},"f:metadata":{"f:labels":{".":{},"f:app.kubernetes.io/component":{},"f:app.kubernetes.io/name":{},"f:app.kubernetes.io/part-of":{}},"f:ownerReferences":{".":{},"k:{\"uid\":\"18d9928b-0d1c-47be-80ec-20960d053827\"}":{".":{},"f:apiVersion":{},"f:blockOwnerDeletion":{},"f:controller":{},"f:kind":{},"f:name":{},"f:uid":{}}}},"f:type":{}}}]},"data":{"default_user.conf":"ZGVmYXVsdF91c2VyID0gcTMxRmh3MGtjWW9SZUl5X3BPTXp2ZVBOUnNVU3I1Mk8KZGVmYXVsdF9wYXNzID0gY0dBX19jNTJHX05hVURpTGhraWZ6UDBOVVlNLTE2MWQK","password":"Y0dBX19jNTJHX05hVURpTGhraWZ6UDBOVVlNLTE2MWQ=","provider":"cmFiYml0bXE=","type":"cmFiYml0bXE=","username":"cTMxRmh3MGtjWW9SZUl5X3BPTXp2ZVBOUnNVU3I1Mk8="},"type":"Opaque"}
2022/03/18 18:02:09 learn_server.go:291: [SIEVE-AFTER-READ]	Get	true	configmap	default	rabbitmq-cluster-plugins-conf	github.com/rabbitmq/cluster-operator/controllers.(*RabbitmqClusterReconciler)	NoError	{"kind":"ConfigMap","apiVersion":"v1","metadata":{"name":"rabbitmq-cluster-plugins-conf","namespace":"default","selfLink":"/api/v1/namespaces/default/configmaps/rabbitmq-cluster-plugins-conf","uid":"a164075b-0562-47ac-a577-99aa8651ec40","resourceVersion":"709","creationTimestamp":"2022-03-18T18:00:38Z","labels":{"app.kubernetes.io/component":"rabbitmq","app.kubernetes.io/name":"rabbitmq-cluster","app.kubernetes.io/part-of":"rabbitmq"},"ownerReferences":[{"apiVersion":"rabbitmq.com/v1beta1","kind":"RabbitmqCluster","name":"rabbitmq-cluster","uid":"18d9928b-0d1c-47be-80ec-20960d053827","controller":true,"blockOwnerDeletion":true}],"managedFields":[{"manager":"manager","operation":"Update","apiVersion":"v1","time":"2022-03-18T18:00:38Z","fieldsType":"FieldsV1","fieldsV1":{"f:data":{".":{},"f:enabled_plugins":{}},"f:metadata":{"f:labels":{".":{},"f:app.kubernetes.io/component":{},"f:app.kubernetes.io/name":{},"f:app.kubernetes.io/part-of":{}},"f:ownerReferences":{".":{},"k:{\"uid\":\"18d9928b-0d1c-47be-80ec-20960d053827\"}":{".":{},"f:apiVersion":{},"f:blockOwnerDeletion":{},"f:controller":{},"f:kind":{},"f:name":{},"f:uid":{}}}}}}]},"data":{"enabled_plugins":"[rabbitmq_peer_discovery_k8s,rabbitmq_prometheus,rabbitmq_management]."}}
2022/03/18 18:02:09 learn_server.go:291: [SIEVE-AFTER-READ]	Get	true	configmap	default	rabbitmq-cluster-server-conf	github.com/rabbitmq/cluster-operator/controllers.(*RabbitmqClusterReconciler)	NoError	{"kind":"ConfigMap","apiVersion":"v1","metadata":{"name":"rabbitmq-cluster-server-conf","namespace":"default","selfLink":"/api/v1/namespaces/default/configmaps/rabbitmq-cluster-server-conf","uid":"22474f2b-8454-44b7-8079-8990223969cc","resourceVersion":"714","creationTimestamp":"2022-03-18T18:00:38Z","labels":{"app.kubernetes.io/component":"rabbitmq","app.kubernetes.io/name":"rabbitmq-cluster","app.kubernetes.io/part-of":"rabbitmq"},"ownerReferences":[{"apiVersion":"rabbitmq.com/v1beta1","kind":"RabbitmqCluster","name":"rabbitmq-cluster","uid":"18d9928b-0d1c-47be-80ec-20960d053827","controller":true,"blockOwnerDeletion":true}],"managedFields":[{"manager":"manager","operation":"Update","apiVersion":"v1","time":"2022-03-18T18:00:38Z","fieldsType":"FieldsV1","fieldsV1":{"f:data":{".":{},"f:operatorDefaults.conf":{},"f:userDefinedConfiguration.conf":{}},"f:metadata":{"f:labels":{".":{},"f:app.kubernetes.io/component":{},"f:app.kubernetes.io/name":{},"f:app.kubernetes.io/part-of":{}},"f:ownerReferences":{".":{},"k:{\"uid\":\"18d9928b-0d1c-47be-80ec-20960d053827\"}":{".":{},"f:apiVersion":{},"f:blockOwnerDeletion":{},"f:controller":{},"f:kind":{},"f:name":{},"f:uid":{}}}}}}]},"data":{"operatorDefaults.conf":"cluster_formation.peer_discovery_backend             = rabbit_peer_discovery_k8s\ncluster_formation.k8s.host                           = kubernetes.default\ncluster_formation.k8s.address_type                   = hostname\ncluster_partition_handling                           = pause_minority\nqueue_master_locator                                 = min-masters\ndisk_free_limit.absolute                             = 2GB\ncluster_formation.randomized_startup_delay_range.min = 5\ncluster_formation.randomized_startup_delay_range.max = 30\ncluster_name                                         = rabbitmq-cluster\n","userDefinedConfiguration.conf":"total_memory_available_override_value = 1717986919\n"}}
2022/03/18 18:02:09 learn_server.go:291: [SIEVE-AFTER-READ]	Get	true	serviceaccount	default	rabbitmq-cluster-server	github.com/rabbitmq/cluster-operator/controllers.(*RabbitmqClusterReconciler)	NoError	{"kind":"ServiceAccount","apiVersion":"v1","metadata":{"name":"rabbitmq-cluster-server","namespace":"default","selfLink":"/api/v1/namespaces/default/serviceaccounts/rabbitmq-cluster-server","uid":"731589b5-ac97-4774-bee4-008949b54734","resourceVersion":"722","creationTimestamp":"2022-03-18T18:00:38Z","labels":{"app.kubernetes.io/component":"rabbitmq","app.kubernetes.io/name":"rabbitmq-cluster","app.kubernetes.io/part-of":"rabbitmq"},"ownerReferences":[{"apiVersion":"rabbitmq.com/v1beta1","kind":"RabbitmqCluster","name":"rabbitmq-cluster","uid":"18d9928b-0d1c-47be-80ec-20960d053827","controller":true,"blockOwnerDeletion":true}],"managedFields":[{"manager":"kube-controller-manager","operation":"Update","apiVersion":"v1","time":"2022-03-18T18:00:38Z","fieldsType":"FieldsV1","fieldsV1":{"f:secrets":{".":{},"k:{\"name\":\"rabbitmq-cluster-server-token-rhzq9\"}":{".":{},"f:name":{}}}}},{"manager":"manager","operation":"Update","apiVersion":"v1","time":"2022-03-18T18:00:38Z","fieldsType":"FieldsV1","fieldsV1":{"f:metadata":{"f:labels":{".":{},"f:app.kubernetes.io/component":{},"f:app.kubernetes.io/name":{},"f:app.kubernetes.io/part-of":{}},"f:ownerReferences":{".":{},"k:{\"uid\":\"18d9928b-0d1c-47be-80ec-20960d053827\"}":{".":{},"f:apiVersion":{},"f:blockOwnerDeletion":{},"f:controller":{},"f:kind":{},"f:name":{},"f:uid":{}}}}}}]},"secrets":[{"name":"rabbitmq-cluster-server-token-rhzq9"}]}
2022/03/18 18:02:09 learn_server.go:291: [SIEVE-AFTER-READ]	Get	true	role	default	rabbitmq-cluster-peer-discovery	github.com/rabbitmq/cluster-operator/controllers.(*RabbitmqClusterReconciler)	NoError	{"kind":"Role","apiVersion":"rbac.authorization.k8s.io/v1","metadata":{"name":"rabbitmq-cluster-peer-discovery","namespace":"default","selfLink":"/apis/rbac.authorization.k8s.io/v1/namespaces/default/roles/rabbitmq-cluster-peer-discovery","uid":"52c80b50-4fdd-4089-bbfd-9756465953f2","resourceVersion":"723","creationTimestamp":"2022-03-18T18:00:38Z","labels":{"app.kubernetes.io/component":"rabbitmq","app.kubernetes.io/name":"rabbitmq-cluster","app.kubernetes.io/part-of":"rabbitmq"},"ownerReferences":[{"apiVersion":"rabbitmq.com/v1beta1","kind":"RabbitmqCluster","name":"rabbitmq-cluster","uid":"18d9928b-0d1c-47be-80ec-20960d053827","controller":true,"blockOwnerDeletion":true}],"managedFields":[{"manager":"manager","operation":"Update","apiVersion":"rbac.authorization.k8s.io/v1","time":"2022-03-18T18:00:38Z","fieldsType":"FieldsV1","fieldsV1":{"f:metadata":{"f:labels":{".":{},"f:app.kubernetes.io/component":{},"f:app.kubernetes.io/name":{},"f:app.kubernetes.io/part-of":{}},"f:ownerReferences":{".":{},"k:{\"uid\":\"18d9928b-0d1c-47be-80ec-20960d053827\"}":{".":{},"f:apiVersion":{},"f:blockOwnerDeletion":{},"f:controller":{},"f:kind":{},"f:name":{},"f:uid":{}}}},"f:rules":{}}}]},"rules":[{"verbs":["get"],"apiGroups":[""],"resources":["endpoints"]},{"verbs":["create"],"apiGroups":[""],"resources":["events"]}]}
2022/03/18 18:02:09 learn_server.go:291: [SIEVE-AFTER-READ]	Get	true	rolebinding	default	rabbitmq-cluster-server	github.com/rabbitmq/cluster-operator/controllers.(*RabbitmqClusterReconciler)	NoError	{"kind":"RoleBinding","apiVersion":"rbac.authorization.k8s.io/v1","metadata":{"name":"rabbitmq-cluster-server","namespace":"default","selfLink":"/apis/rbac.authorization.k8s.io/v1/namespaces/default/rolebindings/rabbitmq-cluster-server","uid":"495e9f7c-a20d-4515-86b0-34149a855034","resourceVersion":"725","creationTimestamp":"2022-03-18T18:00:38Z","labels":{"app.kubernetes.io/component":"rabbitmq","app.kubernetes.io/name":"rabbitmq-cluster","app.kubernetes.io/part-of":"rabbitmq"},"ownerReferences":[{"apiVersion":"rabbitmq.com/v1beta1","kind":"RabbitmqCluster","name":"rabbitmq-cluster","uid":"18d9928b-0d1c-47be-80ec-20960d053827","controller":true,"blockOwnerDeletion":true}],"managedFields":[{"manager":"manager","operation":"Update","apiVersion":"rbac.authorization.k8s.io/v1","time":"2022-03-18T18:00:38Z","fieldsType":"FieldsV1","fieldsV1":{"f:metadata":{"f:labels":{".":{},"f:app.kubernetes.io/component":{},"f:app.kubernetes.io/name":{},"f:app.kubernetes.io/part-of":{}},"f:ownerReferences":{".":{},"k:{\"uid\":\"18d9928b-0d1c-47be-80ec-20960d053827\"}":{".":{},"f:apiVersion":{},"f:blockOwnerDeletion":{},"f:controller":{},"f:kind":{},"f:name":{},"f:uid":{}}}},"f:roleRef":{"f:apiGroup":{},"f:kind":{},"f:name":{}},"f:subjects":{}}}]},"subjects":[{"kind":"ServiceAccount","name":"rabbitmq-cluster-server"}],"roleRef":{"apiGroup":"rbac.authorization.k8s.io","kind":"Role","name":"rabbitmq-cluster-peer-discovery"}}
2022/03/18 18:02:09 learn_server.go:291: [SIEVE-AFTER-READ]	Get	true	statefulset	default	rabbitmq-cluster-server	github.com/rabbitmq/cluster-operator/controllers.(*RabbitmqClusterReconciler)	NoError	{"kind":"StatefulSet","apiVersion":"apps/v1","metadata":{"name":"rabbitmq-cluster-server","namespace":"default","selfLink":"/apis/apps/v1/namespaces/default/statefulsets/rabbitmq-cluster-server","uid":"cb5c43bc-6ee7-481c-ab01-6f3acffdd3c8","resourceVersion":"1231","generation":2,"creationTimestamp":"2022-03-18T18:00:38Z","labels":{"app.kubernetes.io/component":"rabbitmq","app.kubernetes.io/name":"rabbitmq-cluster","app.kubernetes.io/part-of":"rabbitmq"},"ownerReferences":[{"apiVersion":"rabbitmq.com/v1beta1","kind":"RabbitmqCluster","name":"rabbitmq-cluster","uid":"18d9928b-0d1c-47be-80ec-20960d053827","controller":true,"blockOwnerDeletion":true}],"managedFields":[{"manager":"manager","operation":"Update","apiVersion":"apps/v1","time":"2022-03-18T18:01:23Z","fieldsType":"FieldsV1","fieldsV1":{"f:metadata":{"f:labels":{".":{},"f:app.kubernetes.io/component":{},"f:app.kubernetes.io/name":{},"f:app.kubernetes.io/part-of":{}},"f:ownerReferences":{".":{},"k:{\"uid\":\"18d9928b-0d1c-47be-80ec-20960d053827\"}":{".":{},"f:apiVersion":{},"f:blockOwnerDeletion":{},"f:controller":{},"f:kind":{},"f:name":{},"f:uid":{}}}},"f:spec":{"f:podManagementPolicy":{},"f:replicas":{},"f:revisionHistoryLimit":{},"f:selector":{"f:matchLabels":{".":{},"f:app.kubernetes.io/name":{}}},"f:serviceName":{},"f:template":{"f:metadata":{"f:annotations":{".":{},"f:prometheus.io/port":{},"f:prometheus.io/scrape":{}},"f:labels":{".":{},"f:app.kubernetes.io/component":{},"f:app.kubernetes.io/name":{},"f:app.kubernetes.io/part-of":{}}},"f:spec":{"f:automountServiceAccountToken":{},"f:containers":{"k:{\"name\":\"rabbitmq\"}":{".":{},"f:env":{".":{},"k:{\"name\":\"K8S_HOSTNAME_SUFFIX\"}":{".":{},"f:name":{},"f:value":{}},"k:{\"name\":\"K8S_SERVICE_NAME\"}":{".":{},"f:name":{},"f:value":{}},"k:{\"name\":\"MY_POD_NAME\"}":{".":{},"f:name":{},"f:valueFrom":{".":{},"f:fieldRef":{".":{},"f:apiVersion":{},"f:fieldPath":{}}}},"k:{\"name\":\"MY_POD_NAMESPACE\"}":{".":{},"f:name":{},"f:valueFrom":{".":{},"f:fieldRef":{".":{},"f:apiVersion":{},"f:fieldPath":{}}}},"k:{\"name\":\"RABBITMQ_ENABLED_PLUGINS_FILE\"}":{".":{},"f:name":{},"f:value":{}},"k:{\"name\":\"RABBITMQ_NODENAME\"}":{".":{},"f:name":{},"f:value":{}},"k:{\"name\":\"RABBITMQ_USE_LONGNAME\"}":{".":{},"f:name":{},"f:value":{}}},"f:image":{},"f:imagePullPolicy":{},"f:lifecycle":{".":{},"f:preStop":{".":{},"f:exec":{".":{},"f:command":{}}}},"f:name":{},"f:ports":{".":{},"k:{\"containerPort\":4369,\"protocol\":\"TCP\"}":{".":{},"f:containerPort":{},"f:name":{},"f:protocol":{}},"k:{\"containerPort\":5672,\"protocol\":\"TCP\"}":{".":{},"f:containerPort":{},"f:name":{},"f:protocol":{}},"k:{\"containerPort\":15672,\"protocol\":\"TCP\"}":{".":{},"f:containerPort":{},"f:name":{},"f:protocol":{}},"k:{\"containerPort\":15692,\"protocol\":\"TCP\"}":{".":{},"f:containerPort":{},"f:name":{},"f:protocol":{}}},"f:readinessProbe":{".":{},"f:failureThreshold":{},"f:initialDelaySeconds":{},"f:periodSeconds":{},"f:successThreshold":{},"f:tcpSocket":{".":{},"f:port":{}},"f:timeoutSeconds":{}},"f:resources":{".":{},"f:limits":{".":{},"f:cpu":{},"f:memory":{}},"f:requests":{".":{},"f:cpu":{},"f:memory":{}}},"f:terminationMessagePath":{},"f:terminationMessagePolicy":{},"f:volumeMounts":{".":{},"k:{\"mountPath\":\"/etc/pod-info/\"}":{".":{},"f:mountPath":{},"f:name":{}},"k:{\"mountPath\":\"/etc/rabbitmq/conf.d/10-operatorDefaults.conf\"}":{".":{},"f:mountPath":{},"f:name":{},"f:subPath":{}},"k:{\"mountPath\":\"/etc/rabbitmq/conf.d/11-default_user.conf\"}":{".":{},"f:mountPath":{},"f:name":{},"f:subPath":{}},"k:{\"mountPath\":\"/etc/rabbitmq/conf.d/90-userDefinedConfiguration.conf\"}":{".":{},"f:mountPath":{},"f:name":{},"f:subPath":{}},"k:{\"mountPath\":\"/operator\"}":{".":{},"f:mountPath":{},"f:name":{}},"k:{\"mountPath\":\"/var/lib/rabbitmq/\"}":{".":{},"f:mountPath":{},"f:name":{}},"k:{\"mountPath\":\"/var/lib/rabbitmq/mnesia/\"}":{".":{},"f:mountPath":{},"f:name":{}}}}},"f:dnsPolicy":{},"f:initContainers":{".":{},"k:{\"name\":\"setup-container\"}":{".":{},"f:command":{},"f:image":{},"f:imagePullPolicy":{},"f:name":{},"f:resources":{".":{},"f:limits":{".":{},"f:cpu":{},"f:memory":{}},"f:requests":{".":{},"f:cpu":{},"f:memory":{}}},"f:securityContext":{".":{},"f:capabilities":{".":{},"f:drop":{}},"f:runAsUser":{}},"f:terminationMessagePath":{},"f:terminationMessagePolicy":{},"f:volumeMounts":{".":{},"k:{\"mountPath\":\"/operator\"}":{".":{},"f:mountPath":{},"f:name":{}},"k:{\"mountPath\":\"/tmp/default_user.conf\"}":{".":{},"f:mountPath":{},"f:name":{},"f:subPath":{}},"k:{\"mountPath\":\"/tmp/erlang-cookie-secret/\"}":{".":{},"f:mountPath":{},"f:name":{}},"k:{\"mountPath\":\"/tmp/rabbitmq-plugins/\"}":{".":{},"f:mountPath":{},"f:name":{}},"k:{\"mountPath\":\"/var/lib/rabbitmq/\"}":{".":{},"f:mountPath":{},"f:name":{}},"k:{\"mountPath\":\"/var/lib/rabbitmq/mnesia/\"}":{".":{},"f:mountPath":{},"f:name":{}}}}},"f:restartPolicy":{},"f:schedulerName":{},"f:securityContext":{".":{},"f:fsGroup":{},"f:runAsGroup":{},"f:runAsUser":{}},"f:serviceAccount":{},"f:serviceAccountName":{},"f:terminationGracePeriodSeconds":{},"f:topologySpreadConstraints":{".":{},"k:{\"topologyKey\":\"topology.kubernetes.io/zone\",\"whenUnsatisfiable\":\"ScheduleAnyway\"}":{".":{},"f:labelSelector":{".":{},"f:matchLabels":{".":{},"f:app.kubernetes.io/name":{}}},"f:maxSkew":{},"f:topologyKey":{},"f:whenUnsatisfiable":{}}},"f:volumes":{".":{},"k:{\"name\":\"erlang-cookie-secret\"}":{".":{},"f:name":{},"f:secret":{".":{},"f:defaultMode":{},"f:secretName":{}}},"k:{\"name\":\"plugins-conf\"}":{".":{},"f:configMap":{".":{},"f:defaultMode":{},"f:name":{}},"f:name":{}},"k:{\"name\":\"pod-info\"}":{".":{},"f:downwardAPI":{".":{},"f:defaultMode":{},"f:items":{}},"f:name":{}},"k:{\"name\":\"rabbitmq-confd\"}":{".":{},"f:name":{},"f:projected":{".":{},"f:defaultMode":{},"f:sources":{}}},"k:{\"name\":\"rabbitmq-erlang-cookie\"}":{".":{},"f:emptyDir":{},"f:name":{}},"k:{\"name\":\"rabbitmq-plugins\"}":{".":{},"f:emptyDir":{},"f:name":{}}}}},"f:updateStrategy":{"f:rollingUpdate":{".":{},"f:partition":{}},"f:type":{}},"f:volumeClaimTemplates":{}}}},{"manager":"kube-controller-manager","operation":"Update","apiVersion":"apps/v1","time":"2022-03-18T18:02:01Z","fieldsType":"FieldsV1","fieldsV1":{"f:status":{"f:collisionCount":{},"f:currentReplicas":{},"f:currentRevision":{},"f:observedGeneration":{},"f:readyReplicas":{},"f:replicas":{},"f:updateRevision":{},"f:updatedReplicas":{}}}}]},"spec":{"replicas":3,"selector":{"matchLabels":{"app.kubernetes.io/name":"rabbitmq-cluster"}},"template":{"metadata":{"creationTimestamp":null,"labels":{"app.kubernetes.io/component":"rabbitmq","app.kubernetes.io/name":"rabbitmq-cluster","app.kubernetes.io/part-of":"rabbitmq"},"annotations":{"prometheus.io/port":"15692","prometheus.io/scrape":"true"}},"spec":{"volumes":[{"name":"plugins-conf","configMap":{"name":"rabbitmq-cluster-plugins-conf","defaultMode":420}},{"name":"rabbitmq-confd","projected":{"sources":[{"secret":{"name":"rabbitmq-cluster-default-user","items":[{"key":"default_user.conf","path":"default_user.conf"}]}},{"configMap":{"name":"rabbitmq-cluster-server-conf","items":[{"key":"operatorDefaults.conf","path":"operatorDefaults.conf"},{"key":"userDefinedConfiguration.conf","path":"userDefinedConfiguration.conf"}]}}],"defaultMode":420}},{"name":"rabbitmq-erlang-cookie","emptyDir":{}},{"name":"erlang-cookie-secret","secret":{"secretName":"rabbitmq-cluster-erlang-cookie","defaultMode":420}},{"name":"rabbitmq-plugins","emptyDir":{}},{"name":"pod-info","downwardAPI":{"items":[{"path":"skipPreStopChecks","fieldRef":{"apiVersion":"v1","fieldPath":"metadata.labels['skipPreStopChecks']"}}],"defaultMode":420}}],"initContainers":[{"name":"setup-container","image":"rabbitmq:3.8.12-management","command":["sh","-c","cp /tmp/erlang-cookie-secret/.erlang.cookie /var/lib/rabbitmq/.erlang.cookie \u0026\u0026 chown 999:999 /var/lib/rabbitmq/.erlang.cookie \u0026\u0026 chmod 600 /var/lib/rabbitmq/.erlang.cookie ; cp /tmp/rabbitmq-plugins/enabled_plugins /operator/enabled_plugins \u0026\u0026 chown 999:999 /operator/enabled_plugins ; chown 999:999 /var/lib/rabbitmq/mnesia/ ; echo '[default]' \u003e /var/lib/rabbitmq/.rabbitmqadmin.conf \u0026\u0026 sed -e 's/default_user/username/' -e 's/default_pass/password/' /tmp/default_user.conf \u003e\u003e /var/lib/rabbitmq/.rabbitmqadmin.conf \u0026\u0026 chown 999:999 /var/lib/rabbitmq/.rabbitmqadmin.conf \u0026\u0026 chmod 600 /var/lib/rabbitmq/.rabbitmqadmin.conf"],"resources":{"limits":{"cpu":"100m","memory":"500Mi"},"requests":{"cpu":"100m","memory":"500Mi"}},"volumeMounts":[{"name":"plugins-conf","mountPath":"/tmp/rabbitmq-plugins/"},{"name":"rabbitmq-erlang-cookie","mountPath":"/var/lib/rabbitmq/"},{"name":"erlang-cookie-secret","mountPath":"/tmp/erlang-cookie-secret/"},{"name":"rabbitmq-plugins","mountPath":"/operator"},{"name":"persistence","mountPath":"/var/lib/rabbitmq/mnesia/"},{"name":"rabbitmq-confd","mountPath":"/tmp/default_user.conf","subPath":"default_user.conf"}],"terminationMessagePath":"/dev/termination-log","terminationMessagePolicy":"File","imagePullPolicy":"IfNotPresent","securityContext":{"capabilities":{"drop":["FSETID","KILL","SETGID","SETUID","SETPCAP","NET_BIND_SERVICE","NET_RAW","SYS_CHROOT","MKNOD","AUDIT_WRITE","SETFCAP"]},"runAsUser":0}}],"containers":[{"name":"rabbitmq","image":"rabbitmq:3.8.12-management","ports":[{"name":"epmd","containerPort":4369,"protocol":"TCP"},{"name":"amqp","containerPort":5672,"protocol":"TCP"},{"name":"management","containerPort":15672,"protocol":"TCP"},{"name":"prometheus","containerPort":15692,"protocol":"TCP"}],"env":[{"name":"MY_POD_NAME","valueFrom":{"fieldRef":{"apiVersion":"v1","fieldPath":"metadata.name"}}},{"name":"MY_POD_NAMESPACE","valueFrom":{"fieldRef":{"apiVersion":"v1","fieldPath":"metadata.namespace"}}},{"name":"RABBITMQ_ENABLED_PLUGINS_FILE","value":"/operator/enabled_plugins"},{"name":"K8S_SERVICE_NAME","value":"rabbitmq-cluster-nodes"},{"name":"RABBITMQ_USE_LONGNAME","value":"true"},{"name":"RABBITMQ_NODENAME","value":"rabbit@$(MY_POD_NAME).$(K8S_SERVICE_NAME).$(MY_POD_NAMESPACE)"},{"name":"K8S_HOSTNAME_SUFFIX","value":".$(K8S_SERVICE_NAME).$(MY_POD_NAMESPACE)"}],"resources":{"limits":{"cpu":"2","memory":"2Gi"},"requests":{"cpu":"1","memory":"2Gi"}},"volumeMounts":[{"name":"rabbitmq-erlang-cookie","mountPath":"/var/lib/rabbitmq/"},{"name":"persistence","mountPath":"/var/lib/rabbitmq/mnesia/"},{"name":"rabbitmq-plugins","mountPath":"/operator"},{"name":"rabbitmq-confd","mountPath":"/etc/rabbitmq/conf.d/10-operatorDefaults.conf","subPath":"operatorDefaults.conf"},{"name":"rabbitmq-confd","mountPath":"/etc/rabbitmq/conf.d/11-default_user.conf","subPath":"default_user.conf"},{"name":"rabbitmq-confd","mountPath":"/etc/rabbitmq/conf.d/90-userDefinedConfiguration.conf","subPath":"userDefinedConfiguration.conf"},{"name":"pod-info","mountPath":"/etc/pod-info/"}],"readinessProbe":{"tcpSocket":{"port":"amqp"},"initialDelaySeconds":10,"timeoutSeconds":5,"periodSeconds":10,"successThreshold":1,"failureThreshold":3},"lifecycle":{"preStop":{"exec":{"command":["/bin/bash","-c","if [ ! -z \"$(cat /etc/pod-info/skipPreStopChecks)\" ]; then exit 0; fi; rabbitmq-upgrade await_online_quorum_plus_one -t 604800; rabbitmq-upgrade await_online_synchronized_mirror -t 604800; rabbitmq-upgrade drain -t 604800"]}}},"terminationMessagePath":"/dev/termination-log","terminationMessagePolicy":"File","imagePullPolicy":"IfNotPresent"}],"restartPolicy":"Always","terminationGracePeriodSeconds":604800,"dnsPolicy":"ClusterFirst","serviceAccountName":"rabbitmq-cluster-server","serviceAccount":"rabbitmq-cluster-server","automountServiceAccountToken":true,"securityContext":{"runAsUser":999,"runAsGroup":999,"fsGroup":999},"schedulerName":"default-scheduler","topologySpreadConstraints":[{"maxSkew":1,"topologyKey":"topology.kubernetes.io/zone","whenUnsatisfiable":"ScheduleAnyway","labelSelector":{"matchLabels":{"app.kubernetes.io/name":"rabbitmq-cluster"}}}]}},"volumeClaimTemplates":[{"metadata":{"name":"persistence","namespace":"default","creationTimestamp":null,"labels":{"app.kubernetes.io/component":"rabbitmq","app.kubernetes.io/name":"rabbitmq-cluster","app.kubernetes.io/part-of":"rabbitmq"},"ownerReferences":[{"apiVersion":"rabbitmq.com/v1beta1","kind":"RabbitmqCluster","name":"rabbitmq-cluster","uid":"18d9928b-0d1c-47be-80ec-20960d053827","controller":true,"blockOwnerDeletion":false}]},"spec":{"accessModes":["ReadWriteOnce"],"resources":{"requests":{"storage":"10Gi"}},"volumeMode":"Filesystem"},"status":{"phase":"Pending"}}],"serviceName":"rabbitmq-cluster-nodes","podManagementPolicy":"Parallel","updateStrategy":{"type":"RollingUpdate","rollingUpdate":{"partition":0}},"revisionHistoryLimit":10},"status":{"observedGeneration":2,"replicas":3,"readyReplicas":3,"currentReplicas":3,"updatedReplicas":3,"currentRevision":"rabbitmq-cluster-server-5f8b8665fb","updateRevision":"rabbitmq-cluster-server-5f8b8665fb","collisionCount":0}}
2022/03/18 18:02:09 learn_server.go:256: [SIEVE-BEFORE-WRITE]	65
2022/03/18 18:02:09 learn_server.go:263: [SIEVE-AFTER-WRITE]	65	StatusUpdate	rabbitmqcluster	github.com/rabbitmq/cluster-operator/controllers.(*RabbitmqClusterReconciler)	NoError	{"metadata":{"name":"rabbitmq-cluster","namespace":"default","selfLink":"/apis/rabbitmq.com/v1beta1/namespaces/default/rabbitmqclusters/rabbitmq-cluster/status","uid":"18d9928b-0d1c-47be-80ec-20960d053827","resourceVersion":"1264","generation":4,"creationTimestamp":"2022-03-18T18:00:38Z","annotations":{"kubectl.kubernetes.io/last-applied-configuration":"{\"apiVersion\":\"rabbitmq.com/v1beta1\",\"kind\":\"RabbitmqCluster\",\"metadata\":{\"annotations\":{},\"name\":\"rabbitmq-cluster\",\"namespace\":\"default\"},\"spec\":{\"persistence\":{\"storage\":\"10Gi\"},\"replicas\":1}}\n"},"finalizers":["deletion.finalizers.rabbitmqclusters.rabbitmq.com"],"managedFields":[{"manager":"kubectl-client-side-apply","operation":"Update","apiVersion":"rabbitmq.com/v1beta1","time":"2022-03-18T18:00:38Z","fieldsType":"FieldsV1","fieldsV1":{"f:metadata":{"f:annotations":{".":{},"f:kubectl.kubernetes.io/last-applied-configuration":{}}},"f:spec":{".":{},"f:image":{},"f:persistence":{".":{},"f:storage":{}},"f:resources":{".":{},"f:limits":{".":{},"f:memory":{}},"f:requests":{".":{},"f:memory":{}}},"f:service":{".":{},"f:type":{}},"f:terminationGracePeriodSeconds":{}}}},{"manager":"kubectl-patch","operation":"Update","apiVersion":"rabbitmq.com/v1beta1","time":"2022-03-18T18:02:09Z","fieldsType":"FieldsV1","fieldsV1":{"f:spec":{"f:replicas":{}}}},{"manager":"manager","operation":"Update","apiVersion":"rabbitmq.com/v1beta1","time":"2022-03-18T18:02:09Z","fieldsType":"FieldsV1","fieldsV1":{"f:metadata":{"f:finalizers":{}},"f:spec":{"f:override":{},"f:rabbitmq":{},"f:resources":{"f:limits":{"f:cpu":{}},"f:requests":{"f:cpu":{}}},"f:tls":{}},"f:status":{".":{},"f:conditions":{},"f:defaultUser":{".":{},"f:secretReference":{".":{},"f:keys":{".":{},"f:password":{},"f:username":{}},"f:name":{},"f:namespace":{}},"f:serviceReference":{".":{},"f:name":{},"f:namespace":{}}}}}}]},"spec":{"replicas":2,"image":"rabbitmq:3.8.12-management","service":{"type":"ClusterIP"},"persistence":{"storage":"10Gi"},"resources":{"limits":{"cpu":"2","memory":"2Gi"},"requests":{"cpu":"1","memory":"2Gi"}},"rabbitmq":{},"tls":{},"override":{},"terminationGracePeriodSeconds":604800},"status":{"conditions":[{"type":"AllReplicasReady","status":"True","lastTransitionTime":"2022-03-18T18:02:01Z","reason":"AllPodsAreReady"},{"type":"ClusterAvailable","status":"True","lastTransitionTime":"2022-03-18T18:01:17Z","reason":"AtLeastOneEndpointAvailable"},{"type":"NoWarnings","status":"True","lastTransitionTime":"2022-03-18T18:00:38Z","reason":"NoWarnings"},{"type":"ReconcileSuccess","status":"False","lastTransitionTime":"2022-03-18T18:02:09Z","reason":"UnsupportedOperation","message":"Cluster Scale down not supported"}],"defaultUser":{"secretReference":{"name":"rabbitmq-cluster-default-user","namespace":"default","keys":{"password":"password","username":"username"}},"serviceReference":{"name":"rabbitmq-cluster","namespace":"default"}}}}
2022/03/18 18:02:09 learn_server.go:253: [SIEVE-AFTER-RECONCILE]	github.com/rabbitmq/cluster-operator/controllers.(*RabbitmqClusterReconciler)	20
