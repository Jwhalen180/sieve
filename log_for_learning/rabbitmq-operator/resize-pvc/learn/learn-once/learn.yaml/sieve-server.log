2022/03/18 18:04:50 server.go:17: registering rpc server...
2022/03/18 18:04:50 config.go:22: config:
map[crdList:[rabbitmqcluster] rateLimiterEnabled:false rateLimiterInterval:3]
2022/03/18 18:04:50 learn_server.go:125: start learnServer...
2022/03/18 18:04:50 learn_server.go:126: rateLimiterEnabled: false
2022/03/18 18:04:50 server.go:28: setting up connection...
2022/03/18 18:06:25 learn_server.go:279: [SIEVE-BEFORE-HEAR]	0	Added	rabbitmqcluster	{"metadata":{"name":"rabbitmq-cluster","namespace":"default","selfLink":"/apis/rabbitmq.com/v1beta1/namespaces/default/rabbitmqclusters/rabbitmq-cluster","uid":"3ecefa8a-1bec-48a7-9af4-dd0df3339101","resourceVersion":"1077","generation":1,"creationTimestamp":"2022-03-18T18:06:25Z","annotations":{"kubectl.kubernetes.io/last-applied-configuration":"{\"apiVersion\":\"rabbitmq.com/v1beta1\",\"kind\":\"RabbitmqCluster\",\"metadata\":{\"annotations\":{},\"name\":\"rabbitmq-cluster\",\"namespace\":\"default\"},\"spec\":{\"persistence\":{\"storage\":\"10Gi\"},\"replicas\":1}}\n"},"managedFields":[{"manager":"kubectl-client-side-apply","operation":"Update","apiVersion":"rabbitmq.com/v1beta1","time":"2022-03-18T18:06:25Z","fieldsType":"FieldsV1","fieldsV1":{"f:metadata":{"f:annotations":{".":{},"f:kubectl.kubernetes.io/last-applied-configuration":{}}},"f:spec":{".":{},"f:image":{},"f:persistence":{".":{},"f:storage":{}},"f:replicas":{},"f:resources":{".":{},"f:limits":{".":{},"f:cpu":{},"f:memory":{}},"f:requests":{".":{},"f:cpu":{},"f:memory":{}}},"f:service":{".":{},"f:type":{}},"f:terminationGracePeriodSeconds":{}}}}]},"spec":{"replicas":1,"image":"rabbitmq:3.8.12-management","service":{"type":"ClusterIP"},"persistence":{"storage":"10Gi"},"resources":{"limits":{"cpu":"2","memory":"2Gi"},"requests":{"cpu":"1","memory":"2Gi"}},"rabbitmq":{},"tls":{},"override":{},"terminationGracePeriodSeconds":604800},"status":{"conditions":null}}
2022/03/18 18:06:25 learn_server.go:289: [SIEVE-AFTER-HEAR]	0
2022/03/18 18:06:25 learn_server.go:238: [SIEVE-BEFORE-RECONCILE]	github.com/rabbitmq/cluster-operator/controllers.(*RabbitmqClusterReconciler)	0
2022/03/18 18:06:25 learn_server.go:291: [SIEVE-AFTER-READ]	Get	true	rabbitmqcluster	default	rabbitmq-cluster	github.com/rabbitmq/cluster-operator/controllers.(*RabbitmqClusterReconciler)	NoError	{"kind":"RabbitmqCluster","apiVersion":"rabbitmq.com/v1beta1","metadata":{"name":"rabbitmq-cluster","namespace":"default","selfLink":"/apis/rabbitmq.com/v1beta1/namespaces/default/rabbitmqclusters/rabbitmq-cluster","uid":"3ecefa8a-1bec-48a7-9af4-dd0df3339101","resourceVersion":"1077","generation":1,"creationTimestamp":"2022-03-18T18:06:25Z","annotations":{"kubectl.kubernetes.io/last-applied-configuration":"{\"apiVersion\":\"rabbitmq.com/v1beta1\",\"kind\":\"RabbitmqCluster\",\"metadata\":{\"annotations\":{},\"name\":\"rabbitmq-cluster\",\"namespace\":\"default\"},\"spec\":{\"persistence\":{\"storage\":\"10Gi\"},\"replicas\":1}}\n"},"managedFields":[{"manager":"kubectl-client-side-apply","operation":"Update","apiVersion":"rabbitmq.com/v1beta1","time":"2022-03-18T18:06:25Z","fieldsType":"FieldsV1","fieldsV1":{"f:metadata":{"f:annotations":{".":{},"f:kubectl.kubernetes.io/last-applied-configuration":{}}},"f:spec":{".":{},"f:image":{},"f:persistence":{".":{},"f:storage":{}},"f:replicas":{},"f:resources":{".":{},"f:limits":{".":{},"f:cpu":{},"f:memory":{}},"f:requests":{".":{},"f:cpu":{},"f:memory":{}}},"f:service":{".":{},"f:type":{}},"f:terminationGracePeriodSeconds":{}}}}]},"spec":{"replicas":1,"image":"rabbitmq:3.8.12-management","service":{"type":"ClusterIP"},"persistence":{"storage":"10Gi"},"resources":{"limits":{"cpu":"2","memory":"2Gi"},"requests":{"cpu":"1","memory":"2Gi"}},"rabbitmq":{},"tls":{},"override":{},"terminationGracePeriodSeconds":604800},"status":{"conditions":null}}
2022/03/18 18:06:25 learn_server.go:256: [SIEVE-BEFORE-WRITE]	0
2022/03/18 18:06:25 learn_server.go:263: [SIEVE-AFTER-WRITE]	0	Update	rabbitmqcluster	github.com/rabbitmq/cluster-operator/controllers.(*RabbitmqClusterReconciler)	NoError	{"metadata":{"name":"rabbitmq-cluster","namespace":"default","selfLink":"/apis/rabbitmq.com/v1beta1/namespaces/default/rabbitmqclusters/rabbitmq-cluster","uid":"3ecefa8a-1bec-48a7-9af4-dd0df3339101","resourceVersion":"1078","generation":2,"creationTimestamp":"2022-03-18T18:06:25Z","annotations":{"kubectl.kubernetes.io/last-applied-configuration":"{\"apiVersion\":\"rabbitmq.com/v1beta1\",\"kind\":\"RabbitmqCluster\",\"metadata\":{\"annotations\":{},\"name\":\"rabbitmq-cluster\",\"namespace\":\"default\"},\"spec\":{\"persistence\":{\"storage\":\"10Gi\"},\"replicas\":1}}\n"},"finalizers":["deletion.finalizers.rabbitmqclusters.rabbitmq.com"],"managedFields":[{"manager":"kubectl-client-side-apply","operation":"Update","apiVersion":"rabbitmq.com/v1beta1","time":"2022-03-18T18:06:25Z","fieldsType":"FieldsV1","fieldsV1":{"f:metadata":{"f:annotations":{".":{},"f:kubectl.kubernetes.io/last-applied-configuration":{}}},"f:spec":{".":{},"f:image":{},"f:persistence":{".":{},"f:storage":{}},"f:replicas":{},"f:resources":{".":{},"f:limits":{".":{},"f:memory":{}},"f:requests":{".":{},"f:memory":{}}},"f:service":{".":{},"f:type":{}},"f:terminationGracePeriodSeconds":{}}}},{"manager":"manager","operation":"Update","apiVersion":"rabbitmq.com/v1beta1","time":"2022-03-18T18:06:25Z","fieldsType":"FieldsV1","fieldsV1":{"f:metadata":{"f:finalizers":{}},"f:spec":{"f:override":{},"f:rabbitmq":{},"f:resources":{"f:limits":{"f:cpu":{}},"f:requests":{"f:cpu":{}}},"f:tls":{}},"f:status":{".":{},"f:conditions":{}}}}]},"spec":{"replicas":1,"image":"rabbitmq:3.8.12-management","service":{"type":"ClusterIP"},"persistence":{"storage":"10Gi"},"resources":{"limits":{"cpu":"2","memory":"2Gi"},"requests":{"cpu":"1","memory":"2Gi"}},"rabbitmq":{},"tls":{},"override":{},"terminationGracePeriodSeconds":604800},"status":{"conditions":null}}
2022/03/18 18:06:25 learn_server.go:279: [SIEVE-BEFORE-HEAR]	1	Updated	rabbitmqcluster	{"metadata":{"name":"rabbitmq-cluster","namespace":"default","selfLink":"/apis/rabbitmq.com/v1beta1/namespaces/default/rabbitmqclusters/rabbitmq-cluster","uid":"3ecefa8a-1bec-48a7-9af4-dd0df3339101","resourceVersion":"1078","generation":2,"creationTimestamp":"2022-03-18T18:06:25Z","annotations":{"kubectl.kubernetes.io/last-applied-configuration":"{\"apiVersion\":\"rabbitmq.com/v1beta1\",\"kind\":\"RabbitmqCluster\",\"metadata\":{\"annotations\":{},\"name\":\"rabbitmq-cluster\",\"namespace\":\"default\"},\"spec\":{\"persistence\":{\"storage\":\"10Gi\"},\"replicas\":1}}\n"},"finalizers":["deletion.finalizers.rabbitmqclusters.rabbitmq.com"],"managedFields":[{"manager":"kubectl-client-side-apply","operation":"Update","apiVersion":"rabbitmq.com/v1beta1","time":"2022-03-18T18:06:25Z","fieldsType":"FieldsV1","fieldsV1":{"f:metadata":{"f:annotations":{".":{},"f:kubectl.kubernetes.io/last-applied-configuration":{}}},"f:spec":{".":{},"f:image":{},"f:persistence":{".":{},"f:storage":{}},"f:replicas":{},"f:resources":{".":{},"f:limits":{".":{},"f:memory":{}},"f:requests":{".":{},"f:memory":{}}},"f:service":{".":{},"f:type":{}},"f:terminationGracePeriodSeconds":{}}}},{"manager":"manager","operation":"Update","apiVersion":"rabbitmq.com/v1beta1","time":"2022-03-18T18:06:25Z","fieldsType":"FieldsV1","fieldsV1":{"f:metadata":{"f:finalizers":{}},"f:spec":{"f:override":{},"f:rabbitmq":{},"f:resources":{"f:limits":{"f:cpu":{}},"f:requests":{"f:cpu":{}}},"f:tls":{}},"f:status":{".":{},"f:conditions":{}}}}]},"spec":{"replicas":1,"image":"rabbitmq:3.8.12-management","service":{"type":"ClusterIP"},"persistence":{"storage":"10Gi"},"resources":{"limits":{"cpu":"2","memory":"2Gi"},"requests":{"cpu":"1","memory":"2Gi"}},"rabbitmq":{},"tls":{},"override":{},"terminationGracePeriodSeconds":604800},"status":{"conditions":null}}
2022/03/18 18:06:25 learn_server.go:289: [SIEVE-AFTER-HEAR]	1
2022/03/18 18:06:25 learn_server.go:291: [SIEVE-AFTER-READ]	Get	true	statefulset	default	rabbitmq-cluster-server	github.com/rabbitmq/cluster-operator/controllers.(*RabbitmqClusterReconciler)	NotFound	{"metadata":{"creationTimestamp":null},"spec":{"selector":null,"template":{"metadata":{"creationTimestamp":null},"spec":{"containers":null}},"serviceName":"","updateStrategy":{}},"status":{"replicas":0}}
2022/03/18 18:06:25 learn_server.go:291: [SIEVE-AFTER-READ]	Get	true	endpoints	default	rabbitmq-cluster	github.com/rabbitmq/cluster-operator/controllers.(*RabbitmqClusterReconciler)	NotFound	{"metadata":{"creationTimestamp":null}}
2022/03/18 18:06:25 learn_server.go:256: [SIEVE-BEFORE-WRITE]	1
2022/03/18 18:06:25 learn_server.go:263: [SIEVE-AFTER-WRITE]	1	StatusUpdate	rabbitmqcluster	github.com/rabbitmq/cluster-operator/controllers.(*RabbitmqClusterReconciler)	NoError	{"metadata":{"name":"rabbitmq-cluster","namespace":"default","selfLink":"/apis/rabbitmq.com/v1beta1/namespaces/default/rabbitmqclusters/rabbitmq-cluster/status","uid":"3ecefa8a-1bec-48a7-9af4-dd0df3339101","resourceVersion":"1079","generation":2,"creationTimestamp":"2022-03-18T18:06:25Z","annotations":{"kubectl.kubernetes.io/last-applied-configuration":"{\"apiVersion\":\"rabbitmq.com/v1beta1\",\"kind\":\"RabbitmqCluster\",\"metadata\":{\"annotations\":{},\"name\":\"rabbitmq-cluster\",\"namespace\":\"default\"},\"spec\":{\"persistence\":{\"storage\":\"10Gi\"},\"replicas\":1}}\n"},"finalizers":["deletion.finalizers.rabbitmqclusters.rabbitmq.com"],"managedFields":[{"manager":"kubectl-client-side-apply","operation":"Update","apiVersion":"rabbitmq.com/v1beta1","time":"2022-03-18T18:06:25Z","fieldsType":"FieldsV1","fieldsV1":{"f:metadata":{"f:annotations":{".":{},"f:kubectl.kubernetes.io/last-applied-configuration":{}}},"f:spec":{".":{},"f:image":{},"f:persistence":{".":{},"f:storage":{}},"f:replicas":{},"f:resources":{".":{},"f:limits":{".":{},"f:memory":{}},"f:requests":{".":{},"f:memory":{}}},"f:service":{".":{},"f:type":{}},"f:terminationGracePeriodSeconds":{}}}},{"manager":"manager","operation":"Update","apiVersion":"rabbitmq.com/v1beta1","time":"2022-03-18T18:06:25Z","fieldsType":"FieldsV1","fieldsV1":{"f:metadata":{"f:finalizers":{}},"f:spec":{"f:override":{},"f:rabbitmq":{},"f:resources":{"f:limits":{"f:cpu":{}},"f:requests":{"f:cpu":{}}},"f:tls":{}},"f:status":{".":{},"f:conditions":{}}}}]},"spec":{"replicas":1,"image":"rabbitmq:3.8.12-management","service":{"type":"ClusterIP"},"persistence":{"storage":"10Gi"},"resources":{"limits":{"cpu":"2","memory":"2Gi"},"requests":{"cpu":"1","memory":"2Gi"}},"rabbitmq":{},"tls":{},"override":{},"terminationGracePeriodSeconds":604800},"status":{"conditions":[{"type":"AllReplicasReady","status":"Unknown","lastTransitionTime":"2022-03-18T18:06:25Z","reason":"MissingStatefulSet","message":"Could not find StatefulSet"},{"type":"ClusterAvailable","status":"Unknown","lastTransitionTime":"2022-03-18T18:06:25Z","reason":"CouldNotRetrieveEndpoints","message":"Could not verify available service endpoints"},{"type":"NoWarnings","status":"Unknown","lastTransitionTime":"2022-03-18T18:06:25Z","reason":"MissingStatefulSet","message":"Could not find StatefulSet"},{"type":"ReconcileSuccess","status":"Unknown","lastTransitionTime":"2022-03-18T18:06:25Z","reason":"Initialising"}]}}
2022/03/18 18:06:25 learn_server.go:279: [SIEVE-BEFORE-HEAR]	2	Updated	rabbitmqcluster	{"metadata":{"name":"rabbitmq-cluster","namespace":"default","selfLink":"/apis/rabbitmq.com/v1beta1/namespaces/default/rabbitmqclusters/rabbitmq-cluster","uid":"3ecefa8a-1bec-48a7-9af4-dd0df3339101","resourceVersion":"1079","generation":2,"creationTimestamp":"2022-03-18T18:06:25Z","annotations":{"kubectl.kubernetes.io/last-applied-configuration":"{\"apiVersion\":\"rabbitmq.com/v1beta1\",\"kind\":\"RabbitmqCluster\",\"metadata\":{\"annotations\":{},\"name\":\"rabbitmq-cluster\",\"namespace\":\"default\"},\"spec\":{\"persistence\":{\"storage\":\"10Gi\"},\"replicas\":1}}\n"},"finalizers":["deletion.finalizers.rabbitmqclusters.rabbitmq.com"],"managedFields":[{"manager":"kubectl-client-side-apply","operation":"Update","apiVersion":"rabbitmq.com/v1beta1","time":"2022-03-18T18:06:25Z","fieldsType":"FieldsV1","fieldsV1":{"f:metadata":{"f:annotations":{".":{},"f:kubectl.kubernetes.io/last-applied-configuration":{}}},"f:spec":{".":{},"f:image":{},"f:persistence":{".":{},"f:storage":{}},"f:replicas":{},"f:resources":{".":{},"f:limits":{".":{},"f:memory":{}},"f:requests":{".":{},"f:memory":{}}},"f:service":{".":{},"f:type":{}},"f:terminationGracePeriodSeconds":{}}}},{"manager":"manager","operation":"Update","apiVersion":"rabbitmq.com/v1beta1","time":"2022-03-18T18:06:25Z","fieldsType":"FieldsV1","fieldsV1":{"f:metadata":{"f:finalizers":{}},"f:spec":{"f:override":{},"f:rabbitmq":{},"f:resources":{"f:limits":{"f:cpu":{}},"f:requests":{"f:cpu":{}}},"f:tls":{}},"f:status":{".":{},"f:conditions":{}}}}]},"spec":{"replicas":1,"image":"rabbitmq:3.8.12-management","service":{"type":"ClusterIP"},"persistence":{"storage":"10Gi"},"resources":{"limits":{"cpu":"2","memory":"2Gi"},"requests":{"cpu":"1","memory":"2Gi"}},"rabbitmq":{},"tls":{},"override":{},"terminationGracePeriodSeconds":604800},"status":{"conditions":[{"type":"AllReplicasReady","status":"Unknown","lastTransitionTime":"2022-03-18T18:06:25Z","reason":"MissingStatefulSet","message":"Could not find StatefulSet"},{"type":"ClusterAvailable","status":"Unknown","lastTransitionTime":"2022-03-18T18:06:25Z","reason":"CouldNotRetrieveEndpoints","message":"Could not verify available service endpoints"},{"type":"NoWarnings","status":"Unknown","lastTransitionTime":"2022-03-18T18:06:25Z","reason":"MissingStatefulSet","message":"Could not find StatefulSet"},{"type":"ReconcileSuccess","status":"Unknown","lastTransitionTime":"2022-03-18T18:06:25Z","reason":"Initialising"}]}}
2022/03/18 18:06:25 learn_server.go:289: [SIEVE-AFTER-HEAR]	2
2022/03/18 18:06:25 learn_server.go:291: [SIEVE-AFTER-READ]	Get	true	statefulset	default	rabbitmq-cluster-server	github.com/rabbitmq/cluster-operator/controllers.(*RabbitmqClusterReconciler)	NotFound	{"metadata":{"creationTimestamp":null},"spec":{"selector":null,"template":{"metadata":{"creationTimestamp":null},"spec":{"containers":null}},"serviceName":"","updateStrategy":{}},"status":{"replicas":0}}
2022/03/18 18:06:25 learn_server.go:291: [SIEVE-AFTER-READ]	Get	true	service	default	rabbitmq-cluster-nodes	github.com/rabbitmq/cluster-operator/controllers.(*RabbitmqClusterReconciler)	NotFound	{"metadata":{"name":"rabbitmq-cluster-nodes","namespace":"default","creationTimestamp":null},"spec":{},"status":{"loadBalancer":{}}}
2022/03/18 18:06:25 learn_server.go:256: [SIEVE-BEFORE-WRITE]	2
2022/03/18 18:06:25 learn_server.go:263: [SIEVE-AFTER-WRITE]	2	Create	service	github.com/rabbitmq/cluster-operator/controllers.(*RabbitmqClusterReconciler)	NoError	{"metadata":{"name":"rabbitmq-cluster-nodes","namespace":"default","selfLink":"/api/v1/namespaces/default/services/rabbitmq-cluster-nodes","uid":"f843e1c2-ced0-463d-87c1-0e127aaa2006","resourceVersion":"1080","creationTimestamp":"2022-03-18T18:06:25Z","labels":{"app.kubernetes.io/component":"rabbitmq","app.kubernetes.io/name":"rabbitmq-cluster","app.kubernetes.io/part-of":"rabbitmq"},"ownerReferences":[{"apiVersion":"rabbitmq.com/v1beta1","kind":"RabbitmqCluster","name":"rabbitmq-cluster","uid":"3ecefa8a-1bec-48a7-9af4-dd0df3339101","controller":true,"blockOwnerDeletion":true}],"managedFields":[{"manager":"manager","operation":"Update","apiVersion":"v1","time":"2022-03-18T18:06:25Z","fieldsType":"FieldsV1","fieldsV1":{"f:metadata":{"f:labels":{".":{},"f:app.kubernetes.io/component":{},"f:app.kubernetes.io/name":{},"f:app.kubernetes.io/part-of":{}},"f:ownerReferences":{".":{},"k:{\"uid\":\"3ecefa8a-1bec-48a7-9af4-dd0df3339101\"}":{".":{},"f:apiVersion":{},"f:blockOwnerDeletion":{},"f:controller":{},"f:kind":{},"f:name":{},"f:uid":{}}}},"f:spec":{"f:clusterIP":{},"f:ports":{".":{},"k:{\"port\":4369,\"protocol\":\"TCP\"}":{".":{},"f:name":{},"f:port":{},"f:protocol":{},"f:targetPort":{}},"k:{\"port\":25672,\"protocol\":\"TCP\"}":{".":{},"f:name":{},"f:port":{},"f:protocol":{},"f:targetPort":{}}},"f:publishNotReadyAddresses":{},"f:selector":{".":{},"f:app.kubernetes.io/name":{}},"f:sessionAffinity":{},"f:type":{}}}}]},"spec":{"ports":[{"name":"epmd","protocol":"TCP","port":4369,"targetPort":4369},{"name":"cluster-rpc","protocol":"TCP","port":25672,"targetPort":25672}],"selector":{"app.kubernetes.io/name":"rabbitmq-cluster"},"clusterIP":"None","type":"ClusterIP","sessionAffinity":"None","publishNotReadyAddresses":true},"status":{"loadBalancer":{}}}
2022/03/18 18:06:25 learn_server.go:291: [SIEVE-AFTER-READ]	Get	true	service	default	rabbitmq-cluster	github.com/rabbitmq/cluster-operator/controllers.(*RabbitmqClusterReconciler)	NotFound	{"metadata":{"name":"rabbitmq-cluster","namespace":"default","creationTimestamp":null},"spec":{},"status":{"loadBalancer":{}}}
2022/03/18 18:06:25 learn_server.go:256: [SIEVE-BEFORE-WRITE]	3
2022/03/18 18:06:25 learn_server.go:279: [SIEVE-BEFORE-HEAR]	3	Added	service	{"metadata":{"name":"rabbitmq-cluster-nodes","namespace":"default","selfLink":"/api/v1/namespaces/default/services/rabbitmq-cluster-nodes","uid":"f843e1c2-ced0-463d-87c1-0e127aaa2006","resourceVersion":"1080","creationTimestamp":"2022-03-18T18:06:25Z","labels":{"app.kubernetes.io/component":"rabbitmq","app.kubernetes.io/name":"rabbitmq-cluster","app.kubernetes.io/part-of":"rabbitmq"},"ownerReferences":[{"apiVersion":"rabbitmq.com/v1beta1","kind":"RabbitmqCluster","name":"rabbitmq-cluster","uid":"3ecefa8a-1bec-48a7-9af4-dd0df3339101","controller":true,"blockOwnerDeletion":true}],"managedFields":[{"manager":"manager","operation":"Update","apiVersion":"v1","time":"2022-03-18T18:06:25Z","fieldsType":"FieldsV1","fieldsV1":{"f:metadata":{"f:labels":{".":{},"f:app.kubernetes.io/component":{},"f:app.kubernetes.io/name":{},"f:app.kubernetes.io/part-of":{}},"f:ownerReferences":{".":{},"k:{\"uid\":\"3ecefa8a-1bec-48a7-9af4-dd0df3339101\"}":{".":{},"f:apiVersion":{},"f:blockOwnerDeletion":{},"f:controller":{},"f:kind":{},"f:name":{},"f:uid":{}}}},"f:spec":{"f:clusterIP":{},"f:ports":{".":{},"k:{\"port\":4369,\"protocol\":\"TCP\"}":{".":{},"f:name":{},"f:port":{},"f:protocol":{},"f:targetPort":{}},"k:{\"port\":25672,\"protocol\":\"TCP\"}":{".":{},"f:name":{},"f:port":{},"f:protocol":{},"f:targetPort":{}}},"f:publishNotReadyAddresses":{},"f:selector":{".":{},"f:app.kubernetes.io/name":{}},"f:sessionAffinity":{},"f:type":{}}}}]},"spec":{"ports":[{"name":"epmd","protocol":"TCP","port":4369,"targetPort":4369},{"name":"cluster-rpc","protocol":"TCP","port":25672,"targetPort":25672}],"selector":{"app.kubernetes.io/name":"rabbitmq-cluster"},"clusterIP":"None","type":"ClusterIP","sessionAffinity":"None","publishNotReadyAddresses":true},"status":{"loadBalancer":{}}}
2022/03/18 18:06:25 learn_server.go:289: [SIEVE-AFTER-HEAR]	3
2022/03/18 18:06:25 learn_server.go:279: [SIEVE-BEFORE-HEAR]	4	Added	service	{"metadata":{"name":"rabbitmq-cluster","namespace":"default","selfLink":"/api/v1/namespaces/default/services/rabbitmq-cluster","uid":"ae846a70-784e-49ca-99a0-2b0cefb93b46","resourceVersion":"1085","creationTimestamp":"2022-03-18T18:06:25Z","labels":{"app.kubernetes.io/component":"rabbitmq","app.kubernetes.io/name":"rabbitmq-cluster","app.kubernetes.io/part-of":"rabbitmq"},"ownerReferences":[{"apiVersion":"rabbitmq.com/v1beta1","kind":"RabbitmqCluster","name":"rabbitmq-cluster","uid":"3ecefa8a-1bec-48a7-9af4-dd0df3339101","controller":true,"blockOwnerDeletion":true}],"managedFields":[{"manager":"manager","operation":"Update","apiVersion":"v1","time":"2022-03-18T18:06:25Z","fieldsType":"FieldsV1","fieldsV1":{"f:metadata":{"f:labels":{".":{},"f:app.kubernetes.io/component":{},"f:app.kubernetes.io/name":{},"f:app.kubernetes.io/part-of":{}},"f:ownerReferences":{".":{},"k:{\"uid\":\"3ecefa8a-1bec-48a7-9af4-dd0df3339101\"}":{".":{},"f:apiVersion":{},"f:blockOwnerDeletion":{},"f:controller":{},"f:kind":{},"f:name":{},"f:uid":{}}}},"f:spec":{"f:ports":{".":{},"k:{\"port\":5672,\"protocol\":\"TCP\"}":{".":{},"f:name":{},"f:port":{},"f:protocol":{},"f:targetPort":{}},"k:{\"port\":15672,\"protocol\":\"TCP\"}":{".":{},"f:name":{},"f:port":{},"f:protocol":{},"f:targetPort":{}}},"f:selector":{".":{},"f:app.kubernetes.io/name":{}},"f:sessionAffinity":{},"f:type":{}}}}]},"spec":{"ports":[{"name":"amqp","protocol":"TCP","port":5672,"targetPort":5672},{"name":"management","protocol":"TCP","port":15672,"targetPort":15672}],"selector":{"app.kubernetes.io/name":"rabbitmq-cluster"},"clusterIP":"10.96.47.189","type":"ClusterIP","sessionAffinity":"None"},"status":{"loadBalancer":{}}}
2022/03/18 18:06:25 learn_server.go:289: [SIEVE-AFTER-HEAR]	4
2022/03/18 18:06:25 learn_server.go:263: [SIEVE-AFTER-WRITE]	3	Create	service	github.com/rabbitmq/cluster-operator/controllers.(*RabbitmqClusterReconciler)	NoError	{"metadata":{"name":"rabbitmq-cluster","namespace":"default","selfLink":"/api/v1/namespaces/default/services/rabbitmq-cluster","uid":"ae846a70-784e-49ca-99a0-2b0cefb93b46","resourceVersion":"1085","creationTimestamp":"2022-03-18T18:06:25Z","labels":{"app.kubernetes.io/component":"rabbitmq","app.kubernetes.io/name":"rabbitmq-cluster","app.kubernetes.io/part-of":"rabbitmq"},"ownerReferences":[{"apiVersion":"rabbitmq.com/v1beta1","kind":"RabbitmqCluster","name":"rabbitmq-cluster","uid":"3ecefa8a-1bec-48a7-9af4-dd0df3339101","controller":true,"blockOwnerDeletion":true}],"managedFields":[{"manager":"manager","operation":"Update","apiVersion":"v1","time":"2022-03-18T18:06:25Z","fieldsType":"FieldsV1","fieldsV1":{"f:metadata":{"f:labels":{".":{},"f:app.kubernetes.io/component":{},"f:app.kubernetes.io/name":{},"f:app.kubernetes.io/part-of":{}},"f:ownerReferences":{".":{},"k:{\"uid\":\"3ecefa8a-1bec-48a7-9af4-dd0df3339101\"}":{".":{},"f:apiVersion":{},"f:blockOwnerDeletion":{},"f:controller":{},"f:kind":{},"f:name":{},"f:uid":{}}}},"f:spec":{"f:ports":{".":{},"k:{\"port\":5672,\"protocol\":\"TCP\"}":{".":{},"f:name":{},"f:port":{},"f:protocol":{},"f:targetPort":{}},"k:{\"port\":15672,\"protocol\":\"TCP\"}":{".":{},"f:name":{},"f:port":{},"f:protocol":{},"f:targetPort":{}}},"f:selector":{".":{},"f:app.kubernetes.io/name":{}},"f:sessionAffinity":{},"f:type":{}}}}]},"spec":{"ports":[{"name":"amqp","protocol":"TCP","port":5672,"targetPort":5672},{"name":"management","protocol":"TCP","port":15672,"targetPort":15672}],"selector":{"app.kubernetes.io/name":"rabbitmq-cluster"},"clusterIP":"10.96.47.189","type":"ClusterIP","sessionAffinity":"None"},"status":{"loadBalancer":{}}}
2022/03/18 18:06:25 learn_server.go:291: [SIEVE-AFTER-READ]	Get	true	secret	default	rabbitmq-cluster-erlang-cookie	github.com/rabbitmq/cluster-operator/controllers.(*RabbitmqClusterReconciler)	NotFound	{"metadata":{"name":"rabbitmq-cluster-erlang-cookie","namespace":"default","creationTimestamp":null},"data":{".erlang.cookie":"ajdscUtLdnBpR1NwUUMwc1V3a2VyTlJxU2tVUTdBeEw="},"type":"Opaque"}
2022/03/18 18:06:25 learn_server.go:256: [SIEVE-BEFORE-WRITE]	4
2022/03/18 18:06:25 learn_server.go:263: [SIEVE-AFTER-WRITE]	4	Create	secret	github.com/rabbitmq/cluster-operator/controllers.(*RabbitmqClusterReconciler)	NoError	{"metadata":{"name":"rabbitmq-cluster-erlang-cookie","namespace":"default","selfLink":"/api/v1/namespaces/default/secrets/rabbitmq-cluster-erlang-cookie","uid":"01d8d8ad-080a-4c3f-9d27-56616c53dd26","resourceVersion":"1088","creationTimestamp":"2022-03-18T18:06:25Z","labels":{"app.kubernetes.io/component":"rabbitmq","app.kubernetes.io/name":"rabbitmq-cluster","app.kubernetes.io/part-of":"rabbitmq"},"ownerReferences":[{"apiVersion":"rabbitmq.com/v1beta1","kind":"RabbitmqCluster","name":"rabbitmq-cluster","uid":"3ecefa8a-1bec-48a7-9af4-dd0df3339101","controller":true,"blockOwnerDeletion":true}],"managedFields":[{"manager":"manager","operation":"Update","apiVersion":"v1","time":"2022-03-18T18:06:25Z","fieldsType":"FieldsV1","fieldsV1":{"f:data":{".":{},"f:.erlang.cookie":{}},"f:metadata":{"f:labels":{".":{},"f:app.kubernetes.io/component":{},"f:app.kubernetes.io/name":{},"f:app.kubernetes.io/part-of":{}},"f:ownerReferences":{".":{},"k:{\"uid\":\"3ecefa8a-1bec-48a7-9af4-dd0df3339101\"}":{".":{},"f:apiVersion":{},"f:blockOwnerDeletion":{},"f:controller":{},"f:kind":{},"f:name":{},"f:uid":{}}}},"f:type":{}}}]},"data":{".erlang.cookie":"ajdscUtLdnBpR1NwUUMwc1V3a2VyTlJxU2tVUTdBeEw="},"type":"Opaque"}
2022/03/18 18:06:25 learn_server.go:279: [SIEVE-BEFORE-HEAR]	5	Added	secret	{"metadata":{"name":"rabbitmq-cluster-erlang-cookie","namespace":"default","selfLink":"/api/v1/namespaces/default/secrets/rabbitmq-cluster-erlang-cookie","uid":"01d8d8ad-080a-4c3f-9d27-56616c53dd26","resourceVersion":"1088","creationTimestamp":"2022-03-18T18:06:25Z","labels":{"app.kubernetes.io/component":"rabbitmq","app.kubernetes.io/name":"rabbitmq-cluster","app.kubernetes.io/part-of":"rabbitmq"},"ownerReferences":[{"apiVersion":"rabbitmq.com/v1beta1","kind":"RabbitmqCluster","name":"rabbitmq-cluster","uid":"3ecefa8a-1bec-48a7-9af4-dd0df3339101","controller":true,"blockOwnerDeletion":true}],"managedFields":[{"manager":"manager","operation":"Update","apiVersion":"v1","time":"2022-03-18T18:06:25Z","fieldsType":"FieldsV1","fieldsV1":{"f:data":{".":{},"f:.erlang.cookie":{}},"f:metadata":{"f:labels":{".":{},"f:app.kubernetes.io/component":{},"f:app.kubernetes.io/name":{},"f:app.kubernetes.io/part-of":{}},"f:ownerReferences":{".":{},"k:{\"uid\":\"3ecefa8a-1bec-48a7-9af4-dd0df3339101\"}":{".":{},"f:apiVersion":{},"f:blockOwnerDeletion":{},"f:controller":{},"f:kind":{},"f:name":{},"f:uid":{}}}},"f:type":{}}}]},"data":{".erlang.cookie":"ajdscUtLdnBpR1NwUUMwc1V3a2VyTlJxU2tVUTdBeEw="},"type":"Opaque"}
2022/03/18 18:06:25 learn_server.go:289: [SIEVE-AFTER-HEAR]	5
2022/03/18 18:06:25 learn_server.go:291: [SIEVE-AFTER-READ]	Get	true	secret	default	rabbitmq-cluster-default-user	github.com/rabbitmq/cluster-operator/controllers.(*RabbitmqClusterReconciler)	NotFound	{"metadata":{"name":"rabbitmq-cluster-default-user","namespace":"default","creationTimestamp":null},"data":{"default_user.conf":"ZGVmYXVsdF91c2VyID0gdEFMN1otZTgzR29ocEtsZ0Z4cUFFV3ZXemEtcjdJQW8KZGVmYXVsdF9wYXNzID0gdXVocndkTkdOcmJXQ2p6NFZPX0NUZE9OYURkSUpoRkoK","password":"dXVocndkTkdOcmJXQ2p6NFZPX0NUZE9OYURkSUpoRko=","provider":"cmFiYml0bXE=","type":"cmFiYml0bXE=","username":"dEFMN1otZTgzR29ocEtsZ0Z4cUFFV3ZXemEtcjdJQW8="},"type":"Opaque"}
2022/03/18 18:06:25 learn_server.go:256: [SIEVE-BEFORE-WRITE]	5
2022/03/18 18:06:25 learn_server.go:263: [SIEVE-AFTER-WRITE]	5	Create	secret	github.com/rabbitmq/cluster-operator/controllers.(*RabbitmqClusterReconciler)	NoError	{"metadata":{"name":"rabbitmq-cluster-default-user","namespace":"default","selfLink":"/api/v1/namespaces/default/secrets/rabbitmq-cluster-default-user","uid":"b2f5a936-e51f-4488-b6e9-ca23e4d95ac2","resourceVersion":"1091","creationTimestamp":"2022-03-18T18:06:25Z","labels":{"app.kubernetes.io/component":"rabbitmq","app.kubernetes.io/name":"rabbitmq-cluster","app.kubernetes.io/part-of":"rabbitmq"},"ownerReferences":[{"apiVersion":"rabbitmq.com/v1beta1","kind":"RabbitmqCluster","name":"rabbitmq-cluster","uid":"3ecefa8a-1bec-48a7-9af4-dd0df3339101","controller":true,"blockOwnerDeletion":true}],"managedFields":[{"manager":"manager","operation":"Update","apiVersion":"v1","time":"2022-03-18T18:06:25Z","fieldsType":"FieldsV1","fieldsV1":{"f:data":{".":{},"f:default_user.conf":{},"f:password":{},"f:provider":{},"f:type":{},"f:username":{}},"f:metadata":{"f:labels":{".":{},"f:app.kubernetes.io/component":{},"f:app.kubernetes.io/name":{},"f:app.kubernetes.io/part-of":{}},"f:ownerReferences":{".":{},"k:{\"uid\":\"3ecefa8a-1bec-48a7-9af4-dd0df3339101\"}":{".":{},"f:apiVersion":{},"f:blockOwnerDeletion":{},"f:controller":{},"f:kind":{},"f:name":{},"f:uid":{}}}},"f:type":{}}}]},"data":{"default_user.conf":"ZGVmYXVsdF91c2VyID0gdEFMN1otZTgzR29ocEtsZ0Z4cUFFV3ZXemEtcjdJQW8KZGVmYXVsdF9wYXNzID0gdXVocndkTkdOcmJXQ2p6NFZPX0NUZE9OYURkSUpoRkoK","password":"dXVocndkTkdOcmJXQ2p6NFZPX0NUZE9OYURkSUpoRko=","provider":"cmFiYml0bXE=","type":"cmFiYml0bXE=","username":"dEFMN1otZTgzR29ocEtsZ0Z4cUFFV3ZXemEtcjdJQW8="},"type":"Opaque"}
2022/03/18 18:06:25 learn_server.go:291: [SIEVE-AFTER-READ]	Get	true	configmap	default	rabbitmq-cluster-plugins-conf	github.com/rabbitmq/cluster-operator/controllers.(*RabbitmqClusterReconciler)	NotFound	{"metadata":{"name":"rabbitmq-cluster-plugins-conf","namespace":"default","creationTimestamp":null,"labels":{"app.kubernetes.io/component":"rabbitmq","app.kubernetes.io/name":"rabbitmq-cluster","app.kubernetes.io/part-of":"rabbitmq"}},"data":{"enabled_plugins":"[rabbitmq_peer_discovery_k8s,rabbitmq_prometheus,rabbitmq_management]."}}
2022/03/18 18:06:25 learn_server.go:279: [SIEVE-BEFORE-HEAR]	6	Added	secret	{"metadata":{"name":"rabbitmq-cluster-default-user","namespace":"default","selfLink":"/api/v1/namespaces/default/secrets/rabbitmq-cluster-default-user","uid":"b2f5a936-e51f-4488-b6e9-ca23e4d95ac2","resourceVersion":"1091","creationTimestamp":"2022-03-18T18:06:25Z","labels":{"app.kubernetes.io/component":"rabbitmq","app.kubernetes.io/name":"rabbitmq-cluster","app.kubernetes.io/part-of":"rabbitmq"},"ownerReferences":[{"apiVersion":"rabbitmq.com/v1beta1","kind":"RabbitmqCluster","name":"rabbitmq-cluster","uid":"3ecefa8a-1bec-48a7-9af4-dd0df3339101","controller":true,"blockOwnerDeletion":true}],"managedFields":[{"manager":"manager","operation":"Update","apiVersion":"v1","time":"2022-03-18T18:06:25Z","fieldsType":"FieldsV1","fieldsV1":{"f:data":{".":{},"f:default_user.conf":{},"f:password":{},"f:provider":{},"f:type":{},"f:username":{}},"f:metadata":{"f:labels":{".":{},"f:app.kubernetes.io/component":{},"f:app.kubernetes.io/name":{},"f:app.kubernetes.io/part-of":{}},"f:ownerReferences":{".":{},"k:{\"uid\":\"3ecefa8a-1bec-48a7-9af4-dd0df3339101\"}":{".":{},"f:apiVersion":{},"f:blockOwnerDeletion":{},"f:controller":{},"f:kind":{},"f:name":{},"f:uid":{}}}},"f:type":{}}}]},"data":{"default_user.conf":"ZGVmYXVsdF91c2VyID0gdEFMN1otZTgzR29ocEtsZ0Z4cUFFV3ZXemEtcjdJQW8KZGVmYXVsdF9wYXNzID0gdXVocndkTkdOcmJXQ2p6NFZPX0NUZE9OYURkSUpoRkoK","password":"dXVocndkTkdOcmJXQ2p6NFZPX0NUZE9OYURkSUpoRko=","provider":"cmFiYml0bXE=","type":"cmFiYml0bXE=","username":"dEFMN1otZTgzR29ocEtsZ0Z4cUFFV3ZXemEtcjdJQW8="},"type":"Opaque"}
2022/03/18 18:06:25 learn_server.go:256: [SIEVE-BEFORE-WRITE]	6
2022/03/18 18:06:25 learn_server.go:289: [SIEVE-AFTER-HEAR]	6
2022/03/18 18:06:25 learn_server.go:279: [SIEVE-BEFORE-HEAR]	7	Added	configmap	{"metadata":{"name":"rabbitmq-cluster-plugins-conf","namespace":"default","selfLink":"/api/v1/namespaces/default/configmaps/rabbitmq-cluster-plugins-conf","uid":"0aa26eb6-ff3a-4457-a223-284c897db7fe","resourceVersion":"1092","creationTimestamp":"2022-03-18T18:06:25Z","labels":{"app.kubernetes.io/component":"rabbitmq","app.kubernetes.io/name":"rabbitmq-cluster","app.kubernetes.io/part-of":"rabbitmq"},"ownerReferences":[{"apiVersion":"rabbitmq.com/v1beta1","kind":"RabbitmqCluster","name":"rabbitmq-cluster","uid":"3ecefa8a-1bec-48a7-9af4-dd0df3339101","controller":true,"blockOwnerDeletion":true}],"managedFields":[{"manager":"manager","operation":"Update","apiVersion":"v1","time":"2022-03-18T18:06:25Z","fieldsType":"FieldsV1","fieldsV1":{"f:data":{".":{},"f:enabled_plugins":{}},"f:metadata":{"f:labels":{".":{},"f:app.kubernetes.io/component":{},"f:app.kubernetes.io/name":{},"f:app.kubernetes.io/part-of":{}},"f:ownerReferences":{".":{},"k:{\"uid\":\"3ecefa8a-1bec-48a7-9af4-dd0df3339101\"}":{".":{},"f:apiVersion":{},"f:blockOwnerDeletion":{},"f:controller":{},"f:kind":{},"f:name":{},"f:uid":{}}}}}}]},"data":{"enabled_plugins":"[rabbitmq_peer_discovery_k8s,rabbitmq_prometheus,rabbitmq_management]."}}
2022/03/18 18:06:25 learn_server.go:289: [SIEVE-AFTER-HEAR]	7
2022/03/18 18:06:25 learn_server.go:263: [SIEVE-AFTER-WRITE]	6	Create	configmap	github.com/rabbitmq/cluster-operator/controllers.(*RabbitmqClusterReconciler)	NoError	{"metadata":{"name":"rabbitmq-cluster-plugins-conf","namespace":"default","selfLink":"/api/v1/namespaces/default/configmaps/rabbitmq-cluster-plugins-conf","uid":"0aa26eb6-ff3a-4457-a223-284c897db7fe","resourceVersion":"1092","creationTimestamp":"2022-03-18T18:06:25Z","labels":{"app.kubernetes.io/component":"rabbitmq","app.kubernetes.io/name":"rabbitmq-cluster","app.kubernetes.io/part-of":"rabbitmq"},"ownerReferences":[{"apiVersion":"rabbitmq.com/v1beta1","kind":"RabbitmqCluster","name":"rabbitmq-cluster","uid":"3ecefa8a-1bec-48a7-9af4-dd0df3339101","controller":true,"blockOwnerDeletion":true}],"managedFields":[{"manager":"manager","operation":"Update","apiVersion":"v1","time":"2022-03-18T18:06:25Z","fieldsType":"FieldsV1","fieldsV1":{"f:data":{".":{},"f:enabled_plugins":{}},"f:metadata":{"f:labels":{".":{},"f:app.kubernetes.io/component":{},"f:app.kubernetes.io/name":{},"f:app.kubernetes.io/part-of":{}},"f:ownerReferences":{".":{},"k:{\"uid\":\"3ecefa8a-1bec-48a7-9af4-dd0df3339101\"}":{".":{},"f:apiVersion":{},"f:blockOwnerDeletion":{},"f:controller":{},"f:kind":{},"f:name":{},"f:uid":{}}}}}}]},"data":{"enabled_plugins":"[rabbitmq_peer_discovery_k8s,rabbitmq_prometheus,rabbitmq_management]."}}
2022/03/18 18:06:25 learn_server.go:291: [SIEVE-AFTER-READ]	Get	true	configmap	default	rabbitmq-cluster-server-conf	github.com/rabbitmq/cluster-operator/controllers.(*RabbitmqClusterReconciler)	NotFound	{"metadata":{"name":"rabbitmq-cluster-server-conf","namespace":"default","creationTimestamp":null,"labels":{"app.kubernetes.io/component":"rabbitmq","app.kubernetes.io/name":"rabbitmq-cluster","app.kubernetes.io/part-of":"rabbitmq"}}}
2022/03/18 18:06:25 learn_server.go:256: [SIEVE-BEFORE-WRITE]	7
2022/03/18 18:06:25 learn_server.go:279: [SIEVE-BEFORE-HEAR]	8	Added	configmap	{"metadata":{"name":"rabbitmq-cluster-server-conf","namespace":"default","selfLink":"/api/v1/namespaces/default/configmaps/rabbitmq-cluster-server-conf","uid":"e4182078-d429-4baf-9021-72618c509ac5","resourceVersion":"1095","creationTimestamp":"2022-03-18T18:06:25Z","labels":{"app.kubernetes.io/component":"rabbitmq","app.kubernetes.io/name":"rabbitmq-cluster","app.kubernetes.io/part-of":"rabbitmq"},"ownerReferences":[{"apiVersion":"rabbitmq.com/v1beta1","kind":"RabbitmqCluster","name":"rabbitmq-cluster","uid":"3ecefa8a-1bec-48a7-9af4-dd0df3339101","controller":true,"blockOwnerDeletion":true}],"managedFields":[{"manager":"manager","operation":"Update","apiVersion":"v1","time":"2022-03-18T18:06:25Z","fieldsType":"FieldsV1","fieldsV1":{"f:data":{".":{},"f:operatorDefaults.conf":{},"f:userDefinedConfiguration.conf":{}},"f:metadata":{"f:labels":{".":{},"f:app.kubernetes.io/component":{},"f:app.kubernetes.io/name":{},"f:app.kubernetes.io/part-of":{}},"f:ownerReferences":{".":{},"k:{\"uid\":\"3ecefa8a-1bec-48a7-9af4-dd0df3339101\"}":{".":{},"f:apiVersion":{},"f:blockOwnerDeletion":{},"f:controller":{},"f:kind":{},"f:name":{},"f:uid":{}}}}}}]},"data":{"operatorDefaults.conf":"cluster_formation.peer_discovery_backend             = rabbit_peer_discovery_k8s\ncluster_formation.k8s.host                           = kubernetes.default\ncluster_formation.k8s.address_type                   = hostname\ncluster_partition_handling                           = pause_minority\nqueue_master_locator                                 = min-masters\ndisk_free_limit.absolute                             = 2GB\ncluster_formation.randomized_startup_delay_range.min = 5\ncluster_formation.randomized_startup_delay_range.max = 30\ncluster_name                                         = rabbitmq-cluster\n","userDefinedConfiguration.conf":"total_memory_available_override_value = 1717986919\n"}}
2022/03/18 18:06:25 learn_server.go:289: [SIEVE-AFTER-HEAR]	8
2022/03/18 18:06:25 learn_server.go:263: [SIEVE-AFTER-WRITE]	7	Create	configmap	github.com/rabbitmq/cluster-operator/controllers.(*RabbitmqClusterReconciler)	NoError	{"metadata":{"name":"rabbitmq-cluster-server-conf","namespace":"default","selfLink":"/api/v1/namespaces/default/configmaps/rabbitmq-cluster-server-conf","uid":"e4182078-d429-4baf-9021-72618c509ac5","resourceVersion":"1095","creationTimestamp":"2022-03-18T18:06:25Z","labels":{"app.kubernetes.io/component":"rabbitmq","app.kubernetes.io/name":"rabbitmq-cluster","app.kubernetes.io/part-of":"rabbitmq"},"ownerReferences":[{"apiVersion":"rabbitmq.com/v1beta1","kind":"RabbitmqCluster","name":"rabbitmq-cluster","uid":"3ecefa8a-1bec-48a7-9af4-dd0df3339101","controller":true,"blockOwnerDeletion":true}],"managedFields":[{"manager":"manager","operation":"Update","apiVersion":"v1","time":"2022-03-18T18:06:25Z","fieldsType":"FieldsV1","fieldsV1":{"f:data":{".":{},"f:operatorDefaults.conf":{},"f:userDefinedConfiguration.conf":{}},"f:metadata":{"f:labels":{".":{},"f:app.kubernetes.io/component":{},"f:app.kubernetes.io/name":{},"f:app.kubernetes.io/part-of":{}},"f:ownerReferences":{".":{},"k:{\"uid\":\"3ecefa8a-1bec-48a7-9af4-dd0df3339101\"}":{".":{},"f:apiVersion":{},"f:blockOwnerDeletion":{},"f:controller":{},"f:kind":{},"f:name":{},"f:uid":{}}}}}}]},"data":{"operatorDefaults.conf":"cluster_formation.peer_discovery_backend             = rabbit_peer_discovery_k8s\ncluster_formation.k8s.host                           = kubernetes.default\ncluster_formation.k8s.address_type                   = hostname\ncluster_partition_handling                           = pause_minority\nqueue_master_locator                                 = min-masters\ndisk_free_limit.absolute                             = 2GB\ncluster_formation.randomized_startup_delay_range.min = 5\ncluster_formation.randomized_startup_delay_range.max = 30\ncluster_name                                         = rabbitmq-cluster\n","userDefinedConfiguration.conf":"total_memory_available_override_value = 1717986919\n"}}
2022/03/18 18:06:25 learn_server.go:291: [SIEVE-AFTER-READ]	Get	true	serviceaccount	default	rabbitmq-cluster-server	github.com/rabbitmq/cluster-operator/controllers.(*RabbitmqClusterReconciler)	NotFound	{"metadata":{"name":"rabbitmq-cluster-server","namespace":"default","creationTimestamp":null}}
2022/03/18 18:06:25 learn_server.go:256: [SIEVE-BEFORE-WRITE]	8
2022/03/18 18:06:25 learn_server.go:279: [SIEVE-BEFORE-HEAR]	9	Added	serviceaccount	{"metadata":{"name":"rabbitmq-cluster-server","namespace":"default","selfLink":"/api/v1/namespaces/default/serviceaccounts/rabbitmq-cluster-server","uid":"0c3cead0-37dd-452b-b939-fe346a5dfdea","resourceVersion":"1097","creationTimestamp":"2022-03-18T18:06:25Z","labels":{"app.kubernetes.io/component":"rabbitmq","app.kubernetes.io/name":"rabbitmq-cluster","app.kubernetes.io/part-of":"rabbitmq"},"ownerReferences":[{"apiVersion":"rabbitmq.com/v1beta1","kind":"RabbitmqCluster","name":"rabbitmq-cluster","uid":"3ecefa8a-1bec-48a7-9af4-dd0df3339101","controller":true,"blockOwnerDeletion":true}],"managedFields":[{"manager":"manager","operation":"Update","apiVersion":"v1","time":"2022-03-18T18:06:25Z","fieldsType":"FieldsV1","fieldsV1":{"f:metadata":{"f:labels":{".":{},"f:app.kubernetes.io/component":{},"f:app.kubernetes.io/name":{},"f:app.kubernetes.io/part-of":{}},"f:ownerReferences":{".":{},"k:{\"uid\":\"3ecefa8a-1bec-48a7-9af4-dd0df3339101\"}":{".":{},"f:apiVersion":{},"f:blockOwnerDeletion":{},"f:controller":{},"f:kind":{},"f:name":{},"f:uid":{}}}}}}]}}
2022/03/18 18:06:25 learn_server.go:289: [SIEVE-AFTER-HEAR]	9
2022/03/18 18:06:25 learn_server.go:263: [SIEVE-AFTER-WRITE]	8	Create	serviceaccount	github.com/rabbitmq/cluster-operator/controllers.(*RabbitmqClusterReconciler)	NoError	{"metadata":{"name":"rabbitmq-cluster-server","namespace":"default","selfLink":"/api/v1/namespaces/default/serviceaccounts/rabbitmq-cluster-server","uid":"0c3cead0-37dd-452b-b939-fe346a5dfdea","resourceVersion":"1097","creationTimestamp":"2022-03-18T18:06:25Z","labels":{"app.kubernetes.io/component":"rabbitmq","app.kubernetes.io/name":"rabbitmq-cluster","app.kubernetes.io/part-of":"rabbitmq"},"ownerReferences":[{"apiVersion":"rabbitmq.com/v1beta1","kind":"RabbitmqCluster","name":"rabbitmq-cluster","uid":"3ecefa8a-1bec-48a7-9af4-dd0df3339101","controller":true,"blockOwnerDeletion":true}],"managedFields":[{"manager":"manager","operation":"Update","apiVersion":"v1","time":"2022-03-18T18:06:25Z","fieldsType":"FieldsV1","fieldsV1":{"f:metadata":{"f:labels":{".":{},"f:app.kubernetes.io/component":{},"f:app.kubernetes.io/name":{},"f:app.kubernetes.io/part-of":{}},"f:ownerReferences":{".":{},"k:{\"uid\":\"3ecefa8a-1bec-48a7-9af4-dd0df3339101\"}":{".":{},"f:apiVersion":{},"f:blockOwnerDeletion":{},"f:controller":{},"f:kind":{},"f:name":{},"f:uid":{}}}}}}]}}
2022/03/18 18:06:25 learn_server.go:291: [SIEVE-AFTER-READ]	Get	true	role	default	rabbitmq-cluster-peer-discovery	github.com/rabbitmq/cluster-operator/controllers.(*RabbitmqClusterReconciler)	NotFound	{"metadata":{"name":"rabbitmq-cluster-peer-discovery","namespace":"default","creationTimestamp":null},"rules":null}
2022/03/18 18:06:25 learn_server.go:256: [SIEVE-BEFORE-WRITE]	9
2022/03/18 18:06:25 learn_server.go:279: [SIEVE-BEFORE-HEAR]	10	Updated	serviceaccount	{"metadata":{"name":"rabbitmq-cluster-server","namespace":"default","selfLink":"/api/v1/namespaces/default/serviceaccounts/rabbitmq-cluster-server","uid":"0c3cead0-37dd-452b-b939-fe346a5dfdea","resourceVersion":"1102","creationTimestamp":"2022-03-18T18:06:25Z","labels":{"app.kubernetes.io/component":"rabbitmq","app.kubernetes.io/name":"rabbitmq-cluster","app.kubernetes.io/part-of":"rabbitmq"},"ownerReferences":[{"apiVersion":"rabbitmq.com/v1beta1","kind":"RabbitmqCluster","name":"rabbitmq-cluster","uid":"3ecefa8a-1bec-48a7-9af4-dd0df3339101","controller":true,"blockOwnerDeletion":true}],"managedFields":[{"manager":"kube-controller-manager","operation":"Update","apiVersion":"v1","time":"2022-03-18T18:06:25Z","fieldsType":"FieldsV1","fieldsV1":{"f:secrets":{".":{},"k:{\"name\":\"rabbitmq-cluster-server-token-v4wpv\"}":{".":{},"f:name":{}}}}},{"manager":"manager","operation":"Update","apiVersion":"v1","time":"2022-03-18T18:06:25Z","fieldsType":"FieldsV1","fieldsV1":{"f:metadata":{"f:labels":{".":{},"f:app.kubernetes.io/component":{},"f:app.kubernetes.io/name":{},"f:app.kubernetes.io/part-of":{}},"f:ownerReferences":{".":{},"k:{\"uid\":\"3ecefa8a-1bec-48a7-9af4-dd0df3339101\"}":{".":{},"f:apiVersion":{},"f:blockOwnerDeletion":{},"f:controller":{},"f:kind":{},"f:name":{},"f:uid":{}}}}}}]},"secrets":[{"name":"rabbitmq-cluster-server-token-v4wpv"}]}
2022/03/18 18:06:25 learn_server.go:289: [SIEVE-AFTER-HEAR]	10
2022/03/18 18:06:25 learn_server.go:263: [SIEVE-AFTER-WRITE]	9	Create	role	github.com/rabbitmq/cluster-operator/controllers.(*RabbitmqClusterReconciler)	NoError	{"metadata":{"name":"rabbitmq-cluster-peer-discovery","namespace":"default","selfLink":"/apis/rbac.authorization.k8s.io/v1/namespaces/default/roles/rabbitmq-cluster-peer-discovery","uid":"ec9ac474-1880-43ed-af46-9ea5f46d6db4","resourceVersion":"1103","creationTimestamp":"2022-03-18T18:06:25Z","labels":{"app.kubernetes.io/component":"rabbitmq","app.kubernetes.io/name":"rabbitmq-cluster","app.kubernetes.io/part-of":"rabbitmq"},"ownerReferences":[{"apiVersion":"rabbitmq.com/v1beta1","kind":"RabbitmqCluster","name":"rabbitmq-cluster","uid":"3ecefa8a-1bec-48a7-9af4-dd0df3339101","controller":true,"blockOwnerDeletion":true}],"managedFields":[{"manager":"manager","operation":"Update","apiVersion":"rbac.authorization.k8s.io/v1","time":"2022-03-18T18:06:25Z","fieldsType":"FieldsV1","fieldsV1":{"f:metadata":{"f:labels":{".":{},"f:app.kubernetes.io/component":{},"f:app.kubernetes.io/name":{},"f:app.kubernetes.io/part-of":{}},"f:ownerReferences":{".":{},"k:{\"uid\":\"3ecefa8a-1bec-48a7-9af4-dd0df3339101\"}":{".":{},"f:apiVersion":{},"f:blockOwnerDeletion":{},"f:controller":{},"f:kind":{},"f:name":{},"f:uid":{}}}},"f:rules":{}}}]},"rules":[{"verbs":["get"],"apiGroups":[""],"resources":["endpoints"]},{"verbs":["create"],"apiGroups":[""],"resources":["events"]}]}
2022/03/18 18:06:25 learn_server.go:291: [SIEVE-AFTER-READ]	Get	true	rolebinding	default	rabbitmq-cluster-server	github.com/rabbitmq/cluster-operator/controllers.(*RabbitmqClusterReconciler)	NotFound	{"metadata":{"name":"rabbitmq-cluster-server","namespace":"default","creationTimestamp":null},"roleRef":{"apiGroup":"","kind":"","name":""}}
2022/03/18 18:06:25 learn_server.go:256: [SIEVE-BEFORE-WRITE]	10
2022/03/18 18:06:25 learn_server.go:279: [SIEVE-BEFORE-HEAR]	11	Added	rolebinding	{"metadata":{"name":"rabbitmq-cluster-server","namespace":"default","selfLink":"/apis/rbac.authorization.k8s.io/v1/namespaces/default/rolebindings/rabbitmq-cluster-server","uid":"fe69a41c-8d28-4b84-a9f6-a9e6044d75ba","resourceVersion":"1105","creationTimestamp":"2022-03-18T18:06:25Z","labels":{"app.kubernetes.io/component":"rabbitmq","app.kubernetes.io/name":"rabbitmq-cluster","app.kubernetes.io/part-of":"rabbitmq"},"ownerReferences":[{"apiVersion":"rabbitmq.com/v1beta1","kind":"RabbitmqCluster","name":"rabbitmq-cluster","uid":"3ecefa8a-1bec-48a7-9af4-dd0df3339101","controller":true,"blockOwnerDeletion":true}],"managedFields":[{"manager":"manager","operation":"Update","apiVersion":"rbac.authorization.k8s.io/v1","time":"2022-03-18T18:06:25Z","fieldsType":"FieldsV1","fieldsV1":{"f:metadata":{"f:labels":{".":{},"f:app.kubernetes.io/component":{},"f:app.kubernetes.io/name":{},"f:app.kubernetes.io/part-of":{}},"f:ownerReferences":{".":{},"k:{\"uid\":\"3ecefa8a-1bec-48a7-9af4-dd0df3339101\"}":{".":{},"f:apiVersion":{},"f:blockOwnerDeletion":{},"f:controller":{},"f:kind":{},"f:name":{},"f:uid":{}}}},"f:roleRef":{"f:apiGroup":{},"f:kind":{},"f:name":{}},"f:subjects":{}}}]},"subjects":[{"kind":"ServiceAccount","name":"rabbitmq-cluster-server"}],"roleRef":{"apiGroup":"rbac.authorization.k8s.io","kind":"Role","name":"rabbitmq-cluster-peer-discovery"}}
2022/03/18 18:06:25 learn_server.go:279: [SIEVE-BEFORE-HEAR]	12	Added	role	{"metadata":{"name":"rabbitmq-cluster-peer-discovery","namespace":"default","selfLink":"/apis/rbac.authorization.k8s.io/v1/namespaces/default/roles/rabbitmq-cluster-peer-discovery","uid":"ec9ac474-1880-43ed-af46-9ea5f46d6db4","resourceVersion":"1103","creationTimestamp":"2022-03-18T18:06:25Z","labels":{"app.kubernetes.io/component":"rabbitmq","app.kubernetes.io/name":"rabbitmq-cluster","app.kubernetes.io/part-of":"rabbitmq"},"ownerReferences":[{"apiVersion":"rabbitmq.com/v1beta1","kind":"RabbitmqCluster","name":"rabbitmq-cluster","uid":"3ecefa8a-1bec-48a7-9af4-dd0df3339101","controller":true,"blockOwnerDeletion":true}],"managedFields":[{"manager":"manager","operation":"Update","apiVersion":"rbac.authorization.k8s.io/v1","time":"2022-03-18T18:06:25Z","fieldsType":"FieldsV1","fieldsV1":{"f:metadata":{"f:labels":{".":{},"f:app.kubernetes.io/component":{},"f:app.kubernetes.io/name":{},"f:app.kubernetes.io/part-of":{}},"f:ownerReferences":{".":{},"k:{\"uid\":\"3ecefa8a-1bec-48a7-9af4-dd0df3339101\"}":{".":{},"f:apiVersion":{},"f:blockOwnerDeletion":{},"f:controller":{},"f:kind":{},"f:name":{},"f:uid":{}}}},"f:rules":{}}}]},"rules":[{"verbs":["get"],"apiGroups":[""],"resources":["endpoints"]},{"verbs":["create"],"apiGroups":[""],"resources":["events"]}]}
2022/03/18 18:06:25 learn_server.go:263: [SIEVE-AFTER-WRITE]	10	Create	rolebinding	github.com/rabbitmq/cluster-operator/controllers.(*RabbitmqClusterReconciler)	NoError	{"metadata":{"name":"rabbitmq-cluster-server","namespace":"default","selfLink":"/apis/rbac.authorization.k8s.io/v1/namespaces/default/rolebindings/rabbitmq-cluster-server","uid":"fe69a41c-8d28-4b84-a9f6-a9e6044d75ba","resourceVersion":"1105","creationTimestamp":"2022-03-18T18:06:25Z","labels":{"app.kubernetes.io/component":"rabbitmq","app.kubernetes.io/name":"rabbitmq-cluster","app.kubernetes.io/part-of":"rabbitmq"},"ownerReferences":[{"apiVersion":"rabbitmq.com/v1beta1","kind":"RabbitmqCluster","name":"rabbitmq-cluster","uid":"3ecefa8a-1bec-48a7-9af4-dd0df3339101","controller":true,"blockOwnerDeletion":true}],"managedFields":[{"manager":"manager","operation":"Update","apiVersion":"rbac.authorization.k8s.io/v1","time":"2022-03-18T18:06:25Z","fieldsType":"FieldsV1","fieldsV1":{"f:metadata":{"f:labels":{".":{},"f:app.kubernetes.io/component":{},"f:app.kubernetes.io/name":{},"f:app.kubernetes.io/part-of":{}},"f:ownerReferences":{".":{},"k:{\"uid\":\"3ecefa8a-1bec-48a7-9af4-dd0df3339101\"}":{".":{},"f:apiVersion":{},"f:blockOwnerDeletion":{},"f:controller":{},"f:kind":{},"f:name":{},"f:uid":{}}}},"f:roleRef":{"f:apiGroup":{},"f:kind":{},"f:name":{}},"f:subjects":{}}}]},"subjects":[{"kind":"ServiceAccount","name":"rabbitmq-cluster-server"}],"roleRef":{"apiGroup":"rbac.authorization.k8s.io","kind":"Role","name":"rabbitmq-cluster-peer-discovery"}}
2022/03/18 18:06:25 learn_server.go:289: [SIEVE-AFTER-HEAR]	12
2022/03/18 18:06:25 learn_server.go:289: [SIEVE-AFTER-HEAR]	11
2022/03/18 18:06:25 learn_server.go:291: [SIEVE-AFTER-READ]	Get	true	statefulset	default	rabbitmq-cluster-server	github.com/rabbitmq/cluster-operator/controllers.(*RabbitmqClusterReconciler)	NotFound	{"metadata":{"creationTimestamp":null},"spec":{"selector":null,"template":{"metadata":{"creationTimestamp":null},"spec":{"containers":null}},"serviceName":"","updateStrategy":{}},"status":{"replicas":0}}
2022/03/18 18:06:25 learn_server.go:291: [SIEVE-AFTER-READ]	Get	true	statefulset	default	rabbitmq-cluster-server	github.com/rabbitmq/cluster-operator/controllers.(*RabbitmqClusterReconciler)	NotFound	{"metadata":{"name":"rabbitmq-cluster-server","namespace":"default","creationTimestamp":null},"spec":{"selector":{"matchLabels":{"app.kubernetes.io/name":"rabbitmq-cluster"}},"template":{"metadata":{"creationTimestamp":null},"spec":{"containers":null}},"volumeClaimTemplates":[{"metadata":{"name":"persistence","namespace":"default","creationTimestamp":null,"labels":{"app.kubernetes.io/component":"rabbitmq","app.kubernetes.io/name":"rabbitmq-cluster","app.kubernetes.io/part-of":"rabbitmq"},"ownerReferences":[{"apiVersion":"rabbitmq.com/v1beta1","kind":"RabbitmqCluster","name":"rabbitmq-cluster","uid":"3ecefa8a-1bec-48a7-9af4-dd0df3339101","controller":true,"blockOwnerDeletion":false}]},"spec":{"accessModes":["ReadWriteOnce"],"resources":{"requests":{"storage":"10Gi"}}},"status":{}}],"serviceName":"rabbitmq-cluster-nodes","podManagementPolicy":"Parallel","updateStrategy":{}},"status":{"replicas":0}}
2022/03/18 18:06:25 learn_server.go:256: [SIEVE-BEFORE-WRITE]	11
2022/03/18 18:06:25 learn_server.go:279: [SIEVE-BEFORE-HEAR]	13	Added	statefulset	{"metadata":{"name":"rabbitmq-cluster-server","namespace":"default","selfLink":"/apis/apps/v1/namespaces/default/statefulsets/rabbitmq-cluster-server","uid":"f2f07f3e-b500-4c48-a5de-8db7eaf37b9a","resourceVersion":"1107","generation":1,"creationTimestamp":"2022-03-18T18:06:25Z","labels":{"app.kubernetes.io/component":"rabbitmq","app.kubernetes.io/name":"rabbitmq-cluster","app.kubernetes.io/part-of":"rabbitmq"},"ownerReferences":[{"apiVersion":"rabbitmq.com/v1beta1","kind":"RabbitmqCluster","name":"rabbitmq-cluster","uid":"3ecefa8a-1bec-48a7-9af4-dd0df3339101","controller":true,"blockOwnerDeletion":true}],"managedFields":[{"manager":"manager","operation":"Update","apiVersion":"apps/v1","time":"2022-03-18T18:06:25Z","fieldsType":"FieldsV1","fieldsV1":{"f:metadata":{"f:labels":{".":{},"f:app.kubernetes.io/component":{},"f:app.kubernetes.io/name":{},"f:app.kubernetes.io/part-of":{}},"f:ownerReferences":{".":{},"k:{\"uid\":\"3ecefa8a-1bec-48a7-9af4-dd0df3339101\"}":{".":{},"f:apiVersion":{},"f:blockOwnerDeletion":{},"f:controller":{},"f:kind":{},"f:name":{},"f:uid":{}}}},"f:spec":{"f:podManagementPolicy":{},"f:replicas":{},"f:revisionHistoryLimit":{},"f:selector":{"f:matchLabels":{".":{},"f:app.kubernetes.io/name":{}}},"f:serviceName":{},"f:template":{"f:metadata":{"f:annotations":{".":{},"f:prometheus.io/port":{},"f:prometheus.io/scrape":{}},"f:labels":{".":{},"f:app.kubernetes.io/component":{},"f:app.kubernetes.io/name":{},"f:app.kubernetes.io/part-of":{}}},"f:spec":{"f:automountServiceAccountToken":{},"f:containers":{"k:{\"name\":\"rabbitmq\"}":{".":{},"f:env":{".":{},"k:{\"name\":\"K8S_HOSTNAME_SUFFIX\"}":{".":{},"f:name":{},"f:value":{}},"k:{\"name\":\"K8S_SERVICE_NAME\"}":{".":{},"f:name":{},"f:value":{}},"k:{\"name\":\"MY_POD_NAME\"}":{".":{},"f:name":{},"f:valueFrom":{".":{},"f:fieldRef":{".":{},"f:apiVersion":{},"f:fieldPath":{}}}},"k:{\"name\":\"MY_POD_NAMESPACE\"}":{".":{},"f:name":{},"f:valueFrom":{".":{},"f:fieldRef":{".":{},"f:apiVersion":{},"f:fieldPath":{}}}},"k:{\"name\":\"RABBITMQ_ENABLED_PLUGINS_FILE\"}":{".":{},"f:name":{},"f:value":{}},"k:{\"name\":\"RABBITMQ_NODENAME\"}":{".":{},"f:name":{},"f:value":{}},"k:{\"name\":\"RABBITMQ_USE_LONGNAME\"}":{".":{},"f:name":{},"f:value":{}}},"f:image":{},"f:imagePullPolicy":{},"f:lifecycle":{".":{},"f:preStop":{".":{},"f:exec":{".":{},"f:command":{}}}},"f:name":{},"f:ports":{".":{},"k:{\"containerPort\":4369,\"protocol\":\"TCP\"}":{".":{},"f:containerPort":{},"f:name":{},"f:protocol":{}},"k:{\"containerPort\":5672,\"protocol\":\"TCP\"}":{".":{},"f:containerPort":{},"f:name":{},"f:protocol":{}},"k:{\"containerPort\":15672,\"protocol\":\"TCP\"}":{".":{},"f:containerPort":{},"f:name":{},"f:protocol":{}},"k:{\"containerPort\":15692,\"protocol\":\"TCP\"}":{".":{},"f:containerPort":{},"f:name":{},"f:protocol":{}}},"f:readinessProbe":{".":{},"f:failureThreshold":{},"f:initialDelaySeconds":{},"f:periodSeconds":{},"f:successThreshold":{},"f:tcpSocket":{".":{},"f:port":{}},"f:timeoutSeconds":{}},"f:resources":{".":{},"f:limits":{".":{},"f:cpu":{},"f:memory":{}},"f:requests":{".":{},"f:cpu":{},"f:memory":{}}},"f:terminationMessagePath":{},"f:terminationMessagePolicy":{},"f:volumeMounts":{".":{},"k:{\"mountPath\":\"/etc/pod-info/\"}":{".":{},"f:mountPath":{},"f:name":{}},"k:{\"mountPath\":\"/etc/rabbitmq/conf.d/10-operatorDefaults.conf\"}":{".":{},"f:mountPath":{},"f:name":{},"f:subPath":{}},"k:{\"mountPath\":\"/etc/rabbitmq/conf.d/11-default_user.conf\"}":{".":{},"f:mountPath":{},"f:name":{},"f:subPath":{}},"k:{\"mountPath\":\"/etc/rabbitmq/conf.d/90-userDefinedConfiguration.conf\"}":{".":{},"f:mountPath":{},"f:name":{},"f:subPath":{}},"k:{\"mountPath\":\"/operator\"}":{".":{},"f:mountPath":{},"f:name":{}},"k:{\"mountPath\":\"/var/lib/rabbitmq/\"}":{".":{},"f:mountPath":{},"f:name":{}},"k:{\"mountPath\":\"/var/lib/rabbitmq/mnesia/\"}":{".":{},"f:mountPath":{},"f:name":{}}}}},"f:dnsPolicy":{},"f:initContainers":{".":{},"k:{\"name\":\"setup-container\"}":{".":{},"f:command":{},"f:image":{},"f:imagePullPolicy":{},"f:name":{},"f:resources":{".":{},"f:limits":{".":{},"f:cpu":{},"f:memory":{}},"f:requests":{".":{},"f:cpu":{},"f:memory":{}}},"f:securityContext":{".":{},"f:capabilities":{".":{},"f:drop":{}},"f:runAsUser":{}},"f:terminationMessagePath":{},"f:terminationMessagePolicy":{},"f:volumeMounts":{".":{},"k:{\"mountPath\":\"/operator\"}":{".":{},"f:mountPath":{},"f:name":{}},"k:{\"mountPath\":\"/tmp/default_user.conf\"}":{".":{},"f:mountPath":{},"f:name":{},"f:subPath":{}},"k:{\"mountPath\":\"/tmp/erlang-cookie-secret/\"}":{".":{},"f:mountPath":{},"f:name":{}},"k:{\"mountPath\":\"/tmp/rabbitmq-plugins/\"}":{".":{},"f:mountPath":{},"f:name":{}},"k:{\"mountPath\":\"/var/lib/rabbitmq/\"}":{".":{},"f:mountPath":{},"f:name":{}},"k:{\"mountPath\":\"/var/lib/rabbitmq/mnesia/\"}":{".":{},"f:mountPath":{},"f:name":{}}}}},"f:restartPolicy":{},"f:schedulerName":{},"f:securityContext":{".":{},"f:fsGroup":{},"f:runAsGroup":{},"f:runAsUser":{}},"f:serviceAccount":{},"f:serviceAccountName":{},"f:terminationGracePeriodSeconds":{},"f:topologySpreadConstraints":{".":{},"k:{\"topologyKey\":\"topology.kubernetes.io/zone\",\"whenUnsatisfiable\":\"ScheduleAnyway\"}":{".":{},"f:labelSelector":{".":{},"f:matchLabels":{".":{},"f:app.kubernetes.io/name":{}}},"f:maxSkew":{},"f:topologyKey":{},"f:whenUnsatisfiable":{}}},"f:volumes":{".":{},"k:{\"name\":\"erlang-cookie-secret\"}":{".":{},"f:name":{},"f:secret":{".":{},"f:defaultMode":{},"f:secretName":{}}},"k:{\"name\":\"plugins-conf\"}":{".":{},"f:configMap":{".":{},"f:defaultMode":{},"f:name":{}},"f:name":{}},"k:{\"name\":\"pod-info\"}":{".":{},"f:downwardAPI":{".":{},"f:defaultMode":{},"f:items":{}},"f:name":{}},"k:{\"name\":\"rabbitmq-confd\"}":{".":{},"f:name":{},"f:projected":{".":{},"f:defaultMode":{},"f:sources":{}}},"k:{\"name\":\"rabbitmq-erlang-cookie\"}":{".":{},"f:emptyDir":{},"f:name":{}},"k:{\"name\":\"rabbitmq-plugins\"}":{".":{},"f:emptyDir":{},"f:name":{}}}}},"f:updateStrategy":{"f:rollingUpdate":{".":{},"f:partition":{}},"f:type":{}},"f:volumeClaimTemplates":{}}}}]},"spec":{"replicas":1,"selector":{"matchLabels":{"app.kubernetes.io/name":"rabbitmq-cluster"}},"template":{"metadata":{"creationTimestamp":null,"labels":{"app.kubernetes.io/component":"rabbitmq","app.kubernetes.io/name":"rabbitmq-cluster","app.kubernetes.io/part-of":"rabbitmq"},"annotations":{"prometheus.io/port":"15692","prometheus.io/scrape":"true"}},"spec":{"volumes":[{"name":"plugins-conf","configMap":{"name":"rabbitmq-cluster-plugins-conf","defaultMode":420}},{"name":"rabbitmq-confd","projected":{"sources":[{"secret":{"name":"rabbitmq-cluster-default-user","items":[{"key":"default_user.conf","path":"default_user.conf"}]}},{"configMap":{"name":"rabbitmq-cluster-server-conf","items":[{"key":"operatorDefaults.conf","path":"operatorDefaults.conf"},{"key":"userDefinedConfiguration.conf","path":"userDefinedConfiguration.conf"}]}}],"defaultMode":420}},{"name":"rabbitmq-erlang-cookie","emptyDir":{}},{"name":"erlang-cookie-secret","secret":{"secretName":"rabbitmq-cluster-erlang-cookie","defaultMode":420}},{"name":"rabbitmq-plugins","emptyDir":{}},{"name":"pod-info","downwardAPI":{"items":[{"path":"skipPreStopChecks","fieldRef":{"apiVersion":"v1","fieldPath":"metadata.labels['skipPreStopChecks']"}}],"defaultMode":420}}],"initContainers":[{"name":"setup-container","image":"rabbitmq:3.8.12-management","command":["sh","-c","cp /tmp/erlang-cookie-secret/.erlang.cookie /var/lib/rabbitmq/.erlang.cookie \u0026\u0026 chown 999:999 /var/lib/rabbitmq/.erlang.cookie \u0026\u0026 chmod 600 /var/lib/rabbitmq/.erlang.cookie ; cp /tmp/rabbitmq-plugins/enabled_plugins /operator/enabled_plugins \u0026\u0026 chown 999:999 /operator/enabled_plugins ; chown 999:999 /var/lib/rabbitmq/mnesia/ ; echo '[default]' \u003e /var/lib/rabbitmq/.rabbitmqadmin.conf \u0026\u0026 sed -e 's/default_user/username/' -e 's/default_pass/password/' /tmp/default_user.conf \u003e\u003e /var/lib/rabbitmq/.rabbitmqadmin.conf \u0026\u0026 chown 999:999 /var/lib/rabbitmq/.rabbitmqadmin.conf \u0026\u0026 chmod 600 /var/lib/rabbitmq/.rabbitmqadmin.conf"],"resources":{"limits":{"cpu":"100m","memory":"500Mi"},"requests":{"cpu":"100m","memory":"500Mi"}},"volumeMounts":[{"name":"plugins-conf","mountPath":"/tmp/rabbitmq-plugins/"},{"name":"rabbitmq-erlang-cookie","mountPath":"/var/lib/rabbitmq/"},{"name":"erlang-cookie-secret","mountPath":"/tmp/erlang-cookie-secret/"},{"name":"rabbitmq-plugins","mountPath":"/operator"},{"name":"persistence","mountPath":"/var/lib/rabbitmq/mnesia/"},{"name":"rabbitmq-confd","mountPath":"/tmp/default_user.conf","subPath":"default_user.conf"}],"terminationMessagePath":"/dev/termination-log","terminationMessagePolicy":"File","imagePullPolicy":"IfNotPresent","securityContext":{"capabilities":{"drop":["FSETID","KILL","SETGID","SETUID","SETPCAP","NET_BIND_SERVICE","NET_RAW","SYS_CHROOT","MKNOD","AUDIT_WRITE","SETFCAP"]},"runAsUser":0}}],"containers":[{"name":"rabbitmq","image":"rabbitmq:3.8.12-management","ports":[{"name":"epmd","containerPort":4369,"protocol":"TCP"},{"name":"amqp","containerPort":5672,"protocol":"TCP"},{"name":"management","containerPort":15672,"protocol":"TCP"},{"name":"prometheus","containerPort":15692,"protocol":"TCP"}],"env":[{"name":"MY_POD_NAME","valueFrom":{"fieldRef":{"apiVersion":"v1","fieldPath":"metadata.name"}}},{"name":"MY_POD_NAMESPACE","valueFrom":{"fieldRef":{"apiVersion":"v1","fieldPath":"metadata.namespace"}}},{"name":"RABBITMQ_ENABLED_PLUGINS_FILE","value":"/operator/enabled_plugins"},{"name":"K8S_SERVICE_NAME","value":"rabbitmq-cluster-nodes"},{"name":"RABBITMQ_USE_LONGNAME","value":"true"},{"name":"RABBITMQ_NODENAME","value":"rabbit@$(MY_POD_NAME).$(K8S_SERVICE_NAME).$(MY_POD_NAMESPACE)"},{"name":"K8S_HOSTNAME_SUFFIX","value":".$(K8S_SERVICE_NAME).$(MY_POD_NAMESPACE)"}],"resources":{"limits":{"cpu":"2","memory":"2Gi"},"requests":{"cpu":"1","memory":"2Gi"}},"volumeMounts":[{"name":"rabbitmq-erlang-cookie","mountPath":"/var/lib/rabbitmq/"},{"name":"persistence","mountPath":"/var/lib/rabbitmq/mnesia/"},{"name":"rabbitmq-plugins","mountPath":"/operator"},{"name":"rabbitmq-confd","mountPath":"/etc/rabbitmq/conf.d/10-operatorDefaults.conf","subPath":"operatorDefaults.conf"},{"name":"rabbitmq-confd","mountPath":"/etc/rabbitmq/conf.d/11-default_user.conf","subPath":"default_user.conf"},{"name":"rabbitmq-confd","mountPath":"/etc/rabbitmq/conf.d/90-userDefinedConfiguration.conf","subPath":"userDefinedConfiguration.conf"},{"name":"pod-info","mountPath":"/etc/pod-info/"}],"readinessProbe":{"tcpSocket":{"port":"amqp"},"initialDelaySeconds":10,"timeoutSeconds":5,"periodSeconds":10,"successThreshold":1,"failureThreshold":3},"lifecycle":{"preStop":{"exec":{"command":["/bin/bash","-c","if [ ! -z \"$(cat /etc/pod-info/skipPreStopChecks)\" ]; then exit 0; fi; rabbitmq-upgrade await_online_quorum_plus_one -t 604800; rabbitmq-upgrade await_online_synchronized_mirror -t 604800; rabbitmq-upgrade drain -t 604800"]}}},"terminationMessagePath":"/dev/termination-log","terminationMessagePolicy":"File","imagePullPolicy":"IfNotPresent"}],"restartPolicy":"Always","terminationGracePeriodSeconds":604800,"dnsPolicy":"ClusterFirst","serviceAccountName":"rabbitmq-cluster-server","serviceAccount":"rabbitmq-cluster-server","automountServiceAccountToken":true,"securityContext":{"runAsUser":999,"runAsGroup":999,"fsGroup":999},"schedulerName":"default-scheduler","topologySpreadConstraints":[{"maxSkew":1,"topologyKey":"topology.kubernetes.io/zone","whenUnsatisfiable":"ScheduleAnyway","labelSelector":{"matchLabels":{"app.kubernetes.io/name":"rabbitmq-cluster"}}}]}},"volumeClaimTemplates":[{"metadata":{"name":"persistence","namespace":"default","creationTimestamp":null,"labels":{"app.kubernetes.io/component":"rabbitmq","app.kubernetes.io/name":"rabbitmq-cluster","app.kubernetes.io/part-of":"rabbitmq"},"ownerReferences":[{"apiVersion":"rabbitmq.com/v1beta1","kind":"RabbitmqCluster","name":"rabbitmq-cluster","uid":"3ecefa8a-1bec-48a7-9af4-dd0df3339101","controller":true,"blockOwnerDeletion":false}]},"spec":{"accessModes":["ReadWriteOnce"],"resources":{"requests":{"storage":"10Gi"}},"volumeMode":"Filesystem"},"status":{"phase":"Pending"}}],"serviceName":"rabbitmq-cluster-nodes","podManagementPolicy":"Parallel","updateStrategy":{"type":"RollingUpdate","rollingUpdate":{"partition":0}},"revisionHistoryLimit":10},"status":{"replicas":0}}
2022/03/18 18:06:25 learn_server.go:289: [SIEVE-AFTER-HEAR]	13
2022/03/18 18:06:25 learn_server.go:263: [SIEVE-AFTER-WRITE]	11	Create	statefulset	github.com/rabbitmq/cluster-operator/controllers.(*RabbitmqClusterReconciler)	NoError	{"metadata":{"name":"rabbitmq-cluster-server","namespace":"default","selfLink":"/apis/apps/v1/namespaces/default/statefulsets/rabbitmq-cluster-server","uid":"f2f07f3e-b500-4c48-a5de-8db7eaf37b9a","resourceVersion":"1107","generation":1,"creationTimestamp":"2022-03-18T18:06:25Z","labels":{"app.kubernetes.io/component":"rabbitmq","app.kubernetes.io/name":"rabbitmq-cluster","app.kubernetes.io/part-of":"rabbitmq"},"ownerReferences":[{"apiVersion":"rabbitmq.com/v1beta1","kind":"RabbitmqCluster","name":"rabbitmq-cluster","uid":"3ecefa8a-1bec-48a7-9af4-dd0df3339101","controller":true,"blockOwnerDeletion":true}],"managedFields":[{"manager":"manager","operation":"Update","apiVersion":"apps/v1","time":"2022-03-18T18:06:25Z","fieldsType":"FieldsV1","fieldsV1":{"f:metadata":{"f:labels":{".":{},"f:app.kubernetes.io/component":{},"f:app.kubernetes.io/name":{},"f:app.kubernetes.io/part-of":{}},"f:ownerReferences":{".":{},"k:{\"uid\":\"3ecefa8a-1bec-48a7-9af4-dd0df3339101\"}":{".":{},"f:apiVersion":{},"f:blockOwnerDeletion":{},"f:controller":{},"f:kind":{},"f:name":{},"f:uid":{}}}},"f:spec":{"f:podManagementPolicy":{},"f:replicas":{},"f:revisionHistoryLimit":{},"f:selector":{"f:matchLabels":{".":{},"f:app.kubernetes.io/name":{}}},"f:serviceName":{},"f:template":{"f:metadata":{"f:annotations":{".":{},"f:prometheus.io/port":{},"f:prometheus.io/scrape":{}},"f:labels":{".":{},"f:app.kubernetes.io/component":{},"f:app.kubernetes.io/name":{},"f:app.kubernetes.io/part-of":{}}},"f:spec":{"f:automountServiceAccountToken":{},"f:containers":{"k:{\"name\":\"rabbitmq\"}":{".":{},"f:env":{".":{},"k:{\"name\":\"K8S_HOSTNAME_SUFFIX\"}":{".":{},"f:name":{},"f:value":{}},"k:{\"name\":\"K8S_SERVICE_NAME\"}":{".":{},"f:name":{},"f:value":{}},"k:{\"name\":\"MY_POD_NAME\"}":{".":{},"f:name":{},"f:valueFrom":{".":{},"f:fieldRef":{".":{},"f:apiVersion":{},"f:fieldPath":{}}}},"k:{\"name\":\"MY_POD_NAMESPACE\"}":{".":{},"f:name":{},"f:valueFrom":{".":{},"f:fieldRef":{".":{},"f:apiVersion":{},"f:fieldPath":{}}}},"k:{\"name\":\"RABBITMQ_ENABLED_PLUGINS_FILE\"}":{".":{},"f:name":{},"f:value":{}},"k:{\"name\":\"RABBITMQ_NODENAME\"}":{".":{},"f:name":{},"f:value":{}},"k:{\"name\":\"RABBITMQ_USE_LONGNAME\"}":{".":{},"f:name":{},"f:value":{}}},"f:image":{},"f:imagePullPolicy":{},"f:lifecycle":{".":{},"f:preStop":{".":{},"f:exec":{".":{},"f:command":{}}}},"f:name":{},"f:ports":{".":{},"k:{\"containerPort\":4369,\"protocol\":\"TCP\"}":{".":{},"f:containerPort":{},"f:name":{},"f:protocol":{}},"k:{\"containerPort\":5672,\"protocol\":\"TCP\"}":{".":{},"f:containerPort":{},"f:name":{},"f:protocol":{}},"k:{\"containerPort\":15672,\"protocol\":\"TCP\"}":{".":{},"f:containerPort":{},"f:name":{},"f:protocol":{}},"k:{\"containerPort\":15692,\"protocol\":\"TCP\"}":{".":{},"f:containerPort":{},"f:name":{},"f:protocol":{}}},"f:readinessProbe":{".":{},"f:failureThreshold":{},"f:initialDelaySeconds":{},"f:periodSeconds":{},"f:successThreshold":{},"f:tcpSocket":{".":{},"f:port":{}},"f:timeoutSeconds":{}},"f:resources":{".":{},"f:limits":{".":{},"f:cpu":{},"f:memory":{}},"f:requests":{".":{},"f:cpu":{},"f:memory":{}}},"f:terminationMessagePath":{},"f:terminationMessagePolicy":{},"f:volumeMounts":{".":{},"k:{\"mountPath\":\"/etc/pod-info/\"}":{".":{},"f:mountPath":{},"f:name":{}},"k:{\"mountPath\":\"/etc/rabbitmq/conf.d/10-operatorDefaults.conf\"}":{".":{},"f:mountPath":{},"f:name":{},"f:subPath":{}},"k:{\"mountPath\":\"/etc/rabbitmq/conf.d/11-default_user.conf\"}":{".":{},"f:mountPath":{},"f:name":{},"f:subPath":{}},"k:{\"mountPath\":\"/etc/rabbitmq/conf.d/90-userDefinedConfiguration.conf\"}":{".":{},"f:mountPath":{},"f:name":{},"f:subPath":{}},"k:{\"mountPath\":\"/operator\"}":{".":{},"f:mountPath":{},"f:name":{}},"k:{\"mountPath\":\"/var/lib/rabbitmq/\"}":{".":{},"f:mountPath":{},"f:name":{}},"k:{\"mountPath\":\"/var/lib/rabbitmq/mnesia/\"}":{".":{},"f:mountPath":{},"f:name":{}}}}},"f:dnsPolicy":{},"f:initContainers":{".":{},"k:{\"name\":\"setup-container\"}":{".":{},"f:command":{},"f:image":{},"f:imagePullPolicy":{},"f:name":{},"f:resources":{".":{},"f:limits":{".":{},"f:cpu":{},"f:memory":{}},"f:requests":{".":{},"f:cpu":{},"f:memory":{}}},"f:securityContext":{".":{},"f:capabilities":{".":{},"f:drop":{}},"f:runAsUser":{}},"f:terminationMessagePath":{},"f:terminationMessagePolicy":{},"f:volumeMounts":{".":{},"k:{\"mountPath\":\"/operator\"}":{".":{},"f:mountPath":{},"f:name":{}},"k:{\"mountPath\":\"/tmp/default_user.conf\"}":{".":{},"f:mountPath":{},"f:name":{},"f:subPath":{}},"k:{\"mountPath\":\"/tmp/erlang-cookie-secret/\"}":{".":{},"f:mountPath":{},"f:name":{}},"k:{\"mountPath\":\"/tmp/rabbitmq-plugins/\"}":{".":{},"f:mountPath":{},"f:name":{}},"k:{\"mountPath\":\"/var/lib/rabbitmq/\"}":{".":{},"f:mountPath":{},"f:name":{}},"k:{\"mountPath\":\"/var/lib/rabbitmq/mnesia/\"}":{".":{},"f:mountPath":{},"f:name":{}}}}},"f:restartPolicy":{},"f:schedulerName":{},"f:securityContext":{".":{},"f:fsGroup":{},"f:runAsGroup":{},"f:runAsUser":{}},"f:serviceAccount":{},"f:serviceAccountName":{},"f:terminationGracePeriodSeconds":{},"f:topologySpreadConstraints":{".":{},"k:{\"topologyKey\":\"topology.kubernetes.io/zone\",\"whenUnsatisfiable\":\"ScheduleAnyway\"}":{".":{},"f:labelSelector":{".":{},"f:matchLabels":{".":{},"f:app.kubernetes.io/name":{}}},"f:maxSkew":{},"f:topologyKey":{},"f:whenUnsatisfiable":{}}},"f:volumes":{".":{},"k:{\"name\":\"erlang-cookie-secret\"}":{".":{},"f:name":{},"f:secret":{".":{},"f:defaultMode":{},"f:secretName":{}}},"k:{\"name\":\"plugins-conf\"}":{".":{},"f:configMap":{".":{},"f:defaultMode":{},"f:name":{}},"f:name":{}},"k:{\"name\":\"pod-info\"}":{".":{},"f:downwardAPI":{".":{},"f:defaultMode":{},"f:items":{}},"f:name":{}},"k:{\"name\":\"rabbitmq-confd\"}":{".":{},"f:name":{},"f:projected":{".":{},"f:defaultMode":{},"f:sources":{}}},"k:{\"name\":\"rabbitmq-erlang-cookie\"}":{".":{},"f:emptyDir":{},"f:name":{}},"k:{\"name\":\"rabbitmq-plugins\"}":{".":{},"f:emptyDir":{},"f:name":{}}}}},"f:updateStrategy":{"f:rollingUpdate":{".":{},"f:partition":{}},"f:type":{}},"f:volumeClaimTemplates":{}}}}]},"spec":{"replicas":1,"selector":{"matchLabels":{"app.kubernetes.io/name":"rabbitmq-cluster"}},"template":{"metadata":{"creationTimestamp":null,"labels":{"app.kubernetes.io/component":"rabbitmq","app.kubernetes.io/name":"rabbitmq-cluster","app.kubernetes.io/part-of":"rabbitmq"},"annotations":{"prometheus.io/port":"15692","prometheus.io/scrape":"true"}},"spec":{"volumes":[{"name":"plugins-conf","configMap":{"name":"rabbitmq-cluster-plugins-conf","defaultMode":420}},{"name":"rabbitmq-confd","projected":{"sources":[{"secret":{"name":"rabbitmq-cluster-default-user","items":[{"key":"default_user.conf","path":"default_user.conf"}]}},{"configMap":{"name":"rabbitmq-cluster-server-conf","items":[{"key":"operatorDefaults.conf","path":"operatorDefaults.conf"},{"key":"userDefinedConfiguration.conf","path":"userDefinedConfiguration.conf"}]}}],"defaultMode":420}},{"name":"rabbitmq-erlang-cookie","emptyDir":{}},{"name":"erlang-cookie-secret","secret":{"secretName":"rabbitmq-cluster-erlang-cookie","defaultMode":420}},{"name":"rabbitmq-plugins","emptyDir":{}},{"name":"pod-info","downwardAPI":{"items":[{"path":"skipPreStopChecks","fieldRef":{"apiVersion":"v1","fieldPath":"metadata.labels['skipPreStopChecks']"}}],"defaultMode":420}}],"initContainers":[{"name":"setup-container","image":"rabbitmq:3.8.12-management","command":["sh","-c","cp /tmp/erlang-cookie-secret/.erlang.cookie /var/lib/rabbitmq/.erlang.cookie \u0026\u0026 chown 999:999 /var/lib/rabbitmq/.erlang.cookie \u0026\u0026 chmod 600 /var/lib/rabbitmq/.erlang.cookie ; cp /tmp/rabbitmq-plugins/enabled_plugins /operator/enabled_plugins \u0026\u0026 chown 999:999 /operator/enabled_plugins ; chown 999:999 /var/lib/rabbitmq/mnesia/ ; echo '[default]' \u003e /var/lib/rabbitmq/.rabbitmqadmin.conf \u0026\u0026 sed -e 's/default_user/username/' -e 's/default_pass/password/' /tmp/default_user.conf \u003e\u003e /var/lib/rabbitmq/.rabbitmqadmin.conf \u0026\u0026 chown 999:999 /var/lib/rabbitmq/.rabbitmqadmin.conf \u0026\u0026 chmod 600 /var/lib/rabbitmq/.rabbitmqadmin.conf"],"resources":{"limits":{"cpu":"100m","memory":"500Mi"},"requests":{"cpu":"100m","memory":"500Mi"}},"volumeMounts":[{"name":"plugins-conf","mountPath":"/tmp/rabbitmq-plugins/"},{"name":"rabbitmq-erlang-cookie","mountPath":"/var/lib/rabbitmq/"},{"name":"erlang-cookie-secret","mountPath":"/tmp/erlang-cookie-secret/"},{"name":"rabbitmq-plugins","mountPath":"/operator"},{"name":"persistence","mountPath":"/var/lib/rabbitmq/mnesia/"},{"name":"rabbitmq-confd","mountPath":"/tmp/default_user.conf","subPath":"default_user.conf"}],"terminationMessagePath":"/dev/termination-log","terminationMessagePolicy":"File","imagePullPolicy":"IfNotPresent","securityContext":{"capabilities":{"drop":["FSETID","KILL","SETGID","SETUID","SETPCAP","NET_BIND_SERVICE","NET_RAW","SYS_CHROOT","MKNOD","AUDIT_WRITE","SETFCAP"]},"runAsUser":0}}],"containers":[{"name":"rabbitmq","image":"rabbitmq:3.8.12-management","ports":[{"name":"epmd","containerPort":4369,"protocol":"TCP"},{"name":"amqp","containerPort":5672,"protocol":"TCP"},{"name":"management","containerPort":15672,"protocol":"TCP"},{"name":"prometheus","containerPort":15692,"protocol":"TCP"}],"env":[{"name":"MY_POD_NAME","valueFrom":{"fieldRef":{"apiVersion":"v1","fieldPath":"metadata.name"}}},{"name":"MY_POD_NAMESPACE","valueFrom":{"fieldRef":{"apiVersion":"v1","fieldPath":"metadata.namespace"}}},{"name":"RABBITMQ_ENABLED_PLUGINS_FILE","value":"/operator/enabled_plugins"},{"name":"K8S_SERVICE_NAME","value":"rabbitmq-cluster-nodes"},{"name":"RABBITMQ_USE_LONGNAME","value":"true"},{"name":"RABBITMQ_NODENAME","value":"rabbit@$(MY_POD_NAME).$(K8S_SERVICE_NAME).$(MY_POD_NAMESPACE)"},{"name":"K8S_HOSTNAME_SUFFIX","value":".$(K8S_SERVICE_NAME).$(MY_POD_NAMESPACE)"}],"resources":{"limits":{"cpu":"2","memory":"2Gi"},"requests":{"cpu":"1","memory":"2Gi"}},"volumeMounts":[{"name":"rabbitmq-erlang-cookie","mountPath":"/var/lib/rabbitmq/"},{"name":"persistence","mountPath":"/var/lib/rabbitmq/mnesia/"},{"name":"rabbitmq-plugins","mountPath":"/operator"},{"name":"rabbitmq-confd","mountPath":"/etc/rabbitmq/conf.d/10-operatorDefaults.conf","subPath":"operatorDefaults.conf"},{"name":"rabbitmq-confd","mountPath":"/etc/rabbitmq/conf.d/11-default_user.conf","subPath":"default_user.conf"},{"name":"rabbitmq-confd","mountPath":"/etc/rabbitmq/conf.d/90-userDefinedConfiguration.conf","subPath":"userDefinedConfiguration.conf"},{"name":"pod-info","mountPath":"/etc/pod-info/"}],"readinessProbe":{"tcpSocket":{"port":"amqp"},"initialDelaySeconds":10,"timeoutSeconds":5,"periodSeconds":10,"successThreshold":1,"failureThreshold":3},"lifecycle":{"preStop":{"exec":{"command":["/bin/bash","-c","if [ ! -z \"$(cat /etc/pod-info/skipPreStopChecks)\" ]; then exit 0; fi; rabbitmq-upgrade await_online_quorum_plus_one -t 604800; rabbitmq-upgrade await_online_synchronized_mirror -t 604800; rabbitmq-upgrade drain -t 604800"]}}},"terminationMessagePath":"/dev/termination-log","terminationMessagePolicy":"File","imagePullPolicy":"IfNotPresent"}],"restartPolicy":"Always","terminationGracePeriodSeconds":604800,"dnsPolicy":"ClusterFirst","serviceAccountName":"rabbitmq-cluster-server","serviceAccount":"rabbitmq-cluster-server","automountServiceAccountToken":true,"securityContext":{"runAsUser":999,"runAsGroup":999,"fsGroup":999},"schedulerName":"default-scheduler","topologySpreadConstraints":[{"maxSkew":1,"topologyKey":"topology.kubernetes.io/zone","whenUnsatisfiable":"ScheduleAnyway","labelSelector":{"matchLabels":{"app.kubernetes.io/name":"rabbitmq-cluster"}}}]}},"volumeClaimTemplates":[{"metadata":{"name":"persistence","namespace":"default","creationTimestamp":null,"labels":{"app.kubernetes.io/component":"rabbitmq","app.kubernetes.io/name":"rabbitmq-cluster","app.kubernetes.io/part-of":"rabbitmq"},"ownerReferences":[{"apiVersion":"rabbitmq.com/v1beta1","kind":"RabbitmqCluster","name":"rabbitmq-cluster","uid":"3ecefa8a-1bec-48a7-9af4-dd0df3339101","controller":true,"blockOwnerDeletion":false}]},"spec":{"accessModes":["ReadWriteOnce"],"resources":{"requests":{"storage":"10Gi"}},"volumeMode":"Filesystem"},"status":{"phase":"Pending"}}],"serviceName":"rabbitmq-cluster-nodes","podManagementPolicy":"Parallel","updateStrategy":{"type":"RollingUpdate","rollingUpdate":{"partition":0}},"revisionHistoryLimit":10},"status":{"replicas":0}}
2022/03/18 18:06:25 learn_server.go:291: [SIEVE-AFTER-READ]	Get	true	statefulset	default	rabbitmq-cluster-server	github.com/rabbitmq/cluster-operator/controllers.(*RabbitmqClusterReconciler)	NoError	{"kind":"StatefulSet","apiVersion":"apps/v1","metadata":{"name":"rabbitmq-cluster-server","namespace":"default","selfLink":"/apis/apps/v1/namespaces/default/statefulsets/rabbitmq-cluster-server","uid":"f2f07f3e-b500-4c48-a5de-8db7eaf37b9a","resourceVersion":"1107","generation":1,"creationTimestamp":"2022-03-18T18:06:25Z","labels":{"app.kubernetes.io/component":"rabbitmq","app.kubernetes.io/name":"rabbitmq-cluster","app.kubernetes.io/part-of":"rabbitmq"},"ownerReferences":[{"apiVersion":"rabbitmq.com/v1beta1","kind":"RabbitmqCluster","name":"rabbitmq-cluster","uid":"3ecefa8a-1bec-48a7-9af4-dd0df3339101","controller":true,"blockOwnerDeletion":true}],"managedFields":[{"manager":"manager","operation":"Update","apiVersion":"apps/v1","time":"2022-03-18T18:06:25Z","fieldsType":"FieldsV1","fieldsV1":{"f:metadata":{"f:labels":{".":{},"f:app.kubernetes.io/component":{},"f:app.kubernetes.io/name":{},"f:app.kubernetes.io/part-of":{}},"f:ownerReferences":{".":{},"k:{\"uid\":\"3ecefa8a-1bec-48a7-9af4-dd0df3339101\"}":{".":{},"f:apiVersion":{},"f:blockOwnerDeletion":{},"f:controller":{},"f:kind":{},"f:name":{},"f:uid":{}}}},"f:spec":{"f:podManagementPolicy":{},"f:replicas":{},"f:revisionHistoryLimit":{},"f:selector":{"f:matchLabels":{".":{},"f:app.kubernetes.io/name":{}}},"f:serviceName":{},"f:template":{"f:metadata":{"f:annotations":{".":{},"f:prometheus.io/port":{},"f:prometheus.io/scrape":{}},"f:labels":{".":{},"f:app.kubernetes.io/component":{},"f:app.kubernetes.io/name":{},"f:app.kubernetes.io/part-of":{}}},"f:spec":{"f:automountServiceAccountToken":{},"f:containers":{"k:{\"name\":\"rabbitmq\"}":{".":{},"f:env":{".":{},"k:{\"name\":\"K8S_HOSTNAME_SUFFIX\"}":{".":{},"f:name":{},"f:value":{}},"k:{\"name\":\"K8S_SERVICE_NAME\"}":{".":{},"f:name":{},"f:value":{}},"k:{\"name\":\"MY_POD_NAME\"}":{".":{},"f:name":{},"f:valueFrom":{".":{},"f:fieldRef":{".":{},"f:apiVersion":{},"f:fieldPath":{}}}},"k:{\"name\":\"MY_POD_NAMESPACE\"}":{".":{},"f:name":{},"f:valueFrom":{".":{},"f:fieldRef":{".":{},"f:apiVersion":{},"f:fieldPath":{}}}},"k:{\"name\":\"RABBITMQ_ENABLED_PLUGINS_FILE\"}":{".":{},"f:name":{},"f:value":{}},"k:{\"name\":\"RABBITMQ_NODENAME\"}":{".":{},"f:name":{},"f:value":{}},"k:{\"name\":\"RABBITMQ_USE_LONGNAME\"}":{".":{},"f:name":{},"f:value":{}}},"f:image":{},"f:imagePullPolicy":{},"f:lifecycle":{".":{},"f:preStop":{".":{},"f:exec":{".":{},"f:command":{}}}},"f:name":{},"f:ports":{".":{},"k:{\"containerPort\":4369,\"protocol\":\"TCP\"}":{".":{},"f:containerPort":{},"f:name":{},"f:protocol":{}},"k:{\"containerPort\":5672,\"protocol\":\"TCP\"}":{".":{},"f:containerPort":{},"f:name":{},"f:protocol":{}},"k:{\"containerPort\":15672,\"protocol\":\"TCP\"}":{".":{},"f:containerPort":{},"f:name":{},"f:protocol":{}},"k:{\"containerPort\":15692,\"protocol\":\"TCP\"}":{".":{},"f:containerPort":{},"f:name":{},"f:protocol":{}}},"f:readinessProbe":{".":{},"f:failureThreshold":{},"f:initialDelaySeconds":{},"f:periodSeconds":{},"f:successThreshold":{},"f:tcpSocket":{".":{},"f:port":{}},"f:timeoutSeconds":{}},"f:resources":{".":{},"f:limits":{".":{},"f:cpu":{},"f:memory":{}},"f:requests":{".":{},"f:cpu":{},"f:memory":{}}},"f:terminationMessagePath":{},"f:terminationMessagePolicy":{},"f:volumeMounts":{".":{},"k:{\"mountPath\":\"/etc/pod-info/\"}":{".":{},"f:mountPath":{},"f:name":{}},"k:{\"mountPath\":\"/etc/rabbitmq/conf.d/10-operatorDefaults.conf\"}":{".":{},"f:mountPath":{},"f:name":{},"f:subPath":{}},"k:{\"mountPath\":\"/etc/rabbitmq/conf.d/11-default_user.conf\"}":{".":{},"f:mountPath":{},"f:name":{},"f:subPath":{}},"k:{\"mountPath\":\"/etc/rabbitmq/conf.d/90-userDefinedConfiguration.conf\"}":{".":{},"f:mountPath":{},"f:name":{},"f:subPath":{}},"k:{\"mountPath\":\"/operator\"}":{".":{},"f:mountPath":{},"f:name":{}},"k:{\"mountPath\":\"/var/lib/rabbitmq/\"}":{".":{},"f:mountPath":{},"f:name":{}},"k:{\"mountPath\":\"/var/lib/rabbitmq/mnesia/\"}":{".":{},"f:mountPath":{},"f:name":{}}}}},"f:dnsPolicy":{},"f:initContainers":{".":{},"k:{\"name\":\"setup-container\"}":{".":{},"f:command":{},"f:image":{},"f:imagePullPolicy":{},"f:name":{},"f:resources":{".":{},"f:limits":{".":{},"f:cpu":{},"f:memory":{}},"f:requests":{".":{},"f:cpu":{},"f:memory":{}}},"f:securityContext":{".":{},"f:capabilities":{".":{},"f:drop":{}},"f:runAsUser":{}},"f:terminationMessagePath":{},"f:terminationMessagePolicy":{},"f:volumeMounts":{".":{},"k:{\"mountPath\":\"/operator\"}":{".":{},"f:mountPath":{},"f:name":{}},"k:{\"mountPath\":\"/tmp/default_user.conf\"}":{".":{},"f:mountPath":{},"f:name":{},"f:subPath":{}},"k:{\"mountPath\":\"/tmp/erlang-cookie-secret/\"}":{".":{},"f:mountPath":{},"f:name":{}},"k:{\"mountPath\":\"/tmp/rabbitmq-plugins/\"}":{".":{},"f:mountPath":{},"f:name":{}},"k:{\"mountPath\":\"/var/lib/rabbitmq/\"}":{".":{},"f:mountPath":{},"f:name":{}},"k:{\"mountPath\":\"/var/lib/rabbitmq/mnesia/\"}":{".":{},"f:mountPath":{},"f:name":{}}}}},"f:restartPolicy":{},"f:schedulerName":{},"f:securityContext":{".":{},"f:fsGroup":{},"f:runAsGroup":{},"f:runAsUser":{}},"f:serviceAccount":{},"f:serviceAccountName":{},"f:terminationGracePeriodSeconds":{},"f:topologySpreadConstraints":{".":{},"k:{\"topologyKey\":\"topology.kubernetes.io/zone\",\"whenUnsatisfiable\":\"ScheduleAnyway\"}":{".":{},"f:labelSelector":{".":{},"f:matchLabels":{".":{},"f:app.kubernetes.io/name":{}}},"f:maxSkew":{},"f:topologyKey":{},"f:whenUnsatisfiable":{}}},"f:volumes":{".":{},"k:{\"name\":\"erlang-cookie-secret\"}":{".":{},"f:name":{},"f:secret":{".":{},"f:defaultMode":{},"f:secretName":{}}},"k:{\"name\":\"plugins-conf\"}":{".":{},"f:configMap":{".":{},"f:defaultMode":{},"f:name":{}},"f:name":{}},"k:{\"name\":\"pod-info\"}":{".":{},"f:downwardAPI":{".":{},"f:defaultMode":{},"f:items":{}},"f:name":{}},"k:{\"name\":\"rabbitmq-confd\"}":{".":{},"f:name":{},"f:projected":{".":{},"f:defaultMode":{},"f:sources":{}}},"k:{\"name\":\"rabbitmq-erlang-cookie\"}":{".":{},"f:emptyDir":{},"f:name":{}},"k:{\"name\":\"rabbitmq-plugins\"}":{".":{},"f:emptyDir":{},"f:name":{}}}}},"f:updateStrategy":{"f:rollingUpdate":{".":{},"f:partition":{}},"f:type":{}},"f:volumeClaimTemplates":{}}}}]},"spec":{"replicas":1,"selector":{"matchLabels":{"app.kubernetes.io/name":"rabbitmq-cluster"}},"template":{"metadata":{"creationTimestamp":null,"labels":{"app.kubernetes.io/component":"rabbitmq","app.kubernetes.io/name":"rabbitmq-cluster","app.kubernetes.io/part-of":"rabbitmq"},"annotations":{"prometheus.io/port":"15692","prometheus.io/scrape":"true"}},"spec":{"volumes":[{"name":"plugins-conf","configMap":{"name":"rabbitmq-cluster-plugins-conf","defaultMode":420}},{"name":"rabbitmq-confd","projected":{"sources":[{"secret":{"name":"rabbitmq-cluster-default-user","items":[{"key":"default_user.conf","path":"default_user.conf"}]}},{"configMap":{"name":"rabbitmq-cluster-server-conf","items":[{"key":"operatorDefaults.conf","path":"operatorDefaults.conf"},{"key":"userDefinedConfiguration.conf","path":"userDefinedConfiguration.conf"}]}}],"defaultMode":420}},{"name":"rabbitmq-erlang-cookie","emptyDir":{}},{"name":"erlang-cookie-secret","secret":{"secretName":"rabbitmq-cluster-erlang-cookie","defaultMode":420}},{"name":"rabbitmq-plugins","emptyDir":{}},{"name":"pod-info","downwardAPI":{"items":[{"path":"skipPreStopChecks","fieldRef":{"apiVersion":"v1","fieldPath":"metadata.labels['skipPreStopChecks']"}}],"defaultMode":420}}],"initContainers":[{"name":"setup-container","image":"rabbitmq:3.8.12-management","command":["sh","-c","cp /tmp/erlang-cookie-secret/.erlang.cookie /var/lib/rabbitmq/.erlang.cookie \u0026\u0026 chown 999:999 /var/lib/rabbitmq/.erlang.cookie \u0026\u0026 chmod 600 /var/lib/rabbitmq/.erlang.cookie ; cp /tmp/rabbitmq-plugins/enabled_plugins /operator/enabled_plugins \u0026\u0026 chown 999:999 /operator/enabled_plugins ; chown 999:999 /var/lib/rabbitmq/mnesia/ ; echo '[default]' \u003e /var/lib/rabbitmq/.rabbitmqadmin.conf \u0026\u0026 sed -e 's/default_user/username/' -e 's/default_pass/password/' /tmp/default_user.conf \u003e\u003e /var/lib/rabbitmq/.rabbitmqadmin.conf \u0026\u0026 chown 999:999 /var/lib/rabbitmq/.rabbitmqadmin.conf \u0026\u0026 chmod 600 /var/lib/rabbitmq/.rabbitmqadmin.conf"],"resources":{"limits":{"cpu":"100m","memory":"500Mi"},"requests":{"cpu":"100m","memory":"500Mi"}},"volumeMounts":[{"name":"plugins-conf","mountPath":"/tmp/rabbitmq-plugins/"},{"name":"rabbitmq-erlang-cookie","mountPath":"/var/lib/rabbitmq/"},{"name":"erlang-cookie-secret","mountPath":"/tmp/erlang-cookie-secret/"},{"name":"rabbitmq-plugins","mountPath":"/operator"},{"name":"persistence","mountPath":"/var/lib/rabbitmq/mnesia/"},{"name":"rabbitmq-confd","mountPath":"/tmp/default_user.conf","subPath":"default_user.conf"}],"terminationMessagePath":"/dev/termination-log","terminationMessagePolicy":"File","imagePullPolicy":"IfNotPresent","securityContext":{"capabilities":{"drop":["FSETID","KILL","SETGID","SETUID","SETPCAP","NET_BIND_SERVICE","NET_RAW","SYS_CHROOT","MKNOD","AUDIT_WRITE","SETFCAP"]},"runAsUser":0}}],"containers":[{"name":"rabbitmq","image":"rabbitmq:3.8.12-management","ports":[{"name":"epmd","containerPort":4369,"protocol":"TCP"},{"name":"amqp","containerPort":5672,"protocol":"TCP"},{"name":"management","containerPort":15672,"protocol":"TCP"},{"name":"prometheus","containerPort":15692,"protocol":"TCP"}],"env":[{"name":"MY_POD_NAME","valueFrom":{"fieldRef":{"apiVersion":"v1","fieldPath":"metadata.name"}}},{"name":"MY_POD_NAMESPACE","valueFrom":{"fieldRef":{"apiVersion":"v1","fieldPath":"metadata.namespace"}}},{"name":"RABBITMQ_ENABLED_PLUGINS_FILE","value":"/operator/enabled_plugins"},{"name":"K8S_SERVICE_NAME","value":"rabbitmq-cluster-nodes"},{"name":"RABBITMQ_USE_LONGNAME","value":"true"},{"name":"RABBITMQ_NODENAME","value":"rabbit@$(MY_POD_NAME).$(K8S_SERVICE_NAME).$(MY_POD_NAMESPACE)"},{"name":"K8S_HOSTNAME_SUFFIX","value":".$(K8S_SERVICE_NAME).$(MY_POD_NAMESPACE)"}],"resources":{"limits":{"cpu":"2","memory":"2Gi"},"requests":{"cpu":"1","memory":"2Gi"}},"volumeMounts":[{"name":"rabbitmq-erlang-cookie","mountPath":"/var/lib/rabbitmq/"},{"name":"persistence","mountPath":"/var/lib/rabbitmq/mnesia/"},{"name":"rabbitmq-plugins","mountPath":"/operator"},{"name":"rabbitmq-confd","mountPath":"/etc/rabbitmq/conf.d/10-operatorDefaults.conf","subPath":"operatorDefaults.conf"},{"name":"rabbitmq-confd","mountPath":"/etc/rabbitmq/conf.d/11-default_user.conf","subPath":"default_user.conf"},{"name":"rabbitmq-confd","mountPath":"/etc/rabbitmq/conf.d/90-userDefinedConfiguration.conf","subPath":"userDefinedConfiguration.conf"},{"name":"pod-info","mountPath":"/etc/pod-info/"}],"readinessProbe":{"tcpSocket":{"port":"amqp"},"initialDelaySeconds":10,"timeoutSeconds":5,"periodSeconds":10,"successThreshold":1,"failureThreshold":3},"lifecycle":{"preStop":{"exec":{"command":["/bin/bash","-c","if [ ! -z \"$(cat /etc/pod-info/skipPreStopChecks)\" ]; then exit 0; fi; rabbitmq-upgrade await_online_quorum_plus_one -t 604800; rabbitmq-upgrade await_online_synchronized_mirror -t 604800; rabbitmq-upgrade drain -t 604800"]}}},"terminationMessagePath":"/dev/termination-log","terminationMessagePolicy":"File","imagePullPolicy":"IfNotPresent"}],"restartPolicy":"Always","terminationGracePeriodSeconds":604800,"dnsPolicy":"ClusterFirst","serviceAccountName":"rabbitmq-cluster-server","serviceAccount":"rabbitmq-cluster-server","automountServiceAccountToken":true,"securityContext":{"runAsUser":999,"runAsGroup":999,"fsGroup":999},"schedulerName":"default-scheduler","topologySpreadConstraints":[{"maxSkew":1,"topologyKey":"topology.kubernetes.io/zone","whenUnsatisfiable":"ScheduleAnyway","labelSelector":{"matchLabels":{"app.kubernetes.io/name":"rabbitmq-cluster"}}}]}},"volumeClaimTemplates":[{"metadata":{"name":"persistence","namespace":"default","creationTimestamp":null,"labels":{"app.kubernetes.io/component":"rabbitmq","app.kubernetes.io/name":"rabbitmq-cluster","app.kubernetes.io/part-of":"rabbitmq"},"ownerReferences":[{"apiVersion":"rabbitmq.com/v1beta1","kind":"RabbitmqCluster","name":"rabbitmq-cluster","uid":"3ecefa8a-1bec-48a7-9af4-dd0df3339101","controller":true,"blockOwnerDeletion":false}]},"spec":{"accessModes":["ReadWriteOnce"],"resources":{"requests":{"storage":"10Gi"}},"volumeMode":"Filesystem"},"status":{"phase":"Pending"}}],"serviceName":"rabbitmq-cluster-nodes","podManagementPolicy":"Parallel","updateStrategy":{"type":"RollingUpdate","rollingUpdate":{"partition":0}},"revisionHistoryLimit":10},"status":{"replicas":0}}
2022/03/18 18:06:25 learn_server.go:256: [SIEVE-BEFORE-WRITE]	12
2022/03/18 18:06:25 learn_server.go:279: [SIEVE-BEFORE-HEAR]	14	Updated	statefulset	{"metadata":{"name":"rabbitmq-cluster-server","namespace":"default","selfLink":"/apis/apps/v1/namespaces/default/statefulsets/rabbitmq-cluster-server","uid":"f2f07f3e-b500-4c48-a5de-8db7eaf37b9a","resourceVersion":"1111","generation":1,"creationTimestamp":"2022-03-18T18:06:25Z","labels":{"app.kubernetes.io/component":"rabbitmq","app.kubernetes.io/name":"rabbitmq-cluster","app.kubernetes.io/part-of":"rabbitmq"},"annotations":{"rabbitmq.com/createdAt":"2022-03-18T18:06:25Z"},"ownerReferences":[{"apiVersion":"rabbitmq.com/v1beta1","kind":"RabbitmqCluster","name":"rabbitmq-cluster","uid":"3ecefa8a-1bec-48a7-9af4-dd0df3339101","controller":true,"blockOwnerDeletion":true}],"managedFields":[{"manager":"manager","operation":"Update","apiVersion":"apps/v1","time":"2022-03-18T18:06:25Z","fieldsType":"FieldsV1","fieldsV1":{"f:metadata":{"f:annotations":{".":{},"f:rabbitmq.com/createdAt":{}},"f:labels":{".":{},"f:app.kubernetes.io/component":{},"f:app.kubernetes.io/name":{},"f:app.kubernetes.io/part-of":{}},"f:ownerReferences":{".":{},"k:{\"uid\":\"3ecefa8a-1bec-48a7-9af4-dd0df3339101\"}":{".":{},"f:apiVersion":{},"f:blockOwnerDeletion":{},"f:controller":{},"f:kind":{},"f:name":{},"f:uid":{}}}},"f:spec":{"f:podManagementPolicy":{},"f:replicas":{},"f:revisionHistoryLimit":{},"f:selector":{"f:matchLabels":{".":{},"f:app.kubernetes.io/name":{}}},"f:serviceName":{},"f:template":{"f:metadata":{"f:annotations":{".":{},"f:prometheus.io/port":{},"f:prometheus.io/scrape":{}},"f:labels":{".":{},"f:app.kubernetes.io/component":{},"f:app.kubernetes.io/name":{},"f:app.kubernetes.io/part-of":{}}},"f:spec":{"f:automountServiceAccountToken":{},"f:containers":{"k:{\"name\":\"rabbitmq\"}":{".":{},"f:env":{".":{},"k:{\"name\":\"K8S_HOSTNAME_SUFFIX\"}":{".":{},"f:name":{},"f:value":{}},"k:{\"name\":\"K8S_SERVICE_NAME\"}":{".":{},"f:name":{},"f:value":{}},"k:{\"name\":\"MY_POD_NAME\"}":{".":{},"f:name":{},"f:valueFrom":{".":{},"f:fieldRef":{".":{},"f:apiVersion":{},"f:fieldPath":{}}}},"k:{\"name\":\"MY_POD_NAMESPACE\"}":{".":{},"f:name":{},"f:valueFrom":{".":{},"f:fieldRef":{".":{},"f:apiVersion":{},"f:fieldPath":{}}}},"k:{\"name\":\"RABBITMQ_ENABLED_PLUGINS_FILE\"}":{".":{},"f:name":{},"f:value":{}},"k:{\"name\":\"RABBITMQ_NODENAME\"}":{".":{},"f:name":{},"f:value":{}},"k:{\"name\":\"RABBITMQ_USE_LONGNAME\"}":{".":{},"f:name":{},"f:value":{}}},"f:image":{},"f:imagePullPolicy":{},"f:lifecycle":{".":{},"f:preStop":{".":{},"f:exec":{".":{},"f:command":{}}}},"f:name":{},"f:ports":{".":{},"k:{\"containerPort\":4369,\"protocol\":\"TCP\"}":{".":{},"f:containerPort":{},"f:name":{},"f:protocol":{}},"k:{\"containerPort\":5672,\"protocol\":\"TCP\"}":{".":{},"f:containerPort":{},"f:name":{},"f:protocol":{}},"k:{\"containerPort\":15672,\"protocol\":\"TCP\"}":{".":{},"f:containerPort":{},"f:name":{},"f:protocol":{}},"k:{\"containerPort\":15692,\"protocol\":\"TCP\"}":{".":{},"f:containerPort":{},"f:name":{},"f:protocol":{}}},"f:readinessProbe":{".":{},"f:failureThreshold":{},"f:initialDelaySeconds":{},"f:periodSeconds":{},"f:successThreshold":{},"f:tcpSocket":{".":{},"f:port":{}},"f:timeoutSeconds":{}},"f:resources":{".":{},"f:limits":{".":{},"f:cpu":{},"f:memory":{}},"f:requests":{".":{},"f:cpu":{},"f:memory":{}}},"f:terminationMessagePath":{},"f:terminationMessagePolicy":{},"f:volumeMounts":{".":{},"k:{\"mountPath\":\"/etc/pod-info/\"}":{".":{},"f:mountPath":{},"f:name":{}},"k:{\"mountPath\":\"/etc/rabbitmq/conf.d/10-operatorDefaults.conf\"}":{".":{},"f:mountPath":{},"f:name":{},"f:subPath":{}},"k:{\"mountPath\":\"/etc/rabbitmq/conf.d/11-default_user.conf\"}":{".":{},"f:mountPath":{},"f:name":{},"f:subPath":{}},"k:{\"mountPath\":\"/etc/rabbitmq/conf.d/90-userDefinedConfiguration.conf\"}":{".":{},"f:mountPath":{},"f:name":{},"f:subPath":{}},"k:{\"mountPath\":\"/operator\"}":{".":{},"f:mountPath":{},"f:name":{}},"k:{\"mountPath\":\"/var/lib/rabbitmq/\"}":{".":{},"f:mountPath":{},"f:name":{}},"k:{\"mountPath\":\"/var/lib/rabbitmq/mnesia/\"}":{".":{},"f:mountPath":{},"f:name":{}}}}},"f:dnsPolicy":{},"f:initContainers":{".":{},"k:{\"name\":\"setup-container\"}":{".":{},"f:command":{},"f:image":{},"f:imagePullPolicy":{},"f:name":{},"f:resources":{".":{},"f:limits":{".":{},"f:cpu":{},"f:memory":{}},"f:requests":{".":{},"f:cpu":{},"f:memory":{}}},"f:securityContext":{".":{},"f:capabilities":{".":{},"f:drop":{}},"f:runAsUser":{}},"f:terminationMessagePath":{},"f:terminationMessagePolicy":{},"f:volumeMounts":{".":{},"k:{\"mountPath\":\"/operator\"}":{".":{},"f:mountPath":{},"f:name":{}},"k:{\"mountPath\":\"/tmp/default_user.conf\"}":{".":{},"f:mountPath":{},"f:name":{},"f:subPath":{}},"k:{\"mountPath\":\"/tmp/erlang-cookie-secret/\"}":{".":{},"f:mountPath":{},"f:name":{}},"k:{\"mountPath\":\"/tmp/rabbitmq-plugins/\"}":{".":{},"f:mountPath":{},"f:name":{}},"k:{\"mountPath\":\"/var/lib/rabbitmq/\"}":{".":{},"f:mountPath":{},"f:name":{}},"k:{\"mountPath\":\"/var/lib/rabbitmq/mnesia/\"}":{".":{},"f:mountPath":{},"f:name":{}}}}},"f:restartPolicy":{},"f:schedulerName":{},"f:securityContext":{".":{},"f:fsGroup":{},"f:runAsGroup":{},"f:runAsUser":{}},"f:serviceAccount":{},"f:serviceAccountName":{},"f:terminationGracePeriodSeconds":{},"f:topologySpreadConstraints":{".":{},"k:{\"topologyKey\":\"topology.kubernetes.io/zone\",\"whenUnsatisfiable\":\"ScheduleAnyway\"}":{".":{},"f:labelSelector":{".":{},"f:matchLabels":{".":{},"f:app.kubernetes.io/name":{}}},"f:maxSkew":{},"f:topologyKey":{},"f:whenUnsatisfiable":{}}},"f:volumes":{".":{},"k:{\"name\":\"erlang-cookie-secret\"}":{".":{},"f:name":{},"f:secret":{".":{},"f:defaultMode":{},"f:secretName":{}}},"k:{\"name\":\"plugins-conf\"}":{".":{},"f:configMap":{".":{},"f:defaultMode":{},"f:name":{}},"f:name":{}},"k:{\"name\":\"pod-info\"}":{".":{},"f:downwardAPI":{".":{},"f:defaultMode":{},"f:items":{}},"f:name":{}},"k:{\"name\":\"rabbitmq-confd\"}":{".":{},"f:name":{},"f:projected":{".":{},"f:defaultMode":{},"f:sources":{}}},"k:{\"name\":\"rabbitmq-erlang-cookie\"}":{".":{},"f:emptyDir":{},"f:name":{}},"k:{\"name\":\"rabbitmq-plugins\"}":{".":{},"f:emptyDir":{},"f:name":{}}}}},"f:updateStrategy":{"f:rollingUpdate":{".":{},"f:partition":{}},"f:type":{}},"f:volumeClaimTemplates":{}}}}]},"spec":{"replicas":1,"selector":{"matchLabels":{"app.kubernetes.io/name":"rabbitmq-cluster"}},"template":{"metadata":{"creationTimestamp":null,"labels":{"app.kubernetes.io/component":"rabbitmq","app.kubernetes.io/name":"rabbitmq-cluster","app.kubernetes.io/part-of":"rabbitmq"},"annotations":{"prometheus.io/port":"15692","prometheus.io/scrape":"true"}},"spec":{"volumes":[{"name":"plugins-conf","configMap":{"name":"rabbitmq-cluster-plugins-conf","defaultMode":420}},{"name":"rabbitmq-confd","projected":{"sources":[{"secret":{"name":"rabbitmq-cluster-default-user","items":[{"key":"default_user.conf","path":"default_user.conf"}]}},{"configMap":{"name":"rabbitmq-cluster-server-conf","items":[{"key":"operatorDefaults.conf","path":"operatorDefaults.conf"},{"key":"userDefinedConfiguration.conf","path":"userDefinedConfiguration.conf"}]}}],"defaultMode":420}},{"name":"rabbitmq-erlang-cookie","emptyDir":{}},{"name":"erlang-cookie-secret","secret":{"secretName":"rabbitmq-cluster-erlang-cookie","defaultMode":420}},{"name":"rabbitmq-plugins","emptyDir":{}},{"name":"pod-info","downwardAPI":{"items":[{"path":"skipPreStopChecks","fieldRef":{"apiVersion":"v1","fieldPath":"metadata.labels['skipPreStopChecks']"}}],"defaultMode":420}}],"initContainers":[{"name":"setup-container","image":"rabbitmq:3.8.12-management","command":["sh","-c","cp /tmp/erlang-cookie-secret/.erlang.cookie /var/lib/rabbitmq/.erlang.cookie \u0026\u0026 chown 999:999 /var/lib/rabbitmq/.erlang.cookie \u0026\u0026 chmod 600 /var/lib/rabbitmq/.erlang.cookie ; cp /tmp/rabbitmq-plugins/enabled_plugins /operator/enabled_plugins \u0026\u0026 chown 999:999 /operator/enabled_plugins ; chown 999:999 /var/lib/rabbitmq/mnesia/ ; echo '[default]' \u003e /var/lib/rabbitmq/.rabbitmqadmin.conf \u0026\u0026 sed -e 's/default_user/username/' -e 's/default_pass/password/' /tmp/default_user.conf \u003e\u003e /var/lib/rabbitmq/.rabbitmqadmin.conf \u0026\u0026 chown 999:999 /var/lib/rabbitmq/.rabbitmqadmin.conf \u0026\u0026 chmod 600 /var/lib/rabbitmq/.rabbitmqadmin.conf"],"resources":{"limits":{"cpu":"100m","memory":"500Mi"},"requests":{"cpu":"100m","memory":"500Mi"}},"volumeMounts":[{"name":"plugins-conf","mountPath":"/tmp/rabbitmq-plugins/"},{"name":"rabbitmq-erlang-cookie","mountPath":"/var/lib/rabbitmq/"},{"name":"erlang-cookie-secret","mountPath":"/tmp/erlang-cookie-secret/"},{"name":"rabbitmq-plugins","mountPath":"/operator"},{"name":"persistence","mountPath":"/var/lib/rabbitmq/mnesia/"},{"name":"rabbitmq-confd","mountPath":"/tmp/default_user.conf","subPath":"default_user.conf"}],"terminationMessagePath":"/dev/termination-log","terminationMessagePolicy":"File","imagePullPolicy":"IfNotPresent","securityContext":{"capabilities":{"drop":["FSETID","KILL","SETGID","SETUID","SETPCAP","NET_BIND_SERVICE","NET_RAW","SYS_CHROOT","MKNOD","AUDIT_WRITE","SETFCAP"]},"runAsUser":0}}],"containers":[{"name":"rabbitmq","image":"rabbitmq:3.8.12-management","ports":[{"name":"epmd","containerPort":4369,"protocol":"TCP"},{"name":"amqp","containerPort":5672,"protocol":"TCP"},{"name":"management","containerPort":15672,"protocol":"TCP"},{"name":"prometheus","containerPort":15692,"protocol":"TCP"}],"env":[{"name":"MY_POD_NAME","valueFrom":{"fieldRef":{"apiVersion":"v1","fieldPath":"metadata.name"}}},{"name":"MY_POD_NAMESPACE","valueFrom":{"fieldRef":{"apiVersion":"v1","fieldPath":"metadata.namespace"}}},{"name":"RABBITMQ_ENABLED_PLUGINS_FILE","value":"/operator/enabled_plugins"},{"name":"K8S_SERVICE_NAME","value":"rabbitmq-cluster-nodes"},{"name":"RABBITMQ_USE_LONGNAME","value":"true"},{"name":"RABBITMQ_NODENAME","value":"rabbit@$(MY_POD_NAME).$(K8S_SERVICE_NAME).$(MY_POD_NAMESPACE)"},{"name":"K8S_HOSTNAME_SUFFIX","value":".$(K8S_SERVICE_NAME).$(MY_POD_NAMESPACE)"}],"resources":{"limits":{"cpu":"2","memory":"2Gi"},"requests":{"cpu":"1","memory":"2Gi"}},"volumeMounts":[{"name":"rabbitmq-erlang-cookie","mountPath":"/var/lib/rabbitmq/"},{"name":"persistence","mountPath":"/var/lib/rabbitmq/mnesia/"},{"name":"rabbitmq-plugins","mountPath":"/operator"},{"name":"rabbitmq-confd","mountPath":"/etc/rabbitmq/conf.d/10-operatorDefaults.conf","subPath":"operatorDefaults.conf"},{"name":"rabbitmq-confd","mountPath":"/etc/rabbitmq/conf.d/11-default_user.conf","subPath":"default_user.conf"},{"name":"rabbitmq-confd","mountPath":"/etc/rabbitmq/conf.d/90-userDefinedConfiguration.conf","subPath":"userDefinedConfiguration.conf"},{"name":"pod-info","mountPath":"/etc/pod-info/"}],"readinessProbe":{"tcpSocket":{"port":"amqp"},"initialDelaySeconds":10,"timeoutSeconds":5,"periodSeconds":10,"successThreshold":1,"failureThreshold":3},"lifecycle":{"preStop":{"exec":{"command":["/bin/bash","-c","if [ ! -z \"$(cat /etc/pod-info/skipPreStopChecks)\" ]; then exit 0; fi; rabbitmq-upgrade await_online_quorum_plus_one -t 604800; rabbitmq-upgrade await_online_synchronized_mirror -t 604800; rabbitmq-upgrade drain -t 604800"]}}},"terminationMessagePath":"/dev/termination-log","terminationMessagePolicy":"File","imagePullPolicy":"IfNotPresent"}],"restartPolicy":"Always","terminationGracePeriodSeconds":604800,"dnsPolicy":"ClusterFirst","serviceAccountName":"rabbitmq-cluster-server","serviceAccount":"rabbitmq-cluster-server","automountServiceAccountToken":true,"securityContext":{"runAsUser":999,"runAsGroup":999,"fsGroup":999},"schedulerName":"default-scheduler","topologySpreadConstraints":[{"maxSkew":1,"topologyKey":"topology.kubernetes.io/zone","whenUnsatisfiable":"ScheduleAnyway","labelSelector":{"matchLabels":{"app.kubernetes.io/name":"rabbitmq-cluster"}}}]}},"volumeClaimTemplates":[{"metadata":{"name":"persistence","namespace":"default","creationTimestamp":null,"labels":{"app.kubernetes.io/component":"rabbitmq","app.kubernetes.io/name":"rabbitmq-cluster","app.kubernetes.io/part-of":"rabbitmq"},"ownerReferences":[{"apiVersion":"rabbitmq.com/v1beta1","kind":"RabbitmqCluster","name":"rabbitmq-cluster","uid":"3ecefa8a-1bec-48a7-9af4-dd0df3339101","controller":true,"blockOwnerDeletion":false}]},"spec":{"accessModes":["ReadWriteOnce"],"resources":{"requests":{"storage":"10Gi"}},"volumeMode":"Filesystem"},"status":{"phase":"Pending"}}],"serviceName":"rabbitmq-cluster-nodes","podManagementPolicy":"Parallel","updateStrategy":{"type":"RollingUpdate","rollingUpdate":{"partition":0}},"revisionHistoryLimit":10},"status":{"replicas":0}}
2022/03/18 18:06:25 learn_server.go:289: [SIEVE-AFTER-HEAR]	14
2022/03/18 18:06:25 learn_server.go:279: [SIEVE-BEFORE-HEAR]	15	Updated	statefulset	{"metadata":{"name":"rabbitmq-cluster-server","namespace":"default","selfLink":"/apis/apps/v1/namespaces/default/statefulsets/rabbitmq-cluster-server","uid":"f2f07f3e-b500-4c48-a5de-8db7eaf37b9a","resourceVersion":"1129","generation":1,"creationTimestamp":"2022-03-18T18:06:25Z","labels":{"app.kubernetes.io/component":"rabbitmq","app.kubernetes.io/name":"rabbitmq-cluster","app.kubernetes.io/part-of":"rabbitmq"},"annotations":{"rabbitmq.com/createdAt":"2022-03-18T18:06:25Z"},"ownerReferences":[{"apiVersion":"rabbitmq.com/v1beta1","kind":"RabbitmqCluster","name":"rabbitmq-cluster","uid":"3ecefa8a-1bec-48a7-9af4-dd0df3339101","controller":true,"blockOwnerDeletion":true}],"managedFields":[{"manager":"kube-controller-manager","operation":"Update","apiVersion":"apps/v1","time":"2022-03-18T18:06:25Z","fieldsType":"FieldsV1","fieldsV1":{"f:status":{"f:collisionCount":{},"f:currentReplicas":{},"f:currentRevision":{},"f:observedGeneration":{},"f:replicas":{},"f:updateRevision":{},"f:updatedReplicas":{}}}},{"manager":"manager","operation":"Update","apiVersion":"apps/v1","time":"2022-03-18T18:06:25Z","fieldsType":"FieldsV1","fieldsV1":{"f:metadata":{"f:annotations":{".":{},"f:rabbitmq.com/createdAt":{}},"f:labels":{".":{},"f:app.kubernetes.io/component":{},"f:app.kubernetes.io/name":{},"f:app.kubernetes.io/part-of":{}},"f:ownerReferences":{".":{},"k:{\"uid\":\"3ecefa8a-1bec-48a7-9af4-dd0df3339101\"}":{".":{},"f:apiVersion":{},"f:blockOwnerDeletion":{},"f:controller":{},"f:kind":{},"f:name":{},"f:uid":{}}}},"f:spec":{"f:podManagementPolicy":{},"f:replicas":{},"f:revisionHistoryLimit":{},"f:selector":{"f:matchLabels":{".":{},"f:app.kubernetes.io/name":{}}},"f:serviceName":{},"f:template":{"f:metadata":{"f:annotations":{".":{},"f:prometheus.io/port":{},"f:prometheus.io/scrape":{}},"f:labels":{".":{},"f:app.kubernetes.io/component":{},"f:app.kubernetes.io/name":{},"f:app.kubernetes.io/part-of":{}}},"f:spec":{"f:automountServiceAccountToken":{},"f:containers":{"k:{\"name\":\"rabbitmq\"}":{".":{},"f:env":{".":{},"k:{\"name\":\"K8S_HOSTNAME_SUFFIX\"}":{".":{},"f:name":{},"f:value":{}},"k:{\"name\":\"K8S_SERVICE_NAME\"}":{".":{},"f:name":{},"f:value":{}},"k:{\"name\":\"MY_POD_NAME\"}":{".":{},"f:name":{},"f:valueFrom":{".":{},"f:fieldRef":{".":{},"f:apiVersion":{},"f:fieldPath":{}}}},"k:{\"name\":\"MY_POD_NAMESPACE\"}":{".":{},"f:name":{},"f:valueFrom":{".":{},"f:fieldRef":{".":{},"f:apiVersion":{},"f:fieldPath":{}}}},"k:{\"name\":\"RABBITMQ_ENABLED_PLUGINS_FILE\"}":{".":{},"f:name":{},"f:value":{}},"k:{\"name\":\"RABBITMQ_NODENAME\"}":{".":{},"f:name":{},"f:value":{}},"k:{\"name\":\"RABBITMQ_USE_LONGNAME\"}":{".":{},"f:name":{},"f:value":{}}},"f:image":{},"f:imagePullPolicy":{},"f:lifecycle":{".":{},"f:preStop":{".":{},"f:exec":{".":{},"f:command":{}}}},"f:name":{},"f:ports":{".":{},"k:{\"containerPort\":4369,\"protocol\":\"TCP\"}":{".":{},"f:containerPort":{},"f:name":{},"f:protocol":{}},"k:{\"containerPort\":5672,\"protocol\":\"TCP\"}":{".":{},"f:containerPort":{},"f:name":{},"f:protocol":{}},"k:{\"containerPort\":15672,\"protocol\":\"TCP\"}":{".":{},"f:containerPort":{},"f:name":{},"f:protocol":{}},"k:{\"containerPort\":15692,\"protocol\":\"TCP\"}":{".":{},"f:containerPort":{},"f:name":{},"f:protocol":{}}},"f:readinessProbe":{".":{},"f:failureThreshold":{},"f:initialDelaySeconds":{},"f:periodSeconds":{},"f:successThreshold":{},"f:tcpSocket":{".":{},"f:port":{}},"f:timeoutSeconds":{}},"f:resources":{".":{},"f:limits":{".":{},"f:cpu":{},"f:memory":{}},"f:requests":{".":{},"f:cpu":{},"f:memory":{}}},"f:terminationMessagePath":{},"f:terminationMessagePolicy":{},"f:volumeMounts":{".":{},"k:{\"mountPath\":\"/etc/pod-info/\"}":{".":{},"f:mountPath":{},"f:name":{}},"k:{\"mountPath\":\"/etc/rabbitmq/conf.d/10-operatorDefaults.conf\"}":{".":{},"f:mountPath":{},"f:name":{},"f:subPath":{}},"k:{\"mountPath\":\"/etc/rabbitmq/conf.d/11-default_user.conf\"}":{".":{},"f:mountPath":{},"f:name":{},"f:subPath":{}},"k:{\"mountPath\":\"/etc/rabbitmq/conf.d/90-userDefinedConfiguration.conf\"}":{".":{},"f:mountPath":{},"f:name":{},"f:subPath":{}},"k:{\"mountPath\":\"/operator\"}":{".":{},"f:mountPath":{},"f:name":{}},"k:{\"mountPath\":\"/var/lib/rabbitmq/\"}":{".":{},"f:mountPath":{},"f:name":{}},"k:{\"mountPath\":\"/var/lib/rabbitmq/mnesia/\"}":{".":{},"f:mountPath":{},"f:name":{}}}}},"f:dnsPolicy":{},"f:initContainers":{".":{},"k:{\"name\":\"setup-container\"}":{".":{},"f:command":{},"f:image":{},"f:imagePullPolicy":{},"f:name":{},"f:resources":{".":{},"f:limits":{".":{},"f:cpu":{},"f:memory":{}},"f:requests":{".":{},"f:cpu":{},"f:memory":{}}},"f:securityContext":{".":{},"f:capabilities":{".":{},"f:drop":{}},"f:runAsUser":{}},"f:terminationMessagePath":{},"f:terminationMessagePolicy":{},"f:volumeMounts":{".":{},"k:{\"mountPath\":\"/operator\"}":{".":{},"f:mountPath":{},"f:name":{}},"k:{\"mountPath\":\"/tmp/default_user.conf\"}":{".":{},"f:mountPath":{},"f:name":{},"f:subPath":{}},"k:{\"mountPath\":\"/tmp/erlang-cookie-secret/\"}":{".":{},"f:mountPath":{},"f:name":{}},"k:{\"mountPath\":\"/tmp/rabbitmq-plugins/\"}":{".":{},"f:mountPath":{},"f:name":{}},"k:{\"mountPath\":\"/var/lib/rabbitmq/\"}":{".":{},"f:mountPath":{},"f:name":{}},"k:{\"mountPath\":\"/var/lib/rabbitmq/mnesia/\"}":{".":{},"f:mountPath":{},"f:name":{}}}}},"f:restartPolicy":{},"f:schedulerName":{},"f:securityContext":{".":{},"f:fsGroup":{},"f:runAsGroup":{},"f:runAsUser":{}},"f:serviceAccount":{},"f:serviceAccountName":{},"f:terminationGracePeriodSeconds":{},"f:topologySpreadConstraints":{".":{},"k:{\"topologyKey\":\"topology.kubernetes.io/zone\",\"whenUnsatisfiable\":\"ScheduleAnyway\"}":{".":{},"f:labelSelector":{".":{},"f:matchLabels":{".":{},"f:app.kubernetes.io/name":{}}},"f:maxSkew":{},"f:topologyKey":{},"f:whenUnsatisfiable":{}}},"f:volumes":{".":{},"k:{\"name\":\"erlang-cookie-secret\"}":{".":{},"f:name":{},"f:secret":{".":{},"f:defaultMode":{},"f:secretName":{}}},"k:{\"name\":\"plugins-conf\"}":{".":{},"f:configMap":{".":{},"f:defaultMode":{},"f:name":{}},"f:name":{}},"k:{\"name\":\"pod-info\"}":{".":{},"f:downwardAPI":{".":{},"f:defaultMode":{},"f:items":{}},"f:name":{}},"k:{\"name\":\"rabbitmq-confd\"}":{".":{},"f:name":{},"f:projected":{".":{},"f:defaultMode":{},"f:sources":{}}},"k:{\"name\":\"rabbitmq-erlang-cookie\"}":{".":{},"f:emptyDir":{},"f:name":{}},"k:{\"name\":\"rabbitmq-plugins\"}":{".":{},"f:emptyDir":{},"f:name":{}}}}},"f:updateStrategy":{"f:rollingUpdate":{".":{},"f:partition":{}},"f:type":{}},"f:volumeClaimTemplates":{}}}}]},"spec":{"replicas":1,"selector":{"matchLabels":{"app.kubernetes.io/name":"rabbitmq-cluster"}},"template":{"metadata":{"creationTimestamp":null,"labels":{"app.kubernetes.io/component":"rabbitmq","app.kubernetes.io/name":"rabbitmq-cluster","app.kubernetes.io/part-of":"rabbitmq"},"annotations":{"prometheus.io/port":"15692","prometheus.io/scrape":"true"}},"spec":{"volumes":[{"name":"plugins-conf","configMap":{"name":"rabbitmq-cluster-plugins-conf","defaultMode":420}},{"name":"rabbitmq-confd","projected":{"sources":[{"secret":{"name":"rabbitmq-cluster-default-user","items":[{"key":"default_user.conf","path":"default_user.conf"}]}},{"configMap":{"name":"rabbitmq-cluster-server-conf","items":[{"key":"operatorDefaults.conf","path":"operatorDefaults.conf"},{"key":"userDefinedConfiguration.conf","path":"userDefinedConfiguration.conf"}]}}],"defaultMode":420}},{"name":"rabbitmq-erlang-cookie","emptyDir":{}},{"name":"erlang-cookie-secret","secret":{"secretName":"rabbitmq-cluster-erlang-cookie","defaultMode":420}},{"name":"rabbitmq-plugins","emptyDir":{}},{"name":"pod-info","downwardAPI":{"items":[{"path":"skipPreStopChecks","fieldRef":{"apiVersion":"v1","fieldPath":"metadata.labels['skipPreStopChecks']"}}],"defaultMode":420}}],"initContainers":[{"name":"setup-container","image":"rabbitmq:3.8.12-management","command":["sh","-c","cp /tmp/erlang-cookie-secret/.erlang.cookie /var/lib/rabbitmq/.erlang.cookie \u0026\u0026 chown 999:999 /var/lib/rabbitmq/.erlang.cookie \u0026\u0026 chmod 600 /var/lib/rabbitmq/.erlang.cookie ; cp /tmp/rabbitmq-plugins/enabled_plugins /operator/enabled_plugins \u0026\u0026 chown 999:999 /operator/enabled_plugins ; chown 999:999 /var/lib/rabbitmq/mnesia/ ; echo '[default]' \u003e /var/lib/rabbitmq/.rabbitmqadmin.conf \u0026\u0026 sed -e 's/default_user/username/' -e 's/default_pass/password/' /tmp/default_user.conf \u003e\u003e /var/lib/rabbitmq/.rabbitmqadmin.conf \u0026\u0026 chown 999:999 /var/lib/rabbitmq/.rabbitmqadmin.conf \u0026\u0026 chmod 600 /var/lib/rabbitmq/.rabbitmqadmin.conf"],"resources":{"limits":{"cpu":"100m","memory":"500Mi"},"requests":{"cpu":"100m","memory":"500Mi"}},"volumeMounts":[{"name":"plugins-conf","mountPath":"/tmp/rabbitmq-plugins/"},{"name":"rabbitmq-erlang-cookie","mountPath":"/var/lib/rabbitmq/"},{"name":"erlang-cookie-secret","mountPath":"/tmp/erlang-cookie-secret/"},{"name":"rabbitmq-plugins","mountPath":"/operator"},{"name":"persistence","mountPath":"/var/lib/rabbitmq/mnesia/"},{"name":"rabbitmq-confd","mountPath":"/tmp/default_user.conf","subPath":"default_user.conf"}],"terminationMessagePath":"/dev/termination-log","terminationMessagePolicy":"File","imagePullPolicy":"IfNotPresent","securityContext":{"capabilities":{"drop":["FSETID","KILL","SETGID","SETUID","SETPCAP","NET_BIND_SERVICE","NET_RAW","SYS_CHROOT","MKNOD","AUDIT_WRITE","SETFCAP"]},"runAsUser":0}}],"containers":[{"name":"rabbitmq","image":"rabbitmq:3.8.12-management","ports":[{"name":"epmd","containerPort":4369,"protocol":"TCP"},{"name":"amqp","containerPort":5672,"protocol":"TCP"},{"name":"management","containerPort":15672,"protocol":"TCP"},{"name":"prometheus","containerPort":15692,"protocol":"TCP"}],"env":[{"name":"MY_POD_NAME","valueFrom":{"fieldRef":{"apiVersion":"v1","fieldPath":"metadata.name"}}},{"name":"MY_POD_NAMESPACE","valueFrom":{"fieldRef":{"apiVersion":"v1","fieldPath":"metadata.namespace"}}},{"name":"RABBITMQ_ENABLED_PLUGINS_FILE","value":"/operator/enabled_plugins"},{"name":"K8S_SERVICE_NAME","value":"rabbitmq-cluster-nodes"},{"name":"RABBITMQ_USE_LONGNAME","value":"true"},{"name":"RABBITMQ_NODENAME","value":"rabbit@$(MY_POD_NAME).$(K8S_SERVICE_NAME).$(MY_POD_NAMESPACE)"},{"name":"K8S_HOSTNAME_SUFFIX","value":".$(K8S_SERVICE_NAME).$(MY_POD_NAMESPACE)"}],"resources":{"limits":{"cpu":"2","memory":"2Gi"},"requests":{"cpu":"1","memory":"2Gi"}},"volumeMounts":[{"name":"rabbitmq-erlang-cookie","mountPath":"/var/lib/rabbitmq/"},{"name":"persistence","mountPath":"/var/lib/rabbitmq/mnesia/"},{"name":"rabbitmq-plugins","mountPath":"/operator"},{"name":"rabbitmq-confd","mountPath":"/etc/rabbitmq/conf.d/10-operatorDefaults.conf","subPath":"operatorDefaults.conf"},{"name":"rabbitmq-confd","mountPath":"/etc/rabbitmq/conf.d/11-default_user.conf","subPath":"default_user.conf"},{"name":"rabbitmq-confd","mountPath":"/etc/rabbitmq/conf.d/90-userDefinedConfiguration.conf","subPath":"userDefinedConfiguration.conf"},{"name":"pod-info","mountPath":"/etc/pod-info/"}],"readinessProbe":{"tcpSocket":{"port":"amqp"},"initialDelaySeconds":10,"timeoutSeconds":5,"periodSeconds":10,"successThreshold":1,"failureThreshold":3},"lifecycle":{"preStop":{"exec":{"command":["/bin/bash","-c","if [ ! -z \"$(cat /etc/pod-info/skipPreStopChecks)\" ]; then exit 0; fi; rabbitmq-upgrade await_online_quorum_plus_one -t 604800; rabbitmq-upgrade await_online_synchronized_mirror -t 604800; rabbitmq-upgrade drain -t 604800"]}}},"terminationMessagePath":"/dev/termination-log","terminationMessagePolicy":"File","imagePullPolicy":"IfNotPresent"}],"restartPolicy":"Always","terminationGracePeriodSeconds":604800,"dnsPolicy":"ClusterFirst","serviceAccountName":"rabbitmq-cluster-server","serviceAccount":"rabbitmq-cluster-server","automountServiceAccountToken":true,"securityContext":{"runAsUser":999,"runAsGroup":999,"fsGroup":999},"schedulerName":"default-scheduler","topologySpreadConstraints":[{"maxSkew":1,"topologyKey":"topology.kubernetes.io/zone","whenUnsatisfiable":"ScheduleAnyway","labelSelector":{"matchLabels":{"app.kubernetes.io/name":"rabbitmq-cluster"}}}]}},"volumeClaimTemplates":[{"metadata":{"name":"persistence","namespace":"default","creationTimestamp":null,"labels":{"app.kubernetes.io/component":"rabbitmq","app.kubernetes.io/name":"rabbitmq-cluster","app.kubernetes.io/part-of":"rabbitmq"},"ownerReferences":[{"apiVersion":"rabbitmq.com/v1beta1","kind":"RabbitmqCluster","name":"rabbitmq-cluster","uid":"3ecefa8a-1bec-48a7-9af4-dd0df3339101","controller":true,"blockOwnerDeletion":false}]},"spec":{"accessModes":["ReadWriteOnce"],"resources":{"requests":{"storage":"10Gi"}},"volumeMode":"Filesystem"},"status":{"phase":"Pending"}}],"serviceName":"rabbitmq-cluster-nodes","podManagementPolicy":"Parallel","updateStrategy":{"type":"RollingUpdate","rollingUpdate":{"partition":0}},"revisionHistoryLimit":10},"status":{"observedGeneration":1,"replicas":1,"currentReplicas":1,"updatedReplicas":1,"currentRevision":"rabbitmq-cluster-server-5f8b8665fb","updateRevision":"rabbitmq-cluster-server-5f8b8665fb","collisionCount":0}}
2022/03/18 18:06:25 learn_server.go:263: [SIEVE-AFTER-WRITE]	12	Update	statefulset	github.com/rabbitmq/cluster-operator/controllers.(*RabbitmqClusterReconciler)	NoError	{"metadata":{"name":"rabbitmq-cluster-server","namespace":"default","selfLink":"/apis/apps/v1/namespaces/default/statefulsets/rabbitmq-cluster-server","uid":"f2f07f3e-b500-4c48-a5de-8db7eaf37b9a","resourceVersion":"1111","generation":1,"creationTimestamp":"2022-03-18T18:06:25Z","labels":{"app.kubernetes.io/component":"rabbitmq","app.kubernetes.io/name":"rabbitmq-cluster","app.kubernetes.io/part-of":"rabbitmq"},"annotations":{"rabbitmq.com/createdAt":"2022-03-18T18:06:25Z"},"ownerReferences":[{"apiVersion":"rabbitmq.com/v1beta1","kind":"RabbitmqCluster","name":"rabbitmq-cluster","uid":"3ecefa8a-1bec-48a7-9af4-dd0df3339101","controller":true,"blockOwnerDeletion":true}],"managedFields":[{"manager":"manager","operation":"Update","apiVersion":"apps/v1","time":"2022-03-18T18:06:25Z","fieldsType":"FieldsV1","fieldsV1":{"f:metadata":{"f:annotations":{".":{},"f:rabbitmq.com/createdAt":{}},"f:labels":{".":{},"f:app.kubernetes.io/component":{},"f:app.kubernetes.io/name":{},"f:app.kubernetes.io/part-of":{}},"f:ownerReferences":{".":{},"k:{\"uid\":\"3ecefa8a-1bec-48a7-9af4-dd0df3339101\"}":{".":{},"f:apiVersion":{},"f:blockOwnerDeletion":{},"f:controller":{},"f:kind":{},"f:name":{},"f:uid":{}}}},"f:spec":{"f:podManagementPolicy":{},"f:replicas":{},"f:revisionHistoryLimit":{},"f:selector":{"f:matchLabels":{".":{},"f:app.kubernetes.io/name":{}}},"f:serviceName":{},"f:template":{"f:metadata":{"f:annotations":{".":{},"f:prometheus.io/port":{},"f:prometheus.io/scrape":{}},"f:labels":{".":{},"f:app.kubernetes.io/component":{},"f:app.kubernetes.io/name":{},"f:app.kubernetes.io/part-of":{}}},"f:spec":{"f:automountServiceAccountToken":{},"f:containers":{"k:{\"name\":\"rabbitmq\"}":{".":{},"f:env":{".":{},"k:{\"name\":\"K8S_HOSTNAME_SUFFIX\"}":{".":{},"f:name":{},"f:value":{}},"k:{\"name\":\"K8S_SERVICE_NAME\"}":{".":{},"f:name":{},"f:value":{}},"k:{\"name\":\"MY_POD_NAME\"}":{".":{},"f:name":{},"f:valueFrom":{".":{},"f:fieldRef":{".":{},"f:apiVersion":{},"f:fieldPath":{}}}},"k:{\"name\":\"MY_POD_NAMESPACE\"}":{".":{},"f:name":{},"f:valueFrom":{".":{},"f:fieldRef":{".":{},"f:apiVersion":{},"f:fieldPath":{}}}},"k:{\"name\":\"RABBITMQ_ENABLED_PLUGINS_FILE\"}":{".":{},"f:name":{},"f:value":{}},"k:{\"name\":\"RABBITMQ_NODENAME\"}":{".":{},"f:name":{},"f:value":{}},"k:{\"name\":\"RABBITMQ_USE_LONGNAME\"}":{".":{},"f:name":{},"f:value":{}}},"f:image":{},"f:imagePullPolicy":{},"f:lifecycle":{".":{},"f:preStop":{".":{},"f:exec":{".":{},"f:command":{}}}},"f:name":{},"f:ports":{".":{},"k:{\"containerPort\":4369,\"protocol\":\"TCP\"}":{".":{},"f:containerPort":{},"f:name":{},"f:protocol":{}},"k:{\"containerPort\":5672,\"protocol\":\"TCP\"}":{".":{},"f:containerPort":{},"f:name":{},"f:protocol":{}},"k:{\"containerPort\":15672,\"protocol\":\"TCP\"}":{".":{},"f:containerPort":{},"f:name":{},"f:protocol":{}},"k:{\"containerPort\":15692,\"protocol\":\"TCP\"}":{".":{},"f:containerPort":{},"f:name":{},"f:protocol":{}}},"f:readinessProbe":{".":{},"f:failureThreshold":{},"f:initialDelaySeconds":{},"f:periodSeconds":{},"f:successThreshold":{},"f:tcpSocket":{".":{},"f:port":{}},"f:timeoutSeconds":{}},"f:resources":{".":{},"f:limits":{".":{},"f:cpu":{},"f:memory":{}},"f:requests":{".":{},"f:cpu":{},"f:memory":{}}},"f:terminationMessagePath":{},"f:terminationMessagePolicy":{},"f:volumeMounts":{".":{},"k:{\"mountPath\":\"/etc/pod-info/\"}":{".":{},"f:mountPath":{},"f:name":{}},"k:{\"mountPath\":\"/etc/rabbitmq/conf.d/10-operatorDefaults.conf\"}":{".":{},"f:mountPath":{},"f:name":{},"f:subPath":{}},"k:{\"mountPath\":\"/etc/rabbitmq/conf.d/11-default_user.conf\"}":{".":{},"f:mountPath":{},"f:name":{},"f:subPath":{}},"k:{\"mountPath\":\"/etc/rabbitmq/conf.d/90-userDefinedConfiguration.conf\"}":{".":{},"f:mountPath":{},"f:name":{},"f:subPath":{}},"k:{\"mountPath\":\"/operator\"}":{".":{},"f:mountPath":{},"f:name":{}},"k:{\"mountPath\":\"/var/lib/rabbitmq/\"}":{".":{},"f:mountPath":{},"f:name":{}},"k:{\"mountPath\":\"/var/lib/rabbitmq/mnesia/\"}":{".":{},"f:mountPath":{},"f:name":{}}}}},"f:dnsPolicy":{},"f:initContainers":{".":{},"k:{\"name\":\"setup-container\"}":{".":{},"f:command":{},"f:image":{},"f:imagePullPolicy":{},"f:name":{},"f:resources":{".":{},"f:limits":{".":{},"f:cpu":{},"f:memory":{}},"f:requests":{".":{},"f:cpu":{},"f:memory":{}}},"f:securityContext":{".":{},"f:capabilities":{".":{},"f:drop":{}},"f:runAsUser":{}},"f:terminationMessagePath":{},"f:terminationMessagePolicy":{},"f:volumeMounts":{".":{},"k:{\"mountPath\":\"/operator\"}":{".":{},"f:mountPath":{},"f:name":{}},"k:{\"mountPath\":\"/tmp/default_user.conf\"}":{".":{},"f:mountPath":{},"f:name":{},"f:subPath":{}},"k:{\"mountPath\":\"/tmp/erlang-cookie-secret/\"}":{".":{},"f:mountPath":{},"f:name":{}},"k:{\"mountPath\":\"/tmp/rabbitmq-plugins/\"}":{".":{},"f:mountPath":{},"f:name":{}},"k:{\"mountPath\":\"/var/lib/rabbitmq/\"}":{".":{},"f:mountPath":{},"f:name":{}},"k:{\"mountPath\":\"/var/lib/rabbitmq/mnesia/\"}":{".":{},"f:mountPath":{},"f:name":{}}}}},"f:restartPolicy":{},"f:schedulerName":{},"f:securityContext":{".":{},"f:fsGroup":{},"f:runAsGroup":{},"f:runAsUser":{}},"f:serviceAccount":{},"f:serviceAccountName":{},"f:terminationGracePeriodSeconds":{},"f:topologySpreadConstraints":{".":{},"k:{\"topologyKey\":\"topology.kubernetes.io/zone\",\"whenUnsatisfiable\":\"ScheduleAnyway\"}":{".":{},"f:labelSelector":{".":{},"f:matchLabels":{".":{},"f:app.kubernetes.io/name":{}}},"f:maxSkew":{},"f:topologyKey":{},"f:whenUnsatisfiable":{}}},"f:volumes":{".":{},"k:{\"name\":\"erlang-cookie-secret\"}":{".":{},"f:name":{},"f:secret":{".":{},"f:defaultMode":{},"f:secretName":{}}},"k:{\"name\":\"plugins-conf\"}":{".":{},"f:configMap":{".":{},"f:defaultMode":{},"f:name":{}},"f:name":{}},"k:{\"name\":\"pod-info\"}":{".":{},"f:downwardAPI":{".":{},"f:defaultMode":{},"f:items":{}},"f:name":{}},"k:{\"name\":\"rabbitmq-confd\"}":{".":{},"f:name":{},"f:projected":{".":{},"f:defaultMode":{},"f:sources":{}}},"k:{\"name\":\"rabbitmq-erlang-cookie\"}":{".":{},"f:emptyDir":{},"f:name":{}},"k:{\"name\":\"rabbitmq-plugins\"}":{".":{},"f:emptyDir":{},"f:name":{}}}}},"f:updateStrategy":{"f:rollingUpdate":{".":{},"f:partition":{}},"f:type":{}},"f:volumeClaimTemplates":{}}}}]},"spec":{"replicas":1,"selector":{"matchLabels":{"app.kubernetes.io/name":"rabbitmq-cluster"}},"template":{"metadata":{"creationTimestamp":null,"labels":{"app.kubernetes.io/component":"rabbitmq","app.kubernetes.io/name":"rabbitmq-cluster","app.kubernetes.io/part-of":"rabbitmq"},"annotations":{"prometheus.io/port":"15692","prometheus.io/scrape":"true"}},"spec":{"volumes":[{"name":"plugins-conf","configMap":{"name":"rabbitmq-cluster-plugins-conf","defaultMode":420}},{"name":"rabbitmq-confd","projected":{"sources":[{"secret":{"name":"rabbitmq-cluster-default-user","items":[{"key":"default_user.conf","path":"default_user.conf"}]}},{"configMap":{"name":"rabbitmq-cluster-server-conf","items":[{"key":"operatorDefaults.conf","path":"operatorDefaults.conf"},{"key":"userDefinedConfiguration.conf","path":"userDefinedConfiguration.conf"}]}}],"defaultMode":420}},{"name":"rabbitmq-erlang-cookie","emptyDir":{}},{"name":"erlang-cookie-secret","secret":{"secretName":"rabbitmq-cluster-erlang-cookie","defaultMode":420}},{"name":"rabbitmq-plugins","emptyDir":{}},{"name":"pod-info","downwardAPI":{"items":[{"path":"skipPreStopChecks","fieldRef":{"apiVersion":"v1","fieldPath":"metadata.labels['skipPreStopChecks']"}}],"defaultMode":420}}],"initContainers":[{"name":"setup-container","image":"rabbitmq:3.8.12-management","command":["sh","-c","cp /tmp/erlang-cookie-secret/.erlang.cookie /var/lib/rabbitmq/.erlang.cookie \u0026\u0026 chown 999:999 /var/lib/rabbitmq/.erlang.cookie \u0026\u0026 chmod 600 /var/lib/rabbitmq/.erlang.cookie ; cp /tmp/rabbitmq-plugins/enabled_plugins /operator/enabled_plugins \u0026\u0026 chown 999:999 /operator/enabled_plugins ; chown 999:999 /var/lib/rabbitmq/mnesia/ ; echo '[default]' \u003e /var/lib/rabbitmq/.rabbitmqadmin.conf \u0026\u0026 sed -e 's/default_user/username/' -e 's/default_pass/password/' /tmp/default_user.conf \u003e\u003e /var/lib/rabbitmq/.rabbitmqadmin.conf \u0026\u0026 chown 999:999 /var/lib/rabbitmq/.rabbitmqadmin.conf \u0026\u0026 chmod 600 /var/lib/rabbitmq/.rabbitmqadmin.conf"],"resources":{"limits":{"cpu":"100m","memory":"500Mi"},"requests":{"cpu":"100m","memory":"500Mi"}},"volumeMounts":[{"name":"plugins-conf","mountPath":"/tmp/rabbitmq-plugins/"},{"name":"rabbitmq-erlang-cookie","mountPath":"/var/lib/rabbitmq/"},{"name":"erlang-cookie-secret","mountPath":"/tmp/erlang-cookie-secret/"},{"name":"rabbitmq-plugins","mountPath":"/operator"},{"name":"persistence","mountPath":"/var/lib/rabbitmq/mnesia/"},{"name":"rabbitmq-confd","mountPath":"/tmp/default_user.conf","subPath":"default_user.conf"}],"terminationMessagePath":"/dev/termination-log","terminationMessagePolicy":"File","imagePullPolicy":"IfNotPresent","securityContext":{"capabilities":{"drop":["FSETID","KILL","SETGID","SETUID","SETPCAP","NET_BIND_SERVICE","NET_RAW","SYS_CHROOT","MKNOD","AUDIT_WRITE","SETFCAP"]},"runAsUser":0}}],"containers":[{"name":"rabbitmq","image":"rabbitmq:3.8.12-management","ports":[{"name":"epmd","containerPort":4369,"protocol":"TCP"},{"name":"amqp","containerPort":5672,"protocol":"TCP"},{"name":"management","containerPort":15672,"protocol":"TCP"},{"name":"prometheus","containerPort":15692,"protocol":"TCP"}],"env":[{"name":"MY_POD_NAME","valueFrom":{"fieldRef":{"apiVersion":"v1","fieldPath":"metadata.name"}}},{"name":"MY_POD_NAMESPACE","valueFrom":{"fieldRef":{"apiVersion":"v1","fieldPath":"metadata.namespace"}}},{"name":"RABBITMQ_ENABLED_PLUGINS_FILE","value":"/operator/enabled_plugins"},{"name":"K8S_SERVICE_NAME","value":"rabbitmq-cluster-nodes"},{"name":"RABBITMQ_USE_LONGNAME","value":"true"},{"name":"RABBITMQ_NODENAME","value":"rabbit@$(MY_POD_NAME).$(K8S_SERVICE_NAME).$(MY_POD_NAMESPACE)"},{"name":"K8S_HOSTNAME_SUFFIX","value":".$(K8S_SERVICE_NAME).$(MY_POD_NAMESPACE)"}],"resources":{"limits":{"cpu":"2","memory":"2Gi"},"requests":{"cpu":"1","memory":"2Gi"}},"volumeMounts":[{"name":"rabbitmq-erlang-cookie","mountPath":"/var/lib/rabbitmq/"},{"name":"persistence","mountPath":"/var/lib/rabbitmq/mnesia/"},{"name":"rabbitmq-plugins","mountPath":"/operator"},{"name":"rabbitmq-confd","mountPath":"/etc/rabbitmq/conf.d/10-operatorDefaults.conf","subPath":"operatorDefaults.conf"},{"name":"rabbitmq-confd","mountPath":"/etc/rabbitmq/conf.d/11-default_user.conf","subPath":"default_user.conf"},{"name":"rabbitmq-confd","mountPath":"/etc/rabbitmq/conf.d/90-userDefinedConfiguration.conf","subPath":"userDefinedConfiguration.conf"},{"name":"pod-info","mountPath":"/etc/pod-info/"}],"readinessProbe":{"tcpSocket":{"port":"amqp"},"initialDelaySeconds":10,"timeoutSeconds":5,"periodSeconds":10,"successThreshold":1,"failureThreshold":3},"lifecycle":{"preStop":{"exec":{"command":["/bin/bash","-c","if [ ! -z \"$(cat /etc/pod-info/skipPreStopChecks)\" ]; then exit 0; fi; rabbitmq-upgrade await_online_quorum_plus_one -t 604800; rabbitmq-upgrade await_online_synchronized_mirror -t 604800; rabbitmq-upgrade drain -t 604800"]}}},"terminationMessagePath":"/dev/termination-log","terminationMessagePolicy":"File","imagePullPolicy":"IfNotPresent"}],"restartPolicy":"Always","terminationGracePeriodSeconds":604800,"dnsPolicy":"ClusterFirst","serviceAccountName":"rabbitmq-cluster-server","serviceAccount":"rabbitmq-cluster-server","automountServiceAccountToken":true,"securityContext":{"runAsUser":999,"runAsGroup":999,"fsGroup":999},"schedulerName":"default-scheduler","topologySpreadConstraints":[{"maxSkew":1,"topologyKey":"topology.kubernetes.io/zone","whenUnsatisfiable":"ScheduleAnyway","labelSelector":{"matchLabels":{"app.kubernetes.io/name":"rabbitmq-cluster"}}}]}},"volumeClaimTemplates":[{"metadata":{"name":"persistence","namespace":"default","creationTimestamp":null,"labels":{"app.kubernetes.io/component":"rabbitmq","app.kubernetes.io/name":"rabbitmq-cluster","app.kubernetes.io/part-of":"rabbitmq"},"ownerReferences":[{"apiVersion":"rabbitmq.com/v1beta1","kind":"RabbitmqCluster","name":"rabbitmq-cluster","uid":"3ecefa8a-1bec-48a7-9af4-dd0df3339101","controller":true,"blockOwnerDeletion":false}]},"spec":{"accessModes":["ReadWriteOnce"],"resources":{"requests":{"storage":"10Gi"}},"volumeMode":"Filesystem"},"status":{"phase":"Pending"}}],"serviceName":"rabbitmq-cluster-nodes","podManagementPolicy":"Parallel","updateStrategy":{"type":"RollingUpdate","rollingUpdate":{"partition":0}},"revisionHistoryLimit":10},"status":{"replicas":0}}
2022/03/18 18:06:25 learn_server.go:289: [SIEVE-AFTER-HEAR]	15
2022/03/18 18:06:25 learn_server.go:291: [SIEVE-AFTER-READ]	Get	true	configmap	default	rabbitmq-cluster-server-conf	github.com/rabbitmq/cluster-operator/controllers.(*RabbitmqClusterReconciler)	NoError	{"kind":"ConfigMap","apiVersion":"v1","metadata":{"name":"rabbitmq-cluster-server-conf","namespace":"default","selfLink":"/api/v1/namespaces/default/configmaps/rabbitmq-cluster-server-conf","uid":"e4182078-d429-4baf-9021-72618c509ac5","resourceVersion":"1095","creationTimestamp":"2022-03-18T18:06:25Z","labels":{"app.kubernetes.io/component":"rabbitmq","app.kubernetes.io/name":"rabbitmq-cluster","app.kubernetes.io/part-of":"rabbitmq"},"ownerReferences":[{"apiVersion":"rabbitmq.com/v1beta1","kind":"RabbitmqCluster","name":"rabbitmq-cluster","uid":"3ecefa8a-1bec-48a7-9af4-dd0df3339101","controller":true,"blockOwnerDeletion":true}],"managedFields":[{"manager":"manager","operation":"Update","apiVersion":"v1","time":"2022-03-18T18:06:25Z","fieldsType":"FieldsV1","fieldsV1":{"f:data":{".":{},"f:operatorDefaults.conf":{},"f:userDefinedConfiguration.conf":{}},"f:metadata":{"f:labels":{".":{},"f:app.kubernetes.io/component":{},"f:app.kubernetes.io/name":{},"f:app.kubernetes.io/part-of":{}},"f:ownerReferences":{".":{},"k:{\"uid\":\"3ecefa8a-1bec-48a7-9af4-dd0df3339101\"}":{".":{},"f:apiVersion":{},"f:blockOwnerDeletion":{},"f:controller":{},"f:kind":{},"f:name":{},"f:uid":{}}}}}}]},"data":{"operatorDefaults.conf":"cluster_formation.peer_discovery_backend             = rabbit_peer_discovery_k8s\ncluster_formation.k8s.host                           = kubernetes.default\ncluster_formation.k8s.address_type                   = hostname\ncluster_partition_handling                           = pause_minority\nqueue_master_locator                                 = min-masters\ndisk_free_limit.absolute                             = 2GB\ncluster_formation.randomized_startup_delay_range.min = 5\ncluster_formation.randomized_startup_delay_range.max = 30\ncluster_name                                         = rabbitmq-cluster\n","userDefinedConfiguration.conf":"total_memory_available_override_value = 1717986919\n"}}
2022/03/18 18:06:25 learn_server.go:256: [SIEVE-BEFORE-WRITE]	13
2022/03/18 18:06:25 learn_server.go:263: [SIEVE-AFTER-WRITE]	13	StatusUpdate	rabbitmqcluster	github.com/rabbitmq/cluster-operator/controllers.(*RabbitmqClusterReconciler)	NoError	{"metadata":{"name":"rabbitmq-cluster","namespace":"default","selfLink":"/apis/rabbitmq.com/v1beta1/namespaces/default/rabbitmqclusters/rabbitmq-cluster/status","uid":"3ecefa8a-1bec-48a7-9af4-dd0df3339101","resourceVersion":"1131","generation":2,"creationTimestamp":"2022-03-18T18:06:25Z","annotations":{"kubectl.kubernetes.io/last-applied-configuration":"{\"apiVersion\":\"rabbitmq.com/v1beta1\",\"kind\":\"RabbitmqCluster\",\"metadata\":{\"annotations\":{},\"name\":\"rabbitmq-cluster\",\"namespace\":\"default\"},\"spec\":{\"persistence\":{\"storage\":\"10Gi\"},\"replicas\":1}}\n"},"finalizers":["deletion.finalizers.rabbitmqclusters.rabbitmq.com"],"managedFields":[{"manager":"kubectl-client-side-apply","operation":"Update","apiVersion":"rabbitmq.com/v1beta1","time":"2022-03-18T18:06:25Z","fieldsType":"FieldsV1","fieldsV1":{"f:metadata":{"f:annotations":{".":{},"f:kubectl.kubernetes.io/last-applied-configuration":{}}},"f:spec":{".":{},"f:image":{},"f:persistence":{".":{},"f:storage":{}},"f:replicas":{},"f:resources":{".":{},"f:limits":{".":{},"f:memory":{}},"f:requests":{".":{},"f:memory":{}}},"f:service":{".":{},"f:type":{}},"f:terminationGracePeriodSeconds":{}}}},{"manager":"manager","operation":"Update","apiVersion":"rabbitmq.com/v1beta1","time":"2022-03-18T18:06:25Z","fieldsType":"FieldsV1","fieldsV1":{"f:metadata":{"f:finalizers":{}},"f:spec":{"f:override":{},"f:rabbitmq":{},"f:resources":{"f:limits":{"f:cpu":{}},"f:requests":{"f:cpu":{}}},"f:tls":{}},"f:status":{".":{},"f:conditions":{},"f:defaultUser":{".":{},"f:secretReference":{".":{},"f:keys":{".":{},"f:password":{},"f:username":{}},"f:name":{},"f:namespace":{}},"f:serviceReference":{".":{},"f:name":{},"f:namespace":{}}}}}}]},"spec":{"replicas":1,"image":"rabbitmq:3.8.12-management","service":{"type":"ClusterIP"},"persistence":{"storage":"10Gi"},"resources":{"limits":{"cpu":"2","memory":"2Gi"},"requests":{"cpu":"1","memory":"2Gi"}},"rabbitmq":{},"tls":{},"override":{},"terminationGracePeriodSeconds":604800},"status":{"conditions":[{"type":"AllReplicasReady","status":"Unknown","lastTransitionTime":"2022-03-18T18:06:25Z","reason":"MissingStatefulSet","message":"Could not find StatefulSet"},{"type":"ClusterAvailable","status":"Unknown","lastTransitionTime":"2022-03-18T18:06:25Z","reason":"CouldNotRetrieveEndpoints","message":"Could not verify available service endpoints"},{"type":"NoWarnings","status":"Unknown","lastTransitionTime":"2022-03-18T18:06:25Z","reason":"MissingStatefulSet","message":"Could not find StatefulSet"},{"type":"ReconcileSuccess","status":"Unknown","lastTransitionTime":"2022-03-18T18:06:25Z","reason":"Initialising"}],"defaultUser":{"secretReference":{"name":"rabbitmq-cluster-default-user","namespace":"default","keys":{"password":"password","username":"username"}},"serviceReference":{"name":"rabbitmq-cluster","namespace":"default"}}}}
2022/03/18 18:06:25 learn_server.go:279: [SIEVE-BEFORE-HEAR]	16	Updated	rabbitmqcluster	{"metadata":{"name":"rabbitmq-cluster","namespace":"default","selfLink":"/apis/rabbitmq.com/v1beta1/namespaces/default/rabbitmqclusters/rabbitmq-cluster","uid":"3ecefa8a-1bec-48a7-9af4-dd0df3339101","resourceVersion":"1131","generation":2,"creationTimestamp":"2022-03-18T18:06:25Z","annotations":{"kubectl.kubernetes.io/last-applied-configuration":"{\"apiVersion\":\"rabbitmq.com/v1beta1\",\"kind\":\"RabbitmqCluster\",\"metadata\":{\"annotations\":{},\"name\":\"rabbitmq-cluster\",\"namespace\":\"default\"},\"spec\":{\"persistence\":{\"storage\":\"10Gi\"},\"replicas\":1}}\n"},"finalizers":["deletion.finalizers.rabbitmqclusters.rabbitmq.com"],"managedFields":[{"manager":"kubectl-client-side-apply","operation":"Update","apiVersion":"rabbitmq.com/v1beta1","time":"2022-03-18T18:06:25Z","fieldsType":"FieldsV1","fieldsV1":{"f:metadata":{"f:annotations":{".":{},"f:kubectl.kubernetes.io/last-applied-configuration":{}}},"f:spec":{".":{},"f:image":{},"f:persistence":{".":{},"f:storage":{}},"f:replicas":{},"f:resources":{".":{},"f:limits":{".":{},"f:memory":{}},"f:requests":{".":{},"f:memory":{}}},"f:service":{".":{},"f:type":{}},"f:terminationGracePeriodSeconds":{}}}},{"manager":"manager","operation":"Update","apiVersion":"rabbitmq.com/v1beta1","time":"2022-03-18T18:06:25Z","fieldsType":"FieldsV1","fieldsV1":{"f:metadata":{"f:finalizers":{}},"f:spec":{"f:override":{},"f:rabbitmq":{},"f:resources":{"f:limits":{"f:cpu":{}},"f:requests":{"f:cpu":{}}},"f:tls":{}},"f:status":{".":{},"f:conditions":{},"f:defaultUser":{".":{},"f:secretReference":{".":{},"f:keys":{".":{},"f:password":{},"f:username":{}},"f:name":{},"f:namespace":{}},"f:serviceReference":{".":{},"f:name":{},"f:namespace":{}}}}}}]},"spec":{"replicas":1,"image":"rabbitmq:3.8.12-management","service":{"type":"ClusterIP"},"persistence":{"storage":"10Gi"},"resources":{"limits":{"cpu":"2","memory":"2Gi"},"requests":{"cpu":"1","memory":"2Gi"}},"rabbitmq":{},"tls":{},"override":{},"terminationGracePeriodSeconds":604800},"status":{"conditions":[{"type":"AllReplicasReady","status":"Unknown","lastTransitionTime":"2022-03-18T18:06:25Z","reason":"MissingStatefulSet","message":"Could not find StatefulSet"},{"type":"ClusterAvailable","status":"Unknown","lastTransitionTime":"2022-03-18T18:06:25Z","reason":"CouldNotRetrieveEndpoints","message":"Could not verify available service endpoints"},{"type":"NoWarnings","status":"Unknown","lastTransitionTime":"2022-03-18T18:06:25Z","reason":"MissingStatefulSet","message":"Could not find StatefulSet"},{"type":"ReconcileSuccess","status":"Unknown","lastTransitionTime":"2022-03-18T18:06:25Z","reason":"Initialising"}],"defaultUser":{"secretReference":{"name":"rabbitmq-cluster-default-user","namespace":"default","keys":{"password":"password","username":"username"}},"serviceReference":{"name":"rabbitmq-cluster","namespace":"default"}}}}
2022/03/18 18:06:25 learn_server.go:256: [SIEVE-BEFORE-WRITE]	14
2022/03/18 18:06:25 learn_server.go:289: [SIEVE-AFTER-HEAR]	16
2022/03/18 18:06:25 learn_server.go:263: [SIEVE-AFTER-WRITE]	14	StatusUpdate	rabbitmqcluster	github.com/rabbitmq/cluster-operator/controllers.(*RabbitmqClusterReconciler)	NoError	{"metadata":{"name":"rabbitmq-cluster","namespace":"default","selfLink":"/apis/rabbitmq.com/v1beta1/namespaces/default/rabbitmqclusters/rabbitmq-cluster/status","uid":"3ecefa8a-1bec-48a7-9af4-dd0df3339101","resourceVersion":"1131","generation":2,"creationTimestamp":"2022-03-18T18:06:25Z","annotations":{"kubectl.kubernetes.io/last-applied-configuration":"{\"apiVersion\":\"rabbitmq.com/v1beta1\",\"kind\":\"RabbitmqCluster\",\"metadata\":{\"annotations\":{},\"name\":\"rabbitmq-cluster\",\"namespace\":\"default\"},\"spec\":{\"persistence\":{\"storage\":\"10Gi\"},\"replicas\":1}}\n"},"finalizers":["deletion.finalizers.rabbitmqclusters.rabbitmq.com"],"managedFields":[{"manager":"kubectl-client-side-apply","operation":"Update","apiVersion":"rabbitmq.com/v1beta1","time":"2022-03-18T18:06:25Z","fieldsType":"FieldsV1","fieldsV1":{"f:metadata":{"f:annotations":{".":{},"f:kubectl.kubernetes.io/last-applied-configuration":{}}},"f:spec":{".":{},"f:image":{},"f:persistence":{".":{},"f:storage":{}},"f:replicas":{},"f:resources":{".":{},"f:limits":{".":{},"f:memory":{}},"f:requests":{".":{},"f:memory":{}}},"f:service":{".":{},"f:type":{}},"f:terminationGracePeriodSeconds":{}}}},{"manager":"manager","operation":"Update","apiVersion":"rabbitmq.com/v1beta1","time":"2022-03-18T18:06:25Z","fieldsType":"FieldsV1","fieldsV1":{"f:metadata":{"f:finalizers":{}},"f:spec":{"f:override":{},"f:rabbitmq":{},"f:resources":{"f:limits":{"f:cpu":{}},"f:requests":{"f:cpu":{}}},"f:tls":{}},"f:status":{".":{},"f:conditions":{},"f:defaultUser":{".":{},"f:secretReference":{".":{},"f:keys":{".":{},"f:password":{},"f:username":{}},"f:name":{},"f:namespace":{}},"f:serviceReference":{".":{},"f:name":{},"f:namespace":{}}}}}}]},"spec":{"replicas":1,"image":"rabbitmq:3.8.12-management","service":{"type":"ClusterIP"},"persistence":{"storage":"10Gi"},"resources":{"limits":{"cpu":"2","memory":"2Gi"},"requests":{"cpu":"1","memory":"2Gi"}},"rabbitmq":{},"tls":{},"override":{},"terminationGracePeriodSeconds":604800},"status":{"conditions":[{"type":"AllReplicasReady","status":"Unknown","lastTransitionTime":"2022-03-18T18:06:25Z","reason":"MissingStatefulSet","message":"Could not find StatefulSet"},{"type":"ClusterAvailable","status":"Unknown","lastTransitionTime":"2022-03-18T18:06:25Z","reason":"CouldNotRetrieveEndpoints","message":"Could not verify available service endpoints"},{"type":"NoWarnings","status":"Unknown","lastTransitionTime":"2022-03-18T18:06:25Z","reason":"MissingStatefulSet","message":"Could not find StatefulSet"},{"type":"ReconcileSuccess","status":"Unknown","lastTransitionTime":"2022-03-18T18:06:25Z","reason":"Initialising"}],"defaultUser":{"secretReference":{"name":"rabbitmq-cluster-default-user","namespace":"default","keys":{"password":"password","username":"username"}},"serviceReference":{"name":"rabbitmq-cluster","namespace":"default"}},"binding":{"name":"rabbitmq-cluster-default-user"}}}
2022/03/18 18:06:25 learn_server.go:291: [SIEVE-AFTER-READ]	Get	true	statefulset	default	rabbitmq-cluster-server	github.com/rabbitmq/cluster-operator/controllers.(*RabbitmqClusterReconciler)	NoError	{"kind":"StatefulSet","apiVersion":"apps/v1","metadata":{"name":"rabbitmq-cluster-server","namespace":"default","selfLink":"/apis/apps/v1/namespaces/default/statefulsets/rabbitmq-cluster-server","uid":"f2f07f3e-b500-4c48-a5de-8db7eaf37b9a","resourceVersion":"1129","generation":1,"creationTimestamp":"2022-03-18T18:06:25Z","labels":{"app.kubernetes.io/component":"rabbitmq","app.kubernetes.io/name":"rabbitmq-cluster","app.kubernetes.io/part-of":"rabbitmq"},"annotations":{"rabbitmq.com/createdAt":"2022-03-18T18:06:25Z"},"ownerReferences":[{"apiVersion":"rabbitmq.com/v1beta1","kind":"RabbitmqCluster","name":"rabbitmq-cluster","uid":"3ecefa8a-1bec-48a7-9af4-dd0df3339101","controller":true,"blockOwnerDeletion":true}],"managedFields":[{"manager":"kube-controller-manager","operation":"Update","apiVersion":"apps/v1","time":"2022-03-18T18:06:25Z","fieldsType":"FieldsV1","fieldsV1":{"f:status":{"f:collisionCount":{},"f:currentReplicas":{},"f:currentRevision":{},"f:observedGeneration":{},"f:replicas":{},"f:updateRevision":{},"f:updatedReplicas":{}}}},{"manager":"manager","operation":"Update","apiVersion":"apps/v1","time":"2022-03-18T18:06:25Z","fieldsType":"FieldsV1","fieldsV1":{"f:metadata":{"f:annotations":{".":{},"f:rabbitmq.com/createdAt":{}},"f:labels":{".":{},"f:app.kubernetes.io/component":{},"f:app.kubernetes.io/name":{},"f:app.kubernetes.io/part-of":{}},"f:ownerReferences":{".":{},"k:{\"uid\":\"3ecefa8a-1bec-48a7-9af4-dd0df3339101\"}":{".":{},"f:apiVersion":{},"f:blockOwnerDeletion":{},"f:controller":{},"f:kind":{},"f:name":{},"f:uid":{}}}},"f:spec":{"f:podManagementPolicy":{},"f:replicas":{},"f:revisionHistoryLimit":{},"f:selector":{"f:matchLabels":{".":{},"f:app.kubernetes.io/name":{}}},"f:serviceName":{},"f:template":{"f:metadata":{"f:annotations":{".":{},"f:prometheus.io/port":{},"f:prometheus.io/scrape":{}},"f:labels":{".":{},"f:app.kubernetes.io/component":{},"f:app.kubernetes.io/name":{},"f:app.kubernetes.io/part-of":{}}},"f:spec":{"f:automountServiceAccountToken":{},"f:containers":{"k:{\"name\":\"rabbitmq\"}":{".":{},"f:env":{".":{},"k:{\"name\":\"K8S_HOSTNAME_SUFFIX\"}":{".":{},"f:name":{},"f:value":{}},"k:{\"name\":\"K8S_SERVICE_NAME\"}":{".":{},"f:name":{},"f:value":{}},"k:{\"name\":\"MY_POD_NAME\"}":{".":{},"f:name":{},"f:valueFrom":{".":{},"f:fieldRef":{".":{},"f:apiVersion":{},"f:fieldPath":{}}}},"k:{\"name\":\"MY_POD_NAMESPACE\"}":{".":{},"f:name":{},"f:valueFrom":{".":{},"f:fieldRef":{".":{},"f:apiVersion":{},"f:fieldPath":{}}}},"k:{\"name\":\"RABBITMQ_ENABLED_PLUGINS_FILE\"}":{".":{},"f:name":{},"f:value":{}},"k:{\"name\":\"RABBITMQ_NODENAME\"}":{".":{},"f:name":{},"f:value":{}},"k:{\"name\":\"RABBITMQ_USE_LONGNAME\"}":{".":{},"f:name":{},"f:value":{}}},"f:image":{},"f:imagePullPolicy":{},"f:lifecycle":{".":{},"f:preStop":{".":{},"f:exec":{".":{},"f:command":{}}}},"f:name":{},"f:ports":{".":{},"k:{\"containerPort\":4369,\"protocol\":\"TCP\"}":{".":{},"f:containerPort":{},"f:name":{},"f:protocol":{}},"k:{\"containerPort\":5672,\"protocol\":\"TCP\"}":{".":{},"f:containerPort":{},"f:name":{},"f:protocol":{}},"k:{\"containerPort\":15672,\"protocol\":\"TCP\"}":{".":{},"f:containerPort":{},"f:name":{},"f:protocol":{}},"k:{\"containerPort\":15692,\"protocol\":\"TCP\"}":{".":{},"f:containerPort":{},"f:name":{},"f:protocol":{}}},"f:readinessProbe":{".":{},"f:failureThreshold":{},"f:initialDelaySeconds":{},"f:periodSeconds":{},"f:successThreshold":{},"f:tcpSocket":{".":{},"f:port":{}},"f:timeoutSeconds":{}},"f:resources":{".":{},"f:limits":{".":{},"f:cpu":{},"f:memory":{}},"f:requests":{".":{},"f:cpu":{},"f:memory":{}}},"f:terminationMessagePath":{},"f:terminationMessagePolicy":{},"f:volumeMounts":{".":{},"k:{\"mountPath\":\"/etc/pod-info/\"}":{".":{},"f:mountPath":{},"f:name":{}},"k:{\"mountPath\":\"/etc/rabbitmq/conf.d/10-operatorDefaults.conf\"}":{".":{},"f:mountPath":{},"f:name":{},"f:subPath":{}},"k:{\"mountPath\":\"/etc/rabbitmq/conf.d/11-default_user.conf\"}":{".":{},"f:mountPath":{},"f:name":{},"f:subPath":{}},"k:{\"mountPath\":\"/etc/rabbitmq/conf.d/90-userDefinedConfiguration.conf\"}":{".":{},"f:mountPath":{},"f:name":{},"f:subPath":{}},"k:{\"mountPath\":\"/operator\"}":{".":{},"f:mountPath":{},"f:name":{}},"k:{\"mountPath\":\"/var/lib/rabbitmq/\"}":{".":{},"f:mountPath":{},"f:name":{}},"k:{\"mountPath\":\"/var/lib/rabbitmq/mnesia/\"}":{".":{},"f:mountPath":{},"f:name":{}}}}},"f:dnsPolicy":{},"f:initContainers":{".":{},"k:{\"name\":\"setup-container\"}":{".":{},"f:command":{},"f:image":{},"f:imagePullPolicy":{},"f:name":{},"f:resources":{".":{},"f:limits":{".":{},"f:cpu":{},"f:memory":{}},"f:requests":{".":{},"f:cpu":{},"f:memory":{}}},"f:securityContext":{".":{},"f:capabilities":{".":{},"f:drop":{}},"f:runAsUser":{}},"f:terminationMessagePath":{},"f:terminationMessagePolicy":{},"f:volumeMounts":{".":{},"k:{\"mountPath\":\"/operator\"}":{".":{},"f:mountPath":{},"f:name":{}},"k:{\"mountPath\":\"/tmp/default_user.conf\"}":{".":{},"f:mountPath":{},"f:name":{},"f:subPath":{}},"k:{\"mountPath\":\"/tmp/erlang-cookie-secret/\"}":{".":{},"f:mountPath":{},"f:name":{}},"k:{\"mountPath\":\"/tmp/rabbitmq-plugins/\"}":{".":{},"f:mountPath":{},"f:name":{}},"k:{\"mountPath\":\"/var/lib/rabbitmq/\"}":{".":{},"f:mountPath":{},"f:name":{}},"k:{\"mountPath\":\"/var/lib/rabbitmq/mnesia/\"}":{".":{},"f:mountPath":{},"f:name":{}}}}},"f:restartPolicy":{},"f:schedulerName":{},"f:securityContext":{".":{},"f:fsGroup":{},"f:runAsGroup":{},"f:runAsUser":{}},"f:serviceAccount":{},"f:serviceAccountName":{},"f:terminationGracePeriodSeconds":{},"f:topologySpreadConstraints":{".":{},"k:{\"topologyKey\":\"topology.kubernetes.io/zone\",\"whenUnsatisfiable\":\"ScheduleAnyway\"}":{".":{},"f:labelSelector":{".":{},"f:matchLabels":{".":{},"f:app.kubernetes.io/name":{}}},"f:maxSkew":{},"f:topologyKey":{},"f:whenUnsatisfiable":{}}},"f:volumes":{".":{},"k:{\"name\":\"erlang-cookie-secret\"}":{".":{},"f:name":{},"f:secret":{".":{},"f:defaultMode":{},"f:secretName":{}}},"k:{\"name\":\"plugins-conf\"}":{".":{},"f:configMap":{".":{},"f:defaultMode":{},"f:name":{}},"f:name":{}},"k:{\"name\":\"pod-info\"}":{".":{},"f:downwardAPI":{".":{},"f:defaultMode":{},"f:items":{}},"f:name":{}},"k:{\"name\":\"rabbitmq-confd\"}":{".":{},"f:name":{},"f:projected":{".":{},"f:defaultMode":{},"f:sources":{}}},"k:{\"name\":\"rabbitmq-erlang-cookie\"}":{".":{},"f:emptyDir":{},"f:name":{}},"k:{\"name\":\"rabbitmq-plugins\"}":{".":{},"f:emptyDir":{},"f:name":{}}}}},"f:updateStrategy":{"f:rollingUpdate":{".":{},"f:partition":{}},"f:type":{}},"f:volumeClaimTemplates":{}}}}]},"spec":{"replicas":1,"selector":{"matchLabels":{"app.kubernetes.io/name":"rabbitmq-cluster"}},"template":{"metadata":{"creationTimestamp":null,"labels":{"app.kubernetes.io/component":"rabbitmq","app.kubernetes.io/name":"rabbitmq-cluster","app.kubernetes.io/part-of":"rabbitmq"},"annotations":{"prometheus.io/port":"15692","prometheus.io/scrape":"true"}},"spec":{"volumes":[{"name":"plugins-conf","configMap":{"name":"rabbitmq-cluster-plugins-conf","defaultMode":420}},{"name":"rabbitmq-confd","projected":{"sources":[{"secret":{"name":"rabbitmq-cluster-default-user","items":[{"key":"default_user.conf","path":"default_user.conf"}]}},{"configMap":{"name":"rabbitmq-cluster-server-conf","items":[{"key":"operatorDefaults.conf","path":"operatorDefaults.conf"},{"key":"userDefinedConfiguration.conf","path":"userDefinedConfiguration.conf"}]}}],"defaultMode":420}},{"name":"rabbitmq-erlang-cookie","emptyDir":{}},{"name":"erlang-cookie-secret","secret":{"secretName":"rabbitmq-cluster-erlang-cookie","defaultMode":420}},{"name":"rabbitmq-plugins","emptyDir":{}},{"name":"pod-info","downwardAPI":{"items":[{"path":"skipPreStopChecks","fieldRef":{"apiVersion":"v1","fieldPath":"metadata.labels['skipPreStopChecks']"}}],"defaultMode":420}}],"initContainers":[{"name":"setup-container","image":"rabbitmq:3.8.12-management","command":["sh","-c","cp /tmp/erlang-cookie-secret/.erlang.cookie /var/lib/rabbitmq/.erlang.cookie \u0026\u0026 chown 999:999 /var/lib/rabbitmq/.erlang.cookie \u0026\u0026 chmod 600 /var/lib/rabbitmq/.erlang.cookie ; cp /tmp/rabbitmq-plugins/enabled_plugins /operator/enabled_plugins \u0026\u0026 chown 999:999 /operator/enabled_plugins ; chown 999:999 /var/lib/rabbitmq/mnesia/ ; echo '[default]' \u003e /var/lib/rabbitmq/.rabbitmqadmin.conf \u0026\u0026 sed -e 's/default_user/username/' -e 's/default_pass/password/' /tmp/default_user.conf \u003e\u003e /var/lib/rabbitmq/.rabbitmqadmin.conf \u0026\u0026 chown 999:999 /var/lib/rabbitmq/.rabbitmqadmin.conf \u0026\u0026 chmod 600 /var/lib/rabbitmq/.rabbitmqadmin.conf"],"resources":{"limits":{"cpu":"100m","memory":"500Mi"},"requests":{"cpu":"100m","memory":"500Mi"}},"volumeMounts":[{"name":"plugins-conf","mountPath":"/tmp/rabbitmq-plugins/"},{"name":"rabbitmq-erlang-cookie","mountPath":"/var/lib/rabbitmq/"},{"name":"erlang-cookie-secret","mountPath":"/tmp/erlang-cookie-secret/"},{"name":"rabbitmq-plugins","mountPath":"/operator"},{"name":"persistence","mountPath":"/var/lib/rabbitmq/mnesia/"},{"name":"rabbitmq-confd","mountPath":"/tmp/default_user.conf","subPath":"default_user.conf"}],"terminationMessagePath":"/dev/termination-log","terminationMessagePolicy":"File","imagePullPolicy":"IfNotPresent","securityContext":{"capabilities":{"drop":["FSETID","KILL","SETGID","SETUID","SETPCAP","NET_BIND_SERVICE","NET_RAW","SYS_CHROOT","MKNOD","AUDIT_WRITE","SETFCAP"]},"runAsUser":0}}],"containers":[{"name":"rabbitmq","image":"rabbitmq:3.8.12-management","ports":[{"name":"epmd","containerPort":4369,"protocol":"TCP"},{"name":"amqp","containerPort":5672,"protocol":"TCP"},{"name":"management","containerPort":15672,"protocol":"TCP"},{"name":"prometheus","containerPort":15692,"protocol":"TCP"}],"env":[{"name":"MY_POD_NAME","valueFrom":{"fieldRef":{"apiVersion":"v1","fieldPath":"metadata.name"}}},{"name":"MY_POD_NAMESPACE","valueFrom":{"fieldRef":{"apiVersion":"v1","fieldPath":"metadata.namespace"}}},{"name":"RABBITMQ_ENABLED_PLUGINS_FILE","value":"/operator/enabled_plugins"},{"name":"K8S_SERVICE_NAME","value":"rabbitmq-cluster-nodes"},{"name":"RABBITMQ_USE_LONGNAME","value":"true"},{"name":"RABBITMQ_NODENAME","value":"rabbit@$(MY_POD_NAME).$(K8S_SERVICE_NAME).$(MY_POD_NAMESPACE)"},{"name":"K8S_HOSTNAME_SUFFIX","value":".$(K8S_SERVICE_NAME).$(MY_POD_NAMESPACE)"}],"resources":{"limits":{"cpu":"2","memory":"2Gi"},"requests":{"cpu":"1","memory":"2Gi"}},"volumeMounts":[{"name":"rabbitmq-erlang-cookie","mountPath":"/var/lib/rabbitmq/"},{"name":"persistence","mountPath":"/var/lib/rabbitmq/mnesia/"},{"name":"rabbitmq-plugins","mountPath":"/operator"},{"name":"rabbitmq-confd","mountPath":"/etc/rabbitmq/conf.d/10-operatorDefaults.conf","subPath":"operatorDefaults.conf"},{"name":"rabbitmq-confd","mountPath":"/etc/rabbitmq/conf.d/11-default_user.conf","subPath":"default_user.conf"},{"name":"rabbitmq-confd","mountPath":"/etc/rabbitmq/conf.d/90-userDefinedConfiguration.conf","subPath":"userDefinedConfiguration.conf"},{"name":"pod-info","mountPath":"/etc/pod-info/"}],"readinessProbe":{"tcpSocket":{"port":"amqp"},"initialDelaySeconds":10,"timeoutSeconds":5,"periodSeconds":10,"successThreshold":1,"failureThreshold":3},"lifecycle":{"preStop":{"exec":{"command":["/bin/bash","-c","if [ ! -z \"$(cat /etc/pod-info/skipPreStopChecks)\" ]; then exit 0; fi; rabbitmq-upgrade await_online_quorum_plus_one -t 604800; rabbitmq-upgrade await_online_synchronized_mirror -t 604800; rabbitmq-upgrade drain -t 604800"]}}},"terminationMessagePath":"/dev/termination-log","terminationMessagePolicy":"File","imagePullPolicy":"IfNotPresent"}],"restartPolicy":"Always","terminationGracePeriodSeconds":604800,"dnsPolicy":"ClusterFirst","serviceAccountName":"rabbitmq-cluster-server","serviceAccount":"rabbitmq-cluster-server","automountServiceAccountToken":true,"securityContext":{"runAsUser":999,"runAsGroup":999,"fsGroup":999},"schedulerName":"default-scheduler","topologySpreadConstraints":[{"maxSkew":1,"topologyKey":"topology.kubernetes.io/zone","whenUnsatisfiable":"ScheduleAnyway","labelSelector":{"matchLabels":{"app.kubernetes.io/name":"rabbitmq-cluster"}}}]}},"volumeClaimTemplates":[{"metadata":{"name":"persistence","namespace":"default","creationTimestamp":null,"labels":{"app.kubernetes.io/component":"rabbitmq","app.kubernetes.io/name":"rabbitmq-cluster","app.kubernetes.io/part-of":"rabbitmq"},"ownerReferences":[{"apiVersion":"rabbitmq.com/v1beta1","kind":"RabbitmqCluster","name":"rabbitmq-cluster","uid":"3ecefa8a-1bec-48a7-9af4-dd0df3339101","controller":true,"blockOwnerDeletion":false}]},"spec":{"accessModes":["ReadWriteOnce"],"resources":{"requests":{"storage":"10Gi"}},"volumeMode":"Filesystem"},"status":{"phase":"Pending"}}],"serviceName":"rabbitmq-cluster-nodes","podManagementPolicy":"Parallel","updateStrategy":{"type":"RollingUpdate","rollingUpdate":{"partition":0}},"revisionHistoryLimit":10},"status":{"observedGeneration":1,"replicas":1,"currentReplicas":1,"updatedReplicas":1,"currentRevision":"rabbitmq-cluster-server-5f8b8665fb","updateRevision":"rabbitmq-cluster-server-5f8b8665fb","collisionCount":0}}
2022/03/18 18:06:25 learn_server.go:253: [SIEVE-AFTER-RECONCILE]	github.com/rabbitmq/cluster-operator/controllers.(*RabbitmqClusterReconciler)	0
2022/03/18 18:06:25 learn_server.go:238: [SIEVE-BEFORE-RECONCILE]	github.com/rabbitmq/cluster-operator/controllers.(*RabbitmqClusterReconciler)	1
2022/03/18 18:06:25 learn_server.go:291: [SIEVE-AFTER-READ]	Get	true	rabbitmqcluster	default	rabbitmq-cluster	github.com/rabbitmq/cluster-operator/controllers.(*RabbitmqClusterReconciler)	NoError	{"kind":"RabbitmqCluster","apiVersion":"rabbitmq.com/v1beta1","metadata":{"name":"rabbitmq-cluster","namespace":"default","selfLink":"/apis/rabbitmq.com/v1beta1/namespaces/default/rabbitmqclusters/rabbitmq-cluster","uid":"3ecefa8a-1bec-48a7-9af4-dd0df3339101","resourceVersion":"1131","generation":2,"creationTimestamp":"2022-03-18T18:06:25Z","annotations":{"kubectl.kubernetes.io/last-applied-configuration":"{\"apiVersion\":\"rabbitmq.com/v1beta1\",\"kind\":\"RabbitmqCluster\",\"metadata\":{\"annotations\":{},\"name\":\"rabbitmq-cluster\",\"namespace\":\"default\"},\"spec\":{\"persistence\":{\"storage\":\"10Gi\"},\"replicas\":1}}\n"},"finalizers":["deletion.finalizers.rabbitmqclusters.rabbitmq.com"],"managedFields":[{"manager":"kubectl-client-side-apply","operation":"Update","apiVersion":"rabbitmq.com/v1beta1","time":"2022-03-18T18:06:25Z","fieldsType":"FieldsV1","fieldsV1":{"f:metadata":{"f:annotations":{".":{},"f:kubectl.kubernetes.io/last-applied-configuration":{}}},"f:spec":{".":{},"f:image":{},"f:persistence":{".":{},"f:storage":{}},"f:replicas":{},"f:resources":{".":{},"f:limits":{".":{},"f:memory":{}},"f:requests":{".":{},"f:memory":{}}},"f:service":{".":{},"f:type":{}},"f:terminationGracePeriodSeconds":{}}}},{"manager":"manager","operation":"Update","apiVersion":"rabbitmq.com/v1beta1","time":"2022-03-18T18:06:25Z","fieldsType":"FieldsV1","fieldsV1":{"f:metadata":{"f:finalizers":{}},"f:spec":{"f:override":{},"f:rabbitmq":{},"f:resources":{"f:limits":{"f:cpu":{}},"f:requests":{"f:cpu":{}}},"f:tls":{}},"f:status":{".":{},"f:conditions":{},"f:defaultUser":{".":{},"f:secretReference":{".":{},"f:keys":{".":{},"f:password":{},"f:username":{}},"f:name":{},"f:namespace":{}},"f:serviceReference":{".":{},"f:name":{},"f:namespace":{}}}}}}]},"spec":{"replicas":1,"image":"rabbitmq:3.8.12-management","service":{"type":"ClusterIP"},"persistence":{"storage":"10Gi"},"resources":{"limits":{"cpu":"2","memory":"2Gi"},"requests":{"cpu":"1","memory":"2Gi"}},"rabbitmq":{},"tls":{},"override":{},"terminationGracePeriodSeconds":604800},"status":{"conditions":[{"type":"AllReplicasReady","status":"Unknown","lastTransitionTime":"2022-03-18T18:06:25Z","reason":"MissingStatefulSet","message":"Could not find StatefulSet"},{"type":"ClusterAvailable","status":"Unknown","lastTransitionTime":"2022-03-18T18:06:25Z","reason":"CouldNotRetrieveEndpoints","message":"Could not verify available service endpoints"},{"type":"NoWarnings","status":"Unknown","lastTransitionTime":"2022-03-18T18:06:25Z","reason":"MissingStatefulSet","message":"Could not find StatefulSet"},{"type":"ReconcileSuccess","status":"Unknown","lastTransitionTime":"2022-03-18T18:06:25Z","reason":"Initialising"}],"defaultUser":{"secretReference":{"name":"rabbitmq-cluster-default-user","namespace":"default","keys":{"password":"password","username":"username"}},"serviceReference":{"name":"rabbitmq-cluster","namespace":"default"}}}}
2022/03/18 18:06:25 learn_server.go:291: [SIEVE-AFTER-READ]	Get	true	statefulset	default	rabbitmq-cluster-server	github.com/rabbitmq/cluster-operator/controllers.(*RabbitmqClusterReconciler)	NoError	{"kind":"StatefulSet","apiVersion":"apps/v1","metadata":{"name":"rabbitmq-cluster-server","namespace":"default","selfLink":"/apis/apps/v1/namespaces/default/statefulsets/rabbitmq-cluster-server","uid":"f2f07f3e-b500-4c48-a5de-8db7eaf37b9a","resourceVersion":"1129","generation":1,"creationTimestamp":"2022-03-18T18:06:25Z","labels":{"app.kubernetes.io/component":"rabbitmq","app.kubernetes.io/name":"rabbitmq-cluster","app.kubernetes.io/part-of":"rabbitmq"},"annotations":{"rabbitmq.com/createdAt":"2022-03-18T18:06:25Z"},"ownerReferences":[{"apiVersion":"rabbitmq.com/v1beta1","kind":"RabbitmqCluster","name":"rabbitmq-cluster","uid":"3ecefa8a-1bec-48a7-9af4-dd0df3339101","controller":true,"blockOwnerDeletion":true}],"managedFields":[{"manager":"kube-controller-manager","operation":"Update","apiVersion":"apps/v1","time":"2022-03-18T18:06:25Z","fieldsType":"FieldsV1","fieldsV1":{"f:status":{"f:collisionCount":{},"f:currentReplicas":{},"f:currentRevision":{},"f:observedGeneration":{},"f:replicas":{},"f:updateRevision":{},"f:updatedReplicas":{}}}},{"manager":"manager","operation":"Update","apiVersion":"apps/v1","time":"2022-03-18T18:06:25Z","fieldsType":"FieldsV1","fieldsV1":{"f:metadata":{"f:annotations":{".":{},"f:rabbitmq.com/createdAt":{}},"f:labels":{".":{},"f:app.kubernetes.io/component":{},"f:app.kubernetes.io/name":{},"f:app.kubernetes.io/part-of":{}},"f:ownerReferences":{".":{},"k:{\"uid\":\"3ecefa8a-1bec-48a7-9af4-dd0df3339101\"}":{".":{},"f:apiVersion":{},"f:blockOwnerDeletion":{},"f:controller":{},"f:kind":{},"f:name":{},"f:uid":{}}}},"f:spec":{"f:podManagementPolicy":{},"f:replicas":{},"f:revisionHistoryLimit":{},"f:selector":{"f:matchLabels":{".":{},"f:app.kubernetes.io/name":{}}},"f:serviceName":{},"f:template":{"f:metadata":{"f:annotations":{".":{},"f:prometheus.io/port":{},"f:prometheus.io/scrape":{}},"f:labels":{".":{},"f:app.kubernetes.io/component":{},"f:app.kubernetes.io/name":{},"f:app.kubernetes.io/part-of":{}}},"f:spec":{"f:automountServiceAccountToken":{},"f:containers":{"k:{\"name\":\"rabbitmq\"}":{".":{},"f:env":{".":{},"k:{\"name\":\"K8S_HOSTNAME_SUFFIX\"}":{".":{},"f:name":{},"f:value":{}},"k:{\"name\":\"K8S_SERVICE_NAME\"}":{".":{},"f:name":{},"f:value":{}},"k:{\"name\":\"MY_POD_NAME\"}":{".":{},"f:name":{},"f:valueFrom":{".":{},"f:fieldRef":{".":{},"f:apiVersion":{},"f:fieldPath":{}}}},"k:{\"name\":\"MY_POD_NAMESPACE\"}":{".":{},"f:name":{},"f:valueFrom":{".":{},"f:fieldRef":{".":{},"f:apiVersion":{},"f:fieldPath":{}}}},"k:{\"name\":\"RABBITMQ_ENABLED_PLUGINS_FILE\"}":{".":{},"f:name":{},"f:value":{}},"k:{\"name\":\"RABBITMQ_NODENAME\"}":{".":{},"f:name":{},"f:value":{}},"k:{\"name\":\"RABBITMQ_USE_LONGNAME\"}":{".":{},"f:name":{},"f:value":{}}},"f:image":{},"f:imagePullPolicy":{},"f:lifecycle":{".":{},"f:preStop":{".":{},"f:exec":{".":{},"f:command":{}}}},"f:name":{},"f:ports":{".":{},"k:{\"containerPort\":4369,\"protocol\":\"TCP\"}":{".":{},"f:containerPort":{},"f:name":{},"f:protocol":{}},"k:{\"containerPort\":5672,\"protocol\":\"TCP\"}":{".":{},"f:containerPort":{},"f:name":{},"f:protocol":{}},"k:{\"containerPort\":15672,\"protocol\":\"TCP\"}":{".":{},"f:containerPort":{},"f:name":{},"f:protocol":{}},"k:{\"containerPort\":15692,\"protocol\":\"TCP\"}":{".":{},"f:containerPort":{},"f:name":{},"f:protocol":{}}},"f:readinessProbe":{".":{},"f:failureThreshold":{},"f:initialDelaySeconds":{},"f:periodSeconds":{},"f:successThreshold":{},"f:tcpSocket":{".":{},"f:port":{}},"f:timeoutSeconds":{}},"f:resources":{".":{},"f:limits":{".":{},"f:cpu":{},"f:memory":{}},"f:requests":{".":{},"f:cpu":{},"f:memory":{}}},"f:terminationMessagePath":{},"f:terminationMessagePolicy":{},"f:volumeMounts":{".":{},"k:{\"mountPath\":\"/etc/pod-info/\"}":{".":{},"f:mountPath":{},"f:name":{}},"k:{\"mountPath\":\"/etc/rabbitmq/conf.d/10-operatorDefaults.conf\"}":{".":{},"f:mountPath":{},"f:name":{},"f:subPath":{}},"k:{\"mountPath\":\"/etc/rabbitmq/conf.d/11-default_user.conf\"}":{".":{},"f:mountPath":{},"f:name":{},"f:subPath":{}},"k:{\"mountPath\":\"/etc/rabbitmq/conf.d/90-userDefinedConfiguration.conf\"}":{".":{},"f:mountPath":{},"f:name":{},"f:subPath":{}},"k:{\"mountPath\":\"/operator\"}":{".":{},"f:mountPath":{},"f:name":{}},"k:{\"mountPath\":\"/var/lib/rabbitmq/\"}":{".":{},"f:mountPath":{},"f:name":{}},"k:{\"mountPath\":\"/var/lib/rabbitmq/mnesia/\"}":{".":{},"f:mountPath":{},"f:name":{}}}}},"f:dnsPolicy":{},"f:initContainers":{".":{},"k:{\"name\":\"setup-container\"}":{".":{},"f:command":{},"f:image":{},"f:imagePullPolicy":{},"f:name":{},"f:resources":{".":{},"f:limits":{".":{},"f:cpu":{},"f:memory":{}},"f:requests":{".":{},"f:cpu":{},"f:memory":{}}},"f:securityContext":{".":{},"f:capabilities":{".":{},"f:drop":{}},"f:runAsUser":{}},"f:terminationMessagePath":{},"f:terminationMessagePolicy":{},"f:volumeMounts":{".":{},"k:{\"mountPath\":\"/operator\"}":{".":{},"f:mountPath":{},"f:name":{}},"k:{\"mountPath\":\"/tmp/default_user.conf\"}":{".":{},"f:mountPath":{},"f:name":{},"f:subPath":{}},"k:{\"mountPath\":\"/tmp/erlang-cookie-secret/\"}":{".":{},"f:mountPath":{},"f:name":{}},"k:{\"mountPath\":\"/tmp/rabbitmq-plugins/\"}":{".":{},"f:mountPath":{},"f:name":{}},"k:{\"mountPath\":\"/var/lib/rabbitmq/\"}":{".":{},"f:mountPath":{},"f:name":{}},"k:{\"mountPath\":\"/var/lib/rabbitmq/mnesia/\"}":{".":{},"f:mountPath":{},"f:name":{}}}}},"f:restartPolicy":{},"f:schedulerName":{},"f:securityContext":{".":{},"f:fsGroup":{},"f:runAsGroup":{},"f:runAsUser":{}},"f:serviceAccount":{},"f:serviceAccountName":{},"f:terminationGracePeriodSeconds":{},"f:topologySpreadConstraints":{".":{},"k:{\"topologyKey\":\"topology.kubernetes.io/zone\",\"whenUnsatisfiable\":\"ScheduleAnyway\"}":{".":{},"f:labelSelector":{".":{},"f:matchLabels":{".":{},"f:app.kubernetes.io/name":{}}},"f:maxSkew":{},"f:topologyKey":{},"f:whenUnsatisfiable":{}}},"f:volumes":{".":{},"k:{\"name\":\"erlang-cookie-secret\"}":{".":{},"f:name":{},"f:secret":{".":{},"f:defaultMode":{},"f:secretName":{}}},"k:{\"name\":\"plugins-conf\"}":{".":{},"f:configMap":{".":{},"f:defaultMode":{},"f:name":{}},"f:name":{}},"k:{\"name\":\"pod-info\"}":{".":{},"f:downwardAPI":{".":{},"f:defaultMode":{},"f:items":{}},"f:name":{}},"k:{\"name\":\"rabbitmq-confd\"}":{".":{},"f:name":{},"f:projected":{".":{},"f:defaultMode":{},"f:sources":{}}},"k:{\"name\":\"rabbitmq-erlang-cookie\"}":{".":{},"f:emptyDir":{},"f:name":{}},"k:{\"name\":\"rabbitmq-plugins\"}":{".":{},"f:emptyDir":{},"f:name":{}}}}},"f:updateStrategy":{"f:rollingUpdate":{".":{},"f:partition":{}},"f:type":{}},"f:volumeClaimTemplates":{}}}}]},"spec":{"replicas":1,"selector":{"matchLabels":{"app.kubernetes.io/name":"rabbitmq-cluster"}},"template":{"metadata":{"creationTimestamp":null,"labels":{"app.kubernetes.io/component":"rabbitmq","app.kubernetes.io/name":"rabbitmq-cluster","app.kubernetes.io/part-of":"rabbitmq"},"annotations":{"prometheus.io/port":"15692","prometheus.io/scrape":"true"}},"spec":{"volumes":[{"name":"plugins-conf","configMap":{"name":"rabbitmq-cluster-plugins-conf","defaultMode":420}},{"name":"rabbitmq-confd","projected":{"sources":[{"secret":{"name":"rabbitmq-cluster-default-user","items":[{"key":"default_user.conf","path":"default_user.conf"}]}},{"configMap":{"name":"rabbitmq-cluster-server-conf","items":[{"key":"operatorDefaults.conf","path":"operatorDefaults.conf"},{"key":"userDefinedConfiguration.conf","path":"userDefinedConfiguration.conf"}]}}],"defaultMode":420}},{"name":"rabbitmq-erlang-cookie","emptyDir":{}},{"name":"erlang-cookie-secret","secret":{"secretName":"rabbitmq-cluster-erlang-cookie","defaultMode":420}},{"name":"rabbitmq-plugins","emptyDir":{}},{"name":"pod-info","downwardAPI":{"items":[{"path":"skipPreStopChecks","fieldRef":{"apiVersion":"v1","fieldPath":"metadata.labels['skipPreStopChecks']"}}],"defaultMode":420}}],"initContainers":[{"name":"setup-container","image":"rabbitmq:3.8.12-management","command":["sh","-c","cp /tmp/erlang-cookie-secret/.erlang.cookie /var/lib/rabbitmq/.erlang.cookie \u0026\u0026 chown 999:999 /var/lib/rabbitmq/.erlang.cookie \u0026\u0026 chmod 600 /var/lib/rabbitmq/.erlang.cookie ; cp /tmp/rabbitmq-plugins/enabled_plugins /operator/enabled_plugins \u0026\u0026 chown 999:999 /operator/enabled_plugins ; chown 999:999 /var/lib/rabbitmq/mnesia/ ; echo '[default]' \u003e /var/lib/rabbitmq/.rabbitmqadmin.conf \u0026\u0026 sed -e 's/default_user/username/' -e 's/default_pass/password/' /tmp/default_user.conf \u003e\u003e /var/lib/rabbitmq/.rabbitmqadmin.conf \u0026\u0026 chown 999:999 /var/lib/rabbitmq/.rabbitmqadmin.conf \u0026\u0026 chmod 600 /var/lib/rabbitmq/.rabbitmqadmin.conf"],"resources":{"limits":{"cpu":"100m","memory":"500Mi"},"requests":{"cpu":"100m","memory":"500Mi"}},"volumeMounts":[{"name":"plugins-conf","mountPath":"/tmp/rabbitmq-plugins/"},{"name":"rabbitmq-erlang-cookie","mountPath":"/var/lib/rabbitmq/"},{"name":"erlang-cookie-secret","mountPath":"/tmp/erlang-cookie-secret/"},{"name":"rabbitmq-plugins","mountPath":"/operator"},{"name":"persistence","mountPath":"/var/lib/rabbitmq/mnesia/"},{"name":"rabbitmq-confd","mountPath":"/tmp/default_user.conf","subPath":"default_user.conf"}],"terminationMessagePath":"/dev/termination-log","terminationMessagePolicy":"File","imagePullPolicy":"IfNotPresent","securityContext":{"capabilities":{"drop":["FSETID","KILL","SETGID","SETUID","SETPCAP","NET_BIND_SERVICE","NET_RAW","SYS_CHROOT","MKNOD","AUDIT_WRITE","SETFCAP"]},"runAsUser":0}}],"containers":[{"name":"rabbitmq","image":"rabbitmq:3.8.12-management","ports":[{"name":"epmd","containerPort":4369,"protocol":"TCP"},{"name":"amqp","containerPort":5672,"protocol":"TCP"},{"name":"management","containerPort":15672,"protocol":"TCP"},{"name":"prometheus","containerPort":15692,"protocol":"TCP"}],"env":[{"name":"MY_POD_NAME","valueFrom":{"fieldRef":{"apiVersion":"v1","fieldPath":"metadata.name"}}},{"name":"MY_POD_NAMESPACE","valueFrom":{"fieldRef":{"apiVersion":"v1","fieldPath":"metadata.namespace"}}},{"name":"RABBITMQ_ENABLED_PLUGINS_FILE","value":"/operator/enabled_plugins"},{"name":"K8S_SERVICE_NAME","value":"rabbitmq-cluster-nodes"},{"name":"RABBITMQ_USE_LONGNAME","value":"true"},{"name":"RABBITMQ_NODENAME","value":"rabbit@$(MY_POD_NAME).$(K8S_SERVICE_NAME).$(MY_POD_NAMESPACE)"},{"name":"K8S_HOSTNAME_SUFFIX","value":".$(K8S_SERVICE_NAME).$(MY_POD_NAMESPACE)"}],"resources":{"limits":{"cpu":"2","memory":"2Gi"},"requests":{"cpu":"1","memory":"2Gi"}},"volumeMounts":[{"name":"rabbitmq-erlang-cookie","mountPath":"/var/lib/rabbitmq/"},{"name":"persistence","mountPath":"/var/lib/rabbitmq/mnesia/"},{"name":"rabbitmq-plugins","mountPath":"/operator"},{"name":"rabbitmq-confd","mountPath":"/etc/rabbitmq/conf.d/10-operatorDefaults.conf","subPath":"operatorDefaults.conf"},{"name":"rabbitmq-confd","mountPath":"/etc/rabbitmq/conf.d/11-default_user.conf","subPath":"default_user.conf"},{"name":"rabbitmq-confd","mountPath":"/etc/rabbitmq/conf.d/90-userDefinedConfiguration.conf","subPath":"userDefinedConfiguration.conf"},{"name":"pod-info","mountPath":"/etc/pod-info/"}],"readinessProbe":{"tcpSocket":{"port":"amqp"},"initialDelaySeconds":10,"timeoutSeconds":5,"periodSeconds":10,"successThreshold":1,"failureThreshold":3},"lifecycle":{"preStop":{"exec":{"command":["/bin/bash","-c","if [ ! -z \"$(cat /etc/pod-info/skipPreStopChecks)\" ]; then exit 0; fi; rabbitmq-upgrade await_online_quorum_plus_one -t 604800; rabbitmq-upgrade await_online_synchronized_mirror -t 604800; rabbitmq-upgrade drain -t 604800"]}}},"terminationMessagePath":"/dev/termination-log","terminationMessagePolicy":"File","imagePullPolicy":"IfNotPresent"}],"restartPolicy":"Always","terminationGracePeriodSeconds":604800,"dnsPolicy":"ClusterFirst","serviceAccountName":"rabbitmq-cluster-server","serviceAccount":"rabbitmq-cluster-server","automountServiceAccountToken":true,"securityContext":{"runAsUser":999,"runAsGroup":999,"fsGroup":999},"schedulerName":"default-scheduler","topologySpreadConstraints":[{"maxSkew":1,"topologyKey":"topology.kubernetes.io/zone","whenUnsatisfiable":"ScheduleAnyway","labelSelector":{"matchLabels":{"app.kubernetes.io/name":"rabbitmq-cluster"}}}]}},"volumeClaimTemplates":[{"metadata":{"name":"persistence","namespace":"default","creationTimestamp":null,"labels":{"app.kubernetes.io/component":"rabbitmq","app.kubernetes.io/name":"rabbitmq-cluster","app.kubernetes.io/part-of":"rabbitmq"},"ownerReferences":[{"apiVersion":"rabbitmq.com/v1beta1","kind":"RabbitmqCluster","name":"rabbitmq-cluster","uid":"3ecefa8a-1bec-48a7-9af4-dd0df3339101","controller":true,"blockOwnerDeletion":false}]},"spec":{"accessModes":["ReadWriteOnce"],"resources":{"requests":{"storage":"10Gi"}},"volumeMode":"Filesystem"},"status":{"phase":"Pending"}}],"serviceName":"rabbitmq-cluster-nodes","podManagementPolicy":"Parallel","updateStrategy":{"type":"RollingUpdate","rollingUpdate":{"partition":0}},"revisionHistoryLimit":10},"status":{"observedGeneration":1,"replicas":1,"currentReplicas":1,"updatedReplicas":1,"currentRevision":"rabbitmq-cluster-server-5f8b8665fb","updateRevision":"rabbitmq-cluster-server-5f8b8665fb","collisionCount":0}}
2022/03/18 18:06:25 learn_server.go:291: [SIEVE-AFTER-READ]	Get	true	endpoints	default	rabbitmq-cluster	github.com/rabbitmq/cluster-operator/controllers.(*RabbitmqClusterReconciler)	NoError	{"kind":"Endpoints","apiVersion":"v1","metadata":{"name":"rabbitmq-cluster","namespace":"default","selfLink":"/api/v1/namespaces/default/endpoints/rabbitmq-cluster","uid":"eeba9576-0362-4e74-aafd-71e4ffe98d25","resourceVersion":"1087","creationTimestamp":"2022-03-18T18:06:25Z","labels":{"app.kubernetes.io/component":"rabbitmq","app.kubernetes.io/name":"rabbitmq-cluster","app.kubernetes.io/part-of":"rabbitmq"},"annotations":{"endpoints.kubernetes.io/last-change-trigger-time":"2022-03-18T18:06:25Z"},"managedFields":[{"manager":"kube-controller-manager","operation":"Update","apiVersion":"v1","time":"2022-03-18T18:06:25Z","fieldsType":"FieldsV1","fieldsV1":{"f:metadata":{"f:annotations":{".":{},"f:endpoints.kubernetes.io/last-change-trigger-time":{}},"f:labels":{".":{},"f:app.kubernetes.io/component":{},"f:app.kubernetes.io/name":{},"f:app.kubernetes.io/part-of":{}}}}}]}}
2022/03/18 18:06:25 learn_server.go:256: [SIEVE-BEFORE-WRITE]	15
2022/03/18 18:06:25 learn_server.go:279: [SIEVE-BEFORE-HEAR]	17	Updated	rabbitmqcluster	{"metadata":{"name":"rabbitmq-cluster","namespace":"default","selfLink":"/apis/rabbitmq.com/v1beta1/namespaces/default/rabbitmqclusters/rabbitmq-cluster","uid":"3ecefa8a-1bec-48a7-9af4-dd0df3339101","resourceVersion":"1132","generation":2,"creationTimestamp":"2022-03-18T18:06:25Z","annotations":{"kubectl.kubernetes.io/last-applied-configuration":"{\"apiVersion\":\"rabbitmq.com/v1beta1\",\"kind\":\"RabbitmqCluster\",\"metadata\":{\"annotations\":{},\"name\":\"rabbitmq-cluster\",\"namespace\":\"default\"},\"spec\":{\"persistence\":{\"storage\":\"10Gi\"},\"replicas\":1}}\n"},"finalizers":["deletion.finalizers.rabbitmqclusters.rabbitmq.com"],"managedFields":[{"manager":"kubectl-client-side-apply","operation":"Update","apiVersion":"rabbitmq.com/v1beta1","time":"2022-03-18T18:06:25Z","fieldsType":"FieldsV1","fieldsV1":{"f:metadata":{"f:annotations":{".":{},"f:kubectl.kubernetes.io/last-applied-configuration":{}}},"f:spec":{".":{},"f:image":{},"f:persistence":{".":{},"f:storage":{}},"f:replicas":{},"f:resources":{".":{},"f:limits":{".":{},"f:memory":{}},"f:requests":{".":{},"f:memory":{}}},"f:service":{".":{},"f:type":{}},"f:terminationGracePeriodSeconds":{}}}},{"manager":"manager","operation":"Update","apiVersion":"rabbitmq.com/v1beta1","time":"2022-03-18T18:06:25Z","fieldsType":"FieldsV1","fieldsV1":{"f:metadata":{"f:finalizers":{}},"f:spec":{"f:override":{},"f:rabbitmq":{},"f:resources":{"f:limits":{"f:cpu":{}},"f:requests":{"f:cpu":{}}},"f:tls":{}},"f:status":{".":{},"f:conditions":{},"f:defaultUser":{".":{},"f:secretReference":{".":{},"f:keys":{".":{},"f:password":{},"f:username":{}},"f:name":{},"f:namespace":{}},"f:serviceReference":{".":{},"f:name":{},"f:namespace":{}}}}}}]},"spec":{"replicas":1,"image":"rabbitmq:3.8.12-management","service":{"type":"ClusterIP"},"persistence":{"storage":"10Gi"},"resources":{"limits":{"cpu":"2","memory":"2Gi"},"requests":{"cpu":"1","memory":"2Gi"}},"rabbitmq":{},"tls":{},"override":{},"terminationGracePeriodSeconds":604800},"status":{"conditions":[{"type":"AllReplicasReady","status":"False","lastTransitionTime":"2022-03-18T18:06:25Z","reason":"NotAllPodsReady","message":"0/1 Pods ready"},{"type":"ClusterAvailable","status":"False","lastTransitionTime":"2022-03-18T18:06:25Z","reason":"NoEndpointsAvailable","message":"The service has no endpoints available"},{"type":"NoWarnings","status":"True","lastTransitionTime":"2022-03-18T18:06:25Z","reason":"NoWarnings"},{"type":"ReconcileSuccess","status":"Unknown","lastTransitionTime":"2022-03-18T18:06:25Z","reason":"Initialising"}],"defaultUser":{"secretReference":{"name":"rabbitmq-cluster-default-user","namespace":"default","keys":{"password":"password","username":"username"}},"serviceReference":{"name":"rabbitmq-cluster","namespace":"default"}}}}
2022/03/18 18:06:25 learn_server.go:263: [SIEVE-AFTER-WRITE]	15	StatusUpdate	rabbitmqcluster	github.com/rabbitmq/cluster-operator/controllers.(*RabbitmqClusterReconciler)	NoError	{"metadata":{"name":"rabbitmq-cluster","namespace":"default","selfLink":"/apis/rabbitmq.com/v1beta1/namespaces/default/rabbitmqclusters/rabbitmq-cluster/status","uid":"3ecefa8a-1bec-48a7-9af4-dd0df3339101","resourceVersion":"1132","generation":2,"creationTimestamp":"2022-03-18T18:06:25Z","annotations":{"kubectl.kubernetes.io/last-applied-configuration":"{\"apiVersion\":\"rabbitmq.com/v1beta1\",\"kind\":\"RabbitmqCluster\",\"metadata\":{\"annotations\":{},\"name\":\"rabbitmq-cluster\",\"namespace\":\"default\"},\"spec\":{\"persistence\":{\"storage\":\"10Gi\"},\"replicas\":1}}\n"},"finalizers":["deletion.finalizers.rabbitmqclusters.rabbitmq.com"],"managedFields":[{"manager":"kubectl-client-side-apply","operation":"Update","apiVersion":"rabbitmq.com/v1beta1","time":"2022-03-18T18:06:25Z","fieldsType":"FieldsV1","fieldsV1":{"f:metadata":{"f:annotations":{".":{},"f:kubectl.kubernetes.io/last-applied-configuration":{}}},"f:spec":{".":{},"f:image":{},"f:persistence":{".":{},"f:storage":{}},"f:replicas":{},"f:resources":{".":{},"f:limits":{".":{},"f:memory":{}},"f:requests":{".":{},"f:memory":{}}},"f:service":{".":{},"f:type":{}},"f:terminationGracePeriodSeconds":{}}}},{"manager":"manager","operation":"Update","apiVersion":"rabbitmq.com/v1beta1","time":"2022-03-18T18:06:25Z","fieldsType":"FieldsV1","fieldsV1":{"f:metadata":{"f:finalizers":{}},"f:spec":{"f:override":{},"f:rabbitmq":{},"f:resources":{"f:limits":{"f:cpu":{}},"f:requests":{"f:cpu":{}}},"f:tls":{}},"f:status":{".":{},"f:conditions":{},"f:defaultUser":{".":{},"f:secretReference":{".":{},"f:keys":{".":{},"f:password":{},"f:username":{}},"f:name":{},"f:namespace":{}},"f:serviceReference":{".":{},"f:name":{},"f:namespace":{}}}}}}]},"spec":{"replicas":1,"image":"rabbitmq:3.8.12-management","service":{"type":"ClusterIP"},"persistence":{"storage":"10Gi"},"resources":{"limits":{"cpu":"2","memory":"2Gi"},"requests":{"cpu":"1","memory":"2Gi"}},"rabbitmq":{},"tls":{},"override":{},"terminationGracePeriodSeconds":604800},"status":{"conditions":[{"type":"AllReplicasReady","status":"False","lastTransitionTime":"2022-03-18T18:06:25Z","reason":"NotAllPodsReady","message":"0/1 Pods ready"},{"type":"ClusterAvailable","status":"False","lastTransitionTime":"2022-03-18T18:06:25Z","reason":"NoEndpointsAvailable","message":"The service has no endpoints available"},{"type":"NoWarnings","status":"True","lastTransitionTime":"2022-03-18T18:06:25Z","reason":"NoWarnings"},{"type":"ReconcileSuccess","status":"Unknown","lastTransitionTime":"2022-03-18T18:06:25Z","reason":"Initialising"}],"defaultUser":{"secretReference":{"name":"rabbitmq-cluster-default-user","namespace":"default","keys":{"password":"password","username":"username"}},"serviceReference":{"name":"rabbitmq-cluster","namespace":"default"}}}}
2022/03/18 18:06:25 learn_server.go:289: [SIEVE-AFTER-HEAR]	17
2022/03/18 18:06:25 learn_server.go:291: [SIEVE-AFTER-READ]	Get	true	statefulset	default	rabbitmq-cluster-server	github.com/rabbitmq/cluster-operator/controllers.(*RabbitmqClusterReconciler)	NoError	{"kind":"StatefulSet","apiVersion":"apps/v1","metadata":{"name":"rabbitmq-cluster-server","namespace":"default","selfLink":"/apis/apps/v1/namespaces/default/statefulsets/rabbitmq-cluster-server","uid":"f2f07f3e-b500-4c48-a5de-8db7eaf37b9a","resourceVersion":"1129","generation":1,"creationTimestamp":"2022-03-18T18:06:25Z","labels":{"app.kubernetes.io/component":"rabbitmq","app.kubernetes.io/name":"rabbitmq-cluster","app.kubernetes.io/part-of":"rabbitmq"},"annotations":{"rabbitmq.com/createdAt":"2022-03-18T18:06:25Z"},"ownerReferences":[{"apiVersion":"rabbitmq.com/v1beta1","kind":"RabbitmqCluster","name":"rabbitmq-cluster","uid":"3ecefa8a-1bec-48a7-9af4-dd0df3339101","controller":true,"blockOwnerDeletion":true}],"managedFields":[{"manager":"kube-controller-manager","operation":"Update","apiVersion":"apps/v1","time":"2022-03-18T18:06:25Z","fieldsType":"FieldsV1","fieldsV1":{"f:status":{"f:collisionCount":{},"f:currentReplicas":{},"f:currentRevision":{},"f:observedGeneration":{},"f:replicas":{},"f:updateRevision":{},"f:updatedReplicas":{}}}},{"manager":"manager","operation":"Update","apiVersion":"apps/v1","time":"2022-03-18T18:06:25Z","fieldsType":"FieldsV1","fieldsV1":{"f:metadata":{"f:annotations":{".":{},"f:rabbitmq.com/createdAt":{}},"f:labels":{".":{},"f:app.kubernetes.io/component":{},"f:app.kubernetes.io/name":{},"f:app.kubernetes.io/part-of":{}},"f:ownerReferences":{".":{},"k:{\"uid\":\"3ecefa8a-1bec-48a7-9af4-dd0df3339101\"}":{".":{},"f:apiVersion":{},"f:blockOwnerDeletion":{},"f:controller":{},"f:kind":{},"f:name":{},"f:uid":{}}}},"f:spec":{"f:podManagementPolicy":{},"f:replicas":{},"f:revisionHistoryLimit":{},"f:selector":{"f:matchLabels":{".":{},"f:app.kubernetes.io/name":{}}},"f:serviceName":{},"f:template":{"f:metadata":{"f:annotations":{".":{},"f:prometheus.io/port":{},"f:prometheus.io/scrape":{}},"f:labels":{".":{},"f:app.kubernetes.io/component":{},"f:app.kubernetes.io/name":{},"f:app.kubernetes.io/part-of":{}}},"f:spec":{"f:automountServiceAccountToken":{},"f:containers":{"k:{\"name\":\"rabbitmq\"}":{".":{},"f:env":{".":{},"k:{\"name\":\"K8S_HOSTNAME_SUFFIX\"}":{".":{},"f:name":{},"f:value":{}},"k:{\"name\":\"K8S_SERVICE_NAME\"}":{".":{},"f:name":{},"f:value":{}},"k:{\"name\":\"MY_POD_NAME\"}":{".":{},"f:name":{},"f:valueFrom":{".":{},"f:fieldRef":{".":{},"f:apiVersion":{},"f:fieldPath":{}}}},"k:{\"name\":\"MY_POD_NAMESPACE\"}":{".":{},"f:name":{},"f:valueFrom":{".":{},"f:fieldRef":{".":{},"f:apiVersion":{},"f:fieldPath":{}}}},"k:{\"name\":\"RABBITMQ_ENABLED_PLUGINS_FILE\"}":{".":{},"f:name":{},"f:value":{}},"k:{\"name\":\"RABBITMQ_NODENAME\"}":{".":{},"f:name":{},"f:value":{}},"k:{\"name\":\"RABBITMQ_USE_LONGNAME\"}":{".":{},"f:name":{},"f:value":{}}},"f:image":{},"f:imagePullPolicy":{},"f:lifecycle":{".":{},"f:preStop":{".":{},"f:exec":{".":{},"f:command":{}}}},"f:name":{},"f:ports":{".":{},"k:{\"containerPort\":4369,\"protocol\":\"TCP\"}":{".":{},"f:containerPort":{},"f:name":{},"f:protocol":{}},"k:{\"containerPort\":5672,\"protocol\":\"TCP\"}":{".":{},"f:containerPort":{},"f:name":{},"f:protocol":{}},"k:{\"containerPort\":15672,\"protocol\":\"TCP\"}":{".":{},"f:containerPort":{},"f:name":{},"f:protocol":{}},"k:{\"containerPort\":15692,\"protocol\":\"TCP\"}":{".":{},"f:containerPort":{},"f:name":{},"f:protocol":{}}},"f:readinessProbe":{".":{},"f:failureThreshold":{},"f:initialDelaySeconds":{},"f:periodSeconds":{},"f:successThreshold":{},"f:tcpSocket":{".":{},"f:port":{}},"f:timeoutSeconds":{}},"f:resources":{".":{},"f:limits":{".":{},"f:cpu":{},"f:memory":{}},"f:requests":{".":{},"f:cpu":{},"f:memory":{}}},"f:terminationMessagePath":{},"f:terminationMessagePolicy":{},"f:volumeMounts":{".":{},"k:{\"mountPath\":\"/etc/pod-info/\"}":{".":{},"f:mountPath":{},"f:name":{}},"k:{\"mountPath\":\"/etc/rabbitmq/conf.d/10-operatorDefaults.conf\"}":{".":{},"f:mountPath":{},"f:name":{},"f:subPath":{}},"k:{\"mountPath\":\"/etc/rabbitmq/conf.d/11-default_user.conf\"}":{".":{},"f:mountPath":{},"f:name":{},"f:subPath":{}},"k:{\"mountPath\":\"/etc/rabbitmq/conf.d/90-userDefinedConfiguration.conf\"}":{".":{},"f:mountPath":{},"f:name":{},"f:subPath":{}},"k:{\"mountPath\":\"/operator\"}":{".":{},"f:mountPath":{},"f:name":{}},"k:{\"mountPath\":\"/var/lib/rabbitmq/\"}":{".":{},"f:mountPath":{},"f:name":{}},"k:{\"mountPath\":\"/var/lib/rabbitmq/mnesia/\"}":{".":{},"f:mountPath":{},"f:name":{}}}}},"f:dnsPolicy":{},"f:initContainers":{".":{},"k:{\"name\":\"setup-container\"}":{".":{},"f:command":{},"f:image":{},"f:imagePullPolicy":{},"f:name":{},"f:resources":{".":{},"f:limits":{".":{},"f:cpu":{},"f:memory":{}},"f:requests":{".":{},"f:cpu":{},"f:memory":{}}},"f:securityContext":{".":{},"f:capabilities":{".":{},"f:drop":{}},"f:runAsUser":{}},"f:terminationMessagePath":{},"f:terminationMessagePolicy":{},"f:volumeMounts":{".":{},"k:{\"mountPath\":\"/operator\"}":{".":{},"f:mountPath":{},"f:name":{}},"k:{\"mountPath\":\"/tmp/default_user.conf\"}":{".":{},"f:mountPath":{},"f:name":{},"f:subPath":{}},"k:{\"mountPath\":\"/tmp/erlang-cookie-secret/\"}":{".":{},"f:mountPath":{},"f:name":{}},"k:{\"mountPath\":\"/tmp/rabbitmq-plugins/\"}":{".":{},"f:mountPath":{},"f:name":{}},"k:{\"mountPath\":\"/var/lib/rabbitmq/\"}":{".":{},"f:mountPath":{},"f:name":{}},"k:{\"mountPath\":\"/var/lib/rabbitmq/mnesia/\"}":{".":{},"f:mountPath":{},"f:name":{}}}}},"f:restartPolicy":{},"f:schedulerName":{},"f:securityContext":{".":{},"f:fsGroup":{},"f:runAsGroup":{},"f:runAsUser":{}},"f:serviceAccount":{},"f:serviceAccountName":{},"f:terminationGracePeriodSeconds":{},"f:topologySpreadConstraints":{".":{},"k:{\"topologyKey\":\"topology.kubernetes.io/zone\",\"whenUnsatisfiable\":\"ScheduleAnyway\"}":{".":{},"f:labelSelector":{".":{},"f:matchLabels":{".":{},"f:app.kubernetes.io/name":{}}},"f:maxSkew":{},"f:topologyKey":{},"f:whenUnsatisfiable":{}}},"f:volumes":{".":{},"k:{\"name\":\"erlang-cookie-secret\"}":{".":{},"f:name":{},"f:secret":{".":{},"f:defaultMode":{},"f:secretName":{}}},"k:{\"name\":\"plugins-conf\"}":{".":{},"f:configMap":{".":{},"f:defaultMode":{},"f:name":{}},"f:name":{}},"k:{\"name\":\"pod-info\"}":{".":{},"f:downwardAPI":{".":{},"f:defaultMode":{},"f:items":{}},"f:name":{}},"k:{\"name\":\"rabbitmq-confd\"}":{".":{},"f:name":{},"f:projected":{".":{},"f:defaultMode":{},"f:sources":{}}},"k:{\"name\":\"rabbitmq-erlang-cookie\"}":{".":{},"f:emptyDir":{},"f:name":{}},"k:{\"name\":\"rabbitmq-plugins\"}":{".":{},"f:emptyDir":{},"f:name":{}}}}},"f:updateStrategy":{"f:rollingUpdate":{".":{},"f:partition":{}},"f:type":{}},"f:volumeClaimTemplates":{}}}}]},"spec":{"replicas":1,"selector":{"matchLabels":{"app.kubernetes.io/name":"rabbitmq-cluster"}},"template":{"metadata":{"creationTimestamp":null,"labels":{"app.kubernetes.io/component":"rabbitmq","app.kubernetes.io/name":"rabbitmq-cluster","app.kubernetes.io/part-of":"rabbitmq"},"annotations":{"prometheus.io/port":"15692","prometheus.io/scrape":"true"}},"spec":{"volumes":[{"name":"plugins-conf","configMap":{"name":"rabbitmq-cluster-plugins-conf","defaultMode":420}},{"name":"rabbitmq-confd","projected":{"sources":[{"secret":{"name":"rabbitmq-cluster-default-user","items":[{"key":"default_user.conf","path":"default_user.conf"}]}},{"configMap":{"name":"rabbitmq-cluster-server-conf","items":[{"key":"operatorDefaults.conf","path":"operatorDefaults.conf"},{"key":"userDefinedConfiguration.conf","path":"userDefinedConfiguration.conf"}]}}],"defaultMode":420}},{"name":"rabbitmq-erlang-cookie","emptyDir":{}},{"name":"erlang-cookie-secret","secret":{"secretName":"rabbitmq-cluster-erlang-cookie","defaultMode":420}},{"name":"rabbitmq-plugins","emptyDir":{}},{"name":"pod-info","downwardAPI":{"items":[{"path":"skipPreStopChecks","fieldRef":{"apiVersion":"v1","fieldPath":"metadata.labels['skipPreStopChecks']"}}],"defaultMode":420}}],"initContainers":[{"name":"setup-container","image":"rabbitmq:3.8.12-management","command":["sh","-c","cp /tmp/erlang-cookie-secret/.erlang.cookie /var/lib/rabbitmq/.erlang.cookie \u0026\u0026 chown 999:999 /var/lib/rabbitmq/.erlang.cookie \u0026\u0026 chmod 600 /var/lib/rabbitmq/.erlang.cookie ; cp /tmp/rabbitmq-plugins/enabled_plugins /operator/enabled_plugins \u0026\u0026 chown 999:999 /operator/enabled_plugins ; chown 999:999 /var/lib/rabbitmq/mnesia/ ; echo '[default]' \u003e /var/lib/rabbitmq/.rabbitmqadmin.conf \u0026\u0026 sed -e 's/default_user/username/' -e 's/default_pass/password/' /tmp/default_user.conf \u003e\u003e /var/lib/rabbitmq/.rabbitmqadmin.conf \u0026\u0026 chown 999:999 /var/lib/rabbitmq/.rabbitmqadmin.conf \u0026\u0026 chmod 600 /var/lib/rabbitmq/.rabbitmqadmin.conf"],"resources":{"limits":{"cpu":"100m","memory":"500Mi"},"requests":{"cpu":"100m","memory":"500Mi"}},"volumeMounts":[{"name":"plugins-conf","mountPath":"/tmp/rabbitmq-plugins/"},{"name":"rabbitmq-erlang-cookie","mountPath":"/var/lib/rabbitmq/"},{"name":"erlang-cookie-secret","mountPath":"/tmp/erlang-cookie-secret/"},{"name":"rabbitmq-plugins","mountPath":"/operator"},{"name":"persistence","mountPath":"/var/lib/rabbitmq/mnesia/"},{"name":"rabbitmq-confd","mountPath":"/tmp/default_user.conf","subPath":"default_user.conf"}],"terminationMessagePath":"/dev/termination-log","terminationMessagePolicy":"File","imagePullPolicy":"IfNotPresent","securityContext":{"capabilities":{"drop":["FSETID","KILL","SETGID","SETUID","SETPCAP","NET_BIND_SERVICE","NET_RAW","SYS_CHROOT","MKNOD","AUDIT_WRITE","SETFCAP"]},"runAsUser":0}}],"containers":[{"name":"rabbitmq","image":"rabbitmq:3.8.12-management","ports":[{"name":"epmd","containerPort":4369,"protocol":"TCP"},{"name":"amqp","containerPort":5672,"protocol":"TCP"},{"name":"management","containerPort":15672,"protocol":"TCP"},{"name":"prometheus","containerPort":15692,"protocol":"TCP"}],"env":[{"name":"MY_POD_NAME","valueFrom":{"fieldRef":{"apiVersion":"v1","fieldPath":"metadata.name"}}},{"name":"MY_POD_NAMESPACE","valueFrom":{"fieldRef":{"apiVersion":"v1","fieldPath":"metadata.namespace"}}},{"name":"RABBITMQ_ENABLED_PLUGINS_FILE","value":"/operator/enabled_plugins"},{"name":"K8S_SERVICE_NAME","value":"rabbitmq-cluster-nodes"},{"name":"RABBITMQ_USE_LONGNAME","value":"true"},{"name":"RABBITMQ_NODENAME","value":"rabbit@$(MY_POD_NAME).$(K8S_SERVICE_NAME).$(MY_POD_NAMESPACE)"},{"name":"K8S_HOSTNAME_SUFFIX","value":".$(K8S_SERVICE_NAME).$(MY_POD_NAMESPACE)"}],"resources":{"limits":{"cpu":"2","memory":"2Gi"},"requests":{"cpu":"1","memory":"2Gi"}},"volumeMounts":[{"name":"rabbitmq-erlang-cookie","mountPath":"/var/lib/rabbitmq/"},{"name":"persistence","mountPath":"/var/lib/rabbitmq/mnesia/"},{"name":"rabbitmq-plugins","mountPath":"/operator"},{"name":"rabbitmq-confd","mountPath":"/etc/rabbitmq/conf.d/10-operatorDefaults.conf","subPath":"operatorDefaults.conf"},{"name":"rabbitmq-confd","mountPath":"/etc/rabbitmq/conf.d/11-default_user.conf","subPath":"default_user.conf"},{"name":"rabbitmq-confd","mountPath":"/etc/rabbitmq/conf.d/90-userDefinedConfiguration.conf","subPath":"userDefinedConfiguration.conf"},{"name":"pod-info","mountPath":"/etc/pod-info/"}],"readinessProbe":{"tcpSocket":{"port":"amqp"},"initialDelaySeconds":10,"timeoutSeconds":5,"periodSeconds":10,"successThreshold":1,"failureThreshold":3},"lifecycle":{"preStop":{"exec":{"command":["/bin/bash","-c","if [ ! -z \"$(cat /etc/pod-info/skipPreStopChecks)\" ]; then exit 0; fi; rabbitmq-upgrade await_online_quorum_plus_one -t 604800; rabbitmq-upgrade await_online_synchronized_mirror -t 604800; rabbitmq-upgrade drain -t 604800"]}}},"terminationMessagePath":"/dev/termination-log","terminationMessagePolicy":"File","imagePullPolicy":"IfNotPresent"}],"restartPolicy":"Always","terminationGracePeriodSeconds":604800,"dnsPolicy":"ClusterFirst","serviceAccountName":"rabbitmq-cluster-server","serviceAccount":"rabbitmq-cluster-server","automountServiceAccountToken":true,"securityContext":{"runAsUser":999,"runAsGroup":999,"fsGroup":999},"schedulerName":"default-scheduler","topologySpreadConstraints":[{"maxSkew":1,"topologyKey":"topology.kubernetes.io/zone","whenUnsatisfiable":"ScheduleAnyway","labelSelector":{"matchLabels":{"app.kubernetes.io/name":"rabbitmq-cluster"}}}]}},"volumeClaimTemplates":[{"metadata":{"name":"persistence","namespace":"default","creationTimestamp":null,"labels":{"app.kubernetes.io/component":"rabbitmq","app.kubernetes.io/name":"rabbitmq-cluster","app.kubernetes.io/part-of":"rabbitmq"},"ownerReferences":[{"apiVersion":"rabbitmq.com/v1beta1","kind":"RabbitmqCluster","name":"rabbitmq-cluster","uid":"3ecefa8a-1bec-48a7-9af4-dd0df3339101","controller":true,"blockOwnerDeletion":false}]},"spec":{"accessModes":["ReadWriteOnce"],"resources":{"requests":{"storage":"10Gi"}},"volumeMode":"Filesystem"},"status":{"phase":"Pending"}}],"serviceName":"rabbitmq-cluster-nodes","podManagementPolicy":"Parallel","updateStrategy":{"type":"RollingUpdate","rollingUpdate":{"partition":0}},"revisionHistoryLimit":10},"status":{"observedGeneration":1,"replicas":1,"currentReplicas":1,"updatedReplicas":1,"currentRevision":"rabbitmq-cluster-server-5f8b8665fb","updateRevision":"rabbitmq-cluster-server-5f8b8665fb","collisionCount":0}}
2022/03/18 18:06:25 learn_server.go:291: [SIEVE-AFTER-READ]	Get	true	service	default	rabbitmq-cluster-nodes	github.com/rabbitmq/cluster-operator/controllers.(*RabbitmqClusterReconciler)	NoError	{"kind":"Service","apiVersion":"v1","metadata":{"name":"rabbitmq-cluster-nodes","namespace":"default","selfLink":"/api/v1/namespaces/default/services/rabbitmq-cluster-nodes","uid":"f843e1c2-ced0-463d-87c1-0e127aaa2006","resourceVersion":"1080","creationTimestamp":"2022-03-18T18:06:25Z","labels":{"app.kubernetes.io/component":"rabbitmq","app.kubernetes.io/name":"rabbitmq-cluster","app.kubernetes.io/part-of":"rabbitmq"},"ownerReferences":[{"apiVersion":"rabbitmq.com/v1beta1","kind":"RabbitmqCluster","name":"rabbitmq-cluster","uid":"3ecefa8a-1bec-48a7-9af4-dd0df3339101","controller":true,"blockOwnerDeletion":true}],"managedFields":[{"manager":"manager","operation":"Update","apiVersion":"v1","time":"2022-03-18T18:06:25Z","fieldsType":"FieldsV1","fieldsV1":{"f:metadata":{"f:labels":{".":{},"f:app.kubernetes.io/component":{},"f:app.kubernetes.io/name":{},"f:app.kubernetes.io/part-of":{}},"f:ownerReferences":{".":{},"k:{\"uid\":\"3ecefa8a-1bec-48a7-9af4-dd0df3339101\"}":{".":{},"f:apiVersion":{},"f:blockOwnerDeletion":{},"f:controller":{},"f:kind":{},"f:name":{},"f:uid":{}}}},"f:spec":{"f:clusterIP":{},"f:ports":{".":{},"k:{\"port\":4369,\"protocol\":\"TCP\"}":{".":{},"f:name":{},"f:port":{},"f:protocol":{},"f:targetPort":{}},"k:{\"port\":25672,\"protocol\":\"TCP\"}":{".":{},"f:name":{},"f:port":{},"f:protocol":{},"f:targetPort":{}}},"f:publishNotReadyAddresses":{},"f:selector":{".":{},"f:app.kubernetes.io/name":{}},"f:sessionAffinity":{},"f:type":{}}}}]},"spec":{"ports":[{"name":"epmd","protocol":"TCP","port":4369,"targetPort":4369},{"name":"cluster-rpc","protocol":"TCP","port":25672,"targetPort":25672}],"selector":{"app.kubernetes.io/name":"rabbitmq-cluster"},"clusterIP":"None","type":"ClusterIP","sessionAffinity":"None","publishNotReadyAddresses":true},"status":{"loadBalancer":{}}}
2022/03/18 18:06:25 learn_server.go:291: [SIEVE-AFTER-READ]	Get	true	service	default	rabbitmq-cluster	github.com/rabbitmq/cluster-operator/controllers.(*RabbitmqClusterReconciler)	NoError	{"kind":"Service","apiVersion":"v1","metadata":{"name":"rabbitmq-cluster","namespace":"default","selfLink":"/api/v1/namespaces/default/services/rabbitmq-cluster","uid":"ae846a70-784e-49ca-99a0-2b0cefb93b46","resourceVersion":"1085","creationTimestamp":"2022-03-18T18:06:25Z","labels":{"app.kubernetes.io/component":"rabbitmq","app.kubernetes.io/name":"rabbitmq-cluster","app.kubernetes.io/part-of":"rabbitmq"},"ownerReferences":[{"apiVersion":"rabbitmq.com/v1beta1","kind":"RabbitmqCluster","name":"rabbitmq-cluster","uid":"3ecefa8a-1bec-48a7-9af4-dd0df3339101","controller":true,"blockOwnerDeletion":true}],"managedFields":[{"manager":"manager","operation":"Update","apiVersion":"v1","time":"2022-03-18T18:06:25Z","fieldsType":"FieldsV1","fieldsV1":{"f:metadata":{"f:labels":{".":{},"f:app.kubernetes.io/component":{},"f:app.kubernetes.io/name":{},"f:app.kubernetes.io/part-of":{}},"f:ownerReferences":{".":{},"k:{\"uid\":\"3ecefa8a-1bec-48a7-9af4-dd0df3339101\"}":{".":{},"f:apiVersion":{},"f:blockOwnerDeletion":{},"f:controller":{},"f:kind":{},"f:name":{},"f:uid":{}}}},"f:spec":{"f:ports":{".":{},"k:{\"port\":5672,\"protocol\":\"TCP\"}":{".":{},"f:name":{},"f:port":{},"f:protocol":{},"f:targetPort":{}},"k:{\"port\":15672,\"protocol\":\"TCP\"}":{".":{},"f:name":{},"f:port":{},"f:protocol":{},"f:targetPort":{}}},"f:selector":{".":{},"f:app.kubernetes.io/name":{}},"f:sessionAffinity":{},"f:type":{}}}}]},"spec":{"ports":[{"name":"amqp","protocol":"TCP","port":5672,"targetPort":5672},{"name":"management","protocol":"TCP","port":15672,"targetPort":15672}],"selector":{"app.kubernetes.io/name":"rabbitmq-cluster"},"clusterIP":"10.96.47.189","type":"ClusterIP","sessionAffinity":"None"},"status":{"loadBalancer":{}}}
2022/03/18 18:06:25 learn_server.go:291: [SIEVE-AFTER-READ]	Get	true	secret	default	rabbitmq-cluster-erlang-cookie	github.com/rabbitmq/cluster-operator/controllers.(*RabbitmqClusterReconciler)	NoError	{"kind":"Secret","apiVersion":"v1","metadata":{"name":"rabbitmq-cluster-erlang-cookie","namespace":"default","selfLink":"/api/v1/namespaces/default/secrets/rabbitmq-cluster-erlang-cookie","uid":"01d8d8ad-080a-4c3f-9d27-56616c53dd26","resourceVersion":"1088","creationTimestamp":"2022-03-18T18:06:25Z","labels":{"app.kubernetes.io/component":"rabbitmq","app.kubernetes.io/name":"rabbitmq-cluster","app.kubernetes.io/part-of":"rabbitmq"},"ownerReferences":[{"apiVersion":"rabbitmq.com/v1beta1","kind":"RabbitmqCluster","name":"rabbitmq-cluster","uid":"3ecefa8a-1bec-48a7-9af4-dd0df3339101","controller":true,"blockOwnerDeletion":true}],"managedFields":[{"manager":"manager","operation":"Update","apiVersion":"v1","time":"2022-03-18T18:06:25Z","fieldsType":"FieldsV1","fieldsV1":{"f:data":{".":{},"f:.erlang.cookie":{}},"f:metadata":{"f:labels":{".":{},"f:app.kubernetes.io/component":{},"f:app.kubernetes.io/name":{},"f:app.kubernetes.io/part-of":{}},"f:ownerReferences":{".":{},"k:{\"uid\":\"3ecefa8a-1bec-48a7-9af4-dd0df3339101\"}":{".":{},"f:apiVersion":{},"f:blockOwnerDeletion":{},"f:controller":{},"f:kind":{},"f:name":{},"f:uid":{}}}},"f:type":{}}}]},"data":{".erlang.cookie":"ajdscUtLdnBpR1NwUUMwc1V3a2VyTlJxU2tVUTdBeEw="},"type":"Opaque"}
2022/03/18 18:06:25 learn_server.go:291: [SIEVE-AFTER-READ]	Get	true	secret	default	rabbitmq-cluster-default-user	github.com/rabbitmq/cluster-operator/controllers.(*RabbitmqClusterReconciler)	NoError	{"kind":"Secret","apiVersion":"v1","metadata":{"name":"rabbitmq-cluster-default-user","namespace":"default","selfLink":"/api/v1/namespaces/default/secrets/rabbitmq-cluster-default-user","uid":"b2f5a936-e51f-4488-b6e9-ca23e4d95ac2","resourceVersion":"1091","creationTimestamp":"2022-03-18T18:06:25Z","labels":{"app.kubernetes.io/component":"rabbitmq","app.kubernetes.io/name":"rabbitmq-cluster","app.kubernetes.io/part-of":"rabbitmq"},"ownerReferences":[{"apiVersion":"rabbitmq.com/v1beta1","kind":"RabbitmqCluster","name":"rabbitmq-cluster","uid":"3ecefa8a-1bec-48a7-9af4-dd0df3339101","controller":true,"blockOwnerDeletion":true}],"managedFields":[{"manager":"manager","operation":"Update","apiVersion":"v1","time":"2022-03-18T18:06:25Z","fieldsType":"FieldsV1","fieldsV1":{"f:data":{".":{},"f:default_user.conf":{},"f:password":{},"f:provider":{},"f:type":{},"f:username":{}},"f:metadata":{"f:labels":{".":{},"f:app.kubernetes.io/component":{},"f:app.kubernetes.io/name":{},"f:app.kubernetes.io/part-of":{}},"f:ownerReferences":{".":{},"k:{\"uid\":\"3ecefa8a-1bec-48a7-9af4-dd0df3339101\"}":{".":{},"f:apiVersion":{},"f:blockOwnerDeletion":{},"f:controller":{},"f:kind":{},"f:name":{},"f:uid":{}}}},"f:type":{}}}]},"data":{"default_user.conf":"ZGVmYXVsdF91c2VyID0gdEFMN1otZTgzR29ocEtsZ0Z4cUFFV3ZXemEtcjdJQW8KZGVmYXVsdF9wYXNzID0gdXVocndkTkdOcmJXQ2p6NFZPX0NUZE9OYURkSUpoRkoK","password":"dXVocndkTkdOcmJXQ2p6NFZPX0NUZE9OYURkSUpoRko=","provider":"cmFiYml0bXE=","type":"cmFiYml0bXE=","username":"dEFMN1otZTgzR29ocEtsZ0Z4cUFFV3ZXemEtcjdJQW8="},"type":"Opaque"}
2022/03/18 18:06:25 learn_server.go:291: [SIEVE-AFTER-READ]	Get	true	configmap	default	rabbitmq-cluster-plugins-conf	github.com/rabbitmq/cluster-operator/controllers.(*RabbitmqClusterReconciler)	NoError	{"kind":"ConfigMap","apiVersion":"v1","metadata":{"name":"rabbitmq-cluster-plugins-conf","namespace":"default","selfLink":"/api/v1/namespaces/default/configmaps/rabbitmq-cluster-plugins-conf","uid":"0aa26eb6-ff3a-4457-a223-284c897db7fe","resourceVersion":"1092","creationTimestamp":"2022-03-18T18:06:25Z","labels":{"app.kubernetes.io/component":"rabbitmq","app.kubernetes.io/name":"rabbitmq-cluster","app.kubernetes.io/part-of":"rabbitmq"},"ownerReferences":[{"apiVersion":"rabbitmq.com/v1beta1","kind":"RabbitmqCluster","name":"rabbitmq-cluster","uid":"3ecefa8a-1bec-48a7-9af4-dd0df3339101","controller":true,"blockOwnerDeletion":true}],"managedFields":[{"manager":"manager","operation":"Update","apiVersion":"v1","time":"2022-03-18T18:06:25Z","fieldsType":"FieldsV1","fieldsV1":{"f:data":{".":{},"f:enabled_plugins":{}},"f:metadata":{"f:labels":{".":{},"f:app.kubernetes.io/component":{},"f:app.kubernetes.io/name":{},"f:app.kubernetes.io/part-of":{}},"f:ownerReferences":{".":{},"k:{\"uid\":\"3ecefa8a-1bec-48a7-9af4-dd0df3339101\"}":{".":{},"f:apiVersion":{},"f:blockOwnerDeletion":{},"f:controller":{},"f:kind":{},"f:name":{},"f:uid":{}}}}}}]},"data":{"enabled_plugins":"[rabbitmq_peer_discovery_k8s,rabbitmq_prometheus,rabbitmq_management]."}}
2022/03/18 18:06:25 learn_server.go:291: [SIEVE-AFTER-READ]	Get	true	configmap	default	rabbitmq-cluster-server-conf	github.com/rabbitmq/cluster-operator/controllers.(*RabbitmqClusterReconciler)	NoError	{"kind":"ConfigMap","apiVersion":"v1","metadata":{"name":"rabbitmq-cluster-server-conf","namespace":"default","selfLink":"/api/v1/namespaces/default/configmaps/rabbitmq-cluster-server-conf","uid":"e4182078-d429-4baf-9021-72618c509ac5","resourceVersion":"1095","creationTimestamp":"2022-03-18T18:06:25Z","labels":{"app.kubernetes.io/component":"rabbitmq","app.kubernetes.io/name":"rabbitmq-cluster","app.kubernetes.io/part-of":"rabbitmq"},"ownerReferences":[{"apiVersion":"rabbitmq.com/v1beta1","kind":"RabbitmqCluster","name":"rabbitmq-cluster","uid":"3ecefa8a-1bec-48a7-9af4-dd0df3339101","controller":true,"blockOwnerDeletion":true}],"managedFields":[{"manager":"manager","operation":"Update","apiVersion":"v1","time":"2022-03-18T18:06:25Z","fieldsType":"FieldsV1","fieldsV1":{"f:data":{".":{},"f:operatorDefaults.conf":{},"f:userDefinedConfiguration.conf":{}},"f:metadata":{"f:labels":{".":{},"f:app.kubernetes.io/component":{},"f:app.kubernetes.io/name":{},"f:app.kubernetes.io/part-of":{}},"f:ownerReferences":{".":{},"k:{\"uid\":\"3ecefa8a-1bec-48a7-9af4-dd0df3339101\"}":{".":{},"f:apiVersion":{},"f:blockOwnerDeletion":{},"f:controller":{},"f:kind":{},"f:name":{},"f:uid":{}}}}}}]},"data":{"operatorDefaults.conf":"cluster_formation.peer_discovery_backend             = rabbit_peer_discovery_k8s\ncluster_formation.k8s.host                           = kubernetes.default\ncluster_formation.k8s.address_type                   = hostname\ncluster_partition_handling                           = pause_minority\nqueue_master_locator                                 = min-masters\ndisk_free_limit.absolute                             = 2GB\ncluster_formation.randomized_startup_delay_range.min = 5\ncluster_formation.randomized_startup_delay_range.max = 30\ncluster_name                                         = rabbitmq-cluster\n","userDefinedConfiguration.conf":"total_memory_available_override_value = 1717986919\n"}}
2022/03/18 18:06:25 learn_server.go:291: [SIEVE-AFTER-READ]	Get	true	serviceaccount	default	rabbitmq-cluster-server	github.com/rabbitmq/cluster-operator/controllers.(*RabbitmqClusterReconciler)	NoError	{"kind":"ServiceAccount","apiVersion":"v1","metadata":{"name":"rabbitmq-cluster-server","namespace":"default","selfLink":"/api/v1/namespaces/default/serviceaccounts/rabbitmq-cluster-server","uid":"0c3cead0-37dd-452b-b939-fe346a5dfdea","resourceVersion":"1102","creationTimestamp":"2022-03-18T18:06:25Z","labels":{"app.kubernetes.io/component":"rabbitmq","app.kubernetes.io/name":"rabbitmq-cluster","app.kubernetes.io/part-of":"rabbitmq"},"ownerReferences":[{"apiVersion":"rabbitmq.com/v1beta1","kind":"RabbitmqCluster","name":"rabbitmq-cluster","uid":"3ecefa8a-1bec-48a7-9af4-dd0df3339101","controller":true,"blockOwnerDeletion":true}],"managedFields":[{"manager":"kube-controller-manager","operation":"Update","apiVersion":"v1","time":"2022-03-18T18:06:25Z","fieldsType":"FieldsV1","fieldsV1":{"f:secrets":{".":{},"k:{\"name\":\"rabbitmq-cluster-server-token-v4wpv\"}":{".":{},"f:name":{}}}}},{"manager":"manager","operation":"Update","apiVersion":"v1","time":"2022-03-18T18:06:25Z","fieldsType":"FieldsV1","fieldsV1":{"f:metadata":{"f:labels":{".":{},"f:app.kubernetes.io/component":{},"f:app.kubernetes.io/name":{},"f:app.kubernetes.io/part-of":{}},"f:ownerReferences":{".":{},"k:{\"uid\":\"3ecefa8a-1bec-48a7-9af4-dd0df3339101\"}":{".":{},"f:apiVersion":{},"f:blockOwnerDeletion":{},"f:controller":{},"f:kind":{},"f:name":{},"f:uid":{}}}}}}]},"secrets":[{"name":"rabbitmq-cluster-server-token-v4wpv"}]}
2022/03/18 18:06:25 learn_server.go:291: [SIEVE-AFTER-READ]	Get	true	role	default	rabbitmq-cluster-peer-discovery	github.com/rabbitmq/cluster-operator/controllers.(*RabbitmqClusterReconciler)	NoError	{"kind":"Role","apiVersion":"rbac.authorization.k8s.io/v1","metadata":{"name":"rabbitmq-cluster-peer-discovery","namespace":"default","selfLink":"/apis/rbac.authorization.k8s.io/v1/namespaces/default/roles/rabbitmq-cluster-peer-discovery","uid":"ec9ac474-1880-43ed-af46-9ea5f46d6db4","resourceVersion":"1103","creationTimestamp":"2022-03-18T18:06:25Z","labels":{"app.kubernetes.io/component":"rabbitmq","app.kubernetes.io/name":"rabbitmq-cluster","app.kubernetes.io/part-of":"rabbitmq"},"ownerReferences":[{"apiVersion":"rabbitmq.com/v1beta1","kind":"RabbitmqCluster","name":"rabbitmq-cluster","uid":"3ecefa8a-1bec-48a7-9af4-dd0df3339101","controller":true,"blockOwnerDeletion":true}],"managedFields":[{"manager":"manager","operation":"Update","apiVersion":"rbac.authorization.k8s.io/v1","time":"2022-03-18T18:06:25Z","fieldsType":"FieldsV1","fieldsV1":{"f:metadata":{"f:labels":{".":{},"f:app.kubernetes.io/component":{},"f:app.kubernetes.io/name":{},"f:app.kubernetes.io/part-of":{}},"f:ownerReferences":{".":{},"k:{\"uid\":\"3ecefa8a-1bec-48a7-9af4-dd0df3339101\"}":{".":{},"f:apiVersion":{},"f:blockOwnerDeletion":{},"f:controller":{},"f:kind":{},"f:name":{},"f:uid":{}}}},"f:rules":{}}}]},"rules":[{"verbs":["get"],"apiGroups":[""],"resources":["endpoints"]},{"verbs":["create"],"apiGroups":[""],"resources":["events"]}]}
2022/03/18 18:06:25 learn_server.go:291: [SIEVE-AFTER-READ]	Get	true	rolebinding	default	rabbitmq-cluster-server	github.com/rabbitmq/cluster-operator/controllers.(*RabbitmqClusterReconciler)	NoError	{"kind":"RoleBinding","apiVersion":"rbac.authorization.k8s.io/v1","metadata":{"name":"rabbitmq-cluster-server","namespace":"default","selfLink":"/apis/rbac.authorization.k8s.io/v1/namespaces/default/rolebindings/rabbitmq-cluster-server","uid":"fe69a41c-8d28-4b84-a9f6-a9e6044d75ba","resourceVersion":"1105","creationTimestamp":"2022-03-18T18:06:25Z","labels":{"app.kubernetes.io/component":"rabbitmq","app.kubernetes.io/name":"rabbitmq-cluster","app.kubernetes.io/part-of":"rabbitmq"},"ownerReferences":[{"apiVersion":"rabbitmq.com/v1beta1","kind":"RabbitmqCluster","name":"rabbitmq-cluster","uid":"3ecefa8a-1bec-48a7-9af4-dd0df3339101","controller":true,"blockOwnerDeletion":true}],"managedFields":[{"manager":"manager","operation":"Update","apiVersion":"rbac.authorization.k8s.io/v1","time":"2022-03-18T18:06:25Z","fieldsType":"FieldsV1","fieldsV1":{"f:metadata":{"f:labels":{".":{},"f:app.kubernetes.io/component":{},"f:app.kubernetes.io/name":{},"f:app.kubernetes.io/part-of":{}},"f:ownerReferences":{".":{},"k:{\"uid\":\"3ecefa8a-1bec-48a7-9af4-dd0df3339101\"}":{".":{},"f:apiVersion":{},"f:blockOwnerDeletion":{},"f:controller":{},"f:kind":{},"f:name":{},"f:uid":{}}}},"f:roleRef":{"f:apiGroup":{},"f:kind":{},"f:name":{}},"f:subjects":{}}}]},"subjects":[{"kind":"ServiceAccount","name":"rabbitmq-cluster-server"}],"roleRef":{"apiGroup":"rbac.authorization.k8s.io","kind":"Role","name":"rabbitmq-cluster-peer-discovery"}}
2022/03/18 18:06:25 learn_server.go:291: [SIEVE-AFTER-READ]	Get	true	statefulset	default	rabbitmq-cluster-server	github.com/rabbitmq/cluster-operator/controllers.(*RabbitmqClusterReconciler)	NoError	{"kind":"StatefulSet","apiVersion":"apps/v1","metadata":{"name":"rabbitmq-cluster-server","namespace":"default","selfLink":"/apis/apps/v1/namespaces/default/statefulsets/rabbitmq-cluster-server","uid":"f2f07f3e-b500-4c48-a5de-8db7eaf37b9a","resourceVersion":"1129","generation":1,"creationTimestamp":"2022-03-18T18:06:25Z","labels":{"app.kubernetes.io/component":"rabbitmq","app.kubernetes.io/name":"rabbitmq-cluster","app.kubernetes.io/part-of":"rabbitmq"},"annotations":{"rabbitmq.com/createdAt":"2022-03-18T18:06:25Z"},"ownerReferences":[{"apiVersion":"rabbitmq.com/v1beta1","kind":"RabbitmqCluster","name":"rabbitmq-cluster","uid":"3ecefa8a-1bec-48a7-9af4-dd0df3339101","controller":true,"blockOwnerDeletion":true}],"managedFields":[{"manager":"kube-controller-manager","operation":"Update","apiVersion":"apps/v1","time":"2022-03-18T18:06:25Z","fieldsType":"FieldsV1","fieldsV1":{"f:status":{"f:collisionCount":{},"f:currentReplicas":{},"f:currentRevision":{},"f:observedGeneration":{},"f:replicas":{},"f:updateRevision":{},"f:updatedReplicas":{}}}},{"manager":"manager","operation":"Update","apiVersion":"apps/v1","time":"2022-03-18T18:06:25Z","fieldsType":"FieldsV1","fieldsV1":{"f:metadata":{"f:annotations":{".":{},"f:rabbitmq.com/createdAt":{}},"f:labels":{".":{},"f:app.kubernetes.io/component":{},"f:app.kubernetes.io/name":{},"f:app.kubernetes.io/part-of":{}},"f:ownerReferences":{".":{},"k:{\"uid\":\"3ecefa8a-1bec-48a7-9af4-dd0df3339101\"}":{".":{},"f:apiVersion":{},"f:blockOwnerDeletion":{},"f:controller":{},"f:kind":{},"f:name":{},"f:uid":{}}}},"f:spec":{"f:podManagementPolicy":{},"f:replicas":{},"f:revisionHistoryLimit":{},"f:selector":{"f:matchLabels":{".":{},"f:app.kubernetes.io/name":{}}},"f:serviceName":{},"f:template":{"f:metadata":{"f:annotations":{".":{},"f:prometheus.io/port":{},"f:prometheus.io/scrape":{}},"f:labels":{".":{},"f:app.kubernetes.io/component":{},"f:app.kubernetes.io/name":{},"f:app.kubernetes.io/part-of":{}}},"f:spec":{"f:automountServiceAccountToken":{},"f:containers":{"k:{\"name\":\"rabbitmq\"}":{".":{},"f:env":{".":{},"k:{\"name\":\"K8S_HOSTNAME_SUFFIX\"}":{".":{},"f:name":{},"f:value":{}},"k:{\"name\":\"K8S_SERVICE_NAME\"}":{".":{},"f:name":{},"f:value":{}},"k:{\"name\":\"MY_POD_NAME\"}":{".":{},"f:name":{},"f:valueFrom":{".":{},"f:fieldRef":{".":{},"f:apiVersion":{},"f:fieldPath":{}}}},"k:{\"name\":\"MY_POD_NAMESPACE\"}":{".":{},"f:name":{},"f:valueFrom":{".":{},"f:fieldRef":{".":{},"f:apiVersion":{},"f:fieldPath":{}}}},"k:{\"name\":\"RABBITMQ_ENABLED_PLUGINS_FILE\"}":{".":{},"f:name":{},"f:value":{}},"k:{\"name\":\"RABBITMQ_NODENAME\"}":{".":{},"f:name":{},"f:value":{}},"k:{\"name\":\"RABBITMQ_USE_LONGNAME\"}":{".":{},"f:name":{},"f:value":{}}},"f:image":{},"f:imagePullPolicy":{},"f:lifecycle":{".":{},"f:preStop":{".":{},"f:exec":{".":{},"f:command":{}}}},"f:name":{},"f:ports":{".":{},"k:{\"containerPort\":4369,\"protocol\":\"TCP\"}":{".":{},"f:containerPort":{},"f:name":{},"f:protocol":{}},"k:{\"containerPort\":5672,\"protocol\":\"TCP\"}":{".":{},"f:containerPort":{},"f:name":{},"f:protocol":{}},"k:{\"containerPort\":15672,\"protocol\":\"TCP\"}":{".":{},"f:containerPort":{},"f:name":{},"f:protocol":{}},"k:{\"containerPort\":15692,\"protocol\":\"TCP\"}":{".":{},"f:containerPort":{},"f:name":{},"f:protocol":{}}},"f:readinessProbe":{".":{},"f:failureThreshold":{},"f:initialDelaySeconds":{},"f:periodSeconds":{},"f:successThreshold":{},"f:tcpSocket":{".":{},"f:port":{}},"f:timeoutSeconds":{}},"f:resources":{".":{},"f:limits":{".":{},"f:cpu":{},"f:memory":{}},"f:requests":{".":{},"f:cpu":{},"f:memory":{}}},"f:terminationMessagePath":{},"f:terminationMessagePolicy":{},"f:volumeMounts":{".":{},"k:{\"mountPath\":\"/etc/pod-info/\"}":{".":{},"f:mountPath":{},"f:name":{}},"k:{\"mountPath\":\"/etc/rabbitmq/conf.d/10-operatorDefaults.conf\"}":{".":{},"f:mountPath":{},"f:name":{},"f:subPath":{}},"k:{\"mountPath\":\"/etc/rabbitmq/conf.d/11-default_user.conf\"}":{".":{},"f:mountPath":{},"f:name":{},"f:subPath":{}},"k:{\"mountPath\":\"/etc/rabbitmq/conf.d/90-userDefinedConfiguration.conf\"}":{".":{},"f:mountPath":{},"f:name":{},"f:subPath":{}},"k:{\"mountPath\":\"/operator\"}":{".":{},"f:mountPath":{},"f:name":{}},"k:{\"mountPath\":\"/var/lib/rabbitmq/\"}":{".":{},"f:mountPath":{},"f:name":{}},"k:{\"mountPath\":\"/var/lib/rabbitmq/mnesia/\"}":{".":{},"f:mountPath":{},"f:name":{}}}}},"f:dnsPolicy":{},"f:initContainers":{".":{},"k:{\"name\":\"setup-container\"}":{".":{},"f:command":{},"f:image":{},"f:imagePullPolicy":{},"f:name":{},"f:resources":{".":{},"f:limits":{".":{},"f:cpu":{},"f:memory":{}},"f:requests":{".":{},"f:cpu":{},"f:memory":{}}},"f:securityContext":{".":{},"f:capabilities":{".":{},"f:drop":{}},"f:runAsUser":{}},"f:terminationMessagePath":{},"f:terminationMessagePolicy":{},"f:volumeMounts":{".":{},"k:{\"mountPath\":\"/operator\"}":{".":{},"f:mountPath":{},"f:name":{}},"k:{\"mountPath\":\"/tmp/default_user.conf\"}":{".":{},"f:mountPath":{},"f:name":{},"f:subPath":{}},"k:{\"mountPath\":\"/tmp/erlang-cookie-secret/\"}":{".":{},"f:mountPath":{},"f:name":{}},"k:{\"mountPath\":\"/tmp/rabbitmq-plugins/\"}":{".":{},"f:mountPath":{},"f:name":{}},"k:{\"mountPath\":\"/var/lib/rabbitmq/\"}":{".":{},"f:mountPath":{},"f:name":{}},"k:{\"mountPath\":\"/var/lib/rabbitmq/mnesia/\"}":{".":{},"f:mountPath":{},"f:name":{}}}}},"f:restartPolicy":{},"f:schedulerName":{},"f:securityContext":{".":{},"f:fsGroup":{},"f:runAsGroup":{},"f:runAsUser":{}},"f:serviceAccount":{},"f:serviceAccountName":{},"f:terminationGracePeriodSeconds":{},"f:topologySpreadConstraints":{".":{},"k:{\"topologyKey\":\"topology.kubernetes.io/zone\",\"whenUnsatisfiable\":\"ScheduleAnyway\"}":{".":{},"f:labelSelector":{".":{},"f:matchLabels":{".":{},"f:app.kubernetes.io/name":{}}},"f:maxSkew":{},"f:topologyKey":{},"f:whenUnsatisfiable":{}}},"f:volumes":{".":{},"k:{\"name\":\"erlang-cookie-secret\"}":{".":{},"f:name":{},"f:secret":{".":{},"f:defaultMode":{},"f:secretName":{}}},"k:{\"name\":\"plugins-conf\"}":{".":{},"f:configMap":{".":{},"f:defaultMode":{},"f:name":{}},"f:name":{}},"k:{\"name\":\"pod-info\"}":{".":{},"f:downwardAPI":{".":{},"f:defaultMode":{},"f:items":{}},"f:name":{}},"k:{\"name\":\"rabbitmq-confd\"}":{".":{},"f:name":{},"f:projected":{".":{},"f:defaultMode":{},"f:sources":{}}},"k:{\"name\":\"rabbitmq-erlang-cookie\"}":{".":{},"f:emptyDir":{},"f:name":{}},"k:{\"name\":\"rabbitmq-plugins\"}":{".":{},"f:emptyDir":{},"f:name":{}}}}},"f:updateStrategy":{"f:rollingUpdate":{".":{},"f:partition":{}},"f:type":{}},"f:volumeClaimTemplates":{}}}}]},"spec":{"replicas":1,"selector":{"matchLabels":{"app.kubernetes.io/name":"rabbitmq-cluster"}},"template":{"metadata":{"creationTimestamp":null,"labels":{"app.kubernetes.io/component":"rabbitmq","app.kubernetes.io/name":"rabbitmq-cluster","app.kubernetes.io/part-of":"rabbitmq"},"annotations":{"prometheus.io/port":"15692","prometheus.io/scrape":"true"}},"spec":{"volumes":[{"name":"plugins-conf","configMap":{"name":"rabbitmq-cluster-plugins-conf","defaultMode":420}},{"name":"rabbitmq-confd","projected":{"sources":[{"secret":{"name":"rabbitmq-cluster-default-user","items":[{"key":"default_user.conf","path":"default_user.conf"}]}},{"configMap":{"name":"rabbitmq-cluster-server-conf","items":[{"key":"operatorDefaults.conf","path":"operatorDefaults.conf"},{"key":"userDefinedConfiguration.conf","path":"userDefinedConfiguration.conf"}]}}],"defaultMode":420}},{"name":"rabbitmq-erlang-cookie","emptyDir":{}},{"name":"erlang-cookie-secret","secret":{"secretName":"rabbitmq-cluster-erlang-cookie","defaultMode":420}},{"name":"rabbitmq-plugins","emptyDir":{}},{"name":"pod-info","downwardAPI":{"items":[{"path":"skipPreStopChecks","fieldRef":{"apiVersion":"v1","fieldPath":"metadata.labels['skipPreStopChecks']"}}],"defaultMode":420}}],"initContainers":[{"name":"setup-container","image":"rabbitmq:3.8.12-management","command":["sh","-c","cp /tmp/erlang-cookie-secret/.erlang.cookie /var/lib/rabbitmq/.erlang.cookie \u0026\u0026 chown 999:999 /var/lib/rabbitmq/.erlang.cookie \u0026\u0026 chmod 600 /var/lib/rabbitmq/.erlang.cookie ; cp /tmp/rabbitmq-plugins/enabled_plugins /operator/enabled_plugins \u0026\u0026 chown 999:999 /operator/enabled_plugins ; chown 999:999 /var/lib/rabbitmq/mnesia/ ; echo '[default]' \u003e /var/lib/rabbitmq/.rabbitmqadmin.conf \u0026\u0026 sed -e 's/default_user/username/' -e 's/default_pass/password/' /tmp/default_user.conf \u003e\u003e /var/lib/rabbitmq/.rabbitmqadmin.conf \u0026\u0026 chown 999:999 /var/lib/rabbitmq/.rabbitmqadmin.conf \u0026\u0026 chmod 600 /var/lib/rabbitmq/.rabbitmqadmin.conf"],"resources":{"limits":{"cpu":"100m","memory":"500Mi"},"requests":{"cpu":"100m","memory":"500Mi"}},"volumeMounts":[{"name":"plugins-conf","mountPath":"/tmp/rabbitmq-plugins/"},{"name":"rabbitmq-erlang-cookie","mountPath":"/var/lib/rabbitmq/"},{"name":"erlang-cookie-secret","mountPath":"/tmp/erlang-cookie-secret/"},{"name":"rabbitmq-plugins","mountPath":"/operator"},{"name":"persistence","mountPath":"/var/lib/rabbitmq/mnesia/"},{"name":"rabbitmq-confd","mountPath":"/tmp/default_user.conf","subPath":"default_user.conf"}],"terminationMessagePath":"/dev/termination-log","terminationMessagePolicy":"File","imagePullPolicy":"IfNotPresent","securityContext":{"capabilities":{"drop":["FSETID","KILL","SETGID","SETUID","SETPCAP","NET_BIND_SERVICE","NET_RAW","SYS_CHROOT","MKNOD","AUDIT_WRITE","SETFCAP"]},"runAsUser":0}}],"containers":[{"name":"rabbitmq","image":"rabbitmq:3.8.12-management","ports":[{"name":"epmd","containerPort":4369,"protocol":"TCP"},{"name":"amqp","containerPort":5672,"protocol":"TCP"},{"name":"management","containerPort":15672,"protocol":"TCP"},{"name":"prometheus","containerPort":15692,"protocol":"TCP"}],"env":[{"name":"MY_POD_NAME","valueFrom":{"fieldRef":{"apiVersion":"v1","fieldPath":"metadata.name"}}},{"name":"MY_POD_NAMESPACE","valueFrom":{"fieldRef":{"apiVersion":"v1","fieldPath":"metadata.namespace"}}},{"name":"RABBITMQ_ENABLED_PLUGINS_FILE","value":"/operator/enabled_plugins"},{"name":"K8S_SERVICE_NAME","value":"rabbitmq-cluster-nodes"},{"name":"RABBITMQ_USE_LONGNAME","value":"true"},{"name":"RABBITMQ_NODENAME","value":"rabbit@$(MY_POD_NAME).$(K8S_SERVICE_NAME).$(MY_POD_NAMESPACE)"},{"name":"K8S_HOSTNAME_SUFFIX","value":".$(K8S_SERVICE_NAME).$(MY_POD_NAMESPACE)"}],"resources":{"limits":{"cpu":"2","memory":"2Gi"},"requests":{"cpu":"1","memory":"2Gi"}},"volumeMounts":[{"name":"rabbitmq-erlang-cookie","mountPath":"/var/lib/rabbitmq/"},{"name":"persistence","mountPath":"/var/lib/rabbitmq/mnesia/"},{"name":"rabbitmq-plugins","mountPath":"/operator"},{"name":"rabbitmq-confd","mountPath":"/etc/rabbitmq/conf.d/10-operatorDefaults.conf","subPath":"operatorDefaults.conf"},{"name":"rabbitmq-confd","mountPath":"/etc/rabbitmq/conf.d/11-default_user.conf","subPath":"default_user.conf"},{"name":"rabbitmq-confd","mountPath":"/etc/rabbitmq/conf.d/90-userDefinedConfiguration.conf","subPath":"userDefinedConfiguration.conf"},{"name":"pod-info","mountPath":"/etc/pod-info/"}],"readinessProbe":{"tcpSocket":{"port":"amqp"},"initialDelaySeconds":10,"timeoutSeconds":5,"periodSeconds":10,"successThreshold":1,"failureThreshold":3},"lifecycle":{"preStop":{"exec":{"command":["/bin/bash","-c","if [ ! -z \"$(cat /etc/pod-info/skipPreStopChecks)\" ]; then exit 0; fi; rabbitmq-upgrade await_online_quorum_plus_one -t 604800; rabbitmq-upgrade await_online_synchronized_mirror -t 604800; rabbitmq-upgrade drain -t 604800"]}}},"terminationMessagePath":"/dev/termination-log","terminationMessagePolicy":"File","imagePullPolicy":"IfNotPresent"}],"restartPolicy":"Always","terminationGracePeriodSeconds":604800,"dnsPolicy":"ClusterFirst","serviceAccountName":"rabbitmq-cluster-server","serviceAccount":"rabbitmq-cluster-server","automountServiceAccountToken":true,"securityContext":{"runAsUser":999,"runAsGroup":999,"fsGroup":999},"schedulerName":"default-scheduler","topologySpreadConstraints":[{"maxSkew":1,"topologyKey":"topology.kubernetes.io/zone","whenUnsatisfiable":"ScheduleAnyway","labelSelector":{"matchLabels":{"app.kubernetes.io/name":"rabbitmq-cluster"}}}]}},"volumeClaimTemplates":[{"metadata":{"name":"persistence","namespace":"default","creationTimestamp":null,"labels":{"app.kubernetes.io/component":"rabbitmq","app.kubernetes.io/name":"rabbitmq-cluster","app.kubernetes.io/part-of":"rabbitmq"},"ownerReferences":[{"apiVersion":"rabbitmq.com/v1beta1","kind":"RabbitmqCluster","name":"rabbitmq-cluster","uid":"3ecefa8a-1bec-48a7-9af4-dd0df3339101","controller":true,"blockOwnerDeletion":false}]},"spec":{"accessModes":["ReadWriteOnce"],"resources":{"requests":{"storage":"10Gi"}},"volumeMode":"Filesystem"},"status":{"phase":"Pending"}}],"serviceName":"rabbitmq-cluster-nodes","podManagementPolicy":"Parallel","updateStrategy":{"type":"RollingUpdate","rollingUpdate":{"partition":0}},"revisionHistoryLimit":10},"status":{"observedGeneration":1,"replicas":1,"currentReplicas":1,"updatedReplicas":1,"currentRevision":"rabbitmq-cluster-server-5f8b8665fb","updateRevision":"rabbitmq-cluster-server-5f8b8665fb","collisionCount":0}}
2022/03/18 18:06:25 learn_server.go:291: [SIEVE-AFTER-READ]	Get	true	statefulset	default	rabbitmq-cluster-server	github.com/rabbitmq/cluster-operator/controllers.(*RabbitmqClusterReconciler)	NoError	{"kind":"StatefulSet","apiVersion":"apps/v1","metadata":{"name":"rabbitmq-cluster-server","namespace":"default","selfLink":"/apis/apps/v1/namespaces/default/statefulsets/rabbitmq-cluster-server","uid":"f2f07f3e-b500-4c48-a5de-8db7eaf37b9a","resourceVersion":"1129","generation":1,"creationTimestamp":"2022-03-18T18:06:25Z","labels":{"app.kubernetes.io/component":"rabbitmq","app.kubernetes.io/name":"rabbitmq-cluster","app.kubernetes.io/part-of":"rabbitmq"},"annotations":{"rabbitmq.com/createdAt":"2022-03-18T18:06:25Z"},"ownerReferences":[{"apiVersion":"rabbitmq.com/v1beta1","kind":"RabbitmqCluster","name":"rabbitmq-cluster","uid":"3ecefa8a-1bec-48a7-9af4-dd0df3339101","controller":true,"blockOwnerDeletion":true}],"managedFields":[{"manager":"kube-controller-manager","operation":"Update","apiVersion":"apps/v1","time":"2022-03-18T18:06:25Z","fieldsType":"FieldsV1","fieldsV1":{"f:status":{"f:collisionCount":{},"f:currentReplicas":{},"f:currentRevision":{},"f:observedGeneration":{},"f:replicas":{},"f:updateRevision":{},"f:updatedReplicas":{}}}},{"manager":"manager","operation":"Update","apiVersion":"apps/v1","time":"2022-03-18T18:06:25Z","fieldsType":"FieldsV1","fieldsV1":{"f:metadata":{"f:annotations":{".":{},"f:rabbitmq.com/createdAt":{}},"f:labels":{".":{},"f:app.kubernetes.io/component":{},"f:app.kubernetes.io/name":{},"f:app.kubernetes.io/part-of":{}},"f:ownerReferences":{".":{},"k:{\"uid\":\"3ecefa8a-1bec-48a7-9af4-dd0df3339101\"}":{".":{},"f:apiVersion":{},"f:blockOwnerDeletion":{},"f:controller":{},"f:kind":{},"f:name":{},"f:uid":{}}}},"f:spec":{"f:podManagementPolicy":{},"f:replicas":{},"f:revisionHistoryLimit":{},"f:selector":{"f:matchLabels":{".":{},"f:app.kubernetes.io/name":{}}},"f:serviceName":{},"f:template":{"f:metadata":{"f:annotations":{".":{},"f:prometheus.io/port":{},"f:prometheus.io/scrape":{}},"f:labels":{".":{},"f:app.kubernetes.io/component":{},"f:app.kubernetes.io/name":{},"f:app.kubernetes.io/part-of":{}}},"f:spec":{"f:automountServiceAccountToken":{},"f:containers":{"k:{\"name\":\"rabbitmq\"}":{".":{},"f:env":{".":{},"k:{\"name\":\"K8S_HOSTNAME_SUFFIX\"}":{".":{},"f:name":{},"f:value":{}},"k:{\"name\":\"K8S_SERVICE_NAME\"}":{".":{},"f:name":{},"f:value":{}},"k:{\"name\":\"MY_POD_NAME\"}":{".":{},"f:name":{},"f:valueFrom":{".":{},"f:fieldRef":{".":{},"f:apiVersion":{},"f:fieldPath":{}}}},"k:{\"name\":\"MY_POD_NAMESPACE\"}":{".":{},"f:name":{},"f:valueFrom":{".":{},"f:fieldRef":{".":{},"f:apiVersion":{},"f:fieldPath":{}}}},"k:{\"name\":\"RABBITMQ_ENABLED_PLUGINS_FILE\"}":{".":{},"f:name":{},"f:value":{}},"k:{\"name\":\"RABBITMQ_NODENAME\"}":{".":{},"f:name":{},"f:value":{}},"k:{\"name\":\"RABBITMQ_USE_LONGNAME\"}":{".":{},"f:name":{},"f:value":{}}},"f:image":{},"f:imagePullPolicy":{},"f:lifecycle":{".":{},"f:preStop":{".":{},"f:exec":{".":{},"f:command":{}}}},"f:name":{},"f:ports":{".":{},"k:{\"containerPort\":4369,\"protocol\":\"TCP\"}":{".":{},"f:containerPort":{},"f:name":{},"f:protocol":{}},"k:{\"containerPort\":5672,\"protocol\":\"TCP\"}":{".":{},"f:containerPort":{},"f:name":{},"f:protocol":{}},"k:{\"containerPort\":15672,\"protocol\":\"TCP\"}":{".":{},"f:containerPort":{},"f:name":{},"f:protocol":{}},"k:{\"containerPort\":15692,\"protocol\":\"TCP\"}":{".":{},"f:containerPort":{},"f:name":{},"f:protocol":{}}},"f:readinessProbe":{".":{},"f:failureThreshold":{},"f:initialDelaySeconds":{},"f:periodSeconds":{},"f:successThreshold":{},"f:tcpSocket":{".":{},"f:port":{}},"f:timeoutSeconds":{}},"f:resources":{".":{},"f:limits":{".":{},"f:cpu":{},"f:memory":{}},"f:requests":{".":{},"f:cpu":{},"f:memory":{}}},"f:terminationMessagePath":{},"f:terminationMessagePolicy":{},"f:volumeMounts":{".":{},"k:{\"mountPath\":\"/etc/pod-info/\"}":{".":{},"f:mountPath":{},"f:name":{}},"k:{\"mountPath\":\"/etc/rabbitmq/conf.d/10-operatorDefaults.conf\"}":{".":{},"f:mountPath":{},"f:name":{},"f:subPath":{}},"k:{\"mountPath\":\"/etc/rabbitmq/conf.d/11-default_user.conf\"}":{".":{},"f:mountPath":{},"f:name":{},"f:subPath":{}},"k:{\"mountPath\":\"/etc/rabbitmq/conf.d/90-userDefinedConfiguration.conf\"}":{".":{},"f:mountPath":{},"f:name":{},"f:subPath":{}},"k:{\"mountPath\":\"/operator\"}":{".":{},"f:mountPath":{},"f:name":{}},"k:{\"mountPath\":\"/var/lib/rabbitmq/\"}":{".":{},"f:mountPath":{},"f:name":{}},"k:{\"mountPath\":\"/var/lib/rabbitmq/mnesia/\"}":{".":{},"f:mountPath":{},"f:name":{}}}}},"f:dnsPolicy":{},"f:initContainers":{".":{},"k:{\"name\":\"setup-container\"}":{".":{},"f:command":{},"f:image":{},"f:imagePullPolicy":{},"f:name":{},"f:resources":{".":{},"f:limits":{".":{},"f:cpu":{},"f:memory":{}},"f:requests":{".":{},"f:cpu":{},"f:memory":{}}},"f:securityContext":{".":{},"f:capabilities":{".":{},"f:drop":{}},"f:runAsUser":{}},"f:terminationMessagePath":{},"f:terminationMessagePolicy":{},"f:volumeMounts":{".":{},"k:{\"mountPath\":\"/operator\"}":{".":{},"f:mountPath":{},"f:name":{}},"k:{\"mountPath\":\"/tmp/default_user.conf\"}":{".":{},"f:mountPath":{},"f:name":{},"f:subPath":{}},"k:{\"mountPath\":\"/tmp/erlang-cookie-secret/\"}":{".":{},"f:mountPath":{},"f:name":{}},"k:{\"mountPath\":\"/tmp/rabbitmq-plugins/\"}":{".":{},"f:mountPath":{},"f:name":{}},"k:{\"mountPath\":\"/var/lib/rabbitmq/\"}":{".":{},"f:mountPath":{},"f:name":{}},"k:{\"mountPath\":\"/var/lib/rabbitmq/mnesia/\"}":{".":{},"f:mountPath":{},"f:name":{}}}}},"f:restartPolicy":{},"f:schedulerName":{},"f:securityContext":{".":{},"f:fsGroup":{},"f:runAsGroup":{},"f:runAsUser":{}},"f:serviceAccount":{},"f:serviceAccountName":{},"f:terminationGracePeriodSeconds":{},"f:topologySpreadConstraints":{".":{},"k:{\"topologyKey\":\"topology.kubernetes.io/zone\",\"whenUnsatisfiable\":\"ScheduleAnyway\"}":{".":{},"f:labelSelector":{".":{},"f:matchLabels":{".":{},"f:app.kubernetes.io/name":{}}},"f:maxSkew":{},"f:topologyKey":{},"f:whenUnsatisfiable":{}}},"f:volumes":{".":{},"k:{\"name\":\"erlang-cookie-secret\"}":{".":{},"f:name":{},"f:secret":{".":{},"f:defaultMode":{},"f:secretName":{}}},"k:{\"name\":\"plugins-conf\"}":{".":{},"f:configMap":{".":{},"f:defaultMode":{},"f:name":{}},"f:name":{}},"k:{\"name\":\"pod-info\"}":{".":{},"f:downwardAPI":{".":{},"f:defaultMode":{},"f:items":{}},"f:name":{}},"k:{\"name\":\"rabbitmq-confd\"}":{".":{},"f:name":{},"f:projected":{".":{},"f:defaultMode":{},"f:sources":{}}},"k:{\"name\":\"rabbitmq-erlang-cookie\"}":{".":{},"f:emptyDir":{},"f:name":{}},"k:{\"name\":\"rabbitmq-plugins\"}":{".":{},"f:emptyDir":{},"f:name":{}}}}},"f:updateStrategy":{"f:rollingUpdate":{".":{},"f:partition":{}},"f:type":{}},"f:volumeClaimTemplates":{}}}}]},"spec":{"replicas":1,"selector":{"matchLabels":{"app.kubernetes.io/name":"rabbitmq-cluster"}},"template":{"metadata":{"creationTimestamp":null,"labels":{"app.kubernetes.io/component":"rabbitmq","app.kubernetes.io/name":"rabbitmq-cluster","app.kubernetes.io/part-of":"rabbitmq"},"annotations":{"prometheus.io/port":"15692","prometheus.io/scrape":"true"}},"spec":{"volumes":[{"name":"plugins-conf","configMap":{"name":"rabbitmq-cluster-plugins-conf","defaultMode":420}},{"name":"rabbitmq-confd","projected":{"sources":[{"secret":{"name":"rabbitmq-cluster-default-user","items":[{"key":"default_user.conf","path":"default_user.conf"}]}},{"configMap":{"name":"rabbitmq-cluster-server-conf","items":[{"key":"operatorDefaults.conf","path":"operatorDefaults.conf"},{"key":"userDefinedConfiguration.conf","path":"userDefinedConfiguration.conf"}]}}],"defaultMode":420}},{"name":"rabbitmq-erlang-cookie","emptyDir":{}},{"name":"erlang-cookie-secret","secret":{"secretName":"rabbitmq-cluster-erlang-cookie","defaultMode":420}},{"name":"rabbitmq-plugins","emptyDir":{}},{"name":"pod-info","downwardAPI":{"items":[{"path":"skipPreStopChecks","fieldRef":{"apiVersion":"v1","fieldPath":"metadata.labels['skipPreStopChecks']"}}],"defaultMode":420}}],"initContainers":[{"name":"setup-container","image":"rabbitmq:3.8.12-management","command":["sh","-c","cp /tmp/erlang-cookie-secret/.erlang.cookie /var/lib/rabbitmq/.erlang.cookie \u0026\u0026 chown 999:999 /var/lib/rabbitmq/.erlang.cookie \u0026\u0026 chmod 600 /var/lib/rabbitmq/.erlang.cookie ; cp /tmp/rabbitmq-plugins/enabled_plugins /operator/enabled_plugins \u0026\u0026 chown 999:999 /operator/enabled_plugins ; chown 999:999 /var/lib/rabbitmq/mnesia/ ; echo '[default]' \u003e /var/lib/rabbitmq/.rabbitmqadmin.conf \u0026\u0026 sed -e 's/default_user/username/' -e 's/default_pass/password/' /tmp/default_user.conf \u003e\u003e /var/lib/rabbitmq/.rabbitmqadmin.conf \u0026\u0026 chown 999:999 /var/lib/rabbitmq/.rabbitmqadmin.conf \u0026\u0026 chmod 600 /var/lib/rabbitmq/.rabbitmqadmin.conf"],"resources":{"limits":{"cpu":"100m","memory":"500Mi"},"requests":{"cpu":"100m","memory":"500Mi"}},"volumeMounts":[{"name":"plugins-conf","mountPath":"/tmp/rabbitmq-plugins/"},{"name":"rabbitmq-erlang-cookie","mountPath":"/var/lib/rabbitmq/"},{"name":"erlang-cookie-secret","mountPath":"/tmp/erlang-cookie-secret/"},{"name":"rabbitmq-plugins","mountPath":"/operator"},{"name":"persistence","mountPath":"/var/lib/rabbitmq/mnesia/"},{"name":"rabbitmq-confd","mountPath":"/tmp/default_user.conf","subPath":"default_user.conf"}],"terminationMessagePath":"/dev/termination-log","terminationMessagePolicy":"File","imagePullPolicy":"IfNotPresent","securityContext":{"capabilities":{"drop":["FSETID","KILL","SETGID","SETUID","SETPCAP","NET_BIND_SERVICE","NET_RAW","SYS_CHROOT","MKNOD","AUDIT_WRITE","SETFCAP"]},"runAsUser":0}}],"containers":[{"name":"rabbitmq","image":"rabbitmq:3.8.12-management","ports":[{"name":"epmd","containerPort":4369,"protocol":"TCP"},{"name":"amqp","containerPort":5672,"protocol":"TCP"},{"name":"management","containerPort":15672,"protocol":"TCP"},{"name":"prometheus","containerPort":15692,"protocol":"TCP"}],"env":[{"name":"MY_POD_NAME","valueFrom":{"fieldRef":{"apiVersion":"v1","fieldPath":"metadata.name"}}},{"name":"MY_POD_NAMESPACE","valueFrom":{"fieldRef":{"apiVersion":"v1","fieldPath":"metadata.namespace"}}},{"name":"RABBITMQ_ENABLED_PLUGINS_FILE","value":"/operator/enabled_plugins"},{"name":"K8S_SERVICE_NAME","value":"rabbitmq-cluster-nodes"},{"name":"RABBITMQ_USE_LONGNAME","value":"true"},{"name":"RABBITMQ_NODENAME","value":"rabbit@$(MY_POD_NAME).$(K8S_SERVICE_NAME).$(MY_POD_NAMESPACE)"},{"name":"K8S_HOSTNAME_SUFFIX","value":".$(K8S_SERVICE_NAME).$(MY_POD_NAMESPACE)"}],"resources":{"limits":{"cpu":"2","memory":"2Gi"},"requests":{"cpu":"1","memory":"2Gi"}},"volumeMounts":[{"name":"rabbitmq-erlang-cookie","mountPath":"/var/lib/rabbitmq/"},{"name":"persistence","mountPath":"/var/lib/rabbitmq/mnesia/"},{"name":"rabbitmq-plugins","mountPath":"/operator"},{"name":"rabbitmq-confd","mountPath":"/etc/rabbitmq/conf.d/10-operatorDefaults.conf","subPath":"operatorDefaults.conf"},{"name":"rabbitmq-confd","mountPath":"/etc/rabbitmq/conf.d/11-default_user.conf","subPath":"default_user.conf"},{"name":"rabbitmq-confd","mountPath":"/etc/rabbitmq/conf.d/90-userDefinedConfiguration.conf","subPath":"userDefinedConfiguration.conf"},{"name":"pod-info","mountPath":"/etc/pod-info/"}],"readinessProbe":{"tcpSocket":{"port":"amqp"},"initialDelaySeconds":10,"timeoutSeconds":5,"periodSeconds":10,"successThreshold":1,"failureThreshold":3},"lifecycle":{"preStop":{"exec":{"command":["/bin/bash","-c","if [ ! -z \"$(cat /etc/pod-info/skipPreStopChecks)\" ]; then exit 0; fi; rabbitmq-upgrade await_online_quorum_plus_one -t 604800; rabbitmq-upgrade await_online_synchronized_mirror -t 604800; rabbitmq-upgrade drain -t 604800"]}}},"terminationMessagePath":"/dev/termination-log","terminationMessagePolicy":"File","imagePullPolicy":"IfNotPresent"}],"restartPolicy":"Always","terminationGracePeriodSeconds":604800,"dnsPolicy":"ClusterFirst","serviceAccountName":"rabbitmq-cluster-server","serviceAccount":"rabbitmq-cluster-server","automountServiceAccountToken":true,"securityContext":{"runAsUser":999,"runAsGroup":999,"fsGroup":999},"schedulerName":"default-scheduler","topologySpreadConstraints":[{"maxSkew":1,"topologyKey":"topology.kubernetes.io/zone","whenUnsatisfiable":"ScheduleAnyway","labelSelector":{"matchLabels":{"app.kubernetes.io/name":"rabbitmq-cluster"}}}]}},"volumeClaimTemplates":[{"metadata":{"name":"persistence","namespace":"default","creationTimestamp":null,"labels":{"app.kubernetes.io/component":"rabbitmq","app.kubernetes.io/name":"rabbitmq-cluster","app.kubernetes.io/part-of":"rabbitmq"},"ownerReferences":[{"apiVersion":"rabbitmq.com/v1beta1","kind":"RabbitmqCluster","name":"rabbitmq-cluster","uid":"3ecefa8a-1bec-48a7-9af4-dd0df3339101","controller":true,"blockOwnerDeletion":false}]},"spec":{"accessModes":["ReadWriteOnce"],"resources":{"requests":{"storage":"10Gi"}},"volumeMode":"Filesystem"},"status":{"phase":"Pending"}}],"serviceName":"rabbitmq-cluster-nodes","podManagementPolicy":"Parallel","updateStrategy":{"type":"RollingUpdate","rollingUpdate":{"partition":0}},"revisionHistoryLimit":10},"status":{"observedGeneration":1,"replicas":1,"currentReplicas":1,"updatedReplicas":1,"currentRevision":"rabbitmq-cluster-server-5f8b8665fb","updateRevision":"rabbitmq-cluster-server-5f8b8665fb","collisionCount":0}}
2022/03/18 18:06:25 learn_server.go:256: [SIEVE-BEFORE-WRITE]	16
2022/03/18 18:06:25 learn_server.go:263: [SIEVE-AFTER-WRITE]	16	Update	statefulset	github.com/rabbitmq/cluster-operator/controllers.(*RabbitmqClusterReconciler)	NoError	{"metadata":{"name":"rabbitmq-cluster-server","namespace":"default","selfLink":"/apis/apps/v1/namespaces/default/statefulsets/rabbitmq-cluster-server","uid":"f2f07f3e-b500-4c48-a5de-8db7eaf37b9a","resourceVersion":"1129","generation":1,"creationTimestamp":"2022-03-18T18:06:25Z","labels":{"app.kubernetes.io/component":"rabbitmq","app.kubernetes.io/name":"rabbitmq-cluster","app.kubernetes.io/part-of":"rabbitmq"},"annotations":{"rabbitmq.com/createdAt":"2022-03-18T18:06:25Z"},"ownerReferences":[{"apiVersion":"rabbitmq.com/v1beta1","kind":"RabbitmqCluster","name":"rabbitmq-cluster","uid":"3ecefa8a-1bec-48a7-9af4-dd0df3339101","controller":true,"blockOwnerDeletion":true}],"managedFields":[{"manager":"kube-controller-manager","operation":"Update","apiVersion":"apps/v1","time":"2022-03-18T18:06:25Z","fieldsType":"FieldsV1","fieldsV1":{"f:status":{"f:collisionCount":{},"f:currentReplicas":{},"f:currentRevision":{},"f:observedGeneration":{},"f:replicas":{},"f:updateRevision":{},"f:updatedReplicas":{}}}},{"manager":"manager","operation":"Update","apiVersion":"apps/v1","time":"2022-03-18T18:06:25Z","fieldsType":"FieldsV1","fieldsV1":{"f:metadata":{"f:annotations":{".":{},"f:rabbitmq.com/createdAt":{}},"f:labels":{".":{},"f:app.kubernetes.io/component":{},"f:app.kubernetes.io/name":{},"f:app.kubernetes.io/part-of":{}},"f:ownerReferences":{".":{},"k:{\"uid\":\"3ecefa8a-1bec-48a7-9af4-dd0df3339101\"}":{".":{},"f:apiVersion":{},"f:blockOwnerDeletion":{},"f:controller":{},"f:kind":{},"f:name":{},"f:uid":{}}}},"f:spec":{"f:podManagementPolicy":{},"f:replicas":{},"f:revisionHistoryLimit":{},"f:selector":{"f:matchLabels":{".":{},"f:app.kubernetes.io/name":{}}},"f:serviceName":{},"f:template":{"f:metadata":{"f:annotations":{".":{},"f:prometheus.io/port":{},"f:prometheus.io/scrape":{}},"f:labels":{".":{},"f:app.kubernetes.io/component":{},"f:app.kubernetes.io/name":{},"f:app.kubernetes.io/part-of":{}}},"f:spec":{"f:automountServiceAccountToken":{},"f:containers":{"k:{\"name\":\"rabbitmq\"}":{".":{},"f:env":{".":{},"k:{\"name\":\"K8S_HOSTNAME_SUFFIX\"}":{".":{},"f:name":{},"f:value":{}},"k:{\"name\":\"K8S_SERVICE_NAME\"}":{".":{},"f:name":{},"f:value":{}},"k:{\"name\":\"MY_POD_NAME\"}":{".":{},"f:name":{},"f:valueFrom":{".":{},"f:fieldRef":{".":{},"f:apiVersion":{},"f:fieldPath":{}}}},"k:{\"name\":\"MY_POD_NAMESPACE\"}":{".":{},"f:name":{},"f:valueFrom":{".":{},"f:fieldRef":{".":{},"f:apiVersion":{},"f:fieldPath":{}}}},"k:{\"name\":\"RABBITMQ_ENABLED_PLUGINS_FILE\"}":{".":{},"f:name":{},"f:value":{}},"k:{\"name\":\"RABBITMQ_NODENAME\"}":{".":{},"f:name":{},"f:value":{}},"k:{\"name\":\"RABBITMQ_USE_LONGNAME\"}":{".":{},"f:name":{},"f:value":{}}},"f:image":{},"f:imagePullPolicy":{},"f:lifecycle":{".":{},"f:preStop":{".":{},"f:exec":{".":{},"f:command":{}}}},"f:name":{},"f:ports":{".":{},"k:{\"containerPort\":4369,\"protocol\":\"TCP\"}":{".":{},"f:containerPort":{},"f:name":{},"f:protocol":{}},"k:{\"containerPort\":5672,\"protocol\":\"TCP\"}":{".":{},"f:containerPort":{},"f:name":{},"f:protocol":{}},"k:{\"containerPort\":15672,\"protocol\":\"TCP\"}":{".":{},"f:containerPort":{},"f:name":{},"f:protocol":{}},"k:{\"containerPort\":15692,\"protocol\":\"TCP\"}":{".":{},"f:containerPort":{},"f:name":{},"f:protocol":{}}},"f:readinessProbe":{".":{},"f:failureThreshold":{},"f:initialDelaySeconds":{},"f:periodSeconds":{},"f:successThreshold":{},"f:tcpSocket":{".":{},"f:port":{}},"f:timeoutSeconds":{}},"f:resources":{".":{},"f:limits":{".":{},"f:cpu":{},"f:memory":{}},"f:requests":{".":{},"f:cpu":{},"f:memory":{}}},"f:terminationMessagePath":{},"f:terminationMessagePolicy":{},"f:volumeMounts":{".":{},"k:{\"mountPath\":\"/etc/pod-info/\"}":{".":{},"f:mountPath":{},"f:name":{}},"k:{\"mountPath\":\"/etc/rabbitmq/conf.d/10-operatorDefaults.conf\"}":{".":{},"f:mountPath":{},"f:name":{},"f:subPath":{}},"k:{\"mountPath\":\"/etc/rabbitmq/conf.d/11-default_user.conf\"}":{".":{},"f:mountPath":{},"f:name":{},"f:subPath":{}},"k:{\"mountPath\":\"/etc/rabbitmq/conf.d/90-userDefinedConfiguration.conf\"}":{".":{},"f:mountPath":{},"f:name":{},"f:subPath":{}},"k:{\"mountPath\":\"/operator\"}":{".":{},"f:mountPath":{},"f:name":{}},"k:{\"mountPath\":\"/var/lib/rabbitmq/\"}":{".":{},"f:mountPath":{},"f:name":{}},"k:{\"mountPath\":\"/var/lib/rabbitmq/mnesia/\"}":{".":{},"f:mountPath":{},"f:name":{}}}}},"f:dnsPolicy":{},"f:initContainers":{".":{},"k:{\"name\":\"setup-container\"}":{".":{},"f:command":{},"f:image":{},"f:imagePullPolicy":{},"f:name":{},"f:resources":{".":{},"f:limits":{".":{},"f:cpu":{},"f:memory":{}},"f:requests":{".":{},"f:cpu":{},"f:memory":{}}},"f:securityContext":{".":{},"f:capabilities":{".":{},"f:drop":{}},"f:runAsUser":{}},"f:terminationMessagePath":{},"f:terminationMessagePolicy":{},"f:volumeMounts":{".":{},"k:{\"mountPath\":\"/operator\"}":{".":{},"f:mountPath":{},"f:name":{}},"k:{\"mountPath\":\"/tmp/default_user.conf\"}":{".":{},"f:mountPath":{},"f:name":{},"f:subPath":{}},"k:{\"mountPath\":\"/tmp/erlang-cookie-secret/\"}":{".":{},"f:mountPath":{},"f:name":{}},"k:{\"mountPath\":\"/tmp/rabbitmq-plugins/\"}":{".":{},"f:mountPath":{},"f:name":{}},"k:{\"mountPath\":\"/var/lib/rabbitmq/\"}":{".":{},"f:mountPath":{},"f:name":{}},"k:{\"mountPath\":\"/var/lib/rabbitmq/mnesia/\"}":{".":{},"f:mountPath":{},"f:name":{}}}}},"f:restartPolicy":{},"f:schedulerName":{},"f:securityContext":{".":{},"f:fsGroup":{},"f:runAsGroup":{},"f:runAsUser":{}},"f:serviceAccount":{},"f:serviceAccountName":{},"f:terminationGracePeriodSeconds":{},"f:topologySpreadConstraints":{".":{},"k:{\"topologyKey\":\"topology.kubernetes.io/zone\",\"whenUnsatisfiable\":\"ScheduleAnyway\"}":{".":{},"f:labelSelector":{".":{},"f:matchLabels":{".":{},"f:app.kubernetes.io/name":{}}},"f:maxSkew":{},"f:topologyKey":{},"f:whenUnsatisfiable":{}}},"f:volumes":{".":{},"k:{\"name\":\"erlang-cookie-secret\"}":{".":{},"f:name":{},"f:secret":{".":{},"f:defaultMode":{},"f:secretName":{}}},"k:{\"name\":\"plugins-conf\"}":{".":{},"f:configMap":{".":{},"f:defaultMode":{},"f:name":{}},"f:name":{}},"k:{\"name\":\"pod-info\"}":{".":{},"f:downwardAPI":{".":{},"f:defaultMode":{},"f:items":{}},"f:name":{}},"k:{\"name\":\"rabbitmq-confd\"}":{".":{},"f:name":{},"f:projected":{".":{},"f:defaultMode":{},"f:sources":{}}},"k:{\"name\":\"rabbitmq-erlang-cookie\"}":{".":{},"f:emptyDir":{},"f:name":{}},"k:{\"name\":\"rabbitmq-plugins\"}":{".":{},"f:emptyDir":{},"f:name":{}}}}},"f:updateStrategy":{"f:rollingUpdate":{".":{},"f:partition":{}},"f:type":{}},"f:volumeClaimTemplates":{}}}}]},"spec":{"replicas":1,"selector":{"matchLabels":{"app.kubernetes.io/name":"rabbitmq-cluster"}},"template":{"metadata":{"creationTimestamp":null,"labels":{"app.kubernetes.io/component":"rabbitmq","app.kubernetes.io/name":"rabbitmq-cluster","app.kubernetes.io/part-of":"rabbitmq"},"annotations":{"prometheus.io/port":"15692","prometheus.io/scrape":"true"}},"spec":{"volumes":[{"name":"plugins-conf","configMap":{"name":"rabbitmq-cluster-plugins-conf","defaultMode":420}},{"name":"rabbitmq-confd","projected":{"sources":[{"secret":{"name":"rabbitmq-cluster-default-user","items":[{"key":"default_user.conf","path":"default_user.conf"}]}},{"configMap":{"name":"rabbitmq-cluster-server-conf","items":[{"key":"operatorDefaults.conf","path":"operatorDefaults.conf"},{"key":"userDefinedConfiguration.conf","path":"userDefinedConfiguration.conf"}]}}],"defaultMode":420}},{"name":"rabbitmq-erlang-cookie","emptyDir":{}},{"name":"erlang-cookie-secret","secret":{"secretName":"rabbitmq-cluster-erlang-cookie","defaultMode":420}},{"name":"rabbitmq-plugins","emptyDir":{}},{"name":"pod-info","downwardAPI":{"items":[{"path":"skipPreStopChecks","fieldRef":{"apiVersion":"v1","fieldPath":"metadata.labels['skipPreStopChecks']"}}],"defaultMode":420}}],"initContainers":[{"name":"setup-container","image":"rabbitmq:3.8.12-management","command":["sh","-c","cp /tmp/erlang-cookie-secret/.erlang.cookie /var/lib/rabbitmq/.erlang.cookie \u0026\u0026 chown 999:999 /var/lib/rabbitmq/.erlang.cookie \u0026\u0026 chmod 600 /var/lib/rabbitmq/.erlang.cookie ; cp /tmp/rabbitmq-plugins/enabled_plugins /operator/enabled_plugins \u0026\u0026 chown 999:999 /operator/enabled_plugins ; chown 999:999 /var/lib/rabbitmq/mnesia/ ; echo '[default]' \u003e /var/lib/rabbitmq/.rabbitmqadmin.conf \u0026\u0026 sed -e 's/default_user/username/' -e 's/default_pass/password/' /tmp/default_user.conf \u003e\u003e /var/lib/rabbitmq/.rabbitmqadmin.conf \u0026\u0026 chown 999:999 /var/lib/rabbitmq/.rabbitmqadmin.conf \u0026\u0026 chmod 600 /var/lib/rabbitmq/.rabbitmqadmin.conf"],"resources":{"limits":{"cpu":"100m","memory":"500Mi"},"requests":{"cpu":"100m","memory":"500Mi"}},"volumeMounts":[{"name":"plugins-conf","mountPath":"/tmp/rabbitmq-plugins/"},{"name":"rabbitmq-erlang-cookie","mountPath":"/var/lib/rabbitmq/"},{"name":"erlang-cookie-secret","mountPath":"/tmp/erlang-cookie-secret/"},{"name":"rabbitmq-plugins","mountPath":"/operator"},{"name":"persistence","mountPath":"/var/lib/rabbitmq/mnesia/"},{"name":"rabbitmq-confd","mountPath":"/tmp/default_user.conf","subPath":"default_user.conf"}],"terminationMessagePath":"/dev/termination-log","terminationMessagePolicy":"File","imagePullPolicy":"IfNotPresent","securityContext":{"capabilities":{"drop":["FSETID","KILL","SETGID","SETUID","SETPCAP","NET_BIND_SERVICE","NET_RAW","SYS_CHROOT","MKNOD","AUDIT_WRITE","SETFCAP"]},"runAsUser":0}}],"containers":[{"name":"rabbitmq","image":"rabbitmq:3.8.12-management","ports":[{"name":"epmd","containerPort":4369,"protocol":"TCP"},{"name":"amqp","containerPort":5672,"protocol":"TCP"},{"name":"management","containerPort":15672,"protocol":"TCP"},{"name":"prometheus","containerPort":15692,"protocol":"TCP"}],"env":[{"name":"MY_POD_NAME","valueFrom":{"fieldRef":{"apiVersion":"v1","fieldPath":"metadata.name"}}},{"name":"MY_POD_NAMESPACE","valueFrom":{"fieldRef":{"apiVersion":"v1","fieldPath":"metadata.namespace"}}},{"name":"RABBITMQ_ENABLED_PLUGINS_FILE","value":"/operator/enabled_plugins"},{"name":"K8S_SERVICE_NAME","value":"rabbitmq-cluster-nodes"},{"name":"RABBITMQ_USE_LONGNAME","value":"true"},{"name":"RABBITMQ_NODENAME","value":"rabbit@$(MY_POD_NAME).$(K8S_SERVICE_NAME).$(MY_POD_NAMESPACE)"},{"name":"K8S_HOSTNAME_SUFFIX","value":".$(K8S_SERVICE_NAME).$(MY_POD_NAMESPACE)"}],"resources":{"limits":{"cpu":"2","memory":"2Gi"},"requests":{"cpu":"1","memory":"2Gi"}},"volumeMounts":[{"name":"rabbitmq-erlang-cookie","mountPath":"/var/lib/rabbitmq/"},{"name":"persistence","mountPath":"/var/lib/rabbitmq/mnesia/"},{"name":"rabbitmq-plugins","mountPath":"/operator"},{"name":"rabbitmq-confd","mountPath":"/etc/rabbitmq/conf.d/10-operatorDefaults.conf","subPath":"operatorDefaults.conf"},{"name":"rabbitmq-confd","mountPath":"/etc/rabbitmq/conf.d/11-default_user.conf","subPath":"default_user.conf"},{"name":"rabbitmq-confd","mountPath":"/etc/rabbitmq/conf.d/90-userDefinedConfiguration.conf","subPath":"userDefinedConfiguration.conf"},{"name":"pod-info","mountPath":"/etc/pod-info/"}],"readinessProbe":{"tcpSocket":{"port":"amqp"},"initialDelaySeconds":10,"timeoutSeconds":5,"periodSeconds":10,"successThreshold":1,"failureThreshold":3},"lifecycle":{"preStop":{"exec":{"command":["/bin/bash","-c","if [ ! -z \"$(cat /etc/pod-info/skipPreStopChecks)\" ]; then exit 0; fi; rabbitmq-upgrade await_online_quorum_plus_one -t 604800; rabbitmq-upgrade await_online_synchronized_mirror -t 604800; rabbitmq-upgrade drain -t 604800"]}}},"terminationMessagePath":"/dev/termination-log","terminationMessagePolicy":"File","imagePullPolicy":"IfNotPresent"}],"restartPolicy":"Always","terminationGracePeriodSeconds":604800,"dnsPolicy":"ClusterFirst","serviceAccountName":"rabbitmq-cluster-server","serviceAccount":"rabbitmq-cluster-server","automountServiceAccountToken":true,"securityContext":{"runAsUser":999,"runAsGroup":999,"fsGroup":999},"schedulerName":"default-scheduler","topologySpreadConstraints":[{"maxSkew":1,"topologyKey":"topology.kubernetes.io/zone","whenUnsatisfiable":"ScheduleAnyway","labelSelector":{"matchLabels":{"app.kubernetes.io/name":"rabbitmq-cluster"}}}]}},"volumeClaimTemplates":[{"metadata":{"name":"persistence","namespace":"default","creationTimestamp":null,"labels":{"app.kubernetes.io/component":"rabbitmq","app.kubernetes.io/name":"rabbitmq-cluster","app.kubernetes.io/part-of":"rabbitmq"},"ownerReferences":[{"apiVersion":"rabbitmq.com/v1beta1","kind":"RabbitmqCluster","name":"rabbitmq-cluster","uid":"3ecefa8a-1bec-48a7-9af4-dd0df3339101","controller":true,"blockOwnerDeletion":false}]},"spec":{"accessModes":["ReadWriteOnce"],"resources":{"requests":{"storage":"10Gi"}},"volumeMode":"Filesystem"},"status":{"phase":"Pending"}}],"serviceName":"rabbitmq-cluster-nodes","podManagementPolicy":"Parallel","updateStrategy":{"type":"RollingUpdate","rollingUpdate":{"partition":0}},"revisionHistoryLimit":10},"status":{"observedGeneration":1,"replicas":1,"currentReplicas":1,"updatedReplicas":1,"currentRevision":"rabbitmq-cluster-server-5f8b8665fb","updateRevision":"rabbitmq-cluster-server-5f8b8665fb","collisionCount":0}}
2022/03/18 18:06:25 learn_server.go:291: [SIEVE-AFTER-READ]	Get	true	configmap	default	rabbitmq-cluster-server-conf	github.com/rabbitmq/cluster-operator/controllers.(*RabbitmqClusterReconciler)	NoError	{"kind":"ConfigMap","apiVersion":"v1","metadata":{"name":"rabbitmq-cluster-server-conf","namespace":"default","selfLink":"/api/v1/namespaces/default/configmaps/rabbitmq-cluster-server-conf","uid":"e4182078-d429-4baf-9021-72618c509ac5","resourceVersion":"1095","creationTimestamp":"2022-03-18T18:06:25Z","labels":{"app.kubernetes.io/component":"rabbitmq","app.kubernetes.io/name":"rabbitmq-cluster","app.kubernetes.io/part-of":"rabbitmq"},"ownerReferences":[{"apiVersion":"rabbitmq.com/v1beta1","kind":"RabbitmqCluster","name":"rabbitmq-cluster","uid":"3ecefa8a-1bec-48a7-9af4-dd0df3339101","controller":true,"blockOwnerDeletion":true}],"managedFields":[{"manager":"manager","operation":"Update","apiVersion":"v1","time":"2022-03-18T18:06:25Z","fieldsType":"FieldsV1","fieldsV1":{"f:data":{".":{},"f:operatorDefaults.conf":{},"f:userDefinedConfiguration.conf":{}},"f:metadata":{"f:labels":{".":{},"f:app.kubernetes.io/component":{},"f:app.kubernetes.io/name":{},"f:app.kubernetes.io/part-of":{}},"f:ownerReferences":{".":{},"k:{\"uid\":\"3ecefa8a-1bec-48a7-9af4-dd0df3339101\"}":{".":{},"f:apiVersion":{},"f:blockOwnerDeletion":{},"f:controller":{},"f:kind":{},"f:name":{},"f:uid":{}}}}}}]},"data":{"operatorDefaults.conf":"cluster_formation.peer_discovery_backend             = rabbit_peer_discovery_k8s\ncluster_formation.k8s.host                           = kubernetes.default\ncluster_formation.k8s.address_type                   = hostname\ncluster_partition_handling                           = pause_minority\nqueue_master_locator                                 = min-masters\ndisk_free_limit.absolute                             = 2GB\ncluster_formation.randomized_startup_delay_range.min = 5\ncluster_formation.randomized_startup_delay_range.max = 30\ncluster_name                                         = rabbitmq-cluster\n","userDefinedConfiguration.conf":"total_memory_available_override_value = 1717986919\n"}}
2022/03/18 18:06:25 learn_server.go:256: [SIEVE-BEFORE-WRITE]	17
2022/03/18 18:06:25 learn_server.go:263: [SIEVE-AFTER-WRITE]	17	StatusUpdate	rabbitmqcluster	github.com/rabbitmq/cluster-operator/controllers.(*RabbitmqClusterReconciler)	NoError	{"metadata":{"name":"rabbitmq-cluster","namespace":"default","selfLink":"/apis/rabbitmq.com/v1beta1/namespaces/default/rabbitmqclusters/rabbitmq-cluster/status","uid":"3ecefa8a-1bec-48a7-9af4-dd0df3339101","resourceVersion":"1132","generation":2,"creationTimestamp":"2022-03-18T18:06:25Z","annotations":{"kubectl.kubernetes.io/last-applied-configuration":"{\"apiVersion\":\"rabbitmq.com/v1beta1\",\"kind\":\"RabbitmqCluster\",\"metadata\":{\"annotations\":{},\"name\":\"rabbitmq-cluster\",\"namespace\":\"default\"},\"spec\":{\"persistence\":{\"storage\":\"10Gi\"},\"replicas\":1}}\n"},"finalizers":["deletion.finalizers.rabbitmqclusters.rabbitmq.com"],"managedFields":[{"manager":"kubectl-client-side-apply","operation":"Update","apiVersion":"rabbitmq.com/v1beta1","time":"2022-03-18T18:06:25Z","fieldsType":"FieldsV1","fieldsV1":{"f:metadata":{"f:annotations":{".":{},"f:kubectl.kubernetes.io/last-applied-configuration":{}}},"f:spec":{".":{},"f:image":{},"f:persistence":{".":{},"f:storage":{}},"f:replicas":{},"f:resources":{".":{},"f:limits":{".":{},"f:memory":{}},"f:requests":{".":{},"f:memory":{}}},"f:service":{".":{},"f:type":{}},"f:terminationGracePeriodSeconds":{}}}},{"manager":"manager","operation":"Update","apiVersion":"rabbitmq.com/v1beta1","time":"2022-03-18T18:06:25Z","fieldsType":"FieldsV1","fieldsV1":{"f:metadata":{"f:finalizers":{}},"f:spec":{"f:override":{},"f:rabbitmq":{},"f:resources":{"f:limits":{"f:cpu":{}},"f:requests":{"f:cpu":{}}},"f:tls":{}},"f:status":{".":{},"f:conditions":{},"f:defaultUser":{".":{},"f:secretReference":{".":{},"f:keys":{".":{},"f:password":{},"f:username":{}},"f:name":{},"f:namespace":{}},"f:serviceReference":{".":{},"f:name":{},"f:namespace":{}}}}}}]},"spec":{"replicas":1,"image":"rabbitmq:3.8.12-management","service":{"type":"ClusterIP"},"persistence":{"storage":"10Gi"},"resources":{"limits":{"cpu":"2","memory":"2Gi"},"requests":{"cpu":"1","memory":"2Gi"}},"rabbitmq":{},"tls":{},"override":{},"terminationGracePeriodSeconds":604800},"status":{"conditions":[{"type":"AllReplicasReady","status":"False","lastTransitionTime":"2022-03-18T18:06:25Z","reason":"NotAllPodsReady","message":"0/1 Pods ready"},{"type":"ClusterAvailable","status":"False","lastTransitionTime":"2022-03-18T18:06:25Z","reason":"NoEndpointsAvailable","message":"The service has no endpoints available"},{"type":"NoWarnings","status":"True","lastTransitionTime":"2022-03-18T18:06:25Z","reason":"NoWarnings"},{"type":"ReconcileSuccess","status":"Unknown","lastTransitionTime":"2022-03-18T18:06:25Z","reason":"Initialising"}],"defaultUser":{"secretReference":{"name":"rabbitmq-cluster-default-user","namespace":"default","keys":{"password":"password","username":"username"}},"serviceReference":{"name":"rabbitmq-cluster","namespace":"default"}},"binding":{"name":"rabbitmq-cluster-default-user"}}}
2022/03/18 18:06:25 learn_server.go:291: [SIEVE-AFTER-READ]	Get	true	statefulset	default	rabbitmq-cluster-server	github.com/rabbitmq/cluster-operator/controllers.(*RabbitmqClusterReconciler)	NoError	{"kind":"StatefulSet","apiVersion":"apps/v1","metadata":{"name":"rabbitmq-cluster-server","namespace":"default","selfLink":"/apis/apps/v1/namespaces/default/statefulsets/rabbitmq-cluster-server","uid":"f2f07f3e-b500-4c48-a5de-8db7eaf37b9a","resourceVersion":"1129","generation":1,"creationTimestamp":"2022-03-18T18:06:25Z","labels":{"app.kubernetes.io/component":"rabbitmq","app.kubernetes.io/name":"rabbitmq-cluster","app.kubernetes.io/part-of":"rabbitmq"},"annotations":{"rabbitmq.com/createdAt":"2022-03-18T18:06:25Z"},"ownerReferences":[{"apiVersion":"rabbitmq.com/v1beta1","kind":"RabbitmqCluster","name":"rabbitmq-cluster","uid":"3ecefa8a-1bec-48a7-9af4-dd0df3339101","controller":true,"blockOwnerDeletion":true}],"managedFields":[{"manager":"kube-controller-manager","operation":"Update","apiVersion":"apps/v1","time":"2022-03-18T18:06:25Z","fieldsType":"FieldsV1","fieldsV1":{"f:status":{"f:collisionCount":{},"f:currentReplicas":{},"f:currentRevision":{},"f:observedGeneration":{},"f:replicas":{},"f:updateRevision":{},"f:updatedReplicas":{}}}},{"manager":"manager","operation":"Update","apiVersion":"apps/v1","time":"2022-03-18T18:06:25Z","fieldsType":"FieldsV1","fieldsV1":{"f:metadata":{"f:annotations":{".":{},"f:rabbitmq.com/createdAt":{}},"f:labels":{".":{},"f:app.kubernetes.io/component":{},"f:app.kubernetes.io/name":{},"f:app.kubernetes.io/part-of":{}},"f:ownerReferences":{".":{},"k:{\"uid\":\"3ecefa8a-1bec-48a7-9af4-dd0df3339101\"}":{".":{},"f:apiVersion":{},"f:blockOwnerDeletion":{},"f:controller":{},"f:kind":{},"f:name":{},"f:uid":{}}}},"f:spec":{"f:podManagementPolicy":{},"f:replicas":{},"f:revisionHistoryLimit":{},"f:selector":{"f:matchLabels":{".":{},"f:app.kubernetes.io/name":{}}},"f:serviceName":{},"f:template":{"f:metadata":{"f:annotations":{".":{},"f:prometheus.io/port":{},"f:prometheus.io/scrape":{}},"f:labels":{".":{},"f:app.kubernetes.io/component":{},"f:app.kubernetes.io/name":{},"f:app.kubernetes.io/part-of":{}}},"f:spec":{"f:automountServiceAccountToken":{},"f:containers":{"k:{\"name\":\"rabbitmq\"}":{".":{},"f:env":{".":{},"k:{\"name\":\"K8S_HOSTNAME_SUFFIX\"}":{".":{},"f:name":{},"f:value":{}},"k:{\"name\":\"K8S_SERVICE_NAME\"}":{".":{},"f:name":{},"f:value":{}},"k:{\"name\":\"MY_POD_NAME\"}":{".":{},"f:name":{},"f:valueFrom":{".":{},"f:fieldRef":{".":{},"f:apiVersion":{},"f:fieldPath":{}}}},"k:{\"name\":\"MY_POD_NAMESPACE\"}":{".":{},"f:name":{},"f:valueFrom":{".":{},"f:fieldRef":{".":{},"f:apiVersion":{},"f:fieldPath":{}}}},"k:{\"name\":\"RABBITMQ_ENABLED_PLUGINS_FILE\"}":{".":{},"f:name":{},"f:value":{}},"k:{\"name\":\"RABBITMQ_NODENAME\"}":{".":{},"f:name":{},"f:value":{}},"k:{\"name\":\"RABBITMQ_USE_LONGNAME\"}":{".":{},"f:name":{},"f:value":{}}},"f:image":{},"f:imagePullPolicy":{},"f:lifecycle":{".":{},"f:preStop":{".":{},"f:exec":{".":{},"f:command":{}}}},"f:name":{},"f:ports":{".":{},"k:{\"containerPort\":4369,\"protocol\":\"TCP\"}":{".":{},"f:containerPort":{},"f:name":{},"f:protocol":{}},"k:{\"containerPort\":5672,\"protocol\":\"TCP\"}":{".":{},"f:containerPort":{},"f:name":{},"f:protocol":{}},"k:{\"containerPort\":15672,\"protocol\":\"TCP\"}":{".":{},"f:containerPort":{},"f:name":{},"f:protocol":{}},"k:{\"containerPort\":15692,\"protocol\":\"TCP\"}":{".":{},"f:containerPort":{},"f:name":{},"f:protocol":{}}},"f:readinessProbe":{".":{},"f:failureThreshold":{},"f:initialDelaySeconds":{},"f:periodSeconds":{},"f:successThreshold":{},"f:tcpSocket":{".":{},"f:port":{}},"f:timeoutSeconds":{}},"f:resources":{".":{},"f:limits":{".":{},"f:cpu":{},"f:memory":{}},"f:requests":{".":{},"f:cpu":{},"f:memory":{}}},"f:terminationMessagePath":{},"f:terminationMessagePolicy":{},"f:volumeMounts":{".":{},"k:{\"mountPath\":\"/etc/pod-info/\"}":{".":{},"f:mountPath":{},"f:name":{}},"k:{\"mountPath\":\"/etc/rabbitmq/conf.d/10-operatorDefaults.conf\"}":{".":{},"f:mountPath":{},"f:name":{},"f:subPath":{}},"k:{\"mountPath\":\"/etc/rabbitmq/conf.d/11-default_user.conf\"}":{".":{},"f:mountPath":{},"f:name":{},"f:subPath":{}},"k:{\"mountPath\":\"/etc/rabbitmq/conf.d/90-userDefinedConfiguration.conf\"}":{".":{},"f:mountPath":{},"f:name":{},"f:subPath":{}},"k:{\"mountPath\":\"/operator\"}":{".":{},"f:mountPath":{},"f:name":{}},"k:{\"mountPath\":\"/var/lib/rabbitmq/\"}":{".":{},"f:mountPath":{},"f:name":{}},"k:{\"mountPath\":\"/var/lib/rabbitmq/mnesia/\"}":{".":{},"f:mountPath":{},"f:name":{}}}}},"f:dnsPolicy":{},"f:initContainers":{".":{},"k:{\"name\":\"setup-container\"}":{".":{},"f:command":{},"f:image":{},"f:imagePullPolicy":{},"f:name":{},"f:resources":{".":{},"f:limits":{".":{},"f:cpu":{},"f:memory":{}},"f:requests":{".":{},"f:cpu":{},"f:memory":{}}},"f:securityContext":{".":{},"f:capabilities":{".":{},"f:drop":{}},"f:runAsUser":{}},"f:terminationMessagePath":{},"f:terminationMessagePolicy":{},"f:volumeMounts":{".":{},"k:{\"mountPath\":\"/operator\"}":{".":{},"f:mountPath":{},"f:name":{}},"k:{\"mountPath\":\"/tmp/default_user.conf\"}":{".":{},"f:mountPath":{},"f:name":{},"f:subPath":{}},"k:{\"mountPath\":\"/tmp/erlang-cookie-secret/\"}":{".":{},"f:mountPath":{},"f:name":{}},"k:{\"mountPath\":\"/tmp/rabbitmq-plugins/\"}":{".":{},"f:mountPath":{},"f:name":{}},"k:{\"mountPath\":\"/var/lib/rabbitmq/\"}":{".":{},"f:mountPath":{},"f:name":{}},"k:{\"mountPath\":\"/var/lib/rabbitmq/mnesia/\"}":{".":{},"f:mountPath":{},"f:name":{}}}}},"f:restartPolicy":{},"f:schedulerName":{},"f:securityContext":{".":{},"f:fsGroup":{},"f:runAsGroup":{},"f:runAsUser":{}},"f:serviceAccount":{},"f:serviceAccountName":{},"f:terminationGracePeriodSeconds":{},"f:topologySpreadConstraints":{".":{},"k:{\"topologyKey\":\"topology.kubernetes.io/zone\",\"whenUnsatisfiable\":\"ScheduleAnyway\"}":{".":{},"f:labelSelector":{".":{},"f:matchLabels":{".":{},"f:app.kubernetes.io/name":{}}},"f:maxSkew":{},"f:topologyKey":{},"f:whenUnsatisfiable":{}}},"f:volumes":{".":{},"k:{\"name\":\"erlang-cookie-secret\"}":{".":{},"f:name":{},"f:secret":{".":{},"f:defaultMode":{},"f:secretName":{}}},"k:{\"name\":\"plugins-conf\"}":{".":{},"f:configMap":{".":{},"f:defaultMode":{},"f:name":{}},"f:name":{}},"k:{\"name\":\"pod-info\"}":{".":{},"f:downwardAPI":{".":{},"f:defaultMode":{},"f:items":{}},"f:name":{}},"k:{\"name\":\"rabbitmq-confd\"}":{".":{},"f:name":{},"f:projected":{".":{},"f:defaultMode":{},"f:sources":{}}},"k:{\"name\":\"rabbitmq-erlang-cookie\"}":{".":{},"f:emptyDir":{},"f:name":{}},"k:{\"name\":\"rabbitmq-plugins\"}":{".":{},"f:emptyDir":{},"f:name":{}}}}},"f:updateStrategy":{"f:rollingUpdate":{".":{},"f:partition":{}},"f:type":{}},"f:volumeClaimTemplates":{}}}}]},"spec":{"replicas":1,"selector":{"matchLabels":{"app.kubernetes.io/name":"rabbitmq-cluster"}},"template":{"metadata":{"creationTimestamp":null,"labels":{"app.kubernetes.io/component":"rabbitmq","app.kubernetes.io/name":"rabbitmq-cluster","app.kubernetes.io/part-of":"rabbitmq"},"annotations":{"prometheus.io/port":"15692","prometheus.io/scrape":"true"}},"spec":{"volumes":[{"name":"plugins-conf","configMap":{"name":"rabbitmq-cluster-plugins-conf","defaultMode":420}},{"name":"rabbitmq-confd","projected":{"sources":[{"secret":{"name":"rabbitmq-cluster-default-user","items":[{"key":"default_user.conf","path":"default_user.conf"}]}},{"configMap":{"name":"rabbitmq-cluster-server-conf","items":[{"key":"operatorDefaults.conf","path":"operatorDefaults.conf"},{"key":"userDefinedConfiguration.conf","path":"userDefinedConfiguration.conf"}]}}],"defaultMode":420}},{"name":"rabbitmq-erlang-cookie","emptyDir":{}},{"name":"erlang-cookie-secret","secret":{"secretName":"rabbitmq-cluster-erlang-cookie","defaultMode":420}},{"name":"rabbitmq-plugins","emptyDir":{}},{"name":"pod-info","downwardAPI":{"items":[{"path":"skipPreStopChecks","fieldRef":{"apiVersion":"v1","fieldPath":"metadata.labels['skipPreStopChecks']"}}],"defaultMode":420}}],"initContainers":[{"name":"setup-container","image":"rabbitmq:3.8.12-management","command":["sh","-c","cp /tmp/erlang-cookie-secret/.erlang.cookie /var/lib/rabbitmq/.erlang.cookie \u0026\u0026 chown 999:999 /var/lib/rabbitmq/.erlang.cookie \u0026\u0026 chmod 600 /var/lib/rabbitmq/.erlang.cookie ; cp /tmp/rabbitmq-plugins/enabled_plugins /operator/enabled_plugins \u0026\u0026 chown 999:999 /operator/enabled_plugins ; chown 999:999 /var/lib/rabbitmq/mnesia/ ; echo '[default]' \u003e /var/lib/rabbitmq/.rabbitmqadmin.conf \u0026\u0026 sed -e 's/default_user/username/' -e 's/default_pass/password/' /tmp/default_user.conf \u003e\u003e /var/lib/rabbitmq/.rabbitmqadmin.conf \u0026\u0026 chown 999:999 /var/lib/rabbitmq/.rabbitmqadmin.conf \u0026\u0026 chmod 600 /var/lib/rabbitmq/.rabbitmqadmin.conf"],"resources":{"limits":{"cpu":"100m","memory":"500Mi"},"requests":{"cpu":"100m","memory":"500Mi"}},"volumeMounts":[{"name":"plugins-conf","mountPath":"/tmp/rabbitmq-plugins/"},{"name":"rabbitmq-erlang-cookie","mountPath":"/var/lib/rabbitmq/"},{"name":"erlang-cookie-secret","mountPath":"/tmp/erlang-cookie-secret/"},{"name":"rabbitmq-plugins","mountPath":"/operator"},{"name":"persistence","mountPath":"/var/lib/rabbitmq/mnesia/"},{"name":"rabbitmq-confd","mountPath":"/tmp/default_user.conf","subPath":"default_user.conf"}],"terminationMessagePath":"/dev/termination-log","terminationMessagePolicy":"File","imagePullPolicy":"IfNotPresent","securityContext":{"capabilities":{"drop":["FSETID","KILL","SETGID","SETUID","SETPCAP","NET_BIND_SERVICE","NET_RAW","SYS_CHROOT","MKNOD","AUDIT_WRITE","SETFCAP"]},"runAsUser":0}}],"containers":[{"name":"rabbitmq","image":"rabbitmq:3.8.12-management","ports":[{"name":"epmd","containerPort":4369,"protocol":"TCP"},{"name":"amqp","containerPort":5672,"protocol":"TCP"},{"name":"management","containerPort":15672,"protocol":"TCP"},{"name":"prometheus","containerPort":15692,"protocol":"TCP"}],"env":[{"name":"MY_POD_NAME","valueFrom":{"fieldRef":{"apiVersion":"v1","fieldPath":"metadata.name"}}},{"name":"MY_POD_NAMESPACE","valueFrom":{"fieldRef":{"apiVersion":"v1","fieldPath":"metadata.namespace"}}},{"name":"RABBITMQ_ENABLED_PLUGINS_FILE","value":"/operator/enabled_plugins"},{"name":"K8S_SERVICE_NAME","value":"rabbitmq-cluster-nodes"},{"name":"RABBITMQ_USE_LONGNAME","value":"true"},{"name":"RABBITMQ_NODENAME","value":"rabbit@$(MY_POD_NAME).$(K8S_SERVICE_NAME).$(MY_POD_NAMESPACE)"},{"name":"K8S_HOSTNAME_SUFFIX","value":".$(K8S_SERVICE_NAME).$(MY_POD_NAMESPACE)"}],"resources":{"limits":{"cpu":"2","memory":"2Gi"},"requests":{"cpu":"1","memory":"2Gi"}},"volumeMounts":[{"name":"rabbitmq-erlang-cookie","mountPath":"/var/lib/rabbitmq/"},{"name":"persistence","mountPath":"/var/lib/rabbitmq/mnesia/"},{"name":"rabbitmq-plugins","mountPath":"/operator"},{"name":"rabbitmq-confd","mountPath":"/etc/rabbitmq/conf.d/10-operatorDefaults.conf","subPath":"operatorDefaults.conf"},{"name":"rabbitmq-confd","mountPath":"/etc/rabbitmq/conf.d/11-default_user.conf","subPath":"default_user.conf"},{"name":"rabbitmq-confd","mountPath":"/etc/rabbitmq/conf.d/90-userDefinedConfiguration.conf","subPath":"userDefinedConfiguration.conf"},{"name":"pod-info","mountPath":"/etc/pod-info/"}],"readinessProbe":{"tcpSocket":{"port":"amqp"},"initialDelaySeconds":10,"timeoutSeconds":5,"periodSeconds":10,"successThreshold":1,"failureThreshold":3},"lifecycle":{"preStop":{"exec":{"command":["/bin/bash","-c","if [ ! -z \"$(cat /etc/pod-info/skipPreStopChecks)\" ]; then exit 0; fi; rabbitmq-upgrade await_online_quorum_plus_one -t 604800; rabbitmq-upgrade await_online_synchronized_mirror -t 604800; rabbitmq-upgrade drain -t 604800"]}}},"terminationMessagePath":"/dev/termination-log","terminationMessagePolicy":"File","imagePullPolicy":"IfNotPresent"}],"restartPolicy":"Always","terminationGracePeriodSeconds":604800,"dnsPolicy":"ClusterFirst","serviceAccountName":"rabbitmq-cluster-server","serviceAccount":"rabbitmq-cluster-server","automountServiceAccountToken":true,"securityContext":{"runAsUser":999,"runAsGroup":999,"fsGroup":999},"schedulerName":"default-scheduler","topologySpreadConstraints":[{"maxSkew":1,"topologyKey":"topology.kubernetes.io/zone","whenUnsatisfiable":"ScheduleAnyway","labelSelector":{"matchLabels":{"app.kubernetes.io/name":"rabbitmq-cluster"}}}]}},"volumeClaimTemplates":[{"metadata":{"name":"persistence","namespace":"default","creationTimestamp":null,"labels":{"app.kubernetes.io/component":"rabbitmq","app.kubernetes.io/name":"rabbitmq-cluster","app.kubernetes.io/part-of":"rabbitmq"},"ownerReferences":[{"apiVersion":"rabbitmq.com/v1beta1","kind":"RabbitmqCluster","name":"rabbitmq-cluster","uid":"3ecefa8a-1bec-48a7-9af4-dd0df3339101","controller":true,"blockOwnerDeletion":false}]},"spec":{"accessModes":["ReadWriteOnce"],"resources":{"requests":{"storage":"10Gi"}},"volumeMode":"Filesystem"},"status":{"phase":"Pending"}}],"serviceName":"rabbitmq-cluster-nodes","podManagementPolicy":"Parallel","updateStrategy":{"type":"RollingUpdate","rollingUpdate":{"partition":0}},"revisionHistoryLimit":10},"status":{"observedGeneration":1,"replicas":1,"currentReplicas":1,"updatedReplicas":1,"currentRevision":"rabbitmq-cluster-server-5f8b8665fb","updateRevision":"rabbitmq-cluster-server-5f8b8665fb","collisionCount":0}}
2022/03/18 18:06:25 learn_server.go:253: [SIEVE-AFTER-RECONCILE]	github.com/rabbitmq/cluster-operator/controllers.(*RabbitmqClusterReconciler)	1
2022/03/18 18:06:25 learn_server.go:238: [SIEVE-BEFORE-RECONCILE]	github.com/rabbitmq/cluster-operator/controllers.(*RabbitmqClusterReconciler)	2
2022/03/18 18:06:25 learn_server.go:291: [SIEVE-AFTER-READ]	Get	true	rabbitmqcluster	default	rabbitmq-cluster	github.com/rabbitmq/cluster-operator/controllers.(*RabbitmqClusterReconciler)	NoError	{"kind":"RabbitmqCluster","apiVersion":"rabbitmq.com/v1beta1","metadata":{"name":"rabbitmq-cluster","namespace":"default","selfLink":"/apis/rabbitmq.com/v1beta1/namespaces/default/rabbitmqclusters/rabbitmq-cluster","uid":"3ecefa8a-1bec-48a7-9af4-dd0df3339101","resourceVersion":"1132","generation":2,"creationTimestamp":"2022-03-18T18:06:25Z","annotations":{"kubectl.kubernetes.io/last-applied-configuration":"{\"apiVersion\":\"rabbitmq.com/v1beta1\",\"kind\":\"RabbitmqCluster\",\"metadata\":{\"annotations\":{},\"name\":\"rabbitmq-cluster\",\"namespace\":\"default\"},\"spec\":{\"persistence\":{\"storage\":\"10Gi\"},\"replicas\":1}}\n"},"finalizers":["deletion.finalizers.rabbitmqclusters.rabbitmq.com"],"managedFields":[{"manager":"kubectl-client-side-apply","operation":"Update","apiVersion":"rabbitmq.com/v1beta1","time":"2022-03-18T18:06:25Z","fieldsType":"FieldsV1","fieldsV1":{"f:metadata":{"f:annotations":{".":{},"f:kubectl.kubernetes.io/last-applied-configuration":{}}},"f:spec":{".":{},"f:image":{},"f:persistence":{".":{},"f:storage":{}},"f:replicas":{},"f:resources":{".":{},"f:limits":{".":{},"f:memory":{}},"f:requests":{".":{},"f:memory":{}}},"f:service":{".":{},"f:type":{}},"f:terminationGracePeriodSeconds":{}}}},{"manager":"manager","operation":"Update","apiVersion":"rabbitmq.com/v1beta1","time":"2022-03-18T18:06:25Z","fieldsType":"FieldsV1","fieldsV1":{"f:metadata":{"f:finalizers":{}},"f:spec":{"f:override":{},"f:rabbitmq":{},"f:resources":{"f:limits":{"f:cpu":{}},"f:requests":{"f:cpu":{}}},"f:tls":{}},"f:status":{".":{},"f:conditions":{},"f:defaultUser":{".":{},"f:secretReference":{".":{},"f:keys":{".":{},"f:password":{},"f:username":{}},"f:name":{},"f:namespace":{}},"f:serviceReference":{".":{},"f:name":{},"f:namespace":{}}}}}}]},"spec":{"replicas":1,"image":"rabbitmq:3.8.12-management","service":{"type":"ClusterIP"},"persistence":{"storage":"10Gi"},"resources":{"limits":{"cpu":"2","memory":"2Gi"},"requests":{"cpu":"1","memory":"2Gi"}},"rabbitmq":{},"tls":{},"override":{},"terminationGracePeriodSeconds":604800},"status":{"conditions":[{"type":"AllReplicasReady","status":"False","lastTransitionTime":"2022-03-18T18:06:25Z","reason":"NotAllPodsReady","message":"0/1 Pods ready"},{"type":"ClusterAvailable","status":"False","lastTransitionTime":"2022-03-18T18:06:25Z","reason":"NoEndpointsAvailable","message":"The service has no endpoints available"},{"type":"NoWarnings","status":"True","lastTransitionTime":"2022-03-18T18:06:25Z","reason":"NoWarnings"},{"type":"ReconcileSuccess","status":"Unknown","lastTransitionTime":"2022-03-18T18:06:25Z","reason":"Initialising"}],"defaultUser":{"secretReference":{"name":"rabbitmq-cluster-default-user","namespace":"default","keys":{"password":"password","username":"username"}},"serviceReference":{"name":"rabbitmq-cluster","namespace":"default"}}}}
2022/03/18 18:06:25 learn_server.go:291: [SIEVE-AFTER-READ]	Get	true	statefulset	default	rabbitmq-cluster-server	github.com/rabbitmq/cluster-operator/controllers.(*RabbitmqClusterReconciler)	NoError	{"kind":"StatefulSet","apiVersion":"apps/v1","metadata":{"name":"rabbitmq-cluster-server","namespace":"default","selfLink":"/apis/apps/v1/namespaces/default/statefulsets/rabbitmq-cluster-server","uid":"f2f07f3e-b500-4c48-a5de-8db7eaf37b9a","resourceVersion":"1129","generation":1,"creationTimestamp":"2022-03-18T18:06:25Z","labels":{"app.kubernetes.io/component":"rabbitmq","app.kubernetes.io/name":"rabbitmq-cluster","app.kubernetes.io/part-of":"rabbitmq"},"annotations":{"rabbitmq.com/createdAt":"2022-03-18T18:06:25Z"},"ownerReferences":[{"apiVersion":"rabbitmq.com/v1beta1","kind":"RabbitmqCluster","name":"rabbitmq-cluster","uid":"3ecefa8a-1bec-48a7-9af4-dd0df3339101","controller":true,"blockOwnerDeletion":true}],"managedFields":[{"manager":"kube-controller-manager","operation":"Update","apiVersion":"apps/v1","time":"2022-03-18T18:06:25Z","fieldsType":"FieldsV1","fieldsV1":{"f:status":{"f:collisionCount":{},"f:currentReplicas":{},"f:currentRevision":{},"f:observedGeneration":{},"f:replicas":{},"f:updateRevision":{},"f:updatedReplicas":{}}}},{"manager":"manager","operation":"Update","apiVersion":"apps/v1","time":"2022-03-18T18:06:25Z","fieldsType":"FieldsV1","fieldsV1":{"f:metadata":{"f:annotations":{".":{},"f:rabbitmq.com/createdAt":{}},"f:labels":{".":{},"f:app.kubernetes.io/component":{},"f:app.kubernetes.io/name":{},"f:app.kubernetes.io/part-of":{}},"f:ownerReferences":{".":{},"k:{\"uid\":\"3ecefa8a-1bec-48a7-9af4-dd0df3339101\"}":{".":{},"f:apiVersion":{},"f:blockOwnerDeletion":{},"f:controller":{},"f:kind":{},"f:name":{},"f:uid":{}}}},"f:spec":{"f:podManagementPolicy":{},"f:replicas":{},"f:revisionHistoryLimit":{},"f:selector":{"f:matchLabels":{".":{},"f:app.kubernetes.io/name":{}}},"f:serviceName":{},"f:template":{"f:metadata":{"f:annotations":{".":{},"f:prometheus.io/port":{},"f:prometheus.io/scrape":{}},"f:labels":{".":{},"f:app.kubernetes.io/component":{},"f:app.kubernetes.io/name":{},"f:app.kubernetes.io/part-of":{}}},"f:spec":{"f:automountServiceAccountToken":{},"f:containers":{"k:{\"name\":\"rabbitmq\"}":{".":{},"f:env":{".":{},"k:{\"name\":\"K8S_HOSTNAME_SUFFIX\"}":{".":{},"f:name":{},"f:value":{}},"k:{\"name\":\"K8S_SERVICE_NAME\"}":{".":{},"f:name":{},"f:value":{}},"k:{\"name\":\"MY_POD_NAME\"}":{".":{},"f:name":{},"f:valueFrom":{".":{},"f:fieldRef":{".":{},"f:apiVersion":{},"f:fieldPath":{}}}},"k:{\"name\":\"MY_POD_NAMESPACE\"}":{".":{},"f:name":{},"f:valueFrom":{".":{},"f:fieldRef":{".":{},"f:apiVersion":{},"f:fieldPath":{}}}},"k:{\"name\":\"RABBITMQ_ENABLED_PLUGINS_FILE\"}":{".":{},"f:name":{},"f:value":{}},"k:{\"name\":\"RABBITMQ_NODENAME\"}":{".":{},"f:name":{},"f:value":{}},"k:{\"name\":\"RABBITMQ_USE_LONGNAME\"}":{".":{},"f:name":{},"f:value":{}}},"f:image":{},"f:imagePullPolicy":{},"f:lifecycle":{".":{},"f:preStop":{".":{},"f:exec":{".":{},"f:command":{}}}},"f:name":{},"f:ports":{".":{},"k:{\"containerPort\":4369,\"protocol\":\"TCP\"}":{".":{},"f:containerPort":{},"f:name":{},"f:protocol":{}},"k:{\"containerPort\":5672,\"protocol\":\"TCP\"}":{".":{},"f:containerPort":{},"f:name":{},"f:protocol":{}},"k:{\"containerPort\":15672,\"protocol\":\"TCP\"}":{".":{},"f:containerPort":{},"f:name":{},"f:protocol":{}},"k:{\"containerPort\":15692,\"protocol\":\"TCP\"}":{".":{},"f:containerPort":{},"f:name":{},"f:protocol":{}}},"f:readinessProbe":{".":{},"f:failureThreshold":{},"f:initialDelaySeconds":{},"f:periodSeconds":{},"f:successThreshold":{},"f:tcpSocket":{".":{},"f:port":{}},"f:timeoutSeconds":{}},"f:resources":{".":{},"f:limits":{".":{},"f:cpu":{},"f:memory":{}},"f:requests":{".":{},"f:cpu":{},"f:memory":{}}},"f:terminationMessagePath":{},"f:terminationMessagePolicy":{},"f:volumeMounts":{".":{},"k:{\"mountPath\":\"/etc/pod-info/\"}":{".":{},"f:mountPath":{},"f:name":{}},"k:{\"mountPath\":\"/etc/rabbitmq/conf.d/10-operatorDefaults.conf\"}":{".":{},"f:mountPath":{},"f:name":{},"f:subPath":{}},"k:{\"mountPath\":\"/etc/rabbitmq/conf.d/11-default_user.conf\"}":{".":{},"f:mountPath":{},"f:name":{},"f:subPath":{}},"k:{\"mountPath\":\"/etc/rabbitmq/conf.d/90-userDefinedConfiguration.conf\"}":{".":{},"f:mountPath":{},"f:name":{},"f:subPath":{}},"k:{\"mountPath\":\"/operator\"}":{".":{},"f:mountPath":{},"f:name":{}},"k:{\"mountPath\":\"/var/lib/rabbitmq/\"}":{".":{},"f:mountPath":{},"f:name":{}},"k:{\"mountPath\":\"/var/lib/rabbitmq/mnesia/\"}":{".":{},"f:mountPath":{},"f:name":{}}}}},"f:dnsPolicy":{},"f:initContainers":{".":{},"k:{\"name\":\"setup-container\"}":{".":{},"f:command":{},"f:image":{},"f:imagePullPolicy":{},"f:name":{},"f:resources":{".":{},"f:limits":{".":{},"f:cpu":{},"f:memory":{}},"f:requests":{".":{},"f:cpu":{},"f:memory":{}}},"f:securityContext":{".":{},"f:capabilities":{".":{},"f:drop":{}},"f:runAsUser":{}},"f:terminationMessagePath":{},"f:terminationMessagePolicy":{},"f:volumeMounts":{".":{},"k:{\"mountPath\":\"/operator\"}":{".":{},"f:mountPath":{},"f:name":{}},"k:{\"mountPath\":\"/tmp/default_user.conf\"}":{".":{},"f:mountPath":{},"f:name":{},"f:subPath":{}},"k:{\"mountPath\":\"/tmp/erlang-cookie-secret/\"}":{".":{},"f:mountPath":{},"f:name":{}},"k:{\"mountPath\":\"/tmp/rabbitmq-plugins/\"}":{".":{},"f:mountPath":{},"f:name":{}},"k:{\"mountPath\":\"/var/lib/rabbitmq/\"}":{".":{},"f:mountPath":{},"f:name":{}},"k:{\"mountPath\":\"/var/lib/rabbitmq/mnesia/\"}":{".":{},"f:mountPath":{},"f:name":{}}}}},"f:restartPolicy":{},"f:schedulerName":{},"f:securityContext":{".":{},"f:fsGroup":{},"f:runAsGroup":{},"f:runAsUser":{}},"f:serviceAccount":{},"f:serviceAccountName":{},"f:terminationGracePeriodSeconds":{},"f:topologySpreadConstraints":{".":{},"k:{\"topologyKey\":\"topology.kubernetes.io/zone\",\"whenUnsatisfiable\":\"ScheduleAnyway\"}":{".":{},"f:labelSelector":{".":{},"f:matchLabels":{".":{},"f:app.kubernetes.io/name":{}}},"f:maxSkew":{},"f:topologyKey":{},"f:whenUnsatisfiable":{}}},"f:volumes":{".":{},"k:{\"name\":\"erlang-cookie-secret\"}":{".":{},"f:name":{},"f:secret":{".":{},"f:defaultMode":{},"f:secretName":{}}},"k:{\"name\":\"plugins-conf\"}":{".":{},"f:configMap":{".":{},"f:defaultMode":{},"f:name":{}},"f:name":{}},"k:{\"name\":\"pod-info\"}":{".":{},"f:downwardAPI":{".":{},"f:defaultMode":{},"f:items":{}},"f:name":{}},"k:{\"name\":\"rabbitmq-confd\"}":{".":{},"f:name":{},"f:projected":{".":{},"f:defaultMode":{},"f:sources":{}}},"k:{\"name\":\"rabbitmq-erlang-cookie\"}":{".":{},"f:emptyDir":{},"f:name":{}},"k:{\"name\":\"rabbitmq-plugins\"}":{".":{},"f:emptyDir":{},"f:name":{}}}}},"f:updateStrategy":{"f:rollingUpdate":{".":{},"f:partition":{}},"f:type":{}},"f:volumeClaimTemplates":{}}}}]},"spec":{"replicas":1,"selector":{"matchLabels":{"app.kubernetes.io/name":"rabbitmq-cluster"}},"template":{"metadata":{"creationTimestamp":null,"labels":{"app.kubernetes.io/component":"rabbitmq","app.kubernetes.io/name":"rabbitmq-cluster","app.kubernetes.io/part-of":"rabbitmq"},"annotations":{"prometheus.io/port":"15692","prometheus.io/scrape":"true"}},"spec":{"volumes":[{"name":"plugins-conf","configMap":{"name":"rabbitmq-cluster-plugins-conf","defaultMode":420}},{"name":"rabbitmq-confd","projected":{"sources":[{"secret":{"name":"rabbitmq-cluster-default-user","items":[{"key":"default_user.conf","path":"default_user.conf"}]}},{"configMap":{"name":"rabbitmq-cluster-server-conf","items":[{"key":"operatorDefaults.conf","path":"operatorDefaults.conf"},{"key":"userDefinedConfiguration.conf","path":"userDefinedConfiguration.conf"}]}}],"defaultMode":420}},{"name":"rabbitmq-erlang-cookie","emptyDir":{}},{"name":"erlang-cookie-secret","secret":{"secretName":"rabbitmq-cluster-erlang-cookie","defaultMode":420}},{"name":"rabbitmq-plugins","emptyDir":{}},{"name":"pod-info","downwardAPI":{"items":[{"path":"skipPreStopChecks","fieldRef":{"apiVersion":"v1","fieldPath":"metadata.labels['skipPreStopChecks']"}}],"defaultMode":420}}],"initContainers":[{"name":"setup-container","image":"rabbitmq:3.8.12-management","command":["sh","-c","cp /tmp/erlang-cookie-secret/.erlang.cookie /var/lib/rabbitmq/.erlang.cookie \u0026\u0026 chown 999:999 /var/lib/rabbitmq/.erlang.cookie \u0026\u0026 chmod 600 /var/lib/rabbitmq/.erlang.cookie ; cp /tmp/rabbitmq-plugins/enabled_plugins /operator/enabled_plugins \u0026\u0026 chown 999:999 /operator/enabled_plugins ; chown 999:999 /var/lib/rabbitmq/mnesia/ ; echo '[default]' \u003e /var/lib/rabbitmq/.rabbitmqadmin.conf \u0026\u0026 sed -e 's/default_user/username/' -e 's/default_pass/password/' /tmp/default_user.conf \u003e\u003e /var/lib/rabbitmq/.rabbitmqadmin.conf \u0026\u0026 chown 999:999 /var/lib/rabbitmq/.rabbitmqadmin.conf \u0026\u0026 chmod 600 /var/lib/rabbitmq/.rabbitmqadmin.conf"],"resources":{"limits":{"cpu":"100m","memory":"500Mi"},"requests":{"cpu":"100m","memory":"500Mi"}},"volumeMounts":[{"name":"plugins-conf","mountPath":"/tmp/rabbitmq-plugins/"},{"name":"rabbitmq-erlang-cookie","mountPath":"/var/lib/rabbitmq/"},{"name":"erlang-cookie-secret","mountPath":"/tmp/erlang-cookie-secret/"},{"name":"rabbitmq-plugins","mountPath":"/operator"},{"name":"persistence","mountPath":"/var/lib/rabbitmq/mnesia/"},{"name":"rabbitmq-confd","mountPath":"/tmp/default_user.conf","subPath":"default_user.conf"}],"terminationMessagePath":"/dev/termination-log","terminationMessagePolicy":"File","imagePullPolicy":"IfNotPresent","securityContext":{"capabilities":{"drop":["FSETID","KILL","SETGID","SETUID","SETPCAP","NET_BIND_SERVICE","NET_RAW","SYS_CHROOT","MKNOD","AUDIT_WRITE","SETFCAP"]},"runAsUser":0}}],"containers":[{"name":"rabbitmq","image":"rabbitmq:3.8.12-management","ports":[{"name":"epmd","containerPort":4369,"protocol":"TCP"},{"name":"amqp","containerPort":5672,"protocol":"TCP"},{"name":"management","containerPort":15672,"protocol":"TCP"},{"name":"prometheus","containerPort":15692,"protocol":"TCP"}],"env":[{"name":"MY_POD_NAME","valueFrom":{"fieldRef":{"apiVersion":"v1","fieldPath":"metadata.name"}}},{"name":"MY_POD_NAMESPACE","valueFrom":{"fieldRef":{"apiVersion":"v1","fieldPath":"metadata.namespace"}}},{"name":"RABBITMQ_ENABLED_PLUGINS_FILE","value":"/operator/enabled_plugins"},{"name":"K8S_SERVICE_NAME","value":"rabbitmq-cluster-nodes"},{"name":"RABBITMQ_USE_LONGNAME","value":"true"},{"name":"RABBITMQ_NODENAME","value":"rabbit@$(MY_POD_NAME).$(K8S_SERVICE_NAME).$(MY_POD_NAMESPACE)"},{"name":"K8S_HOSTNAME_SUFFIX","value":".$(K8S_SERVICE_NAME).$(MY_POD_NAMESPACE)"}],"resources":{"limits":{"cpu":"2","memory":"2Gi"},"requests":{"cpu":"1","memory":"2Gi"}},"volumeMounts":[{"name":"rabbitmq-erlang-cookie","mountPath":"/var/lib/rabbitmq/"},{"name":"persistence","mountPath":"/var/lib/rabbitmq/mnesia/"},{"name":"rabbitmq-plugins","mountPath":"/operator"},{"name":"rabbitmq-confd","mountPath":"/etc/rabbitmq/conf.d/10-operatorDefaults.conf","subPath":"operatorDefaults.conf"},{"name":"rabbitmq-confd","mountPath":"/etc/rabbitmq/conf.d/11-default_user.conf","subPath":"default_user.conf"},{"name":"rabbitmq-confd","mountPath":"/etc/rabbitmq/conf.d/90-userDefinedConfiguration.conf","subPath":"userDefinedConfiguration.conf"},{"name":"pod-info","mountPath":"/etc/pod-info/"}],"readinessProbe":{"tcpSocket":{"port":"amqp"},"initialDelaySeconds":10,"timeoutSeconds":5,"periodSeconds":10,"successThreshold":1,"failureThreshold":3},"lifecycle":{"preStop":{"exec":{"command":["/bin/bash","-c","if [ ! -z \"$(cat /etc/pod-info/skipPreStopChecks)\" ]; then exit 0; fi; rabbitmq-upgrade await_online_quorum_plus_one -t 604800; rabbitmq-upgrade await_online_synchronized_mirror -t 604800; rabbitmq-upgrade drain -t 604800"]}}},"terminationMessagePath":"/dev/termination-log","terminationMessagePolicy":"File","imagePullPolicy":"IfNotPresent"}],"restartPolicy":"Always","terminationGracePeriodSeconds":604800,"dnsPolicy":"ClusterFirst","serviceAccountName":"rabbitmq-cluster-server","serviceAccount":"rabbitmq-cluster-server","automountServiceAccountToken":true,"securityContext":{"runAsUser":999,"runAsGroup":999,"fsGroup":999},"schedulerName":"default-scheduler","topologySpreadConstraints":[{"maxSkew":1,"topologyKey":"topology.kubernetes.io/zone","whenUnsatisfiable":"ScheduleAnyway","labelSelector":{"matchLabels":{"app.kubernetes.io/name":"rabbitmq-cluster"}}}]}},"volumeClaimTemplates":[{"metadata":{"name":"persistence","namespace":"default","creationTimestamp":null,"labels":{"app.kubernetes.io/component":"rabbitmq","app.kubernetes.io/name":"rabbitmq-cluster","app.kubernetes.io/part-of":"rabbitmq"},"ownerReferences":[{"apiVersion":"rabbitmq.com/v1beta1","kind":"RabbitmqCluster","name":"rabbitmq-cluster","uid":"3ecefa8a-1bec-48a7-9af4-dd0df3339101","controller":true,"blockOwnerDeletion":false}]},"spec":{"accessModes":["ReadWriteOnce"],"resources":{"requests":{"storage":"10Gi"}},"volumeMode":"Filesystem"},"status":{"phase":"Pending"}}],"serviceName":"rabbitmq-cluster-nodes","podManagementPolicy":"Parallel","updateStrategy":{"type":"RollingUpdate","rollingUpdate":{"partition":0}},"revisionHistoryLimit":10},"status":{"observedGeneration":1,"replicas":1,"currentReplicas":1,"updatedReplicas":1,"currentRevision":"rabbitmq-cluster-server-5f8b8665fb","updateRevision":"rabbitmq-cluster-server-5f8b8665fb","collisionCount":0}}
2022/03/18 18:06:25 learn_server.go:291: [SIEVE-AFTER-READ]	Get	true	endpoints	default	rabbitmq-cluster	github.com/rabbitmq/cluster-operator/controllers.(*RabbitmqClusterReconciler)	NoError	{"kind":"Endpoints","apiVersion":"v1","metadata":{"name":"rabbitmq-cluster","namespace":"default","selfLink":"/api/v1/namespaces/default/endpoints/rabbitmq-cluster","uid":"eeba9576-0362-4e74-aafd-71e4ffe98d25","resourceVersion":"1087","creationTimestamp":"2022-03-18T18:06:25Z","labels":{"app.kubernetes.io/component":"rabbitmq","app.kubernetes.io/name":"rabbitmq-cluster","app.kubernetes.io/part-of":"rabbitmq"},"annotations":{"endpoints.kubernetes.io/last-change-trigger-time":"2022-03-18T18:06:25Z"},"managedFields":[{"manager":"kube-controller-manager","operation":"Update","apiVersion":"v1","time":"2022-03-18T18:06:25Z","fieldsType":"FieldsV1","fieldsV1":{"f:metadata":{"f:annotations":{".":{},"f:endpoints.kubernetes.io/last-change-trigger-time":{}},"f:labels":{".":{},"f:app.kubernetes.io/component":{},"f:app.kubernetes.io/name":{},"f:app.kubernetes.io/part-of":{}}}}}]}}
2022/03/18 18:06:25 learn_server.go:291: [SIEVE-AFTER-READ]	Get	true	statefulset	default	rabbitmq-cluster-server	github.com/rabbitmq/cluster-operator/controllers.(*RabbitmqClusterReconciler)	NoError	{"kind":"StatefulSet","apiVersion":"apps/v1","metadata":{"name":"rabbitmq-cluster-server","namespace":"default","selfLink":"/apis/apps/v1/namespaces/default/statefulsets/rabbitmq-cluster-server","uid":"f2f07f3e-b500-4c48-a5de-8db7eaf37b9a","resourceVersion":"1129","generation":1,"creationTimestamp":"2022-03-18T18:06:25Z","labels":{"app.kubernetes.io/component":"rabbitmq","app.kubernetes.io/name":"rabbitmq-cluster","app.kubernetes.io/part-of":"rabbitmq"},"annotations":{"rabbitmq.com/createdAt":"2022-03-18T18:06:25Z"},"ownerReferences":[{"apiVersion":"rabbitmq.com/v1beta1","kind":"RabbitmqCluster","name":"rabbitmq-cluster","uid":"3ecefa8a-1bec-48a7-9af4-dd0df3339101","controller":true,"blockOwnerDeletion":true}],"managedFields":[{"manager":"kube-controller-manager","operation":"Update","apiVersion":"apps/v1","time":"2022-03-18T18:06:25Z","fieldsType":"FieldsV1","fieldsV1":{"f:status":{"f:collisionCount":{},"f:currentReplicas":{},"f:currentRevision":{},"f:observedGeneration":{},"f:replicas":{},"f:updateRevision":{},"f:updatedReplicas":{}}}},{"manager":"manager","operation":"Update","apiVersion":"apps/v1","time":"2022-03-18T18:06:25Z","fieldsType":"FieldsV1","fieldsV1":{"f:metadata":{"f:annotations":{".":{},"f:rabbitmq.com/createdAt":{}},"f:labels":{".":{},"f:app.kubernetes.io/component":{},"f:app.kubernetes.io/name":{},"f:app.kubernetes.io/part-of":{}},"f:ownerReferences":{".":{},"k:{\"uid\":\"3ecefa8a-1bec-48a7-9af4-dd0df3339101\"}":{".":{},"f:apiVersion":{},"f:blockOwnerDeletion":{},"f:controller":{},"f:kind":{},"f:name":{},"f:uid":{}}}},"f:spec":{"f:podManagementPolicy":{},"f:replicas":{},"f:revisionHistoryLimit":{},"f:selector":{"f:matchLabels":{".":{},"f:app.kubernetes.io/name":{}}},"f:serviceName":{},"f:template":{"f:metadata":{"f:annotations":{".":{},"f:prometheus.io/port":{},"f:prometheus.io/scrape":{}},"f:labels":{".":{},"f:app.kubernetes.io/component":{},"f:app.kubernetes.io/name":{},"f:app.kubernetes.io/part-of":{}}},"f:spec":{"f:automountServiceAccountToken":{},"f:containers":{"k:{\"name\":\"rabbitmq\"}":{".":{},"f:env":{".":{},"k:{\"name\":\"K8S_HOSTNAME_SUFFIX\"}":{".":{},"f:name":{},"f:value":{}},"k:{\"name\":\"K8S_SERVICE_NAME\"}":{".":{},"f:name":{},"f:value":{}},"k:{\"name\":\"MY_POD_NAME\"}":{".":{},"f:name":{},"f:valueFrom":{".":{},"f:fieldRef":{".":{},"f:apiVersion":{},"f:fieldPath":{}}}},"k:{\"name\":\"MY_POD_NAMESPACE\"}":{".":{},"f:name":{},"f:valueFrom":{".":{},"f:fieldRef":{".":{},"f:apiVersion":{},"f:fieldPath":{}}}},"k:{\"name\":\"RABBITMQ_ENABLED_PLUGINS_FILE\"}":{".":{},"f:name":{},"f:value":{}},"k:{\"name\":\"RABBITMQ_NODENAME\"}":{".":{},"f:name":{},"f:value":{}},"k:{\"name\":\"RABBITMQ_USE_LONGNAME\"}":{".":{},"f:name":{},"f:value":{}}},"f:image":{},"f:imagePullPolicy":{},"f:lifecycle":{".":{},"f:preStop":{".":{},"f:exec":{".":{},"f:command":{}}}},"f:name":{},"f:ports":{".":{},"k:{\"containerPort\":4369,\"protocol\":\"TCP\"}":{".":{},"f:containerPort":{},"f:name":{},"f:protocol":{}},"k:{\"containerPort\":5672,\"protocol\":\"TCP\"}":{".":{},"f:containerPort":{},"f:name":{},"f:protocol":{}},"k:{\"containerPort\":15672,\"protocol\":\"TCP\"}":{".":{},"f:containerPort":{},"f:name":{},"f:protocol":{}},"k:{\"containerPort\":15692,\"protocol\":\"TCP\"}":{".":{},"f:containerPort":{},"f:name":{},"f:protocol":{}}},"f:readinessProbe":{".":{},"f:failureThreshold":{},"f:initialDelaySeconds":{},"f:periodSeconds":{},"f:successThreshold":{},"f:tcpSocket":{".":{},"f:port":{}},"f:timeoutSeconds":{}},"f:resources":{".":{},"f:limits":{".":{},"f:cpu":{},"f:memory":{}},"f:requests":{".":{},"f:cpu":{},"f:memory":{}}},"f:terminationMessagePath":{},"f:terminationMessagePolicy":{},"f:volumeMounts":{".":{},"k:{\"mountPath\":\"/etc/pod-info/\"}":{".":{},"f:mountPath":{},"f:name":{}},"k:{\"mountPath\":\"/etc/rabbitmq/conf.d/10-operatorDefaults.conf\"}":{".":{},"f:mountPath":{},"f:name":{},"f:subPath":{}},"k:{\"mountPath\":\"/etc/rabbitmq/conf.d/11-default_user.conf\"}":{".":{},"f:mountPath":{},"f:name":{},"f:subPath":{}},"k:{\"mountPath\":\"/etc/rabbitmq/conf.d/90-userDefinedConfiguration.conf\"}":{".":{},"f:mountPath":{},"f:name":{},"f:subPath":{}},"k:{\"mountPath\":\"/operator\"}":{".":{},"f:mountPath":{},"f:name":{}},"k:{\"mountPath\":\"/var/lib/rabbitmq/\"}":{".":{},"f:mountPath":{},"f:name":{}},"k:{\"mountPath\":\"/var/lib/rabbitmq/mnesia/\"}":{".":{},"f:mountPath":{},"f:name":{}}}}},"f:dnsPolicy":{},"f:initContainers":{".":{},"k:{\"name\":\"setup-container\"}":{".":{},"f:command":{},"f:image":{},"f:imagePullPolicy":{},"f:name":{},"f:resources":{".":{},"f:limits":{".":{},"f:cpu":{},"f:memory":{}},"f:requests":{".":{},"f:cpu":{},"f:memory":{}}},"f:securityContext":{".":{},"f:capabilities":{".":{},"f:drop":{}},"f:runAsUser":{}},"f:terminationMessagePath":{},"f:terminationMessagePolicy":{},"f:volumeMounts":{".":{},"k:{\"mountPath\":\"/operator\"}":{".":{},"f:mountPath":{},"f:name":{}},"k:{\"mountPath\":\"/tmp/default_user.conf\"}":{".":{},"f:mountPath":{},"f:name":{},"f:subPath":{}},"k:{\"mountPath\":\"/tmp/erlang-cookie-secret/\"}":{".":{},"f:mountPath":{},"f:name":{}},"k:{\"mountPath\":\"/tmp/rabbitmq-plugins/\"}":{".":{},"f:mountPath":{},"f:name":{}},"k:{\"mountPath\":\"/var/lib/rabbitmq/\"}":{".":{},"f:mountPath":{},"f:name":{}},"k:{\"mountPath\":\"/var/lib/rabbitmq/mnesia/\"}":{".":{},"f:mountPath":{},"f:name":{}}}}},"f:restartPolicy":{},"f:schedulerName":{},"f:securityContext":{".":{},"f:fsGroup":{},"f:runAsGroup":{},"f:runAsUser":{}},"f:serviceAccount":{},"f:serviceAccountName":{},"f:terminationGracePeriodSeconds":{},"f:topologySpreadConstraints":{".":{},"k:{\"topologyKey\":\"topology.kubernetes.io/zone\",\"whenUnsatisfiable\":\"ScheduleAnyway\"}":{".":{},"f:labelSelector":{".":{},"f:matchLabels":{".":{},"f:app.kubernetes.io/name":{}}},"f:maxSkew":{},"f:topologyKey":{},"f:whenUnsatisfiable":{}}},"f:volumes":{".":{},"k:{\"name\":\"erlang-cookie-secret\"}":{".":{},"f:name":{},"f:secret":{".":{},"f:defaultMode":{},"f:secretName":{}}},"k:{\"name\":\"plugins-conf\"}":{".":{},"f:configMap":{".":{},"f:defaultMode":{},"f:name":{}},"f:name":{}},"k:{\"name\":\"pod-info\"}":{".":{},"f:downwardAPI":{".":{},"f:defaultMode":{},"f:items":{}},"f:name":{}},"k:{\"name\":\"rabbitmq-confd\"}":{".":{},"f:name":{},"f:projected":{".":{},"f:defaultMode":{},"f:sources":{}}},"k:{\"name\":\"rabbitmq-erlang-cookie\"}":{".":{},"f:emptyDir":{},"f:name":{}},"k:{\"name\":\"rabbitmq-plugins\"}":{".":{},"f:emptyDir":{},"f:name":{}}}}},"f:updateStrategy":{"f:rollingUpdate":{".":{},"f:partition":{}},"f:type":{}},"f:volumeClaimTemplates":{}}}}]},"spec":{"replicas":1,"selector":{"matchLabels":{"app.kubernetes.io/name":"rabbitmq-cluster"}},"template":{"metadata":{"creationTimestamp":null,"labels":{"app.kubernetes.io/component":"rabbitmq","app.kubernetes.io/name":"rabbitmq-cluster","app.kubernetes.io/part-of":"rabbitmq"},"annotations":{"prometheus.io/port":"15692","prometheus.io/scrape":"true"}},"spec":{"volumes":[{"name":"plugins-conf","configMap":{"name":"rabbitmq-cluster-plugins-conf","defaultMode":420}},{"name":"rabbitmq-confd","projected":{"sources":[{"secret":{"name":"rabbitmq-cluster-default-user","items":[{"key":"default_user.conf","path":"default_user.conf"}]}},{"configMap":{"name":"rabbitmq-cluster-server-conf","items":[{"key":"operatorDefaults.conf","path":"operatorDefaults.conf"},{"key":"userDefinedConfiguration.conf","path":"userDefinedConfiguration.conf"}]}}],"defaultMode":420}},{"name":"rabbitmq-erlang-cookie","emptyDir":{}},{"name":"erlang-cookie-secret","secret":{"secretName":"rabbitmq-cluster-erlang-cookie","defaultMode":420}},{"name":"rabbitmq-plugins","emptyDir":{}},{"name":"pod-info","downwardAPI":{"items":[{"path":"skipPreStopChecks","fieldRef":{"apiVersion":"v1","fieldPath":"metadata.labels['skipPreStopChecks']"}}],"defaultMode":420}}],"initContainers":[{"name":"setup-container","image":"rabbitmq:3.8.12-management","command":["sh","-c","cp /tmp/erlang-cookie-secret/.erlang.cookie /var/lib/rabbitmq/.erlang.cookie \u0026\u0026 chown 999:999 /var/lib/rabbitmq/.erlang.cookie \u0026\u0026 chmod 600 /var/lib/rabbitmq/.erlang.cookie ; cp /tmp/rabbitmq-plugins/enabled_plugins /operator/enabled_plugins \u0026\u0026 chown 999:999 /operator/enabled_plugins ; chown 999:999 /var/lib/rabbitmq/mnesia/ ; echo '[default]' \u003e /var/lib/rabbitmq/.rabbitmqadmin.conf \u0026\u0026 sed -e 's/default_user/username/' -e 's/default_pass/password/' /tmp/default_user.conf \u003e\u003e /var/lib/rabbitmq/.rabbitmqadmin.conf \u0026\u0026 chown 999:999 /var/lib/rabbitmq/.rabbitmqadmin.conf \u0026\u0026 chmod 600 /var/lib/rabbitmq/.rabbitmqadmin.conf"],"resources":{"limits":{"cpu":"100m","memory":"500Mi"},"requests":{"cpu":"100m","memory":"500Mi"}},"volumeMounts":[{"name":"plugins-conf","mountPath":"/tmp/rabbitmq-plugins/"},{"name":"rabbitmq-erlang-cookie","mountPath":"/var/lib/rabbitmq/"},{"name":"erlang-cookie-secret","mountPath":"/tmp/erlang-cookie-secret/"},{"name":"rabbitmq-plugins","mountPath":"/operator"},{"name":"persistence","mountPath":"/var/lib/rabbitmq/mnesia/"},{"name":"rabbitmq-confd","mountPath":"/tmp/default_user.conf","subPath":"default_user.conf"}],"terminationMessagePath":"/dev/termination-log","terminationMessagePolicy":"File","imagePullPolicy":"IfNotPresent","securityContext":{"capabilities":{"drop":["FSETID","KILL","SETGID","SETUID","SETPCAP","NET_BIND_SERVICE","NET_RAW","SYS_CHROOT","MKNOD","AUDIT_WRITE","SETFCAP"]},"runAsUser":0}}],"containers":[{"name":"rabbitmq","image":"rabbitmq:3.8.12-management","ports":[{"name":"epmd","containerPort":4369,"protocol":"TCP"},{"name":"amqp","containerPort":5672,"protocol":"TCP"},{"name":"management","containerPort":15672,"protocol":"TCP"},{"name":"prometheus","containerPort":15692,"protocol":"TCP"}],"env":[{"name":"MY_POD_NAME","valueFrom":{"fieldRef":{"apiVersion":"v1","fieldPath":"metadata.name"}}},{"name":"MY_POD_NAMESPACE","valueFrom":{"fieldRef":{"apiVersion":"v1","fieldPath":"metadata.namespace"}}},{"name":"RABBITMQ_ENABLED_PLUGINS_FILE","value":"/operator/enabled_plugins"},{"name":"K8S_SERVICE_NAME","value":"rabbitmq-cluster-nodes"},{"name":"RABBITMQ_USE_LONGNAME","value":"true"},{"name":"RABBITMQ_NODENAME","value":"rabbit@$(MY_POD_NAME).$(K8S_SERVICE_NAME).$(MY_POD_NAMESPACE)"},{"name":"K8S_HOSTNAME_SUFFIX","value":".$(K8S_SERVICE_NAME).$(MY_POD_NAMESPACE)"}],"resources":{"limits":{"cpu":"2","memory":"2Gi"},"requests":{"cpu":"1","memory":"2Gi"}},"volumeMounts":[{"name":"rabbitmq-erlang-cookie","mountPath":"/var/lib/rabbitmq/"},{"name":"persistence","mountPath":"/var/lib/rabbitmq/mnesia/"},{"name":"rabbitmq-plugins","mountPath":"/operator"},{"name":"rabbitmq-confd","mountPath":"/etc/rabbitmq/conf.d/10-operatorDefaults.conf","subPath":"operatorDefaults.conf"},{"name":"rabbitmq-confd","mountPath":"/etc/rabbitmq/conf.d/11-default_user.conf","subPath":"default_user.conf"},{"name":"rabbitmq-confd","mountPath":"/etc/rabbitmq/conf.d/90-userDefinedConfiguration.conf","subPath":"userDefinedConfiguration.conf"},{"name":"pod-info","mountPath":"/etc/pod-info/"}],"readinessProbe":{"tcpSocket":{"port":"amqp"},"initialDelaySeconds":10,"timeoutSeconds":5,"periodSeconds":10,"successThreshold":1,"failureThreshold":3},"lifecycle":{"preStop":{"exec":{"command":["/bin/bash","-c","if [ ! -z \"$(cat /etc/pod-info/skipPreStopChecks)\" ]; then exit 0; fi; rabbitmq-upgrade await_online_quorum_plus_one -t 604800; rabbitmq-upgrade await_online_synchronized_mirror -t 604800; rabbitmq-upgrade drain -t 604800"]}}},"terminationMessagePath":"/dev/termination-log","terminationMessagePolicy":"File","imagePullPolicy":"IfNotPresent"}],"restartPolicy":"Always","terminationGracePeriodSeconds":604800,"dnsPolicy":"ClusterFirst","serviceAccountName":"rabbitmq-cluster-server","serviceAccount":"rabbitmq-cluster-server","automountServiceAccountToken":true,"securityContext":{"runAsUser":999,"runAsGroup":999,"fsGroup":999},"schedulerName":"default-scheduler","topologySpreadConstraints":[{"maxSkew":1,"topologyKey":"topology.kubernetes.io/zone","whenUnsatisfiable":"ScheduleAnyway","labelSelector":{"matchLabels":{"app.kubernetes.io/name":"rabbitmq-cluster"}}}]}},"volumeClaimTemplates":[{"metadata":{"name":"persistence","namespace":"default","creationTimestamp":null,"labels":{"app.kubernetes.io/component":"rabbitmq","app.kubernetes.io/name":"rabbitmq-cluster","app.kubernetes.io/part-of":"rabbitmq"},"ownerReferences":[{"apiVersion":"rabbitmq.com/v1beta1","kind":"RabbitmqCluster","name":"rabbitmq-cluster","uid":"3ecefa8a-1bec-48a7-9af4-dd0df3339101","controller":true,"blockOwnerDeletion":false}]},"spec":{"accessModes":["ReadWriteOnce"],"resources":{"requests":{"storage":"10Gi"}},"volumeMode":"Filesystem"},"status":{"phase":"Pending"}}],"serviceName":"rabbitmq-cluster-nodes","podManagementPolicy":"Parallel","updateStrategy":{"type":"RollingUpdate","rollingUpdate":{"partition":0}},"revisionHistoryLimit":10},"status":{"observedGeneration":1,"replicas":1,"currentReplicas":1,"updatedReplicas":1,"currentRevision":"rabbitmq-cluster-server-5f8b8665fb","updateRevision":"rabbitmq-cluster-server-5f8b8665fb","collisionCount":0}}
2022/03/18 18:06:25 learn_server.go:291: [SIEVE-AFTER-READ]	Get	true	service	default	rabbitmq-cluster-nodes	github.com/rabbitmq/cluster-operator/controllers.(*RabbitmqClusterReconciler)	NoError	{"kind":"Service","apiVersion":"v1","metadata":{"name":"rabbitmq-cluster-nodes","namespace":"default","selfLink":"/api/v1/namespaces/default/services/rabbitmq-cluster-nodes","uid":"f843e1c2-ced0-463d-87c1-0e127aaa2006","resourceVersion":"1080","creationTimestamp":"2022-03-18T18:06:25Z","labels":{"app.kubernetes.io/component":"rabbitmq","app.kubernetes.io/name":"rabbitmq-cluster","app.kubernetes.io/part-of":"rabbitmq"},"ownerReferences":[{"apiVersion":"rabbitmq.com/v1beta1","kind":"RabbitmqCluster","name":"rabbitmq-cluster","uid":"3ecefa8a-1bec-48a7-9af4-dd0df3339101","controller":true,"blockOwnerDeletion":true}],"managedFields":[{"manager":"manager","operation":"Update","apiVersion":"v1","time":"2022-03-18T18:06:25Z","fieldsType":"FieldsV1","fieldsV1":{"f:metadata":{"f:labels":{".":{},"f:app.kubernetes.io/component":{},"f:app.kubernetes.io/name":{},"f:app.kubernetes.io/part-of":{}},"f:ownerReferences":{".":{},"k:{\"uid\":\"3ecefa8a-1bec-48a7-9af4-dd0df3339101\"}":{".":{},"f:apiVersion":{},"f:blockOwnerDeletion":{},"f:controller":{},"f:kind":{},"f:name":{},"f:uid":{}}}},"f:spec":{"f:clusterIP":{},"f:ports":{".":{},"k:{\"port\":4369,\"protocol\":\"TCP\"}":{".":{},"f:name":{},"f:port":{},"f:protocol":{},"f:targetPort":{}},"k:{\"port\":25672,\"protocol\":\"TCP\"}":{".":{},"f:name":{},"f:port":{},"f:protocol":{},"f:targetPort":{}}},"f:publishNotReadyAddresses":{},"f:selector":{".":{},"f:app.kubernetes.io/name":{}},"f:sessionAffinity":{},"f:type":{}}}}]},"spec":{"ports":[{"name":"epmd","protocol":"TCP","port":4369,"targetPort":4369},{"name":"cluster-rpc","protocol":"TCP","port":25672,"targetPort":25672}],"selector":{"app.kubernetes.io/name":"rabbitmq-cluster"},"clusterIP":"None","type":"ClusterIP","sessionAffinity":"None","publishNotReadyAddresses":true},"status":{"loadBalancer":{}}}
2022/03/18 18:06:25 learn_server.go:291: [SIEVE-AFTER-READ]	Get	true	service	default	rabbitmq-cluster	github.com/rabbitmq/cluster-operator/controllers.(*RabbitmqClusterReconciler)	NoError	{"kind":"Service","apiVersion":"v1","metadata":{"name":"rabbitmq-cluster","namespace":"default","selfLink":"/api/v1/namespaces/default/services/rabbitmq-cluster","uid":"ae846a70-784e-49ca-99a0-2b0cefb93b46","resourceVersion":"1085","creationTimestamp":"2022-03-18T18:06:25Z","labels":{"app.kubernetes.io/component":"rabbitmq","app.kubernetes.io/name":"rabbitmq-cluster","app.kubernetes.io/part-of":"rabbitmq"},"ownerReferences":[{"apiVersion":"rabbitmq.com/v1beta1","kind":"RabbitmqCluster","name":"rabbitmq-cluster","uid":"3ecefa8a-1bec-48a7-9af4-dd0df3339101","controller":true,"blockOwnerDeletion":true}],"managedFields":[{"manager":"manager","operation":"Update","apiVersion":"v1","time":"2022-03-18T18:06:25Z","fieldsType":"FieldsV1","fieldsV1":{"f:metadata":{"f:labels":{".":{},"f:app.kubernetes.io/component":{},"f:app.kubernetes.io/name":{},"f:app.kubernetes.io/part-of":{}},"f:ownerReferences":{".":{},"k:{\"uid\":\"3ecefa8a-1bec-48a7-9af4-dd0df3339101\"}":{".":{},"f:apiVersion":{},"f:blockOwnerDeletion":{},"f:controller":{},"f:kind":{},"f:name":{},"f:uid":{}}}},"f:spec":{"f:ports":{".":{},"k:{\"port\":5672,\"protocol\":\"TCP\"}":{".":{},"f:name":{},"f:port":{},"f:protocol":{},"f:targetPort":{}},"k:{\"port\":15672,\"protocol\":\"TCP\"}":{".":{},"f:name":{},"f:port":{},"f:protocol":{},"f:targetPort":{}}},"f:selector":{".":{},"f:app.kubernetes.io/name":{}},"f:sessionAffinity":{},"f:type":{}}}}]},"spec":{"ports":[{"name":"amqp","protocol":"TCP","port":5672,"targetPort":5672},{"name":"management","protocol":"TCP","port":15672,"targetPort":15672}],"selector":{"app.kubernetes.io/name":"rabbitmq-cluster"},"clusterIP":"10.96.47.189","type":"ClusterIP","sessionAffinity":"None"},"status":{"loadBalancer":{}}}
2022/03/18 18:06:25 learn_server.go:291: [SIEVE-AFTER-READ]	Get	true	secret	default	rabbitmq-cluster-erlang-cookie	github.com/rabbitmq/cluster-operator/controllers.(*RabbitmqClusterReconciler)	NoError	{"kind":"Secret","apiVersion":"v1","metadata":{"name":"rabbitmq-cluster-erlang-cookie","namespace":"default","selfLink":"/api/v1/namespaces/default/secrets/rabbitmq-cluster-erlang-cookie","uid":"01d8d8ad-080a-4c3f-9d27-56616c53dd26","resourceVersion":"1088","creationTimestamp":"2022-03-18T18:06:25Z","labels":{"app.kubernetes.io/component":"rabbitmq","app.kubernetes.io/name":"rabbitmq-cluster","app.kubernetes.io/part-of":"rabbitmq"},"ownerReferences":[{"apiVersion":"rabbitmq.com/v1beta1","kind":"RabbitmqCluster","name":"rabbitmq-cluster","uid":"3ecefa8a-1bec-48a7-9af4-dd0df3339101","controller":true,"blockOwnerDeletion":true}],"managedFields":[{"manager":"manager","operation":"Update","apiVersion":"v1","time":"2022-03-18T18:06:25Z","fieldsType":"FieldsV1","fieldsV1":{"f:data":{".":{},"f:.erlang.cookie":{}},"f:metadata":{"f:labels":{".":{},"f:app.kubernetes.io/component":{},"f:app.kubernetes.io/name":{},"f:app.kubernetes.io/part-of":{}},"f:ownerReferences":{".":{},"k:{\"uid\":\"3ecefa8a-1bec-48a7-9af4-dd0df3339101\"}":{".":{},"f:apiVersion":{},"f:blockOwnerDeletion":{},"f:controller":{},"f:kind":{},"f:name":{},"f:uid":{}}}},"f:type":{}}}]},"data":{".erlang.cookie":"ajdscUtLdnBpR1NwUUMwc1V3a2VyTlJxU2tVUTdBeEw="},"type":"Opaque"}
2022/03/18 18:06:25 learn_server.go:291: [SIEVE-AFTER-READ]	Get	true	secret	default	rabbitmq-cluster-default-user	github.com/rabbitmq/cluster-operator/controllers.(*RabbitmqClusterReconciler)	NoError	{"kind":"Secret","apiVersion":"v1","metadata":{"name":"rabbitmq-cluster-default-user","namespace":"default","selfLink":"/api/v1/namespaces/default/secrets/rabbitmq-cluster-default-user","uid":"b2f5a936-e51f-4488-b6e9-ca23e4d95ac2","resourceVersion":"1091","creationTimestamp":"2022-03-18T18:06:25Z","labels":{"app.kubernetes.io/component":"rabbitmq","app.kubernetes.io/name":"rabbitmq-cluster","app.kubernetes.io/part-of":"rabbitmq"},"ownerReferences":[{"apiVersion":"rabbitmq.com/v1beta1","kind":"RabbitmqCluster","name":"rabbitmq-cluster","uid":"3ecefa8a-1bec-48a7-9af4-dd0df3339101","controller":true,"blockOwnerDeletion":true}],"managedFields":[{"manager":"manager","operation":"Update","apiVersion":"v1","time":"2022-03-18T18:06:25Z","fieldsType":"FieldsV1","fieldsV1":{"f:data":{".":{},"f:default_user.conf":{},"f:password":{},"f:provider":{},"f:type":{},"f:username":{}},"f:metadata":{"f:labels":{".":{},"f:app.kubernetes.io/component":{},"f:app.kubernetes.io/name":{},"f:app.kubernetes.io/part-of":{}},"f:ownerReferences":{".":{},"k:{\"uid\":\"3ecefa8a-1bec-48a7-9af4-dd0df3339101\"}":{".":{},"f:apiVersion":{},"f:blockOwnerDeletion":{},"f:controller":{},"f:kind":{},"f:name":{},"f:uid":{}}}},"f:type":{}}}]},"data":{"default_user.conf":"ZGVmYXVsdF91c2VyID0gdEFMN1otZTgzR29ocEtsZ0Z4cUFFV3ZXemEtcjdJQW8KZGVmYXVsdF9wYXNzID0gdXVocndkTkdOcmJXQ2p6NFZPX0NUZE9OYURkSUpoRkoK","password":"dXVocndkTkdOcmJXQ2p6NFZPX0NUZE9OYURkSUpoRko=","provider":"cmFiYml0bXE=","type":"cmFiYml0bXE=","username":"dEFMN1otZTgzR29ocEtsZ0Z4cUFFV3ZXemEtcjdJQW8="},"type":"Opaque"}
2022/03/18 18:06:25 learn_server.go:291: [SIEVE-AFTER-READ]	Get	true	configmap	default	rabbitmq-cluster-plugins-conf	github.com/rabbitmq/cluster-operator/controllers.(*RabbitmqClusterReconciler)	NoError	{"kind":"ConfigMap","apiVersion":"v1","metadata":{"name":"rabbitmq-cluster-plugins-conf","namespace":"default","selfLink":"/api/v1/namespaces/default/configmaps/rabbitmq-cluster-plugins-conf","uid":"0aa26eb6-ff3a-4457-a223-284c897db7fe","resourceVersion":"1092","creationTimestamp":"2022-03-18T18:06:25Z","labels":{"app.kubernetes.io/component":"rabbitmq","app.kubernetes.io/name":"rabbitmq-cluster","app.kubernetes.io/part-of":"rabbitmq"},"ownerReferences":[{"apiVersion":"rabbitmq.com/v1beta1","kind":"RabbitmqCluster","name":"rabbitmq-cluster","uid":"3ecefa8a-1bec-48a7-9af4-dd0df3339101","controller":true,"blockOwnerDeletion":true}],"managedFields":[{"manager":"manager","operation":"Update","apiVersion":"v1","time":"2022-03-18T18:06:25Z","fieldsType":"FieldsV1","fieldsV1":{"f:data":{".":{},"f:enabled_plugins":{}},"f:metadata":{"f:labels":{".":{},"f:app.kubernetes.io/component":{},"f:app.kubernetes.io/name":{},"f:app.kubernetes.io/part-of":{}},"f:ownerReferences":{".":{},"k:{\"uid\":\"3ecefa8a-1bec-48a7-9af4-dd0df3339101\"}":{".":{},"f:apiVersion":{},"f:blockOwnerDeletion":{},"f:controller":{},"f:kind":{},"f:name":{},"f:uid":{}}}}}}]},"data":{"enabled_plugins":"[rabbitmq_peer_discovery_k8s,rabbitmq_prometheus,rabbitmq_management]."}}
2022/03/18 18:06:25 learn_server.go:291: [SIEVE-AFTER-READ]	Get	true	configmap	default	rabbitmq-cluster-server-conf	github.com/rabbitmq/cluster-operator/controllers.(*RabbitmqClusterReconciler)	NoError	{"kind":"ConfigMap","apiVersion":"v1","metadata":{"name":"rabbitmq-cluster-server-conf","namespace":"default","selfLink":"/api/v1/namespaces/default/configmaps/rabbitmq-cluster-server-conf","uid":"e4182078-d429-4baf-9021-72618c509ac5","resourceVersion":"1095","creationTimestamp":"2022-03-18T18:06:25Z","labels":{"app.kubernetes.io/component":"rabbitmq","app.kubernetes.io/name":"rabbitmq-cluster","app.kubernetes.io/part-of":"rabbitmq"},"ownerReferences":[{"apiVersion":"rabbitmq.com/v1beta1","kind":"RabbitmqCluster","name":"rabbitmq-cluster","uid":"3ecefa8a-1bec-48a7-9af4-dd0df3339101","controller":true,"blockOwnerDeletion":true}],"managedFields":[{"manager":"manager","operation":"Update","apiVersion":"v1","time":"2022-03-18T18:06:25Z","fieldsType":"FieldsV1","fieldsV1":{"f:data":{".":{},"f:operatorDefaults.conf":{},"f:userDefinedConfiguration.conf":{}},"f:metadata":{"f:labels":{".":{},"f:app.kubernetes.io/component":{},"f:app.kubernetes.io/name":{},"f:app.kubernetes.io/part-of":{}},"f:ownerReferences":{".":{},"k:{\"uid\":\"3ecefa8a-1bec-48a7-9af4-dd0df3339101\"}":{".":{},"f:apiVersion":{},"f:blockOwnerDeletion":{},"f:controller":{},"f:kind":{},"f:name":{},"f:uid":{}}}}}}]},"data":{"operatorDefaults.conf":"cluster_formation.peer_discovery_backend             = rabbit_peer_discovery_k8s\ncluster_formation.k8s.host                           = kubernetes.default\ncluster_formation.k8s.address_type                   = hostname\ncluster_partition_handling                           = pause_minority\nqueue_master_locator                                 = min-masters\ndisk_free_limit.absolute                             = 2GB\ncluster_formation.randomized_startup_delay_range.min = 5\ncluster_formation.randomized_startup_delay_range.max = 30\ncluster_name                                         = rabbitmq-cluster\n","userDefinedConfiguration.conf":"total_memory_available_override_value = 1717986919\n"}}
2022/03/18 18:06:25 learn_server.go:291: [SIEVE-AFTER-READ]	Get	true	serviceaccount	default	rabbitmq-cluster-server	github.com/rabbitmq/cluster-operator/controllers.(*RabbitmqClusterReconciler)	NoError	{"kind":"ServiceAccount","apiVersion":"v1","metadata":{"name":"rabbitmq-cluster-server","namespace":"default","selfLink":"/api/v1/namespaces/default/serviceaccounts/rabbitmq-cluster-server","uid":"0c3cead0-37dd-452b-b939-fe346a5dfdea","resourceVersion":"1102","creationTimestamp":"2022-03-18T18:06:25Z","labels":{"app.kubernetes.io/component":"rabbitmq","app.kubernetes.io/name":"rabbitmq-cluster","app.kubernetes.io/part-of":"rabbitmq"},"ownerReferences":[{"apiVersion":"rabbitmq.com/v1beta1","kind":"RabbitmqCluster","name":"rabbitmq-cluster","uid":"3ecefa8a-1bec-48a7-9af4-dd0df3339101","controller":true,"blockOwnerDeletion":true}],"managedFields":[{"manager":"kube-controller-manager","operation":"Update","apiVersion":"v1","time":"2022-03-18T18:06:25Z","fieldsType":"FieldsV1","fieldsV1":{"f:secrets":{".":{},"k:{\"name\":\"rabbitmq-cluster-server-token-v4wpv\"}":{".":{},"f:name":{}}}}},{"manager":"manager","operation":"Update","apiVersion":"v1","time":"2022-03-18T18:06:25Z","fieldsType":"FieldsV1","fieldsV1":{"f:metadata":{"f:labels":{".":{},"f:app.kubernetes.io/component":{},"f:app.kubernetes.io/name":{},"f:app.kubernetes.io/part-of":{}},"f:ownerReferences":{".":{},"k:{\"uid\":\"3ecefa8a-1bec-48a7-9af4-dd0df3339101\"}":{".":{},"f:apiVersion":{},"f:blockOwnerDeletion":{},"f:controller":{},"f:kind":{},"f:name":{},"f:uid":{}}}}}}]},"secrets":[{"name":"rabbitmq-cluster-server-token-v4wpv"}]}
2022/03/18 18:06:25 learn_server.go:291: [SIEVE-AFTER-READ]	Get	true	role	default	rabbitmq-cluster-peer-discovery	github.com/rabbitmq/cluster-operator/controllers.(*RabbitmqClusterReconciler)	NoError	{"kind":"Role","apiVersion":"rbac.authorization.k8s.io/v1","metadata":{"name":"rabbitmq-cluster-peer-discovery","namespace":"default","selfLink":"/apis/rbac.authorization.k8s.io/v1/namespaces/default/roles/rabbitmq-cluster-peer-discovery","uid":"ec9ac474-1880-43ed-af46-9ea5f46d6db4","resourceVersion":"1103","creationTimestamp":"2022-03-18T18:06:25Z","labels":{"app.kubernetes.io/component":"rabbitmq","app.kubernetes.io/name":"rabbitmq-cluster","app.kubernetes.io/part-of":"rabbitmq"},"ownerReferences":[{"apiVersion":"rabbitmq.com/v1beta1","kind":"RabbitmqCluster","name":"rabbitmq-cluster","uid":"3ecefa8a-1bec-48a7-9af4-dd0df3339101","controller":true,"blockOwnerDeletion":true}],"managedFields":[{"manager":"manager","operation":"Update","apiVersion":"rbac.authorization.k8s.io/v1","time":"2022-03-18T18:06:25Z","fieldsType":"FieldsV1","fieldsV1":{"f:metadata":{"f:labels":{".":{},"f:app.kubernetes.io/component":{},"f:app.kubernetes.io/name":{},"f:app.kubernetes.io/part-of":{}},"f:ownerReferences":{".":{},"k:{\"uid\":\"3ecefa8a-1bec-48a7-9af4-dd0df3339101\"}":{".":{},"f:apiVersion":{},"f:blockOwnerDeletion":{},"f:controller":{},"f:kind":{},"f:name":{},"f:uid":{}}}},"f:rules":{}}}]},"rules":[{"verbs":["get"],"apiGroups":[""],"resources":["endpoints"]},{"verbs":["create"],"apiGroups":[""],"resources":["events"]}]}
2022/03/18 18:06:25 learn_server.go:291: [SIEVE-AFTER-READ]	Get	true	rolebinding	default	rabbitmq-cluster-server	github.com/rabbitmq/cluster-operator/controllers.(*RabbitmqClusterReconciler)	NoError	{"kind":"RoleBinding","apiVersion":"rbac.authorization.k8s.io/v1","metadata":{"name":"rabbitmq-cluster-server","namespace":"default","selfLink":"/apis/rbac.authorization.k8s.io/v1/namespaces/default/rolebindings/rabbitmq-cluster-server","uid":"fe69a41c-8d28-4b84-a9f6-a9e6044d75ba","resourceVersion":"1105","creationTimestamp":"2022-03-18T18:06:25Z","labels":{"app.kubernetes.io/component":"rabbitmq","app.kubernetes.io/name":"rabbitmq-cluster","app.kubernetes.io/part-of":"rabbitmq"},"ownerReferences":[{"apiVersion":"rabbitmq.com/v1beta1","kind":"RabbitmqCluster","name":"rabbitmq-cluster","uid":"3ecefa8a-1bec-48a7-9af4-dd0df3339101","controller":true,"blockOwnerDeletion":true}],"managedFields":[{"manager":"manager","operation":"Update","apiVersion":"rbac.authorization.k8s.io/v1","time":"2022-03-18T18:06:25Z","fieldsType":"FieldsV1","fieldsV1":{"f:metadata":{"f:labels":{".":{},"f:app.kubernetes.io/component":{},"f:app.kubernetes.io/name":{},"f:app.kubernetes.io/part-of":{}},"f:ownerReferences":{".":{},"k:{\"uid\":\"3ecefa8a-1bec-48a7-9af4-dd0df3339101\"}":{".":{},"f:apiVersion":{},"f:blockOwnerDeletion":{},"f:controller":{},"f:kind":{},"f:name":{},"f:uid":{}}}},"f:roleRef":{"f:apiGroup":{},"f:kind":{},"f:name":{}},"f:subjects":{}}}]},"subjects":[{"kind":"ServiceAccount","name":"rabbitmq-cluster-server"}],"roleRef":{"apiGroup":"rbac.authorization.k8s.io","kind":"Role","name":"rabbitmq-cluster-peer-discovery"}}
2022/03/18 18:06:25 learn_server.go:291: [SIEVE-AFTER-READ]	Get	true	statefulset	default	rabbitmq-cluster-server	github.com/rabbitmq/cluster-operator/controllers.(*RabbitmqClusterReconciler)	NoError	{"kind":"StatefulSet","apiVersion":"apps/v1","metadata":{"name":"rabbitmq-cluster-server","namespace":"default","selfLink":"/apis/apps/v1/namespaces/default/statefulsets/rabbitmq-cluster-server","uid":"f2f07f3e-b500-4c48-a5de-8db7eaf37b9a","resourceVersion":"1129","generation":1,"creationTimestamp":"2022-03-18T18:06:25Z","labels":{"app.kubernetes.io/component":"rabbitmq","app.kubernetes.io/name":"rabbitmq-cluster","app.kubernetes.io/part-of":"rabbitmq"},"annotations":{"rabbitmq.com/createdAt":"2022-03-18T18:06:25Z"},"ownerReferences":[{"apiVersion":"rabbitmq.com/v1beta1","kind":"RabbitmqCluster","name":"rabbitmq-cluster","uid":"3ecefa8a-1bec-48a7-9af4-dd0df3339101","controller":true,"blockOwnerDeletion":true}],"managedFields":[{"manager":"kube-controller-manager","operation":"Update","apiVersion":"apps/v1","time":"2022-03-18T18:06:25Z","fieldsType":"FieldsV1","fieldsV1":{"f:status":{"f:collisionCount":{},"f:currentReplicas":{},"f:currentRevision":{},"f:observedGeneration":{},"f:replicas":{},"f:updateRevision":{},"f:updatedReplicas":{}}}},{"manager":"manager","operation":"Update","apiVersion":"apps/v1","time":"2022-03-18T18:06:25Z","fieldsType":"FieldsV1","fieldsV1":{"f:metadata":{"f:annotations":{".":{},"f:rabbitmq.com/createdAt":{}},"f:labels":{".":{},"f:app.kubernetes.io/component":{},"f:app.kubernetes.io/name":{},"f:app.kubernetes.io/part-of":{}},"f:ownerReferences":{".":{},"k:{\"uid\":\"3ecefa8a-1bec-48a7-9af4-dd0df3339101\"}":{".":{},"f:apiVersion":{},"f:blockOwnerDeletion":{},"f:controller":{},"f:kind":{},"f:name":{},"f:uid":{}}}},"f:spec":{"f:podManagementPolicy":{},"f:replicas":{},"f:revisionHistoryLimit":{},"f:selector":{"f:matchLabels":{".":{},"f:app.kubernetes.io/name":{}}},"f:serviceName":{},"f:template":{"f:metadata":{"f:annotations":{".":{},"f:prometheus.io/port":{},"f:prometheus.io/scrape":{}},"f:labels":{".":{},"f:app.kubernetes.io/component":{},"f:app.kubernetes.io/name":{},"f:app.kubernetes.io/part-of":{}}},"f:spec":{"f:automountServiceAccountToken":{},"f:containers":{"k:{\"name\":\"rabbitmq\"}":{".":{},"f:env":{".":{},"k:{\"name\":\"K8S_HOSTNAME_SUFFIX\"}":{".":{},"f:name":{},"f:value":{}},"k:{\"name\":\"K8S_SERVICE_NAME\"}":{".":{},"f:name":{},"f:value":{}},"k:{\"name\":\"MY_POD_NAME\"}":{".":{},"f:name":{},"f:valueFrom":{".":{},"f:fieldRef":{".":{},"f:apiVersion":{},"f:fieldPath":{}}}},"k:{\"name\":\"MY_POD_NAMESPACE\"}":{".":{},"f:name":{},"f:valueFrom":{".":{},"f:fieldRef":{".":{},"f:apiVersion":{},"f:fieldPath":{}}}},"k:{\"name\":\"RABBITMQ_ENABLED_PLUGINS_FILE\"}":{".":{},"f:name":{},"f:value":{}},"k:{\"name\":\"RABBITMQ_NODENAME\"}":{".":{},"f:name":{},"f:value":{}},"k:{\"name\":\"RABBITMQ_USE_LONGNAME\"}":{".":{},"f:name":{},"f:value":{}}},"f:image":{},"f:imagePullPolicy":{},"f:lifecycle":{".":{},"f:preStop":{".":{},"f:exec":{".":{},"f:command":{}}}},"f:name":{},"f:ports":{".":{},"k:{\"containerPort\":4369,\"protocol\":\"TCP\"}":{".":{},"f:containerPort":{},"f:name":{},"f:protocol":{}},"k:{\"containerPort\":5672,\"protocol\":\"TCP\"}":{".":{},"f:containerPort":{},"f:name":{},"f:protocol":{}},"k:{\"containerPort\":15672,\"protocol\":\"TCP\"}":{".":{},"f:containerPort":{},"f:name":{},"f:protocol":{}},"k:{\"containerPort\":15692,\"protocol\":\"TCP\"}":{".":{},"f:containerPort":{},"f:name":{},"f:protocol":{}}},"f:readinessProbe":{".":{},"f:failureThreshold":{},"f:initialDelaySeconds":{},"f:periodSeconds":{},"f:successThreshold":{},"f:tcpSocket":{".":{},"f:port":{}},"f:timeoutSeconds":{}},"f:resources":{".":{},"f:limits":{".":{},"f:cpu":{},"f:memory":{}},"f:requests":{".":{},"f:cpu":{},"f:memory":{}}},"f:terminationMessagePath":{},"f:terminationMessagePolicy":{},"f:volumeMounts":{".":{},"k:{\"mountPath\":\"/etc/pod-info/\"}":{".":{},"f:mountPath":{},"f:name":{}},"k:{\"mountPath\":\"/etc/rabbitmq/conf.d/10-operatorDefaults.conf\"}":{".":{},"f:mountPath":{},"f:name":{},"f:subPath":{}},"k:{\"mountPath\":\"/etc/rabbitmq/conf.d/11-default_user.conf\"}":{".":{},"f:mountPath":{},"f:name":{},"f:subPath":{}},"k:{\"mountPath\":\"/etc/rabbitmq/conf.d/90-userDefinedConfiguration.conf\"}":{".":{},"f:mountPath":{},"f:name":{},"f:subPath":{}},"k:{\"mountPath\":\"/operator\"}":{".":{},"f:mountPath":{},"f:name":{}},"k:{\"mountPath\":\"/var/lib/rabbitmq/\"}":{".":{},"f:mountPath":{},"f:name":{}},"k:{\"mountPath\":\"/var/lib/rabbitmq/mnesia/\"}":{".":{},"f:mountPath":{},"f:name":{}}}}},"f:dnsPolicy":{},"f:initContainers":{".":{},"k:{\"name\":\"setup-container\"}":{".":{},"f:command":{},"f:image":{},"f:imagePullPolicy":{},"f:name":{},"f:resources":{".":{},"f:limits":{".":{},"f:cpu":{},"f:memory":{}},"f:requests":{".":{},"f:cpu":{},"f:memory":{}}},"f:securityContext":{".":{},"f:capabilities":{".":{},"f:drop":{}},"f:runAsUser":{}},"f:terminationMessagePath":{},"f:terminationMessagePolicy":{},"f:volumeMounts":{".":{},"k:{\"mountPath\":\"/operator\"}":{".":{},"f:mountPath":{},"f:name":{}},"k:{\"mountPath\":\"/tmp/default_user.conf\"}":{".":{},"f:mountPath":{},"f:name":{},"f:subPath":{}},"k:{\"mountPath\":\"/tmp/erlang-cookie-secret/\"}":{".":{},"f:mountPath":{},"f:name":{}},"k:{\"mountPath\":\"/tmp/rabbitmq-plugins/\"}":{".":{},"f:mountPath":{},"f:name":{}},"k:{\"mountPath\":\"/var/lib/rabbitmq/\"}":{".":{},"f:mountPath":{},"f:name":{}},"k:{\"mountPath\":\"/var/lib/rabbitmq/mnesia/\"}":{".":{},"f:mountPath":{},"f:name":{}}}}},"f:restartPolicy":{},"f:schedulerName":{},"f:securityContext":{".":{},"f:fsGroup":{},"f:runAsGroup":{},"f:runAsUser":{}},"f:serviceAccount":{},"f:serviceAccountName":{},"f:terminationGracePeriodSeconds":{},"f:topologySpreadConstraints":{".":{},"k:{\"topologyKey\":\"topology.kubernetes.io/zone\",\"whenUnsatisfiable\":\"ScheduleAnyway\"}":{".":{},"f:labelSelector":{".":{},"f:matchLabels":{".":{},"f:app.kubernetes.io/name":{}}},"f:maxSkew":{},"f:topologyKey":{},"f:whenUnsatisfiable":{}}},"f:volumes":{".":{},"k:{\"name\":\"erlang-cookie-secret\"}":{".":{},"f:name":{},"f:secret":{".":{},"f:defaultMode":{},"f:secretName":{}}},"k:{\"name\":\"plugins-conf\"}":{".":{},"f:configMap":{".":{},"f:defaultMode":{},"f:name":{}},"f:name":{}},"k:{\"name\":\"pod-info\"}":{".":{},"f:downwardAPI":{".":{},"f:defaultMode":{},"f:items":{}},"f:name":{}},"k:{\"name\":\"rabbitmq-confd\"}":{".":{},"f:name":{},"f:projected":{".":{},"f:defaultMode":{},"f:sources":{}}},"k:{\"name\":\"rabbitmq-erlang-cookie\"}":{".":{},"f:emptyDir":{},"f:name":{}},"k:{\"name\":\"rabbitmq-plugins\"}":{".":{},"f:emptyDir":{},"f:name":{}}}}},"f:updateStrategy":{"f:rollingUpdate":{".":{},"f:partition":{}},"f:type":{}},"f:volumeClaimTemplates":{}}}}]},"spec":{"replicas":1,"selector":{"matchLabels":{"app.kubernetes.io/name":"rabbitmq-cluster"}},"template":{"metadata":{"creationTimestamp":null,"labels":{"app.kubernetes.io/component":"rabbitmq","app.kubernetes.io/name":"rabbitmq-cluster","app.kubernetes.io/part-of":"rabbitmq"},"annotations":{"prometheus.io/port":"15692","prometheus.io/scrape":"true"}},"spec":{"volumes":[{"name":"plugins-conf","configMap":{"name":"rabbitmq-cluster-plugins-conf","defaultMode":420}},{"name":"rabbitmq-confd","projected":{"sources":[{"secret":{"name":"rabbitmq-cluster-default-user","items":[{"key":"default_user.conf","path":"default_user.conf"}]}},{"configMap":{"name":"rabbitmq-cluster-server-conf","items":[{"key":"operatorDefaults.conf","path":"operatorDefaults.conf"},{"key":"userDefinedConfiguration.conf","path":"userDefinedConfiguration.conf"}]}}],"defaultMode":420}},{"name":"rabbitmq-erlang-cookie","emptyDir":{}},{"name":"erlang-cookie-secret","secret":{"secretName":"rabbitmq-cluster-erlang-cookie","defaultMode":420}},{"name":"rabbitmq-plugins","emptyDir":{}},{"name":"pod-info","downwardAPI":{"items":[{"path":"skipPreStopChecks","fieldRef":{"apiVersion":"v1","fieldPath":"metadata.labels['skipPreStopChecks']"}}],"defaultMode":420}}],"initContainers":[{"name":"setup-container","image":"rabbitmq:3.8.12-management","command":["sh","-c","cp /tmp/erlang-cookie-secret/.erlang.cookie /var/lib/rabbitmq/.erlang.cookie \u0026\u0026 chown 999:999 /var/lib/rabbitmq/.erlang.cookie \u0026\u0026 chmod 600 /var/lib/rabbitmq/.erlang.cookie ; cp /tmp/rabbitmq-plugins/enabled_plugins /operator/enabled_plugins \u0026\u0026 chown 999:999 /operator/enabled_plugins ; chown 999:999 /var/lib/rabbitmq/mnesia/ ; echo '[default]' \u003e /var/lib/rabbitmq/.rabbitmqadmin.conf \u0026\u0026 sed -e 's/default_user/username/' -e 's/default_pass/password/' /tmp/default_user.conf \u003e\u003e /var/lib/rabbitmq/.rabbitmqadmin.conf \u0026\u0026 chown 999:999 /var/lib/rabbitmq/.rabbitmqadmin.conf \u0026\u0026 chmod 600 /var/lib/rabbitmq/.rabbitmqadmin.conf"],"resources":{"limits":{"cpu":"100m","memory":"500Mi"},"requests":{"cpu":"100m","memory":"500Mi"}},"volumeMounts":[{"name":"plugins-conf","mountPath":"/tmp/rabbitmq-plugins/"},{"name":"rabbitmq-erlang-cookie","mountPath":"/var/lib/rabbitmq/"},{"name":"erlang-cookie-secret","mountPath":"/tmp/erlang-cookie-secret/"},{"name":"rabbitmq-plugins","mountPath":"/operator"},{"name":"persistence","mountPath":"/var/lib/rabbitmq/mnesia/"},{"name":"rabbitmq-confd","mountPath":"/tmp/default_user.conf","subPath":"default_user.conf"}],"terminationMessagePath":"/dev/termination-log","terminationMessagePolicy":"File","imagePullPolicy":"IfNotPresent","securityContext":{"capabilities":{"drop":["FSETID","KILL","SETGID","SETUID","SETPCAP","NET_BIND_SERVICE","NET_RAW","SYS_CHROOT","MKNOD","AUDIT_WRITE","SETFCAP"]},"runAsUser":0}}],"containers":[{"name":"rabbitmq","image":"rabbitmq:3.8.12-management","ports":[{"name":"epmd","containerPort":4369,"protocol":"TCP"},{"name":"amqp","containerPort":5672,"protocol":"TCP"},{"name":"management","containerPort":15672,"protocol":"TCP"},{"name":"prometheus","containerPort":15692,"protocol":"TCP"}],"env":[{"name":"MY_POD_NAME","valueFrom":{"fieldRef":{"apiVersion":"v1","fieldPath":"metadata.name"}}},{"name":"MY_POD_NAMESPACE","valueFrom":{"fieldRef":{"apiVersion":"v1","fieldPath":"metadata.namespace"}}},{"name":"RABBITMQ_ENABLED_PLUGINS_FILE","value":"/operator/enabled_plugins"},{"name":"K8S_SERVICE_NAME","value":"rabbitmq-cluster-nodes"},{"name":"RABBITMQ_USE_LONGNAME","value":"true"},{"name":"RABBITMQ_NODENAME","value":"rabbit@$(MY_POD_NAME).$(K8S_SERVICE_NAME).$(MY_POD_NAMESPACE)"},{"name":"K8S_HOSTNAME_SUFFIX","value":".$(K8S_SERVICE_NAME).$(MY_POD_NAMESPACE)"}],"resources":{"limits":{"cpu":"2","memory":"2Gi"},"requests":{"cpu":"1","memory":"2Gi"}},"volumeMounts":[{"name":"rabbitmq-erlang-cookie","mountPath":"/var/lib/rabbitmq/"},{"name":"persistence","mountPath":"/var/lib/rabbitmq/mnesia/"},{"name":"rabbitmq-plugins","mountPath":"/operator"},{"name":"rabbitmq-confd","mountPath":"/etc/rabbitmq/conf.d/10-operatorDefaults.conf","subPath":"operatorDefaults.conf"},{"name":"rabbitmq-confd","mountPath":"/etc/rabbitmq/conf.d/11-default_user.conf","subPath":"default_user.conf"},{"name":"rabbitmq-confd","mountPath":"/etc/rabbitmq/conf.d/90-userDefinedConfiguration.conf","subPath":"userDefinedConfiguration.conf"},{"name":"pod-info","mountPath":"/etc/pod-info/"}],"readinessProbe":{"tcpSocket":{"port":"amqp"},"initialDelaySeconds":10,"timeoutSeconds":5,"periodSeconds":10,"successThreshold":1,"failureThreshold":3},"lifecycle":{"preStop":{"exec":{"command":["/bin/bash","-c","if [ ! -z \"$(cat /etc/pod-info/skipPreStopChecks)\" ]; then exit 0; fi; rabbitmq-upgrade await_online_quorum_plus_one -t 604800; rabbitmq-upgrade await_online_synchronized_mirror -t 604800; rabbitmq-upgrade drain -t 604800"]}}},"terminationMessagePath":"/dev/termination-log","terminationMessagePolicy":"File","imagePullPolicy":"IfNotPresent"}],"restartPolicy":"Always","terminationGracePeriodSeconds":604800,"dnsPolicy":"ClusterFirst","serviceAccountName":"rabbitmq-cluster-server","serviceAccount":"rabbitmq-cluster-server","automountServiceAccountToken":true,"securityContext":{"runAsUser":999,"runAsGroup":999,"fsGroup":999},"schedulerName":"default-scheduler","topologySpreadConstraints":[{"maxSkew":1,"topologyKey":"topology.kubernetes.io/zone","whenUnsatisfiable":"ScheduleAnyway","labelSelector":{"matchLabels":{"app.kubernetes.io/name":"rabbitmq-cluster"}}}]}},"volumeClaimTemplates":[{"metadata":{"name":"persistence","namespace":"default","creationTimestamp":null,"labels":{"app.kubernetes.io/component":"rabbitmq","app.kubernetes.io/name":"rabbitmq-cluster","app.kubernetes.io/part-of":"rabbitmq"},"ownerReferences":[{"apiVersion":"rabbitmq.com/v1beta1","kind":"RabbitmqCluster","name":"rabbitmq-cluster","uid":"3ecefa8a-1bec-48a7-9af4-dd0df3339101","controller":true,"blockOwnerDeletion":false}]},"spec":{"accessModes":["ReadWriteOnce"],"resources":{"requests":{"storage":"10Gi"}},"volumeMode":"Filesystem"},"status":{"phase":"Pending"}}],"serviceName":"rabbitmq-cluster-nodes","podManagementPolicy":"Parallel","updateStrategy":{"type":"RollingUpdate","rollingUpdate":{"partition":0}},"revisionHistoryLimit":10},"status":{"observedGeneration":1,"replicas":1,"currentReplicas":1,"updatedReplicas":1,"currentRevision":"rabbitmq-cluster-server-5f8b8665fb","updateRevision":"rabbitmq-cluster-server-5f8b8665fb","collisionCount":0}}
2022/03/18 18:06:25 learn_server.go:291: [SIEVE-AFTER-READ]	Get	true	statefulset	default	rabbitmq-cluster-server	github.com/rabbitmq/cluster-operator/controllers.(*RabbitmqClusterReconciler)	NoError	{"kind":"StatefulSet","apiVersion":"apps/v1","metadata":{"name":"rabbitmq-cluster-server","namespace":"default","selfLink":"/apis/apps/v1/namespaces/default/statefulsets/rabbitmq-cluster-server","uid":"f2f07f3e-b500-4c48-a5de-8db7eaf37b9a","resourceVersion":"1129","generation":1,"creationTimestamp":"2022-03-18T18:06:25Z","labels":{"app.kubernetes.io/component":"rabbitmq","app.kubernetes.io/name":"rabbitmq-cluster","app.kubernetes.io/part-of":"rabbitmq"},"annotations":{"rabbitmq.com/createdAt":"2022-03-18T18:06:25Z"},"ownerReferences":[{"apiVersion":"rabbitmq.com/v1beta1","kind":"RabbitmqCluster","name":"rabbitmq-cluster","uid":"3ecefa8a-1bec-48a7-9af4-dd0df3339101","controller":true,"blockOwnerDeletion":true}],"managedFields":[{"manager":"kube-controller-manager","operation":"Update","apiVersion":"apps/v1","time":"2022-03-18T18:06:25Z","fieldsType":"FieldsV1","fieldsV1":{"f:status":{"f:collisionCount":{},"f:currentReplicas":{},"f:currentRevision":{},"f:observedGeneration":{},"f:replicas":{},"f:updateRevision":{},"f:updatedReplicas":{}}}},{"manager":"manager","operation":"Update","apiVersion":"apps/v1","time":"2022-03-18T18:06:25Z","fieldsType":"FieldsV1","fieldsV1":{"f:metadata":{"f:annotations":{".":{},"f:rabbitmq.com/createdAt":{}},"f:labels":{".":{},"f:app.kubernetes.io/component":{},"f:app.kubernetes.io/name":{},"f:app.kubernetes.io/part-of":{}},"f:ownerReferences":{".":{},"k:{\"uid\":\"3ecefa8a-1bec-48a7-9af4-dd0df3339101\"}":{".":{},"f:apiVersion":{},"f:blockOwnerDeletion":{},"f:controller":{},"f:kind":{},"f:name":{},"f:uid":{}}}},"f:spec":{"f:podManagementPolicy":{},"f:replicas":{},"f:revisionHistoryLimit":{},"f:selector":{"f:matchLabels":{".":{},"f:app.kubernetes.io/name":{}}},"f:serviceName":{},"f:template":{"f:metadata":{"f:annotations":{".":{},"f:prometheus.io/port":{},"f:prometheus.io/scrape":{}},"f:labels":{".":{},"f:app.kubernetes.io/component":{},"f:app.kubernetes.io/name":{},"f:app.kubernetes.io/part-of":{}}},"f:spec":{"f:automountServiceAccountToken":{},"f:containers":{"k:{\"name\":\"rabbitmq\"}":{".":{},"f:env":{".":{},"k:{\"name\":\"K8S_HOSTNAME_SUFFIX\"}":{".":{},"f:name":{},"f:value":{}},"k:{\"name\":\"K8S_SERVICE_NAME\"}":{".":{},"f:name":{},"f:value":{}},"k:{\"name\":\"MY_POD_NAME\"}":{".":{},"f:name":{},"f:valueFrom":{".":{},"f:fieldRef":{".":{},"f:apiVersion":{},"f:fieldPath":{}}}},"k:{\"name\":\"MY_POD_NAMESPACE\"}":{".":{},"f:name":{},"f:valueFrom":{".":{},"f:fieldRef":{".":{},"f:apiVersion":{},"f:fieldPath":{}}}},"k:{\"name\":\"RABBITMQ_ENABLED_PLUGINS_FILE\"}":{".":{},"f:name":{},"f:value":{}},"k:{\"name\":\"RABBITMQ_NODENAME\"}":{".":{},"f:name":{},"f:value":{}},"k:{\"name\":\"RABBITMQ_USE_LONGNAME\"}":{".":{},"f:name":{},"f:value":{}}},"f:image":{},"f:imagePullPolicy":{},"f:lifecycle":{".":{},"f:preStop":{".":{},"f:exec":{".":{},"f:command":{}}}},"f:name":{},"f:ports":{".":{},"k:{\"containerPort\":4369,\"protocol\":\"TCP\"}":{".":{},"f:containerPort":{},"f:name":{},"f:protocol":{}},"k:{\"containerPort\":5672,\"protocol\":\"TCP\"}":{".":{},"f:containerPort":{},"f:name":{},"f:protocol":{}},"k:{\"containerPort\":15672,\"protocol\":\"TCP\"}":{".":{},"f:containerPort":{},"f:name":{},"f:protocol":{}},"k:{\"containerPort\":15692,\"protocol\":\"TCP\"}":{".":{},"f:containerPort":{},"f:name":{},"f:protocol":{}}},"f:readinessProbe":{".":{},"f:failureThreshold":{},"f:initialDelaySeconds":{},"f:periodSeconds":{},"f:successThreshold":{},"f:tcpSocket":{".":{},"f:port":{}},"f:timeoutSeconds":{}},"f:resources":{".":{},"f:limits":{".":{},"f:cpu":{},"f:memory":{}},"f:requests":{".":{},"f:cpu":{},"f:memory":{}}},"f:terminationMessagePath":{},"f:terminationMessagePolicy":{},"f:volumeMounts":{".":{},"k:{\"mountPath\":\"/etc/pod-info/\"}":{".":{},"f:mountPath":{},"f:name":{}},"k:{\"mountPath\":\"/etc/rabbitmq/conf.d/10-operatorDefaults.conf\"}":{".":{},"f:mountPath":{},"f:name":{},"f:subPath":{}},"k:{\"mountPath\":\"/etc/rabbitmq/conf.d/11-default_user.conf\"}":{".":{},"f:mountPath":{},"f:name":{},"f:subPath":{}},"k:{\"mountPath\":\"/etc/rabbitmq/conf.d/90-userDefinedConfiguration.conf\"}":{".":{},"f:mountPath":{},"f:name":{},"f:subPath":{}},"k:{\"mountPath\":\"/operator\"}":{".":{},"f:mountPath":{},"f:name":{}},"k:{\"mountPath\":\"/var/lib/rabbitmq/\"}":{".":{},"f:mountPath":{},"f:name":{}},"k:{\"mountPath\":\"/var/lib/rabbitmq/mnesia/\"}":{".":{},"f:mountPath":{},"f:name":{}}}}},"f:dnsPolicy":{},"f:initContainers":{".":{},"k:{\"name\":\"setup-container\"}":{".":{},"f:command":{},"f:image":{},"f:imagePullPolicy":{},"f:name":{},"f:resources":{".":{},"f:limits":{".":{},"f:cpu":{},"f:memory":{}},"f:requests":{".":{},"f:cpu":{},"f:memory":{}}},"f:securityContext":{".":{},"f:capabilities":{".":{},"f:drop":{}},"f:runAsUser":{}},"f:terminationMessagePath":{},"f:terminationMessagePolicy":{},"f:volumeMounts":{".":{},"k:{\"mountPath\":\"/operator\"}":{".":{},"f:mountPath":{},"f:name":{}},"k:{\"mountPath\":\"/tmp/default_user.conf\"}":{".":{},"f:mountPath":{},"f:name":{},"f:subPath":{}},"k:{\"mountPath\":\"/tmp/erlang-cookie-secret/\"}":{".":{},"f:mountPath":{},"f:name":{}},"k:{\"mountPath\":\"/tmp/rabbitmq-plugins/\"}":{".":{},"f:mountPath":{},"f:name":{}},"k:{\"mountPath\":\"/var/lib/rabbitmq/\"}":{".":{},"f:mountPath":{},"f:name":{}},"k:{\"mountPath\":\"/var/lib/rabbitmq/mnesia/\"}":{".":{},"f:mountPath":{},"f:name":{}}}}},"f:restartPolicy":{},"f:schedulerName":{},"f:securityContext":{".":{},"f:fsGroup":{},"f:runAsGroup":{},"f:runAsUser":{}},"f:serviceAccount":{},"f:serviceAccountName":{},"f:terminationGracePeriodSeconds":{},"f:topologySpreadConstraints":{".":{},"k:{\"topologyKey\":\"topology.kubernetes.io/zone\",\"whenUnsatisfiable\":\"ScheduleAnyway\"}":{".":{},"f:labelSelector":{".":{},"f:matchLabels":{".":{},"f:app.kubernetes.io/name":{}}},"f:maxSkew":{},"f:topologyKey":{},"f:whenUnsatisfiable":{}}},"f:volumes":{".":{},"k:{\"name\":\"erlang-cookie-secret\"}":{".":{},"f:name":{},"f:secret":{".":{},"f:defaultMode":{},"f:secretName":{}}},"k:{\"name\":\"plugins-conf\"}":{".":{},"f:configMap":{".":{},"f:defaultMode":{},"f:name":{}},"f:name":{}},"k:{\"name\":\"pod-info\"}":{".":{},"f:downwardAPI":{".":{},"f:defaultMode":{},"f:items":{}},"f:name":{}},"k:{\"name\":\"rabbitmq-confd\"}":{".":{},"f:name":{},"f:projected":{".":{},"f:defaultMode":{},"f:sources":{}}},"k:{\"name\":\"rabbitmq-erlang-cookie\"}":{".":{},"f:emptyDir":{},"f:name":{}},"k:{\"name\":\"rabbitmq-plugins\"}":{".":{},"f:emptyDir":{},"f:name":{}}}}},"f:updateStrategy":{"f:rollingUpdate":{".":{},"f:partition":{}},"f:type":{}},"f:volumeClaimTemplates":{}}}}]},"spec":{"replicas":1,"selector":{"matchLabels":{"app.kubernetes.io/name":"rabbitmq-cluster"}},"template":{"metadata":{"creationTimestamp":null,"labels":{"app.kubernetes.io/component":"rabbitmq","app.kubernetes.io/name":"rabbitmq-cluster","app.kubernetes.io/part-of":"rabbitmq"},"annotations":{"prometheus.io/port":"15692","prometheus.io/scrape":"true"}},"spec":{"volumes":[{"name":"plugins-conf","configMap":{"name":"rabbitmq-cluster-plugins-conf","defaultMode":420}},{"name":"rabbitmq-confd","projected":{"sources":[{"secret":{"name":"rabbitmq-cluster-default-user","items":[{"key":"default_user.conf","path":"default_user.conf"}]}},{"configMap":{"name":"rabbitmq-cluster-server-conf","items":[{"key":"operatorDefaults.conf","path":"operatorDefaults.conf"},{"key":"userDefinedConfiguration.conf","path":"userDefinedConfiguration.conf"}]}}],"defaultMode":420}},{"name":"rabbitmq-erlang-cookie","emptyDir":{}},{"name":"erlang-cookie-secret","secret":{"secretName":"rabbitmq-cluster-erlang-cookie","defaultMode":420}},{"name":"rabbitmq-plugins","emptyDir":{}},{"name":"pod-info","downwardAPI":{"items":[{"path":"skipPreStopChecks","fieldRef":{"apiVersion":"v1","fieldPath":"metadata.labels['skipPreStopChecks']"}}],"defaultMode":420}}],"initContainers":[{"name":"setup-container","image":"rabbitmq:3.8.12-management","command":["sh","-c","cp /tmp/erlang-cookie-secret/.erlang.cookie /var/lib/rabbitmq/.erlang.cookie \u0026\u0026 chown 999:999 /var/lib/rabbitmq/.erlang.cookie \u0026\u0026 chmod 600 /var/lib/rabbitmq/.erlang.cookie ; cp /tmp/rabbitmq-plugins/enabled_plugins /operator/enabled_plugins \u0026\u0026 chown 999:999 /operator/enabled_plugins ; chown 999:999 /var/lib/rabbitmq/mnesia/ ; echo '[default]' \u003e /var/lib/rabbitmq/.rabbitmqadmin.conf \u0026\u0026 sed -e 's/default_user/username/' -e 's/default_pass/password/' /tmp/default_user.conf \u003e\u003e /var/lib/rabbitmq/.rabbitmqadmin.conf \u0026\u0026 chown 999:999 /var/lib/rabbitmq/.rabbitmqadmin.conf \u0026\u0026 chmod 600 /var/lib/rabbitmq/.rabbitmqadmin.conf"],"resources":{"limits":{"cpu":"100m","memory":"500Mi"},"requests":{"cpu":"100m","memory":"500Mi"}},"volumeMounts":[{"name":"plugins-conf","mountPath":"/tmp/rabbitmq-plugins/"},{"name":"rabbitmq-erlang-cookie","mountPath":"/var/lib/rabbitmq/"},{"name":"erlang-cookie-secret","mountPath":"/tmp/erlang-cookie-secret/"},{"name":"rabbitmq-plugins","mountPath":"/operator"},{"name":"persistence","mountPath":"/var/lib/rabbitmq/mnesia/"},{"name":"rabbitmq-confd","mountPath":"/tmp/default_user.conf","subPath":"default_user.conf"}],"terminationMessagePath":"/dev/termination-log","terminationMessagePolicy":"File","imagePullPolicy":"IfNotPresent","securityContext":{"capabilities":{"drop":["FSETID","KILL","SETGID","SETUID","SETPCAP","NET_BIND_SERVICE","NET_RAW","SYS_CHROOT","MKNOD","AUDIT_WRITE","SETFCAP"]},"runAsUser":0}}],"containers":[{"name":"rabbitmq","image":"rabbitmq:3.8.12-management","ports":[{"name":"epmd","containerPort":4369,"protocol":"TCP"},{"name":"amqp","containerPort":5672,"protocol":"TCP"},{"name":"management","containerPort":15672,"protocol":"TCP"},{"name":"prometheus","containerPort":15692,"protocol":"TCP"}],"env":[{"name":"MY_POD_NAME","valueFrom":{"fieldRef":{"apiVersion":"v1","fieldPath":"metadata.name"}}},{"name":"MY_POD_NAMESPACE","valueFrom":{"fieldRef":{"apiVersion":"v1","fieldPath":"metadata.namespace"}}},{"name":"RABBITMQ_ENABLED_PLUGINS_FILE","value":"/operator/enabled_plugins"},{"name":"K8S_SERVICE_NAME","value":"rabbitmq-cluster-nodes"},{"name":"RABBITMQ_USE_LONGNAME","value":"true"},{"name":"RABBITMQ_NODENAME","value":"rabbit@$(MY_POD_NAME).$(K8S_SERVICE_NAME).$(MY_POD_NAMESPACE)"},{"name":"K8S_HOSTNAME_SUFFIX","value":".$(K8S_SERVICE_NAME).$(MY_POD_NAMESPACE)"}],"resources":{"limits":{"cpu":"2","memory":"2Gi"},"requests":{"cpu":"1","memory":"2Gi"}},"volumeMounts":[{"name":"rabbitmq-erlang-cookie","mountPath":"/var/lib/rabbitmq/"},{"name":"persistence","mountPath":"/var/lib/rabbitmq/mnesia/"},{"name":"rabbitmq-plugins","mountPath":"/operator"},{"name":"rabbitmq-confd","mountPath":"/etc/rabbitmq/conf.d/10-operatorDefaults.conf","subPath":"operatorDefaults.conf"},{"name":"rabbitmq-confd","mountPath":"/etc/rabbitmq/conf.d/11-default_user.conf","subPath":"default_user.conf"},{"name":"rabbitmq-confd","mountPath":"/etc/rabbitmq/conf.d/90-userDefinedConfiguration.conf","subPath":"userDefinedConfiguration.conf"},{"name":"pod-info","mountPath":"/etc/pod-info/"}],"readinessProbe":{"tcpSocket":{"port":"amqp"},"initialDelaySeconds":10,"timeoutSeconds":5,"periodSeconds":10,"successThreshold":1,"failureThreshold":3},"lifecycle":{"preStop":{"exec":{"command":["/bin/bash","-c","if [ ! -z \"$(cat /etc/pod-info/skipPreStopChecks)\" ]; then exit 0; fi; rabbitmq-upgrade await_online_quorum_plus_one -t 604800; rabbitmq-upgrade await_online_synchronized_mirror -t 604800; rabbitmq-upgrade drain -t 604800"]}}},"terminationMessagePath":"/dev/termination-log","terminationMessagePolicy":"File","imagePullPolicy":"IfNotPresent"}],"restartPolicy":"Always","terminationGracePeriodSeconds":604800,"dnsPolicy":"ClusterFirst","serviceAccountName":"rabbitmq-cluster-server","serviceAccount":"rabbitmq-cluster-server","automountServiceAccountToken":true,"securityContext":{"runAsUser":999,"runAsGroup":999,"fsGroup":999},"schedulerName":"default-scheduler","topologySpreadConstraints":[{"maxSkew":1,"topologyKey":"topology.kubernetes.io/zone","whenUnsatisfiable":"ScheduleAnyway","labelSelector":{"matchLabels":{"app.kubernetes.io/name":"rabbitmq-cluster"}}}]}},"volumeClaimTemplates":[{"metadata":{"name":"persistence","namespace":"default","creationTimestamp":null,"labels":{"app.kubernetes.io/component":"rabbitmq","app.kubernetes.io/name":"rabbitmq-cluster","app.kubernetes.io/part-of":"rabbitmq"},"ownerReferences":[{"apiVersion":"rabbitmq.com/v1beta1","kind":"RabbitmqCluster","name":"rabbitmq-cluster","uid":"3ecefa8a-1bec-48a7-9af4-dd0df3339101","controller":true,"blockOwnerDeletion":false}]},"spec":{"accessModes":["ReadWriteOnce"],"resources":{"requests":{"storage":"10Gi"}},"volumeMode":"Filesystem"},"status":{"phase":"Pending"}}],"serviceName":"rabbitmq-cluster-nodes","podManagementPolicy":"Parallel","updateStrategy":{"type":"RollingUpdate","rollingUpdate":{"partition":0}},"revisionHistoryLimit":10},"status":{"observedGeneration":1,"replicas":1,"currentReplicas":1,"updatedReplicas":1,"currentRevision":"rabbitmq-cluster-server-5f8b8665fb","updateRevision":"rabbitmq-cluster-server-5f8b8665fb","collisionCount":0}}
2022/03/18 18:06:25 learn_server.go:256: [SIEVE-BEFORE-WRITE]	18
2022/03/18 18:06:25 learn_server.go:263: [SIEVE-AFTER-WRITE]	18	Update	statefulset	github.com/rabbitmq/cluster-operator/controllers.(*RabbitmqClusterReconciler)	NoError	{"metadata":{"name":"rabbitmq-cluster-server","namespace":"default","selfLink":"/apis/apps/v1/namespaces/default/statefulsets/rabbitmq-cluster-server","uid":"f2f07f3e-b500-4c48-a5de-8db7eaf37b9a","resourceVersion":"1129","generation":1,"creationTimestamp":"2022-03-18T18:06:25Z","labels":{"app.kubernetes.io/component":"rabbitmq","app.kubernetes.io/name":"rabbitmq-cluster","app.kubernetes.io/part-of":"rabbitmq"},"annotations":{"rabbitmq.com/createdAt":"2022-03-18T18:06:25Z"},"ownerReferences":[{"apiVersion":"rabbitmq.com/v1beta1","kind":"RabbitmqCluster","name":"rabbitmq-cluster","uid":"3ecefa8a-1bec-48a7-9af4-dd0df3339101","controller":true,"blockOwnerDeletion":true}],"managedFields":[{"manager":"kube-controller-manager","operation":"Update","apiVersion":"apps/v1","time":"2022-03-18T18:06:25Z","fieldsType":"FieldsV1","fieldsV1":{"f:status":{"f:collisionCount":{},"f:currentReplicas":{},"f:currentRevision":{},"f:observedGeneration":{},"f:replicas":{},"f:updateRevision":{},"f:updatedReplicas":{}}}},{"manager":"manager","operation":"Update","apiVersion":"apps/v1","time":"2022-03-18T18:06:25Z","fieldsType":"FieldsV1","fieldsV1":{"f:metadata":{"f:annotations":{".":{},"f:rabbitmq.com/createdAt":{}},"f:labels":{".":{},"f:app.kubernetes.io/component":{},"f:app.kubernetes.io/name":{},"f:app.kubernetes.io/part-of":{}},"f:ownerReferences":{".":{},"k:{\"uid\":\"3ecefa8a-1bec-48a7-9af4-dd0df3339101\"}":{".":{},"f:apiVersion":{},"f:blockOwnerDeletion":{},"f:controller":{},"f:kind":{},"f:name":{},"f:uid":{}}}},"f:spec":{"f:podManagementPolicy":{},"f:replicas":{},"f:revisionHistoryLimit":{},"f:selector":{"f:matchLabels":{".":{},"f:app.kubernetes.io/name":{}}},"f:serviceName":{},"f:template":{"f:metadata":{"f:annotations":{".":{},"f:prometheus.io/port":{},"f:prometheus.io/scrape":{}},"f:labels":{".":{},"f:app.kubernetes.io/component":{},"f:app.kubernetes.io/name":{},"f:app.kubernetes.io/part-of":{}}},"f:spec":{"f:automountServiceAccountToken":{},"f:containers":{"k:{\"name\":\"rabbitmq\"}":{".":{},"f:env":{".":{},"k:{\"name\":\"K8S_HOSTNAME_SUFFIX\"}":{".":{},"f:name":{},"f:value":{}},"k:{\"name\":\"K8S_SERVICE_NAME\"}":{".":{},"f:name":{},"f:value":{}},"k:{\"name\":\"MY_POD_NAME\"}":{".":{},"f:name":{},"f:valueFrom":{".":{},"f:fieldRef":{".":{},"f:apiVersion":{},"f:fieldPath":{}}}},"k:{\"name\":\"MY_POD_NAMESPACE\"}":{".":{},"f:name":{},"f:valueFrom":{".":{},"f:fieldRef":{".":{},"f:apiVersion":{},"f:fieldPath":{}}}},"k:{\"name\":\"RABBITMQ_ENABLED_PLUGINS_FILE\"}":{".":{},"f:name":{},"f:value":{}},"k:{\"name\":\"RABBITMQ_NODENAME\"}":{".":{},"f:name":{},"f:value":{}},"k:{\"name\":\"RABBITMQ_USE_LONGNAME\"}":{".":{},"f:name":{},"f:value":{}}},"f:image":{},"f:imagePullPolicy":{},"f:lifecycle":{".":{},"f:preStop":{".":{},"f:exec":{".":{},"f:command":{}}}},"f:name":{},"f:ports":{".":{},"k:{\"containerPort\":4369,\"protocol\":\"TCP\"}":{".":{},"f:containerPort":{},"f:name":{},"f:protocol":{}},"k:{\"containerPort\":5672,\"protocol\":\"TCP\"}":{".":{},"f:containerPort":{},"f:name":{},"f:protocol":{}},"k:{\"containerPort\":15672,\"protocol\":\"TCP\"}":{".":{},"f:containerPort":{},"f:name":{},"f:protocol":{}},"k:{\"containerPort\":15692,\"protocol\":\"TCP\"}":{".":{},"f:containerPort":{},"f:name":{},"f:protocol":{}}},"f:readinessProbe":{".":{},"f:failureThreshold":{},"f:initialDelaySeconds":{},"f:periodSeconds":{},"f:successThreshold":{},"f:tcpSocket":{".":{},"f:port":{}},"f:timeoutSeconds":{}},"f:resources":{".":{},"f:limits":{".":{},"f:cpu":{},"f:memory":{}},"f:requests":{".":{},"f:cpu":{},"f:memory":{}}},"f:terminationMessagePath":{},"f:terminationMessagePolicy":{},"f:volumeMounts":{".":{},"k:{\"mountPath\":\"/etc/pod-info/\"}":{".":{},"f:mountPath":{},"f:name":{}},"k:{\"mountPath\":\"/etc/rabbitmq/conf.d/10-operatorDefaults.conf\"}":{".":{},"f:mountPath":{},"f:name":{},"f:subPath":{}},"k:{\"mountPath\":\"/etc/rabbitmq/conf.d/11-default_user.conf\"}":{".":{},"f:mountPath":{},"f:name":{},"f:subPath":{}},"k:{\"mountPath\":\"/etc/rabbitmq/conf.d/90-userDefinedConfiguration.conf\"}":{".":{},"f:mountPath":{},"f:name":{},"f:subPath":{}},"k:{\"mountPath\":\"/operator\"}":{".":{},"f:mountPath":{},"f:name":{}},"k:{\"mountPath\":\"/var/lib/rabbitmq/\"}":{".":{},"f:mountPath":{},"f:name":{}},"k:{\"mountPath\":\"/var/lib/rabbitmq/mnesia/\"}":{".":{},"f:mountPath":{},"f:name":{}}}}},"f:dnsPolicy":{},"f:initContainers":{".":{},"k:{\"name\":\"setup-container\"}":{".":{},"f:command":{},"f:image":{},"f:imagePullPolicy":{},"f:name":{},"f:resources":{".":{},"f:limits":{".":{},"f:cpu":{},"f:memory":{}},"f:requests":{".":{},"f:cpu":{},"f:memory":{}}},"f:securityContext":{".":{},"f:capabilities":{".":{},"f:drop":{}},"f:runAsUser":{}},"f:terminationMessagePath":{},"f:terminationMessagePolicy":{},"f:volumeMounts":{".":{},"k:{\"mountPath\":\"/operator\"}":{".":{},"f:mountPath":{},"f:name":{}},"k:{\"mountPath\":\"/tmp/default_user.conf\"}":{".":{},"f:mountPath":{},"f:name":{},"f:subPath":{}},"k:{\"mountPath\":\"/tmp/erlang-cookie-secret/\"}":{".":{},"f:mountPath":{},"f:name":{}},"k:{\"mountPath\":\"/tmp/rabbitmq-plugins/\"}":{".":{},"f:mountPath":{},"f:name":{}},"k:{\"mountPath\":\"/var/lib/rabbitmq/\"}":{".":{},"f:mountPath":{},"f:name":{}},"k:{\"mountPath\":\"/var/lib/rabbitmq/mnesia/\"}":{".":{},"f:mountPath":{},"f:name":{}}}}},"f:restartPolicy":{},"f:schedulerName":{},"f:securityContext":{".":{},"f:fsGroup":{},"f:runAsGroup":{},"f:runAsUser":{}},"f:serviceAccount":{},"f:serviceAccountName":{},"f:terminationGracePeriodSeconds":{},"f:topologySpreadConstraints":{".":{},"k:{\"topologyKey\":\"topology.kubernetes.io/zone\",\"whenUnsatisfiable\":\"ScheduleAnyway\"}":{".":{},"f:labelSelector":{".":{},"f:matchLabels":{".":{},"f:app.kubernetes.io/name":{}}},"f:maxSkew":{},"f:topologyKey":{},"f:whenUnsatisfiable":{}}},"f:volumes":{".":{},"k:{\"name\":\"erlang-cookie-secret\"}":{".":{},"f:name":{},"f:secret":{".":{},"f:defaultMode":{},"f:secretName":{}}},"k:{\"name\":\"plugins-conf\"}":{".":{},"f:configMap":{".":{},"f:defaultMode":{},"f:name":{}},"f:name":{}},"k:{\"name\":\"pod-info\"}":{".":{},"f:downwardAPI":{".":{},"f:defaultMode":{},"f:items":{}},"f:name":{}},"k:{\"name\":\"rabbitmq-confd\"}":{".":{},"f:name":{},"f:projected":{".":{},"f:defaultMode":{},"f:sources":{}}},"k:{\"name\":\"rabbitmq-erlang-cookie\"}":{".":{},"f:emptyDir":{},"f:name":{}},"k:{\"name\":\"rabbitmq-plugins\"}":{".":{},"f:emptyDir":{},"f:name":{}}}}},"f:updateStrategy":{"f:rollingUpdate":{".":{},"f:partition":{}},"f:type":{}},"f:volumeClaimTemplates":{}}}}]},"spec":{"replicas":1,"selector":{"matchLabels":{"app.kubernetes.io/name":"rabbitmq-cluster"}},"template":{"metadata":{"creationTimestamp":null,"labels":{"app.kubernetes.io/component":"rabbitmq","app.kubernetes.io/name":"rabbitmq-cluster","app.kubernetes.io/part-of":"rabbitmq"},"annotations":{"prometheus.io/port":"15692","prometheus.io/scrape":"true"}},"spec":{"volumes":[{"name":"plugins-conf","configMap":{"name":"rabbitmq-cluster-plugins-conf","defaultMode":420}},{"name":"rabbitmq-confd","projected":{"sources":[{"secret":{"name":"rabbitmq-cluster-default-user","items":[{"key":"default_user.conf","path":"default_user.conf"}]}},{"configMap":{"name":"rabbitmq-cluster-server-conf","items":[{"key":"operatorDefaults.conf","path":"operatorDefaults.conf"},{"key":"userDefinedConfiguration.conf","path":"userDefinedConfiguration.conf"}]}}],"defaultMode":420}},{"name":"rabbitmq-erlang-cookie","emptyDir":{}},{"name":"erlang-cookie-secret","secret":{"secretName":"rabbitmq-cluster-erlang-cookie","defaultMode":420}},{"name":"rabbitmq-plugins","emptyDir":{}},{"name":"pod-info","downwardAPI":{"items":[{"path":"skipPreStopChecks","fieldRef":{"apiVersion":"v1","fieldPath":"metadata.labels['skipPreStopChecks']"}}],"defaultMode":420}}],"initContainers":[{"name":"setup-container","image":"rabbitmq:3.8.12-management","command":["sh","-c","cp /tmp/erlang-cookie-secret/.erlang.cookie /var/lib/rabbitmq/.erlang.cookie \u0026\u0026 chown 999:999 /var/lib/rabbitmq/.erlang.cookie \u0026\u0026 chmod 600 /var/lib/rabbitmq/.erlang.cookie ; cp /tmp/rabbitmq-plugins/enabled_plugins /operator/enabled_plugins \u0026\u0026 chown 999:999 /operator/enabled_plugins ; chown 999:999 /var/lib/rabbitmq/mnesia/ ; echo '[default]' \u003e /var/lib/rabbitmq/.rabbitmqadmin.conf \u0026\u0026 sed -e 's/default_user/username/' -e 's/default_pass/password/' /tmp/default_user.conf \u003e\u003e /var/lib/rabbitmq/.rabbitmqadmin.conf \u0026\u0026 chown 999:999 /var/lib/rabbitmq/.rabbitmqadmin.conf \u0026\u0026 chmod 600 /var/lib/rabbitmq/.rabbitmqadmin.conf"],"resources":{"limits":{"cpu":"100m","memory":"500Mi"},"requests":{"cpu":"100m","memory":"500Mi"}},"volumeMounts":[{"name":"plugins-conf","mountPath":"/tmp/rabbitmq-plugins/"},{"name":"rabbitmq-erlang-cookie","mountPath":"/var/lib/rabbitmq/"},{"name":"erlang-cookie-secret","mountPath":"/tmp/erlang-cookie-secret/"},{"name":"rabbitmq-plugins","mountPath":"/operator"},{"name":"persistence","mountPath":"/var/lib/rabbitmq/mnesia/"},{"name":"rabbitmq-confd","mountPath":"/tmp/default_user.conf","subPath":"default_user.conf"}],"terminationMessagePath":"/dev/termination-log","terminationMessagePolicy":"File","imagePullPolicy":"IfNotPresent","securityContext":{"capabilities":{"drop":["FSETID","KILL","SETGID","SETUID","SETPCAP","NET_BIND_SERVICE","NET_RAW","SYS_CHROOT","MKNOD","AUDIT_WRITE","SETFCAP"]},"runAsUser":0}}],"containers":[{"name":"rabbitmq","image":"rabbitmq:3.8.12-management","ports":[{"name":"epmd","containerPort":4369,"protocol":"TCP"},{"name":"amqp","containerPort":5672,"protocol":"TCP"},{"name":"management","containerPort":15672,"protocol":"TCP"},{"name":"prometheus","containerPort":15692,"protocol":"TCP"}],"env":[{"name":"MY_POD_NAME","valueFrom":{"fieldRef":{"apiVersion":"v1","fieldPath":"metadata.name"}}},{"name":"MY_POD_NAMESPACE","valueFrom":{"fieldRef":{"apiVersion":"v1","fieldPath":"metadata.namespace"}}},{"name":"RABBITMQ_ENABLED_PLUGINS_FILE","value":"/operator/enabled_plugins"},{"name":"K8S_SERVICE_NAME","value":"rabbitmq-cluster-nodes"},{"name":"RABBITMQ_USE_LONGNAME","value":"true"},{"name":"RABBITMQ_NODENAME","value":"rabbit@$(MY_POD_NAME).$(K8S_SERVICE_NAME).$(MY_POD_NAMESPACE)"},{"name":"K8S_HOSTNAME_SUFFIX","value":".$(K8S_SERVICE_NAME).$(MY_POD_NAMESPACE)"}],"resources":{"limits":{"cpu":"2","memory":"2Gi"},"requests":{"cpu":"1","memory":"2Gi"}},"volumeMounts":[{"name":"rabbitmq-erlang-cookie","mountPath":"/var/lib/rabbitmq/"},{"name":"persistence","mountPath":"/var/lib/rabbitmq/mnesia/"},{"name":"rabbitmq-plugins","mountPath":"/operator"},{"name":"rabbitmq-confd","mountPath":"/etc/rabbitmq/conf.d/10-operatorDefaults.conf","subPath":"operatorDefaults.conf"},{"name":"rabbitmq-confd","mountPath":"/etc/rabbitmq/conf.d/11-default_user.conf","subPath":"default_user.conf"},{"name":"rabbitmq-confd","mountPath":"/etc/rabbitmq/conf.d/90-userDefinedConfiguration.conf","subPath":"userDefinedConfiguration.conf"},{"name":"pod-info","mountPath":"/etc/pod-info/"}],"readinessProbe":{"tcpSocket":{"port":"amqp"},"initialDelaySeconds":10,"timeoutSeconds":5,"periodSeconds":10,"successThreshold":1,"failureThreshold":3},"lifecycle":{"preStop":{"exec":{"command":["/bin/bash","-c","if [ ! -z \"$(cat /etc/pod-info/skipPreStopChecks)\" ]; then exit 0; fi; rabbitmq-upgrade await_online_quorum_plus_one -t 604800; rabbitmq-upgrade await_online_synchronized_mirror -t 604800; rabbitmq-upgrade drain -t 604800"]}}},"terminationMessagePath":"/dev/termination-log","terminationMessagePolicy":"File","imagePullPolicy":"IfNotPresent"}],"restartPolicy":"Always","terminationGracePeriodSeconds":604800,"dnsPolicy":"ClusterFirst","serviceAccountName":"rabbitmq-cluster-server","serviceAccount":"rabbitmq-cluster-server","automountServiceAccountToken":true,"securityContext":{"runAsUser":999,"runAsGroup":999,"fsGroup":999},"schedulerName":"default-scheduler","topologySpreadConstraints":[{"maxSkew":1,"topologyKey":"topology.kubernetes.io/zone","whenUnsatisfiable":"ScheduleAnyway","labelSelector":{"matchLabels":{"app.kubernetes.io/name":"rabbitmq-cluster"}}}]}},"volumeClaimTemplates":[{"metadata":{"name":"persistence","namespace":"default","creationTimestamp":null,"labels":{"app.kubernetes.io/component":"rabbitmq","app.kubernetes.io/name":"rabbitmq-cluster","app.kubernetes.io/part-of":"rabbitmq"},"ownerReferences":[{"apiVersion":"rabbitmq.com/v1beta1","kind":"RabbitmqCluster","name":"rabbitmq-cluster","uid":"3ecefa8a-1bec-48a7-9af4-dd0df3339101","controller":true,"blockOwnerDeletion":false}]},"spec":{"accessModes":["ReadWriteOnce"],"resources":{"requests":{"storage":"10Gi"}},"volumeMode":"Filesystem"},"status":{"phase":"Pending"}}],"serviceName":"rabbitmq-cluster-nodes","podManagementPolicy":"Parallel","updateStrategy":{"type":"RollingUpdate","rollingUpdate":{"partition":0}},"revisionHistoryLimit":10},"status":{"observedGeneration":1,"replicas":1,"currentReplicas":1,"updatedReplicas":1,"currentRevision":"rabbitmq-cluster-server-5f8b8665fb","updateRevision":"rabbitmq-cluster-server-5f8b8665fb","collisionCount":0}}
2022/03/18 18:06:25 learn_server.go:291: [SIEVE-AFTER-READ]	Get	true	configmap	default	rabbitmq-cluster-server-conf	github.com/rabbitmq/cluster-operator/controllers.(*RabbitmqClusterReconciler)	NoError	{"kind":"ConfigMap","apiVersion":"v1","metadata":{"name":"rabbitmq-cluster-server-conf","namespace":"default","selfLink":"/api/v1/namespaces/default/configmaps/rabbitmq-cluster-server-conf","uid":"e4182078-d429-4baf-9021-72618c509ac5","resourceVersion":"1095","creationTimestamp":"2022-03-18T18:06:25Z","labels":{"app.kubernetes.io/component":"rabbitmq","app.kubernetes.io/name":"rabbitmq-cluster","app.kubernetes.io/part-of":"rabbitmq"},"ownerReferences":[{"apiVersion":"rabbitmq.com/v1beta1","kind":"RabbitmqCluster","name":"rabbitmq-cluster","uid":"3ecefa8a-1bec-48a7-9af4-dd0df3339101","controller":true,"blockOwnerDeletion":true}],"managedFields":[{"manager":"manager","operation":"Update","apiVersion":"v1","time":"2022-03-18T18:06:25Z","fieldsType":"FieldsV1","fieldsV1":{"f:data":{".":{},"f:operatorDefaults.conf":{},"f:userDefinedConfiguration.conf":{}},"f:metadata":{"f:labels":{".":{},"f:app.kubernetes.io/component":{},"f:app.kubernetes.io/name":{},"f:app.kubernetes.io/part-of":{}},"f:ownerReferences":{".":{},"k:{\"uid\":\"3ecefa8a-1bec-48a7-9af4-dd0df3339101\"}":{".":{},"f:apiVersion":{},"f:blockOwnerDeletion":{},"f:controller":{},"f:kind":{},"f:name":{},"f:uid":{}}}}}}]},"data":{"operatorDefaults.conf":"cluster_formation.peer_discovery_backend             = rabbit_peer_discovery_k8s\ncluster_formation.k8s.host                           = kubernetes.default\ncluster_formation.k8s.address_type                   = hostname\ncluster_partition_handling                           = pause_minority\nqueue_master_locator                                 = min-masters\ndisk_free_limit.absolute                             = 2GB\ncluster_formation.randomized_startup_delay_range.min = 5\ncluster_formation.randomized_startup_delay_range.max = 30\ncluster_name                                         = rabbitmq-cluster\n","userDefinedConfiguration.conf":"total_memory_available_override_value = 1717986919\n"}}
2022/03/18 18:06:25 learn_server.go:256: [SIEVE-BEFORE-WRITE]	19
2022/03/18 18:06:25 learn_server.go:263: [SIEVE-AFTER-WRITE]	19	StatusUpdate	rabbitmqcluster	github.com/rabbitmq/cluster-operator/controllers.(*RabbitmqClusterReconciler)	NoError	{"metadata":{"name":"rabbitmq-cluster","namespace":"default","selfLink":"/apis/rabbitmq.com/v1beta1/namespaces/default/rabbitmqclusters/rabbitmq-cluster/status","uid":"3ecefa8a-1bec-48a7-9af4-dd0df3339101","resourceVersion":"1132","generation":2,"creationTimestamp":"2022-03-18T18:06:25Z","annotations":{"kubectl.kubernetes.io/last-applied-configuration":"{\"apiVersion\":\"rabbitmq.com/v1beta1\",\"kind\":\"RabbitmqCluster\",\"metadata\":{\"annotations\":{},\"name\":\"rabbitmq-cluster\",\"namespace\":\"default\"},\"spec\":{\"persistence\":{\"storage\":\"10Gi\"},\"replicas\":1}}\n"},"finalizers":["deletion.finalizers.rabbitmqclusters.rabbitmq.com"],"managedFields":[{"manager":"kubectl-client-side-apply","operation":"Update","apiVersion":"rabbitmq.com/v1beta1","time":"2022-03-18T18:06:25Z","fieldsType":"FieldsV1","fieldsV1":{"f:metadata":{"f:annotations":{".":{},"f:kubectl.kubernetes.io/last-applied-configuration":{}}},"f:spec":{".":{},"f:image":{},"f:persistence":{".":{},"f:storage":{}},"f:replicas":{},"f:resources":{".":{},"f:limits":{".":{},"f:memory":{}},"f:requests":{".":{},"f:memory":{}}},"f:service":{".":{},"f:type":{}},"f:terminationGracePeriodSeconds":{}}}},{"manager":"manager","operation":"Update","apiVersion":"rabbitmq.com/v1beta1","time":"2022-03-18T18:06:25Z","fieldsType":"FieldsV1","fieldsV1":{"f:metadata":{"f:finalizers":{}},"f:spec":{"f:override":{},"f:rabbitmq":{},"f:resources":{"f:limits":{"f:cpu":{}},"f:requests":{"f:cpu":{}}},"f:tls":{}},"f:status":{".":{},"f:conditions":{},"f:defaultUser":{".":{},"f:secretReference":{".":{},"f:keys":{".":{},"f:password":{},"f:username":{}},"f:name":{},"f:namespace":{}},"f:serviceReference":{".":{},"f:name":{},"f:namespace":{}}}}}}]},"spec":{"replicas":1,"image":"rabbitmq:3.8.12-management","service":{"type":"ClusterIP"},"persistence":{"storage":"10Gi"},"resources":{"limits":{"cpu":"2","memory":"2Gi"},"requests":{"cpu":"1","memory":"2Gi"}},"rabbitmq":{},"tls":{},"override":{},"terminationGracePeriodSeconds":604800},"status":{"conditions":[{"type":"AllReplicasReady","status":"False","lastTransitionTime":"2022-03-18T18:06:25Z","reason":"NotAllPodsReady","message":"0/1 Pods ready"},{"type":"ClusterAvailable","status":"False","lastTransitionTime":"2022-03-18T18:06:25Z","reason":"NoEndpointsAvailable","message":"The service has no endpoints available"},{"type":"NoWarnings","status":"True","lastTransitionTime":"2022-03-18T18:06:25Z","reason":"NoWarnings"},{"type":"ReconcileSuccess","status":"Unknown","lastTransitionTime":"2022-03-18T18:06:25Z","reason":"Initialising"}],"defaultUser":{"secretReference":{"name":"rabbitmq-cluster-default-user","namespace":"default","keys":{"password":"password","username":"username"}},"serviceReference":{"name":"rabbitmq-cluster","namespace":"default"}},"binding":{"name":"rabbitmq-cluster-default-user"}}}
2022/03/18 18:06:25 learn_server.go:291: [SIEVE-AFTER-READ]	Get	true	statefulset	default	rabbitmq-cluster-server	github.com/rabbitmq/cluster-operator/controllers.(*RabbitmqClusterReconciler)	NoError	{"kind":"StatefulSet","apiVersion":"apps/v1","metadata":{"name":"rabbitmq-cluster-server","namespace":"default","selfLink":"/apis/apps/v1/namespaces/default/statefulsets/rabbitmq-cluster-server","uid":"f2f07f3e-b500-4c48-a5de-8db7eaf37b9a","resourceVersion":"1129","generation":1,"creationTimestamp":"2022-03-18T18:06:25Z","labels":{"app.kubernetes.io/component":"rabbitmq","app.kubernetes.io/name":"rabbitmq-cluster","app.kubernetes.io/part-of":"rabbitmq"},"annotations":{"rabbitmq.com/createdAt":"2022-03-18T18:06:25Z"},"ownerReferences":[{"apiVersion":"rabbitmq.com/v1beta1","kind":"RabbitmqCluster","name":"rabbitmq-cluster","uid":"3ecefa8a-1bec-48a7-9af4-dd0df3339101","controller":true,"blockOwnerDeletion":true}],"managedFields":[{"manager":"kube-controller-manager","operation":"Update","apiVersion":"apps/v1","time":"2022-03-18T18:06:25Z","fieldsType":"FieldsV1","fieldsV1":{"f:status":{"f:collisionCount":{},"f:currentReplicas":{},"f:currentRevision":{},"f:observedGeneration":{},"f:replicas":{},"f:updateRevision":{},"f:updatedReplicas":{}}}},{"manager":"manager","operation":"Update","apiVersion":"apps/v1","time":"2022-03-18T18:06:25Z","fieldsType":"FieldsV1","fieldsV1":{"f:metadata":{"f:annotations":{".":{},"f:rabbitmq.com/createdAt":{}},"f:labels":{".":{},"f:app.kubernetes.io/component":{},"f:app.kubernetes.io/name":{},"f:app.kubernetes.io/part-of":{}},"f:ownerReferences":{".":{},"k:{\"uid\":\"3ecefa8a-1bec-48a7-9af4-dd0df3339101\"}":{".":{},"f:apiVersion":{},"f:blockOwnerDeletion":{},"f:controller":{},"f:kind":{},"f:name":{},"f:uid":{}}}},"f:spec":{"f:podManagementPolicy":{},"f:replicas":{},"f:revisionHistoryLimit":{},"f:selector":{"f:matchLabels":{".":{},"f:app.kubernetes.io/name":{}}},"f:serviceName":{},"f:template":{"f:metadata":{"f:annotations":{".":{},"f:prometheus.io/port":{},"f:prometheus.io/scrape":{}},"f:labels":{".":{},"f:app.kubernetes.io/component":{},"f:app.kubernetes.io/name":{},"f:app.kubernetes.io/part-of":{}}},"f:spec":{"f:automountServiceAccountToken":{},"f:containers":{"k:{\"name\":\"rabbitmq\"}":{".":{},"f:env":{".":{},"k:{\"name\":\"K8S_HOSTNAME_SUFFIX\"}":{".":{},"f:name":{},"f:value":{}},"k:{\"name\":\"K8S_SERVICE_NAME\"}":{".":{},"f:name":{},"f:value":{}},"k:{\"name\":\"MY_POD_NAME\"}":{".":{},"f:name":{},"f:valueFrom":{".":{},"f:fieldRef":{".":{},"f:apiVersion":{},"f:fieldPath":{}}}},"k:{\"name\":\"MY_POD_NAMESPACE\"}":{".":{},"f:name":{},"f:valueFrom":{".":{},"f:fieldRef":{".":{},"f:apiVersion":{},"f:fieldPath":{}}}},"k:{\"name\":\"RABBITMQ_ENABLED_PLUGINS_FILE\"}":{".":{},"f:name":{},"f:value":{}},"k:{\"name\":\"RABBITMQ_NODENAME\"}":{".":{},"f:name":{},"f:value":{}},"k:{\"name\":\"RABBITMQ_USE_LONGNAME\"}":{".":{},"f:name":{},"f:value":{}}},"f:image":{},"f:imagePullPolicy":{},"f:lifecycle":{".":{},"f:preStop":{".":{},"f:exec":{".":{},"f:command":{}}}},"f:name":{},"f:ports":{".":{},"k:{\"containerPort\":4369,\"protocol\":\"TCP\"}":{".":{},"f:containerPort":{},"f:name":{},"f:protocol":{}},"k:{\"containerPort\":5672,\"protocol\":\"TCP\"}":{".":{},"f:containerPort":{},"f:name":{},"f:protocol":{}},"k:{\"containerPort\":15672,\"protocol\":\"TCP\"}":{".":{},"f:containerPort":{},"f:name":{},"f:protocol":{}},"k:{\"containerPort\":15692,\"protocol\":\"TCP\"}":{".":{},"f:containerPort":{},"f:name":{},"f:protocol":{}}},"f:readinessProbe":{".":{},"f:failureThreshold":{},"f:initialDelaySeconds":{},"f:periodSeconds":{},"f:successThreshold":{},"f:tcpSocket":{".":{},"f:port":{}},"f:timeoutSeconds":{}},"f:resources":{".":{},"f:limits":{".":{},"f:cpu":{},"f:memory":{}},"f:requests":{".":{},"f:cpu":{},"f:memory":{}}},"f:terminationMessagePath":{},"f:terminationMessagePolicy":{},"f:volumeMounts":{".":{},"k:{\"mountPath\":\"/etc/pod-info/\"}":{".":{},"f:mountPath":{},"f:name":{}},"k:{\"mountPath\":\"/etc/rabbitmq/conf.d/10-operatorDefaults.conf\"}":{".":{},"f:mountPath":{},"f:name":{},"f:subPath":{}},"k:{\"mountPath\":\"/etc/rabbitmq/conf.d/11-default_user.conf\"}":{".":{},"f:mountPath":{},"f:name":{},"f:subPath":{}},"k:{\"mountPath\":\"/etc/rabbitmq/conf.d/90-userDefinedConfiguration.conf\"}":{".":{},"f:mountPath":{},"f:name":{},"f:subPath":{}},"k:{\"mountPath\":\"/operator\"}":{".":{},"f:mountPath":{},"f:name":{}},"k:{\"mountPath\":\"/var/lib/rabbitmq/\"}":{".":{},"f:mountPath":{},"f:name":{}},"k:{\"mountPath\":\"/var/lib/rabbitmq/mnesia/\"}":{".":{},"f:mountPath":{},"f:name":{}}}}},"f:dnsPolicy":{},"f:initContainers":{".":{},"k:{\"name\":\"setup-container\"}":{".":{},"f:command":{},"f:image":{},"f:imagePullPolicy":{},"f:name":{},"f:resources":{".":{},"f:limits":{".":{},"f:cpu":{},"f:memory":{}},"f:requests":{".":{},"f:cpu":{},"f:memory":{}}},"f:securityContext":{".":{},"f:capabilities":{".":{},"f:drop":{}},"f:runAsUser":{}},"f:terminationMessagePath":{},"f:terminationMessagePolicy":{},"f:volumeMounts":{".":{},"k:{\"mountPath\":\"/operator\"}":{".":{},"f:mountPath":{},"f:name":{}},"k:{\"mountPath\":\"/tmp/default_user.conf\"}":{".":{},"f:mountPath":{},"f:name":{},"f:subPath":{}},"k:{\"mountPath\":\"/tmp/erlang-cookie-secret/\"}":{".":{},"f:mountPath":{},"f:name":{}},"k:{\"mountPath\":\"/tmp/rabbitmq-plugins/\"}":{".":{},"f:mountPath":{},"f:name":{}},"k:{\"mountPath\":\"/var/lib/rabbitmq/\"}":{".":{},"f:mountPath":{},"f:name":{}},"k:{\"mountPath\":\"/var/lib/rabbitmq/mnesia/\"}":{".":{},"f:mountPath":{},"f:name":{}}}}},"f:restartPolicy":{},"f:schedulerName":{},"f:securityContext":{".":{},"f:fsGroup":{},"f:runAsGroup":{},"f:runAsUser":{}},"f:serviceAccount":{},"f:serviceAccountName":{},"f:terminationGracePeriodSeconds":{},"f:topologySpreadConstraints":{".":{},"k:{\"topologyKey\":\"topology.kubernetes.io/zone\",\"whenUnsatisfiable\":\"ScheduleAnyway\"}":{".":{},"f:labelSelector":{".":{},"f:matchLabels":{".":{},"f:app.kubernetes.io/name":{}}},"f:maxSkew":{},"f:topologyKey":{},"f:whenUnsatisfiable":{}}},"f:volumes":{".":{},"k:{\"name\":\"erlang-cookie-secret\"}":{".":{},"f:name":{},"f:secret":{".":{},"f:defaultMode":{},"f:secretName":{}}},"k:{\"name\":\"plugins-conf\"}":{".":{},"f:configMap":{".":{},"f:defaultMode":{},"f:name":{}},"f:name":{}},"k:{\"name\":\"pod-info\"}":{".":{},"f:downwardAPI":{".":{},"f:defaultMode":{},"f:items":{}},"f:name":{}},"k:{\"name\":\"rabbitmq-confd\"}":{".":{},"f:name":{},"f:projected":{".":{},"f:defaultMode":{},"f:sources":{}}},"k:{\"name\":\"rabbitmq-erlang-cookie\"}":{".":{},"f:emptyDir":{},"f:name":{}},"k:{\"name\":\"rabbitmq-plugins\"}":{".":{},"f:emptyDir":{},"f:name":{}}}}},"f:updateStrategy":{"f:rollingUpdate":{".":{},"f:partition":{}},"f:type":{}},"f:volumeClaimTemplates":{}}}}]},"spec":{"replicas":1,"selector":{"matchLabels":{"app.kubernetes.io/name":"rabbitmq-cluster"}},"template":{"metadata":{"creationTimestamp":null,"labels":{"app.kubernetes.io/component":"rabbitmq","app.kubernetes.io/name":"rabbitmq-cluster","app.kubernetes.io/part-of":"rabbitmq"},"annotations":{"prometheus.io/port":"15692","prometheus.io/scrape":"true"}},"spec":{"volumes":[{"name":"plugins-conf","configMap":{"name":"rabbitmq-cluster-plugins-conf","defaultMode":420}},{"name":"rabbitmq-confd","projected":{"sources":[{"secret":{"name":"rabbitmq-cluster-default-user","items":[{"key":"default_user.conf","path":"default_user.conf"}]}},{"configMap":{"name":"rabbitmq-cluster-server-conf","items":[{"key":"operatorDefaults.conf","path":"operatorDefaults.conf"},{"key":"userDefinedConfiguration.conf","path":"userDefinedConfiguration.conf"}]}}],"defaultMode":420}},{"name":"rabbitmq-erlang-cookie","emptyDir":{}},{"name":"erlang-cookie-secret","secret":{"secretName":"rabbitmq-cluster-erlang-cookie","defaultMode":420}},{"name":"rabbitmq-plugins","emptyDir":{}},{"name":"pod-info","downwardAPI":{"items":[{"path":"skipPreStopChecks","fieldRef":{"apiVersion":"v1","fieldPath":"metadata.labels['skipPreStopChecks']"}}],"defaultMode":420}}],"initContainers":[{"name":"setup-container","image":"rabbitmq:3.8.12-management","command":["sh","-c","cp /tmp/erlang-cookie-secret/.erlang.cookie /var/lib/rabbitmq/.erlang.cookie \u0026\u0026 chown 999:999 /var/lib/rabbitmq/.erlang.cookie \u0026\u0026 chmod 600 /var/lib/rabbitmq/.erlang.cookie ; cp /tmp/rabbitmq-plugins/enabled_plugins /operator/enabled_plugins \u0026\u0026 chown 999:999 /operator/enabled_plugins ; chown 999:999 /var/lib/rabbitmq/mnesia/ ; echo '[default]' \u003e /var/lib/rabbitmq/.rabbitmqadmin.conf \u0026\u0026 sed -e 's/default_user/username/' -e 's/default_pass/password/' /tmp/default_user.conf \u003e\u003e /var/lib/rabbitmq/.rabbitmqadmin.conf \u0026\u0026 chown 999:999 /var/lib/rabbitmq/.rabbitmqadmin.conf \u0026\u0026 chmod 600 /var/lib/rabbitmq/.rabbitmqadmin.conf"],"resources":{"limits":{"cpu":"100m","memory":"500Mi"},"requests":{"cpu":"100m","memory":"500Mi"}},"volumeMounts":[{"name":"plugins-conf","mountPath":"/tmp/rabbitmq-plugins/"},{"name":"rabbitmq-erlang-cookie","mountPath":"/var/lib/rabbitmq/"},{"name":"erlang-cookie-secret","mountPath":"/tmp/erlang-cookie-secret/"},{"name":"rabbitmq-plugins","mountPath":"/operator"},{"name":"persistence","mountPath":"/var/lib/rabbitmq/mnesia/"},{"name":"rabbitmq-confd","mountPath":"/tmp/default_user.conf","subPath":"default_user.conf"}],"terminationMessagePath":"/dev/termination-log","terminationMessagePolicy":"File","imagePullPolicy":"IfNotPresent","securityContext":{"capabilities":{"drop":["FSETID","KILL","SETGID","SETUID","SETPCAP","NET_BIND_SERVICE","NET_RAW","SYS_CHROOT","MKNOD","AUDIT_WRITE","SETFCAP"]},"runAsUser":0}}],"containers":[{"name":"rabbitmq","image":"rabbitmq:3.8.12-management","ports":[{"name":"epmd","containerPort":4369,"protocol":"TCP"},{"name":"amqp","containerPort":5672,"protocol":"TCP"},{"name":"management","containerPort":15672,"protocol":"TCP"},{"name":"prometheus","containerPort":15692,"protocol":"TCP"}],"env":[{"name":"MY_POD_NAME","valueFrom":{"fieldRef":{"apiVersion":"v1","fieldPath":"metadata.name"}}},{"name":"MY_POD_NAMESPACE","valueFrom":{"fieldRef":{"apiVersion":"v1","fieldPath":"metadata.namespace"}}},{"name":"RABBITMQ_ENABLED_PLUGINS_FILE","value":"/operator/enabled_plugins"},{"name":"K8S_SERVICE_NAME","value":"rabbitmq-cluster-nodes"},{"name":"RABBITMQ_USE_LONGNAME","value":"true"},{"name":"RABBITMQ_NODENAME","value":"rabbit@$(MY_POD_NAME).$(K8S_SERVICE_NAME).$(MY_POD_NAMESPACE)"},{"name":"K8S_HOSTNAME_SUFFIX","value":".$(K8S_SERVICE_NAME).$(MY_POD_NAMESPACE)"}],"resources":{"limits":{"cpu":"2","memory":"2Gi"},"requests":{"cpu":"1","memory":"2Gi"}},"volumeMounts":[{"name":"rabbitmq-erlang-cookie","mountPath":"/var/lib/rabbitmq/"},{"name":"persistence","mountPath":"/var/lib/rabbitmq/mnesia/"},{"name":"rabbitmq-plugins","mountPath":"/operator"},{"name":"rabbitmq-confd","mountPath":"/etc/rabbitmq/conf.d/10-operatorDefaults.conf","subPath":"operatorDefaults.conf"},{"name":"rabbitmq-confd","mountPath":"/etc/rabbitmq/conf.d/11-default_user.conf","subPath":"default_user.conf"},{"name":"rabbitmq-confd","mountPath":"/etc/rabbitmq/conf.d/90-userDefinedConfiguration.conf","subPath":"userDefinedConfiguration.conf"},{"name":"pod-info","mountPath":"/etc/pod-info/"}],"readinessProbe":{"tcpSocket":{"port":"amqp"},"initialDelaySeconds":10,"timeoutSeconds":5,"periodSeconds":10,"successThreshold":1,"failureThreshold":3},"lifecycle":{"preStop":{"exec":{"command":["/bin/bash","-c","if [ ! -z \"$(cat /etc/pod-info/skipPreStopChecks)\" ]; then exit 0; fi; rabbitmq-upgrade await_online_quorum_plus_one -t 604800; rabbitmq-upgrade await_online_synchronized_mirror -t 604800; rabbitmq-upgrade drain -t 604800"]}}},"terminationMessagePath":"/dev/termination-log","terminationMessagePolicy":"File","imagePullPolicy":"IfNotPresent"}],"restartPolicy":"Always","terminationGracePeriodSeconds":604800,"dnsPolicy":"ClusterFirst","serviceAccountName":"rabbitmq-cluster-server","serviceAccount":"rabbitmq-cluster-server","automountServiceAccountToken":true,"securityContext":{"runAsUser":999,"runAsGroup":999,"fsGroup":999},"schedulerName":"default-scheduler","topologySpreadConstraints":[{"maxSkew":1,"topologyKey":"topology.kubernetes.io/zone","whenUnsatisfiable":"ScheduleAnyway","labelSelector":{"matchLabels":{"app.kubernetes.io/name":"rabbitmq-cluster"}}}]}},"volumeClaimTemplates":[{"metadata":{"name":"persistence","namespace":"default","creationTimestamp":null,"labels":{"app.kubernetes.io/component":"rabbitmq","app.kubernetes.io/name":"rabbitmq-cluster","app.kubernetes.io/part-of":"rabbitmq"},"ownerReferences":[{"apiVersion":"rabbitmq.com/v1beta1","kind":"RabbitmqCluster","name":"rabbitmq-cluster","uid":"3ecefa8a-1bec-48a7-9af4-dd0df3339101","controller":true,"blockOwnerDeletion":false}]},"spec":{"accessModes":["ReadWriteOnce"],"resources":{"requests":{"storage":"10Gi"}},"volumeMode":"Filesystem"},"status":{"phase":"Pending"}}],"serviceName":"rabbitmq-cluster-nodes","podManagementPolicy":"Parallel","updateStrategy":{"type":"RollingUpdate","rollingUpdate":{"partition":0}},"revisionHistoryLimit":10},"status":{"observedGeneration":1,"replicas":1,"currentReplicas":1,"updatedReplicas":1,"currentRevision":"rabbitmq-cluster-server-5f8b8665fb","updateRevision":"rabbitmq-cluster-server-5f8b8665fb","collisionCount":0}}
2022/03/18 18:06:25 learn_server.go:253: [SIEVE-AFTER-RECONCILE]	github.com/rabbitmq/cluster-operator/controllers.(*RabbitmqClusterReconciler)	2
2022/03/18 18:06:40 learn_server.go:238: [SIEVE-BEFORE-RECONCILE]	github.com/rabbitmq/cluster-operator/controllers.(*RabbitmqClusterReconciler)	3
2022/03/18 18:06:40 learn_server.go:291: [SIEVE-AFTER-READ]	Get	true	rabbitmqcluster	default	rabbitmq-cluster	github.com/rabbitmq/cluster-operator/controllers.(*RabbitmqClusterReconciler)	NoError	{"kind":"RabbitmqCluster","apiVersion":"rabbitmq.com/v1beta1","metadata":{"name":"rabbitmq-cluster","namespace":"default","selfLink":"/apis/rabbitmq.com/v1beta1/namespaces/default/rabbitmqclusters/rabbitmq-cluster","uid":"3ecefa8a-1bec-48a7-9af4-dd0df3339101","resourceVersion":"1132","generation":2,"creationTimestamp":"2022-03-18T18:06:25Z","annotations":{"kubectl.kubernetes.io/last-applied-configuration":"{\"apiVersion\":\"rabbitmq.com/v1beta1\",\"kind\":\"RabbitmqCluster\",\"metadata\":{\"annotations\":{},\"name\":\"rabbitmq-cluster\",\"namespace\":\"default\"},\"spec\":{\"persistence\":{\"storage\":\"10Gi\"},\"replicas\":1}}\n"},"finalizers":["deletion.finalizers.rabbitmqclusters.rabbitmq.com"],"managedFields":[{"manager":"kubectl-client-side-apply","operation":"Update","apiVersion":"rabbitmq.com/v1beta1","time":"2022-03-18T18:06:25Z","fieldsType":"FieldsV1","fieldsV1":{"f:metadata":{"f:annotations":{".":{},"f:kubectl.kubernetes.io/last-applied-configuration":{}}},"f:spec":{".":{},"f:image":{},"f:persistence":{".":{},"f:storage":{}},"f:replicas":{},"f:resources":{".":{},"f:limits":{".":{},"f:memory":{}},"f:requests":{".":{},"f:memory":{}}},"f:service":{".":{},"f:type":{}},"f:terminationGracePeriodSeconds":{}}}},{"manager":"manager","operation":"Update","apiVersion":"rabbitmq.com/v1beta1","time":"2022-03-18T18:06:25Z","fieldsType":"FieldsV1","fieldsV1":{"f:metadata":{"f:finalizers":{}},"f:spec":{"f:override":{},"f:rabbitmq":{},"f:resources":{"f:limits":{"f:cpu":{}},"f:requests":{"f:cpu":{}}},"f:tls":{}},"f:status":{".":{},"f:conditions":{},"f:defaultUser":{".":{},"f:secretReference":{".":{},"f:keys":{".":{},"f:password":{},"f:username":{}},"f:name":{},"f:namespace":{}},"f:serviceReference":{".":{},"f:name":{},"f:namespace":{}}}}}}]},"spec":{"replicas":1,"image":"rabbitmq:3.8.12-management","service":{"type":"ClusterIP"},"persistence":{"storage":"10Gi"},"resources":{"limits":{"cpu":"2","memory":"2Gi"},"requests":{"cpu":"1","memory":"2Gi"}},"rabbitmq":{},"tls":{},"override":{},"terminationGracePeriodSeconds":604800},"status":{"conditions":[{"type":"AllReplicasReady","status":"False","lastTransitionTime":"2022-03-18T18:06:25Z","reason":"NotAllPodsReady","message":"0/1 Pods ready"},{"type":"ClusterAvailable","status":"False","lastTransitionTime":"2022-03-18T18:06:25Z","reason":"NoEndpointsAvailable","message":"The service has no endpoints available"},{"type":"NoWarnings","status":"True","lastTransitionTime":"2022-03-18T18:06:25Z","reason":"NoWarnings"},{"type":"ReconcileSuccess","status":"Unknown","lastTransitionTime":"2022-03-18T18:06:25Z","reason":"Initialising"}],"defaultUser":{"secretReference":{"name":"rabbitmq-cluster-default-user","namespace":"default","keys":{"password":"password","username":"username"}},"serviceReference":{"name":"rabbitmq-cluster","namespace":"default"}}}}
2022/03/18 18:06:40 learn_server.go:291: [SIEVE-AFTER-READ]	Get	true	statefulset	default	rabbitmq-cluster-server	github.com/rabbitmq/cluster-operator/controllers.(*RabbitmqClusterReconciler)	NoError	{"kind":"StatefulSet","apiVersion":"apps/v1","metadata":{"name":"rabbitmq-cluster-server","namespace":"default","selfLink":"/apis/apps/v1/namespaces/default/statefulsets/rabbitmq-cluster-server","uid":"f2f07f3e-b500-4c48-a5de-8db7eaf37b9a","resourceVersion":"1129","generation":1,"creationTimestamp":"2022-03-18T18:06:25Z","labels":{"app.kubernetes.io/component":"rabbitmq","app.kubernetes.io/name":"rabbitmq-cluster","app.kubernetes.io/part-of":"rabbitmq"},"annotations":{"rabbitmq.com/createdAt":"2022-03-18T18:06:25Z"},"ownerReferences":[{"apiVersion":"rabbitmq.com/v1beta1","kind":"RabbitmqCluster","name":"rabbitmq-cluster","uid":"3ecefa8a-1bec-48a7-9af4-dd0df3339101","controller":true,"blockOwnerDeletion":true}],"managedFields":[{"manager":"kube-controller-manager","operation":"Update","apiVersion":"apps/v1","time":"2022-03-18T18:06:25Z","fieldsType":"FieldsV1","fieldsV1":{"f:status":{"f:collisionCount":{},"f:currentReplicas":{},"f:currentRevision":{},"f:observedGeneration":{},"f:replicas":{},"f:updateRevision":{},"f:updatedReplicas":{}}}},{"manager":"manager","operation":"Update","apiVersion":"apps/v1","time":"2022-03-18T18:06:25Z","fieldsType":"FieldsV1","fieldsV1":{"f:metadata":{"f:annotations":{".":{},"f:rabbitmq.com/createdAt":{}},"f:labels":{".":{},"f:app.kubernetes.io/component":{},"f:app.kubernetes.io/name":{},"f:app.kubernetes.io/part-of":{}},"f:ownerReferences":{".":{},"k:{\"uid\":\"3ecefa8a-1bec-48a7-9af4-dd0df3339101\"}":{".":{},"f:apiVersion":{},"f:blockOwnerDeletion":{},"f:controller":{},"f:kind":{},"f:name":{},"f:uid":{}}}},"f:spec":{"f:podManagementPolicy":{},"f:replicas":{},"f:revisionHistoryLimit":{},"f:selector":{"f:matchLabels":{".":{},"f:app.kubernetes.io/name":{}}},"f:serviceName":{},"f:template":{"f:metadata":{"f:annotations":{".":{},"f:prometheus.io/port":{},"f:prometheus.io/scrape":{}},"f:labels":{".":{},"f:app.kubernetes.io/component":{},"f:app.kubernetes.io/name":{},"f:app.kubernetes.io/part-of":{}}},"f:spec":{"f:automountServiceAccountToken":{},"f:containers":{"k:{\"name\":\"rabbitmq\"}":{".":{},"f:env":{".":{},"k:{\"name\":\"K8S_HOSTNAME_SUFFIX\"}":{".":{},"f:name":{},"f:value":{}},"k:{\"name\":\"K8S_SERVICE_NAME\"}":{".":{},"f:name":{},"f:value":{}},"k:{\"name\":\"MY_POD_NAME\"}":{".":{},"f:name":{},"f:valueFrom":{".":{},"f:fieldRef":{".":{},"f:apiVersion":{},"f:fieldPath":{}}}},"k:{\"name\":\"MY_POD_NAMESPACE\"}":{".":{},"f:name":{},"f:valueFrom":{".":{},"f:fieldRef":{".":{},"f:apiVersion":{},"f:fieldPath":{}}}},"k:{\"name\":\"RABBITMQ_ENABLED_PLUGINS_FILE\"}":{".":{},"f:name":{},"f:value":{}},"k:{\"name\":\"RABBITMQ_NODENAME\"}":{".":{},"f:name":{},"f:value":{}},"k:{\"name\":\"RABBITMQ_USE_LONGNAME\"}":{".":{},"f:name":{},"f:value":{}}},"f:image":{},"f:imagePullPolicy":{},"f:lifecycle":{".":{},"f:preStop":{".":{},"f:exec":{".":{},"f:command":{}}}},"f:name":{},"f:ports":{".":{},"k:{\"containerPort\":4369,\"protocol\":\"TCP\"}":{".":{},"f:containerPort":{},"f:name":{},"f:protocol":{}},"k:{\"containerPort\":5672,\"protocol\":\"TCP\"}":{".":{},"f:containerPort":{},"f:name":{},"f:protocol":{}},"k:{\"containerPort\":15672,\"protocol\":\"TCP\"}":{".":{},"f:containerPort":{},"f:name":{},"f:protocol":{}},"k:{\"containerPort\":15692,\"protocol\":\"TCP\"}":{".":{},"f:containerPort":{},"f:name":{},"f:protocol":{}}},"f:readinessProbe":{".":{},"f:failureThreshold":{},"f:initialDelaySeconds":{},"f:periodSeconds":{},"f:successThreshold":{},"f:tcpSocket":{".":{},"f:port":{}},"f:timeoutSeconds":{}},"f:resources":{".":{},"f:limits":{".":{},"f:cpu":{},"f:memory":{}},"f:requests":{".":{},"f:cpu":{},"f:memory":{}}},"f:terminationMessagePath":{},"f:terminationMessagePolicy":{},"f:volumeMounts":{".":{},"k:{\"mountPath\":\"/etc/pod-info/\"}":{".":{},"f:mountPath":{},"f:name":{}},"k:{\"mountPath\":\"/etc/rabbitmq/conf.d/10-operatorDefaults.conf\"}":{".":{},"f:mountPath":{},"f:name":{},"f:subPath":{}},"k:{\"mountPath\":\"/etc/rabbitmq/conf.d/11-default_user.conf\"}":{".":{},"f:mountPath":{},"f:name":{},"f:subPath":{}},"k:{\"mountPath\":\"/etc/rabbitmq/conf.d/90-userDefinedConfiguration.conf\"}":{".":{},"f:mountPath":{},"f:name":{},"f:subPath":{}},"k:{\"mountPath\":\"/operator\"}":{".":{},"f:mountPath":{},"f:name":{}},"k:{\"mountPath\":\"/var/lib/rabbitmq/\"}":{".":{},"f:mountPath":{},"f:name":{}},"k:{\"mountPath\":\"/var/lib/rabbitmq/mnesia/\"}":{".":{},"f:mountPath":{},"f:name":{}}}}},"f:dnsPolicy":{},"f:initContainers":{".":{},"k:{\"name\":\"setup-container\"}":{".":{},"f:command":{},"f:image":{},"f:imagePullPolicy":{},"f:name":{},"f:resources":{".":{},"f:limits":{".":{},"f:cpu":{},"f:memory":{}},"f:requests":{".":{},"f:cpu":{},"f:memory":{}}},"f:securityContext":{".":{},"f:capabilities":{".":{},"f:drop":{}},"f:runAsUser":{}},"f:terminationMessagePath":{},"f:terminationMessagePolicy":{},"f:volumeMounts":{".":{},"k:{\"mountPath\":\"/operator\"}":{".":{},"f:mountPath":{},"f:name":{}},"k:{\"mountPath\":\"/tmp/default_user.conf\"}":{".":{},"f:mountPath":{},"f:name":{},"f:subPath":{}},"k:{\"mountPath\":\"/tmp/erlang-cookie-secret/\"}":{".":{},"f:mountPath":{},"f:name":{}},"k:{\"mountPath\":\"/tmp/rabbitmq-plugins/\"}":{".":{},"f:mountPath":{},"f:name":{}},"k:{\"mountPath\":\"/var/lib/rabbitmq/\"}":{".":{},"f:mountPath":{},"f:name":{}},"k:{\"mountPath\":\"/var/lib/rabbitmq/mnesia/\"}":{".":{},"f:mountPath":{},"f:name":{}}}}},"f:restartPolicy":{},"f:schedulerName":{},"f:securityContext":{".":{},"f:fsGroup":{},"f:runAsGroup":{},"f:runAsUser":{}},"f:serviceAccount":{},"f:serviceAccountName":{},"f:terminationGracePeriodSeconds":{},"f:topologySpreadConstraints":{".":{},"k:{\"topologyKey\":\"topology.kubernetes.io/zone\",\"whenUnsatisfiable\":\"ScheduleAnyway\"}":{".":{},"f:labelSelector":{".":{},"f:matchLabels":{".":{},"f:app.kubernetes.io/name":{}}},"f:maxSkew":{},"f:topologyKey":{},"f:whenUnsatisfiable":{}}},"f:volumes":{".":{},"k:{\"name\":\"erlang-cookie-secret\"}":{".":{},"f:name":{},"f:secret":{".":{},"f:defaultMode":{},"f:secretName":{}}},"k:{\"name\":\"plugins-conf\"}":{".":{},"f:configMap":{".":{},"f:defaultMode":{},"f:name":{}},"f:name":{}},"k:{\"name\":\"pod-info\"}":{".":{},"f:downwardAPI":{".":{},"f:defaultMode":{},"f:items":{}},"f:name":{}},"k:{\"name\":\"rabbitmq-confd\"}":{".":{},"f:name":{},"f:projected":{".":{},"f:defaultMode":{},"f:sources":{}}},"k:{\"name\":\"rabbitmq-erlang-cookie\"}":{".":{},"f:emptyDir":{},"f:name":{}},"k:{\"name\":\"rabbitmq-plugins\"}":{".":{},"f:emptyDir":{},"f:name":{}}}}},"f:updateStrategy":{"f:rollingUpdate":{".":{},"f:partition":{}},"f:type":{}},"f:volumeClaimTemplates":{}}}}]},"spec":{"replicas":1,"selector":{"matchLabels":{"app.kubernetes.io/name":"rabbitmq-cluster"}},"template":{"metadata":{"creationTimestamp":null,"labels":{"app.kubernetes.io/component":"rabbitmq","app.kubernetes.io/name":"rabbitmq-cluster","app.kubernetes.io/part-of":"rabbitmq"},"annotations":{"prometheus.io/port":"15692","prometheus.io/scrape":"true"}},"spec":{"volumes":[{"name":"plugins-conf","configMap":{"name":"rabbitmq-cluster-plugins-conf","defaultMode":420}},{"name":"rabbitmq-confd","projected":{"sources":[{"secret":{"name":"rabbitmq-cluster-default-user","items":[{"key":"default_user.conf","path":"default_user.conf"}]}},{"configMap":{"name":"rabbitmq-cluster-server-conf","items":[{"key":"operatorDefaults.conf","path":"operatorDefaults.conf"},{"key":"userDefinedConfiguration.conf","path":"userDefinedConfiguration.conf"}]}}],"defaultMode":420}},{"name":"rabbitmq-erlang-cookie","emptyDir":{}},{"name":"erlang-cookie-secret","secret":{"secretName":"rabbitmq-cluster-erlang-cookie","defaultMode":420}},{"name":"rabbitmq-plugins","emptyDir":{}},{"name":"pod-info","downwardAPI":{"items":[{"path":"skipPreStopChecks","fieldRef":{"apiVersion":"v1","fieldPath":"metadata.labels['skipPreStopChecks']"}}],"defaultMode":420}}],"initContainers":[{"name":"setup-container","image":"rabbitmq:3.8.12-management","command":["sh","-c","cp /tmp/erlang-cookie-secret/.erlang.cookie /var/lib/rabbitmq/.erlang.cookie \u0026\u0026 chown 999:999 /var/lib/rabbitmq/.erlang.cookie \u0026\u0026 chmod 600 /var/lib/rabbitmq/.erlang.cookie ; cp /tmp/rabbitmq-plugins/enabled_plugins /operator/enabled_plugins \u0026\u0026 chown 999:999 /operator/enabled_plugins ; chown 999:999 /var/lib/rabbitmq/mnesia/ ; echo '[default]' \u003e /var/lib/rabbitmq/.rabbitmqadmin.conf \u0026\u0026 sed -e 's/default_user/username/' -e 's/default_pass/password/' /tmp/default_user.conf \u003e\u003e /var/lib/rabbitmq/.rabbitmqadmin.conf \u0026\u0026 chown 999:999 /var/lib/rabbitmq/.rabbitmqadmin.conf \u0026\u0026 chmod 600 /var/lib/rabbitmq/.rabbitmqadmin.conf"],"resources":{"limits":{"cpu":"100m","memory":"500Mi"},"requests":{"cpu":"100m","memory":"500Mi"}},"volumeMounts":[{"name":"plugins-conf","mountPath":"/tmp/rabbitmq-plugins/"},{"name":"rabbitmq-erlang-cookie","mountPath":"/var/lib/rabbitmq/"},{"name":"erlang-cookie-secret","mountPath":"/tmp/erlang-cookie-secret/"},{"name":"rabbitmq-plugins","mountPath":"/operator"},{"name":"persistence","mountPath":"/var/lib/rabbitmq/mnesia/"},{"name":"rabbitmq-confd","mountPath":"/tmp/default_user.conf","subPath":"default_user.conf"}],"terminationMessagePath":"/dev/termination-log","terminationMessagePolicy":"File","imagePullPolicy":"IfNotPresent","securityContext":{"capabilities":{"drop":["FSETID","KILL","SETGID","SETUID","SETPCAP","NET_BIND_SERVICE","NET_RAW","SYS_CHROOT","MKNOD","AUDIT_WRITE","SETFCAP"]},"runAsUser":0}}],"containers":[{"name":"rabbitmq","image":"rabbitmq:3.8.12-management","ports":[{"name":"epmd","containerPort":4369,"protocol":"TCP"},{"name":"amqp","containerPort":5672,"protocol":"TCP"},{"name":"management","containerPort":15672,"protocol":"TCP"},{"name":"prometheus","containerPort":15692,"protocol":"TCP"}],"env":[{"name":"MY_POD_NAME","valueFrom":{"fieldRef":{"apiVersion":"v1","fieldPath":"metadata.name"}}},{"name":"MY_POD_NAMESPACE","valueFrom":{"fieldRef":{"apiVersion":"v1","fieldPath":"metadata.namespace"}}},{"name":"RABBITMQ_ENABLED_PLUGINS_FILE","value":"/operator/enabled_plugins"},{"name":"K8S_SERVICE_NAME","value":"rabbitmq-cluster-nodes"},{"name":"RABBITMQ_USE_LONGNAME","value":"true"},{"name":"RABBITMQ_NODENAME","value":"rabbit@$(MY_POD_NAME).$(K8S_SERVICE_NAME).$(MY_POD_NAMESPACE)"},{"name":"K8S_HOSTNAME_SUFFIX","value":".$(K8S_SERVICE_NAME).$(MY_POD_NAMESPACE)"}],"resources":{"limits":{"cpu":"2","memory":"2Gi"},"requests":{"cpu":"1","memory":"2Gi"}},"volumeMounts":[{"name":"rabbitmq-erlang-cookie","mountPath":"/var/lib/rabbitmq/"},{"name":"persistence","mountPath":"/var/lib/rabbitmq/mnesia/"},{"name":"rabbitmq-plugins","mountPath":"/operator"},{"name":"rabbitmq-confd","mountPath":"/etc/rabbitmq/conf.d/10-operatorDefaults.conf","subPath":"operatorDefaults.conf"},{"name":"rabbitmq-confd","mountPath":"/etc/rabbitmq/conf.d/11-default_user.conf","subPath":"default_user.conf"},{"name":"rabbitmq-confd","mountPath":"/etc/rabbitmq/conf.d/90-userDefinedConfiguration.conf","subPath":"userDefinedConfiguration.conf"},{"name":"pod-info","mountPath":"/etc/pod-info/"}],"readinessProbe":{"tcpSocket":{"port":"amqp"},"initialDelaySeconds":10,"timeoutSeconds":5,"periodSeconds":10,"successThreshold":1,"failureThreshold":3},"lifecycle":{"preStop":{"exec":{"command":["/bin/bash","-c","if [ ! -z \"$(cat /etc/pod-info/skipPreStopChecks)\" ]; then exit 0; fi; rabbitmq-upgrade await_online_quorum_plus_one -t 604800; rabbitmq-upgrade await_online_synchronized_mirror -t 604800; rabbitmq-upgrade drain -t 604800"]}}},"terminationMessagePath":"/dev/termination-log","terminationMessagePolicy":"File","imagePullPolicy":"IfNotPresent"}],"restartPolicy":"Always","terminationGracePeriodSeconds":604800,"dnsPolicy":"ClusterFirst","serviceAccountName":"rabbitmq-cluster-server","serviceAccount":"rabbitmq-cluster-server","automountServiceAccountToken":true,"securityContext":{"runAsUser":999,"runAsGroup":999,"fsGroup":999},"schedulerName":"default-scheduler","topologySpreadConstraints":[{"maxSkew":1,"topologyKey":"topology.kubernetes.io/zone","whenUnsatisfiable":"ScheduleAnyway","labelSelector":{"matchLabels":{"app.kubernetes.io/name":"rabbitmq-cluster"}}}]}},"volumeClaimTemplates":[{"metadata":{"name":"persistence","namespace":"default","creationTimestamp":null,"labels":{"app.kubernetes.io/component":"rabbitmq","app.kubernetes.io/name":"rabbitmq-cluster","app.kubernetes.io/part-of":"rabbitmq"},"ownerReferences":[{"apiVersion":"rabbitmq.com/v1beta1","kind":"RabbitmqCluster","name":"rabbitmq-cluster","uid":"3ecefa8a-1bec-48a7-9af4-dd0df3339101","controller":true,"blockOwnerDeletion":false}]},"spec":{"accessModes":["ReadWriteOnce"],"resources":{"requests":{"storage":"10Gi"}},"volumeMode":"Filesystem"},"status":{"phase":"Pending"}}],"serviceName":"rabbitmq-cluster-nodes","podManagementPolicy":"Parallel","updateStrategy":{"type":"RollingUpdate","rollingUpdate":{"partition":0}},"revisionHistoryLimit":10},"status":{"observedGeneration":1,"replicas":1,"currentReplicas":1,"updatedReplicas":1,"currentRevision":"rabbitmq-cluster-server-5f8b8665fb","updateRevision":"rabbitmq-cluster-server-5f8b8665fb","collisionCount":0}}
2022/03/18 18:06:40 learn_server.go:291: [SIEVE-AFTER-READ]	Get	true	endpoints	default	rabbitmq-cluster	github.com/rabbitmq/cluster-operator/controllers.(*RabbitmqClusterReconciler)	NoError	{"kind":"Endpoints","apiVersion":"v1","metadata":{"name":"rabbitmq-cluster","namespace":"default","selfLink":"/api/v1/namespaces/default/endpoints/rabbitmq-cluster","uid":"eeba9576-0362-4e74-aafd-71e4ffe98d25","resourceVersion":"1087","creationTimestamp":"2022-03-18T18:06:25Z","labels":{"app.kubernetes.io/component":"rabbitmq","app.kubernetes.io/name":"rabbitmq-cluster","app.kubernetes.io/part-of":"rabbitmq"},"annotations":{"endpoints.kubernetes.io/last-change-trigger-time":"2022-03-18T18:06:25Z"},"managedFields":[{"manager":"kube-controller-manager","operation":"Update","apiVersion":"v1","time":"2022-03-18T18:06:25Z","fieldsType":"FieldsV1","fieldsV1":{"f:metadata":{"f:annotations":{".":{},"f:endpoints.kubernetes.io/last-change-trigger-time":{}},"f:labels":{".":{},"f:app.kubernetes.io/component":{},"f:app.kubernetes.io/name":{},"f:app.kubernetes.io/part-of":{}}}}}]}}
2022/03/18 18:06:40 learn_server.go:291: [SIEVE-AFTER-READ]	Get	true	statefulset	default	rabbitmq-cluster-server	github.com/rabbitmq/cluster-operator/controllers.(*RabbitmqClusterReconciler)	NoError	{"kind":"StatefulSet","apiVersion":"apps/v1","metadata":{"name":"rabbitmq-cluster-server","namespace":"default","selfLink":"/apis/apps/v1/namespaces/default/statefulsets/rabbitmq-cluster-server","uid":"f2f07f3e-b500-4c48-a5de-8db7eaf37b9a","resourceVersion":"1129","generation":1,"creationTimestamp":"2022-03-18T18:06:25Z","labels":{"app.kubernetes.io/component":"rabbitmq","app.kubernetes.io/name":"rabbitmq-cluster","app.kubernetes.io/part-of":"rabbitmq"},"annotations":{"rabbitmq.com/createdAt":"2022-03-18T18:06:25Z"},"ownerReferences":[{"apiVersion":"rabbitmq.com/v1beta1","kind":"RabbitmqCluster","name":"rabbitmq-cluster","uid":"3ecefa8a-1bec-48a7-9af4-dd0df3339101","controller":true,"blockOwnerDeletion":true}],"managedFields":[{"manager":"kube-controller-manager","operation":"Update","apiVersion":"apps/v1","time":"2022-03-18T18:06:25Z","fieldsType":"FieldsV1","fieldsV1":{"f:status":{"f:collisionCount":{},"f:currentReplicas":{},"f:currentRevision":{},"f:observedGeneration":{},"f:replicas":{},"f:updateRevision":{},"f:updatedReplicas":{}}}},{"manager":"manager","operation":"Update","apiVersion":"apps/v1","time":"2022-03-18T18:06:25Z","fieldsType":"FieldsV1","fieldsV1":{"f:metadata":{"f:annotations":{".":{},"f:rabbitmq.com/createdAt":{}},"f:labels":{".":{},"f:app.kubernetes.io/component":{},"f:app.kubernetes.io/name":{},"f:app.kubernetes.io/part-of":{}},"f:ownerReferences":{".":{},"k:{\"uid\":\"3ecefa8a-1bec-48a7-9af4-dd0df3339101\"}":{".":{},"f:apiVersion":{},"f:blockOwnerDeletion":{},"f:controller":{},"f:kind":{},"f:name":{},"f:uid":{}}}},"f:spec":{"f:podManagementPolicy":{},"f:replicas":{},"f:revisionHistoryLimit":{},"f:selector":{"f:matchLabels":{".":{},"f:app.kubernetes.io/name":{}}},"f:serviceName":{},"f:template":{"f:metadata":{"f:annotations":{".":{},"f:prometheus.io/port":{},"f:prometheus.io/scrape":{}},"f:labels":{".":{},"f:app.kubernetes.io/component":{},"f:app.kubernetes.io/name":{},"f:app.kubernetes.io/part-of":{}}},"f:spec":{"f:automountServiceAccountToken":{},"f:containers":{"k:{\"name\":\"rabbitmq\"}":{".":{},"f:env":{".":{},"k:{\"name\":\"K8S_HOSTNAME_SUFFIX\"}":{".":{},"f:name":{},"f:value":{}},"k:{\"name\":\"K8S_SERVICE_NAME\"}":{".":{},"f:name":{},"f:value":{}},"k:{\"name\":\"MY_POD_NAME\"}":{".":{},"f:name":{},"f:valueFrom":{".":{},"f:fieldRef":{".":{},"f:apiVersion":{},"f:fieldPath":{}}}},"k:{\"name\":\"MY_POD_NAMESPACE\"}":{".":{},"f:name":{},"f:valueFrom":{".":{},"f:fieldRef":{".":{},"f:apiVersion":{},"f:fieldPath":{}}}},"k:{\"name\":\"RABBITMQ_ENABLED_PLUGINS_FILE\"}":{".":{},"f:name":{},"f:value":{}},"k:{\"name\":\"RABBITMQ_NODENAME\"}":{".":{},"f:name":{},"f:value":{}},"k:{\"name\":\"RABBITMQ_USE_LONGNAME\"}":{".":{},"f:name":{},"f:value":{}}},"f:image":{},"f:imagePullPolicy":{},"f:lifecycle":{".":{},"f:preStop":{".":{},"f:exec":{".":{},"f:command":{}}}},"f:name":{},"f:ports":{".":{},"k:{\"containerPort\":4369,\"protocol\":\"TCP\"}":{".":{},"f:containerPort":{},"f:name":{},"f:protocol":{}},"k:{\"containerPort\":5672,\"protocol\":\"TCP\"}":{".":{},"f:containerPort":{},"f:name":{},"f:protocol":{}},"k:{\"containerPort\":15672,\"protocol\":\"TCP\"}":{".":{},"f:containerPort":{},"f:name":{},"f:protocol":{}},"k:{\"containerPort\":15692,\"protocol\":\"TCP\"}":{".":{},"f:containerPort":{},"f:name":{},"f:protocol":{}}},"f:readinessProbe":{".":{},"f:failureThreshold":{},"f:initialDelaySeconds":{},"f:periodSeconds":{},"f:successThreshold":{},"f:tcpSocket":{".":{},"f:port":{}},"f:timeoutSeconds":{}},"f:resources":{".":{},"f:limits":{".":{},"f:cpu":{},"f:memory":{}},"f:requests":{".":{},"f:cpu":{},"f:memory":{}}},"f:terminationMessagePath":{},"f:terminationMessagePolicy":{},"f:volumeMounts":{".":{},"k:{\"mountPath\":\"/etc/pod-info/\"}":{".":{},"f:mountPath":{},"f:name":{}},"k:{\"mountPath\":\"/etc/rabbitmq/conf.d/10-operatorDefaults.conf\"}":{".":{},"f:mountPath":{},"f:name":{},"f:subPath":{}},"k:{\"mountPath\":\"/etc/rabbitmq/conf.d/11-default_user.conf\"}":{".":{},"f:mountPath":{},"f:name":{},"f:subPath":{}},"k:{\"mountPath\":\"/etc/rabbitmq/conf.d/90-userDefinedConfiguration.conf\"}":{".":{},"f:mountPath":{},"f:name":{},"f:subPath":{}},"k:{\"mountPath\":\"/operator\"}":{".":{},"f:mountPath":{},"f:name":{}},"k:{\"mountPath\":\"/var/lib/rabbitmq/\"}":{".":{},"f:mountPath":{},"f:name":{}},"k:{\"mountPath\":\"/var/lib/rabbitmq/mnesia/\"}":{".":{},"f:mountPath":{},"f:name":{}}}}},"f:dnsPolicy":{},"f:initContainers":{".":{},"k:{\"name\":\"setup-container\"}":{".":{},"f:command":{},"f:image":{},"f:imagePullPolicy":{},"f:name":{},"f:resources":{".":{},"f:limits":{".":{},"f:cpu":{},"f:memory":{}},"f:requests":{".":{},"f:cpu":{},"f:memory":{}}},"f:securityContext":{".":{},"f:capabilities":{".":{},"f:drop":{}},"f:runAsUser":{}},"f:terminationMessagePath":{},"f:terminationMessagePolicy":{},"f:volumeMounts":{".":{},"k:{\"mountPath\":\"/operator\"}":{".":{},"f:mountPath":{},"f:name":{}},"k:{\"mountPath\":\"/tmp/default_user.conf\"}":{".":{},"f:mountPath":{},"f:name":{},"f:subPath":{}},"k:{\"mountPath\":\"/tmp/erlang-cookie-secret/\"}":{".":{},"f:mountPath":{},"f:name":{}},"k:{\"mountPath\":\"/tmp/rabbitmq-plugins/\"}":{".":{},"f:mountPath":{},"f:name":{}},"k:{\"mountPath\":\"/var/lib/rabbitmq/\"}":{".":{},"f:mountPath":{},"f:name":{}},"k:{\"mountPath\":\"/var/lib/rabbitmq/mnesia/\"}":{".":{},"f:mountPath":{},"f:name":{}}}}},"f:restartPolicy":{},"f:schedulerName":{},"f:securityContext":{".":{},"f:fsGroup":{},"f:runAsGroup":{},"f:runAsUser":{}},"f:serviceAccount":{},"f:serviceAccountName":{},"f:terminationGracePeriodSeconds":{},"f:topologySpreadConstraints":{".":{},"k:{\"topologyKey\":\"topology.kubernetes.io/zone\",\"whenUnsatisfiable\":\"ScheduleAnyway\"}":{".":{},"f:labelSelector":{".":{},"f:matchLabels":{".":{},"f:app.kubernetes.io/name":{}}},"f:maxSkew":{},"f:topologyKey":{},"f:whenUnsatisfiable":{}}},"f:volumes":{".":{},"k:{\"name\":\"erlang-cookie-secret\"}":{".":{},"f:name":{},"f:secret":{".":{},"f:defaultMode":{},"f:secretName":{}}},"k:{\"name\":\"plugins-conf\"}":{".":{},"f:configMap":{".":{},"f:defaultMode":{},"f:name":{}},"f:name":{}},"k:{\"name\":\"pod-info\"}":{".":{},"f:downwardAPI":{".":{},"f:defaultMode":{},"f:items":{}},"f:name":{}},"k:{\"name\":\"rabbitmq-confd\"}":{".":{},"f:name":{},"f:projected":{".":{},"f:defaultMode":{},"f:sources":{}}},"k:{\"name\":\"rabbitmq-erlang-cookie\"}":{".":{},"f:emptyDir":{},"f:name":{}},"k:{\"name\":\"rabbitmq-plugins\"}":{".":{},"f:emptyDir":{},"f:name":{}}}}},"f:updateStrategy":{"f:rollingUpdate":{".":{},"f:partition":{}},"f:type":{}},"f:volumeClaimTemplates":{}}}}]},"spec":{"replicas":1,"selector":{"matchLabels":{"app.kubernetes.io/name":"rabbitmq-cluster"}},"template":{"metadata":{"creationTimestamp":null,"labels":{"app.kubernetes.io/component":"rabbitmq","app.kubernetes.io/name":"rabbitmq-cluster","app.kubernetes.io/part-of":"rabbitmq"},"annotations":{"prometheus.io/port":"15692","prometheus.io/scrape":"true"}},"spec":{"volumes":[{"name":"plugins-conf","configMap":{"name":"rabbitmq-cluster-plugins-conf","defaultMode":420}},{"name":"rabbitmq-confd","projected":{"sources":[{"secret":{"name":"rabbitmq-cluster-default-user","items":[{"key":"default_user.conf","path":"default_user.conf"}]}},{"configMap":{"name":"rabbitmq-cluster-server-conf","items":[{"key":"operatorDefaults.conf","path":"operatorDefaults.conf"},{"key":"userDefinedConfiguration.conf","path":"userDefinedConfiguration.conf"}]}}],"defaultMode":420}},{"name":"rabbitmq-erlang-cookie","emptyDir":{}},{"name":"erlang-cookie-secret","secret":{"secretName":"rabbitmq-cluster-erlang-cookie","defaultMode":420}},{"name":"rabbitmq-plugins","emptyDir":{}},{"name":"pod-info","downwardAPI":{"items":[{"path":"skipPreStopChecks","fieldRef":{"apiVersion":"v1","fieldPath":"metadata.labels['skipPreStopChecks']"}}],"defaultMode":420}}],"initContainers":[{"name":"setup-container","image":"rabbitmq:3.8.12-management","command":["sh","-c","cp /tmp/erlang-cookie-secret/.erlang.cookie /var/lib/rabbitmq/.erlang.cookie \u0026\u0026 chown 999:999 /var/lib/rabbitmq/.erlang.cookie \u0026\u0026 chmod 600 /var/lib/rabbitmq/.erlang.cookie ; cp /tmp/rabbitmq-plugins/enabled_plugins /operator/enabled_plugins \u0026\u0026 chown 999:999 /operator/enabled_plugins ; chown 999:999 /var/lib/rabbitmq/mnesia/ ; echo '[default]' \u003e /var/lib/rabbitmq/.rabbitmqadmin.conf \u0026\u0026 sed -e 's/default_user/username/' -e 's/default_pass/password/' /tmp/default_user.conf \u003e\u003e /var/lib/rabbitmq/.rabbitmqadmin.conf \u0026\u0026 chown 999:999 /var/lib/rabbitmq/.rabbitmqadmin.conf \u0026\u0026 chmod 600 /var/lib/rabbitmq/.rabbitmqadmin.conf"],"resources":{"limits":{"cpu":"100m","memory":"500Mi"},"requests":{"cpu":"100m","memory":"500Mi"}},"volumeMounts":[{"name":"plugins-conf","mountPath":"/tmp/rabbitmq-plugins/"},{"name":"rabbitmq-erlang-cookie","mountPath":"/var/lib/rabbitmq/"},{"name":"erlang-cookie-secret","mountPath":"/tmp/erlang-cookie-secret/"},{"name":"rabbitmq-plugins","mountPath":"/operator"},{"name":"persistence","mountPath":"/var/lib/rabbitmq/mnesia/"},{"name":"rabbitmq-confd","mountPath":"/tmp/default_user.conf","subPath":"default_user.conf"}],"terminationMessagePath":"/dev/termination-log","terminationMessagePolicy":"File","imagePullPolicy":"IfNotPresent","securityContext":{"capabilities":{"drop":["FSETID","KILL","SETGID","SETUID","SETPCAP","NET_BIND_SERVICE","NET_RAW","SYS_CHROOT","MKNOD","AUDIT_WRITE","SETFCAP"]},"runAsUser":0}}],"containers":[{"name":"rabbitmq","image":"rabbitmq:3.8.12-management","ports":[{"name":"epmd","containerPort":4369,"protocol":"TCP"},{"name":"amqp","containerPort":5672,"protocol":"TCP"},{"name":"management","containerPort":15672,"protocol":"TCP"},{"name":"prometheus","containerPort":15692,"protocol":"TCP"}],"env":[{"name":"MY_POD_NAME","valueFrom":{"fieldRef":{"apiVersion":"v1","fieldPath":"metadata.name"}}},{"name":"MY_POD_NAMESPACE","valueFrom":{"fieldRef":{"apiVersion":"v1","fieldPath":"metadata.namespace"}}},{"name":"RABBITMQ_ENABLED_PLUGINS_FILE","value":"/operator/enabled_plugins"},{"name":"K8S_SERVICE_NAME","value":"rabbitmq-cluster-nodes"},{"name":"RABBITMQ_USE_LONGNAME","value":"true"},{"name":"RABBITMQ_NODENAME","value":"rabbit@$(MY_POD_NAME).$(K8S_SERVICE_NAME).$(MY_POD_NAMESPACE)"},{"name":"K8S_HOSTNAME_SUFFIX","value":".$(K8S_SERVICE_NAME).$(MY_POD_NAMESPACE)"}],"resources":{"limits":{"cpu":"2","memory":"2Gi"},"requests":{"cpu":"1","memory":"2Gi"}},"volumeMounts":[{"name":"rabbitmq-erlang-cookie","mountPath":"/var/lib/rabbitmq/"},{"name":"persistence","mountPath":"/var/lib/rabbitmq/mnesia/"},{"name":"rabbitmq-plugins","mountPath":"/operator"},{"name":"rabbitmq-confd","mountPath":"/etc/rabbitmq/conf.d/10-operatorDefaults.conf","subPath":"operatorDefaults.conf"},{"name":"rabbitmq-confd","mountPath":"/etc/rabbitmq/conf.d/11-default_user.conf","subPath":"default_user.conf"},{"name":"rabbitmq-confd","mountPath":"/etc/rabbitmq/conf.d/90-userDefinedConfiguration.conf","subPath":"userDefinedConfiguration.conf"},{"name":"pod-info","mountPath":"/etc/pod-info/"}],"readinessProbe":{"tcpSocket":{"port":"amqp"},"initialDelaySeconds":10,"timeoutSeconds":5,"periodSeconds":10,"successThreshold":1,"failureThreshold":3},"lifecycle":{"preStop":{"exec":{"command":["/bin/bash","-c","if [ ! -z \"$(cat /etc/pod-info/skipPreStopChecks)\" ]; then exit 0; fi; rabbitmq-upgrade await_online_quorum_plus_one -t 604800; rabbitmq-upgrade await_online_synchronized_mirror -t 604800; rabbitmq-upgrade drain -t 604800"]}}},"terminationMessagePath":"/dev/termination-log","terminationMessagePolicy":"File","imagePullPolicy":"IfNotPresent"}],"restartPolicy":"Always","terminationGracePeriodSeconds":604800,"dnsPolicy":"ClusterFirst","serviceAccountName":"rabbitmq-cluster-server","serviceAccount":"rabbitmq-cluster-server","automountServiceAccountToken":true,"securityContext":{"runAsUser":999,"runAsGroup":999,"fsGroup":999},"schedulerName":"default-scheduler","topologySpreadConstraints":[{"maxSkew":1,"topologyKey":"topology.kubernetes.io/zone","whenUnsatisfiable":"ScheduleAnyway","labelSelector":{"matchLabels":{"app.kubernetes.io/name":"rabbitmq-cluster"}}}]}},"volumeClaimTemplates":[{"metadata":{"name":"persistence","namespace":"default","creationTimestamp":null,"labels":{"app.kubernetes.io/component":"rabbitmq","app.kubernetes.io/name":"rabbitmq-cluster","app.kubernetes.io/part-of":"rabbitmq"},"ownerReferences":[{"apiVersion":"rabbitmq.com/v1beta1","kind":"RabbitmqCluster","name":"rabbitmq-cluster","uid":"3ecefa8a-1bec-48a7-9af4-dd0df3339101","controller":true,"blockOwnerDeletion":false}]},"spec":{"accessModes":["ReadWriteOnce"],"resources":{"requests":{"storage":"10Gi"}},"volumeMode":"Filesystem"},"status":{"phase":"Pending"}}],"serviceName":"rabbitmq-cluster-nodes","podManagementPolicy":"Parallel","updateStrategy":{"type":"RollingUpdate","rollingUpdate":{"partition":0}},"revisionHistoryLimit":10},"status":{"observedGeneration":1,"replicas":1,"currentReplicas":1,"updatedReplicas":1,"currentRevision":"rabbitmq-cluster-server-5f8b8665fb","updateRevision":"rabbitmq-cluster-server-5f8b8665fb","collisionCount":0}}
2022/03/18 18:06:40 learn_server.go:291: [SIEVE-AFTER-READ]	Get	true	service	default	rabbitmq-cluster-nodes	github.com/rabbitmq/cluster-operator/controllers.(*RabbitmqClusterReconciler)	NoError	{"kind":"Service","apiVersion":"v1","metadata":{"name":"rabbitmq-cluster-nodes","namespace":"default","selfLink":"/api/v1/namespaces/default/services/rabbitmq-cluster-nodes","uid":"f843e1c2-ced0-463d-87c1-0e127aaa2006","resourceVersion":"1080","creationTimestamp":"2022-03-18T18:06:25Z","labels":{"app.kubernetes.io/component":"rabbitmq","app.kubernetes.io/name":"rabbitmq-cluster","app.kubernetes.io/part-of":"rabbitmq"},"ownerReferences":[{"apiVersion":"rabbitmq.com/v1beta1","kind":"RabbitmqCluster","name":"rabbitmq-cluster","uid":"3ecefa8a-1bec-48a7-9af4-dd0df3339101","controller":true,"blockOwnerDeletion":true}],"managedFields":[{"manager":"manager","operation":"Update","apiVersion":"v1","time":"2022-03-18T18:06:25Z","fieldsType":"FieldsV1","fieldsV1":{"f:metadata":{"f:labels":{".":{},"f:app.kubernetes.io/component":{},"f:app.kubernetes.io/name":{},"f:app.kubernetes.io/part-of":{}},"f:ownerReferences":{".":{},"k:{\"uid\":\"3ecefa8a-1bec-48a7-9af4-dd0df3339101\"}":{".":{},"f:apiVersion":{},"f:blockOwnerDeletion":{},"f:controller":{},"f:kind":{},"f:name":{},"f:uid":{}}}},"f:spec":{"f:clusterIP":{},"f:ports":{".":{},"k:{\"port\":4369,\"protocol\":\"TCP\"}":{".":{},"f:name":{},"f:port":{},"f:protocol":{},"f:targetPort":{}},"k:{\"port\":25672,\"protocol\":\"TCP\"}":{".":{},"f:name":{},"f:port":{},"f:protocol":{},"f:targetPort":{}}},"f:publishNotReadyAddresses":{},"f:selector":{".":{},"f:app.kubernetes.io/name":{}},"f:sessionAffinity":{},"f:type":{}}}}]},"spec":{"ports":[{"name":"epmd","protocol":"TCP","port":4369,"targetPort":4369},{"name":"cluster-rpc","protocol":"TCP","port":25672,"targetPort":25672}],"selector":{"app.kubernetes.io/name":"rabbitmq-cluster"},"clusterIP":"None","type":"ClusterIP","sessionAffinity":"None","publishNotReadyAddresses":true},"status":{"loadBalancer":{}}}
2022/03/18 18:06:40 learn_server.go:291: [SIEVE-AFTER-READ]	Get	true	service	default	rabbitmq-cluster	github.com/rabbitmq/cluster-operator/controllers.(*RabbitmqClusterReconciler)	NoError	{"kind":"Service","apiVersion":"v1","metadata":{"name":"rabbitmq-cluster","namespace":"default","selfLink":"/api/v1/namespaces/default/services/rabbitmq-cluster","uid":"ae846a70-784e-49ca-99a0-2b0cefb93b46","resourceVersion":"1085","creationTimestamp":"2022-03-18T18:06:25Z","labels":{"app.kubernetes.io/component":"rabbitmq","app.kubernetes.io/name":"rabbitmq-cluster","app.kubernetes.io/part-of":"rabbitmq"},"ownerReferences":[{"apiVersion":"rabbitmq.com/v1beta1","kind":"RabbitmqCluster","name":"rabbitmq-cluster","uid":"3ecefa8a-1bec-48a7-9af4-dd0df3339101","controller":true,"blockOwnerDeletion":true}],"managedFields":[{"manager":"manager","operation":"Update","apiVersion":"v1","time":"2022-03-18T18:06:25Z","fieldsType":"FieldsV1","fieldsV1":{"f:metadata":{"f:labels":{".":{},"f:app.kubernetes.io/component":{},"f:app.kubernetes.io/name":{},"f:app.kubernetes.io/part-of":{}},"f:ownerReferences":{".":{},"k:{\"uid\":\"3ecefa8a-1bec-48a7-9af4-dd0df3339101\"}":{".":{},"f:apiVersion":{},"f:blockOwnerDeletion":{},"f:controller":{},"f:kind":{},"f:name":{},"f:uid":{}}}},"f:spec":{"f:ports":{".":{},"k:{\"port\":5672,\"protocol\":\"TCP\"}":{".":{},"f:name":{},"f:port":{},"f:protocol":{},"f:targetPort":{}},"k:{\"port\":15672,\"protocol\":\"TCP\"}":{".":{},"f:name":{},"f:port":{},"f:protocol":{},"f:targetPort":{}}},"f:selector":{".":{},"f:app.kubernetes.io/name":{}},"f:sessionAffinity":{},"f:type":{}}}}]},"spec":{"ports":[{"name":"amqp","protocol":"TCP","port":5672,"targetPort":5672},{"name":"management","protocol":"TCP","port":15672,"targetPort":15672}],"selector":{"app.kubernetes.io/name":"rabbitmq-cluster"},"clusterIP":"10.96.47.189","type":"ClusterIP","sessionAffinity":"None"},"status":{"loadBalancer":{}}}
2022/03/18 18:06:40 learn_server.go:291: [SIEVE-AFTER-READ]	Get	true	secret	default	rabbitmq-cluster-erlang-cookie	github.com/rabbitmq/cluster-operator/controllers.(*RabbitmqClusterReconciler)	NoError	{"kind":"Secret","apiVersion":"v1","metadata":{"name":"rabbitmq-cluster-erlang-cookie","namespace":"default","selfLink":"/api/v1/namespaces/default/secrets/rabbitmq-cluster-erlang-cookie","uid":"01d8d8ad-080a-4c3f-9d27-56616c53dd26","resourceVersion":"1088","creationTimestamp":"2022-03-18T18:06:25Z","labels":{"app.kubernetes.io/component":"rabbitmq","app.kubernetes.io/name":"rabbitmq-cluster","app.kubernetes.io/part-of":"rabbitmq"},"ownerReferences":[{"apiVersion":"rabbitmq.com/v1beta1","kind":"RabbitmqCluster","name":"rabbitmq-cluster","uid":"3ecefa8a-1bec-48a7-9af4-dd0df3339101","controller":true,"blockOwnerDeletion":true}],"managedFields":[{"manager":"manager","operation":"Update","apiVersion":"v1","time":"2022-03-18T18:06:25Z","fieldsType":"FieldsV1","fieldsV1":{"f:data":{".":{},"f:.erlang.cookie":{}},"f:metadata":{"f:labels":{".":{},"f:app.kubernetes.io/component":{},"f:app.kubernetes.io/name":{},"f:app.kubernetes.io/part-of":{}},"f:ownerReferences":{".":{},"k:{\"uid\":\"3ecefa8a-1bec-48a7-9af4-dd0df3339101\"}":{".":{},"f:apiVersion":{},"f:blockOwnerDeletion":{},"f:controller":{},"f:kind":{},"f:name":{},"f:uid":{}}}},"f:type":{}}}]},"data":{".erlang.cookie":"ajdscUtLdnBpR1NwUUMwc1V3a2VyTlJxU2tVUTdBeEw="},"type":"Opaque"}
2022/03/18 18:06:40 learn_server.go:291: [SIEVE-AFTER-READ]	Get	true	secret	default	rabbitmq-cluster-default-user	github.com/rabbitmq/cluster-operator/controllers.(*RabbitmqClusterReconciler)	NoError	{"kind":"Secret","apiVersion":"v1","metadata":{"name":"rabbitmq-cluster-default-user","namespace":"default","selfLink":"/api/v1/namespaces/default/secrets/rabbitmq-cluster-default-user","uid":"b2f5a936-e51f-4488-b6e9-ca23e4d95ac2","resourceVersion":"1091","creationTimestamp":"2022-03-18T18:06:25Z","labels":{"app.kubernetes.io/component":"rabbitmq","app.kubernetes.io/name":"rabbitmq-cluster","app.kubernetes.io/part-of":"rabbitmq"},"ownerReferences":[{"apiVersion":"rabbitmq.com/v1beta1","kind":"RabbitmqCluster","name":"rabbitmq-cluster","uid":"3ecefa8a-1bec-48a7-9af4-dd0df3339101","controller":true,"blockOwnerDeletion":true}],"managedFields":[{"manager":"manager","operation":"Update","apiVersion":"v1","time":"2022-03-18T18:06:25Z","fieldsType":"FieldsV1","fieldsV1":{"f:data":{".":{},"f:default_user.conf":{},"f:password":{},"f:provider":{},"f:type":{},"f:username":{}},"f:metadata":{"f:labels":{".":{},"f:app.kubernetes.io/component":{},"f:app.kubernetes.io/name":{},"f:app.kubernetes.io/part-of":{}},"f:ownerReferences":{".":{},"k:{\"uid\":\"3ecefa8a-1bec-48a7-9af4-dd0df3339101\"}":{".":{},"f:apiVersion":{},"f:blockOwnerDeletion":{},"f:controller":{},"f:kind":{},"f:name":{},"f:uid":{}}}},"f:type":{}}}]},"data":{"default_user.conf":"ZGVmYXVsdF91c2VyID0gdEFMN1otZTgzR29ocEtsZ0Z4cUFFV3ZXemEtcjdJQW8KZGVmYXVsdF9wYXNzID0gdXVocndkTkdOcmJXQ2p6NFZPX0NUZE9OYURkSUpoRkoK","password":"dXVocndkTkdOcmJXQ2p6NFZPX0NUZE9OYURkSUpoRko=","provider":"cmFiYml0bXE=","type":"cmFiYml0bXE=","username":"dEFMN1otZTgzR29ocEtsZ0Z4cUFFV3ZXemEtcjdJQW8="},"type":"Opaque"}
2022/03/18 18:06:40 learn_server.go:291: [SIEVE-AFTER-READ]	Get	true	configmap	default	rabbitmq-cluster-plugins-conf	github.com/rabbitmq/cluster-operator/controllers.(*RabbitmqClusterReconciler)	NoError	{"kind":"ConfigMap","apiVersion":"v1","metadata":{"name":"rabbitmq-cluster-plugins-conf","namespace":"default","selfLink":"/api/v1/namespaces/default/configmaps/rabbitmq-cluster-plugins-conf","uid":"0aa26eb6-ff3a-4457-a223-284c897db7fe","resourceVersion":"1092","creationTimestamp":"2022-03-18T18:06:25Z","labels":{"app.kubernetes.io/component":"rabbitmq","app.kubernetes.io/name":"rabbitmq-cluster","app.kubernetes.io/part-of":"rabbitmq"},"ownerReferences":[{"apiVersion":"rabbitmq.com/v1beta1","kind":"RabbitmqCluster","name":"rabbitmq-cluster","uid":"3ecefa8a-1bec-48a7-9af4-dd0df3339101","controller":true,"blockOwnerDeletion":true}],"managedFields":[{"manager":"manager","operation":"Update","apiVersion":"v1","time":"2022-03-18T18:06:25Z","fieldsType":"FieldsV1","fieldsV1":{"f:data":{".":{},"f:enabled_plugins":{}},"f:metadata":{"f:labels":{".":{},"f:app.kubernetes.io/component":{},"f:app.kubernetes.io/name":{},"f:app.kubernetes.io/part-of":{}},"f:ownerReferences":{".":{},"k:{\"uid\":\"3ecefa8a-1bec-48a7-9af4-dd0df3339101\"}":{".":{},"f:apiVersion":{},"f:blockOwnerDeletion":{},"f:controller":{},"f:kind":{},"f:name":{},"f:uid":{}}}}}}]},"data":{"enabled_plugins":"[rabbitmq_peer_discovery_k8s,rabbitmq_prometheus,rabbitmq_management]."}}
2022/03/18 18:06:40 learn_server.go:291: [SIEVE-AFTER-READ]	Get	true	configmap	default	rabbitmq-cluster-server-conf	github.com/rabbitmq/cluster-operator/controllers.(*RabbitmqClusterReconciler)	NoError	{"kind":"ConfigMap","apiVersion":"v1","metadata":{"name":"rabbitmq-cluster-server-conf","namespace":"default","selfLink":"/api/v1/namespaces/default/configmaps/rabbitmq-cluster-server-conf","uid":"e4182078-d429-4baf-9021-72618c509ac5","resourceVersion":"1095","creationTimestamp":"2022-03-18T18:06:25Z","labels":{"app.kubernetes.io/component":"rabbitmq","app.kubernetes.io/name":"rabbitmq-cluster","app.kubernetes.io/part-of":"rabbitmq"},"ownerReferences":[{"apiVersion":"rabbitmq.com/v1beta1","kind":"RabbitmqCluster","name":"rabbitmq-cluster","uid":"3ecefa8a-1bec-48a7-9af4-dd0df3339101","controller":true,"blockOwnerDeletion":true}],"managedFields":[{"manager":"manager","operation":"Update","apiVersion":"v1","time":"2022-03-18T18:06:25Z","fieldsType":"FieldsV1","fieldsV1":{"f:data":{".":{},"f:operatorDefaults.conf":{},"f:userDefinedConfiguration.conf":{}},"f:metadata":{"f:labels":{".":{},"f:app.kubernetes.io/component":{},"f:app.kubernetes.io/name":{},"f:app.kubernetes.io/part-of":{}},"f:ownerReferences":{".":{},"k:{\"uid\":\"3ecefa8a-1bec-48a7-9af4-dd0df3339101\"}":{".":{},"f:apiVersion":{},"f:blockOwnerDeletion":{},"f:controller":{},"f:kind":{},"f:name":{},"f:uid":{}}}}}}]},"data":{"operatorDefaults.conf":"cluster_formation.peer_discovery_backend             = rabbit_peer_discovery_k8s\ncluster_formation.k8s.host                           = kubernetes.default\ncluster_formation.k8s.address_type                   = hostname\ncluster_partition_handling                           = pause_minority\nqueue_master_locator                                 = min-masters\ndisk_free_limit.absolute                             = 2GB\ncluster_formation.randomized_startup_delay_range.min = 5\ncluster_formation.randomized_startup_delay_range.max = 30\ncluster_name                                         = rabbitmq-cluster\n","userDefinedConfiguration.conf":"total_memory_available_override_value = 1717986919\n"}}
2022/03/18 18:06:40 learn_server.go:291: [SIEVE-AFTER-READ]	Get	true	serviceaccount	default	rabbitmq-cluster-server	github.com/rabbitmq/cluster-operator/controllers.(*RabbitmqClusterReconciler)	NoError	{"kind":"ServiceAccount","apiVersion":"v1","metadata":{"name":"rabbitmq-cluster-server","namespace":"default","selfLink":"/api/v1/namespaces/default/serviceaccounts/rabbitmq-cluster-server","uid":"0c3cead0-37dd-452b-b939-fe346a5dfdea","resourceVersion":"1102","creationTimestamp":"2022-03-18T18:06:25Z","labels":{"app.kubernetes.io/component":"rabbitmq","app.kubernetes.io/name":"rabbitmq-cluster","app.kubernetes.io/part-of":"rabbitmq"},"ownerReferences":[{"apiVersion":"rabbitmq.com/v1beta1","kind":"RabbitmqCluster","name":"rabbitmq-cluster","uid":"3ecefa8a-1bec-48a7-9af4-dd0df3339101","controller":true,"blockOwnerDeletion":true}],"managedFields":[{"manager":"kube-controller-manager","operation":"Update","apiVersion":"v1","time":"2022-03-18T18:06:25Z","fieldsType":"FieldsV1","fieldsV1":{"f:secrets":{".":{},"k:{\"name\":\"rabbitmq-cluster-server-token-v4wpv\"}":{".":{},"f:name":{}}}}},{"manager":"manager","operation":"Update","apiVersion":"v1","time":"2022-03-18T18:06:25Z","fieldsType":"FieldsV1","fieldsV1":{"f:metadata":{"f:labels":{".":{},"f:app.kubernetes.io/component":{},"f:app.kubernetes.io/name":{},"f:app.kubernetes.io/part-of":{}},"f:ownerReferences":{".":{},"k:{\"uid\":\"3ecefa8a-1bec-48a7-9af4-dd0df3339101\"}":{".":{},"f:apiVersion":{},"f:blockOwnerDeletion":{},"f:controller":{},"f:kind":{},"f:name":{},"f:uid":{}}}}}}]},"secrets":[{"name":"rabbitmq-cluster-server-token-v4wpv"}]}
2022/03/18 18:06:40 learn_server.go:291: [SIEVE-AFTER-READ]	Get	true	role	default	rabbitmq-cluster-peer-discovery	github.com/rabbitmq/cluster-operator/controllers.(*RabbitmqClusterReconciler)	NoError	{"kind":"Role","apiVersion":"rbac.authorization.k8s.io/v1","metadata":{"name":"rabbitmq-cluster-peer-discovery","namespace":"default","selfLink":"/apis/rbac.authorization.k8s.io/v1/namespaces/default/roles/rabbitmq-cluster-peer-discovery","uid":"ec9ac474-1880-43ed-af46-9ea5f46d6db4","resourceVersion":"1103","creationTimestamp":"2022-03-18T18:06:25Z","labels":{"app.kubernetes.io/component":"rabbitmq","app.kubernetes.io/name":"rabbitmq-cluster","app.kubernetes.io/part-of":"rabbitmq"},"ownerReferences":[{"apiVersion":"rabbitmq.com/v1beta1","kind":"RabbitmqCluster","name":"rabbitmq-cluster","uid":"3ecefa8a-1bec-48a7-9af4-dd0df3339101","controller":true,"blockOwnerDeletion":true}],"managedFields":[{"manager":"manager","operation":"Update","apiVersion":"rbac.authorization.k8s.io/v1","time":"2022-03-18T18:06:25Z","fieldsType":"FieldsV1","fieldsV1":{"f:metadata":{"f:labels":{".":{},"f:app.kubernetes.io/component":{},"f:app.kubernetes.io/name":{},"f:app.kubernetes.io/part-of":{}},"f:ownerReferences":{".":{},"k:{\"uid\":\"3ecefa8a-1bec-48a7-9af4-dd0df3339101\"}":{".":{},"f:apiVersion":{},"f:blockOwnerDeletion":{},"f:controller":{},"f:kind":{},"f:name":{},"f:uid":{}}}},"f:rules":{}}}]},"rules":[{"verbs":["get"],"apiGroups":[""],"resources":["endpoints"]},{"verbs":["create"],"apiGroups":[""],"resources":["events"]}]}
2022/03/18 18:06:40 learn_server.go:291: [SIEVE-AFTER-READ]	Get	true	rolebinding	default	rabbitmq-cluster-server	github.com/rabbitmq/cluster-operator/controllers.(*RabbitmqClusterReconciler)	NoError	{"kind":"RoleBinding","apiVersion":"rbac.authorization.k8s.io/v1","metadata":{"name":"rabbitmq-cluster-server","namespace":"default","selfLink":"/apis/rbac.authorization.k8s.io/v1/namespaces/default/rolebindings/rabbitmq-cluster-server","uid":"fe69a41c-8d28-4b84-a9f6-a9e6044d75ba","resourceVersion":"1105","creationTimestamp":"2022-03-18T18:06:25Z","labels":{"app.kubernetes.io/component":"rabbitmq","app.kubernetes.io/name":"rabbitmq-cluster","app.kubernetes.io/part-of":"rabbitmq"},"ownerReferences":[{"apiVersion":"rabbitmq.com/v1beta1","kind":"RabbitmqCluster","name":"rabbitmq-cluster","uid":"3ecefa8a-1bec-48a7-9af4-dd0df3339101","controller":true,"blockOwnerDeletion":true}],"managedFields":[{"manager":"manager","operation":"Update","apiVersion":"rbac.authorization.k8s.io/v1","time":"2022-03-18T18:06:25Z","fieldsType":"FieldsV1","fieldsV1":{"f:metadata":{"f:labels":{".":{},"f:app.kubernetes.io/component":{},"f:app.kubernetes.io/name":{},"f:app.kubernetes.io/part-of":{}},"f:ownerReferences":{".":{},"k:{\"uid\":\"3ecefa8a-1bec-48a7-9af4-dd0df3339101\"}":{".":{},"f:apiVersion":{},"f:blockOwnerDeletion":{},"f:controller":{},"f:kind":{},"f:name":{},"f:uid":{}}}},"f:roleRef":{"f:apiGroup":{},"f:kind":{},"f:name":{}},"f:subjects":{}}}]},"subjects":[{"kind":"ServiceAccount","name":"rabbitmq-cluster-server"}],"roleRef":{"apiGroup":"rbac.authorization.k8s.io","kind":"Role","name":"rabbitmq-cluster-peer-discovery"}}
2022/03/18 18:06:40 learn_server.go:291: [SIEVE-AFTER-READ]	Get	true	statefulset	default	rabbitmq-cluster-server	github.com/rabbitmq/cluster-operator/controllers.(*RabbitmqClusterReconciler)	NoError	{"kind":"StatefulSet","apiVersion":"apps/v1","metadata":{"name":"rabbitmq-cluster-server","namespace":"default","selfLink":"/apis/apps/v1/namespaces/default/statefulsets/rabbitmq-cluster-server","uid":"f2f07f3e-b500-4c48-a5de-8db7eaf37b9a","resourceVersion":"1129","generation":1,"creationTimestamp":"2022-03-18T18:06:25Z","labels":{"app.kubernetes.io/component":"rabbitmq","app.kubernetes.io/name":"rabbitmq-cluster","app.kubernetes.io/part-of":"rabbitmq"},"annotations":{"rabbitmq.com/createdAt":"2022-03-18T18:06:25Z"},"ownerReferences":[{"apiVersion":"rabbitmq.com/v1beta1","kind":"RabbitmqCluster","name":"rabbitmq-cluster","uid":"3ecefa8a-1bec-48a7-9af4-dd0df3339101","controller":true,"blockOwnerDeletion":true}],"managedFields":[{"manager":"kube-controller-manager","operation":"Update","apiVersion":"apps/v1","time":"2022-03-18T18:06:25Z","fieldsType":"FieldsV1","fieldsV1":{"f:status":{"f:collisionCount":{},"f:currentReplicas":{},"f:currentRevision":{},"f:observedGeneration":{},"f:replicas":{},"f:updateRevision":{},"f:updatedReplicas":{}}}},{"manager":"manager","operation":"Update","apiVersion":"apps/v1","time":"2022-03-18T18:06:25Z","fieldsType":"FieldsV1","fieldsV1":{"f:metadata":{"f:annotations":{".":{},"f:rabbitmq.com/createdAt":{}},"f:labels":{".":{},"f:app.kubernetes.io/component":{},"f:app.kubernetes.io/name":{},"f:app.kubernetes.io/part-of":{}},"f:ownerReferences":{".":{},"k:{\"uid\":\"3ecefa8a-1bec-48a7-9af4-dd0df3339101\"}":{".":{},"f:apiVersion":{},"f:blockOwnerDeletion":{},"f:controller":{},"f:kind":{},"f:name":{},"f:uid":{}}}},"f:spec":{"f:podManagementPolicy":{},"f:replicas":{},"f:revisionHistoryLimit":{},"f:selector":{"f:matchLabels":{".":{},"f:app.kubernetes.io/name":{}}},"f:serviceName":{},"f:template":{"f:metadata":{"f:annotations":{".":{},"f:prometheus.io/port":{},"f:prometheus.io/scrape":{}},"f:labels":{".":{},"f:app.kubernetes.io/component":{},"f:app.kubernetes.io/name":{},"f:app.kubernetes.io/part-of":{}}},"f:spec":{"f:automountServiceAccountToken":{},"f:containers":{"k:{\"name\":\"rabbitmq\"}":{".":{},"f:env":{".":{},"k:{\"name\":\"K8S_HOSTNAME_SUFFIX\"}":{".":{},"f:name":{},"f:value":{}},"k:{\"name\":\"K8S_SERVICE_NAME\"}":{".":{},"f:name":{},"f:value":{}},"k:{\"name\":\"MY_POD_NAME\"}":{".":{},"f:name":{},"f:valueFrom":{".":{},"f:fieldRef":{".":{},"f:apiVersion":{},"f:fieldPath":{}}}},"k:{\"name\":\"MY_POD_NAMESPACE\"}":{".":{},"f:name":{},"f:valueFrom":{".":{},"f:fieldRef":{".":{},"f:apiVersion":{},"f:fieldPath":{}}}},"k:{\"name\":\"RABBITMQ_ENABLED_PLUGINS_FILE\"}":{".":{},"f:name":{},"f:value":{}},"k:{\"name\":\"RABBITMQ_NODENAME\"}":{".":{},"f:name":{},"f:value":{}},"k:{\"name\":\"RABBITMQ_USE_LONGNAME\"}":{".":{},"f:name":{},"f:value":{}}},"f:image":{},"f:imagePullPolicy":{},"f:lifecycle":{".":{},"f:preStop":{".":{},"f:exec":{".":{},"f:command":{}}}},"f:name":{},"f:ports":{".":{},"k:{\"containerPort\":4369,\"protocol\":\"TCP\"}":{".":{},"f:containerPort":{},"f:name":{},"f:protocol":{}},"k:{\"containerPort\":5672,\"protocol\":\"TCP\"}":{".":{},"f:containerPort":{},"f:name":{},"f:protocol":{}},"k:{\"containerPort\":15672,\"protocol\":\"TCP\"}":{".":{},"f:containerPort":{},"f:name":{},"f:protocol":{}},"k:{\"containerPort\":15692,\"protocol\":\"TCP\"}":{".":{},"f:containerPort":{},"f:name":{},"f:protocol":{}}},"f:readinessProbe":{".":{},"f:failureThreshold":{},"f:initialDelaySeconds":{},"f:periodSeconds":{},"f:successThreshold":{},"f:tcpSocket":{".":{},"f:port":{}},"f:timeoutSeconds":{}},"f:resources":{".":{},"f:limits":{".":{},"f:cpu":{},"f:memory":{}},"f:requests":{".":{},"f:cpu":{},"f:memory":{}}},"f:terminationMessagePath":{},"f:terminationMessagePolicy":{},"f:volumeMounts":{".":{},"k:{\"mountPath\":\"/etc/pod-info/\"}":{".":{},"f:mountPath":{},"f:name":{}},"k:{\"mountPath\":\"/etc/rabbitmq/conf.d/10-operatorDefaults.conf\"}":{".":{},"f:mountPath":{},"f:name":{},"f:subPath":{}},"k:{\"mountPath\":\"/etc/rabbitmq/conf.d/11-default_user.conf\"}":{".":{},"f:mountPath":{},"f:name":{},"f:subPath":{}},"k:{\"mountPath\":\"/etc/rabbitmq/conf.d/90-userDefinedConfiguration.conf\"}":{".":{},"f:mountPath":{},"f:name":{},"f:subPath":{}},"k:{\"mountPath\":\"/operator\"}":{".":{},"f:mountPath":{},"f:name":{}},"k:{\"mountPath\":\"/var/lib/rabbitmq/\"}":{".":{},"f:mountPath":{},"f:name":{}},"k:{\"mountPath\":\"/var/lib/rabbitmq/mnesia/\"}":{".":{},"f:mountPath":{},"f:name":{}}}}},"f:dnsPolicy":{},"f:initContainers":{".":{},"k:{\"name\":\"setup-container\"}":{".":{},"f:command":{},"f:image":{},"f:imagePullPolicy":{},"f:name":{},"f:resources":{".":{},"f:limits":{".":{},"f:cpu":{},"f:memory":{}},"f:requests":{".":{},"f:cpu":{},"f:memory":{}}},"f:securityContext":{".":{},"f:capabilities":{".":{},"f:drop":{}},"f:runAsUser":{}},"f:terminationMessagePath":{},"f:terminationMessagePolicy":{},"f:volumeMounts":{".":{},"k:{\"mountPath\":\"/operator\"}":{".":{},"f:mountPath":{},"f:name":{}},"k:{\"mountPath\":\"/tmp/default_user.conf\"}":{".":{},"f:mountPath":{},"f:name":{},"f:subPath":{}},"k:{\"mountPath\":\"/tmp/erlang-cookie-secret/\"}":{".":{},"f:mountPath":{},"f:name":{}},"k:{\"mountPath\":\"/tmp/rabbitmq-plugins/\"}":{".":{},"f:mountPath":{},"f:name":{}},"k:{\"mountPath\":\"/var/lib/rabbitmq/\"}":{".":{},"f:mountPath":{},"f:name":{}},"k:{\"mountPath\":\"/var/lib/rabbitmq/mnesia/\"}":{".":{},"f:mountPath":{},"f:name":{}}}}},"f:restartPolicy":{},"f:schedulerName":{},"f:securityContext":{".":{},"f:fsGroup":{},"f:runAsGroup":{},"f:runAsUser":{}},"f:serviceAccount":{},"f:serviceAccountName":{},"f:terminationGracePeriodSeconds":{},"f:topologySpreadConstraints":{".":{},"k:{\"topologyKey\":\"topology.kubernetes.io/zone\",\"whenUnsatisfiable\":\"ScheduleAnyway\"}":{".":{},"f:labelSelector":{".":{},"f:matchLabels":{".":{},"f:app.kubernetes.io/name":{}}},"f:maxSkew":{},"f:topologyKey":{},"f:whenUnsatisfiable":{}}},"f:volumes":{".":{},"k:{\"name\":\"erlang-cookie-secret\"}":{".":{},"f:name":{},"f:secret":{".":{},"f:defaultMode":{},"f:secretName":{}}},"k:{\"name\":\"plugins-conf\"}":{".":{},"f:configMap":{".":{},"f:defaultMode":{},"f:name":{}},"f:name":{}},"k:{\"name\":\"pod-info\"}":{".":{},"f:downwardAPI":{".":{},"f:defaultMode":{},"f:items":{}},"f:name":{}},"k:{\"name\":\"rabbitmq-confd\"}":{".":{},"f:name":{},"f:projected":{".":{},"f:defaultMode":{},"f:sources":{}}},"k:{\"name\":\"rabbitmq-erlang-cookie\"}":{".":{},"f:emptyDir":{},"f:name":{}},"k:{\"name\":\"rabbitmq-plugins\"}":{".":{},"f:emptyDir":{},"f:name":{}}}}},"f:updateStrategy":{"f:rollingUpdate":{".":{},"f:partition":{}},"f:type":{}},"f:volumeClaimTemplates":{}}}}]},"spec":{"replicas":1,"selector":{"matchLabels":{"app.kubernetes.io/name":"rabbitmq-cluster"}},"template":{"metadata":{"creationTimestamp":null,"labels":{"app.kubernetes.io/component":"rabbitmq","app.kubernetes.io/name":"rabbitmq-cluster","app.kubernetes.io/part-of":"rabbitmq"},"annotations":{"prometheus.io/port":"15692","prometheus.io/scrape":"true"}},"spec":{"volumes":[{"name":"plugins-conf","configMap":{"name":"rabbitmq-cluster-plugins-conf","defaultMode":420}},{"name":"rabbitmq-confd","projected":{"sources":[{"secret":{"name":"rabbitmq-cluster-default-user","items":[{"key":"default_user.conf","path":"default_user.conf"}]}},{"configMap":{"name":"rabbitmq-cluster-server-conf","items":[{"key":"operatorDefaults.conf","path":"operatorDefaults.conf"},{"key":"userDefinedConfiguration.conf","path":"userDefinedConfiguration.conf"}]}}],"defaultMode":420}},{"name":"rabbitmq-erlang-cookie","emptyDir":{}},{"name":"erlang-cookie-secret","secret":{"secretName":"rabbitmq-cluster-erlang-cookie","defaultMode":420}},{"name":"rabbitmq-plugins","emptyDir":{}},{"name":"pod-info","downwardAPI":{"items":[{"path":"skipPreStopChecks","fieldRef":{"apiVersion":"v1","fieldPath":"metadata.labels['skipPreStopChecks']"}}],"defaultMode":420}}],"initContainers":[{"name":"setup-container","image":"rabbitmq:3.8.12-management","command":["sh","-c","cp /tmp/erlang-cookie-secret/.erlang.cookie /var/lib/rabbitmq/.erlang.cookie \u0026\u0026 chown 999:999 /var/lib/rabbitmq/.erlang.cookie \u0026\u0026 chmod 600 /var/lib/rabbitmq/.erlang.cookie ; cp /tmp/rabbitmq-plugins/enabled_plugins /operator/enabled_plugins \u0026\u0026 chown 999:999 /operator/enabled_plugins ; chown 999:999 /var/lib/rabbitmq/mnesia/ ; echo '[default]' \u003e /var/lib/rabbitmq/.rabbitmqadmin.conf \u0026\u0026 sed -e 's/default_user/username/' -e 's/default_pass/password/' /tmp/default_user.conf \u003e\u003e /var/lib/rabbitmq/.rabbitmqadmin.conf \u0026\u0026 chown 999:999 /var/lib/rabbitmq/.rabbitmqadmin.conf \u0026\u0026 chmod 600 /var/lib/rabbitmq/.rabbitmqadmin.conf"],"resources":{"limits":{"cpu":"100m","memory":"500Mi"},"requests":{"cpu":"100m","memory":"500Mi"}},"volumeMounts":[{"name":"plugins-conf","mountPath":"/tmp/rabbitmq-plugins/"},{"name":"rabbitmq-erlang-cookie","mountPath":"/var/lib/rabbitmq/"},{"name":"erlang-cookie-secret","mountPath":"/tmp/erlang-cookie-secret/"},{"name":"rabbitmq-plugins","mountPath":"/operator"},{"name":"persistence","mountPath":"/var/lib/rabbitmq/mnesia/"},{"name":"rabbitmq-confd","mountPath":"/tmp/default_user.conf","subPath":"default_user.conf"}],"terminationMessagePath":"/dev/termination-log","terminationMessagePolicy":"File","imagePullPolicy":"IfNotPresent","securityContext":{"capabilities":{"drop":["FSETID","KILL","SETGID","SETUID","SETPCAP","NET_BIND_SERVICE","NET_RAW","SYS_CHROOT","MKNOD","AUDIT_WRITE","SETFCAP"]},"runAsUser":0}}],"containers":[{"name":"rabbitmq","image":"rabbitmq:3.8.12-management","ports":[{"name":"epmd","containerPort":4369,"protocol":"TCP"},{"name":"amqp","containerPort":5672,"protocol":"TCP"},{"name":"management","containerPort":15672,"protocol":"TCP"},{"name":"prometheus","containerPort":15692,"protocol":"TCP"}],"env":[{"name":"MY_POD_NAME","valueFrom":{"fieldRef":{"apiVersion":"v1","fieldPath":"metadata.name"}}},{"name":"MY_POD_NAMESPACE","valueFrom":{"fieldRef":{"apiVersion":"v1","fieldPath":"metadata.namespace"}}},{"name":"RABBITMQ_ENABLED_PLUGINS_FILE","value":"/operator/enabled_plugins"},{"name":"K8S_SERVICE_NAME","value":"rabbitmq-cluster-nodes"},{"name":"RABBITMQ_USE_LONGNAME","value":"true"},{"name":"RABBITMQ_NODENAME","value":"rabbit@$(MY_POD_NAME).$(K8S_SERVICE_NAME).$(MY_POD_NAMESPACE)"},{"name":"K8S_HOSTNAME_SUFFIX","value":".$(K8S_SERVICE_NAME).$(MY_POD_NAMESPACE)"}],"resources":{"limits":{"cpu":"2","memory":"2Gi"},"requests":{"cpu":"1","memory":"2Gi"}},"volumeMounts":[{"name":"rabbitmq-erlang-cookie","mountPath":"/var/lib/rabbitmq/"},{"name":"persistence","mountPath":"/var/lib/rabbitmq/mnesia/"},{"name":"rabbitmq-plugins","mountPath":"/operator"},{"name":"rabbitmq-confd","mountPath":"/etc/rabbitmq/conf.d/10-operatorDefaults.conf","subPath":"operatorDefaults.conf"},{"name":"rabbitmq-confd","mountPath":"/etc/rabbitmq/conf.d/11-default_user.conf","subPath":"default_user.conf"},{"name":"rabbitmq-confd","mountPath":"/etc/rabbitmq/conf.d/90-userDefinedConfiguration.conf","subPath":"userDefinedConfiguration.conf"},{"name":"pod-info","mountPath":"/etc/pod-info/"}],"readinessProbe":{"tcpSocket":{"port":"amqp"},"initialDelaySeconds":10,"timeoutSeconds":5,"periodSeconds":10,"successThreshold":1,"failureThreshold":3},"lifecycle":{"preStop":{"exec":{"command":["/bin/bash","-c","if [ ! -z \"$(cat /etc/pod-info/skipPreStopChecks)\" ]; then exit 0; fi; rabbitmq-upgrade await_online_quorum_plus_one -t 604800; rabbitmq-upgrade await_online_synchronized_mirror -t 604800; rabbitmq-upgrade drain -t 604800"]}}},"terminationMessagePath":"/dev/termination-log","terminationMessagePolicy":"File","imagePullPolicy":"IfNotPresent"}],"restartPolicy":"Always","terminationGracePeriodSeconds":604800,"dnsPolicy":"ClusterFirst","serviceAccountName":"rabbitmq-cluster-server","serviceAccount":"rabbitmq-cluster-server","automountServiceAccountToken":true,"securityContext":{"runAsUser":999,"runAsGroup":999,"fsGroup":999},"schedulerName":"default-scheduler","topologySpreadConstraints":[{"maxSkew":1,"topologyKey":"topology.kubernetes.io/zone","whenUnsatisfiable":"ScheduleAnyway","labelSelector":{"matchLabels":{"app.kubernetes.io/name":"rabbitmq-cluster"}}}]}},"volumeClaimTemplates":[{"metadata":{"name":"persistence","namespace":"default","creationTimestamp":null,"labels":{"app.kubernetes.io/component":"rabbitmq","app.kubernetes.io/name":"rabbitmq-cluster","app.kubernetes.io/part-of":"rabbitmq"},"ownerReferences":[{"apiVersion":"rabbitmq.com/v1beta1","kind":"RabbitmqCluster","name":"rabbitmq-cluster","uid":"3ecefa8a-1bec-48a7-9af4-dd0df3339101","controller":true,"blockOwnerDeletion":false}]},"spec":{"accessModes":["ReadWriteOnce"],"resources":{"requests":{"storage":"10Gi"}},"volumeMode":"Filesystem"},"status":{"phase":"Pending"}}],"serviceName":"rabbitmq-cluster-nodes","podManagementPolicy":"Parallel","updateStrategy":{"type":"RollingUpdate","rollingUpdate":{"partition":0}},"revisionHistoryLimit":10},"status":{"observedGeneration":1,"replicas":1,"currentReplicas":1,"updatedReplicas":1,"currentRevision":"rabbitmq-cluster-server-5f8b8665fb","updateRevision":"rabbitmq-cluster-server-5f8b8665fb","collisionCount":0}}
2022/03/18 18:06:40 learn_server.go:291: [SIEVE-AFTER-READ]	Get	true	statefulset	default	rabbitmq-cluster-server	github.com/rabbitmq/cluster-operator/controllers.(*RabbitmqClusterReconciler)	NoError	{"kind":"StatefulSet","apiVersion":"apps/v1","metadata":{"name":"rabbitmq-cluster-server","namespace":"default","selfLink":"/apis/apps/v1/namespaces/default/statefulsets/rabbitmq-cluster-server","uid":"f2f07f3e-b500-4c48-a5de-8db7eaf37b9a","resourceVersion":"1129","generation":1,"creationTimestamp":"2022-03-18T18:06:25Z","labels":{"app.kubernetes.io/component":"rabbitmq","app.kubernetes.io/name":"rabbitmq-cluster","app.kubernetes.io/part-of":"rabbitmq"},"annotations":{"rabbitmq.com/createdAt":"2022-03-18T18:06:25Z"},"ownerReferences":[{"apiVersion":"rabbitmq.com/v1beta1","kind":"RabbitmqCluster","name":"rabbitmq-cluster","uid":"3ecefa8a-1bec-48a7-9af4-dd0df3339101","controller":true,"blockOwnerDeletion":true}],"managedFields":[{"manager":"kube-controller-manager","operation":"Update","apiVersion":"apps/v1","time":"2022-03-18T18:06:25Z","fieldsType":"FieldsV1","fieldsV1":{"f:status":{"f:collisionCount":{},"f:currentReplicas":{},"f:currentRevision":{},"f:observedGeneration":{},"f:replicas":{},"f:updateRevision":{},"f:updatedReplicas":{}}}},{"manager":"manager","operation":"Update","apiVersion":"apps/v1","time":"2022-03-18T18:06:25Z","fieldsType":"FieldsV1","fieldsV1":{"f:metadata":{"f:annotations":{".":{},"f:rabbitmq.com/createdAt":{}},"f:labels":{".":{},"f:app.kubernetes.io/component":{},"f:app.kubernetes.io/name":{},"f:app.kubernetes.io/part-of":{}},"f:ownerReferences":{".":{},"k:{\"uid\":\"3ecefa8a-1bec-48a7-9af4-dd0df3339101\"}":{".":{},"f:apiVersion":{},"f:blockOwnerDeletion":{},"f:controller":{},"f:kind":{},"f:name":{},"f:uid":{}}}},"f:spec":{"f:podManagementPolicy":{},"f:replicas":{},"f:revisionHistoryLimit":{},"f:selector":{"f:matchLabels":{".":{},"f:app.kubernetes.io/name":{}}},"f:serviceName":{},"f:template":{"f:metadata":{"f:annotations":{".":{},"f:prometheus.io/port":{},"f:prometheus.io/scrape":{}},"f:labels":{".":{},"f:app.kubernetes.io/component":{},"f:app.kubernetes.io/name":{},"f:app.kubernetes.io/part-of":{}}},"f:spec":{"f:automountServiceAccountToken":{},"f:containers":{"k:{\"name\":\"rabbitmq\"}":{".":{},"f:env":{".":{},"k:{\"name\":\"K8S_HOSTNAME_SUFFIX\"}":{".":{},"f:name":{},"f:value":{}},"k:{\"name\":\"K8S_SERVICE_NAME\"}":{".":{},"f:name":{},"f:value":{}},"k:{\"name\":\"MY_POD_NAME\"}":{".":{},"f:name":{},"f:valueFrom":{".":{},"f:fieldRef":{".":{},"f:apiVersion":{},"f:fieldPath":{}}}},"k:{\"name\":\"MY_POD_NAMESPACE\"}":{".":{},"f:name":{},"f:valueFrom":{".":{},"f:fieldRef":{".":{},"f:apiVersion":{},"f:fieldPath":{}}}},"k:{\"name\":\"RABBITMQ_ENABLED_PLUGINS_FILE\"}":{".":{},"f:name":{},"f:value":{}},"k:{\"name\":\"RABBITMQ_NODENAME\"}":{".":{},"f:name":{},"f:value":{}},"k:{\"name\":\"RABBITMQ_USE_LONGNAME\"}":{".":{},"f:name":{},"f:value":{}}},"f:image":{},"f:imagePullPolicy":{},"f:lifecycle":{".":{},"f:preStop":{".":{},"f:exec":{".":{},"f:command":{}}}},"f:name":{},"f:ports":{".":{},"k:{\"containerPort\":4369,\"protocol\":\"TCP\"}":{".":{},"f:containerPort":{},"f:name":{},"f:protocol":{}},"k:{\"containerPort\":5672,\"protocol\":\"TCP\"}":{".":{},"f:containerPort":{},"f:name":{},"f:protocol":{}},"k:{\"containerPort\":15672,\"protocol\":\"TCP\"}":{".":{},"f:containerPort":{},"f:name":{},"f:protocol":{}},"k:{\"containerPort\":15692,\"protocol\":\"TCP\"}":{".":{},"f:containerPort":{},"f:name":{},"f:protocol":{}}},"f:readinessProbe":{".":{},"f:failureThreshold":{},"f:initialDelaySeconds":{},"f:periodSeconds":{},"f:successThreshold":{},"f:tcpSocket":{".":{},"f:port":{}},"f:timeoutSeconds":{}},"f:resources":{".":{},"f:limits":{".":{},"f:cpu":{},"f:memory":{}},"f:requests":{".":{},"f:cpu":{},"f:memory":{}}},"f:terminationMessagePath":{},"f:terminationMessagePolicy":{},"f:volumeMounts":{".":{},"k:{\"mountPath\":\"/etc/pod-info/\"}":{".":{},"f:mountPath":{},"f:name":{}},"k:{\"mountPath\":\"/etc/rabbitmq/conf.d/10-operatorDefaults.conf\"}":{".":{},"f:mountPath":{},"f:name":{},"f:subPath":{}},"k:{\"mountPath\":\"/etc/rabbitmq/conf.d/11-default_user.conf\"}":{".":{},"f:mountPath":{},"f:name":{},"f:subPath":{}},"k:{\"mountPath\":\"/etc/rabbitmq/conf.d/90-userDefinedConfiguration.conf\"}":{".":{},"f:mountPath":{},"f:name":{},"f:subPath":{}},"k:{\"mountPath\":\"/operator\"}":{".":{},"f:mountPath":{},"f:name":{}},"k:{\"mountPath\":\"/var/lib/rabbitmq/\"}":{".":{},"f:mountPath":{},"f:name":{}},"k:{\"mountPath\":\"/var/lib/rabbitmq/mnesia/\"}":{".":{},"f:mountPath":{},"f:name":{}}}}},"f:dnsPolicy":{},"f:initContainers":{".":{},"k:{\"name\":\"setup-container\"}":{".":{},"f:command":{},"f:image":{},"f:imagePullPolicy":{},"f:name":{},"f:resources":{".":{},"f:limits":{".":{},"f:cpu":{},"f:memory":{}},"f:requests":{".":{},"f:cpu":{},"f:memory":{}}},"f:securityContext":{".":{},"f:capabilities":{".":{},"f:drop":{}},"f:runAsUser":{}},"f:terminationMessagePath":{},"f:terminationMessagePolicy":{},"f:volumeMounts":{".":{},"k:{\"mountPath\":\"/operator\"}":{".":{},"f:mountPath":{},"f:name":{}},"k:{\"mountPath\":\"/tmp/default_user.conf\"}":{".":{},"f:mountPath":{},"f:name":{},"f:subPath":{}},"k:{\"mountPath\":\"/tmp/erlang-cookie-secret/\"}":{".":{},"f:mountPath":{},"f:name":{}},"k:{\"mountPath\":\"/tmp/rabbitmq-plugins/\"}":{".":{},"f:mountPath":{},"f:name":{}},"k:{\"mountPath\":\"/var/lib/rabbitmq/\"}":{".":{},"f:mountPath":{},"f:name":{}},"k:{\"mountPath\":\"/var/lib/rabbitmq/mnesia/\"}":{".":{},"f:mountPath":{},"f:name":{}}}}},"f:restartPolicy":{},"f:schedulerName":{},"f:securityContext":{".":{},"f:fsGroup":{},"f:runAsGroup":{},"f:runAsUser":{}},"f:serviceAccount":{},"f:serviceAccountName":{},"f:terminationGracePeriodSeconds":{},"f:topologySpreadConstraints":{".":{},"k:{\"topologyKey\":\"topology.kubernetes.io/zone\",\"whenUnsatisfiable\":\"ScheduleAnyway\"}":{".":{},"f:labelSelector":{".":{},"f:matchLabels":{".":{},"f:app.kubernetes.io/name":{}}},"f:maxSkew":{},"f:topologyKey":{},"f:whenUnsatisfiable":{}}},"f:volumes":{".":{},"k:{\"name\":\"erlang-cookie-secret\"}":{".":{},"f:name":{},"f:secret":{".":{},"f:defaultMode":{},"f:secretName":{}}},"k:{\"name\":\"plugins-conf\"}":{".":{},"f:configMap":{".":{},"f:defaultMode":{},"f:name":{}},"f:name":{}},"k:{\"name\":\"pod-info\"}":{".":{},"f:downwardAPI":{".":{},"f:defaultMode":{},"f:items":{}},"f:name":{}},"k:{\"name\":\"rabbitmq-confd\"}":{".":{},"f:name":{},"f:projected":{".":{},"f:defaultMode":{},"f:sources":{}}},"k:{\"name\":\"rabbitmq-erlang-cookie\"}":{".":{},"f:emptyDir":{},"f:name":{}},"k:{\"name\":\"rabbitmq-plugins\"}":{".":{},"f:emptyDir":{},"f:name":{}}}}},"f:updateStrategy":{"f:rollingUpdate":{".":{},"f:partition":{}},"f:type":{}},"f:volumeClaimTemplates":{}}}}]},"spec":{"replicas":1,"selector":{"matchLabels":{"app.kubernetes.io/name":"rabbitmq-cluster"}},"template":{"metadata":{"creationTimestamp":null,"labels":{"app.kubernetes.io/component":"rabbitmq","app.kubernetes.io/name":"rabbitmq-cluster","app.kubernetes.io/part-of":"rabbitmq"},"annotations":{"prometheus.io/port":"15692","prometheus.io/scrape":"true"}},"spec":{"volumes":[{"name":"plugins-conf","configMap":{"name":"rabbitmq-cluster-plugins-conf","defaultMode":420}},{"name":"rabbitmq-confd","projected":{"sources":[{"secret":{"name":"rabbitmq-cluster-default-user","items":[{"key":"default_user.conf","path":"default_user.conf"}]}},{"configMap":{"name":"rabbitmq-cluster-server-conf","items":[{"key":"operatorDefaults.conf","path":"operatorDefaults.conf"},{"key":"userDefinedConfiguration.conf","path":"userDefinedConfiguration.conf"}]}}],"defaultMode":420}},{"name":"rabbitmq-erlang-cookie","emptyDir":{}},{"name":"erlang-cookie-secret","secret":{"secretName":"rabbitmq-cluster-erlang-cookie","defaultMode":420}},{"name":"rabbitmq-plugins","emptyDir":{}},{"name":"pod-info","downwardAPI":{"items":[{"path":"skipPreStopChecks","fieldRef":{"apiVersion":"v1","fieldPath":"metadata.labels['skipPreStopChecks']"}}],"defaultMode":420}}],"initContainers":[{"name":"setup-container","image":"rabbitmq:3.8.12-management","command":["sh","-c","cp /tmp/erlang-cookie-secret/.erlang.cookie /var/lib/rabbitmq/.erlang.cookie \u0026\u0026 chown 999:999 /var/lib/rabbitmq/.erlang.cookie \u0026\u0026 chmod 600 /var/lib/rabbitmq/.erlang.cookie ; cp /tmp/rabbitmq-plugins/enabled_plugins /operator/enabled_plugins \u0026\u0026 chown 999:999 /operator/enabled_plugins ; chown 999:999 /var/lib/rabbitmq/mnesia/ ; echo '[default]' \u003e /var/lib/rabbitmq/.rabbitmqadmin.conf \u0026\u0026 sed -e 's/default_user/username/' -e 's/default_pass/password/' /tmp/default_user.conf \u003e\u003e /var/lib/rabbitmq/.rabbitmqadmin.conf \u0026\u0026 chown 999:999 /var/lib/rabbitmq/.rabbitmqadmin.conf \u0026\u0026 chmod 600 /var/lib/rabbitmq/.rabbitmqadmin.conf"],"resources":{"limits":{"cpu":"100m","memory":"500Mi"},"requests":{"cpu":"100m","memory":"500Mi"}},"volumeMounts":[{"name":"plugins-conf","mountPath":"/tmp/rabbitmq-plugins/"},{"name":"rabbitmq-erlang-cookie","mountPath":"/var/lib/rabbitmq/"},{"name":"erlang-cookie-secret","mountPath":"/tmp/erlang-cookie-secret/"},{"name":"rabbitmq-plugins","mountPath":"/operator"},{"name":"persistence","mountPath":"/var/lib/rabbitmq/mnesia/"},{"name":"rabbitmq-confd","mountPath":"/tmp/default_user.conf","subPath":"default_user.conf"}],"terminationMessagePath":"/dev/termination-log","terminationMessagePolicy":"File","imagePullPolicy":"IfNotPresent","securityContext":{"capabilities":{"drop":["FSETID","KILL","SETGID","SETUID","SETPCAP","NET_BIND_SERVICE","NET_RAW","SYS_CHROOT","MKNOD","AUDIT_WRITE","SETFCAP"]},"runAsUser":0}}],"containers":[{"name":"rabbitmq","image":"rabbitmq:3.8.12-management","ports":[{"name":"epmd","containerPort":4369,"protocol":"TCP"},{"name":"amqp","containerPort":5672,"protocol":"TCP"},{"name":"management","containerPort":15672,"protocol":"TCP"},{"name":"prometheus","containerPort":15692,"protocol":"TCP"}],"env":[{"name":"MY_POD_NAME","valueFrom":{"fieldRef":{"apiVersion":"v1","fieldPath":"metadata.name"}}},{"name":"MY_POD_NAMESPACE","valueFrom":{"fieldRef":{"apiVersion":"v1","fieldPath":"metadata.namespace"}}},{"name":"RABBITMQ_ENABLED_PLUGINS_FILE","value":"/operator/enabled_plugins"},{"name":"K8S_SERVICE_NAME","value":"rabbitmq-cluster-nodes"},{"name":"RABBITMQ_USE_LONGNAME","value":"true"},{"name":"RABBITMQ_NODENAME","value":"rabbit@$(MY_POD_NAME).$(K8S_SERVICE_NAME).$(MY_POD_NAMESPACE)"},{"name":"K8S_HOSTNAME_SUFFIX","value":".$(K8S_SERVICE_NAME).$(MY_POD_NAMESPACE)"}],"resources":{"limits":{"cpu":"2","memory":"2Gi"},"requests":{"cpu":"1","memory":"2Gi"}},"volumeMounts":[{"name":"rabbitmq-erlang-cookie","mountPath":"/var/lib/rabbitmq/"},{"name":"persistence","mountPath":"/var/lib/rabbitmq/mnesia/"},{"name":"rabbitmq-plugins","mountPath":"/operator"},{"name":"rabbitmq-confd","mountPath":"/etc/rabbitmq/conf.d/10-operatorDefaults.conf","subPath":"operatorDefaults.conf"},{"name":"rabbitmq-confd","mountPath":"/etc/rabbitmq/conf.d/11-default_user.conf","subPath":"default_user.conf"},{"name":"rabbitmq-confd","mountPath":"/etc/rabbitmq/conf.d/90-userDefinedConfiguration.conf","subPath":"userDefinedConfiguration.conf"},{"name":"pod-info","mountPath":"/etc/pod-info/"}],"readinessProbe":{"tcpSocket":{"port":"amqp"},"initialDelaySeconds":10,"timeoutSeconds":5,"periodSeconds":10,"successThreshold":1,"failureThreshold":3},"lifecycle":{"preStop":{"exec":{"command":["/bin/bash","-c","if [ ! -z \"$(cat /etc/pod-info/skipPreStopChecks)\" ]; then exit 0; fi; rabbitmq-upgrade await_online_quorum_plus_one -t 604800; rabbitmq-upgrade await_online_synchronized_mirror -t 604800; rabbitmq-upgrade drain -t 604800"]}}},"terminationMessagePath":"/dev/termination-log","terminationMessagePolicy":"File","imagePullPolicy":"IfNotPresent"}],"restartPolicy":"Always","terminationGracePeriodSeconds":604800,"dnsPolicy":"ClusterFirst","serviceAccountName":"rabbitmq-cluster-server","serviceAccount":"rabbitmq-cluster-server","automountServiceAccountToken":true,"securityContext":{"runAsUser":999,"runAsGroup":999,"fsGroup":999},"schedulerName":"default-scheduler","topologySpreadConstraints":[{"maxSkew":1,"topologyKey":"topology.kubernetes.io/zone","whenUnsatisfiable":"ScheduleAnyway","labelSelector":{"matchLabels":{"app.kubernetes.io/name":"rabbitmq-cluster"}}}]}},"volumeClaimTemplates":[{"metadata":{"name":"persistence","namespace":"default","creationTimestamp":null,"labels":{"app.kubernetes.io/component":"rabbitmq","app.kubernetes.io/name":"rabbitmq-cluster","app.kubernetes.io/part-of":"rabbitmq"},"ownerReferences":[{"apiVersion":"rabbitmq.com/v1beta1","kind":"RabbitmqCluster","name":"rabbitmq-cluster","uid":"3ecefa8a-1bec-48a7-9af4-dd0df3339101","controller":true,"blockOwnerDeletion":false}]},"spec":{"accessModes":["ReadWriteOnce"],"resources":{"requests":{"storage":"10Gi"}},"volumeMode":"Filesystem"},"status":{"phase":"Pending"}}],"serviceName":"rabbitmq-cluster-nodes","podManagementPolicy":"Parallel","updateStrategy":{"type":"RollingUpdate","rollingUpdate":{"partition":0}},"revisionHistoryLimit":10},"status":{"observedGeneration":1,"replicas":1,"currentReplicas":1,"updatedReplicas":1,"currentRevision":"rabbitmq-cluster-server-5f8b8665fb","updateRevision":"rabbitmq-cluster-server-5f8b8665fb","collisionCount":0}}
2022/03/18 18:06:40 learn_server.go:256: [SIEVE-BEFORE-WRITE]	20
2022/03/18 18:06:40 learn_server.go:263: [SIEVE-AFTER-WRITE]	20	Update	statefulset	github.com/rabbitmq/cluster-operator/controllers.(*RabbitmqClusterReconciler)	NoError	{"metadata":{"name":"rabbitmq-cluster-server","namespace":"default","selfLink":"/apis/apps/v1/namespaces/default/statefulsets/rabbitmq-cluster-server","uid":"f2f07f3e-b500-4c48-a5de-8db7eaf37b9a","resourceVersion":"1129","generation":1,"creationTimestamp":"2022-03-18T18:06:25Z","labels":{"app.kubernetes.io/component":"rabbitmq","app.kubernetes.io/name":"rabbitmq-cluster","app.kubernetes.io/part-of":"rabbitmq"},"annotations":{"rabbitmq.com/createdAt":"2022-03-18T18:06:25Z"},"ownerReferences":[{"apiVersion":"rabbitmq.com/v1beta1","kind":"RabbitmqCluster","name":"rabbitmq-cluster","uid":"3ecefa8a-1bec-48a7-9af4-dd0df3339101","controller":true,"blockOwnerDeletion":true}],"managedFields":[{"manager":"kube-controller-manager","operation":"Update","apiVersion":"apps/v1","time":"2022-03-18T18:06:25Z","fieldsType":"FieldsV1","fieldsV1":{"f:status":{"f:collisionCount":{},"f:currentReplicas":{},"f:currentRevision":{},"f:observedGeneration":{},"f:replicas":{},"f:updateRevision":{},"f:updatedReplicas":{}}}},{"manager":"manager","operation":"Update","apiVersion":"apps/v1","time":"2022-03-18T18:06:25Z","fieldsType":"FieldsV1","fieldsV1":{"f:metadata":{"f:annotations":{".":{},"f:rabbitmq.com/createdAt":{}},"f:labels":{".":{},"f:app.kubernetes.io/component":{},"f:app.kubernetes.io/name":{},"f:app.kubernetes.io/part-of":{}},"f:ownerReferences":{".":{},"k:{\"uid\":\"3ecefa8a-1bec-48a7-9af4-dd0df3339101\"}":{".":{},"f:apiVersion":{},"f:blockOwnerDeletion":{},"f:controller":{},"f:kind":{},"f:name":{},"f:uid":{}}}},"f:spec":{"f:podManagementPolicy":{},"f:replicas":{},"f:revisionHistoryLimit":{},"f:selector":{"f:matchLabels":{".":{},"f:app.kubernetes.io/name":{}}},"f:serviceName":{},"f:template":{"f:metadata":{"f:annotations":{".":{},"f:prometheus.io/port":{},"f:prometheus.io/scrape":{}},"f:labels":{".":{},"f:app.kubernetes.io/component":{},"f:app.kubernetes.io/name":{},"f:app.kubernetes.io/part-of":{}}},"f:spec":{"f:automountServiceAccountToken":{},"f:containers":{"k:{\"name\":\"rabbitmq\"}":{".":{},"f:env":{".":{},"k:{\"name\":\"K8S_HOSTNAME_SUFFIX\"}":{".":{},"f:name":{},"f:value":{}},"k:{\"name\":\"K8S_SERVICE_NAME\"}":{".":{},"f:name":{},"f:value":{}},"k:{\"name\":\"MY_POD_NAME\"}":{".":{},"f:name":{},"f:valueFrom":{".":{},"f:fieldRef":{".":{},"f:apiVersion":{},"f:fieldPath":{}}}},"k:{\"name\":\"MY_POD_NAMESPACE\"}":{".":{},"f:name":{},"f:valueFrom":{".":{},"f:fieldRef":{".":{},"f:apiVersion":{},"f:fieldPath":{}}}},"k:{\"name\":\"RABBITMQ_ENABLED_PLUGINS_FILE\"}":{".":{},"f:name":{},"f:value":{}},"k:{\"name\":\"RABBITMQ_NODENAME\"}":{".":{},"f:name":{},"f:value":{}},"k:{\"name\":\"RABBITMQ_USE_LONGNAME\"}":{".":{},"f:name":{},"f:value":{}}},"f:image":{},"f:imagePullPolicy":{},"f:lifecycle":{".":{},"f:preStop":{".":{},"f:exec":{".":{},"f:command":{}}}},"f:name":{},"f:ports":{".":{},"k:{\"containerPort\":4369,\"protocol\":\"TCP\"}":{".":{},"f:containerPort":{},"f:name":{},"f:protocol":{}},"k:{\"containerPort\":5672,\"protocol\":\"TCP\"}":{".":{},"f:containerPort":{},"f:name":{},"f:protocol":{}},"k:{\"containerPort\":15672,\"protocol\":\"TCP\"}":{".":{},"f:containerPort":{},"f:name":{},"f:protocol":{}},"k:{\"containerPort\":15692,\"protocol\":\"TCP\"}":{".":{},"f:containerPort":{},"f:name":{},"f:protocol":{}}},"f:readinessProbe":{".":{},"f:failureThreshold":{},"f:initialDelaySeconds":{},"f:periodSeconds":{},"f:successThreshold":{},"f:tcpSocket":{".":{},"f:port":{}},"f:timeoutSeconds":{}},"f:resources":{".":{},"f:limits":{".":{},"f:cpu":{},"f:memory":{}},"f:requests":{".":{},"f:cpu":{},"f:memory":{}}},"f:terminationMessagePath":{},"f:terminationMessagePolicy":{},"f:volumeMounts":{".":{},"k:{\"mountPath\":\"/etc/pod-info/\"}":{".":{},"f:mountPath":{},"f:name":{}},"k:{\"mountPath\":\"/etc/rabbitmq/conf.d/10-operatorDefaults.conf\"}":{".":{},"f:mountPath":{},"f:name":{},"f:subPath":{}},"k:{\"mountPath\":\"/etc/rabbitmq/conf.d/11-default_user.conf\"}":{".":{},"f:mountPath":{},"f:name":{},"f:subPath":{}},"k:{\"mountPath\":\"/etc/rabbitmq/conf.d/90-userDefinedConfiguration.conf\"}":{".":{},"f:mountPath":{},"f:name":{},"f:subPath":{}},"k:{\"mountPath\":\"/operator\"}":{".":{},"f:mountPath":{},"f:name":{}},"k:{\"mountPath\":\"/var/lib/rabbitmq/\"}":{".":{},"f:mountPath":{},"f:name":{}},"k:{\"mountPath\":\"/var/lib/rabbitmq/mnesia/\"}":{".":{},"f:mountPath":{},"f:name":{}}}}},"f:dnsPolicy":{},"f:initContainers":{".":{},"k:{\"name\":\"setup-container\"}":{".":{},"f:command":{},"f:image":{},"f:imagePullPolicy":{},"f:name":{},"f:resources":{".":{},"f:limits":{".":{},"f:cpu":{},"f:memory":{}},"f:requests":{".":{},"f:cpu":{},"f:memory":{}}},"f:securityContext":{".":{},"f:capabilities":{".":{},"f:drop":{}},"f:runAsUser":{}},"f:terminationMessagePath":{},"f:terminationMessagePolicy":{},"f:volumeMounts":{".":{},"k:{\"mountPath\":\"/operator\"}":{".":{},"f:mountPath":{},"f:name":{}},"k:{\"mountPath\":\"/tmp/default_user.conf\"}":{".":{},"f:mountPath":{},"f:name":{},"f:subPath":{}},"k:{\"mountPath\":\"/tmp/erlang-cookie-secret/\"}":{".":{},"f:mountPath":{},"f:name":{}},"k:{\"mountPath\":\"/tmp/rabbitmq-plugins/\"}":{".":{},"f:mountPath":{},"f:name":{}},"k:{\"mountPath\":\"/var/lib/rabbitmq/\"}":{".":{},"f:mountPath":{},"f:name":{}},"k:{\"mountPath\":\"/var/lib/rabbitmq/mnesia/\"}":{".":{},"f:mountPath":{},"f:name":{}}}}},"f:restartPolicy":{},"f:schedulerName":{},"f:securityContext":{".":{},"f:fsGroup":{},"f:runAsGroup":{},"f:runAsUser":{}},"f:serviceAccount":{},"f:serviceAccountName":{},"f:terminationGracePeriodSeconds":{},"f:topologySpreadConstraints":{".":{},"k:{\"topologyKey\":\"topology.kubernetes.io/zone\",\"whenUnsatisfiable\":\"ScheduleAnyway\"}":{".":{},"f:labelSelector":{".":{},"f:matchLabels":{".":{},"f:app.kubernetes.io/name":{}}},"f:maxSkew":{},"f:topologyKey":{},"f:whenUnsatisfiable":{}}},"f:volumes":{".":{},"k:{\"name\":\"erlang-cookie-secret\"}":{".":{},"f:name":{},"f:secret":{".":{},"f:defaultMode":{},"f:secretName":{}}},"k:{\"name\":\"plugins-conf\"}":{".":{},"f:configMap":{".":{},"f:defaultMode":{},"f:name":{}},"f:name":{}},"k:{\"name\":\"pod-info\"}":{".":{},"f:downwardAPI":{".":{},"f:defaultMode":{},"f:items":{}},"f:name":{}},"k:{\"name\":\"rabbitmq-confd\"}":{".":{},"f:name":{},"f:projected":{".":{},"f:defaultMode":{},"f:sources":{}}},"k:{\"name\":\"rabbitmq-erlang-cookie\"}":{".":{},"f:emptyDir":{},"f:name":{}},"k:{\"name\":\"rabbitmq-plugins\"}":{".":{},"f:emptyDir":{},"f:name":{}}}}},"f:updateStrategy":{"f:rollingUpdate":{".":{},"f:partition":{}},"f:type":{}},"f:volumeClaimTemplates":{}}}}]},"spec":{"replicas":1,"selector":{"matchLabels":{"app.kubernetes.io/name":"rabbitmq-cluster"}},"template":{"metadata":{"creationTimestamp":null,"labels":{"app.kubernetes.io/component":"rabbitmq","app.kubernetes.io/name":"rabbitmq-cluster","app.kubernetes.io/part-of":"rabbitmq"},"annotations":{"prometheus.io/port":"15692","prometheus.io/scrape":"true"}},"spec":{"volumes":[{"name":"plugins-conf","configMap":{"name":"rabbitmq-cluster-plugins-conf","defaultMode":420}},{"name":"rabbitmq-confd","projected":{"sources":[{"secret":{"name":"rabbitmq-cluster-default-user","items":[{"key":"default_user.conf","path":"default_user.conf"}]}},{"configMap":{"name":"rabbitmq-cluster-server-conf","items":[{"key":"operatorDefaults.conf","path":"operatorDefaults.conf"},{"key":"userDefinedConfiguration.conf","path":"userDefinedConfiguration.conf"}]}}],"defaultMode":420}},{"name":"rabbitmq-erlang-cookie","emptyDir":{}},{"name":"erlang-cookie-secret","secret":{"secretName":"rabbitmq-cluster-erlang-cookie","defaultMode":420}},{"name":"rabbitmq-plugins","emptyDir":{}},{"name":"pod-info","downwardAPI":{"items":[{"path":"skipPreStopChecks","fieldRef":{"apiVersion":"v1","fieldPath":"metadata.labels['skipPreStopChecks']"}}],"defaultMode":420}}],"initContainers":[{"name":"setup-container","image":"rabbitmq:3.8.12-management","command":["sh","-c","cp /tmp/erlang-cookie-secret/.erlang.cookie /var/lib/rabbitmq/.erlang.cookie \u0026\u0026 chown 999:999 /var/lib/rabbitmq/.erlang.cookie \u0026\u0026 chmod 600 /var/lib/rabbitmq/.erlang.cookie ; cp /tmp/rabbitmq-plugins/enabled_plugins /operator/enabled_plugins \u0026\u0026 chown 999:999 /operator/enabled_plugins ; chown 999:999 /var/lib/rabbitmq/mnesia/ ; echo '[default]' \u003e /var/lib/rabbitmq/.rabbitmqadmin.conf \u0026\u0026 sed -e 's/default_user/username/' -e 's/default_pass/password/' /tmp/default_user.conf \u003e\u003e /var/lib/rabbitmq/.rabbitmqadmin.conf \u0026\u0026 chown 999:999 /var/lib/rabbitmq/.rabbitmqadmin.conf \u0026\u0026 chmod 600 /var/lib/rabbitmq/.rabbitmqadmin.conf"],"resources":{"limits":{"cpu":"100m","memory":"500Mi"},"requests":{"cpu":"100m","memory":"500Mi"}},"volumeMounts":[{"name":"plugins-conf","mountPath":"/tmp/rabbitmq-plugins/"},{"name":"rabbitmq-erlang-cookie","mountPath":"/var/lib/rabbitmq/"},{"name":"erlang-cookie-secret","mountPath":"/tmp/erlang-cookie-secret/"},{"name":"rabbitmq-plugins","mountPath":"/operator"},{"name":"persistence","mountPath":"/var/lib/rabbitmq/mnesia/"},{"name":"rabbitmq-confd","mountPath":"/tmp/default_user.conf","subPath":"default_user.conf"}],"terminationMessagePath":"/dev/termination-log","terminationMessagePolicy":"File","imagePullPolicy":"IfNotPresent","securityContext":{"capabilities":{"drop":["FSETID","KILL","SETGID","SETUID","SETPCAP","NET_BIND_SERVICE","NET_RAW","SYS_CHROOT","MKNOD","AUDIT_WRITE","SETFCAP"]},"runAsUser":0}}],"containers":[{"name":"rabbitmq","image":"rabbitmq:3.8.12-management","ports":[{"name":"epmd","containerPort":4369,"protocol":"TCP"},{"name":"amqp","containerPort":5672,"protocol":"TCP"},{"name":"management","containerPort":15672,"protocol":"TCP"},{"name":"prometheus","containerPort":15692,"protocol":"TCP"}],"env":[{"name":"MY_POD_NAME","valueFrom":{"fieldRef":{"apiVersion":"v1","fieldPath":"metadata.name"}}},{"name":"MY_POD_NAMESPACE","valueFrom":{"fieldRef":{"apiVersion":"v1","fieldPath":"metadata.namespace"}}},{"name":"RABBITMQ_ENABLED_PLUGINS_FILE","value":"/operator/enabled_plugins"},{"name":"K8S_SERVICE_NAME","value":"rabbitmq-cluster-nodes"},{"name":"RABBITMQ_USE_LONGNAME","value":"true"},{"name":"RABBITMQ_NODENAME","value":"rabbit@$(MY_POD_NAME).$(K8S_SERVICE_NAME).$(MY_POD_NAMESPACE)"},{"name":"K8S_HOSTNAME_SUFFIX","value":".$(K8S_SERVICE_NAME).$(MY_POD_NAMESPACE)"}],"resources":{"limits":{"cpu":"2","memory":"2Gi"},"requests":{"cpu":"1","memory":"2Gi"}},"volumeMounts":[{"name":"rabbitmq-erlang-cookie","mountPath":"/var/lib/rabbitmq/"},{"name":"persistence","mountPath":"/var/lib/rabbitmq/mnesia/"},{"name":"rabbitmq-plugins","mountPath":"/operator"},{"name":"rabbitmq-confd","mountPath":"/etc/rabbitmq/conf.d/10-operatorDefaults.conf","subPath":"operatorDefaults.conf"},{"name":"rabbitmq-confd","mountPath":"/etc/rabbitmq/conf.d/11-default_user.conf","subPath":"default_user.conf"},{"name":"rabbitmq-confd","mountPath":"/etc/rabbitmq/conf.d/90-userDefinedConfiguration.conf","subPath":"userDefinedConfiguration.conf"},{"name":"pod-info","mountPath":"/etc/pod-info/"}],"readinessProbe":{"tcpSocket":{"port":"amqp"},"initialDelaySeconds":10,"timeoutSeconds":5,"periodSeconds":10,"successThreshold":1,"failureThreshold":3},"lifecycle":{"preStop":{"exec":{"command":["/bin/bash","-c","if [ ! -z \"$(cat /etc/pod-info/skipPreStopChecks)\" ]; then exit 0; fi; rabbitmq-upgrade await_online_quorum_plus_one -t 604800; rabbitmq-upgrade await_online_synchronized_mirror -t 604800; rabbitmq-upgrade drain -t 604800"]}}},"terminationMessagePath":"/dev/termination-log","terminationMessagePolicy":"File","imagePullPolicy":"IfNotPresent"}],"restartPolicy":"Always","terminationGracePeriodSeconds":604800,"dnsPolicy":"ClusterFirst","serviceAccountName":"rabbitmq-cluster-server","serviceAccount":"rabbitmq-cluster-server","automountServiceAccountToken":true,"securityContext":{"runAsUser":999,"runAsGroup":999,"fsGroup":999},"schedulerName":"default-scheduler","topologySpreadConstraints":[{"maxSkew":1,"topologyKey":"topology.kubernetes.io/zone","whenUnsatisfiable":"ScheduleAnyway","labelSelector":{"matchLabels":{"app.kubernetes.io/name":"rabbitmq-cluster"}}}]}},"volumeClaimTemplates":[{"metadata":{"name":"persistence","namespace":"default","creationTimestamp":null,"labels":{"app.kubernetes.io/component":"rabbitmq","app.kubernetes.io/name":"rabbitmq-cluster","app.kubernetes.io/part-of":"rabbitmq"},"ownerReferences":[{"apiVersion":"rabbitmq.com/v1beta1","kind":"RabbitmqCluster","name":"rabbitmq-cluster","uid":"3ecefa8a-1bec-48a7-9af4-dd0df3339101","controller":true,"blockOwnerDeletion":false}]},"spec":{"accessModes":["ReadWriteOnce"],"resources":{"requests":{"storage":"10Gi"}},"volumeMode":"Filesystem"},"status":{"phase":"Pending"}}],"serviceName":"rabbitmq-cluster-nodes","podManagementPolicy":"Parallel","updateStrategy":{"type":"RollingUpdate","rollingUpdate":{"partition":0}},"revisionHistoryLimit":10},"status":{"observedGeneration":1,"replicas":1,"currentReplicas":1,"updatedReplicas":1,"currentRevision":"rabbitmq-cluster-server-5f8b8665fb","updateRevision":"rabbitmq-cluster-server-5f8b8665fb","collisionCount":0}}
2022/03/18 18:06:40 learn_server.go:291: [SIEVE-AFTER-READ]	Get	true	configmap	default	rabbitmq-cluster-server-conf	github.com/rabbitmq/cluster-operator/controllers.(*RabbitmqClusterReconciler)	NoError	{"kind":"ConfigMap","apiVersion":"v1","metadata":{"name":"rabbitmq-cluster-server-conf","namespace":"default","selfLink":"/api/v1/namespaces/default/configmaps/rabbitmq-cluster-server-conf","uid":"e4182078-d429-4baf-9021-72618c509ac5","resourceVersion":"1095","creationTimestamp":"2022-03-18T18:06:25Z","labels":{"app.kubernetes.io/component":"rabbitmq","app.kubernetes.io/name":"rabbitmq-cluster","app.kubernetes.io/part-of":"rabbitmq"},"ownerReferences":[{"apiVersion":"rabbitmq.com/v1beta1","kind":"RabbitmqCluster","name":"rabbitmq-cluster","uid":"3ecefa8a-1bec-48a7-9af4-dd0df3339101","controller":true,"blockOwnerDeletion":true}],"managedFields":[{"manager":"manager","operation":"Update","apiVersion":"v1","time":"2022-03-18T18:06:25Z","fieldsType":"FieldsV1","fieldsV1":{"f:data":{".":{},"f:operatorDefaults.conf":{},"f:userDefinedConfiguration.conf":{}},"f:metadata":{"f:labels":{".":{},"f:app.kubernetes.io/component":{},"f:app.kubernetes.io/name":{},"f:app.kubernetes.io/part-of":{}},"f:ownerReferences":{".":{},"k:{\"uid\":\"3ecefa8a-1bec-48a7-9af4-dd0df3339101\"}":{".":{},"f:apiVersion":{},"f:blockOwnerDeletion":{},"f:controller":{},"f:kind":{},"f:name":{},"f:uid":{}}}}}}]},"data":{"operatorDefaults.conf":"cluster_formation.peer_discovery_backend             = rabbit_peer_discovery_k8s\ncluster_formation.k8s.host                           = kubernetes.default\ncluster_formation.k8s.address_type                   = hostname\ncluster_partition_handling                           = pause_minority\nqueue_master_locator                                 = min-masters\ndisk_free_limit.absolute                             = 2GB\ncluster_formation.randomized_startup_delay_range.min = 5\ncluster_formation.randomized_startup_delay_range.max = 30\ncluster_name                                         = rabbitmq-cluster\n","userDefinedConfiguration.conf":"total_memory_available_override_value = 1717986919\n"}}
2022/03/18 18:06:40 learn_server.go:256: [SIEVE-BEFORE-WRITE]	21
2022/03/18 18:06:40 learn_server.go:263: [SIEVE-AFTER-WRITE]	21	StatusUpdate	rabbitmqcluster	github.com/rabbitmq/cluster-operator/controllers.(*RabbitmqClusterReconciler)	NoError	{"metadata":{"name":"rabbitmq-cluster","namespace":"default","selfLink":"/apis/rabbitmq.com/v1beta1/namespaces/default/rabbitmqclusters/rabbitmq-cluster/status","uid":"3ecefa8a-1bec-48a7-9af4-dd0df3339101","resourceVersion":"1132","generation":2,"creationTimestamp":"2022-03-18T18:06:25Z","annotations":{"kubectl.kubernetes.io/last-applied-configuration":"{\"apiVersion\":\"rabbitmq.com/v1beta1\",\"kind\":\"RabbitmqCluster\",\"metadata\":{\"annotations\":{},\"name\":\"rabbitmq-cluster\",\"namespace\":\"default\"},\"spec\":{\"persistence\":{\"storage\":\"10Gi\"},\"replicas\":1}}\n"},"finalizers":["deletion.finalizers.rabbitmqclusters.rabbitmq.com"],"managedFields":[{"manager":"kubectl-client-side-apply","operation":"Update","apiVersion":"rabbitmq.com/v1beta1","time":"2022-03-18T18:06:25Z","fieldsType":"FieldsV1","fieldsV1":{"f:metadata":{"f:annotations":{".":{},"f:kubectl.kubernetes.io/last-applied-configuration":{}}},"f:spec":{".":{},"f:image":{},"f:persistence":{".":{},"f:storage":{}},"f:replicas":{},"f:resources":{".":{},"f:limits":{".":{},"f:memory":{}},"f:requests":{".":{},"f:memory":{}}},"f:service":{".":{},"f:type":{}},"f:terminationGracePeriodSeconds":{}}}},{"manager":"manager","operation":"Update","apiVersion":"rabbitmq.com/v1beta1","time":"2022-03-18T18:06:25Z","fieldsType":"FieldsV1","fieldsV1":{"f:metadata":{"f:finalizers":{}},"f:spec":{"f:override":{},"f:rabbitmq":{},"f:resources":{"f:limits":{"f:cpu":{}},"f:requests":{"f:cpu":{}}},"f:tls":{}},"f:status":{".":{},"f:conditions":{},"f:defaultUser":{".":{},"f:secretReference":{".":{},"f:keys":{".":{},"f:password":{},"f:username":{}},"f:name":{},"f:namespace":{}},"f:serviceReference":{".":{},"f:name":{},"f:namespace":{}}}}}}]},"spec":{"replicas":1,"image":"rabbitmq:3.8.12-management","service":{"type":"ClusterIP"},"persistence":{"storage":"10Gi"},"resources":{"limits":{"cpu":"2","memory":"2Gi"},"requests":{"cpu":"1","memory":"2Gi"}},"rabbitmq":{},"tls":{},"override":{},"terminationGracePeriodSeconds":604800},"status":{"conditions":[{"type":"AllReplicasReady","status":"False","lastTransitionTime":"2022-03-18T18:06:25Z","reason":"NotAllPodsReady","message":"0/1 Pods ready"},{"type":"ClusterAvailable","status":"False","lastTransitionTime":"2022-03-18T18:06:25Z","reason":"NoEndpointsAvailable","message":"The service has no endpoints available"},{"type":"NoWarnings","status":"True","lastTransitionTime":"2022-03-18T18:06:25Z","reason":"NoWarnings"},{"type":"ReconcileSuccess","status":"Unknown","lastTransitionTime":"2022-03-18T18:06:25Z","reason":"Initialising"}],"defaultUser":{"secretReference":{"name":"rabbitmq-cluster-default-user","namespace":"default","keys":{"password":"password","username":"username"}},"serviceReference":{"name":"rabbitmq-cluster","namespace":"default"}},"binding":{"name":"rabbitmq-cluster-default-user"}}}
2022/03/18 18:06:40 learn_server.go:291: [SIEVE-AFTER-READ]	Get	true	statefulset	default	rabbitmq-cluster-server	github.com/rabbitmq/cluster-operator/controllers.(*RabbitmqClusterReconciler)	NoError	{"kind":"StatefulSet","apiVersion":"apps/v1","metadata":{"name":"rabbitmq-cluster-server","namespace":"default","selfLink":"/apis/apps/v1/namespaces/default/statefulsets/rabbitmq-cluster-server","uid":"f2f07f3e-b500-4c48-a5de-8db7eaf37b9a","resourceVersion":"1129","generation":1,"creationTimestamp":"2022-03-18T18:06:25Z","labels":{"app.kubernetes.io/component":"rabbitmq","app.kubernetes.io/name":"rabbitmq-cluster","app.kubernetes.io/part-of":"rabbitmq"},"annotations":{"rabbitmq.com/createdAt":"2022-03-18T18:06:25Z"},"ownerReferences":[{"apiVersion":"rabbitmq.com/v1beta1","kind":"RabbitmqCluster","name":"rabbitmq-cluster","uid":"3ecefa8a-1bec-48a7-9af4-dd0df3339101","controller":true,"blockOwnerDeletion":true}],"managedFields":[{"manager":"kube-controller-manager","operation":"Update","apiVersion":"apps/v1","time":"2022-03-18T18:06:25Z","fieldsType":"FieldsV1","fieldsV1":{"f:status":{"f:collisionCount":{},"f:currentReplicas":{},"f:currentRevision":{},"f:observedGeneration":{},"f:replicas":{},"f:updateRevision":{},"f:updatedReplicas":{}}}},{"manager":"manager","operation":"Update","apiVersion":"apps/v1","time":"2022-03-18T18:06:25Z","fieldsType":"FieldsV1","fieldsV1":{"f:metadata":{"f:annotations":{".":{},"f:rabbitmq.com/createdAt":{}},"f:labels":{".":{},"f:app.kubernetes.io/component":{},"f:app.kubernetes.io/name":{},"f:app.kubernetes.io/part-of":{}},"f:ownerReferences":{".":{},"k:{\"uid\":\"3ecefa8a-1bec-48a7-9af4-dd0df3339101\"}":{".":{},"f:apiVersion":{},"f:blockOwnerDeletion":{},"f:controller":{},"f:kind":{},"f:name":{},"f:uid":{}}}},"f:spec":{"f:podManagementPolicy":{},"f:replicas":{},"f:revisionHistoryLimit":{},"f:selector":{"f:matchLabels":{".":{},"f:app.kubernetes.io/name":{}}},"f:serviceName":{},"f:template":{"f:metadata":{"f:annotations":{".":{},"f:prometheus.io/port":{},"f:prometheus.io/scrape":{}},"f:labels":{".":{},"f:app.kubernetes.io/component":{},"f:app.kubernetes.io/name":{},"f:app.kubernetes.io/part-of":{}}},"f:spec":{"f:automountServiceAccountToken":{},"f:containers":{"k:{\"name\":\"rabbitmq\"}":{".":{},"f:env":{".":{},"k:{\"name\":\"K8S_HOSTNAME_SUFFIX\"}":{".":{},"f:name":{},"f:value":{}},"k:{\"name\":\"K8S_SERVICE_NAME\"}":{".":{},"f:name":{},"f:value":{}},"k:{\"name\":\"MY_POD_NAME\"}":{".":{},"f:name":{},"f:valueFrom":{".":{},"f:fieldRef":{".":{},"f:apiVersion":{},"f:fieldPath":{}}}},"k:{\"name\":\"MY_POD_NAMESPACE\"}":{".":{},"f:name":{},"f:valueFrom":{".":{},"f:fieldRef":{".":{},"f:apiVersion":{},"f:fieldPath":{}}}},"k:{\"name\":\"RABBITMQ_ENABLED_PLUGINS_FILE\"}":{".":{},"f:name":{},"f:value":{}},"k:{\"name\":\"RABBITMQ_NODENAME\"}":{".":{},"f:name":{},"f:value":{}},"k:{\"name\":\"RABBITMQ_USE_LONGNAME\"}":{".":{},"f:name":{},"f:value":{}}},"f:image":{},"f:imagePullPolicy":{},"f:lifecycle":{".":{},"f:preStop":{".":{},"f:exec":{".":{},"f:command":{}}}},"f:name":{},"f:ports":{".":{},"k:{\"containerPort\":4369,\"protocol\":\"TCP\"}":{".":{},"f:containerPort":{},"f:name":{},"f:protocol":{}},"k:{\"containerPort\":5672,\"protocol\":\"TCP\"}":{".":{},"f:containerPort":{},"f:name":{},"f:protocol":{}},"k:{\"containerPort\":15672,\"protocol\":\"TCP\"}":{".":{},"f:containerPort":{},"f:name":{},"f:protocol":{}},"k:{\"containerPort\":15692,\"protocol\":\"TCP\"}":{".":{},"f:containerPort":{},"f:name":{},"f:protocol":{}}},"f:readinessProbe":{".":{},"f:failureThreshold":{},"f:initialDelaySeconds":{},"f:periodSeconds":{},"f:successThreshold":{},"f:tcpSocket":{".":{},"f:port":{}},"f:timeoutSeconds":{}},"f:resources":{".":{},"f:limits":{".":{},"f:cpu":{},"f:memory":{}},"f:requests":{".":{},"f:cpu":{},"f:memory":{}}},"f:terminationMessagePath":{},"f:terminationMessagePolicy":{},"f:volumeMounts":{".":{},"k:{\"mountPath\":\"/etc/pod-info/\"}":{".":{},"f:mountPath":{},"f:name":{}},"k:{\"mountPath\":\"/etc/rabbitmq/conf.d/10-operatorDefaults.conf\"}":{".":{},"f:mountPath":{},"f:name":{},"f:subPath":{}},"k:{\"mountPath\":\"/etc/rabbitmq/conf.d/11-default_user.conf\"}":{".":{},"f:mountPath":{},"f:name":{},"f:subPath":{}},"k:{\"mountPath\":\"/etc/rabbitmq/conf.d/90-userDefinedConfiguration.conf\"}":{".":{},"f:mountPath":{},"f:name":{},"f:subPath":{}},"k:{\"mountPath\":\"/operator\"}":{".":{},"f:mountPath":{},"f:name":{}},"k:{\"mountPath\":\"/var/lib/rabbitmq/\"}":{".":{},"f:mountPath":{},"f:name":{}},"k:{\"mountPath\":\"/var/lib/rabbitmq/mnesia/\"}":{".":{},"f:mountPath":{},"f:name":{}}}}},"f:dnsPolicy":{},"f:initContainers":{".":{},"k:{\"name\":\"setup-container\"}":{".":{},"f:command":{},"f:image":{},"f:imagePullPolicy":{},"f:name":{},"f:resources":{".":{},"f:limits":{".":{},"f:cpu":{},"f:memory":{}},"f:requests":{".":{},"f:cpu":{},"f:memory":{}}},"f:securityContext":{".":{},"f:capabilities":{".":{},"f:drop":{}},"f:runAsUser":{}},"f:terminationMessagePath":{},"f:terminationMessagePolicy":{},"f:volumeMounts":{".":{},"k:{\"mountPath\":\"/operator\"}":{".":{},"f:mountPath":{},"f:name":{}},"k:{\"mountPath\":\"/tmp/default_user.conf\"}":{".":{},"f:mountPath":{},"f:name":{},"f:subPath":{}},"k:{\"mountPath\":\"/tmp/erlang-cookie-secret/\"}":{".":{},"f:mountPath":{},"f:name":{}},"k:{\"mountPath\":\"/tmp/rabbitmq-plugins/\"}":{".":{},"f:mountPath":{},"f:name":{}},"k:{\"mountPath\":\"/var/lib/rabbitmq/\"}":{".":{},"f:mountPath":{},"f:name":{}},"k:{\"mountPath\":\"/var/lib/rabbitmq/mnesia/\"}":{".":{},"f:mountPath":{},"f:name":{}}}}},"f:restartPolicy":{},"f:schedulerName":{},"f:securityContext":{".":{},"f:fsGroup":{},"f:runAsGroup":{},"f:runAsUser":{}},"f:serviceAccount":{},"f:serviceAccountName":{},"f:terminationGracePeriodSeconds":{},"f:topologySpreadConstraints":{".":{},"k:{\"topologyKey\":\"topology.kubernetes.io/zone\",\"whenUnsatisfiable\":\"ScheduleAnyway\"}":{".":{},"f:labelSelector":{".":{},"f:matchLabels":{".":{},"f:app.kubernetes.io/name":{}}},"f:maxSkew":{},"f:topologyKey":{},"f:whenUnsatisfiable":{}}},"f:volumes":{".":{},"k:{\"name\":\"erlang-cookie-secret\"}":{".":{},"f:name":{},"f:secret":{".":{},"f:defaultMode":{},"f:secretName":{}}},"k:{\"name\":\"plugins-conf\"}":{".":{},"f:configMap":{".":{},"f:defaultMode":{},"f:name":{}},"f:name":{}},"k:{\"name\":\"pod-info\"}":{".":{},"f:downwardAPI":{".":{},"f:defaultMode":{},"f:items":{}},"f:name":{}},"k:{\"name\":\"rabbitmq-confd\"}":{".":{},"f:name":{},"f:projected":{".":{},"f:defaultMode":{},"f:sources":{}}},"k:{\"name\":\"rabbitmq-erlang-cookie\"}":{".":{},"f:emptyDir":{},"f:name":{}},"k:{\"name\":\"rabbitmq-plugins\"}":{".":{},"f:emptyDir":{},"f:name":{}}}}},"f:updateStrategy":{"f:rollingUpdate":{".":{},"f:partition":{}},"f:type":{}},"f:volumeClaimTemplates":{}}}}]},"spec":{"replicas":1,"selector":{"matchLabels":{"app.kubernetes.io/name":"rabbitmq-cluster"}},"template":{"metadata":{"creationTimestamp":null,"labels":{"app.kubernetes.io/component":"rabbitmq","app.kubernetes.io/name":"rabbitmq-cluster","app.kubernetes.io/part-of":"rabbitmq"},"annotations":{"prometheus.io/port":"15692","prometheus.io/scrape":"true"}},"spec":{"volumes":[{"name":"plugins-conf","configMap":{"name":"rabbitmq-cluster-plugins-conf","defaultMode":420}},{"name":"rabbitmq-confd","projected":{"sources":[{"secret":{"name":"rabbitmq-cluster-default-user","items":[{"key":"default_user.conf","path":"default_user.conf"}]}},{"configMap":{"name":"rabbitmq-cluster-server-conf","items":[{"key":"operatorDefaults.conf","path":"operatorDefaults.conf"},{"key":"userDefinedConfiguration.conf","path":"userDefinedConfiguration.conf"}]}}],"defaultMode":420}},{"name":"rabbitmq-erlang-cookie","emptyDir":{}},{"name":"erlang-cookie-secret","secret":{"secretName":"rabbitmq-cluster-erlang-cookie","defaultMode":420}},{"name":"rabbitmq-plugins","emptyDir":{}},{"name":"pod-info","downwardAPI":{"items":[{"path":"skipPreStopChecks","fieldRef":{"apiVersion":"v1","fieldPath":"metadata.labels['skipPreStopChecks']"}}],"defaultMode":420}}],"initContainers":[{"name":"setup-container","image":"rabbitmq:3.8.12-management","command":["sh","-c","cp /tmp/erlang-cookie-secret/.erlang.cookie /var/lib/rabbitmq/.erlang.cookie \u0026\u0026 chown 999:999 /var/lib/rabbitmq/.erlang.cookie \u0026\u0026 chmod 600 /var/lib/rabbitmq/.erlang.cookie ; cp /tmp/rabbitmq-plugins/enabled_plugins /operator/enabled_plugins \u0026\u0026 chown 999:999 /operator/enabled_plugins ; chown 999:999 /var/lib/rabbitmq/mnesia/ ; echo '[default]' \u003e /var/lib/rabbitmq/.rabbitmqadmin.conf \u0026\u0026 sed -e 's/default_user/username/' -e 's/default_pass/password/' /tmp/default_user.conf \u003e\u003e /var/lib/rabbitmq/.rabbitmqadmin.conf \u0026\u0026 chown 999:999 /var/lib/rabbitmq/.rabbitmqadmin.conf \u0026\u0026 chmod 600 /var/lib/rabbitmq/.rabbitmqadmin.conf"],"resources":{"limits":{"cpu":"100m","memory":"500Mi"},"requests":{"cpu":"100m","memory":"500Mi"}},"volumeMounts":[{"name":"plugins-conf","mountPath":"/tmp/rabbitmq-plugins/"},{"name":"rabbitmq-erlang-cookie","mountPath":"/var/lib/rabbitmq/"},{"name":"erlang-cookie-secret","mountPath":"/tmp/erlang-cookie-secret/"},{"name":"rabbitmq-plugins","mountPath":"/operator"},{"name":"persistence","mountPath":"/var/lib/rabbitmq/mnesia/"},{"name":"rabbitmq-confd","mountPath":"/tmp/default_user.conf","subPath":"default_user.conf"}],"terminationMessagePath":"/dev/termination-log","terminationMessagePolicy":"File","imagePullPolicy":"IfNotPresent","securityContext":{"capabilities":{"drop":["FSETID","KILL","SETGID","SETUID","SETPCAP","NET_BIND_SERVICE","NET_RAW","SYS_CHROOT","MKNOD","AUDIT_WRITE","SETFCAP"]},"runAsUser":0}}],"containers":[{"name":"rabbitmq","image":"rabbitmq:3.8.12-management","ports":[{"name":"epmd","containerPort":4369,"protocol":"TCP"},{"name":"amqp","containerPort":5672,"protocol":"TCP"},{"name":"management","containerPort":15672,"protocol":"TCP"},{"name":"prometheus","containerPort":15692,"protocol":"TCP"}],"env":[{"name":"MY_POD_NAME","valueFrom":{"fieldRef":{"apiVersion":"v1","fieldPath":"metadata.name"}}},{"name":"MY_POD_NAMESPACE","valueFrom":{"fieldRef":{"apiVersion":"v1","fieldPath":"metadata.namespace"}}},{"name":"RABBITMQ_ENABLED_PLUGINS_FILE","value":"/operator/enabled_plugins"},{"name":"K8S_SERVICE_NAME","value":"rabbitmq-cluster-nodes"},{"name":"RABBITMQ_USE_LONGNAME","value":"true"},{"name":"RABBITMQ_NODENAME","value":"rabbit@$(MY_POD_NAME).$(K8S_SERVICE_NAME).$(MY_POD_NAMESPACE)"},{"name":"K8S_HOSTNAME_SUFFIX","value":".$(K8S_SERVICE_NAME).$(MY_POD_NAMESPACE)"}],"resources":{"limits":{"cpu":"2","memory":"2Gi"},"requests":{"cpu":"1","memory":"2Gi"}},"volumeMounts":[{"name":"rabbitmq-erlang-cookie","mountPath":"/var/lib/rabbitmq/"},{"name":"persistence","mountPath":"/var/lib/rabbitmq/mnesia/"},{"name":"rabbitmq-plugins","mountPath":"/operator"},{"name":"rabbitmq-confd","mountPath":"/etc/rabbitmq/conf.d/10-operatorDefaults.conf","subPath":"operatorDefaults.conf"},{"name":"rabbitmq-confd","mountPath":"/etc/rabbitmq/conf.d/11-default_user.conf","subPath":"default_user.conf"},{"name":"rabbitmq-confd","mountPath":"/etc/rabbitmq/conf.d/90-userDefinedConfiguration.conf","subPath":"userDefinedConfiguration.conf"},{"name":"pod-info","mountPath":"/etc/pod-info/"}],"readinessProbe":{"tcpSocket":{"port":"amqp"},"initialDelaySeconds":10,"timeoutSeconds":5,"periodSeconds":10,"successThreshold":1,"failureThreshold":3},"lifecycle":{"preStop":{"exec":{"command":["/bin/bash","-c","if [ ! -z \"$(cat /etc/pod-info/skipPreStopChecks)\" ]; then exit 0; fi; rabbitmq-upgrade await_online_quorum_plus_one -t 604800; rabbitmq-upgrade await_online_synchronized_mirror -t 604800; rabbitmq-upgrade drain -t 604800"]}}},"terminationMessagePath":"/dev/termination-log","terminationMessagePolicy":"File","imagePullPolicy":"IfNotPresent"}],"restartPolicy":"Always","terminationGracePeriodSeconds":604800,"dnsPolicy":"ClusterFirst","serviceAccountName":"rabbitmq-cluster-server","serviceAccount":"rabbitmq-cluster-server","automountServiceAccountToken":true,"securityContext":{"runAsUser":999,"runAsGroup":999,"fsGroup":999},"schedulerName":"default-scheduler","topologySpreadConstraints":[{"maxSkew":1,"topologyKey":"topology.kubernetes.io/zone","whenUnsatisfiable":"ScheduleAnyway","labelSelector":{"matchLabels":{"app.kubernetes.io/name":"rabbitmq-cluster"}}}]}},"volumeClaimTemplates":[{"metadata":{"name":"persistence","namespace":"default","creationTimestamp":null,"labels":{"app.kubernetes.io/component":"rabbitmq","app.kubernetes.io/name":"rabbitmq-cluster","app.kubernetes.io/part-of":"rabbitmq"},"ownerReferences":[{"apiVersion":"rabbitmq.com/v1beta1","kind":"RabbitmqCluster","name":"rabbitmq-cluster","uid":"3ecefa8a-1bec-48a7-9af4-dd0df3339101","controller":true,"blockOwnerDeletion":false}]},"spec":{"accessModes":["ReadWriteOnce"],"resources":{"requests":{"storage":"10Gi"}},"volumeMode":"Filesystem"},"status":{"phase":"Pending"}}],"serviceName":"rabbitmq-cluster-nodes","podManagementPolicy":"Parallel","updateStrategy":{"type":"RollingUpdate","rollingUpdate":{"partition":0}},"revisionHistoryLimit":10},"status":{"observedGeneration":1,"replicas":1,"currentReplicas":1,"updatedReplicas":1,"currentRevision":"rabbitmq-cluster-server-5f8b8665fb","updateRevision":"rabbitmq-cluster-server-5f8b8665fb","collisionCount":0}}
2022/03/18 18:06:40 learn_server.go:253: [SIEVE-AFTER-RECONCILE]	github.com/rabbitmq/cluster-operator/controllers.(*RabbitmqClusterReconciler)	3
2022/03/18 18:06:55 learn_server.go:238: [SIEVE-BEFORE-RECONCILE]	github.com/rabbitmq/cluster-operator/controllers.(*RabbitmqClusterReconciler)	4
2022/03/18 18:06:55 learn_server.go:291: [SIEVE-AFTER-READ]	Get	true	rabbitmqcluster	default	rabbitmq-cluster	github.com/rabbitmq/cluster-operator/controllers.(*RabbitmqClusterReconciler)	NoError	{"kind":"RabbitmqCluster","apiVersion":"rabbitmq.com/v1beta1","metadata":{"name":"rabbitmq-cluster","namespace":"default","selfLink":"/apis/rabbitmq.com/v1beta1/namespaces/default/rabbitmqclusters/rabbitmq-cluster","uid":"3ecefa8a-1bec-48a7-9af4-dd0df3339101","resourceVersion":"1132","generation":2,"creationTimestamp":"2022-03-18T18:06:25Z","annotations":{"kubectl.kubernetes.io/last-applied-configuration":"{\"apiVersion\":\"rabbitmq.com/v1beta1\",\"kind\":\"RabbitmqCluster\",\"metadata\":{\"annotations\":{},\"name\":\"rabbitmq-cluster\",\"namespace\":\"default\"},\"spec\":{\"persistence\":{\"storage\":\"10Gi\"},\"replicas\":1}}\n"},"finalizers":["deletion.finalizers.rabbitmqclusters.rabbitmq.com"],"managedFields":[{"manager":"kubectl-client-side-apply","operation":"Update","apiVersion":"rabbitmq.com/v1beta1","time":"2022-03-18T18:06:25Z","fieldsType":"FieldsV1","fieldsV1":{"f:metadata":{"f:annotations":{".":{},"f:kubectl.kubernetes.io/last-applied-configuration":{}}},"f:spec":{".":{},"f:image":{},"f:persistence":{".":{},"f:storage":{}},"f:replicas":{},"f:resources":{".":{},"f:limits":{".":{},"f:memory":{}},"f:requests":{".":{},"f:memory":{}}},"f:service":{".":{},"f:type":{}},"f:terminationGracePeriodSeconds":{}}}},{"manager":"manager","operation":"Update","apiVersion":"rabbitmq.com/v1beta1","time":"2022-03-18T18:06:25Z","fieldsType":"FieldsV1","fieldsV1":{"f:metadata":{"f:finalizers":{}},"f:spec":{"f:override":{},"f:rabbitmq":{},"f:resources":{"f:limits":{"f:cpu":{}},"f:requests":{"f:cpu":{}}},"f:tls":{}},"f:status":{".":{},"f:conditions":{},"f:defaultUser":{".":{},"f:secretReference":{".":{},"f:keys":{".":{},"f:password":{},"f:username":{}},"f:name":{},"f:namespace":{}},"f:serviceReference":{".":{},"f:name":{},"f:namespace":{}}}}}}]},"spec":{"replicas":1,"image":"rabbitmq:3.8.12-management","service":{"type":"ClusterIP"},"persistence":{"storage":"10Gi"},"resources":{"limits":{"cpu":"2","memory":"2Gi"},"requests":{"cpu":"1","memory":"2Gi"}},"rabbitmq":{},"tls":{},"override":{},"terminationGracePeriodSeconds":604800},"status":{"conditions":[{"type":"AllReplicasReady","status":"False","lastTransitionTime":"2022-03-18T18:06:25Z","reason":"NotAllPodsReady","message":"0/1 Pods ready"},{"type":"ClusterAvailable","status":"False","lastTransitionTime":"2022-03-18T18:06:25Z","reason":"NoEndpointsAvailable","message":"The service has no endpoints available"},{"type":"NoWarnings","status":"True","lastTransitionTime":"2022-03-18T18:06:25Z","reason":"NoWarnings"},{"type":"ReconcileSuccess","status":"Unknown","lastTransitionTime":"2022-03-18T18:06:25Z","reason":"Initialising"}],"defaultUser":{"secretReference":{"name":"rabbitmq-cluster-default-user","namespace":"default","keys":{"password":"password","username":"username"}},"serviceReference":{"name":"rabbitmq-cluster","namespace":"default"}}}}
2022/03/18 18:06:55 learn_server.go:291: [SIEVE-AFTER-READ]	Get	true	statefulset	default	rabbitmq-cluster-server	github.com/rabbitmq/cluster-operator/controllers.(*RabbitmqClusterReconciler)	NoError	{"kind":"StatefulSet","apiVersion":"apps/v1","metadata":{"name":"rabbitmq-cluster-server","namespace":"default","selfLink":"/apis/apps/v1/namespaces/default/statefulsets/rabbitmq-cluster-server","uid":"f2f07f3e-b500-4c48-a5de-8db7eaf37b9a","resourceVersion":"1129","generation":1,"creationTimestamp":"2022-03-18T18:06:25Z","labels":{"app.kubernetes.io/component":"rabbitmq","app.kubernetes.io/name":"rabbitmq-cluster","app.kubernetes.io/part-of":"rabbitmq"},"annotations":{"rabbitmq.com/createdAt":"2022-03-18T18:06:25Z"},"ownerReferences":[{"apiVersion":"rabbitmq.com/v1beta1","kind":"RabbitmqCluster","name":"rabbitmq-cluster","uid":"3ecefa8a-1bec-48a7-9af4-dd0df3339101","controller":true,"blockOwnerDeletion":true}],"managedFields":[{"manager":"kube-controller-manager","operation":"Update","apiVersion":"apps/v1","time":"2022-03-18T18:06:25Z","fieldsType":"FieldsV1","fieldsV1":{"f:status":{"f:collisionCount":{},"f:currentReplicas":{},"f:currentRevision":{},"f:observedGeneration":{},"f:replicas":{},"f:updateRevision":{},"f:updatedReplicas":{}}}},{"manager":"manager","operation":"Update","apiVersion":"apps/v1","time":"2022-03-18T18:06:25Z","fieldsType":"FieldsV1","fieldsV1":{"f:metadata":{"f:annotations":{".":{},"f:rabbitmq.com/createdAt":{}},"f:labels":{".":{},"f:app.kubernetes.io/component":{},"f:app.kubernetes.io/name":{},"f:app.kubernetes.io/part-of":{}},"f:ownerReferences":{".":{},"k:{\"uid\":\"3ecefa8a-1bec-48a7-9af4-dd0df3339101\"}":{".":{},"f:apiVersion":{},"f:blockOwnerDeletion":{},"f:controller":{},"f:kind":{},"f:name":{},"f:uid":{}}}},"f:spec":{"f:podManagementPolicy":{},"f:replicas":{},"f:revisionHistoryLimit":{},"f:selector":{"f:matchLabels":{".":{},"f:app.kubernetes.io/name":{}}},"f:serviceName":{},"f:template":{"f:metadata":{"f:annotations":{".":{},"f:prometheus.io/port":{},"f:prometheus.io/scrape":{}},"f:labels":{".":{},"f:app.kubernetes.io/component":{},"f:app.kubernetes.io/name":{},"f:app.kubernetes.io/part-of":{}}},"f:spec":{"f:automountServiceAccountToken":{},"f:containers":{"k:{\"name\":\"rabbitmq\"}":{".":{},"f:env":{".":{},"k:{\"name\":\"K8S_HOSTNAME_SUFFIX\"}":{".":{},"f:name":{},"f:value":{}},"k:{\"name\":\"K8S_SERVICE_NAME\"}":{".":{},"f:name":{},"f:value":{}},"k:{\"name\":\"MY_POD_NAME\"}":{".":{},"f:name":{},"f:valueFrom":{".":{},"f:fieldRef":{".":{},"f:apiVersion":{},"f:fieldPath":{}}}},"k:{\"name\":\"MY_POD_NAMESPACE\"}":{".":{},"f:name":{},"f:valueFrom":{".":{},"f:fieldRef":{".":{},"f:apiVersion":{},"f:fieldPath":{}}}},"k:{\"name\":\"RABBITMQ_ENABLED_PLUGINS_FILE\"}":{".":{},"f:name":{},"f:value":{}},"k:{\"name\":\"RABBITMQ_NODENAME\"}":{".":{},"f:name":{},"f:value":{}},"k:{\"name\":\"RABBITMQ_USE_LONGNAME\"}":{".":{},"f:name":{},"f:value":{}}},"f:image":{},"f:imagePullPolicy":{},"f:lifecycle":{".":{},"f:preStop":{".":{},"f:exec":{".":{},"f:command":{}}}},"f:name":{},"f:ports":{".":{},"k:{\"containerPort\":4369,\"protocol\":\"TCP\"}":{".":{},"f:containerPort":{},"f:name":{},"f:protocol":{}},"k:{\"containerPort\":5672,\"protocol\":\"TCP\"}":{".":{},"f:containerPort":{},"f:name":{},"f:protocol":{}},"k:{\"containerPort\":15672,\"protocol\":\"TCP\"}":{".":{},"f:containerPort":{},"f:name":{},"f:protocol":{}},"k:{\"containerPort\":15692,\"protocol\":\"TCP\"}":{".":{},"f:containerPort":{},"f:name":{},"f:protocol":{}}},"f:readinessProbe":{".":{},"f:failureThreshold":{},"f:initialDelaySeconds":{},"f:periodSeconds":{},"f:successThreshold":{},"f:tcpSocket":{".":{},"f:port":{}},"f:timeoutSeconds":{}},"f:resources":{".":{},"f:limits":{".":{},"f:cpu":{},"f:memory":{}},"f:requests":{".":{},"f:cpu":{},"f:memory":{}}},"f:terminationMessagePath":{},"f:terminationMessagePolicy":{},"f:volumeMounts":{".":{},"k:{\"mountPath\":\"/etc/pod-info/\"}":{".":{},"f:mountPath":{},"f:name":{}},"k:{\"mountPath\":\"/etc/rabbitmq/conf.d/10-operatorDefaults.conf\"}":{".":{},"f:mountPath":{},"f:name":{},"f:subPath":{}},"k:{\"mountPath\":\"/etc/rabbitmq/conf.d/11-default_user.conf\"}":{".":{},"f:mountPath":{},"f:name":{},"f:subPath":{}},"k:{\"mountPath\":\"/etc/rabbitmq/conf.d/90-userDefinedConfiguration.conf\"}":{".":{},"f:mountPath":{},"f:name":{},"f:subPath":{}},"k:{\"mountPath\":\"/operator\"}":{".":{},"f:mountPath":{},"f:name":{}},"k:{\"mountPath\":\"/var/lib/rabbitmq/\"}":{".":{},"f:mountPath":{},"f:name":{}},"k:{\"mountPath\":\"/var/lib/rabbitmq/mnesia/\"}":{".":{},"f:mountPath":{},"f:name":{}}}}},"f:dnsPolicy":{},"f:initContainers":{".":{},"k:{\"name\":\"setup-container\"}":{".":{},"f:command":{},"f:image":{},"f:imagePullPolicy":{},"f:name":{},"f:resources":{".":{},"f:limits":{".":{},"f:cpu":{},"f:memory":{}},"f:requests":{".":{},"f:cpu":{},"f:memory":{}}},"f:securityContext":{".":{},"f:capabilities":{".":{},"f:drop":{}},"f:runAsUser":{}},"f:terminationMessagePath":{},"f:terminationMessagePolicy":{},"f:volumeMounts":{".":{},"k:{\"mountPath\":\"/operator\"}":{".":{},"f:mountPath":{},"f:name":{}},"k:{\"mountPath\":\"/tmp/default_user.conf\"}":{".":{},"f:mountPath":{},"f:name":{},"f:subPath":{}},"k:{\"mountPath\":\"/tmp/erlang-cookie-secret/\"}":{".":{},"f:mountPath":{},"f:name":{}},"k:{\"mountPath\":\"/tmp/rabbitmq-plugins/\"}":{".":{},"f:mountPath":{},"f:name":{}},"k:{\"mountPath\":\"/var/lib/rabbitmq/\"}":{".":{},"f:mountPath":{},"f:name":{}},"k:{\"mountPath\":\"/var/lib/rabbitmq/mnesia/\"}":{".":{},"f:mountPath":{},"f:name":{}}}}},"f:restartPolicy":{},"f:schedulerName":{},"f:securityContext":{".":{},"f:fsGroup":{},"f:runAsGroup":{},"f:runAsUser":{}},"f:serviceAccount":{},"f:serviceAccountName":{},"f:terminationGracePeriodSeconds":{},"f:topologySpreadConstraints":{".":{},"k:{\"topologyKey\":\"topology.kubernetes.io/zone\",\"whenUnsatisfiable\":\"ScheduleAnyway\"}":{".":{},"f:labelSelector":{".":{},"f:matchLabels":{".":{},"f:app.kubernetes.io/name":{}}},"f:maxSkew":{},"f:topologyKey":{},"f:whenUnsatisfiable":{}}},"f:volumes":{".":{},"k:{\"name\":\"erlang-cookie-secret\"}":{".":{},"f:name":{},"f:secret":{".":{},"f:defaultMode":{},"f:secretName":{}}},"k:{\"name\":\"plugins-conf\"}":{".":{},"f:configMap":{".":{},"f:defaultMode":{},"f:name":{}},"f:name":{}},"k:{\"name\":\"pod-info\"}":{".":{},"f:downwardAPI":{".":{},"f:defaultMode":{},"f:items":{}},"f:name":{}},"k:{\"name\":\"rabbitmq-confd\"}":{".":{},"f:name":{},"f:projected":{".":{},"f:defaultMode":{},"f:sources":{}}},"k:{\"name\":\"rabbitmq-erlang-cookie\"}":{".":{},"f:emptyDir":{},"f:name":{}},"k:{\"name\":\"rabbitmq-plugins\"}":{".":{},"f:emptyDir":{},"f:name":{}}}}},"f:updateStrategy":{"f:rollingUpdate":{".":{},"f:partition":{}},"f:type":{}},"f:volumeClaimTemplates":{}}}}]},"spec":{"replicas":1,"selector":{"matchLabels":{"app.kubernetes.io/name":"rabbitmq-cluster"}},"template":{"metadata":{"creationTimestamp":null,"labels":{"app.kubernetes.io/component":"rabbitmq","app.kubernetes.io/name":"rabbitmq-cluster","app.kubernetes.io/part-of":"rabbitmq"},"annotations":{"prometheus.io/port":"15692","prometheus.io/scrape":"true"}},"spec":{"volumes":[{"name":"plugins-conf","configMap":{"name":"rabbitmq-cluster-plugins-conf","defaultMode":420}},{"name":"rabbitmq-confd","projected":{"sources":[{"secret":{"name":"rabbitmq-cluster-default-user","items":[{"key":"default_user.conf","path":"default_user.conf"}]}},{"configMap":{"name":"rabbitmq-cluster-server-conf","items":[{"key":"operatorDefaults.conf","path":"operatorDefaults.conf"},{"key":"userDefinedConfiguration.conf","path":"userDefinedConfiguration.conf"}]}}],"defaultMode":420}},{"name":"rabbitmq-erlang-cookie","emptyDir":{}},{"name":"erlang-cookie-secret","secret":{"secretName":"rabbitmq-cluster-erlang-cookie","defaultMode":420}},{"name":"rabbitmq-plugins","emptyDir":{}},{"name":"pod-info","downwardAPI":{"items":[{"path":"skipPreStopChecks","fieldRef":{"apiVersion":"v1","fieldPath":"metadata.labels['skipPreStopChecks']"}}],"defaultMode":420}}],"initContainers":[{"name":"setup-container","image":"rabbitmq:3.8.12-management","command":["sh","-c","cp /tmp/erlang-cookie-secret/.erlang.cookie /var/lib/rabbitmq/.erlang.cookie \u0026\u0026 chown 999:999 /var/lib/rabbitmq/.erlang.cookie \u0026\u0026 chmod 600 /var/lib/rabbitmq/.erlang.cookie ; cp /tmp/rabbitmq-plugins/enabled_plugins /operator/enabled_plugins \u0026\u0026 chown 999:999 /operator/enabled_plugins ; chown 999:999 /var/lib/rabbitmq/mnesia/ ; echo '[default]' \u003e /var/lib/rabbitmq/.rabbitmqadmin.conf \u0026\u0026 sed -e 's/default_user/username/' -e 's/default_pass/password/' /tmp/default_user.conf \u003e\u003e /var/lib/rabbitmq/.rabbitmqadmin.conf \u0026\u0026 chown 999:999 /var/lib/rabbitmq/.rabbitmqadmin.conf \u0026\u0026 chmod 600 /var/lib/rabbitmq/.rabbitmqadmin.conf"],"resources":{"limits":{"cpu":"100m","memory":"500Mi"},"requests":{"cpu":"100m","memory":"500Mi"}},"volumeMounts":[{"name":"plugins-conf","mountPath":"/tmp/rabbitmq-plugins/"},{"name":"rabbitmq-erlang-cookie","mountPath":"/var/lib/rabbitmq/"},{"name":"erlang-cookie-secret","mountPath":"/tmp/erlang-cookie-secret/"},{"name":"rabbitmq-plugins","mountPath":"/operator"},{"name":"persistence","mountPath":"/var/lib/rabbitmq/mnesia/"},{"name":"rabbitmq-confd","mountPath":"/tmp/default_user.conf","subPath":"default_user.conf"}],"terminationMessagePath":"/dev/termination-log","terminationMessagePolicy":"File","imagePullPolicy":"IfNotPresent","securityContext":{"capabilities":{"drop":["FSETID","KILL","SETGID","SETUID","SETPCAP","NET_BIND_SERVICE","NET_RAW","SYS_CHROOT","MKNOD","AUDIT_WRITE","SETFCAP"]},"runAsUser":0}}],"containers":[{"name":"rabbitmq","image":"rabbitmq:3.8.12-management","ports":[{"name":"epmd","containerPort":4369,"protocol":"TCP"},{"name":"amqp","containerPort":5672,"protocol":"TCP"},{"name":"management","containerPort":15672,"protocol":"TCP"},{"name":"prometheus","containerPort":15692,"protocol":"TCP"}],"env":[{"name":"MY_POD_NAME","valueFrom":{"fieldRef":{"apiVersion":"v1","fieldPath":"metadata.name"}}},{"name":"MY_POD_NAMESPACE","valueFrom":{"fieldRef":{"apiVersion":"v1","fieldPath":"metadata.namespace"}}},{"name":"RABBITMQ_ENABLED_PLUGINS_FILE","value":"/operator/enabled_plugins"},{"name":"K8S_SERVICE_NAME","value":"rabbitmq-cluster-nodes"},{"name":"RABBITMQ_USE_LONGNAME","value":"true"},{"name":"RABBITMQ_NODENAME","value":"rabbit@$(MY_POD_NAME).$(K8S_SERVICE_NAME).$(MY_POD_NAMESPACE)"},{"name":"K8S_HOSTNAME_SUFFIX","value":".$(K8S_SERVICE_NAME).$(MY_POD_NAMESPACE)"}],"resources":{"limits":{"cpu":"2","memory":"2Gi"},"requests":{"cpu":"1","memory":"2Gi"}},"volumeMounts":[{"name":"rabbitmq-erlang-cookie","mountPath":"/var/lib/rabbitmq/"},{"name":"persistence","mountPath":"/var/lib/rabbitmq/mnesia/"},{"name":"rabbitmq-plugins","mountPath":"/operator"},{"name":"rabbitmq-confd","mountPath":"/etc/rabbitmq/conf.d/10-operatorDefaults.conf","subPath":"operatorDefaults.conf"},{"name":"rabbitmq-confd","mountPath":"/etc/rabbitmq/conf.d/11-default_user.conf","subPath":"default_user.conf"},{"name":"rabbitmq-confd","mountPath":"/etc/rabbitmq/conf.d/90-userDefinedConfiguration.conf","subPath":"userDefinedConfiguration.conf"},{"name":"pod-info","mountPath":"/etc/pod-info/"}],"readinessProbe":{"tcpSocket":{"port":"amqp"},"initialDelaySeconds":10,"timeoutSeconds":5,"periodSeconds":10,"successThreshold":1,"failureThreshold":3},"lifecycle":{"preStop":{"exec":{"command":["/bin/bash","-c","if [ ! -z \"$(cat /etc/pod-info/skipPreStopChecks)\" ]; then exit 0; fi; rabbitmq-upgrade await_online_quorum_plus_one -t 604800; rabbitmq-upgrade await_online_synchronized_mirror -t 604800; rabbitmq-upgrade drain -t 604800"]}}},"terminationMessagePath":"/dev/termination-log","terminationMessagePolicy":"File","imagePullPolicy":"IfNotPresent"}],"restartPolicy":"Always","terminationGracePeriodSeconds":604800,"dnsPolicy":"ClusterFirst","serviceAccountName":"rabbitmq-cluster-server","serviceAccount":"rabbitmq-cluster-server","automountServiceAccountToken":true,"securityContext":{"runAsUser":999,"runAsGroup":999,"fsGroup":999},"schedulerName":"default-scheduler","topologySpreadConstraints":[{"maxSkew":1,"topologyKey":"topology.kubernetes.io/zone","whenUnsatisfiable":"ScheduleAnyway","labelSelector":{"matchLabels":{"app.kubernetes.io/name":"rabbitmq-cluster"}}}]}},"volumeClaimTemplates":[{"metadata":{"name":"persistence","namespace":"default","creationTimestamp":null,"labels":{"app.kubernetes.io/component":"rabbitmq","app.kubernetes.io/name":"rabbitmq-cluster","app.kubernetes.io/part-of":"rabbitmq"},"ownerReferences":[{"apiVersion":"rabbitmq.com/v1beta1","kind":"RabbitmqCluster","name":"rabbitmq-cluster","uid":"3ecefa8a-1bec-48a7-9af4-dd0df3339101","controller":true,"blockOwnerDeletion":false}]},"spec":{"accessModes":["ReadWriteOnce"],"resources":{"requests":{"storage":"10Gi"}},"volumeMode":"Filesystem"},"status":{"phase":"Pending"}}],"serviceName":"rabbitmq-cluster-nodes","podManagementPolicy":"Parallel","updateStrategy":{"type":"RollingUpdate","rollingUpdate":{"partition":0}},"revisionHistoryLimit":10},"status":{"observedGeneration":1,"replicas":1,"currentReplicas":1,"updatedReplicas":1,"currentRevision":"rabbitmq-cluster-server-5f8b8665fb","updateRevision":"rabbitmq-cluster-server-5f8b8665fb","collisionCount":0}}
2022/03/18 18:06:55 learn_server.go:291: [SIEVE-AFTER-READ]	Get	true	endpoints	default	rabbitmq-cluster	github.com/rabbitmq/cluster-operator/controllers.(*RabbitmqClusterReconciler)	NoError	{"kind":"Endpoints","apiVersion":"v1","metadata":{"name":"rabbitmq-cluster","namespace":"default","selfLink":"/api/v1/namespaces/default/endpoints/rabbitmq-cluster","uid":"eeba9576-0362-4e74-aafd-71e4ffe98d25","resourceVersion":"1251","creationTimestamp":"2022-03-18T18:06:25Z","labels":{"app.kubernetes.io/component":"rabbitmq","app.kubernetes.io/name":"rabbitmq-cluster","app.kubernetes.io/part-of":"rabbitmq"},"annotations":{"endpoints.kubernetes.io/last-change-trigger-time":"2022-03-18T18:06:27Z"},"managedFields":[{"manager":"kube-controller-manager","operation":"Update","apiVersion":"v1","time":"2022-03-18T18:06:49Z","fieldsType":"FieldsV1","fieldsV1":{"f:metadata":{"f:annotations":{".":{},"f:endpoints.kubernetes.io/last-change-trigger-time":{}},"f:labels":{".":{},"f:app.kubernetes.io/component":{},"f:app.kubernetes.io/name":{},"f:app.kubernetes.io/part-of":{}}},"f:subsets":{}}}]},"subsets":[{"notReadyAddresses":[{"ip":"10.244.1.4","nodeName":"kind-worker","targetRef":{"kind":"Pod","namespace":"default","name":"rabbitmq-cluster-server-0","uid":"cbaba199-5faf-480a-81e8-051ce2cc79e6","resourceVersion":"1247"}}],"ports":[{"name":"amqp","port":5672,"protocol":"TCP"},{"name":"management","port":15672,"protocol":"TCP"}]}]}
2022/03/18 18:06:55 learn_server.go:291: [SIEVE-AFTER-READ]	Get	true	statefulset	default	rabbitmq-cluster-server	github.com/rabbitmq/cluster-operator/controllers.(*RabbitmqClusterReconciler)	NoError	{"kind":"StatefulSet","apiVersion":"apps/v1","metadata":{"name":"rabbitmq-cluster-server","namespace":"default","selfLink":"/apis/apps/v1/namespaces/default/statefulsets/rabbitmq-cluster-server","uid":"f2f07f3e-b500-4c48-a5de-8db7eaf37b9a","resourceVersion":"1129","generation":1,"creationTimestamp":"2022-03-18T18:06:25Z","labels":{"app.kubernetes.io/component":"rabbitmq","app.kubernetes.io/name":"rabbitmq-cluster","app.kubernetes.io/part-of":"rabbitmq"},"annotations":{"rabbitmq.com/createdAt":"2022-03-18T18:06:25Z"},"ownerReferences":[{"apiVersion":"rabbitmq.com/v1beta1","kind":"RabbitmqCluster","name":"rabbitmq-cluster","uid":"3ecefa8a-1bec-48a7-9af4-dd0df3339101","controller":true,"blockOwnerDeletion":true}],"managedFields":[{"manager":"kube-controller-manager","operation":"Update","apiVersion":"apps/v1","time":"2022-03-18T18:06:25Z","fieldsType":"FieldsV1","fieldsV1":{"f:status":{"f:collisionCount":{},"f:currentReplicas":{},"f:currentRevision":{},"f:observedGeneration":{},"f:replicas":{},"f:updateRevision":{},"f:updatedReplicas":{}}}},{"manager":"manager","operation":"Update","apiVersion":"apps/v1","time":"2022-03-18T18:06:25Z","fieldsType":"FieldsV1","fieldsV1":{"f:metadata":{"f:annotations":{".":{},"f:rabbitmq.com/createdAt":{}},"f:labels":{".":{},"f:app.kubernetes.io/component":{},"f:app.kubernetes.io/name":{},"f:app.kubernetes.io/part-of":{}},"f:ownerReferences":{".":{},"k:{\"uid\":\"3ecefa8a-1bec-48a7-9af4-dd0df3339101\"}":{".":{},"f:apiVersion":{},"f:blockOwnerDeletion":{},"f:controller":{},"f:kind":{},"f:name":{},"f:uid":{}}}},"f:spec":{"f:podManagementPolicy":{},"f:replicas":{},"f:revisionHistoryLimit":{},"f:selector":{"f:matchLabels":{".":{},"f:app.kubernetes.io/name":{}}},"f:serviceName":{},"f:template":{"f:metadata":{"f:annotations":{".":{},"f:prometheus.io/port":{},"f:prometheus.io/scrape":{}},"f:labels":{".":{},"f:app.kubernetes.io/component":{},"f:app.kubernetes.io/name":{},"f:app.kubernetes.io/part-of":{}}},"f:spec":{"f:automountServiceAccountToken":{},"f:containers":{"k:{\"name\":\"rabbitmq\"}":{".":{},"f:env":{".":{},"k:{\"name\":\"K8S_HOSTNAME_SUFFIX\"}":{".":{},"f:name":{},"f:value":{}},"k:{\"name\":\"K8S_SERVICE_NAME\"}":{".":{},"f:name":{},"f:value":{}},"k:{\"name\":\"MY_POD_NAME\"}":{".":{},"f:name":{},"f:valueFrom":{".":{},"f:fieldRef":{".":{},"f:apiVersion":{},"f:fieldPath":{}}}},"k:{\"name\":\"MY_POD_NAMESPACE\"}":{".":{},"f:name":{},"f:valueFrom":{".":{},"f:fieldRef":{".":{},"f:apiVersion":{},"f:fieldPath":{}}}},"k:{\"name\":\"RABBITMQ_ENABLED_PLUGINS_FILE\"}":{".":{},"f:name":{},"f:value":{}},"k:{\"name\":\"RABBITMQ_NODENAME\"}":{".":{},"f:name":{},"f:value":{}},"k:{\"name\":\"RABBITMQ_USE_LONGNAME\"}":{".":{},"f:name":{},"f:value":{}}},"f:image":{},"f:imagePullPolicy":{},"f:lifecycle":{".":{},"f:preStop":{".":{},"f:exec":{".":{},"f:command":{}}}},"f:name":{},"f:ports":{".":{},"k:{\"containerPort\":4369,\"protocol\":\"TCP\"}":{".":{},"f:containerPort":{},"f:name":{},"f:protocol":{}},"k:{\"containerPort\":5672,\"protocol\":\"TCP\"}":{".":{},"f:containerPort":{},"f:name":{},"f:protocol":{}},"k:{\"containerPort\":15672,\"protocol\":\"TCP\"}":{".":{},"f:containerPort":{},"f:name":{},"f:protocol":{}},"k:{\"containerPort\":15692,\"protocol\":\"TCP\"}":{".":{},"f:containerPort":{},"f:name":{},"f:protocol":{}}},"f:readinessProbe":{".":{},"f:failureThreshold":{},"f:initialDelaySeconds":{},"f:periodSeconds":{},"f:successThreshold":{},"f:tcpSocket":{".":{},"f:port":{}},"f:timeoutSeconds":{}},"f:resources":{".":{},"f:limits":{".":{},"f:cpu":{},"f:memory":{}},"f:requests":{".":{},"f:cpu":{},"f:memory":{}}},"f:terminationMessagePath":{},"f:terminationMessagePolicy":{},"f:volumeMounts":{".":{},"k:{\"mountPath\":\"/etc/pod-info/\"}":{".":{},"f:mountPath":{},"f:name":{}},"k:{\"mountPath\":\"/etc/rabbitmq/conf.d/10-operatorDefaults.conf\"}":{".":{},"f:mountPath":{},"f:name":{},"f:subPath":{}},"k:{\"mountPath\":\"/etc/rabbitmq/conf.d/11-default_user.conf\"}":{".":{},"f:mountPath":{},"f:name":{},"f:subPath":{}},"k:{\"mountPath\":\"/etc/rabbitmq/conf.d/90-userDefinedConfiguration.conf\"}":{".":{},"f:mountPath":{},"f:name":{},"f:subPath":{}},"k:{\"mountPath\":\"/operator\"}":{".":{},"f:mountPath":{},"f:name":{}},"k:{\"mountPath\":\"/var/lib/rabbitmq/\"}":{".":{},"f:mountPath":{},"f:name":{}},"k:{\"mountPath\":\"/var/lib/rabbitmq/mnesia/\"}":{".":{},"f:mountPath":{},"f:name":{}}}}},"f:dnsPolicy":{},"f:initContainers":{".":{},"k:{\"name\":\"setup-container\"}":{".":{},"f:command":{},"f:image":{},"f:imagePullPolicy":{},"f:name":{},"f:resources":{".":{},"f:limits":{".":{},"f:cpu":{},"f:memory":{}},"f:requests":{".":{},"f:cpu":{},"f:memory":{}}},"f:securityContext":{".":{},"f:capabilities":{".":{},"f:drop":{}},"f:runAsUser":{}},"f:terminationMessagePath":{},"f:terminationMessagePolicy":{},"f:volumeMounts":{".":{},"k:{\"mountPath\":\"/operator\"}":{".":{},"f:mountPath":{},"f:name":{}},"k:{\"mountPath\":\"/tmp/default_user.conf\"}":{".":{},"f:mountPath":{},"f:name":{},"f:subPath":{}},"k:{\"mountPath\":\"/tmp/erlang-cookie-secret/\"}":{".":{},"f:mountPath":{},"f:name":{}},"k:{\"mountPath\":\"/tmp/rabbitmq-plugins/\"}":{".":{},"f:mountPath":{},"f:name":{}},"k:{\"mountPath\":\"/var/lib/rabbitmq/\"}":{".":{},"f:mountPath":{},"f:name":{}},"k:{\"mountPath\":\"/var/lib/rabbitmq/mnesia/\"}":{".":{},"f:mountPath":{},"f:name":{}}}}},"f:restartPolicy":{},"f:schedulerName":{},"f:securityContext":{".":{},"f:fsGroup":{},"f:runAsGroup":{},"f:runAsUser":{}},"f:serviceAccount":{},"f:serviceAccountName":{},"f:terminationGracePeriodSeconds":{},"f:topologySpreadConstraints":{".":{},"k:{\"topologyKey\":\"topology.kubernetes.io/zone\",\"whenUnsatisfiable\":\"ScheduleAnyway\"}":{".":{},"f:labelSelector":{".":{},"f:matchLabels":{".":{},"f:app.kubernetes.io/name":{}}},"f:maxSkew":{},"f:topologyKey":{},"f:whenUnsatisfiable":{}}},"f:volumes":{".":{},"k:{\"name\":\"erlang-cookie-secret\"}":{".":{},"f:name":{},"f:secret":{".":{},"f:defaultMode":{},"f:secretName":{}}},"k:{\"name\":\"plugins-conf\"}":{".":{},"f:configMap":{".":{},"f:defaultMode":{},"f:name":{}},"f:name":{}},"k:{\"name\":\"pod-info\"}":{".":{},"f:downwardAPI":{".":{},"f:defaultMode":{},"f:items":{}},"f:name":{}},"k:{\"name\":\"rabbitmq-confd\"}":{".":{},"f:name":{},"f:projected":{".":{},"f:defaultMode":{},"f:sources":{}}},"k:{\"name\":\"rabbitmq-erlang-cookie\"}":{".":{},"f:emptyDir":{},"f:name":{}},"k:{\"name\":\"rabbitmq-plugins\"}":{".":{},"f:emptyDir":{},"f:name":{}}}}},"f:updateStrategy":{"f:rollingUpdate":{".":{},"f:partition":{}},"f:type":{}},"f:volumeClaimTemplates":{}}}}]},"spec":{"replicas":1,"selector":{"matchLabels":{"app.kubernetes.io/name":"rabbitmq-cluster"}},"template":{"metadata":{"creationTimestamp":null,"labels":{"app.kubernetes.io/component":"rabbitmq","app.kubernetes.io/name":"rabbitmq-cluster","app.kubernetes.io/part-of":"rabbitmq"},"annotations":{"prometheus.io/port":"15692","prometheus.io/scrape":"true"}},"spec":{"volumes":[{"name":"plugins-conf","configMap":{"name":"rabbitmq-cluster-plugins-conf","defaultMode":420}},{"name":"rabbitmq-confd","projected":{"sources":[{"secret":{"name":"rabbitmq-cluster-default-user","items":[{"key":"default_user.conf","path":"default_user.conf"}]}},{"configMap":{"name":"rabbitmq-cluster-server-conf","items":[{"key":"operatorDefaults.conf","path":"operatorDefaults.conf"},{"key":"userDefinedConfiguration.conf","path":"userDefinedConfiguration.conf"}]}}],"defaultMode":420}},{"name":"rabbitmq-erlang-cookie","emptyDir":{}},{"name":"erlang-cookie-secret","secret":{"secretName":"rabbitmq-cluster-erlang-cookie","defaultMode":420}},{"name":"rabbitmq-plugins","emptyDir":{}},{"name":"pod-info","downwardAPI":{"items":[{"path":"skipPreStopChecks","fieldRef":{"apiVersion":"v1","fieldPath":"metadata.labels['skipPreStopChecks']"}}],"defaultMode":420}}],"initContainers":[{"name":"setup-container","image":"rabbitmq:3.8.12-management","command":["sh","-c","cp /tmp/erlang-cookie-secret/.erlang.cookie /var/lib/rabbitmq/.erlang.cookie \u0026\u0026 chown 999:999 /var/lib/rabbitmq/.erlang.cookie \u0026\u0026 chmod 600 /var/lib/rabbitmq/.erlang.cookie ; cp /tmp/rabbitmq-plugins/enabled_plugins /operator/enabled_plugins \u0026\u0026 chown 999:999 /operator/enabled_plugins ; chown 999:999 /var/lib/rabbitmq/mnesia/ ; echo '[default]' \u003e /var/lib/rabbitmq/.rabbitmqadmin.conf \u0026\u0026 sed -e 's/default_user/username/' -e 's/default_pass/password/' /tmp/default_user.conf \u003e\u003e /var/lib/rabbitmq/.rabbitmqadmin.conf \u0026\u0026 chown 999:999 /var/lib/rabbitmq/.rabbitmqadmin.conf \u0026\u0026 chmod 600 /var/lib/rabbitmq/.rabbitmqadmin.conf"],"resources":{"limits":{"cpu":"100m","memory":"500Mi"},"requests":{"cpu":"100m","memory":"500Mi"}},"volumeMounts":[{"name":"plugins-conf","mountPath":"/tmp/rabbitmq-plugins/"},{"name":"rabbitmq-erlang-cookie","mountPath":"/var/lib/rabbitmq/"},{"name":"erlang-cookie-secret","mountPath":"/tmp/erlang-cookie-secret/"},{"name":"rabbitmq-plugins","mountPath":"/operator"},{"name":"persistence","mountPath":"/var/lib/rabbitmq/mnesia/"},{"name":"rabbitmq-confd","mountPath":"/tmp/default_user.conf","subPath":"default_user.conf"}],"terminationMessagePath":"/dev/termination-log","terminationMessagePolicy":"File","imagePullPolicy":"IfNotPresent","securityContext":{"capabilities":{"drop":["FSETID","KILL","SETGID","SETUID","SETPCAP","NET_BIND_SERVICE","NET_RAW","SYS_CHROOT","MKNOD","AUDIT_WRITE","SETFCAP"]},"runAsUser":0}}],"containers":[{"name":"rabbitmq","image":"rabbitmq:3.8.12-management","ports":[{"name":"epmd","containerPort":4369,"protocol":"TCP"},{"name":"amqp","containerPort":5672,"protocol":"TCP"},{"name":"management","containerPort":15672,"protocol":"TCP"},{"name":"prometheus","containerPort":15692,"protocol":"TCP"}],"env":[{"name":"MY_POD_NAME","valueFrom":{"fieldRef":{"apiVersion":"v1","fieldPath":"metadata.name"}}},{"name":"MY_POD_NAMESPACE","valueFrom":{"fieldRef":{"apiVersion":"v1","fieldPath":"metadata.namespace"}}},{"name":"RABBITMQ_ENABLED_PLUGINS_FILE","value":"/operator/enabled_plugins"},{"name":"K8S_SERVICE_NAME","value":"rabbitmq-cluster-nodes"},{"name":"RABBITMQ_USE_LONGNAME","value":"true"},{"name":"RABBITMQ_NODENAME","value":"rabbit@$(MY_POD_NAME).$(K8S_SERVICE_NAME).$(MY_POD_NAMESPACE)"},{"name":"K8S_HOSTNAME_SUFFIX","value":".$(K8S_SERVICE_NAME).$(MY_POD_NAMESPACE)"}],"resources":{"limits":{"cpu":"2","memory":"2Gi"},"requests":{"cpu":"1","memory":"2Gi"}},"volumeMounts":[{"name":"rabbitmq-erlang-cookie","mountPath":"/var/lib/rabbitmq/"},{"name":"persistence","mountPath":"/var/lib/rabbitmq/mnesia/"},{"name":"rabbitmq-plugins","mountPath":"/operator"},{"name":"rabbitmq-confd","mountPath":"/etc/rabbitmq/conf.d/10-operatorDefaults.conf","subPath":"operatorDefaults.conf"},{"name":"rabbitmq-confd","mountPath":"/etc/rabbitmq/conf.d/11-default_user.conf","subPath":"default_user.conf"},{"name":"rabbitmq-confd","mountPath":"/etc/rabbitmq/conf.d/90-userDefinedConfiguration.conf","subPath":"userDefinedConfiguration.conf"},{"name":"pod-info","mountPath":"/etc/pod-info/"}],"readinessProbe":{"tcpSocket":{"port":"amqp"},"initialDelaySeconds":10,"timeoutSeconds":5,"periodSeconds":10,"successThreshold":1,"failureThreshold":3},"lifecycle":{"preStop":{"exec":{"command":["/bin/bash","-c","if [ ! -z \"$(cat /etc/pod-info/skipPreStopChecks)\" ]; then exit 0; fi; rabbitmq-upgrade await_online_quorum_plus_one -t 604800; rabbitmq-upgrade await_online_synchronized_mirror -t 604800; rabbitmq-upgrade drain -t 604800"]}}},"terminationMessagePath":"/dev/termination-log","terminationMessagePolicy":"File","imagePullPolicy":"IfNotPresent"}],"restartPolicy":"Always","terminationGracePeriodSeconds":604800,"dnsPolicy":"ClusterFirst","serviceAccountName":"rabbitmq-cluster-server","serviceAccount":"rabbitmq-cluster-server","automountServiceAccountToken":true,"securityContext":{"runAsUser":999,"runAsGroup":999,"fsGroup":999},"schedulerName":"default-scheduler","topologySpreadConstraints":[{"maxSkew":1,"topologyKey":"topology.kubernetes.io/zone","whenUnsatisfiable":"ScheduleAnyway","labelSelector":{"matchLabels":{"app.kubernetes.io/name":"rabbitmq-cluster"}}}]}},"volumeClaimTemplates":[{"metadata":{"name":"persistence","namespace":"default","creationTimestamp":null,"labels":{"app.kubernetes.io/component":"rabbitmq","app.kubernetes.io/name":"rabbitmq-cluster","app.kubernetes.io/part-of":"rabbitmq"},"ownerReferences":[{"apiVersion":"rabbitmq.com/v1beta1","kind":"RabbitmqCluster","name":"rabbitmq-cluster","uid":"3ecefa8a-1bec-48a7-9af4-dd0df3339101","controller":true,"blockOwnerDeletion":false}]},"spec":{"accessModes":["ReadWriteOnce"],"resources":{"requests":{"storage":"10Gi"}},"volumeMode":"Filesystem"},"status":{"phase":"Pending"}}],"serviceName":"rabbitmq-cluster-nodes","podManagementPolicy":"Parallel","updateStrategy":{"type":"RollingUpdate","rollingUpdate":{"partition":0}},"revisionHistoryLimit":10},"status":{"observedGeneration":1,"replicas":1,"currentReplicas":1,"updatedReplicas":1,"currentRevision":"rabbitmq-cluster-server-5f8b8665fb","updateRevision":"rabbitmq-cluster-server-5f8b8665fb","collisionCount":0}}
2022/03/18 18:06:55 learn_server.go:291: [SIEVE-AFTER-READ]	Get	true	service	default	rabbitmq-cluster-nodes	github.com/rabbitmq/cluster-operator/controllers.(*RabbitmqClusterReconciler)	NoError	{"kind":"Service","apiVersion":"v1","metadata":{"name":"rabbitmq-cluster-nodes","namespace":"default","selfLink":"/api/v1/namespaces/default/services/rabbitmq-cluster-nodes","uid":"f843e1c2-ced0-463d-87c1-0e127aaa2006","resourceVersion":"1080","creationTimestamp":"2022-03-18T18:06:25Z","labels":{"app.kubernetes.io/component":"rabbitmq","app.kubernetes.io/name":"rabbitmq-cluster","app.kubernetes.io/part-of":"rabbitmq"},"ownerReferences":[{"apiVersion":"rabbitmq.com/v1beta1","kind":"RabbitmqCluster","name":"rabbitmq-cluster","uid":"3ecefa8a-1bec-48a7-9af4-dd0df3339101","controller":true,"blockOwnerDeletion":true}],"managedFields":[{"manager":"manager","operation":"Update","apiVersion":"v1","time":"2022-03-18T18:06:25Z","fieldsType":"FieldsV1","fieldsV1":{"f:metadata":{"f:labels":{".":{},"f:app.kubernetes.io/component":{},"f:app.kubernetes.io/name":{},"f:app.kubernetes.io/part-of":{}},"f:ownerReferences":{".":{},"k:{\"uid\":\"3ecefa8a-1bec-48a7-9af4-dd0df3339101\"}":{".":{},"f:apiVersion":{},"f:blockOwnerDeletion":{},"f:controller":{},"f:kind":{},"f:name":{},"f:uid":{}}}},"f:spec":{"f:clusterIP":{},"f:ports":{".":{},"k:{\"port\":4369,\"protocol\":\"TCP\"}":{".":{},"f:name":{},"f:port":{},"f:protocol":{},"f:targetPort":{}},"k:{\"port\":25672,\"protocol\":\"TCP\"}":{".":{},"f:name":{},"f:port":{},"f:protocol":{},"f:targetPort":{}}},"f:publishNotReadyAddresses":{},"f:selector":{".":{},"f:app.kubernetes.io/name":{}},"f:sessionAffinity":{},"f:type":{}}}}]},"spec":{"ports":[{"name":"epmd","protocol":"TCP","port":4369,"targetPort":4369},{"name":"cluster-rpc","protocol":"TCP","port":25672,"targetPort":25672}],"selector":{"app.kubernetes.io/name":"rabbitmq-cluster"},"clusterIP":"None","type":"ClusterIP","sessionAffinity":"None","publishNotReadyAddresses":true},"status":{"loadBalancer":{}}}
2022/03/18 18:06:55 learn_server.go:291: [SIEVE-AFTER-READ]	Get	true	service	default	rabbitmq-cluster	github.com/rabbitmq/cluster-operator/controllers.(*RabbitmqClusterReconciler)	NoError	{"kind":"Service","apiVersion":"v1","metadata":{"name":"rabbitmq-cluster","namespace":"default","selfLink":"/api/v1/namespaces/default/services/rabbitmq-cluster","uid":"ae846a70-784e-49ca-99a0-2b0cefb93b46","resourceVersion":"1085","creationTimestamp":"2022-03-18T18:06:25Z","labels":{"app.kubernetes.io/component":"rabbitmq","app.kubernetes.io/name":"rabbitmq-cluster","app.kubernetes.io/part-of":"rabbitmq"},"ownerReferences":[{"apiVersion":"rabbitmq.com/v1beta1","kind":"RabbitmqCluster","name":"rabbitmq-cluster","uid":"3ecefa8a-1bec-48a7-9af4-dd0df3339101","controller":true,"blockOwnerDeletion":true}],"managedFields":[{"manager":"manager","operation":"Update","apiVersion":"v1","time":"2022-03-18T18:06:25Z","fieldsType":"FieldsV1","fieldsV1":{"f:metadata":{"f:labels":{".":{},"f:app.kubernetes.io/component":{},"f:app.kubernetes.io/name":{},"f:app.kubernetes.io/part-of":{}},"f:ownerReferences":{".":{},"k:{\"uid\":\"3ecefa8a-1bec-48a7-9af4-dd0df3339101\"}":{".":{},"f:apiVersion":{},"f:blockOwnerDeletion":{},"f:controller":{},"f:kind":{},"f:name":{},"f:uid":{}}}},"f:spec":{"f:ports":{".":{},"k:{\"port\":5672,\"protocol\":\"TCP\"}":{".":{},"f:name":{},"f:port":{},"f:protocol":{},"f:targetPort":{}},"k:{\"port\":15672,\"protocol\":\"TCP\"}":{".":{},"f:name":{},"f:port":{},"f:protocol":{},"f:targetPort":{}}},"f:selector":{".":{},"f:app.kubernetes.io/name":{}},"f:sessionAffinity":{},"f:type":{}}}}]},"spec":{"ports":[{"name":"amqp","protocol":"TCP","port":5672,"targetPort":5672},{"name":"management","protocol":"TCP","port":15672,"targetPort":15672}],"selector":{"app.kubernetes.io/name":"rabbitmq-cluster"},"clusterIP":"10.96.47.189","type":"ClusterIP","sessionAffinity":"None"},"status":{"loadBalancer":{}}}
2022/03/18 18:06:55 learn_server.go:291: [SIEVE-AFTER-READ]	Get	true	secret	default	rabbitmq-cluster-erlang-cookie	github.com/rabbitmq/cluster-operator/controllers.(*RabbitmqClusterReconciler)	NoError	{"kind":"Secret","apiVersion":"v1","metadata":{"name":"rabbitmq-cluster-erlang-cookie","namespace":"default","selfLink":"/api/v1/namespaces/default/secrets/rabbitmq-cluster-erlang-cookie","uid":"01d8d8ad-080a-4c3f-9d27-56616c53dd26","resourceVersion":"1088","creationTimestamp":"2022-03-18T18:06:25Z","labels":{"app.kubernetes.io/component":"rabbitmq","app.kubernetes.io/name":"rabbitmq-cluster","app.kubernetes.io/part-of":"rabbitmq"},"ownerReferences":[{"apiVersion":"rabbitmq.com/v1beta1","kind":"RabbitmqCluster","name":"rabbitmq-cluster","uid":"3ecefa8a-1bec-48a7-9af4-dd0df3339101","controller":true,"blockOwnerDeletion":true}],"managedFields":[{"manager":"manager","operation":"Update","apiVersion":"v1","time":"2022-03-18T18:06:25Z","fieldsType":"FieldsV1","fieldsV1":{"f:data":{".":{},"f:.erlang.cookie":{}},"f:metadata":{"f:labels":{".":{},"f:app.kubernetes.io/component":{},"f:app.kubernetes.io/name":{},"f:app.kubernetes.io/part-of":{}},"f:ownerReferences":{".":{},"k:{\"uid\":\"3ecefa8a-1bec-48a7-9af4-dd0df3339101\"}":{".":{},"f:apiVersion":{},"f:blockOwnerDeletion":{},"f:controller":{},"f:kind":{},"f:name":{},"f:uid":{}}}},"f:type":{}}}]},"data":{".erlang.cookie":"ajdscUtLdnBpR1NwUUMwc1V3a2VyTlJxU2tVUTdBeEw="},"type":"Opaque"}
2022/03/18 18:06:55 learn_server.go:291: [SIEVE-AFTER-READ]	Get	true	secret	default	rabbitmq-cluster-default-user	github.com/rabbitmq/cluster-operator/controllers.(*RabbitmqClusterReconciler)	NoError	{"kind":"Secret","apiVersion":"v1","metadata":{"name":"rabbitmq-cluster-default-user","namespace":"default","selfLink":"/api/v1/namespaces/default/secrets/rabbitmq-cluster-default-user","uid":"b2f5a936-e51f-4488-b6e9-ca23e4d95ac2","resourceVersion":"1091","creationTimestamp":"2022-03-18T18:06:25Z","labels":{"app.kubernetes.io/component":"rabbitmq","app.kubernetes.io/name":"rabbitmq-cluster","app.kubernetes.io/part-of":"rabbitmq"},"ownerReferences":[{"apiVersion":"rabbitmq.com/v1beta1","kind":"RabbitmqCluster","name":"rabbitmq-cluster","uid":"3ecefa8a-1bec-48a7-9af4-dd0df3339101","controller":true,"blockOwnerDeletion":true}],"managedFields":[{"manager":"manager","operation":"Update","apiVersion":"v1","time":"2022-03-18T18:06:25Z","fieldsType":"FieldsV1","fieldsV1":{"f:data":{".":{},"f:default_user.conf":{},"f:password":{},"f:provider":{},"f:type":{},"f:username":{}},"f:metadata":{"f:labels":{".":{},"f:app.kubernetes.io/component":{},"f:app.kubernetes.io/name":{},"f:app.kubernetes.io/part-of":{}},"f:ownerReferences":{".":{},"k:{\"uid\":\"3ecefa8a-1bec-48a7-9af4-dd0df3339101\"}":{".":{},"f:apiVersion":{},"f:blockOwnerDeletion":{},"f:controller":{},"f:kind":{},"f:name":{},"f:uid":{}}}},"f:type":{}}}]},"data":{"default_user.conf":"ZGVmYXVsdF91c2VyID0gdEFMN1otZTgzR29ocEtsZ0Z4cUFFV3ZXemEtcjdJQW8KZGVmYXVsdF9wYXNzID0gdXVocndkTkdOcmJXQ2p6NFZPX0NUZE9OYURkSUpoRkoK","password":"dXVocndkTkdOcmJXQ2p6NFZPX0NUZE9OYURkSUpoRko=","provider":"cmFiYml0bXE=","type":"cmFiYml0bXE=","username":"dEFMN1otZTgzR29ocEtsZ0Z4cUFFV3ZXemEtcjdJQW8="},"type":"Opaque"}
2022/03/18 18:06:55 learn_server.go:291: [SIEVE-AFTER-READ]	Get	true	configmap	default	rabbitmq-cluster-plugins-conf	github.com/rabbitmq/cluster-operator/controllers.(*RabbitmqClusterReconciler)	NoError	{"kind":"ConfigMap","apiVersion":"v1","metadata":{"name":"rabbitmq-cluster-plugins-conf","namespace":"default","selfLink":"/api/v1/namespaces/default/configmaps/rabbitmq-cluster-plugins-conf","uid":"0aa26eb6-ff3a-4457-a223-284c897db7fe","resourceVersion":"1092","creationTimestamp":"2022-03-18T18:06:25Z","labels":{"app.kubernetes.io/component":"rabbitmq","app.kubernetes.io/name":"rabbitmq-cluster","app.kubernetes.io/part-of":"rabbitmq"},"ownerReferences":[{"apiVersion":"rabbitmq.com/v1beta1","kind":"RabbitmqCluster","name":"rabbitmq-cluster","uid":"3ecefa8a-1bec-48a7-9af4-dd0df3339101","controller":true,"blockOwnerDeletion":true}],"managedFields":[{"manager":"manager","operation":"Update","apiVersion":"v1","time":"2022-03-18T18:06:25Z","fieldsType":"FieldsV1","fieldsV1":{"f:data":{".":{},"f:enabled_plugins":{}},"f:metadata":{"f:labels":{".":{},"f:app.kubernetes.io/component":{},"f:app.kubernetes.io/name":{},"f:app.kubernetes.io/part-of":{}},"f:ownerReferences":{".":{},"k:{\"uid\":\"3ecefa8a-1bec-48a7-9af4-dd0df3339101\"}":{".":{},"f:apiVersion":{},"f:blockOwnerDeletion":{},"f:controller":{},"f:kind":{},"f:name":{},"f:uid":{}}}}}}]},"data":{"enabled_plugins":"[rabbitmq_peer_discovery_k8s,rabbitmq_prometheus,rabbitmq_management]."}}
2022/03/18 18:06:55 learn_server.go:291: [SIEVE-AFTER-READ]	Get	true	configmap	default	rabbitmq-cluster-server-conf	github.com/rabbitmq/cluster-operator/controllers.(*RabbitmqClusterReconciler)	NoError	{"kind":"ConfigMap","apiVersion":"v1","metadata":{"name":"rabbitmq-cluster-server-conf","namespace":"default","selfLink":"/api/v1/namespaces/default/configmaps/rabbitmq-cluster-server-conf","uid":"e4182078-d429-4baf-9021-72618c509ac5","resourceVersion":"1095","creationTimestamp":"2022-03-18T18:06:25Z","labels":{"app.kubernetes.io/component":"rabbitmq","app.kubernetes.io/name":"rabbitmq-cluster","app.kubernetes.io/part-of":"rabbitmq"},"ownerReferences":[{"apiVersion":"rabbitmq.com/v1beta1","kind":"RabbitmqCluster","name":"rabbitmq-cluster","uid":"3ecefa8a-1bec-48a7-9af4-dd0df3339101","controller":true,"blockOwnerDeletion":true}],"managedFields":[{"manager":"manager","operation":"Update","apiVersion":"v1","time":"2022-03-18T18:06:25Z","fieldsType":"FieldsV1","fieldsV1":{"f:data":{".":{},"f:operatorDefaults.conf":{},"f:userDefinedConfiguration.conf":{}},"f:metadata":{"f:labels":{".":{},"f:app.kubernetes.io/component":{},"f:app.kubernetes.io/name":{},"f:app.kubernetes.io/part-of":{}},"f:ownerReferences":{".":{},"k:{\"uid\":\"3ecefa8a-1bec-48a7-9af4-dd0df3339101\"}":{".":{},"f:apiVersion":{},"f:blockOwnerDeletion":{},"f:controller":{},"f:kind":{},"f:name":{},"f:uid":{}}}}}}]},"data":{"operatorDefaults.conf":"cluster_formation.peer_discovery_backend             = rabbit_peer_discovery_k8s\ncluster_formation.k8s.host                           = kubernetes.default\ncluster_formation.k8s.address_type                   = hostname\ncluster_partition_handling                           = pause_minority\nqueue_master_locator                                 = min-masters\ndisk_free_limit.absolute                             = 2GB\ncluster_formation.randomized_startup_delay_range.min = 5\ncluster_formation.randomized_startup_delay_range.max = 30\ncluster_name                                         = rabbitmq-cluster\n","userDefinedConfiguration.conf":"total_memory_available_override_value = 1717986919\n"}}
2022/03/18 18:06:55 learn_server.go:291: [SIEVE-AFTER-READ]	Get	true	serviceaccount	default	rabbitmq-cluster-server	github.com/rabbitmq/cluster-operator/controllers.(*RabbitmqClusterReconciler)	NoError	{"kind":"ServiceAccount","apiVersion":"v1","metadata":{"name":"rabbitmq-cluster-server","namespace":"default","selfLink":"/api/v1/namespaces/default/serviceaccounts/rabbitmq-cluster-server","uid":"0c3cead0-37dd-452b-b939-fe346a5dfdea","resourceVersion":"1102","creationTimestamp":"2022-03-18T18:06:25Z","labels":{"app.kubernetes.io/component":"rabbitmq","app.kubernetes.io/name":"rabbitmq-cluster","app.kubernetes.io/part-of":"rabbitmq"},"ownerReferences":[{"apiVersion":"rabbitmq.com/v1beta1","kind":"RabbitmqCluster","name":"rabbitmq-cluster","uid":"3ecefa8a-1bec-48a7-9af4-dd0df3339101","controller":true,"blockOwnerDeletion":true}],"managedFields":[{"manager":"kube-controller-manager","operation":"Update","apiVersion":"v1","time":"2022-03-18T18:06:25Z","fieldsType":"FieldsV1","fieldsV1":{"f:secrets":{".":{},"k:{\"name\":\"rabbitmq-cluster-server-token-v4wpv\"}":{".":{},"f:name":{}}}}},{"manager":"manager","operation":"Update","apiVersion":"v1","time":"2022-03-18T18:06:25Z","fieldsType":"FieldsV1","fieldsV1":{"f:metadata":{"f:labels":{".":{},"f:app.kubernetes.io/component":{},"f:app.kubernetes.io/name":{},"f:app.kubernetes.io/part-of":{}},"f:ownerReferences":{".":{},"k:{\"uid\":\"3ecefa8a-1bec-48a7-9af4-dd0df3339101\"}":{".":{},"f:apiVersion":{},"f:blockOwnerDeletion":{},"f:controller":{},"f:kind":{},"f:name":{},"f:uid":{}}}}}}]},"secrets":[{"name":"rabbitmq-cluster-server-token-v4wpv"}]}
2022/03/18 18:06:55 learn_server.go:291: [SIEVE-AFTER-READ]	Get	true	role	default	rabbitmq-cluster-peer-discovery	github.com/rabbitmq/cluster-operator/controllers.(*RabbitmqClusterReconciler)	NoError	{"kind":"Role","apiVersion":"rbac.authorization.k8s.io/v1","metadata":{"name":"rabbitmq-cluster-peer-discovery","namespace":"default","selfLink":"/apis/rbac.authorization.k8s.io/v1/namespaces/default/roles/rabbitmq-cluster-peer-discovery","uid":"ec9ac474-1880-43ed-af46-9ea5f46d6db4","resourceVersion":"1103","creationTimestamp":"2022-03-18T18:06:25Z","labels":{"app.kubernetes.io/component":"rabbitmq","app.kubernetes.io/name":"rabbitmq-cluster","app.kubernetes.io/part-of":"rabbitmq"},"ownerReferences":[{"apiVersion":"rabbitmq.com/v1beta1","kind":"RabbitmqCluster","name":"rabbitmq-cluster","uid":"3ecefa8a-1bec-48a7-9af4-dd0df3339101","controller":true,"blockOwnerDeletion":true}],"managedFields":[{"manager":"manager","operation":"Update","apiVersion":"rbac.authorization.k8s.io/v1","time":"2022-03-18T18:06:25Z","fieldsType":"FieldsV1","fieldsV1":{"f:metadata":{"f:labels":{".":{},"f:app.kubernetes.io/component":{},"f:app.kubernetes.io/name":{},"f:app.kubernetes.io/part-of":{}},"f:ownerReferences":{".":{},"k:{\"uid\":\"3ecefa8a-1bec-48a7-9af4-dd0df3339101\"}":{".":{},"f:apiVersion":{},"f:blockOwnerDeletion":{},"f:controller":{},"f:kind":{},"f:name":{},"f:uid":{}}}},"f:rules":{}}}]},"rules":[{"verbs":["get"],"apiGroups":[""],"resources":["endpoints"]},{"verbs":["create"],"apiGroups":[""],"resources":["events"]}]}
2022/03/18 18:06:55 learn_server.go:291: [SIEVE-AFTER-READ]	Get	true	rolebinding	default	rabbitmq-cluster-server	github.com/rabbitmq/cluster-operator/controllers.(*RabbitmqClusterReconciler)	NoError	{"kind":"RoleBinding","apiVersion":"rbac.authorization.k8s.io/v1","metadata":{"name":"rabbitmq-cluster-server","namespace":"default","selfLink":"/apis/rbac.authorization.k8s.io/v1/namespaces/default/rolebindings/rabbitmq-cluster-server","uid":"fe69a41c-8d28-4b84-a9f6-a9e6044d75ba","resourceVersion":"1105","creationTimestamp":"2022-03-18T18:06:25Z","labels":{"app.kubernetes.io/component":"rabbitmq","app.kubernetes.io/name":"rabbitmq-cluster","app.kubernetes.io/part-of":"rabbitmq"},"ownerReferences":[{"apiVersion":"rabbitmq.com/v1beta1","kind":"RabbitmqCluster","name":"rabbitmq-cluster","uid":"3ecefa8a-1bec-48a7-9af4-dd0df3339101","controller":true,"blockOwnerDeletion":true}],"managedFields":[{"manager":"manager","operation":"Update","apiVersion":"rbac.authorization.k8s.io/v1","time":"2022-03-18T18:06:25Z","fieldsType":"FieldsV1","fieldsV1":{"f:metadata":{"f:labels":{".":{},"f:app.kubernetes.io/component":{},"f:app.kubernetes.io/name":{},"f:app.kubernetes.io/part-of":{}},"f:ownerReferences":{".":{},"k:{\"uid\":\"3ecefa8a-1bec-48a7-9af4-dd0df3339101\"}":{".":{},"f:apiVersion":{},"f:blockOwnerDeletion":{},"f:controller":{},"f:kind":{},"f:name":{},"f:uid":{}}}},"f:roleRef":{"f:apiGroup":{},"f:kind":{},"f:name":{}},"f:subjects":{}}}]},"subjects":[{"kind":"ServiceAccount","name":"rabbitmq-cluster-server"}],"roleRef":{"apiGroup":"rbac.authorization.k8s.io","kind":"Role","name":"rabbitmq-cluster-peer-discovery"}}
2022/03/18 18:06:55 learn_server.go:291: [SIEVE-AFTER-READ]	Get	true	statefulset	default	rabbitmq-cluster-server	github.com/rabbitmq/cluster-operator/controllers.(*RabbitmqClusterReconciler)	NoError	{"kind":"StatefulSet","apiVersion":"apps/v1","metadata":{"name":"rabbitmq-cluster-server","namespace":"default","selfLink":"/apis/apps/v1/namespaces/default/statefulsets/rabbitmq-cluster-server","uid":"f2f07f3e-b500-4c48-a5de-8db7eaf37b9a","resourceVersion":"1129","generation":1,"creationTimestamp":"2022-03-18T18:06:25Z","labels":{"app.kubernetes.io/component":"rabbitmq","app.kubernetes.io/name":"rabbitmq-cluster","app.kubernetes.io/part-of":"rabbitmq"},"annotations":{"rabbitmq.com/createdAt":"2022-03-18T18:06:25Z"},"ownerReferences":[{"apiVersion":"rabbitmq.com/v1beta1","kind":"RabbitmqCluster","name":"rabbitmq-cluster","uid":"3ecefa8a-1bec-48a7-9af4-dd0df3339101","controller":true,"blockOwnerDeletion":true}],"managedFields":[{"manager":"kube-controller-manager","operation":"Update","apiVersion":"apps/v1","time":"2022-03-18T18:06:25Z","fieldsType":"FieldsV1","fieldsV1":{"f:status":{"f:collisionCount":{},"f:currentReplicas":{},"f:currentRevision":{},"f:observedGeneration":{},"f:replicas":{},"f:updateRevision":{},"f:updatedReplicas":{}}}},{"manager":"manager","operation":"Update","apiVersion":"apps/v1","time":"2022-03-18T18:06:25Z","fieldsType":"FieldsV1","fieldsV1":{"f:metadata":{"f:annotations":{".":{},"f:rabbitmq.com/createdAt":{}},"f:labels":{".":{},"f:app.kubernetes.io/component":{},"f:app.kubernetes.io/name":{},"f:app.kubernetes.io/part-of":{}},"f:ownerReferences":{".":{},"k:{\"uid\":\"3ecefa8a-1bec-48a7-9af4-dd0df3339101\"}":{".":{},"f:apiVersion":{},"f:blockOwnerDeletion":{},"f:controller":{},"f:kind":{},"f:name":{},"f:uid":{}}}},"f:spec":{"f:podManagementPolicy":{},"f:replicas":{},"f:revisionHistoryLimit":{},"f:selector":{"f:matchLabels":{".":{},"f:app.kubernetes.io/name":{}}},"f:serviceName":{},"f:template":{"f:metadata":{"f:annotations":{".":{},"f:prometheus.io/port":{},"f:prometheus.io/scrape":{}},"f:labels":{".":{},"f:app.kubernetes.io/component":{},"f:app.kubernetes.io/name":{},"f:app.kubernetes.io/part-of":{}}},"f:spec":{"f:automountServiceAccountToken":{},"f:containers":{"k:{\"name\":\"rabbitmq\"}":{".":{},"f:env":{".":{},"k:{\"name\":\"K8S_HOSTNAME_SUFFIX\"}":{".":{},"f:name":{},"f:value":{}},"k:{\"name\":\"K8S_SERVICE_NAME\"}":{".":{},"f:name":{},"f:value":{}},"k:{\"name\":\"MY_POD_NAME\"}":{".":{},"f:name":{},"f:valueFrom":{".":{},"f:fieldRef":{".":{},"f:apiVersion":{},"f:fieldPath":{}}}},"k:{\"name\":\"MY_POD_NAMESPACE\"}":{".":{},"f:name":{},"f:valueFrom":{".":{},"f:fieldRef":{".":{},"f:apiVersion":{},"f:fieldPath":{}}}},"k:{\"name\":\"RABBITMQ_ENABLED_PLUGINS_FILE\"}":{".":{},"f:name":{},"f:value":{}},"k:{\"name\":\"RABBITMQ_NODENAME\"}":{".":{},"f:name":{},"f:value":{}},"k:{\"name\":\"RABBITMQ_USE_LONGNAME\"}":{".":{},"f:name":{},"f:value":{}}},"f:image":{},"f:imagePullPolicy":{},"f:lifecycle":{".":{},"f:preStop":{".":{},"f:exec":{".":{},"f:command":{}}}},"f:name":{},"f:ports":{".":{},"k:{\"containerPort\":4369,\"protocol\":\"TCP\"}":{".":{},"f:containerPort":{},"f:name":{},"f:protocol":{}},"k:{\"containerPort\":5672,\"protocol\":\"TCP\"}":{".":{},"f:containerPort":{},"f:name":{},"f:protocol":{}},"k:{\"containerPort\":15672,\"protocol\":\"TCP\"}":{".":{},"f:containerPort":{},"f:name":{},"f:protocol":{}},"k:{\"containerPort\":15692,\"protocol\":\"TCP\"}":{".":{},"f:containerPort":{},"f:name":{},"f:protocol":{}}},"f:readinessProbe":{".":{},"f:failureThreshold":{},"f:initialDelaySeconds":{},"f:periodSeconds":{},"f:successThreshold":{},"f:tcpSocket":{".":{},"f:port":{}},"f:timeoutSeconds":{}},"f:resources":{".":{},"f:limits":{".":{},"f:cpu":{},"f:memory":{}},"f:requests":{".":{},"f:cpu":{},"f:memory":{}}},"f:terminationMessagePath":{},"f:terminationMessagePolicy":{},"f:volumeMounts":{".":{},"k:{\"mountPath\":\"/etc/pod-info/\"}":{".":{},"f:mountPath":{},"f:name":{}},"k:{\"mountPath\":\"/etc/rabbitmq/conf.d/10-operatorDefaults.conf\"}":{".":{},"f:mountPath":{},"f:name":{},"f:subPath":{}},"k:{\"mountPath\":\"/etc/rabbitmq/conf.d/11-default_user.conf\"}":{".":{},"f:mountPath":{},"f:name":{},"f:subPath":{}},"k:{\"mountPath\":\"/etc/rabbitmq/conf.d/90-userDefinedConfiguration.conf\"}":{".":{},"f:mountPath":{},"f:name":{},"f:subPath":{}},"k:{\"mountPath\":\"/operator\"}":{".":{},"f:mountPath":{},"f:name":{}},"k:{\"mountPath\":\"/var/lib/rabbitmq/\"}":{".":{},"f:mountPath":{},"f:name":{}},"k:{\"mountPath\":\"/var/lib/rabbitmq/mnesia/\"}":{".":{},"f:mountPath":{},"f:name":{}}}}},"f:dnsPolicy":{},"f:initContainers":{".":{},"k:{\"name\":\"setup-container\"}":{".":{},"f:command":{},"f:image":{},"f:imagePullPolicy":{},"f:name":{},"f:resources":{".":{},"f:limits":{".":{},"f:cpu":{},"f:memory":{}},"f:requests":{".":{},"f:cpu":{},"f:memory":{}}},"f:securityContext":{".":{},"f:capabilities":{".":{},"f:drop":{}},"f:runAsUser":{}},"f:terminationMessagePath":{},"f:terminationMessagePolicy":{},"f:volumeMounts":{".":{},"k:{\"mountPath\":\"/operator\"}":{".":{},"f:mountPath":{},"f:name":{}},"k:{\"mountPath\":\"/tmp/default_user.conf\"}":{".":{},"f:mountPath":{},"f:name":{},"f:subPath":{}},"k:{\"mountPath\":\"/tmp/erlang-cookie-secret/\"}":{".":{},"f:mountPath":{},"f:name":{}},"k:{\"mountPath\":\"/tmp/rabbitmq-plugins/\"}":{".":{},"f:mountPath":{},"f:name":{}},"k:{\"mountPath\":\"/var/lib/rabbitmq/\"}":{".":{},"f:mountPath":{},"f:name":{}},"k:{\"mountPath\":\"/var/lib/rabbitmq/mnesia/\"}":{".":{},"f:mountPath":{},"f:name":{}}}}},"f:restartPolicy":{},"f:schedulerName":{},"f:securityContext":{".":{},"f:fsGroup":{},"f:runAsGroup":{},"f:runAsUser":{}},"f:serviceAccount":{},"f:serviceAccountName":{},"f:terminationGracePeriodSeconds":{},"f:topologySpreadConstraints":{".":{},"k:{\"topologyKey\":\"topology.kubernetes.io/zone\",\"whenUnsatisfiable\":\"ScheduleAnyway\"}":{".":{},"f:labelSelector":{".":{},"f:matchLabels":{".":{},"f:app.kubernetes.io/name":{}}},"f:maxSkew":{},"f:topologyKey":{},"f:whenUnsatisfiable":{}}},"f:volumes":{".":{},"k:{\"name\":\"erlang-cookie-secret\"}":{".":{},"f:name":{},"f:secret":{".":{},"f:defaultMode":{},"f:secretName":{}}},"k:{\"name\":\"plugins-conf\"}":{".":{},"f:configMap":{".":{},"f:defaultMode":{},"f:name":{}},"f:name":{}},"k:{\"name\":\"pod-info\"}":{".":{},"f:downwardAPI":{".":{},"f:defaultMode":{},"f:items":{}},"f:name":{}},"k:{\"name\":\"rabbitmq-confd\"}":{".":{},"f:name":{},"f:projected":{".":{},"f:defaultMode":{},"f:sources":{}}},"k:{\"name\":\"rabbitmq-erlang-cookie\"}":{".":{},"f:emptyDir":{},"f:name":{}},"k:{\"name\":\"rabbitmq-plugins\"}":{".":{},"f:emptyDir":{},"f:name":{}}}}},"f:updateStrategy":{"f:rollingUpdate":{".":{},"f:partition":{}},"f:type":{}},"f:volumeClaimTemplates":{}}}}]},"spec":{"replicas":1,"selector":{"matchLabels":{"app.kubernetes.io/name":"rabbitmq-cluster"}},"template":{"metadata":{"creationTimestamp":null,"labels":{"app.kubernetes.io/component":"rabbitmq","app.kubernetes.io/name":"rabbitmq-cluster","app.kubernetes.io/part-of":"rabbitmq"},"annotations":{"prometheus.io/port":"15692","prometheus.io/scrape":"true"}},"spec":{"volumes":[{"name":"plugins-conf","configMap":{"name":"rabbitmq-cluster-plugins-conf","defaultMode":420}},{"name":"rabbitmq-confd","projected":{"sources":[{"secret":{"name":"rabbitmq-cluster-default-user","items":[{"key":"default_user.conf","path":"default_user.conf"}]}},{"configMap":{"name":"rabbitmq-cluster-server-conf","items":[{"key":"operatorDefaults.conf","path":"operatorDefaults.conf"},{"key":"userDefinedConfiguration.conf","path":"userDefinedConfiguration.conf"}]}}],"defaultMode":420}},{"name":"rabbitmq-erlang-cookie","emptyDir":{}},{"name":"erlang-cookie-secret","secret":{"secretName":"rabbitmq-cluster-erlang-cookie","defaultMode":420}},{"name":"rabbitmq-plugins","emptyDir":{}},{"name":"pod-info","downwardAPI":{"items":[{"path":"skipPreStopChecks","fieldRef":{"apiVersion":"v1","fieldPath":"metadata.labels['skipPreStopChecks']"}}],"defaultMode":420}}],"initContainers":[{"name":"setup-container","image":"rabbitmq:3.8.12-management","command":["sh","-c","cp /tmp/erlang-cookie-secret/.erlang.cookie /var/lib/rabbitmq/.erlang.cookie \u0026\u0026 chown 999:999 /var/lib/rabbitmq/.erlang.cookie \u0026\u0026 chmod 600 /var/lib/rabbitmq/.erlang.cookie ; cp /tmp/rabbitmq-plugins/enabled_plugins /operator/enabled_plugins \u0026\u0026 chown 999:999 /operator/enabled_plugins ; chown 999:999 /var/lib/rabbitmq/mnesia/ ; echo '[default]' \u003e /var/lib/rabbitmq/.rabbitmqadmin.conf \u0026\u0026 sed -e 's/default_user/username/' -e 's/default_pass/password/' /tmp/default_user.conf \u003e\u003e /var/lib/rabbitmq/.rabbitmqadmin.conf \u0026\u0026 chown 999:999 /var/lib/rabbitmq/.rabbitmqadmin.conf \u0026\u0026 chmod 600 /var/lib/rabbitmq/.rabbitmqadmin.conf"],"resources":{"limits":{"cpu":"100m","memory":"500Mi"},"requests":{"cpu":"100m","memory":"500Mi"}},"volumeMounts":[{"name":"plugins-conf","mountPath":"/tmp/rabbitmq-plugins/"},{"name":"rabbitmq-erlang-cookie","mountPath":"/var/lib/rabbitmq/"},{"name":"erlang-cookie-secret","mountPath":"/tmp/erlang-cookie-secret/"},{"name":"rabbitmq-plugins","mountPath":"/operator"},{"name":"persistence","mountPath":"/var/lib/rabbitmq/mnesia/"},{"name":"rabbitmq-confd","mountPath":"/tmp/default_user.conf","subPath":"default_user.conf"}],"terminationMessagePath":"/dev/termination-log","terminationMessagePolicy":"File","imagePullPolicy":"IfNotPresent","securityContext":{"capabilities":{"drop":["FSETID","KILL","SETGID","SETUID","SETPCAP","NET_BIND_SERVICE","NET_RAW","SYS_CHROOT","MKNOD","AUDIT_WRITE","SETFCAP"]},"runAsUser":0}}],"containers":[{"name":"rabbitmq","image":"rabbitmq:3.8.12-management","ports":[{"name":"epmd","containerPort":4369,"protocol":"TCP"},{"name":"amqp","containerPort":5672,"protocol":"TCP"},{"name":"management","containerPort":15672,"protocol":"TCP"},{"name":"prometheus","containerPort":15692,"protocol":"TCP"}],"env":[{"name":"MY_POD_NAME","valueFrom":{"fieldRef":{"apiVersion":"v1","fieldPath":"metadata.name"}}},{"name":"MY_POD_NAMESPACE","valueFrom":{"fieldRef":{"apiVersion":"v1","fieldPath":"metadata.namespace"}}},{"name":"RABBITMQ_ENABLED_PLUGINS_FILE","value":"/operator/enabled_plugins"},{"name":"K8S_SERVICE_NAME","value":"rabbitmq-cluster-nodes"},{"name":"RABBITMQ_USE_LONGNAME","value":"true"},{"name":"RABBITMQ_NODENAME","value":"rabbit@$(MY_POD_NAME).$(K8S_SERVICE_NAME).$(MY_POD_NAMESPACE)"},{"name":"K8S_HOSTNAME_SUFFIX","value":".$(K8S_SERVICE_NAME).$(MY_POD_NAMESPACE)"}],"resources":{"limits":{"cpu":"2","memory":"2Gi"},"requests":{"cpu":"1","memory":"2Gi"}},"volumeMounts":[{"name":"rabbitmq-erlang-cookie","mountPath":"/var/lib/rabbitmq/"},{"name":"persistence","mountPath":"/var/lib/rabbitmq/mnesia/"},{"name":"rabbitmq-plugins","mountPath":"/operator"},{"name":"rabbitmq-confd","mountPath":"/etc/rabbitmq/conf.d/10-operatorDefaults.conf","subPath":"operatorDefaults.conf"},{"name":"rabbitmq-confd","mountPath":"/etc/rabbitmq/conf.d/11-default_user.conf","subPath":"default_user.conf"},{"name":"rabbitmq-confd","mountPath":"/etc/rabbitmq/conf.d/90-userDefinedConfiguration.conf","subPath":"userDefinedConfiguration.conf"},{"name":"pod-info","mountPath":"/etc/pod-info/"}],"readinessProbe":{"tcpSocket":{"port":"amqp"},"initialDelaySeconds":10,"timeoutSeconds":5,"periodSeconds":10,"successThreshold":1,"failureThreshold":3},"lifecycle":{"preStop":{"exec":{"command":["/bin/bash","-c","if [ ! -z \"$(cat /etc/pod-info/skipPreStopChecks)\" ]; then exit 0; fi; rabbitmq-upgrade await_online_quorum_plus_one -t 604800; rabbitmq-upgrade await_online_synchronized_mirror -t 604800; rabbitmq-upgrade drain -t 604800"]}}},"terminationMessagePath":"/dev/termination-log","terminationMessagePolicy":"File","imagePullPolicy":"IfNotPresent"}],"restartPolicy":"Always","terminationGracePeriodSeconds":604800,"dnsPolicy":"ClusterFirst","serviceAccountName":"rabbitmq-cluster-server","serviceAccount":"rabbitmq-cluster-server","automountServiceAccountToken":true,"securityContext":{"runAsUser":999,"runAsGroup":999,"fsGroup":999},"schedulerName":"default-scheduler","topologySpreadConstraints":[{"maxSkew":1,"topologyKey":"topology.kubernetes.io/zone","whenUnsatisfiable":"ScheduleAnyway","labelSelector":{"matchLabels":{"app.kubernetes.io/name":"rabbitmq-cluster"}}}]}},"volumeClaimTemplates":[{"metadata":{"name":"persistence","namespace":"default","creationTimestamp":null,"labels":{"app.kubernetes.io/component":"rabbitmq","app.kubernetes.io/name":"rabbitmq-cluster","app.kubernetes.io/part-of":"rabbitmq"},"ownerReferences":[{"apiVersion":"rabbitmq.com/v1beta1","kind":"RabbitmqCluster","name":"rabbitmq-cluster","uid":"3ecefa8a-1bec-48a7-9af4-dd0df3339101","controller":true,"blockOwnerDeletion":false}]},"spec":{"accessModes":["ReadWriteOnce"],"resources":{"requests":{"storage":"10Gi"}},"volumeMode":"Filesystem"},"status":{"phase":"Pending"}}],"serviceName":"rabbitmq-cluster-nodes","podManagementPolicy":"Parallel","updateStrategy":{"type":"RollingUpdate","rollingUpdate":{"partition":0}},"revisionHistoryLimit":10},"status":{"observedGeneration":1,"replicas":1,"currentReplicas":1,"updatedReplicas":1,"currentRevision":"rabbitmq-cluster-server-5f8b8665fb","updateRevision":"rabbitmq-cluster-server-5f8b8665fb","collisionCount":0}}
2022/03/18 18:06:55 learn_server.go:291: [SIEVE-AFTER-READ]	Get	true	statefulset	default	rabbitmq-cluster-server	github.com/rabbitmq/cluster-operator/controllers.(*RabbitmqClusterReconciler)	NoError	{"kind":"StatefulSet","apiVersion":"apps/v1","metadata":{"name":"rabbitmq-cluster-server","namespace":"default","selfLink":"/apis/apps/v1/namespaces/default/statefulsets/rabbitmq-cluster-server","uid":"f2f07f3e-b500-4c48-a5de-8db7eaf37b9a","resourceVersion":"1129","generation":1,"creationTimestamp":"2022-03-18T18:06:25Z","labels":{"app.kubernetes.io/component":"rabbitmq","app.kubernetes.io/name":"rabbitmq-cluster","app.kubernetes.io/part-of":"rabbitmq"},"annotations":{"rabbitmq.com/createdAt":"2022-03-18T18:06:25Z"},"ownerReferences":[{"apiVersion":"rabbitmq.com/v1beta1","kind":"RabbitmqCluster","name":"rabbitmq-cluster","uid":"3ecefa8a-1bec-48a7-9af4-dd0df3339101","controller":true,"blockOwnerDeletion":true}],"managedFields":[{"manager":"kube-controller-manager","operation":"Update","apiVersion":"apps/v1","time":"2022-03-18T18:06:25Z","fieldsType":"FieldsV1","fieldsV1":{"f:status":{"f:collisionCount":{},"f:currentReplicas":{},"f:currentRevision":{},"f:observedGeneration":{},"f:replicas":{},"f:updateRevision":{},"f:updatedReplicas":{}}}},{"manager":"manager","operation":"Update","apiVersion":"apps/v1","time":"2022-03-18T18:06:25Z","fieldsType":"FieldsV1","fieldsV1":{"f:metadata":{"f:annotations":{".":{},"f:rabbitmq.com/createdAt":{}},"f:labels":{".":{},"f:app.kubernetes.io/component":{},"f:app.kubernetes.io/name":{},"f:app.kubernetes.io/part-of":{}},"f:ownerReferences":{".":{},"k:{\"uid\":\"3ecefa8a-1bec-48a7-9af4-dd0df3339101\"}":{".":{},"f:apiVersion":{},"f:blockOwnerDeletion":{},"f:controller":{},"f:kind":{},"f:name":{},"f:uid":{}}}},"f:spec":{"f:podManagementPolicy":{},"f:replicas":{},"f:revisionHistoryLimit":{},"f:selector":{"f:matchLabels":{".":{},"f:app.kubernetes.io/name":{}}},"f:serviceName":{},"f:template":{"f:metadata":{"f:annotations":{".":{},"f:prometheus.io/port":{},"f:prometheus.io/scrape":{}},"f:labels":{".":{},"f:app.kubernetes.io/component":{},"f:app.kubernetes.io/name":{},"f:app.kubernetes.io/part-of":{}}},"f:spec":{"f:automountServiceAccountToken":{},"f:containers":{"k:{\"name\":\"rabbitmq\"}":{".":{},"f:env":{".":{},"k:{\"name\":\"K8S_HOSTNAME_SUFFIX\"}":{".":{},"f:name":{},"f:value":{}},"k:{\"name\":\"K8S_SERVICE_NAME\"}":{".":{},"f:name":{},"f:value":{}},"k:{\"name\":\"MY_POD_NAME\"}":{".":{},"f:name":{},"f:valueFrom":{".":{},"f:fieldRef":{".":{},"f:apiVersion":{},"f:fieldPath":{}}}},"k:{\"name\":\"MY_POD_NAMESPACE\"}":{".":{},"f:name":{},"f:valueFrom":{".":{},"f:fieldRef":{".":{},"f:apiVersion":{},"f:fieldPath":{}}}},"k:{\"name\":\"RABBITMQ_ENABLED_PLUGINS_FILE\"}":{".":{},"f:name":{},"f:value":{}},"k:{\"name\":\"RABBITMQ_NODENAME\"}":{".":{},"f:name":{},"f:value":{}},"k:{\"name\":\"RABBITMQ_USE_LONGNAME\"}":{".":{},"f:name":{},"f:value":{}}},"f:image":{},"f:imagePullPolicy":{},"f:lifecycle":{".":{},"f:preStop":{".":{},"f:exec":{".":{},"f:command":{}}}},"f:name":{},"f:ports":{".":{},"k:{\"containerPort\":4369,\"protocol\":\"TCP\"}":{".":{},"f:containerPort":{},"f:name":{},"f:protocol":{}},"k:{\"containerPort\":5672,\"protocol\":\"TCP\"}":{".":{},"f:containerPort":{},"f:name":{},"f:protocol":{}},"k:{\"containerPort\":15672,\"protocol\":\"TCP\"}":{".":{},"f:containerPort":{},"f:name":{},"f:protocol":{}},"k:{\"containerPort\":15692,\"protocol\":\"TCP\"}":{".":{},"f:containerPort":{},"f:name":{},"f:protocol":{}}},"f:readinessProbe":{".":{},"f:failureThreshold":{},"f:initialDelaySeconds":{},"f:periodSeconds":{},"f:successThreshold":{},"f:tcpSocket":{".":{},"f:port":{}},"f:timeoutSeconds":{}},"f:resources":{".":{},"f:limits":{".":{},"f:cpu":{},"f:memory":{}},"f:requests":{".":{},"f:cpu":{},"f:memory":{}}},"f:terminationMessagePath":{},"f:terminationMessagePolicy":{},"f:volumeMounts":{".":{},"k:{\"mountPath\":\"/etc/pod-info/\"}":{".":{},"f:mountPath":{},"f:name":{}},"k:{\"mountPath\":\"/etc/rabbitmq/conf.d/10-operatorDefaults.conf\"}":{".":{},"f:mountPath":{},"f:name":{},"f:subPath":{}},"k:{\"mountPath\":\"/etc/rabbitmq/conf.d/11-default_user.conf\"}":{".":{},"f:mountPath":{},"f:name":{},"f:subPath":{}},"k:{\"mountPath\":\"/etc/rabbitmq/conf.d/90-userDefinedConfiguration.conf\"}":{".":{},"f:mountPath":{},"f:name":{},"f:subPath":{}},"k:{\"mountPath\":\"/operator\"}":{".":{},"f:mountPath":{},"f:name":{}},"k:{\"mountPath\":\"/var/lib/rabbitmq/\"}":{".":{},"f:mountPath":{},"f:name":{}},"k:{\"mountPath\":\"/var/lib/rabbitmq/mnesia/\"}":{".":{},"f:mountPath":{},"f:name":{}}}}},"f:dnsPolicy":{},"f:initContainers":{".":{},"k:{\"name\":\"setup-container\"}":{".":{},"f:command":{},"f:image":{},"f:imagePullPolicy":{},"f:name":{},"f:resources":{".":{},"f:limits":{".":{},"f:cpu":{},"f:memory":{}},"f:requests":{".":{},"f:cpu":{},"f:memory":{}}},"f:securityContext":{".":{},"f:capabilities":{".":{},"f:drop":{}},"f:runAsUser":{}},"f:terminationMessagePath":{},"f:terminationMessagePolicy":{},"f:volumeMounts":{".":{},"k:{\"mountPath\":\"/operator\"}":{".":{},"f:mountPath":{},"f:name":{}},"k:{\"mountPath\":\"/tmp/default_user.conf\"}":{".":{},"f:mountPath":{},"f:name":{},"f:subPath":{}},"k:{\"mountPath\":\"/tmp/erlang-cookie-secret/\"}":{".":{},"f:mountPath":{},"f:name":{}},"k:{\"mountPath\":\"/tmp/rabbitmq-plugins/\"}":{".":{},"f:mountPath":{},"f:name":{}},"k:{\"mountPath\":\"/var/lib/rabbitmq/\"}":{".":{},"f:mountPath":{},"f:name":{}},"k:{\"mountPath\":\"/var/lib/rabbitmq/mnesia/\"}":{".":{},"f:mountPath":{},"f:name":{}}}}},"f:restartPolicy":{},"f:schedulerName":{},"f:securityContext":{".":{},"f:fsGroup":{},"f:runAsGroup":{},"f:runAsUser":{}},"f:serviceAccount":{},"f:serviceAccountName":{},"f:terminationGracePeriodSeconds":{},"f:topologySpreadConstraints":{".":{},"k:{\"topologyKey\":\"topology.kubernetes.io/zone\",\"whenUnsatisfiable\":\"ScheduleAnyway\"}":{".":{},"f:labelSelector":{".":{},"f:matchLabels":{".":{},"f:app.kubernetes.io/name":{}}},"f:maxSkew":{},"f:topologyKey":{},"f:whenUnsatisfiable":{}}},"f:volumes":{".":{},"k:{\"name\":\"erlang-cookie-secret\"}":{".":{},"f:name":{},"f:secret":{".":{},"f:defaultMode":{},"f:secretName":{}}},"k:{\"name\":\"plugins-conf\"}":{".":{},"f:configMap":{".":{},"f:defaultMode":{},"f:name":{}},"f:name":{}},"k:{\"name\":\"pod-info\"}":{".":{},"f:downwardAPI":{".":{},"f:defaultMode":{},"f:items":{}},"f:name":{}},"k:{\"name\":\"rabbitmq-confd\"}":{".":{},"f:name":{},"f:projected":{".":{},"f:defaultMode":{},"f:sources":{}}},"k:{\"name\":\"rabbitmq-erlang-cookie\"}":{".":{},"f:emptyDir":{},"f:name":{}},"k:{\"name\":\"rabbitmq-plugins\"}":{".":{},"f:emptyDir":{},"f:name":{}}}}},"f:updateStrategy":{"f:rollingUpdate":{".":{},"f:partition":{}},"f:type":{}},"f:volumeClaimTemplates":{}}}}]},"spec":{"replicas":1,"selector":{"matchLabels":{"app.kubernetes.io/name":"rabbitmq-cluster"}},"template":{"metadata":{"creationTimestamp":null,"labels":{"app.kubernetes.io/component":"rabbitmq","app.kubernetes.io/name":"rabbitmq-cluster","app.kubernetes.io/part-of":"rabbitmq"},"annotations":{"prometheus.io/port":"15692","prometheus.io/scrape":"true"}},"spec":{"volumes":[{"name":"plugins-conf","configMap":{"name":"rabbitmq-cluster-plugins-conf","defaultMode":420}},{"name":"rabbitmq-confd","projected":{"sources":[{"secret":{"name":"rabbitmq-cluster-default-user","items":[{"key":"default_user.conf","path":"default_user.conf"}]}},{"configMap":{"name":"rabbitmq-cluster-server-conf","items":[{"key":"operatorDefaults.conf","path":"operatorDefaults.conf"},{"key":"userDefinedConfiguration.conf","path":"userDefinedConfiguration.conf"}]}}],"defaultMode":420}},{"name":"rabbitmq-erlang-cookie","emptyDir":{}},{"name":"erlang-cookie-secret","secret":{"secretName":"rabbitmq-cluster-erlang-cookie","defaultMode":420}},{"name":"rabbitmq-plugins","emptyDir":{}},{"name":"pod-info","downwardAPI":{"items":[{"path":"skipPreStopChecks","fieldRef":{"apiVersion":"v1","fieldPath":"metadata.labels['skipPreStopChecks']"}}],"defaultMode":420}}],"initContainers":[{"name":"setup-container","image":"rabbitmq:3.8.12-management","command":["sh","-c","cp /tmp/erlang-cookie-secret/.erlang.cookie /var/lib/rabbitmq/.erlang.cookie \u0026\u0026 chown 999:999 /var/lib/rabbitmq/.erlang.cookie \u0026\u0026 chmod 600 /var/lib/rabbitmq/.erlang.cookie ; cp /tmp/rabbitmq-plugins/enabled_plugins /operator/enabled_plugins \u0026\u0026 chown 999:999 /operator/enabled_plugins ; chown 999:999 /var/lib/rabbitmq/mnesia/ ; echo '[default]' \u003e /var/lib/rabbitmq/.rabbitmqadmin.conf \u0026\u0026 sed -e 's/default_user/username/' -e 's/default_pass/password/' /tmp/default_user.conf \u003e\u003e /var/lib/rabbitmq/.rabbitmqadmin.conf \u0026\u0026 chown 999:999 /var/lib/rabbitmq/.rabbitmqadmin.conf \u0026\u0026 chmod 600 /var/lib/rabbitmq/.rabbitmqadmin.conf"],"resources":{"limits":{"cpu":"100m","memory":"500Mi"},"requests":{"cpu":"100m","memory":"500Mi"}},"volumeMounts":[{"name":"plugins-conf","mountPath":"/tmp/rabbitmq-plugins/"},{"name":"rabbitmq-erlang-cookie","mountPath":"/var/lib/rabbitmq/"},{"name":"erlang-cookie-secret","mountPath":"/tmp/erlang-cookie-secret/"},{"name":"rabbitmq-plugins","mountPath":"/operator"},{"name":"persistence","mountPath":"/var/lib/rabbitmq/mnesia/"},{"name":"rabbitmq-confd","mountPath":"/tmp/default_user.conf","subPath":"default_user.conf"}],"terminationMessagePath":"/dev/termination-log","terminationMessagePolicy":"File","imagePullPolicy":"IfNotPresent","securityContext":{"capabilities":{"drop":["FSETID","KILL","SETGID","SETUID","SETPCAP","NET_BIND_SERVICE","NET_RAW","SYS_CHROOT","MKNOD","AUDIT_WRITE","SETFCAP"]},"runAsUser":0}}],"containers":[{"name":"rabbitmq","image":"rabbitmq:3.8.12-management","ports":[{"name":"epmd","containerPort":4369,"protocol":"TCP"},{"name":"amqp","containerPort":5672,"protocol":"TCP"},{"name":"management","containerPort":15672,"protocol":"TCP"},{"name":"prometheus","containerPort":15692,"protocol":"TCP"}],"env":[{"name":"MY_POD_NAME","valueFrom":{"fieldRef":{"apiVersion":"v1","fieldPath":"metadata.name"}}},{"name":"MY_POD_NAMESPACE","valueFrom":{"fieldRef":{"apiVersion":"v1","fieldPath":"metadata.namespace"}}},{"name":"RABBITMQ_ENABLED_PLUGINS_FILE","value":"/operator/enabled_plugins"},{"name":"K8S_SERVICE_NAME","value":"rabbitmq-cluster-nodes"},{"name":"RABBITMQ_USE_LONGNAME","value":"true"},{"name":"RABBITMQ_NODENAME","value":"rabbit@$(MY_POD_NAME).$(K8S_SERVICE_NAME).$(MY_POD_NAMESPACE)"},{"name":"K8S_HOSTNAME_SUFFIX","value":".$(K8S_SERVICE_NAME).$(MY_POD_NAMESPACE)"}],"resources":{"limits":{"cpu":"2","memory":"2Gi"},"requests":{"cpu":"1","memory":"2Gi"}},"volumeMounts":[{"name":"rabbitmq-erlang-cookie","mountPath":"/var/lib/rabbitmq/"},{"name":"persistence","mountPath":"/var/lib/rabbitmq/mnesia/"},{"name":"rabbitmq-plugins","mountPath":"/operator"},{"name":"rabbitmq-confd","mountPath":"/etc/rabbitmq/conf.d/10-operatorDefaults.conf","subPath":"operatorDefaults.conf"},{"name":"rabbitmq-confd","mountPath":"/etc/rabbitmq/conf.d/11-default_user.conf","subPath":"default_user.conf"},{"name":"rabbitmq-confd","mountPath":"/etc/rabbitmq/conf.d/90-userDefinedConfiguration.conf","subPath":"userDefinedConfiguration.conf"},{"name":"pod-info","mountPath":"/etc/pod-info/"}],"readinessProbe":{"tcpSocket":{"port":"amqp"},"initialDelaySeconds":10,"timeoutSeconds":5,"periodSeconds":10,"successThreshold":1,"failureThreshold":3},"lifecycle":{"preStop":{"exec":{"command":["/bin/bash","-c","if [ ! -z \"$(cat /etc/pod-info/skipPreStopChecks)\" ]; then exit 0; fi; rabbitmq-upgrade await_online_quorum_plus_one -t 604800; rabbitmq-upgrade await_online_synchronized_mirror -t 604800; rabbitmq-upgrade drain -t 604800"]}}},"terminationMessagePath":"/dev/termination-log","terminationMessagePolicy":"File","imagePullPolicy":"IfNotPresent"}],"restartPolicy":"Always","terminationGracePeriodSeconds":604800,"dnsPolicy":"ClusterFirst","serviceAccountName":"rabbitmq-cluster-server","serviceAccount":"rabbitmq-cluster-server","automountServiceAccountToken":true,"securityContext":{"runAsUser":999,"runAsGroup":999,"fsGroup":999},"schedulerName":"default-scheduler","topologySpreadConstraints":[{"maxSkew":1,"topologyKey":"topology.kubernetes.io/zone","whenUnsatisfiable":"ScheduleAnyway","labelSelector":{"matchLabels":{"app.kubernetes.io/name":"rabbitmq-cluster"}}}]}},"volumeClaimTemplates":[{"metadata":{"name":"persistence","namespace":"default","creationTimestamp":null,"labels":{"app.kubernetes.io/component":"rabbitmq","app.kubernetes.io/name":"rabbitmq-cluster","app.kubernetes.io/part-of":"rabbitmq"},"ownerReferences":[{"apiVersion":"rabbitmq.com/v1beta1","kind":"RabbitmqCluster","name":"rabbitmq-cluster","uid":"3ecefa8a-1bec-48a7-9af4-dd0df3339101","controller":true,"blockOwnerDeletion":false}]},"spec":{"accessModes":["ReadWriteOnce"],"resources":{"requests":{"storage":"10Gi"}},"volumeMode":"Filesystem"},"status":{"phase":"Pending"}}],"serviceName":"rabbitmq-cluster-nodes","podManagementPolicy":"Parallel","updateStrategy":{"type":"RollingUpdate","rollingUpdate":{"partition":0}},"revisionHistoryLimit":10},"status":{"observedGeneration":1,"replicas":1,"currentReplicas":1,"updatedReplicas":1,"currentRevision":"rabbitmq-cluster-server-5f8b8665fb","updateRevision":"rabbitmq-cluster-server-5f8b8665fb","collisionCount":0}}
2022/03/18 18:06:55 learn_server.go:256: [SIEVE-BEFORE-WRITE]	22
2022/03/18 18:06:55 learn_server.go:263: [SIEVE-AFTER-WRITE]	22	Update	statefulset	github.com/rabbitmq/cluster-operator/controllers.(*RabbitmqClusterReconciler)	NoError	{"metadata":{"name":"rabbitmq-cluster-server","namespace":"default","selfLink":"/apis/apps/v1/namespaces/default/statefulsets/rabbitmq-cluster-server","uid":"f2f07f3e-b500-4c48-a5de-8db7eaf37b9a","resourceVersion":"1129","generation":1,"creationTimestamp":"2022-03-18T18:06:25Z","labels":{"app.kubernetes.io/component":"rabbitmq","app.kubernetes.io/name":"rabbitmq-cluster","app.kubernetes.io/part-of":"rabbitmq"},"annotations":{"rabbitmq.com/createdAt":"2022-03-18T18:06:25Z"},"ownerReferences":[{"apiVersion":"rabbitmq.com/v1beta1","kind":"RabbitmqCluster","name":"rabbitmq-cluster","uid":"3ecefa8a-1bec-48a7-9af4-dd0df3339101","controller":true,"blockOwnerDeletion":true}],"managedFields":[{"manager":"kube-controller-manager","operation":"Update","apiVersion":"apps/v1","time":"2022-03-18T18:06:25Z","fieldsType":"FieldsV1","fieldsV1":{"f:status":{"f:collisionCount":{},"f:currentReplicas":{},"f:currentRevision":{},"f:observedGeneration":{},"f:replicas":{},"f:updateRevision":{},"f:updatedReplicas":{}}}},{"manager":"manager","operation":"Update","apiVersion":"apps/v1","time":"2022-03-18T18:06:25Z","fieldsType":"FieldsV1","fieldsV1":{"f:metadata":{"f:annotations":{".":{},"f:rabbitmq.com/createdAt":{}},"f:labels":{".":{},"f:app.kubernetes.io/component":{},"f:app.kubernetes.io/name":{},"f:app.kubernetes.io/part-of":{}},"f:ownerReferences":{".":{},"k:{\"uid\":\"3ecefa8a-1bec-48a7-9af4-dd0df3339101\"}":{".":{},"f:apiVersion":{},"f:blockOwnerDeletion":{},"f:controller":{},"f:kind":{},"f:name":{},"f:uid":{}}}},"f:spec":{"f:podManagementPolicy":{},"f:replicas":{},"f:revisionHistoryLimit":{},"f:selector":{"f:matchLabels":{".":{},"f:app.kubernetes.io/name":{}}},"f:serviceName":{},"f:template":{"f:metadata":{"f:annotations":{".":{},"f:prometheus.io/port":{},"f:prometheus.io/scrape":{}},"f:labels":{".":{},"f:app.kubernetes.io/component":{},"f:app.kubernetes.io/name":{},"f:app.kubernetes.io/part-of":{}}},"f:spec":{"f:automountServiceAccountToken":{},"f:containers":{"k:{\"name\":\"rabbitmq\"}":{".":{},"f:env":{".":{},"k:{\"name\":\"K8S_HOSTNAME_SUFFIX\"}":{".":{},"f:name":{},"f:value":{}},"k:{\"name\":\"K8S_SERVICE_NAME\"}":{".":{},"f:name":{},"f:value":{}},"k:{\"name\":\"MY_POD_NAME\"}":{".":{},"f:name":{},"f:valueFrom":{".":{},"f:fieldRef":{".":{},"f:apiVersion":{},"f:fieldPath":{}}}},"k:{\"name\":\"MY_POD_NAMESPACE\"}":{".":{},"f:name":{},"f:valueFrom":{".":{},"f:fieldRef":{".":{},"f:apiVersion":{},"f:fieldPath":{}}}},"k:{\"name\":\"RABBITMQ_ENABLED_PLUGINS_FILE\"}":{".":{},"f:name":{},"f:value":{}},"k:{\"name\":\"RABBITMQ_NODENAME\"}":{".":{},"f:name":{},"f:value":{}},"k:{\"name\":\"RABBITMQ_USE_LONGNAME\"}":{".":{},"f:name":{},"f:value":{}}},"f:image":{},"f:imagePullPolicy":{},"f:lifecycle":{".":{},"f:preStop":{".":{},"f:exec":{".":{},"f:command":{}}}},"f:name":{},"f:ports":{".":{},"k:{\"containerPort\":4369,\"protocol\":\"TCP\"}":{".":{},"f:containerPort":{},"f:name":{},"f:protocol":{}},"k:{\"containerPort\":5672,\"protocol\":\"TCP\"}":{".":{},"f:containerPort":{},"f:name":{},"f:protocol":{}},"k:{\"containerPort\":15672,\"protocol\":\"TCP\"}":{".":{},"f:containerPort":{},"f:name":{},"f:protocol":{}},"k:{\"containerPort\":15692,\"protocol\":\"TCP\"}":{".":{},"f:containerPort":{},"f:name":{},"f:protocol":{}}},"f:readinessProbe":{".":{},"f:failureThreshold":{},"f:initialDelaySeconds":{},"f:periodSeconds":{},"f:successThreshold":{},"f:tcpSocket":{".":{},"f:port":{}},"f:timeoutSeconds":{}},"f:resources":{".":{},"f:limits":{".":{},"f:cpu":{},"f:memory":{}},"f:requests":{".":{},"f:cpu":{},"f:memory":{}}},"f:terminationMessagePath":{},"f:terminationMessagePolicy":{},"f:volumeMounts":{".":{},"k:{\"mountPath\":\"/etc/pod-info/\"}":{".":{},"f:mountPath":{},"f:name":{}},"k:{\"mountPath\":\"/etc/rabbitmq/conf.d/10-operatorDefaults.conf\"}":{".":{},"f:mountPath":{},"f:name":{},"f:subPath":{}},"k:{\"mountPath\":\"/etc/rabbitmq/conf.d/11-default_user.conf\"}":{".":{},"f:mountPath":{},"f:name":{},"f:subPath":{}},"k:{\"mountPath\":\"/etc/rabbitmq/conf.d/90-userDefinedConfiguration.conf\"}":{".":{},"f:mountPath":{},"f:name":{},"f:subPath":{}},"k:{\"mountPath\":\"/operator\"}":{".":{},"f:mountPath":{},"f:name":{}},"k:{\"mountPath\":\"/var/lib/rabbitmq/\"}":{".":{},"f:mountPath":{},"f:name":{}},"k:{\"mountPath\":\"/var/lib/rabbitmq/mnesia/\"}":{".":{},"f:mountPath":{},"f:name":{}}}}},"f:dnsPolicy":{},"f:initContainers":{".":{},"k:{\"name\":\"setup-container\"}":{".":{},"f:command":{},"f:image":{},"f:imagePullPolicy":{},"f:name":{},"f:resources":{".":{},"f:limits":{".":{},"f:cpu":{},"f:memory":{}},"f:requests":{".":{},"f:cpu":{},"f:memory":{}}},"f:securityContext":{".":{},"f:capabilities":{".":{},"f:drop":{}},"f:runAsUser":{}},"f:terminationMessagePath":{},"f:terminationMessagePolicy":{},"f:volumeMounts":{".":{},"k:{\"mountPath\":\"/operator\"}":{".":{},"f:mountPath":{},"f:name":{}},"k:{\"mountPath\":\"/tmp/default_user.conf\"}":{".":{},"f:mountPath":{},"f:name":{},"f:subPath":{}},"k:{\"mountPath\":\"/tmp/erlang-cookie-secret/\"}":{".":{},"f:mountPath":{},"f:name":{}},"k:{\"mountPath\":\"/tmp/rabbitmq-plugins/\"}":{".":{},"f:mountPath":{},"f:name":{}},"k:{\"mountPath\":\"/var/lib/rabbitmq/\"}":{".":{},"f:mountPath":{},"f:name":{}},"k:{\"mountPath\":\"/var/lib/rabbitmq/mnesia/\"}":{".":{},"f:mountPath":{},"f:name":{}}}}},"f:restartPolicy":{},"f:schedulerName":{},"f:securityContext":{".":{},"f:fsGroup":{},"f:runAsGroup":{},"f:runAsUser":{}},"f:serviceAccount":{},"f:serviceAccountName":{},"f:terminationGracePeriodSeconds":{},"f:topologySpreadConstraints":{".":{},"k:{\"topologyKey\":\"topology.kubernetes.io/zone\",\"whenUnsatisfiable\":\"ScheduleAnyway\"}":{".":{},"f:labelSelector":{".":{},"f:matchLabels":{".":{},"f:app.kubernetes.io/name":{}}},"f:maxSkew":{},"f:topologyKey":{},"f:whenUnsatisfiable":{}}},"f:volumes":{".":{},"k:{\"name\":\"erlang-cookie-secret\"}":{".":{},"f:name":{},"f:secret":{".":{},"f:defaultMode":{},"f:secretName":{}}},"k:{\"name\":\"plugins-conf\"}":{".":{},"f:configMap":{".":{},"f:defaultMode":{},"f:name":{}},"f:name":{}},"k:{\"name\":\"pod-info\"}":{".":{},"f:downwardAPI":{".":{},"f:defaultMode":{},"f:items":{}},"f:name":{}},"k:{\"name\":\"rabbitmq-confd\"}":{".":{},"f:name":{},"f:projected":{".":{},"f:defaultMode":{},"f:sources":{}}},"k:{\"name\":\"rabbitmq-erlang-cookie\"}":{".":{},"f:emptyDir":{},"f:name":{}},"k:{\"name\":\"rabbitmq-plugins\"}":{".":{},"f:emptyDir":{},"f:name":{}}}}},"f:updateStrategy":{"f:rollingUpdate":{".":{},"f:partition":{}},"f:type":{}},"f:volumeClaimTemplates":{}}}}]},"spec":{"replicas":1,"selector":{"matchLabels":{"app.kubernetes.io/name":"rabbitmq-cluster"}},"template":{"metadata":{"creationTimestamp":null,"labels":{"app.kubernetes.io/component":"rabbitmq","app.kubernetes.io/name":"rabbitmq-cluster","app.kubernetes.io/part-of":"rabbitmq"},"annotations":{"prometheus.io/port":"15692","prometheus.io/scrape":"true"}},"spec":{"volumes":[{"name":"plugins-conf","configMap":{"name":"rabbitmq-cluster-plugins-conf","defaultMode":420}},{"name":"rabbitmq-confd","projected":{"sources":[{"secret":{"name":"rabbitmq-cluster-default-user","items":[{"key":"default_user.conf","path":"default_user.conf"}]}},{"configMap":{"name":"rabbitmq-cluster-server-conf","items":[{"key":"operatorDefaults.conf","path":"operatorDefaults.conf"},{"key":"userDefinedConfiguration.conf","path":"userDefinedConfiguration.conf"}]}}],"defaultMode":420}},{"name":"rabbitmq-erlang-cookie","emptyDir":{}},{"name":"erlang-cookie-secret","secret":{"secretName":"rabbitmq-cluster-erlang-cookie","defaultMode":420}},{"name":"rabbitmq-plugins","emptyDir":{}},{"name":"pod-info","downwardAPI":{"items":[{"path":"skipPreStopChecks","fieldRef":{"apiVersion":"v1","fieldPath":"metadata.labels['skipPreStopChecks']"}}],"defaultMode":420}}],"initContainers":[{"name":"setup-container","image":"rabbitmq:3.8.12-management","command":["sh","-c","cp /tmp/erlang-cookie-secret/.erlang.cookie /var/lib/rabbitmq/.erlang.cookie \u0026\u0026 chown 999:999 /var/lib/rabbitmq/.erlang.cookie \u0026\u0026 chmod 600 /var/lib/rabbitmq/.erlang.cookie ; cp /tmp/rabbitmq-plugins/enabled_plugins /operator/enabled_plugins \u0026\u0026 chown 999:999 /operator/enabled_plugins ; chown 999:999 /var/lib/rabbitmq/mnesia/ ; echo '[default]' \u003e /var/lib/rabbitmq/.rabbitmqadmin.conf \u0026\u0026 sed -e 's/default_user/username/' -e 's/default_pass/password/' /tmp/default_user.conf \u003e\u003e /var/lib/rabbitmq/.rabbitmqadmin.conf \u0026\u0026 chown 999:999 /var/lib/rabbitmq/.rabbitmqadmin.conf \u0026\u0026 chmod 600 /var/lib/rabbitmq/.rabbitmqadmin.conf"],"resources":{"limits":{"cpu":"100m","memory":"500Mi"},"requests":{"cpu":"100m","memory":"500Mi"}},"volumeMounts":[{"name":"plugins-conf","mountPath":"/tmp/rabbitmq-plugins/"},{"name":"rabbitmq-erlang-cookie","mountPath":"/var/lib/rabbitmq/"},{"name":"erlang-cookie-secret","mountPath":"/tmp/erlang-cookie-secret/"},{"name":"rabbitmq-plugins","mountPath":"/operator"},{"name":"persistence","mountPath":"/var/lib/rabbitmq/mnesia/"},{"name":"rabbitmq-confd","mountPath":"/tmp/default_user.conf","subPath":"default_user.conf"}],"terminationMessagePath":"/dev/termination-log","terminationMessagePolicy":"File","imagePullPolicy":"IfNotPresent","securityContext":{"capabilities":{"drop":["FSETID","KILL","SETGID","SETUID","SETPCAP","NET_BIND_SERVICE","NET_RAW","SYS_CHROOT","MKNOD","AUDIT_WRITE","SETFCAP"]},"runAsUser":0}}],"containers":[{"name":"rabbitmq","image":"rabbitmq:3.8.12-management","ports":[{"name":"epmd","containerPort":4369,"protocol":"TCP"},{"name":"amqp","containerPort":5672,"protocol":"TCP"},{"name":"management","containerPort":15672,"protocol":"TCP"},{"name":"prometheus","containerPort":15692,"protocol":"TCP"}],"env":[{"name":"MY_POD_NAME","valueFrom":{"fieldRef":{"apiVersion":"v1","fieldPath":"metadata.name"}}},{"name":"MY_POD_NAMESPACE","valueFrom":{"fieldRef":{"apiVersion":"v1","fieldPath":"metadata.namespace"}}},{"name":"RABBITMQ_ENABLED_PLUGINS_FILE","value":"/operator/enabled_plugins"},{"name":"K8S_SERVICE_NAME","value":"rabbitmq-cluster-nodes"},{"name":"RABBITMQ_USE_LONGNAME","value":"true"},{"name":"RABBITMQ_NODENAME","value":"rabbit@$(MY_POD_NAME).$(K8S_SERVICE_NAME).$(MY_POD_NAMESPACE)"},{"name":"K8S_HOSTNAME_SUFFIX","value":".$(K8S_SERVICE_NAME).$(MY_POD_NAMESPACE)"}],"resources":{"limits":{"cpu":"2","memory":"2Gi"},"requests":{"cpu":"1","memory":"2Gi"}},"volumeMounts":[{"name":"rabbitmq-erlang-cookie","mountPath":"/var/lib/rabbitmq/"},{"name":"persistence","mountPath":"/var/lib/rabbitmq/mnesia/"},{"name":"rabbitmq-plugins","mountPath":"/operator"},{"name":"rabbitmq-confd","mountPath":"/etc/rabbitmq/conf.d/10-operatorDefaults.conf","subPath":"operatorDefaults.conf"},{"name":"rabbitmq-confd","mountPath":"/etc/rabbitmq/conf.d/11-default_user.conf","subPath":"default_user.conf"},{"name":"rabbitmq-confd","mountPath":"/etc/rabbitmq/conf.d/90-userDefinedConfiguration.conf","subPath":"userDefinedConfiguration.conf"},{"name":"pod-info","mountPath":"/etc/pod-info/"}],"readinessProbe":{"tcpSocket":{"port":"amqp"},"initialDelaySeconds":10,"timeoutSeconds":5,"periodSeconds":10,"successThreshold":1,"failureThreshold":3},"lifecycle":{"preStop":{"exec":{"command":["/bin/bash","-c","if [ ! -z \"$(cat /etc/pod-info/skipPreStopChecks)\" ]; then exit 0; fi; rabbitmq-upgrade await_online_quorum_plus_one -t 604800; rabbitmq-upgrade await_online_synchronized_mirror -t 604800; rabbitmq-upgrade drain -t 604800"]}}},"terminationMessagePath":"/dev/termination-log","terminationMessagePolicy":"File","imagePullPolicy":"IfNotPresent"}],"restartPolicy":"Always","terminationGracePeriodSeconds":604800,"dnsPolicy":"ClusterFirst","serviceAccountName":"rabbitmq-cluster-server","serviceAccount":"rabbitmq-cluster-server","automountServiceAccountToken":true,"securityContext":{"runAsUser":999,"runAsGroup":999,"fsGroup":999},"schedulerName":"default-scheduler","topologySpreadConstraints":[{"maxSkew":1,"topologyKey":"topology.kubernetes.io/zone","whenUnsatisfiable":"ScheduleAnyway","labelSelector":{"matchLabels":{"app.kubernetes.io/name":"rabbitmq-cluster"}}}]}},"volumeClaimTemplates":[{"metadata":{"name":"persistence","namespace":"default","creationTimestamp":null,"labels":{"app.kubernetes.io/component":"rabbitmq","app.kubernetes.io/name":"rabbitmq-cluster","app.kubernetes.io/part-of":"rabbitmq"},"ownerReferences":[{"apiVersion":"rabbitmq.com/v1beta1","kind":"RabbitmqCluster","name":"rabbitmq-cluster","uid":"3ecefa8a-1bec-48a7-9af4-dd0df3339101","controller":true,"blockOwnerDeletion":false}]},"spec":{"accessModes":["ReadWriteOnce"],"resources":{"requests":{"storage":"10Gi"}},"volumeMode":"Filesystem"},"status":{"phase":"Pending"}}],"serviceName":"rabbitmq-cluster-nodes","podManagementPolicy":"Parallel","updateStrategy":{"type":"RollingUpdate","rollingUpdate":{"partition":0}},"revisionHistoryLimit":10},"status":{"observedGeneration":1,"replicas":1,"currentReplicas":1,"updatedReplicas":1,"currentRevision":"rabbitmq-cluster-server-5f8b8665fb","updateRevision":"rabbitmq-cluster-server-5f8b8665fb","collisionCount":0}}
2022/03/18 18:06:55 learn_server.go:291: [SIEVE-AFTER-READ]	Get	true	configmap	default	rabbitmq-cluster-server-conf	github.com/rabbitmq/cluster-operator/controllers.(*RabbitmqClusterReconciler)	NoError	{"kind":"ConfigMap","apiVersion":"v1","metadata":{"name":"rabbitmq-cluster-server-conf","namespace":"default","selfLink":"/api/v1/namespaces/default/configmaps/rabbitmq-cluster-server-conf","uid":"e4182078-d429-4baf-9021-72618c509ac5","resourceVersion":"1095","creationTimestamp":"2022-03-18T18:06:25Z","labels":{"app.kubernetes.io/component":"rabbitmq","app.kubernetes.io/name":"rabbitmq-cluster","app.kubernetes.io/part-of":"rabbitmq"},"ownerReferences":[{"apiVersion":"rabbitmq.com/v1beta1","kind":"RabbitmqCluster","name":"rabbitmq-cluster","uid":"3ecefa8a-1bec-48a7-9af4-dd0df3339101","controller":true,"blockOwnerDeletion":true}],"managedFields":[{"manager":"manager","operation":"Update","apiVersion":"v1","time":"2022-03-18T18:06:25Z","fieldsType":"FieldsV1","fieldsV1":{"f:data":{".":{},"f:operatorDefaults.conf":{},"f:userDefinedConfiguration.conf":{}},"f:metadata":{"f:labels":{".":{},"f:app.kubernetes.io/component":{},"f:app.kubernetes.io/name":{},"f:app.kubernetes.io/part-of":{}},"f:ownerReferences":{".":{},"k:{\"uid\":\"3ecefa8a-1bec-48a7-9af4-dd0df3339101\"}":{".":{},"f:apiVersion":{},"f:blockOwnerDeletion":{},"f:controller":{},"f:kind":{},"f:name":{},"f:uid":{}}}}}}]},"data":{"operatorDefaults.conf":"cluster_formation.peer_discovery_backend             = rabbit_peer_discovery_k8s\ncluster_formation.k8s.host                           = kubernetes.default\ncluster_formation.k8s.address_type                   = hostname\ncluster_partition_handling                           = pause_minority\nqueue_master_locator                                 = min-masters\ndisk_free_limit.absolute                             = 2GB\ncluster_formation.randomized_startup_delay_range.min = 5\ncluster_formation.randomized_startup_delay_range.max = 30\ncluster_name                                         = rabbitmq-cluster\n","userDefinedConfiguration.conf":"total_memory_available_override_value = 1717986919\n"}}
2022/03/18 18:06:55 learn_server.go:256: [SIEVE-BEFORE-WRITE]	23
2022/03/18 18:06:55 learn_server.go:263: [SIEVE-AFTER-WRITE]	23	StatusUpdate	rabbitmqcluster	github.com/rabbitmq/cluster-operator/controllers.(*RabbitmqClusterReconciler)	NoError	{"metadata":{"name":"rabbitmq-cluster","namespace":"default","selfLink":"/apis/rabbitmq.com/v1beta1/namespaces/default/rabbitmqclusters/rabbitmq-cluster/status","uid":"3ecefa8a-1bec-48a7-9af4-dd0df3339101","resourceVersion":"1132","generation":2,"creationTimestamp":"2022-03-18T18:06:25Z","annotations":{"kubectl.kubernetes.io/last-applied-configuration":"{\"apiVersion\":\"rabbitmq.com/v1beta1\",\"kind\":\"RabbitmqCluster\",\"metadata\":{\"annotations\":{},\"name\":\"rabbitmq-cluster\",\"namespace\":\"default\"},\"spec\":{\"persistence\":{\"storage\":\"10Gi\"},\"replicas\":1}}\n"},"finalizers":["deletion.finalizers.rabbitmqclusters.rabbitmq.com"],"managedFields":[{"manager":"kubectl-client-side-apply","operation":"Update","apiVersion":"rabbitmq.com/v1beta1","time":"2022-03-18T18:06:25Z","fieldsType":"FieldsV1","fieldsV1":{"f:metadata":{"f:annotations":{".":{},"f:kubectl.kubernetes.io/last-applied-configuration":{}}},"f:spec":{".":{},"f:image":{},"f:persistence":{".":{},"f:storage":{}},"f:replicas":{},"f:resources":{".":{},"f:limits":{".":{},"f:memory":{}},"f:requests":{".":{},"f:memory":{}}},"f:service":{".":{},"f:type":{}},"f:terminationGracePeriodSeconds":{}}}},{"manager":"manager","operation":"Update","apiVersion":"rabbitmq.com/v1beta1","time":"2022-03-18T18:06:25Z","fieldsType":"FieldsV1","fieldsV1":{"f:metadata":{"f:finalizers":{}},"f:spec":{"f:override":{},"f:rabbitmq":{},"f:resources":{"f:limits":{"f:cpu":{}},"f:requests":{"f:cpu":{}}},"f:tls":{}},"f:status":{".":{},"f:conditions":{},"f:defaultUser":{".":{},"f:secretReference":{".":{},"f:keys":{".":{},"f:password":{},"f:username":{}},"f:name":{},"f:namespace":{}},"f:serviceReference":{".":{},"f:name":{},"f:namespace":{}}}}}}]},"spec":{"replicas":1,"image":"rabbitmq:3.8.12-management","service":{"type":"ClusterIP"},"persistence":{"storage":"10Gi"},"resources":{"limits":{"cpu":"2","memory":"2Gi"},"requests":{"cpu":"1","memory":"2Gi"}},"rabbitmq":{},"tls":{},"override":{},"terminationGracePeriodSeconds":604800},"status":{"conditions":[{"type":"AllReplicasReady","status":"False","lastTransitionTime":"2022-03-18T18:06:25Z","reason":"NotAllPodsReady","message":"0/1 Pods ready"},{"type":"ClusterAvailable","status":"False","lastTransitionTime":"2022-03-18T18:06:25Z","reason":"NoEndpointsAvailable","message":"The service has no endpoints available"},{"type":"NoWarnings","status":"True","lastTransitionTime":"2022-03-18T18:06:25Z","reason":"NoWarnings"},{"type":"ReconcileSuccess","status":"Unknown","lastTransitionTime":"2022-03-18T18:06:25Z","reason":"Initialising"}],"defaultUser":{"secretReference":{"name":"rabbitmq-cluster-default-user","namespace":"default","keys":{"password":"password","username":"username"}},"serviceReference":{"name":"rabbitmq-cluster","namespace":"default"}},"binding":{"name":"rabbitmq-cluster-default-user"}}}
2022/03/18 18:06:55 learn_server.go:291: [SIEVE-AFTER-READ]	Get	true	statefulset	default	rabbitmq-cluster-server	github.com/rabbitmq/cluster-operator/controllers.(*RabbitmqClusterReconciler)	NoError	{"kind":"StatefulSet","apiVersion":"apps/v1","metadata":{"name":"rabbitmq-cluster-server","namespace":"default","selfLink":"/apis/apps/v1/namespaces/default/statefulsets/rabbitmq-cluster-server","uid":"f2f07f3e-b500-4c48-a5de-8db7eaf37b9a","resourceVersion":"1129","generation":1,"creationTimestamp":"2022-03-18T18:06:25Z","labels":{"app.kubernetes.io/component":"rabbitmq","app.kubernetes.io/name":"rabbitmq-cluster","app.kubernetes.io/part-of":"rabbitmq"},"annotations":{"rabbitmq.com/createdAt":"2022-03-18T18:06:25Z"},"ownerReferences":[{"apiVersion":"rabbitmq.com/v1beta1","kind":"RabbitmqCluster","name":"rabbitmq-cluster","uid":"3ecefa8a-1bec-48a7-9af4-dd0df3339101","controller":true,"blockOwnerDeletion":true}],"managedFields":[{"manager":"kube-controller-manager","operation":"Update","apiVersion":"apps/v1","time":"2022-03-18T18:06:25Z","fieldsType":"FieldsV1","fieldsV1":{"f:status":{"f:collisionCount":{},"f:currentReplicas":{},"f:currentRevision":{},"f:observedGeneration":{},"f:replicas":{},"f:updateRevision":{},"f:updatedReplicas":{}}}},{"manager":"manager","operation":"Update","apiVersion":"apps/v1","time":"2022-03-18T18:06:25Z","fieldsType":"FieldsV1","fieldsV1":{"f:metadata":{"f:annotations":{".":{},"f:rabbitmq.com/createdAt":{}},"f:labels":{".":{},"f:app.kubernetes.io/component":{},"f:app.kubernetes.io/name":{},"f:app.kubernetes.io/part-of":{}},"f:ownerReferences":{".":{},"k:{\"uid\":\"3ecefa8a-1bec-48a7-9af4-dd0df3339101\"}":{".":{},"f:apiVersion":{},"f:blockOwnerDeletion":{},"f:controller":{},"f:kind":{},"f:name":{},"f:uid":{}}}},"f:spec":{"f:podManagementPolicy":{},"f:replicas":{},"f:revisionHistoryLimit":{},"f:selector":{"f:matchLabels":{".":{},"f:app.kubernetes.io/name":{}}},"f:serviceName":{},"f:template":{"f:metadata":{"f:annotations":{".":{},"f:prometheus.io/port":{},"f:prometheus.io/scrape":{}},"f:labels":{".":{},"f:app.kubernetes.io/component":{},"f:app.kubernetes.io/name":{},"f:app.kubernetes.io/part-of":{}}},"f:spec":{"f:automountServiceAccountToken":{},"f:containers":{"k:{\"name\":\"rabbitmq\"}":{".":{},"f:env":{".":{},"k:{\"name\":\"K8S_HOSTNAME_SUFFIX\"}":{".":{},"f:name":{},"f:value":{}},"k:{\"name\":\"K8S_SERVICE_NAME\"}":{".":{},"f:name":{},"f:value":{}},"k:{\"name\":\"MY_POD_NAME\"}":{".":{},"f:name":{},"f:valueFrom":{".":{},"f:fieldRef":{".":{},"f:apiVersion":{},"f:fieldPath":{}}}},"k:{\"name\":\"MY_POD_NAMESPACE\"}":{".":{},"f:name":{},"f:valueFrom":{".":{},"f:fieldRef":{".":{},"f:apiVersion":{},"f:fieldPath":{}}}},"k:{\"name\":\"RABBITMQ_ENABLED_PLUGINS_FILE\"}":{".":{},"f:name":{},"f:value":{}},"k:{\"name\":\"RABBITMQ_NODENAME\"}":{".":{},"f:name":{},"f:value":{}},"k:{\"name\":\"RABBITMQ_USE_LONGNAME\"}":{".":{},"f:name":{},"f:value":{}}},"f:image":{},"f:imagePullPolicy":{},"f:lifecycle":{".":{},"f:preStop":{".":{},"f:exec":{".":{},"f:command":{}}}},"f:name":{},"f:ports":{".":{},"k:{\"containerPort\":4369,\"protocol\":\"TCP\"}":{".":{},"f:containerPort":{},"f:name":{},"f:protocol":{}},"k:{\"containerPort\":5672,\"protocol\":\"TCP\"}":{".":{},"f:containerPort":{},"f:name":{},"f:protocol":{}},"k:{\"containerPort\":15672,\"protocol\":\"TCP\"}":{".":{},"f:containerPort":{},"f:name":{},"f:protocol":{}},"k:{\"containerPort\":15692,\"protocol\":\"TCP\"}":{".":{},"f:containerPort":{},"f:name":{},"f:protocol":{}}},"f:readinessProbe":{".":{},"f:failureThreshold":{},"f:initialDelaySeconds":{},"f:periodSeconds":{},"f:successThreshold":{},"f:tcpSocket":{".":{},"f:port":{}},"f:timeoutSeconds":{}},"f:resources":{".":{},"f:limits":{".":{},"f:cpu":{},"f:memory":{}},"f:requests":{".":{},"f:cpu":{},"f:memory":{}}},"f:terminationMessagePath":{},"f:terminationMessagePolicy":{},"f:volumeMounts":{".":{},"k:{\"mountPath\":\"/etc/pod-info/\"}":{".":{},"f:mountPath":{},"f:name":{}},"k:{\"mountPath\":\"/etc/rabbitmq/conf.d/10-operatorDefaults.conf\"}":{".":{},"f:mountPath":{},"f:name":{},"f:subPath":{}},"k:{\"mountPath\":\"/etc/rabbitmq/conf.d/11-default_user.conf\"}":{".":{},"f:mountPath":{},"f:name":{},"f:subPath":{}},"k:{\"mountPath\":\"/etc/rabbitmq/conf.d/90-userDefinedConfiguration.conf\"}":{".":{},"f:mountPath":{},"f:name":{},"f:subPath":{}},"k:{\"mountPath\":\"/operator\"}":{".":{},"f:mountPath":{},"f:name":{}},"k:{\"mountPath\":\"/var/lib/rabbitmq/\"}":{".":{},"f:mountPath":{},"f:name":{}},"k:{\"mountPath\":\"/var/lib/rabbitmq/mnesia/\"}":{".":{},"f:mountPath":{},"f:name":{}}}}},"f:dnsPolicy":{},"f:initContainers":{".":{},"k:{\"name\":\"setup-container\"}":{".":{},"f:command":{},"f:image":{},"f:imagePullPolicy":{},"f:name":{},"f:resources":{".":{},"f:limits":{".":{},"f:cpu":{},"f:memory":{}},"f:requests":{".":{},"f:cpu":{},"f:memory":{}}},"f:securityContext":{".":{},"f:capabilities":{".":{},"f:drop":{}},"f:runAsUser":{}},"f:terminationMessagePath":{},"f:terminationMessagePolicy":{},"f:volumeMounts":{".":{},"k:{\"mountPath\":\"/operator\"}":{".":{},"f:mountPath":{},"f:name":{}},"k:{\"mountPath\":\"/tmp/default_user.conf\"}":{".":{},"f:mountPath":{},"f:name":{},"f:subPath":{}},"k:{\"mountPath\":\"/tmp/erlang-cookie-secret/\"}":{".":{},"f:mountPath":{},"f:name":{}},"k:{\"mountPath\":\"/tmp/rabbitmq-plugins/\"}":{".":{},"f:mountPath":{},"f:name":{}},"k:{\"mountPath\":\"/var/lib/rabbitmq/\"}":{".":{},"f:mountPath":{},"f:name":{}},"k:{\"mountPath\":\"/var/lib/rabbitmq/mnesia/\"}":{".":{},"f:mountPath":{},"f:name":{}}}}},"f:restartPolicy":{},"f:schedulerName":{},"f:securityContext":{".":{},"f:fsGroup":{},"f:runAsGroup":{},"f:runAsUser":{}},"f:serviceAccount":{},"f:serviceAccountName":{},"f:terminationGracePeriodSeconds":{},"f:topologySpreadConstraints":{".":{},"k:{\"topologyKey\":\"topology.kubernetes.io/zone\",\"whenUnsatisfiable\":\"ScheduleAnyway\"}":{".":{},"f:labelSelector":{".":{},"f:matchLabels":{".":{},"f:app.kubernetes.io/name":{}}},"f:maxSkew":{},"f:topologyKey":{},"f:whenUnsatisfiable":{}}},"f:volumes":{".":{},"k:{\"name\":\"erlang-cookie-secret\"}":{".":{},"f:name":{},"f:secret":{".":{},"f:defaultMode":{},"f:secretName":{}}},"k:{\"name\":\"plugins-conf\"}":{".":{},"f:configMap":{".":{},"f:defaultMode":{},"f:name":{}},"f:name":{}},"k:{\"name\":\"pod-info\"}":{".":{},"f:downwardAPI":{".":{},"f:defaultMode":{},"f:items":{}},"f:name":{}},"k:{\"name\":\"rabbitmq-confd\"}":{".":{},"f:name":{},"f:projected":{".":{},"f:defaultMode":{},"f:sources":{}}},"k:{\"name\":\"rabbitmq-erlang-cookie\"}":{".":{},"f:emptyDir":{},"f:name":{}},"k:{\"name\":\"rabbitmq-plugins\"}":{".":{},"f:emptyDir":{},"f:name":{}}}}},"f:updateStrategy":{"f:rollingUpdate":{".":{},"f:partition":{}},"f:type":{}},"f:volumeClaimTemplates":{}}}}]},"spec":{"replicas":1,"selector":{"matchLabels":{"app.kubernetes.io/name":"rabbitmq-cluster"}},"template":{"metadata":{"creationTimestamp":null,"labels":{"app.kubernetes.io/component":"rabbitmq","app.kubernetes.io/name":"rabbitmq-cluster","app.kubernetes.io/part-of":"rabbitmq"},"annotations":{"prometheus.io/port":"15692","prometheus.io/scrape":"true"}},"spec":{"volumes":[{"name":"plugins-conf","configMap":{"name":"rabbitmq-cluster-plugins-conf","defaultMode":420}},{"name":"rabbitmq-confd","projected":{"sources":[{"secret":{"name":"rabbitmq-cluster-default-user","items":[{"key":"default_user.conf","path":"default_user.conf"}]}},{"configMap":{"name":"rabbitmq-cluster-server-conf","items":[{"key":"operatorDefaults.conf","path":"operatorDefaults.conf"},{"key":"userDefinedConfiguration.conf","path":"userDefinedConfiguration.conf"}]}}],"defaultMode":420}},{"name":"rabbitmq-erlang-cookie","emptyDir":{}},{"name":"erlang-cookie-secret","secret":{"secretName":"rabbitmq-cluster-erlang-cookie","defaultMode":420}},{"name":"rabbitmq-plugins","emptyDir":{}},{"name":"pod-info","downwardAPI":{"items":[{"path":"skipPreStopChecks","fieldRef":{"apiVersion":"v1","fieldPath":"metadata.labels['skipPreStopChecks']"}}],"defaultMode":420}}],"initContainers":[{"name":"setup-container","image":"rabbitmq:3.8.12-management","command":["sh","-c","cp /tmp/erlang-cookie-secret/.erlang.cookie /var/lib/rabbitmq/.erlang.cookie \u0026\u0026 chown 999:999 /var/lib/rabbitmq/.erlang.cookie \u0026\u0026 chmod 600 /var/lib/rabbitmq/.erlang.cookie ; cp /tmp/rabbitmq-plugins/enabled_plugins /operator/enabled_plugins \u0026\u0026 chown 999:999 /operator/enabled_plugins ; chown 999:999 /var/lib/rabbitmq/mnesia/ ; echo '[default]' \u003e /var/lib/rabbitmq/.rabbitmqadmin.conf \u0026\u0026 sed -e 's/default_user/username/' -e 's/default_pass/password/' /tmp/default_user.conf \u003e\u003e /var/lib/rabbitmq/.rabbitmqadmin.conf \u0026\u0026 chown 999:999 /var/lib/rabbitmq/.rabbitmqadmin.conf \u0026\u0026 chmod 600 /var/lib/rabbitmq/.rabbitmqadmin.conf"],"resources":{"limits":{"cpu":"100m","memory":"500Mi"},"requests":{"cpu":"100m","memory":"500Mi"}},"volumeMounts":[{"name":"plugins-conf","mountPath":"/tmp/rabbitmq-plugins/"},{"name":"rabbitmq-erlang-cookie","mountPath":"/var/lib/rabbitmq/"},{"name":"erlang-cookie-secret","mountPath":"/tmp/erlang-cookie-secret/"},{"name":"rabbitmq-plugins","mountPath":"/operator"},{"name":"persistence","mountPath":"/var/lib/rabbitmq/mnesia/"},{"name":"rabbitmq-confd","mountPath":"/tmp/default_user.conf","subPath":"default_user.conf"}],"terminationMessagePath":"/dev/termination-log","terminationMessagePolicy":"File","imagePullPolicy":"IfNotPresent","securityContext":{"capabilities":{"drop":["FSETID","KILL","SETGID","SETUID","SETPCAP","NET_BIND_SERVICE","NET_RAW","SYS_CHROOT","MKNOD","AUDIT_WRITE","SETFCAP"]},"runAsUser":0}}],"containers":[{"name":"rabbitmq","image":"rabbitmq:3.8.12-management","ports":[{"name":"epmd","containerPort":4369,"protocol":"TCP"},{"name":"amqp","containerPort":5672,"protocol":"TCP"},{"name":"management","containerPort":15672,"protocol":"TCP"},{"name":"prometheus","containerPort":15692,"protocol":"TCP"}],"env":[{"name":"MY_POD_NAME","valueFrom":{"fieldRef":{"apiVersion":"v1","fieldPath":"metadata.name"}}},{"name":"MY_POD_NAMESPACE","valueFrom":{"fieldRef":{"apiVersion":"v1","fieldPath":"metadata.namespace"}}},{"name":"RABBITMQ_ENABLED_PLUGINS_FILE","value":"/operator/enabled_plugins"},{"name":"K8S_SERVICE_NAME","value":"rabbitmq-cluster-nodes"},{"name":"RABBITMQ_USE_LONGNAME","value":"true"},{"name":"RABBITMQ_NODENAME","value":"rabbit@$(MY_POD_NAME).$(K8S_SERVICE_NAME).$(MY_POD_NAMESPACE)"},{"name":"K8S_HOSTNAME_SUFFIX","value":".$(K8S_SERVICE_NAME).$(MY_POD_NAMESPACE)"}],"resources":{"limits":{"cpu":"2","memory":"2Gi"},"requests":{"cpu":"1","memory":"2Gi"}},"volumeMounts":[{"name":"rabbitmq-erlang-cookie","mountPath":"/var/lib/rabbitmq/"},{"name":"persistence","mountPath":"/var/lib/rabbitmq/mnesia/"},{"name":"rabbitmq-plugins","mountPath":"/operator"},{"name":"rabbitmq-confd","mountPath":"/etc/rabbitmq/conf.d/10-operatorDefaults.conf","subPath":"operatorDefaults.conf"},{"name":"rabbitmq-confd","mountPath":"/etc/rabbitmq/conf.d/11-default_user.conf","subPath":"default_user.conf"},{"name":"rabbitmq-confd","mountPath":"/etc/rabbitmq/conf.d/90-userDefinedConfiguration.conf","subPath":"userDefinedConfiguration.conf"},{"name":"pod-info","mountPath":"/etc/pod-info/"}],"readinessProbe":{"tcpSocket":{"port":"amqp"},"initialDelaySeconds":10,"timeoutSeconds":5,"periodSeconds":10,"successThreshold":1,"failureThreshold":3},"lifecycle":{"preStop":{"exec":{"command":["/bin/bash","-c","if [ ! -z \"$(cat /etc/pod-info/skipPreStopChecks)\" ]; then exit 0; fi; rabbitmq-upgrade await_online_quorum_plus_one -t 604800; rabbitmq-upgrade await_online_synchronized_mirror -t 604800; rabbitmq-upgrade drain -t 604800"]}}},"terminationMessagePath":"/dev/termination-log","terminationMessagePolicy":"File","imagePullPolicy":"IfNotPresent"}],"restartPolicy":"Always","terminationGracePeriodSeconds":604800,"dnsPolicy":"ClusterFirst","serviceAccountName":"rabbitmq-cluster-server","serviceAccount":"rabbitmq-cluster-server","automountServiceAccountToken":true,"securityContext":{"runAsUser":999,"runAsGroup":999,"fsGroup":999},"schedulerName":"default-scheduler","topologySpreadConstraints":[{"maxSkew":1,"topologyKey":"topology.kubernetes.io/zone","whenUnsatisfiable":"ScheduleAnyway","labelSelector":{"matchLabels":{"app.kubernetes.io/name":"rabbitmq-cluster"}}}]}},"volumeClaimTemplates":[{"metadata":{"name":"persistence","namespace":"default","creationTimestamp":null,"labels":{"app.kubernetes.io/component":"rabbitmq","app.kubernetes.io/name":"rabbitmq-cluster","app.kubernetes.io/part-of":"rabbitmq"},"ownerReferences":[{"apiVersion":"rabbitmq.com/v1beta1","kind":"RabbitmqCluster","name":"rabbitmq-cluster","uid":"3ecefa8a-1bec-48a7-9af4-dd0df3339101","controller":true,"blockOwnerDeletion":false}]},"spec":{"accessModes":["ReadWriteOnce"],"resources":{"requests":{"storage":"10Gi"}},"volumeMode":"Filesystem"},"status":{"phase":"Pending"}}],"serviceName":"rabbitmq-cluster-nodes","podManagementPolicy":"Parallel","updateStrategy":{"type":"RollingUpdate","rollingUpdate":{"partition":0}},"revisionHistoryLimit":10},"status":{"observedGeneration":1,"replicas":1,"currentReplicas":1,"updatedReplicas":1,"currentRevision":"rabbitmq-cluster-server-5f8b8665fb","updateRevision":"rabbitmq-cluster-server-5f8b8665fb","collisionCount":0}}
2022/03/18 18:06:55 learn_server.go:253: [SIEVE-AFTER-RECONCILE]	github.com/rabbitmq/cluster-operator/controllers.(*RabbitmqClusterReconciler)	4
2022/03/18 18:07:10 learn_server.go:238: [SIEVE-BEFORE-RECONCILE]	github.com/rabbitmq/cluster-operator/controllers.(*RabbitmqClusterReconciler)	5
2022/03/18 18:07:10 learn_server.go:291: [SIEVE-AFTER-READ]	Get	true	rabbitmqcluster	default	rabbitmq-cluster	github.com/rabbitmq/cluster-operator/controllers.(*RabbitmqClusterReconciler)	NoError	{"kind":"RabbitmqCluster","apiVersion":"rabbitmq.com/v1beta1","metadata":{"name":"rabbitmq-cluster","namespace":"default","selfLink":"/apis/rabbitmq.com/v1beta1/namespaces/default/rabbitmqclusters/rabbitmq-cluster","uid":"3ecefa8a-1bec-48a7-9af4-dd0df3339101","resourceVersion":"1132","generation":2,"creationTimestamp":"2022-03-18T18:06:25Z","annotations":{"kubectl.kubernetes.io/last-applied-configuration":"{\"apiVersion\":\"rabbitmq.com/v1beta1\",\"kind\":\"RabbitmqCluster\",\"metadata\":{\"annotations\":{},\"name\":\"rabbitmq-cluster\",\"namespace\":\"default\"},\"spec\":{\"persistence\":{\"storage\":\"10Gi\"},\"replicas\":1}}\n"},"finalizers":["deletion.finalizers.rabbitmqclusters.rabbitmq.com"],"managedFields":[{"manager":"kubectl-client-side-apply","operation":"Update","apiVersion":"rabbitmq.com/v1beta1","time":"2022-03-18T18:06:25Z","fieldsType":"FieldsV1","fieldsV1":{"f:metadata":{"f:annotations":{".":{},"f:kubectl.kubernetes.io/last-applied-configuration":{}}},"f:spec":{".":{},"f:image":{},"f:persistence":{".":{},"f:storage":{}},"f:replicas":{},"f:resources":{".":{},"f:limits":{".":{},"f:memory":{}},"f:requests":{".":{},"f:memory":{}}},"f:service":{".":{},"f:type":{}},"f:terminationGracePeriodSeconds":{}}}},{"manager":"manager","operation":"Update","apiVersion":"rabbitmq.com/v1beta1","time":"2022-03-18T18:06:25Z","fieldsType":"FieldsV1","fieldsV1":{"f:metadata":{"f:finalizers":{}},"f:spec":{"f:override":{},"f:rabbitmq":{},"f:resources":{"f:limits":{"f:cpu":{}},"f:requests":{"f:cpu":{}}},"f:tls":{}},"f:status":{".":{},"f:conditions":{},"f:defaultUser":{".":{},"f:secretReference":{".":{},"f:keys":{".":{},"f:password":{},"f:username":{}},"f:name":{},"f:namespace":{}},"f:serviceReference":{".":{},"f:name":{},"f:namespace":{}}}}}}]},"spec":{"replicas":1,"image":"rabbitmq:3.8.12-management","service":{"type":"ClusterIP"},"persistence":{"storage":"10Gi"},"resources":{"limits":{"cpu":"2","memory":"2Gi"},"requests":{"cpu":"1","memory":"2Gi"}},"rabbitmq":{},"tls":{},"override":{},"terminationGracePeriodSeconds":604800},"status":{"conditions":[{"type":"AllReplicasReady","status":"False","lastTransitionTime":"2022-03-18T18:06:25Z","reason":"NotAllPodsReady","message":"0/1 Pods ready"},{"type":"ClusterAvailable","status":"False","lastTransitionTime":"2022-03-18T18:06:25Z","reason":"NoEndpointsAvailable","message":"The service has no endpoints available"},{"type":"NoWarnings","status":"True","lastTransitionTime":"2022-03-18T18:06:25Z","reason":"NoWarnings"},{"type":"ReconcileSuccess","status":"Unknown","lastTransitionTime":"2022-03-18T18:06:25Z","reason":"Initialising"}],"defaultUser":{"secretReference":{"name":"rabbitmq-cluster-default-user","namespace":"default","keys":{"password":"password","username":"username"}},"serviceReference":{"name":"rabbitmq-cluster","namespace":"default"}}}}
2022/03/18 18:07:10 learn_server.go:291: [SIEVE-AFTER-READ]	Get	true	statefulset	default	rabbitmq-cluster-server	github.com/rabbitmq/cluster-operator/controllers.(*RabbitmqClusterReconciler)	NoError	{"kind":"StatefulSet","apiVersion":"apps/v1","metadata":{"name":"rabbitmq-cluster-server","namespace":"default","selfLink":"/apis/apps/v1/namespaces/default/statefulsets/rabbitmq-cluster-server","uid":"f2f07f3e-b500-4c48-a5de-8db7eaf37b9a","resourceVersion":"1129","generation":1,"creationTimestamp":"2022-03-18T18:06:25Z","labels":{"app.kubernetes.io/component":"rabbitmq","app.kubernetes.io/name":"rabbitmq-cluster","app.kubernetes.io/part-of":"rabbitmq"},"annotations":{"rabbitmq.com/createdAt":"2022-03-18T18:06:25Z"},"ownerReferences":[{"apiVersion":"rabbitmq.com/v1beta1","kind":"RabbitmqCluster","name":"rabbitmq-cluster","uid":"3ecefa8a-1bec-48a7-9af4-dd0df3339101","controller":true,"blockOwnerDeletion":true}],"managedFields":[{"manager":"kube-controller-manager","operation":"Update","apiVersion":"apps/v1","time":"2022-03-18T18:06:25Z","fieldsType":"FieldsV1","fieldsV1":{"f:status":{"f:collisionCount":{},"f:currentReplicas":{},"f:currentRevision":{},"f:observedGeneration":{},"f:replicas":{},"f:updateRevision":{},"f:updatedReplicas":{}}}},{"manager":"manager","operation":"Update","apiVersion":"apps/v1","time":"2022-03-18T18:06:25Z","fieldsType":"FieldsV1","fieldsV1":{"f:metadata":{"f:annotations":{".":{},"f:rabbitmq.com/createdAt":{}},"f:labels":{".":{},"f:app.kubernetes.io/component":{},"f:app.kubernetes.io/name":{},"f:app.kubernetes.io/part-of":{}},"f:ownerReferences":{".":{},"k:{\"uid\":\"3ecefa8a-1bec-48a7-9af4-dd0df3339101\"}":{".":{},"f:apiVersion":{},"f:blockOwnerDeletion":{},"f:controller":{},"f:kind":{},"f:name":{},"f:uid":{}}}},"f:spec":{"f:podManagementPolicy":{},"f:replicas":{},"f:revisionHistoryLimit":{},"f:selector":{"f:matchLabels":{".":{},"f:app.kubernetes.io/name":{}}},"f:serviceName":{},"f:template":{"f:metadata":{"f:annotations":{".":{},"f:prometheus.io/port":{},"f:prometheus.io/scrape":{}},"f:labels":{".":{},"f:app.kubernetes.io/component":{},"f:app.kubernetes.io/name":{},"f:app.kubernetes.io/part-of":{}}},"f:spec":{"f:automountServiceAccountToken":{},"f:containers":{"k:{\"name\":\"rabbitmq\"}":{".":{},"f:env":{".":{},"k:{\"name\":\"K8S_HOSTNAME_SUFFIX\"}":{".":{},"f:name":{},"f:value":{}},"k:{\"name\":\"K8S_SERVICE_NAME\"}":{".":{},"f:name":{},"f:value":{}},"k:{\"name\":\"MY_POD_NAME\"}":{".":{},"f:name":{},"f:valueFrom":{".":{},"f:fieldRef":{".":{},"f:apiVersion":{},"f:fieldPath":{}}}},"k:{\"name\":\"MY_POD_NAMESPACE\"}":{".":{},"f:name":{},"f:valueFrom":{".":{},"f:fieldRef":{".":{},"f:apiVersion":{},"f:fieldPath":{}}}},"k:{\"name\":\"RABBITMQ_ENABLED_PLUGINS_FILE\"}":{".":{},"f:name":{},"f:value":{}},"k:{\"name\":\"RABBITMQ_NODENAME\"}":{".":{},"f:name":{},"f:value":{}},"k:{\"name\":\"RABBITMQ_USE_LONGNAME\"}":{".":{},"f:name":{},"f:value":{}}},"f:image":{},"f:imagePullPolicy":{},"f:lifecycle":{".":{},"f:preStop":{".":{},"f:exec":{".":{},"f:command":{}}}},"f:name":{},"f:ports":{".":{},"k:{\"containerPort\":4369,\"protocol\":\"TCP\"}":{".":{},"f:containerPort":{},"f:name":{},"f:protocol":{}},"k:{\"containerPort\":5672,\"protocol\":\"TCP\"}":{".":{},"f:containerPort":{},"f:name":{},"f:protocol":{}},"k:{\"containerPort\":15672,\"protocol\":\"TCP\"}":{".":{},"f:containerPort":{},"f:name":{},"f:protocol":{}},"k:{\"containerPort\":15692,\"protocol\":\"TCP\"}":{".":{},"f:containerPort":{},"f:name":{},"f:protocol":{}}},"f:readinessProbe":{".":{},"f:failureThreshold":{},"f:initialDelaySeconds":{},"f:periodSeconds":{},"f:successThreshold":{},"f:tcpSocket":{".":{},"f:port":{}},"f:timeoutSeconds":{}},"f:resources":{".":{},"f:limits":{".":{},"f:cpu":{},"f:memory":{}},"f:requests":{".":{},"f:cpu":{},"f:memory":{}}},"f:terminationMessagePath":{},"f:terminationMessagePolicy":{},"f:volumeMounts":{".":{},"k:{\"mountPath\":\"/etc/pod-info/\"}":{".":{},"f:mountPath":{},"f:name":{}},"k:{\"mountPath\":\"/etc/rabbitmq/conf.d/10-operatorDefaults.conf\"}":{".":{},"f:mountPath":{},"f:name":{},"f:subPath":{}},"k:{\"mountPath\":\"/etc/rabbitmq/conf.d/11-default_user.conf\"}":{".":{},"f:mountPath":{},"f:name":{},"f:subPath":{}},"k:{\"mountPath\":\"/etc/rabbitmq/conf.d/90-userDefinedConfiguration.conf\"}":{".":{},"f:mountPath":{},"f:name":{},"f:subPath":{}},"k:{\"mountPath\":\"/operator\"}":{".":{},"f:mountPath":{},"f:name":{}},"k:{\"mountPath\":\"/var/lib/rabbitmq/\"}":{".":{},"f:mountPath":{},"f:name":{}},"k:{\"mountPath\":\"/var/lib/rabbitmq/mnesia/\"}":{".":{},"f:mountPath":{},"f:name":{}}}}},"f:dnsPolicy":{},"f:initContainers":{".":{},"k:{\"name\":\"setup-container\"}":{".":{},"f:command":{},"f:image":{},"f:imagePullPolicy":{},"f:name":{},"f:resources":{".":{},"f:limits":{".":{},"f:cpu":{},"f:memory":{}},"f:requests":{".":{},"f:cpu":{},"f:memory":{}}},"f:securityContext":{".":{},"f:capabilities":{".":{},"f:drop":{}},"f:runAsUser":{}},"f:terminationMessagePath":{},"f:terminationMessagePolicy":{},"f:volumeMounts":{".":{},"k:{\"mountPath\":\"/operator\"}":{".":{},"f:mountPath":{},"f:name":{}},"k:{\"mountPath\":\"/tmp/default_user.conf\"}":{".":{},"f:mountPath":{},"f:name":{},"f:subPath":{}},"k:{\"mountPath\":\"/tmp/erlang-cookie-secret/\"}":{".":{},"f:mountPath":{},"f:name":{}},"k:{\"mountPath\":\"/tmp/rabbitmq-plugins/\"}":{".":{},"f:mountPath":{},"f:name":{}},"k:{\"mountPath\":\"/var/lib/rabbitmq/\"}":{".":{},"f:mountPath":{},"f:name":{}},"k:{\"mountPath\":\"/var/lib/rabbitmq/mnesia/\"}":{".":{},"f:mountPath":{},"f:name":{}}}}},"f:restartPolicy":{},"f:schedulerName":{},"f:securityContext":{".":{},"f:fsGroup":{},"f:runAsGroup":{},"f:runAsUser":{}},"f:serviceAccount":{},"f:serviceAccountName":{},"f:terminationGracePeriodSeconds":{},"f:topologySpreadConstraints":{".":{},"k:{\"topologyKey\":\"topology.kubernetes.io/zone\",\"whenUnsatisfiable\":\"ScheduleAnyway\"}":{".":{},"f:labelSelector":{".":{},"f:matchLabels":{".":{},"f:app.kubernetes.io/name":{}}},"f:maxSkew":{},"f:topologyKey":{},"f:whenUnsatisfiable":{}}},"f:volumes":{".":{},"k:{\"name\":\"erlang-cookie-secret\"}":{".":{},"f:name":{},"f:secret":{".":{},"f:defaultMode":{},"f:secretName":{}}},"k:{\"name\":\"plugins-conf\"}":{".":{},"f:configMap":{".":{},"f:defaultMode":{},"f:name":{}},"f:name":{}},"k:{\"name\":\"pod-info\"}":{".":{},"f:downwardAPI":{".":{},"f:defaultMode":{},"f:items":{}},"f:name":{}},"k:{\"name\":\"rabbitmq-confd\"}":{".":{},"f:name":{},"f:projected":{".":{},"f:defaultMode":{},"f:sources":{}}},"k:{\"name\":\"rabbitmq-erlang-cookie\"}":{".":{},"f:emptyDir":{},"f:name":{}},"k:{\"name\":\"rabbitmq-plugins\"}":{".":{},"f:emptyDir":{},"f:name":{}}}}},"f:updateStrategy":{"f:rollingUpdate":{".":{},"f:partition":{}},"f:type":{}},"f:volumeClaimTemplates":{}}}}]},"spec":{"replicas":1,"selector":{"matchLabels":{"app.kubernetes.io/name":"rabbitmq-cluster"}},"template":{"metadata":{"creationTimestamp":null,"labels":{"app.kubernetes.io/component":"rabbitmq","app.kubernetes.io/name":"rabbitmq-cluster","app.kubernetes.io/part-of":"rabbitmq"},"annotations":{"prometheus.io/port":"15692","prometheus.io/scrape":"true"}},"spec":{"volumes":[{"name":"plugins-conf","configMap":{"name":"rabbitmq-cluster-plugins-conf","defaultMode":420}},{"name":"rabbitmq-confd","projected":{"sources":[{"secret":{"name":"rabbitmq-cluster-default-user","items":[{"key":"default_user.conf","path":"default_user.conf"}]}},{"configMap":{"name":"rabbitmq-cluster-server-conf","items":[{"key":"operatorDefaults.conf","path":"operatorDefaults.conf"},{"key":"userDefinedConfiguration.conf","path":"userDefinedConfiguration.conf"}]}}],"defaultMode":420}},{"name":"rabbitmq-erlang-cookie","emptyDir":{}},{"name":"erlang-cookie-secret","secret":{"secretName":"rabbitmq-cluster-erlang-cookie","defaultMode":420}},{"name":"rabbitmq-plugins","emptyDir":{}},{"name":"pod-info","downwardAPI":{"items":[{"path":"skipPreStopChecks","fieldRef":{"apiVersion":"v1","fieldPath":"metadata.labels['skipPreStopChecks']"}}],"defaultMode":420}}],"initContainers":[{"name":"setup-container","image":"rabbitmq:3.8.12-management","command":["sh","-c","cp /tmp/erlang-cookie-secret/.erlang.cookie /var/lib/rabbitmq/.erlang.cookie \u0026\u0026 chown 999:999 /var/lib/rabbitmq/.erlang.cookie \u0026\u0026 chmod 600 /var/lib/rabbitmq/.erlang.cookie ; cp /tmp/rabbitmq-plugins/enabled_plugins /operator/enabled_plugins \u0026\u0026 chown 999:999 /operator/enabled_plugins ; chown 999:999 /var/lib/rabbitmq/mnesia/ ; echo '[default]' \u003e /var/lib/rabbitmq/.rabbitmqadmin.conf \u0026\u0026 sed -e 's/default_user/username/' -e 's/default_pass/password/' /tmp/default_user.conf \u003e\u003e /var/lib/rabbitmq/.rabbitmqadmin.conf \u0026\u0026 chown 999:999 /var/lib/rabbitmq/.rabbitmqadmin.conf \u0026\u0026 chmod 600 /var/lib/rabbitmq/.rabbitmqadmin.conf"],"resources":{"limits":{"cpu":"100m","memory":"500Mi"},"requests":{"cpu":"100m","memory":"500Mi"}},"volumeMounts":[{"name":"plugins-conf","mountPath":"/tmp/rabbitmq-plugins/"},{"name":"rabbitmq-erlang-cookie","mountPath":"/var/lib/rabbitmq/"},{"name":"erlang-cookie-secret","mountPath":"/tmp/erlang-cookie-secret/"},{"name":"rabbitmq-plugins","mountPath":"/operator"},{"name":"persistence","mountPath":"/var/lib/rabbitmq/mnesia/"},{"name":"rabbitmq-confd","mountPath":"/tmp/default_user.conf","subPath":"default_user.conf"}],"terminationMessagePath":"/dev/termination-log","terminationMessagePolicy":"File","imagePullPolicy":"IfNotPresent","securityContext":{"capabilities":{"drop":["FSETID","KILL","SETGID","SETUID","SETPCAP","NET_BIND_SERVICE","NET_RAW","SYS_CHROOT","MKNOD","AUDIT_WRITE","SETFCAP"]},"runAsUser":0}}],"containers":[{"name":"rabbitmq","image":"rabbitmq:3.8.12-management","ports":[{"name":"epmd","containerPort":4369,"protocol":"TCP"},{"name":"amqp","containerPort":5672,"protocol":"TCP"},{"name":"management","containerPort":15672,"protocol":"TCP"},{"name":"prometheus","containerPort":15692,"protocol":"TCP"}],"env":[{"name":"MY_POD_NAME","valueFrom":{"fieldRef":{"apiVersion":"v1","fieldPath":"metadata.name"}}},{"name":"MY_POD_NAMESPACE","valueFrom":{"fieldRef":{"apiVersion":"v1","fieldPath":"metadata.namespace"}}},{"name":"RABBITMQ_ENABLED_PLUGINS_FILE","value":"/operator/enabled_plugins"},{"name":"K8S_SERVICE_NAME","value":"rabbitmq-cluster-nodes"},{"name":"RABBITMQ_USE_LONGNAME","value":"true"},{"name":"RABBITMQ_NODENAME","value":"rabbit@$(MY_POD_NAME).$(K8S_SERVICE_NAME).$(MY_POD_NAMESPACE)"},{"name":"K8S_HOSTNAME_SUFFIX","value":".$(K8S_SERVICE_NAME).$(MY_POD_NAMESPACE)"}],"resources":{"limits":{"cpu":"2","memory":"2Gi"},"requests":{"cpu":"1","memory":"2Gi"}},"volumeMounts":[{"name":"rabbitmq-erlang-cookie","mountPath":"/var/lib/rabbitmq/"},{"name":"persistence","mountPath":"/var/lib/rabbitmq/mnesia/"},{"name":"rabbitmq-plugins","mountPath":"/operator"},{"name":"rabbitmq-confd","mountPath":"/etc/rabbitmq/conf.d/10-operatorDefaults.conf","subPath":"operatorDefaults.conf"},{"name":"rabbitmq-confd","mountPath":"/etc/rabbitmq/conf.d/11-default_user.conf","subPath":"default_user.conf"},{"name":"rabbitmq-confd","mountPath":"/etc/rabbitmq/conf.d/90-userDefinedConfiguration.conf","subPath":"userDefinedConfiguration.conf"},{"name":"pod-info","mountPath":"/etc/pod-info/"}],"readinessProbe":{"tcpSocket":{"port":"amqp"},"initialDelaySeconds":10,"timeoutSeconds":5,"periodSeconds":10,"successThreshold":1,"failureThreshold":3},"lifecycle":{"preStop":{"exec":{"command":["/bin/bash","-c","if [ ! -z \"$(cat /etc/pod-info/skipPreStopChecks)\" ]; then exit 0; fi; rabbitmq-upgrade await_online_quorum_plus_one -t 604800; rabbitmq-upgrade await_online_synchronized_mirror -t 604800; rabbitmq-upgrade drain -t 604800"]}}},"terminationMessagePath":"/dev/termination-log","terminationMessagePolicy":"File","imagePullPolicy":"IfNotPresent"}],"restartPolicy":"Always","terminationGracePeriodSeconds":604800,"dnsPolicy":"ClusterFirst","serviceAccountName":"rabbitmq-cluster-server","serviceAccount":"rabbitmq-cluster-server","automountServiceAccountToken":true,"securityContext":{"runAsUser":999,"runAsGroup":999,"fsGroup":999},"schedulerName":"default-scheduler","topologySpreadConstraints":[{"maxSkew":1,"topologyKey":"topology.kubernetes.io/zone","whenUnsatisfiable":"ScheduleAnyway","labelSelector":{"matchLabels":{"app.kubernetes.io/name":"rabbitmq-cluster"}}}]}},"volumeClaimTemplates":[{"metadata":{"name":"persistence","namespace":"default","creationTimestamp":null,"labels":{"app.kubernetes.io/component":"rabbitmq","app.kubernetes.io/name":"rabbitmq-cluster","app.kubernetes.io/part-of":"rabbitmq"},"ownerReferences":[{"apiVersion":"rabbitmq.com/v1beta1","kind":"RabbitmqCluster","name":"rabbitmq-cluster","uid":"3ecefa8a-1bec-48a7-9af4-dd0df3339101","controller":true,"blockOwnerDeletion":false}]},"spec":{"accessModes":["ReadWriteOnce"],"resources":{"requests":{"storage":"10Gi"}},"volumeMode":"Filesystem"},"status":{"phase":"Pending"}}],"serviceName":"rabbitmq-cluster-nodes","podManagementPolicy":"Parallel","updateStrategy":{"type":"RollingUpdate","rollingUpdate":{"partition":0}},"revisionHistoryLimit":10},"status":{"observedGeneration":1,"replicas":1,"currentReplicas":1,"updatedReplicas":1,"currentRevision":"rabbitmq-cluster-server-5f8b8665fb","updateRevision":"rabbitmq-cluster-server-5f8b8665fb","collisionCount":0}}
2022/03/18 18:07:10 learn_server.go:291: [SIEVE-AFTER-READ]	Get	true	endpoints	default	rabbitmq-cluster	github.com/rabbitmq/cluster-operator/controllers.(*RabbitmqClusterReconciler)	NoError	{"kind":"Endpoints","apiVersion":"v1","metadata":{"name":"rabbitmq-cluster","namespace":"default","selfLink":"/api/v1/namespaces/default/endpoints/rabbitmq-cluster","uid":"eeba9576-0362-4e74-aafd-71e4ffe98d25","resourceVersion":"1251","creationTimestamp":"2022-03-18T18:06:25Z","labels":{"app.kubernetes.io/component":"rabbitmq","app.kubernetes.io/name":"rabbitmq-cluster","app.kubernetes.io/part-of":"rabbitmq"},"annotations":{"endpoints.kubernetes.io/last-change-trigger-time":"2022-03-18T18:06:27Z"},"managedFields":[{"manager":"kube-controller-manager","operation":"Update","apiVersion":"v1","time":"2022-03-18T18:06:49Z","fieldsType":"FieldsV1","fieldsV1":{"f:metadata":{"f:annotations":{".":{},"f:endpoints.kubernetes.io/last-change-trigger-time":{}},"f:labels":{".":{},"f:app.kubernetes.io/component":{},"f:app.kubernetes.io/name":{},"f:app.kubernetes.io/part-of":{}}},"f:subsets":{}}}]},"subsets":[{"notReadyAddresses":[{"ip":"10.244.1.4","nodeName":"kind-worker","targetRef":{"kind":"Pod","namespace":"default","name":"rabbitmq-cluster-server-0","uid":"cbaba199-5faf-480a-81e8-051ce2cc79e6","resourceVersion":"1247"}}],"ports":[{"name":"amqp","port":5672,"protocol":"TCP"},{"name":"management","port":15672,"protocol":"TCP"}]}]}
2022/03/18 18:07:10 learn_server.go:291: [SIEVE-AFTER-READ]	Get	true	statefulset	default	rabbitmq-cluster-server	github.com/rabbitmq/cluster-operator/controllers.(*RabbitmqClusterReconciler)	NoError	{"kind":"StatefulSet","apiVersion":"apps/v1","metadata":{"name":"rabbitmq-cluster-server","namespace":"default","selfLink":"/apis/apps/v1/namespaces/default/statefulsets/rabbitmq-cluster-server","uid":"f2f07f3e-b500-4c48-a5de-8db7eaf37b9a","resourceVersion":"1129","generation":1,"creationTimestamp":"2022-03-18T18:06:25Z","labels":{"app.kubernetes.io/component":"rabbitmq","app.kubernetes.io/name":"rabbitmq-cluster","app.kubernetes.io/part-of":"rabbitmq"},"annotations":{"rabbitmq.com/createdAt":"2022-03-18T18:06:25Z"},"ownerReferences":[{"apiVersion":"rabbitmq.com/v1beta1","kind":"RabbitmqCluster","name":"rabbitmq-cluster","uid":"3ecefa8a-1bec-48a7-9af4-dd0df3339101","controller":true,"blockOwnerDeletion":true}],"managedFields":[{"manager":"kube-controller-manager","operation":"Update","apiVersion":"apps/v1","time":"2022-03-18T18:06:25Z","fieldsType":"FieldsV1","fieldsV1":{"f:status":{"f:collisionCount":{},"f:currentReplicas":{},"f:currentRevision":{},"f:observedGeneration":{},"f:replicas":{},"f:updateRevision":{},"f:updatedReplicas":{}}}},{"manager":"manager","operation":"Update","apiVersion":"apps/v1","time":"2022-03-18T18:06:25Z","fieldsType":"FieldsV1","fieldsV1":{"f:metadata":{"f:annotations":{".":{},"f:rabbitmq.com/createdAt":{}},"f:labels":{".":{},"f:app.kubernetes.io/component":{},"f:app.kubernetes.io/name":{},"f:app.kubernetes.io/part-of":{}},"f:ownerReferences":{".":{},"k:{\"uid\":\"3ecefa8a-1bec-48a7-9af4-dd0df3339101\"}":{".":{},"f:apiVersion":{},"f:blockOwnerDeletion":{},"f:controller":{},"f:kind":{},"f:name":{},"f:uid":{}}}},"f:spec":{"f:podManagementPolicy":{},"f:replicas":{},"f:revisionHistoryLimit":{},"f:selector":{"f:matchLabels":{".":{},"f:app.kubernetes.io/name":{}}},"f:serviceName":{},"f:template":{"f:metadata":{"f:annotations":{".":{},"f:prometheus.io/port":{},"f:prometheus.io/scrape":{}},"f:labels":{".":{},"f:app.kubernetes.io/component":{},"f:app.kubernetes.io/name":{},"f:app.kubernetes.io/part-of":{}}},"f:spec":{"f:automountServiceAccountToken":{},"f:containers":{"k:{\"name\":\"rabbitmq\"}":{".":{},"f:env":{".":{},"k:{\"name\":\"K8S_HOSTNAME_SUFFIX\"}":{".":{},"f:name":{},"f:value":{}},"k:{\"name\":\"K8S_SERVICE_NAME\"}":{".":{},"f:name":{},"f:value":{}},"k:{\"name\":\"MY_POD_NAME\"}":{".":{},"f:name":{},"f:valueFrom":{".":{},"f:fieldRef":{".":{},"f:apiVersion":{},"f:fieldPath":{}}}},"k:{\"name\":\"MY_POD_NAMESPACE\"}":{".":{},"f:name":{},"f:valueFrom":{".":{},"f:fieldRef":{".":{},"f:apiVersion":{},"f:fieldPath":{}}}},"k:{\"name\":\"RABBITMQ_ENABLED_PLUGINS_FILE\"}":{".":{},"f:name":{},"f:value":{}},"k:{\"name\":\"RABBITMQ_NODENAME\"}":{".":{},"f:name":{},"f:value":{}},"k:{\"name\":\"RABBITMQ_USE_LONGNAME\"}":{".":{},"f:name":{},"f:value":{}}},"f:image":{},"f:imagePullPolicy":{},"f:lifecycle":{".":{},"f:preStop":{".":{},"f:exec":{".":{},"f:command":{}}}},"f:name":{},"f:ports":{".":{},"k:{\"containerPort\":4369,\"protocol\":\"TCP\"}":{".":{},"f:containerPort":{},"f:name":{},"f:protocol":{}},"k:{\"containerPort\":5672,\"protocol\":\"TCP\"}":{".":{},"f:containerPort":{},"f:name":{},"f:protocol":{}},"k:{\"containerPort\":15672,\"protocol\":\"TCP\"}":{".":{},"f:containerPort":{},"f:name":{},"f:protocol":{}},"k:{\"containerPort\":15692,\"protocol\":\"TCP\"}":{".":{},"f:containerPort":{},"f:name":{},"f:protocol":{}}},"f:readinessProbe":{".":{},"f:failureThreshold":{},"f:initialDelaySeconds":{},"f:periodSeconds":{},"f:successThreshold":{},"f:tcpSocket":{".":{},"f:port":{}},"f:timeoutSeconds":{}},"f:resources":{".":{},"f:limits":{".":{},"f:cpu":{},"f:memory":{}},"f:requests":{".":{},"f:cpu":{},"f:memory":{}}},"f:terminationMessagePath":{},"f:terminationMessagePolicy":{},"f:volumeMounts":{".":{},"k:{\"mountPath\":\"/etc/pod-info/\"}":{".":{},"f:mountPath":{},"f:name":{}},"k:{\"mountPath\":\"/etc/rabbitmq/conf.d/10-operatorDefaults.conf\"}":{".":{},"f:mountPath":{},"f:name":{},"f:subPath":{}},"k:{\"mountPath\":\"/etc/rabbitmq/conf.d/11-default_user.conf\"}":{".":{},"f:mountPath":{},"f:name":{},"f:subPath":{}},"k:{\"mountPath\":\"/etc/rabbitmq/conf.d/90-userDefinedConfiguration.conf\"}":{".":{},"f:mountPath":{},"f:name":{},"f:subPath":{}},"k:{\"mountPath\":\"/operator\"}":{".":{},"f:mountPath":{},"f:name":{}},"k:{\"mountPath\":\"/var/lib/rabbitmq/\"}":{".":{},"f:mountPath":{},"f:name":{}},"k:{\"mountPath\":\"/var/lib/rabbitmq/mnesia/\"}":{".":{},"f:mountPath":{},"f:name":{}}}}},"f:dnsPolicy":{},"f:initContainers":{".":{},"k:{\"name\":\"setup-container\"}":{".":{},"f:command":{},"f:image":{},"f:imagePullPolicy":{},"f:name":{},"f:resources":{".":{},"f:limits":{".":{},"f:cpu":{},"f:memory":{}},"f:requests":{".":{},"f:cpu":{},"f:memory":{}}},"f:securityContext":{".":{},"f:capabilities":{".":{},"f:drop":{}},"f:runAsUser":{}},"f:terminationMessagePath":{},"f:terminationMessagePolicy":{},"f:volumeMounts":{".":{},"k:{\"mountPath\":\"/operator\"}":{".":{},"f:mountPath":{},"f:name":{}},"k:{\"mountPath\":\"/tmp/default_user.conf\"}":{".":{},"f:mountPath":{},"f:name":{},"f:subPath":{}},"k:{\"mountPath\":\"/tmp/erlang-cookie-secret/\"}":{".":{},"f:mountPath":{},"f:name":{}},"k:{\"mountPath\":\"/tmp/rabbitmq-plugins/\"}":{".":{},"f:mountPath":{},"f:name":{}},"k:{\"mountPath\":\"/var/lib/rabbitmq/\"}":{".":{},"f:mountPath":{},"f:name":{}},"k:{\"mountPath\":\"/var/lib/rabbitmq/mnesia/\"}":{".":{},"f:mountPath":{},"f:name":{}}}}},"f:restartPolicy":{},"f:schedulerName":{},"f:securityContext":{".":{},"f:fsGroup":{},"f:runAsGroup":{},"f:runAsUser":{}},"f:serviceAccount":{},"f:serviceAccountName":{},"f:terminationGracePeriodSeconds":{},"f:topologySpreadConstraints":{".":{},"k:{\"topologyKey\":\"topology.kubernetes.io/zone\",\"whenUnsatisfiable\":\"ScheduleAnyway\"}":{".":{},"f:labelSelector":{".":{},"f:matchLabels":{".":{},"f:app.kubernetes.io/name":{}}},"f:maxSkew":{},"f:topologyKey":{},"f:whenUnsatisfiable":{}}},"f:volumes":{".":{},"k:{\"name\":\"erlang-cookie-secret\"}":{".":{},"f:name":{},"f:secret":{".":{},"f:defaultMode":{},"f:secretName":{}}},"k:{\"name\":\"plugins-conf\"}":{".":{},"f:configMap":{".":{},"f:defaultMode":{},"f:name":{}},"f:name":{}},"k:{\"name\":\"pod-info\"}":{".":{},"f:downwardAPI":{".":{},"f:defaultMode":{},"f:items":{}},"f:name":{}},"k:{\"name\":\"rabbitmq-confd\"}":{".":{},"f:name":{},"f:projected":{".":{},"f:defaultMode":{},"f:sources":{}}},"k:{\"name\":\"rabbitmq-erlang-cookie\"}":{".":{},"f:emptyDir":{},"f:name":{}},"k:{\"name\":\"rabbitmq-plugins\"}":{".":{},"f:emptyDir":{},"f:name":{}}}}},"f:updateStrategy":{"f:rollingUpdate":{".":{},"f:partition":{}},"f:type":{}},"f:volumeClaimTemplates":{}}}}]},"spec":{"replicas":1,"selector":{"matchLabels":{"app.kubernetes.io/name":"rabbitmq-cluster"}},"template":{"metadata":{"creationTimestamp":null,"labels":{"app.kubernetes.io/component":"rabbitmq","app.kubernetes.io/name":"rabbitmq-cluster","app.kubernetes.io/part-of":"rabbitmq"},"annotations":{"prometheus.io/port":"15692","prometheus.io/scrape":"true"}},"spec":{"volumes":[{"name":"plugins-conf","configMap":{"name":"rabbitmq-cluster-plugins-conf","defaultMode":420}},{"name":"rabbitmq-confd","projected":{"sources":[{"secret":{"name":"rabbitmq-cluster-default-user","items":[{"key":"default_user.conf","path":"default_user.conf"}]}},{"configMap":{"name":"rabbitmq-cluster-server-conf","items":[{"key":"operatorDefaults.conf","path":"operatorDefaults.conf"},{"key":"userDefinedConfiguration.conf","path":"userDefinedConfiguration.conf"}]}}],"defaultMode":420}},{"name":"rabbitmq-erlang-cookie","emptyDir":{}},{"name":"erlang-cookie-secret","secret":{"secretName":"rabbitmq-cluster-erlang-cookie","defaultMode":420}},{"name":"rabbitmq-plugins","emptyDir":{}},{"name":"pod-info","downwardAPI":{"items":[{"path":"skipPreStopChecks","fieldRef":{"apiVersion":"v1","fieldPath":"metadata.labels['skipPreStopChecks']"}}],"defaultMode":420}}],"initContainers":[{"name":"setup-container","image":"rabbitmq:3.8.12-management","command":["sh","-c","cp /tmp/erlang-cookie-secret/.erlang.cookie /var/lib/rabbitmq/.erlang.cookie \u0026\u0026 chown 999:999 /var/lib/rabbitmq/.erlang.cookie \u0026\u0026 chmod 600 /var/lib/rabbitmq/.erlang.cookie ; cp /tmp/rabbitmq-plugins/enabled_plugins /operator/enabled_plugins \u0026\u0026 chown 999:999 /operator/enabled_plugins ; chown 999:999 /var/lib/rabbitmq/mnesia/ ; echo '[default]' \u003e /var/lib/rabbitmq/.rabbitmqadmin.conf \u0026\u0026 sed -e 's/default_user/username/' -e 's/default_pass/password/' /tmp/default_user.conf \u003e\u003e /var/lib/rabbitmq/.rabbitmqadmin.conf \u0026\u0026 chown 999:999 /var/lib/rabbitmq/.rabbitmqadmin.conf \u0026\u0026 chmod 600 /var/lib/rabbitmq/.rabbitmqadmin.conf"],"resources":{"limits":{"cpu":"100m","memory":"500Mi"},"requests":{"cpu":"100m","memory":"500Mi"}},"volumeMounts":[{"name":"plugins-conf","mountPath":"/tmp/rabbitmq-plugins/"},{"name":"rabbitmq-erlang-cookie","mountPath":"/var/lib/rabbitmq/"},{"name":"erlang-cookie-secret","mountPath":"/tmp/erlang-cookie-secret/"},{"name":"rabbitmq-plugins","mountPath":"/operator"},{"name":"persistence","mountPath":"/var/lib/rabbitmq/mnesia/"},{"name":"rabbitmq-confd","mountPath":"/tmp/default_user.conf","subPath":"default_user.conf"}],"terminationMessagePath":"/dev/termination-log","terminationMessagePolicy":"File","imagePullPolicy":"IfNotPresent","securityContext":{"capabilities":{"drop":["FSETID","KILL","SETGID","SETUID","SETPCAP","NET_BIND_SERVICE","NET_RAW","SYS_CHROOT","MKNOD","AUDIT_WRITE","SETFCAP"]},"runAsUser":0}}],"containers":[{"name":"rabbitmq","image":"rabbitmq:3.8.12-management","ports":[{"name":"epmd","containerPort":4369,"protocol":"TCP"},{"name":"amqp","containerPort":5672,"protocol":"TCP"},{"name":"management","containerPort":15672,"protocol":"TCP"},{"name":"prometheus","containerPort":15692,"protocol":"TCP"}],"env":[{"name":"MY_POD_NAME","valueFrom":{"fieldRef":{"apiVersion":"v1","fieldPath":"metadata.name"}}},{"name":"MY_POD_NAMESPACE","valueFrom":{"fieldRef":{"apiVersion":"v1","fieldPath":"metadata.namespace"}}},{"name":"RABBITMQ_ENABLED_PLUGINS_FILE","value":"/operator/enabled_plugins"},{"name":"K8S_SERVICE_NAME","value":"rabbitmq-cluster-nodes"},{"name":"RABBITMQ_USE_LONGNAME","value":"true"},{"name":"RABBITMQ_NODENAME","value":"rabbit@$(MY_POD_NAME).$(K8S_SERVICE_NAME).$(MY_POD_NAMESPACE)"},{"name":"K8S_HOSTNAME_SUFFIX","value":".$(K8S_SERVICE_NAME).$(MY_POD_NAMESPACE)"}],"resources":{"limits":{"cpu":"2","memory":"2Gi"},"requests":{"cpu":"1","memory":"2Gi"}},"volumeMounts":[{"name":"rabbitmq-erlang-cookie","mountPath":"/var/lib/rabbitmq/"},{"name":"persistence","mountPath":"/var/lib/rabbitmq/mnesia/"},{"name":"rabbitmq-plugins","mountPath":"/operator"},{"name":"rabbitmq-confd","mountPath":"/etc/rabbitmq/conf.d/10-operatorDefaults.conf","subPath":"operatorDefaults.conf"},{"name":"rabbitmq-confd","mountPath":"/etc/rabbitmq/conf.d/11-default_user.conf","subPath":"default_user.conf"},{"name":"rabbitmq-confd","mountPath":"/etc/rabbitmq/conf.d/90-userDefinedConfiguration.conf","subPath":"userDefinedConfiguration.conf"},{"name":"pod-info","mountPath":"/etc/pod-info/"}],"readinessProbe":{"tcpSocket":{"port":"amqp"},"initialDelaySeconds":10,"timeoutSeconds":5,"periodSeconds":10,"successThreshold":1,"failureThreshold":3},"lifecycle":{"preStop":{"exec":{"command":["/bin/bash","-c","if [ ! -z \"$(cat /etc/pod-info/skipPreStopChecks)\" ]; then exit 0; fi; rabbitmq-upgrade await_online_quorum_plus_one -t 604800; rabbitmq-upgrade await_online_synchronized_mirror -t 604800; rabbitmq-upgrade drain -t 604800"]}}},"terminationMessagePath":"/dev/termination-log","terminationMessagePolicy":"File","imagePullPolicy":"IfNotPresent"}],"restartPolicy":"Always","terminationGracePeriodSeconds":604800,"dnsPolicy":"ClusterFirst","serviceAccountName":"rabbitmq-cluster-server","serviceAccount":"rabbitmq-cluster-server","automountServiceAccountToken":true,"securityContext":{"runAsUser":999,"runAsGroup":999,"fsGroup":999},"schedulerName":"default-scheduler","topologySpreadConstraints":[{"maxSkew":1,"topologyKey":"topology.kubernetes.io/zone","whenUnsatisfiable":"ScheduleAnyway","labelSelector":{"matchLabels":{"app.kubernetes.io/name":"rabbitmq-cluster"}}}]}},"volumeClaimTemplates":[{"metadata":{"name":"persistence","namespace":"default","creationTimestamp":null,"labels":{"app.kubernetes.io/component":"rabbitmq","app.kubernetes.io/name":"rabbitmq-cluster","app.kubernetes.io/part-of":"rabbitmq"},"ownerReferences":[{"apiVersion":"rabbitmq.com/v1beta1","kind":"RabbitmqCluster","name":"rabbitmq-cluster","uid":"3ecefa8a-1bec-48a7-9af4-dd0df3339101","controller":true,"blockOwnerDeletion":false}]},"spec":{"accessModes":["ReadWriteOnce"],"resources":{"requests":{"storage":"10Gi"}},"volumeMode":"Filesystem"},"status":{"phase":"Pending"}}],"serviceName":"rabbitmq-cluster-nodes","podManagementPolicy":"Parallel","updateStrategy":{"type":"RollingUpdate","rollingUpdate":{"partition":0}},"revisionHistoryLimit":10},"status":{"observedGeneration":1,"replicas":1,"currentReplicas":1,"updatedReplicas":1,"currentRevision":"rabbitmq-cluster-server-5f8b8665fb","updateRevision":"rabbitmq-cluster-server-5f8b8665fb","collisionCount":0}}
2022/03/18 18:07:10 learn_server.go:291: [SIEVE-AFTER-READ]	Get	true	service	default	rabbitmq-cluster-nodes	github.com/rabbitmq/cluster-operator/controllers.(*RabbitmqClusterReconciler)	NoError	{"kind":"Service","apiVersion":"v1","metadata":{"name":"rabbitmq-cluster-nodes","namespace":"default","selfLink":"/api/v1/namespaces/default/services/rabbitmq-cluster-nodes","uid":"f843e1c2-ced0-463d-87c1-0e127aaa2006","resourceVersion":"1080","creationTimestamp":"2022-03-18T18:06:25Z","labels":{"app.kubernetes.io/component":"rabbitmq","app.kubernetes.io/name":"rabbitmq-cluster","app.kubernetes.io/part-of":"rabbitmq"},"ownerReferences":[{"apiVersion":"rabbitmq.com/v1beta1","kind":"RabbitmqCluster","name":"rabbitmq-cluster","uid":"3ecefa8a-1bec-48a7-9af4-dd0df3339101","controller":true,"blockOwnerDeletion":true}],"managedFields":[{"manager":"manager","operation":"Update","apiVersion":"v1","time":"2022-03-18T18:06:25Z","fieldsType":"FieldsV1","fieldsV1":{"f:metadata":{"f:labels":{".":{},"f:app.kubernetes.io/component":{},"f:app.kubernetes.io/name":{},"f:app.kubernetes.io/part-of":{}},"f:ownerReferences":{".":{},"k:{\"uid\":\"3ecefa8a-1bec-48a7-9af4-dd0df3339101\"}":{".":{},"f:apiVersion":{},"f:blockOwnerDeletion":{},"f:controller":{},"f:kind":{},"f:name":{},"f:uid":{}}}},"f:spec":{"f:clusterIP":{},"f:ports":{".":{},"k:{\"port\":4369,\"protocol\":\"TCP\"}":{".":{},"f:name":{},"f:port":{},"f:protocol":{},"f:targetPort":{}},"k:{\"port\":25672,\"protocol\":\"TCP\"}":{".":{},"f:name":{},"f:port":{},"f:protocol":{},"f:targetPort":{}}},"f:publishNotReadyAddresses":{},"f:selector":{".":{},"f:app.kubernetes.io/name":{}},"f:sessionAffinity":{},"f:type":{}}}}]},"spec":{"ports":[{"name":"epmd","protocol":"TCP","port":4369,"targetPort":4369},{"name":"cluster-rpc","protocol":"TCP","port":25672,"targetPort":25672}],"selector":{"app.kubernetes.io/name":"rabbitmq-cluster"},"clusterIP":"None","type":"ClusterIP","sessionAffinity":"None","publishNotReadyAddresses":true},"status":{"loadBalancer":{}}}
2022/03/18 18:07:10 learn_server.go:291: [SIEVE-AFTER-READ]	Get	true	service	default	rabbitmq-cluster	github.com/rabbitmq/cluster-operator/controllers.(*RabbitmqClusterReconciler)	NoError	{"kind":"Service","apiVersion":"v1","metadata":{"name":"rabbitmq-cluster","namespace":"default","selfLink":"/api/v1/namespaces/default/services/rabbitmq-cluster","uid":"ae846a70-784e-49ca-99a0-2b0cefb93b46","resourceVersion":"1085","creationTimestamp":"2022-03-18T18:06:25Z","labels":{"app.kubernetes.io/component":"rabbitmq","app.kubernetes.io/name":"rabbitmq-cluster","app.kubernetes.io/part-of":"rabbitmq"},"ownerReferences":[{"apiVersion":"rabbitmq.com/v1beta1","kind":"RabbitmqCluster","name":"rabbitmq-cluster","uid":"3ecefa8a-1bec-48a7-9af4-dd0df3339101","controller":true,"blockOwnerDeletion":true}],"managedFields":[{"manager":"manager","operation":"Update","apiVersion":"v1","time":"2022-03-18T18:06:25Z","fieldsType":"FieldsV1","fieldsV1":{"f:metadata":{"f:labels":{".":{},"f:app.kubernetes.io/component":{},"f:app.kubernetes.io/name":{},"f:app.kubernetes.io/part-of":{}},"f:ownerReferences":{".":{},"k:{\"uid\":\"3ecefa8a-1bec-48a7-9af4-dd0df3339101\"}":{".":{},"f:apiVersion":{},"f:blockOwnerDeletion":{},"f:controller":{},"f:kind":{},"f:name":{},"f:uid":{}}}},"f:spec":{"f:ports":{".":{},"k:{\"port\":5672,\"protocol\":\"TCP\"}":{".":{},"f:name":{},"f:port":{},"f:protocol":{},"f:targetPort":{}},"k:{\"port\":15672,\"protocol\":\"TCP\"}":{".":{},"f:name":{},"f:port":{},"f:protocol":{},"f:targetPort":{}}},"f:selector":{".":{},"f:app.kubernetes.io/name":{}},"f:sessionAffinity":{},"f:type":{}}}}]},"spec":{"ports":[{"name":"amqp","protocol":"TCP","port":5672,"targetPort":5672},{"name":"management","protocol":"TCP","port":15672,"targetPort":15672}],"selector":{"app.kubernetes.io/name":"rabbitmq-cluster"},"clusterIP":"10.96.47.189","type":"ClusterIP","sessionAffinity":"None"},"status":{"loadBalancer":{}}}
2022/03/18 18:07:10 learn_server.go:291: [SIEVE-AFTER-READ]	Get	true	secret	default	rabbitmq-cluster-erlang-cookie	github.com/rabbitmq/cluster-operator/controllers.(*RabbitmqClusterReconciler)	NoError	{"kind":"Secret","apiVersion":"v1","metadata":{"name":"rabbitmq-cluster-erlang-cookie","namespace":"default","selfLink":"/api/v1/namespaces/default/secrets/rabbitmq-cluster-erlang-cookie","uid":"01d8d8ad-080a-4c3f-9d27-56616c53dd26","resourceVersion":"1088","creationTimestamp":"2022-03-18T18:06:25Z","labels":{"app.kubernetes.io/component":"rabbitmq","app.kubernetes.io/name":"rabbitmq-cluster","app.kubernetes.io/part-of":"rabbitmq"},"ownerReferences":[{"apiVersion":"rabbitmq.com/v1beta1","kind":"RabbitmqCluster","name":"rabbitmq-cluster","uid":"3ecefa8a-1bec-48a7-9af4-dd0df3339101","controller":true,"blockOwnerDeletion":true}],"managedFields":[{"manager":"manager","operation":"Update","apiVersion":"v1","time":"2022-03-18T18:06:25Z","fieldsType":"FieldsV1","fieldsV1":{"f:data":{".":{},"f:.erlang.cookie":{}},"f:metadata":{"f:labels":{".":{},"f:app.kubernetes.io/component":{},"f:app.kubernetes.io/name":{},"f:app.kubernetes.io/part-of":{}},"f:ownerReferences":{".":{},"k:{\"uid\":\"3ecefa8a-1bec-48a7-9af4-dd0df3339101\"}":{".":{},"f:apiVersion":{},"f:blockOwnerDeletion":{},"f:controller":{},"f:kind":{},"f:name":{},"f:uid":{}}}},"f:type":{}}}]},"data":{".erlang.cookie":"ajdscUtLdnBpR1NwUUMwc1V3a2VyTlJxU2tVUTdBeEw="},"type":"Opaque"}
2022/03/18 18:07:10 learn_server.go:291: [SIEVE-AFTER-READ]	Get	true	secret	default	rabbitmq-cluster-default-user	github.com/rabbitmq/cluster-operator/controllers.(*RabbitmqClusterReconciler)	NoError	{"kind":"Secret","apiVersion":"v1","metadata":{"name":"rabbitmq-cluster-default-user","namespace":"default","selfLink":"/api/v1/namespaces/default/secrets/rabbitmq-cluster-default-user","uid":"b2f5a936-e51f-4488-b6e9-ca23e4d95ac2","resourceVersion":"1091","creationTimestamp":"2022-03-18T18:06:25Z","labels":{"app.kubernetes.io/component":"rabbitmq","app.kubernetes.io/name":"rabbitmq-cluster","app.kubernetes.io/part-of":"rabbitmq"},"ownerReferences":[{"apiVersion":"rabbitmq.com/v1beta1","kind":"RabbitmqCluster","name":"rabbitmq-cluster","uid":"3ecefa8a-1bec-48a7-9af4-dd0df3339101","controller":true,"blockOwnerDeletion":true}],"managedFields":[{"manager":"manager","operation":"Update","apiVersion":"v1","time":"2022-03-18T18:06:25Z","fieldsType":"FieldsV1","fieldsV1":{"f:data":{".":{},"f:default_user.conf":{},"f:password":{},"f:provider":{},"f:type":{},"f:username":{}},"f:metadata":{"f:labels":{".":{},"f:app.kubernetes.io/component":{},"f:app.kubernetes.io/name":{},"f:app.kubernetes.io/part-of":{}},"f:ownerReferences":{".":{},"k:{\"uid\":\"3ecefa8a-1bec-48a7-9af4-dd0df3339101\"}":{".":{},"f:apiVersion":{},"f:blockOwnerDeletion":{},"f:controller":{},"f:kind":{},"f:name":{},"f:uid":{}}}},"f:type":{}}}]},"data":{"default_user.conf":"ZGVmYXVsdF91c2VyID0gdEFMN1otZTgzR29ocEtsZ0Z4cUFFV3ZXemEtcjdJQW8KZGVmYXVsdF9wYXNzID0gdXVocndkTkdOcmJXQ2p6NFZPX0NUZE9OYURkSUpoRkoK","password":"dXVocndkTkdOcmJXQ2p6NFZPX0NUZE9OYURkSUpoRko=","provider":"cmFiYml0bXE=","type":"cmFiYml0bXE=","username":"dEFMN1otZTgzR29ocEtsZ0Z4cUFFV3ZXemEtcjdJQW8="},"type":"Opaque"}
2022/03/18 18:07:10 learn_server.go:291: [SIEVE-AFTER-READ]	Get	true	configmap	default	rabbitmq-cluster-plugins-conf	github.com/rabbitmq/cluster-operator/controllers.(*RabbitmqClusterReconciler)	NoError	{"kind":"ConfigMap","apiVersion":"v1","metadata":{"name":"rabbitmq-cluster-plugins-conf","namespace":"default","selfLink":"/api/v1/namespaces/default/configmaps/rabbitmq-cluster-plugins-conf","uid":"0aa26eb6-ff3a-4457-a223-284c897db7fe","resourceVersion":"1092","creationTimestamp":"2022-03-18T18:06:25Z","labels":{"app.kubernetes.io/component":"rabbitmq","app.kubernetes.io/name":"rabbitmq-cluster","app.kubernetes.io/part-of":"rabbitmq"},"ownerReferences":[{"apiVersion":"rabbitmq.com/v1beta1","kind":"RabbitmqCluster","name":"rabbitmq-cluster","uid":"3ecefa8a-1bec-48a7-9af4-dd0df3339101","controller":true,"blockOwnerDeletion":true}],"managedFields":[{"manager":"manager","operation":"Update","apiVersion":"v1","time":"2022-03-18T18:06:25Z","fieldsType":"FieldsV1","fieldsV1":{"f:data":{".":{},"f:enabled_plugins":{}},"f:metadata":{"f:labels":{".":{},"f:app.kubernetes.io/component":{},"f:app.kubernetes.io/name":{},"f:app.kubernetes.io/part-of":{}},"f:ownerReferences":{".":{},"k:{\"uid\":\"3ecefa8a-1bec-48a7-9af4-dd0df3339101\"}":{".":{},"f:apiVersion":{},"f:blockOwnerDeletion":{},"f:controller":{},"f:kind":{},"f:name":{},"f:uid":{}}}}}}]},"data":{"enabled_plugins":"[rabbitmq_peer_discovery_k8s,rabbitmq_prometheus,rabbitmq_management]."}}
2022/03/18 18:07:10 learn_server.go:291: [SIEVE-AFTER-READ]	Get	true	configmap	default	rabbitmq-cluster-server-conf	github.com/rabbitmq/cluster-operator/controllers.(*RabbitmqClusterReconciler)	NoError	{"kind":"ConfigMap","apiVersion":"v1","metadata":{"name":"rabbitmq-cluster-server-conf","namespace":"default","selfLink":"/api/v1/namespaces/default/configmaps/rabbitmq-cluster-server-conf","uid":"e4182078-d429-4baf-9021-72618c509ac5","resourceVersion":"1095","creationTimestamp":"2022-03-18T18:06:25Z","labels":{"app.kubernetes.io/component":"rabbitmq","app.kubernetes.io/name":"rabbitmq-cluster","app.kubernetes.io/part-of":"rabbitmq"},"ownerReferences":[{"apiVersion":"rabbitmq.com/v1beta1","kind":"RabbitmqCluster","name":"rabbitmq-cluster","uid":"3ecefa8a-1bec-48a7-9af4-dd0df3339101","controller":true,"blockOwnerDeletion":true}],"managedFields":[{"manager":"manager","operation":"Update","apiVersion":"v1","time":"2022-03-18T18:06:25Z","fieldsType":"FieldsV1","fieldsV1":{"f:data":{".":{},"f:operatorDefaults.conf":{},"f:userDefinedConfiguration.conf":{}},"f:metadata":{"f:labels":{".":{},"f:app.kubernetes.io/component":{},"f:app.kubernetes.io/name":{},"f:app.kubernetes.io/part-of":{}},"f:ownerReferences":{".":{},"k:{\"uid\":\"3ecefa8a-1bec-48a7-9af4-dd0df3339101\"}":{".":{},"f:apiVersion":{},"f:blockOwnerDeletion":{},"f:controller":{},"f:kind":{},"f:name":{},"f:uid":{}}}}}}]},"data":{"operatorDefaults.conf":"cluster_formation.peer_discovery_backend             = rabbit_peer_discovery_k8s\ncluster_formation.k8s.host                           = kubernetes.default\ncluster_formation.k8s.address_type                   = hostname\ncluster_partition_handling                           = pause_minority\nqueue_master_locator                                 = min-masters\ndisk_free_limit.absolute                             = 2GB\ncluster_formation.randomized_startup_delay_range.min = 5\ncluster_formation.randomized_startup_delay_range.max = 30\ncluster_name                                         = rabbitmq-cluster\n","userDefinedConfiguration.conf":"total_memory_available_override_value = 1717986919\n"}}
2022/03/18 18:07:10 learn_server.go:291: [SIEVE-AFTER-READ]	Get	true	serviceaccount	default	rabbitmq-cluster-server	github.com/rabbitmq/cluster-operator/controllers.(*RabbitmqClusterReconciler)	NoError	{"kind":"ServiceAccount","apiVersion":"v1","metadata":{"name":"rabbitmq-cluster-server","namespace":"default","selfLink":"/api/v1/namespaces/default/serviceaccounts/rabbitmq-cluster-server","uid":"0c3cead0-37dd-452b-b939-fe346a5dfdea","resourceVersion":"1102","creationTimestamp":"2022-03-18T18:06:25Z","labels":{"app.kubernetes.io/component":"rabbitmq","app.kubernetes.io/name":"rabbitmq-cluster","app.kubernetes.io/part-of":"rabbitmq"},"ownerReferences":[{"apiVersion":"rabbitmq.com/v1beta1","kind":"RabbitmqCluster","name":"rabbitmq-cluster","uid":"3ecefa8a-1bec-48a7-9af4-dd0df3339101","controller":true,"blockOwnerDeletion":true}],"managedFields":[{"manager":"kube-controller-manager","operation":"Update","apiVersion":"v1","time":"2022-03-18T18:06:25Z","fieldsType":"FieldsV1","fieldsV1":{"f:secrets":{".":{},"k:{\"name\":\"rabbitmq-cluster-server-token-v4wpv\"}":{".":{},"f:name":{}}}}},{"manager":"manager","operation":"Update","apiVersion":"v1","time":"2022-03-18T18:06:25Z","fieldsType":"FieldsV1","fieldsV1":{"f:metadata":{"f:labels":{".":{},"f:app.kubernetes.io/component":{},"f:app.kubernetes.io/name":{},"f:app.kubernetes.io/part-of":{}},"f:ownerReferences":{".":{},"k:{\"uid\":\"3ecefa8a-1bec-48a7-9af4-dd0df3339101\"}":{".":{},"f:apiVersion":{},"f:blockOwnerDeletion":{},"f:controller":{},"f:kind":{},"f:name":{},"f:uid":{}}}}}}]},"secrets":[{"name":"rabbitmq-cluster-server-token-v4wpv"}]}
2022/03/18 18:07:10 learn_server.go:291: [SIEVE-AFTER-READ]	Get	true	role	default	rabbitmq-cluster-peer-discovery	github.com/rabbitmq/cluster-operator/controllers.(*RabbitmqClusterReconciler)	NoError	{"kind":"Role","apiVersion":"rbac.authorization.k8s.io/v1","metadata":{"name":"rabbitmq-cluster-peer-discovery","namespace":"default","selfLink":"/apis/rbac.authorization.k8s.io/v1/namespaces/default/roles/rabbitmq-cluster-peer-discovery","uid":"ec9ac474-1880-43ed-af46-9ea5f46d6db4","resourceVersion":"1103","creationTimestamp":"2022-03-18T18:06:25Z","labels":{"app.kubernetes.io/component":"rabbitmq","app.kubernetes.io/name":"rabbitmq-cluster","app.kubernetes.io/part-of":"rabbitmq"},"ownerReferences":[{"apiVersion":"rabbitmq.com/v1beta1","kind":"RabbitmqCluster","name":"rabbitmq-cluster","uid":"3ecefa8a-1bec-48a7-9af4-dd0df3339101","controller":true,"blockOwnerDeletion":true}],"managedFields":[{"manager":"manager","operation":"Update","apiVersion":"rbac.authorization.k8s.io/v1","time":"2022-03-18T18:06:25Z","fieldsType":"FieldsV1","fieldsV1":{"f:metadata":{"f:labels":{".":{},"f:app.kubernetes.io/component":{},"f:app.kubernetes.io/name":{},"f:app.kubernetes.io/part-of":{}},"f:ownerReferences":{".":{},"k:{\"uid\":\"3ecefa8a-1bec-48a7-9af4-dd0df3339101\"}":{".":{},"f:apiVersion":{},"f:blockOwnerDeletion":{},"f:controller":{},"f:kind":{},"f:name":{},"f:uid":{}}}},"f:rules":{}}}]},"rules":[{"verbs":["get"],"apiGroups":[""],"resources":["endpoints"]},{"verbs":["create"],"apiGroups":[""],"resources":["events"]}]}
2022/03/18 18:07:10 learn_server.go:291: [SIEVE-AFTER-READ]	Get	true	rolebinding	default	rabbitmq-cluster-server	github.com/rabbitmq/cluster-operator/controllers.(*RabbitmqClusterReconciler)	NoError	{"kind":"RoleBinding","apiVersion":"rbac.authorization.k8s.io/v1","metadata":{"name":"rabbitmq-cluster-server","namespace":"default","selfLink":"/apis/rbac.authorization.k8s.io/v1/namespaces/default/rolebindings/rabbitmq-cluster-server","uid":"fe69a41c-8d28-4b84-a9f6-a9e6044d75ba","resourceVersion":"1105","creationTimestamp":"2022-03-18T18:06:25Z","labels":{"app.kubernetes.io/component":"rabbitmq","app.kubernetes.io/name":"rabbitmq-cluster","app.kubernetes.io/part-of":"rabbitmq"},"ownerReferences":[{"apiVersion":"rabbitmq.com/v1beta1","kind":"RabbitmqCluster","name":"rabbitmq-cluster","uid":"3ecefa8a-1bec-48a7-9af4-dd0df3339101","controller":true,"blockOwnerDeletion":true}],"managedFields":[{"manager":"manager","operation":"Update","apiVersion":"rbac.authorization.k8s.io/v1","time":"2022-03-18T18:06:25Z","fieldsType":"FieldsV1","fieldsV1":{"f:metadata":{"f:labels":{".":{},"f:app.kubernetes.io/component":{},"f:app.kubernetes.io/name":{},"f:app.kubernetes.io/part-of":{}},"f:ownerReferences":{".":{},"k:{\"uid\":\"3ecefa8a-1bec-48a7-9af4-dd0df3339101\"}":{".":{},"f:apiVersion":{},"f:blockOwnerDeletion":{},"f:controller":{},"f:kind":{},"f:name":{},"f:uid":{}}}},"f:roleRef":{"f:apiGroup":{},"f:kind":{},"f:name":{}},"f:subjects":{}}}]},"subjects":[{"kind":"ServiceAccount","name":"rabbitmq-cluster-server"}],"roleRef":{"apiGroup":"rbac.authorization.k8s.io","kind":"Role","name":"rabbitmq-cluster-peer-discovery"}}
2022/03/18 18:07:10 learn_server.go:291: [SIEVE-AFTER-READ]	Get	true	statefulset	default	rabbitmq-cluster-server	github.com/rabbitmq/cluster-operator/controllers.(*RabbitmqClusterReconciler)	NoError	{"kind":"StatefulSet","apiVersion":"apps/v1","metadata":{"name":"rabbitmq-cluster-server","namespace":"default","selfLink":"/apis/apps/v1/namespaces/default/statefulsets/rabbitmq-cluster-server","uid":"f2f07f3e-b500-4c48-a5de-8db7eaf37b9a","resourceVersion":"1129","generation":1,"creationTimestamp":"2022-03-18T18:06:25Z","labels":{"app.kubernetes.io/component":"rabbitmq","app.kubernetes.io/name":"rabbitmq-cluster","app.kubernetes.io/part-of":"rabbitmq"},"annotations":{"rabbitmq.com/createdAt":"2022-03-18T18:06:25Z"},"ownerReferences":[{"apiVersion":"rabbitmq.com/v1beta1","kind":"RabbitmqCluster","name":"rabbitmq-cluster","uid":"3ecefa8a-1bec-48a7-9af4-dd0df3339101","controller":true,"blockOwnerDeletion":true}],"managedFields":[{"manager":"kube-controller-manager","operation":"Update","apiVersion":"apps/v1","time":"2022-03-18T18:06:25Z","fieldsType":"FieldsV1","fieldsV1":{"f:status":{"f:collisionCount":{},"f:currentReplicas":{},"f:currentRevision":{},"f:observedGeneration":{},"f:replicas":{},"f:updateRevision":{},"f:updatedReplicas":{}}}},{"manager":"manager","operation":"Update","apiVersion":"apps/v1","time":"2022-03-18T18:06:25Z","fieldsType":"FieldsV1","fieldsV1":{"f:metadata":{"f:annotations":{".":{},"f:rabbitmq.com/createdAt":{}},"f:labels":{".":{},"f:app.kubernetes.io/component":{},"f:app.kubernetes.io/name":{},"f:app.kubernetes.io/part-of":{}},"f:ownerReferences":{".":{},"k:{\"uid\":\"3ecefa8a-1bec-48a7-9af4-dd0df3339101\"}":{".":{},"f:apiVersion":{},"f:blockOwnerDeletion":{},"f:controller":{},"f:kind":{},"f:name":{},"f:uid":{}}}},"f:spec":{"f:podManagementPolicy":{},"f:replicas":{},"f:revisionHistoryLimit":{},"f:selector":{"f:matchLabels":{".":{},"f:app.kubernetes.io/name":{}}},"f:serviceName":{},"f:template":{"f:metadata":{"f:annotations":{".":{},"f:prometheus.io/port":{},"f:prometheus.io/scrape":{}},"f:labels":{".":{},"f:app.kubernetes.io/component":{},"f:app.kubernetes.io/name":{},"f:app.kubernetes.io/part-of":{}}},"f:spec":{"f:automountServiceAccountToken":{},"f:containers":{"k:{\"name\":\"rabbitmq\"}":{".":{},"f:env":{".":{},"k:{\"name\":\"K8S_HOSTNAME_SUFFIX\"}":{".":{},"f:name":{},"f:value":{}},"k:{\"name\":\"K8S_SERVICE_NAME\"}":{".":{},"f:name":{},"f:value":{}},"k:{\"name\":\"MY_POD_NAME\"}":{".":{},"f:name":{},"f:valueFrom":{".":{},"f:fieldRef":{".":{},"f:apiVersion":{},"f:fieldPath":{}}}},"k:{\"name\":\"MY_POD_NAMESPACE\"}":{".":{},"f:name":{},"f:valueFrom":{".":{},"f:fieldRef":{".":{},"f:apiVersion":{},"f:fieldPath":{}}}},"k:{\"name\":\"RABBITMQ_ENABLED_PLUGINS_FILE\"}":{".":{},"f:name":{},"f:value":{}},"k:{\"name\":\"RABBITMQ_NODENAME\"}":{".":{},"f:name":{},"f:value":{}},"k:{\"name\":\"RABBITMQ_USE_LONGNAME\"}":{".":{},"f:name":{},"f:value":{}}},"f:image":{},"f:imagePullPolicy":{},"f:lifecycle":{".":{},"f:preStop":{".":{},"f:exec":{".":{},"f:command":{}}}},"f:name":{},"f:ports":{".":{},"k:{\"containerPort\":4369,\"protocol\":\"TCP\"}":{".":{},"f:containerPort":{},"f:name":{},"f:protocol":{}},"k:{\"containerPort\":5672,\"protocol\":\"TCP\"}":{".":{},"f:containerPort":{},"f:name":{},"f:protocol":{}},"k:{\"containerPort\":15672,\"protocol\":\"TCP\"}":{".":{},"f:containerPort":{},"f:name":{},"f:protocol":{}},"k:{\"containerPort\":15692,\"protocol\":\"TCP\"}":{".":{},"f:containerPort":{},"f:name":{},"f:protocol":{}}},"f:readinessProbe":{".":{},"f:failureThreshold":{},"f:initialDelaySeconds":{},"f:periodSeconds":{},"f:successThreshold":{},"f:tcpSocket":{".":{},"f:port":{}},"f:timeoutSeconds":{}},"f:resources":{".":{},"f:limits":{".":{},"f:cpu":{},"f:memory":{}},"f:requests":{".":{},"f:cpu":{},"f:memory":{}}},"f:terminationMessagePath":{},"f:terminationMessagePolicy":{},"f:volumeMounts":{".":{},"k:{\"mountPath\":\"/etc/pod-info/\"}":{".":{},"f:mountPath":{},"f:name":{}},"k:{\"mountPath\":\"/etc/rabbitmq/conf.d/10-operatorDefaults.conf\"}":{".":{},"f:mountPath":{},"f:name":{},"f:subPath":{}},"k:{\"mountPath\":\"/etc/rabbitmq/conf.d/11-default_user.conf\"}":{".":{},"f:mountPath":{},"f:name":{},"f:subPath":{}},"k:{\"mountPath\":\"/etc/rabbitmq/conf.d/90-userDefinedConfiguration.conf\"}":{".":{},"f:mountPath":{},"f:name":{},"f:subPath":{}},"k:{\"mountPath\":\"/operator\"}":{".":{},"f:mountPath":{},"f:name":{}},"k:{\"mountPath\":\"/var/lib/rabbitmq/\"}":{".":{},"f:mountPath":{},"f:name":{}},"k:{\"mountPath\":\"/var/lib/rabbitmq/mnesia/\"}":{".":{},"f:mountPath":{},"f:name":{}}}}},"f:dnsPolicy":{},"f:initContainers":{".":{},"k:{\"name\":\"setup-container\"}":{".":{},"f:command":{},"f:image":{},"f:imagePullPolicy":{},"f:name":{},"f:resources":{".":{},"f:limits":{".":{},"f:cpu":{},"f:memory":{}},"f:requests":{".":{},"f:cpu":{},"f:memory":{}}},"f:securityContext":{".":{},"f:capabilities":{".":{},"f:drop":{}},"f:runAsUser":{}},"f:terminationMessagePath":{},"f:terminationMessagePolicy":{},"f:volumeMounts":{".":{},"k:{\"mountPath\":\"/operator\"}":{".":{},"f:mountPath":{},"f:name":{}},"k:{\"mountPath\":\"/tmp/default_user.conf\"}":{".":{},"f:mountPath":{},"f:name":{},"f:subPath":{}},"k:{\"mountPath\":\"/tmp/erlang-cookie-secret/\"}":{".":{},"f:mountPath":{},"f:name":{}},"k:{\"mountPath\":\"/tmp/rabbitmq-plugins/\"}":{".":{},"f:mountPath":{},"f:name":{}},"k:{\"mountPath\":\"/var/lib/rabbitmq/\"}":{".":{},"f:mountPath":{},"f:name":{}},"k:{\"mountPath\":\"/var/lib/rabbitmq/mnesia/\"}":{".":{},"f:mountPath":{},"f:name":{}}}}},"f:restartPolicy":{},"f:schedulerName":{},"f:securityContext":{".":{},"f:fsGroup":{},"f:runAsGroup":{},"f:runAsUser":{}},"f:serviceAccount":{},"f:serviceAccountName":{},"f:terminationGracePeriodSeconds":{},"f:topologySpreadConstraints":{".":{},"k:{\"topologyKey\":\"topology.kubernetes.io/zone\",\"whenUnsatisfiable\":\"ScheduleAnyway\"}":{".":{},"f:labelSelector":{".":{},"f:matchLabels":{".":{},"f:app.kubernetes.io/name":{}}},"f:maxSkew":{},"f:topologyKey":{},"f:whenUnsatisfiable":{}}},"f:volumes":{".":{},"k:{\"name\":\"erlang-cookie-secret\"}":{".":{},"f:name":{},"f:secret":{".":{},"f:defaultMode":{},"f:secretName":{}}},"k:{\"name\":\"plugins-conf\"}":{".":{},"f:configMap":{".":{},"f:defaultMode":{},"f:name":{}},"f:name":{}},"k:{\"name\":\"pod-info\"}":{".":{},"f:downwardAPI":{".":{},"f:defaultMode":{},"f:items":{}},"f:name":{}},"k:{\"name\":\"rabbitmq-confd\"}":{".":{},"f:name":{},"f:projected":{".":{},"f:defaultMode":{},"f:sources":{}}},"k:{\"name\":\"rabbitmq-erlang-cookie\"}":{".":{},"f:emptyDir":{},"f:name":{}},"k:{\"name\":\"rabbitmq-plugins\"}":{".":{},"f:emptyDir":{},"f:name":{}}}}},"f:updateStrategy":{"f:rollingUpdate":{".":{},"f:partition":{}},"f:type":{}},"f:volumeClaimTemplates":{}}}}]},"spec":{"replicas":1,"selector":{"matchLabels":{"app.kubernetes.io/name":"rabbitmq-cluster"}},"template":{"metadata":{"creationTimestamp":null,"labels":{"app.kubernetes.io/component":"rabbitmq","app.kubernetes.io/name":"rabbitmq-cluster","app.kubernetes.io/part-of":"rabbitmq"},"annotations":{"prometheus.io/port":"15692","prometheus.io/scrape":"true"}},"spec":{"volumes":[{"name":"plugins-conf","configMap":{"name":"rabbitmq-cluster-plugins-conf","defaultMode":420}},{"name":"rabbitmq-confd","projected":{"sources":[{"secret":{"name":"rabbitmq-cluster-default-user","items":[{"key":"default_user.conf","path":"default_user.conf"}]}},{"configMap":{"name":"rabbitmq-cluster-server-conf","items":[{"key":"operatorDefaults.conf","path":"operatorDefaults.conf"},{"key":"userDefinedConfiguration.conf","path":"userDefinedConfiguration.conf"}]}}],"defaultMode":420}},{"name":"rabbitmq-erlang-cookie","emptyDir":{}},{"name":"erlang-cookie-secret","secret":{"secretName":"rabbitmq-cluster-erlang-cookie","defaultMode":420}},{"name":"rabbitmq-plugins","emptyDir":{}},{"name":"pod-info","downwardAPI":{"items":[{"path":"skipPreStopChecks","fieldRef":{"apiVersion":"v1","fieldPath":"metadata.labels['skipPreStopChecks']"}}],"defaultMode":420}}],"initContainers":[{"name":"setup-container","image":"rabbitmq:3.8.12-management","command":["sh","-c","cp /tmp/erlang-cookie-secret/.erlang.cookie /var/lib/rabbitmq/.erlang.cookie \u0026\u0026 chown 999:999 /var/lib/rabbitmq/.erlang.cookie \u0026\u0026 chmod 600 /var/lib/rabbitmq/.erlang.cookie ; cp /tmp/rabbitmq-plugins/enabled_plugins /operator/enabled_plugins \u0026\u0026 chown 999:999 /operator/enabled_plugins ; chown 999:999 /var/lib/rabbitmq/mnesia/ ; echo '[default]' \u003e /var/lib/rabbitmq/.rabbitmqadmin.conf \u0026\u0026 sed -e 's/default_user/username/' -e 's/default_pass/password/' /tmp/default_user.conf \u003e\u003e /var/lib/rabbitmq/.rabbitmqadmin.conf \u0026\u0026 chown 999:999 /var/lib/rabbitmq/.rabbitmqadmin.conf \u0026\u0026 chmod 600 /var/lib/rabbitmq/.rabbitmqadmin.conf"],"resources":{"limits":{"cpu":"100m","memory":"500Mi"},"requests":{"cpu":"100m","memory":"500Mi"}},"volumeMounts":[{"name":"plugins-conf","mountPath":"/tmp/rabbitmq-plugins/"},{"name":"rabbitmq-erlang-cookie","mountPath":"/var/lib/rabbitmq/"},{"name":"erlang-cookie-secret","mountPath":"/tmp/erlang-cookie-secret/"},{"name":"rabbitmq-plugins","mountPath":"/operator"},{"name":"persistence","mountPath":"/var/lib/rabbitmq/mnesia/"},{"name":"rabbitmq-confd","mountPath":"/tmp/default_user.conf","subPath":"default_user.conf"}],"terminationMessagePath":"/dev/termination-log","terminationMessagePolicy":"File","imagePullPolicy":"IfNotPresent","securityContext":{"capabilities":{"drop":["FSETID","KILL","SETGID","SETUID","SETPCAP","NET_BIND_SERVICE","NET_RAW","SYS_CHROOT","MKNOD","AUDIT_WRITE","SETFCAP"]},"runAsUser":0}}],"containers":[{"name":"rabbitmq","image":"rabbitmq:3.8.12-management","ports":[{"name":"epmd","containerPort":4369,"protocol":"TCP"},{"name":"amqp","containerPort":5672,"protocol":"TCP"},{"name":"management","containerPort":15672,"protocol":"TCP"},{"name":"prometheus","containerPort":15692,"protocol":"TCP"}],"env":[{"name":"MY_POD_NAME","valueFrom":{"fieldRef":{"apiVersion":"v1","fieldPath":"metadata.name"}}},{"name":"MY_POD_NAMESPACE","valueFrom":{"fieldRef":{"apiVersion":"v1","fieldPath":"metadata.namespace"}}},{"name":"RABBITMQ_ENABLED_PLUGINS_FILE","value":"/operator/enabled_plugins"},{"name":"K8S_SERVICE_NAME","value":"rabbitmq-cluster-nodes"},{"name":"RABBITMQ_USE_LONGNAME","value":"true"},{"name":"RABBITMQ_NODENAME","value":"rabbit@$(MY_POD_NAME).$(K8S_SERVICE_NAME).$(MY_POD_NAMESPACE)"},{"name":"K8S_HOSTNAME_SUFFIX","value":".$(K8S_SERVICE_NAME).$(MY_POD_NAMESPACE)"}],"resources":{"limits":{"cpu":"2","memory":"2Gi"},"requests":{"cpu":"1","memory":"2Gi"}},"volumeMounts":[{"name":"rabbitmq-erlang-cookie","mountPath":"/var/lib/rabbitmq/"},{"name":"persistence","mountPath":"/var/lib/rabbitmq/mnesia/"},{"name":"rabbitmq-plugins","mountPath":"/operator"},{"name":"rabbitmq-confd","mountPath":"/etc/rabbitmq/conf.d/10-operatorDefaults.conf","subPath":"operatorDefaults.conf"},{"name":"rabbitmq-confd","mountPath":"/etc/rabbitmq/conf.d/11-default_user.conf","subPath":"default_user.conf"},{"name":"rabbitmq-confd","mountPath":"/etc/rabbitmq/conf.d/90-userDefinedConfiguration.conf","subPath":"userDefinedConfiguration.conf"},{"name":"pod-info","mountPath":"/etc/pod-info/"}],"readinessProbe":{"tcpSocket":{"port":"amqp"},"initialDelaySeconds":10,"timeoutSeconds":5,"periodSeconds":10,"successThreshold":1,"failureThreshold":3},"lifecycle":{"preStop":{"exec":{"command":["/bin/bash","-c","if [ ! -z \"$(cat /etc/pod-info/skipPreStopChecks)\" ]; then exit 0; fi; rabbitmq-upgrade await_online_quorum_plus_one -t 604800; rabbitmq-upgrade await_online_synchronized_mirror -t 604800; rabbitmq-upgrade drain -t 604800"]}}},"terminationMessagePath":"/dev/termination-log","terminationMessagePolicy":"File","imagePullPolicy":"IfNotPresent"}],"restartPolicy":"Always","terminationGracePeriodSeconds":604800,"dnsPolicy":"ClusterFirst","serviceAccountName":"rabbitmq-cluster-server","serviceAccount":"rabbitmq-cluster-server","automountServiceAccountToken":true,"securityContext":{"runAsUser":999,"runAsGroup":999,"fsGroup":999},"schedulerName":"default-scheduler","topologySpreadConstraints":[{"maxSkew":1,"topologyKey":"topology.kubernetes.io/zone","whenUnsatisfiable":"ScheduleAnyway","labelSelector":{"matchLabels":{"app.kubernetes.io/name":"rabbitmq-cluster"}}}]}},"volumeClaimTemplates":[{"metadata":{"name":"persistence","namespace":"default","creationTimestamp":null,"labels":{"app.kubernetes.io/component":"rabbitmq","app.kubernetes.io/name":"rabbitmq-cluster","app.kubernetes.io/part-of":"rabbitmq"},"ownerReferences":[{"apiVersion":"rabbitmq.com/v1beta1","kind":"RabbitmqCluster","name":"rabbitmq-cluster","uid":"3ecefa8a-1bec-48a7-9af4-dd0df3339101","controller":true,"blockOwnerDeletion":false}]},"spec":{"accessModes":["ReadWriteOnce"],"resources":{"requests":{"storage":"10Gi"}},"volumeMode":"Filesystem"},"status":{"phase":"Pending"}}],"serviceName":"rabbitmq-cluster-nodes","podManagementPolicy":"Parallel","updateStrategy":{"type":"RollingUpdate","rollingUpdate":{"partition":0}},"revisionHistoryLimit":10},"status":{"observedGeneration":1,"replicas":1,"currentReplicas":1,"updatedReplicas":1,"currentRevision":"rabbitmq-cluster-server-5f8b8665fb","updateRevision":"rabbitmq-cluster-server-5f8b8665fb","collisionCount":0}}
2022/03/18 18:07:10 learn_server.go:291: [SIEVE-AFTER-READ]	Get	true	statefulset	default	rabbitmq-cluster-server	github.com/rabbitmq/cluster-operator/controllers.(*RabbitmqClusterReconciler)	NoError	{"kind":"StatefulSet","apiVersion":"apps/v1","metadata":{"name":"rabbitmq-cluster-server","namespace":"default","selfLink":"/apis/apps/v1/namespaces/default/statefulsets/rabbitmq-cluster-server","uid":"f2f07f3e-b500-4c48-a5de-8db7eaf37b9a","resourceVersion":"1129","generation":1,"creationTimestamp":"2022-03-18T18:06:25Z","labels":{"app.kubernetes.io/component":"rabbitmq","app.kubernetes.io/name":"rabbitmq-cluster","app.kubernetes.io/part-of":"rabbitmq"},"annotations":{"rabbitmq.com/createdAt":"2022-03-18T18:06:25Z"},"ownerReferences":[{"apiVersion":"rabbitmq.com/v1beta1","kind":"RabbitmqCluster","name":"rabbitmq-cluster","uid":"3ecefa8a-1bec-48a7-9af4-dd0df3339101","controller":true,"blockOwnerDeletion":true}],"managedFields":[{"manager":"kube-controller-manager","operation":"Update","apiVersion":"apps/v1","time":"2022-03-18T18:06:25Z","fieldsType":"FieldsV1","fieldsV1":{"f:status":{"f:collisionCount":{},"f:currentReplicas":{},"f:currentRevision":{},"f:observedGeneration":{},"f:replicas":{},"f:updateRevision":{},"f:updatedReplicas":{}}}},{"manager":"manager","operation":"Update","apiVersion":"apps/v1","time":"2022-03-18T18:06:25Z","fieldsType":"FieldsV1","fieldsV1":{"f:metadata":{"f:annotations":{".":{},"f:rabbitmq.com/createdAt":{}},"f:labels":{".":{},"f:app.kubernetes.io/component":{},"f:app.kubernetes.io/name":{},"f:app.kubernetes.io/part-of":{}},"f:ownerReferences":{".":{},"k:{\"uid\":\"3ecefa8a-1bec-48a7-9af4-dd0df3339101\"}":{".":{},"f:apiVersion":{},"f:blockOwnerDeletion":{},"f:controller":{},"f:kind":{},"f:name":{},"f:uid":{}}}},"f:spec":{"f:podManagementPolicy":{},"f:replicas":{},"f:revisionHistoryLimit":{},"f:selector":{"f:matchLabels":{".":{},"f:app.kubernetes.io/name":{}}},"f:serviceName":{},"f:template":{"f:metadata":{"f:annotations":{".":{},"f:prometheus.io/port":{},"f:prometheus.io/scrape":{}},"f:labels":{".":{},"f:app.kubernetes.io/component":{},"f:app.kubernetes.io/name":{},"f:app.kubernetes.io/part-of":{}}},"f:spec":{"f:automountServiceAccountToken":{},"f:containers":{"k:{\"name\":\"rabbitmq\"}":{".":{},"f:env":{".":{},"k:{\"name\":\"K8S_HOSTNAME_SUFFIX\"}":{".":{},"f:name":{},"f:value":{}},"k:{\"name\":\"K8S_SERVICE_NAME\"}":{".":{},"f:name":{},"f:value":{}},"k:{\"name\":\"MY_POD_NAME\"}":{".":{},"f:name":{},"f:valueFrom":{".":{},"f:fieldRef":{".":{},"f:apiVersion":{},"f:fieldPath":{}}}},"k:{\"name\":\"MY_POD_NAMESPACE\"}":{".":{},"f:name":{},"f:valueFrom":{".":{},"f:fieldRef":{".":{},"f:apiVersion":{},"f:fieldPath":{}}}},"k:{\"name\":\"RABBITMQ_ENABLED_PLUGINS_FILE\"}":{".":{},"f:name":{},"f:value":{}},"k:{\"name\":\"RABBITMQ_NODENAME\"}":{".":{},"f:name":{},"f:value":{}},"k:{\"name\":\"RABBITMQ_USE_LONGNAME\"}":{".":{},"f:name":{},"f:value":{}}},"f:image":{},"f:imagePullPolicy":{},"f:lifecycle":{".":{},"f:preStop":{".":{},"f:exec":{".":{},"f:command":{}}}},"f:name":{},"f:ports":{".":{},"k:{\"containerPort\":4369,\"protocol\":\"TCP\"}":{".":{},"f:containerPort":{},"f:name":{},"f:protocol":{}},"k:{\"containerPort\":5672,\"protocol\":\"TCP\"}":{".":{},"f:containerPort":{},"f:name":{},"f:protocol":{}},"k:{\"containerPort\":15672,\"protocol\":\"TCP\"}":{".":{},"f:containerPort":{},"f:name":{},"f:protocol":{}},"k:{\"containerPort\":15692,\"protocol\":\"TCP\"}":{".":{},"f:containerPort":{},"f:name":{},"f:protocol":{}}},"f:readinessProbe":{".":{},"f:failureThreshold":{},"f:initialDelaySeconds":{},"f:periodSeconds":{},"f:successThreshold":{},"f:tcpSocket":{".":{},"f:port":{}},"f:timeoutSeconds":{}},"f:resources":{".":{},"f:limits":{".":{},"f:cpu":{},"f:memory":{}},"f:requests":{".":{},"f:cpu":{},"f:memory":{}}},"f:terminationMessagePath":{},"f:terminationMessagePolicy":{},"f:volumeMounts":{".":{},"k:{\"mountPath\":\"/etc/pod-info/\"}":{".":{},"f:mountPath":{},"f:name":{}},"k:{\"mountPath\":\"/etc/rabbitmq/conf.d/10-operatorDefaults.conf\"}":{".":{},"f:mountPath":{},"f:name":{},"f:subPath":{}},"k:{\"mountPath\":\"/etc/rabbitmq/conf.d/11-default_user.conf\"}":{".":{},"f:mountPath":{},"f:name":{},"f:subPath":{}},"k:{\"mountPath\":\"/etc/rabbitmq/conf.d/90-userDefinedConfiguration.conf\"}":{".":{},"f:mountPath":{},"f:name":{},"f:subPath":{}},"k:{\"mountPath\":\"/operator\"}":{".":{},"f:mountPath":{},"f:name":{}},"k:{\"mountPath\":\"/var/lib/rabbitmq/\"}":{".":{},"f:mountPath":{},"f:name":{}},"k:{\"mountPath\":\"/var/lib/rabbitmq/mnesia/\"}":{".":{},"f:mountPath":{},"f:name":{}}}}},"f:dnsPolicy":{},"f:initContainers":{".":{},"k:{\"name\":\"setup-container\"}":{".":{},"f:command":{},"f:image":{},"f:imagePullPolicy":{},"f:name":{},"f:resources":{".":{},"f:limits":{".":{},"f:cpu":{},"f:memory":{}},"f:requests":{".":{},"f:cpu":{},"f:memory":{}}},"f:securityContext":{".":{},"f:capabilities":{".":{},"f:drop":{}},"f:runAsUser":{}},"f:terminationMessagePath":{},"f:terminationMessagePolicy":{},"f:volumeMounts":{".":{},"k:{\"mountPath\":\"/operator\"}":{".":{},"f:mountPath":{},"f:name":{}},"k:{\"mountPath\":\"/tmp/default_user.conf\"}":{".":{},"f:mountPath":{},"f:name":{},"f:subPath":{}},"k:{\"mountPath\":\"/tmp/erlang-cookie-secret/\"}":{".":{},"f:mountPath":{},"f:name":{}},"k:{\"mountPath\":\"/tmp/rabbitmq-plugins/\"}":{".":{},"f:mountPath":{},"f:name":{}},"k:{\"mountPath\":\"/var/lib/rabbitmq/\"}":{".":{},"f:mountPath":{},"f:name":{}},"k:{\"mountPath\":\"/var/lib/rabbitmq/mnesia/\"}":{".":{},"f:mountPath":{},"f:name":{}}}}},"f:restartPolicy":{},"f:schedulerName":{},"f:securityContext":{".":{},"f:fsGroup":{},"f:runAsGroup":{},"f:runAsUser":{}},"f:serviceAccount":{},"f:serviceAccountName":{},"f:terminationGracePeriodSeconds":{},"f:topologySpreadConstraints":{".":{},"k:{\"topologyKey\":\"topology.kubernetes.io/zone\",\"whenUnsatisfiable\":\"ScheduleAnyway\"}":{".":{},"f:labelSelector":{".":{},"f:matchLabels":{".":{},"f:app.kubernetes.io/name":{}}},"f:maxSkew":{},"f:topologyKey":{},"f:whenUnsatisfiable":{}}},"f:volumes":{".":{},"k:{\"name\":\"erlang-cookie-secret\"}":{".":{},"f:name":{},"f:secret":{".":{},"f:defaultMode":{},"f:secretName":{}}},"k:{\"name\":\"plugins-conf\"}":{".":{},"f:configMap":{".":{},"f:defaultMode":{},"f:name":{}},"f:name":{}},"k:{\"name\":\"pod-info\"}":{".":{},"f:downwardAPI":{".":{},"f:defaultMode":{},"f:items":{}},"f:name":{}},"k:{\"name\":\"rabbitmq-confd\"}":{".":{},"f:name":{},"f:projected":{".":{},"f:defaultMode":{},"f:sources":{}}},"k:{\"name\":\"rabbitmq-erlang-cookie\"}":{".":{},"f:emptyDir":{},"f:name":{}},"k:{\"name\":\"rabbitmq-plugins\"}":{".":{},"f:emptyDir":{},"f:name":{}}}}},"f:updateStrategy":{"f:rollingUpdate":{".":{},"f:partition":{}},"f:type":{}},"f:volumeClaimTemplates":{}}}}]},"spec":{"replicas":1,"selector":{"matchLabels":{"app.kubernetes.io/name":"rabbitmq-cluster"}},"template":{"metadata":{"creationTimestamp":null,"labels":{"app.kubernetes.io/component":"rabbitmq","app.kubernetes.io/name":"rabbitmq-cluster","app.kubernetes.io/part-of":"rabbitmq"},"annotations":{"prometheus.io/port":"15692","prometheus.io/scrape":"true"}},"spec":{"volumes":[{"name":"plugins-conf","configMap":{"name":"rabbitmq-cluster-plugins-conf","defaultMode":420}},{"name":"rabbitmq-confd","projected":{"sources":[{"secret":{"name":"rabbitmq-cluster-default-user","items":[{"key":"default_user.conf","path":"default_user.conf"}]}},{"configMap":{"name":"rabbitmq-cluster-server-conf","items":[{"key":"operatorDefaults.conf","path":"operatorDefaults.conf"},{"key":"userDefinedConfiguration.conf","path":"userDefinedConfiguration.conf"}]}}],"defaultMode":420}},{"name":"rabbitmq-erlang-cookie","emptyDir":{}},{"name":"erlang-cookie-secret","secret":{"secretName":"rabbitmq-cluster-erlang-cookie","defaultMode":420}},{"name":"rabbitmq-plugins","emptyDir":{}},{"name":"pod-info","downwardAPI":{"items":[{"path":"skipPreStopChecks","fieldRef":{"apiVersion":"v1","fieldPath":"metadata.labels['skipPreStopChecks']"}}],"defaultMode":420}}],"initContainers":[{"name":"setup-container","image":"rabbitmq:3.8.12-management","command":["sh","-c","cp /tmp/erlang-cookie-secret/.erlang.cookie /var/lib/rabbitmq/.erlang.cookie \u0026\u0026 chown 999:999 /var/lib/rabbitmq/.erlang.cookie \u0026\u0026 chmod 600 /var/lib/rabbitmq/.erlang.cookie ; cp /tmp/rabbitmq-plugins/enabled_plugins /operator/enabled_plugins \u0026\u0026 chown 999:999 /operator/enabled_plugins ; chown 999:999 /var/lib/rabbitmq/mnesia/ ; echo '[default]' \u003e /var/lib/rabbitmq/.rabbitmqadmin.conf \u0026\u0026 sed -e 's/default_user/username/' -e 's/default_pass/password/' /tmp/default_user.conf \u003e\u003e /var/lib/rabbitmq/.rabbitmqadmin.conf \u0026\u0026 chown 999:999 /var/lib/rabbitmq/.rabbitmqadmin.conf \u0026\u0026 chmod 600 /var/lib/rabbitmq/.rabbitmqadmin.conf"],"resources":{"limits":{"cpu":"100m","memory":"500Mi"},"requests":{"cpu":"100m","memory":"500Mi"}},"volumeMounts":[{"name":"plugins-conf","mountPath":"/tmp/rabbitmq-plugins/"},{"name":"rabbitmq-erlang-cookie","mountPath":"/var/lib/rabbitmq/"},{"name":"erlang-cookie-secret","mountPath":"/tmp/erlang-cookie-secret/"},{"name":"rabbitmq-plugins","mountPath":"/operator"},{"name":"persistence","mountPath":"/var/lib/rabbitmq/mnesia/"},{"name":"rabbitmq-confd","mountPath":"/tmp/default_user.conf","subPath":"default_user.conf"}],"terminationMessagePath":"/dev/termination-log","terminationMessagePolicy":"File","imagePullPolicy":"IfNotPresent","securityContext":{"capabilities":{"drop":["FSETID","KILL","SETGID","SETUID","SETPCAP","NET_BIND_SERVICE","NET_RAW","SYS_CHROOT","MKNOD","AUDIT_WRITE","SETFCAP"]},"runAsUser":0}}],"containers":[{"name":"rabbitmq","image":"rabbitmq:3.8.12-management","ports":[{"name":"epmd","containerPort":4369,"protocol":"TCP"},{"name":"amqp","containerPort":5672,"protocol":"TCP"},{"name":"management","containerPort":15672,"protocol":"TCP"},{"name":"prometheus","containerPort":15692,"protocol":"TCP"}],"env":[{"name":"MY_POD_NAME","valueFrom":{"fieldRef":{"apiVersion":"v1","fieldPath":"metadata.name"}}},{"name":"MY_POD_NAMESPACE","valueFrom":{"fieldRef":{"apiVersion":"v1","fieldPath":"metadata.namespace"}}},{"name":"RABBITMQ_ENABLED_PLUGINS_FILE","value":"/operator/enabled_plugins"},{"name":"K8S_SERVICE_NAME","value":"rabbitmq-cluster-nodes"},{"name":"RABBITMQ_USE_LONGNAME","value":"true"},{"name":"RABBITMQ_NODENAME","value":"rabbit@$(MY_POD_NAME).$(K8S_SERVICE_NAME).$(MY_POD_NAMESPACE)"},{"name":"K8S_HOSTNAME_SUFFIX","value":".$(K8S_SERVICE_NAME).$(MY_POD_NAMESPACE)"}],"resources":{"limits":{"cpu":"2","memory":"2Gi"},"requests":{"cpu":"1","memory":"2Gi"}},"volumeMounts":[{"name":"rabbitmq-erlang-cookie","mountPath":"/var/lib/rabbitmq/"},{"name":"persistence","mountPath":"/var/lib/rabbitmq/mnesia/"},{"name":"rabbitmq-plugins","mountPath":"/operator"},{"name":"rabbitmq-confd","mountPath":"/etc/rabbitmq/conf.d/10-operatorDefaults.conf","subPath":"operatorDefaults.conf"},{"name":"rabbitmq-confd","mountPath":"/etc/rabbitmq/conf.d/11-default_user.conf","subPath":"default_user.conf"},{"name":"rabbitmq-confd","mountPath":"/etc/rabbitmq/conf.d/90-userDefinedConfiguration.conf","subPath":"userDefinedConfiguration.conf"},{"name":"pod-info","mountPath":"/etc/pod-info/"}],"readinessProbe":{"tcpSocket":{"port":"amqp"},"initialDelaySeconds":10,"timeoutSeconds":5,"periodSeconds":10,"successThreshold":1,"failureThreshold":3},"lifecycle":{"preStop":{"exec":{"command":["/bin/bash","-c","if [ ! -z \"$(cat /etc/pod-info/skipPreStopChecks)\" ]; then exit 0; fi; rabbitmq-upgrade await_online_quorum_plus_one -t 604800; rabbitmq-upgrade await_online_synchronized_mirror -t 604800; rabbitmq-upgrade drain -t 604800"]}}},"terminationMessagePath":"/dev/termination-log","terminationMessagePolicy":"File","imagePullPolicy":"IfNotPresent"}],"restartPolicy":"Always","terminationGracePeriodSeconds":604800,"dnsPolicy":"ClusterFirst","serviceAccountName":"rabbitmq-cluster-server","serviceAccount":"rabbitmq-cluster-server","automountServiceAccountToken":true,"securityContext":{"runAsUser":999,"runAsGroup":999,"fsGroup":999},"schedulerName":"default-scheduler","topologySpreadConstraints":[{"maxSkew":1,"topologyKey":"topology.kubernetes.io/zone","whenUnsatisfiable":"ScheduleAnyway","labelSelector":{"matchLabels":{"app.kubernetes.io/name":"rabbitmq-cluster"}}}]}},"volumeClaimTemplates":[{"metadata":{"name":"persistence","namespace":"default","creationTimestamp":null,"labels":{"app.kubernetes.io/component":"rabbitmq","app.kubernetes.io/name":"rabbitmq-cluster","app.kubernetes.io/part-of":"rabbitmq"},"ownerReferences":[{"apiVersion":"rabbitmq.com/v1beta1","kind":"RabbitmqCluster","name":"rabbitmq-cluster","uid":"3ecefa8a-1bec-48a7-9af4-dd0df3339101","controller":true,"blockOwnerDeletion":false}]},"spec":{"accessModes":["ReadWriteOnce"],"resources":{"requests":{"storage":"10Gi"}},"volumeMode":"Filesystem"},"status":{"phase":"Pending"}}],"serviceName":"rabbitmq-cluster-nodes","podManagementPolicy":"Parallel","updateStrategy":{"type":"RollingUpdate","rollingUpdate":{"partition":0}},"revisionHistoryLimit":10},"status":{"observedGeneration":1,"replicas":1,"currentReplicas":1,"updatedReplicas":1,"currentRevision":"rabbitmq-cluster-server-5f8b8665fb","updateRevision":"rabbitmq-cluster-server-5f8b8665fb","collisionCount":0}}
2022/03/18 18:07:10 learn_server.go:256: [SIEVE-BEFORE-WRITE]	24
2022/03/18 18:07:10 learn_server.go:263: [SIEVE-AFTER-WRITE]	24	Update	statefulset	github.com/rabbitmq/cluster-operator/controllers.(*RabbitmqClusterReconciler)	NoError	{"metadata":{"name":"rabbitmq-cluster-server","namespace":"default","selfLink":"/apis/apps/v1/namespaces/default/statefulsets/rabbitmq-cluster-server","uid":"f2f07f3e-b500-4c48-a5de-8db7eaf37b9a","resourceVersion":"1129","generation":1,"creationTimestamp":"2022-03-18T18:06:25Z","labels":{"app.kubernetes.io/component":"rabbitmq","app.kubernetes.io/name":"rabbitmq-cluster","app.kubernetes.io/part-of":"rabbitmq"},"annotations":{"rabbitmq.com/createdAt":"2022-03-18T18:06:25Z"},"ownerReferences":[{"apiVersion":"rabbitmq.com/v1beta1","kind":"RabbitmqCluster","name":"rabbitmq-cluster","uid":"3ecefa8a-1bec-48a7-9af4-dd0df3339101","controller":true,"blockOwnerDeletion":true}],"managedFields":[{"manager":"kube-controller-manager","operation":"Update","apiVersion":"apps/v1","time":"2022-03-18T18:06:25Z","fieldsType":"FieldsV1","fieldsV1":{"f:status":{"f:collisionCount":{},"f:currentReplicas":{},"f:currentRevision":{},"f:observedGeneration":{},"f:replicas":{},"f:updateRevision":{},"f:updatedReplicas":{}}}},{"manager":"manager","operation":"Update","apiVersion":"apps/v1","time":"2022-03-18T18:06:25Z","fieldsType":"FieldsV1","fieldsV1":{"f:metadata":{"f:annotations":{".":{},"f:rabbitmq.com/createdAt":{}},"f:labels":{".":{},"f:app.kubernetes.io/component":{},"f:app.kubernetes.io/name":{},"f:app.kubernetes.io/part-of":{}},"f:ownerReferences":{".":{},"k:{\"uid\":\"3ecefa8a-1bec-48a7-9af4-dd0df3339101\"}":{".":{},"f:apiVersion":{},"f:blockOwnerDeletion":{},"f:controller":{},"f:kind":{},"f:name":{},"f:uid":{}}}},"f:spec":{"f:podManagementPolicy":{},"f:replicas":{},"f:revisionHistoryLimit":{},"f:selector":{"f:matchLabels":{".":{},"f:app.kubernetes.io/name":{}}},"f:serviceName":{},"f:template":{"f:metadata":{"f:annotations":{".":{},"f:prometheus.io/port":{},"f:prometheus.io/scrape":{}},"f:labels":{".":{},"f:app.kubernetes.io/component":{},"f:app.kubernetes.io/name":{},"f:app.kubernetes.io/part-of":{}}},"f:spec":{"f:automountServiceAccountToken":{},"f:containers":{"k:{\"name\":\"rabbitmq\"}":{".":{},"f:env":{".":{},"k:{\"name\":\"K8S_HOSTNAME_SUFFIX\"}":{".":{},"f:name":{},"f:value":{}},"k:{\"name\":\"K8S_SERVICE_NAME\"}":{".":{},"f:name":{},"f:value":{}},"k:{\"name\":\"MY_POD_NAME\"}":{".":{},"f:name":{},"f:valueFrom":{".":{},"f:fieldRef":{".":{},"f:apiVersion":{},"f:fieldPath":{}}}},"k:{\"name\":\"MY_POD_NAMESPACE\"}":{".":{},"f:name":{},"f:valueFrom":{".":{},"f:fieldRef":{".":{},"f:apiVersion":{},"f:fieldPath":{}}}},"k:{\"name\":\"RABBITMQ_ENABLED_PLUGINS_FILE\"}":{".":{},"f:name":{},"f:value":{}},"k:{\"name\":\"RABBITMQ_NODENAME\"}":{".":{},"f:name":{},"f:value":{}},"k:{\"name\":\"RABBITMQ_USE_LONGNAME\"}":{".":{},"f:name":{},"f:value":{}}},"f:image":{},"f:imagePullPolicy":{},"f:lifecycle":{".":{},"f:preStop":{".":{},"f:exec":{".":{},"f:command":{}}}},"f:name":{},"f:ports":{".":{},"k:{\"containerPort\":4369,\"protocol\":\"TCP\"}":{".":{},"f:containerPort":{},"f:name":{},"f:protocol":{}},"k:{\"containerPort\":5672,\"protocol\":\"TCP\"}":{".":{},"f:containerPort":{},"f:name":{},"f:protocol":{}},"k:{\"containerPort\":15672,\"protocol\":\"TCP\"}":{".":{},"f:containerPort":{},"f:name":{},"f:protocol":{}},"k:{\"containerPort\":15692,\"protocol\":\"TCP\"}":{".":{},"f:containerPort":{},"f:name":{},"f:protocol":{}}},"f:readinessProbe":{".":{},"f:failureThreshold":{},"f:initialDelaySeconds":{},"f:periodSeconds":{},"f:successThreshold":{},"f:tcpSocket":{".":{},"f:port":{}},"f:timeoutSeconds":{}},"f:resources":{".":{},"f:limits":{".":{},"f:cpu":{},"f:memory":{}},"f:requests":{".":{},"f:cpu":{},"f:memory":{}}},"f:terminationMessagePath":{},"f:terminationMessagePolicy":{},"f:volumeMounts":{".":{},"k:{\"mountPath\":\"/etc/pod-info/\"}":{".":{},"f:mountPath":{},"f:name":{}},"k:{\"mountPath\":\"/etc/rabbitmq/conf.d/10-operatorDefaults.conf\"}":{".":{},"f:mountPath":{},"f:name":{},"f:subPath":{}},"k:{\"mountPath\":\"/etc/rabbitmq/conf.d/11-default_user.conf\"}":{".":{},"f:mountPath":{},"f:name":{},"f:subPath":{}},"k:{\"mountPath\":\"/etc/rabbitmq/conf.d/90-userDefinedConfiguration.conf\"}":{".":{},"f:mountPath":{},"f:name":{},"f:subPath":{}},"k:{\"mountPath\":\"/operator\"}":{".":{},"f:mountPath":{},"f:name":{}},"k:{\"mountPath\":\"/var/lib/rabbitmq/\"}":{".":{},"f:mountPath":{},"f:name":{}},"k:{\"mountPath\":\"/var/lib/rabbitmq/mnesia/\"}":{".":{},"f:mountPath":{},"f:name":{}}}}},"f:dnsPolicy":{},"f:initContainers":{".":{},"k:{\"name\":\"setup-container\"}":{".":{},"f:command":{},"f:image":{},"f:imagePullPolicy":{},"f:name":{},"f:resources":{".":{},"f:limits":{".":{},"f:cpu":{},"f:memory":{}},"f:requests":{".":{},"f:cpu":{},"f:memory":{}}},"f:securityContext":{".":{},"f:capabilities":{".":{},"f:drop":{}},"f:runAsUser":{}},"f:terminationMessagePath":{},"f:terminationMessagePolicy":{},"f:volumeMounts":{".":{},"k:{\"mountPath\":\"/operator\"}":{".":{},"f:mountPath":{},"f:name":{}},"k:{\"mountPath\":\"/tmp/default_user.conf\"}":{".":{},"f:mountPath":{},"f:name":{},"f:subPath":{}},"k:{\"mountPath\":\"/tmp/erlang-cookie-secret/\"}":{".":{},"f:mountPath":{},"f:name":{}},"k:{\"mountPath\":\"/tmp/rabbitmq-plugins/\"}":{".":{},"f:mountPath":{},"f:name":{}},"k:{\"mountPath\":\"/var/lib/rabbitmq/\"}":{".":{},"f:mountPath":{},"f:name":{}},"k:{\"mountPath\":\"/var/lib/rabbitmq/mnesia/\"}":{".":{},"f:mountPath":{},"f:name":{}}}}},"f:restartPolicy":{},"f:schedulerName":{},"f:securityContext":{".":{},"f:fsGroup":{},"f:runAsGroup":{},"f:runAsUser":{}},"f:serviceAccount":{},"f:serviceAccountName":{},"f:terminationGracePeriodSeconds":{},"f:topologySpreadConstraints":{".":{},"k:{\"topologyKey\":\"topology.kubernetes.io/zone\",\"whenUnsatisfiable\":\"ScheduleAnyway\"}":{".":{},"f:labelSelector":{".":{},"f:matchLabels":{".":{},"f:app.kubernetes.io/name":{}}},"f:maxSkew":{},"f:topologyKey":{},"f:whenUnsatisfiable":{}}},"f:volumes":{".":{},"k:{\"name\":\"erlang-cookie-secret\"}":{".":{},"f:name":{},"f:secret":{".":{},"f:defaultMode":{},"f:secretName":{}}},"k:{\"name\":\"plugins-conf\"}":{".":{},"f:configMap":{".":{},"f:defaultMode":{},"f:name":{}},"f:name":{}},"k:{\"name\":\"pod-info\"}":{".":{},"f:downwardAPI":{".":{},"f:defaultMode":{},"f:items":{}},"f:name":{}},"k:{\"name\":\"rabbitmq-confd\"}":{".":{},"f:name":{},"f:projected":{".":{},"f:defaultMode":{},"f:sources":{}}},"k:{\"name\":\"rabbitmq-erlang-cookie\"}":{".":{},"f:emptyDir":{},"f:name":{}},"k:{\"name\":\"rabbitmq-plugins\"}":{".":{},"f:emptyDir":{},"f:name":{}}}}},"f:updateStrategy":{"f:rollingUpdate":{".":{},"f:partition":{}},"f:type":{}},"f:volumeClaimTemplates":{}}}}]},"spec":{"replicas":1,"selector":{"matchLabels":{"app.kubernetes.io/name":"rabbitmq-cluster"}},"template":{"metadata":{"creationTimestamp":null,"labels":{"app.kubernetes.io/component":"rabbitmq","app.kubernetes.io/name":"rabbitmq-cluster","app.kubernetes.io/part-of":"rabbitmq"},"annotations":{"prometheus.io/port":"15692","prometheus.io/scrape":"true"}},"spec":{"volumes":[{"name":"plugins-conf","configMap":{"name":"rabbitmq-cluster-plugins-conf","defaultMode":420}},{"name":"rabbitmq-confd","projected":{"sources":[{"secret":{"name":"rabbitmq-cluster-default-user","items":[{"key":"default_user.conf","path":"default_user.conf"}]}},{"configMap":{"name":"rabbitmq-cluster-server-conf","items":[{"key":"operatorDefaults.conf","path":"operatorDefaults.conf"},{"key":"userDefinedConfiguration.conf","path":"userDefinedConfiguration.conf"}]}}],"defaultMode":420}},{"name":"rabbitmq-erlang-cookie","emptyDir":{}},{"name":"erlang-cookie-secret","secret":{"secretName":"rabbitmq-cluster-erlang-cookie","defaultMode":420}},{"name":"rabbitmq-plugins","emptyDir":{}},{"name":"pod-info","downwardAPI":{"items":[{"path":"skipPreStopChecks","fieldRef":{"apiVersion":"v1","fieldPath":"metadata.labels['skipPreStopChecks']"}}],"defaultMode":420}}],"initContainers":[{"name":"setup-container","image":"rabbitmq:3.8.12-management","command":["sh","-c","cp /tmp/erlang-cookie-secret/.erlang.cookie /var/lib/rabbitmq/.erlang.cookie \u0026\u0026 chown 999:999 /var/lib/rabbitmq/.erlang.cookie \u0026\u0026 chmod 600 /var/lib/rabbitmq/.erlang.cookie ; cp /tmp/rabbitmq-plugins/enabled_plugins /operator/enabled_plugins \u0026\u0026 chown 999:999 /operator/enabled_plugins ; chown 999:999 /var/lib/rabbitmq/mnesia/ ; echo '[default]' \u003e /var/lib/rabbitmq/.rabbitmqadmin.conf \u0026\u0026 sed -e 's/default_user/username/' -e 's/default_pass/password/' /tmp/default_user.conf \u003e\u003e /var/lib/rabbitmq/.rabbitmqadmin.conf \u0026\u0026 chown 999:999 /var/lib/rabbitmq/.rabbitmqadmin.conf \u0026\u0026 chmod 600 /var/lib/rabbitmq/.rabbitmqadmin.conf"],"resources":{"limits":{"cpu":"100m","memory":"500Mi"},"requests":{"cpu":"100m","memory":"500Mi"}},"volumeMounts":[{"name":"plugins-conf","mountPath":"/tmp/rabbitmq-plugins/"},{"name":"rabbitmq-erlang-cookie","mountPath":"/var/lib/rabbitmq/"},{"name":"erlang-cookie-secret","mountPath":"/tmp/erlang-cookie-secret/"},{"name":"rabbitmq-plugins","mountPath":"/operator"},{"name":"persistence","mountPath":"/var/lib/rabbitmq/mnesia/"},{"name":"rabbitmq-confd","mountPath":"/tmp/default_user.conf","subPath":"default_user.conf"}],"terminationMessagePath":"/dev/termination-log","terminationMessagePolicy":"File","imagePullPolicy":"IfNotPresent","securityContext":{"capabilities":{"drop":["FSETID","KILL","SETGID","SETUID","SETPCAP","NET_BIND_SERVICE","NET_RAW","SYS_CHROOT","MKNOD","AUDIT_WRITE","SETFCAP"]},"runAsUser":0}}],"containers":[{"name":"rabbitmq","image":"rabbitmq:3.8.12-management","ports":[{"name":"epmd","containerPort":4369,"protocol":"TCP"},{"name":"amqp","containerPort":5672,"protocol":"TCP"},{"name":"management","containerPort":15672,"protocol":"TCP"},{"name":"prometheus","containerPort":15692,"protocol":"TCP"}],"env":[{"name":"MY_POD_NAME","valueFrom":{"fieldRef":{"apiVersion":"v1","fieldPath":"metadata.name"}}},{"name":"MY_POD_NAMESPACE","valueFrom":{"fieldRef":{"apiVersion":"v1","fieldPath":"metadata.namespace"}}},{"name":"RABBITMQ_ENABLED_PLUGINS_FILE","value":"/operator/enabled_plugins"},{"name":"K8S_SERVICE_NAME","value":"rabbitmq-cluster-nodes"},{"name":"RABBITMQ_USE_LONGNAME","value":"true"},{"name":"RABBITMQ_NODENAME","value":"rabbit@$(MY_POD_NAME).$(K8S_SERVICE_NAME).$(MY_POD_NAMESPACE)"},{"name":"K8S_HOSTNAME_SUFFIX","value":".$(K8S_SERVICE_NAME).$(MY_POD_NAMESPACE)"}],"resources":{"limits":{"cpu":"2","memory":"2Gi"},"requests":{"cpu":"1","memory":"2Gi"}},"volumeMounts":[{"name":"rabbitmq-erlang-cookie","mountPath":"/var/lib/rabbitmq/"},{"name":"persistence","mountPath":"/var/lib/rabbitmq/mnesia/"},{"name":"rabbitmq-plugins","mountPath":"/operator"},{"name":"rabbitmq-confd","mountPath":"/etc/rabbitmq/conf.d/10-operatorDefaults.conf","subPath":"operatorDefaults.conf"},{"name":"rabbitmq-confd","mountPath":"/etc/rabbitmq/conf.d/11-default_user.conf","subPath":"default_user.conf"},{"name":"rabbitmq-confd","mountPath":"/etc/rabbitmq/conf.d/90-userDefinedConfiguration.conf","subPath":"userDefinedConfiguration.conf"},{"name":"pod-info","mountPath":"/etc/pod-info/"}],"readinessProbe":{"tcpSocket":{"port":"amqp"},"initialDelaySeconds":10,"timeoutSeconds":5,"periodSeconds":10,"successThreshold":1,"failureThreshold":3},"lifecycle":{"preStop":{"exec":{"command":["/bin/bash","-c","if [ ! -z \"$(cat /etc/pod-info/skipPreStopChecks)\" ]; then exit 0; fi; rabbitmq-upgrade await_online_quorum_plus_one -t 604800; rabbitmq-upgrade await_online_synchronized_mirror -t 604800; rabbitmq-upgrade drain -t 604800"]}}},"terminationMessagePath":"/dev/termination-log","terminationMessagePolicy":"File","imagePullPolicy":"IfNotPresent"}],"restartPolicy":"Always","terminationGracePeriodSeconds":604800,"dnsPolicy":"ClusterFirst","serviceAccountName":"rabbitmq-cluster-server","serviceAccount":"rabbitmq-cluster-server","automountServiceAccountToken":true,"securityContext":{"runAsUser":999,"runAsGroup":999,"fsGroup":999},"schedulerName":"default-scheduler","topologySpreadConstraints":[{"maxSkew":1,"topologyKey":"topology.kubernetes.io/zone","whenUnsatisfiable":"ScheduleAnyway","labelSelector":{"matchLabels":{"app.kubernetes.io/name":"rabbitmq-cluster"}}}]}},"volumeClaimTemplates":[{"metadata":{"name":"persistence","namespace":"default","creationTimestamp":null,"labels":{"app.kubernetes.io/component":"rabbitmq","app.kubernetes.io/name":"rabbitmq-cluster","app.kubernetes.io/part-of":"rabbitmq"},"ownerReferences":[{"apiVersion":"rabbitmq.com/v1beta1","kind":"RabbitmqCluster","name":"rabbitmq-cluster","uid":"3ecefa8a-1bec-48a7-9af4-dd0df3339101","controller":true,"blockOwnerDeletion":false}]},"spec":{"accessModes":["ReadWriteOnce"],"resources":{"requests":{"storage":"10Gi"}},"volumeMode":"Filesystem"},"status":{"phase":"Pending"}}],"serviceName":"rabbitmq-cluster-nodes","podManagementPolicy":"Parallel","updateStrategy":{"type":"RollingUpdate","rollingUpdate":{"partition":0}},"revisionHistoryLimit":10},"status":{"observedGeneration":1,"replicas":1,"currentReplicas":1,"updatedReplicas":1,"currentRevision":"rabbitmq-cluster-server-5f8b8665fb","updateRevision":"rabbitmq-cluster-server-5f8b8665fb","collisionCount":0}}
2022/03/18 18:07:10 learn_server.go:291: [SIEVE-AFTER-READ]	Get	true	configmap	default	rabbitmq-cluster-server-conf	github.com/rabbitmq/cluster-operator/controllers.(*RabbitmqClusterReconciler)	NoError	{"kind":"ConfigMap","apiVersion":"v1","metadata":{"name":"rabbitmq-cluster-server-conf","namespace":"default","selfLink":"/api/v1/namespaces/default/configmaps/rabbitmq-cluster-server-conf","uid":"e4182078-d429-4baf-9021-72618c509ac5","resourceVersion":"1095","creationTimestamp":"2022-03-18T18:06:25Z","labels":{"app.kubernetes.io/component":"rabbitmq","app.kubernetes.io/name":"rabbitmq-cluster","app.kubernetes.io/part-of":"rabbitmq"},"ownerReferences":[{"apiVersion":"rabbitmq.com/v1beta1","kind":"RabbitmqCluster","name":"rabbitmq-cluster","uid":"3ecefa8a-1bec-48a7-9af4-dd0df3339101","controller":true,"blockOwnerDeletion":true}],"managedFields":[{"manager":"manager","operation":"Update","apiVersion":"v1","time":"2022-03-18T18:06:25Z","fieldsType":"FieldsV1","fieldsV1":{"f:data":{".":{},"f:operatorDefaults.conf":{},"f:userDefinedConfiguration.conf":{}},"f:metadata":{"f:labels":{".":{},"f:app.kubernetes.io/component":{},"f:app.kubernetes.io/name":{},"f:app.kubernetes.io/part-of":{}},"f:ownerReferences":{".":{},"k:{\"uid\":\"3ecefa8a-1bec-48a7-9af4-dd0df3339101\"}":{".":{},"f:apiVersion":{},"f:blockOwnerDeletion":{},"f:controller":{},"f:kind":{},"f:name":{},"f:uid":{}}}}}}]},"data":{"operatorDefaults.conf":"cluster_formation.peer_discovery_backend             = rabbit_peer_discovery_k8s\ncluster_formation.k8s.host                           = kubernetes.default\ncluster_formation.k8s.address_type                   = hostname\ncluster_partition_handling                           = pause_minority\nqueue_master_locator                                 = min-masters\ndisk_free_limit.absolute                             = 2GB\ncluster_formation.randomized_startup_delay_range.min = 5\ncluster_formation.randomized_startup_delay_range.max = 30\ncluster_name                                         = rabbitmq-cluster\n","userDefinedConfiguration.conf":"total_memory_available_override_value = 1717986919\n"}}
2022/03/18 18:07:10 learn_server.go:256: [SIEVE-BEFORE-WRITE]	25
2022/03/18 18:07:10 learn_server.go:263: [SIEVE-AFTER-WRITE]	25	StatusUpdate	rabbitmqcluster	github.com/rabbitmq/cluster-operator/controllers.(*RabbitmqClusterReconciler)	NoError	{"metadata":{"name":"rabbitmq-cluster","namespace":"default","selfLink":"/apis/rabbitmq.com/v1beta1/namespaces/default/rabbitmqclusters/rabbitmq-cluster/status","uid":"3ecefa8a-1bec-48a7-9af4-dd0df3339101","resourceVersion":"1132","generation":2,"creationTimestamp":"2022-03-18T18:06:25Z","annotations":{"kubectl.kubernetes.io/last-applied-configuration":"{\"apiVersion\":\"rabbitmq.com/v1beta1\",\"kind\":\"RabbitmqCluster\",\"metadata\":{\"annotations\":{},\"name\":\"rabbitmq-cluster\",\"namespace\":\"default\"},\"spec\":{\"persistence\":{\"storage\":\"10Gi\"},\"replicas\":1}}\n"},"finalizers":["deletion.finalizers.rabbitmqclusters.rabbitmq.com"],"managedFields":[{"manager":"kubectl-client-side-apply","operation":"Update","apiVersion":"rabbitmq.com/v1beta1","time":"2022-03-18T18:06:25Z","fieldsType":"FieldsV1","fieldsV1":{"f:metadata":{"f:annotations":{".":{},"f:kubectl.kubernetes.io/last-applied-configuration":{}}},"f:spec":{".":{},"f:image":{},"f:persistence":{".":{},"f:storage":{}},"f:replicas":{},"f:resources":{".":{},"f:limits":{".":{},"f:memory":{}},"f:requests":{".":{},"f:memory":{}}},"f:service":{".":{},"f:type":{}},"f:terminationGracePeriodSeconds":{}}}},{"manager":"manager","operation":"Update","apiVersion":"rabbitmq.com/v1beta1","time":"2022-03-18T18:06:25Z","fieldsType":"FieldsV1","fieldsV1":{"f:metadata":{"f:finalizers":{}},"f:spec":{"f:override":{},"f:rabbitmq":{},"f:resources":{"f:limits":{"f:cpu":{}},"f:requests":{"f:cpu":{}}},"f:tls":{}},"f:status":{".":{},"f:conditions":{},"f:defaultUser":{".":{},"f:secretReference":{".":{},"f:keys":{".":{},"f:password":{},"f:username":{}},"f:name":{},"f:namespace":{}},"f:serviceReference":{".":{},"f:name":{},"f:namespace":{}}}}}}]},"spec":{"replicas":1,"image":"rabbitmq:3.8.12-management","service":{"type":"ClusterIP"},"persistence":{"storage":"10Gi"},"resources":{"limits":{"cpu":"2","memory":"2Gi"},"requests":{"cpu":"1","memory":"2Gi"}},"rabbitmq":{},"tls":{},"override":{},"terminationGracePeriodSeconds":604800},"status":{"conditions":[{"type":"AllReplicasReady","status":"False","lastTransitionTime":"2022-03-18T18:06:25Z","reason":"NotAllPodsReady","message":"0/1 Pods ready"},{"type":"ClusterAvailable","status":"False","lastTransitionTime":"2022-03-18T18:06:25Z","reason":"NoEndpointsAvailable","message":"The service has no endpoints available"},{"type":"NoWarnings","status":"True","lastTransitionTime":"2022-03-18T18:06:25Z","reason":"NoWarnings"},{"type":"ReconcileSuccess","status":"Unknown","lastTransitionTime":"2022-03-18T18:06:25Z","reason":"Initialising"}],"defaultUser":{"secretReference":{"name":"rabbitmq-cluster-default-user","namespace":"default","keys":{"password":"password","username":"username"}},"serviceReference":{"name":"rabbitmq-cluster","namespace":"default"}},"binding":{"name":"rabbitmq-cluster-default-user"}}}
2022/03/18 18:07:10 learn_server.go:291: [SIEVE-AFTER-READ]	Get	true	statefulset	default	rabbitmq-cluster-server	github.com/rabbitmq/cluster-operator/controllers.(*RabbitmqClusterReconciler)	NoError	{"kind":"StatefulSet","apiVersion":"apps/v1","metadata":{"name":"rabbitmq-cluster-server","namespace":"default","selfLink":"/apis/apps/v1/namespaces/default/statefulsets/rabbitmq-cluster-server","uid":"f2f07f3e-b500-4c48-a5de-8db7eaf37b9a","resourceVersion":"1129","generation":1,"creationTimestamp":"2022-03-18T18:06:25Z","labels":{"app.kubernetes.io/component":"rabbitmq","app.kubernetes.io/name":"rabbitmq-cluster","app.kubernetes.io/part-of":"rabbitmq"},"annotations":{"rabbitmq.com/createdAt":"2022-03-18T18:06:25Z"},"ownerReferences":[{"apiVersion":"rabbitmq.com/v1beta1","kind":"RabbitmqCluster","name":"rabbitmq-cluster","uid":"3ecefa8a-1bec-48a7-9af4-dd0df3339101","controller":true,"blockOwnerDeletion":true}],"managedFields":[{"manager":"kube-controller-manager","operation":"Update","apiVersion":"apps/v1","time":"2022-03-18T18:06:25Z","fieldsType":"FieldsV1","fieldsV1":{"f:status":{"f:collisionCount":{},"f:currentReplicas":{},"f:currentRevision":{},"f:observedGeneration":{},"f:replicas":{},"f:updateRevision":{},"f:updatedReplicas":{}}}},{"manager":"manager","operation":"Update","apiVersion":"apps/v1","time":"2022-03-18T18:06:25Z","fieldsType":"FieldsV1","fieldsV1":{"f:metadata":{"f:annotations":{".":{},"f:rabbitmq.com/createdAt":{}},"f:labels":{".":{},"f:app.kubernetes.io/component":{},"f:app.kubernetes.io/name":{},"f:app.kubernetes.io/part-of":{}},"f:ownerReferences":{".":{},"k:{\"uid\":\"3ecefa8a-1bec-48a7-9af4-dd0df3339101\"}":{".":{},"f:apiVersion":{},"f:blockOwnerDeletion":{},"f:controller":{},"f:kind":{},"f:name":{},"f:uid":{}}}},"f:spec":{"f:podManagementPolicy":{},"f:replicas":{},"f:revisionHistoryLimit":{},"f:selector":{"f:matchLabels":{".":{},"f:app.kubernetes.io/name":{}}},"f:serviceName":{},"f:template":{"f:metadata":{"f:annotations":{".":{},"f:prometheus.io/port":{},"f:prometheus.io/scrape":{}},"f:labels":{".":{},"f:app.kubernetes.io/component":{},"f:app.kubernetes.io/name":{},"f:app.kubernetes.io/part-of":{}}},"f:spec":{"f:automountServiceAccountToken":{},"f:containers":{"k:{\"name\":\"rabbitmq\"}":{".":{},"f:env":{".":{},"k:{\"name\":\"K8S_HOSTNAME_SUFFIX\"}":{".":{},"f:name":{},"f:value":{}},"k:{\"name\":\"K8S_SERVICE_NAME\"}":{".":{},"f:name":{},"f:value":{}},"k:{\"name\":\"MY_POD_NAME\"}":{".":{},"f:name":{},"f:valueFrom":{".":{},"f:fieldRef":{".":{},"f:apiVersion":{},"f:fieldPath":{}}}},"k:{\"name\":\"MY_POD_NAMESPACE\"}":{".":{},"f:name":{},"f:valueFrom":{".":{},"f:fieldRef":{".":{},"f:apiVersion":{},"f:fieldPath":{}}}},"k:{\"name\":\"RABBITMQ_ENABLED_PLUGINS_FILE\"}":{".":{},"f:name":{},"f:value":{}},"k:{\"name\":\"RABBITMQ_NODENAME\"}":{".":{},"f:name":{},"f:value":{}},"k:{\"name\":\"RABBITMQ_USE_LONGNAME\"}":{".":{},"f:name":{},"f:value":{}}},"f:image":{},"f:imagePullPolicy":{},"f:lifecycle":{".":{},"f:preStop":{".":{},"f:exec":{".":{},"f:command":{}}}},"f:name":{},"f:ports":{".":{},"k:{\"containerPort\":4369,\"protocol\":\"TCP\"}":{".":{},"f:containerPort":{},"f:name":{},"f:protocol":{}},"k:{\"containerPort\":5672,\"protocol\":\"TCP\"}":{".":{},"f:containerPort":{},"f:name":{},"f:protocol":{}},"k:{\"containerPort\":15672,\"protocol\":\"TCP\"}":{".":{},"f:containerPort":{},"f:name":{},"f:protocol":{}},"k:{\"containerPort\":15692,\"protocol\":\"TCP\"}":{".":{},"f:containerPort":{},"f:name":{},"f:protocol":{}}},"f:readinessProbe":{".":{},"f:failureThreshold":{},"f:initialDelaySeconds":{},"f:periodSeconds":{},"f:successThreshold":{},"f:tcpSocket":{".":{},"f:port":{}},"f:timeoutSeconds":{}},"f:resources":{".":{},"f:limits":{".":{},"f:cpu":{},"f:memory":{}},"f:requests":{".":{},"f:cpu":{},"f:memory":{}}},"f:terminationMessagePath":{},"f:terminationMessagePolicy":{},"f:volumeMounts":{".":{},"k:{\"mountPath\":\"/etc/pod-info/\"}":{".":{},"f:mountPath":{},"f:name":{}},"k:{\"mountPath\":\"/etc/rabbitmq/conf.d/10-operatorDefaults.conf\"}":{".":{},"f:mountPath":{},"f:name":{},"f:subPath":{}},"k:{\"mountPath\":\"/etc/rabbitmq/conf.d/11-default_user.conf\"}":{".":{},"f:mountPath":{},"f:name":{},"f:subPath":{}},"k:{\"mountPath\":\"/etc/rabbitmq/conf.d/90-userDefinedConfiguration.conf\"}":{".":{},"f:mountPath":{},"f:name":{},"f:subPath":{}},"k:{\"mountPath\":\"/operator\"}":{".":{},"f:mountPath":{},"f:name":{}},"k:{\"mountPath\":\"/var/lib/rabbitmq/\"}":{".":{},"f:mountPath":{},"f:name":{}},"k:{\"mountPath\":\"/var/lib/rabbitmq/mnesia/\"}":{".":{},"f:mountPath":{},"f:name":{}}}}},"f:dnsPolicy":{},"f:initContainers":{".":{},"k:{\"name\":\"setup-container\"}":{".":{},"f:command":{},"f:image":{},"f:imagePullPolicy":{},"f:name":{},"f:resources":{".":{},"f:limits":{".":{},"f:cpu":{},"f:memory":{}},"f:requests":{".":{},"f:cpu":{},"f:memory":{}}},"f:securityContext":{".":{},"f:capabilities":{".":{},"f:drop":{}},"f:runAsUser":{}},"f:terminationMessagePath":{},"f:terminationMessagePolicy":{},"f:volumeMounts":{".":{},"k:{\"mountPath\":\"/operator\"}":{".":{},"f:mountPath":{},"f:name":{}},"k:{\"mountPath\":\"/tmp/default_user.conf\"}":{".":{},"f:mountPath":{},"f:name":{},"f:subPath":{}},"k:{\"mountPath\":\"/tmp/erlang-cookie-secret/\"}":{".":{},"f:mountPath":{},"f:name":{}},"k:{\"mountPath\":\"/tmp/rabbitmq-plugins/\"}":{".":{},"f:mountPath":{},"f:name":{}},"k:{\"mountPath\":\"/var/lib/rabbitmq/\"}":{".":{},"f:mountPath":{},"f:name":{}},"k:{\"mountPath\":\"/var/lib/rabbitmq/mnesia/\"}":{".":{},"f:mountPath":{},"f:name":{}}}}},"f:restartPolicy":{},"f:schedulerName":{},"f:securityContext":{".":{},"f:fsGroup":{},"f:runAsGroup":{},"f:runAsUser":{}},"f:serviceAccount":{},"f:serviceAccountName":{},"f:terminationGracePeriodSeconds":{},"f:topologySpreadConstraints":{".":{},"k:{\"topologyKey\":\"topology.kubernetes.io/zone\",\"whenUnsatisfiable\":\"ScheduleAnyway\"}":{".":{},"f:labelSelector":{".":{},"f:matchLabels":{".":{},"f:app.kubernetes.io/name":{}}},"f:maxSkew":{},"f:topologyKey":{},"f:whenUnsatisfiable":{}}},"f:volumes":{".":{},"k:{\"name\":\"erlang-cookie-secret\"}":{".":{},"f:name":{},"f:secret":{".":{},"f:defaultMode":{},"f:secretName":{}}},"k:{\"name\":\"plugins-conf\"}":{".":{},"f:configMap":{".":{},"f:defaultMode":{},"f:name":{}},"f:name":{}},"k:{\"name\":\"pod-info\"}":{".":{},"f:downwardAPI":{".":{},"f:defaultMode":{},"f:items":{}},"f:name":{}},"k:{\"name\":\"rabbitmq-confd\"}":{".":{},"f:name":{},"f:projected":{".":{},"f:defaultMode":{},"f:sources":{}}},"k:{\"name\":\"rabbitmq-erlang-cookie\"}":{".":{},"f:emptyDir":{},"f:name":{}},"k:{\"name\":\"rabbitmq-plugins\"}":{".":{},"f:emptyDir":{},"f:name":{}}}}},"f:updateStrategy":{"f:rollingUpdate":{".":{},"f:partition":{}},"f:type":{}},"f:volumeClaimTemplates":{}}}}]},"spec":{"replicas":1,"selector":{"matchLabels":{"app.kubernetes.io/name":"rabbitmq-cluster"}},"template":{"metadata":{"creationTimestamp":null,"labels":{"app.kubernetes.io/component":"rabbitmq","app.kubernetes.io/name":"rabbitmq-cluster","app.kubernetes.io/part-of":"rabbitmq"},"annotations":{"prometheus.io/port":"15692","prometheus.io/scrape":"true"}},"spec":{"volumes":[{"name":"plugins-conf","configMap":{"name":"rabbitmq-cluster-plugins-conf","defaultMode":420}},{"name":"rabbitmq-confd","projected":{"sources":[{"secret":{"name":"rabbitmq-cluster-default-user","items":[{"key":"default_user.conf","path":"default_user.conf"}]}},{"configMap":{"name":"rabbitmq-cluster-server-conf","items":[{"key":"operatorDefaults.conf","path":"operatorDefaults.conf"},{"key":"userDefinedConfiguration.conf","path":"userDefinedConfiguration.conf"}]}}],"defaultMode":420}},{"name":"rabbitmq-erlang-cookie","emptyDir":{}},{"name":"erlang-cookie-secret","secret":{"secretName":"rabbitmq-cluster-erlang-cookie","defaultMode":420}},{"name":"rabbitmq-plugins","emptyDir":{}},{"name":"pod-info","downwardAPI":{"items":[{"path":"skipPreStopChecks","fieldRef":{"apiVersion":"v1","fieldPath":"metadata.labels['skipPreStopChecks']"}}],"defaultMode":420}}],"initContainers":[{"name":"setup-container","image":"rabbitmq:3.8.12-management","command":["sh","-c","cp /tmp/erlang-cookie-secret/.erlang.cookie /var/lib/rabbitmq/.erlang.cookie \u0026\u0026 chown 999:999 /var/lib/rabbitmq/.erlang.cookie \u0026\u0026 chmod 600 /var/lib/rabbitmq/.erlang.cookie ; cp /tmp/rabbitmq-plugins/enabled_plugins /operator/enabled_plugins \u0026\u0026 chown 999:999 /operator/enabled_plugins ; chown 999:999 /var/lib/rabbitmq/mnesia/ ; echo '[default]' \u003e /var/lib/rabbitmq/.rabbitmqadmin.conf \u0026\u0026 sed -e 's/default_user/username/' -e 's/default_pass/password/' /tmp/default_user.conf \u003e\u003e /var/lib/rabbitmq/.rabbitmqadmin.conf \u0026\u0026 chown 999:999 /var/lib/rabbitmq/.rabbitmqadmin.conf \u0026\u0026 chmod 600 /var/lib/rabbitmq/.rabbitmqadmin.conf"],"resources":{"limits":{"cpu":"100m","memory":"500Mi"},"requests":{"cpu":"100m","memory":"500Mi"}},"volumeMounts":[{"name":"plugins-conf","mountPath":"/tmp/rabbitmq-plugins/"},{"name":"rabbitmq-erlang-cookie","mountPath":"/var/lib/rabbitmq/"},{"name":"erlang-cookie-secret","mountPath":"/tmp/erlang-cookie-secret/"},{"name":"rabbitmq-plugins","mountPath":"/operator"},{"name":"persistence","mountPath":"/var/lib/rabbitmq/mnesia/"},{"name":"rabbitmq-confd","mountPath":"/tmp/default_user.conf","subPath":"default_user.conf"}],"terminationMessagePath":"/dev/termination-log","terminationMessagePolicy":"File","imagePullPolicy":"IfNotPresent","securityContext":{"capabilities":{"drop":["FSETID","KILL","SETGID","SETUID","SETPCAP","NET_BIND_SERVICE","NET_RAW","SYS_CHROOT","MKNOD","AUDIT_WRITE","SETFCAP"]},"runAsUser":0}}],"containers":[{"name":"rabbitmq","image":"rabbitmq:3.8.12-management","ports":[{"name":"epmd","containerPort":4369,"protocol":"TCP"},{"name":"amqp","containerPort":5672,"protocol":"TCP"},{"name":"management","containerPort":15672,"protocol":"TCP"},{"name":"prometheus","containerPort":15692,"protocol":"TCP"}],"env":[{"name":"MY_POD_NAME","valueFrom":{"fieldRef":{"apiVersion":"v1","fieldPath":"metadata.name"}}},{"name":"MY_POD_NAMESPACE","valueFrom":{"fieldRef":{"apiVersion":"v1","fieldPath":"metadata.namespace"}}},{"name":"RABBITMQ_ENABLED_PLUGINS_FILE","value":"/operator/enabled_plugins"},{"name":"K8S_SERVICE_NAME","value":"rabbitmq-cluster-nodes"},{"name":"RABBITMQ_USE_LONGNAME","value":"true"},{"name":"RABBITMQ_NODENAME","value":"rabbit@$(MY_POD_NAME).$(K8S_SERVICE_NAME).$(MY_POD_NAMESPACE)"},{"name":"K8S_HOSTNAME_SUFFIX","value":".$(K8S_SERVICE_NAME).$(MY_POD_NAMESPACE)"}],"resources":{"limits":{"cpu":"2","memory":"2Gi"},"requests":{"cpu":"1","memory":"2Gi"}},"volumeMounts":[{"name":"rabbitmq-erlang-cookie","mountPath":"/var/lib/rabbitmq/"},{"name":"persistence","mountPath":"/var/lib/rabbitmq/mnesia/"},{"name":"rabbitmq-plugins","mountPath":"/operator"},{"name":"rabbitmq-confd","mountPath":"/etc/rabbitmq/conf.d/10-operatorDefaults.conf","subPath":"operatorDefaults.conf"},{"name":"rabbitmq-confd","mountPath":"/etc/rabbitmq/conf.d/11-default_user.conf","subPath":"default_user.conf"},{"name":"rabbitmq-confd","mountPath":"/etc/rabbitmq/conf.d/90-userDefinedConfiguration.conf","subPath":"userDefinedConfiguration.conf"},{"name":"pod-info","mountPath":"/etc/pod-info/"}],"readinessProbe":{"tcpSocket":{"port":"amqp"},"initialDelaySeconds":10,"timeoutSeconds":5,"periodSeconds":10,"successThreshold":1,"failureThreshold":3},"lifecycle":{"preStop":{"exec":{"command":["/bin/bash","-c","if [ ! -z \"$(cat /etc/pod-info/skipPreStopChecks)\" ]; then exit 0; fi; rabbitmq-upgrade await_online_quorum_plus_one -t 604800; rabbitmq-upgrade await_online_synchronized_mirror -t 604800; rabbitmq-upgrade drain -t 604800"]}}},"terminationMessagePath":"/dev/termination-log","terminationMessagePolicy":"File","imagePullPolicy":"IfNotPresent"}],"restartPolicy":"Always","terminationGracePeriodSeconds":604800,"dnsPolicy":"ClusterFirst","serviceAccountName":"rabbitmq-cluster-server","serviceAccount":"rabbitmq-cluster-server","automountServiceAccountToken":true,"securityContext":{"runAsUser":999,"runAsGroup":999,"fsGroup":999},"schedulerName":"default-scheduler","topologySpreadConstraints":[{"maxSkew":1,"topologyKey":"topology.kubernetes.io/zone","whenUnsatisfiable":"ScheduleAnyway","labelSelector":{"matchLabels":{"app.kubernetes.io/name":"rabbitmq-cluster"}}}]}},"volumeClaimTemplates":[{"metadata":{"name":"persistence","namespace":"default","creationTimestamp":null,"labels":{"app.kubernetes.io/component":"rabbitmq","app.kubernetes.io/name":"rabbitmq-cluster","app.kubernetes.io/part-of":"rabbitmq"},"ownerReferences":[{"apiVersion":"rabbitmq.com/v1beta1","kind":"RabbitmqCluster","name":"rabbitmq-cluster","uid":"3ecefa8a-1bec-48a7-9af4-dd0df3339101","controller":true,"blockOwnerDeletion":false}]},"spec":{"accessModes":["ReadWriteOnce"],"resources":{"requests":{"storage":"10Gi"}},"volumeMode":"Filesystem"},"status":{"phase":"Pending"}}],"serviceName":"rabbitmq-cluster-nodes","podManagementPolicy":"Parallel","updateStrategy":{"type":"RollingUpdate","rollingUpdate":{"partition":0}},"revisionHistoryLimit":10},"status":{"observedGeneration":1,"replicas":1,"currentReplicas":1,"updatedReplicas":1,"currentRevision":"rabbitmq-cluster-server-5f8b8665fb","updateRevision":"rabbitmq-cluster-server-5f8b8665fb","collisionCount":0}}
2022/03/18 18:07:10 learn_server.go:253: [SIEVE-AFTER-RECONCILE]	github.com/rabbitmq/cluster-operator/controllers.(*RabbitmqClusterReconciler)	5
2022/03/18 18:07:23 learn_server.go:279: [SIEVE-BEFORE-HEAR]	18	Updated	statefulset	{"metadata":{"name":"rabbitmq-cluster-server","namespace":"default","selfLink":"/apis/apps/v1/namespaces/default/statefulsets/rabbitmq-cluster-server","uid":"f2f07f3e-b500-4c48-a5de-8db7eaf37b9a","resourceVersion":"1404","generation":1,"creationTimestamp":"2022-03-18T18:06:25Z","labels":{"app.kubernetes.io/component":"rabbitmq","app.kubernetes.io/name":"rabbitmq-cluster","app.kubernetes.io/part-of":"rabbitmq"},"annotations":{"rabbitmq.com/createdAt":"2022-03-18T18:06:25Z"},"ownerReferences":[{"apiVersion":"rabbitmq.com/v1beta1","kind":"RabbitmqCluster","name":"rabbitmq-cluster","uid":"3ecefa8a-1bec-48a7-9af4-dd0df3339101","controller":true,"blockOwnerDeletion":true}],"managedFields":[{"manager":"manager","operation":"Update","apiVersion":"apps/v1","time":"2022-03-18T18:06:25Z","fieldsType":"FieldsV1","fieldsV1":{"f:metadata":{"f:annotations":{".":{},"f:rabbitmq.com/createdAt":{}},"f:labels":{".":{},"f:app.kubernetes.io/component":{},"f:app.kubernetes.io/name":{},"f:app.kubernetes.io/part-of":{}},"f:ownerReferences":{".":{},"k:{\"uid\":\"3ecefa8a-1bec-48a7-9af4-dd0df3339101\"}":{".":{},"f:apiVersion":{},"f:blockOwnerDeletion":{},"f:controller":{},"f:kind":{},"f:name":{},"f:uid":{}}}},"f:spec":{"f:podManagementPolicy":{},"f:replicas":{},"f:revisionHistoryLimit":{},"f:selector":{"f:matchLabels":{".":{},"f:app.kubernetes.io/name":{}}},"f:serviceName":{},"f:template":{"f:metadata":{"f:annotations":{".":{},"f:prometheus.io/port":{},"f:prometheus.io/scrape":{}},"f:labels":{".":{},"f:app.kubernetes.io/component":{},"f:app.kubernetes.io/name":{},"f:app.kubernetes.io/part-of":{}}},"f:spec":{"f:automountServiceAccountToken":{},"f:containers":{"k:{\"name\":\"rabbitmq\"}":{".":{},"f:env":{".":{},"k:{\"name\":\"K8S_HOSTNAME_SUFFIX\"}":{".":{},"f:name":{},"f:value":{}},"k:{\"name\":\"K8S_SERVICE_NAME\"}":{".":{},"f:name":{},"f:value":{}},"k:{\"name\":\"MY_POD_NAME\"}":{".":{},"f:name":{},"f:valueFrom":{".":{},"f:fieldRef":{".":{},"f:apiVersion":{},"f:fieldPath":{}}}},"k:{\"name\":\"MY_POD_NAMESPACE\"}":{".":{},"f:name":{},"f:valueFrom":{".":{},"f:fieldRef":{".":{},"f:apiVersion":{},"f:fieldPath":{}}}},"k:{\"name\":\"RABBITMQ_ENABLED_PLUGINS_FILE\"}":{".":{},"f:name":{},"f:value":{}},"k:{\"name\":\"RABBITMQ_NODENAME\"}":{".":{},"f:name":{},"f:value":{}},"k:{\"name\":\"RABBITMQ_USE_LONGNAME\"}":{".":{},"f:name":{},"f:value":{}}},"f:image":{},"f:imagePullPolicy":{},"f:lifecycle":{".":{},"f:preStop":{".":{},"f:exec":{".":{},"f:command":{}}}},"f:name":{},"f:ports":{".":{},"k:{\"containerPort\":4369,\"protocol\":\"TCP\"}":{".":{},"f:containerPort":{},"f:name":{},"f:protocol":{}},"k:{\"containerPort\":5672,\"protocol\":\"TCP\"}":{".":{},"f:containerPort":{},"f:name":{},"f:protocol":{}},"k:{\"containerPort\":15672,\"protocol\":\"TCP\"}":{".":{},"f:containerPort":{},"f:name":{},"f:protocol":{}},"k:{\"containerPort\":15692,\"protocol\":\"TCP\"}":{".":{},"f:containerPort":{},"f:name":{},"f:protocol":{}}},"f:readinessProbe":{".":{},"f:failureThreshold":{},"f:initialDelaySeconds":{},"f:periodSeconds":{},"f:successThreshold":{},"f:tcpSocket":{".":{},"f:port":{}},"f:timeoutSeconds":{}},"f:resources":{".":{},"f:limits":{".":{},"f:cpu":{},"f:memory":{}},"f:requests":{".":{},"f:cpu":{},"f:memory":{}}},"f:terminationMessagePath":{},"f:terminationMessagePolicy":{},"f:volumeMounts":{".":{},"k:{\"mountPath\":\"/etc/pod-info/\"}":{".":{},"f:mountPath":{},"f:name":{}},"k:{\"mountPath\":\"/etc/rabbitmq/conf.d/10-operatorDefaults.conf\"}":{".":{},"f:mountPath":{},"f:name":{},"f:subPath":{}},"k:{\"mountPath\":\"/etc/rabbitmq/conf.d/11-default_user.conf\"}":{".":{},"f:mountPath":{},"f:name":{},"f:subPath":{}},"k:{\"mountPath\":\"/etc/rabbitmq/conf.d/90-userDefinedConfiguration.conf\"}":{".":{},"f:mountPath":{},"f:name":{},"f:subPath":{}},"k:{\"mountPath\":\"/operator\"}":{".":{},"f:mountPath":{},"f:name":{}},"k:{\"mountPath\":\"/var/lib/rabbitmq/\"}":{".":{},"f:mountPath":{},"f:name":{}},"k:{\"mountPath\":\"/var/lib/rabbitmq/mnesia/\"}":{".":{},"f:mountPath":{},"f:name":{}}}}},"f:dnsPolicy":{},"f:initContainers":{".":{},"k:{\"name\":\"setup-container\"}":{".":{},"f:command":{},"f:image":{},"f:imagePullPolicy":{},"f:name":{},"f:resources":{".":{},"f:limits":{".":{},"f:cpu":{},"f:memory":{}},"f:requests":{".":{},"f:cpu":{},"f:memory":{}}},"f:securityContext":{".":{},"f:capabilities":{".":{},"f:drop":{}},"f:runAsUser":{}},"f:terminationMessagePath":{},"f:terminationMessagePolicy":{},"f:volumeMounts":{".":{},"k:{\"mountPath\":\"/operator\"}":{".":{},"f:mountPath":{},"f:name":{}},"k:{\"mountPath\":\"/tmp/default_user.conf\"}":{".":{},"f:mountPath":{},"f:name":{},"f:subPath":{}},"k:{\"mountPath\":\"/tmp/erlang-cookie-secret/\"}":{".":{},"f:mountPath":{},"f:name":{}},"k:{\"mountPath\":\"/tmp/rabbitmq-plugins/\"}":{".":{},"f:mountPath":{},"f:name":{}},"k:{\"mountPath\":\"/var/lib/rabbitmq/\"}":{".":{},"f:mountPath":{},"f:name":{}},"k:{\"mountPath\":\"/var/lib/rabbitmq/mnesia/\"}":{".":{},"f:mountPath":{},"f:name":{}}}}},"f:restartPolicy":{},"f:schedulerName":{},"f:securityContext":{".":{},"f:fsGroup":{},"f:runAsGroup":{},"f:runAsUser":{}},"f:serviceAccount":{},"f:serviceAccountName":{},"f:terminationGracePeriodSeconds":{},"f:topologySpreadConstraints":{".":{},"k:{\"topologyKey\":\"topology.kubernetes.io/zone\",\"whenUnsatisfiable\":\"ScheduleAnyway\"}":{".":{},"f:labelSelector":{".":{},"f:matchLabels":{".":{},"f:app.kubernetes.io/name":{}}},"f:maxSkew":{},"f:topologyKey":{},"f:whenUnsatisfiable":{}}},"f:volumes":{".":{},"k:{\"name\":\"erlang-cookie-secret\"}":{".":{},"f:name":{},"f:secret":{".":{},"f:defaultMode":{},"f:secretName":{}}},"k:{\"name\":\"plugins-conf\"}":{".":{},"f:configMap":{".":{},"f:defaultMode":{},"f:name":{}},"f:name":{}},"k:{\"name\":\"pod-info\"}":{".":{},"f:downwardAPI":{".":{},"f:defaultMode":{},"f:items":{}},"f:name":{}},"k:{\"name\":\"rabbitmq-confd\"}":{".":{},"f:name":{},"f:projected":{".":{},"f:defaultMode":{},"f:sources":{}}},"k:{\"name\":\"rabbitmq-erlang-cookie\"}":{".":{},"f:emptyDir":{},"f:name":{}},"k:{\"name\":\"rabbitmq-plugins\"}":{".":{},"f:emptyDir":{},"f:name":{}}}}},"f:updateStrategy":{"f:rollingUpdate":{".":{},"f:partition":{}},"f:type":{}},"f:volumeClaimTemplates":{}}}},{"manager":"kube-controller-manager","operation":"Update","apiVersion":"apps/v1","time":"2022-03-18T18:07:23Z","fieldsType":"FieldsV1","fieldsV1":{"f:status":{"f:collisionCount":{},"f:currentReplicas":{},"f:currentRevision":{},"f:observedGeneration":{},"f:readyReplicas":{},"f:replicas":{},"f:updateRevision":{},"f:updatedReplicas":{}}}}]},"spec":{"replicas":1,"selector":{"matchLabels":{"app.kubernetes.io/name":"rabbitmq-cluster"}},"template":{"metadata":{"creationTimestamp":null,"labels":{"app.kubernetes.io/component":"rabbitmq","app.kubernetes.io/name":"rabbitmq-cluster","app.kubernetes.io/part-of":"rabbitmq"},"annotations":{"prometheus.io/port":"15692","prometheus.io/scrape":"true"}},"spec":{"volumes":[{"name":"plugins-conf","configMap":{"name":"rabbitmq-cluster-plugins-conf","defaultMode":420}},{"name":"rabbitmq-confd","projected":{"sources":[{"secret":{"name":"rabbitmq-cluster-default-user","items":[{"key":"default_user.conf","path":"default_user.conf"}]}},{"configMap":{"name":"rabbitmq-cluster-server-conf","items":[{"key":"operatorDefaults.conf","path":"operatorDefaults.conf"},{"key":"userDefinedConfiguration.conf","path":"userDefinedConfiguration.conf"}]}}],"defaultMode":420}},{"name":"rabbitmq-erlang-cookie","emptyDir":{}},{"name":"erlang-cookie-secret","secret":{"secretName":"rabbitmq-cluster-erlang-cookie","defaultMode":420}},{"name":"rabbitmq-plugins","emptyDir":{}},{"name":"pod-info","downwardAPI":{"items":[{"path":"skipPreStopChecks","fieldRef":{"apiVersion":"v1","fieldPath":"metadata.labels['skipPreStopChecks']"}}],"defaultMode":420}}],"initContainers":[{"name":"setup-container","image":"rabbitmq:3.8.12-management","command":["sh","-c","cp /tmp/erlang-cookie-secret/.erlang.cookie /var/lib/rabbitmq/.erlang.cookie \u0026\u0026 chown 999:999 /var/lib/rabbitmq/.erlang.cookie \u0026\u0026 chmod 600 /var/lib/rabbitmq/.erlang.cookie ; cp /tmp/rabbitmq-plugins/enabled_plugins /operator/enabled_plugins \u0026\u0026 chown 999:999 /operator/enabled_plugins ; chown 999:999 /var/lib/rabbitmq/mnesia/ ; echo '[default]' \u003e /var/lib/rabbitmq/.rabbitmqadmin.conf \u0026\u0026 sed -e 's/default_user/username/' -e 's/default_pass/password/' /tmp/default_user.conf \u003e\u003e /var/lib/rabbitmq/.rabbitmqadmin.conf \u0026\u0026 chown 999:999 /var/lib/rabbitmq/.rabbitmqadmin.conf \u0026\u0026 chmod 600 /var/lib/rabbitmq/.rabbitmqadmin.conf"],"resources":{"limits":{"cpu":"100m","memory":"500Mi"},"requests":{"cpu":"100m","memory":"500Mi"}},"volumeMounts":[{"name":"plugins-conf","mountPath":"/tmp/rabbitmq-plugins/"},{"name":"rabbitmq-erlang-cookie","mountPath":"/var/lib/rabbitmq/"},{"name":"erlang-cookie-secret","mountPath":"/tmp/erlang-cookie-secret/"},{"name":"rabbitmq-plugins","mountPath":"/operator"},{"name":"persistence","mountPath":"/var/lib/rabbitmq/mnesia/"},{"name":"rabbitmq-confd","mountPath":"/tmp/default_user.conf","subPath":"default_user.conf"}],"terminationMessagePath":"/dev/termination-log","terminationMessagePolicy":"File","imagePullPolicy":"IfNotPresent","securityContext":{"capabilities":{"drop":["FSETID","KILL","SETGID","SETUID","SETPCAP","NET_BIND_SERVICE","NET_RAW","SYS_CHROOT","MKNOD","AUDIT_WRITE","SETFCAP"]},"runAsUser":0}}],"containers":[{"name":"rabbitmq","image":"rabbitmq:3.8.12-management","ports":[{"name":"epmd","containerPort":4369,"protocol":"TCP"},{"name":"amqp","containerPort":5672,"protocol":"TCP"},{"name":"management","containerPort":15672,"protocol":"TCP"},{"name":"prometheus","containerPort":15692,"protocol":"TCP"}],"env":[{"name":"MY_POD_NAME","valueFrom":{"fieldRef":{"apiVersion":"v1","fieldPath":"metadata.name"}}},{"name":"MY_POD_NAMESPACE","valueFrom":{"fieldRef":{"apiVersion":"v1","fieldPath":"metadata.namespace"}}},{"name":"RABBITMQ_ENABLED_PLUGINS_FILE","value":"/operator/enabled_plugins"},{"name":"K8S_SERVICE_NAME","value":"rabbitmq-cluster-nodes"},{"name":"RABBITMQ_USE_LONGNAME","value":"true"},{"name":"RABBITMQ_NODENAME","value":"rabbit@$(MY_POD_NAME).$(K8S_SERVICE_NAME).$(MY_POD_NAMESPACE)"},{"name":"K8S_HOSTNAME_SUFFIX","value":".$(K8S_SERVICE_NAME).$(MY_POD_NAMESPACE)"}],"resources":{"limits":{"cpu":"2","memory":"2Gi"},"requests":{"cpu":"1","memory":"2Gi"}},"volumeMounts":[{"name":"rabbitmq-erlang-cookie","mountPath":"/var/lib/rabbitmq/"},{"name":"persistence","mountPath":"/var/lib/rabbitmq/mnesia/"},{"name":"rabbitmq-plugins","mountPath":"/operator"},{"name":"rabbitmq-confd","mountPath":"/etc/rabbitmq/conf.d/10-operatorDefaults.conf","subPath":"operatorDefaults.conf"},{"name":"rabbitmq-confd","mountPath":"/etc/rabbitmq/conf.d/11-default_user.conf","subPath":"default_user.conf"},{"name":"rabbitmq-confd","mountPath":"/etc/rabbitmq/conf.d/90-userDefinedConfiguration.conf","subPath":"userDefinedConfiguration.conf"},{"name":"pod-info","mountPath":"/etc/pod-info/"}],"readinessProbe":{"tcpSocket":{"port":"amqp"},"initialDelaySeconds":10,"timeoutSeconds":5,"periodSeconds":10,"successThreshold":1,"failureThreshold":3},"lifecycle":{"preStop":{"exec":{"command":["/bin/bash","-c","if [ ! -z \"$(cat /etc/pod-info/skipPreStopChecks)\" ]; then exit 0; fi; rabbitmq-upgrade await_online_quorum_plus_one -t 604800; rabbitmq-upgrade await_online_synchronized_mirror -t 604800; rabbitmq-upgrade drain -t 604800"]}}},"terminationMessagePath":"/dev/termination-log","terminationMessagePolicy":"File","imagePullPolicy":"IfNotPresent"}],"restartPolicy":"Always","terminationGracePeriodSeconds":604800,"dnsPolicy":"ClusterFirst","serviceAccountName":"rabbitmq-cluster-server","serviceAccount":"rabbitmq-cluster-server","automountServiceAccountToken":true,"securityContext":{"runAsUser":999,"runAsGroup":999,"fsGroup":999},"schedulerName":"default-scheduler","topologySpreadConstraints":[{"maxSkew":1,"topologyKey":"topology.kubernetes.io/zone","whenUnsatisfiable":"ScheduleAnyway","labelSelector":{"matchLabels":{"app.kubernetes.io/name":"rabbitmq-cluster"}}}]}},"volumeClaimTemplates":[{"metadata":{"name":"persistence","namespace":"default","creationTimestamp":null,"labels":{"app.kubernetes.io/component":"rabbitmq","app.kubernetes.io/name":"rabbitmq-cluster","app.kubernetes.io/part-of":"rabbitmq"},"ownerReferences":[{"apiVersion":"rabbitmq.com/v1beta1","kind":"RabbitmqCluster","name":"rabbitmq-cluster","uid":"3ecefa8a-1bec-48a7-9af4-dd0df3339101","controller":true,"blockOwnerDeletion":false}]},"spec":{"accessModes":["ReadWriteOnce"],"resources":{"requests":{"storage":"10Gi"}},"volumeMode":"Filesystem"},"status":{"phase":"Pending"}}],"serviceName":"rabbitmq-cluster-nodes","podManagementPolicy":"Parallel","updateStrategy":{"type":"RollingUpdate","rollingUpdate":{"partition":0}},"revisionHistoryLimit":10},"status":{"observedGeneration":1,"replicas":1,"readyReplicas":1,"currentReplicas":1,"updatedReplicas":1,"currentRevision":"rabbitmq-cluster-server-5f8b8665fb","updateRevision":"rabbitmq-cluster-server-5f8b8665fb","collisionCount":0}}
2022/03/18 18:07:23 learn_server.go:238: [SIEVE-BEFORE-RECONCILE]	github.com/rabbitmq/cluster-operator/controllers.(*RabbitmqClusterReconciler)	6
2022/03/18 18:07:23 learn_server.go:289: [SIEVE-AFTER-HEAR]	18
2022/03/18 18:07:23 learn_server.go:291: [SIEVE-AFTER-READ]	Get	true	rabbitmqcluster	default	rabbitmq-cluster	github.com/rabbitmq/cluster-operator/controllers.(*RabbitmqClusterReconciler)	NoError	{"kind":"RabbitmqCluster","apiVersion":"rabbitmq.com/v1beta1","metadata":{"name":"rabbitmq-cluster","namespace":"default","selfLink":"/apis/rabbitmq.com/v1beta1/namespaces/default/rabbitmqclusters/rabbitmq-cluster","uid":"3ecefa8a-1bec-48a7-9af4-dd0df3339101","resourceVersion":"1132","generation":2,"creationTimestamp":"2022-03-18T18:06:25Z","annotations":{"kubectl.kubernetes.io/last-applied-configuration":"{\"apiVersion\":\"rabbitmq.com/v1beta1\",\"kind\":\"RabbitmqCluster\",\"metadata\":{\"annotations\":{},\"name\":\"rabbitmq-cluster\",\"namespace\":\"default\"},\"spec\":{\"persistence\":{\"storage\":\"10Gi\"},\"replicas\":1}}\n"},"finalizers":["deletion.finalizers.rabbitmqclusters.rabbitmq.com"],"managedFields":[{"manager":"kubectl-client-side-apply","operation":"Update","apiVersion":"rabbitmq.com/v1beta1","time":"2022-03-18T18:06:25Z","fieldsType":"FieldsV1","fieldsV1":{"f:metadata":{"f:annotations":{".":{},"f:kubectl.kubernetes.io/last-applied-configuration":{}}},"f:spec":{".":{},"f:image":{},"f:persistence":{".":{},"f:storage":{}},"f:replicas":{},"f:resources":{".":{},"f:limits":{".":{},"f:memory":{}},"f:requests":{".":{},"f:memory":{}}},"f:service":{".":{},"f:type":{}},"f:terminationGracePeriodSeconds":{}}}},{"manager":"manager","operation":"Update","apiVersion":"rabbitmq.com/v1beta1","time":"2022-03-18T18:06:25Z","fieldsType":"FieldsV1","fieldsV1":{"f:metadata":{"f:finalizers":{}},"f:spec":{"f:override":{},"f:rabbitmq":{},"f:resources":{"f:limits":{"f:cpu":{}},"f:requests":{"f:cpu":{}}},"f:tls":{}},"f:status":{".":{},"f:conditions":{},"f:defaultUser":{".":{},"f:secretReference":{".":{},"f:keys":{".":{},"f:password":{},"f:username":{}},"f:name":{},"f:namespace":{}},"f:serviceReference":{".":{},"f:name":{},"f:namespace":{}}}}}}]},"spec":{"replicas":1,"image":"rabbitmq:3.8.12-management","service":{"type":"ClusterIP"},"persistence":{"storage":"10Gi"},"resources":{"limits":{"cpu":"2","memory":"2Gi"},"requests":{"cpu":"1","memory":"2Gi"}},"rabbitmq":{},"tls":{},"override":{},"terminationGracePeriodSeconds":604800},"status":{"conditions":[{"type":"AllReplicasReady","status":"False","lastTransitionTime":"2022-03-18T18:06:25Z","reason":"NotAllPodsReady","message":"0/1 Pods ready"},{"type":"ClusterAvailable","status":"False","lastTransitionTime":"2022-03-18T18:06:25Z","reason":"NoEndpointsAvailable","message":"The service has no endpoints available"},{"type":"NoWarnings","status":"True","lastTransitionTime":"2022-03-18T18:06:25Z","reason":"NoWarnings"},{"type":"ReconcileSuccess","status":"Unknown","lastTransitionTime":"2022-03-18T18:06:25Z","reason":"Initialising"}],"defaultUser":{"secretReference":{"name":"rabbitmq-cluster-default-user","namespace":"default","keys":{"password":"password","username":"username"}},"serviceReference":{"name":"rabbitmq-cluster","namespace":"default"}}}}
2022/03/18 18:07:23 learn_server.go:291: [SIEVE-AFTER-READ]	Get	true	statefulset	default	rabbitmq-cluster-server	github.com/rabbitmq/cluster-operator/controllers.(*RabbitmqClusterReconciler)	NoError	{"kind":"StatefulSet","apiVersion":"apps/v1","metadata":{"name":"rabbitmq-cluster-server","namespace":"default","selfLink":"/apis/apps/v1/namespaces/default/statefulsets/rabbitmq-cluster-server","uid":"f2f07f3e-b500-4c48-a5de-8db7eaf37b9a","resourceVersion":"1404","generation":1,"creationTimestamp":"2022-03-18T18:06:25Z","labels":{"app.kubernetes.io/component":"rabbitmq","app.kubernetes.io/name":"rabbitmq-cluster","app.kubernetes.io/part-of":"rabbitmq"},"annotations":{"rabbitmq.com/createdAt":"2022-03-18T18:06:25Z"},"ownerReferences":[{"apiVersion":"rabbitmq.com/v1beta1","kind":"RabbitmqCluster","name":"rabbitmq-cluster","uid":"3ecefa8a-1bec-48a7-9af4-dd0df3339101","controller":true,"blockOwnerDeletion":true}],"managedFields":[{"manager":"manager","operation":"Update","apiVersion":"apps/v1","time":"2022-03-18T18:06:25Z","fieldsType":"FieldsV1","fieldsV1":{"f:metadata":{"f:annotations":{".":{},"f:rabbitmq.com/createdAt":{}},"f:labels":{".":{},"f:app.kubernetes.io/component":{},"f:app.kubernetes.io/name":{},"f:app.kubernetes.io/part-of":{}},"f:ownerReferences":{".":{},"k:{\"uid\":\"3ecefa8a-1bec-48a7-9af4-dd0df3339101\"}":{".":{},"f:apiVersion":{},"f:blockOwnerDeletion":{},"f:controller":{},"f:kind":{},"f:name":{},"f:uid":{}}}},"f:spec":{"f:podManagementPolicy":{},"f:replicas":{},"f:revisionHistoryLimit":{},"f:selector":{"f:matchLabels":{".":{},"f:app.kubernetes.io/name":{}}},"f:serviceName":{},"f:template":{"f:metadata":{"f:annotations":{".":{},"f:prometheus.io/port":{},"f:prometheus.io/scrape":{}},"f:labels":{".":{},"f:app.kubernetes.io/component":{},"f:app.kubernetes.io/name":{},"f:app.kubernetes.io/part-of":{}}},"f:spec":{"f:automountServiceAccountToken":{},"f:containers":{"k:{\"name\":\"rabbitmq\"}":{".":{},"f:env":{".":{},"k:{\"name\":\"K8S_HOSTNAME_SUFFIX\"}":{".":{},"f:name":{},"f:value":{}},"k:{\"name\":\"K8S_SERVICE_NAME\"}":{".":{},"f:name":{},"f:value":{}},"k:{\"name\":\"MY_POD_NAME\"}":{".":{},"f:name":{},"f:valueFrom":{".":{},"f:fieldRef":{".":{},"f:apiVersion":{},"f:fieldPath":{}}}},"k:{\"name\":\"MY_POD_NAMESPACE\"}":{".":{},"f:name":{},"f:valueFrom":{".":{},"f:fieldRef":{".":{},"f:apiVersion":{},"f:fieldPath":{}}}},"k:{\"name\":\"RABBITMQ_ENABLED_PLUGINS_FILE\"}":{".":{},"f:name":{},"f:value":{}},"k:{\"name\":\"RABBITMQ_NODENAME\"}":{".":{},"f:name":{},"f:value":{}},"k:{\"name\":\"RABBITMQ_USE_LONGNAME\"}":{".":{},"f:name":{},"f:value":{}}},"f:image":{},"f:imagePullPolicy":{},"f:lifecycle":{".":{},"f:preStop":{".":{},"f:exec":{".":{},"f:command":{}}}},"f:name":{},"f:ports":{".":{},"k:{\"containerPort\":4369,\"protocol\":\"TCP\"}":{".":{},"f:containerPort":{},"f:name":{},"f:protocol":{}},"k:{\"containerPort\":5672,\"protocol\":\"TCP\"}":{".":{},"f:containerPort":{},"f:name":{},"f:protocol":{}},"k:{\"containerPort\":15672,\"protocol\":\"TCP\"}":{".":{},"f:containerPort":{},"f:name":{},"f:protocol":{}},"k:{\"containerPort\":15692,\"protocol\":\"TCP\"}":{".":{},"f:containerPort":{},"f:name":{},"f:protocol":{}}},"f:readinessProbe":{".":{},"f:failureThreshold":{},"f:initialDelaySeconds":{},"f:periodSeconds":{},"f:successThreshold":{},"f:tcpSocket":{".":{},"f:port":{}},"f:timeoutSeconds":{}},"f:resources":{".":{},"f:limits":{".":{},"f:cpu":{},"f:memory":{}},"f:requests":{".":{},"f:cpu":{},"f:memory":{}}},"f:terminationMessagePath":{},"f:terminationMessagePolicy":{},"f:volumeMounts":{".":{},"k:{\"mountPath\":\"/etc/pod-info/\"}":{".":{},"f:mountPath":{},"f:name":{}},"k:{\"mountPath\":\"/etc/rabbitmq/conf.d/10-operatorDefaults.conf\"}":{".":{},"f:mountPath":{},"f:name":{},"f:subPath":{}},"k:{\"mountPath\":\"/etc/rabbitmq/conf.d/11-default_user.conf\"}":{".":{},"f:mountPath":{},"f:name":{},"f:subPath":{}},"k:{\"mountPath\":\"/etc/rabbitmq/conf.d/90-userDefinedConfiguration.conf\"}":{".":{},"f:mountPath":{},"f:name":{},"f:subPath":{}},"k:{\"mountPath\":\"/operator\"}":{".":{},"f:mountPath":{},"f:name":{}},"k:{\"mountPath\":\"/var/lib/rabbitmq/\"}":{".":{},"f:mountPath":{},"f:name":{}},"k:{\"mountPath\":\"/var/lib/rabbitmq/mnesia/\"}":{".":{},"f:mountPath":{},"f:name":{}}}}},"f:dnsPolicy":{},"f:initContainers":{".":{},"k:{\"name\":\"setup-container\"}":{".":{},"f:command":{},"f:image":{},"f:imagePullPolicy":{},"f:name":{},"f:resources":{".":{},"f:limits":{".":{},"f:cpu":{},"f:memory":{}},"f:requests":{".":{},"f:cpu":{},"f:memory":{}}},"f:securityContext":{".":{},"f:capabilities":{".":{},"f:drop":{}},"f:runAsUser":{}},"f:terminationMessagePath":{},"f:terminationMessagePolicy":{},"f:volumeMounts":{".":{},"k:{\"mountPath\":\"/operator\"}":{".":{},"f:mountPath":{},"f:name":{}},"k:{\"mountPath\":\"/tmp/default_user.conf\"}":{".":{},"f:mountPath":{},"f:name":{},"f:subPath":{}},"k:{\"mountPath\":\"/tmp/erlang-cookie-secret/\"}":{".":{},"f:mountPath":{},"f:name":{}},"k:{\"mountPath\":\"/tmp/rabbitmq-plugins/\"}":{".":{},"f:mountPath":{},"f:name":{}},"k:{\"mountPath\":\"/var/lib/rabbitmq/\"}":{".":{},"f:mountPath":{},"f:name":{}},"k:{\"mountPath\":\"/var/lib/rabbitmq/mnesia/\"}":{".":{},"f:mountPath":{},"f:name":{}}}}},"f:restartPolicy":{},"f:schedulerName":{},"f:securityContext":{".":{},"f:fsGroup":{},"f:runAsGroup":{},"f:runAsUser":{}},"f:serviceAccount":{},"f:serviceAccountName":{},"f:terminationGracePeriodSeconds":{},"f:topologySpreadConstraints":{".":{},"k:{\"topologyKey\":\"topology.kubernetes.io/zone\",\"whenUnsatisfiable\":\"ScheduleAnyway\"}":{".":{},"f:labelSelector":{".":{},"f:matchLabels":{".":{},"f:app.kubernetes.io/name":{}}},"f:maxSkew":{},"f:topologyKey":{},"f:whenUnsatisfiable":{}}},"f:volumes":{".":{},"k:{\"name\":\"erlang-cookie-secret\"}":{".":{},"f:name":{},"f:secret":{".":{},"f:defaultMode":{},"f:secretName":{}}},"k:{\"name\":\"plugins-conf\"}":{".":{},"f:configMap":{".":{},"f:defaultMode":{},"f:name":{}},"f:name":{}},"k:{\"name\":\"pod-info\"}":{".":{},"f:downwardAPI":{".":{},"f:defaultMode":{},"f:items":{}},"f:name":{}},"k:{\"name\":\"rabbitmq-confd\"}":{".":{},"f:name":{},"f:projected":{".":{},"f:defaultMode":{},"f:sources":{}}},"k:{\"name\":\"rabbitmq-erlang-cookie\"}":{".":{},"f:emptyDir":{},"f:name":{}},"k:{\"name\":\"rabbitmq-plugins\"}":{".":{},"f:emptyDir":{},"f:name":{}}}}},"f:updateStrategy":{"f:rollingUpdate":{".":{},"f:partition":{}},"f:type":{}},"f:volumeClaimTemplates":{}}}},{"manager":"kube-controller-manager","operation":"Update","apiVersion":"apps/v1","time":"2022-03-18T18:07:23Z","fieldsType":"FieldsV1","fieldsV1":{"f:status":{"f:collisionCount":{},"f:currentReplicas":{},"f:currentRevision":{},"f:observedGeneration":{},"f:readyReplicas":{},"f:replicas":{},"f:updateRevision":{},"f:updatedReplicas":{}}}}]},"spec":{"replicas":1,"selector":{"matchLabels":{"app.kubernetes.io/name":"rabbitmq-cluster"}},"template":{"metadata":{"creationTimestamp":null,"labels":{"app.kubernetes.io/component":"rabbitmq","app.kubernetes.io/name":"rabbitmq-cluster","app.kubernetes.io/part-of":"rabbitmq"},"annotations":{"prometheus.io/port":"15692","prometheus.io/scrape":"true"}},"spec":{"volumes":[{"name":"plugins-conf","configMap":{"name":"rabbitmq-cluster-plugins-conf","defaultMode":420}},{"name":"rabbitmq-confd","projected":{"sources":[{"secret":{"name":"rabbitmq-cluster-default-user","items":[{"key":"default_user.conf","path":"default_user.conf"}]}},{"configMap":{"name":"rabbitmq-cluster-server-conf","items":[{"key":"operatorDefaults.conf","path":"operatorDefaults.conf"},{"key":"userDefinedConfiguration.conf","path":"userDefinedConfiguration.conf"}]}}],"defaultMode":420}},{"name":"rabbitmq-erlang-cookie","emptyDir":{}},{"name":"erlang-cookie-secret","secret":{"secretName":"rabbitmq-cluster-erlang-cookie","defaultMode":420}},{"name":"rabbitmq-plugins","emptyDir":{}},{"name":"pod-info","downwardAPI":{"items":[{"path":"skipPreStopChecks","fieldRef":{"apiVersion":"v1","fieldPath":"metadata.labels['skipPreStopChecks']"}}],"defaultMode":420}}],"initContainers":[{"name":"setup-container","image":"rabbitmq:3.8.12-management","command":["sh","-c","cp /tmp/erlang-cookie-secret/.erlang.cookie /var/lib/rabbitmq/.erlang.cookie \u0026\u0026 chown 999:999 /var/lib/rabbitmq/.erlang.cookie \u0026\u0026 chmod 600 /var/lib/rabbitmq/.erlang.cookie ; cp /tmp/rabbitmq-plugins/enabled_plugins /operator/enabled_plugins \u0026\u0026 chown 999:999 /operator/enabled_plugins ; chown 999:999 /var/lib/rabbitmq/mnesia/ ; echo '[default]' \u003e /var/lib/rabbitmq/.rabbitmqadmin.conf \u0026\u0026 sed -e 's/default_user/username/' -e 's/default_pass/password/' /tmp/default_user.conf \u003e\u003e /var/lib/rabbitmq/.rabbitmqadmin.conf \u0026\u0026 chown 999:999 /var/lib/rabbitmq/.rabbitmqadmin.conf \u0026\u0026 chmod 600 /var/lib/rabbitmq/.rabbitmqadmin.conf"],"resources":{"limits":{"cpu":"100m","memory":"500Mi"},"requests":{"cpu":"100m","memory":"500Mi"}},"volumeMounts":[{"name":"plugins-conf","mountPath":"/tmp/rabbitmq-plugins/"},{"name":"rabbitmq-erlang-cookie","mountPath":"/var/lib/rabbitmq/"},{"name":"erlang-cookie-secret","mountPath":"/tmp/erlang-cookie-secret/"},{"name":"rabbitmq-plugins","mountPath":"/operator"},{"name":"persistence","mountPath":"/var/lib/rabbitmq/mnesia/"},{"name":"rabbitmq-confd","mountPath":"/tmp/default_user.conf","subPath":"default_user.conf"}],"terminationMessagePath":"/dev/termination-log","terminationMessagePolicy":"File","imagePullPolicy":"IfNotPresent","securityContext":{"capabilities":{"drop":["FSETID","KILL","SETGID","SETUID","SETPCAP","NET_BIND_SERVICE","NET_RAW","SYS_CHROOT","MKNOD","AUDIT_WRITE","SETFCAP"]},"runAsUser":0}}],"containers":[{"name":"rabbitmq","image":"rabbitmq:3.8.12-management","ports":[{"name":"epmd","containerPort":4369,"protocol":"TCP"},{"name":"amqp","containerPort":5672,"protocol":"TCP"},{"name":"management","containerPort":15672,"protocol":"TCP"},{"name":"prometheus","containerPort":15692,"protocol":"TCP"}],"env":[{"name":"MY_POD_NAME","valueFrom":{"fieldRef":{"apiVersion":"v1","fieldPath":"metadata.name"}}},{"name":"MY_POD_NAMESPACE","valueFrom":{"fieldRef":{"apiVersion":"v1","fieldPath":"metadata.namespace"}}},{"name":"RABBITMQ_ENABLED_PLUGINS_FILE","value":"/operator/enabled_plugins"},{"name":"K8S_SERVICE_NAME","value":"rabbitmq-cluster-nodes"},{"name":"RABBITMQ_USE_LONGNAME","value":"true"},{"name":"RABBITMQ_NODENAME","value":"rabbit@$(MY_POD_NAME).$(K8S_SERVICE_NAME).$(MY_POD_NAMESPACE)"},{"name":"K8S_HOSTNAME_SUFFIX","value":".$(K8S_SERVICE_NAME).$(MY_POD_NAMESPACE)"}],"resources":{"limits":{"cpu":"2","memory":"2Gi"},"requests":{"cpu":"1","memory":"2Gi"}},"volumeMounts":[{"name":"rabbitmq-erlang-cookie","mountPath":"/var/lib/rabbitmq/"},{"name":"persistence","mountPath":"/var/lib/rabbitmq/mnesia/"},{"name":"rabbitmq-plugins","mountPath":"/operator"},{"name":"rabbitmq-confd","mountPath":"/etc/rabbitmq/conf.d/10-operatorDefaults.conf","subPath":"operatorDefaults.conf"},{"name":"rabbitmq-confd","mountPath":"/etc/rabbitmq/conf.d/11-default_user.conf","subPath":"default_user.conf"},{"name":"rabbitmq-confd","mountPath":"/etc/rabbitmq/conf.d/90-userDefinedConfiguration.conf","subPath":"userDefinedConfiguration.conf"},{"name":"pod-info","mountPath":"/etc/pod-info/"}],"readinessProbe":{"tcpSocket":{"port":"amqp"},"initialDelaySeconds":10,"timeoutSeconds":5,"periodSeconds":10,"successThreshold":1,"failureThreshold":3},"lifecycle":{"preStop":{"exec":{"command":["/bin/bash","-c","if [ ! -z \"$(cat /etc/pod-info/skipPreStopChecks)\" ]; then exit 0; fi; rabbitmq-upgrade await_online_quorum_plus_one -t 604800; rabbitmq-upgrade await_online_synchronized_mirror -t 604800; rabbitmq-upgrade drain -t 604800"]}}},"terminationMessagePath":"/dev/termination-log","terminationMessagePolicy":"File","imagePullPolicy":"IfNotPresent"}],"restartPolicy":"Always","terminationGracePeriodSeconds":604800,"dnsPolicy":"ClusterFirst","serviceAccountName":"rabbitmq-cluster-server","serviceAccount":"rabbitmq-cluster-server","automountServiceAccountToken":true,"securityContext":{"runAsUser":999,"runAsGroup":999,"fsGroup":999},"schedulerName":"default-scheduler","topologySpreadConstraints":[{"maxSkew":1,"topologyKey":"topology.kubernetes.io/zone","whenUnsatisfiable":"ScheduleAnyway","labelSelector":{"matchLabels":{"app.kubernetes.io/name":"rabbitmq-cluster"}}}]}},"volumeClaimTemplates":[{"metadata":{"name":"persistence","namespace":"default","creationTimestamp":null,"labels":{"app.kubernetes.io/component":"rabbitmq","app.kubernetes.io/name":"rabbitmq-cluster","app.kubernetes.io/part-of":"rabbitmq"},"ownerReferences":[{"apiVersion":"rabbitmq.com/v1beta1","kind":"RabbitmqCluster","name":"rabbitmq-cluster","uid":"3ecefa8a-1bec-48a7-9af4-dd0df3339101","controller":true,"blockOwnerDeletion":false}]},"spec":{"accessModes":["ReadWriteOnce"],"resources":{"requests":{"storage":"10Gi"}},"volumeMode":"Filesystem"},"status":{"phase":"Pending"}}],"serviceName":"rabbitmq-cluster-nodes","podManagementPolicy":"Parallel","updateStrategy":{"type":"RollingUpdate","rollingUpdate":{"partition":0}},"revisionHistoryLimit":10},"status":{"observedGeneration":1,"replicas":1,"readyReplicas":1,"currentReplicas":1,"updatedReplicas":1,"currentRevision":"rabbitmq-cluster-server-5f8b8665fb","updateRevision":"rabbitmq-cluster-server-5f8b8665fb","collisionCount":0}}
2022/03/18 18:07:23 learn_server.go:291: [SIEVE-AFTER-READ]	Get	true	endpoints	default	rabbitmq-cluster	github.com/rabbitmq/cluster-operator/controllers.(*RabbitmqClusterReconciler)	NoError	{"kind":"Endpoints","apiVersion":"v1","metadata":{"name":"rabbitmq-cluster","namespace":"default","selfLink":"/api/v1/namespaces/default/endpoints/rabbitmq-cluster","uid":"eeba9576-0362-4e74-aafd-71e4ffe98d25","resourceVersion":"1402","creationTimestamp":"2022-03-18T18:06:25Z","labels":{"app.kubernetes.io/component":"rabbitmq","app.kubernetes.io/name":"rabbitmq-cluster","app.kubernetes.io/part-of":"rabbitmq"},"annotations":{"endpoints.kubernetes.io/last-change-trigger-time":"2022-03-18T18:07:23Z"},"managedFields":[{"manager":"kube-controller-manager","operation":"Update","apiVersion":"v1","time":"2022-03-18T18:07:23Z","fieldsType":"FieldsV1","fieldsV1":{"f:metadata":{"f:annotations":{".":{},"f:endpoints.kubernetes.io/last-change-trigger-time":{}},"f:labels":{".":{},"f:app.kubernetes.io/component":{},"f:app.kubernetes.io/name":{},"f:app.kubernetes.io/part-of":{}}},"f:subsets":{}}}]},"subsets":[{"addresses":[{"ip":"10.244.1.4","nodeName":"kind-worker","targetRef":{"kind":"Pod","namespace":"default","name":"rabbitmq-cluster-server-0","uid":"cbaba199-5faf-480a-81e8-051ce2cc79e6","resourceVersion":"1399"}}],"ports":[{"name":"amqp","port":5672,"protocol":"TCP"},{"name":"management","port":15672,"protocol":"TCP"}]}]}
2022/03/18 18:07:23 learn_server.go:256: [SIEVE-BEFORE-WRITE]	26
2022/03/18 18:07:23 learn_server.go:263: [SIEVE-AFTER-WRITE]	26	StatusUpdate	rabbitmqcluster	github.com/rabbitmq/cluster-operator/controllers.(*RabbitmqClusterReconciler)	NoError	{"metadata":{"name":"rabbitmq-cluster","namespace":"default","selfLink":"/apis/rabbitmq.com/v1beta1/namespaces/default/rabbitmqclusters/rabbitmq-cluster/status","uid":"3ecefa8a-1bec-48a7-9af4-dd0df3339101","resourceVersion":"1405","generation":2,"creationTimestamp":"2022-03-18T18:06:25Z","annotations":{"kubectl.kubernetes.io/last-applied-configuration":"{\"apiVersion\":\"rabbitmq.com/v1beta1\",\"kind\":\"RabbitmqCluster\",\"metadata\":{\"annotations\":{},\"name\":\"rabbitmq-cluster\",\"namespace\":\"default\"},\"spec\":{\"persistence\":{\"storage\":\"10Gi\"},\"replicas\":1}}\n"},"finalizers":["deletion.finalizers.rabbitmqclusters.rabbitmq.com"],"managedFields":[{"manager":"kubectl-client-side-apply","operation":"Update","apiVersion":"rabbitmq.com/v1beta1","time":"2022-03-18T18:06:25Z","fieldsType":"FieldsV1","fieldsV1":{"f:metadata":{"f:annotations":{".":{},"f:kubectl.kubernetes.io/last-applied-configuration":{}}},"f:spec":{".":{},"f:image":{},"f:persistence":{".":{},"f:storage":{}},"f:replicas":{},"f:resources":{".":{},"f:limits":{".":{},"f:memory":{}},"f:requests":{".":{},"f:memory":{}}},"f:service":{".":{},"f:type":{}},"f:terminationGracePeriodSeconds":{}}}},{"manager":"manager","operation":"Update","apiVersion":"rabbitmq.com/v1beta1","time":"2022-03-18T18:07:23Z","fieldsType":"FieldsV1","fieldsV1":{"f:metadata":{"f:finalizers":{}},"f:spec":{"f:override":{},"f:rabbitmq":{},"f:resources":{"f:limits":{"f:cpu":{}},"f:requests":{"f:cpu":{}}},"f:tls":{}},"f:status":{".":{},"f:conditions":{},"f:defaultUser":{".":{},"f:secretReference":{".":{},"f:keys":{".":{},"f:password":{},"f:username":{}},"f:name":{},"f:namespace":{}},"f:serviceReference":{".":{},"f:name":{},"f:namespace":{}}}}}}]},"spec":{"replicas":1,"image":"rabbitmq:3.8.12-management","service":{"type":"ClusterIP"},"persistence":{"storage":"10Gi"},"resources":{"limits":{"cpu":"2","memory":"2Gi"},"requests":{"cpu":"1","memory":"2Gi"}},"rabbitmq":{},"tls":{},"override":{},"terminationGracePeriodSeconds":604800},"status":{"conditions":[{"type":"AllReplicasReady","status":"True","lastTransitionTime":"2022-03-18T18:07:23Z","reason":"AllPodsAreReady"},{"type":"ClusterAvailable","status":"True","lastTransitionTime":"2022-03-18T18:07:23Z","reason":"AtLeastOneEndpointAvailable"},{"type":"NoWarnings","status":"True","lastTransitionTime":"2022-03-18T18:06:25Z","reason":"NoWarnings"},{"type":"ReconcileSuccess","status":"Unknown","lastTransitionTime":"2022-03-18T18:06:25Z","reason":"Initialising"}],"defaultUser":{"secretReference":{"name":"rabbitmq-cluster-default-user","namespace":"default","keys":{"password":"password","username":"username"}},"serviceReference":{"name":"rabbitmq-cluster","namespace":"default"}}}}
2022/03/18 18:07:23 learn_server.go:279: [SIEVE-BEFORE-HEAR]	19	Updated	rabbitmqcluster	{"metadata":{"name":"rabbitmq-cluster","namespace":"default","selfLink":"/apis/rabbitmq.com/v1beta1/namespaces/default/rabbitmqclusters/rabbitmq-cluster","uid":"3ecefa8a-1bec-48a7-9af4-dd0df3339101","resourceVersion":"1405","generation":2,"creationTimestamp":"2022-03-18T18:06:25Z","annotations":{"kubectl.kubernetes.io/last-applied-configuration":"{\"apiVersion\":\"rabbitmq.com/v1beta1\",\"kind\":\"RabbitmqCluster\",\"metadata\":{\"annotations\":{},\"name\":\"rabbitmq-cluster\",\"namespace\":\"default\"},\"spec\":{\"persistence\":{\"storage\":\"10Gi\"},\"replicas\":1}}\n"},"finalizers":["deletion.finalizers.rabbitmqclusters.rabbitmq.com"],"managedFields":[{"manager":"kubectl-client-side-apply","operation":"Update","apiVersion":"rabbitmq.com/v1beta1","time":"2022-03-18T18:06:25Z","fieldsType":"FieldsV1","fieldsV1":{"f:metadata":{"f:annotations":{".":{},"f:kubectl.kubernetes.io/last-applied-configuration":{}}},"f:spec":{".":{},"f:image":{},"f:persistence":{".":{},"f:storage":{}},"f:replicas":{},"f:resources":{".":{},"f:limits":{".":{},"f:memory":{}},"f:requests":{".":{},"f:memory":{}}},"f:service":{".":{},"f:type":{}},"f:terminationGracePeriodSeconds":{}}}},{"manager":"manager","operation":"Update","apiVersion":"rabbitmq.com/v1beta1","time":"2022-03-18T18:07:23Z","fieldsType":"FieldsV1","fieldsV1":{"f:metadata":{"f:finalizers":{}},"f:spec":{"f:override":{},"f:rabbitmq":{},"f:resources":{"f:limits":{"f:cpu":{}},"f:requests":{"f:cpu":{}}},"f:tls":{}},"f:status":{".":{},"f:conditions":{},"f:defaultUser":{".":{},"f:secretReference":{".":{},"f:keys":{".":{},"f:password":{},"f:username":{}},"f:name":{},"f:namespace":{}},"f:serviceReference":{".":{},"f:name":{},"f:namespace":{}}}}}}]},"spec":{"replicas":1,"image":"rabbitmq:3.8.12-management","service":{"type":"ClusterIP"},"persistence":{"storage":"10Gi"},"resources":{"limits":{"cpu":"2","memory":"2Gi"},"requests":{"cpu":"1","memory":"2Gi"}},"rabbitmq":{},"tls":{},"override":{},"terminationGracePeriodSeconds":604800},"status":{"conditions":[{"type":"AllReplicasReady","status":"True","lastTransitionTime":"2022-03-18T18:07:23Z","reason":"AllPodsAreReady"},{"type":"ClusterAvailable","status":"True","lastTransitionTime":"2022-03-18T18:07:23Z","reason":"AtLeastOneEndpointAvailable"},{"type":"NoWarnings","status":"True","lastTransitionTime":"2022-03-18T18:06:25Z","reason":"NoWarnings"},{"type":"ReconcileSuccess","status":"Unknown","lastTransitionTime":"2022-03-18T18:06:25Z","reason":"Initialising"}],"defaultUser":{"secretReference":{"name":"rabbitmq-cluster-default-user","namespace":"default","keys":{"password":"password","username":"username"}},"serviceReference":{"name":"rabbitmq-cluster","namespace":"default"}}}}
2022/03/18 18:07:23 learn_server.go:289: [SIEVE-AFTER-HEAR]	19
2022/03/18 18:07:23 learn_server.go:291: [SIEVE-AFTER-READ]	Get	true	statefulset	default	rabbitmq-cluster-server	github.com/rabbitmq/cluster-operator/controllers.(*RabbitmqClusterReconciler)	NoError	{"kind":"StatefulSet","apiVersion":"apps/v1","metadata":{"name":"rabbitmq-cluster-server","namespace":"default","selfLink":"/apis/apps/v1/namespaces/default/statefulsets/rabbitmq-cluster-server","uid":"f2f07f3e-b500-4c48-a5de-8db7eaf37b9a","resourceVersion":"1404","generation":1,"creationTimestamp":"2022-03-18T18:06:25Z","labels":{"app.kubernetes.io/component":"rabbitmq","app.kubernetes.io/name":"rabbitmq-cluster","app.kubernetes.io/part-of":"rabbitmq"},"annotations":{"rabbitmq.com/createdAt":"2022-03-18T18:06:25Z"},"ownerReferences":[{"apiVersion":"rabbitmq.com/v1beta1","kind":"RabbitmqCluster","name":"rabbitmq-cluster","uid":"3ecefa8a-1bec-48a7-9af4-dd0df3339101","controller":true,"blockOwnerDeletion":true}],"managedFields":[{"manager":"manager","operation":"Update","apiVersion":"apps/v1","time":"2022-03-18T18:06:25Z","fieldsType":"FieldsV1","fieldsV1":{"f:metadata":{"f:annotations":{".":{},"f:rabbitmq.com/createdAt":{}},"f:labels":{".":{},"f:app.kubernetes.io/component":{},"f:app.kubernetes.io/name":{},"f:app.kubernetes.io/part-of":{}},"f:ownerReferences":{".":{},"k:{\"uid\":\"3ecefa8a-1bec-48a7-9af4-dd0df3339101\"}":{".":{},"f:apiVersion":{},"f:blockOwnerDeletion":{},"f:controller":{},"f:kind":{},"f:name":{},"f:uid":{}}}},"f:spec":{"f:podManagementPolicy":{},"f:replicas":{},"f:revisionHistoryLimit":{},"f:selector":{"f:matchLabels":{".":{},"f:app.kubernetes.io/name":{}}},"f:serviceName":{},"f:template":{"f:metadata":{"f:annotations":{".":{},"f:prometheus.io/port":{},"f:prometheus.io/scrape":{}},"f:labels":{".":{},"f:app.kubernetes.io/component":{},"f:app.kubernetes.io/name":{},"f:app.kubernetes.io/part-of":{}}},"f:spec":{"f:automountServiceAccountToken":{},"f:containers":{"k:{\"name\":\"rabbitmq\"}":{".":{},"f:env":{".":{},"k:{\"name\":\"K8S_HOSTNAME_SUFFIX\"}":{".":{},"f:name":{},"f:value":{}},"k:{\"name\":\"K8S_SERVICE_NAME\"}":{".":{},"f:name":{},"f:value":{}},"k:{\"name\":\"MY_POD_NAME\"}":{".":{},"f:name":{},"f:valueFrom":{".":{},"f:fieldRef":{".":{},"f:apiVersion":{},"f:fieldPath":{}}}},"k:{\"name\":\"MY_POD_NAMESPACE\"}":{".":{},"f:name":{},"f:valueFrom":{".":{},"f:fieldRef":{".":{},"f:apiVersion":{},"f:fieldPath":{}}}},"k:{\"name\":\"RABBITMQ_ENABLED_PLUGINS_FILE\"}":{".":{},"f:name":{},"f:value":{}},"k:{\"name\":\"RABBITMQ_NODENAME\"}":{".":{},"f:name":{},"f:value":{}},"k:{\"name\":\"RABBITMQ_USE_LONGNAME\"}":{".":{},"f:name":{},"f:value":{}}},"f:image":{},"f:imagePullPolicy":{},"f:lifecycle":{".":{},"f:preStop":{".":{},"f:exec":{".":{},"f:command":{}}}},"f:name":{},"f:ports":{".":{},"k:{\"containerPort\":4369,\"protocol\":\"TCP\"}":{".":{},"f:containerPort":{},"f:name":{},"f:protocol":{}},"k:{\"containerPort\":5672,\"protocol\":\"TCP\"}":{".":{},"f:containerPort":{},"f:name":{},"f:protocol":{}},"k:{\"containerPort\":15672,\"protocol\":\"TCP\"}":{".":{},"f:containerPort":{},"f:name":{},"f:protocol":{}},"k:{\"containerPort\":15692,\"protocol\":\"TCP\"}":{".":{},"f:containerPort":{},"f:name":{},"f:protocol":{}}},"f:readinessProbe":{".":{},"f:failureThreshold":{},"f:initialDelaySeconds":{},"f:periodSeconds":{},"f:successThreshold":{},"f:tcpSocket":{".":{},"f:port":{}},"f:timeoutSeconds":{}},"f:resources":{".":{},"f:limits":{".":{},"f:cpu":{},"f:memory":{}},"f:requests":{".":{},"f:cpu":{},"f:memory":{}}},"f:terminationMessagePath":{},"f:terminationMessagePolicy":{},"f:volumeMounts":{".":{},"k:{\"mountPath\":\"/etc/pod-info/\"}":{".":{},"f:mountPath":{},"f:name":{}},"k:{\"mountPath\":\"/etc/rabbitmq/conf.d/10-operatorDefaults.conf\"}":{".":{},"f:mountPath":{},"f:name":{},"f:subPath":{}},"k:{\"mountPath\":\"/etc/rabbitmq/conf.d/11-default_user.conf\"}":{".":{},"f:mountPath":{},"f:name":{},"f:subPath":{}},"k:{\"mountPath\":\"/etc/rabbitmq/conf.d/90-userDefinedConfiguration.conf\"}":{".":{},"f:mountPath":{},"f:name":{},"f:subPath":{}},"k:{\"mountPath\":\"/operator\"}":{".":{},"f:mountPath":{},"f:name":{}},"k:{\"mountPath\":\"/var/lib/rabbitmq/\"}":{".":{},"f:mountPath":{},"f:name":{}},"k:{\"mountPath\":\"/var/lib/rabbitmq/mnesia/\"}":{".":{},"f:mountPath":{},"f:name":{}}}}},"f:dnsPolicy":{},"f:initContainers":{".":{},"k:{\"name\":\"setup-container\"}":{".":{},"f:command":{},"f:image":{},"f:imagePullPolicy":{},"f:name":{},"f:resources":{".":{},"f:limits":{".":{},"f:cpu":{},"f:memory":{}},"f:requests":{".":{},"f:cpu":{},"f:memory":{}}},"f:securityContext":{".":{},"f:capabilities":{".":{},"f:drop":{}},"f:runAsUser":{}},"f:terminationMessagePath":{},"f:terminationMessagePolicy":{},"f:volumeMounts":{".":{},"k:{\"mountPath\":\"/operator\"}":{".":{},"f:mountPath":{},"f:name":{}},"k:{\"mountPath\":\"/tmp/default_user.conf\"}":{".":{},"f:mountPath":{},"f:name":{},"f:subPath":{}},"k:{\"mountPath\":\"/tmp/erlang-cookie-secret/\"}":{".":{},"f:mountPath":{},"f:name":{}},"k:{\"mountPath\":\"/tmp/rabbitmq-plugins/\"}":{".":{},"f:mountPath":{},"f:name":{}},"k:{\"mountPath\":\"/var/lib/rabbitmq/\"}":{".":{},"f:mountPath":{},"f:name":{}},"k:{\"mountPath\":\"/var/lib/rabbitmq/mnesia/\"}":{".":{},"f:mountPath":{},"f:name":{}}}}},"f:restartPolicy":{},"f:schedulerName":{},"f:securityContext":{".":{},"f:fsGroup":{},"f:runAsGroup":{},"f:runAsUser":{}},"f:serviceAccount":{},"f:serviceAccountName":{},"f:terminationGracePeriodSeconds":{},"f:topologySpreadConstraints":{".":{},"k:{\"topologyKey\":\"topology.kubernetes.io/zone\",\"whenUnsatisfiable\":\"ScheduleAnyway\"}":{".":{},"f:labelSelector":{".":{},"f:matchLabels":{".":{},"f:app.kubernetes.io/name":{}}},"f:maxSkew":{},"f:topologyKey":{},"f:whenUnsatisfiable":{}}},"f:volumes":{".":{},"k:{\"name\":\"erlang-cookie-secret\"}":{".":{},"f:name":{},"f:secret":{".":{},"f:defaultMode":{},"f:secretName":{}}},"k:{\"name\":\"plugins-conf\"}":{".":{},"f:configMap":{".":{},"f:defaultMode":{},"f:name":{}},"f:name":{}},"k:{\"name\":\"pod-info\"}":{".":{},"f:downwardAPI":{".":{},"f:defaultMode":{},"f:items":{}},"f:name":{}},"k:{\"name\":\"rabbitmq-confd\"}":{".":{},"f:name":{},"f:projected":{".":{},"f:defaultMode":{},"f:sources":{}}},"k:{\"name\":\"rabbitmq-erlang-cookie\"}":{".":{},"f:emptyDir":{},"f:name":{}},"k:{\"name\":\"rabbitmq-plugins\"}":{".":{},"f:emptyDir":{},"f:name":{}}}}},"f:updateStrategy":{"f:rollingUpdate":{".":{},"f:partition":{}},"f:type":{}},"f:volumeClaimTemplates":{}}}},{"manager":"kube-controller-manager","operation":"Update","apiVersion":"apps/v1","time":"2022-03-18T18:07:23Z","fieldsType":"FieldsV1","fieldsV1":{"f:status":{"f:collisionCount":{},"f:currentReplicas":{},"f:currentRevision":{},"f:observedGeneration":{},"f:readyReplicas":{},"f:replicas":{},"f:updateRevision":{},"f:updatedReplicas":{}}}}]},"spec":{"replicas":1,"selector":{"matchLabels":{"app.kubernetes.io/name":"rabbitmq-cluster"}},"template":{"metadata":{"creationTimestamp":null,"labels":{"app.kubernetes.io/component":"rabbitmq","app.kubernetes.io/name":"rabbitmq-cluster","app.kubernetes.io/part-of":"rabbitmq"},"annotations":{"prometheus.io/port":"15692","prometheus.io/scrape":"true"}},"spec":{"volumes":[{"name":"plugins-conf","configMap":{"name":"rabbitmq-cluster-plugins-conf","defaultMode":420}},{"name":"rabbitmq-confd","projected":{"sources":[{"secret":{"name":"rabbitmq-cluster-default-user","items":[{"key":"default_user.conf","path":"default_user.conf"}]}},{"configMap":{"name":"rabbitmq-cluster-server-conf","items":[{"key":"operatorDefaults.conf","path":"operatorDefaults.conf"},{"key":"userDefinedConfiguration.conf","path":"userDefinedConfiguration.conf"}]}}],"defaultMode":420}},{"name":"rabbitmq-erlang-cookie","emptyDir":{}},{"name":"erlang-cookie-secret","secret":{"secretName":"rabbitmq-cluster-erlang-cookie","defaultMode":420}},{"name":"rabbitmq-plugins","emptyDir":{}},{"name":"pod-info","downwardAPI":{"items":[{"path":"skipPreStopChecks","fieldRef":{"apiVersion":"v1","fieldPath":"metadata.labels['skipPreStopChecks']"}}],"defaultMode":420}}],"initContainers":[{"name":"setup-container","image":"rabbitmq:3.8.12-management","command":["sh","-c","cp /tmp/erlang-cookie-secret/.erlang.cookie /var/lib/rabbitmq/.erlang.cookie \u0026\u0026 chown 999:999 /var/lib/rabbitmq/.erlang.cookie \u0026\u0026 chmod 600 /var/lib/rabbitmq/.erlang.cookie ; cp /tmp/rabbitmq-plugins/enabled_plugins /operator/enabled_plugins \u0026\u0026 chown 999:999 /operator/enabled_plugins ; chown 999:999 /var/lib/rabbitmq/mnesia/ ; echo '[default]' \u003e /var/lib/rabbitmq/.rabbitmqadmin.conf \u0026\u0026 sed -e 's/default_user/username/' -e 's/default_pass/password/' /tmp/default_user.conf \u003e\u003e /var/lib/rabbitmq/.rabbitmqadmin.conf \u0026\u0026 chown 999:999 /var/lib/rabbitmq/.rabbitmqadmin.conf \u0026\u0026 chmod 600 /var/lib/rabbitmq/.rabbitmqadmin.conf"],"resources":{"limits":{"cpu":"100m","memory":"500Mi"},"requests":{"cpu":"100m","memory":"500Mi"}},"volumeMounts":[{"name":"plugins-conf","mountPath":"/tmp/rabbitmq-plugins/"},{"name":"rabbitmq-erlang-cookie","mountPath":"/var/lib/rabbitmq/"},{"name":"erlang-cookie-secret","mountPath":"/tmp/erlang-cookie-secret/"},{"name":"rabbitmq-plugins","mountPath":"/operator"},{"name":"persistence","mountPath":"/var/lib/rabbitmq/mnesia/"},{"name":"rabbitmq-confd","mountPath":"/tmp/default_user.conf","subPath":"default_user.conf"}],"terminationMessagePath":"/dev/termination-log","terminationMessagePolicy":"File","imagePullPolicy":"IfNotPresent","securityContext":{"capabilities":{"drop":["FSETID","KILL","SETGID","SETUID","SETPCAP","NET_BIND_SERVICE","NET_RAW","SYS_CHROOT","MKNOD","AUDIT_WRITE","SETFCAP"]},"runAsUser":0}}],"containers":[{"name":"rabbitmq","image":"rabbitmq:3.8.12-management","ports":[{"name":"epmd","containerPort":4369,"protocol":"TCP"},{"name":"amqp","containerPort":5672,"protocol":"TCP"},{"name":"management","containerPort":15672,"protocol":"TCP"},{"name":"prometheus","containerPort":15692,"protocol":"TCP"}],"env":[{"name":"MY_POD_NAME","valueFrom":{"fieldRef":{"apiVersion":"v1","fieldPath":"metadata.name"}}},{"name":"MY_POD_NAMESPACE","valueFrom":{"fieldRef":{"apiVersion":"v1","fieldPath":"metadata.namespace"}}},{"name":"RABBITMQ_ENABLED_PLUGINS_FILE","value":"/operator/enabled_plugins"},{"name":"K8S_SERVICE_NAME","value":"rabbitmq-cluster-nodes"},{"name":"RABBITMQ_USE_LONGNAME","value":"true"},{"name":"RABBITMQ_NODENAME","value":"rabbit@$(MY_POD_NAME).$(K8S_SERVICE_NAME).$(MY_POD_NAMESPACE)"},{"name":"K8S_HOSTNAME_SUFFIX","value":".$(K8S_SERVICE_NAME).$(MY_POD_NAMESPACE)"}],"resources":{"limits":{"cpu":"2","memory":"2Gi"},"requests":{"cpu":"1","memory":"2Gi"}},"volumeMounts":[{"name":"rabbitmq-erlang-cookie","mountPath":"/var/lib/rabbitmq/"},{"name":"persistence","mountPath":"/var/lib/rabbitmq/mnesia/"},{"name":"rabbitmq-plugins","mountPath":"/operator"},{"name":"rabbitmq-confd","mountPath":"/etc/rabbitmq/conf.d/10-operatorDefaults.conf","subPath":"operatorDefaults.conf"},{"name":"rabbitmq-confd","mountPath":"/etc/rabbitmq/conf.d/11-default_user.conf","subPath":"default_user.conf"},{"name":"rabbitmq-confd","mountPath":"/etc/rabbitmq/conf.d/90-userDefinedConfiguration.conf","subPath":"userDefinedConfiguration.conf"},{"name":"pod-info","mountPath":"/etc/pod-info/"}],"readinessProbe":{"tcpSocket":{"port":"amqp"},"initialDelaySeconds":10,"timeoutSeconds":5,"periodSeconds":10,"successThreshold":1,"failureThreshold":3},"lifecycle":{"preStop":{"exec":{"command":["/bin/bash","-c","if [ ! -z \"$(cat /etc/pod-info/skipPreStopChecks)\" ]; then exit 0; fi; rabbitmq-upgrade await_online_quorum_plus_one -t 604800; rabbitmq-upgrade await_online_synchronized_mirror -t 604800; rabbitmq-upgrade drain -t 604800"]}}},"terminationMessagePath":"/dev/termination-log","terminationMessagePolicy":"File","imagePullPolicy":"IfNotPresent"}],"restartPolicy":"Always","terminationGracePeriodSeconds":604800,"dnsPolicy":"ClusterFirst","serviceAccountName":"rabbitmq-cluster-server","serviceAccount":"rabbitmq-cluster-server","automountServiceAccountToken":true,"securityContext":{"runAsUser":999,"runAsGroup":999,"fsGroup":999},"schedulerName":"default-scheduler","topologySpreadConstraints":[{"maxSkew":1,"topologyKey":"topology.kubernetes.io/zone","whenUnsatisfiable":"ScheduleAnyway","labelSelector":{"matchLabels":{"app.kubernetes.io/name":"rabbitmq-cluster"}}}]}},"volumeClaimTemplates":[{"metadata":{"name":"persistence","namespace":"default","creationTimestamp":null,"labels":{"app.kubernetes.io/component":"rabbitmq","app.kubernetes.io/name":"rabbitmq-cluster","app.kubernetes.io/part-of":"rabbitmq"},"ownerReferences":[{"apiVersion":"rabbitmq.com/v1beta1","kind":"RabbitmqCluster","name":"rabbitmq-cluster","uid":"3ecefa8a-1bec-48a7-9af4-dd0df3339101","controller":true,"blockOwnerDeletion":false}]},"spec":{"accessModes":["ReadWriteOnce"],"resources":{"requests":{"storage":"10Gi"}},"volumeMode":"Filesystem"},"status":{"phase":"Pending"}}],"serviceName":"rabbitmq-cluster-nodes","podManagementPolicy":"Parallel","updateStrategy":{"type":"RollingUpdate","rollingUpdate":{"partition":0}},"revisionHistoryLimit":10},"status":{"observedGeneration":1,"replicas":1,"readyReplicas":1,"currentReplicas":1,"updatedReplicas":1,"currentRevision":"rabbitmq-cluster-server-5f8b8665fb","updateRevision":"rabbitmq-cluster-server-5f8b8665fb","collisionCount":0}}
2022/03/18 18:07:23 learn_server.go:291: [SIEVE-AFTER-READ]	Get	true	service	default	rabbitmq-cluster-nodes	github.com/rabbitmq/cluster-operator/controllers.(*RabbitmqClusterReconciler)	NoError	{"kind":"Service","apiVersion":"v1","metadata":{"name":"rabbitmq-cluster-nodes","namespace":"default","selfLink":"/api/v1/namespaces/default/services/rabbitmq-cluster-nodes","uid":"f843e1c2-ced0-463d-87c1-0e127aaa2006","resourceVersion":"1080","creationTimestamp":"2022-03-18T18:06:25Z","labels":{"app.kubernetes.io/component":"rabbitmq","app.kubernetes.io/name":"rabbitmq-cluster","app.kubernetes.io/part-of":"rabbitmq"},"ownerReferences":[{"apiVersion":"rabbitmq.com/v1beta1","kind":"RabbitmqCluster","name":"rabbitmq-cluster","uid":"3ecefa8a-1bec-48a7-9af4-dd0df3339101","controller":true,"blockOwnerDeletion":true}],"managedFields":[{"manager":"manager","operation":"Update","apiVersion":"v1","time":"2022-03-18T18:06:25Z","fieldsType":"FieldsV1","fieldsV1":{"f:metadata":{"f:labels":{".":{},"f:app.kubernetes.io/component":{},"f:app.kubernetes.io/name":{},"f:app.kubernetes.io/part-of":{}},"f:ownerReferences":{".":{},"k:{\"uid\":\"3ecefa8a-1bec-48a7-9af4-dd0df3339101\"}":{".":{},"f:apiVersion":{},"f:blockOwnerDeletion":{},"f:controller":{},"f:kind":{},"f:name":{},"f:uid":{}}}},"f:spec":{"f:clusterIP":{},"f:ports":{".":{},"k:{\"port\":4369,\"protocol\":\"TCP\"}":{".":{},"f:name":{},"f:port":{},"f:protocol":{},"f:targetPort":{}},"k:{\"port\":25672,\"protocol\":\"TCP\"}":{".":{},"f:name":{},"f:port":{},"f:protocol":{},"f:targetPort":{}}},"f:publishNotReadyAddresses":{},"f:selector":{".":{},"f:app.kubernetes.io/name":{}},"f:sessionAffinity":{},"f:type":{}}}}]},"spec":{"ports":[{"name":"epmd","protocol":"TCP","port":4369,"targetPort":4369},{"name":"cluster-rpc","protocol":"TCP","port":25672,"targetPort":25672}],"selector":{"app.kubernetes.io/name":"rabbitmq-cluster"},"clusterIP":"None","type":"ClusterIP","sessionAffinity":"None","publishNotReadyAddresses":true},"status":{"loadBalancer":{}}}
2022/03/18 18:07:23 learn_server.go:291: [SIEVE-AFTER-READ]	Get	true	service	default	rabbitmq-cluster	github.com/rabbitmq/cluster-operator/controllers.(*RabbitmqClusterReconciler)	NoError	{"kind":"Service","apiVersion":"v1","metadata":{"name":"rabbitmq-cluster","namespace":"default","selfLink":"/api/v1/namespaces/default/services/rabbitmq-cluster","uid":"ae846a70-784e-49ca-99a0-2b0cefb93b46","resourceVersion":"1085","creationTimestamp":"2022-03-18T18:06:25Z","labels":{"app.kubernetes.io/component":"rabbitmq","app.kubernetes.io/name":"rabbitmq-cluster","app.kubernetes.io/part-of":"rabbitmq"},"ownerReferences":[{"apiVersion":"rabbitmq.com/v1beta1","kind":"RabbitmqCluster","name":"rabbitmq-cluster","uid":"3ecefa8a-1bec-48a7-9af4-dd0df3339101","controller":true,"blockOwnerDeletion":true}],"managedFields":[{"manager":"manager","operation":"Update","apiVersion":"v1","time":"2022-03-18T18:06:25Z","fieldsType":"FieldsV1","fieldsV1":{"f:metadata":{"f:labels":{".":{},"f:app.kubernetes.io/component":{},"f:app.kubernetes.io/name":{},"f:app.kubernetes.io/part-of":{}},"f:ownerReferences":{".":{},"k:{\"uid\":\"3ecefa8a-1bec-48a7-9af4-dd0df3339101\"}":{".":{},"f:apiVersion":{},"f:blockOwnerDeletion":{},"f:controller":{},"f:kind":{},"f:name":{},"f:uid":{}}}},"f:spec":{"f:ports":{".":{},"k:{\"port\":5672,\"protocol\":\"TCP\"}":{".":{},"f:name":{},"f:port":{},"f:protocol":{},"f:targetPort":{}},"k:{\"port\":15672,\"protocol\":\"TCP\"}":{".":{},"f:name":{},"f:port":{},"f:protocol":{},"f:targetPort":{}}},"f:selector":{".":{},"f:app.kubernetes.io/name":{}},"f:sessionAffinity":{},"f:type":{}}}}]},"spec":{"ports":[{"name":"amqp","protocol":"TCP","port":5672,"targetPort":5672},{"name":"management","protocol":"TCP","port":15672,"targetPort":15672}],"selector":{"app.kubernetes.io/name":"rabbitmq-cluster"},"clusterIP":"10.96.47.189","type":"ClusterIP","sessionAffinity":"None"},"status":{"loadBalancer":{}}}
2022/03/18 18:07:23 learn_server.go:291: [SIEVE-AFTER-READ]	Get	true	secret	default	rabbitmq-cluster-erlang-cookie	github.com/rabbitmq/cluster-operator/controllers.(*RabbitmqClusterReconciler)	NoError	{"kind":"Secret","apiVersion":"v1","metadata":{"name":"rabbitmq-cluster-erlang-cookie","namespace":"default","selfLink":"/api/v1/namespaces/default/secrets/rabbitmq-cluster-erlang-cookie","uid":"01d8d8ad-080a-4c3f-9d27-56616c53dd26","resourceVersion":"1088","creationTimestamp":"2022-03-18T18:06:25Z","labels":{"app.kubernetes.io/component":"rabbitmq","app.kubernetes.io/name":"rabbitmq-cluster","app.kubernetes.io/part-of":"rabbitmq"},"ownerReferences":[{"apiVersion":"rabbitmq.com/v1beta1","kind":"RabbitmqCluster","name":"rabbitmq-cluster","uid":"3ecefa8a-1bec-48a7-9af4-dd0df3339101","controller":true,"blockOwnerDeletion":true}],"managedFields":[{"manager":"manager","operation":"Update","apiVersion":"v1","time":"2022-03-18T18:06:25Z","fieldsType":"FieldsV1","fieldsV1":{"f:data":{".":{},"f:.erlang.cookie":{}},"f:metadata":{"f:labels":{".":{},"f:app.kubernetes.io/component":{},"f:app.kubernetes.io/name":{},"f:app.kubernetes.io/part-of":{}},"f:ownerReferences":{".":{},"k:{\"uid\":\"3ecefa8a-1bec-48a7-9af4-dd0df3339101\"}":{".":{},"f:apiVersion":{},"f:blockOwnerDeletion":{},"f:controller":{},"f:kind":{},"f:name":{},"f:uid":{}}}},"f:type":{}}}]},"data":{".erlang.cookie":"ajdscUtLdnBpR1NwUUMwc1V3a2VyTlJxU2tVUTdBeEw="},"type":"Opaque"}
2022/03/18 18:07:23 learn_server.go:291: [SIEVE-AFTER-READ]	Get	true	secret	default	rabbitmq-cluster-default-user	github.com/rabbitmq/cluster-operator/controllers.(*RabbitmqClusterReconciler)	NoError	{"kind":"Secret","apiVersion":"v1","metadata":{"name":"rabbitmq-cluster-default-user","namespace":"default","selfLink":"/api/v1/namespaces/default/secrets/rabbitmq-cluster-default-user","uid":"b2f5a936-e51f-4488-b6e9-ca23e4d95ac2","resourceVersion":"1091","creationTimestamp":"2022-03-18T18:06:25Z","labels":{"app.kubernetes.io/component":"rabbitmq","app.kubernetes.io/name":"rabbitmq-cluster","app.kubernetes.io/part-of":"rabbitmq"},"ownerReferences":[{"apiVersion":"rabbitmq.com/v1beta1","kind":"RabbitmqCluster","name":"rabbitmq-cluster","uid":"3ecefa8a-1bec-48a7-9af4-dd0df3339101","controller":true,"blockOwnerDeletion":true}],"managedFields":[{"manager":"manager","operation":"Update","apiVersion":"v1","time":"2022-03-18T18:06:25Z","fieldsType":"FieldsV1","fieldsV1":{"f:data":{".":{},"f:default_user.conf":{},"f:password":{},"f:provider":{},"f:type":{},"f:username":{}},"f:metadata":{"f:labels":{".":{},"f:app.kubernetes.io/component":{},"f:app.kubernetes.io/name":{},"f:app.kubernetes.io/part-of":{}},"f:ownerReferences":{".":{},"k:{\"uid\":\"3ecefa8a-1bec-48a7-9af4-dd0df3339101\"}":{".":{},"f:apiVersion":{},"f:blockOwnerDeletion":{},"f:controller":{},"f:kind":{},"f:name":{},"f:uid":{}}}},"f:type":{}}}]},"data":{"default_user.conf":"ZGVmYXVsdF91c2VyID0gdEFMN1otZTgzR29ocEtsZ0Z4cUFFV3ZXemEtcjdJQW8KZGVmYXVsdF9wYXNzID0gdXVocndkTkdOcmJXQ2p6NFZPX0NUZE9OYURkSUpoRkoK","password":"dXVocndkTkdOcmJXQ2p6NFZPX0NUZE9OYURkSUpoRko=","provider":"cmFiYml0bXE=","type":"cmFiYml0bXE=","username":"dEFMN1otZTgzR29ocEtsZ0Z4cUFFV3ZXemEtcjdJQW8="},"type":"Opaque"}
2022/03/18 18:07:23 learn_server.go:291: [SIEVE-AFTER-READ]	Get	true	configmap	default	rabbitmq-cluster-plugins-conf	github.com/rabbitmq/cluster-operator/controllers.(*RabbitmqClusterReconciler)	NoError	{"kind":"ConfigMap","apiVersion":"v1","metadata":{"name":"rabbitmq-cluster-plugins-conf","namespace":"default","selfLink":"/api/v1/namespaces/default/configmaps/rabbitmq-cluster-plugins-conf","uid":"0aa26eb6-ff3a-4457-a223-284c897db7fe","resourceVersion":"1092","creationTimestamp":"2022-03-18T18:06:25Z","labels":{"app.kubernetes.io/component":"rabbitmq","app.kubernetes.io/name":"rabbitmq-cluster","app.kubernetes.io/part-of":"rabbitmq"},"ownerReferences":[{"apiVersion":"rabbitmq.com/v1beta1","kind":"RabbitmqCluster","name":"rabbitmq-cluster","uid":"3ecefa8a-1bec-48a7-9af4-dd0df3339101","controller":true,"blockOwnerDeletion":true}],"managedFields":[{"manager":"manager","operation":"Update","apiVersion":"v1","time":"2022-03-18T18:06:25Z","fieldsType":"FieldsV1","fieldsV1":{"f:data":{".":{},"f:enabled_plugins":{}},"f:metadata":{"f:labels":{".":{},"f:app.kubernetes.io/component":{},"f:app.kubernetes.io/name":{},"f:app.kubernetes.io/part-of":{}},"f:ownerReferences":{".":{},"k:{\"uid\":\"3ecefa8a-1bec-48a7-9af4-dd0df3339101\"}":{".":{},"f:apiVersion":{},"f:blockOwnerDeletion":{},"f:controller":{},"f:kind":{},"f:name":{},"f:uid":{}}}}}}]},"data":{"enabled_plugins":"[rabbitmq_peer_discovery_k8s,rabbitmq_prometheus,rabbitmq_management]."}}
2022/03/18 18:07:23 learn_server.go:291: [SIEVE-AFTER-READ]	Get	true	configmap	default	rabbitmq-cluster-server-conf	github.com/rabbitmq/cluster-operator/controllers.(*RabbitmqClusterReconciler)	NoError	{"kind":"ConfigMap","apiVersion":"v1","metadata":{"name":"rabbitmq-cluster-server-conf","namespace":"default","selfLink":"/api/v1/namespaces/default/configmaps/rabbitmq-cluster-server-conf","uid":"e4182078-d429-4baf-9021-72618c509ac5","resourceVersion":"1095","creationTimestamp":"2022-03-18T18:06:25Z","labels":{"app.kubernetes.io/component":"rabbitmq","app.kubernetes.io/name":"rabbitmq-cluster","app.kubernetes.io/part-of":"rabbitmq"},"ownerReferences":[{"apiVersion":"rabbitmq.com/v1beta1","kind":"RabbitmqCluster","name":"rabbitmq-cluster","uid":"3ecefa8a-1bec-48a7-9af4-dd0df3339101","controller":true,"blockOwnerDeletion":true}],"managedFields":[{"manager":"manager","operation":"Update","apiVersion":"v1","time":"2022-03-18T18:06:25Z","fieldsType":"FieldsV1","fieldsV1":{"f:data":{".":{},"f:operatorDefaults.conf":{},"f:userDefinedConfiguration.conf":{}},"f:metadata":{"f:labels":{".":{},"f:app.kubernetes.io/component":{},"f:app.kubernetes.io/name":{},"f:app.kubernetes.io/part-of":{}},"f:ownerReferences":{".":{},"k:{\"uid\":\"3ecefa8a-1bec-48a7-9af4-dd0df3339101\"}":{".":{},"f:apiVersion":{},"f:blockOwnerDeletion":{},"f:controller":{},"f:kind":{},"f:name":{},"f:uid":{}}}}}}]},"data":{"operatorDefaults.conf":"cluster_formation.peer_discovery_backend             = rabbit_peer_discovery_k8s\ncluster_formation.k8s.host                           = kubernetes.default\ncluster_formation.k8s.address_type                   = hostname\ncluster_partition_handling                           = pause_minority\nqueue_master_locator                                 = min-masters\ndisk_free_limit.absolute                             = 2GB\ncluster_formation.randomized_startup_delay_range.min = 5\ncluster_formation.randomized_startup_delay_range.max = 30\ncluster_name                                         = rabbitmq-cluster\n","userDefinedConfiguration.conf":"total_memory_available_override_value = 1717986919\n"}}
2022/03/18 18:07:23 learn_server.go:291: [SIEVE-AFTER-READ]	Get	true	serviceaccount	default	rabbitmq-cluster-server	github.com/rabbitmq/cluster-operator/controllers.(*RabbitmqClusterReconciler)	NoError	{"kind":"ServiceAccount","apiVersion":"v1","metadata":{"name":"rabbitmq-cluster-server","namespace":"default","selfLink":"/api/v1/namespaces/default/serviceaccounts/rabbitmq-cluster-server","uid":"0c3cead0-37dd-452b-b939-fe346a5dfdea","resourceVersion":"1102","creationTimestamp":"2022-03-18T18:06:25Z","labels":{"app.kubernetes.io/component":"rabbitmq","app.kubernetes.io/name":"rabbitmq-cluster","app.kubernetes.io/part-of":"rabbitmq"},"ownerReferences":[{"apiVersion":"rabbitmq.com/v1beta1","kind":"RabbitmqCluster","name":"rabbitmq-cluster","uid":"3ecefa8a-1bec-48a7-9af4-dd0df3339101","controller":true,"blockOwnerDeletion":true}],"managedFields":[{"manager":"kube-controller-manager","operation":"Update","apiVersion":"v1","time":"2022-03-18T18:06:25Z","fieldsType":"FieldsV1","fieldsV1":{"f:secrets":{".":{},"k:{\"name\":\"rabbitmq-cluster-server-token-v4wpv\"}":{".":{},"f:name":{}}}}},{"manager":"manager","operation":"Update","apiVersion":"v1","time":"2022-03-18T18:06:25Z","fieldsType":"FieldsV1","fieldsV1":{"f:metadata":{"f:labels":{".":{},"f:app.kubernetes.io/component":{},"f:app.kubernetes.io/name":{},"f:app.kubernetes.io/part-of":{}},"f:ownerReferences":{".":{},"k:{\"uid\":\"3ecefa8a-1bec-48a7-9af4-dd0df3339101\"}":{".":{},"f:apiVersion":{},"f:blockOwnerDeletion":{},"f:controller":{},"f:kind":{},"f:name":{},"f:uid":{}}}}}}]},"secrets":[{"name":"rabbitmq-cluster-server-token-v4wpv"}]}
2022/03/18 18:07:23 learn_server.go:291: [SIEVE-AFTER-READ]	Get	true	role	default	rabbitmq-cluster-peer-discovery	github.com/rabbitmq/cluster-operator/controllers.(*RabbitmqClusterReconciler)	NoError	{"kind":"Role","apiVersion":"rbac.authorization.k8s.io/v1","metadata":{"name":"rabbitmq-cluster-peer-discovery","namespace":"default","selfLink":"/apis/rbac.authorization.k8s.io/v1/namespaces/default/roles/rabbitmq-cluster-peer-discovery","uid":"ec9ac474-1880-43ed-af46-9ea5f46d6db4","resourceVersion":"1103","creationTimestamp":"2022-03-18T18:06:25Z","labels":{"app.kubernetes.io/component":"rabbitmq","app.kubernetes.io/name":"rabbitmq-cluster","app.kubernetes.io/part-of":"rabbitmq"},"ownerReferences":[{"apiVersion":"rabbitmq.com/v1beta1","kind":"RabbitmqCluster","name":"rabbitmq-cluster","uid":"3ecefa8a-1bec-48a7-9af4-dd0df3339101","controller":true,"blockOwnerDeletion":true}],"managedFields":[{"manager":"manager","operation":"Update","apiVersion":"rbac.authorization.k8s.io/v1","time":"2022-03-18T18:06:25Z","fieldsType":"FieldsV1","fieldsV1":{"f:metadata":{"f:labels":{".":{},"f:app.kubernetes.io/component":{},"f:app.kubernetes.io/name":{},"f:app.kubernetes.io/part-of":{}},"f:ownerReferences":{".":{},"k:{\"uid\":\"3ecefa8a-1bec-48a7-9af4-dd0df3339101\"}":{".":{},"f:apiVersion":{},"f:blockOwnerDeletion":{},"f:controller":{},"f:kind":{},"f:name":{},"f:uid":{}}}},"f:rules":{}}}]},"rules":[{"verbs":["get"],"apiGroups":[""],"resources":["endpoints"]},{"verbs":["create"],"apiGroups":[""],"resources":["events"]}]}
2022/03/18 18:07:23 learn_server.go:291: [SIEVE-AFTER-READ]	Get	true	rolebinding	default	rabbitmq-cluster-server	github.com/rabbitmq/cluster-operator/controllers.(*RabbitmqClusterReconciler)	NoError	{"kind":"RoleBinding","apiVersion":"rbac.authorization.k8s.io/v1","metadata":{"name":"rabbitmq-cluster-server","namespace":"default","selfLink":"/apis/rbac.authorization.k8s.io/v1/namespaces/default/rolebindings/rabbitmq-cluster-server","uid":"fe69a41c-8d28-4b84-a9f6-a9e6044d75ba","resourceVersion":"1105","creationTimestamp":"2022-03-18T18:06:25Z","labels":{"app.kubernetes.io/component":"rabbitmq","app.kubernetes.io/name":"rabbitmq-cluster","app.kubernetes.io/part-of":"rabbitmq"},"ownerReferences":[{"apiVersion":"rabbitmq.com/v1beta1","kind":"RabbitmqCluster","name":"rabbitmq-cluster","uid":"3ecefa8a-1bec-48a7-9af4-dd0df3339101","controller":true,"blockOwnerDeletion":true}],"managedFields":[{"manager":"manager","operation":"Update","apiVersion":"rbac.authorization.k8s.io/v1","time":"2022-03-18T18:06:25Z","fieldsType":"FieldsV1","fieldsV1":{"f:metadata":{"f:labels":{".":{},"f:app.kubernetes.io/component":{},"f:app.kubernetes.io/name":{},"f:app.kubernetes.io/part-of":{}},"f:ownerReferences":{".":{},"k:{\"uid\":\"3ecefa8a-1bec-48a7-9af4-dd0df3339101\"}":{".":{},"f:apiVersion":{},"f:blockOwnerDeletion":{},"f:controller":{},"f:kind":{},"f:name":{},"f:uid":{}}}},"f:roleRef":{"f:apiGroup":{},"f:kind":{},"f:name":{}},"f:subjects":{}}}]},"subjects":[{"kind":"ServiceAccount","name":"rabbitmq-cluster-server"}],"roleRef":{"apiGroup":"rbac.authorization.k8s.io","kind":"Role","name":"rabbitmq-cluster-peer-discovery"}}
2022/03/18 18:07:23 learn_server.go:291: [SIEVE-AFTER-READ]	Get	true	statefulset	default	rabbitmq-cluster-server	github.com/rabbitmq/cluster-operator/controllers.(*RabbitmqClusterReconciler)	NoError	{"kind":"StatefulSet","apiVersion":"apps/v1","metadata":{"name":"rabbitmq-cluster-server","namespace":"default","selfLink":"/apis/apps/v1/namespaces/default/statefulsets/rabbitmq-cluster-server","uid":"f2f07f3e-b500-4c48-a5de-8db7eaf37b9a","resourceVersion":"1404","generation":1,"creationTimestamp":"2022-03-18T18:06:25Z","labels":{"app.kubernetes.io/component":"rabbitmq","app.kubernetes.io/name":"rabbitmq-cluster","app.kubernetes.io/part-of":"rabbitmq"},"annotations":{"rabbitmq.com/createdAt":"2022-03-18T18:06:25Z"},"ownerReferences":[{"apiVersion":"rabbitmq.com/v1beta1","kind":"RabbitmqCluster","name":"rabbitmq-cluster","uid":"3ecefa8a-1bec-48a7-9af4-dd0df3339101","controller":true,"blockOwnerDeletion":true}],"managedFields":[{"manager":"manager","operation":"Update","apiVersion":"apps/v1","time":"2022-03-18T18:06:25Z","fieldsType":"FieldsV1","fieldsV1":{"f:metadata":{"f:annotations":{".":{},"f:rabbitmq.com/createdAt":{}},"f:labels":{".":{},"f:app.kubernetes.io/component":{},"f:app.kubernetes.io/name":{},"f:app.kubernetes.io/part-of":{}},"f:ownerReferences":{".":{},"k:{\"uid\":\"3ecefa8a-1bec-48a7-9af4-dd0df3339101\"}":{".":{},"f:apiVersion":{},"f:blockOwnerDeletion":{},"f:controller":{},"f:kind":{},"f:name":{},"f:uid":{}}}},"f:spec":{"f:podManagementPolicy":{},"f:replicas":{},"f:revisionHistoryLimit":{},"f:selector":{"f:matchLabels":{".":{},"f:app.kubernetes.io/name":{}}},"f:serviceName":{},"f:template":{"f:metadata":{"f:annotations":{".":{},"f:prometheus.io/port":{},"f:prometheus.io/scrape":{}},"f:labels":{".":{},"f:app.kubernetes.io/component":{},"f:app.kubernetes.io/name":{},"f:app.kubernetes.io/part-of":{}}},"f:spec":{"f:automountServiceAccountToken":{},"f:containers":{"k:{\"name\":\"rabbitmq\"}":{".":{},"f:env":{".":{},"k:{\"name\":\"K8S_HOSTNAME_SUFFIX\"}":{".":{},"f:name":{},"f:value":{}},"k:{\"name\":\"K8S_SERVICE_NAME\"}":{".":{},"f:name":{},"f:value":{}},"k:{\"name\":\"MY_POD_NAME\"}":{".":{},"f:name":{},"f:valueFrom":{".":{},"f:fieldRef":{".":{},"f:apiVersion":{},"f:fieldPath":{}}}},"k:{\"name\":\"MY_POD_NAMESPACE\"}":{".":{},"f:name":{},"f:valueFrom":{".":{},"f:fieldRef":{".":{},"f:apiVersion":{},"f:fieldPath":{}}}},"k:{\"name\":\"RABBITMQ_ENABLED_PLUGINS_FILE\"}":{".":{},"f:name":{},"f:value":{}},"k:{\"name\":\"RABBITMQ_NODENAME\"}":{".":{},"f:name":{},"f:value":{}},"k:{\"name\":\"RABBITMQ_USE_LONGNAME\"}":{".":{},"f:name":{},"f:value":{}}},"f:image":{},"f:imagePullPolicy":{},"f:lifecycle":{".":{},"f:preStop":{".":{},"f:exec":{".":{},"f:command":{}}}},"f:name":{},"f:ports":{".":{},"k:{\"containerPort\":4369,\"protocol\":\"TCP\"}":{".":{},"f:containerPort":{},"f:name":{},"f:protocol":{}},"k:{\"containerPort\":5672,\"protocol\":\"TCP\"}":{".":{},"f:containerPort":{},"f:name":{},"f:protocol":{}},"k:{\"containerPort\":15672,\"protocol\":\"TCP\"}":{".":{},"f:containerPort":{},"f:name":{},"f:protocol":{}},"k:{\"containerPort\":15692,\"protocol\":\"TCP\"}":{".":{},"f:containerPort":{},"f:name":{},"f:protocol":{}}},"f:readinessProbe":{".":{},"f:failureThreshold":{},"f:initialDelaySeconds":{},"f:periodSeconds":{},"f:successThreshold":{},"f:tcpSocket":{".":{},"f:port":{}},"f:timeoutSeconds":{}},"f:resources":{".":{},"f:limits":{".":{},"f:cpu":{},"f:memory":{}},"f:requests":{".":{},"f:cpu":{},"f:memory":{}}},"f:terminationMessagePath":{},"f:terminationMessagePolicy":{},"f:volumeMounts":{".":{},"k:{\"mountPath\":\"/etc/pod-info/\"}":{".":{},"f:mountPath":{},"f:name":{}},"k:{\"mountPath\":\"/etc/rabbitmq/conf.d/10-operatorDefaults.conf\"}":{".":{},"f:mountPath":{},"f:name":{},"f:subPath":{}},"k:{\"mountPath\":\"/etc/rabbitmq/conf.d/11-default_user.conf\"}":{".":{},"f:mountPath":{},"f:name":{},"f:subPath":{}},"k:{\"mountPath\":\"/etc/rabbitmq/conf.d/90-userDefinedConfiguration.conf\"}":{".":{},"f:mountPath":{},"f:name":{},"f:subPath":{}},"k:{\"mountPath\":\"/operator\"}":{".":{},"f:mountPath":{},"f:name":{}},"k:{\"mountPath\":\"/var/lib/rabbitmq/\"}":{".":{},"f:mountPath":{},"f:name":{}},"k:{\"mountPath\":\"/var/lib/rabbitmq/mnesia/\"}":{".":{},"f:mountPath":{},"f:name":{}}}}},"f:dnsPolicy":{},"f:initContainers":{".":{},"k:{\"name\":\"setup-container\"}":{".":{},"f:command":{},"f:image":{},"f:imagePullPolicy":{},"f:name":{},"f:resources":{".":{},"f:limits":{".":{},"f:cpu":{},"f:memory":{}},"f:requests":{".":{},"f:cpu":{},"f:memory":{}}},"f:securityContext":{".":{},"f:capabilities":{".":{},"f:drop":{}},"f:runAsUser":{}},"f:terminationMessagePath":{},"f:terminationMessagePolicy":{},"f:volumeMounts":{".":{},"k:{\"mountPath\":\"/operator\"}":{".":{},"f:mountPath":{},"f:name":{}},"k:{\"mountPath\":\"/tmp/default_user.conf\"}":{".":{},"f:mountPath":{},"f:name":{},"f:subPath":{}},"k:{\"mountPath\":\"/tmp/erlang-cookie-secret/\"}":{".":{},"f:mountPath":{},"f:name":{}},"k:{\"mountPath\":\"/tmp/rabbitmq-plugins/\"}":{".":{},"f:mountPath":{},"f:name":{}},"k:{\"mountPath\":\"/var/lib/rabbitmq/\"}":{".":{},"f:mountPath":{},"f:name":{}},"k:{\"mountPath\":\"/var/lib/rabbitmq/mnesia/\"}":{".":{},"f:mountPath":{},"f:name":{}}}}},"f:restartPolicy":{},"f:schedulerName":{},"f:securityContext":{".":{},"f:fsGroup":{},"f:runAsGroup":{},"f:runAsUser":{}},"f:serviceAccount":{},"f:serviceAccountName":{},"f:terminationGracePeriodSeconds":{},"f:topologySpreadConstraints":{".":{},"k:{\"topologyKey\":\"topology.kubernetes.io/zone\",\"whenUnsatisfiable\":\"ScheduleAnyway\"}":{".":{},"f:labelSelector":{".":{},"f:matchLabels":{".":{},"f:app.kubernetes.io/name":{}}},"f:maxSkew":{},"f:topologyKey":{},"f:whenUnsatisfiable":{}}},"f:volumes":{".":{},"k:{\"name\":\"erlang-cookie-secret\"}":{".":{},"f:name":{},"f:secret":{".":{},"f:defaultMode":{},"f:secretName":{}}},"k:{\"name\":\"plugins-conf\"}":{".":{},"f:configMap":{".":{},"f:defaultMode":{},"f:name":{}},"f:name":{}},"k:{\"name\":\"pod-info\"}":{".":{},"f:downwardAPI":{".":{},"f:defaultMode":{},"f:items":{}},"f:name":{}},"k:{\"name\":\"rabbitmq-confd\"}":{".":{},"f:name":{},"f:projected":{".":{},"f:defaultMode":{},"f:sources":{}}},"k:{\"name\":\"rabbitmq-erlang-cookie\"}":{".":{},"f:emptyDir":{},"f:name":{}},"k:{\"name\":\"rabbitmq-plugins\"}":{".":{},"f:emptyDir":{},"f:name":{}}}}},"f:updateStrategy":{"f:rollingUpdate":{".":{},"f:partition":{}},"f:type":{}},"f:volumeClaimTemplates":{}}}},{"manager":"kube-controller-manager","operation":"Update","apiVersion":"apps/v1","time":"2022-03-18T18:07:23Z","fieldsType":"FieldsV1","fieldsV1":{"f:status":{"f:collisionCount":{},"f:currentReplicas":{},"f:currentRevision":{},"f:observedGeneration":{},"f:readyReplicas":{},"f:replicas":{},"f:updateRevision":{},"f:updatedReplicas":{}}}}]},"spec":{"replicas":1,"selector":{"matchLabels":{"app.kubernetes.io/name":"rabbitmq-cluster"}},"template":{"metadata":{"creationTimestamp":null,"labels":{"app.kubernetes.io/component":"rabbitmq","app.kubernetes.io/name":"rabbitmq-cluster","app.kubernetes.io/part-of":"rabbitmq"},"annotations":{"prometheus.io/port":"15692","prometheus.io/scrape":"true"}},"spec":{"volumes":[{"name":"plugins-conf","configMap":{"name":"rabbitmq-cluster-plugins-conf","defaultMode":420}},{"name":"rabbitmq-confd","projected":{"sources":[{"secret":{"name":"rabbitmq-cluster-default-user","items":[{"key":"default_user.conf","path":"default_user.conf"}]}},{"configMap":{"name":"rabbitmq-cluster-server-conf","items":[{"key":"operatorDefaults.conf","path":"operatorDefaults.conf"},{"key":"userDefinedConfiguration.conf","path":"userDefinedConfiguration.conf"}]}}],"defaultMode":420}},{"name":"rabbitmq-erlang-cookie","emptyDir":{}},{"name":"erlang-cookie-secret","secret":{"secretName":"rabbitmq-cluster-erlang-cookie","defaultMode":420}},{"name":"rabbitmq-plugins","emptyDir":{}},{"name":"pod-info","downwardAPI":{"items":[{"path":"skipPreStopChecks","fieldRef":{"apiVersion":"v1","fieldPath":"metadata.labels['skipPreStopChecks']"}}],"defaultMode":420}}],"initContainers":[{"name":"setup-container","image":"rabbitmq:3.8.12-management","command":["sh","-c","cp /tmp/erlang-cookie-secret/.erlang.cookie /var/lib/rabbitmq/.erlang.cookie \u0026\u0026 chown 999:999 /var/lib/rabbitmq/.erlang.cookie \u0026\u0026 chmod 600 /var/lib/rabbitmq/.erlang.cookie ; cp /tmp/rabbitmq-plugins/enabled_plugins /operator/enabled_plugins \u0026\u0026 chown 999:999 /operator/enabled_plugins ; chown 999:999 /var/lib/rabbitmq/mnesia/ ; echo '[default]' \u003e /var/lib/rabbitmq/.rabbitmqadmin.conf \u0026\u0026 sed -e 's/default_user/username/' -e 's/default_pass/password/' /tmp/default_user.conf \u003e\u003e /var/lib/rabbitmq/.rabbitmqadmin.conf \u0026\u0026 chown 999:999 /var/lib/rabbitmq/.rabbitmqadmin.conf \u0026\u0026 chmod 600 /var/lib/rabbitmq/.rabbitmqadmin.conf"],"resources":{"limits":{"cpu":"100m","memory":"500Mi"},"requests":{"cpu":"100m","memory":"500Mi"}},"volumeMounts":[{"name":"plugins-conf","mountPath":"/tmp/rabbitmq-plugins/"},{"name":"rabbitmq-erlang-cookie","mountPath":"/var/lib/rabbitmq/"},{"name":"erlang-cookie-secret","mountPath":"/tmp/erlang-cookie-secret/"},{"name":"rabbitmq-plugins","mountPath":"/operator"},{"name":"persistence","mountPath":"/var/lib/rabbitmq/mnesia/"},{"name":"rabbitmq-confd","mountPath":"/tmp/default_user.conf","subPath":"default_user.conf"}],"terminationMessagePath":"/dev/termination-log","terminationMessagePolicy":"File","imagePullPolicy":"IfNotPresent","securityContext":{"capabilities":{"drop":["FSETID","KILL","SETGID","SETUID","SETPCAP","NET_BIND_SERVICE","NET_RAW","SYS_CHROOT","MKNOD","AUDIT_WRITE","SETFCAP"]},"runAsUser":0}}],"containers":[{"name":"rabbitmq","image":"rabbitmq:3.8.12-management","ports":[{"name":"epmd","containerPort":4369,"protocol":"TCP"},{"name":"amqp","containerPort":5672,"protocol":"TCP"},{"name":"management","containerPort":15672,"protocol":"TCP"},{"name":"prometheus","containerPort":15692,"protocol":"TCP"}],"env":[{"name":"MY_POD_NAME","valueFrom":{"fieldRef":{"apiVersion":"v1","fieldPath":"metadata.name"}}},{"name":"MY_POD_NAMESPACE","valueFrom":{"fieldRef":{"apiVersion":"v1","fieldPath":"metadata.namespace"}}},{"name":"RABBITMQ_ENABLED_PLUGINS_FILE","value":"/operator/enabled_plugins"},{"name":"K8S_SERVICE_NAME","value":"rabbitmq-cluster-nodes"},{"name":"RABBITMQ_USE_LONGNAME","value":"true"},{"name":"RABBITMQ_NODENAME","value":"rabbit@$(MY_POD_NAME).$(K8S_SERVICE_NAME).$(MY_POD_NAMESPACE)"},{"name":"K8S_HOSTNAME_SUFFIX","value":".$(K8S_SERVICE_NAME).$(MY_POD_NAMESPACE)"}],"resources":{"limits":{"cpu":"2","memory":"2Gi"},"requests":{"cpu":"1","memory":"2Gi"}},"volumeMounts":[{"name":"rabbitmq-erlang-cookie","mountPath":"/var/lib/rabbitmq/"},{"name":"persistence","mountPath":"/var/lib/rabbitmq/mnesia/"},{"name":"rabbitmq-plugins","mountPath":"/operator"},{"name":"rabbitmq-confd","mountPath":"/etc/rabbitmq/conf.d/10-operatorDefaults.conf","subPath":"operatorDefaults.conf"},{"name":"rabbitmq-confd","mountPath":"/etc/rabbitmq/conf.d/11-default_user.conf","subPath":"default_user.conf"},{"name":"rabbitmq-confd","mountPath":"/etc/rabbitmq/conf.d/90-userDefinedConfiguration.conf","subPath":"userDefinedConfiguration.conf"},{"name":"pod-info","mountPath":"/etc/pod-info/"}],"readinessProbe":{"tcpSocket":{"port":"amqp"},"initialDelaySeconds":10,"timeoutSeconds":5,"periodSeconds":10,"successThreshold":1,"failureThreshold":3},"lifecycle":{"preStop":{"exec":{"command":["/bin/bash","-c","if [ ! -z \"$(cat /etc/pod-info/skipPreStopChecks)\" ]; then exit 0; fi; rabbitmq-upgrade await_online_quorum_plus_one -t 604800; rabbitmq-upgrade await_online_synchronized_mirror -t 604800; rabbitmq-upgrade drain -t 604800"]}}},"terminationMessagePath":"/dev/termination-log","terminationMessagePolicy":"File","imagePullPolicy":"IfNotPresent"}],"restartPolicy":"Always","terminationGracePeriodSeconds":604800,"dnsPolicy":"ClusterFirst","serviceAccountName":"rabbitmq-cluster-server","serviceAccount":"rabbitmq-cluster-server","automountServiceAccountToken":true,"securityContext":{"runAsUser":999,"runAsGroup":999,"fsGroup":999},"schedulerName":"default-scheduler","topologySpreadConstraints":[{"maxSkew":1,"topologyKey":"topology.kubernetes.io/zone","whenUnsatisfiable":"ScheduleAnyway","labelSelector":{"matchLabels":{"app.kubernetes.io/name":"rabbitmq-cluster"}}}]}},"volumeClaimTemplates":[{"metadata":{"name":"persistence","namespace":"default","creationTimestamp":null,"labels":{"app.kubernetes.io/component":"rabbitmq","app.kubernetes.io/name":"rabbitmq-cluster","app.kubernetes.io/part-of":"rabbitmq"},"ownerReferences":[{"apiVersion":"rabbitmq.com/v1beta1","kind":"RabbitmqCluster","name":"rabbitmq-cluster","uid":"3ecefa8a-1bec-48a7-9af4-dd0df3339101","controller":true,"blockOwnerDeletion":false}]},"spec":{"accessModes":["ReadWriteOnce"],"resources":{"requests":{"storage":"10Gi"}},"volumeMode":"Filesystem"},"status":{"phase":"Pending"}}],"serviceName":"rabbitmq-cluster-nodes","podManagementPolicy":"Parallel","updateStrategy":{"type":"RollingUpdate","rollingUpdate":{"partition":0}},"revisionHistoryLimit":10},"status":{"observedGeneration":1,"replicas":1,"readyReplicas":1,"currentReplicas":1,"updatedReplicas":1,"currentRevision":"rabbitmq-cluster-server-5f8b8665fb","updateRevision":"rabbitmq-cluster-server-5f8b8665fb","collisionCount":0}}
2022/03/18 18:07:23 learn_server.go:291: [SIEVE-AFTER-READ]	Get	true	statefulset	default	rabbitmq-cluster-server	github.com/rabbitmq/cluster-operator/controllers.(*RabbitmqClusterReconciler)	NoError	{"kind":"StatefulSet","apiVersion":"apps/v1","metadata":{"name":"rabbitmq-cluster-server","namespace":"default","selfLink":"/apis/apps/v1/namespaces/default/statefulsets/rabbitmq-cluster-server","uid":"f2f07f3e-b500-4c48-a5de-8db7eaf37b9a","resourceVersion":"1404","generation":1,"creationTimestamp":"2022-03-18T18:06:25Z","labels":{"app.kubernetes.io/component":"rabbitmq","app.kubernetes.io/name":"rabbitmq-cluster","app.kubernetes.io/part-of":"rabbitmq"},"annotations":{"rabbitmq.com/createdAt":"2022-03-18T18:06:25Z"},"ownerReferences":[{"apiVersion":"rabbitmq.com/v1beta1","kind":"RabbitmqCluster","name":"rabbitmq-cluster","uid":"3ecefa8a-1bec-48a7-9af4-dd0df3339101","controller":true,"blockOwnerDeletion":true}],"managedFields":[{"manager":"manager","operation":"Update","apiVersion":"apps/v1","time":"2022-03-18T18:06:25Z","fieldsType":"FieldsV1","fieldsV1":{"f:metadata":{"f:annotations":{".":{},"f:rabbitmq.com/createdAt":{}},"f:labels":{".":{},"f:app.kubernetes.io/component":{},"f:app.kubernetes.io/name":{},"f:app.kubernetes.io/part-of":{}},"f:ownerReferences":{".":{},"k:{\"uid\":\"3ecefa8a-1bec-48a7-9af4-dd0df3339101\"}":{".":{},"f:apiVersion":{},"f:blockOwnerDeletion":{},"f:controller":{},"f:kind":{},"f:name":{},"f:uid":{}}}},"f:spec":{"f:podManagementPolicy":{},"f:replicas":{},"f:revisionHistoryLimit":{},"f:selector":{"f:matchLabels":{".":{},"f:app.kubernetes.io/name":{}}},"f:serviceName":{},"f:template":{"f:metadata":{"f:annotations":{".":{},"f:prometheus.io/port":{},"f:prometheus.io/scrape":{}},"f:labels":{".":{},"f:app.kubernetes.io/component":{},"f:app.kubernetes.io/name":{},"f:app.kubernetes.io/part-of":{}}},"f:spec":{"f:automountServiceAccountToken":{},"f:containers":{"k:{\"name\":\"rabbitmq\"}":{".":{},"f:env":{".":{},"k:{\"name\":\"K8S_HOSTNAME_SUFFIX\"}":{".":{},"f:name":{},"f:value":{}},"k:{\"name\":\"K8S_SERVICE_NAME\"}":{".":{},"f:name":{},"f:value":{}},"k:{\"name\":\"MY_POD_NAME\"}":{".":{},"f:name":{},"f:valueFrom":{".":{},"f:fieldRef":{".":{},"f:apiVersion":{},"f:fieldPath":{}}}},"k:{\"name\":\"MY_POD_NAMESPACE\"}":{".":{},"f:name":{},"f:valueFrom":{".":{},"f:fieldRef":{".":{},"f:apiVersion":{},"f:fieldPath":{}}}},"k:{\"name\":\"RABBITMQ_ENABLED_PLUGINS_FILE\"}":{".":{},"f:name":{},"f:value":{}},"k:{\"name\":\"RABBITMQ_NODENAME\"}":{".":{},"f:name":{},"f:value":{}},"k:{\"name\":\"RABBITMQ_USE_LONGNAME\"}":{".":{},"f:name":{},"f:value":{}}},"f:image":{},"f:imagePullPolicy":{},"f:lifecycle":{".":{},"f:preStop":{".":{},"f:exec":{".":{},"f:command":{}}}},"f:name":{},"f:ports":{".":{},"k:{\"containerPort\":4369,\"protocol\":\"TCP\"}":{".":{},"f:containerPort":{},"f:name":{},"f:protocol":{}},"k:{\"containerPort\":5672,\"protocol\":\"TCP\"}":{".":{},"f:containerPort":{},"f:name":{},"f:protocol":{}},"k:{\"containerPort\":15672,\"protocol\":\"TCP\"}":{".":{},"f:containerPort":{},"f:name":{},"f:protocol":{}},"k:{\"containerPort\":15692,\"protocol\":\"TCP\"}":{".":{},"f:containerPort":{},"f:name":{},"f:protocol":{}}},"f:readinessProbe":{".":{},"f:failureThreshold":{},"f:initialDelaySeconds":{},"f:periodSeconds":{},"f:successThreshold":{},"f:tcpSocket":{".":{},"f:port":{}},"f:timeoutSeconds":{}},"f:resources":{".":{},"f:limits":{".":{},"f:cpu":{},"f:memory":{}},"f:requests":{".":{},"f:cpu":{},"f:memory":{}}},"f:terminationMessagePath":{},"f:terminationMessagePolicy":{},"f:volumeMounts":{".":{},"k:{\"mountPath\":\"/etc/pod-info/\"}":{".":{},"f:mountPath":{},"f:name":{}},"k:{\"mountPath\":\"/etc/rabbitmq/conf.d/10-operatorDefaults.conf\"}":{".":{},"f:mountPath":{},"f:name":{},"f:subPath":{}},"k:{\"mountPath\":\"/etc/rabbitmq/conf.d/11-default_user.conf\"}":{".":{},"f:mountPath":{},"f:name":{},"f:subPath":{}},"k:{\"mountPath\":\"/etc/rabbitmq/conf.d/90-userDefinedConfiguration.conf\"}":{".":{},"f:mountPath":{},"f:name":{},"f:subPath":{}},"k:{\"mountPath\":\"/operator\"}":{".":{},"f:mountPath":{},"f:name":{}},"k:{\"mountPath\":\"/var/lib/rabbitmq/\"}":{".":{},"f:mountPath":{},"f:name":{}},"k:{\"mountPath\":\"/var/lib/rabbitmq/mnesia/\"}":{".":{},"f:mountPath":{},"f:name":{}}}}},"f:dnsPolicy":{},"f:initContainers":{".":{},"k:{\"name\":\"setup-container\"}":{".":{},"f:command":{},"f:image":{},"f:imagePullPolicy":{},"f:name":{},"f:resources":{".":{},"f:limits":{".":{},"f:cpu":{},"f:memory":{}},"f:requests":{".":{},"f:cpu":{},"f:memory":{}}},"f:securityContext":{".":{},"f:capabilities":{".":{},"f:drop":{}},"f:runAsUser":{}},"f:terminationMessagePath":{},"f:terminationMessagePolicy":{},"f:volumeMounts":{".":{},"k:{\"mountPath\":\"/operator\"}":{".":{},"f:mountPath":{},"f:name":{}},"k:{\"mountPath\":\"/tmp/default_user.conf\"}":{".":{},"f:mountPath":{},"f:name":{},"f:subPath":{}},"k:{\"mountPath\":\"/tmp/erlang-cookie-secret/\"}":{".":{},"f:mountPath":{},"f:name":{}},"k:{\"mountPath\":\"/tmp/rabbitmq-plugins/\"}":{".":{},"f:mountPath":{},"f:name":{}},"k:{\"mountPath\":\"/var/lib/rabbitmq/\"}":{".":{},"f:mountPath":{},"f:name":{}},"k:{\"mountPath\":\"/var/lib/rabbitmq/mnesia/\"}":{".":{},"f:mountPath":{},"f:name":{}}}}},"f:restartPolicy":{},"f:schedulerName":{},"f:securityContext":{".":{},"f:fsGroup":{},"f:runAsGroup":{},"f:runAsUser":{}},"f:serviceAccount":{},"f:serviceAccountName":{},"f:terminationGracePeriodSeconds":{},"f:topologySpreadConstraints":{".":{},"k:{\"topologyKey\":\"topology.kubernetes.io/zone\",\"whenUnsatisfiable\":\"ScheduleAnyway\"}":{".":{},"f:labelSelector":{".":{},"f:matchLabels":{".":{},"f:app.kubernetes.io/name":{}}},"f:maxSkew":{},"f:topologyKey":{},"f:whenUnsatisfiable":{}}},"f:volumes":{".":{},"k:{\"name\":\"erlang-cookie-secret\"}":{".":{},"f:name":{},"f:secret":{".":{},"f:defaultMode":{},"f:secretName":{}}},"k:{\"name\":\"plugins-conf\"}":{".":{},"f:configMap":{".":{},"f:defaultMode":{},"f:name":{}},"f:name":{}},"k:{\"name\":\"pod-info\"}":{".":{},"f:downwardAPI":{".":{},"f:defaultMode":{},"f:items":{}},"f:name":{}},"k:{\"name\":\"rabbitmq-confd\"}":{".":{},"f:name":{},"f:projected":{".":{},"f:defaultMode":{},"f:sources":{}}},"k:{\"name\":\"rabbitmq-erlang-cookie\"}":{".":{},"f:emptyDir":{},"f:name":{}},"k:{\"name\":\"rabbitmq-plugins\"}":{".":{},"f:emptyDir":{},"f:name":{}}}}},"f:updateStrategy":{"f:rollingUpdate":{".":{},"f:partition":{}},"f:type":{}},"f:volumeClaimTemplates":{}}}},{"manager":"kube-controller-manager","operation":"Update","apiVersion":"apps/v1","time":"2022-03-18T18:07:23Z","fieldsType":"FieldsV1","fieldsV1":{"f:status":{"f:collisionCount":{},"f:currentReplicas":{},"f:currentRevision":{},"f:observedGeneration":{},"f:readyReplicas":{},"f:replicas":{},"f:updateRevision":{},"f:updatedReplicas":{}}}}]},"spec":{"replicas":1,"selector":{"matchLabels":{"app.kubernetes.io/name":"rabbitmq-cluster"}},"template":{"metadata":{"creationTimestamp":null,"labels":{"app.kubernetes.io/component":"rabbitmq","app.kubernetes.io/name":"rabbitmq-cluster","app.kubernetes.io/part-of":"rabbitmq"},"annotations":{"prometheus.io/port":"15692","prometheus.io/scrape":"true"}},"spec":{"volumes":[{"name":"plugins-conf","configMap":{"name":"rabbitmq-cluster-plugins-conf","defaultMode":420}},{"name":"rabbitmq-confd","projected":{"sources":[{"secret":{"name":"rabbitmq-cluster-default-user","items":[{"key":"default_user.conf","path":"default_user.conf"}]}},{"configMap":{"name":"rabbitmq-cluster-server-conf","items":[{"key":"operatorDefaults.conf","path":"operatorDefaults.conf"},{"key":"userDefinedConfiguration.conf","path":"userDefinedConfiguration.conf"}]}}],"defaultMode":420}},{"name":"rabbitmq-erlang-cookie","emptyDir":{}},{"name":"erlang-cookie-secret","secret":{"secretName":"rabbitmq-cluster-erlang-cookie","defaultMode":420}},{"name":"rabbitmq-plugins","emptyDir":{}},{"name":"pod-info","downwardAPI":{"items":[{"path":"skipPreStopChecks","fieldRef":{"apiVersion":"v1","fieldPath":"metadata.labels['skipPreStopChecks']"}}],"defaultMode":420}}],"initContainers":[{"name":"setup-container","image":"rabbitmq:3.8.12-management","command":["sh","-c","cp /tmp/erlang-cookie-secret/.erlang.cookie /var/lib/rabbitmq/.erlang.cookie \u0026\u0026 chown 999:999 /var/lib/rabbitmq/.erlang.cookie \u0026\u0026 chmod 600 /var/lib/rabbitmq/.erlang.cookie ; cp /tmp/rabbitmq-plugins/enabled_plugins /operator/enabled_plugins \u0026\u0026 chown 999:999 /operator/enabled_plugins ; chown 999:999 /var/lib/rabbitmq/mnesia/ ; echo '[default]' \u003e /var/lib/rabbitmq/.rabbitmqadmin.conf \u0026\u0026 sed -e 's/default_user/username/' -e 's/default_pass/password/' /tmp/default_user.conf \u003e\u003e /var/lib/rabbitmq/.rabbitmqadmin.conf \u0026\u0026 chown 999:999 /var/lib/rabbitmq/.rabbitmqadmin.conf \u0026\u0026 chmod 600 /var/lib/rabbitmq/.rabbitmqadmin.conf"],"resources":{"limits":{"cpu":"100m","memory":"500Mi"},"requests":{"cpu":"100m","memory":"500Mi"}},"volumeMounts":[{"name":"plugins-conf","mountPath":"/tmp/rabbitmq-plugins/"},{"name":"rabbitmq-erlang-cookie","mountPath":"/var/lib/rabbitmq/"},{"name":"erlang-cookie-secret","mountPath":"/tmp/erlang-cookie-secret/"},{"name":"rabbitmq-plugins","mountPath":"/operator"},{"name":"persistence","mountPath":"/var/lib/rabbitmq/mnesia/"},{"name":"rabbitmq-confd","mountPath":"/tmp/default_user.conf","subPath":"default_user.conf"}],"terminationMessagePath":"/dev/termination-log","terminationMessagePolicy":"File","imagePullPolicy":"IfNotPresent","securityContext":{"capabilities":{"drop":["FSETID","KILL","SETGID","SETUID","SETPCAP","NET_BIND_SERVICE","NET_RAW","SYS_CHROOT","MKNOD","AUDIT_WRITE","SETFCAP"]},"runAsUser":0}}],"containers":[{"name":"rabbitmq","image":"rabbitmq:3.8.12-management","ports":[{"name":"epmd","containerPort":4369,"protocol":"TCP"},{"name":"amqp","containerPort":5672,"protocol":"TCP"},{"name":"management","containerPort":15672,"protocol":"TCP"},{"name":"prometheus","containerPort":15692,"protocol":"TCP"}],"env":[{"name":"MY_POD_NAME","valueFrom":{"fieldRef":{"apiVersion":"v1","fieldPath":"metadata.name"}}},{"name":"MY_POD_NAMESPACE","valueFrom":{"fieldRef":{"apiVersion":"v1","fieldPath":"metadata.namespace"}}},{"name":"RABBITMQ_ENABLED_PLUGINS_FILE","value":"/operator/enabled_plugins"},{"name":"K8S_SERVICE_NAME","value":"rabbitmq-cluster-nodes"},{"name":"RABBITMQ_USE_LONGNAME","value":"true"},{"name":"RABBITMQ_NODENAME","value":"rabbit@$(MY_POD_NAME).$(K8S_SERVICE_NAME).$(MY_POD_NAMESPACE)"},{"name":"K8S_HOSTNAME_SUFFIX","value":".$(K8S_SERVICE_NAME).$(MY_POD_NAMESPACE)"}],"resources":{"limits":{"cpu":"2","memory":"2Gi"},"requests":{"cpu":"1","memory":"2Gi"}},"volumeMounts":[{"name":"rabbitmq-erlang-cookie","mountPath":"/var/lib/rabbitmq/"},{"name":"persistence","mountPath":"/var/lib/rabbitmq/mnesia/"},{"name":"rabbitmq-plugins","mountPath":"/operator"},{"name":"rabbitmq-confd","mountPath":"/etc/rabbitmq/conf.d/10-operatorDefaults.conf","subPath":"operatorDefaults.conf"},{"name":"rabbitmq-confd","mountPath":"/etc/rabbitmq/conf.d/11-default_user.conf","subPath":"default_user.conf"},{"name":"rabbitmq-confd","mountPath":"/etc/rabbitmq/conf.d/90-userDefinedConfiguration.conf","subPath":"userDefinedConfiguration.conf"},{"name":"pod-info","mountPath":"/etc/pod-info/"}],"readinessProbe":{"tcpSocket":{"port":"amqp"},"initialDelaySeconds":10,"timeoutSeconds":5,"periodSeconds":10,"successThreshold":1,"failureThreshold":3},"lifecycle":{"preStop":{"exec":{"command":["/bin/bash","-c","if [ ! -z \"$(cat /etc/pod-info/skipPreStopChecks)\" ]; then exit 0; fi; rabbitmq-upgrade await_online_quorum_plus_one -t 604800; rabbitmq-upgrade await_online_synchronized_mirror -t 604800; rabbitmq-upgrade drain -t 604800"]}}},"terminationMessagePath":"/dev/termination-log","terminationMessagePolicy":"File","imagePullPolicy":"IfNotPresent"}],"restartPolicy":"Always","terminationGracePeriodSeconds":604800,"dnsPolicy":"ClusterFirst","serviceAccountName":"rabbitmq-cluster-server","serviceAccount":"rabbitmq-cluster-server","automountServiceAccountToken":true,"securityContext":{"runAsUser":999,"runAsGroup":999,"fsGroup":999},"schedulerName":"default-scheduler","topologySpreadConstraints":[{"maxSkew":1,"topologyKey":"topology.kubernetes.io/zone","whenUnsatisfiable":"ScheduleAnyway","labelSelector":{"matchLabels":{"app.kubernetes.io/name":"rabbitmq-cluster"}}}]}},"volumeClaimTemplates":[{"metadata":{"name":"persistence","namespace":"default","creationTimestamp":null,"labels":{"app.kubernetes.io/component":"rabbitmq","app.kubernetes.io/name":"rabbitmq-cluster","app.kubernetes.io/part-of":"rabbitmq"},"ownerReferences":[{"apiVersion":"rabbitmq.com/v1beta1","kind":"RabbitmqCluster","name":"rabbitmq-cluster","uid":"3ecefa8a-1bec-48a7-9af4-dd0df3339101","controller":true,"blockOwnerDeletion":false}]},"spec":{"accessModes":["ReadWriteOnce"],"resources":{"requests":{"storage":"10Gi"}},"volumeMode":"Filesystem"},"status":{"phase":"Pending"}}],"serviceName":"rabbitmq-cluster-nodes","podManagementPolicy":"Parallel","updateStrategy":{"type":"RollingUpdate","rollingUpdate":{"partition":0}},"revisionHistoryLimit":10},"status":{"observedGeneration":1,"replicas":1,"readyReplicas":1,"currentReplicas":1,"updatedReplicas":1,"currentRevision":"rabbitmq-cluster-server-5f8b8665fb","updateRevision":"rabbitmq-cluster-server-5f8b8665fb","collisionCount":0}}
2022/03/18 18:07:23 learn_server.go:256: [SIEVE-BEFORE-WRITE]	27
2022/03/18 18:07:23 learn_server.go:263: [SIEVE-AFTER-WRITE]	27	Update	statefulset	github.com/rabbitmq/cluster-operator/controllers.(*RabbitmqClusterReconciler)	NoError	{"metadata":{"name":"rabbitmq-cluster-server","namespace":"default","selfLink":"/apis/apps/v1/namespaces/default/statefulsets/rabbitmq-cluster-server","uid":"f2f07f3e-b500-4c48-a5de-8db7eaf37b9a","resourceVersion":"1404","generation":1,"creationTimestamp":"2022-03-18T18:06:25Z","labels":{"app.kubernetes.io/component":"rabbitmq","app.kubernetes.io/name":"rabbitmq-cluster","app.kubernetes.io/part-of":"rabbitmq"},"annotations":{"rabbitmq.com/createdAt":"2022-03-18T18:06:25Z"},"ownerReferences":[{"apiVersion":"rabbitmq.com/v1beta1","kind":"RabbitmqCluster","name":"rabbitmq-cluster","uid":"3ecefa8a-1bec-48a7-9af4-dd0df3339101","controller":true,"blockOwnerDeletion":true}],"managedFields":[{"manager":"manager","operation":"Update","apiVersion":"apps/v1","time":"2022-03-18T18:06:25Z","fieldsType":"FieldsV1","fieldsV1":{"f:metadata":{"f:annotations":{".":{},"f:rabbitmq.com/createdAt":{}},"f:labels":{".":{},"f:app.kubernetes.io/component":{},"f:app.kubernetes.io/name":{},"f:app.kubernetes.io/part-of":{}},"f:ownerReferences":{".":{},"k:{\"uid\":\"3ecefa8a-1bec-48a7-9af4-dd0df3339101\"}":{".":{},"f:apiVersion":{},"f:blockOwnerDeletion":{},"f:controller":{},"f:kind":{},"f:name":{},"f:uid":{}}}},"f:spec":{"f:podManagementPolicy":{},"f:replicas":{},"f:revisionHistoryLimit":{},"f:selector":{"f:matchLabels":{".":{},"f:app.kubernetes.io/name":{}}},"f:serviceName":{},"f:template":{"f:metadata":{"f:annotations":{".":{},"f:prometheus.io/port":{},"f:prometheus.io/scrape":{}},"f:labels":{".":{},"f:app.kubernetes.io/component":{},"f:app.kubernetes.io/name":{},"f:app.kubernetes.io/part-of":{}}},"f:spec":{"f:automountServiceAccountToken":{},"f:containers":{"k:{\"name\":\"rabbitmq\"}":{".":{},"f:env":{".":{},"k:{\"name\":\"K8S_HOSTNAME_SUFFIX\"}":{".":{},"f:name":{},"f:value":{}},"k:{\"name\":\"K8S_SERVICE_NAME\"}":{".":{},"f:name":{},"f:value":{}},"k:{\"name\":\"MY_POD_NAME\"}":{".":{},"f:name":{},"f:valueFrom":{".":{},"f:fieldRef":{".":{},"f:apiVersion":{},"f:fieldPath":{}}}},"k:{\"name\":\"MY_POD_NAMESPACE\"}":{".":{},"f:name":{},"f:valueFrom":{".":{},"f:fieldRef":{".":{},"f:apiVersion":{},"f:fieldPath":{}}}},"k:{\"name\":\"RABBITMQ_ENABLED_PLUGINS_FILE\"}":{".":{},"f:name":{},"f:value":{}},"k:{\"name\":\"RABBITMQ_NODENAME\"}":{".":{},"f:name":{},"f:value":{}},"k:{\"name\":\"RABBITMQ_USE_LONGNAME\"}":{".":{},"f:name":{},"f:value":{}}},"f:image":{},"f:imagePullPolicy":{},"f:lifecycle":{".":{},"f:preStop":{".":{},"f:exec":{".":{},"f:command":{}}}},"f:name":{},"f:ports":{".":{},"k:{\"containerPort\":4369,\"protocol\":\"TCP\"}":{".":{},"f:containerPort":{},"f:name":{},"f:protocol":{}},"k:{\"containerPort\":5672,\"protocol\":\"TCP\"}":{".":{},"f:containerPort":{},"f:name":{},"f:protocol":{}},"k:{\"containerPort\":15672,\"protocol\":\"TCP\"}":{".":{},"f:containerPort":{},"f:name":{},"f:protocol":{}},"k:{\"containerPort\":15692,\"protocol\":\"TCP\"}":{".":{},"f:containerPort":{},"f:name":{},"f:protocol":{}}},"f:readinessProbe":{".":{},"f:failureThreshold":{},"f:initialDelaySeconds":{},"f:periodSeconds":{},"f:successThreshold":{},"f:tcpSocket":{".":{},"f:port":{}},"f:timeoutSeconds":{}},"f:resources":{".":{},"f:limits":{".":{},"f:cpu":{},"f:memory":{}},"f:requests":{".":{},"f:cpu":{},"f:memory":{}}},"f:terminationMessagePath":{},"f:terminationMessagePolicy":{},"f:volumeMounts":{".":{},"k:{\"mountPath\":\"/etc/pod-info/\"}":{".":{},"f:mountPath":{},"f:name":{}},"k:{\"mountPath\":\"/etc/rabbitmq/conf.d/10-operatorDefaults.conf\"}":{".":{},"f:mountPath":{},"f:name":{},"f:subPath":{}},"k:{\"mountPath\":\"/etc/rabbitmq/conf.d/11-default_user.conf\"}":{".":{},"f:mountPath":{},"f:name":{},"f:subPath":{}},"k:{\"mountPath\":\"/etc/rabbitmq/conf.d/90-userDefinedConfiguration.conf\"}":{".":{},"f:mountPath":{},"f:name":{},"f:subPath":{}},"k:{\"mountPath\":\"/operator\"}":{".":{},"f:mountPath":{},"f:name":{}},"k:{\"mountPath\":\"/var/lib/rabbitmq/\"}":{".":{},"f:mountPath":{},"f:name":{}},"k:{\"mountPath\":\"/var/lib/rabbitmq/mnesia/\"}":{".":{},"f:mountPath":{},"f:name":{}}}}},"f:dnsPolicy":{},"f:initContainers":{".":{},"k:{\"name\":\"setup-container\"}":{".":{},"f:command":{},"f:image":{},"f:imagePullPolicy":{},"f:name":{},"f:resources":{".":{},"f:limits":{".":{},"f:cpu":{},"f:memory":{}},"f:requests":{".":{},"f:cpu":{},"f:memory":{}}},"f:securityContext":{".":{},"f:capabilities":{".":{},"f:drop":{}},"f:runAsUser":{}},"f:terminationMessagePath":{},"f:terminationMessagePolicy":{},"f:volumeMounts":{".":{},"k:{\"mountPath\":\"/operator\"}":{".":{},"f:mountPath":{},"f:name":{}},"k:{\"mountPath\":\"/tmp/default_user.conf\"}":{".":{},"f:mountPath":{},"f:name":{},"f:subPath":{}},"k:{\"mountPath\":\"/tmp/erlang-cookie-secret/\"}":{".":{},"f:mountPath":{},"f:name":{}},"k:{\"mountPath\":\"/tmp/rabbitmq-plugins/\"}":{".":{},"f:mountPath":{},"f:name":{}},"k:{\"mountPath\":\"/var/lib/rabbitmq/\"}":{".":{},"f:mountPath":{},"f:name":{}},"k:{\"mountPath\":\"/var/lib/rabbitmq/mnesia/\"}":{".":{},"f:mountPath":{},"f:name":{}}}}},"f:restartPolicy":{},"f:schedulerName":{},"f:securityContext":{".":{},"f:fsGroup":{},"f:runAsGroup":{},"f:runAsUser":{}},"f:serviceAccount":{},"f:serviceAccountName":{},"f:terminationGracePeriodSeconds":{},"f:topologySpreadConstraints":{".":{},"k:{\"topologyKey\":\"topology.kubernetes.io/zone\",\"whenUnsatisfiable\":\"ScheduleAnyway\"}":{".":{},"f:labelSelector":{".":{},"f:matchLabels":{".":{},"f:app.kubernetes.io/name":{}}},"f:maxSkew":{},"f:topologyKey":{},"f:whenUnsatisfiable":{}}},"f:volumes":{".":{},"k:{\"name\":\"erlang-cookie-secret\"}":{".":{},"f:name":{},"f:secret":{".":{},"f:defaultMode":{},"f:secretName":{}}},"k:{\"name\":\"plugins-conf\"}":{".":{},"f:configMap":{".":{},"f:defaultMode":{},"f:name":{}},"f:name":{}},"k:{\"name\":\"pod-info\"}":{".":{},"f:downwardAPI":{".":{},"f:defaultMode":{},"f:items":{}},"f:name":{}},"k:{\"name\":\"rabbitmq-confd\"}":{".":{},"f:name":{},"f:projected":{".":{},"f:defaultMode":{},"f:sources":{}}},"k:{\"name\":\"rabbitmq-erlang-cookie\"}":{".":{},"f:emptyDir":{},"f:name":{}},"k:{\"name\":\"rabbitmq-plugins\"}":{".":{},"f:emptyDir":{},"f:name":{}}}}},"f:updateStrategy":{"f:rollingUpdate":{".":{},"f:partition":{}},"f:type":{}},"f:volumeClaimTemplates":{}}}},{"manager":"kube-controller-manager","operation":"Update","apiVersion":"apps/v1","time":"2022-03-18T18:07:23Z","fieldsType":"FieldsV1","fieldsV1":{"f:status":{"f:collisionCount":{},"f:currentReplicas":{},"f:currentRevision":{},"f:observedGeneration":{},"f:readyReplicas":{},"f:replicas":{},"f:updateRevision":{},"f:updatedReplicas":{}}}}]},"spec":{"replicas":1,"selector":{"matchLabels":{"app.kubernetes.io/name":"rabbitmq-cluster"}},"template":{"metadata":{"creationTimestamp":null,"labels":{"app.kubernetes.io/component":"rabbitmq","app.kubernetes.io/name":"rabbitmq-cluster","app.kubernetes.io/part-of":"rabbitmq"},"annotations":{"prometheus.io/port":"15692","prometheus.io/scrape":"true"}},"spec":{"volumes":[{"name":"plugins-conf","configMap":{"name":"rabbitmq-cluster-plugins-conf","defaultMode":420}},{"name":"rabbitmq-confd","projected":{"sources":[{"secret":{"name":"rabbitmq-cluster-default-user","items":[{"key":"default_user.conf","path":"default_user.conf"}]}},{"configMap":{"name":"rabbitmq-cluster-server-conf","items":[{"key":"operatorDefaults.conf","path":"operatorDefaults.conf"},{"key":"userDefinedConfiguration.conf","path":"userDefinedConfiguration.conf"}]}}],"defaultMode":420}},{"name":"rabbitmq-erlang-cookie","emptyDir":{}},{"name":"erlang-cookie-secret","secret":{"secretName":"rabbitmq-cluster-erlang-cookie","defaultMode":420}},{"name":"rabbitmq-plugins","emptyDir":{}},{"name":"pod-info","downwardAPI":{"items":[{"path":"skipPreStopChecks","fieldRef":{"apiVersion":"v1","fieldPath":"metadata.labels['skipPreStopChecks']"}}],"defaultMode":420}}],"initContainers":[{"name":"setup-container","image":"rabbitmq:3.8.12-management","command":["sh","-c","cp /tmp/erlang-cookie-secret/.erlang.cookie /var/lib/rabbitmq/.erlang.cookie \u0026\u0026 chown 999:999 /var/lib/rabbitmq/.erlang.cookie \u0026\u0026 chmod 600 /var/lib/rabbitmq/.erlang.cookie ; cp /tmp/rabbitmq-plugins/enabled_plugins /operator/enabled_plugins \u0026\u0026 chown 999:999 /operator/enabled_plugins ; chown 999:999 /var/lib/rabbitmq/mnesia/ ; echo '[default]' \u003e /var/lib/rabbitmq/.rabbitmqadmin.conf \u0026\u0026 sed -e 's/default_user/username/' -e 's/default_pass/password/' /tmp/default_user.conf \u003e\u003e /var/lib/rabbitmq/.rabbitmqadmin.conf \u0026\u0026 chown 999:999 /var/lib/rabbitmq/.rabbitmqadmin.conf \u0026\u0026 chmod 600 /var/lib/rabbitmq/.rabbitmqadmin.conf"],"resources":{"limits":{"cpu":"100m","memory":"500Mi"},"requests":{"cpu":"100m","memory":"500Mi"}},"volumeMounts":[{"name":"plugins-conf","mountPath":"/tmp/rabbitmq-plugins/"},{"name":"rabbitmq-erlang-cookie","mountPath":"/var/lib/rabbitmq/"},{"name":"erlang-cookie-secret","mountPath":"/tmp/erlang-cookie-secret/"},{"name":"rabbitmq-plugins","mountPath":"/operator"},{"name":"persistence","mountPath":"/var/lib/rabbitmq/mnesia/"},{"name":"rabbitmq-confd","mountPath":"/tmp/default_user.conf","subPath":"default_user.conf"}],"terminationMessagePath":"/dev/termination-log","terminationMessagePolicy":"File","imagePullPolicy":"IfNotPresent","securityContext":{"capabilities":{"drop":["FSETID","KILL","SETGID","SETUID","SETPCAP","NET_BIND_SERVICE","NET_RAW","SYS_CHROOT","MKNOD","AUDIT_WRITE","SETFCAP"]},"runAsUser":0}}],"containers":[{"name":"rabbitmq","image":"rabbitmq:3.8.12-management","ports":[{"name":"epmd","containerPort":4369,"protocol":"TCP"},{"name":"amqp","containerPort":5672,"protocol":"TCP"},{"name":"management","containerPort":15672,"protocol":"TCP"},{"name":"prometheus","containerPort":15692,"protocol":"TCP"}],"env":[{"name":"MY_POD_NAME","valueFrom":{"fieldRef":{"apiVersion":"v1","fieldPath":"metadata.name"}}},{"name":"MY_POD_NAMESPACE","valueFrom":{"fieldRef":{"apiVersion":"v1","fieldPath":"metadata.namespace"}}},{"name":"RABBITMQ_ENABLED_PLUGINS_FILE","value":"/operator/enabled_plugins"},{"name":"K8S_SERVICE_NAME","value":"rabbitmq-cluster-nodes"},{"name":"RABBITMQ_USE_LONGNAME","value":"true"},{"name":"RABBITMQ_NODENAME","value":"rabbit@$(MY_POD_NAME).$(K8S_SERVICE_NAME).$(MY_POD_NAMESPACE)"},{"name":"K8S_HOSTNAME_SUFFIX","value":".$(K8S_SERVICE_NAME).$(MY_POD_NAMESPACE)"}],"resources":{"limits":{"cpu":"2","memory":"2Gi"},"requests":{"cpu":"1","memory":"2Gi"}},"volumeMounts":[{"name":"rabbitmq-erlang-cookie","mountPath":"/var/lib/rabbitmq/"},{"name":"persistence","mountPath":"/var/lib/rabbitmq/mnesia/"},{"name":"rabbitmq-plugins","mountPath":"/operator"},{"name":"rabbitmq-confd","mountPath":"/etc/rabbitmq/conf.d/10-operatorDefaults.conf","subPath":"operatorDefaults.conf"},{"name":"rabbitmq-confd","mountPath":"/etc/rabbitmq/conf.d/11-default_user.conf","subPath":"default_user.conf"},{"name":"rabbitmq-confd","mountPath":"/etc/rabbitmq/conf.d/90-userDefinedConfiguration.conf","subPath":"userDefinedConfiguration.conf"},{"name":"pod-info","mountPath":"/etc/pod-info/"}],"readinessProbe":{"tcpSocket":{"port":"amqp"},"initialDelaySeconds":10,"timeoutSeconds":5,"periodSeconds":10,"successThreshold":1,"failureThreshold":3},"lifecycle":{"preStop":{"exec":{"command":["/bin/bash","-c","if [ ! -z \"$(cat /etc/pod-info/skipPreStopChecks)\" ]; then exit 0; fi; rabbitmq-upgrade await_online_quorum_plus_one -t 604800; rabbitmq-upgrade await_online_synchronized_mirror -t 604800; rabbitmq-upgrade drain -t 604800"]}}},"terminationMessagePath":"/dev/termination-log","terminationMessagePolicy":"File","imagePullPolicy":"IfNotPresent"}],"restartPolicy":"Always","terminationGracePeriodSeconds":604800,"dnsPolicy":"ClusterFirst","serviceAccountName":"rabbitmq-cluster-server","serviceAccount":"rabbitmq-cluster-server","automountServiceAccountToken":true,"securityContext":{"runAsUser":999,"runAsGroup":999,"fsGroup":999},"schedulerName":"default-scheduler","topologySpreadConstraints":[{"maxSkew":1,"topologyKey":"topology.kubernetes.io/zone","whenUnsatisfiable":"ScheduleAnyway","labelSelector":{"matchLabels":{"app.kubernetes.io/name":"rabbitmq-cluster"}}}]}},"volumeClaimTemplates":[{"metadata":{"name":"persistence","namespace":"default","creationTimestamp":null,"labels":{"app.kubernetes.io/component":"rabbitmq","app.kubernetes.io/name":"rabbitmq-cluster","app.kubernetes.io/part-of":"rabbitmq"},"ownerReferences":[{"apiVersion":"rabbitmq.com/v1beta1","kind":"RabbitmqCluster","name":"rabbitmq-cluster","uid":"3ecefa8a-1bec-48a7-9af4-dd0df3339101","controller":true,"blockOwnerDeletion":false}]},"spec":{"accessModes":["ReadWriteOnce"],"resources":{"requests":{"storage":"10Gi"}},"volumeMode":"Filesystem"},"status":{"phase":"Pending"}}],"serviceName":"rabbitmq-cluster-nodes","podManagementPolicy":"Parallel","updateStrategy":{"type":"RollingUpdate","rollingUpdate":{"partition":0}},"revisionHistoryLimit":10},"status":{"observedGeneration":1,"replicas":1,"readyReplicas":1,"currentReplicas":1,"updatedReplicas":1,"currentRevision":"rabbitmq-cluster-server-5f8b8665fb","updateRevision":"rabbitmq-cluster-server-5f8b8665fb","collisionCount":0}}
2022/03/18 18:07:23 learn_server.go:291: [SIEVE-AFTER-READ]	Get	true	configmap	default	rabbitmq-cluster-server-conf	github.com/rabbitmq/cluster-operator/controllers.(*RabbitmqClusterReconciler)	NoError	{"kind":"ConfigMap","apiVersion":"v1","metadata":{"name":"rabbitmq-cluster-server-conf","namespace":"default","selfLink":"/api/v1/namespaces/default/configmaps/rabbitmq-cluster-server-conf","uid":"e4182078-d429-4baf-9021-72618c509ac5","resourceVersion":"1095","creationTimestamp":"2022-03-18T18:06:25Z","labels":{"app.kubernetes.io/component":"rabbitmq","app.kubernetes.io/name":"rabbitmq-cluster","app.kubernetes.io/part-of":"rabbitmq"},"ownerReferences":[{"apiVersion":"rabbitmq.com/v1beta1","kind":"RabbitmqCluster","name":"rabbitmq-cluster","uid":"3ecefa8a-1bec-48a7-9af4-dd0df3339101","controller":true,"blockOwnerDeletion":true}],"managedFields":[{"manager":"manager","operation":"Update","apiVersion":"v1","time":"2022-03-18T18:06:25Z","fieldsType":"FieldsV1","fieldsV1":{"f:data":{".":{},"f:operatorDefaults.conf":{},"f:userDefinedConfiguration.conf":{}},"f:metadata":{"f:labels":{".":{},"f:app.kubernetes.io/component":{},"f:app.kubernetes.io/name":{},"f:app.kubernetes.io/part-of":{}},"f:ownerReferences":{".":{},"k:{\"uid\":\"3ecefa8a-1bec-48a7-9af4-dd0df3339101\"}":{".":{},"f:apiVersion":{},"f:blockOwnerDeletion":{},"f:controller":{},"f:kind":{},"f:name":{},"f:uid":{}}}}}}]},"data":{"operatorDefaults.conf":"cluster_formation.peer_discovery_backend             = rabbit_peer_discovery_k8s\ncluster_formation.k8s.host                           = kubernetes.default\ncluster_formation.k8s.address_type                   = hostname\ncluster_partition_handling                           = pause_minority\nqueue_master_locator                                 = min-masters\ndisk_free_limit.absolute                             = 2GB\ncluster_formation.randomized_startup_delay_range.min = 5\ncluster_formation.randomized_startup_delay_range.max = 30\ncluster_name                                         = rabbitmq-cluster\n","userDefinedConfiguration.conf":"total_memory_available_override_value = 1717986919\n"}}
2022/03/18 18:07:23 learn_server.go:256: [SIEVE-BEFORE-WRITE]	28
2022/03/18 18:07:23 learn_server.go:263: [SIEVE-AFTER-WRITE]	28	StatusUpdate	rabbitmqcluster	github.com/rabbitmq/cluster-operator/controllers.(*RabbitmqClusterReconciler)	NoError	{"metadata":{"name":"rabbitmq-cluster","namespace":"default","selfLink":"/apis/rabbitmq.com/v1beta1/namespaces/default/rabbitmqclusters/rabbitmq-cluster/status","uid":"3ecefa8a-1bec-48a7-9af4-dd0df3339101","resourceVersion":"1405","generation":2,"creationTimestamp":"2022-03-18T18:06:25Z","annotations":{"kubectl.kubernetes.io/last-applied-configuration":"{\"apiVersion\":\"rabbitmq.com/v1beta1\",\"kind\":\"RabbitmqCluster\",\"metadata\":{\"annotations\":{},\"name\":\"rabbitmq-cluster\",\"namespace\":\"default\"},\"spec\":{\"persistence\":{\"storage\":\"10Gi\"},\"replicas\":1}}\n"},"finalizers":["deletion.finalizers.rabbitmqclusters.rabbitmq.com"],"managedFields":[{"manager":"kubectl-client-side-apply","operation":"Update","apiVersion":"rabbitmq.com/v1beta1","time":"2022-03-18T18:06:25Z","fieldsType":"FieldsV1","fieldsV1":{"f:metadata":{"f:annotations":{".":{},"f:kubectl.kubernetes.io/last-applied-configuration":{}}},"f:spec":{".":{},"f:image":{},"f:persistence":{".":{},"f:storage":{}},"f:replicas":{},"f:resources":{".":{},"f:limits":{".":{},"f:memory":{}},"f:requests":{".":{},"f:memory":{}}},"f:service":{".":{},"f:type":{}},"f:terminationGracePeriodSeconds":{}}}},{"manager":"manager","operation":"Update","apiVersion":"rabbitmq.com/v1beta1","time":"2022-03-18T18:07:23Z","fieldsType":"FieldsV1","fieldsV1":{"f:metadata":{"f:finalizers":{}},"f:spec":{"f:override":{},"f:rabbitmq":{},"f:resources":{"f:limits":{"f:cpu":{}},"f:requests":{"f:cpu":{}}},"f:tls":{}},"f:status":{".":{},"f:conditions":{},"f:defaultUser":{".":{},"f:secretReference":{".":{},"f:keys":{".":{},"f:password":{},"f:username":{}},"f:name":{},"f:namespace":{}},"f:serviceReference":{".":{},"f:name":{},"f:namespace":{}}}}}}]},"spec":{"replicas":1,"image":"rabbitmq:3.8.12-management","service":{"type":"ClusterIP"},"persistence":{"storage":"10Gi"},"resources":{"limits":{"cpu":"2","memory":"2Gi"},"requests":{"cpu":"1","memory":"2Gi"}},"rabbitmq":{},"tls":{},"override":{},"terminationGracePeriodSeconds":604800},"status":{"conditions":[{"type":"AllReplicasReady","status":"True","lastTransitionTime":"2022-03-18T18:07:23Z","reason":"AllPodsAreReady"},{"type":"ClusterAvailable","status":"True","lastTransitionTime":"2022-03-18T18:07:23Z","reason":"AtLeastOneEndpointAvailable"},{"type":"NoWarnings","status":"True","lastTransitionTime":"2022-03-18T18:06:25Z","reason":"NoWarnings"},{"type":"ReconcileSuccess","status":"Unknown","lastTransitionTime":"2022-03-18T18:06:25Z","reason":"Initialising"}],"defaultUser":{"secretReference":{"name":"rabbitmq-cluster-default-user","namespace":"default","keys":{"password":"password","username":"username"}},"serviceReference":{"name":"rabbitmq-cluster","namespace":"default"}},"binding":{"name":"rabbitmq-cluster-default-user"}}}
2022/03/18 18:07:23 learn_server.go:291: [SIEVE-AFTER-READ]	Get	true	statefulset	default	rabbitmq-cluster-server	github.com/rabbitmq/cluster-operator/controllers.(*RabbitmqClusterReconciler)	NoError	{"kind":"StatefulSet","apiVersion":"apps/v1","metadata":{"name":"rabbitmq-cluster-server","namespace":"default","selfLink":"/apis/apps/v1/namespaces/default/statefulsets/rabbitmq-cluster-server","uid":"f2f07f3e-b500-4c48-a5de-8db7eaf37b9a","resourceVersion":"1404","generation":1,"creationTimestamp":"2022-03-18T18:06:25Z","labels":{"app.kubernetes.io/component":"rabbitmq","app.kubernetes.io/name":"rabbitmq-cluster","app.kubernetes.io/part-of":"rabbitmq"},"annotations":{"rabbitmq.com/createdAt":"2022-03-18T18:06:25Z"},"ownerReferences":[{"apiVersion":"rabbitmq.com/v1beta1","kind":"RabbitmqCluster","name":"rabbitmq-cluster","uid":"3ecefa8a-1bec-48a7-9af4-dd0df3339101","controller":true,"blockOwnerDeletion":true}],"managedFields":[{"manager":"manager","operation":"Update","apiVersion":"apps/v1","time":"2022-03-18T18:06:25Z","fieldsType":"FieldsV1","fieldsV1":{"f:metadata":{"f:annotations":{".":{},"f:rabbitmq.com/createdAt":{}},"f:labels":{".":{},"f:app.kubernetes.io/component":{},"f:app.kubernetes.io/name":{},"f:app.kubernetes.io/part-of":{}},"f:ownerReferences":{".":{},"k:{\"uid\":\"3ecefa8a-1bec-48a7-9af4-dd0df3339101\"}":{".":{},"f:apiVersion":{},"f:blockOwnerDeletion":{},"f:controller":{},"f:kind":{},"f:name":{},"f:uid":{}}}},"f:spec":{"f:podManagementPolicy":{},"f:replicas":{},"f:revisionHistoryLimit":{},"f:selector":{"f:matchLabels":{".":{},"f:app.kubernetes.io/name":{}}},"f:serviceName":{},"f:template":{"f:metadata":{"f:annotations":{".":{},"f:prometheus.io/port":{},"f:prometheus.io/scrape":{}},"f:labels":{".":{},"f:app.kubernetes.io/component":{},"f:app.kubernetes.io/name":{},"f:app.kubernetes.io/part-of":{}}},"f:spec":{"f:automountServiceAccountToken":{},"f:containers":{"k:{\"name\":\"rabbitmq\"}":{".":{},"f:env":{".":{},"k:{\"name\":\"K8S_HOSTNAME_SUFFIX\"}":{".":{},"f:name":{},"f:value":{}},"k:{\"name\":\"K8S_SERVICE_NAME\"}":{".":{},"f:name":{},"f:value":{}},"k:{\"name\":\"MY_POD_NAME\"}":{".":{},"f:name":{},"f:valueFrom":{".":{},"f:fieldRef":{".":{},"f:apiVersion":{},"f:fieldPath":{}}}},"k:{\"name\":\"MY_POD_NAMESPACE\"}":{".":{},"f:name":{},"f:valueFrom":{".":{},"f:fieldRef":{".":{},"f:apiVersion":{},"f:fieldPath":{}}}},"k:{\"name\":\"RABBITMQ_ENABLED_PLUGINS_FILE\"}":{".":{},"f:name":{},"f:value":{}},"k:{\"name\":\"RABBITMQ_NODENAME\"}":{".":{},"f:name":{},"f:value":{}},"k:{\"name\":\"RABBITMQ_USE_LONGNAME\"}":{".":{},"f:name":{},"f:value":{}}},"f:image":{},"f:imagePullPolicy":{},"f:lifecycle":{".":{},"f:preStop":{".":{},"f:exec":{".":{},"f:command":{}}}},"f:name":{},"f:ports":{".":{},"k:{\"containerPort\":4369,\"protocol\":\"TCP\"}":{".":{},"f:containerPort":{},"f:name":{},"f:protocol":{}},"k:{\"containerPort\":5672,\"protocol\":\"TCP\"}":{".":{},"f:containerPort":{},"f:name":{},"f:protocol":{}},"k:{\"containerPort\":15672,\"protocol\":\"TCP\"}":{".":{},"f:containerPort":{},"f:name":{},"f:protocol":{}},"k:{\"containerPort\":15692,\"protocol\":\"TCP\"}":{".":{},"f:containerPort":{},"f:name":{},"f:protocol":{}}},"f:readinessProbe":{".":{},"f:failureThreshold":{},"f:initialDelaySeconds":{},"f:periodSeconds":{},"f:successThreshold":{},"f:tcpSocket":{".":{},"f:port":{}},"f:timeoutSeconds":{}},"f:resources":{".":{},"f:limits":{".":{},"f:cpu":{},"f:memory":{}},"f:requests":{".":{},"f:cpu":{},"f:memory":{}}},"f:terminationMessagePath":{},"f:terminationMessagePolicy":{},"f:volumeMounts":{".":{},"k:{\"mountPath\":\"/etc/pod-info/\"}":{".":{},"f:mountPath":{},"f:name":{}},"k:{\"mountPath\":\"/etc/rabbitmq/conf.d/10-operatorDefaults.conf\"}":{".":{},"f:mountPath":{},"f:name":{},"f:subPath":{}},"k:{\"mountPath\":\"/etc/rabbitmq/conf.d/11-default_user.conf\"}":{".":{},"f:mountPath":{},"f:name":{},"f:subPath":{}},"k:{\"mountPath\":\"/etc/rabbitmq/conf.d/90-userDefinedConfiguration.conf\"}":{".":{},"f:mountPath":{},"f:name":{},"f:subPath":{}},"k:{\"mountPath\":\"/operator\"}":{".":{},"f:mountPath":{},"f:name":{}},"k:{\"mountPath\":\"/var/lib/rabbitmq/\"}":{".":{},"f:mountPath":{},"f:name":{}},"k:{\"mountPath\":\"/var/lib/rabbitmq/mnesia/\"}":{".":{},"f:mountPath":{},"f:name":{}}}}},"f:dnsPolicy":{},"f:initContainers":{".":{},"k:{\"name\":\"setup-container\"}":{".":{},"f:command":{},"f:image":{},"f:imagePullPolicy":{},"f:name":{},"f:resources":{".":{},"f:limits":{".":{},"f:cpu":{},"f:memory":{}},"f:requests":{".":{},"f:cpu":{},"f:memory":{}}},"f:securityContext":{".":{},"f:capabilities":{".":{},"f:drop":{}},"f:runAsUser":{}},"f:terminationMessagePath":{},"f:terminationMessagePolicy":{},"f:volumeMounts":{".":{},"k:{\"mountPath\":\"/operator\"}":{".":{},"f:mountPath":{},"f:name":{}},"k:{\"mountPath\":\"/tmp/default_user.conf\"}":{".":{},"f:mountPath":{},"f:name":{},"f:subPath":{}},"k:{\"mountPath\":\"/tmp/erlang-cookie-secret/\"}":{".":{},"f:mountPath":{},"f:name":{}},"k:{\"mountPath\":\"/tmp/rabbitmq-plugins/\"}":{".":{},"f:mountPath":{},"f:name":{}},"k:{\"mountPath\":\"/var/lib/rabbitmq/\"}":{".":{},"f:mountPath":{},"f:name":{}},"k:{\"mountPath\":\"/var/lib/rabbitmq/mnesia/\"}":{".":{},"f:mountPath":{},"f:name":{}}}}},"f:restartPolicy":{},"f:schedulerName":{},"f:securityContext":{".":{},"f:fsGroup":{},"f:runAsGroup":{},"f:runAsUser":{}},"f:serviceAccount":{},"f:serviceAccountName":{},"f:terminationGracePeriodSeconds":{},"f:topologySpreadConstraints":{".":{},"k:{\"topologyKey\":\"topology.kubernetes.io/zone\",\"whenUnsatisfiable\":\"ScheduleAnyway\"}":{".":{},"f:labelSelector":{".":{},"f:matchLabels":{".":{},"f:app.kubernetes.io/name":{}}},"f:maxSkew":{},"f:topologyKey":{},"f:whenUnsatisfiable":{}}},"f:volumes":{".":{},"k:{\"name\":\"erlang-cookie-secret\"}":{".":{},"f:name":{},"f:secret":{".":{},"f:defaultMode":{},"f:secretName":{}}},"k:{\"name\":\"plugins-conf\"}":{".":{},"f:configMap":{".":{},"f:defaultMode":{},"f:name":{}},"f:name":{}},"k:{\"name\":\"pod-info\"}":{".":{},"f:downwardAPI":{".":{},"f:defaultMode":{},"f:items":{}},"f:name":{}},"k:{\"name\":\"rabbitmq-confd\"}":{".":{},"f:name":{},"f:projected":{".":{},"f:defaultMode":{},"f:sources":{}}},"k:{\"name\":\"rabbitmq-erlang-cookie\"}":{".":{},"f:emptyDir":{},"f:name":{}},"k:{\"name\":\"rabbitmq-plugins\"}":{".":{},"f:emptyDir":{},"f:name":{}}}}},"f:updateStrategy":{"f:rollingUpdate":{".":{},"f:partition":{}},"f:type":{}},"f:volumeClaimTemplates":{}}}},{"manager":"kube-controller-manager","operation":"Update","apiVersion":"apps/v1","time":"2022-03-18T18:07:23Z","fieldsType":"FieldsV1","fieldsV1":{"f:status":{"f:collisionCount":{},"f:currentReplicas":{},"f:currentRevision":{},"f:observedGeneration":{},"f:readyReplicas":{},"f:replicas":{},"f:updateRevision":{},"f:updatedReplicas":{}}}}]},"spec":{"replicas":1,"selector":{"matchLabels":{"app.kubernetes.io/name":"rabbitmq-cluster"}},"template":{"metadata":{"creationTimestamp":null,"labels":{"app.kubernetes.io/component":"rabbitmq","app.kubernetes.io/name":"rabbitmq-cluster","app.kubernetes.io/part-of":"rabbitmq"},"annotations":{"prometheus.io/port":"15692","prometheus.io/scrape":"true"}},"spec":{"volumes":[{"name":"plugins-conf","configMap":{"name":"rabbitmq-cluster-plugins-conf","defaultMode":420}},{"name":"rabbitmq-confd","projected":{"sources":[{"secret":{"name":"rabbitmq-cluster-default-user","items":[{"key":"default_user.conf","path":"default_user.conf"}]}},{"configMap":{"name":"rabbitmq-cluster-server-conf","items":[{"key":"operatorDefaults.conf","path":"operatorDefaults.conf"},{"key":"userDefinedConfiguration.conf","path":"userDefinedConfiguration.conf"}]}}],"defaultMode":420}},{"name":"rabbitmq-erlang-cookie","emptyDir":{}},{"name":"erlang-cookie-secret","secret":{"secretName":"rabbitmq-cluster-erlang-cookie","defaultMode":420}},{"name":"rabbitmq-plugins","emptyDir":{}},{"name":"pod-info","downwardAPI":{"items":[{"path":"skipPreStopChecks","fieldRef":{"apiVersion":"v1","fieldPath":"metadata.labels['skipPreStopChecks']"}}],"defaultMode":420}}],"initContainers":[{"name":"setup-container","image":"rabbitmq:3.8.12-management","command":["sh","-c","cp /tmp/erlang-cookie-secret/.erlang.cookie /var/lib/rabbitmq/.erlang.cookie \u0026\u0026 chown 999:999 /var/lib/rabbitmq/.erlang.cookie \u0026\u0026 chmod 600 /var/lib/rabbitmq/.erlang.cookie ; cp /tmp/rabbitmq-plugins/enabled_plugins /operator/enabled_plugins \u0026\u0026 chown 999:999 /operator/enabled_plugins ; chown 999:999 /var/lib/rabbitmq/mnesia/ ; echo '[default]' \u003e /var/lib/rabbitmq/.rabbitmqadmin.conf \u0026\u0026 sed -e 's/default_user/username/' -e 's/default_pass/password/' /tmp/default_user.conf \u003e\u003e /var/lib/rabbitmq/.rabbitmqadmin.conf \u0026\u0026 chown 999:999 /var/lib/rabbitmq/.rabbitmqadmin.conf \u0026\u0026 chmod 600 /var/lib/rabbitmq/.rabbitmqadmin.conf"],"resources":{"limits":{"cpu":"100m","memory":"500Mi"},"requests":{"cpu":"100m","memory":"500Mi"}},"volumeMounts":[{"name":"plugins-conf","mountPath":"/tmp/rabbitmq-plugins/"},{"name":"rabbitmq-erlang-cookie","mountPath":"/var/lib/rabbitmq/"},{"name":"erlang-cookie-secret","mountPath":"/tmp/erlang-cookie-secret/"},{"name":"rabbitmq-plugins","mountPath":"/operator"},{"name":"persistence","mountPath":"/var/lib/rabbitmq/mnesia/"},{"name":"rabbitmq-confd","mountPath":"/tmp/default_user.conf","subPath":"default_user.conf"}],"terminationMessagePath":"/dev/termination-log","terminationMessagePolicy":"File","imagePullPolicy":"IfNotPresent","securityContext":{"capabilities":{"drop":["FSETID","KILL","SETGID","SETUID","SETPCAP","NET_BIND_SERVICE","NET_RAW","SYS_CHROOT","MKNOD","AUDIT_WRITE","SETFCAP"]},"runAsUser":0}}],"containers":[{"name":"rabbitmq","image":"rabbitmq:3.8.12-management","ports":[{"name":"epmd","containerPort":4369,"protocol":"TCP"},{"name":"amqp","containerPort":5672,"protocol":"TCP"},{"name":"management","containerPort":15672,"protocol":"TCP"},{"name":"prometheus","containerPort":15692,"protocol":"TCP"}],"env":[{"name":"MY_POD_NAME","valueFrom":{"fieldRef":{"apiVersion":"v1","fieldPath":"metadata.name"}}},{"name":"MY_POD_NAMESPACE","valueFrom":{"fieldRef":{"apiVersion":"v1","fieldPath":"metadata.namespace"}}},{"name":"RABBITMQ_ENABLED_PLUGINS_FILE","value":"/operator/enabled_plugins"},{"name":"K8S_SERVICE_NAME","value":"rabbitmq-cluster-nodes"},{"name":"RABBITMQ_USE_LONGNAME","value":"true"},{"name":"RABBITMQ_NODENAME","value":"rabbit@$(MY_POD_NAME).$(K8S_SERVICE_NAME).$(MY_POD_NAMESPACE)"},{"name":"K8S_HOSTNAME_SUFFIX","value":".$(K8S_SERVICE_NAME).$(MY_POD_NAMESPACE)"}],"resources":{"limits":{"cpu":"2","memory":"2Gi"},"requests":{"cpu":"1","memory":"2Gi"}},"volumeMounts":[{"name":"rabbitmq-erlang-cookie","mountPath":"/var/lib/rabbitmq/"},{"name":"persistence","mountPath":"/var/lib/rabbitmq/mnesia/"},{"name":"rabbitmq-plugins","mountPath":"/operator"},{"name":"rabbitmq-confd","mountPath":"/etc/rabbitmq/conf.d/10-operatorDefaults.conf","subPath":"operatorDefaults.conf"},{"name":"rabbitmq-confd","mountPath":"/etc/rabbitmq/conf.d/11-default_user.conf","subPath":"default_user.conf"},{"name":"rabbitmq-confd","mountPath":"/etc/rabbitmq/conf.d/90-userDefinedConfiguration.conf","subPath":"userDefinedConfiguration.conf"},{"name":"pod-info","mountPath":"/etc/pod-info/"}],"readinessProbe":{"tcpSocket":{"port":"amqp"},"initialDelaySeconds":10,"timeoutSeconds":5,"periodSeconds":10,"successThreshold":1,"failureThreshold":3},"lifecycle":{"preStop":{"exec":{"command":["/bin/bash","-c","if [ ! -z \"$(cat /etc/pod-info/skipPreStopChecks)\" ]; then exit 0; fi; rabbitmq-upgrade await_online_quorum_plus_one -t 604800; rabbitmq-upgrade await_online_synchronized_mirror -t 604800; rabbitmq-upgrade drain -t 604800"]}}},"terminationMessagePath":"/dev/termination-log","terminationMessagePolicy":"File","imagePullPolicy":"IfNotPresent"}],"restartPolicy":"Always","terminationGracePeriodSeconds":604800,"dnsPolicy":"ClusterFirst","serviceAccountName":"rabbitmq-cluster-server","serviceAccount":"rabbitmq-cluster-server","automountServiceAccountToken":true,"securityContext":{"runAsUser":999,"runAsGroup":999,"fsGroup":999},"schedulerName":"default-scheduler","topologySpreadConstraints":[{"maxSkew":1,"topologyKey":"topology.kubernetes.io/zone","whenUnsatisfiable":"ScheduleAnyway","labelSelector":{"matchLabels":{"app.kubernetes.io/name":"rabbitmq-cluster"}}}]}},"volumeClaimTemplates":[{"metadata":{"name":"persistence","namespace":"default","creationTimestamp":null,"labels":{"app.kubernetes.io/component":"rabbitmq","app.kubernetes.io/name":"rabbitmq-cluster","app.kubernetes.io/part-of":"rabbitmq"},"ownerReferences":[{"apiVersion":"rabbitmq.com/v1beta1","kind":"RabbitmqCluster","name":"rabbitmq-cluster","uid":"3ecefa8a-1bec-48a7-9af4-dd0df3339101","controller":true,"blockOwnerDeletion":false}]},"spec":{"accessModes":["ReadWriteOnce"],"resources":{"requests":{"storage":"10Gi"}},"volumeMode":"Filesystem"},"status":{"phase":"Pending"}}],"serviceName":"rabbitmq-cluster-nodes","podManagementPolicy":"Parallel","updateStrategy":{"type":"RollingUpdate","rollingUpdate":{"partition":0}},"revisionHistoryLimit":10},"status":{"observedGeneration":1,"replicas":1,"readyReplicas":1,"currentReplicas":1,"updatedReplicas":1,"currentRevision":"rabbitmq-cluster-server-5f8b8665fb","updateRevision":"rabbitmq-cluster-server-5f8b8665fb","collisionCount":0}}
2022/03/18 18:07:23 learn_server.go:291: [SIEVE-AFTER-READ]	Get	true	configmap	default	rabbitmq-cluster-plugins-conf	github.com/rabbitmq/cluster-operator/controllers.(*RabbitmqClusterReconciler)	NoError	{"kind":"ConfigMap","apiVersion":"v1","metadata":{"name":"rabbitmq-cluster-plugins-conf","namespace":"default","selfLink":"/api/v1/namespaces/default/configmaps/rabbitmq-cluster-plugins-conf","uid":"0aa26eb6-ff3a-4457-a223-284c897db7fe","resourceVersion":"1092","creationTimestamp":"2022-03-18T18:06:25Z","labels":{"app.kubernetes.io/component":"rabbitmq","app.kubernetes.io/name":"rabbitmq-cluster","app.kubernetes.io/part-of":"rabbitmq"},"ownerReferences":[{"apiVersion":"rabbitmq.com/v1beta1","kind":"RabbitmqCluster","name":"rabbitmq-cluster","uid":"3ecefa8a-1bec-48a7-9af4-dd0df3339101","controller":true,"blockOwnerDeletion":true}],"managedFields":[{"manager":"manager","operation":"Update","apiVersion":"v1","time":"2022-03-18T18:06:25Z","fieldsType":"FieldsV1","fieldsV1":{"f:data":{".":{},"f:enabled_plugins":{}},"f:metadata":{"f:labels":{".":{},"f:app.kubernetes.io/component":{},"f:app.kubernetes.io/name":{},"f:app.kubernetes.io/part-of":{}},"f:ownerReferences":{".":{},"k:{\"uid\":\"3ecefa8a-1bec-48a7-9af4-dd0df3339101\"}":{".":{},"f:apiVersion":{},"f:blockOwnerDeletion":{},"f:controller":{},"f:kind":{},"f:name":{},"f:uid":{}}}}}}]},"data":{"enabled_plugins":"[rabbitmq_peer_discovery_k8s,rabbitmq_prometheus,rabbitmq_management]."}}
2022/03/18 18:07:24 learn_server.go:256: [SIEVE-BEFORE-WRITE]	29
2022/03/18 18:07:24 learn_server.go:263: [SIEVE-AFTER-WRITE]	29	Update	statefulset	github.com/rabbitmq/cluster-operator/controllers.(*RabbitmqClusterReconciler)	NoError	{"metadata":{"name":"rabbitmq-cluster-server","namespace":"default","selfLink":"/apis/apps/v1/namespaces/default/statefulsets/rabbitmq-cluster-server","uid":"f2f07f3e-b500-4c48-a5de-8db7eaf37b9a","resourceVersion":"1409","generation":1,"creationTimestamp":"2022-03-18T18:06:25Z","labels":{"app.kubernetes.io/component":"rabbitmq","app.kubernetes.io/name":"rabbitmq-cluster","app.kubernetes.io/part-of":"rabbitmq"},"ownerReferences":[{"apiVersion":"rabbitmq.com/v1beta1","kind":"RabbitmqCluster","name":"rabbitmq-cluster","uid":"3ecefa8a-1bec-48a7-9af4-dd0df3339101","controller":true,"blockOwnerDeletion":true}],"managedFields":[{"manager":"manager","operation":"Update","apiVersion":"apps/v1","time":"2022-03-18T18:06:25Z","fieldsType":"FieldsV1","fieldsV1":{"f:metadata":{"f:labels":{".":{},"f:app.kubernetes.io/component":{},"f:app.kubernetes.io/name":{},"f:app.kubernetes.io/part-of":{}},"f:ownerReferences":{".":{},"k:{\"uid\":\"3ecefa8a-1bec-48a7-9af4-dd0df3339101\"}":{".":{},"f:apiVersion":{},"f:blockOwnerDeletion":{},"f:controller":{},"f:kind":{},"f:name":{},"f:uid":{}}}},"f:spec":{"f:podManagementPolicy":{},"f:replicas":{},"f:revisionHistoryLimit":{},"f:selector":{"f:matchLabels":{".":{},"f:app.kubernetes.io/name":{}}},"f:serviceName":{},"f:template":{"f:metadata":{"f:annotations":{".":{},"f:prometheus.io/port":{},"f:prometheus.io/scrape":{}},"f:labels":{".":{},"f:app.kubernetes.io/component":{},"f:app.kubernetes.io/name":{},"f:app.kubernetes.io/part-of":{}}},"f:spec":{"f:automountServiceAccountToken":{},"f:containers":{"k:{\"name\":\"rabbitmq\"}":{".":{},"f:env":{".":{},"k:{\"name\":\"K8S_HOSTNAME_SUFFIX\"}":{".":{},"f:name":{},"f:value":{}},"k:{\"name\":\"K8S_SERVICE_NAME\"}":{".":{},"f:name":{},"f:value":{}},"k:{\"name\":\"MY_POD_NAME\"}":{".":{},"f:name":{},"f:valueFrom":{".":{},"f:fieldRef":{".":{},"f:apiVersion":{},"f:fieldPath":{}}}},"k:{\"name\":\"MY_POD_NAMESPACE\"}":{".":{},"f:name":{},"f:valueFrom":{".":{},"f:fieldRef":{".":{},"f:apiVersion":{},"f:fieldPath":{}}}},"k:{\"name\":\"RABBITMQ_ENABLED_PLUGINS_FILE\"}":{".":{},"f:name":{},"f:value":{}},"k:{\"name\":\"RABBITMQ_NODENAME\"}":{".":{},"f:name":{},"f:value":{}},"k:{\"name\":\"RABBITMQ_USE_LONGNAME\"}":{".":{},"f:name":{},"f:value":{}}},"f:image":{},"f:imagePullPolicy":{},"f:lifecycle":{".":{},"f:preStop":{".":{},"f:exec":{".":{},"f:command":{}}}},"f:name":{},"f:ports":{".":{},"k:{\"containerPort\":4369,\"protocol\":\"TCP\"}":{".":{},"f:containerPort":{},"f:name":{},"f:protocol":{}},"k:{\"containerPort\":5672,\"protocol\":\"TCP\"}":{".":{},"f:containerPort":{},"f:name":{},"f:protocol":{}},"k:{\"containerPort\":15672,\"protocol\":\"TCP\"}":{".":{},"f:containerPort":{},"f:name":{},"f:protocol":{}},"k:{\"containerPort\":15692,\"protocol\":\"TCP\"}":{".":{},"f:containerPort":{},"f:name":{},"f:protocol":{}}},"f:readinessProbe":{".":{},"f:failureThreshold":{},"f:initialDelaySeconds":{},"f:periodSeconds":{},"f:successThreshold":{},"f:tcpSocket":{".":{},"f:port":{}},"f:timeoutSeconds":{}},"f:resources":{".":{},"f:limits":{".":{},"f:cpu":{},"f:memory":{}},"f:requests":{".":{},"f:cpu":{},"f:memory":{}}},"f:terminationMessagePath":{},"f:terminationMessagePolicy":{},"f:volumeMounts":{".":{},"k:{\"mountPath\":\"/etc/pod-info/\"}":{".":{},"f:mountPath":{},"f:name":{}},"k:{\"mountPath\":\"/etc/rabbitmq/conf.d/10-operatorDefaults.conf\"}":{".":{},"f:mountPath":{},"f:name":{},"f:subPath":{}},"k:{\"mountPath\":\"/etc/rabbitmq/conf.d/11-default_user.conf\"}":{".":{},"f:mountPath":{},"f:name":{},"f:subPath":{}},"k:{\"mountPath\":\"/etc/rabbitmq/conf.d/90-userDefinedConfiguration.conf\"}":{".":{},"f:mountPath":{},"f:name":{},"f:subPath":{}},"k:{\"mountPath\":\"/operator\"}":{".":{},"f:mountPath":{},"f:name":{}},"k:{\"mountPath\":\"/var/lib/rabbitmq/\"}":{".":{},"f:mountPath":{},"f:name":{}},"k:{\"mountPath\":\"/var/lib/rabbitmq/mnesia/\"}":{".":{},"f:mountPath":{},"f:name":{}}}}},"f:dnsPolicy":{},"f:initContainers":{".":{},"k:{\"name\":\"setup-container\"}":{".":{},"f:command":{},"f:image":{},"f:imagePullPolicy":{},"f:name":{},"f:resources":{".":{},"f:limits":{".":{},"f:cpu":{},"f:memory":{}},"f:requests":{".":{},"f:cpu":{},"f:memory":{}}},"f:securityContext":{".":{},"f:capabilities":{".":{},"f:drop":{}},"f:runAsUser":{}},"f:terminationMessagePath":{},"f:terminationMessagePolicy":{},"f:volumeMounts":{".":{},"k:{\"mountPath\":\"/operator\"}":{".":{},"f:mountPath":{},"f:name":{}},"k:{\"mountPath\":\"/tmp/default_user.conf\"}":{".":{},"f:mountPath":{},"f:name":{},"f:subPath":{}},"k:{\"mountPath\":\"/tmp/erlang-cookie-secret/\"}":{".":{},"f:mountPath":{},"f:name":{}},"k:{\"mountPath\":\"/tmp/rabbitmq-plugins/\"}":{".":{},"f:mountPath":{},"f:name":{}},"k:{\"mountPath\":\"/var/lib/rabbitmq/\"}":{".":{},"f:mountPath":{},"f:name":{}},"k:{\"mountPath\":\"/var/lib/rabbitmq/mnesia/\"}":{".":{},"f:mountPath":{},"f:name":{}}}}},"f:restartPolicy":{},"f:schedulerName":{},"f:securityContext":{".":{},"f:fsGroup":{},"f:runAsGroup":{},"f:runAsUser":{}},"f:serviceAccount":{},"f:serviceAccountName":{},"f:terminationGracePeriodSeconds":{},"f:topologySpreadConstraints":{".":{},"k:{\"topologyKey\":\"topology.kubernetes.io/zone\",\"whenUnsatisfiable\":\"ScheduleAnyway\"}":{".":{},"f:labelSelector":{".":{},"f:matchLabels":{".":{},"f:app.kubernetes.io/name":{}}},"f:maxSkew":{},"f:topologyKey":{},"f:whenUnsatisfiable":{}}},"f:volumes":{".":{},"k:{\"name\":\"erlang-cookie-secret\"}":{".":{},"f:name":{},"f:secret":{".":{},"f:defaultMode":{},"f:secretName":{}}},"k:{\"name\":\"plugins-conf\"}":{".":{},"f:configMap":{".":{},"f:defaultMode":{},"f:name":{}},"f:name":{}},"k:{\"name\":\"pod-info\"}":{".":{},"f:downwardAPI":{".":{},"f:defaultMode":{},"f:items":{}},"f:name":{}},"k:{\"name\":\"rabbitmq-confd\"}":{".":{},"f:name":{},"f:projected":{".":{},"f:defaultMode":{},"f:sources":{}}},"k:{\"name\":\"rabbitmq-erlang-cookie\"}":{".":{},"f:emptyDir":{},"f:name":{}},"k:{\"name\":\"rabbitmq-plugins\"}":{".":{},"f:emptyDir":{},"f:name":{}}}}},"f:updateStrategy":{"f:rollingUpdate":{".":{},"f:partition":{}},"f:type":{}},"f:volumeClaimTemplates":{}}}},{"manager":"kube-controller-manager","operation":"Update","apiVersion":"apps/v1","time":"2022-03-18T18:07:23Z","fieldsType":"FieldsV1","fieldsV1":{"f:status":{"f:collisionCount":{},"f:currentReplicas":{},"f:currentRevision":{},"f:observedGeneration":{},"f:readyReplicas":{},"f:replicas":{},"f:updateRevision":{},"f:updatedReplicas":{}}}}]},"spec":{"replicas":1,"selector":{"matchLabels":{"app.kubernetes.io/name":"rabbitmq-cluster"}},"template":{"metadata":{"creationTimestamp":null,"labels":{"app.kubernetes.io/component":"rabbitmq","app.kubernetes.io/name":"rabbitmq-cluster","app.kubernetes.io/part-of":"rabbitmq"},"annotations":{"prometheus.io/port":"15692","prometheus.io/scrape":"true"}},"spec":{"volumes":[{"name":"plugins-conf","configMap":{"name":"rabbitmq-cluster-plugins-conf","defaultMode":420}},{"name":"rabbitmq-confd","projected":{"sources":[{"secret":{"name":"rabbitmq-cluster-default-user","items":[{"key":"default_user.conf","path":"default_user.conf"}]}},{"configMap":{"name":"rabbitmq-cluster-server-conf","items":[{"key":"operatorDefaults.conf","path":"operatorDefaults.conf"},{"key":"userDefinedConfiguration.conf","path":"userDefinedConfiguration.conf"}]}}],"defaultMode":420}},{"name":"rabbitmq-erlang-cookie","emptyDir":{}},{"name":"erlang-cookie-secret","secret":{"secretName":"rabbitmq-cluster-erlang-cookie","defaultMode":420}},{"name":"rabbitmq-plugins","emptyDir":{}},{"name":"pod-info","downwardAPI":{"items":[{"path":"skipPreStopChecks","fieldRef":{"apiVersion":"v1","fieldPath":"metadata.labels['skipPreStopChecks']"}}],"defaultMode":420}}],"initContainers":[{"name":"setup-container","image":"rabbitmq:3.8.12-management","command":["sh","-c","cp /tmp/erlang-cookie-secret/.erlang.cookie /var/lib/rabbitmq/.erlang.cookie \u0026\u0026 chown 999:999 /var/lib/rabbitmq/.erlang.cookie \u0026\u0026 chmod 600 /var/lib/rabbitmq/.erlang.cookie ; cp /tmp/rabbitmq-plugins/enabled_plugins /operator/enabled_plugins \u0026\u0026 chown 999:999 /operator/enabled_plugins ; chown 999:999 /var/lib/rabbitmq/mnesia/ ; echo '[default]' \u003e /var/lib/rabbitmq/.rabbitmqadmin.conf \u0026\u0026 sed -e 's/default_user/username/' -e 's/default_pass/password/' /tmp/default_user.conf \u003e\u003e /var/lib/rabbitmq/.rabbitmqadmin.conf \u0026\u0026 chown 999:999 /var/lib/rabbitmq/.rabbitmqadmin.conf \u0026\u0026 chmod 600 /var/lib/rabbitmq/.rabbitmqadmin.conf"],"resources":{"limits":{"cpu":"100m","memory":"500Mi"},"requests":{"cpu":"100m","memory":"500Mi"}},"volumeMounts":[{"name":"plugins-conf","mountPath":"/tmp/rabbitmq-plugins/"},{"name":"rabbitmq-erlang-cookie","mountPath":"/var/lib/rabbitmq/"},{"name":"erlang-cookie-secret","mountPath":"/tmp/erlang-cookie-secret/"},{"name":"rabbitmq-plugins","mountPath":"/operator"},{"name":"persistence","mountPath":"/var/lib/rabbitmq/mnesia/"},{"name":"rabbitmq-confd","mountPath":"/tmp/default_user.conf","subPath":"default_user.conf"}],"terminationMessagePath":"/dev/termination-log","terminationMessagePolicy":"File","imagePullPolicy":"IfNotPresent","securityContext":{"capabilities":{"drop":["FSETID","KILL","SETGID","SETUID","SETPCAP","NET_BIND_SERVICE","NET_RAW","SYS_CHROOT","MKNOD","AUDIT_WRITE","SETFCAP"]},"runAsUser":0}}],"containers":[{"name":"rabbitmq","image":"rabbitmq:3.8.12-management","ports":[{"name":"epmd","containerPort":4369,"protocol":"TCP"},{"name":"amqp","containerPort":5672,"protocol":"TCP"},{"name":"management","containerPort":15672,"protocol":"TCP"},{"name":"prometheus","containerPort":15692,"protocol":"TCP"}],"env":[{"name":"MY_POD_NAME","valueFrom":{"fieldRef":{"apiVersion":"v1","fieldPath":"metadata.name"}}},{"name":"MY_POD_NAMESPACE","valueFrom":{"fieldRef":{"apiVersion":"v1","fieldPath":"metadata.namespace"}}},{"name":"RABBITMQ_ENABLED_PLUGINS_FILE","value":"/operator/enabled_plugins"},{"name":"K8S_SERVICE_NAME","value":"rabbitmq-cluster-nodes"},{"name":"RABBITMQ_USE_LONGNAME","value":"true"},{"name":"RABBITMQ_NODENAME","value":"rabbit@$(MY_POD_NAME).$(K8S_SERVICE_NAME).$(MY_POD_NAMESPACE)"},{"name":"K8S_HOSTNAME_SUFFIX","value":".$(K8S_SERVICE_NAME).$(MY_POD_NAMESPACE)"}],"resources":{"limits":{"cpu":"2","memory":"2Gi"},"requests":{"cpu":"1","memory":"2Gi"}},"volumeMounts":[{"name":"rabbitmq-erlang-cookie","mountPath":"/var/lib/rabbitmq/"},{"name":"persistence","mountPath":"/var/lib/rabbitmq/mnesia/"},{"name":"rabbitmq-plugins","mountPath":"/operator"},{"name":"rabbitmq-confd","mountPath":"/etc/rabbitmq/conf.d/10-operatorDefaults.conf","subPath":"operatorDefaults.conf"},{"name":"rabbitmq-confd","mountPath":"/etc/rabbitmq/conf.d/11-default_user.conf","subPath":"default_user.conf"},{"name":"rabbitmq-confd","mountPath":"/etc/rabbitmq/conf.d/90-userDefinedConfiguration.conf","subPath":"userDefinedConfiguration.conf"},{"name":"pod-info","mountPath":"/etc/pod-info/"}],"readinessProbe":{"tcpSocket":{"port":"amqp"},"initialDelaySeconds":10,"timeoutSeconds":5,"periodSeconds":10,"successThreshold":1,"failureThreshold":3},"lifecycle":{"preStop":{"exec":{"command":["/bin/bash","-c","if [ ! -z \"$(cat /etc/pod-info/skipPreStopChecks)\" ]; then exit 0; fi; rabbitmq-upgrade await_online_quorum_plus_one -t 604800; rabbitmq-upgrade await_online_synchronized_mirror -t 604800; rabbitmq-upgrade drain -t 604800"]}}},"terminationMessagePath":"/dev/termination-log","terminationMessagePolicy":"File","imagePullPolicy":"IfNotPresent"}],"restartPolicy":"Always","terminationGracePeriodSeconds":604800,"dnsPolicy":"ClusterFirst","serviceAccountName":"rabbitmq-cluster-server","serviceAccount":"rabbitmq-cluster-server","automountServiceAccountToken":true,"securityContext":{"runAsUser":999,"runAsGroup":999,"fsGroup":999},"schedulerName":"default-scheduler","topologySpreadConstraints":[{"maxSkew":1,"topologyKey":"topology.kubernetes.io/zone","whenUnsatisfiable":"ScheduleAnyway","labelSelector":{"matchLabels":{"app.kubernetes.io/name":"rabbitmq-cluster"}}}]}},"volumeClaimTemplates":[{"metadata":{"name":"persistence","namespace":"default","creationTimestamp":null,"labels":{"app.kubernetes.io/component":"rabbitmq","app.kubernetes.io/name":"rabbitmq-cluster","app.kubernetes.io/part-of":"rabbitmq"},"ownerReferences":[{"apiVersion":"rabbitmq.com/v1beta1","kind":"RabbitmqCluster","name":"rabbitmq-cluster","uid":"3ecefa8a-1bec-48a7-9af4-dd0df3339101","controller":true,"blockOwnerDeletion":false}]},"spec":{"accessModes":["ReadWriteOnce"],"resources":{"requests":{"storage":"10Gi"}},"volumeMode":"Filesystem"},"status":{"phase":"Pending"}}],"serviceName":"rabbitmq-cluster-nodes","podManagementPolicy":"Parallel","updateStrategy":{"type":"RollingUpdate","rollingUpdate":{"partition":0}},"revisionHistoryLimit":10},"status":{"observedGeneration":1,"replicas":1,"readyReplicas":1,"currentReplicas":1,"updatedReplicas":1,"currentRevision":"rabbitmq-cluster-server-5f8b8665fb","updateRevision":"rabbitmq-cluster-server-5f8b8665fb","collisionCount":0}}
2022/03/18 18:07:24 learn_server.go:256: [SIEVE-BEFORE-WRITE]	30
2022/03/18 18:07:24 learn_server.go:279: [SIEVE-BEFORE-HEAR]	20	Updated	statefulset	{"metadata":{"name":"rabbitmq-cluster-server","namespace":"default","selfLink":"/apis/apps/v1/namespaces/default/statefulsets/rabbitmq-cluster-server","uid":"f2f07f3e-b500-4c48-a5de-8db7eaf37b9a","resourceVersion":"1409","generation":1,"creationTimestamp":"2022-03-18T18:06:25Z","labels":{"app.kubernetes.io/component":"rabbitmq","app.kubernetes.io/name":"rabbitmq-cluster","app.kubernetes.io/part-of":"rabbitmq"},"ownerReferences":[{"apiVersion":"rabbitmq.com/v1beta1","kind":"RabbitmqCluster","name":"rabbitmq-cluster","uid":"3ecefa8a-1bec-48a7-9af4-dd0df3339101","controller":true,"blockOwnerDeletion":true}],"managedFields":[{"manager":"manager","operation":"Update","apiVersion":"apps/v1","time":"2022-03-18T18:06:25Z","fieldsType":"FieldsV1","fieldsV1":{"f:metadata":{"f:labels":{".":{},"f:app.kubernetes.io/component":{},"f:app.kubernetes.io/name":{},"f:app.kubernetes.io/part-of":{}},"f:ownerReferences":{".":{},"k:{\"uid\":\"3ecefa8a-1bec-48a7-9af4-dd0df3339101\"}":{".":{},"f:apiVersion":{},"f:blockOwnerDeletion":{},"f:controller":{},"f:kind":{},"f:name":{},"f:uid":{}}}},"f:spec":{"f:podManagementPolicy":{},"f:replicas":{},"f:revisionHistoryLimit":{},"f:selector":{"f:matchLabels":{".":{},"f:app.kubernetes.io/name":{}}},"f:serviceName":{},"f:template":{"f:metadata":{"f:annotations":{".":{},"f:prometheus.io/port":{},"f:prometheus.io/scrape":{}},"f:labels":{".":{},"f:app.kubernetes.io/component":{},"f:app.kubernetes.io/name":{},"f:app.kubernetes.io/part-of":{}}},"f:spec":{"f:automountServiceAccountToken":{},"f:containers":{"k:{\"name\":\"rabbitmq\"}":{".":{},"f:env":{".":{},"k:{\"name\":\"K8S_HOSTNAME_SUFFIX\"}":{".":{},"f:name":{},"f:value":{}},"k:{\"name\":\"K8S_SERVICE_NAME\"}":{".":{},"f:name":{},"f:value":{}},"k:{\"name\":\"MY_POD_NAME\"}":{".":{},"f:name":{},"f:valueFrom":{".":{},"f:fieldRef":{".":{},"f:apiVersion":{},"f:fieldPath":{}}}},"k:{\"name\":\"MY_POD_NAMESPACE\"}":{".":{},"f:name":{},"f:valueFrom":{".":{},"f:fieldRef":{".":{},"f:apiVersion":{},"f:fieldPath":{}}}},"k:{\"name\":\"RABBITMQ_ENABLED_PLUGINS_FILE\"}":{".":{},"f:name":{},"f:value":{}},"k:{\"name\":\"RABBITMQ_NODENAME\"}":{".":{},"f:name":{},"f:value":{}},"k:{\"name\":\"RABBITMQ_USE_LONGNAME\"}":{".":{},"f:name":{},"f:value":{}}},"f:image":{},"f:imagePullPolicy":{},"f:lifecycle":{".":{},"f:preStop":{".":{},"f:exec":{".":{},"f:command":{}}}},"f:name":{},"f:ports":{".":{},"k:{\"containerPort\":4369,\"protocol\":\"TCP\"}":{".":{},"f:containerPort":{},"f:name":{},"f:protocol":{}},"k:{\"containerPort\":5672,\"protocol\":\"TCP\"}":{".":{},"f:containerPort":{},"f:name":{},"f:protocol":{}},"k:{\"containerPort\":15672,\"protocol\":\"TCP\"}":{".":{},"f:containerPort":{},"f:name":{},"f:protocol":{}},"k:{\"containerPort\":15692,\"protocol\":\"TCP\"}":{".":{},"f:containerPort":{},"f:name":{},"f:protocol":{}}},"f:readinessProbe":{".":{},"f:failureThreshold":{},"f:initialDelaySeconds":{},"f:periodSeconds":{},"f:successThreshold":{},"f:tcpSocket":{".":{},"f:port":{}},"f:timeoutSeconds":{}},"f:resources":{".":{},"f:limits":{".":{},"f:cpu":{},"f:memory":{}},"f:requests":{".":{},"f:cpu":{},"f:memory":{}}},"f:terminationMessagePath":{},"f:terminationMessagePolicy":{},"f:volumeMounts":{".":{},"k:{\"mountPath\":\"/etc/pod-info/\"}":{".":{},"f:mountPath":{},"f:name":{}},"k:{\"mountPath\":\"/etc/rabbitmq/conf.d/10-operatorDefaults.conf\"}":{".":{},"f:mountPath":{},"f:name":{},"f:subPath":{}},"k:{\"mountPath\":\"/etc/rabbitmq/conf.d/11-default_user.conf\"}":{".":{},"f:mountPath":{},"f:name":{},"f:subPath":{}},"k:{\"mountPath\":\"/etc/rabbitmq/conf.d/90-userDefinedConfiguration.conf\"}":{".":{},"f:mountPath":{},"f:name":{},"f:subPath":{}},"k:{\"mountPath\":\"/operator\"}":{".":{},"f:mountPath":{},"f:name":{}},"k:{\"mountPath\":\"/var/lib/rabbitmq/\"}":{".":{},"f:mountPath":{},"f:name":{}},"k:{\"mountPath\":\"/var/lib/rabbitmq/mnesia/\"}":{".":{},"f:mountPath":{},"f:name":{}}}}},"f:dnsPolicy":{},"f:initContainers":{".":{},"k:{\"name\":\"setup-container\"}":{".":{},"f:command":{},"f:image":{},"f:imagePullPolicy":{},"f:name":{},"f:resources":{".":{},"f:limits":{".":{},"f:cpu":{},"f:memory":{}},"f:requests":{".":{},"f:cpu":{},"f:memory":{}}},"f:securityContext":{".":{},"f:capabilities":{".":{},"f:drop":{}},"f:runAsUser":{}},"f:terminationMessagePath":{},"f:terminationMessagePolicy":{},"f:volumeMounts":{".":{},"k:{\"mountPath\":\"/operator\"}":{".":{},"f:mountPath":{},"f:name":{}},"k:{\"mountPath\":\"/tmp/default_user.conf\"}":{".":{},"f:mountPath":{},"f:name":{},"f:subPath":{}},"k:{\"mountPath\":\"/tmp/erlang-cookie-secret/\"}":{".":{},"f:mountPath":{},"f:name":{}},"k:{\"mountPath\":\"/tmp/rabbitmq-plugins/\"}":{".":{},"f:mountPath":{},"f:name":{}},"k:{\"mountPath\":\"/var/lib/rabbitmq/\"}":{".":{},"f:mountPath":{},"f:name":{}},"k:{\"mountPath\":\"/var/lib/rabbitmq/mnesia/\"}":{".":{},"f:mountPath":{},"f:name":{}}}}},"f:restartPolicy":{},"f:schedulerName":{},"f:securityContext":{".":{},"f:fsGroup":{},"f:runAsGroup":{},"f:runAsUser":{}},"f:serviceAccount":{},"f:serviceAccountName":{},"f:terminationGracePeriodSeconds":{},"f:topologySpreadConstraints":{".":{},"k:{\"topologyKey\":\"topology.kubernetes.io/zone\",\"whenUnsatisfiable\":\"ScheduleAnyway\"}":{".":{},"f:labelSelector":{".":{},"f:matchLabels":{".":{},"f:app.kubernetes.io/name":{}}},"f:maxSkew":{},"f:topologyKey":{},"f:whenUnsatisfiable":{}}},"f:volumes":{".":{},"k:{\"name\":\"erlang-cookie-secret\"}":{".":{},"f:name":{},"f:secret":{".":{},"f:defaultMode":{},"f:secretName":{}}},"k:{\"name\":\"plugins-conf\"}":{".":{},"f:configMap":{".":{},"f:defaultMode":{},"f:name":{}},"f:name":{}},"k:{\"name\":\"pod-info\"}":{".":{},"f:downwardAPI":{".":{},"f:defaultMode":{},"f:items":{}},"f:name":{}},"k:{\"name\":\"rabbitmq-confd\"}":{".":{},"f:name":{},"f:projected":{".":{},"f:defaultMode":{},"f:sources":{}}},"k:{\"name\":\"rabbitmq-erlang-cookie\"}":{".":{},"f:emptyDir":{},"f:name":{}},"k:{\"name\":\"rabbitmq-plugins\"}":{".":{},"f:emptyDir":{},"f:name":{}}}}},"f:updateStrategy":{"f:rollingUpdate":{".":{},"f:partition":{}},"f:type":{}},"f:volumeClaimTemplates":{}}}},{"manager":"kube-controller-manager","operation":"Update","apiVersion":"apps/v1","time":"2022-03-18T18:07:23Z","fieldsType":"FieldsV1","fieldsV1":{"f:status":{"f:collisionCount":{},"f:currentReplicas":{},"f:currentRevision":{},"f:observedGeneration":{},"f:readyReplicas":{},"f:replicas":{},"f:updateRevision":{},"f:updatedReplicas":{}}}}]},"spec":{"replicas":1,"selector":{"matchLabels":{"app.kubernetes.io/name":"rabbitmq-cluster"}},"template":{"metadata":{"creationTimestamp":null,"labels":{"app.kubernetes.io/component":"rabbitmq","app.kubernetes.io/name":"rabbitmq-cluster","app.kubernetes.io/part-of":"rabbitmq"},"annotations":{"prometheus.io/port":"15692","prometheus.io/scrape":"true"}},"spec":{"volumes":[{"name":"plugins-conf","configMap":{"name":"rabbitmq-cluster-plugins-conf","defaultMode":420}},{"name":"rabbitmq-confd","projected":{"sources":[{"secret":{"name":"rabbitmq-cluster-default-user","items":[{"key":"default_user.conf","path":"default_user.conf"}]}},{"configMap":{"name":"rabbitmq-cluster-server-conf","items":[{"key":"operatorDefaults.conf","path":"operatorDefaults.conf"},{"key":"userDefinedConfiguration.conf","path":"userDefinedConfiguration.conf"}]}}],"defaultMode":420}},{"name":"rabbitmq-erlang-cookie","emptyDir":{}},{"name":"erlang-cookie-secret","secret":{"secretName":"rabbitmq-cluster-erlang-cookie","defaultMode":420}},{"name":"rabbitmq-plugins","emptyDir":{}},{"name":"pod-info","downwardAPI":{"items":[{"path":"skipPreStopChecks","fieldRef":{"apiVersion":"v1","fieldPath":"metadata.labels['skipPreStopChecks']"}}],"defaultMode":420}}],"initContainers":[{"name":"setup-container","image":"rabbitmq:3.8.12-management","command":["sh","-c","cp /tmp/erlang-cookie-secret/.erlang.cookie /var/lib/rabbitmq/.erlang.cookie \u0026\u0026 chown 999:999 /var/lib/rabbitmq/.erlang.cookie \u0026\u0026 chmod 600 /var/lib/rabbitmq/.erlang.cookie ; cp /tmp/rabbitmq-plugins/enabled_plugins /operator/enabled_plugins \u0026\u0026 chown 999:999 /operator/enabled_plugins ; chown 999:999 /var/lib/rabbitmq/mnesia/ ; echo '[default]' \u003e /var/lib/rabbitmq/.rabbitmqadmin.conf \u0026\u0026 sed -e 's/default_user/username/' -e 's/default_pass/password/' /tmp/default_user.conf \u003e\u003e /var/lib/rabbitmq/.rabbitmqadmin.conf \u0026\u0026 chown 999:999 /var/lib/rabbitmq/.rabbitmqadmin.conf \u0026\u0026 chmod 600 /var/lib/rabbitmq/.rabbitmqadmin.conf"],"resources":{"limits":{"cpu":"100m","memory":"500Mi"},"requests":{"cpu":"100m","memory":"500Mi"}},"volumeMounts":[{"name":"plugins-conf","mountPath":"/tmp/rabbitmq-plugins/"},{"name":"rabbitmq-erlang-cookie","mountPath":"/var/lib/rabbitmq/"},{"name":"erlang-cookie-secret","mountPath":"/tmp/erlang-cookie-secret/"},{"name":"rabbitmq-plugins","mountPath":"/operator"},{"name":"persistence","mountPath":"/var/lib/rabbitmq/mnesia/"},{"name":"rabbitmq-confd","mountPath":"/tmp/default_user.conf","subPath":"default_user.conf"}],"terminationMessagePath":"/dev/termination-log","terminationMessagePolicy":"File","imagePullPolicy":"IfNotPresent","securityContext":{"capabilities":{"drop":["FSETID","KILL","SETGID","SETUID","SETPCAP","NET_BIND_SERVICE","NET_RAW","SYS_CHROOT","MKNOD","AUDIT_WRITE","SETFCAP"]},"runAsUser":0}}],"containers":[{"name":"rabbitmq","image":"rabbitmq:3.8.12-management","ports":[{"name":"epmd","containerPort":4369,"protocol":"TCP"},{"name":"amqp","containerPort":5672,"protocol":"TCP"},{"name":"management","containerPort":15672,"protocol":"TCP"},{"name":"prometheus","containerPort":15692,"protocol":"TCP"}],"env":[{"name":"MY_POD_NAME","valueFrom":{"fieldRef":{"apiVersion":"v1","fieldPath":"metadata.name"}}},{"name":"MY_POD_NAMESPACE","valueFrom":{"fieldRef":{"apiVersion":"v1","fieldPath":"metadata.namespace"}}},{"name":"RABBITMQ_ENABLED_PLUGINS_FILE","value":"/operator/enabled_plugins"},{"name":"K8S_SERVICE_NAME","value":"rabbitmq-cluster-nodes"},{"name":"RABBITMQ_USE_LONGNAME","value":"true"},{"name":"RABBITMQ_NODENAME","value":"rabbit@$(MY_POD_NAME).$(K8S_SERVICE_NAME).$(MY_POD_NAMESPACE)"},{"name":"K8S_HOSTNAME_SUFFIX","value":".$(K8S_SERVICE_NAME).$(MY_POD_NAMESPACE)"}],"resources":{"limits":{"cpu":"2","memory":"2Gi"},"requests":{"cpu":"1","memory":"2Gi"}},"volumeMounts":[{"name":"rabbitmq-erlang-cookie","mountPath":"/var/lib/rabbitmq/"},{"name":"persistence","mountPath":"/var/lib/rabbitmq/mnesia/"},{"name":"rabbitmq-plugins","mountPath":"/operator"},{"name":"rabbitmq-confd","mountPath":"/etc/rabbitmq/conf.d/10-operatorDefaults.conf","subPath":"operatorDefaults.conf"},{"name":"rabbitmq-confd","mountPath":"/etc/rabbitmq/conf.d/11-default_user.conf","subPath":"default_user.conf"},{"name":"rabbitmq-confd","mountPath":"/etc/rabbitmq/conf.d/90-userDefinedConfiguration.conf","subPath":"userDefinedConfiguration.conf"},{"name":"pod-info","mountPath":"/etc/pod-info/"}],"readinessProbe":{"tcpSocket":{"port":"amqp"},"initialDelaySeconds":10,"timeoutSeconds":5,"periodSeconds":10,"successThreshold":1,"failureThreshold":3},"lifecycle":{"preStop":{"exec":{"command":["/bin/bash","-c","if [ ! -z \"$(cat /etc/pod-info/skipPreStopChecks)\" ]; then exit 0; fi; rabbitmq-upgrade await_online_quorum_plus_one -t 604800; rabbitmq-upgrade await_online_synchronized_mirror -t 604800; rabbitmq-upgrade drain -t 604800"]}}},"terminationMessagePath":"/dev/termination-log","terminationMessagePolicy":"File","imagePullPolicy":"IfNotPresent"}],"restartPolicy":"Always","terminationGracePeriodSeconds":604800,"dnsPolicy":"ClusterFirst","serviceAccountName":"rabbitmq-cluster-server","serviceAccount":"rabbitmq-cluster-server","automountServiceAccountToken":true,"securityContext":{"runAsUser":999,"runAsGroup":999,"fsGroup":999},"schedulerName":"default-scheduler","topologySpreadConstraints":[{"maxSkew":1,"topologyKey":"topology.kubernetes.io/zone","whenUnsatisfiable":"ScheduleAnyway","labelSelector":{"matchLabels":{"app.kubernetes.io/name":"rabbitmq-cluster"}}}]}},"volumeClaimTemplates":[{"metadata":{"name":"persistence","namespace":"default","creationTimestamp":null,"labels":{"app.kubernetes.io/component":"rabbitmq","app.kubernetes.io/name":"rabbitmq-cluster","app.kubernetes.io/part-of":"rabbitmq"},"ownerReferences":[{"apiVersion":"rabbitmq.com/v1beta1","kind":"RabbitmqCluster","name":"rabbitmq-cluster","uid":"3ecefa8a-1bec-48a7-9af4-dd0df3339101","controller":true,"blockOwnerDeletion":false}]},"spec":{"accessModes":["ReadWriteOnce"],"resources":{"requests":{"storage":"10Gi"}},"volumeMode":"Filesystem"},"status":{"phase":"Pending"}}],"serviceName":"rabbitmq-cluster-nodes","podManagementPolicy":"Parallel","updateStrategy":{"type":"RollingUpdate","rollingUpdate":{"partition":0}},"revisionHistoryLimit":10},"status":{"observedGeneration":1,"replicas":1,"readyReplicas":1,"currentReplicas":1,"updatedReplicas":1,"currentRevision":"rabbitmq-cluster-server-5f8b8665fb","updateRevision":"rabbitmq-cluster-server-5f8b8665fb","collisionCount":0}}
2022/03/18 18:07:24 learn_server.go:289: [SIEVE-AFTER-HEAR]	20
2022/03/18 18:07:24 learn_server.go:279: [SIEVE-BEFORE-HEAR]	21	Updated	rabbitmqcluster	{"metadata":{"name":"rabbitmq-cluster","namespace":"default","selfLink":"/apis/rabbitmq.com/v1beta1/namespaces/default/rabbitmqclusters/rabbitmq-cluster","uid":"3ecefa8a-1bec-48a7-9af4-dd0df3339101","resourceVersion":"1410","generation":2,"creationTimestamp":"2022-03-18T18:06:25Z","annotations":{"kubectl.kubernetes.io/last-applied-configuration":"{\"apiVersion\":\"rabbitmq.com/v1beta1\",\"kind\":\"RabbitmqCluster\",\"metadata\":{\"annotations\":{},\"name\":\"rabbitmq-cluster\",\"namespace\":\"default\"},\"spec\":{\"persistence\":{\"storage\":\"10Gi\"},\"replicas\":1}}\n"},"finalizers":["deletion.finalizers.rabbitmqclusters.rabbitmq.com"],"managedFields":[{"manager":"kubectl-client-side-apply","operation":"Update","apiVersion":"rabbitmq.com/v1beta1","time":"2022-03-18T18:06:25Z","fieldsType":"FieldsV1","fieldsV1":{"f:metadata":{"f:annotations":{".":{},"f:kubectl.kubernetes.io/last-applied-configuration":{}}},"f:spec":{".":{},"f:image":{},"f:persistence":{".":{},"f:storage":{}},"f:replicas":{},"f:resources":{".":{},"f:limits":{".":{},"f:memory":{}},"f:requests":{".":{},"f:memory":{}}},"f:service":{".":{},"f:type":{}},"f:terminationGracePeriodSeconds":{}}}},{"manager":"manager","operation":"Update","apiVersion":"rabbitmq.com/v1beta1","time":"2022-03-18T18:07:24Z","fieldsType":"FieldsV1","fieldsV1":{"f:metadata":{"f:finalizers":{}},"f:spec":{"f:override":{},"f:rabbitmq":{},"f:resources":{"f:limits":{"f:cpu":{}},"f:requests":{"f:cpu":{}}},"f:tls":{}},"f:status":{".":{},"f:conditions":{},"f:defaultUser":{".":{},"f:secretReference":{".":{},"f:keys":{".":{},"f:password":{},"f:username":{}},"f:name":{},"f:namespace":{}},"f:serviceReference":{".":{},"f:name":{},"f:namespace":{}}}}}}]},"spec":{"replicas":1,"image":"rabbitmq:3.8.12-management","service":{"type":"ClusterIP"},"persistence":{"storage":"10Gi"},"resources":{"limits":{"cpu":"2","memory":"2Gi"},"requests":{"cpu":"1","memory":"2Gi"}},"rabbitmq":{},"tls":{},"override":{},"terminationGracePeriodSeconds":604800},"status":{"conditions":[{"type":"AllReplicasReady","status":"True","lastTransitionTime":"2022-03-18T18:07:23Z","reason":"AllPodsAreReady"},{"type":"ClusterAvailable","status":"True","lastTransitionTime":"2022-03-18T18:07:23Z","reason":"AtLeastOneEndpointAvailable"},{"type":"NoWarnings","status":"True","lastTransitionTime":"2022-03-18T18:06:25Z","reason":"NoWarnings"},{"type":"ReconcileSuccess","status":"True","lastTransitionTime":"2022-03-18T18:07:24Z","reason":"Success","message":"Finish reconciling"}],"defaultUser":{"secretReference":{"name":"rabbitmq-cluster-default-user","namespace":"default","keys":{"password":"password","username":"username"}},"serviceReference":{"name":"rabbitmq-cluster","namespace":"default"}}}}
2022/03/18 18:07:24 learn_server.go:289: [SIEVE-AFTER-HEAR]	21
2022/03/18 18:07:24 learn_server.go:263: [SIEVE-AFTER-WRITE]	30	StatusUpdate	rabbitmqcluster	github.com/rabbitmq/cluster-operator/controllers.(*RabbitmqClusterReconciler)	NoError	{"metadata":{"name":"rabbitmq-cluster","namespace":"default","selfLink":"/apis/rabbitmq.com/v1beta1/namespaces/default/rabbitmqclusters/rabbitmq-cluster/status","uid":"3ecefa8a-1bec-48a7-9af4-dd0df3339101","resourceVersion":"1410","generation":2,"creationTimestamp":"2022-03-18T18:06:25Z","annotations":{"kubectl.kubernetes.io/last-applied-configuration":"{\"apiVersion\":\"rabbitmq.com/v1beta1\",\"kind\":\"RabbitmqCluster\",\"metadata\":{\"annotations\":{},\"name\":\"rabbitmq-cluster\",\"namespace\":\"default\"},\"spec\":{\"persistence\":{\"storage\":\"10Gi\"},\"replicas\":1}}\n"},"finalizers":["deletion.finalizers.rabbitmqclusters.rabbitmq.com"],"managedFields":[{"manager":"kubectl-client-side-apply","operation":"Update","apiVersion":"rabbitmq.com/v1beta1","time":"2022-03-18T18:06:25Z","fieldsType":"FieldsV1","fieldsV1":{"f:metadata":{"f:annotations":{".":{},"f:kubectl.kubernetes.io/last-applied-configuration":{}}},"f:spec":{".":{},"f:image":{},"f:persistence":{".":{},"f:storage":{}},"f:replicas":{},"f:resources":{".":{},"f:limits":{".":{},"f:memory":{}},"f:requests":{".":{},"f:memory":{}}},"f:service":{".":{},"f:type":{}},"f:terminationGracePeriodSeconds":{}}}},{"manager":"manager","operation":"Update","apiVersion":"rabbitmq.com/v1beta1","time":"2022-03-18T18:07:24Z","fieldsType":"FieldsV1","fieldsV1":{"f:metadata":{"f:finalizers":{}},"f:spec":{"f:override":{},"f:rabbitmq":{},"f:resources":{"f:limits":{"f:cpu":{}},"f:requests":{"f:cpu":{}}},"f:tls":{}},"f:status":{".":{},"f:conditions":{},"f:defaultUser":{".":{},"f:secretReference":{".":{},"f:keys":{".":{},"f:password":{},"f:username":{}},"f:name":{},"f:namespace":{}},"f:serviceReference":{".":{},"f:name":{},"f:namespace":{}}}}}}]},"spec":{"replicas":1,"image":"rabbitmq:3.8.12-management","service":{"type":"ClusterIP"},"persistence":{"storage":"10Gi"},"resources":{"limits":{"cpu":"2","memory":"2Gi"},"requests":{"cpu":"1","memory":"2Gi"}},"rabbitmq":{},"tls":{},"override":{},"terminationGracePeriodSeconds":604800},"status":{"conditions":[{"type":"AllReplicasReady","status":"True","lastTransitionTime":"2022-03-18T18:07:23Z","reason":"AllPodsAreReady"},{"type":"ClusterAvailable","status":"True","lastTransitionTime":"2022-03-18T18:07:23Z","reason":"AtLeastOneEndpointAvailable"},{"type":"NoWarnings","status":"True","lastTransitionTime":"2022-03-18T18:06:25Z","reason":"NoWarnings"},{"type":"ReconcileSuccess","status":"True","lastTransitionTime":"2022-03-18T18:07:24Z","reason":"Success","message":"Finish reconciling"}],"defaultUser":{"secretReference":{"name":"rabbitmq-cluster-default-user","namespace":"default","keys":{"password":"password","username":"username"}},"serviceReference":{"name":"rabbitmq-cluster","namespace":"default"}},"binding":{"name":"rabbitmq-cluster-default-user"}}}
2022/03/18 18:07:24 learn_server.go:253: [SIEVE-AFTER-RECONCILE]	github.com/rabbitmq/cluster-operator/controllers.(*RabbitmqClusterReconciler)	6
2022/03/18 18:07:24 learn_server.go:238: [SIEVE-BEFORE-RECONCILE]	github.com/rabbitmq/cluster-operator/controllers.(*RabbitmqClusterReconciler)	7
2022/03/18 18:07:24 learn_server.go:291: [SIEVE-AFTER-READ]	Get	true	rabbitmqcluster	default	rabbitmq-cluster	github.com/rabbitmq/cluster-operator/controllers.(*RabbitmqClusterReconciler)	NoError	{"kind":"RabbitmqCluster","apiVersion":"rabbitmq.com/v1beta1","metadata":{"name":"rabbitmq-cluster","namespace":"default","selfLink":"/apis/rabbitmq.com/v1beta1/namespaces/default/rabbitmqclusters/rabbitmq-cluster","uid":"3ecefa8a-1bec-48a7-9af4-dd0df3339101","resourceVersion":"1410","generation":2,"creationTimestamp":"2022-03-18T18:06:25Z","annotations":{"kubectl.kubernetes.io/last-applied-configuration":"{\"apiVersion\":\"rabbitmq.com/v1beta1\",\"kind\":\"RabbitmqCluster\",\"metadata\":{\"annotations\":{},\"name\":\"rabbitmq-cluster\",\"namespace\":\"default\"},\"spec\":{\"persistence\":{\"storage\":\"10Gi\"},\"replicas\":1}}\n"},"finalizers":["deletion.finalizers.rabbitmqclusters.rabbitmq.com"],"managedFields":[{"manager":"kubectl-client-side-apply","operation":"Update","apiVersion":"rabbitmq.com/v1beta1","time":"2022-03-18T18:06:25Z","fieldsType":"FieldsV1","fieldsV1":{"f:metadata":{"f:annotations":{".":{},"f:kubectl.kubernetes.io/last-applied-configuration":{}}},"f:spec":{".":{},"f:image":{},"f:persistence":{".":{},"f:storage":{}},"f:replicas":{},"f:resources":{".":{},"f:limits":{".":{},"f:memory":{}},"f:requests":{".":{},"f:memory":{}}},"f:service":{".":{},"f:type":{}},"f:terminationGracePeriodSeconds":{}}}},{"manager":"manager","operation":"Update","apiVersion":"rabbitmq.com/v1beta1","time":"2022-03-18T18:07:24Z","fieldsType":"FieldsV1","fieldsV1":{"f:metadata":{"f:finalizers":{}},"f:spec":{"f:override":{},"f:rabbitmq":{},"f:resources":{"f:limits":{"f:cpu":{}},"f:requests":{"f:cpu":{}}},"f:tls":{}},"f:status":{".":{},"f:conditions":{},"f:defaultUser":{".":{},"f:secretReference":{".":{},"f:keys":{".":{},"f:password":{},"f:username":{}},"f:name":{},"f:namespace":{}},"f:serviceReference":{".":{},"f:name":{},"f:namespace":{}}}}}}]},"spec":{"replicas":1,"image":"rabbitmq:3.8.12-management","service":{"type":"ClusterIP"},"persistence":{"storage":"10Gi"},"resources":{"limits":{"cpu":"2","memory":"2Gi"},"requests":{"cpu":"1","memory":"2Gi"}},"rabbitmq":{},"tls":{},"override":{},"terminationGracePeriodSeconds":604800},"status":{"conditions":[{"type":"AllReplicasReady","status":"True","lastTransitionTime":"2022-03-18T18:07:23Z","reason":"AllPodsAreReady"},{"type":"ClusterAvailable","status":"True","lastTransitionTime":"2022-03-18T18:07:23Z","reason":"AtLeastOneEndpointAvailable"},{"type":"NoWarnings","status":"True","lastTransitionTime":"2022-03-18T18:06:25Z","reason":"NoWarnings"},{"type":"ReconcileSuccess","status":"True","lastTransitionTime":"2022-03-18T18:07:24Z","reason":"Success","message":"Finish reconciling"}],"defaultUser":{"secretReference":{"name":"rabbitmq-cluster-default-user","namespace":"default","keys":{"password":"password","username":"username"}},"serviceReference":{"name":"rabbitmq-cluster","namespace":"default"}}}}
2022/03/18 18:07:24 learn_server.go:291: [SIEVE-AFTER-READ]	Get	true	statefulset	default	rabbitmq-cluster-server	github.com/rabbitmq/cluster-operator/controllers.(*RabbitmqClusterReconciler)	NoError	{"kind":"StatefulSet","apiVersion":"apps/v1","metadata":{"name":"rabbitmq-cluster-server","namespace":"default","selfLink":"/apis/apps/v1/namespaces/default/statefulsets/rabbitmq-cluster-server","uid":"f2f07f3e-b500-4c48-a5de-8db7eaf37b9a","resourceVersion":"1409","generation":1,"creationTimestamp":"2022-03-18T18:06:25Z","labels":{"app.kubernetes.io/component":"rabbitmq","app.kubernetes.io/name":"rabbitmq-cluster","app.kubernetes.io/part-of":"rabbitmq"},"ownerReferences":[{"apiVersion":"rabbitmq.com/v1beta1","kind":"RabbitmqCluster","name":"rabbitmq-cluster","uid":"3ecefa8a-1bec-48a7-9af4-dd0df3339101","controller":true,"blockOwnerDeletion":true}],"managedFields":[{"manager":"manager","operation":"Update","apiVersion":"apps/v1","time":"2022-03-18T18:06:25Z","fieldsType":"FieldsV1","fieldsV1":{"f:metadata":{"f:labels":{".":{},"f:app.kubernetes.io/component":{},"f:app.kubernetes.io/name":{},"f:app.kubernetes.io/part-of":{}},"f:ownerReferences":{".":{},"k:{\"uid\":\"3ecefa8a-1bec-48a7-9af4-dd0df3339101\"}":{".":{},"f:apiVersion":{},"f:blockOwnerDeletion":{},"f:controller":{},"f:kind":{},"f:name":{},"f:uid":{}}}},"f:spec":{"f:podManagementPolicy":{},"f:replicas":{},"f:revisionHistoryLimit":{},"f:selector":{"f:matchLabels":{".":{},"f:app.kubernetes.io/name":{}}},"f:serviceName":{},"f:template":{"f:metadata":{"f:annotations":{".":{},"f:prometheus.io/port":{},"f:prometheus.io/scrape":{}},"f:labels":{".":{},"f:app.kubernetes.io/component":{},"f:app.kubernetes.io/name":{},"f:app.kubernetes.io/part-of":{}}},"f:spec":{"f:automountServiceAccountToken":{},"f:containers":{"k:{\"name\":\"rabbitmq\"}":{".":{},"f:env":{".":{},"k:{\"name\":\"K8S_HOSTNAME_SUFFIX\"}":{".":{},"f:name":{},"f:value":{}},"k:{\"name\":\"K8S_SERVICE_NAME\"}":{".":{},"f:name":{},"f:value":{}},"k:{\"name\":\"MY_POD_NAME\"}":{".":{},"f:name":{},"f:valueFrom":{".":{},"f:fieldRef":{".":{},"f:apiVersion":{},"f:fieldPath":{}}}},"k:{\"name\":\"MY_POD_NAMESPACE\"}":{".":{},"f:name":{},"f:valueFrom":{".":{},"f:fieldRef":{".":{},"f:apiVersion":{},"f:fieldPath":{}}}},"k:{\"name\":\"RABBITMQ_ENABLED_PLUGINS_FILE\"}":{".":{},"f:name":{},"f:value":{}},"k:{\"name\":\"RABBITMQ_NODENAME\"}":{".":{},"f:name":{},"f:value":{}},"k:{\"name\":\"RABBITMQ_USE_LONGNAME\"}":{".":{},"f:name":{},"f:value":{}}},"f:image":{},"f:imagePullPolicy":{},"f:lifecycle":{".":{},"f:preStop":{".":{},"f:exec":{".":{},"f:command":{}}}},"f:name":{},"f:ports":{".":{},"k:{\"containerPort\":4369,\"protocol\":\"TCP\"}":{".":{},"f:containerPort":{},"f:name":{},"f:protocol":{}},"k:{\"containerPort\":5672,\"protocol\":\"TCP\"}":{".":{},"f:containerPort":{},"f:name":{},"f:protocol":{}},"k:{\"containerPort\":15672,\"protocol\":\"TCP\"}":{".":{},"f:containerPort":{},"f:name":{},"f:protocol":{}},"k:{\"containerPort\":15692,\"protocol\":\"TCP\"}":{".":{},"f:containerPort":{},"f:name":{},"f:protocol":{}}},"f:readinessProbe":{".":{},"f:failureThreshold":{},"f:initialDelaySeconds":{},"f:periodSeconds":{},"f:successThreshold":{},"f:tcpSocket":{".":{},"f:port":{}},"f:timeoutSeconds":{}},"f:resources":{".":{},"f:limits":{".":{},"f:cpu":{},"f:memory":{}},"f:requests":{".":{},"f:cpu":{},"f:memory":{}}},"f:terminationMessagePath":{},"f:terminationMessagePolicy":{},"f:volumeMounts":{".":{},"k:{\"mountPath\":\"/etc/pod-info/\"}":{".":{},"f:mountPath":{},"f:name":{}},"k:{\"mountPath\":\"/etc/rabbitmq/conf.d/10-operatorDefaults.conf\"}":{".":{},"f:mountPath":{},"f:name":{},"f:subPath":{}},"k:{\"mountPath\":\"/etc/rabbitmq/conf.d/11-default_user.conf\"}":{".":{},"f:mountPath":{},"f:name":{},"f:subPath":{}},"k:{\"mountPath\":\"/etc/rabbitmq/conf.d/90-userDefinedConfiguration.conf\"}":{".":{},"f:mountPath":{},"f:name":{},"f:subPath":{}},"k:{\"mountPath\":\"/operator\"}":{".":{},"f:mountPath":{},"f:name":{}},"k:{\"mountPath\":\"/var/lib/rabbitmq/\"}":{".":{},"f:mountPath":{},"f:name":{}},"k:{\"mountPath\":\"/var/lib/rabbitmq/mnesia/\"}":{".":{},"f:mountPath":{},"f:name":{}}}}},"f:dnsPolicy":{},"f:initContainers":{".":{},"k:{\"name\":\"setup-container\"}":{".":{},"f:command":{},"f:image":{},"f:imagePullPolicy":{},"f:name":{},"f:resources":{".":{},"f:limits":{".":{},"f:cpu":{},"f:memory":{}},"f:requests":{".":{},"f:cpu":{},"f:memory":{}}},"f:securityContext":{".":{},"f:capabilities":{".":{},"f:drop":{}},"f:runAsUser":{}},"f:terminationMessagePath":{},"f:terminationMessagePolicy":{},"f:volumeMounts":{".":{},"k:{\"mountPath\":\"/operator\"}":{".":{},"f:mountPath":{},"f:name":{}},"k:{\"mountPath\":\"/tmp/default_user.conf\"}":{".":{},"f:mountPath":{},"f:name":{},"f:subPath":{}},"k:{\"mountPath\":\"/tmp/erlang-cookie-secret/\"}":{".":{},"f:mountPath":{},"f:name":{}},"k:{\"mountPath\":\"/tmp/rabbitmq-plugins/\"}":{".":{},"f:mountPath":{},"f:name":{}},"k:{\"mountPath\":\"/var/lib/rabbitmq/\"}":{".":{},"f:mountPath":{},"f:name":{}},"k:{\"mountPath\":\"/var/lib/rabbitmq/mnesia/\"}":{".":{},"f:mountPath":{},"f:name":{}}}}},"f:restartPolicy":{},"f:schedulerName":{},"f:securityContext":{".":{},"f:fsGroup":{},"f:runAsGroup":{},"f:runAsUser":{}},"f:serviceAccount":{},"f:serviceAccountName":{},"f:terminationGracePeriodSeconds":{},"f:topologySpreadConstraints":{".":{},"k:{\"topologyKey\":\"topology.kubernetes.io/zone\",\"whenUnsatisfiable\":\"ScheduleAnyway\"}":{".":{},"f:labelSelector":{".":{},"f:matchLabels":{".":{},"f:app.kubernetes.io/name":{}}},"f:maxSkew":{},"f:topologyKey":{},"f:whenUnsatisfiable":{}}},"f:volumes":{".":{},"k:{\"name\":\"erlang-cookie-secret\"}":{".":{},"f:name":{},"f:secret":{".":{},"f:defaultMode":{},"f:secretName":{}}},"k:{\"name\":\"plugins-conf\"}":{".":{},"f:configMap":{".":{},"f:defaultMode":{},"f:name":{}},"f:name":{}},"k:{\"name\":\"pod-info\"}":{".":{},"f:downwardAPI":{".":{},"f:defaultMode":{},"f:items":{}},"f:name":{}},"k:{\"name\":\"rabbitmq-confd\"}":{".":{},"f:name":{},"f:projected":{".":{},"f:defaultMode":{},"f:sources":{}}},"k:{\"name\":\"rabbitmq-erlang-cookie\"}":{".":{},"f:emptyDir":{},"f:name":{}},"k:{\"name\":\"rabbitmq-plugins\"}":{".":{},"f:emptyDir":{},"f:name":{}}}}},"f:updateStrategy":{"f:rollingUpdate":{".":{},"f:partition":{}},"f:type":{}},"f:volumeClaimTemplates":{}}}},{"manager":"kube-controller-manager","operation":"Update","apiVersion":"apps/v1","time":"2022-03-18T18:07:23Z","fieldsType":"FieldsV1","fieldsV1":{"f:status":{"f:collisionCount":{},"f:currentReplicas":{},"f:currentRevision":{},"f:observedGeneration":{},"f:readyReplicas":{},"f:replicas":{},"f:updateRevision":{},"f:updatedReplicas":{}}}}]},"spec":{"replicas":1,"selector":{"matchLabels":{"app.kubernetes.io/name":"rabbitmq-cluster"}},"template":{"metadata":{"creationTimestamp":null,"labels":{"app.kubernetes.io/component":"rabbitmq","app.kubernetes.io/name":"rabbitmq-cluster","app.kubernetes.io/part-of":"rabbitmq"},"annotations":{"prometheus.io/port":"15692","prometheus.io/scrape":"true"}},"spec":{"volumes":[{"name":"plugins-conf","configMap":{"name":"rabbitmq-cluster-plugins-conf","defaultMode":420}},{"name":"rabbitmq-confd","projected":{"sources":[{"secret":{"name":"rabbitmq-cluster-default-user","items":[{"key":"default_user.conf","path":"default_user.conf"}]}},{"configMap":{"name":"rabbitmq-cluster-server-conf","items":[{"key":"operatorDefaults.conf","path":"operatorDefaults.conf"},{"key":"userDefinedConfiguration.conf","path":"userDefinedConfiguration.conf"}]}}],"defaultMode":420}},{"name":"rabbitmq-erlang-cookie","emptyDir":{}},{"name":"erlang-cookie-secret","secret":{"secretName":"rabbitmq-cluster-erlang-cookie","defaultMode":420}},{"name":"rabbitmq-plugins","emptyDir":{}},{"name":"pod-info","downwardAPI":{"items":[{"path":"skipPreStopChecks","fieldRef":{"apiVersion":"v1","fieldPath":"metadata.labels['skipPreStopChecks']"}}],"defaultMode":420}}],"initContainers":[{"name":"setup-container","image":"rabbitmq:3.8.12-management","command":["sh","-c","cp /tmp/erlang-cookie-secret/.erlang.cookie /var/lib/rabbitmq/.erlang.cookie \u0026\u0026 chown 999:999 /var/lib/rabbitmq/.erlang.cookie \u0026\u0026 chmod 600 /var/lib/rabbitmq/.erlang.cookie ; cp /tmp/rabbitmq-plugins/enabled_plugins /operator/enabled_plugins \u0026\u0026 chown 999:999 /operator/enabled_plugins ; chown 999:999 /var/lib/rabbitmq/mnesia/ ; echo '[default]' \u003e /var/lib/rabbitmq/.rabbitmqadmin.conf \u0026\u0026 sed -e 's/default_user/username/' -e 's/default_pass/password/' /tmp/default_user.conf \u003e\u003e /var/lib/rabbitmq/.rabbitmqadmin.conf \u0026\u0026 chown 999:999 /var/lib/rabbitmq/.rabbitmqadmin.conf \u0026\u0026 chmod 600 /var/lib/rabbitmq/.rabbitmqadmin.conf"],"resources":{"limits":{"cpu":"100m","memory":"500Mi"},"requests":{"cpu":"100m","memory":"500Mi"}},"volumeMounts":[{"name":"plugins-conf","mountPath":"/tmp/rabbitmq-plugins/"},{"name":"rabbitmq-erlang-cookie","mountPath":"/var/lib/rabbitmq/"},{"name":"erlang-cookie-secret","mountPath":"/tmp/erlang-cookie-secret/"},{"name":"rabbitmq-plugins","mountPath":"/operator"},{"name":"persistence","mountPath":"/var/lib/rabbitmq/mnesia/"},{"name":"rabbitmq-confd","mountPath":"/tmp/default_user.conf","subPath":"default_user.conf"}],"terminationMessagePath":"/dev/termination-log","terminationMessagePolicy":"File","imagePullPolicy":"IfNotPresent","securityContext":{"capabilities":{"drop":["FSETID","KILL","SETGID","SETUID","SETPCAP","NET_BIND_SERVICE","NET_RAW","SYS_CHROOT","MKNOD","AUDIT_WRITE","SETFCAP"]},"runAsUser":0}}],"containers":[{"name":"rabbitmq","image":"rabbitmq:3.8.12-management","ports":[{"name":"epmd","containerPort":4369,"protocol":"TCP"},{"name":"amqp","containerPort":5672,"protocol":"TCP"},{"name":"management","containerPort":15672,"protocol":"TCP"},{"name":"prometheus","containerPort":15692,"protocol":"TCP"}],"env":[{"name":"MY_POD_NAME","valueFrom":{"fieldRef":{"apiVersion":"v1","fieldPath":"metadata.name"}}},{"name":"MY_POD_NAMESPACE","valueFrom":{"fieldRef":{"apiVersion":"v1","fieldPath":"metadata.namespace"}}},{"name":"RABBITMQ_ENABLED_PLUGINS_FILE","value":"/operator/enabled_plugins"},{"name":"K8S_SERVICE_NAME","value":"rabbitmq-cluster-nodes"},{"name":"RABBITMQ_USE_LONGNAME","value":"true"},{"name":"RABBITMQ_NODENAME","value":"rabbit@$(MY_POD_NAME).$(K8S_SERVICE_NAME).$(MY_POD_NAMESPACE)"},{"name":"K8S_HOSTNAME_SUFFIX","value":".$(K8S_SERVICE_NAME).$(MY_POD_NAMESPACE)"}],"resources":{"limits":{"cpu":"2","memory":"2Gi"},"requests":{"cpu":"1","memory":"2Gi"}},"volumeMounts":[{"name":"rabbitmq-erlang-cookie","mountPath":"/var/lib/rabbitmq/"},{"name":"persistence","mountPath":"/var/lib/rabbitmq/mnesia/"},{"name":"rabbitmq-plugins","mountPath":"/operator"},{"name":"rabbitmq-confd","mountPath":"/etc/rabbitmq/conf.d/10-operatorDefaults.conf","subPath":"operatorDefaults.conf"},{"name":"rabbitmq-confd","mountPath":"/etc/rabbitmq/conf.d/11-default_user.conf","subPath":"default_user.conf"},{"name":"rabbitmq-confd","mountPath":"/etc/rabbitmq/conf.d/90-userDefinedConfiguration.conf","subPath":"userDefinedConfiguration.conf"},{"name":"pod-info","mountPath":"/etc/pod-info/"}],"readinessProbe":{"tcpSocket":{"port":"amqp"},"initialDelaySeconds":10,"timeoutSeconds":5,"periodSeconds":10,"successThreshold":1,"failureThreshold":3},"lifecycle":{"preStop":{"exec":{"command":["/bin/bash","-c","if [ ! -z \"$(cat /etc/pod-info/skipPreStopChecks)\" ]; then exit 0; fi; rabbitmq-upgrade await_online_quorum_plus_one -t 604800; rabbitmq-upgrade await_online_synchronized_mirror -t 604800; rabbitmq-upgrade drain -t 604800"]}}},"terminationMessagePath":"/dev/termination-log","terminationMessagePolicy":"File","imagePullPolicy":"IfNotPresent"}],"restartPolicy":"Always","terminationGracePeriodSeconds":604800,"dnsPolicy":"ClusterFirst","serviceAccountName":"rabbitmq-cluster-server","serviceAccount":"rabbitmq-cluster-server","automountServiceAccountToken":true,"securityContext":{"runAsUser":999,"runAsGroup":999,"fsGroup":999},"schedulerName":"default-scheduler","topologySpreadConstraints":[{"maxSkew":1,"topologyKey":"topology.kubernetes.io/zone","whenUnsatisfiable":"ScheduleAnyway","labelSelector":{"matchLabels":{"app.kubernetes.io/name":"rabbitmq-cluster"}}}]}},"volumeClaimTemplates":[{"metadata":{"name":"persistence","namespace":"default","creationTimestamp":null,"labels":{"app.kubernetes.io/component":"rabbitmq","app.kubernetes.io/name":"rabbitmq-cluster","app.kubernetes.io/part-of":"rabbitmq"},"ownerReferences":[{"apiVersion":"rabbitmq.com/v1beta1","kind":"RabbitmqCluster","name":"rabbitmq-cluster","uid":"3ecefa8a-1bec-48a7-9af4-dd0df3339101","controller":true,"blockOwnerDeletion":false}]},"spec":{"accessModes":["ReadWriteOnce"],"resources":{"requests":{"storage":"10Gi"}},"volumeMode":"Filesystem"},"status":{"phase":"Pending"}}],"serviceName":"rabbitmq-cluster-nodes","podManagementPolicy":"Parallel","updateStrategy":{"type":"RollingUpdate","rollingUpdate":{"partition":0}},"revisionHistoryLimit":10},"status":{"observedGeneration":1,"replicas":1,"readyReplicas":1,"currentReplicas":1,"updatedReplicas":1,"currentRevision":"rabbitmq-cluster-server-5f8b8665fb","updateRevision":"rabbitmq-cluster-server-5f8b8665fb","collisionCount":0}}
2022/03/18 18:07:24 learn_server.go:291: [SIEVE-AFTER-READ]	Get	true	endpoints	default	rabbitmq-cluster	github.com/rabbitmq/cluster-operator/controllers.(*RabbitmqClusterReconciler)	NoError	{"kind":"Endpoints","apiVersion":"v1","metadata":{"name":"rabbitmq-cluster","namespace":"default","selfLink":"/api/v1/namespaces/default/endpoints/rabbitmq-cluster","uid":"eeba9576-0362-4e74-aafd-71e4ffe98d25","resourceVersion":"1402","creationTimestamp":"2022-03-18T18:06:25Z","labels":{"app.kubernetes.io/component":"rabbitmq","app.kubernetes.io/name":"rabbitmq-cluster","app.kubernetes.io/part-of":"rabbitmq"},"annotations":{"endpoints.kubernetes.io/last-change-trigger-time":"2022-03-18T18:07:23Z"},"managedFields":[{"manager":"kube-controller-manager","operation":"Update","apiVersion":"v1","time":"2022-03-18T18:07:23Z","fieldsType":"FieldsV1","fieldsV1":{"f:metadata":{"f:annotations":{".":{},"f:endpoints.kubernetes.io/last-change-trigger-time":{}},"f:labels":{".":{},"f:app.kubernetes.io/component":{},"f:app.kubernetes.io/name":{},"f:app.kubernetes.io/part-of":{}}},"f:subsets":{}}}]},"subsets":[{"addresses":[{"ip":"10.244.1.4","nodeName":"kind-worker","targetRef":{"kind":"Pod","namespace":"default","name":"rabbitmq-cluster-server-0","uid":"cbaba199-5faf-480a-81e8-051ce2cc79e6","resourceVersion":"1399"}}],"ports":[{"name":"amqp","port":5672,"protocol":"TCP"},{"name":"management","port":15672,"protocol":"TCP"}]}]}
2022/03/18 18:07:24 learn_server.go:291: [SIEVE-AFTER-READ]	Get	true	statefulset	default	rabbitmq-cluster-server	github.com/rabbitmq/cluster-operator/controllers.(*RabbitmqClusterReconciler)	NoError	{"kind":"StatefulSet","apiVersion":"apps/v1","metadata":{"name":"rabbitmq-cluster-server","namespace":"default","selfLink":"/apis/apps/v1/namespaces/default/statefulsets/rabbitmq-cluster-server","uid":"f2f07f3e-b500-4c48-a5de-8db7eaf37b9a","resourceVersion":"1409","generation":1,"creationTimestamp":"2022-03-18T18:06:25Z","labels":{"app.kubernetes.io/component":"rabbitmq","app.kubernetes.io/name":"rabbitmq-cluster","app.kubernetes.io/part-of":"rabbitmq"},"ownerReferences":[{"apiVersion":"rabbitmq.com/v1beta1","kind":"RabbitmqCluster","name":"rabbitmq-cluster","uid":"3ecefa8a-1bec-48a7-9af4-dd0df3339101","controller":true,"blockOwnerDeletion":true}],"managedFields":[{"manager":"manager","operation":"Update","apiVersion":"apps/v1","time":"2022-03-18T18:06:25Z","fieldsType":"FieldsV1","fieldsV1":{"f:metadata":{"f:labels":{".":{},"f:app.kubernetes.io/component":{},"f:app.kubernetes.io/name":{},"f:app.kubernetes.io/part-of":{}},"f:ownerReferences":{".":{},"k:{\"uid\":\"3ecefa8a-1bec-48a7-9af4-dd0df3339101\"}":{".":{},"f:apiVersion":{},"f:blockOwnerDeletion":{},"f:controller":{},"f:kind":{},"f:name":{},"f:uid":{}}}},"f:spec":{"f:podManagementPolicy":{},"f:replicas":{},"f:revisionHistoryLimit":{},"f:selector":{"f:matchLabels":{".":{},"f:app.kubernetes.io/name":{}}},"f:serviceName":{},"f:template":{"f:metadata":{"f:annotations":{".":{},"f:prometheus.io/port":{},"f:prometheus.io/scrape":{}},"f:labels":{".":{},"f:app.kubernetes.io/component":{},"f:app.kubernetes.io/name":{},"f:app.kubernetes.io/part-of":{}}},"f:spec":{"f:automountServiceAccountToken":{},"f:containers":{"k:{\"name\":\"rabbitmq\"}":{".":{},"f:env":{".":{},"k:{\"name\":\"K8S_HOSTNAME_SUFFIX\"}":{".":{},"f:name":{},"f:value":{}},"k:{\"name\":\"K8S_SERVICE_NAME\"}":{".":{},"f:name":{},"f:value":{}},"k:{\"name\":\"MY_POD_NAME\"}":{".":{},"f:name":{},"f:valueFrom":{".":{},"f:fieldRef":{".":{},"f:apiVersion":{},"f:fieldPath":{}}}},"k:{\"name\":\"MY_POD_NAMESPACE\"}":{".":{},"f:name":{},"f:valueFrom":{".":{},"f:fieldRef":{".":{},"f:apiVersion":{},"f:fieldPath":{}}}},"k:{\"name\":\"RABBITMQ_ENABLED_PLUGINS_FILE\"}":{".":{},"f:name":{},"f:value":{}},"k:{\"name\":\"RABBITMQ_NODENAME\"}":{".":{},"f:name":{},"f:value":{}},"k:{\"name\":\"RABBITMQ_USE_LONGNAME\"}":{".":{},"f:name":{},"f:value":{}}},"f:image":{},"f:imagePullPolicy":{},"f:lifecycle":{".":{},"f:preStop":{".":{},"f:exec":{".":{},"f:command":{}}}},"f:name":{},"f:ports":{".":{},"k:{\"containerPort\":4369,\"protocol\":\"TCP\"}":{".":{},"f:containerPort":{},"f:name":{},"f:protocol":{}},"k:{\"containerPort\":5672,\"protocol\":\"TCP\"}":{".":{},"f:containerPort":{},"f:name":{},"f:protocol":{}},"k:{\"containerPort\":15672,\"protocol\":\"TCP\"}":{".":{},"f:containerPort":{},"f:name":{},"f:protocol":{}},"k:{\"containerPort\":15692,\"protocol\":\"TCP\"}":{".":{},"f:containerPort":{},"f:name":{},"f:protocol":{}}},"f:readinessProbe":{".":{},"f:failureThreshold":{},"f:initialDelaySeconds":{},"f:periodSeconds":{},"f:successThreshold":{},"f:tcpSocket":{".":{},"f:port":{}},"f:timeoutSeconds":{}},"f:resources":{".":{},"f:limits":{".":{},"f:cpu":{},"f:memory":{}},"f:requests":{".":{},"f:cpu":{},"f:memory":{}}},"f:terminationMessagePath":{},"f:terminationMessagePolicy":{},"f:volumeMounts":{".":{},"k:{\"mountPath\":\"/etc/pod-info/\"}":{".":{},"f:mountPath":{},"f:name":{}},"k:{\"mountPath\":\"/etc/rabbitmq/conf.d/10-operatorDefaults.conf\"}":{".":{},"f:mountPath":{},"f:name":{},"f:subPath":{}},"k:{\"mountPath\":\"/etc/rabbitmq/conf.d/11-default_user.conf\"}":{".":{},"f:mountPath":{},"f:name":{},"f:subPath":{}},"k:{\"mountPath\":\"/etc/rabbitmq/conf.d/90-userDefinedConfiguration.conf\"}":{".":{},"f:mountPath":{},"f:name":{},"f:subPath":{}},"k:{\"mountPath\":\"/operator\"}":{".":{},"f:mountPath":{},"f:name":{}},"k:{\"mountPath\":\"/var/lib/rabbitmq/\"}":{".":{},"f:mountPath":{},"f:name":{}},"k:{\"mountPath\":\"/var/lib/rabbitmq/mnesia/\"}":{".":{},"f:mountPath":{},"f:name":{}}}}},"f:dnsPolicy":{},"f:initContainers":{".":{},"k:{\"name\":\"setup-container\"}":{".":{},"f:command":{},"f:image":{},"f:imagePullPolicy":{},"f:name":{},"f:resources":{".":{},"f:limits":{".":{},"f:cpu":{},"f:memory":{}},"f:requests":{".":{},"f:cpu":{},"f:memory":{}}},"f:securityContext":{".":{},"f:capabilities":{".":{},"f:drop":{}},"f:runAsUser":{}},"f:terminationMessagePath":{},"f:terminationMessagePolicy":{},"f:volumeMounts":{".":{},"k:{\"mountPath\":\"/operator\"}":{".":{},"f:mountPath":{},"f:name":{}},"k:{\"mountPath\":\"/tmp/default_user.conf\"}":{".":{},"f:mountPath":{},"f:name":{},"f:subPath":{}},"k:{\"mountPath\":\"/tmp/erlang-cookie-secret/\"}":{".":{},"f:mountPath":{},"f:name":{}},"k:{\"mountPath\":\"/tmp/rabbitmq-plugins/\"}":{".":{},"f:mountPath":{},"f:name":{}},"k:{\"mountPath\":\"/var/lib/rabbitmq/\"}":{".":{},"f:mountPath":{},"f:name":{}},"k:{\"mountPath\":\"/var/lib/rabbitmq/mnesia/\"}":{".":{},"f:mountPath":{},"f:name":{}}}}},"f:restartPolicy":{},"f:schedulerName":{},"f:securityContext":{".":{},"f:fsGroup":{},"f:runAsGroup":{},"f:runAsUser":{}},"f:serviceAccount":{},"f:serviceAccountName":{},"f:terminationGracePeriodSeconds":{},"f:topologySpreadConstraints":{".":{},"k:{\"topologyKey\":\"topology.kubernetes.io/zone\",\"whenUnsatisfiable\":\"ScheduleAnyway\"}":{".":{},"f:labelSelector":{".":{},"f:matchLabels":{".":{},"f:app.kubernetes.io/name":{}}},"f:maxSkew":{},"f:topologyKey":{},"f:whenUnsatisfiable":{}}},"f:volumes":{".":{},"k:{\"name\":\"erlang-cookie-secret\"}":{".":{},"f:name":{},"f:secret":{".":{},"f:defaultMode":{},"f:secretName":{}}},"k:{\"name\":\"plugins-conf\"}":{".":{},"f:configMap":{".":{},"f:defaultMode":{},"f:name":{}},"f:name":{}},"k:{\"name\":\"pod-info\"}":{".":{},"f:downwardAPI":{".":{},"f:defaultMode":{},"f:items":{}},"f:name":{}},"k:{\"name\":\"rabbitmq-confd\"}":{".":{},"f:name":{},"f:projected":{".":{},"f:defaultMode":{},"f:sources":{}}},"k:{\"name\":\"rabbitmq-erlang-cookie\"}":{".":{},"f:emptyDir":{},"f:name":{}},"k:{\"name\":\"rabbitmq-plugins\"}":{".":{},"f:emptyDir":{},"f:name":{}}}}},"f:updateStrategy":{"f:rollingUpdate":{".":{},"f:partition":{}},"f:type":{}},"f:volumeClaimTemplates":{}}}},{"manager":"kube-controller-manager","operation":"Update","apiVersion":"apps/v1","time":"2022-03-18T18:07:23Z","fieldsType":"FieldsV1","fieldsV1":{"f:status":{"f:collisionCount":{},"f:currentReplicas":{},"f:currentRevision":{},"f:observedGeneration":{},"f:readyReplicas":{},"f:replicas":{},"f:updateRevision":{},"f:updatedReplicas":{}}}}]},"spec":{"replicas":1,"selector":{"matchLabels":{"app.kubernetes.io/name":"rabbitmq-cluster"}},"template":{"metadata":{"creationTimestamp":null,"labels":{"app.kubernetes.io/component":"rabbitmq","app.kubernetes.io/name":"rabbitmq-cluster","app.kubernetes.io/part-of":"rabbitmq"},"annotations":{"prometheus.io/port":"15692","prometheus.io/scrape":"true"}},"spec":{"volumes":[{"name":"plugins-conf","configMap":{"name":"rabbitmq-cluster-plugins-conf","defaultMode":420}},{"name":"rabbitmq-confd","projected":{"sources":[{"secret":{"name":"rabbitmq-cluster-default-user","items":[{"key":"default_user.conf","path":"default_user.conf"}]}},{"configMap":{"name":"rabbitmq-cluster-server-conf","items":[{"key":"operatorDefaults.conf","path":"operatorDefaults.conf"},{"key":"userDefinedConfiguration.conf","path":"userDefinedConfiguration.conf"}]}}],"defaultMode":420}},{"name":"rabbitmq-erlang-cookie","emptyDir":{}},{"name":"erlang-cookie-secret","secret":{"secretName":"rabbitmq-cluster-erlang-cookie","defaultMode":420}},{"name":"rabbitmq-plugins","emptyDir":{}},{"name":"pod-info","downwardAPI":{"items":[{"path":"skipPreStopChecks","fieldRef":{"apiVersion":"v1","fieldPath":"metadata.labels['skipPreStopChecks']"}}],"defaultMode":420}}],"initContainers":[{"name":"setup-container","image":"rabbitmq:3.8.12-management","command":["sh","-c","cp /tmp/erlang-cookie-secret/.erlang.cookie /var/lib/rabbitmq/.erlang.cookie \u0026\u0026 chown 999:999 /var/lib/rabbitmq/.erlang.cookie \u0026\u0026 chmod 600 /var/lib/rabbitmq/.erlang.cookie ; cp /tmp/rabbitmq-plugins/enabled_plugins /operator/enabled_plugins \u0026\u0026 chown 999:999 /operator/enabled_plugins ; chown 999:999 /var/lib/rabbitmq/mnesia/ ; echo '[default]' \u003e /var/lib/rabbitmq/.rabbitmqadmin.conf \u0026\u0026 sed -e 's/default_user/username/' -e 's/default_pass/password/' /tmp/default_user.conf \u003e\u003e /var/lib/rabbitmq/.rabbitmqadmin.conf \u0026\u0026 chown 999:999 /var/lib/rabbitmq/.rabbitmqadmin.conf \u0026\u0026 chmod 600 /var/lib/rabbitmq/.rabbitmqadmin.conf"],"resources":{"limits":{"cpu":"100m","memory":"500Mi"},"requests":{"cpu":"100m","memory":"500Mi"}},"volumeMounts":[{"name":"plugins-conf","mountPath":"/tmp/rabbitmq-plugins/"},{"name":"rabbitmq-erlang-cookie","mountPath":"/var/lib/rabbitmq/"},{"name":"erlang-cookie-secret","mountPath":"/tmp/erlang-cookie-secret/"},{"name":"rabbitmq-plugins","mountPath":"/operator"},{"name":"persistence","mountPath":"/var/lib/rabbitmq/mnesia/"},{"name":"rabbitmq-confd","mountPath":"/tmp/default_user.conf","subPath":"default_user.conf"}],"terminationMessagePath":"/dev/termination-log","terminationMessagePolicy":"File","imagePullPolicy":"IfNotPresent","securityContext":{"capabilities":{"drop":["FSETID","KILL","SETGID","SETUID","SETPCAP","NET_BIND_SERVICE","NET_RAW","SYS_CHROOT","MKNOD","AUDIT_WRITE","SETFCAP"]},"runAsUser":0}}],"containers":[{"name":"rabbitmq","image":"rabbitmq:3.8.12-management","ports":[{"name":"epmd","containerPort":4369,"protocol":"TCP"},{"name":"amqp","containerPort":5672,"protocol":"TCP"},{"name":"management","containerPort":15672,"protocol":"TCP"},{"name":"prometheus","containerPort":15692,"protocol":"TCP"}],"env":[{"name":"MY_POD_NAME","valueFrom":{"fieldRef":{"apiVersion":"v1","fieldPath":"metadata.name"}}},{"name":"MY_POD_NAMESPACE","valueFrom":{"fieldRef":{"apiVersion":"v1","fieldPath":"metadata.namespace"}}},{"name":"RABBITMQ_ENABLED_PLUGINS_FILE","value":"/operator/enabled_plugins"},{"name":"K8S_SERVICE_NAME","value":"rabbitmq-cluster-nodes"},{"name":"RABBITMQ_USE_LONGNAME","value":"true"},{"name":"RABBITMQ_NODENAME","value":"rabbit@$(MY_POD_NAME).$(K8S_SERVICE_NAME).$(MY_POD_NAMESPACE)"},{"name":"K8S_HOSTNAME_SUFFIX","value":".$(K8S_SERVICE_NAME).$(MY_POD_NAMESPACE)"}],"resources":{"limits":{"cpu":"2","memory":"2Gi"},"requests":{"cpu":"1","memory":"2Gi"}},"volumeMounts":[{"name":"rabbitmq-erlang-cookie","mountPath":"/var/lib/rabbitmq/"},{"name":"persistence","mountPath":"/var/lib/rabbitmq/mnesia/"},{"name":"rabbitmq-plugins","mountPath":"/operator"},{"name":"rabbitmq-confd","mountPath":"/etc/rabbitmq/conf.d/10-operatorDefaults.conf","subPath":"operatorDefaults.conf"},{"name":"rabbitmq-confd","mountPath":"/etc/rabbitmq/conf.d/11-default_user.conf","subPath":"default_user.conf"},{"name":"rabbitmq-confd","mountPath":"/etc/rabbitmq/conf.d/90-userDefinedConfiguration.conf","subPath":"userDefinedConfiguration.conf"},{"name":"pod-info","mountPath":"/etc/pod-info/"}],"readinessProbe":{"tcpSocket":{"port":"amqp"},"initialDelaySeconds":10,"timeoutSeconds":5,"periodSeconds":10,"successThreshold":1,"failureThreshold":3},"lifecycle":{"preStop":{"exec":{"command":["/bin/bash","-c","if [ ! -z \"$(cat /etc/pod-info/skipPreStopChecks)\" ]; then exit 0; fi; rabbitmq-upgrade await_online_quorum_plus_one -t 604800; rabbitmq-upgrade await_online_synchronized_mirror -t 604800; rabbitmq-upgrade drain -t 604800"]}}},"terminationMessagePath":"/dev/termination-log","terminationMessagePolicy":"File","imagePullPolicy":"IfNotPresent"}],"restartPolicy":"Always","terminationGracePeriodSeconds":604800,"dnsPolicy":"ClusterFirst","serviceAccountName":"rabbitmq-cluster-server","serviceAccount":"rabbitmq-cluster-server","automountServiceAccountToken":true,"securityContext":{"runAsUser":999,"runAsGroup":999,"fsGroup":999},"schedulerName":"default-scheduler","topologySpreadConstraints":[{"maxSkew":1,"topologyKey":"topology.kubernetes.io/zone","whenUnsatisfiable":"ScheduleAnyway","labelSelector":{"matchLabels":{"app.kubernetes.io/name":"rabbitmq-cluster"}}}]}},"volumeClaimTemplates":[{"metadata":{"name":"persistence","namespace":"default","creationTimestamp":null,"labels":{"app.kubernetes.io/component":"rabbitmq","app.kubernetes.io/name":"rabbitmq-cluster","app.kubernetes.io/part-of":"rabbitmq"},"ownerReferences":[{"apiVersion":"rabbitmq.com/v1beta1","kind":"RabbitmqCluster","name":"rabbitmq-cluster","uid":"3ecefa8a-1bec-48a7-9af4-dd0df3339101","controller":true,"blockOwnerDeletion":false}]},"spec":{"accessModes":["ReadWriteOnce"],"resources":{"requests":{"storage":"10Gi"}},"volumeMode":"Filesystem"},"status":{"phase":"Pending"}}],"serviceName":"rabbitmq-cluster-nodes","podManagementPolicy":"Parallel","updateStrategy":{"type":"RollingUpdate","rollingUpdate":{"partition":0}},"revisionHistoryLimit":10},"status":{"observedGeneration":1,"replicas":1,"readyReplicas":1,"currentReplicas":1,"updatedReplicas":1,"currentRevision":"rabbitmq-cluster-server-5f8b8665fb","updateRevision":"rabbitmq-cluster-server-5f8b8665fb","collisionCount":0}}
2022/03/18 18:07:24 learn_server.go:291: [SIEVE-AFTER-READ]	Get	true	service	default	rabbitmq-cluster-nodes	github.com/rabbitmq/cluster-operator/controllers.(*RabbitmqClusterReconciler)	NoError	{"kind":"Service","apiVersion":"v1","metadata":{"name":"rabbitmq-cluster-nodes","namespace":"default","selfLink":"/api/v1/namespaces/default/services/rabbitmq-cluster-nodes","uid":"f843e1c2-ced0-463d-87c1-0e127aaa2006","resourceVersion":"1080","creationTimestamp":"2022-03-18T18:06:25Z","labels":{"app.kubernetes.io/component":"rabbitmq","app.kubernetes.io/name":"rabbitmq-cluster","app.kubernetes.io/part-of":"rabbitmq"},"ownerReferences":[{"apiVersion":"rabbitmq.com/v1beta1","kind":"RabbitmqCluster","name":"rabbitmq-cluster","uid":"3ecefa8a-1bec-48a7-9af4-dd0df3339101","controller":true,"blockOwnerDeletion":true}],"managedFields":[{"manager":"manager","operation":"Update","apiVersion":"v1","time":"2022-03-18T18:06:25Z","fieldsType":"FieldsV1","fieldsV1":{"f:metadata":{"f:labels":{".":{},"f:app.kubernetes.io/component":{},"f:app.kubernetes.io/name":{},"f:app.kubernetes.io/part-of":{}},"f:ownerReferences":{".":{},"k:{\"uid\":\"3ecefa8a-1bec-48a7-9af4-dd0df3339101\"}":{".":{},"f:apiVersion":{},"f:blockOwnerDeletion":{},"f:controller":{},"f:kind":{},"f:name":{},"f:uid":{}}}},"f:spec":{"f:clusterIP":{},"f:ports":{".":{},"k:{\"port\":4369,\"protocol\":\"TCP\"}":{".":{},"f:name":{},"f:port":{},"f:protocol":{},"f:targetPort":{}},"k:{\"port\":25672,\"protocol\":\"TCP\"}":{".":{},"f:name":{},"f:port":{},"f:protocol":{},"f:targetPort":{}}},"f:publishNotReadyAddresses":{},"f:selector":{".":{},"f:app.kubernetes.io/name":{}},"f:sessionAffinity":{},"f:type":{}}}}]},"spec":{"ports":[{"name":"epmd","protocol":"TCP","port":4369,"targetPort":4369},{"name":"cluster-rpc","protocol":"TCP","port":25672,"targetPort":25672}],"selector":{"app.kubernetes.io/name":"rabbitmq-cluster"},"clusterIP":"None","type":"ClusterIP","sessionAffinity":"None","publishNotReadyAddresses":true},"status":{"loadBalancer":{}}}
2022/03/18 18:07:24 learn_server.go:291: [SIEVE-AFTER-READ]	Get	true	service	default	rabbitmq-cluster	github.com/rabbitmq/cluster-operator/controllers.(*RabbitmqClusterReconciler)	NoError	{"kind":"Service","apiVersion":"v1","metadata":{"name":"rabbitmq-cluster","namespace":"default","selfLink":"/api/v1/namespaces/default/services/rabbitmq-cluster","uid":"ae846a70-784e-49ca-99a0-2b0cefb93b46","resourceVersion":"1085","creationTimestamp":"2022-03-18T18:06:25Z","labels":{"app.kubernetes.io/component":"rabbitmq","app.kubernetes.io/name":"rabbitmq-cluster","app.kubernetes.io/part-of":"rabbitmq"},"ownerReferences":[{"apiVersion":"rabbitmq.com/v1beta1","kind":"RabbitmqCluster","name":"rabbitmq-cluster","uid":"3ecefa8a-1bec-48a7-9af4-dd0df3339101","controller":true,"blockOwnerDeletion":true}],"managedFields":[{"manager":"manager","operation":"Update","apiVersion":"v1","time":"2022-03-18T18:06:25Z","fieldsType":"FieldsV1","fieldsV1":{"f:metadata":{"f:labels":{".":{},"f:app.kubernetes.io/component":{},"f:app.kubernetes.io/name":{},"f:app.kubernetes.io/part-of":{}},"f:ownerReferences":{".":{},"k:{\"uid\":\"3ecefa8a-1bec-48a7-9af4-dd0df3339101\"}":{".":{},"f:apiVersion":{},"f:blockOwnerDeletion":{},"f:controller":{},"f:kind":{},"f:name":{},"f:uid":{}}}},"f:spec":{"f:ports":{".":{},"k:{\"port\":5672,\"protocol\":\"TCP\"}":{".":{},"f:name":{},"f:port":{},"f:protocol":{},"f:targetPort":{}},"k:{\"port\":15672,\"protocol\":\"TCP\"}":{".":{},"f:name":{},"f:port":{},"f:protocol":{},"f:targetPort":{}}},"f:selector":{".":{},"f:app.kubernetes.io/name":{}},"f:sessionAffinity":{},"f:type":{}}}}]},"spec":{"ports":[{"name":"amqp","protocol":"TCP","port":5672,"targetPort":5672},{"name":"management","protocol":"TCP","port":15672,"targetPort":15672}],"selector":{"app.kubernetes.io/name":"rabbitmq-cluster"},"clusterIP":"10.96.47.189","type":"ClusterIP","sessionAffinity":"None"},"status":{"loadBalancer":{}}}
2022/03/18 18:07:24 learn_server.go:291: [SIEVE-AFTER-READ]	Get	true	secret	default	rabbitmq-cluster-erlang-cookie	github.com/rabbitmq/cluster-operator/controllers.(*RabbitmqClusterReconciler)	NoError	{"kind":"Secret","apiVersion":"v1","metadata":{"name":"rabbitmq-cluster-erlang-cookie","namespace":"default","selfLink":"/api/v1/namespaces/default/secrets/rabbitmq-cluster-erlang-cookie","uid":"01d8d8ad-080a-4c3f-9d27-56616c53dd26","resourceVersion":"1088","creationTimestamp":"2022-03-18T18:06:25Z","labels":{"app.kubernetes.io/component":"rabbitmq","app.kubernetes.io/name":"rabbitmq-cluster","app.kubernetes.io/part-of":"rabbitmq"},"ownerReferences":[{"apiVersion":"rabbitmq.com/v1beta1","kind":"RabbitmqCluster","name":"rabbitmq-cluster","uid":"3ecefa8a-1bec-48a7-9af4-dd0df3339101","controller":true,"blockOwnerDeletion":true}],"managedFields":[{"manager":"manager","operation":"Update","apiVersion":"v1","time":"2022-03-18T18:06:25Z","fieldsType":"FieldsV1","fieldsV1":{"f:data":{".":{},"f:.erlang.cookie":{}},"f:metadata":{"f:labels":{".":{},"f:app.kubernetes.io/component":{},"f:app.kubernetes.io/name":{},"f:app.kubernetes.io/part-of":{}},"f:ownerReferences":{".":{},"k:{\"uid\":\"3ecefa8a-1bec-48a7-9af4-dd0df3339101\"}":{".":{},"f:apiVersion":{},"f:blockOwnerDeletion":{},"f:controller":{},"f:kind":{},"f:name":{},"f:uid":{}}}},"f:type":{}}}]},"data":{".erlang.cookie":"ajdscUtLdnBpR1NwUUMwc1V3a2VyTlJxU2tVUTdBeEw="},"type":"Opaque"}
2022/03/18 18:07:24 learn_server.go:291: [SIEVE-AFTER-READ]	Get	true	secret	default	rabbitmq-cluster-default-user	github.com/rabbitmq/cluster-operator/controllers.(*RabbitmqClusterReconciler)	NoError	{"kind":"Secret","apiVersion":"v1","metadata":{"name":"rabbitmq-cluster-default-user","namespace":"default","selfLink":"/api/v1/namespaces/default/secrets/rabbitmq-cluster-default-user","uid":"b2f5a936-e51f-4488-b6e9-ca23e4d95ac2","resourceVersion":"1091","creationTimestamp":"2022-03-18T18:06:25Z","labels":{"app.kubernetes.io/component":"rabbitmq","app.kubernetes.io/name":"rabbitmq-cluster","app.kubernetes.io/part-of":"rabbitmq"},"ownerReferences":[{"apiVersion":"rabbitmq.com/v1beta1","kind":"RabbitmqCluster","name":"rabbitmq-cluster","uid":"3ecefa8a-1bec-48a7-9af4-dd0df3339101","controller":true,"blockOwnerDeletion":true}],"managedFields":[{"manager":"manager","operation":"Update","apiVersion":"v1","time":"2022-03-18T18:06:25Z","fieldsType":"FieldsV1","fieldsV1":{"f:data":{".":{},"f:default_user.conf":{},"f:password":{},"f:provider":{},"f:type":{},"f:username":{}},"f:metadata":{"f:labels":{".":{},"f:app.kubernetes.io/component":{},"f:app.kubernetes.io/name":{},"f:app.kubernetes.io/part-of":{}},"f:ownerReferences":{".":{},"k:{\"uid\":\"3ecefa8a-1bec-48a7-9af4-dd0df3339101\"}":{".":{},"f:apiVersion":{},"f:blockOwnerDeletion":{},"f:controller":{},"f:kind":{},"f:name":{},"f:uid":{}}}},"f:type":{}}}]},"data":{"default_user.conf":"ZGVmYXVsdF91c2VyID0gdEFMN1otZTgzR29ocEtsZ0Z4cUFFV3ZXemEtcjdJQW8KZGVmYXVsdF9wYXNzID0gdXVocndkTkdOcmJXQ2p6NFZPX0NUZE9OYURkSUpoRkoK","password":"dXVocndkTkdOcmJXQ2p6NFZPX0NUZE9OYURkSUpoRko=","provider":"cmFiYml0bXE=","type":"cmFiYml0bXE=","username":"dEFMN1otZTgzR29ocEtsZ0Z4cUFFV3ZXemEtcjdJQW8="},"type":"Opaque"}
2022/03/18 18:07:24 learn_server.go:291: [SIEVE-AFTER-READ]	Get	true	configmap	default	rabbitmq-cluster-plugins-conf	github.com/rabbitmq/cluster-operator/controllers.(*RabbitmqClusterReconciler)	NoError	{"kind":"ConfigMap","apiVersion":"v1","metadata":{"name":"rabbitmq-cluster-plugins-conf","namespace":"default","selfLink":"/api/v1/namespaces/default/configmaps/rabbitmq-cluster-plugins-conf","uid":"0aa26eb6-ff3a-4457-a223-284c897db7fe","resourceVersion":"1092","creationTimestamp":"2022-03-18T18:06:25Z","labels":{"app.kubernetes.io/component":"rabbitmq","app.kubernetes.io/name":"rabbitmq-cluster","app.kubernetes.io/part-of":"rabbitmq"},"ownerReferences":[{"apiVersion":"rabbitmq.com/v1beta1","kind":"RabbitmqCluster","name":"rabbitmq-cluster","uid":"3ecefa8a-1bec-48a7-9af4-dd0df3339101","controller":true,"blockOwnerDeletion":true}],"managedFields":[{"manager":"manager","operation":"Update","apiVersion":"v1","time":"2022-03-18T18:06:25Z","fieldsType":"FieldsV1","fieldsV1":{"f:data":{".":{},"f:enabled_plugins":{}},"f:metadata":{"f:labels":{".":{},"f:app.kubernetes.io/component":{},"f:app.kubernetes.io/name":{},"f:app.kubernetes.io/part-of":{}},"f:ownerReferences":{".":{},"k:{\"uid\":\"3ecefa8a-1bec-48a7-9af4-dd0df3339101\"}":{".":{},"f:apiVersion":{},"f:blockOwnerDeletion":{},"f:controller":{},"f:kind":{},"f:name":{},"f:uid":{}}}}}}]},"data":{"enabled_plugins":"[rabbitmq_peer_discovery_k8s,rabbitmq_prometheus,rabbitmq_management]."}}
2022/03/18 18:07:24 learn_server.go:291: [SIEVE-AFTER-READ]	Get	true	configmap	default	rabbitmq-cluster-server-conf	github.com/rabbitmq/cluster-operator/controllers.(*RabbitmqClusterReconciler)	NoError	{"kind":"ConfigMap","apiVersion":"v1","metadata":{"name":"rabbitmq-cluster-server-conf","namespace":"default","selfLink":"/api/v1/namespaces/default/configmaps/rabbitmq-cluster-server-conf","uid":"e4182078-d429-4baf-9021-72618c509ac5","resourceVersion":"1095","creationTimestamp":"2022-03-18T18:06:25Z","labels":{"app.kubernetes.io/component":"rabbitmq","app.kubernetes.io/name":"rabbitmq-cluster","app.kubernetes.io/part-of":"rabbitmq"},"ownerReferences":[{"apiVersion":"rabbitmq.com/v1beta1","kind":"RabbitmqCluster","name":"rabbitmq-cluster","uid":"3ecefa8a-1bec-48a7-9af4-dd0df3339101","controller":true,"blockOwnerDeletion":true}],"managedFields":[{"manager":"manager","operation":"Update","apiVersion":"v1","time":"2022-03-18T18:06:25Z","fieldsType":"FieldsV1","fieldsV1":{"f:data":{".":{},"f:operatorDefaults.conf":{},"f:userDefinedConfiguration.conf":{}},"f:metadata":{"f:labels":{".":{},"f:app.kubernetes.io/component":{},"f:app.kubernetes.io/name":{},"f:app.kubernetes.io/part-of":{}},"f:ownerReferences":{".":{},"k:{\"uid\":\"3ecefa8a-1bec-48a7-9af4-dd0df3339101\"}":{".":{},"f:apiVersion":{},"f:blockOwnerDeletion":{},"f:controller":{},"f:kind":{},"f:name":{},"f:uid":{}}}}}}]},"data":{"operatorDefaults.conf":"cluster_formation.peer_discovery_backend             = rabbit_peer_discovery_k8s\ncluster_formation.k8s.host                           = kubernetes.default\ncluster_formation.k8s.address_type                   = hostname\ncluster_partition_handling                           = pause_minority\nqueue_master_locator                                 = min-masters\ndisk_free_limit.absolute                             = 2GB\ncluster_formation.randomized_startup_delay_range.min = 5\ncluster_formation.randomized_startup_delay_range.max = 30\ncluster_name                                         = rabbitmq-cluster\n","userDefinedConfiguration.conf":"total_memory_available_override_value = 1717986919\n"}}
2022/03/18 18:07:24 learn_server.go:291: [SIEVE-AFTER-READ]	Get	true	serviceaccount	default	rabbitmq-cluster-server	github.com/rabbitmq/cluster-operator/controllers.(*RabbitmqClusterReconciler)	NoError	{"kind":"ServiceAccount","apiVersion":"v1","metadata":{"name":"rabbitmq-cluster-server","namespace":"default","selfLink":"/api/v1/namespaces/default/serviceaccounts/rabbitmq-cluster-server","uid":"0c3cead0-37dd-452b-b939-fe346a5dfdea","resourceVersion":"1102","creationTimestamp":"2022-03-18T18:06:25Z","labels":{"app.kubernetes.io/component":"rabbitmq","app.kubernetes.io/name":"rabbitmq-cluster","app.kubernetes.io/part-of":"rabbitmq"},"ownerReferences":[{"apiVersion":"rabbitmq.com/v1beta1","kind":"RabbitmqCluster","name":"rabbitmq-cluster","uid":"3ecefa8a-1bec-48a7-9af4-dd0df3339101","controller":true,"blockOwnerDeletion":true}],"managedFields":[{"manager":"kube-controller-manager","operation":"Update","apiVersion":"v1","time":"2022-03-18T18:06:25Z","fieldsType":"FieldsV1","fieldsV1":{"f:secrets":{".":{},"k:{\"name\":\"rabbitmq-cluster-server-token-v4wpv\"}":{".":{},"f:name":{}}}}},{"manager":"manager","operation":"Update","apiVersion":"v1","time":"2022-03-18T18:06:25Z","fieldsType":"FieldsV1","fieldsV1":{"f:metadata":{"f:labels":{".":{},"f:app.kubernetes.io/component":{},"f:app.kubernetes.io/name":{},"f:app.kubernetes.io/part-of":{}},"f:ownerReferences":{".":{},"k:{\"uid\":\"3ecefa8a-1bec-48a7-9af4-dd0df3339101\"}":{".":{},"f:apiVersion":{},"f:blockOwnerDeletion":{},"f:controller":{},"f:kind":{},"f:name":{},"f:uid":{}}}}}}]},"secrets":[{"name":"rabbitmq-cluster-server-token-v4wpv"}]}
2022/03/18 18:07:24 learn_server.go:291: [SIEVE-AFTER-READ]	Get	true	role	default	rabbitmq-cluster-peer-discovery	github.com/rabbitmq/cluster-operator/controllers.(*RabbitmqClusterReconciler)	NoError	{"kind":"Role","apiVersion":"rbac.authorization.k8s.io/v1","metadata":{"name":"rabbitmq-cluster-peer-discovery","namespace":"default","selfLink":"/apis/rbac.authorization.k8s.io/v1/namespaces/default/roles/rabbitmq-cluster-peer-discovery","uid":"ec9ac474-1880-43ed-af46-9ea5f46d6db4","resourceVersion":"1103","creationTimestamp":"2022-03-18T18:06:25Z","labels":{"app.kubernetes.io/component":"rabbitmq","app.kubernetes.io/name":"rabbitmq-cluster","app.kubernetes.io/part-of":"rabbitmq"},"ownerReferences":[{"apiVersion":"rabbitmq.com/v1beta1","kind":"RabbitmqCluster","name":"rabbitmq-cluster","uid":"3ecefa8a-1bec-48a7-9af4-dd0df3339101","controller":true,"blockOwnerDeletion":true}],"managedFields":[{"manager":"manager","operation":"Update","apiVersion":"rbac.authorization.k8s.io/v1","time":"2022-03-18T18:06:25Z","fieldsType":"FieldsV1","fieldsV1":{"f:metadata":{"f:labels":{".":{},"f:app.kubernetes.io/component":{},"f:app.kubernetes.io/name":{},"f:app.kubernetes.io/part-of":{}},"f:ownerReferences":{".":{},"k:{\"uid\":\"3ecefa8a-1bec-48a7-9af4-dd0df3339101\"}":{".":{},"f:apiVersion":{},"f:blockOwnerDeletion":{},"f:controller":{},"f:kind":{},"f:name":{},"f:uid":{}}}},"f:rules":{}}}]},"rules":[{"verbs":["get"],"apiGroups":[""],"resources":["endpoints"]},{"verbs":["create"],"apiGroups":[""],"resources":["events"]}]}
2022/03/18 18:07:24 learn_server.go:291: [SIEVE-AFTER-READ]	Get	true	rolebinding	default	rabbitmq-cluster-server	github.com/rabbitmq/cluster-operator/controllers.(*RabbitmqClusterReconciler)	NoError	{"kind":"RoleBinding","apiVersion":"rbac.authorization.k8s.io/v1","metadata":{"name":"rabbitmq-cluster-server","namespace":"default","selfLink":"/apis/rbac.authorization.k8s.io/v1/namespaces/default/rolebindings/rabbitmq-cluster-server","uid":"fe69a41c-8d28-4b84-a9f6-a9e6044d75ba","resourceVersion":"1105","creationTimestamp":"2022-03-18T18:06:25Z","labels":{"app.kubernetes.io/component":"rabbitmq","app.kubernetes.io/name":"rabbitmq-cluster","app.kubernetes.io/part-of":"rabbitmq"},"ownerReferences":[{"apiVersion":"rabbitmq.com/v1beta1","kind":"RabbitmqCluster","name":"rabbitmq-cluster","uid":"3ecefa8a-1bec-48a7-9af4-dd0df3339101","controller":true,"blockOwnerDeletion":true}],"managedFields":[{"manager":"manager","operation":"Update","apiVersion":"rbac.authorization.k8s.io/v1","time":"2022-03-18T18:06:25Z","fieldsType":"FieldsV1","fieldsV1":{"f:metadata":{"f:labels":{".":{},"f:app.kubernetes.io/component":{},"f:app.kubernetes.io/name":{},"f:app.kubernetes.io/part-of":{}},"f:ownerReferences":{".":{},"k:{\"uid\":\"3ecefa8a-1bec-48a7-9af4-dd0df3339101\"}":{".":{},"f:apiVersion":{},"f:blockOwnerDeletion":{},"f:controller":{},"f:kind":{},"f:name":{},"f:uid":{}}}},"f:roleRef":{"f:apiGroup":{},"f:kind":{},"f:name":{}},"f:subjects":{}}}]},"subjects":[{"kind":"ServiceAccount","name":"rabbitmq-cluster-server"}],"roleRef":{"apiGroup":"rbac.authorization.k8s.io","kind":"Role","name":"rabbitmq-cluster-peer-discovery"}}
2022/03/18 18:07:24 learn_server.go:291: [SIEVE-AFTER-READ]	Get	true	statefulset	default	rabbitmq-cluster-server	github.com/rabbitmq/cluster-operator/controllers.(*RabbitmqClusterReconciler)	NoError	{"kind":"StatefulSet","apiVersion":"apps/v1","metadata":{"name":"rabbitmq-cluster-server","namespace":"default","selfLink":"/apis/apps/v1/namespaces/default/statefulsets/rabbitmq-cluster-server","uid":"f2f07f3e-b500-4c48-a5de-8db7eaf37b9a","resourceVersion":"1409","generation":1,"creationTimestamp":"2022-03-18T18:06:25Z","labels":{"app.kubernetes.io/component":"rabbitmq","app.kubernetes.io/name":"rabbitmq-cluster","app.kubernetes.io/part-of":"rabbitmq"},"ownerReferences":[{"apiVersion":"rabbitmq.com/v1beta1","kind":"RabbitmqCluster","name":"rabbitmq-cluster","uid":"3ecefa8a-1bec-48a7-9af4-dd0df3339101","controller":true,"blockOwnerDeletion":true}],"managedFields":[{"manager":"manager","operation":"Update","apiVersion":"apps/v1","time":"2022-03-18T18:06:25Z","fieldsType":"FieldsV1","fieldsV1":{"f:metadata":{"f:labels":{".":{},"f:app.kubernetes.io/component":{},"f:app.kubernetes.io/name":{},"f:app.kubernetes.io/part-of":{}},"f:ownerReferences":{".":{},"k:{\"uid\":\"3ecefa8a-1bec-48a7-9af4-dd0df3339101\"}":{".":{},"f:apiVersion":{},"f:blockOwnerDeletion":{},"f:controller":{},"f:kind":{},"f:name":{},"f:uid":{}}}},"f:spec":{"f:podManagementPolicy":{},"f:replicas":{},"f:revisionHistoryLimit":{},"f:selector":{"f:matchLabels":{".":{},"f:app.kubernetes.io/name":{}}},"f:serviceName":{},"f:template":{"f:metadata":{"f:annotations":{".":{},"f:prometheus.io/port":{},"f:prometheus.io/scrape":{}},"f:labels":{".":{},"f:app.kubernetes.io/component":{},"f:app.kubernetes.io/name":{},"f:app.kubernetes.io/part-of":{}}},"f:spec":{"f:automountServiceAccountToken":{},"f:containers":{"k:{\"name\":\"rabbitmq\"}":{".":{},"f:env":{".":{},"k:{\"name\":\"K8S_HOSTNAME_SUFFIX\"}":{".":{},"f:name":{},"f:value":{}},"k:{\"name\":\"K8S_SERVICE_NAME\"}":{".":{},"f:name":{},"f:value":{}},"k:{\"name\":\"MY_POD_NAME\"}":{".":{},"f:name":{},"f:valueFrom":{".":{},"f:fieldRef":{".":{},"f:apiVersion":{},"f:fieldPath":{}}}},"k:{\"name\":\"MY_POD_NAMESPACE\"}":{".":{},"f:name":{},"f:valueFrom":{".":{},"f:fieldRef":{".":{},"f:apiVersion":{},"f:fieldPath":{}}}},"k:{\"name\":\"RABBITMQ_ENABLED_PLUGINS_FILE\"}":{".":{},"f:name":{},"f:value":{}},"k:{\"name\":\"RABBITMQ_NODENAME\"}":{".":{},"f:name":{},"f:value":{}},"k:{\"name\":\"RABBITMQ_USE_LONGNAME\"}":{".":{},"f:name":{},"f:value":{}}},"f:image":{},"f:imagePullPolicy":{},"f:lifecycle":{".":{},"f:preStop":{".":{},"f:exec":{".":{},"f:command":{}}}},"f:name":{},"f:ports":{".":{},"k:{\"containerPort\":4369,\"protocol\":\"TCP\"}":{".":{},"f:containerPort":{},"f:name":{},"f:protocol":{}},"k:{\"containerPort\":5672,\"protocol\":\"TCP\"}":{".":{},"f:containerPort":{},"f:name":{},"f:protocol":{}},"k:{\"containerPort\":15672,\"protocol\":\"TCP\"}":{".":{},"f:containerPort":{},"f:name":{},"f:protocol":{}},"k:{\"containerPort\":15692,\"protocol\":\"TCP\"}":{".":{},"f:containerPort":{},"f:name":{},"f:protocol":{}}},"f:readinessProbe":{".":{},"f:failureThreshold":{},"f:initialDelaySeconds":{},"f:periodSeconds":{},"f:successThreshold":{},"f:tcpSocket":{".":{},"f:port":{}},"f:timeoutSeconds":{}},"f:resources":{".":{},"f:limits":{".":{},"f:cpu":{},"f:memory":{}},"f:requests":{".":{},"f:cpu":{},"f:memory":{}}},"f:terminationMessagePath":{},"f:terminationMessagePolicy":{},"f:volumeMounts":{".":{},"k:{\"mountPath\":\"/etc/pod-info/\"}":{".":{},"f:mountPath":{},"f:name":{}},"k:{\"mountPath\":\"/etc/rabbitmq/conf.d/10-operatorDefaults.conf\"}":{".":{},"f:mountPath":{},"f:name":{},"f:subPath":{}},"k:{\"mountPath\":\"/etc/rabbitmq/conf.d/11-default_user.conf\"}":{".":{},"f:mountPath":{},"f:name":{},"f:subPath":{}},"k:{\"mountPath\":\"/etc/rabbitmq/conf.d/90-userDefinedConfiguration.conf\"}":{".":{},"f:mountPath":{},"f:name":{},"f:subPath":{}},"k:{\"mountPath\":\"/operator\"}":{".":{},"f:mountPath":{},"f:name":{}},"k:{\"mountPath\":\"/var/lib/rabbitmq/\"}":{".":{},"f:mountPath":{},"f:name":{}},"k:{\"mountPath\":\"/var/lib/rabbitmq/mnesia/\"}":{".":{},"f:mountPath":{},"f:name":{}}}}},"f:dnsPolicy":{},"f:initContainers":{".":{},"k:{\"name\":\"setup-container\"}":{".":{},"f:command":{},"f:image":{},"f:imagePullPolicy":{},"f:name":{},"f:resources":{".":{},"f:limits":{".":{},"f:cpu":{},"f:memory":{}},"f:requests":{".":{},"f:cpu":{},"f:memory":{}}},"f:securityContext":{".":{},"f:capabilities":{".":{},"f:drop":{}},"f:runAsUser":{}},"f:terminationMessagePath":{},"f:terminationMessagePolicy":{},"f:volumeMounts":{".":{},"k:{\"mountPath\":\"/operator\"}":{".":{},"f:mountPath":{},"f:name":{}},"k:{\"mountPath\":\"/tmp/default_user.conf\"}":{".":{},"f:mountPath":{},"f:name":{},"f:subPath":{}},"k:{\"mountPath\":\"/tmp/erlang-cookie-secret/\"}":{".":{},"f:mountPath":{},"f:name":{}},"k:{\"mountPath\":\"/tmp/rabbitmq-plugins/\"}":{".":{},"f:mountPath":{},"f:name":{}},"k:{\"mountPath\":\"/var/lib/rabbitmq/\"}":{".":{},"f:mountPath":{},"f:name":{}},"k:{\"mountPath\":\"/var/lib/rabbitmq/mnesia/\"}":{".":{},"f:mountPath":{},"f:name":{}}}}},"f:restartPolicy":{},"f:schedulerName":{},"f:securityContext":{".":{},"f:fsGroup":{},"f:runAsGroup":{},"f:runAsUser":{}},"f:serviceAccount":{},"f:serviceAccountName":{},"f:terminationGracePeriodSeconds":{},"f:topologySpreadConstraints":{".":{},"k:{\"topologyKey\":\"topology.kubernetes.io/zone\",\"whenUnsatisfiable\":\"ScheduleAnyway\"}":{".":{},"f:labelSelector":{".":{},"f:matchLabels":{".":{},"f:app.kubernetes.io/name":{}}},"f:maxSkew":{},"f:topologyKey":{},"f:whenUnsatisfiable":{}}},"f:volumes":{".":{},"k:{\"name\":\"erlang-cookie-secret\"}":{".":{},"f:name":{},"f:secret":{".":{},"f:defaultMode":{},"f:secretName":{}}},"k:{\"name\":\"plugins-conf\"}":{".":{},"f:configMap":{".":{},"f:defaultMode":{},"f:name":{}},"f:name":{}},"k:{\"name\":\"pod-info\"}":{".":{},"f:downwardAPI":{".":{},"f:defaultMode":{},"f:items":{}},"f:name":{}},"k:{\"name\":\"rabbitmq-confd\"}":{".":{},"f:name":{},"f:projected":{".":{},"f:defaultMode":{},"f:sources":{}}},"k:{\"name\":\"rabbitmq-erlang-cookie\"}":{".":{},"f:emptyDir":{},"f:name":{}},"k:{\"name\":\"rabbitmq-plugins\"}":{".":{},"f:emptyDir":{},"f:name":{}}}}},"f:updateStrategy":{"f:rollingUpdate":{".":{},"f:partition":{}},"f:type":{}},"f:volumeClaimTemplates":{}}}},{"manager":"kube-controller-manager","operation":"Update","apiVersion":"apps/v1","time":"2022-03-18T18:07:23Z","fieldsType":"FieldsV1","fieldsV1":{"f:status":{"f:collisionCount":{},"f:currentReplicas":{},"f:currentRevision":{},"f:observedGeneration":{},"f:readyReplicas":{},"f:replicas":{},"f:updateRevision":{},"f:updatedReplicas":{}}}}]},"spec":{"replicas":1,"selector":{"matchLabels":{"app.kubernetes.io/name":"rabbitmq-cluster"}},"template":{"metadata":{"creationTimestamp":null,"labels":{"app.kubernetes.io/component":"rabbitmq","app.kubernetes.io/name":"rabbitmq-cluster","app.kubernetes.io/part-of":"rabbitmq"},"annotations":{"prometheus.io/port":"15692","prometheus.io/scrape":"true"}},"spec":{"volumes":[{"name":"plugins-conf","configMap":{"name":"rabbitmq-cluster-plugins-conf","defaultMode":420}},{"name":"rabbitmq-confd","projected":{"sources":[{"secret":{"name":"rabbitmq-cluster-default-user","items":[{"key":"default_user.conf","path":"default_user.conf"}]}},{"configMap":{"name":"rabbitmq-cluster-server-conf","items":[{"key":"operatorDefaults.conf","path":"operatorDefaults.conf"},{"key":"userDefinedConfiguration.conf","path":"userDefinedConfiguration.conf"}]}}],"defaultMode":420}},{"name":"rabbitmq-erlang-cookie","emptyDir":{}},{"name":"erlang-cookie-secret","secret":{"secretName":"rabbitmq-cluster-erlang-cookie","defaultMode":420}},{"name":"rabbitmq-plugins","emptyDir":{}},{"name":"pod-info","downwardAPI":{"items":[{"path":"skipPreStopChecks","fieldRef":{"apiVersion":"v1","fieldPath":"metadata.labels['skipPreStopChecks']"}}],"defaultMode":420}}],"initContainers":[{"name":"setup-container","image":"rabbitmq:3.8.12-management","command":["sh","-c","cp /tmp/erlang-cookie-secret/.erlang.cookie /var/lib/rabbitmq/.erlang.cookie \u0026\u0026 chown 999:999 /var/lib/rabbitmq/.erlang.cookie \u0026\u0026 chmod 600 /var/lib/rabbitmq/.erlang.cookie ; cp /tmp/rabbitmq-plugins/enabled_plugins /operator/enabled_plugins \u0026\u0026 chown 999:999 /operator/enabled_plugins ; chown 999:999 /var/lib/rabbitmq/mnesia/ ; echo '[default]' \u003e /var/lib/rabbitmq/.rabbitmqadmin.conf \u0026\u0026 sed -e 's/default_user/username/' -e 's/default_pass/password/' /tmp/default_user.conf \u003e\u003e /var/lib/rabbitmq/.rabbitmqadmin.conf \u0026\u0026 chown 999:999 /var/lib/rabbitmq/.rabbitmqadmin.conf \u0026\u0026 chmod 600 /var/lib/rabbitmq/.rabbitmqadmin.conf"],"resources":{"limits":{"cpu":"100m","memory":"500Mi"},"requests":{"cpu":"100m","memory":"500Mi"}},"volumeMounts":[{"name":"plugins-conf","mountPath":"/tmp/rabbitmq-plugins/"},{"name":"rabbitmq-erlang-cookie","mountPath":"/var/lib/rabbitmq/"},{"name":"erlang-cookie-secret","mountPath":"/tmp/erlang-cookie-secret/"},{"name":"rabbitmq-plugins","mountPath":"/operator"},{"name":"persistence","mountPath":"/var/lib/rabbitmq/mnesia/"},{"name":"rabbitmq-confd","mountPath":"/tmp/default_user.conf","subPath":"default_user.conf"}],"terminationMessagePath":"/dev/termination-log","terminationMessagePolicy":"File","imagePullPolicy":"IfNotPresent","securityContext":{"capabilities":{"drop":["FSETID","KILL","SETGID","SETUID","SETPCAP","NET_BIND_SERVICE","NET_RAW","SYS_CHROOT","MKNOD","AUDIT_WRITE","SETFCAP"]},"runAsUser":0}}],"containers":[{"name":"rabbitmq","image":"rabbitmq:3.8.12-management","ports":[{"name":"epmd","containerPort":4369,"protocol":"TCP"},{"name":"amqp","containerPort":5672,"protocol":"TCP"},{"name":"management","containerPort":15672,"protocol":"TCP"},{"name":"prometheus","containerPort":15692,"protocol":"TCP"}],"env":[{"name":"MY_POD_NAME","valueFrom":{"fieldRef":{"apiVersion":"v1","fieldPath":"metadata.name"}}},{"name":"MY_POD_NAMESPACE","valueFrom":{"fieldRef":{"apiVersion":"v1","fieldPath":"metadata.namespace"}}},{"name":"RABBITMQ_ENABLED_PLUGINS_FILE","value":"/operator/enabled_plugins"},{"name":"K8S_SERVICE_NAME","value":"rabbitmq-cluster-nodes"},{"name":"RABBITMQ_USE_LONGNAME","value":"true"},{"name":"RABBITMQ_NODENAME","value":"rabbit@$(MY_POD_NAME).$(K8S_SERVICE_NAME).$(MY_POD_NAMESPACE)"},{"name":"K8S_HOSTNAME_SUFFIX","value":".$(K8S_SERVICE_NAME).$(MY_POD_NAMESPACE)"}],"resources":{"limits":{"cpu":"2","memory":"2Gi"},"requests":{"cpu":"1","memory":"2Gi"}},"volumeMounts":[{"name":"rabbitmq-erlang-cookie","mountPath":"/var/lib/rabbitmq/"},{"name":"persistence","mountPath":"/var/lib/rabbitmq/mnesia/"},{"name":"rabbitmq-plugins","mountPath":"/operator"},{"name":"rabbitmq-confd","mountPath":"/etc/rabbitmq/conf.d/10-operatorDefaults.conf","subPath":"operatorDefaults.conf"},{"name":"rabbitmq-confd","mountPath":"/etc/rabbitmq/conf.d/11-default_user.conf","subPath":"default_user.conf"},{"name":"rabbitmq-confd","mountPath":"/etc/rabbitmq/conf.d/90-userDefinedConfiguration.conf","subPath":"userDefinedConfiguration.conf"},{"name":"pod-info","mountPath":"/etc/pod-info/"}],"readinessProbe":{"tcpSocket":{"port":"amqp"},"initialDelaySeconds":10,"timeoutSeconds":5,"periodSeconds":10,"successThreshold":1,"failureThreshold":3},"lifecycle":{"preStop":{"exec":{"command":["/bin/bash","-c","if [ ! -z \"$(cat /etc/pod-info/skipPreStopChecks)\" ]; then exit 0; fi; rabbitmq-upgrade await_online_quorum_plus_one -t 604800; rabbitmq-upgrade await_online_synchronized_mirror -t 604800; rabbitmq-upgrade drain -t 604800"]}}},"terminationMessagePath":"/dev/termination-log","terminationMessagePolicy":"File","imagePullPolicy":"IfNotPresent"}],"restartPolicy":"Always","terminationGracePeriodSeconds":604800,"dnsPolicy":"ClusterFirst","serviceAccountName":"rabbitmq-cluster-server","serviceAccount":"rabbitmq-cluster-server","automountServiceAccountToken":true,"securityContext":{"runAsUser":999,"runAsGroup":999,"fsGroup":999},"schedulerName":"default-scheduler","topologySpreadConstraints":[{"maxSkew":1,"topologyKey":"topology.kubernetes.io/zone","whenUnsatisfiable":"ScheduleAnyway","labelSelector":{"matchLabels":{"app.kubernetes.io/name":"rabbitmq-cluster"}}}]}},"volumeClaimTemplates":[{"metadata":{"name":"persistence","namespace":"default","creationTimestamp":null,"labels":{"app.kubernetes.io/component":"rabbitmq","app.kubernetes.io/name":"rabbitmq-cluster","app.kubernetes.io/part-of":"rabbitmq"},"ownerReferences":[{"apiVersion":"rabbitmq.com/v1beta1","kind":"RabbitmqCluster","name":"rabbitmq-cluster","uid":"3ecefa8a-1bec-48a7-9af4-dd0df3339101","controller":true,"blockOwnerDeletion":false}]},"spec":{"accessModes":["ReadWriteOnce"],"resources":{"requests":{"storage":"10Gi"}},"volumeMode":"Filesystem"},"status":{"phase":"Pending"}}],"serviceName":"rabbitmq-cluster-nodes","podManagementPolicy":"Parallel","updateStrategy":{"type":"RollingUpdate","rollingUpdate":{"partition":0}},"revisionHistoryLimit":10},"status":{"observedGeneration":1,"replicas":1,"readyReplicas":1,"currentReplicas":1,"updatedReplicas":1,"currentRevision":"rabbitmq-cluster-server-5f8b8665fb","updateRevision":"rabbitmq-cluster-server-5f8b8665fb","collisionCount":0}}
2022/03/18 18:07:24 learn_server.go:291: [SIEVE-AFTER-READ]	Get	true	statefulset	default	rabbitmq-cluster-server	github.com/rabbitmq/cluster-operator/controllers.(*RabbitmqClusterReconciler)	NoError	{"kind":"StatefulSet","apiVersion":"apps/v1","metadata":{"name":"rabbitmq-cluster-server","namespace":"default","selfLink":"/apis/apps/v1/namespaces/default/statefulsets/rabbitmq-cluster-server","uid":"f2f07f3e-b500-4c48-a5de-8db7eaf37b9a","resourceVersion":"1409","generation":1,"creationTimestamp":"2022-03-18T18:06:25Z","labels":{"app.kubernetes.io/component":"rabbitmq","app.kubernetes.io/name":"rabbitmq-cluster","app.kubernetes.io/part-of":"rabbitmq"},"ownerReferences":[{"apiVersion":"rabbitmq.com/v1beta1","kind":"RabbitmqCluster","name":"rabbitmq-cluster","uid":"3ecefa8a-1bec-48a7-9af4-dd0df3339101","controller":true,"blockOwnerDeletion":true}],"managedFields":[{"manager":"manager","operation":"Update","apiVersion":"apps/v1","time":"2022-03-18T18:06:25Z","fieldsType":"FieldsV1","fieldsV1":{"f:metadata":{"f:labels":{".":{},"f:app.kubernetes.io/component":{},"f:app.kubernetes.io/name":{},"f:app.kubernetes.io/part-of":{}},"f:ownerReferences":{".":{},"k:{\"uid\":\"3ecefa8a-1bec-48a7-9af4-dd0df3339101\"}":{".":{},"f:apiVersion":{},"f:blockOwnerDeletion":{},"f:controller":{},"f:kind":{},"f:name":{},"f:uid":{}}}},"f:spec":{"f:podManagementPolicy":{},"f:replicas":{},"f:revisionHistoryLimit":{},"f:selector":{"f:matchLabels":{".":{},"f:app.kubernetes.io/name":{}}},"f:serviceName":{},"f:template":{"f:metadata":{"f:annotations":{".":{},"f:prometheus.io/port":{},"f:prometheus.io/scrape":{}},"f:labels":{".":{},"f:app.kubernetes.io/component":{},"f:app.kubernetes.io/name":{},"f:app.kubernetes.io/part-of":{}}},"f:spec":{"f:automountServiceAccountToken":{},"f:containers":{"k:{\"name\":\"rabbitmq\"}":{".":{},"f:env":{".":{},"k:{\"name\":\"K8S_HOSTNAME_SUFFIX\"}":{".":{},"f:name":{},"f:value":{}},"k:{\"name\":\"K8S_SERVICE_NAME\"}":{".":{},"f:name":{},"f:value":{}},"k:{\"name\":\"MY_POD_NAME\"}":{".":{},"f:name":{},"f:valueFrom":{".":{},"f:fieldRef":{".":{},"f:apiVersion":{},"f:fieldPath":{}}}},"k:{\"name\":\"MY_POD_NAMESPACE\"}":{".":{},"f:name":{},"f:valueFrom":{".":{},"f:fieldRef":{".":{},"f:apiVersion":{},"f:fieldPath":{}}}},"k:{\"name\":\"RABBITMQ_ENABLED_PLUGINS_FILE\"}":{".":{},"f:name":{},"f:value":{}},"k:{\"name\":\"RABBITMQ_NODENAME\"}":{".":{},"f:name":{},"f:value":{}},"k:{\"name\":\"RABBITMQ_USE_LONGNAME\"}":{".":{},"f:name":{},"f:value":{}}},"f:image":{},"f:imagePullPolicy":{},"f:lifecycle":{".":{},"f:preStop":{".":{},"f:exec":{".":{},"f:command":{}}}},"f:name":{},"f:ports":{".":{},"k:{\"containerPort\":4369,\"protocol\":\"TCP\"}":{".":{},"f:containerPort":{},"f:name":{},"f:protocol":{}},"k:{\"containerPort\":5672,\"protocol\":\"TCP\"}":{".":{},"f:containerPort":{},"f:name":{},"f:protocol":{}},"k:{\"containerPort\":15672,\"protocol\":\"TCP\"}":{".":{},"f:containerPort":{},"f:name":{},"f:protocol":{}},"k:{\"containerPort\":15692,\"protocol\":\"TCP\"}":{".":{},"f:containerPort":{},"f:name":{},"f:protocol":{}}},"f:readinessProbe":{".":{},"f:failureThreshold":{},"f:initialDelaySeconds":{},"f:periodSeconds":{},"f:successThreshold":{},"f:tcpSocket":{".":{},"f:port":{}},"f:timeoutSeconds":{}},"f:resources":{".":{},"f:limits":{".":{},"f:cpu":{},"f:memory":{}},"f:requests":{".":{},"f:cpu":{},"f:memory":{}}},"f:terminationMessagePath":{},"f:terminationMessagePolicy":{},"f:volumeMounts":{".":{},"k:{\"mountPath\":\"/etc/pod-info/\"}":{".":{},"f:mountPath":{},"f:name":{}},"k:{\"mountPath\":\"/etc/rabbitmq/conf.d/10-operatorDefaults.conf\"}":{".":{},"f:mountPath":{},"f:name":{},"f:subPath":{}},"k:{\"mountPath\":\"/etc/rabbitmq/conf.d/11-default_user.conf\"}":{".":{},"f:mountPath":{},"f:name":{},"f:subPath":{}},"k:{\"mountPath\":\"/etc/rabbitmq/conf.d/90-userDefinedConfiguration.conf\"}":{".":{},"f:mountPath":{},"f:name":{},"f:subPath":{}},"k:{\"mountPath\":\"/operator\"}":{".":{},"f:mountPath":{},"f:name":{}},"k:{\"mountPath\":\"/var/lib/rabbitmq/\"}":{".":{},"f:mountPath":{},"f:name":{}},"k:{\"mountPath\":\"/var/lib/rabbitmq/mnesia/\"}":{".":{},"f:mountPath":{},"f:name":{}}}}},"f:dnsPolicy":{},"f:initContainers":{".":{},"k:{\"name\":\"setup-container\"}":{".":{},"f:command":{},"f:image":{},"f:imagePullPolicy":{},"f:name":{},"f:resources":{".":{},"f:limits":{".":{},"f:cpu":{},"f:memory":{}},"f:requests":{".":{},"f:cpu":{},"f:memory":{}}},"f:securityContext":{".":{},"f:capabilities":{".":{},"f:drop":{}},"f:runAsUser":{}},"f:terminationMessagePath":{},"f:terminationMessagePolicy":{},"f:volumeMounts":{".":{},"k:{\"mountPath\":\"/operator\"}":{".":{},"f:mountPath":{},"f:name":{}},"k:{\"mountPath\":\"/tmp/default_user.conf\"}":{".":{},"f:mountPath":{},"f:name":{},"f:subPath":{}},"k:{\"mountPath\":\"/tmp/erlang-cookie-secret/\"}":{".":{},"f:mountPath":{},"f:name":{}},"k:{\"mountPath\":\"/tmp/rabbitmq-plugins/\"}":{".":{},"f:mountPath":{},"f:name":{}},"k:{\"mountPath\":\"/var/lib/rabbitmq/\"}":{".":{},"f:mountPath":{},"f:name":{}},"k:{\"mountPath\":\"/var/lib/rabbitmq/mnesia/\"}":{".":{},"f:mountPath":{},"f:name":{}}}}},"f:restartPolicy":{},"f:schedulerName":{},"f:securityContext":{".":{},"f:fsGroup":{},"f:runAsGroup":{},"f:runAsUser":{}},"f:serviceAccount":{},"f:serviceAccountName":{},"f:terminationGracePeriodSeconds":{},"f:topologySpreadConstraints":{".":{},"k:{\"topologyKey\":\"topology.kubernetes.io/zone\",\"whenUnsatisfiable\":\"ScheduleAnyway\"}":{".":{},"f:labelSelector":{".":{},"f:matchLabels":{".":{},"f:app.kubernetes.io/name":{}}},"f:maxSkew":{},"f:topologyKey":{},"f:whenUnsatisfiable":{}}},"f:volumes":{".":{},"k:{\"name\":\"erlang-cookie-secret\"}":{".":{},"f:name":{},"f:secret":{".":{},"f:defaultMode":{},"f:secretName":{}}},"k:{\"name\":\"plugins-conf\"}":{".":{},"f:configMap":{".":{},"f:defaultMode":{},"f:name":{}},"f:name":{}},"k:{\"name\":\"pod-info\"}":{".":{},"f:downwardAPI":{".":{},"f:defaultMode":{},"f:items":{}},"f:name":{}},"k:{\"name\":\"rabbitmq-confd\"}":{".":{},"f:name":{},"f:projected":{".":{},"f:defaultMode":{},"f:sources":{}}},"k:{\"name\":\"rabbitmq-erlang-cookie\"}":{".":{},"f:emptyDir":{},"f:name":{}},"k:{\"name\":\"rabbitmq-plugins\"}":{".":{},"f:emptyDir":{},"f:name":{}}}}},"f:updateStrategy":{"f:rollingUpdate":{".":{},"f:partition":{}},"f:type":{}},"f:volumeClaimTemplates":{}}}},{"manager":"kube-controller-manager","operation":"Update","apiVersion":"apps/v1","time":"2022-03-18T18:07:23Z","fieldsType":"FieldsV1","fieldsV1":{"f:status":{"f:collisionCount":{},"f:currentReplicas":{},"f:currentRevision":{},"f:observedGeneration":{},"f:readyReplicas":{},"f:replicas":{},"f:updateRevision":{},"f:updatedReplicas":{}}}}]},"spec":{"replicas":1,"selector":{"matchLabels":{"app.kubernetes.io/name":"rabbitmq-cluster"}},"template":{"metadata":{"creationTimestamp":null,"labels":{"app.kubernetes.io/component":"rabbitmq","app.kubernetes.io/name":"rabbitmq-cluster","app.kubernetes.io/part-of":"rabbitmq"},"annotations":{"prometheus.io/port":"15692","prometheus.io/scrape":"true"}},"spec":{"volumes":[{"name":"plugins-conf","configMap":{"name":"rabbitmq-cluster-plugins-conf","defaultMode":420}},{"name":"rabbitmq-confd","projected":{"sources":[{"secret":{"name":"rabbitmq-cluster-default-user","items":[{"key":"default_user.conf","path":"default_user.conf"}]}},{"configMap":{"name":"rabbitmq-cluster-server-conf","items":[{"key":"operatorDefaults.conf","path":"operatorDefaults.conf"},{"key":"userDefinedConfiguration.conf","path":"userDefinedConfiguration.conf"}]}}],"defaultMode":420}},{"name":"rabbitmq-erlang-cookie","emptyDir":{}},{"name":"erlang-cookie-secret","secret":{"secretName":"rabbitmq-cluster-erlang-cookie","defaultMode":420}},{"name":"rabbitmq-plugins","emptyDir":{}},{"name":"pod-info","downwardAPI":{"items":[{"path":"skipPreStopChecks","fieldRef":{"apiVersion":"v1","fieldPath":"metadata.labels['skipPreStopChecks']"}}],"defaultMode":420}}],"initContainers":[{"name":"setup-container","image":"rabbitmq:3.8.12-management","command":["sh","-c","cp /tmp/erlang-cookie-secret/.erlang.cookie /var/lib/rabbitmq/.erlang.cookie \u0026\u0026 chown 999:999 /var/lib/rabbitmq/.erlang.cookie \u0026\u0026 chmod 600 /var/lib/rabbitmq/.erlang.cookie ; cp /tmp/rabbitmq-plugins/enabled_plugins /operator/enabled_plugins \u0026\u0026 chown 999:999 /operator/enabled_plugins ; chown 999:999 /var/lib/rabbitmq/mnesia/ ; echo '[default]' \u003e /var/lib/rabbitmq/.rabbitmqadmin.conf \u0026\u0026 sed -e 's/default_user/username/' -e 's/default_pass/password/' /tmp/default_user.conf \u003e\u003e /var/lib/rabbitmq/.rabbitmqadmin.conf \u0026\u0026 chown 999:999 /var/lib/rabbitmq/.rabbitmqadmin.conf \u0026\u0026 chmod 600 /var/lib/rabbitmq/.rabbitmqadmin.conf"],"resources":{"limits":{"cpu":"100m","memory":"500Mi"},"requests":{"cpu":"100m","memory":"500Mi"}},"volumeMounts":[{"name":"plugins-conf","mountPath":"/tmp/rabbitmq-plugins/"},{"name":"rabbitmq-erlang-cookie","mountPath":"/var/lib/rabbitmq/"},{"name":"erlang-cookie-secret","mountPath":"/tmp/erlang-cookie-secret/"},{"name":"rabbitmq-plugins","mountPath":"/operator"},{"name":"persistence","mountPath":"/var/lib/rabbitmq/mnesia/"},{"name":"rabbitmq-confd","mountPath":"/tmp/default_user.conf","subPath":"default_user.conf"}],"terminationMessagePath":"/dev/termination-log","terminationMessagePolicy":"File","imagePullPolicy":"IfNotPresent","securityContext":{"capabilities":{"drop":["FSETID","KILL","SETGID","SETUID","SETPCAP","NET_BIND_SERVICE","NET_RAW","SYS_CHROOT","MKNOD","AUDIT_WRITE","SETFCAP"]},"runAsUser":0}}],"containers":[{"name":"rabbitmq","image":"rabbitmq:3.8.12-management","ports":[{"name":"epmd","containerPort":4369,"protocol":"TCP"},{"name":"amqp","containerPort":5672,"protocol":"TCP"},{"name":"management","containerPort":15672,"protocol":"TCP"},{"name":"prometheus","containerPort":15692,"protocol":"TCP"}],"env":[{"name":"MY_POD_NAME","valueFrom":{"fieldRef":{"apiVersion":"v1","fieldPath":"metadata.name"}}},{"name":"MY_POD_NAMESPACE","valueFrom":{"fieldRef":{"apiVersion":"v1","fieldPath":"metadata.namespace"}}},{"name":"RABBITMQ_ENABLED_PLUGINS_FILE","value":"/operator/enabled_plugins"},{"name":"K8S_SERVICE_NAME","value":"rabbitmq-cluster-nodes"},{"name":"RABBITMQ_USE_LONGNAME","value":"true"},{"name":"RABBITMQ_NODENAME","value":"rabbit@$(MY_POD_NAME).$(K8S_SERVICE_NAME).$(MY_POD_NAMESPACE)"},{"name":"K8S_HOSTNAME_SUFFIX","value":".$(K8S_SERVICE_NAME).$(MY_POD_NAMESPACE)"}],"resources":{"limits":{"cpu":"2","memory":"2Gi"},"requests":{"cpu":"1","memory":"2Gi"}},"volumeMounts":[{"name":"rabbitmq-erlang-cookie","mountPath":"/var/lib/rabbitmq/"},{"name":"persistence","mountPath":"/var/lib/rabbitmq/mnesia/"},{"name":"rabbitmq-plugins","mountPath":"/operator"},{"name":"rabbitmq-confd","mountPath":"/etc/rabbitmq/conf.d/10-operatorDefaults.conf","subPath":"operatorDefaults.conf"},{"name":"rabbitmq-confd","mountPath":"/etc/rabbitmq/conf.d/11-default_user.conf","subPath":"default_user.conf"},{"name":"rabbitmq-confd","mountPath":"/etc/rabbitmq/conf.d/90-userDefinedConfiguration.conf","subPath":"userDefinedConfiguration.conf"},{"name":"pod-info","mountPath":"/etc/pod-info/"}],"readinessProbe":{"tcpSocket":{"port":"amqp"},"initialDelaySeconds":10,"timeoutSeconds":5,"periodSeconds":10,"successThreshold":1,"failureThreshold":3},"lifecycle":{"preStop":{"exec":{"command":["/bin/bash","-c","if [ ! -z \"$(cat /etc/pod-info/skipPreStopChecks)\" ]; then exit 0; fi; rabbitmq-upgrade await_online_quorum_plus_one -t 604800; rabbitmq-upgrade await_online_synchronized_mirror -t 604800; rabbitmq-upgrade drain -t 604800"]}}},"terminationMessagePath":"/dev/termination-log","terminationMessagePolicy":"File","imagePullPolicy":"IfNotPresent"}],"restartPolicy":"Always","terminationGracePeriodSeconds":604800,"dnsPolicy":"ClusterFirst","serviceAccountName":"rabbitmq-cluster-server","serviceAccount":"rabbitmq-cluster-server","automountServiceAccountToken":true,"securityContext":{"runAsUser":999,"runAsGroup":999,"fsGroup":999},"schedulerName":"default-scheduler","topologySpreadConstraints":[{"maxSkew":1,"topologyKey":"topology.kubernetes.io/zone","whenUnsatisfiable":"ScheduleAnyway","labelSelector":{"matchLabels":{"app.kubernetes.io/name":"rabbitmq-cluster"}}}]}},"volumeClaimTemplates":[{"metadata":{"name":"persistence","namespace":"default","creationTimestamp":null,"labels":{"app.kubernetes.io/component":"rabbitmq","app.kubernetes.io/name":"rabbitmq-cluster","app.kubernetes.io/part-of":"rabbitmq"},"ownerReferences":[{"apiVersion":"rabbitmq.com/v1beta1","kind":"RabbitmqCluster","name":"rabbitmq-cluster","uid":"3ecefa8a-1bec-48a7-9af4-dd0df3339101","controller":true,"blockOwnerDeletion":false}]},"spec":{"accessModes":["ReadWriteOnce"],"resources":{"requests":{"storage":"10Gi"}},"volumeMode":"Filesystem"},"status":{"phase":"Pending"}}],"serviceName":"rabbitmq-cluster-nodes","podManagementPolicy":"Parallel","updateStrategy":{"type":"RollingUpdate","rollingUpdate":{"partition":0}},"revisionHistoryLimit":10},"status":{"observedGeneration":1,"replicas":1,"readyReplicas":1,"currentReplicas":1,"updatedReplicas":1,"currentRevision":"rabbitmq-cluster-server-5f8b8665fb","updateRevision":"rabbitmq-cluster-server-5f8b8665fb","collisionCount":0}}
2022/03/18 18:07:24 learn_server.go:256: [SIEVE-BEFORE-WRITE]	31
2022/03/18 18:07:24 learn_server.go:263: [SIEVE-AFTER-WRITE]	31	Update	statefulset	github.com/rabbitmq/cluster-operator/controllers.(*RabbitmqClusterReconciler)	NoError	{"metadata":{"name":"rabbitmq-cluster-server","namespace":"default","selfLink":"/apis/apps/v1/namespaces/default/statefulsets/rabbitmq-cluster-server","uid":"f2f07f3e-b500-4c48-a5de-8db7eaf37b9a","resourceVersion":"1409","generation":1,"creationTimestamp":"2022-03-18T18:06:25Z","labels":{"app.kubernetes.io/component":"rabbitmq","app.kubernetes.io/name":"rabbitmq-cluster","app.kubernetes.io/part-of":"rabbitmq"},"ownerReferences":[{"apiVersion":"rabbitmq.com/v1beta1","kind":"RabbitmqCluster","name":"rabbitmq-cluster","uid":"3ecefa8a-1bec-48a7-9af4-dd0df3339101","controller":true,"blockOwnerDeletion":true}],"managedFields":[{"manager":"manager","operation":"Update","apiVersion":"apps/v1","time":"2022-03-18T18:06:25Z","fieldsType":"FieldsV1","fieldsV1":{"f:metadata":{"f:labels":{".":{},"f:app.kubernetes.io/component":{},"f:app.kubernetes.io/name":{},"f:app.kubernetes.io/part-of":{}},"f:ownerReferences":{".":{},"k:{\"uid\":\"3ecefa8a-1bec-48a7-9af4-dd0df3339101\"}":{".":{},"f:apiVersion":{},"f:blockOwnerDeletion":{},"f:controller":{},"f:kind":{},"f:name":{},"f:uid":{}}}},"f:spec":{"f:podManagementPolicy":{},"f:replicas":{},"f:revisionHistoryLimit":{},"f:selector":{"f:matchLabels":{".":{},"f:app.kubernetes.io/name":{}}},"f:serviceName":{},"f:template":{"f:metadata":{"f:annotations":{".":{},"f:prometheus.io/port":{},"f:prometheus.io/scrape":{}},"f:labels":{".":{},"f:app.kubernetes.io/component":{},"f:app.kubernetes.io/name":{},"f:app.kubernetes.io/part-of":{}}},"f:spec":{"f:automountServiceAccountToken":{},"f:containers":{"k:{\"name\":\"rabbitmq\"}":{".":{},"f:env":{".":{},"k:{\"name\":\"K8S_HOSTNAME_SUFFIX\"}":{".":{},"f:name":{},"f:value":{}},"k:{\"name\":\"K8S_SERVICE_NAME\"}":{".":{},"f:name":{},"f:value":{}},"k:{\"name\":\"MY_POD_NAME\"}":{".":{},"f:name":{},"f:valueFrom":{".":{},"f:fieldRef":{".":{},"f:apiVersion":{},"f:fieldPath":{}}}},"k:{\"name\":\"MY_POD_NAMESPACE\"}":{".":{},"f:name":{},"f:valueFrom":{".":{},"f:fieldRef":{".":{},"f:apiVersion":{},"f:fieldPath":{}}}},"k:{\"name\":\"RABBITMQ_ENABLED_PLUGINS_FILE\"}":{".":{},"f:name":{},"f:value":{}},"k:{\"name\":\"RABBITMQ_NODENAME\"}":{".":{},"f:name":{},"f:value":{}},"k:{\"name\":\"RABBITMQ_USE_LONGNAME\"}":{".":{},"f:name":{},"f:value":{}}},"f:image":{},"f:imagePullPolicy":{},"f:lifecycle":{".":{},"f:preStop":{".":{},"f:exec":{".":{},"f:command":{}}}},"f:name":{},"f:ports":{".":{},"k:{\"containerPort\":4369,\"protocol\":\"TCP\"}":{".":{},"f:containerPort":{},"f:name":{},"f:protocol":{}},"k:{\"containerPort\":5672,\"protocol\":\"TCP\"}":{".":{},"f:containerPort":{},"f:name":{},"f:protocol":{}},"k:{\"containerPort\":15672,\"protocol\":\"TCP\"}":{".":{},"f:containerPort":{},"f:name":{},"f:protocol":{}},"k:{\"containerPort\":15692,\"protocol\":\"TCP\"}":{".":{},"f:containerPort":{},"f:name":{},"f:protocol":{}}},"f:readinessProbe":{".":{},"f:failureThreshold":{},"f:initialDelaySeconds":{},"f:periodSeconds":{},"f:successThreshold":{},"f:tcpSocket":{".":{},"f:port":{}},"f:timeoutSeconds":{}},"f:resources":{".":{},"f:limits":{".":{},"f:cpu":{},"f:memory":{}},"f:requests":{".":{},"f:cpu":{},"f:memory":{}}},"f:terminationMessagePath":{},"f:terminationMessagePolicy":{},"f:volumeMounts":{".":{},"k:{\"mountPath\":\"/etc/pod-info/\"}":{".":{},"f:mountPath":{},"f:name":{}},"k:{\"mountPath\":\"/etc/rabbitmq/conf.d/10-operatorDefaults.conf\"}":{".":{},"f:mountPath":{},"f:name":{},"f:subPath":{}},"k:{\"mountPath\":\"/etc/rabbitmq/conf.d/11-default_user.conf\"}":{".":{},"f:mountPath":{},"f:name":{},"f:subPath":{}},"k:{\"mountPath\":\"/etc/rabbitmq/conf.d/90-userDefinedConfiguration.conf\"}":{".":{},"f:mountPath":{},"f:name":{},"f:subPath":{}},"k:{\"mountPath\":\"/operator\"}":{".":{},"f:mountPath":{},"f:name":{}},"k:{\"mountPath\":\"/var/lib/rabbitmq/\"}":{".":{},"f:mountPath":{},"f:name":{}},"k:{\"mountPath\":\"/var/lib/rabbitmq/mnesia/\"}":{".":{},"f:mountPath":{},"f:name":{}}}}},"f:dnsPolicy":{},"f:initContainers":{".":{},"k:{\"name\":\"setup-container\"}":{".":{},"f:command":{},"f:image":{},"f:imagePullPolicy":{},"f:name":{},"f:resources":{".":{},"f:limits":{".":{},"f:cpu":{},"f:memory":{}},"f:requests":{".":{},"f:cpu":{},"f:memory":{}}},"f:securityContext":{".":{},"f:capabilities":{".":{},"f:drop":{}},"f:runAsUser":{}},"f:terminationMessagePath":{},"f:terminationMessagePolicy":{},"f:volumeMounts":{".":{},"k:{\"mountPath\":\"/operator\"}":{".":{},"f:mountPath":{},"f:name":{}},"k:{\"mountPath\":\"/tmp/default_user.conf\"}":{".":{},"f:mountPath":{},"f:name":{},"f:subPath":{}},"k:{\"mountPath\":\"/tmp/erlang-cookie-secret/\"}":{".":{},"f:mountPath":{},"f:name":{}},"k:{\"mountPath\":\"/tmp/rabbitmq-plugins/\"}":{".":{},"f:mountPath":{},"f:name":{}},"k:{\"mountPath\":\"/var/lib/rabbitmq/\"}":{".":{},"f:mountPath":{},"f:name":{}},"k:{\"mountPath\":\"/var/lib/rabbitmq/mnesia/\"}":{".":{},"f:mountPath":{},"f:name":{}}}}},"f:restartPolicy":{},"f:schedulerName":{},"f:securityContext":{".":{},"f:fsGroup":{},"f:runAsGroup":{},"f:runAsUser":{}},"f:serviceAccount":{},"f:serviceAccountName":{},"f:terminationGracePeriodSeconds":{},"f:topologySpreadConstraints":{".":{},"k:{\"topologyKey\":\"topology.kubernetes.io/zone\",\"whenUnsatisfiable\":\"ScheduleAnyway\"}":{".":{},"f:labelSelector":{".":{},"f:matchLabels":{".":{},"f:app.kubernetes.io/name":{}}},"f:maxSkew":{},"f:topologyKey":{},"f:whenUnsatisfiable":{}}},"f:volumes":{".":{},"k:{\"name\":\"erlang-cookie-secret\"}":{".":{},"f:name":{},"f:secret":{".":{},"f:defaultMode":{},"f:secretName":{}}},"k:{\"name\":\"plugins-conf\"}":{".":{},"f:configMap":{".":{},"f:defaultMode":{},"f:name":{}},"f:name":{}},"k:{\"name\":\"pod-info\"}":{".":{},"f:downwardAPI":{".":{},"f:defaultMode":{},"f:items":{}},"f:name":{}},"k:{\"name\":\"rabbitmq-confd\"}":{".":{},"f:name":{},"f:projected":{".":{},"f:defaultMode":{},"f:sources":{}}},"k:{\"name\":\"rabbitmq-erlang-cookie\"}":{".":{},"f:emptyDir":{},"f:name":{}},"k:{\"name\":\"rabbitmq-plugins\"}":{".":{},"f:emptyDir":{},"f:name":{}}}}},"f:updateStrategy":{"f:rollingUpdate":{".":{},"f:partition":{}},"f:type":{}},"f:volumeClaimTemplates":{}}}},{"manager":"kube-controller-manager","operation":"Update","apiVersion":"apps/v1","time":"2022-03-18T18:07:23Z","fieldsType":"FieldsV1","fieldsV1":{"f:status":{"f:collisionCount":{},"f:currentReplicas":{},"f:currentRevision":{},"f:observedGeneration":{},"f:readyReplicas":{},"f:replicas":{},"f:updateRevision":{},"f:updatedReplicas":{}}}}]},"spec":{"replicas":1,"selector":{"matchLabels":{"app.kubernetes.io/name":"rabbitmq-cluster"}},"template":{"metadata":{"creationTimestamp":null,"labels":{"app.kubernetes.io/component":"rabbitmq","app.kubernetes.io/name":"rabbitmq-cluster","app.kubernetes.io/part-of":"rabbitmq"},"annotations":{"prometheus.io/port":"15692","prometheus.io/scrape":"true"}},"spec":{"volumes":[{"name":"plugins-conf","configMap":{"name":"rabbitmq-cluster-plugins-conf","defaultMode":420}},{"name":"rabbitmq-confd","projected":{"sources":[{"secret":{"name":"rabbitmq-cluster-default-user","items":[{"key":"default_user.conf","path":"default_user.conf"}]}},{"configMap":{"name":"rabbitmq-cluster-server-conf","items":[{"key":"operatorDefaults.conf","path":"operatorDefaults.conf"},{"key":"userDefinedConfiguration.conf","path":"userDefinedConfiguration.conf"}]}}],"defaultMode":420}},{"name":"rabbitmq-erlang-cookie","emptyDir":{}},{"name":"erlang-cookie-secret","secret":{"secretName":"rabbitmq-cluster-erlang-cookie","defaultMode":420}},{"name":"rabbitmq-plugins","emptyDir":{}},{"name":"pod-info","downwardAPI":{"items":[{"path":"skipPreStopChecks","fieldRef":{"apiVersion":"v1","fieldPath":"metadata.labels['skipPreStopChecks']"}}],"defaultMode":420}}],"initContainers":[{"name":"setup-container","image":"rabbitmq:3.8.12-management","command":["sh","-c","cp /tmp/erlang-cookie-secret/.erlang.cookie /var/lib/rabbitmq/.erlang.cookie \u0026\u0026 chown 999:999 /var/lib/rabbitmq/.erlang.cookie \u0026\u0026 chmod 600 /var/lib/rabbitmq/.erlang.cookie ; cp /tmp/rabbitmq-plugins/enabled_plugins /operator/enabled_plugins \u0026\u0026 chown 999:999 /operator/enabled_plugins ; chown 999:999 /var/lib/rabbitmq/mnesia/ ; echo '[default]' \u003e /var/lib/rabbitmq/.rabbitmqadmin.conf \u0026\u0026 sed -e 's/default_user/username/' -e 's/default_pass/password/' /tmp/default_user.conf \u003e\u003e /var/lib/rabbitmq/.rabbitmqadmin.conf \u0026\u0026 chown 999:999 /var/lib/rabbitmq/.rabbitmqadmin.conf \u0026\u0026 chmod 600 /var/lib/rabbitmq/.rabbitmqadmin.conf"],"resources":{"limits":{"cpu":"100m","memory":"500Mi"},"requests":{"cpu":"100m","memory":"500Mi"}},"volumeMounts":[{"name":"plugins-conf","mountPath":"/tmp/rabbitmq-plugins/"},{"name":"rabbitmq-erlang-cookie","mountPath":"/var/lib/rabbitmq/"},{"name":"erlang-cookie-secret","mountPath":"/tmp/erlang-cookie-secret/"},{"name":"rabbitmq-plugins","mountPath":"/operator"},{"name":"persistence","mountPath":"/var/lib/rabbitmq/mnesia/"},{"name":"rabbitmq-confd","mountPath":"/tmp/default_user.conf","subPath":"default_user.conf"}],"terminationMessagePath":"/dev/termination-log","terminationMessagePolicy":"File","imagePullPolicy":"IfNotPresent","securityContext":{"capabilities":{"drop":["FSETID","KILL","SETGID","SETUID","SETPCAP","NET_BIND_SERVICE","NET_RAW","SYS_CHROOT","MKNOD","AUDIT_WRITE","SETFCAP"]},"runAsUser":0}}],"containers":[{"name":"rabbitmq","image":"rabbitmq:3.8.12-management","ports":[{"name":"epmd","containerPort":4369,"protocol":"TCP"},{"name":"amqp","containerPort":5672,"protocol":"TCP"},{"name":"management","containerPort":15672,"protocol":"TCP"},{"name":"prometheus","containerPort":15692,"protocol":"TCP"}],"env":[{"name":"MY_POD_NAME","valueFrom":{"fieldRef":{"apiVersion":"v1","fieldPath":"metadata.name"}}},{"name":"MY_POD_NAMESPACE","valueFrom":{"fieldRef":{"apiVersion":"v1","fieldPath":"metadata.namespace"}}},{"name":"RABBITMQ_ENABLED_PLUGINS_FILE","value":"/operator/enabled_plugins"},{"name":"K8S_SERVICE_NAME","value":"rabbitmq-cluster-nodes"},{"name":"RABBITMQ_USE_LONGNAME","value":"true"},{"name":"RABBITMQ_NODENAME","value":"rabbit@$(MY_POD_NAME).$(K8S_SERVICE_NAME).$(MY_POD_NAMESPACE)"},{"name":"K8S_HOSTNAME_SUFFIX","value":".$(K8S_SERVICE_NAME).$(MY_POD_NAMESPACE)"}],"resources":{"limits":{"cpu":"2","memory":"2Gi"},"requests":{"cpu":"1","memory":"2Gi"}},"volumeMounts":[{"name":"rabbitmq-erlang-cookie","mountPath":"/var/lib/rabbitmq/"},{"name":"persistence","mountPath":"/var/lib/rabbitmq/mnesia/"},{"name":"rabbitmq-plugins","mountPath":"/operator"},{"name":"rabbitmq-confd","mountPath":"/etc/rabbitmq/conf.d/10-operatorDefaults.conf","subPath":"operatorDefaults.conf"},{"name":"rabbitmq-confd","mountPath":"/etc/rabbitmq/conf.d/11-default_user.conf","subPath":"default_user.conf"},{"name":"rabbitmq-confd","mountPath":"/etc/rabbitmq/conf.d/90-userDefinedConfiguration.conf","subPath":"userDefinedConfiguration.conf"},{"name":"pod-info","mountPath":"/etc/pod-info/"}],"readinessProbe":{"tcpSocket":{"port":"amqp"},"initialDelaySeconds":10,"timeoutSeconds":5,"periodSeconds":10,"successThreshold":1,"failureThreshold":3},"lifecycle":{"preStop":{"exec":{"command":["/bin/bash","-c","if [ ! -z \"$(cat /etc/pod-info/skipPreStopChecks)\" ]; then exit 0; fi; rabbitmq-upgrade await_online_quorum_plus_one -t 604800; rabbitmq-upgrade await_online_synchronized_mirror -t 604800; rabbitmq-upgrade drain -t 604800"]}}},"terminationMessagePath":"/dev/termination-log","terminationMessagePolicy":"File","imagePullPolicy":"IfNotPresent"}],"restartPolicy":"Always","terminationGracePeriodSeconds":604800,"dnsPolicy":"ClusterFirst","serviceAccountName":"rabbitmq-cluster-server","serviceAccount":"rabbitmq-cluster-server","automountServiceAccountToken":true,"securityContext":{"runAsUser":999,"runAsGroup":999,"fsGroup":999},"schedulerName":"default-scheduler","topologySpreadConstraints":[{"maxSkew":1,"topologyKey":"topology.kubernetes.io/zone","whenUnsatisfiable":"ScheduleAnyway","labelSelector":{"matchLabels":{"app.kubernetes.io/name":"rabbitmq-cluster"}}}]}},"volumeClaimTemplates":[{"metadata":{"name":"persistence","namespace":"default","creationTimestamp":null,"labels":{"app.kubernetes.io/component":"rabbitmq","app.kubernetes.io/name":"rabbitmq-cluster","app.kubernetes.io/part-of":"rabbitmq"},"ownerReferences":[{"apiVersion":"rabbitmq.com/v1beta1","kind":"RabbitmqCluster","name":"rabbitmq-cluster","uid":"3ecefa8a-1bec-48a7-9af4-dd0df3339101","controller":true,"blockOwnerDeletion":false}]},"spec":{"accessModes":["ReadWriteOnce"],"resources":{"requests":{"storage":"10Gi"}},"volumeMode":"Filesystem"},"status":{"phase":"Pending"}}],"serviceName":"rabbitmq-cluster-nodes","podManagementPolicy":"Parallel","updateStrategy":{"type":"RollingUpdate","rollingUpdate":{"partition":0}},"revisionHistoryLimit":10},"status":{"observedGeneration":1,"replicas":1,"readyReplicas":1,"currentReplicas":1,"updatedReplicas":1,"currentRevision":"rabbitmq-cluster-server-5f8b8665fb","updateRevision":"rabbitmq-cluster-server-5f8b8665fb","collisionCount":0}}
2022/03/18 18:07:24 learn_server.go:291: [SIEVE-AFTER-READ]	Get	true	configmap	default	rabbitmq-cluster-server-conf	github.com/rabbitmq/cluster-operator/controllers.(*RabbitmqClusterReconciler)	NoError	{"kind":"ConfigMap","apiVersion":"v1","metadata":{"name":"rabbitmq-cluster-server-conf","namespace":"default","selfLink":"/api/v1/namespaces/default/configmaps/rabbitmq-cluster-server-conf","uid":"e4182078-d429-4baf-9021-72618c509ac5","resourceVersion":"1095","creationTimestamp":"2022-03-18T18:06:25Z","labels":{"app.kubernetes.io/component":"rabbitmq","app.kubernetes.io/name":"rabbitmq-cluster","app.kubernetes.io/part-of":"rabbitmq"},"ownerReferences":[{"apiVersion":"rabbitmq.com/v1beta1","kind":"RabbitmqCluster","name":"rabbitmq-cluster","uid":"3ecefa8a-1bec-48a7-9af4-dd0df3339101","controller":true,"blockOwnerDeletion":true}],"managedFields":[{"manager":"manager","operation":"Update","apiVersion":"v1","time":"2022-03-18T18:06:25Z","fieldsType":"FieldsV1","fieldsV1":{"f:data":{".":{},"f:operatorDefaults.conf":{},"f:userDefinedConfiguration.conf":{}},"f:metadata":{"f:labels":{".":{},"f:app.kubernetes.io/component":{},"f:app.kubernetes.io/name":{},"f:app.kubernetes.io/part-of":{}},"f:ownerReferences":{".":{},"k:{\"uid\":\"3ecefa8a-1bec-48a7-9af4-dd0df3339101\"}":{".":{},"f:apiVersion":{},"f:blockOwnerDeletion":{},"f:controller":{},"f:kind":{},"f:name":{},"f:uid":{}}}}}}]},"data":{"operatorDefaults.conf":"cluster_formation.peer_discovery_backend             = rabbit_peer_discovery_k8s\ncluster_formation.k8s.host                           = kubernetes.default\ncluster_formation.k8s.address_type                   = hostname\ncluster_partition_handling                           = pause_minority\nqueue_master_locator                                 = min-masters\ndisk_free_limit.absolute                             = 2GB\ncluster_formation.randomized_startup_delay_range.min = 5\ncluster_formation.randomized_startup_delay_range.max = 30\ncluster_name                                         = rabbitmq-cluster\n","userDefinedConfiguration.conf":"total_memory_available_override_value = 1717986919\n"}}
2022/03/18 18:07:24 learn_server.go:256: [SIEVE-BEFORE-WRITE]	32
2022/03/18 18:07:24 learn_server.go:263: [SIEVE-AFTER-WRITE]	32	StatusUpdate	rabbitmqcluster	github.com/rabbitmq/cluster-operator/controllers.(*RabbitmqClusterReconciler)	NoError	{"metadata":{"name":"rabbitmq-cluster","namespace":"default","selfLink":"/apis/rabbitmq.com/v1beta1/namespaces/default/rabbitmqclusters/rabbitmq-cluster/status","uid":"3ecefa8a-1bec-48a7-9af4-dd0df3339101","resourceVersion":"1410","generation":2,"creationTimestamp":"2022-03-18T18:06:25Z","annotations":{"kubectl.kubernetes.io/last-applied-configuration":"{\"apiVersion\":\"rabbitmq.com/v1beta1\",\"kind\":\"RabbitmqCluster\",\"metadata\":{\"annotations\":{},\"name\":\"rabbitmq-cluster\",\"namespace\":\"default\"},\"spec\":{\"persistence\":{\"storage\":\"10Gi\"},\"replicas\":1}}\n"},"finalizers":["deletion.finalizers.rabbitmqclusters.rabbitmq.com"],"managedFields":[{"manager":"kubectl-client-side-apply","operation":"Update","apiVersion":"rabbitmq.com/v1beta1","time":"2022-03-18T18:06:25Z","fieldsType":"FieldsV1","fieldsV1":{"f:metadata":{"f:annotations":{".":{},"f:kubectl.kubernetes.io/last-applied-configuration":{}}},"f:spec":{".":{},"f:image":{},"f:persistence":{".":{},"f:storage":{}},"f:replicas":{},"f:resources":{".":{},"f:limits":{".":{},"f:memory":{}},"f:requests":{".":{},"f:memory":{}}},"f:service":{".":{},"f:type":{}},"f:terminationGracePeriodSeconds":{}}}},{"manager":"manager","operation":"Update","apiVersion":"rabbitmq.com/v1beta1","time":"2022-03-18T18:07:24Z","fieldsType":"FieldsV1","fieldsV1":{"f:metadata":{"f:finalizers":{}},"f:spec":{"f:override":{},"f:rabbitmq":{},"f:resources":{"f:limits":{"f:cpu":{}},"f:requests":{"f:cpu":{}}},"f:tls":{}},"f:status":{".":{},"f:conditions":{},"f:defaultUser":{".":{},"f:secretReference":{".":{},"f:keys":{".":{},"f:password":{},"f:username":{}},"f:name":{},"f:namespace":{}},"f:serviceReference":{".":{},"f:name":{},"f:namespace":{}}}}}}]},"spec":{"replicas":1,"image":"rabbitmq:3.8.12-management","service":{"type":"ClusterIP"},"persistence":{"storage":"10Gi"},"resources":{"limits":{"cpu":"2","memory":"2Gi"},"requests":{"cpu":"1","memory":"2Gi"}},"rabbitmq":{},"tls":{},"override":{},"terminationGracePeriodSeconds":604800},"status":{"conditions":[{"type":"AllReplicasReady","status":"True","lastTransitionTime":"2022-03-18T18:07:23Z","reason":"AllPodsAreReady"},{"type":"ClusterAvailable","status":"True","lastTransitionTime":"2022-03-18T18:07:23Z","reason":"AtLeastOneEndpointAvailable"},{"type":"NoWarnings","status":"True","lastTransitionTime":"2022-03-18T18:06:25Z","reason":"NoWarnings"},{"type":"ReconcileSuccess","status":"True","lastTransitionTime":"2022-03-18T18:07:24Z","reason":"Success","message":"Finish reconciling"}],"defaultUser":{"secretReference":{"name":"rabbitmq-cluster-default-user","namespace":"default","keys":{"password":"password","username":"username"}},"serviceReference":{"name":"rabbitmq-cluster","namespace":"default"}},"binding":{"name":"rabbitmq-cluster-default-user"}}}
2022/03/18 18:07:24 learn_server.go:291: [SIEVE-AFTER-READ]	Get	true	statefulset	default	rabbitmq-cluster-server	github.com/rabbitmq/cluster-operator/controllers.(*RabbitmqClusterReconciler)	NoError	{"kind":"StatefulSet","apiVersion":"apps/v1","metadata":{"name":"rabbitmq-cluster-server","namespace":"default","selfLink":"/apis/apps/v1/namespaces/default/statefulsets/rabbitmq-cluster-server","uid":"f2f07f3e-b500-4c48-a5de-8db7eaf37b9a","resourceVersion":"1409","generation":1,"creationTimestamp":"2022-03-18T18:06:25Z","labels":{"app.kubernetes.io/component":"rabbitmq","app.kubernetes.io/name":"rabbitmq-cluster","app.kubernetes.io/part-of":"rabbitmq"},"ownerReferences":[{"apiVersion":"rabbitmq.com/v1beta1","kind":"RabbitmqCluster","name":"rabbitmq-cluster","uid":"3ecefa8a-1bec-48a7-9af4-dd0df3339101","controller":true,"blockOwnerDeletion":true}],"managedFields":[{"manager":"manager","operation":"Update","apiVersion":"apps/v1","time":"2022-03-18T18:06:25Z","fieldsType":"FieldsV1","fieldsV1":{"f:metadata":{"f:labels":{".":{},"f:app.kubernetes.io/component":{},"f:app.kubernetes.io/name":{},"f:app.kubernetes.io/part-of":{}},"f:ownerReferences":{".":{},"k:{\"uid\":\"3ecefa8a-1bec-48a7-9af4-dd0df3339101\"}":{".":{},"f:apiVersion":{},"f:blockOwnerDeletion":{},"f:controller":{},"f:kind":{},"f:name":{},"f:uid":{}}}},"f:spec":{"f:podManagementPolicy":{},"f:replicas":{},"f:revisionHistoryLimit":{},"f:selector":{"f:matchLabels":{".":{},"f:app.kubernetes.io/name":{}}},"f:serviceName":{},"f:template":{"f:metadata":{"f:annotations":{".":{},"f:prometheus.io/port":{},"f:prometheus.io/scrape":{}},"f:labels":{".":{},"f:app.kubernetes.io/component":{},"f:app.kubernetes.io/name":{},"f:app.kubernetes.io/part-of":{}}},"f:spec":{"f:automountServiceAccountToken":{},"f:containers":{"k:{\"name\":\"rabbitmq\"}":{".":{},"f:env":{".":{},"k:{\"name\":\"K8S_HOSTNAME_SUFFIX\"}":{".":{},"f:name":{},"f:value":{}},"k:{\"name\":\"K8S_SERVICE_NAME\"}":{".":{},"f:name":{},"f:value":{}},"k:{\"name\":\"MY_POD_NAME\"}":{".":{},"f:name":{},"f:valueFrom":{".":{},"f:fieldRef":{".":{},"f:apiVersion":{},"f:fieldPath":{}}}},"k:{\"name\":\"MY_POD_NAMESPACE\"}":{".":{},"f:name":{},"f:valueFrom":{".":{},"f:fieldRef":{".":{},"f:apiVersion":{},"f:fieldPath":{}}}},"k:{\"name\":\"RABBITMQ_ENABLED_PLUGINS_FILE\"}":{".":{},"f:name":{},"f:value":{}},"k:{\"name\":\"RABBITMQ_NODENAME\"}":{".":{},"f:name":{},"f:value":{}},"k:{\"name\":\"RABBITMQ_USE_LONGNAME\"}":{".":{},"f:name":{},"f:value":{}}},"f:image":{},"f:imagePullPolicy":{},"f:lifecycle":{".":{},"f:preStop":{".":{},"f:exec":{".":{},"f:command":{}}}},"f:name":{},"f:ports":{".":{},"k:{\"containerPort\":4369,\"protocol\":\"TCP\"}":{".":{},"f:containerPort":{},"f:name":{},"f:protocol":{}},"k:{\"containerPort\":5672,\"protocol\":\"TCP\"}":{".":{},"f:containerPort":{},"f:name":{},"f:protocol":{}},"k:{\"containerPort\":15672,\"protocol\":\"TCP\"}":{".":{},"f:containerPort":{},"f:name":{},"f:protocol":{}},"k:{\"containerPort\":15692,\"protocol\":\"TCP\"}":{".":{},"f:containerPort":{},"f:name":{},"f:protocol":{}}},"f:readinessProbe":{".":{},"f:failureThreshold":{},"f:initialDelaySeconds":{},"f:periodSeconds":{},"f:successThreshold":{},"f:tcpSocket":{".":{},"f:port":{}},"f:timeoutSeconds":{}},"f:resources":{".":{},"f:limits":{".":{},"f:cpu":{},"f:memory":{}},"f:requests":{".":{},"f:cpu":{},"f:memory":{}}},"f:terminationMessagePath":{},"f:terminationMessagePolicy":{},"f:volumeMounts":{".":{},"k:{\"mountPath\":\"/etc/pod-info/\"}":{".":{},"f:mountPath":{},"f:name":{}},"k:{\"mountPath\":\"/etc/rabbitmq/conf.d/10-operatorDefaults.conf\"}":{".":{},"f:mountPath":{},"f:name":{},"f:subPath":{}},"k:{\"mountPath\":\"/etc/rabbitmq/conf.d/11-default_user.conf\"}":{".":{},"f:mountPath":{},"f:name":{},"f:subPath":{}},"k:{\"mountPath\":\"/etc/rabbitmq/conf.d/90-userDefinedConfiguration.conf\"}":{".":{},"f:mountPath":{},"f:name":{},"f:subPath":{}},"k:{\"mountPath\":\"/operator\"}":{".":{},"f:mountPath":{},"f:name":{}},"k:{\"mountPath\":\"/var/lib/rabbitmq/\"}":{".":{},"f:mountPath":{},"f:name":{}},"k:{\"mountPath\":\"/var/lib/rabbitmq/mnesia/\"}":{".":{},"f:mountPath":{},"f:name":{}}}}},"f:dnsPolicy":{},"f:initContainers":{".":{},"k:{\"name\":\"setup-container\"}":{".":{},"f:command":{},"f:image":{},"f:imagePullPolicy":{},"f:name":{},"f:resources":{".":{},"f:limits":{".":{},"f:cpu":{},"f:memory":{}},"f:requests":{".":{},"f:cpu":{},"f:memory":{}}},"f:securityContext":{".":{},"f:capabilities":{".":{},"f:drop":{}},"f:runAsUser":{}},"f:terminationMessagePath":{},"f:terminationMessagePolicy":{},"f:volumeMounts":{".":{},"k:{\"mountPath\":\"/operator\"}":{".":{},"f:mountPath":{},"f:name":{}},"k:{\"mountPath\":\"/tmp/default_user.conf\"}":{".":{},"f:mountPath":{},"f:name":{},"f:subPath":{}},"k:{\"mountPath\":\"/tmp/erlang-cookie-secret/\"}":{".":{},"f:mountPath":{},"f:name":{}},"k:{\"mountPath\":\"/tmp/rabbitmq-plugins/\"}":{".":{},"f:mountPath":{},"f:name":{}},"k:{\"mountPath\":\"/var/lib/rabbitmq/\"}":{".":{},"f:mountPath":{},"f:name":{}},"k:{\"mountPath\":\"/var/lib/rabbitmq/mnesia/\"}":{".":{},"f:mountPath":{},"f:name":{}}}}},"f:restartPolicy":{},"f:schedulerName":{},"f:securityContext":{".":{},"f:fsGroup":{},"f:runAsGroup":{},"f:runAsUser":{}},"f:serviceAccount":{},"f:serviceAccountName":{},"f:terminationGracePeriodSeconds":{},"f:topologySpreadConstraints":{".":{},"k:{\"topologyKey\":\"topology.kubernetes.io/zone\",\"whenUnsatisfiable\":\"ScheduleAnyway\"}":{".":{},"f:labelSelector":{".":{},"f:matchLabels":{".":{},"f:app.kubernetes.io/name":{}}},"f:maxSkew":{},"f:topologyKey":{},"f:whenUnsatisfiable":{}}},"f:volumes":{".":{},"k:{\"name\":\"erlang-cookie-secret\"}":{".":{},"f:name":{},"f:secret":{".":{},"f:defaultMode":{},"f:secretName":{}}},"k:{\"name\":\"plugins-conf\"}":{".":{},"f:configMap":{".":{},"f:defaultMode":{},"f:name":{}},"f:name":{}},"k:{\"name\":\"pod-info\"}":{".":{},"f:downwardAPI":{".":{},"f:defaultMode":{},"f:items":{}},"f:name":{}},"k:{\"name\":\"rabbitmq-confd\"}":{".":{},"f:name":{},"f:projected":{".":{},"f:defaultMode":{},"f:sources":{}}},"k:{\"name\":\"rabbitmq-erlang-cookie\"}":{".":{},"f:emptyDir":{},"f:name":{}},"k:{\"name\":\"rabbitmq-plugins\"}":{".":{},"f:emptyDir":{},"f:name":{}}}}},"f:updateStrategy":{"f:rollingUpdate":{".":{},"f:partition":{}},"f:type":{}},"f:volumeClaimTemplates":{}}}},{"manager":"kube-controller-manager","operation":"Update","apiVersion":"apps/v1","time":"2022-03-18T18:07:23Z","fieldsType":"FieldsV1","fieldsV1":{"f:status":{"f:collisionCount":{},"f:currentReplicas":{},"f:currentRevision":{},"f:observedGeneration":{},"f:readyReplicas":{},"f:replicas":{},"f:updateRevision":{},"f:updatedReplicas":{}}}}]},"spec":{"replicas":1,"selector":{"matchLabels":{"app.kubernetes.io/name":"rabbitmq-cluster"}},"template":{"metadata":{"creationTimestamp":null,"labels":{"app.kubernetes.io/component":"rabbitmq","app.kubernetes.io/name":"rabbitmq-cluster","app.kubernetes.io/part-of":"rabbitmq"},"annotations":{"prometheus.io/port":"15692","prometheus.io/scrape":"true"}},"spec":{"volumes":[{"name":"plugins-conf","configMap":{"name":"rabbitmq-cluster-plugins-conf","defaultMode":420}},{"name":"rabbitmq-confd","projected":{"sources":[{"secret":{"name":"rabbitmq-cluster-default-user","items":[{"key":"default_user.conf","path":"default_user.conf"}]}},{"configMap":{"name":"rabbitmq-cluster-server-conf","items":[{"key":"operatorDefaults.conf","path":"operatorDefaults.conf"},{"key":"userDefinedConfiguration.conf","path":"userDefinedConfiguration.conf"}]}}],"defaultMode":420}},{"name":"rabbitmq-erlang-cookie","emptyDir":{}},{"name":"erlang-cookie-secret","secret":{"secretName":"rabbitmq-cluster-erlang-cookie","defaultMode":420}},{"name":"rabbitmq-plugins","emptyDir":{}},{"name":"pod-info","downwardAPI":{"items":[{"path":"skipPreStopChecks","fieldRef":{"apiVersion":"v1","fieldPath":"metadata.labels['skipPreStopChecks']"}}],"defaultMode":420}}],"initContainers":[{"name":"setup-container","image":"rabbitmq:3.8.12-management","command":["sh","-c","cp /tmp/erlang-cookie-secret/.erlang.cookie /var/lib/rabbitmq/.erlang.cookie \u0026\u0026 chown 999:999 /var/lib/rabbitmq/.erlang.cookie \u0026\u0026 chmod 600 /var/lib/rabbitmq/.erlang.cookie ; cp /tmp/rabbitmq-plugins/enabled_plugins /operator/enabled_plugins \u0026\u0026 chown 999:999 /operator/enabled_plugins ; chown 999:999 /var/lib/rabbitmq/mnesia/ ; echo '[default]' \u003e /var/lib/rabbitmq/.rabbitmqadmin.conf \u0026\u0026 sed -e 's/default_user/username/' -e 's/default_pass/password/' /tmp/default_user.conf \u003e\u003e /var/lib/rabbitmq/.rabbitmqadmin.conf \u0026\u0026 chown 999:999 /var/lib/rabbitmq/.rabbitmqadmin.conf \u0026\u0026 chmod 600 /var/lib/rabbitmq/.rabbitmqadmin.conf"],"resources":{"limits":{"cpu":"100m","memory":"500Mi"},"requests":{"cpu":"100m","memory":"500Mi"}},"volumeMounts":[{"name":"plugins-conf","mountPath":"/tmp/rabbitmq-plugins/"},{"name":"rabbitmq-erlang-cookie","mountPath":"/var/lib/rabbitmq/"},{"name":"erlang-cookie-secret","mountPath":"/tmp/erlang-cookie-secret/"},{"name":"rabbitmq-plugins","mountPath":"/operator"},{"name":"persistence","mountPath":"/var/lib/rabbitmq/mnesia/"},{"name":"rabbitmq-confd","mountPath":"/tmp/default_user.conf","subPath":"default_user.conf"}],"terminationMessagePath":"/dev/termination-log","terminationMessagePolicy":"File","imagePullPolicy":"IfNotPresent","securityContext":{"capabilities":{"drop":["FSETID","KILL","SETGID","SETUID","SETPCAP","NET_BIND_SERVICE","NET_RAW","SYS_CHROOT","MKNOD","AUDIT_WRITE","SETFCAP"]},"runAsUser":0}}],"containers":[{"name":"rabbitmq","image":"rabbitmq:3.8.12-management","ports":[{"name":"epmd","containerPort":4369,"protocol":"TCP"},{"name":"amqp","containerPort":5672,"protocol":"TCP"},{"name":"management","containerPort":15672,"protocol":"TCP"},{"name":"prometheus","containerPort":15692,"protocol":"TCP"}],"env":[{"name":"MY_POD_NAME","valueFrom":{"fieldRef":{"apiVersion":"v1","fieldPath":"metadata.name"}}},{"name":"MY_POD_NAMESPACE","valueFrom":{"fieldRef":{"apiVersion":"v1","fieldPath":"metadata.namespace"}}},{"name":"RABBITMQ_ENABLED_PLUGINS_FILE","value":"/operator/enabled_plugins"},{"name":"K8S_SERVICE_NAME","value":"rabbitmq-cluster-nodes"},{"name":"RABBITMQ_USE_LONGNAME","value":"true"},{"name":"RABBITMQ_NODENAME","value":"rabbit@$(MY_POD_NAME).$(K8S_SERVICE_NAME).$(MY_POD_NAMESPACE)"},{"name":"K8S_HOSTNAME_SUFFIX","value":".$(K8S_SERVICE_NAME).$(MY_POD_NAMESPACE)"}],"resources":{"limits":{"cpu":"2","memory":"2Gi"},"requests":{"cpu":"1","memory":"2Gi"}},"volumeMounts":[{"name":"rabbitmq-erlang-cookie","mountPath":"/var/lib/rabbitmq/"},{"name":"persistence","mountPath":"/var/lib/rabbitmq/mnesia/"},{"name":"rabbitmq-plugins","mountPath":"/operator"},{"name":"rabbitmq-confd","mountPath":"/etc/rabbitmq/conf.d/10-operatorDefaults.conf","subPath":"operatorDefaults.conf"},{"name":"rabbitmq-confd","mountPath":"/etc/rabbitmq/conf.d/11-default_user.conf","subPath":"default_user.conf"},{"name":"rabbitmq-confd","mountPath":"/etc/rabbitmq/conf.d/90-userDefinedConfiguration.conf","subPath":"userDefinedConfiguration.conf"},{"name":"pod-info","mountPath":"/etc/pod-info/"}],"readinessProbe":{"tcpSocket":{"port":"amqp"},"initialDelaySeconds":10,"timeoutSeconds":5,"periodSeconds":10,"successThreshold":1,"failureThreshold":3},"lifecycle":{"preStop":{"exec":{"command":["/bin/bash","-c","if [ ! -z \"$(cat /etc/pod-info/skipPreStopChecks)\" ]; then exit 0; fi; rabbitmq-upgrade await_online_quorum_plus_one -t 604800; rabbitmq-upgrade await_online_synchronized_mirror -t 604800; rabbitmq-upgrade drain -t 604800"]}}},"terminationMessagePath":"/dev/termination-log","terminationMessagePolicy":"File","imagePullPolicy":"IfNotPresent"}],"restartPolicy":"Always","terminationGracePeriodSeconds":604800,"dnsPolicy":"ClusterFirst","serviceAccountName":"rabbitmq-cluster-server","serviceAccount":"rabbitmq-cluster-server","automountServiceAccountToken":true,"securityContext":{"runAsUser":999,"runAsGroup":999,"fsGroup":999},"schedulerName":"default-scheduler","topologySpreadConstraints":[{"maxSkew":1,"topologyKey":"topology.kubernetes.io/zone","whenUnsatisfiable":"ScheduleAnyway","labelSelector":{"matchLabels":{"app.kubernetes.io/name":"rabbitmq-cluster"}}}]}},"volumeClaimTemplates":[{"metadata":{"name":"persistence","namespace":"default","creationTimestamp":null,"labels":{"app.kubernetes.io/component":"rabbitmq","app.kubernetes.io/name":"rabbitmq-cluster","app.kubernetes.io/part-of":"rabbitmq"},"ownerReferences":[{"apiVersion":"rabbitmq.com/v1beta1","kind":"RabbitmqCluster","name":"rabbitmq-cluster","uid":"3ecefa8a-1bec-48a7-9af4-dd0df3339101","controller":true,"blockOwnerDeletion":false}]},"spec":{"accessModes":["ReadWriteOnce"],"resources":{"requests":{"storage":"10Gi"}},"volumeMode":"Filesystem"},"status":{"phase":"Pending"}}],"serviceName":"rabbitmq-cluster-nodes","podManagementPolicy":"Parallel","updateStrategy":{"type":"RollingUpdate","rollingUpdate":{"partition":0}},"revisionHistoryLimit":10},"status":{"observedGeneration":1,"replicas":1,"readyReplicas":1,"currentReplicas":1,"updatedReplicas":1,"currentRevision":"rabbitmq-cluster-server-5f8b8665fb","updateRevision":"rabbitmq-cluster-server-5f8b8665fb","collisionCount":0}}
2022/03/18 18:07:24 learn_server.go:291: [SIEVE-AFTER-READ]	Get	true	configmap	default	rabbitmq-cluster-plugins-conf	github.com/rabbitmq/cluster-operator/controllers.(*RabbitmqClusterReconciler)	NoError	{"kind":"ConfigMap","apiVersion":"v1","metadata":{"name":"rabbitmq-cluster-plugins-conf","namespace":"default","selfLink":"/api/v1/namespaces/default/configmaps/rabbitmq-cluster-plugins-conf","uid":"0aa26eb6-ff3a-4457-a223-284c897db7fe","resourceVersion":"1092","creationTimestamp":"2022-03-18T18:06:25Z","labels":{"app.kubernetes.io/component":"rabbitmq","app.kubernetes.io/name":"rabbitmq-cluster","app.kubernetes.io/part-of":"rabbitmq"},"ownerReferences":[{"apiVersion":"rabbitmq.com/v1beta1","kind":"RabbitmqCluster","name":"rabbitmq-cluster","uid":"3ecefa8a-1bec-48a7-9af4-dd0df3339101","controller":true,"blockOwnerDeletion":true}],"managedFields":[{"manager":"manager","operation":"Update","apiVersion":"v1","time":"2022-03-18T18:06:25Z","fieldsType":"FieldsV1","fieldsV1":{"f:data":{".":{},"f:enabled_plugins":{}},"f:metadata":{"f:labels":{".":{},"f:app.kubernetes.io/component":{},"f:app.kubernetes.io/name":{},"f:app.kubernetes.io/part-of":{}},"f:ownerReferences":{".":{},"k:{\"uid\":\"3ecefa8a-1bec-48a7-9af4-dd0df3339101\"}":{".":{},"f:apiVersion":{},"f:blockOwnerDeletion":{},"f:controller":{},"f:kind":{},"f:name":{},"f:uid":{}}}}}}]},"data":{"enabled_plugins":"[rabbitmq_peer_discovery_k8s,rabbitmq_prometheus,rabbitmq_management]."}}
2022/03/18 18:07:24 learn_server.go:256: [SIEVE-BEFORE-WRITE]	33
2022/03/18 18:07:24 learn_server.go:263: [SIEVE-AFTER-WRITE]	33	StatusUpdate	rabbitmqcluster	github.com/rabbitmq/cluster-operator/controllers.(*RabbitmqClusterReconciler)	NoError	{"metadata":{"name":"rabbitmq-cluster","namespace":"default","selfLink":"/apis/rabbitmq.com/v1beta1/namespaces/default/rabbitmqclusters/rabbitmq-cluster/status","uid":"3ecefa8a-1bec-48a7-9af4-dd0df3339101","resourceVersion":"1410","generation":2,"creationTimestamp":"2022-03-18T18:06:25Z","annotations":{"kubectl.kubernetes.io/last-applied-configuration":"{\"apiVersion\":\"rabbitmq.com/v1beta1\",\"kind\":\"RabbitmqCluster\",\"metadata\":{\"annotations\":{},\"name\":\"rabbitmq-cluster\",\"namespace\":\"default\"},\"spec\":{\"persistence\":{\"storage\":\"10Gi\"},\"replicas\":1}}\n"},"finalizers":["deletion.finalizers.rabbitmqclusters.rabbitmq.com"],"managedFields":[{"manager":"kubectl-client-side-apply","operation":"Update","apiVersion":"rabbitmq.com/v1beta1","time":"2022-03-18T18:06:25Z","fieldsType":"FieldsV1","fieldsV1":{"f:metadata":{"f:annotations":{".":{},"f:kubectl.kubernetes.io/last-applied-configuration":{}}},"f:spec":{".":{},"f:image":{},"f:persistence":{".":{},"f:storage":{}},"f:replicas":{},"f:resources":{".":{},"f:limits":{".":{},"f:memory":{}},"f:requests":{".":{},"f:memory":{}}},"f:service":{".":{},"f:type":{}},"f:terminationGracePeriodSeconds":{}}}},{"manager":"manager","operation":"Update","apiVersion":"rabbitmq.com/v1beta1","time":"2022-03-18T18:07:24Z","fieldsType":"FieldsV1","fieldsV1":{"f:metadata":{"f:finalizers":{}},"f:spec":{"f:override":{},"f:rabbitmq":{},"f:resources":{"f:limits":{"f:cpu":{}},"f:requests":{"f:cpu":{}}},"f:tls":{}},"f:status":{".":{},"f:conditions":{},"f:defaultUser":{".":{},"f:secretReference":{".":{},"f:keys":{".":{},"f:password":{},"f:username":{}},"f:name":{},"f:namespace":{}},"f:serviceReference":{".":{},"f:name":{},"f:namespace":{}}}}}}]},"spec":{"replicas":1,"image":"rabbitmq:3.8.12-management","service":{"type":"ClusterIP"},"persistence":{"storage":"10Gi"},"resources":{"limits":{"cpu":"2","memory":"2Gi"},"requests":{"cpu":"1","memory":"2Gi"}},"rabbitmq":{},"tls":{},"override":{},"terminationGracePeriodSeconds":604800},"status":{"conditions":[{"type":"AllReplicasReady","status":"True","lastTransitionTime":"2022-03-18T18:07:23Z","reason":"AllPodsAreReady"},{"type":"ClusterAvailable","status":"True","lastTransitionTime":"2022-03-18T18:07:23Z","reason":"AtLeastOneEndpointAvailable"},{"type":"NoWarnings","status":"True","lastTransitionTime":"2022-03-18T18:06:25Z","reason":"NoWarnings"},{"type":"ReconcileSuccess","status":"True","lastTransitionTime":"2022-03-18T18:07:24Z","reason":"Success","message":"Finish reconciling"}],"defaultUser":{"secretReference":{"name":"rabbitmq-cluster-default-user","namespace":"default","keys":{"password":"password","username":"username"}},"serviceReference":{"name":"rabbitmq-cluster","namespace":"default"}},"binding":{"name":"rabbitmq-cluster-default-user"}}}
2022/03/18 18:07:24 learn_server.go:253: [SIEVE-AFTER-RECONCILE]	github.com/rabbitmq/cluster-operator/controllers.(*RabbitmqClusterReconciler)	7
2022/03/18 18:07:25 learn_server.go:238: [SIEVE-BEFORE-RECONCILE]	github.com/rabbitmq/cluster-operator/controllers.(*RabbitmqClusterReconciler)	8
2022/03/18 18:07:25 learn_server.go:291: [SIEVE-AFTER-READ]	Get	true	rabbitmqcluster	default	rabbitmq-cluster	github.com/rabbitmq/cluster-operator/controllers.(*RabbitmqClusterReconciler)	NoError	{"kind":"RabbitmqCluster","apiVersion":"rabbitmq.com/v1beta1","metadata":{"name":"rabbitmq-cluster","namespace":"default","selfLink":"/apis/rabbitmq.com/v1beta1/namespaces/default/rabbitmqclusters/rabbitmq-cluster","uid":"3ecefa8a-1bec-48a7-9af4-dd0df3339101","resourceVersion":"1410","generation":2,"creationTimestamp":"2022-03-18T18:06:25Z","annotations":{"kubectl.kubernetes.io/last-applied-configuration":"{\"apiVersion\":\"rabbitmq.com/v1beta1\",\"kind\":\"RabbitmqCluster\",\"metadata\":{\"annotations\":{},\"name\":\"rabbitmq-cluster\",\"namespace\":\"default\"},\"spec\":{\"persistence\":{\"storage\":\"10Gi\"},\"replicas\":1}}\n"},"finalizers":["deletion.finalizers.rabbitmqclusters.rabbitmq.com"],"managedFields":[{"manager":"kubectl-client-side-apply","operation":"Update","apiVersion":"rabbitmq.com/v1beta1","time":"2022-03-18T18:06:25Z","fieldsType":"FieldsV1","fieldsV1":{"f:metadata":{"f:annotations":{".":{},"f:kubectl.kubernetes.io/last-applied-configuration":{}}},"f:spec":{".":{},"f:image":{},"f:persistence":{".":{},"f:storage":{}},"f:replicas":{},"f:resources":{".":{},"f:limits":{".":{},"f:memory":{}},"f:requests":{".":{},"f:memory":{}}},"f:service":{".":{},"f:type":{}},"f:terminationGracePeriodSeconds":{}}}},{"manager":"manager","operation":"Update","apiVersion":"rabbitmq.com/v1beta1","time":"2022-03-18T18:07:24Z","fieldsType":"FieldsV1","fieldsV1":{"f:metadata":{"f:finalizers":{}},"f:spec":{"f:override":{},"f:rabbitmq":{},"f:resources":{"f:limits":{"f:cpu":{}},"f:requests":{"f:cpu":{}}},"f:tls":{}},"f:status":{".":{},"f:conditions":{},"f:defaultUser":{".":{},"f:secretReference":{".":{},"f:keys":{".":{},"f:password":{},"f:username":{}},"f:name":{},"f:namespace":{}},"f:serviceReference":{".":{},"f:name":{},"f:namespace":{}}}}}}]},"spec":{"replicas":1,"image":"rabbitmq:3.8.12-management","service":{"type":"ClusterIP"},"persistence":{"storage":"10Gi"},"resources":{"limits":{"cpu":"2","memory":"2Gi"},"requests":{"cpu":"1","memory":"2Gi"}},"rabbitmq":{},"tls":{},"override":{},"terminationGracePeriodSeconds":604800},"status":{"conditions":[{"type":"AllReplicasReady","status":"True","lastTransitionTime":"2022-03-18T18:07:23Z","reason":"AllPodsAreReady"},{"type":"ClusterAvailable","status":"True","lastTransitionTime":"2022-03-18T18:07:23Z","reason":"AtLeastOneEndpointAvailable"},{"type":"NoWarnings","status":"True","lastTransitionTime":"2022-03-18T18:06:25Z","reason":"NoWarnings"},{"type":"ReconcileSuccess","status":"True","lastTransitionTime":"2022-03-18T18:07:24Z","reason":"Success","message":"Finish reconciling"}],"defaultUser":{"secretReference":{"name":"rabbitmq-cluster-default-user","namespace":"default","keys":{"password":"password","username":"username"}},"serviceReference":{"name":"rabbitmq-cluster","namespace":"default"}}}}
2022/03/18 18:07:25 learn_server.go:291: [SIEVE-AFTER-READ]	Get	true	statefulset	default	rabbitmq-cluster-server	github.com/rabbitmq/cluster-operator/controllers.(*RabbitmqClusterReconciler)	NoError	{"kind":"StatefulSet","apiVersion":"apps/v1","metadata":{"name":"rabbitmq-cluster-server","namespace":"default","selfLink":"/apis/apps/v1/namespaces/default/statefulsets/rabbitmq-cluster-server","uid":"f2f07f3e-b500-4c48-a5de-8db7eaf37b9a","resourceVersion":"1409","generation":1,"creationTimestamp":"2022-03-18T18:06:25Z","labels":{"app.kubernetes.io/component":"rabbitmq","app.kubernetes.io/name":"rabbitmq-cluster","app.kubernetes.io/part-of":"rabbitmq"},"ownerReferences":[{"apiVersion":"rabbitmq.com/v1beta1","kind":"RabbitmqCluster","name":"rabbitmq-cluster","uid":"3ecefa8a-1bec-48a7-9af4-dd0df3339101","controller":true,"blockOwnerDeletion":true}],"managedFields":[{"manager":"manager","operation":"Update","apiVersion":"apps/v1","time":"2022-03-18T18:06:25Z","fieldsType":"FieldsV1","fieldsV1":{"f:metadata":{"f:labels":{".":{},"f:app.kubernetes.io/component":{},"f:app.kubernetes.io/name":{},"f:app.kubernetes.io/part-of":{}},"f:ownerReferences":{".":{},"k:{\"uid\":\"3ecefa8a-1bec-48a7-9af4-dd0df3339101\"}":{".":{},"f:apiVersion":{},"f:blockOwnerDeletion":{},"f:controller":{},"f:kind":{},"f:name":{},"f:uid":{}}}},"f:spec":{"f:podManagementPolicy":{},"f:replicas":{},"f:revisionHistoryLimit":{},"f:selector":{"f:matchLabels":{".":{},"f:app.kubernetes.io/name":{}}},"f:serviceName":{},"f:template":{"f:metadata":{"f:annotations":{".":{},"f:prometheus.io/port":{},"f:prometheus.io/scrape":{}},"f:labels":{".":{},"f:app.kubernetes.io/component":{},"f:app.kubernetes.io/name":{},"f:app.kubernetes.io/part-of":{}}},"f:spec":{"f:automountServiceAccountToken":{},"f:containers":{"k:{\"name\":\"rabbitmq\"}":{".":{},"f:env":{".":{},"k:{\"name\":\"K8S_HOSTNAME_SUFFIX\"}":{".":{},"f:name":{},"f:value":{}},"k:{\"name\":\"K8S_SERVICE_NAME\"}":{".":{},"f:name":{},"f:value":{}},"k:{\"name\":\"MY_POD_NAME\"}":{".":{},"f:name":{},"f:valueFrom":{".":{},"f:fieldRef":{".":{},"f:apiVersion":{},"f:fieldPath":{}}}},"k:{\"name\":\"MY_POD_NAMESPACE\"}":{".":{},"f:name":{},"f:valueFrom":{".":{},"f:fieldRef":{".":{},"f:apiVersion":{},"f:fieldPath":{}}}},"k:{\"name\":\"RABBITMQ_ENABLED_PLUGINS_FILE\"}":{".":{},"f:name":{},"f:value":{}},"k:{\"name\":\"RABBITMQ_NODENAME\"}":{".":{},"f:name":{},"f:value":{}},"k:{\"name\":\"RABBITMQ_USE_LONGNAME\"}":{".":{},"f:name":{},"f:value":{}}},"f:image":{},"f:imagePullPolicy":{},"f:lifecycle":{".":{},"f:preStop":{".":{},"f:exec":{".":{},"f:command":{}}}},"f:name":{},"f:ports":{".":{},"k:{\"containerPort\":4369,\"protocol\":\"TCP\"}":{".":{},"f:containerPort":{},"f:name":{},"f:protocol":{}},"k:{\"containerPort\":5672,\"protocol\":\"TCP\"}":{".":{},"f:containerPort":{},"f:name":{},"f:protocol":{}},"k:{\"containerPort\":15672,\"protocol\":\"TCP\"}":{".":{},"f:containerPort":{},"f:name":{},"f:protocol":{}},"k:{\"containerPort\":15692,\"protocol\":\"TCP\"}":{".":{},"f:containerPort":{},"f:name":{},"f:protocol":{}}},"f:readinessProbe":{".":{},"f:failureThreshold":{},"f:initialDelaySeconds":{},"f:periodSeconds":{},"f:successThreshold":{},"f:tcpSocket":{".":{},"f:port":{}},"f:timeoutSeconds":{}},"f:resources":{".":{},"f:limits":{".":{},"f:cpu":{},"f:memory":{}},"f:requests":{".":{},"f:cpu":{},"f:memory":{}}},"f:terminationMessagePath":{},"f:terminationMessagePolicy":{},"f:volumeMounts":{".":{},"k:{\"mountPath\":\"/etc/pod-info/\"}":{".":{},"f:mountPath":{},"f:name":{}},"k:{\"mountPath\":\"/etc/rabbitmq/conf.d/10-operatorDefaults.conf\"}":{".":{},"f:mountPath":{},"f:name":{},"f:subPath":{}},"k:{\"mountPath\":\"/etc/rabbitmq/conf.d/11-default_user.conf\"}":{".":{},"f:mountPath":{},"f:name":{},"f:subPath":{}},"k:{\"mountPath\":\"/etc/rabbitmq/conf.d/90-userDefinedConfiguration.conf\"}":{".":{},"f:mountPath":{},"f:name":{},"f:subPath":{}},"k:{\"mountPath\":\"/operator\"}":{".":{},"f:mountPath":{},"f:name":{}},"k:{\"mountPath\":\"/var/lib/rabbitmq/\"}":{".":{},"f:mountPath":{},"f:name":{}},"k:{\"mountPath\":\"/var/lib/rabbitmq/mnesia/\"}":{".":{},"f:mountPath":{},"f:name":{}}}}},"f:dnsPolicy":{},"f:initContainers":{".":{},"k:{\"name\":\"setup-container\"}":{".":{},"f:command":{},"f:image":{},"f:imagePullPolicy":{},"f:name":{},"f:resources":{".":{},"f:limits":{".":{},"f:cpu":{},"f:memory":{}},"f:requests":{".":{},"f:cpu":{},"f:memory":{}}},"f:securityContext":{".":{},"f:capabilities":{".":{},"f:drop":{}},"f:runAsUser":{}},"f:terminationMessagePath":{},"f:terminationMessagePolicy":{},"f:volumeMounts":{".":{},"k:{\"mountPath\":\"/operator\"}":{".":{},"f:mountPath":{},"f:name":{}},"k:{\"mountPath\":\"/tmp/default_user.conf\"}":{".":{},"f:mountPath":{},"f:name":{},"f:subPath":{}},"k:{\"mountPath\":\"/tmp/erlang-cookie-secret/\"}":{".":{},"f:mountPath":{},"f:name":{}},"k:{\"mountPath\":\"/tmp/rabbitmq-plugins/\"}":{".":{},"f:mountPath":{},"f:name":{}},"k:{\"mountPath\":\"/var/lib/rabbitmq/\"}":{".":{},"f:mountPath":{},"f:name":{}},"k:{\"mountPath\":\"/var/lib/rabbitmq/mnesia/\"}":{".":{},"f:mountPath":{},"f:name":{}}}}},"f:restartPolicy":{},"f:schedulerName":{},"f:securityContext":{".":{},"f:fsGroup":{},"f:runAsGroup":{},"f:runAsUser":{}},"f:serviceAccount":{},"f:serviceAccountName":{},"f:terminationGracePeriodSeconds":{},"f:topologySpreadConstraints":{".":{},"k:{\"topologyKey\":\"topology.kubernetes.io/zone\",\"whenUnsatisfiable\":\"ScheduleAnyway\"}":{".":{},"f:labelSelector":{".":{},"f:matchLabels":{".":{},"f:app.kubernetes.io/name":{}}},"f:maxSkew":{},"f:topologyKey":{},"f:whenUnsatisfiable":{}}},"f:volumes":{".":{},"k:{\"name\":\"erlang-cookie-secret\"}":{".":{},"f:name":{},"f:secret":{".":{},"f:defaultMode":{},"f:secretName":{}}},"k:{\"name\":\"plugins-conf\"}":{".":{},"f:configMap":{".":{},"f:defaultMode":{},"f:name":{}},"f:name":{}},"k:{\"name\":\"pod-info\"}":{".":{},"f:downwardAPI":{".":{},"f:defaultMode":{},"f:items":{}},"f:name":{}},"k:{\"name\":\"rabbitmq-confd\"}":{".":{},"f:name":{},"f:projected":{".":{},"f:defaultMode":{},"f:sources":{}}},"k:{\"name\":\"rabbitmq-erlang-cookie\"}":{".":{},"f:emptyDir":{},"f:name":{}},"k:{\"name\":\"rabbitmq-plugins\"}":{".":{},"f:emptyDir":{},"f:name":{}}}}},"f:updateStrategy":{"f:rollingUpdate":{".":{},"f:partition":{}},"f:type":{}},"f:volumeClaimTemplates":{}}}},{"manager":"kube-controller-manager","operation":"Update","apiVersion":"apps/v1","time":"2022-03-18T18:07:23Z","fieldsType":"FieldsV1","fieldsV1":{"f:status":{"f:collisionCount":{},"f:currentReplicas":{},"f:currentRevision":{},"f:observedGeneration":{},"f:readyReplicas":{},"f:replicas":{},"f:updateRevision":{},"f:updatedReplicas":{}}}}]},"spec":{"replicas":1,"selector":{"matchLabels":{"app.kubernetes.io/name":"rabbitmq-cluster"}},"template":{"metadata":{"creationTimestamp":null,"labels":{"app.kubernetes.io/component":"rabbitmq","app.kubernetes.io/name":"rabbitmq-cluster","app.kubernetes.io/part-of":"rabbitmq"},"annotations":{"prometheus.io/port":"15692","prometheus.io/scrape":"true"}},"spec":{"volumes":[{"name":"plugins-conf","configMap":{"name":"rabbitmq-cluster-plugins-conf","defaultMode":420}},{"name":"rabbitmq-confd","projected":{"sources":[{"secret":{"name":"rabbitmq-cluster-default-user","items":[{"key":"default_user.conf","path":"default_user.conf"}]}},{"configMap":{"name":"rabbitmq-cluster-server-conf","items":[{"key":"operatorDefaults.conf","path":"operatorDefaults.conf"},{"key":"userDefinedConfiguration.conf","path":"userDefinedConfiguration.conf"}]}}],"defaultMode":420}},{"name":"rabbitmq-erlang-cookie","emptyDir":{}},{"name":"erlang-cookie-secret","secret":{"secretName":"rabbitmq-cluster-erlang-cookie","defaultMode":420}},{"name":"rabbitmq-plugins","emptyDir":{}},{"name":"pod-info","downwardAPI":{"items":[{"path":"skipPreStopChecks","fieldRef":{"apiVersion":"v1","fieldPath":"metadata.labels['skipPreStopChecks']"}}],"defaultMode":420}}],"initContainers":[{"name":"setup-container","image":"rabbitmq:3.8.12-management","command":["sh","-c","cp /tmp/erlang-cookie-secret/.erlang.cookie /var/lib/rabbitmq/.erlang.cookie \u0026\u0026 chown 999:999 /var/lib/rabbitmq/.erlang.cookie \u0026\u0026 chmod 600 /var/lib/rabbitmq/.erlang.cookie ; cp /tmp/rabbitmq-plugins/enabled_plugins /operator/enabled_plugins \u0026\u0026 chown 999:999 /operator/enabled_plugins ; chown 999:999 /var/lib/rabbitmq/mnesia/ ; echo '[default]' \u003e /var/lib/rabbitmq/.rabbitmqadmin.conf \u0026\u0026 sed -e 's/default_user/username/' -e 's/default_pass/password/' /tmp/default_user.conf \u003e\u003e /var/lib/rabbitmq/.rabbitmqadmin.conf \u0026\u0026 chown 999:999 /var/lib/rabbitmq/.rabbitmqadmin.conf \u0026\u0026 chmod 600 /var/lib/rabbitmq/.rabbitmqadmin.conf"],"resources":{"limits":{"cpu":"100m","memory":"500Mi"},"requests":{"cpu":"100m","memory":"500Mi"}},"volumeMounts":[{"name":"plugins-conf","mountPath":"/tmp/rabbitmq-plugins/"},{"name":"rabbitmq-erlang-cookie","mountPath":"/var/lib/rabbitmq/"},{"name":"erlang-cookie-secret","mountPath":"/tmp/erlang-cookie-secret/"},{"name":"rabbitmq-plugins","mountPath":"/operator"},{"name":"persistence","mountPath":"/var/lib/rabbitmq/mnesia/"},{"name":"rabbitmq-confd","mountPath":"/tmp/default_user.conf","subPath":"default_user.conf"}],"terminationMessagePath":"/dev/termination-log","terminationMessagePolicy":"File","imagePullPolicy":"IfNotPresent","securityContext":{"capabilities":{"drop":["FSETID","KILL","SETGID","SETUID","SETPCAP","NET_BIND_SERVICE","NET_RAW","SYS_CHROOT","MKNOD","AUDIT_WRITE","SETFCAP"]},"runAsUser":0}}],"containers":[{"name":"rabbitmq","image":"rabbitmq:3.8.12-management","ports":[{"name":"epmd","containerPort":4369,"protocol":"TCP"},{"name":"amqp","containerPort":5672,"protocol":"TCP"},{"name":"management","containerPort":15672,"protocol":"TCP"},{"name":"prometheus","containerPort":15692,"protocol":"TCP"}],"env":[{"name":"MY_POD_NAME","valueFrom":{"fieldRef":{"apiVersion":"v1","fieldPath":"metadata.name"}}},{"name":"MY_POD_NAMESPACE","valueFrom":{"fieldRef":{"apiVersion":"v1","fieldPath":"metadata.namespace"}}},{"name":"RABBITMQ_ENABLED_PLUGINS_FILE","value":"/operator/enabled_plugins"},{"name":"K8S_SERVICE_NAME","value":"rabbitmq-cluster-nodes"},{"name":"RABBITMQ_USE_LONGNAME","value":"true"},{"name":"RABBITMQ_NODENAME","value":"rabbit@$(MY_POD_NAME).$(K8S_SERVICE_NAME).$(MY_POD_NAMESPACE)"},{"name":"K8S_HOSTNAME_SUFFIX","value":".$(K8S_SERVICE_NAME).$(MY_POD_NAMESPACE)"}],"resources":{"limits":{"cpu":"2","memory":"2Gi"},"requests":{"cpu":"1","memory":"2Gi"}},"volumeMounts":[{"name":"rabbitmq-erlang-cookie","mountPath":"/var/lib/rabbitmq/"},{"name":"persistence","mountPath":"/var/lib/rabbitmq/mnesia/"},{"name":"rabbitmq-plugins","mountPath":"/operator"},{"name":"rabbitmq-confd","mountPath":"/etc/rabbitmq/conf.d/10-operatorDefaults.conf","subPath":"operatorDefaults.conf"},{"name":"rabbitmq-confd","mountPath":"/etc/rabbitmq/conf.d/11-default_user.conf","subPath":"default_user.conf"},{"name":"rabbitmq-confd","mountPath":"/etc/rabbitmq/conf.d/90-userDefinedConfiguration.conf","subPath":"userDefinedConfiguration.conf"},{"name":"pod-info","mountPath":"/etc/pod-info/"}],"readinessProbe":{"tcpSocket":{"port":"amqp"},"initialDelaySeconds":10,"timeoutSeconds":5,"periodSeconds":10,"successThreshold":1,"failureThreshold":3},"lifecycle":{"preStop":{"exec":{"command":["/bin/bash","-c","if [ ! -z \"$(cat /etc/pod-info/skipPreStopChecks)\" ]; then exit 0; fi; rabbitmq-upgrade await_online_quorum_plus_one -t 604800; rabbitmq-upgrade await_online_synchronized_mirror -t 604800; rabbitmq-upgrade drain -t 604800"]}}},"terminationMessagePath":"/dev/termination-log","terminationMessagePolicy":"File","imagePullPolicy":"IfNotPresent"}],"restartPolicy":"Always","terminationGracePeriodSeconds":604800,"dnsPolicy":"ClusterFirst","serviceAccountName":"rabbitmq-cluster-server","serviceAccount":"rabbitmq-cluster-server","automountServiceAccountToken":true,"securityContext":{"runAsUser":999,"runAsGroup":999,"fsGroup":999},"schedulerName":"default-scheduler","topologySpreadConstraints":[{"maxSkew":1,"topologyKey":"topology.kubernetes.io/zone","whenUnsatisfiable":"ScheduleAnyway","labelSelector":{"matchLabels":{"app.kubernetes.io/name":"rabbitmq-cluster"}}}]}},"volumeClaimTemplates":[{"metadata":{"name":"persistence","namespace":"default","creationTimestamp":null,"labels":{"app.kubernetes.io/component":"rabbitmq","app.kubernetes.io/name":"rabbitmq-cluster","app.kubernetes.io/part-of":"rabbitmq"},"ownerReferences":[{"apiVersion":"rabbitmq.com/v1beta1","kind":"RabbitmqCluster","name":"rabbitmq-cluster","uid":"3ecefa8a-1bec-48a7-9af4-dd0df3339101","controller":true,"blockOwnerDeletion":false}]},"spec":{"accessModes":["ReadWriteOnce"],"resources":{"requests":{"storage":"10Gi"}},"volumeMode":"Filesystem"},"status":{"phase":"Pending"}}],"serviceName":"rabbitmq-cluster-nodes","podManagementPolicy":"Parallel","updateStrategy":{"type":"RollingUpdate","rollingUpdate":{"partition":0}},"revisionHistoryLimit":10},"status":{"observedGeneration":1,"replicas":1,"readyReplicas":1,"currentReplicas":1,"updatedReplicas":1,"currentRevision":"rabbitmq-cluster-server-5f8b8665fb","updateRevision":"rabbitmq-cluster-server-5f8b8665fb","collisionCount":0}}
2022/03/18 18:07:25 learn_server.go:291: [SIEVE-AFTER-READ]	Get	true	endpoints	default	rabbitmq-cluster	github.com/rabbitmq/cluster-operator/controllers.(*RabbitmqClusterReconciler)	NoError	{"kind":"Endpoints","apiVersion":"v1","metadata":{"name":"rabbitmq-cluster","namespace":"default","selfLink":"/api/v1/namespaces/default/endpoints/rabbitmq-cluster","uid":"eeba9576-0362-4e74-aafd-71e4ffe98d25","resourceVersion":"1402","creationTimestamp":"2022-03-18T18:06:25Z","labels":{"app.kubernetes.io/component":"rabbitmq","app.kubernetes.io/name":"rabbitmq-cluster","app.kubernetes.io/part-of":"rabbitmq"},"annotations":{"endpoints.kubernetes.io/last-change-trigger-time":"2022-03-18T18:07:23Z"},"managedFields":[{"manager":"kube-controller-manager","operation":"Update","apiVersion":"v1","time":"2022-03-18T18:07:23Z","fieldsType":"FieldsV1","fieldsV1":{"f:metadata":{"f:annotations":{".":{},"f:endpoints.kubernetes.io/last-change-trigger-time":{}},"f:labels":{".":{},"f:app.kubernetes.io/component":{},"f:app.kubernetes.io/name":{},"f:app.kubernetes.io/part-of":{}}},"f:subsets":{}}}]},"subsets":[{"addresses":[{"ip":"10.244.1.4","nodeName":"kind-worker","targetRef":{"kind":"Pod","namespace":"default","name":"rabbitmq-cluster-server-0","uid":"cbaba199-5faf-480a-81e8-051ce2cc79e6","resourceVersion":"1399"}}],"ports":[{"name":"amqp","port":5672,"protocol":"TCP"},{"name":"management","port":15672,"protocol":"TCP"}]}]}
2022/03/18 18:07:25 learn_server.go:291: [SIEVE-AFTER-READ]	Get	true	statefulset	default	rabbitmq-cluster-server	github.com/rabbitmq/cluster-operator/controllers.(*RabbitmqClusterReconciler)	NoError	{"kind":"StatefulSet","apiVersion":"apps/v1","metadata":{"name":"rabbitmq-cluster-server","namespace":"default","selfLink":"/apis/apps/v1/namespaces/default/statefulsets/rabbitmq-cluster-server","uid":"f2f07f3e-b500-4c48-a5de-8db7eaf37b9a","resourceVersion":"1409","generation":1,"creationTimestamp":"2022-03-18T18:06:25Z","labels":{"app.kubernetes.io/component":"rabbitmq","app.kubernetes.io/name":"rabbitmq-cluster","app.kubernetes.io/part-of":"rabbitmq"},"ownerReferences":[{"apiVersion":"rabbitmq.com/v1beta1","kind":"RabbitmqCluster","name":"rabbitmq-cluster","uid":"3ecefa8a-1bec-48a7-9af4-dd0df3339101","controller":true,"blockOwnerDeletion":true}],"managedFields":[{"manager":"manager","operation":"Update","apiVersion":"apps/v1","time":"2022-03-18T18:06:25Z","fieldsType":"FieldsV1","fieldsV1":{"f:metadata":{"f:labels":{".":{},"f:app.kubernetes.io/component":{},"f:app.kubernetes.io/name":{},"f:app.kubernetes.io/part-of":{}},"f:ownerReferences":{".":{},"k:{\"uid\":\"3ecefa8a-1bec-48a7-9af4-dd0df3339101\"}":{".":{},"f:apiVersion":{},"f:blockOwnerDeletion":{},"f:controller":{},"f:kind":{},"f:name":{},"f:uid":{}}}},"f:spec":{"f:podManagementPolicy":{},"f:replicas":{},"f:revisionHistoryLimit":{},"f:selector":{"f:matchLabels":{".":{},"f:app.kubernetes.io/name":{}}},"f:serviceName":{},"f:template":{"f:metadata":{"f:annotations":{".":{},"f:prometheus.io/port":{},"f:prometheus.io/scrape":{}},"f:labels":{".":{},"f:app.kubernetes.io/component":{},"f:app.kubernetes.io/name":{},"f:app.kubernetes.io/part-of":{}}},"f:spec":{"f:automountServiceAccountToken":{},"f:containers":{"k:{\"name\":\"rabbitmq\"}":{".":{},"f:env":{".":{},"k:{\"name\":\"K8S_HOSTNAME_SUFFIX\"}":{".":{},"f:name":{},"f:value":{}},"k:{\"name\":\"K8S_SERVICE_NAME\"}":{".":{},"f:name":{},"f:value":{}},"k:{\"name\":\"MY_POD_NAME\"}":{".":{},"f:name":{},"f:valueFrom":{".":{},"f:fieldRef":{".":{},"f:apiVersion":{},"f:fieldPath":{}}}},"k:{\"name\":\"MY_POD_NAMESPACE\"}":{".":{},"f:name":{},"f:valueFrom":{".":{},"f:fieldRef":{".":{},"f:apiVersion":{},"f:fieldPath":{}}}},"k:{\"name\":\"RABBITMQ_ENABLED_PLUGINS_FILE\"}":{".":{},"f:name":{},"f:value":{}},"k:{\"name\":\"RABBITMQ_NODENAME\"}":{".":{},"f:name":{},"f:value":{}},"k:{\"name\":\"RABBITMQ_USE_LONGNAME\"}":{".":{},"f:name":{},"f:value":{}}},"f:image":{},"f:imagePullPolicy":{},"f:lifecycle":{".":{},"f:preStop":{".":{},"f:exec":{".":{},"f:command":{}}}},"f:name":{},"f:ports":{".":{},"k:{\"containerPort\":4369,\"protocol\":\"TCP\"}":{".":{},"f:containerPort":{},"f:name":{},"f:protocol":{}},"k:{\"containerPort\":5672,\"protocol\":\"TCP\"}":{".":{},"f:containerPort":{},"f:name":{},"f:protocol":{}},"k:{\"containerPort\":15672,\"protocol\":\"TCP\"}":{".":{},"f:containerPort":{},"f:name":{},"f:protocol":{}},"k:{\"containerPort\":15692,\"protocol\":\"TCP\"}":{".":{},"f:containerPort":{},"f:name":{},"f:protocol":{}}},"f:readinessProbe":{".":{},"f:failureThreshold":{},"f:initialDelaySeconds":{},"f:periodSeconds":{},"f:successThreshold":{},"f:tcpSocket":{".":{},"f:port":{}},"f:timeoutSeconds":{}},"f:resources":{".":{},"f:limits":{".":{},"f:cpu":{},"f:memory":{}},"f:requests":{".":{},"f:cpu":{},"f:memory":{}}},"f:terminationMessagePath":{},"f:terminationMessagePolicy":{},"f:volumeMounts":{".":{},"k:{\"mountPath\":\"/etc/pod-info/\"}":{".":{},"f:mountPath":{},"f:name":{}},"k:{\"mountPath\":\"/etc/rabbitmq/conf.d/10-operatorDefaults.conf\"}":{".":{},"f:mountPath":{},"f:name":{},"f:subPath":{}},"k:{\"mountPath\":\"/etc/rabbitmq/conf.d/11-default_user.conf\"}":{".":{},"f:mountPath":{},"f:name":{},"f:subPath":{}},"k:{\"mountPath\":\"/etc/rabbitmq/conf.d/90-userDefinedConfiguration.conf\"}":{".":{},"f:mountPath":{},"f:name":{},"f:subPath":{}},"k:{\"mountPath\":\"/operator\"}":{".":{},"f:mountPath":{},"f:name":{}},"k:{\"mountPath\":\"/var/lib/rabbitmq/\"}":{".":{},"f:mountPath":{},"f:name":{}},"k:{\"mountPath\":\"/var/lib/rabbitmq/mnesia/\"}":{".":{},"f:mountPath":{},"f:name":{}}}}},"f:dnsPolicy":{},"f:initContainers":{".":{},"k:{\"name\":\"setup-container\"}":{".":{},"f:command":{},"f:image":{},"f:imagePullPolicy":{},"f:name":{},"f:resources":{".":{},"f:limits":{".":{},"f:cpu":{},"f:memory":{}},"f:requests":{".":{},"f:cpu":{},"f:memory":{}}},"f:securityContext":{".":{},"f:capabilities":{".":{},"f:drop":{}},"f:runAsUser":{}},"f:terminationMessagePath":{},"f:terminationMessagePolicy":{},"f:volumeMounts":{".":{},"k:{\"mountPath\":\"/operator\"}":{".":{},"f:mountPath":{},"f:name":{}},"k:{\"mountPath\":\"/tmp/default_user.conf\"}":{".":{},"f:mountPath":{},"f:name":{},"f:subPath":{}},"k:{\"mountPath\":\"/tmp/erlang-cookie-secret/\"}":{".":{},"f:mountPath":{},"f:name":{}},"k:{\"mountPath\":\"/tmp/rabbitmq-plugins/\"}":{".":{},"f:mountPath":{},"f:name":{}},"k:{\"mountPath\":\"/var/lib/rabbitmq/\"}":{".":{},"f:mountPath":{},"f:name":{}},"k:{\"mountPath\":\"/var/lib/rabbitmq/mnesia/\"}":{".":{},"f:mountPath":{},"f:name":{}}}}},"f:restartPolicy":{},"f:schedulerName":{},"f:securityContext":{".":{},"f:fsGroup":{},"f:runAsGroup":{},"f:runAsUser":{}},"f:serviceAccount":{},"f:serviceAccountName":{},"f:terminationGracePeriodSeconds":{},"f:topologySpreadConstraints":{".":{},"k:{\"topologyKey\":\"topology.kubernetes.io/zone\",\"whenUnsatisfiable\":\"ScheduleAnyway\"}":{".":{},"f:labelSelector":{".":{},"f:matchLabels":{".":{},"f:app.kubernetes.io/name":{}}},"f:maxSkew":{},"f:topologyKey":{},"f:whenUnsatisfiable":{}}},"f:volumes":{".":{},"k:{\"name\":\"erlang-cookie-secret\"}":{".":{},"f:name":{},"f:secret":{".":{},"f:defaultMode":{},"f:secretName":{}}},"k:{\"name\":\"plugins-conf\"}":{".":{},"f:configMap":{".":{},"f:defaultMode":{},"f:name":{}},"f:name":{}},"k:{\"name\":\"pod-info\"}":{".":{},"f:downwardAPI":{".":{},"f:defaultMode":{},"f:items":{}},"f:name":{}},"k:{\"name\":\"rabbitmq-confd\"}":{".":{},"f:name":{},"f:projected":{".":{},"f:defaultMode":{},"f:sources":{}}},"k:{\"name\":\"rabbitmq-erlang-cookie\"}":{".":{},"f:emptyDir":{},"f:name":{}},"k:{\"name\":\"rabbitmq-plugins\"}":{".":{},"f:emptyDir":{},"f:name":{}}}}},"f:updateStrategy":{"f:rollingUpdate":{".":{},"f:partition":{}},"f:type":{}},"f:volumeClaimTemplates":{}}}},{"manager":"kube-controller-manager","operation":"Update","apiVersion":"apps/v1","time":"2022-03-18T18:07:23Z","fieldsType":"FieldsV1","fieldsV1":{"f:status":{"f:collisionCount":{},"f:currentReplicas":{},"f:currentRevision":{},"f:observedGeneration":{},"f:readyReplicas":{},"f:replicas":{},"f:updateRevision":{},"f:updatedReplicas":{}}}}]},"spec":{"replicas":1,"selector":{"matchLabels":{"app.kubernetes.io/name":"rabbitmq-cluster"}},"template":{"metadata":{"creationTimestamp":null,"labels":{"app.kubernetes.io/component":"rabbitmq","app.kubernetes.io/name":"rabbitmq-cluster","app.kubernetes.io/part-of":"rabbitmq"},"annotations":{"prometheus.io/port":"15692","prometheus.io/scrape":"true"}},"spec":{"volumes":[{"name":"plugins-conf","configMap":{"name":"rabbitmq-cluster-plugins-conf","defaultMode":420}},{"name":"rabbitmq-confd","projected":{"sources":[{"secret":{"name":"rabbitmq-cluster-default-user","items":[{"key":"default_user.conf","path":"default_user.conf"}]}},{"configMap":{"name":"rabbitmq-cluster-server-conf","items":[{"key":"operatorDefaults.conf","path":"operatorDefaults.conf"},{"key":"userDefinedConfiguration.conf","path":"userDefinedConfiguration.conf"}]}}],"defaultMode":420}},{"name":"rabbitmq-erlang-cookie","emptyDir":{}},{"name":"erlang-cookie-secret","secret":{"secretName":"rabbitmq-cluster-erlang-cookie","defaultMode":420}},{"name":"rabbitmq-plugins","emptyDir":{}},{"name":"pod-info","downwardAPI":{"items":[{"path":"skipPreStopChecks","fieldRef":{"apiVersion":"v1","fieldPath":"metadata.labels['skipPreStopChecks']"}}],"defaultMode":420}}],"initContainers":[{"name":"setup-container","image":"rabbitmq:3.8.12-management","command":["sh","-c","cp /tmp/erlang-cookie-secret/.erlang.cookie /var/lib/rabbitmq/.erlang.cookie \u0026\u0026 chown 999:999 /var/lib/rabbitmq/.erlang.cookie \u0026\u0026 chmod 600 /var/lib/rabbitmq/.erlang.cookie ; cp /tmp/rabbitmq-plugins/enabled_plugins /operator/enabled_plugins \u0026\u0026 chown 999:999 /operator/enabled_plugins ; chown 999:999 /var/lib/rabbitmq/mnesia/ ; echo '[default]' \u003e /var/lib/rabbitmq/.rabbitmqadmin.conf \u0026\u0026 sed -e 's/default_user/username/' -e 's/default_pass/password/' /tmp/default_user.conf \u003e\u003e /var/lib/rabbitmq/.rabbitmqadmin.conf \u0026\u0026 chown 999:999 /var/lib/rabbitmq/.rabbitmqadmin.conf \u0026\u0026 chmod 600 /var/lib/rabbitmq/.rabbitmqadmin.conf"],"resources":{"limits":{"cpu":"100m","memory":"500Mi"},"requests":{"cpu":"100m","memory":"500Mi"}},"volumeMounts":[{"name":"plugins-conf","mountPath":"/tmp/rabbitmq-plugins/"},{"name":"rabbitmq-erlang-cookie","mountPath":"/var/lib/rabbitmq/"},{"name":"erlang-cookie-secret","mountPath":"/tmp/erlang-cookie-secret/"},{"name":"rabbitmq-plugins","mountPath":"/operator"},{"name":"persistence","mountPath":"/var/lib/rabbitmq/mnesia/"},{"name":"rabbitmq-confd","mountPath":"/tmp/default_user.conf","subPath":"default_user.conf"}],"terminationMessagePath":"/dev/termination-log","terminationMessagePolicy":"File","imagePullPolicy":"IfNotPresent","securityContext":{"capabilities":{"drop":["FSETID","KILL","SETGID","SETUID","SETPCAP","NET_BIND_SERVICE","NET_RAW","SYS_CHROOT","MKNOD","AUDIT_WRITE","SETFCAP"]},"runAsUser":0}}],"containers":[{"name":"rabbitmq","image":"rabbitmq:3.8.12-management","ports":[{"name":"epmd","containerPort":4369,"protocol":"TCP"},{"name":"amqp","containerPort":5672,"protocol":"TCP"},{"name":"management","containerPort":15672,"protocol":"TCP"},{"name":"prometheus","containerPort":15692,"protocol":"TCP"}],"env":[{"name":"MY_POD_NAME","valueFrom":{"fieldRef":{"apiVersion":"v1","fieldPath":"metadata.name"}}},{"name":"MY_POD_NAMESPACE","valueFrom":{"fieldRef":{"apiVersion":"v1","fieldPath":"metadata.namespace"}}},{"name":"RABBITMQ_ENABLED_PLUGINS_FILE","value":"/operator/enabled_plugins"},{"name":"K8S_SERVICE_NAME","value":"rabbitmq-cluster-nodes"},{"name":"RABBITMQ_USE_LONGNAME","value":"true"},{"name":"RABBITMQ_NODENAME","value":"rabbit@$(MY_POD_NAME).$(K8S_SERVICE_NAME).$(MY_POD_NAMESPACE)"},{"name":"K8S_HOSTNAME_SUFFIX","value":".$(K8S_SERVICE_NAME).$(MY_POD_NAMESPACE)"}],"resources":{"limits":{"cpu":"2","memory":"2Gi"},"requests":{"cpu":"1","memory":"2Gi"}},"volumeMounts":[{"name":"rabbitmq-erlang-cookie","mountPath":"/var/lib/rabbitmq/"},{"name":"persistence","mountPath":"/var/lib/rabbitmq/mnesia/"},{"name":"rabbitmq-plugins","mountPath":"/operator"},{"name":"rabbitmq-confd","mountPath":"/etc/rabbitmq/conf.d/10-operatorDefaults.conf","subPath":"operatorDefaults.conf"},{"name":"rabbitmq-confd","mountPath":"/etc/rabbitmq/conf.d/11-default_user.conf","subPath":"default_user.conf"},{"name":"rabbitmq-confd","mountPath":"/etc/rabbitmq/conf.d/90-userDefinedConfiguration.conf","subPath":"userDefinedConfiguration.conf"},{"name":"pod-info","mountPath":"/etc/pod-info/"}],"readinessProbe":{"tcpSocket":{"port":"amqp"},"initialDelaySeconds":10,"timeoutSeconds":5,"periodSeconds":10,"successThreshold":1,"failureThreshold":3},"lifecycle":{"preStop":{"exec":{"command":["/bin/bash","-c","if [ ! -z \"$(cat /etc/pod-info/skipPreStopChecks)\" ]; then exit 0; fi; rabbitmq-upgrade await_online_quorum_plus_one -t 604800; rabbitmq-upgrade await_online_synchronized_mirror -t 604800; rabbitmq-upgrade drain -t 604800"]}}},"terminationMessagePath":"/dev/termination-log","terminationMessagePolicy":"File","imagePullPolicy":"IfNotPresent"}],"restartPolicy":"Always","terminationGracePeriodSeconds":604800,"dnsPolicy":"ClusterFirst","serviceAccountName":"rabbitmq-cluster-server","serviceAccount":"rabbitmq-cluster-server","automountServiceAccountToken":true,"securityContext":{"runAsUser":999,"runAsGroup":999,"fsGroup":999},"schedulerName":"default-scheduler","topologySpreadConstraints":[{"maxSkew":1,"topologyKey":"topology.kubernetes.io/zone","whenUnsatisfiable":"ScheduleAnyway","labelSelector":{"matchLabels":{"app.kubernetes.io/name":"rabbitmq-cluster"}}}]}},"volumeClaimTemplates":[{"metadata":{"name":"persistence","namespace":"default","creationTimestamp":null,"labels":{"app.kubernetes.io/component":"rabbitmq","app.kubernetes.io/name":"rabbitmq-cluster","app.kubernetes.io/part-of":"rabbitmq"},"ownerReferences":[{"apiVersion":"rabbitmq.com/v1beta1","kind":"RabbitmqCluster","name":"rabbitmq-cluster","uid":"3ecefa8a-1bec-48a7-9af4-dd0df3339101","controller":true,"blockOwnerDeletion":false}]},"spec":{"accessModes":["ReadWriteOnce"],"resources":{"requests":{"storage":"10Gi"}},"volumeMode":"Filesystem"},"status":{"phase":"Pending"}}],"serviceName":"rabbitmq-cluster-nodes","podManagementPolicy":"Parallel","updateStrategy":{"type":"RollingUpdate","rollingUpdate":{"partition":0}},"revisionHistoryLimit":10},"status":{"observedGeneration":1,"replicas":1,"readyReplicas":1,"currentReplicas":1,"updatedReplicas":1,"currentRevision":"rabbitmq-cluster-server-5f8b8665fb","updateRevision":"rabbitmq-cluster-server-5f8b8665fb","collisionCount":0}}
2022/03/18 18:07:25 learn_server.go:291: [SIEVE-AFTER-READ]	Get	true	service	default	rabbitmq-cluster-nodes	github.com/rabbitmq/cluster-operator/controllers.(*RabbitmqClusterReconciler)	NoError	{"kind":"Service","apiVersion":"v1","metadata":{"name":"rabbitmq-cluster-nodes","namespace":"default","selfLink":"/api/v1/namespaces/default/services/rabbitmq-cluster-nodes","uid":"f843e1c2-ced0-463d-87c1-0e127aaa2006","resourceVersion":"1080","creationTimestamp":"2022-03-18T18:06:25Z","labels":{"app.kubernetes.io/component":"rabbitmq","app.kubernetes.io/name":"rabbitmq-cluster","app.kubernetes.io/part-of":"rabbitmq"},"ownerReferences":[{"apiVersion":"rabbitmq.com/v1beta1","kind":"RabbitmqCluster","name":"rabbitmq-cluster","uid":"3ecefa8a-1bec-48a7-9af4-dd0df3339101","controller":true,"blockOwnerDeletion":true}],"managedFields":[{"manager":"manager","operation":"Update","apiVersion":"v1","time":"2022-03-18T18:06:25Z","fieldsType":"FieldsV1","fieldsV1":{"f:metadata":{"f:labels":{".":{},"f:app.kubernetes.io/component":{},"f:app.kubernetes.io/name":{},"f:app.kubernetes.io/part-of":{}},"f:ownerReferences":{".":{},"k:{\"uid\":\"3ecefa8a-1bec-48a7-9af4-dd0df3339101\"}":{".":{},"f:apiVersion":{},"f:blockOwnerDeletion":{},"f:controller":{},"f:kind":{},"f:name":{},"f:uid":{}}}},"f:spec":{"f:clusterIP":{},"f:ports":{".":{},"k:{\"port\":4369,\"protocol\":\"TCP\"}":{".":{},"f:name":{},"f:port":{},"f:protocol":{},"f:targetPort":{}},"k:{\"port\":25672,\"protocol\":\"TCP\"}":{".":{},"f:name":{},"f:port":{},"f:protocol":{},"f:targetPort":{}}},"f:publishNotReadyAddresses":{},"f:selector":{".":{},"f:app.kubernetes.io/name":{}},"f:sessionAffinity":{},"f:type":{}}}}]},"spec":{"ports":[{"name":"epmd","protocol":"TCP","port":4369,"targetPort":4369},{"name":"cluster-rpc","protocol":"TCP","port":25672,"targetPort":25672}],"selector":{"app.kubernetes.io/name":"rabbitmq-cluster"},"clusterIP":"None","type":"ClusterIP","sessionAffinity":"None","publishNotReadyAddresses":true},"status":{"loadBalancer":{}}}
2022/03/18 18:07:25 learn_server.go:291: [SIEVE-AFTER-READ]	Get	true	service	default	rabbitmq-cluster	github.com/rabbitmq/cluster-operator/controllers.(*RabbitmqClusterReconciler)	NoError	{"kind":"Service","apiVersion":"v1","metadata":{"name":"rabbitmq-cluster","namespace":"default","selfLink":"/api/v1/namespaces/default/services/rabbitmq-cluster","uid":"ae846a70-784e-49ca-99a0-2b0cefb93b46","resourceVersion":"1085","creationTimestamp":"2022-03-18T18:06:25Z","labels":{"app.kubernetes.io/component":"rabbitmq","app.kubernetes.io/name":"rabbitmq-cluster","app.kubernetes.io/part-of":"rabbitmq"},"ownerReferences":[{"apiVersion":"rabbitmq.com/v1beta1","kind":"RabbitmqCluster","name":"rabbitmq-cluster","uid":"3ecefa8a-1bec-48a7-9af4-dd0df3339101","controller":true,"blockOwnerDeletion":true}],"managedFields":[{"manager":"manager","operation":"Update","apiVersion":"v1","time":"2022-03-18T18:06:25Z","fieldsType":"FieldsV1","fieldsV1":{"f:metadata":{"f:labels":{".":{},"f:app.kubernetes.io/component":{},"f:app.kubernetes.io/name":{},"f:app.kubernetes.io/part-of":{}},"f:ownerReferences":{".":{},"k:{\"uid\":\"3ecefa8a-1bec-48a7-9af4-dd0df3339101\"}":{".":{},"f:apiVersion":{},"f:blockOwnerDeletion":{},"f:controller":{},"f:kind":{},"f:name":{},"f:uid":{}}}},"f:spec":{"f:ports":{".":{},"k:{\"port\":5672,\"protocol\":\"TCP\"}":{".":{},"f:name":{},"f:port":{},"f:protocol":{},"f:targetPort":{}},"k:{\"port\":15672,\"protocol\":\"TCP\"}":{".":{},"f:name":{},"f:port":{},"f:protocol":{},"f:targetPort":{}}},"f:selector":{".":{},"f:app.kubernetes.io/name":{}},"f:sessionAffinity":{},"f:type":{}}}}]},"spec":{"ports":[{"name":"amqp","protocol":"TCP","port":5672,"targetPort":5672},{"name":"management","protocol":"TCP","port":15672,"targetPort":15672}],"selector":{"app.kubernetes.io/name":"rabbitmq-cluster"},"clusterIP":"10.96.47.189","type":"ClusterIP","sessionAffinity":"None"},"status":{"loadBalancer":{}}}
2022/03/18 18:07:25 learn_server.go:291: [SIEVE-AFTER-READ]	Get	true	secret	default	rabbitmq-cluster-erlang-cookie	github.com/rabbitmq/cluster-operator/controllers.(*RabbitmqClusterReconciler)	NoError	{"kind":"Secret","apiVersion":"v1","metadata":{"name":"rabbitmq-cluster-erlang-cookie","namespace":"default","selfLink":"/api/v1/namespaces/default/secrets/rabbitmq-cluster-erlang-cookie","uid":"01d8d8ad-080a-4c3f-9d27-56616c53dd26","resourceVersion":"1088","creationTimestamp":"2022-03-18T18:06:25Z","labels":{"app.kubernetes.io/component":"rabbitmq","app.kubernetes.io/name":"rabbitmq-cluster","app.kubernetes.io/part-of":"rabbitmq"},"ownerReferences":[{"apiVersion":"rabbitmq.com/v1beta1","kind":"RabbitmqCluster","name":"rabbitmq-cluster","uid":"3ecefa8a-1bec-48a7-9af4-dd0df3339101","controller":true,"blockOwnerDeletion":true}],"managedFields":[{"manager":"manager","operation":"Update","apiVersion":"v1","time":"2022-03-18T18:06:25Z","fieldsType":"FieldsV1","fieldsV1":{"f:data":{".":{},"f:.erlang.cookie":{}},"f:metadata":{"f:labels":{".":{},"f:app.kubernetes.io/component":{},"f:app.kubernetes.io/name":{},"f:app.kubernetes.io/part-of":{}},"f:ownerReferences":{".":{},"k:{\"uid\":\"3ecefa8a-1bec-48a7-9af4-dd0df3339101\"}":{".":{},"f:apiVersion":{},"f:blockOwnerDeletion":{},"f:controller":{},"f:kind":{},"f:name":{},"f:uid":{}}}},"f:type":{}}}]},"data":{".erlang.cookie":"ajdscUtLdnBpR1NwUUMwc1V3a2VyTlJxU2tVUTdBeEw="},"type":"Opaque"}
2022/03/18 18:07:25 learn_server.go:291: [SIEVE-AFTER-READ]	Get	true	secret	default	rabbitmq-cluster-default-user	github.com/rabbitmq/cluster-operator/controllers.(*RabbitmqClusterReconciler)	NoError	{"kind":"Secret","apiVersion":"v1","metadata":{"name":"rabbitmq-cluster-default-user","namespace":"default","selfLink":"/api/v1/namespaces/default/secrets/rabbitmq-cluster-default-user","uid":"b2f5a936-e51f-4488-b6e9-ca23e4d95ac2","resourceVersion":"1091","creationTimestamp":"2022-03-18T18:06:25Z","labels":{"app.kubernetes.io/component":"rabbitmq","app.kubernetes.io/name":"rabbitmq-cluster","app.kubernetes.io/part-of":"rabbitmq"},"ownerReferences":[{"apiVersion":"rabbitmq.com/v1beta1","kind":"RabbitmqCluster","name":"rabbitmq-cluster","uid":"3ecefa8a-1bec-48a7-9af4-dd0df3339101","controller":true,"blockOwnerDeletion":true}],"managedFields":[{"manager":"manager","operation":"Update","apiVersion":"v1","time":"2022-03-18T18:06:25Z","fieldsType":"FieldsV1","fieldsV1":{"f:data":{".":{},"f:default_user.conf":{},"f:password":{},"f:provider":{},"f:type":{},"f:username":{}},"f:metadata":{"f:labels":{".":{},"f:app.kubernetes.io/component":{},"f:app.kubernetes.io/name":{},"f:app.kubernetes.io/part-of":{}},"f:ownerReferences":{".":{},"k:{\"uid\":\"3ecefa8a-1bec-48a7-9af4-dd0df3339101\"}":{".":{},"f:apiVersion":{},"f:blockOwnerDeletion":{},"f:controller":{},"f:kind":{},"f:name":{},"f:uid":{}}}},"f:type":{}}}]},"data":{"default_user.conf":"ZGVmYXVsdF91c2VyID0gdEFMN1otZTgzR29ocEtsZ0Z4cUFFV3ZXemEtcjdJQW8KZGVmYXVsdF9wYXNzID0gdXVocndkTkdOcmJXQ2p6NFZPX0NUZE9OYURkSUpoRkoK","password":"dXVocndkTkdOcmJXQ2p6NFZPX0NUZE9OYURkSUpoRko=","provider":"cmFiYml0bXE=","type":"cmFiYml0bXE=","username":"dEFMN1otZTgzR29ocEtsZ0Z4cUFFV3ZXemEtcjdJQW8="},"type":"Opaque"}
2022/03/18 18:07:25 learn_server.go:291: [SIEVE-AFTER-READ]	Get	true	configmap	default	rabbitmq-cluster-plugins-conf	github.com/rabbitmq/cluster-operator/controllers.(*RabbitmqClusterReconciler)	NoError	{"kind":"ConfigMap","apiVersion":"v1","metadata":{"name":"rabbitmq-cluster-plugins-conf","namespace":"default","selfLink":"/api/v1/namespaces/default/configmaps/rabbitmq-cluster-plugins-conf","uid":"0aa26eb6-ff3a-4457-a223-284c897db7fe","resourceVersion":"1092","creationTimestamp":"2022-03-18T18:06:25Z","labels":{"app.kubernetes.io/component":"rabbitmq","app.kubernetes.io/name":"rabbitmq-cluster","app.kubernetes.io/part-of":"rabbitmq"},"ownerReferences":[{"apiVersion":"rabbitmq.com/v1beta1","kind":"RabbitmqCluster","name":"rabbitmq-cluster","uid":"3ecefa8a-1bec-48a7-9af4-dd0df3339101","controller":true,"blockOwnerDeletion":true}],"managedFields":[{"manager":"manager","operation":"Update","apiVersion":"v1","time":"2022-03-18T18:06:25Z","fieldsType":"FieldsV1","fieldsV1":{"f:data":{".":{},"f:enabled_plugins":{}},"f:metadata":{"f:labels":{".":{},"f:app.kubernetes.io/component":{},"f:app.kubernetes.io/name":{},"f:app.kubernetes.io/part-of":{}},"f:ownerReferences":{".":{},"k:{\"uid\":\"3ecefa8a-1bec-48a7-9af4-dd0df3339101\"}":{".":{},"f:apiVersion":{},"f:blockOwnerDeletion":{},"f:controller":{},"f:kind":{},"f:name":{},"f:uid":{}}}}}}]},"data":{"enabled_plugins":"[rabbitmq_peer_discovery_k8s,rabbitmq_prometheus,rabbitmq_management]."}}
2022/03/18 18:07:25 learn_server.go:291: [SIEVE-AFTER-READ]	Get	true	configmap	default	rabbitmq-cluster-server-conf	github.com/rabbitmq/cluster-operator/controllers.(*RabbitmqClusterReconciler)	NoError	{"kind":"ConfigMap","apiVersion":"v1","metadata":{"name":"rabbitmq-cluster-server-conf","namespace":"default","selfLink":"/api/v1/namespaces/default/configmaps/rabbitmq-cluster-server-conf","uid":"e4182078-d429-4baf-9021-72618c509ac5","resourceVersion":"1095","creationTimestamp":"2022-03-18T18:06:25Z","labels":{"app.kubernetes.io/component":"rabbitmq","app.kubernetes.io/name":"rabbitmq-cluster","app.kubernetes.io/part-of":"rabbitmq"},"ownerReferences":[{"apiVersion":"rabbitmq.com/v1beta1","kind":"RabbitmqCluster","name":"rabbitmq-cluster","uid":"3ecefa8a-1bec-48a7-9af4-dd0df3339101","controller":true,"blockOwnerDeletion":true}],"managedFields":[{"manager":"manager","operation":"Update","apiVersion":"v1","time":"2022-03-18T18:06:25Z","fieldsType":"FieldsV1","fieldsV1":{"f:data":{".":{},"f:operatorDefaults.conf":{},"f:userDefinedConfiguration.conf":{}},"f:metadata":{"f:labels":{".":{},"f:app.kubernetes.io/component":{},"f:app.kubernetes.io/name":{},"f:app.kubernetes.io/part-of":{}},"f:ownerReferences":{".":{},"k:{\"uid\":\"3ecefa8a-1bec-48a7-9af4-dd0df3339101\"}":{".":{},"f:apiVersion":{},"f:blockOwnerDeletion":{},"f:controller":{},"f:kind":{},"f:name":{},"f:uid":{}}}}}}]},"data":{"operatorDefaults.conf":"cluster_formation.peer_discovery_backend             = rabbit_peer_discovery_k8s\ncluster_formation.k8s.host                           = kubernetes.default\ncluster_formation.k8s.address_type                   = hostname\ncluster_partition_handling                           = pause_minority\nqueue_master_locator                                 = min-masters\ndisk_free_limit.absolute                             = 2GB\ncluster_formation.randomized_startup_delay_range.min = 5\ncluster_formation.randomized_startup_delay_range.max = 30\ncluster_name                                         = rabbitmq-cluster\n","userDefinedConfiguration.conf":"total_memory_available_override_value = 1717986919\n"}}
2022/03/18 18:07:25 learn_server.go:291: [SIEVE-AFTER-READ]	Get	true	serviceaccount	default	rabbitmq-cluster-server	github.com/rabbitmq/cluster-operator/controllers.(*RabbitmqClusterReconciler)	NoError	{"kind":"ServiceAccount","apiVersion":"v1","metadata":{"name":"rabbitmq-cluster-server","namespace":"default","selfLink":"/api/v1/namespaces/default/serviceaccounts/rabbitmq-cluster-server","uid":"0c3cead0-37dd-452b-b939-fe346a5dfdea","resourceVersion":"1102","creationTimestamp":"2022-03-18T18:06:25Z","labels":{"app.kubernetes.io/component":"rabbitmq","app.kubernetes.io/name":"rabbitmq-cluster","app.kubernetes.io/part-of":"rabbitmq"},"ownerReferences":[{"apiVersion":"rabbitmq.com/v1beta1","kind":"RabbitmqCluster","name":"rabbitmq-cluster","uid":"3ecefa8a-1bec-48a7-9af4-dd0df3339101","controller":true,"blockOwnerDeletion":true}],"managedFields":[{"manager":"kube-controller-manager","operation":"Update","apiVersion":"v1","time":"2022-03-18T18:06:25Z","fieldsType":"FieldsV1","fieldsV1":{"f:secrets":{".":{},"k:{\"name\":\"rabbitmq-cluster-server-token-v4wpv\"}":{".":{},"f:name":{}}}}},{"manager":"manager","operation":"Update","apiVersion":"v1","time":"2022-03-18T18:06:25Z","fieldsType":"FieldsV1","fieldsV1":{"f:metadata":{"f:labels":{".":{},"f:app.kubernetes.io/component":{},"f:app.kubernetes.io/name":{},"f:app.kubernetes.io/part-of":{}},"f:ownerReferences":{".":{},"k:{\"uid\":\"3ecefa8a-1bec-48a7-9af4-dd0df3339101\"}":{".":{},"f:apiVersion":{},"f:blockOwnerDeletion":{},"f:controller":{},"f:kind":{},"f:name":{},"f:uid":{}}}}}}]},"secrets":[{"name":"rabbitmq-cluster-server-token-v4wpv"}]}
2022/03/18 18:07:25 learn_server.go:291: [SIEVE-AFTER-READ]	Get	true	role	default	rabbitmq-cluster-peer-discovery	github.com/rabbitmq/cluster-operator/controllers.(*RabbitmqClusterReconciler)	NoError	{"kind":"Role","apiVersion":"rbac.authorization.k8s.io/v1","metadata":{"name":"rabbitmq-cluster-peer-discovery","namespace":"default","selfLink":"/apis/rbac.authorization.k8s.io/v1/namespaces/default/roles/rabbitmq-cluster-peer-discovery","uid":"ec9ac474-1880-43ed-af46-9ea5f46d6db4","resourceVersion":"1103","creationTimestamp":"2022-03-18T18:06:25Z","labels":{"app.kubernetes.io/component":"rabbitmq","app.kubernetes.io/name":"rabbitmq-cluster","app.kubernetes.io/part-of":"rabbitmq"},"ownerReferences":[{"apiVersion":"rabbitmq.com/v1beta1","kind":"RabbitmqCluster","name":"rabbitmq-cluster","uid":"3ecefa8a-1bec-48a7-9af4-dd0df3339101","controller":true,"blockOwnerDeletion":true}],"managedFields":[{"manager":"manager","operation":"Update","apiVersion":"rbac.authorization.k8s.io/v1","time":"2022-03-18T18:06:25Z","fieldsType":"FieldsV1","fieldsV1":{"f:metadata":{"f:labels":{".":{},"f:app.kubernetes.io/component":{},"f:app.kubernetes.io/name":{},"f:app.kubernetes.io/part-of":{}},"f:ownerReferences":{".":{},"k:{\"uid\":\"3ecefa8a-1bec-48a7-9af4-dd0df3339101\"}":{".":{},"f:apiVersion":{},"f:blockOwnerDeletion":{},"f:controller":{},"f:kind":{},"f:name":{},"f:uid":{}}}},"f:rules":{}}}]},"rules":[{"verbs":["get"],"apiGroups":[""],"resources":["endpoints"]},{"verbs":["create"],"apiGroups":[""],"resources":["events"]}]}
2022/03/18 18:07:25 learn_server.go:291: [SIEVE-AFTER-READ]	Get	true	rolebinding	default	rabbitmq-cluster-server	github.com/rabbitmq/cluster-operator/controllers.(*RabbitmqClusterReconciler)	NoError	{"kind":"RoleBinding","apiVersion":"rbac.authorization.k8s.io/v1","metadata":{"name":"rabbitmq-cluster-server","namespace":"default","selfLink":"/apis/rbac.authorization.k8s.io/v1/namespaces/default/rolebindings/rabbitmq-cluster-server","uid":"fe69a41c-8d28-4b84-a9f6-a9e6044d75ba","resourceVersion":"1105","creationTimestamp":"2022-03-18T18:06:25Z","labels":{"app.kubernetes.io/component":"rabbitmq","app.kubernetes.io/name":"rabbitmq-cluster","app.kubernetes.io/part-of":"rabbitmq"},"ownerReferences":[{"apiVersion":"rabbitmq.com/v1beta1","kind":"RabbitmqCluster","name":"rabbitmq-cluster","uid":"3ecefa8a-1bec-48a7-9af4-dd0df3339101","controller":true,"blockOwnerDeletion":true}],"managedFields":[{"manager":"manager","operation":"Update","apiVersion":"rbac.authorization.k8s.io/v1","time":"2022-03-18T18:06:25Z","fieldsType":"FieldsV1","fieldsV1":{"f:metadata":{"f:labels":{".":{},"f:app.kubernetes.io/component":{},"f:app.kubernetes.io/name":{},"f:app.kubernetes.io/part-of":{}},"f:ownerReferences":{".":{},"k:{\"uid\":\"3ecefa8a-1bec-48a7-9af4-dd0df3339101\"}":{".":{},"f:apiVersion":{},"f:blockOwnerDeletion":{},"f:controller":{},"f:kind":{},"f:name":{},"f:uid":{}}}},"f:roleRef":{"f:apiGroup":{},"f:kind":{},"f:name":{}},"f:subjects":{}}}]},"subjects":[{"kind":"ServiceAccount","name":"rabbitmq-cluster-server"}],"roleRef":{"apiGroup":"rbac.authorization.k8s.io","kind":"Role","name":"rabbitmq-cluster-peer-discovery"}}
2022/03/18 18:07:25 learn_server.go:291: [SIEVE-AFTER-READ]	Get	true	statefulset	default	rabbitmq-cluster-server	github.com/rabbitmq/cluster-operator/controllers.(*RabbitmqClusterReconciler)	NoError	{"kind":"StatefulSet","apiVersion":"apps/v1","metadata":{"name":"rabbitmq-cluster-server","namespace":"default","selfLink":"/apis/apps/v1/namespaces/default/statefulsets/rabbitmq-cluster-server","uid":"f2f07f3e-b500-4c48-a5de-8db7eaf37b9a","resourceVersion":"1409","generation":1,"creationTimestamp":"2022-03-18T18:06:25Z","labels":{"app.kubernetes.io/component":"rabbitmq","app.kubernetes.io/name":"rabbitmq-cluster","app.kubernetes.io/part-of":"rabbitmq"},"ownerReferences":[{"apiVersion":"rabbitmq.com/v1beta1","kind":"RabbitmqCluster","name":"rabbitmq-cluster","uid":"3ecefa8a-1bec-48a7-9af4-dd0df3339101","controller":true,"blockOwnerDeletion":true}],"managedFields":[{"manager":"manager","operation":"Update","apiVersion":"apps/v1","time":"2022-03-18T18:06:25Z","fieldsType":"FieldsV1","fieldsV1":{"f:metadata":{"f:labels":{".":{},"f:app.kubernetes.io/component":{},"f:app.kubernetes.io/name":{},"f:app.kubernetes.io/part-of":{}},"f:ownerReferences":{".":{},"k:{\"uid\":\"3ecefa8a-1bec-48a7-9af4-dd0df3339101\"}":{".":{},"f:apiVersion":{},"f:blockOwnerDeletion":{},"f:controller":{},"f:kind":{},"f:name":{},"f:uid":{}}}},"f:spec":{"f:podManagementPolicy":{},"f:replicas":{},"f:revisionHistoryLimit":{},"f:selector":{"f:matchLabels":{".":{},"f:app.kubernetes.io/name":{}}},"f:serviceName":{},"f:template":{"f:metadata":{"f:annotations":{".":{},"f:prometheus.io/port":{},"f:prometheus.io/scrape":{}},"f:labels":{".":{},"f:app.kubernetes.io/component":{},"f:app.kubernetes.io/name":{},"f:app.kubernetes.io/part-of":{}}},"f:spec":{"f:automountServiceAccountToken":{},"f:containers":{"k:{\"name\":\"rabbitmq\"}":{".":{},"f:env":{".":{},"k:{\"name\":\"K8S_HOSTNAME_SUFFIX\"}":{".":{},"f:name":{},"f:value":{}},"k:{\"name\":\"K8S_SERVICE_NAME\"}":{".":{},"f:name":{},"f:value":{}},"k:{\"name\":\"MY_POD_NAME\"}":{".":{},"f:name":{},"f:valueFrom":{".":{},"f:fieldRef":{".":{},"f:apiVersion":{},"f:fieldPath":{}}}},"k:{\"name\":\"MY_POD_NAMESPACE\"}":{".":{},"f:name":{},"f:valueFrom":{".":{},"f:fieldRef":{".":{},"f:apiVersion":{},"f:fieldPath":{}}}},"k:{\"name\":\"RABBITMQ_ENABLED_PLUGINS_FILE\"}":{".":{},"f:name":{},"f:value":{}},"k:{\"name\":\"RABBITMQ_NODENAME\"}":{".":{},"f:name":{},"f:value":{}},"k:{\"name\":\"RABBITMQ_USE_LONGNAME\"}":{".":{},"f:name":{},"f:value":{}}},"f:image":{},"f:imagePullPolicy":{},"f:lifecycle":{".":{},"f:preStop":{".":{},"f:exec":{".":{},"f:command":{}}}},"f:name":{},"f:ports":{".":{},"k:{\"containerPort\":4369,\"protocol\":\"TCP\"}":{".":{},"f:containerPort":{},"f:name":{},"f:protocol":{}},"k:{\"containerPort\":5672,\"protocol\":\"TCP\"}":{".":{},"f:containerPort":{},"f:name":{},"f:protocol":{}},"k:{\"containerPort\":15672,\"protocol\":\"TCP\"}":{".":{},"f:containerPort":{},"f:name":{},"f:protocol":{}},"k:{\"containerPort\":15692,\"protocol\":\"TCP\"}":{".":{},"f:containerPort":{},"f:name":{},"f:protocol":{}}},"f:readinessProbe":{".":{},"f:failureThreshold":{},"f:initialDelaySeconds":{},"f:periodSeconds":{},"f:successThreshold":{},"f:tcpSocket":{".":{},"f:port":{}},"f:timeoutSeconds":{}},"f:resources":{".":{},"f:limits":{".":{},"f:cpu":{},"f:memory":{}},"f:requests":{".":{},"f:cpu":{},"f:memory":{}}},"f:terminationMessagePath":{},"f:terminationMessagePolicy":{},"f:volumeMounts":{".":{},"k:{\"mountPath\":\"/etc/pod-info/\"}":{".":{},"f:mountPath":{},"f:name":{}},"k:{\"mountPath\":\"/etc/rabbitmq/conf.d/10-operatorDefaults.conf\"}":{".":{},"f:mountPath":{},"f:name":{},"f:subPath":{}},"k:{\"mountPath\":\"/etc/rabbitmq/conf.d/11-default_user.conf\"}":{".":{},"f:mountPath":{},"f:name":{},"f:subPath":{}},"k:{\"mountPath\":\"/etc/rabbitmq/conf.d/90-userDefinedConfiguration.conf\"}":{".":{},"f:mountPath":{},"f:name":{},"f:subPath":{}},"k:{\"mountPath\":\"/operator\"}":{".":{},"f:mountPath":{},"f:name":{}},"k:{\"mountPath\":\"/var/lib/rabbitmq/\"}":{".":{},"f:mountPath":{},"f:name":{}},"k:{\"mountPath\":\"/var/lib/rabbitmq/mnesia/\"}":{".":{},"f:mountPath":{},"f:name":{}}}}},"f:dnsPolicy":{},"f:initContainers":{".":{},"k:{\"name\":\"setup-container\"}":{".":{},"f:command":{},"f:image":{},"f:imagePullPolicy":{},"f:name":{},"f:resources":{".":{},"f:limits":{".":{},"f:cpu":{},"f:memory":{}},"f:requests":{".":{},"f:cpu":{},"f:memory":{}}},"f:securityContext":{".":{},"f:capabilities":{".":{},"f:drop":{}},"f:runAsUser":{}},"f:terminationMessagePath":{},"f:terminationMessagePolicy":{},"f:volumeMounts":{".":{},"k:{\"mountPath\":\"/operator\"}":{".":{},"f:mountPath":{},"f:name":{}},"k:{\"mountPath\":\"/tmp/default_user.conf\"}":{".":{},"f:mountPath":{},"f:name":{},"f:subPath":{}},"k:{\"mountPath\":\"/tmp/erlang-cookie-secret/\"}":{".":{},"f:mountPath":{},"f:name":{}},"k:{\"mountPath\":\"/tmp/rabbitmq-plugins/\"}":{".":{},"f:mountPath":{},"f:name":{}},"k:{\"mountPath\":\"/var/lib/rabbitmq/\"}":{".":{},"f:mountPath":{},"f:name":{}},"k:{\"mountPath\":\"/var/lib/rabbitmq/mnesia/\"}":{".":{},"f:mountPath":{},"f:name":{}}}}},"f:restartPolicy":{},"f:schedulerName":{},"f:securityContext":{".":{},"f:fsGroup":{},"f:runAsGroup":{},"f:runAsUser":{}},"f:serviceAccount":{},"f:serviceAccountName":{},"f:terminationGracePeriodSeconds":{},"f:topologySpreadConstraints":{".":{},"k:{\"topologyKey\":\"topology.kubernetes.io/zone\",\"whenUnsatisfiable\":\"ScheduleAnyway\"}":{".":{},"f:labelSelector":{".":{},"f:matchLabels":{".":{},"f:app.kubernetes.io/name":{}}},"f:maxSkew":{},"f:topologyKey":{},"f:whenUnsatisfiable":{}}},"f:volumes":{".":{},"k:{\"name\":\"erlang-cookie-secret\"}":{".":{},"f:name":{},"f:secret":{".":{},"f:defaultMode":{},"f:secretName":{}}},"k:{\"name\":\"plugins-conf\"}":{".":{},"f:configMap":{".":{},"f:defaultMode":{},"f:name":{}},"f:name":{}},"k:{\"name\":\"pod-info\"}":{".":{},"f:downwardAPI":{".":{},"f:defaultMode":{},"f:items":{}},"f:name":{}},"k:{\"name\":\"rabbitmq-confd\"}":{".":{},"f:name":{},"f:projected":{".":{},"f:defaultMode":{},"f:sources":{}}},"k:{\"name\":\"rabbitmq-erlang-cookie\"}":{".":{},"f:emptyDir":{},"f:name":{}},"k:{\"name\":\"rabbitmq-plugins\"}":{".":{},"f:emptyDir":{},"f:name":{}}}}},"f:updateStrategy":{"f:rollingUpdate":{".":{},"f:partition":{}},"f:type":{}},"f:volumeClaimTemplates":{}}}},{"manager":"kube-controller-manager","operation":"Update","apiVersion":"apps/v1","time":"2022-03-18T18:07:23Z","fieldsType":"FieldsV1","fieldsV1":{"f:status":{"f:collisionCount":{},"f:currentReplicas":{},"f:currentRevision":{},"f:observedGeneration":{},"f:readyReplicas":{},"f:replicas":{},"f:updateRevision":{},"f:updatedReplicas":{}}}}]},"spec":{"replicas":1,"selector":{"matchLabels":{"app.kubernetes.io/name":"rabbitmq-cluster"}},"template":{"metadata":{"creationTimestamp":null,"labels":{"app.kubernetes.io/component":"rabbitmq","app.kubernetes.io/name":"rabbitmq-cluster","app.kubernetes.io/part-of":"rabbitmq"},"annotations":{"prometheus.io/port":"15692","prometheus.io/scrape":"true"}},"spec":{"volumes":[{"name":"plugins-conf","configMap":{"name":"rabbitmq-cluster-plugins-conf","defaultMode":420}},{"name":"rabbitmq-confd","projected":{"sources":[{"secret":{"name":"rabbitmq-cluster-default-user","items":[{"key":"default_user.conf","path":"default_user.conf"}]}},{"configMap":{"name":"rabbitmq-cluster-server-conf","items":[{"key":"operatorDefaults.conf","path":"operatorDefaults.conf"},{"key":"userDefinedConfiguration.conf","path":"userDefinedConfiguration.conf"}]}}],"defaultMode":420}},{"name":"rabbitmq-erlang-cookie","emptyDir":{}},{"name":"erlang-cookie-secret","secret":{"secretName":"rabbitmq-cluster-erlang-cookie","defaultMode":420}},{"name":"rabbitmq-plugins","emptyDir":{}},{"name":"pod-info","downwardAPI":{"items":[{"path":"skipPreStopChecks","fieldRef":{"apiVersion":"v1","fieldPath":"metadata.labels['skipPreStopChecks']"}}],"defaultMode":420}}],"initContainers":[{"name":"setup-container","image":"rabbitmq:3.8.12-management","command":["sh","-c","cp /tmp/erlang-cookie-secret/.erlang.cookie /var/lib/rabbitmq/.erlang.cookie \u0026\u0026 chown 999:999 /var/lib/rabbitmq/.erlang.cookie \u0026\u0026 chmod 600 /var/lib/rabbitmq/.erlang.cookie ; cp /tmp/rabbitmq-plugins/enabled_plugins /operator/enabled_plugins \u0026\u0026 chown 999:999 /operator/enabled_plugins ; chown 999:999 /var/lib/rabbitmq/mnesia/ ; echo '[default]' \u003e /var/lib/rabbitmq/.rabbitmqadmin.conf \u0026\u0026 sed -e 's/default_user/username/' -e 's/default_pass/password/' /tmp/default_user.conf \u003e\u003e /var/lib/rabbitmq/.rabbitmqadmin.conf \u0026\u0026 chown 999:999 /var/lib/rabbitmq/.rabbitmqadmin.conf \u0026\u0026 chmod 600 /var/lib/rabbitmq/.rabbitmqadmin.conf"],"resources":{"limits":{"cpu":"100m","memory":"500Mi"},"requests":{"cpu":"100m","memory":"500Mi"}},"volumeMounts":[{"name":"plugins-conf","mountPath":"/tmp/rabbitmq-plugins/"},{"name":"rabbitmq-erlang-cookie","mountPath":"/var/lib/rabbitmq/"},{"name":"erlang-cookie-secret","mountPath":"/tmp/erlang-cookie-secret/"},{"name":"rabbitmq-plugins","mountPath":"/operator"},{"name":"persistence","mountPath":"/var/lib/rabbitmq/mnesia/"},{"name":"rabbitmq-confd","mountPath":"/tmp/default_user.conf","subPath":"default_user.conf"}],"terminationMessagePath":"/dev/termination-log","terminationMessagePolicy":"File","imagePullPolicy":"IfNotPresent","securityContext":{"capabilities":{"drop":["FSETID","KILL","SETGID","SETUID","SETPCAP","NET_BIND_SERVICE","NET_RAW","SYS_CHROOT","MKNOD","AUDIT_WRITE","SETFCAP"]},"runAsUser":0}}],"containers":[{"name":"rabbitmq","image":"rabbitmq:3.8.12-management","ports":[{"name":"epmd","containerPort":4369,"protocol":"TCP"},{"name":"amqp","containerPort":5672,"protocol":"TCP"},{"name":"management","containerPort":15672,"protocol":"TCP"},{"name":"prometheus","containerPort":15692,"protocol":"TCP"}],"env":[{"name":"MY_POD_NAME","valueFrom":{"fieldRef":{"apiVersion":"v1","fieldPath":"metadata.name"}}},{"name":"MY_POD_NAMESPACE","valueFrom":{"fieldRef":{"apiVersion":"v1","fieldPath":"metadata.namespace"}}},{"name":"RABBITMQ_ENABLED_PLUGINS_FILE","value":"/operator/enabled_plugins"},{"name":"K8S_SERVICE_NAME","value":"rabbitmq-cluster-nodes"},{"name":"RABBITMQ_USE_LONGNAME","value":"true"},{"name":"RABBITMQ_NODENAME","value":"rabbit@$(MY_POD_NAME).$(K8S_SERVICE_NAME).$(MY_POD_NAMESPACE)"},{"name":"K8S_HOSTNAME_SUFFIX","value":".$(K8S_SERVICE_NAME).$(MY_POD_NAMESPACE)"}],"resources":{"limits":{"cpu":"2","memory":"2Gi"},"requests":{"cpu":"1","memory":"2Gi"}},"volumeMounts":[{"name":"rabbitmq-erlang-cookie","mountPath":"/var/lib/rabbitmq/"},{"name":"persistence","mountPath":"/var/lib/rabbitmq/mnesia/"},{"name":"rabbitmq-plugins","mountPath":"/operator"},{"name":"rabbitmq-confd","mountPath":"/etc/rabbitmq/conf.d/10-operatorDefaults.conf","subPath":"operatorDefaults.conf"},{"name":"rabbitmq-confd","mountPath":"/etc/rabbitmq/conf.d/11-default_user.conf","subPath":"default_user.conf"},{"name":"rabbitmq-confd","mountPath":"/etc/rabbitmq/conf.d/90-userDefinedConfiguration.conf","subPath":"userDefinedConfiguration.conf"},{"name":"pod-info","mountPath":"/etc/pod-info/"}],"readinessProbe":{"tcpSocket":{"port":"amqp"},"initialDelaySeconds":10,"timeoutSeconds":5,"periodSeconds":10,"successThreshold":1,"failureThreshold":3},"lifecycle":{"preStop":{"exec":{"command":["/bin/bash","-c","if [ ! -z \"$(cat /etc/pod-info/skipPreStopChecks)\" ]; then exit 0; fi; rabbitmq-upgrade await_online_quorum_plus_one -t 604800; rabbitmq-upgrade await_online_synchronized_mirror -t 604800; rabbitmq-upgrade drain -t 604800"]}}},"terminationMessagePath":"/dev/termination-log","terminationMessagePolicy":"File","imagePullPolicy":"IfNotPresent"}],"restartPolicy":"Always","terminationGracePeriodSeconds":604800,"dnsPolicy":"ClusterFirst","serviceAccountName":"rabbitmq-cluster-server","serviceAccount":"rabbitmq-cluster-server","automountServiceAccountToken":true,"securityContext":{"runAsUser":999,"runAsGroup":999,"fsGroup":999},"schedulerName":"default-scheduler","topologySpreadConstraints":[{"maxSkew":1,"topologyKey":"topology.kubernetes.io/zone","whenUnsatisfiable":"ScheduleAnyway","labelSelector":{"matchLabels":{"app.kubernetes.io/name":"rabbitmq-cluster"}}}]}},"volumeClaimTemplates":[{"metadata":{"name":"persistence","namespace":"default","creationTimestamp":null,"labels":{"app.kubernetes.io/component":"rabbitmq","app.kubernetes.io/name":"rabbitmq-cluster","app.kubernetes.io/part-of":"rabbitmq"},"ownerReferences":[{"apiVersion":"rabbitmq.com/v1beta1","kind":"RabbitmqCluster","name":"rabbitmq-cluster","uid":"3ecefa8a-1bec-48a7-9af4-dd0df3339101","controller":true,"blockOwnerDeletion":false}]},"spec":{"accessModes":["ReadWriteOnce"],"resources":{"requests":{"storage":"10Gi"}},"volumeMode":"Filesystem"},"status":{"phase":"Pending"}}],"serviceName":"rabbitmq-cluster-nodes","podManagementPolicy":"Parallel","updateStrategy":{"type":"RollingUpdate","rollingUpdate":{"partition":0}},"revisionHistoryLimit":10},"status":{"observedGeneration":1,"replicas":1,"readyReplicas":1,"currentReplicas":1,"updatedReplicas":1,"currentRevision":"rabbitmq-cluster-server-5f8b8665fb","updateRevision":"rabbitmq-cluster-server-5f8b8665fb","collisionCount":0}}
2022/03/18 18:07:25 learn_server.go:291: [SIEVE-AFTER-READ]	Get	true	statefulset	default	rabbitmq-cluster-server	github.com/rabbitmq/cluster-operator/controllers.(*RabbitmqClusterReconciler)	NoError	{"kind":"StatefulSet","apiVersion":"apps/v1","metadata":{"name":"rabbitmq-cluster-server","namespace":"default","selfLink":"/apis/apps/v1/namespaces/default/statefulsets/rabbitmq-cluster-server","uid":"f2f07f3e-b500-4c48-a5de-8db7eaf37b9a","resourceVersion":"1409","generation":1,"creationTimestamp":"2022-03-18T18:06:25Z","labels":{"app.kubernetes.io/component":"rabbitmq","app.kubernetes.io/name":"rabbitmq-cluster","app.kubernetes.io/part-of":"rabbitmq"},"ownerReferences":[{"apiVersion":"rabbitmq.com/v1beta1","kind":"RabbitmqCluster","name":"rabbitmq-cluster","uid":"3ecefa8a-1bec-48a7-9af4-dd0df3339101","controller":true,"blockOwnerDeletion":true}],"managedFields":[{"manager":"manager","operation":"Update","apiVersion":"apps/v1","time":"2022-03-18T18:06:25Z","fieldsType":"FieldsV1","fieldsV1":{"f:metadata":{"f:labels":{".":{},"f:app.kubernetes.io/component":{},"f:app.kubernetes.io/name":{},"f:app.kubernetes.io/part-of":{}},"f:ownerReferences":{".":{},"k:{\"uid\":\"3ecefa8a-1bec-48a7-9af4-dd0df3339101\"}":{".":{},"f:apiVersion":{},"f:blockOwnerDeletion":{},"f:controller":{},"f:kind":{},"f:name":{},"f:uid":{}}}},"f:spec":{"f:podManagementPolicy":{},"f:replicas":{},"f:revisionHistoryLimit":{},"f:selector":{"f:matchLabels":{".":{},"f:app.kubernetes.io/name":{}}},"f:serviceName":{},"f:template":{"f:metadata":{"f:annotations":{".":{},"f:prometheus.io/port":{},"f:prometheus.io/scrape":{}},"f:labels":{".":{},"f:app.kubernetes.io/component":{},"f:app.kubernetes.io/name":{},"f:app.kubernetes.io/part-of":{}}},"f:spec":{"f:automountServiceAccountToken":{},"f:containers":{"k:{\"name\":\"rabbitmq\"}":{".":{},"f:env":{".":{},"k:{\"name\":\"K8S_HOSTNAME_SUFFIX\"}":{".":{},"f:name":{},"f:value":{}},"k:{\"name\":\"K8S_SERVICE_NAME\"}":{".":{},"f:name":{},"f:value":{}},"k:{\"name\":\"MY_POD_NAME\"}":{".":{},"f:name":{},"f:valueFrom":{".":{},"f:fieldRef":{".":{},"f:apiVersion":{},"f:fieldPath":{}}}},"k:{\"name\":\"MY_POD_NAMESPACE\"}":{".":{},"f:name":{},"f:valueFrom":{".":{},"f:fieldRef":{".":{},"f:apiVersion":{},"f:fieldPath":{}}}},"k:{\"name\":\"RABBITMQ_ENABLED_PLUGINS_FILE\"}":{".":{},"f:name":{},"f:value":{}},"k:{\"name\":\"RABBITMQ_NODENAME\"}":{".":{},"f:name":{},"f:value":{}},"k:{\"name\":\"RABBITMQ_USE_LONGNAME\"}":{".":{},"f:name":{},"f:value":{}}},"f:image":{},"f:imagePullPolicy":{},"f:lifecycle":{".":{},"f:preStop":{".":{},"f:exec":{".":{},"f:command":{}}}},"f:name":{},"f:ports":{".":{},"k:{\"containerPort\":4369,\"protocol\":\"TCP\"}":{".":{},"f:containerPort":{},"f:name":{},"f:protocol":{}},"k:{\"containerPort\":5672,\"protocol\":\"TCP\"}":{".":{},"f:containerPort":{},"f:name":{},"f:protocol":{}},"k:{\"containerPort\":15672,\"protocol\":\"TCP\"}":{".":{},"f:containerPort":{},"f:name":{},"f:protocol":{}},"k:{\"containerPort\":15692,\"protocol\":\"TCP\"}":{".":{},"f:containerPort":{},"f:name":{},"f:protocol":{}}},"f:readinessProbe":{".":{},"f:failureThreshold":{},"f:initialDelaySeconds":{},"f:periodSeconds":{},"f:successThreshold":{},"f:tcpSocket":{".":{},"f:port":{}},"f:timeoutSeconds":{}},"f:resources":{".":{},"f:limits":{".":{},"f:cpu":{},"f:memory":{}},"f:requests":{".":{},"f:cpu":{},"f:memory":{}}},"f:terminationMessagePath":{},"f:terminationMessagePolicy":{},"f:volumeMounts":{".":{},"k:{\"mountPath\":\"/etc/pod-info/\"}":{".":{},"f:mountPath":{},"f:name":{}},"k:{\"mountPath\":\"/etc/rabbitmq/conf.d/10-operatorDefaults.conf\"}":{".":{},"f:mountPath":{},"f:name":{},"f:subPath":{}},"k:{\"mountPath\":\"/etc/rabbitmq/conf.d/11-default_user.conf\"}":{".":{},"f:mountPath":{},"f:name":{},"f:subPath":{}},"k:{\"mountPath\":\"/etc/rabbitmq/conf.d/90-userDefinedConfiguration.conf\"}":{".":{},"f:mountPath":{},"f:name":{},"f:subPath":{}},"k:{\"mountPath\":\"/operator\"}":{".":{},"f:mountPath":{},"f:name":{}},"k:{\"mountPath\":\"/var/lib/rabbitmq/\"}":{".":{},"f:mountPath":{},"f:name":{}},"k:{\"mountPath\":\"/var/lib/rabbitmq/mnesia/\"}":{".":{},"f:mountPath":{},"f:name":{}}}}},"f:dnsPolicy":{},"f:initContainers":{".":{},"k:{\"name\":\"setup-container\"}":{".":{},"f:command":{},"f:image":{},"f:imagePullPolicy":{},"f:name":{},"f:resources":{".":{},"f:limits":{".":{},"f:cpu":{},"f:memory":{}},"f:requests":{".":{},"f:cpu":{},"f:memory":{}}},"f:securityContext":{".":{},"f:capabilities":{".":{},"f:drop":{}},"f:runAsUser":{}},"f:terminationMessagePath":{},"f:terminationMessagePolicy":{},"f:volumeMounts":{".":{},"k:{\"mountPath\":\"/operator\"}":{".":{},"f:mountPath":{},"f:name":{}},"k:{\"mountPath\":\"/tmp/default_user.conf\"}":{".":{},"f:mountPath":{},"f:name":{},"f:subPath":{}},"k:{\"mountPath\":\"/tmp/erlang-cookie-secret/\"}":{".":{},"f:mountPath":{},"f:name":{}},"k:{\"mountPath\":\"/tmp/rabbitmq-plugins/\"}":{".":{},"f:mountPath":{},"f:name":{}},"k:{\"mountPath\":\"/var/lib/rabbitmq/\"}":{".":{},"f:mountPath":{},"f:name":{}},"k:{\"mountPath\":\"/var/lib/rabbitmq/mnesia/\"}":{".":{},"f:mountPath":{},"f:name":{}}}}},"f:restartPolicy":{},"f:schedulerName":{},"f:securityContext":{".":{},"f:fsGroup":{},"f:runAsGroup":{},"f:runAsUser":{}},"f:serviceAccount":{},"f:serviceAccountName":{},"f:terminationGracePeriodSeconds":{},"f:topologySpreadConstraints":{".":{},"k:{\"topologyKey\":\"topology.kubernetes.io/zone\",\"whenUnsatisfiable\":\"ScheduleAnyway\"}":{".":{},"f:labelSelector":{".":{},"f:matchLabels":{".":{},"f:app.kubernetes.io/name":{}}},"f:maxSkew":{},"f:topologyKey":{},"f:whenUnsatisfiable":{}}},"f:volumes":{".":{},"k:{\"name\":\"erlang-cookie-secret\"}":{".":{},"f:name":{},"f:secret":{".":{},"f:defaultMode":{},"f:secretName":{}}},"k:{\"name\":\"plugins-conf\"}":{".":{},"f:configMap":{".":{},"f:defaultMode":{},"f:name":{}},"f:name":{}},"k:{\"name\":\"pod-info\"}":{".":{},"f:downwardAPI":{".":{},"f:defaultMode":{},"f:items":{}},"f:name":{}},"k:{\"name\":\"rabbitmq-confd\"}":{".":{},"f:name":{},"f:projected":{".":{},"f:defaultMode":{},"f:sources":{}}},"k:{\"name\":\"rabbitmq-erlang-cookie\"}":{".":{},"f:emptyDir":{},"f:name":{}},"k:{\"name\":\"rabbitmq-plugins\"}":{".":{},"f:emptyDir":{},"f:name":{}}}}},"f:updateStrategy":{"f:rollingUpdate":{".":{},"f:partition":{}},"f:type":{}},"f:volumeClaimTemplates":{}}}},{"manager":"kube-controller-manager","operation":"Update","apiVersion":"apps/v1","time":"2022-03-18T18:07:23Z","fieldsType":"FieldsV1","fieldsV1":{"f:status":{"f:collisionCount":{},"f:currentReplicas":{},"f:currentRevision":{},"f:observedGeneration":{},"f:readyReplicas":{},"f:replicas":{},"f:updateRevision":{},"f:updatedReplicas":{}}}}]},"spec":{"replicas":1,"selector":{"matchLabels":{"app.kubernetes.io/name":"rabbitmq-cluster"}},"template":{"metadata":{"creationTimestamp":null,"labels":{"app.kubernetes.io/component":"rabbitmq","app.kubernetes.io/name":"rabbitmq-cluster","app.kubernetes.io/part-of":"rabbitmq"},"annotations":{"prometheus.io/port":"15692","prometheus.io/scrape":"true"}},"spec":{"volumes":[{"name":"plugins-conf","configMap":{"name":"rabbitmq-cluster-plugins-conf","defaultMode":420}},{"name":"rabbitmq-confd","projected":{"sources":[{"secret":{"name":"rabbitmq-cluster-default-user","items":[{"key":"default_user.conf","path":"default_user.conf"}]}},{"configMap":{"name":"rabbitmq-cluster-server-conf","items":[{"key":"operatorDefaults.conf","path":"operatorDefaults.conf"},{"key":"userDefinedConfiguration.conf","path":"userDefinedConfiguration.conf"}]}}],"defaultMode":420}},{"name":"rabbitmq-erlang-cookie","emptyDir":{}},{"name":"erlang-cookie-secret","secret":{"secretName":"rabbitmq-cluster-erlang-cookie","defaultMode":420}},{"name":"rabbitmq-plugins","emptyDir":{}},{"name":"pod-info","downwardAPI":{"items":[{"path":"skipPreStopChecks","fieldRef":{"apiVersion":"v1","fieldPath":"metadata.labels['skipPreStopChecks']"}}],"defaultMode":420}}],"initContainers":[{"name":"setup-container","image":"rabbitmq:3.8.12-management","command":["sh","-c","cp /tmp/erlang-cookie-secret/.erlang.cookie /var/lib/rabbitmq/.erlang.cookie \u0026\u0026 chown 999:999 /var/lib/rabbitmq/.erlang.cookie \u0026\u0026 chmod 600 /var/lib/rabbitmq/.erlang.cookie ; cp /tmp/rabbitmq-plugins/enabled_plugins /operator/enabled_plugins \u0026\u0026 chown 999:999 /operator/enabled_plugins ; chown 999:999 /var/lib/rabbitmq/mnesia/ ; echo '[default]' \u003e /var/lib/rabbitmq/.rabbitmqadmin.conf \u0026\u0026 sed -e 's/default_user/username/' -e 's/default_pass/password/' /tmp/default_user.conf \u003e\u003e /var/lib/rabbitmq/.rabbitmqadmin.conf \u0026\u0026 chown 999:999 /var/lib/rabbitmq/.rabbitmqadmin.conf \u0026\u0026 chmod 600 /var/lib/rabbitmq/.rabbitmqadmin.conf"],"resources":{"limits":{"cpu":"100m","memory":"500Mi"},"requests":{"cpu":"100m","memory":"500Mi"}},"volumeMounts":[{"name":"plugins-conf","mountPath":"/tmp/rabbitmq-plugins/"},{"name":"rabbitmq-erlang-cookie","mountPath":"/var/lib/rabbitmq/"},{"name":"erlang-cookie-secret","mountPath":"/tmp/erlang-cookie-secret/"},{"name":"rabbitmq-plugins","mountPath":"/operator"},{"name":"persistence","mountPath":"/var/lib/rabbitmq/mnesia/"},{"name":"rabbitmq-confd","mountPath":"/tmp/default_user.conf","subPath":"default_user.conf"}],"terminationMessagePath":"/dev/termination-log","terminationMessagePolicy":"File","imagePullPolicy":"IfNotPresent","securityContext":{"capabilities":{"drop":["FSETID","KILL","SETGID","SETUID","SETPCAP","NET_BIND_SERVICE","NET_RAW","SYS_CHROOT","MKNOD","AUDIT_WRITE","SETFCAP"]},"runAsUser":0}}],"containers":[{"name":"rabbitmq","image":"rabbitmq:3.8.12-management","ports":[{"name":"epmd","containerPort":4369,"protocol":"TCP"},{"name":"amqp","containerPort":5672,"protocol":"TCP"},{"name":"management","containerPort":15672,"protocol":"TCP"},{"name":"prometheus","containerPort":15692,"protocol":"TCP"}],"env":[{"name":"MY_POD_NAME","valueFrom":{"fieldRef":{"apiVersion":"v1","fieldPath":"metadata.name"}}},{"name":"MY_POD_NAMESPACE","valueFrom":{"fieldRef":{"apiVersion":"v1","fieldPath":"metadata.namespace"}}},{"name":"RABBITMQ_ENABLED_PLUGINS_FILE","value":"/operator/enabled_plugins"},{"name":"K8S_SERVICE_NAME","value":"rabbitmq-cluster-nodes"},{"name":"RABBITMQ_USE_LONGNAME","value":"true"},{"name":"RABBITMQ_NODENAME","value":"rabbit@$(MY_POD_NAME).$(K8S_SERVICE_NAME).$(MY_POD_NAMESPACE)"},{"name":"K8S_HOSTNAME_SUFFIX","value":".$(K8S_SERVICE_NAME).$(MY_POD_NAMESPACE)"}],"resources":{"limits":{"cpu":"2","memory":"2Gi"},"requests":{"cpu":"1","memory":"2Gi"}},"volumeMounts":[{"name":"rabbitmq-erlang-cookie","mountPath":"/var/lib/rabbitmq/"},{"name":"persistence","mountPath":"/var/lib/rabbitmq/mnesia/"},{"name":"rabbitmq-plugins","mountPath":"/operator"},{"name":"rabbitmq-confd","mountPath":"/etc/rabbitmq/conf.d/10-operatorDefaults.conf","subPath":"operatorDefaults.conf"},{"name":"rabbitmq-confd","mountPath":"/etc/rabbitmq/conf.d/11-default_user.conf","subPath":"default_user.conf"},{"name":"rabbitmq-confd","mountPath":"/etc/rabbitmq/conf.d/90-userDefinedConfiguration.conf","subPath":"userDefinedConfiguration.conf"},{"name":"pod-info","mountPath":"/etc/pod-info/"}],"readinessProbe":{"tcpSocket":{"port":"amqp"},"initialDelaySeconds":10,"timeoutSeconds":5,"periodSeconds":10,"successThreshold":1,"failureThreshold":3},"lifecycle":{"preStop":{"exec":{"command":["/bin/bash","-c","if [ ! -z \"$(cat /etc/pod-info/skipPreStopChecks)\" ]; then exit 0; fi; rabbitmq-upgrade await_online_quorum_plus_one -t 604800; rabbitmq-upgrade await_online_synchronized_mirror -t 604800; rabbitmq-upgrade drain -t 604800"]}}},"terminationMessagePath":"/dev/termination-log","terminationMessagePolicy":"File","imagePullPolicy":"IfNotPresent"}],"restartPolicy":"Always","terminationGracePeriodSeconds":604800,"dnsPolicy":"ClusterFirst","serviceAccountName":"rabbitmq-cluster-server","serviceAccount":"rabbitmq-cluster-server","automountServiceAccountToken":true,"securityContext":{"runAsUser":999,"runAsGroup":999,"fsGroup":999},"schedulerName":"default-scheduler","topologySpreadConstraints":[{"maxSkew":1,"topologyKey":"topology.kubernetes.io/zone","whenUnsatisfiable":"ScheduleAnyway","labelSelector":{"matchLabels":{"app.kubernetes.io/name":"rabbitmq-cluster"}}}]}},"volumeClaimTemplates":[{"metadata":{"name":"persistence","namespace":"default","creationTimestamp":null,"labels":{"app.kubernetes.io/component":"rabbitmq","app.kubernetes.io/name":"rabbitmq-cluster","app.kubernetes.io/part-of":"rabbitmq"},"ownerReferences":[{"apiVersion":"rabbitmq.com/v1beta1","kind":"RabbitmqCluster","name":"rabbitmq-cluster","uid":"3ecefa8a-1bec-48a7-9af4-dd0df3339101","controller":true,"blockOwnerDeletion":false}]},"spec":{"accessModes":["ReadWriteOnce"],"resources":{"requests":{"storage":"10Gi"}},"volumeMode":"Filesystem"},"status":{"phase":"Pending"}}],"serviceName":"rabbitmq-cluster-nodes","podManagementPolicy":"Parallel","updateStrategy":{"type":"RollingUpdate","rollingUpdate":{"partition":0}},"revisionHistoryLimit":10},"status":{"observedGeneration":1,"replicas":1,"readyReplicas":1,"currentReplicas":1,"updatedReplicas":1,"currentRevision":"rabbitmq-cluster-server-5f8b8665fb","updateRevision":"rabbitmq-cluster-server-5f8b8665fb","collisionCount":0}}
2022/03/18 18:07:25 learn_server.go:256: [SIEVE-BEFORE-WRITE]	34
2022/03/18 18:07:25 learn_server.go:263: [SIEVE-AFTER-WRITE]	34	Update	statefulset	github.com/rabbitmq/cluster-operator/controllers.(*RabbitmqClusterReconciler)	NoError	{"metadata":{"name":"rabbitmq-cluster-server","namespace":"default","selfLink":"/apis/apps/v1/namespaces/default/statefulsets/rabbitmq-cluster-server","uid":"f2f07f3e-b500-4c48-a5de-8db7eaf37b9a","resourceVersion":"1409","generation":1,"creationTimestamp":"2022-03-18T18:06:25Z","labels":{"app.kubernetes.io/component":"rabbitmq","app.kubernetes.io/name":"rabbitmq-cluster","app.kubernetes.io/part-of":"rabbitmq"},"ownerReferences":[{"apiVersion":"rabbitmq.com/v1beta1","kind":"RabbitmqCluster","name":"rabbitmq-cluster","uid":"3ecefa8a-1bec-48a7-9af4-dd0df3339101","controller":true,"blockOwnerDeletion":true}],"managedFields":[{"manager":"manager","operation":"Update","apiVersion":"apps/v1","time":"2022-03-18T18:06:25Z","fieldsType":"FieldsV1","fieldsV1":{"f:metadata":{"f:labels":{".":{},"f:app.kubernetes.io/component":{},"f:app.kubernetes.io/name":{},"f:app.kubernetes.io/part-of":{}},"f:ownerReferences":{".":{},"k:{\"uid\":\"3ecefa8a-1bec-48a7-9af4-dd0df3339101\"}":{".":{},"f:apiVersion":{},"f:blockOwnerDeletion":{},"f:controller":{},"f:kind":{},"f:name":{},"f:uid":{}}}},"f:spec":{"f:podManagementPolicy":{},"f:replicas":{},"f:revisionHistoryLimit":{},"f:selector":{"f:matchLabels":{".":{},"f:app.kubernetes.io/name":{}}},"f:serviceName":{},"f:template":{"f:metadata":{"f:annotations":{".":{},"f:prometheus.io/port":{},"f:prometheus.io/scrape":{}},"f:labels":{".":{},"f:app.kubernetes.io/component":{},"f:app.kubernetes.io/name":{},"f:app.kubernetes.io/part-of":{}}},"f:spec":{"f:automountServiceAccountToken":{},"f:containers":{"k:{\"name\":\"rabbitmq\"}":{".":{},"f:env":{".":{},"k:{\"name\":\"K8S_HOSTNAME_SUFFIX\"}":{".":{},"f:name":{},"f:value":{}},"k:{\"name\":\"K8S_SERVICE_NAME\"}":{".":{},"f:name":{},"f:value":{}},"k:{\"name\":\"MY_POD_NAME\"}":{".":{},"f:name":{},"f:valueFrom":{".":{},"f:fieldRef":{".":{},"f:apiVersion":{},"f:fieldPath":{}}}},"k:{\"name\":\"MY_POD_NAMESPACE\"}":{".":{},"f:name":{},"f:valueFrom":{".":{},"f:fieldRef":{".":{},"f:apiVersion":{},"f:fieldPath":{}}}},"k:{\"name\":\"RABBITMQ_ENABLED_PLUGINS_FILE\"}":{".":{},"f:name":{},"f:value":{}},"k:{\"name\":\"RABBITMQ_NODENAME\"}":{".":{},"f:name":{},"f:value":{}},"k:{\"name\":\"RABBITMQ_USE_LONGNAME\"}":{".":{},"f:name":{},"f:value":{}}},"f:image":{},"f:imagePullPolicy":{},"f:lifecycle":{".":{},"f:preStop":{".":{},"f:exec":{".":{},"f:command":{}}}},"f:name":{},"f:ports":{".":{},"k:{\"containerPort\":4369,\"protocol\":\"TCP\"}":{".":{},"f:containerPort":{},"f:name":{},"f:protocol":{}},"k:{\"containerPort\":5672,\"protocol\":\"TCP\"}":{".":{},"f:containerPort":{},"f:name":{},"f:protocol":{}},"k:{\"containerPort\":15672,\"protocol\":\"TCP\"}":{".":{},"f:containerPort":{},"f:name":{},"f:protocol":{}},"k:{\"containerPort\":15692,\"protocol\":\"TCP\"}":{".":{},"f:containerPort":{},"f:name":{},"f:protocol":{}}},"f:readinessProbe":{".":{},"f:failureThreshold":{},"f:initialDelaySeconds":{},"f:periodSeconds":{},"f:successThreshold":{},"f:tcpSocket":{".":{},"f:port":{}},"f:timeoutSeconds":{}},"f:resources":{".":{},"f:limits":{".":{},"f:cpu":{},"f:memory":{}},"f:requests":{".":{},"f:cpu":{},"f:memory":{}}},"f:terminationMessagePath":{},"f:terminationMessagePolicy":{},"f:volumeMounts":{".":{},"k:{\"mountPath\":\"/etc/pod-info/\"}":{".":{},"f:mountPath":{},"f:name":{}},"k:{\"mountPath\":\"/etc/rabbitmq/conf.d/10-operatorDefaults.conf\"}":{".":{},"f:mountPath":{},"f:name":{},"f:subPath":{}},"k:{\"mountPath\":\"/etc/rabbitmq/conf.d/11-default_user.conf\"}":{".":{},"f:mountPath":{},"f:name":{},"f:subPath":{}},"k:{\"mountPath\":\"/etc/rabbitmq/conf.d/90-userDefinedConfiguration.conf\"}":{".":{},"f:mountPath":{},"f:name":{},"f:subPath":{}},"k:{\"mountPath\":\"/operator\"}":{".":{},"f:mountPath":{},"f:name":{}},"k:{\"mountPath\":\"/var/lib/rabbitmq/\"}":{".":{},"f:mountPath":{},"f:name":{}},"k:{\"mountPath\":\"/var/lib/rabbitmq/mnesia/\"}":{".":{},"f:mountPath":{},"f:name":{}}}}},"f:dnsPolicy":{},"f:initContainers":{".":{},"k:{\"name\":\"setup-container\"}":{".":{},"f:command":{},"f:image":{},"f:imagePullPolicy":{},"f:name":{},"f:resources":{".":{},"f:limits":{".":{},"f:cpu":{},"f:memory":{}},"f:requests":{".":{},"f:cpu":{},"f:memory":{}}},"f:securityContext":{".":{},"f:capabilities":{".":{},"f:drop":{}},"f:runAsUser":{}},"f:terminationMessagePath":{},"f:terminationMessagePolicy":{},"f:volumeMounts":{".":{},"k:{\"mountPath\":\"/operator\"}":{".":{},"f:mountPath":{},"f:name":{}},"k:{\"mountPath\":\"/tmp/default_user.conf\"}":{".":{},"f:mountPath":{},"f:name":{},"f:subPath":{}},"k:{\"mountPath\":\"/tmp/erlang-cookie-secret/\"}":{".":{},"f:mountPath":{},"f:name":{}},"k:{\"mountPath\":\"/tmp/rabbitmq-plugins/\"}":{".":{},"f:mountPath":{},"f:name":{}},"k:{\"mountPath\":\"/var/lib/rabbitmq/\"}":{".":{},"f:mountPath":{},"f:name":{}},"k:{\"mountPath\":\"/var/lib/rabbitmq/mnesia/\"}":{".":{},"f:mountPath":{},"f:name":{}}}}},"f:restartPolicy":{},"f:schedulerName":{},"f:securityContext":{".":{},"f:fsGroup":{},"f:runAsGroup":{},"f:runAsUser":{}},"f:serviceAccount":{},"f:serviceAccountName":{},"f:terminationGracePeriodSeconds":{},"f:topologySpreadConstraints":{".":{},"k:{\"topologyKey\":\"topology.kubernetes.io/zone\",\"whenUnsatisfiable\":\"ScheduleAnyway\"}":{".":{},"f:labelSelector":{".":{},"f:matchLabels":{".":{},"f:app.kubernetes.io/name":{}}},"f:maxSkew":{},"f:topologyKey":{},"f:whenUnsatisfiable":{}}},"f:volumes":{".":{},"k:{\"name\":\"erlang-cookie-secret\"}":{".":{},"f:name":{},"f:secret":{".":{},"f:defaultMode":{},"f:secretName":{}}},"k:{\"name\":\"plugins-conf\"}":{".":{},"f:configMap":{".":{},"f:defaultMode":{},"f:name":{}},"f:name":{}},"k:{\"name\":\"pod-info\"}":{".":{},"f:downwardAPI":{".":{},"f:defaultMode":{},"f:items":{}},"f:name":{}},"k:{\"name\":\"rabbitmq-confd\"}":{".":{},"f:name":{},"f:projected":{".":{},"f:defaultMode":{},"f:sources":{}}},"k:{\"name\":\"rabbitmq-erlang-cookie\"}":{".":{},"f:emptyDir":{},"f:name":{}},"k:{\"name\":\"rabbitmq-plugins\"}":{".":{},"f:emptyDir":{},"f:name":{}}}}},"f:updateStrategy":{"f:rollingUpdate":{".":{},"f:partition":{}},"f:type":{}},"f:volumeClaimTemplates":{}}}},{"manager":"kube-controller-manager","operation":"Update","apiVersion":"apps/v1","time":"2022-03-18T18:07:23Z","fieldsType":"FieldsV1","fieldsV1":{"f:status":{"f:collisionCount":{},"f:currentReplicas":{},"f:currentRevision":{},"f:observedGeneration":{},"f:readyReplicas":{},"f:replicas":{},"f:updateRevision":{},"f:updatedReplicas":{}}}}]},"spec":{"replicas":1,"selector":{"matchLabels":{"app.kubernetes.io/name":"rabbitmq-cluster"}},"template":{"metadata":{"creationTimestamp":null,"labels":{"app.kubernetes.io/component":"rabbitmq","app.kubernetes.io/name":"rabbitmq-cluster","app.kubernetes.io/part-of":"rabbitmq"},"annotations":{"prometheus.io/port":"15692","prometheus.io/scrape":"true"}},"spec":{"volumes":[{"name":"plugins-conf","configMap":{"name":"rabbitmq-cluster-plugins-conf","defaultMode":420}},{"name":"rabbitmq-confd","projected":{"sources":[{"secret":{"name":"rabbitmq-cluster-default-user","items":[{"key":"default_user.conf","path":"default_user.conf"}]}},{"configMap":{"name":"rabbitmq-cluster-server-conf","items":[{"key":"operatorDefaults.conf","path":"operatorDefaults.conf"},{"key":"userDefinedConfiguration.conf","path":"userDefinedConfiguration.conf"}]}}],"defaultMode":420}},{"name":"rabbitmq-erlang-cookie","emptyDir":{}},{"name":"erlang-cookie-secret","secret":{"secretName":"rabbitmq-cluster-erlang-cookie","defaultMode":420}},{"name":"rabbitmq-plugins","emptyDir":{}},{"name":"pod-info","downwardAPI":{"items":[{"path":"skipPreStopChecks","fieldRef":{"apiVersion":"v1","fieldPath":"metadata.labels['skipPreStopChecks']"}}],"defaultMode":420}}],"initContainers":[{"name":"setup-container","image":"rabbitmq:3.8.12-management","command":["sh","-c","cp /tmp/erlang-cookie-secret/.erlang.cookie /var/lib/rabbitmq/.erlang.cookie \u0026\u0026 chown 999:999 /var/lib/rabbitmq/.erlang.cookie \u0026\u0026 chmod 600 /var/lib/rabbitmq/.erlang.cookie ; cp /tmp/rabbitmq-plugins/enabled_plugins /operator/enabled_plugins \u0026\u0026 chown 999:999 /operator/enabled_plugins ; chown 999:999 /var/lib/rabbitmq/mnesia/ ; echo '[default]' \u003e /var/lib/rabbitmq/.rabbitmqadmin.conf \u0026\u0026 sed -e 's/default_user/username/' -e 's/default_pass/password/' /tmp/default_user.conf \u003e\u003e /var/lib/rabbitmq/.rabbitmqadmin.conf \u0026\u0026 chown 999:999 /var/lib/rabbitmq/.rabbitmqadmin.conf \u0026\u0026 chmod 600 /var/lib/rabbitmq/.rabbitmqadmin.conf"],"resources":{"limits":{"cpu":"100m","memory":"500Mi"},"requests":{"cpu":"100m","memory":"500Mi"}},"volumeMounts":[{"name":"plugins-conf","mountPath":"/tmp/rabbitmq-plugins/"},{"name":"rabbitmq-erlang-cookie","mountPath":"/var/lib/rabbitmq/"},{"name":"erlang-cookie-secret","mountPath":"/tmp/erlang-cookie-secret/"},{"name":"rabbitmq-plugins","mountPath":"/operator"},{"name":"persistence","mountPath":"/var/lib/rabbitmq/mnesia/"},{"name":"rabbitmq-confd","mountPath":"/tmp/default_user.conf","subPath":"default_user.conf"}],"terminationMessagePath":"/dev/termination-log","terminationMessagePolicy":"File","imagePullPolicy":"IfNotPresent","securityContext":{"capabilities":{"drop":["FSETID","KILL","SETGID","SETUID","SETPCAP","NET_BIND_SERVICE","NET_RAW","SYS_CHROOT","MKNOD","AUDIT_WRITE","SETFCAP"]},"runAsUser":0}}],"containers":[{"name":"rabbitmq","image":"rabbitmq:3.8.12-management","ports":[{"name":"epmd","containerPort":4369,"protocol":"TCP"},{"name":"amqp","containerPort":5672,"protocol":"TCP"},{"name":"management","containerPort":15672,"protocol":"TCP"},{"name":"prometheus","containerPort":15692,"protocol":"TCP"}],"env":[{"name":"MY_POD_NAME","valueFrom":{"fieldRef":{"apiVersion":"v1","fieldPath":"metadata.name"}}},{"name":"MY_POD_NAMESPACE","valueFrom":{"fieldRef":{"apiVersion":"v1","fieldPath":"metadata.namespace"}}},{"name":"RABBITMQ_ENABLED_PLUGINS_FILE","value":"/operator/enabled_plugins"},{"name":"K8S_SERVICE_NAME","value":"rabbitmq-cluster-nodes"},{"name":"RABBITMQ_USE_LONGNAME","value":"true"},{"name":"RABBITMQ_NODENAME","value":"rabbit@$(MY_POD_NAME).$(K8S_SERVICE_NAME).$(MY_POD_NAMESPACE)"},{"name":"K8S_HOSTNAME_SUFFIX","value":".$(K8S_SERVICE_NAME).$(MY_POD_NAMESPACE)"}],"resources":{"limits":{"cpu":"2","memory":"2Gi"},"requests":{"cpu":"1","memory":"2Gi"}},"volumeMounts":[{"name":"rabbitmq-erlang-cookie","mountPath":"/var/lib/rabbitmq/"},{"name":"persistence","mountPath":"/var/lib/rabbitmq/mnesia/"},{"name":"rabbitmq-plugins","mountPath":"/operator"},{"name":"rabbitmq-confd","mountPath":"/etc/rabbitmq/conf.d/10-operatorDefaults.conf","subPath":"operatorDefaults.conf"},{"name":"rabbitmq-confd","mountPath":"/etc/rabbitmq/conf.d/11-default_user.conf","subPath":"default_user.conf"},{"name":"rabbitmq-confd","mountPath":"/etc/rabbitmq/conf.d/90-userDefinedConfiguration.conf","subPath":"userDefinedConfiguration.conf"},{"name":"pod-info","mountPath":"/etc/pod-info/"}],"readinessProbe":{"tcpSocket":{"port":"amqp"},"initialDelaySeconds":10,"timeoutSeconds":5,"periodSeconds":10,"successThreshold":1,"failureThreshold":3},"lifecycle":{"preStop":{"exec":{"command":["/bin/bash","-c","if [ ! -z \"$(cat /etc/pod-info/skipPreStopChecks)\" ]; then exit 0; fi; rabbitmq-upgrade await_online_quorum_plus_one -t 604800; rabbitmq-upgrade await_online_synchronized_mirror -t 604800; rabbitmq-upgrade drain -t 604800"]}}},"terminationMessagePath":"/dev/termination-log","terminationMessagePolicy":"File","imagePullPolicy":"IfNotPresent"}],"restartPolicy":"Always","terminationGracePeriodSeconds":604800,"dnsPolicy":"ClusterFirst","serviceAccountName":"rabbitmq-cluster-server","serviceAccount":"rabbitmq-cluster-server","automountServiceAccountToken":true,"securityContext":{"runAsUser":999,"runAsGroup":999,"fsGroup":999},"schedulerName":"default-scheduler","topologySpreadConstraints":[{"maxSkew":1,"topologyKey":"topology.kubernetes.io/zone","whenUnsatisfiable":"ScheduleAnyway","labelSelector":{"matchLabels":{"app.kubernetes.io/name":"rabbitmq-cluster"}}}]}},"volumeClaimTemplates":[{"metadata":{"name":"persistence","namespace":"default","creationTimestamp":null,"labels":{"app.kubernetes.io/component":"rabbitmq","app.kubernetes.io/name":"rabbitmq-cluster","app.kubernetes.io/part-of":"rabbitmq"},"ownerReferences":[{"apiVersion":"rabbitmq.com/v1beta1","kind":"RabbitmqCluster","name":"rabbitmq-cluster","uid":"3ecefa8a-1bec-48a7-9af4-dd0df3339101","controller":true,"blockOwnerDeletion":false}]},"spec":{"accessModes":["ReadWriteOnce"],"resources":{"requests":{"storage":"10Gi"}},"volumeMode":"Filesystem"},"status":{"phase":"Pending"}}],"serviceName":"rabbitmq-cluster-nodes","podManagementPolicy":"Parallel","updateStrategy":{"type":"RollingUpdate","rollingUpdate":{"partition":0}},"revisionHistoryLimit":10},"status":{"observedGeneration":1,"replicas":1,"readyReplicas":1,"currentReplicas":1,"updatedReplicas":1,"currentRevision":"rabbitmq-cluster-server-5f8b8665fb","updateRevision":"rabbitmq-cluster-server-5f8b8665fb","collisionCount":0}}
2022/03/18 18:07:25 learn_server.go:291: [SIEVE-AFTER-READ]	Get	true	configmap	default	rabbitmq-cluster-server-conf	github.com/rabbitmq/cluster-operator/controllers.(*RabbitmqClusterReconciler)	NoError	{"kind":"ConfigMap","apiVersion":"v1","metadata":{"name":"rabbitmq-cluster-server-conf","namespace":"default","selfLink":"/api/v1/namespaces/default/configmaps/rabbitmq-cluster-server-conf","uid":"e4182078-d429-4baf-9021-72618c509ac5","resourceVersion":"1095","creationTimestamp":"2022-03-18T18:06:25Z","labels":{"app.kubernetes.io/component":"rabbitmq","app.kubernetes.io/name":"rabbitmq-cluster","app.kubernetes.io/part-of":"rabbitmq"},"ownerReferences":[{"apiVersion":"rabbitmq.com/v1beta1","kind":"RabbitmqCluster","name":"rabbitmq-cluster","uid":"3ecefa8a-1bec-48a7-9af4-dd0df3339101","controller":true,"blockOwnerDeletion":true}],"managedFields":[{"manager":"manager","operation":"Update","apiVersion":"v1","time":"2022-03-18T18:06:25Z","fieldsType":"FieldsV1","fieldsV1":{"f:data":{".":{},"f:operatorDefaults.conf":{},"f:userDefinedConfiguration.conf":{}},"f:metadata":{"f:labels":{".":{},"f:app.kubernetes.io/component":{},"f:app.kubernetes.io/name":{},"f:app.kubernetes.io/part-of":{}},"f:ownerReferences":{".":{},"k:{\"uid\":\"3ecefa8a-1bec-48a7-9af4-dd0df3339101\"}":{".":{},"f:apiVersion":{},"f:blockOwnerDeletion":{},"f:controller":{},"f:kind":{},"f:name":{},"f:uid":{}}}}}}]},"data":{"operatorDefaults.conf":"cluster_formation.peer_discovery_backend             = rabbit_peer_discovery_k8s\ncluster_formation.k8s.host                           = kubernetes.default\ncluster_formation.k8s.address_type                   = hostname\ncluster_partition_handling                           = pause_minority\nqueue_master_locator                                 = min-masters\ndisk_free_limit.absolute                             = 2GB\ncluster_formation.randomized_startup_delay_range.min = 5\ncluster_formation.randomized_startup_delay_range.max = 30\ncluster_name                                         = rabbitmq-cluster\n","userDefinedConfiguration.conf":"total_memory_available_override_value = 1717986919\n"}}
2022/03/18 18:07:25 learn_server.go:256: [SIEVE-BEFORE-WRITE]	35
2022/03/18 18:07:25 learn_server.go:263: [SIEVE-AFTER-WRITE]	35	StatusUpdate	rabbitmqcluster	github.com/rabbitmq/cluster-operator/controllers.(*RabbitmqClusterReconciler)	NoError	{"metadata":{"name":"rabbitmq-cluster","namespace":"default","selfLink":"/apis/rabbitmq.com/v1beta1/namespaces/default/rabbitmqclusters/rabbitmq-cluster/status","uid":"3ecefa8a-1bec-48a7-9af4-dd0df3339101","resourceVersion":"1410","generation":2,"creationTimestamp":"2022-03-18T18:06:25Z","annotations":{"kubectl.kubernetes.io/last-applied-configuration":"{\"apiVersion\":\"rabbitmq.com/v1beta1\",\"kind\":\"RabbitmqCluster\",\"metadata\":{\"annotations\":{},\"name\":\"rabbitmq-cluster\",\"namespace\":\"default\"},\"spec\":{\"persistence\":{\"storage\":\"10Gi\"},\"replicas\":1}}\n"},"finalizers":["deletion.finalizers.rabbitmqclusters.rabbitmq.com"],"managedFields":[{"manager":"kubectl-client-side-apply","operation":"Update","apiVersion":"rabbitmq.com/v1beta1","time":"2022-03-18T18:06:25Z","fieldsType":"FieldsV1","fieldsV1":{"f:metadata":{"f:annotations":{".":{},"f:kubectl.kubernetes.io/last-applied-configuration":{}}},"f:spec":{".":{},"f:image":{},"f:persistence":{".":{},"f:storage":{}},"f:replicas":{},"f:resources":{".":{},"f:limits":{".":{},"f:memory":{}},"f:requests":{".":{},"f:memory":{}}},"f:service":{".":{},"f:type":{}},"f:terminationGracePeriodSeconds":{}}}},{"manager":"manager","operation":"Update","apiVersion":"rabbitmq.com/v1beta1","time":"2022-03-18T18:07:24Z","fieldsType":"FieldsV1","fieldsV1":{"f:metadata":{"f:finalizers":{}},"f:spec":{"f:override":{},"f:rabbitmq":{},"f:resources":{"f:limits":{"f:cpu":{}},"f:requests":{"f:cpu":{}}},"f:tls":{}},"f:status":{".":{},"f:conditions":{},"f:defaultUser":{".":{},"f:secretReference":{".":{},"f:keys":{".":{},"f:password":{},"f:username":{}},"f:name":{},"f:namespace":{}},"f:serviceReference":{".":{},"f:name":{},"f:namespace":{}}}}}}]},"spec":{"replicas":1,"image":"rabbitmq:3.8.12-management","service":{"type":"ClusterIP"},"persistence":{"storage":"10Gi"},"resources":{"limits":{"cpu":"2","memory":"2Gi"},"requests":{"cpu":"1","memory":"2Gi"}},"rabbitmq":{},"tls":{},"override":{},"terminationGracePeriodSeconds":604800},"status":{"conditions":[{"type":"AllReplicasReady","status":"True","lastTransitionTime":"2022-03-18T18:07:23Z","reason":"AllPodsAreReady"},{"type":"ClusterAvailable","status":"True","lastTransitionTime":"2022-03-18T18:07:23Z","reason":"AtLeastOneEndpointAvailable"},{"type":"NoWarnings","status":"True","lastTransitionTime":"2022-03-18T18:06:25Z","reason":"NoWarnings"},{"type":"ReconcileSuccess","status":"True","lastTransitionTime":"2022-03-18T18:07:24Z","reason":"Success","message":"Finish reconciling"}],"defaultUser":{"secretReference":{"name":"rabbitmq-cluster-default-user","namespace":"default","keys":{"password":"password","username":"username"}},"serviceReference":{"name":"rabbitmq-cluster","namespace":"default"}},"binding":{"name":"rabbitmq-cluster-default-user"}}}
2022/03/18 18:07:25 learn_server.go:291: [SIEVE-AFTER-READ]	Get	true	statefulset	default	rabbitmq-cluster-server	github.com/rabbitmq/cluster-operator/controllers.(*RabbitmqClusterReconciler)	NoError	{"kind":"StatefulSet","apiVersion":"apps/v1","metadata":{"name":"rabbitmq-cluster-server","namespace":"default","selfLink":"/apis/apps/v1/namespaces/default/statefulsets/rabbitmq-cluster-server","uid":"f2f07f3e-b500-4c48-a5de-8db7eaf37b9a","resourceVersion":"1409","generation":1,"creationTimestamp":"2022-03-18T18:06:25Z","labels":{"app.kubernetes.io/component":"rabbitmq","app.kubernetes.io/name":"rabbitmq-cluster","app.kubernetes.io/part-of":"rabbitmq"},"ownerReferences":[{"apiVersion":"rabbitmq.com/v1beta1","kind":"RabbitmqCluster","name":"rabbitmq-cluster","uid":"3ecefa8a-1bec-48a7-9af4-dd0df3339101","controller":true,"blockOwnerDeletion":true}],"managedFields":[{"manager":"manager","operation":"Update","apiVersion":"apps/v1","time":"2022-03-18T18:06:25Z","fieldsType":"FieldsV1","fieldsV1":{"f:metadata":{"f:labels":{".":{},"f:app.kubernetes.io/component":{},"f:app.kubernetes.io/name":{},"f:app.kubernetes.io/part-of":{}},"f:ownerReferences":{".":{},"k:{\"uid\":\"3ecefa8a-1bec-48a7-9af4-dd0df3339101\"}":{".":{},"f:apiVersion":{},"f:blockOwnerDeletion":{},"f:controller":{},"f:kind":{},"f:name":{},"f:uid":{}}}},"f:spec":{"f:podManagementPolicy":{},"f:replicas":{},"f:revisionHistoryLimit":{},"f:selector":{"f:matchLabels":{".":{},"f:app.kubernetes.io/name":{}}},"f:serviceName":{},"f:template":{"f:metadata":{"f:annotations":{".":{},"f:prometheus.io/port":{},"f:prometheus.io/scrape":{}},"f:labels":{".":{},"f:app.kubernetes.io/component":{},"f:app.kubernetes.io/name":{},"f:app.kubernetes.io/part-of":{}}},"f:spec":{"f:automountServiceAccountToken":{},"f:containers":{"k:{\"name\":\"rabbitmq\"}":{".":{},"f:env":{".":{},"k:{\"name\":\"K8S_HOSTNAME_SUFFIX\"}":{".":{},"f:name":{},"f:value":{}},"k:{\"name\":\"K8S_SERVICE_NAME\"}":{".":{},"f:name":{},"f:value":{}},"k:{\"name\":\"MY_POD_NAME\"}":{".":{},"f:name":{},"f:valueFrom":{".":{},"f:fieldRef":{".":{},"f:apiVersion":{},"f:fieldPath":{}}}},"k:{\"name\":\"MY_POD_NAMESPACE\"}":{".":{},"f:name":{},"f:valueFrom":{".":{},"f:fieldRef":{".":{},"f:apiVersion":{},"f:fieldPath":{}}}},"k:{\"name\":\"RABBITMQ_ENABLED_PLUGINS_FILE\"}":{".":{},"f:name":{},"f:value":{}},"k:{\"name\":\"RABBITMQ_NODENAME\"}":{".":{},"f:name":{},"f:value":{}},"k:{\"name\":\"RABBITMQ_USE_LONGNAME\"}":{".":{},"f:name":{},"f:value":{}}},"f:image":{},"f:imagePullPolicy":{},"f:lifecycle":{".":{},"f:preStop":{".":{},"f:exec":{".":{},"f:command":{}}}},"f:name":{},"f:ports":{".":{},"k:{\"containerPort\":4369,\"protocol\":\"TCP\"}":{".":{},"f:containerPort":{},"f:name":{},"f:protocol":{}},"k:{\"containerPort\":5672,\"protocol\":\"TCP\"}":{".":{},"f:containerPort":{},"f:name":{},"f:protocol":{}},"k:{\"containerPort\":15672,\"protocol\":\"TCP\"}":{".":{},"f:containerPort":{},"f:name":{},"f:protocol":{}},"k:{\"containerPort\":15692,\"protocol\":\"TCP\"}":{".":{},"f:containerPort":{},"f:name":{},"f:protocol":{}}},"f:readinessProbe":{".":{},"f:failureThreshold":{},"f:initialDelaySeconds":{},"f:periodSeconds":{},"f:successThreshold":{},"f:tcpSocket":{".":{},"f:port":{}},"f:timeoutSeconds":{}},"f:resources":{".":{},"f:limits":{".":{},"f:cpu":{},"f:memory":{}},"f:requests":{".":{},"f:cpu":{},"f:memory":{}}},"f:terminationMessagePath":{},"f:terminationMessagePolicy":{},"f:volumeMounts":{".":{},"k:{\"mountPath\":\"/etc/pod-info/\"}":{".":{},"f:mountPath":{},"f:name":{}},"k:{\"mountPath\":\"/etc/rabbitmq/conf.d/10-operatorDefaults.conf\"}":{".":{},"f:mountPath":{},"f:name":{},"f:subPath":{}},"k:{\"mountPath\":\"/etc/rabbitmq/conf.d/11-default_user.conf\"}":{".":{},"f:mountPath":{},"f:name":{},"f:subPath":{}},"k:{\"mountPath\":\"/etc/rabbitmq/conf.d/90-userDefinedConfiguration.conf\"}":{".":{},"f:mountPath":{},"f:name":{},"f:subPath":{}},"k:{\"mountPath\":\"/operator\"}":{".":{},"f:mountPath":{},"f:name":{}},"k:{\"mountPath\":\"/var/lib/rabbitmq/\"}":{".":{},"f:mountPath":{},"f:name":{}},"k:{\"mountPath\":\"/var/lib/rabbitmq/mnesia/\"}":{".":{},"f:mountPath":{},"f:name":{}}}}},"f:dnsPolicy":{},"f:initContainers":{".":{},"k:{\"name\":\"setup-container\"}":{".":{},"f:command":{},"f:image":{},"f:imagePullPolicy":{},"f:name":{},"f:resources":{".":{},"f:limits":{".":{},"f:cpu":{},"f:memory":{}},"f:requests":{".":{},"f:cpu":{},"f:memory":{}}},"f:securityContext":{".":{},"f:capabilities":{".":{},"f:drop":{}},"f:runAsUser":{}},"f:terminationMessagePath":{},"f:terminationMessagePolicy":{},"f:volumeMounts":{".":{},"k:{\"mountPath\":\"/operator\"}":{".":{},"f:mountPath":{},"f:name":{}},"k:{\"mountPath\":\"/tmp/default_user.conf\"}":{".":{},"f:mountPath":{},"f:name":{},"f:subPath":{}},"k:{\"mountPath\":\"/tmp/erlang-cookie-secret/\"}":{".":{},"f:mountPath":{},"f:name":{}},"k:{\"mountPath\":\"/tmp/rabbitmq-plugins/\"}":{".":{},"f:mountPath":{},"f:name":{}},"k:{\"mountPath\":\"/var/lib/rabbitmq/\"}":{".":{},"f:mountPath":{},"f:name":{}},"k:{\"mountPath\":\"/var/lib/rabbitmq/mnesia/\"}":{".":{},"f:mountPath":{},"f:name":{}}}}},"f:restartPolicy":{},"f:schedulerName":{},"f:securityContext":{".":{},"f:fsGroup":{},"f:runAsGroup":{},"f:runAsUser":{}},"f:serviceAccount":{},"f:serviceAccountName":{},"f:terminationGracePeriodSeconds":{},"f:topologySpreadConstraints":{".":{},"k:{\"topologyKey\":\"topology.kubernetes.io/zone\",\"whenUnsatisfiable\":\"ScheduleAnyway\"}":{".":{},"f:labelSelector":{".":{},"f:matchLabels":{".":{},"f:app.kubernetes.io/name":{}}},"f:maxSkew":{},"f:topologyKey":{},"f:whenUnsatisfiable":{}}},"f:volumes":{".":{},"k:{\"name\":\"erlang-cookie-secret\"}":{".":{},"f:name":{},"f:secret":{".":{},"f:defaultMode":{},"f:secretName":{}}},"k:{\"name\":\"plugins-conf\"}":{".":{},"f:configMap":{".":{},"f:defaultMode":{},"f:name":{}},"f:name":{}},"k:{\"name\":\"pod-info\"}":{".":{},"f:downwardAPI":{".":{},"f:defaultMode":{},"f:items":{}},"f:name":{}},"k:{\"name\":\"rabbitmq-confd\"}":{".":{},"f:name":{},"f:projected":{".":{},"f:defaultMode":{},"f:sources":{}}},"k:{\"name\":\"rabbitmq-erlang-cookie\"}":{".":{},"f:emptyDir":{},"f:name":{}},"k:{\"name\":\"rabbitmq-plugins\"}":{".":{},"f:emptyDir":{},"f:name":{}}}}},"f:updateStrategy":{"f:rollingUpdate":{".":{},"f:partition":{}},"f:type":{}},"f:volumeClaimTemplates":{}}}},{"manager":"kube-controller-manager","operation":"Update","apiVersion":"apps/v1","time":"2022-03-18T18:07:23Z","fieldsType":"FieldsV1","fieldsV1":{"f:status":{"f:collisionCount":{},"f:currentReplicas":{},"f:currentRevision":{},"f:observedGeneration":{},"f:readyReplicas":{},"f:replicas":{},"f:updateRevision":{},"f:updatedReplicas":{}}}}]},"spec":{"replicas":1,"selector":{"matchLabels":{"app.kubernetes.io/name":"rabbitmq-cluster"}},"template":{"metadata":{"creationTimestamp":null,"labels":{"app.kubernetes.io/component":"rabbitmq","app.kubernetes.io/name":"rabbitmq-cluster","app.kubernetes.io/part-of":"rabbitmq"},"annotations":{"prometheus.io/port":"15692","prometheus.io/scrape":"true"}},"spec":{"volumes":[{"name":"plugins-conf","configMap":{"name":"rabbitmq-cluster-plugins-conf","defaultMode":420}},{"name":"rabbitmq-confd","projected":{"sources":[{"secret":{"name":"rabbitmq-cluster-default-user","items":[{"key":"default_user.conf","path":"default_user.conf"}]}},{"configMap":{"name":"rabbitmq-cluster-server-conf","items":[{"key":"operatorDefaults.conf","path":"operatorDefaults.conf"},{"key":"userDefinedConfiguration.conf","path":"userDefinedConfiguration.conf"}]}}],"defaultMode":420}},{"name":"rabbitmq-erlang-cookie","emptyDir":{}},{"name":"erlang-cookie-secret","secret":{"secretName":"rabbitmq-cluster-erlang-cookie","defaultMode":420}},{"name":"rabbitmq-plugins","emptyDir":{}},{"name":"pod-info","downwardAPI":{"items":[{"path":"skipPreStopChecks","fieldRef":{"apiVersion":"v1","fieldPath":"metadata.labels['skipPreStopChecks']"}}],"defaultMode":420}}],"initContainers":[{"name":"setup-container","image":"rabbitmq:3.8.12-management","command":["sh","-c","cp /tmp/erlang-cookie-secret/.erlang.cookie /var/lib/rabbitmq/.erlang.cookie \u0026\u0026 chown 999:999 /var/lib/rabbitmq/.erlang.cookie \u0026\u0026 chmod 600 /var/lib/rabbitmq/.erlang.cookie ; cp /tmp/rabbitmq-plugins/enabled_plugins /operator/enabled_plugins \u0026\u0026 chown 999:999 /operator/enabled_plugins ; chown 999:999 /var/lib/rabbitmq/mnesia/ ; echo '[default]' \u003e /var/lib/rabbitmq/.rabbitmqadmin.conf \u0026\u0026 sed -e 's/default_user/username/' -e 's/default_pass/password/' /tmp/default_user.conf \u003e\u003e /var/lib/rabbitmq/.rabbitmqadmin.conf \u0026\u0026 chown 999:999 /var/lib/rabbitmq/.rabbitmqadmin.conf \u0026\u0026 chmod 600 /var/lib/rabbitmq/.rabbitmqadmin.conf"],"resources":{"limits":{"cpu":"100m","memory":"500Mi"},"requests":{"cpu":"100m","memory":"500Mi"}},"volumeMounts":[{"name":"plugins-conf","mountPath":"/tmp/rabbitmq-plugins/"},{"name":"rabbitmq-erlang-cookie","mountPath":"/var/lib/rabbitmq/"},{"name":"erlang-cookie-secret","mountPath":"/tmp/erlang-cookie-secret/"},{"name":"rabbitmq-plugins","mountPath":"/operator"},{"name":"persistence","mountPath":"/var/lib/rabbitmq/mnesia/"},{"name":"rabbitmq-confd","mountPath":"/tmp/default_user.conf","subPath":"default_user.conf"}],"terminationMessagePath":"/dev/termination-log","terminationMessagePolicy":"File","imagePullPolicy":"IfNotPresent","securityContext":{"capabilities":{"drop":["FSETID","KILL","SETGID","SETUID","SETPCAP","NET_BIND_SERVICE","NET_RAW","SYS_CHROOT","MKNOD","AUDIT_WRITE","SETFCAP"]},"runAsUser":0}}],"containers":[{"name":"rabbitmq","image":"rabbitmq:3.8.12-management","ports":[{"name":"epmd","containerPort":4369,"protocol":"TCP"},{"name":"amqp","containerPort":5672,"protocol":"TCP"},{"name":"management","containerPort":15672,"protocol":"TCP"},{"name":"prometheus","containerPort":15692,"protocol":"TCP"}],"env":[{"name":"MY_POD_NAME","valueFrom":{"fieldRef":{"apiVersion":"v1","fieldPath":"metadata.name"}}},{"name":"MY_POD_NAMESPACE","valueFrom":{"fieldRef":{"apiVersion":"v1","fieldPath":"metadata.namespace"}}},{"name":"RABBITMQ_ENABLED_PLUGINS_FILE","value":"/operator/enabled_plugins"},{"name":"K8S_SERVICE_NAME","value":"rabbitmq-cluster-nodes"},{"name":"RABBITMQ_USE_LONGNAME","value":"true"},{"name":"RABBITMQ_NODENAME","value":"rabbit@$(MY_POD_NAME).$(K8S_SERVICE_NAME).$(MY_POD_NAMESPACE)"},{"name":"K8S_HOSTNAME_SUFFIX","value":".$(K8S_SERVICE_NAME).$(MY_POD_NAMESPACE)"}],"resources":{"limits":{"cpu":"2","memory":"2Gi"},"requests":{"cpu":"1","memory":"2Gi"}},"volumeMounts":[{"name":"rabbitmq-erlang-cookie","mountPath":"/var/lib/rabbitmq/"},{"name":"persistence","mountPath":"/var/lib/rabbitmq/mnesia/"},{"name":"rabbitmq-plugins","mountPath":"/operator"},{"name":"rabbitmq-confd","mountPath":"/etc/rabbitmq/conf.d/10-operatorDefaults.conf","subPath":"operatorDefaults.conf"},{"name":"rabbitmq-confd","mountPath":"/etc/rabbitmq/conf.d/11-default_user.conf","subPath":"default_user.conf"},{"name":"rabbitmq-confd","mountPath":"/etc/rabbitmq/conf.d/90-userDefinedConfiguration.conf","subPath":"userDefinedConfiguration.conf"},{"name":"pod-info","mountPath":"/etc/pod-info/"}],"readinessProbe":{"tcpSocket":{"port":"amqp"},"initialDelaySeconds":10,"timeoutSeconds":5,"periodSeconds":10,"successThreshold":1,"failureThreshold":3},"lifecycle":{"preStop":{"exec":{"command":["/bin/bash","-c","if [ ! -z \"$(cat /etc/pod-info/skipPreStopChecks)\" ]; then exit 0; fi; rabbitmq-upgrade await_online_quorum_plus_one -t 604800; rabbitmq-upgrade await_online_synchronized_mirror -t 604800; rabbitmq-upgrade drain -t 604800"]}}},"terminationMessagePath":"/dev/termination-log","terminationMessagePolicy":"File","imagePullPolicy":"IfNotPresent"}],"restartPolicy":"Always","terminationGracePeriodSeconds":604800,"dnsPolicy":"ClusterFirst","serviceAccountName":"rabbitmq-cluster-server","serviceAccount":"rabbitmq-cluster-server","automountServiceAccountToken":true,"securityContext":{"runAsUser":999,"runAsGroup":999,"fsGroup":999},"schedulerName":"default-scheduler","topologySpreadConstraints":[{"maxSkew":1,"topologyKey":"topology.kubernetes.io/zone","whenUnsatisfiable":"ScheduleAnyway","labelSelector":{"matchLabels":{"app.kubernetes.io/name":"rabbitmq-cluster"}}}]}},"volumeClaimTemplates":[{"metadata":{"name":"persistence","namespace":"default","creationTimestamp":null,"labels":{"app.kubernetes.io/component":"rabbitmq","app.kubernetes.io/name":"rabbitmq-cluster","app.kubernetes.io/part-of":"rabbitmq"},"ownerReferences":[{"apiVersion":"rabbitmq.com/v1beta1","kind":"RabbitmqCluster","name":"rabbitmq-cluster","uid":"3ecefa8a-1bec-48a7-9af4-dd0df3339101","controller":true,"blockOwnerDeletion":false}]},"spec":{"accessModes":["ReadWriteOnce"],"resources":{"requests":{"storage":"10Gi"}},"volumeMode":"Filesystem"},"status":{"phase":"Pending"}}],"serviceName":"rabbitmq-cluster-nodes","podManagementPolicy":"Parallel","updateStrategy":{"type":"RollingUpdate","rollingUpdate":{"partition":0}},"revisionHistoryLimit":10},"status":{"observedGeneration":1,"replicas":1,"readyReplicas":1,"currentReplicas":1,"updatedReplicas":1,"currentRevision":"rabbitmq-cluster-server-5f8b8665fb","updateRevision":"rabbitmq-cluster-server-5f8b8665fb","collisionCount":0}}
2022/03/18 18:07:25 learn_server.go:291: [SIEVE-AFTER-READ]	Get	true	configmap	default	rabbitmq-cluster-plugins-conf	github.com/rabbitmq/cluster-operator/controllers.(*RabbitmqClusterReconciler)	NoError	{"kind":"ConfigMap","apiVersion":"v1","metadata":{"name":"rabbitmq-cluster-plugins-conf","namespace":"default","selfLink":"/api/v1/namespaces/default/configmaps/rabbitmq-cluster-plugins-conf","uid":"0aa26eb6-ff3a-4457-a223-284c897db7fe","resourceVersion":"1092","creationTimestamp":"2022-03-18T18:06:25Z","labels":{"app.kubernetes.io/component":"rabbitmq","app.kubernetes.io/name":"rabbitmq-cluster","app.kubernetes.io/part-of":"rabbitmq"},"ownerReferences":[{"apiVersion":"rabbitmq.com/v1beta1","kind":"RabbitmqCluster","name":"rabbitmq-cluster","uid":"3ecefa8a-1bec-48a7-9af4-dd0df3339101","controller":true,"blockOwnerDeletion":true}],"managedFields":[{"manager":"manager","operation":"Update","apiVersion":"v1","time":"2022-03-18T18:06:25Z","fieldsType":"FieldsV1","fieldsV1":{"f:data":{".":{},"f:enabled_plugins":{}},"f:metadata":{"f:labels":{".":{},"f:app.kubernetes.io/component":{},"f:app.kubernetes.io/name":{},"f:app.kubernetes.io/part-of":{}},"f:ownerReferences":{".":{},"k:{\"uid\":\"3ecefa8a-1bec-48a7-9af4-dd0df3339101\"}":{".":{},"f:apiVersion":{},"f:blockOwnerDeletion":{},"f:controller":{},"f:kind":{},"f:name":{},"f:uid":{}}}}}}]},"data":{"enabled_plugins":"[rabbitmq_peer_discovery_k8s,rabbitmq_prometheus,rabbitmq_management]."}}
2022/03/18 18:07:25 learn_server.go:256: [SIEVE-BEFORE-WRITE]	36
2022/03/18 18:07:25 learn_server.go:263: [SIEVE-AFTER-WRITE]	36	StatusUpdate	rabbitmqcluster	github.com/rabbitmq/cluster-operator/controllers.(*RabbitmqClusterReconciler)	NoError	{"metadata":{"name":"rabbitmq-cluster","namespace":"default","selfLink":"/apis/rabbitmq.com/v1beta1/namespaces/default/rabbitmqclusters/rabbitmq-cluster/status","uid":"3ecefa8a-1bec-48a7-9af4-dd0df3339101","resourceVersion":"1410","generation":2,"creationTimestamp":"2022-03-18T18:06:25Z","annotations":{"kubectl.kubernetes.io/last-applied-configuration":"{\"apiVersion\":\"rabbitmq.com/v1beta1\",\"kind\":\"RabbitmqCluster\",\"metadata\":{\"annotations\":{},\"name\":\"rabbitmq-cluster\",\"namespace\":\"default\"},\"spec\":{\"persistence\":{\"storage\":\"10Gi\"},\"replicas\":1}}\n"},"finalizers":["deletion.finalizers.rabbitmqclusters.rabbitmq.com"],"managedFields":[{"manager":"kubectl-client-side-apply","operation":"Update","apiVersion":"rabbitmq.com/v1beta1","time":"2022-03-18T18:06:25Z","fieldsType":"FieldsV1","fieldsV1":{"f:metadata":{"f:annotations":{".":{},"f:kubectl.kubernetes.io/last-applied-configuration":{}}},"f:spec":{".":{},"f:image":{},"f:persistence":{".":{},"f:storage":{}},"f:replicas":{},"f:resources":{".":{},"f:limits":{".":{},"f:memory":{}},"f:requests":{".":{},"f:memory":{}}},"f:service":{".":{},"f:type":{}},"f:terminationGracePeriodSeconds":{}}}},{"manager":"manager","operation":"Update","apiVersion":"rabbitmq.com/v1beta1","time":"2022-03-18T18:07:24Z","fieldsType":"FieldsV1","fieldsV1":{"f:metadata":{"f:finalizers":{}},"f:spec":{"f:override":{},"f:rabbitmq":{},"f:resources":{"f:limits":{"f:cpu":{}},"f:requests":{"f:cpu":{}}},"f:tls":{}},"f:status":{".":{},"f:conditions":{},"f:defaultUser":{".":{},"f:secretReference":{".":{},"f:keys":{".":{},"f:password":{},"f:username":{}},"f:name":{},"f:namespace":{}},"f:serviceReference":{".":{},"f:name":{},"f:namespace":{}}}}}}]},"spec":{"replicas":1,"image":"rabbitmq:3.8.12-management","service":{"type":"ClusterIP"},"persistence":{"storage":"10Gi"},"resources":{"limits":{"cpu":"2","memory":"2Gi"},"requests":{"cpu":"1","memory":"2Gi"}},"rabbitmq":{},"tls":{},"override":{},"terminationGracePeriodSeconds":604800},"status":{"conditions":[{"type":"AllReplicasReady","status":"True","lastTransitionTime":"2022-03-18T18:07:23Z","reason":"AllPodsAreReady"},{"type":"ClusterAvailable","status":"True","lastTransitionTime":"2022-03-18T18:07:23Z","reason":"AtLeastOneEndpointAvailable"},{"type":"NoWarnings","status":"True","lastTransitionTime":"2022-03-18T18:06:25Z","reason":"NoWarnings"},{"type":"ReconcileSuccess","status":"True","lastTransitionTime":"2022-03-18T18:07:24Z","reason":"Success","message":"Finish reconciling"}],"defaultUser":{"secretReference":{"name":"rabbitmq-cluster-default-user","namespace":"default","keys":{"password":"password","username":"username"}},"serviceReference":{"name":"rabbitmq-cluster","namespace":"default"}},"binding":{"name":"rabbitmq-cluster-default-user"}}}
2022/03/18 18:07:25 learn_server.go:253: [SIEVE-AFTER-RECONCILE]	github.com/rabbitmq/cluster-operator/controllers.(*RabbitmqClusterReconciler)	8
2022/03/18 18:07:31 learn_server.go:279: [SIEVE-BEFORE-HEAR]	22	Updated	rabbitmqcluster	{"metadata":{"name":"rabbitmq-cluster","namespace":"default","selfLink":"/apis/rabbitmq.com/v1beta1/namespaces/default/rabbitmqclusters/rabbitmq-cluster","uid":"3ecefa8a-1bec-48a7-9af4-dd0df3339101","resourceVersion":"1440","generation":3,"creationTimestamp":"2022-03-18T18:06:25Z","annotations":{"kubectl.kubernetes.io/last-applied-configuration":"{\"apiVersion\":\"rabbitmq.com/v1beta1\",\"kind\":\"RabbitmqCluster\",\"metadata\":{\"annotations\":{},\"name\":\"rabbitmq-cluster\",\"namespace\":\"default\"},\"spec\":{\"persistence\":{\"storage\":\"10Gi\"},\"replicas\":1}}\n"},"finalizers":["deletion.finalizers.rabbitmqclusters.rabbitmq.com"],"managedFields":[{"manager":"kubectl-client-side-apply","operation":"Update","apiVersion":"rabbitmq.com/v1beta1","time":"2022-03-18T18:06:25Z","fieldsType":"FieldsV1","fieldsV1":{"f:metadata":{"f:annotations":{".":{},"f:kubectl.kubernetes.io/last-applied-configuration":{}}},"f:spec":{".":{},"f:image":{},"f:persistence":{},"f:replicas":{},"f:resources":{".":{},"f:limits":{".":{},"f:memory":{}},"f:requests":{".":{},"f:memory":{}}},"f:service":{".":{},"f:type":{}},"f:terminationGracePeriodSeconds":{}}}},{"manager":"manager","operation":"Update","apiVersion":"rabbitmq.com/v1beta1","time":"2022-03-18T18:07:24Z","fieldsType":"FieldsV1","fieldsV1":{"f:metadata":{"f:finalizers":{}},"f:spec":{"f:override":{},"f:rabbitmq":{},"f:resources":{"f:limits":{"f:cpu":{}},"f:requests":{"f:cpu":{}}},"f:tls":{}},"f:status":{".":{},"f:conditions":{},"f:defaultUser":{".":{},"f:secretReference":{".":{},"f:keys":{".":{},"f:password":{},"f:username":{}},"f:name":{},"f:namespace":{}},"f:serviceReference":{".":{},"f:name":{},"f:namespace":{}}}}}},{"manager":"kubectl-patch","operation":"Update","apiVersion":"rabbitmq.com/v1beta1","time":"2022-03-18T18:07:31Z","fieldsType":"FieldsV1","fieldsV1":{"f:spec":{"f:persistence":{"f:storage":{}}}}}]},"spec":{"replicas":1,"image":"rabbitmq:3.8.12-management","service":{"type":"ClusterIP"},"persistence":{"storage":"15Gi"},"resources":{"limits":{"cpu":"2","memory":"2Gi"},"requests":{"cpu":"1","memory":"2Gi"}},"rabbitmq":{},"tls":{},"override":{},"terminationGracePeriodSeconds":604800},"status":{"conditions":[{"type":"AllReplicasReady","status":"True","lastTransitionTime":"2022-03-18T18:07:23Z","reason":"AllPodsAreReady"},{"type":"ClusterAvailable","status":"True","lastTransitionTime":"2022-03-18T18:07:23Z","reason":"AtLeastOneEndpointAvailable"},{"type":"NoWarnings","status":"True","lastTransitionTime":"2022-03-18T18:06:25Z","reason":"NoWarnings"},{"type":"ReconcileSuccess","status":"True","lastTransitionTime":"2022-03-18T18:07:24Z","reason":"Success","message":"Finish reconciling"}],"defaultUser":{"secretReference":{"name":"rabbitmq-cluster-default-user","namespace":"default","keys":{"password":"password","username":"username"}},"serviceReference":{"name":"rabbitmq-cluster","namespace":"default"}}}}
2022/03/18 18:07:31 learn_server.go:238: [SIEVE-BEFORE-RECONCILE]	github.com/rabbitmq/cluster-operator/controllers.(*RabbitmqClusterReconciler)	9
2022/03/18 18:07:31 learn_server.go:289: [SIEVE-AFTER-HEAR]	22
2022/03/18 18:07:31 learn_server.go:291: [SIEVE-AFTER-READ]	Get	true	rabbitmqcluster	default	rabbitmq-cluster	github.com/rabbitmq/cluster-operator/controllers.(*RabbitmqClusterReconciler)	NoError	{"kind":"RabbitmqCluster","apiVersion":"rabbitmq.com/v1beta1","metadata":{"name":"rabbitmq-cluster","namespace":"default","selfLink":"/apis/rabbitmq.com/v1beta1/namespaces/default/rabbitmqclusters/rabbitmq-cluster","uid":"3ecefa8a-1bec-48a7-9af4-dd0df3339101","resourceVersion":"1440","generation":3,"creationTimestamp":"2022-03-18T18:06:25Z","annotations":{"kubectl.kubernetes.io/last-applied-configuration":"{\"apiVersion\":\"rabbitmq.com/v1beta1\",\"kind\":\"RabbitmqCluster\",\"metadata\":{\"annotations\":{},\"name\":\"rabbitmq-cluster\",\"namespace\":\"default\"},\"spec\":{\"persistence\":{\"storage\":\"10Gi\"},\"replicas\":1}}\n"},"finalizers":["deletion.finalizers.rabbitmqclusters.rabbitmq.com"],"managedFields":[{"manager":"kubectl-client-side-apply","operation":"Update","apiVersion":"rabbitmq.com/v1beta1","time":"2022-03-18T18:06:25Z","fieldsType":"FieldsV1","fieldsV1":{"f:metadata":{"f:annotations":{".":{},"f:kubectl.kubernetes.io/last-applied-configuration":{}}},"f:spec":{".":{},"f:image":{},"f:persistence":{},"f:replicas":{},"f:resources":{".":{},"f:limits":{".":{},"f:memory":{}},"f:requests":{".":{},"f:memory":{}}},"f:service":{".":{},"f:type":{}},"f:terminationGracePeriodSeconds":{}}}},{"manager":"manager","operation":"Update","apiVersion":"rabbitmq.com/v1beta1","time":"2022-03-18T18:07:24Z","fieldsType":"FieldsV1","fieldsV1":{"f:metadata":{"f:finalizers":{}},"f:spec":{"f:override":{},"f:rabbitmq":{},"f:resources":{"f:limits":{"f:cpu":{}},"f:requests":{"f:cpu":{}}},"f:tls":{}},"f:status":{".":{},"f:conditions":{},"f:defaultUser":{".":{},"f:secretReference":{".":{},"f:keys":{".":{},"f:password":{},"f:username":{}},"f:name":{},"f:namespace":{}},"f:serviceReference":{".":{},"f:name":{},"f:namespace":{}}}}}},{"manager":"kubectl-patch","operation":"Update","apiVersion":"rabbitmq.com/v1beta1","time":"2022-03-18T18:07:31Z","fieldsType":"FieldsV1","fieldsV1":{"f:spec":{"f:persistence":{"f:storage":{}}}}}]},"spec":{"replicas":1,"image":"rabbitmq:3.8.12-management","service":{"type":"ClusterIP"},"persistence":{"storage":"15Gi"},"resources":{"limits":{"cpu":"2","memory":"2Gi"},"requests":{"cpu":"1","memory":"2Gi"}},"rabbitmq":{},"tls":{},"override":{},"terminationGracePeriodSeconds":604800},"status":{"conditions":[{"type":"AllReplicasReady","status":"True","lastTransitionTime":"2022-03-18T18:07:23Z","reason":"AllPodsAreReady"},{"type":"ClusterAvailable","status":"True","lastTransitionTime":"2022-03-18T18:07:23Z","reason":"AtLeastOneEndpointAvailable"},{"type":"NoWarnings","status":"True","lastTransitionTime":"2022-03-18T18:06:25Z","reason":"NoWarnings"},{"type":"ReconcileSuccess","status":"True","lastTransitionTime":"2022-03-18T18:07:24Z","reason":"Success","message":"Finish reconciling"}],"defaultUser":{"secretReference":{"name":"rabbitmq-cluster-default-user","namespace":"default","keys":{"password":"password","username":"username"}},"serviceReference":{"name":"rabbitmq-cluster","namespace":"default"}}}}
2022/03/18 18:07:31 learn_server.go:291: [SIEVE-AFTER-READ]	Get	true	statefulset	default	rabbitmq-cluster-server	github.com/rabbitmq/cluster-operator/controllers.(*RabbitmqClusterReconciler)	NoError	{"kind":"StatefulSet","apiVersion":"apps/v1","metadata":{"name":"rabbitmq-cluster-server","namespace":"default","selfLink":"/apis/apps/v1/namespaces/default/statefulsets/rabbitmq-cluster-server","uid":"f2f07f3e-b500-4c48-a5de-8db7eaf37b9a","resourceVersion":"1409","generation":1,"creationTimestamp":"2022-03-18T18:06:25Z","labels":{"app.kubernetes.io/component":"rabbitmq","app.kubernetes.io/name":"rabbitmq-cluster","app.kubernetes.io/part-of":"rabbitmq"},"ownerReferences":[{"apiVersion":"rabbitmq.com/v1beta1","kind":"RabbitmqCluster","name":"rabbitmq-cluster","uid":"3ecefa8a-1bec-48a7-9af4-dd0df3339101","controller":true,"blockOwnerDeletion":true}],"managedFields":[{"manager":"manager","operation":"Update","apiVersion":"apps/v1","time":"2022-03-18T18:06:25Z","fieldsType":"FieldsV1","fieldsV1":{"f:metadata":{"f:labels":{".":{},"f:app.kubernetes.io/component":{},"f:app.kubernetes.io/name":{},"f:app.kubernetes.io/part-of":{}},"f:ownerReferences":{".":{},"k:{\"uid\":\"3ecefa8a-1bec-48a7-9af4-dd0df3339101\"}":{".":{},"f:apiVersion":{},"f:blockOwnerDeletion":{},"f:controller":{},"f:kind":{},"f:name":{},"f:uid":{}}}},"f:spec":{"f:podManagementPolicy":{},"f:replicas":{},"f:revisionHistoryLimit":{},"f:selector":{"f:matchLabels":{".":{},"f:app.kubernetes.io/name":{}}},"f:serviceName":{},"f:template":{"f:metadata":{"f:annotations":{".":{},"f:prometheus.io/port":{},"f:prometheus.io/scrape":{}},"f:labels":{".":{},"f:app.kubernetes.io/component":{},"f:app.kubernetes.io/name":{},"f:app.kubernetes.io/part-of":{}}},"f:spec":{"f:automountServiceAccountToken":{},"f:containers":{"k:{\"name\":\"rabbitmq\"}":{".":{},"f:env":{".":{},"k:{\"name\":\"K8S_HOSTNAME_SUFFIX\"}":{".":{},"f:name":{},"f:value":{}},"k:{\"name\":\"K8S_SERVICE_NAME\"}":{".":{},"f:name":{},"f:value":{}},"k:{\"name\":\"MY_POD_NAME\"}":{".":{},"f:name":{},"f:valueFrom":{".":{},"f:fieldRef":{".":{},"f:apiVersion":{},"f:fieldPath":{}}}},"k:{\"name\":\"MY_POD_NAMESPACE\"}":{".":{},"f:name":{},"f:valueFrom":{".":{},"f:fieldRef":{".":{},"f:apiVersion":{},"f:fieldPath":{}}}},"k:{\"name\":\"RABBITMQ_ENABLED_PLUGINS_FILE\"}":{".":{},"f:name":{},"f:value":{}},"k:{\"name\":\"RABBITMQ_NODENAME\"}":{".":{},"f:name":{},"f:value":{}},"k:{\"name\":\"RABBITMQ_USE_LONGNAME\"}":{".":{},"f:name":{},"f:value":{}}},"f:image":{},"f:imagePullPolicy":{},"f:lifecycle":{".":{},"f:preStop":{".":{},"f:exec":{".":{},"f:command":{}}}},"f:name":{},"f:ports":{".":{},"k:{\"containerPort\":4369,\"protocol\":\"TCP\"}":{".":{},"f:containerPort":{},"f:name":{},"f:protocol":{}},"k:{\"containerPort\":5672,\"protocol\":\"TCP\"}":{".":{},"f:containerPort":{},"f:name":{},"f:protocol":{}},"k:{\"containerPort\":15672,\"protocol\":\"TCP\"}":{".":{},"f:containerPort":{},"f:name":{},"f:protocol":{}},"k:{\"containerPort\":15692,\"protocol\":\"TCP\"}":{".":{},"f:containerPort":{},"f:name":{},"f:protocol":{}}},"f:readinessProbe":{".":{},"f:failureThreshold":{},"f:initialDelaySeconds":{},"f:periodSeconds":{},"f:successThreshold":{},"f:tcpSocket":{".":{},"f:port":{}},"f:timeoutSeconds":{}},"f:resources":{".":{},"f:limits":{".":{},"f:cpu":{},"f:memory":{}},"f:requests":{".":{},"f:cpu":{},"f:memory":{}}},"f:terminationMessagePath":{},"f:terminationMessagePolicy":{},"f:volumeMounts":{".":{},"k:{\"mountPath\":\"/etc/pod-info/\"}":{".":{},"f:mountPath":{},"f:name":{}},"k:{\"mountPath\":\"/etc/rabbitmq/conf.d/10-operatorDefaults.conf\"}":{".":{},"f:mountPath":{},"f:name":{},"f:subPath":{}},"k:{\"mountPath\":\"/etc/rabbitmq/conf.d/11-default_user.conf\"}":{".":{},"f:mountPath":{},"f:name":{},"f:subPath":{}},"k:{\"mountPath\":\"/etc/rabbitmq/conf.d/90-userDefinedConfiguration.conf\"}":{".":{},"f:mountPath":{},"f:name":{},"f:subPath":{}},"k:{\"mountPath\":\"/operator\"}":{".":{},"f:mountPath":{},"f:name":{}},"k:{\"mountPath\":\"/var/lib/rabbitmq/\"}":{".":{},"f:mountPath":{},"f:name":{}},"k:{\"mountPath\":\"/var/lib/rabbitmq/mnesia/\"}":{".":{},"f:mountPath":{},"f:name":{}}}}},"f:dnsPolicy":{},"f:initContainers":{".":{},"k:{\"name\":\"setup-container\"}":{".":{},"f:command":{},"f:image":{},"f:imagePullPolicy":{},"f:name":{},"f:resources":{".":{},"f:limits":{".":{},"f:cpu":{},"f:memory":{}},"f:requests":{".":{},"f:cpu":{},"f:memory":{}}},"f:securityContext":{".":{},"f:capabilities":{".":{},"f:drop":{}},"f:runAsUser":{}},"f:terminationMessagePath":{},"f:terminationMessagePolicy":{},"f:volumeMounts":{".":{},"k:{\"mountPath\":\"/operator\"}":{".":{},"f:mountPath":{},"f:name":{}},"k:{\"mountPath\":\"/tmp/default_user.conf\"}":{".":{},"f:mountPath":{},"f:name":{},"f:subPath":{}},"k:{\"mountPath\":\"/tmp/erlang-cookie-secret/\"}":{".":{},"f:mountPath":{},"f:name":{}},"k:{\"mountPath\":\"/tmp/rabbitmq-plugins/\"}":{".":{},"f:mountPath":{},"f:name":{}},"k:{\"mountPath\":\"/var/lib/rabbitmq/\"}":{".":{},"f:mountPath":{},"f:name":{}},"k:{\"mountPath\":\"/var/lib/rabbitmq/mnesia/\"}":{".":{},"f:mountPath":{},"f:name":{}}}}},"f:restartPolicy":{},"f:schedulerName":{},"f:securityContext":{".":{},"f:fsGroup":{},"f:runAsGroup":{},"f:runAsUser":{}},"f:serviceAccount":{},"f:serviceAccountName":{},"f:terminationGracePeriodSeconds":{},"f:topologySpreadConstraints":{".":{},"k:{\"topologyKey\":\"topology.kubernetes.io/zone\",\"whenUnsatisfiable\":\"ScheduleAnyway\"}":{".":{},"f:labelSelector":{".":{},"f:matchLabels":{".":{},"f:app.kubernetes.io/name":{}}},"f:maxSkew":{},"f:topologyKey":{},"f:whenUnsatisfiable":{}}},"f:volumes":{".":{},"k:{\"name\":\"erlang-cookie-secret\"}":{".":{},"f:name":{},"f:secret":{".":{},"f:defaultMode":{},"f:secretName":{}}},"k:{\"name\":\"plugins-conf\"}":{".":{},"f:configMap":{".":{},"f:defaultMode":{},"f:name":{}},"f:name":{}},"k:{\"name\":\"pod-info\"}":{".":{},"f:downwardAPI":{".":{},"f:defaultMode":{},"f:items":{}},"f:name":{}},"k:{\"name\":\"rabbitmq-confd\"}":{".":{},"f:name":{},"f:projected":{".":{},"f:defaultMode":{},"f:sources":{}}},"k:{\"name\":\"rabbitmq-erlang-cookie\"}":{".":{},"f:emptyDir":{},"f:name":{}},"k:{\"name\":\"rabbitmq-plugins\"}":{".":{},"f:emptyDir":{},"f:name":{}}}}},"f:updateStrategy":{"f:rollingUpdate":{".":{},"f:partition":{}},"f:type":{}},"f:volumeClaimTemplates":{}}}},{"manager":"kube-controller-manager","operation":"Update","apiVersion":"apps/v1","time":"2022-03-18T18:07:23Z","fieldsType":"FieldsV1","fieldsV1":{"f:status":{"f:collisionCount":{},"f:currentReplicas":{},"f:currentRevision":{},"f:observedGeneration":{},"f:readyReplicas":{},"f:replicas":{},"f:updateRevision":{},"f:updatedReplicas":{}}}}]},"spec":{"replicas":1,"selector":{"matchLabels":{"app.kubernetes.io/name":"rabbitmq-cluster"}},"template":{"metadata":{"creationTimestamp":null,"labels":{"app.kubernetes.io/component":"rabbitmq","app.kubernetes.io/name":"rabbitmq-cluster","app.kubernetes.io/part-of":"rabbitmq"},"annotations":{"prometheus.io/port":"15692","prometheus.io/scrape":"true"}},"spec":{"volumes":[{"name":"plugins-conf","configMap":{"name":"rabbitmq-cluster-plugins-conf","defaultMode":420}},{"name":"rabbitmq-confd","projected":{"sources":[{"secret":{"name":"rabbitmq-cluster-default-user","items":[{"key":"default_user.conf","path":"default_user.conf"}]}},{"configMap":{"name":"rabbitmq-cluster-server-conf","items":[{"key":"operatorDefaults.conf","path":"operatorDefaults.conf"},{"key":"userDefinedConfiguration.conf","path":"userDefinedConfiguration.conf"}]}}],"defaultMode":420}},{"name":"rabbitmq-erlang-cookie","emptyDir":{}},{"name":"erlang-cookie-secret","secret":{"secretName":"rabbitmq-cluster-erlang-cookie","defaultMode":420}},{"name":"rabbitmq-plugins","emptyDir":{}},{"name":"pod-info","downwardAPI":{"items":[{"path":"skipPreStopChecks","fieldRef":{"apiVersion":"v1","fieldPath":"metadata.labels['skipPreStopChecks']"}}],"defaultMode":420}}],"initContainers":[{"name":"setup-container","image":"rabbitmq:3.8.12-management","command":["sh","-c","cp /tmp/erlang-cookie-secret/.erlang.cookie /var/lib/rabbitmq/.erlang.cookie \u0026\u0026 chown 999:999 /var/lib/rabbitmq/.erlang.cookie \u0026\u0026 chmod 600 /var/lib/rabbitmq/.erlang.cookie ; cp /tmp/rabbitmq-plugins/enabled_plugins /operator/enabled_plugins \u0026\u0026 chown 999:999 /operator/enabled_plugins ; chown 999:999 /var/lib/rabbitmq/mnesia/ ; echo '[default]' \u003e /var/lib/rabbitmq/.rabbitmqadmin.conf \u0026\u0026 sed -e 's/default_user/username/' -e 's/default_pass/password/' /tmp/default_user.conf \u003e\u003e /var/lib/rabbitmq/.rabbitmqadmin.conf \u0026\u0026 chown 999:999 /var/lib/rabbitmq/.rabbitmqadmin.conf \u0026\u0026 chmod 600 /var/lib/rabbitmq/.rabbitmqadmin.conf"],"resources":{"limits":{"cpu":"100m","memory":"500Mi"},"requests":{"cpu":"100m","memory":"500Mi"}},"volumeMounts":[{"name":"plugins-conf","mountPath":"/tmp/rabbitmq-plugins/"},{"name":"rabbitmq-erlang-cookie","mountPath":"/var/lib/rabbitmq/"},{"name":"erlang-cookie-secret","mountPath":"/tmp/erlang-cookie-secret/"},{"name":"rabbitmq-plugins","mountPath":"/operator"},{"name":"persistence","mountPath":"/var/lib/rabbitmq/mnesia/"},{"name":"rabbitmq-confd","mountPath":"/tmp/default_user.conf","subPath":"default_user.conf"}],"terminationMessagePath":"/dev/termination-log","terminationMessagePolicy":"File","imagePullPolicy":"IfNotPresent","securityContext":{"capabilities":{"drop":["FSETID","KILL","SETGID","SETUID","SETPCAP","NET_BIND_SERVICE","NET_RAW","SYS_CHROOT","MKNOD","AUDIT_WRITE","SETFCAP"]},"runAsUser":0}}],"containers":[{"name":"rabbitmq","image":"rabbitmq:3.8.12-management","ports":[{"name":"epmd","containerPort":4369,"protocol":"TCP"},{"name":"amqp","containerPort":5672,"protocol":"TCP"},{"name":"management","containerPort":15672,"protocol":"TCP"},{"name":"prometheus","containerPort":15692,"protocol":"TCP"}],"env":[{"name":"MY_POD_NAME","valueFrom":{"fieldRef":{"apiVersion":"v1","fieldPath":"metadata.name"}}},{"name":"MY_POD_NAMESPACE","valueFrom":{"fieldRef":{"apiVersion":"v1","fieldPath":"metadata.namespace"}}},{"name":"RABBITMQ_ENABLED_PLUGINS_FILE","value":"/operator/enabled_plugins"},{"name":"K8S_SERVICE_NAME","value":"rabbitmq-cluster-nodes"},{"name":"RABBITMQ_USE_LONGNAME","value":"true"},{"name":"RABBITMQ_NODENAME","value":"rabbit@$(MY_POD_NAME).$(K8S_SERVICE_NAME).$(MY_POD_NAMESPACE)"},{"name":"K8S_HOSTNAME_SUFFIX","value":".$(K8S_SERVICE_NAME).$(MY_POD_NAMESPACE)"}],"resources":{"limits":{"cpu":"2","memory":"2Gi"},"requests":{"cpu":"1","memory":"2Gi"}},"volumeMounts":[{"name":"rabbitmq-erlang-cookie","mountPath":"/var/lib/rabbitmq/"},{"name":"persistence","mountPath":"/var/lib/rabbitmq/mnesia/"},{"name":"rabbitmq-plugins","mountPath":"/operator"},{"name":"rabbitmq-confd","mountPath":"/etc/rabbitmq/conf.d/10-operatorDefaults.conf","subPath":"operatorDefaults.conf"},{"name":"rabbitmq-confd","mountPath":"/etc/rabbitmq/conf.d/11-default_user.conf","subPath":"default_user.conf"},{"name":"rabbitmq-confd","mountPath":"/etc/rabbitmq/conf.d/90-userDefinedConfiguration.conf","subPath":"userDefinedConfiguration.conf"},{"name":"pod-info","mountPath":"/etc/pod-info/"}],"readinessProbe":{"tcpSocket":{"port":"amqp"},"initialDelaySeconds":10,"timeoutSeconds":5,"periodSeconds":10,"successThreshold":1,"failureThreshold":3},"lifecycle":{"preStop":{"exec":{"command":["/bin/bash","-c","if [ ! -z \"$(cat /etc/pod-info/skipPreStopChecks)\" ]; then exit 0; fi; rabbitmq-upgrade await_online_quorum_plus_one -t 604800; rabbitmq-upgrade await_online_synchronized_mirror -t 604800; rabbitmq-upgrade drain -t 604800"]}}},"terminationMessagePath":"/dev/termination-log","terminationMessagePolicy":"File","imagePullPolicy":"IfNotPresent"}],"restartPolicy":"Always","terminationGracePeriodSeconds":604800,"dnsPolicy":"ClusterFirst","serviceAccountName":"rabbitmq-cluster-server","serviceAccount":"rabbitmq-cluster-server","automountServiceAccountToken":true,"securityContext":{"runAsUser":999,"runAsGroup":999,"fsGroup":999},"schedulerName":"default-scheduler","topologySpreadConstraints":[{"maxSkew":1,"topologyKey":"topology.kubernetes.io/zone","whenUnsatisfiable":"ScheduleAnyway","labelSelector":{"matchLabels":{"app.kubernetes.io/name":"rabbitmq-cluster"}}}]}},"volumeClaimTemplates":[{"metadata":{"name":"persistence","namespace":"default","creationTimestamp":null,"labels":{"app.kubernetes.io/component":"rabbitmq","app.kubernetes.io/name":"rabbitmq-cluster","app.kubernetes.io/part-of":"rabbitmq"},"ownerReferences":[{"apiVersion":"rabbitmq.com/v1beta1","kind":"RabbitmqCluster","name":"rabbitmq-cluster","uid":"3ecefa8a-1bec-48a7-9af4-dd0df3339101","controller":true,"blockOwnerDeletion":false}]},"spec":{"accessModes":["ReadWriteOnce"],"resources":{"requests":{"storage":"10Gi"}},"volumeMode":"Filesystem"},"status":{"phase":"Pending"}}],"serviceName":"rabbitmq-cluster-nodes","podManagementPolicy":"Parallel","updateStrategy":{"type":"RollingUpdate","rollingUpdate":{"partition":0}},"revisionHistoryLimit":10},"status":{"observedGeneration":1,"replicas":1,"readyReplicas":1,"currentReplicas":1,"updatedReplicas":1,"currentRevision":"rabbitmq-cluster-server-5f8b8665fb","updateRevision":"rabbitmq-cluster-server-5f8b8665fb","collisionCount":0}}
2022/03/18 18:07:31 learn_server.go:291: [SIEVE-AFTER-READ]	Get	true	endpoints	default	rabbitmq-cluster	github.com/rabbitmq/cluster-operator/controllers.(*RabbitmqClusterReconciler)	NoError	{"kind":"Endpoints","apiVersion":"v1","metadata":{"name":"rabbitmq-cluster","namespace":"default","selfLink":"/api/v1/namespaces/default/endpoints/rabbitmq-cluster","uid":"eeba9576-0362-4e74-aafd-71e4ffe98d25","resourceVersion":"1402","creationTimestamp":"2022-03-18T18:06:25Z","labels":{"app.kubernetes.io/component":"rabbitmq","app.kubernetes.io/name":"rabbitmq-cluster","app.kubernetes.io/part-of":"rabbitmq"},"annotations":{"endpoints.kubernetes.io/last-change-trigger-time":"2022-03-18T18:07:23Z"},"managedFields":[{"manager":"kube-controller-manager","operation":"Update","apiVersion":"v1","time":"2022-03-18T18:07:23Z","fieldsType":"FieldsV1","fieldsV1":{"f:metadata":{"f:annotations":{".":{},"f:endpoints.kubernetes.io/last-change-trigger-time":{}},"f:labels":{".":{},"f:app.kubernetes.io/component":{},"f:app.kubernetes.io/name":{},"f:app.kubernetes.io/part-of":{}}},"f:subsets":{}}}]},"subsets":[{"addresses":[{"ip":"10.244.1.4","nodeName":"kind-worker","targetRef":{"kind":"Pod","namespace":"default","name":"rabbitmq-cluster-server-0","uid":"cbaba199-5faf-480a-81e8-051ce2cc79e6","resourceVersion":"1399"}}],"ports":[{"name":"amqp","port":5672,"protocol":"TCP"},{"name":"management","port":15672,"protocol":"TCP"}]}]}
2022/03/18 18:07:31 learn_server.go:291: [SIEVE-AFTER-READ]	Get	true	statefulset	default	rabbitmq-cluster-server	github.com/rabbitmq/cluster-operator/controllers.(*RabbitmqClusterReconciler)	NoError	{"kind":"StatefulSet","apiVersion":"apps/v1","metadata":{"name":"rabbitmq-cluster-server","namespace":"default","selfLink":"/apis/apps/v1/namespaces/default/statefulsets/rabbitmq-cluster-server","uid":"f2f07f3e-b500-4c48-a5de-8db7eaf37b9a","resourceVersion":"1409","generation":1,"creationTimestamp":"2022-03-18T18:06:25Z","labels":{"app.kubernetes.io/component":"rabbitmq","app.kubernetes.io/name":"rabbitmq-cluster","app.kubernetes.io/part-of":"rabbitmq"},"ownerReferences":[{"apiVersion":"rabbitmq.com/v1beta1","kind":"RabbitmqCluster","name":"rabbitmq-cluster","uid":"3ecefa8a-1bec-48a7-9af4-dd0df3339101","controller":true,"blockOwnerDeletion":true}],"managedFields":[{"manager":"manager","operation":"Update","apiVersion":"apps/v1","time":"2022-03-18T18:06:25Z","fieldsType":"FieldsV1","fieldsV1":{"f:metadata":{"f:labels":{".":{},"f:app.kubernetes.io/component":{},"f:app.kubernetes.io/name":{},"f:app.kubernetes.io/part-of":{}},"f:ownerReferences":{".":{},"k:{\"uid\":\"3ecefa8a-1bec-48a7-9af4-dd0df3339101\"}":{".":{},"f:apiVersion":{},"f:blockOwnerDeletion":{},"f:controller":{},"f:kind":{},"f:name":{},"f:uid":{}}}},"f:spec":{"f:podManagementPolicy":{},"f:replicas":{},"f:revisionHistoryLimit":{},"f:selector":{"f:matchLabels":{".":{},"f:app.kubernetes.io/name":{}}},"f:serviceName":{},"f:template":{"f:metadata":{"f:annotations":{".":{},"f:prometheus.io/port":{},"f:prometheus.io/scrape":{}},"f:labels":{".":{},"f:app.kubernetes.io/component":{},"f:app.kubernetes.io/name":{},"f:app.kubernetes.io/part-of":{}}},"f:spec":{"f:automountServiceAccountToken":{},"f:containers":{"k:{\"name\":\"rabbitmq\"}":{".":{},"f:env":{".":{},"k:{\"name\":\"K8S_HOSTNAME_SUFFIX\"}":{".":{},"f:name":{},"f:value":{}},"k:{\"name\":\"K8S_SERVICE_NAME\"}":{".":{},"f:name":{},"f:value":{}},"k:{\"name\":\"MY_POD_NAME\"}":{".":{},"f:name":{},"f:valueFrom":{".":{},"f:fieldRef":{".":{},"f:apiVersion":{},"f:fieldPath":{}}}},"k:{\"name\":\"MY_POD_NAMESPACE\"}":{".":{},"f:name":{},"f:valueFrom":{".":{},"f:fieldRef":{".":{},"f:apiVersion":{},"f:fieldPath":{}}}},"k:{\"name\":\"RABBITMQ_ENABLED_PLUGINS_FILE\"}":{".":{},"f:name":{},"f:value":{}},"k:{\"name\":\"RABBITMQ_NODENAME\"}":{".":{},"f:name":{},"f:value":{}},"k:{\"name\":\"RABBITMQ_USE_LONGNAME\"}":{".":{},"f:name":{},"f:value":{}}},"f:image":{},"f:imagePullPolicy":{},"f:lifecycle":{".":{},"f:preStop":{".":{},"f:exec":{".":{},"f:command":{}}}},"f:name":{},"f:ports":{".":{},"k:{\"containerPort\":4369,\"protocol\":\"TCP\"}":{".":{},"f:containerPort":{},"f:name":{},"f:protocol":{}},"k:{\"containerPort\":5672,\"protocol\":\"TCP\"}":{".":{},"f:containerPort":{},"f:name":{},"f:protocol":{}},"k:{\"containerPort\":15672,\"protocol\":\"TCP\"}":{".":{},"f:containerPort":{},"f:name":{},"f:protocol":{}},"k:{\"containerPort\":15692,\"protocol\":\"TCP\"}":{".":{},"f:containerPort":{},"f:name":{},"f:protocol":{}}},"f:readinessProbe":{".":{},"f:failureThreshold":{},"f:initialDelaySeconds":{},"f:periodSeconds":{},"f:successThreshold":{},"f:tcpSocket":{".":{},"f:port":{}},"f:timeoutSeconds":{}},"f:resources":{".":{},"f:limits":{".":{},"f:cpu":{},"f:memory":{}},"f:requests":{".":{},"f:cpu":{},"f:memory":{}}},"f:terminationMessagePath":{},"f:terminationMessagePolicy":{},"f:volumeMounts":{".":{},"k:{\"mountPath\":\"/etc/pod-info/\"}":{".":{},"f:mountPath":{},"f:name":{}},"k:{\"mountPath\":\"/etc/rabbitmq/conf.d/10-operatorDefaults.conf\"}":{".":{},"f:mountPath":{},"f:name":{},"f:subPath":{}},"k:{\"mountPath\":\"/etc/rabbitmq/conf.d/11-default_user.conf\"}":{".":{},"f:mountPath":{},"f:name":{},"f:subPath":{}},"k:{\"mountPath\":\"/etc/rabbitmq/conf.d/90-userDefinedConfiguration.conf\"}":{".":{},"f:mountPath":{},"f:name":{},"f:subPath":{}},"k:{\"mountPath\":\"/operator\"}":{".":{},"f:mountPath":{},"f:name":{}},"k:{\"mountPath\":\"/var/lib/rabbitmq/\"}":{".":{},"f:mountPath":{},"f:name":{}},"k:{\"mountPath\":\"/var/lib/rabbitmq/mnesia/\"}":{".":{},"f:mountPath":{},"f:name":{}}}}},"f:dnsPolicy":{},"f:initContainers":{".":{},"k:{\"name\":\"setup-container\"}":{".":{},"f:command":{},"f:image":{},"f:imagePullPolicy":{},"f:name":{},"f:resources":{".":{},"f:limits":{".":{},"f:cpu":{},"f:memory":{}},"f:requests":{".":{},"f:cpu":{},"f:memory":{}}},"f:securityContext":{".":{},"f:capabilities":{".":{},"f:drop":{}},"f:runAsUser":{}},"f:terminationMessagePath":{},"f:terminationMessagePolicy":{},"f:volumeMounts":{".":{},"k:{\"mountPath\":\"/operator\"}":{".":{},"f:mountPath":{},"f:name":{}},"k:{\"mountPath\":\"/tmp/default_user.conf\"}":{".":{},"f:mountPath":{},"f:name":{},"f:subPath":{}},"k:{\"mountPath\":\"/tmp/erlang-cookie-secret/\"}":{".":{},"f:mountPath":{},"f:name":{}},"k:{\"mountPath\":\"/tmp/rabbitmq-plugins/\"}":{".":{},"f:mountPath":{},"f:name":{}},"k:{\"mountPath\":\"/var/lib/rabbitmq/\"}":{".":{},"f:mountPath":{},"f:name":{}},"k:{\"mountPath\":\"/var/lib/rabbitmq/mnesia/\"}":{".":{},"f:mountPath":{},"f:name":{}}}}},"f:restartPolicy":{},"f:schedulerName":{},"f:securityContext":{".":{},"f:fsGroup":{},"f:runAsGroup":{},"f:runAsUser":{}},"f:serviceAccount":{},"f:serviceAccountName":{},"f:terminationGracePeriodSeconds":{},"f:topologySpreadConstraints":{".":{},"k:{\"topologyKey\":\"topology.kubernetes.io/zone\",\"whenUnsatisfiable\":\"ScheduleAnyway\"}":{".":{},"f:labelSelector":{".":{},"f:matchLabels":{".":{},"f:app.kubernetes.io/name":{}}},"f:maxSkew":{},"f:topologyKey":{},"f:whenUnsatisfiable":{}}},"f:volumes":{".":{},"k:{\"name\":\"erlang-cookie-secret\"}":{".":{},"f:name":{},"f:secret":{".":{},"f:defaultMode":{},"f:secretName":{}}},"k:{\"name\":\"plugins-conf\"}":{".":{},"f:configMap":{".":{},"f:defaultMode":{},"f:name":{}},"f:name":{}},"k:{\"name\":\"pod-info\"}":{".":{},"f:downwardAPI":{".":{},"f:defaultMode":{},"f:items":{}},"f:name":{}},"k:{\"name\":\"rabbitmq-confd\"}":{".":{},"f:name":{},"f:projected":{".":{},"f:defaultMode":{},"f:sources":{}}},"k:{\"name\":\"rabbitmq-erlang-cookie\"}":{".":{},"f:emptyDir":{},"f:name":{}},"k:{\"name\":\"rabbitmq-plugins\"}":{".":{},"f:emptyDir":{},"f:name":{}}}}},"f:updateStrategy":{"f:rollingUpdate":{".":{},"f:partition":{}},"f:type":{}},"f:volumeClaimTemplates":{}}}},{"manager":"kube-controller-manager","operation":"Update","apiVersion":"apps/v1","time":"2022-03-18T18:07:23Z","fieldsType":"FieldsV1","fieldsV1":{"f:status":{"f:collisionCount":{},"f:currentReplicas":{},"f:currentRevision":{},"f:observedGeneration":{},"f:readyReplicas":{},"f:replicas":{},"f:updateRevision":{},"f:updatedReplicas":{}}}}]},"spec":{"replicas":1,"selector":{"matchLabels":{"app.kubernetes.io/name":"rabbitmq-cluster"}},"template":{"metadata":{"creationTimestamp":null,"labels":{"app.kubernetes.io/component":"rabbitmq","app.kubernetes.io/name":"rabbitmq-cluster","app.kubernetes.io/part-of":"rabbitmq"},"annotations":{"prometheus.io/port":"15692","prometheus.io/scrape":"true"}},"spec":{"volumes":[{"name":"plugins-conf","configMap":{"name":"rabbitmq-cluster-plugins-conf","defaultMode":420}},{"name":"rabbitmq-confd","projected":{"sources":[{"secret":{"name":"rabbitmq-cluster-default-user","items":[{"key":"default_user.conf","path":"default_user.conf"}]}},{"configMap":{"name":"rabbitmq-cluster-server-conf","items":[{"key":"operatorDefaults.conf","path":"operatorDefaults.conf"},{"key":"userDefinedConfiguration.conf","path":"userDefinedConfiguration.conf"}]}}],"defaultMode":420}},{"name":"rabbitmq-erlang-cookie","emptyDir":{}},{"name":"erlang-cookie-secret","secret":{"secretName":"rabbitmq-cluster-erlang-cookie","defaultMode":420}},{"name":"rabbitmq-plugins","emptyDir":{}},{"name":"pod-info","downwardAPI":{"items":[{"path":"skipPreStopChecks","fieldRef":{"apiVersion":"v1","fieldPath":"metadata.labels['skipPreStopChecks']"}}],"defaultMode":420}}],"initContainers":[{"name":"setup-container","image":"rabbitmq:3.8.12-management","command":["sh","-c","cp /tmp/erlang-cookie-secret/.erlang.cookie /var/lib/rabbitmq/.erlang.cookie \u0026\u0026 chown 999:999 /var/lib/rabbitmq/.erlang.cookie \u0026\u0026 chmod 600 /var/lib/rabbitmq/.erlang.cookie ; cp /tmp/rabbitmq-plugins/enabled_plugins /operator/enabled_plugins \u0026\u0026 chown 999:999 /operator/enabled_plugins ; chown 999:999 /var/lib/rabbitmq/mnesia/ ; echo '[default]' \u003e /var/lib/rabbitmq/.rabbitmqadmin.conf \u0026\u0026 sed -e 's/default_user/username/' -e 's/default_pass/password/' /tmp/default_user.conf \u003e\u003e /var/lib/rabbitmq/.rabbitmqadmin.conf \u0026\u0026 chown 999:999 /var/lib/rabbitmq/.rabbitmqadmin.conf \u0026\u0026 chmod 600 /var/lib/rabbitmq/.rabbitmqadmin.conf"],"resources":{"limits":{"cpu":"100m","memory":"500Mi"},"requests":{"cpu":"100m","memory":"500Mi"}},"volumeMounts":[{"name":"plugins-conf","mountPath":"/tmp/rabbitmq-plugins/"},{"name":"rabbitmq-erlang-cookie","mountPath":"/var/lib/rabbitmq/"},{"name":"erlang-cookie-secret","mountPath":"/tmp/erlang-cookie-secret/"},{"name":"rabbitmq-plugins","mountPath":"/operator"},{"name":"persistence","mountPath":"/var/lib/rabbitmq/mnesia/"},{"name":"rabbitmq-confd","mountPath":"/tmp/default_user.conf","subPath":"default_user.conf"}],"terminationMessagePath":"/dev/termination-log","terminationMessagePolicy":"File","imagePullPolicy":"IfNotPresent","securityContext":{"capabilities":{"drop":["FSETID","KILL","SETGID","SETUID","SETPCAP","NET_BIND_SERVICE","NET_RAW","SYS_CHROOT","MKNOD","AUDIT_WRITE","SETFCAP"]},"runAsUser":0}}],"containers":[{"name":"rabbitmq","image":"rabbitmq:3.8.12-management","ports":[{"name":"epmd","containerPort":4369,"protocol":"TCP"},{"name":"amqp","containerPort":5672,"protocol":"TCP"},{"name":"management","containerPort":15672,"protocol":"TCP"},{"name":"prometheus","containerPort":15692,"protocol":"TCP"}],"env":[{"name":"MY_POD_NAME","valueFrom":{"fieldRef":{"apiVersion":"v1","fieldPath":"metadata.name"}}},{"name":"MY_POD_NAMESPACE","valueFrom":{"fieldRef":{"apiVersion":"v1","fieldPath":"metadata.namespace"}}},{"name":"RABBITMQ_ENABLED_PLUGINS_FILE","value":"/operator/enabled_plugins"},{"name":"K8S_SERVICE_NAME","value":"rabbitmq-cluster-nodes"},{"name":"RABBITMQ_USE_LONGNAME","value":"true"},{"name":"RABBITMQ_NODENAME","value":"rabbit@$(MY_POD_NAME).$(K8S_SERVICE_NAME).$(MY_POD_NAMESPACE)"},{"name":"K8S_HOSTNAME_SUFFIX","value":".$(K8S_SERVICE_NAME).$(MY_POD_NAMESPACE)"}],"resources":{"limits":{"cpu":"2","memory":"2Gi"},"requests":{"cpu":"1","memory":"2Gi"}},"volumeMounts":[{"name":"rabbitmq-erlang-cookie","mountPath":"/var/lib/rabbitmq/"},{"name":"persistence","mountPath":"/var/lib/rabbitmq/mnesia/"},{"name":"rabbitmq-plugins","mountPath":"/operator"},{"name":"rabbitmq-confd","mountPath":"/etc/rabbitmq/conf.d/10-operatorDefaults.conf","subPath":"operatorDefaults.conf"},{"name":"rabbitmq-confd","mountPath":"/etc/rabbitmq/conf.d/11-default_user.conf","subPath":"default_user.conf"},{"name":"rabbitmq-confd","mountPath":"/etc/rabbitmq/conf.d/90-userDefinedConfiguration.conf","subPath":"userDefinedConfiguration.conf"},{"name":"pod-info","mountPath":"/etc/pod-info/"}],"readinessProbe":{"tcpSocket":{"port":"amqp"},"initialDelaySeconds":10,"timeoutSeconds":5,"periodSeconds":10,"successThreshold":1,"failureThreshold":3},"lifecycle":{"preStop":{"exec":{"command":["/bin/bash","-c","if [ ! -z \"$(cat /etc/pod-info/skipPreStopChecks)\" ]; then exit 0; fi; rabbitmq-upgrade await_online_quorum_plus_one -t 604800; rabbitmq-upgrade await_online_synchronized_mirror -t 604800; rabbitmq-upgrade drain -t 604800"]}}},"terminationMessagePath":"/dev/termination-log","terminationMessagePolicy":"File","imagePullPolicy":"IfNotPresent"}],"restartPolicy":"Always","terminationGracePeriodSeconds":604800,"dnsPolicy":"ClusterFirst","serviceAccountName":"rabbitmq-cluster-server","serviceAccount":"rabbitmq-cluster-server","automountServiceAccountToken":true,"securityContext":{"runAsUser":999,"runAsGroup":999,"fsGroup":999},"schedulerName":"default-scheduler","topologySpreadConstraints":[{"maxSkew":1,"topologyKey":"topology.kubernetes.io/zone","whenUnsatisfiable":"ScheduleAnyway","labelSelector":{"matchLabels":{"app.kubernetes.io/name":"rabbitmq-cluster"}}}]}},"volumeClaimTemplates":[{"metadata":{"name":"persistence","namespace":"default","creationTimestamp":null,"labels":{"app.kubernetes.io/component":"rabbitmq","app.kubernetes.io/name":"rabbitmq-cluster","app.kubernetes.io/part-of":"rabbitmq"},"ownerReferences":[{"apiVersion":"rabbitmq.com/v1beta1","kind":"RabbitmqCluster","name":"rabbitmq-cluster","uid":"3ecefa8a-1bec-48a7-9af4-dd0df3339101","controller":true,"blockOwnerDeletion":false}]},"spec":{"accessModes":["ReadWriteOnce"],"resources":{"requests":{"storage":"10Gi"}},"volumeMode":"Filesystem"},"status":{"phase":"Pending"}}],"serviceName":"rabbitmq-cluster-nodes","podManagementPolicy":"Parallel","updateStrategy":{"type":"RollingUpdate","rollingUpdate":{"partition":0}},"revisionHistoryLimit":10},"status":{"observedGeneration":1,"replicas":1,"readyReplicas":1,"currentReplicas":1,"updatedReplicas":1,"currentRevision":"rabbitmq-cluster-server-5f8b8665fb","updateRevision":"rabbitmq-cluster-server-5f8b8665fb","collisionCount":0}}
2022/03/18 18:07:31 learn_server.go:291: [SIEVE-AFTER-READ]	Get	true	service	default	rabbitmq-cluster-nodes	github.com/rabbitmq/cluster-operator/controllers.(*RabbitmqClusterReconciler)	NoError	{"kind":"Service","apiVersion":"v1","metadata":{"name":"rabbitmq-cluster-nodes","namespace":"default","selfLink":"/api/v1/namespaces/default/services/rabbitmq-cluster-nodes","uid":"f843e1c2-ced0-463d-87c1-0e127aaa2006","resourceVersion":"1080","creationTimestamp":"2022-03-18T18:06:25Z","labels":{"app.kubernetes.io/component":"rabbitmq","app.kubernetes.io/name":"rabbitmq-cluster","app.kubernetes.io/part-of":"rabbitmq"},"ownerReferences":[{"apiVersion":"rabbitmq.com/v1beta1","kind":"RabbitmqCluster","name":"rabbitmq-cluster","uid":"3ecefa8a-1bec-48a7-9af4-dd0df3339101","controller":true,"blockOwnerDeletion":true}],"managedFields":[{"manager":"manager","operation":"Update","apiVersion":"v1","time":"2022-03-18T18:06:25Z","fieldsType":"FieldsV1","fieldsV1":{"f:metadata":{"f:labels":{".":{},"f:app.kubernetes.io/component":{},"f:app.kubernetes.io/name":{},"f:app.kubernetes.io/part-of":{}},"f:ownerReferences":{".":{},"k:{\"uid\":\"3ecefa8a-1bec-48a7-9af4-dd0df3339101\"}":{".":{},"f:apiVersion":{},"f:blockOwnerDeletion":{},"f:controller":{},"f:kind":{},"f:name":{},"f:uid":{}}}},"f:spec":{"f:clusterIP":{},"f:ports":{".":{},"k:{\"port\":4369,\"protocol\":\"TCP\"}":{".":{},"f:name":{},"f:port":{},"f:protocol":{},"f:targetPort":{}},"k:{\"port\":25672,\"protocol\":\"TCP\"}":{".":{},"f:name":{},"f:port":{},"f:protocol":{},"f:targetPort":{}}},"f:publishNotReadyAddresses":{},"f:selector":{".":{},"f:app.kubernetes.io/name":{}},"f:sessionAffinity":{},"f:type":{}}}}]},"spec":{"ports":[{"name":"epmd","protocol":"TCP","port":4369,"targetPort":4369},{"name":"cluster-rpc","protocol":"TCP","port":25672,"targetPort":25672}],"selector":{"app.kubernetes.io/name":"rabbitmq-cluster"},"clusterIP":"None","type":"ClusterIP","sessionAffinity":"None","publishNotReadyAddresses":true},"status":{"loadBalancer":{}}}
2022/03/18 18:07:31 learn_server.go:291: [SIEVE-AFTER-READ]	Get	true	service	default	rabbitmq-cluster	github.com/rabbitmq/cluster-operator/controllers.(*RabbitmqClusterReconciler)	NoError	{"kind":"Service","apiVersion":"v1","metadata":{"name":"rabbitmq-cluster","namespace":"default","selfLink":"/api/v1/namespaces/default/services/rabbitmq-cluster","uid":"ae846a70-784e-49ca-99a0-2b0cefb93b46","resourceVersion":"1085","creationTimestamp":"2022-03-18T18:06:25Z","labels":{"app.kubernetes.io/component":"rabbitmq","app.kubernetes.io/name":"rabbitmq-cluster","app.kubernetes.io/part-of":"rabbitmq"},"ownerReferences":[{"apiVersion":"rabbitmq.com/v1beta1","kind":"RabbitmqCluster","name":"rabbitmq-cluster","uid":"3ecefa8a-1bec-48a7-9af4-dd0df3339101","controller":true,"blockOwnerDeletion":true}],"managedFields":[{"manager":"manager","operation":"Update","apiVersion":"v1","time":"2022-03-18T18:06:25Z","fieldsType":"FieldsV1","fieldsV1":{"f:metadata":{"f:labels":{".":{},"f:app.kubernetes.io/component":{},"f:app.kubernetes.io/name":{},"f:app.kubernetes.io/part-of":{}},"f:ownerReferences":{".":{},"k:{\"uid\":\"3ecefa8a-1bec-48a7-9af4-dd0df3339101\"}":{".":{},"f:apiVersion":{},"f:blockOwnerDeletion":{},"f:controller":{},"f:kind":{},"f:name":{},"f:uid":{}}}},"f:spec":{"f:ports":{".":{},"k:{\"port\":5672,\"protocol\":\"TCP\"}":{".":{},"f:name":{},"f:port":{},"f:protocol":{},"f:targetPort":{}},"k:{\"port\":15672,\"protocol\":\"TCP\"}":{".":{},"f:name":{},"f:port":{},"f:protocol":{},"f:targetPort":{}}},"f:selector":{".":{},"f:app.kubernetes.io/name":{}},"f:sessionAffinity":{},"f:type":{}}}}]},"spec":{"ports":[{"name":"amqp","protocol":"TCP","port":5672,"targetPort":5672},{"name":"management","protocol":"TCP","port":15672,"targetPort":15672}],"selector":{"app.kubernetes.io/name":"rabbitmq-cluster"},"clusterIP":"10.96.47.189","type":"ClusterIP","sessionAffinity":"None"},"status":{"loadBalancer":{}}}
2022/03/18 18:07:31 learn_server.go:291: [SIEVE-AFTER-READ]	Get	true	secret	default	rabbitmq-cluster-erlang-cookie	github.com/rabbitmq/cluster-operator/controllers.(*RabbitmqClusterReconciler)	NoError	{"kind":"Secret","apiVersion":"v1","metadata":{"name":"rabbitmq-cluster-erlang-cookie","namespace":"default","selfLink":"/api/v1/namespaces/default/secrets/rabbitmq-cluster-erlang-cookie","uid":"01d8d8ad-080a-4c3f-9d27-56616c53dd26","resourceVersion":"1088","creationTimestamp":"2022-03-18T18:06:25Z","labels":{"app.kubernetes.io/component":"rabbitmq","app.kubernetes.io/name":"rabbitmq-cluster","app.kubernetes.io/part-of":"rabbitmq"},"ownerReferences":[{"apiVersion":"rabbitmq.com/v1beta1","kind":"RabbitmqCluster","name":"rabbitmq-cluster","uid":"3ecefa8a-1bec-48a7-9af4-dd0df3339101","controller":true,"blockOwnerDeletion":true}],"managedFields":[{"manager":"manager","operation":"Update","apiVersion":"v1","time":"2022-03-18T18:06:25Z","fieldsType":"FieldsV1","fieldsV1":{"f:data":{".":{},"f:.erlang.cookie":{}},"f:metadata":{"f:labels":{".":{},"f:app.kubernetes.io/component":{},"f:app.kubernetes.io/name":{},"f:app.kubernetes.io/part-of":{}},"f:ownerReferences":{".":{},"k:{\"uid\":\"3ecefa8a-1bec-48a7-9af4-dd0df3339101\"}":{".":{},"f:apiVersion":{},"f:blockOwnerDeletion":{},"f:controller":{},"f:kind":{},"f:name":{},"f:uid":{}}}},"f:type":{}}}]},"data":{".erlang.cookie":"ajdscUtLdnBpR1NwUUMwc1V3a2VyTlJxU2tVUTdBeEw="},"type":"Opaque"}
2022/03/18 18:07:31 learn_server.go:291: [SIEVE-AFTER-READ]	Get	true	secret	default	rabbitmq-cluster-default-user	github.com/rabbitmq/cluster-operator/controllers.(*RabbitmqClusterReconciler)	NoError	{"kind":"Secret","apiVersion":"v1","metadata":{"name":"rabbitmq-cluster-default-user","namespace":"default","selfLink":"/api/v1/namespaces/default/secrets/rabbitmq-cluster-default-user","uid":"b2f5a936-e51f-4488-b6e9-ca23e4d95ac2","resourceVersion":"1091","creationTimestamp":"2022-03-18T18:06:25Z","labels":{"app.kubernetes.io/component":"rabbitmq","app.kubernetes.io/name":"rabbitmq-cluster","app.kubernetes.io/part-of":"rabbitmq"},"ownerReferences":[{"apiVersion":"rabbitmq.com/v1beta1","kind":"RabbitmqCluster","name":"rabbitmq-cluster","uid":"3ecefa8a-1bec-48a7-9af4-dd0df3339101","controller":true,"blockOwnerDeletion":true}],"managedFields":[{"manager":"manager","operation":"Update","apiVersion":"v1","time":"2022-03-18T18:06:25Z","fieldsType":"FieldsV1","fieldsV1":{"f:data":{".":{},"f:default_user.conf":{},"f:password":{},"f:provider":{},"f:type":{},"f:username":{}},"f:metadata":{"f:labels":{".":{},"f:app.kubernetes.io/component":{},"f:app.kubernetes.io/name":{},"f:app.kubernetes.io/part-of":{}},"f:ownerReferences":{".":{},"k:{\"uid\":\"3ecefa8a-1bec-48a7-9af4-dd0df3339101\"}":{".":{},"f:apiVersion":{},"f:blockOwnerDeletion":{},"f:controller":{},"f:kind":{},"f:name":{},"f:uid":{}}}},"f:type":{}}}]},"data":{"default_user.conf":"ZGVmYXVsdF91c2VyID0gdEFMN1otZTgzR29ocEtsZ0Z4cUFFV3ZXemEtcjdJQW8KZGVmYXVsdF9wYXNzID0gdXVocndkTkdOcmJXQ2p6NFZPX0NUZE9OYURkSUpoRkoK","password":"dXVocndkTkdOcmJXQ2p6NFZPX0NUZE9OYURkSUpoRko=","provider":"cmFiYml0bXE=","type":"cmFiYml0bXE=","username":"dEFMN1otZTgzR29ocEtsZ0Z4cUFFV3ZXemEtcjdJQW8="},"type":"Opaque"}
2022/03/18 18:07:31 learn_server.go:291: [SIEVE-AFTER-READ]	Get	true	configmap	default	rabbitmq-cluster-plugins-conf	github.com/rabbitmq/cluster-operator/controllers.(*RabbitmqClusterReconciler)	NoError	{"kind":"ConfigMap","apiVersion":"v1","metadata":{"name":"rabbitmq-cluster-plugins-conf","namespace":"default","selfLink":"/api/v1/namespaces/default/configmaps/rabbitmq-cluster-plugins-conf","uid":"0aa26eb6-ff3a-4457-a223-284c897db7fe","resourceVersion":"1092","creationTimestamp":"2022-03-18T18:06:25Z","labels":{"app.kubernetes.io/component":"rabbitmq","app.kubernetes.io/name":"rabbitmq-cluster","app.kubernetes.io/part-of":"rabbitmq"},"ownerReferences":[{"apiVersion":"rabbitmq.com/v1beta1","kind":"RabbitmqCluster","name":"rabbitmq-cluster","uid":"3ecefa8a-1bec-48a7-9af4-dd0df3339101","controller":true,"blockOwnerDeletion":true}],"managedFields":[{"manager":"manager","operation":"Update","apiVersion":"v1","time":"2022-03-18T18:06:25Z","fieldsType":"FieldsV1","fieldsV1":{"f:data":{".":{},"f:enabled_plugins":{}},"f:metadata":{"f:labels":{".":{},"f:app.kubernetes.io/component":{},"f:app.kubernetes.io/name":{},"f:app.kubernetes.io/part-of":{}},"f:ownerReferences":{".":{},"k:{\"uid\":\"3ecefa8a-1bec-48a7-9af4-dd0df3339101\"}":{".":{},"f:apiVersion":{},"f:blockOwnerDeletion":{},"f:controller":{},"f:kind":{},"f:name":{},"f:uid":{}}}}}}]},"data":{"enabled_plugins":"[rabbitmq_peer_discovery_k8s,rabbitmq_prometheus,rabbitmq_management]."}}
2022/03/18 18:07:31 learn_server.go:291: [SIEVE-AFTER-READ]	Get	true	configmap	default	rabbitmq-cluster-server-conf	github.com/rabbitmq/cluster-operator/controllers.(*RabbitmqClusterReconciler)	NoError	{"kind":"ConfigMap","apiVersion":"v1","metadata":{"name":"rabbitmq-cluster-server-conf","namespace":"default","selfLink":"/api/v1/namespaces/default/configmaps/rabbitmq-cluster-server-conf","uid":"e4182078-d429-4baf-9021-72618c509ac5","resourceVersion":"1095","creationTimestamp":"2022-03-18T18:06:25Z","labels":{"app.kubernetes.io/component":"rabbitmq","app.kubernetes.io/name":"rabbitmq-cluster","app.kubernetes.io/part-of":"rabbitmq"},"ownerReferences":[{"apiVersion":"rabbitmq.com/v1beta1","kind":"RabbitmqCluster","name":"rabbitmq-cluster","uid":"3ecefa8a-1bec-48a7-9af4-dd0df3339101","controller":true,"blockOwnerDeletion":true}],"managedFields":[{"manager":"manager","operation":"Update","apiVersion":"v1","time":"2022-03-18T18:06:25Z","fieldsType":"FieldsV1","fieldsV1":{"f:data":{".":{},"f:operatorDefaults.conf":{},"f:userDefinedConfiguration.conf":{}},"f:metadata":{"f:labels":{".":{},"f:app.kubernetes.io/component":{},"f:app.kubernetes.io/name":{},"f:app.kubernetes.io/part-of":{}},"f:ownerReferences":{".":{},"k:{\"uid\":\"3ecefa8a-1bec-48a7-9af4-dd0df3339101\"}":{".":{},"f:apiVersion":{},"f:blockOwnerDeletion":{},"f:controller":{},"f:kind":{},"f:name":{},"f:uid":{}}}}}}]},"data":{"operatorDefaults.conf":"cluster_formation.peer_discovery_backend             = rabbit_peer_discovery_k8s\ncluster_formation.k8s.host                           = kubernetes.default\ncluster_formation.k8s.address_type                   = hostname\ncluster_partition_handling                           = pause_minority\nqueue_master_locator                                 = min-masters\ndisk_free_limit.absolute                             = 2GB\ncluster_formation.randomized_startup_delay_range.min = 5\ncluster_formation.randomized_startup_delay_range.max = 30\ncluster_name                                         = rabbitmq-cluster\n","userDefinedConfiguration.conf":"total_memory_available_override_value = 1717986919\n"}}
2022/03/18 18:07:31 learn_server.go:291: [SIEVE-AFTER-READ]	Get	true	serviceaccount	default	rabbitmq-cluster-server	github.com/rabbitmq/cluster-operator/controllers.(*RabbitmqClusterReconciler)	NoError	{"kind":"ServiceAccount","apiVersion":"v1","metadata":{"name":"rabbitmq-cluster-server","namespace":"default","selfLink":"/api/v1/namespaces/default/serviceaccounts/rabbitmq-cluster-server","uid":"0c3cead0-37dd-452b-b939-fe346a5dfdea","resourceVersion":"1102","creationTimestamp":"2022-03-18T18:06:25Z","labels":{"app.kubernetes.io/component":"rabbitmq","app.kubernetes.io/name":"rabbitmq-cluster","app.kubernetes.io/part-of":"rabbitmq"},"ownerReferences":[{"apiVersion":"rabbitmq.com/v1beta1","kind":"RabbitmqCluster","name":"rabbitmq-cluster","uid":"3ecefa8a-1bec-48a7-9af4-dd0df3339101","controller":true,"blockOwnerDeletion":true}],"managedFields":[{"manager":"kube-controller-manager","operation":"Update","apiVersion":"v1","time":"2022-03-18T18:06:25Z","fieldsType":"FieldsV1","fieldsV1":{"f:secrets":{".":{},"k:{\"name\":\"rabbitmq-cluster-server-token-v4wpv\"}":{".":{},"f:name":{}}}}},{"manager":"manager","operation":"Update","apiVersion":"v1","time":"2022-03-18T18:06:25Z","fieldsType":"FieldsV1","fieldsV1":{"f:metadata":{"f:labels":{".":{},"f:app.kubernetes.io/component":{},"f:app.kubernetes.io/name":{},"f:app.kubernetes.io/part-of":{}},"f:ownerReferences":{".":{},"k:{\"uid\":\"3ecefa8a-1bec-48a7-9af4-dd0df3339101\"}":{".":{},"f:apiVersion":{},"f:blockOwnerDeletion":{},"f:controller":{},"f:kind":{},"f:name":{},"f:uid":{}}}}}}]},"secrets":[{"name":"rabbitmq-cluster-server-token-v4wpv"}]}
2022/03/18 18:07:31 learn_server.go:291: [SIEVE-AFTER-READ]	Get	true	role	default	rabbitmq-cluster-peer-discovery	github.com/rabbitmq/cluster-operator/controllers.(*RabbitmqClusterReconciler)	NoError	{"kind":"Role","apiVersion":"rbac.authorization.k8s.io/v1","metadata":{"name":"rabbitmq-cluster-peer-discovery","namespace":"default","selfLink":"/apis/rbac.authorization.k8s.io/v1/namespaces/default/roles/rabbitmq-cluster-peer-discovery","uid":"ec9ac474-1880-43ed-af46-9ea5f46d6db4","resourceVersion":"1103","creationTimestamp":"2022-03-18T18:06:25Z","labels":{"app.kubernetes.io/component":"rabbitmq","app.kubernetes.io/name":"rabbitmq-cluster","app.kubernetes.io/part-of":"rabbitmq"},"ownerReferences":[{"apiVersion":"rabbitmq.com/v1beta1","kind":"RabbitmqCluster","name":"rabbitmq-cluster","uid":"3ecefa8a-1bec-48a7-9af4-dd0df3339101","controller":true,"blockOwnerDeletion":true}],"managedFields":[{"manager":"manager","operation":"Update","apiVersion":"rbac.authorization.k8s.io/v1","time":"2022-03-18T18:06:25Z","fieldsType":"FieldsV1","fieldsV1":{"f:metadata":{"f:labels":{".":{},"f:app.kubernetes.io/component":{},"f:app.kubernetes.io/name":{},"f:app.kubernetes.io/part-of":{}},"f:ownerReferences":{".":{},"k:{\"uid\":\"3ecefa8a-1bec-48a7-9af4-dd0df3339101\"}":{".":{},"f:apiVersion":{},"f:blockOwnerDeletion":{},"f:controller":{},"f:kind":{},"f:name":{},"f:uid":{}}}},"f:rules":{}}}]},"rules":[{"verbs":["get"],"apiGroups":[""],"resources":["endpoints"]},{"verbs":["create"],"apiGroups":[""],"resources":["events"]}]}
2022/03/18 18:07:31 learn_server.go:291: [SIEVE-AFTER-READ]	Get	true	rolebinding	default	rabbitmq-cluster-server	github.com/rabbitmq/cluster-operator/controllers.(*RabbitmqClusterReconciler)	NoError	{"kind":"RoleBinding","apiVersion":"rbac.authorization.k8s.io/v1","metadata":{"name":"rabbitmq-cluster-server","namespace":"default","selfLink":"/apis/rbac.authorization.k8s.io/v1/namespaces/default/rolebindings/rabbitmq-cluster-server","uid":"fe69a41c-8d28-4b84-a9f6-a9e6044d75ba","resourceVersion":"1105","creationTimestamp":"2022-03-18T18:06:25Z","labels":{"app.kubernetes.io/component":"rabbitmq","app.kubernetes.io/name":"rabbitmq-cluster","app.kubernetes.io/part-of":"rabbitmq"},"ownerReferences":[{"apiVersion":"rabbitmq.com/v1beta1","kind":"RabbitmqCluster","name":"rabbitmq-cluster","uid":"3ecefa8a-1bec-48a7-9af4-dd0df3339101","controller":true,"blockOwnerDeletion":true}],"managedFields":[{"manager":"manager","operation":"Update","apiVersion":"rbac.authorization.k8s.io/v1","time":"2022-03-18T18:06:25Z","fieldsType":"FieldsV1","fieldsV1":{"f:metadata":{"f:labels":{".":{},"f:app.kubernetes.io/component":{},"f:app.kubernetes.io/name":{},"f:app.kubernetes.io/part-of":{}},"f:ownerReferences":{".":{},"k:{\"uid\":\"3ecefa8a-1bec-48a7-9af4-dd0df3339101\"}":{".":{},"f:apiVersion":{},"f:blockOwnerDeletion":{},"f:controller":{},"f:kind":{},"f:name":{},"f:uid":{}}}},"f:roleRef":{"f:apiGroup":{},"f:kind":{},"f:name":{}},"f:subjects":{}}}]},"subjects":[{"kind":"ServiceAccount","name":"rabbitmq-cluster-server"}],"roleRef":{"apiGroup":"rbac.authorization.k8s.io","kind":"Role","name":"rabbitmq-cluster-peer-discovery"}}
2022/03/18 18:07:31 learn_server.go:291: [SIEVE-AFTER-READ]	Get	true	statefulset	default	rabbitmq-cluster-server	github.com/rabbitmq/cluster-operator/controllers.(*RabbitmqClusterReconciler)	NoError	{"kind":"StatefulSet","apiVersion":"apps/v1","metadata":{"name":"rabbitmq-cluster-server","namespace":"default","selfLink":"/apis/apps/v1/namespaces/default/statefulsets/rabbitmq-cluster-server","uid":"f2f07f3e-b500-4c48-a5de-8db7eaf37b9a","resourceVersion":"1409","generation":1,"creationTimestamp":"2022-03-18T18:06:25Z","labels":{"app.kubernetes.io/component":"rabbitmq","app.kubernetes.io/name":"rabbitmq-cluster","app.kubernetes.io/part-of":"rabbitmq"},"ownerReferences":[{"apiVersion":"rabbitmq.com/v1beta1","kind":"RabbitmqCluster","name":"rabbitmq-cluster","uid":"3ecefa8a-1bec-48a7-9af4-dd0df3339101","controller":true,"blockOwnerDeletion":true}],"managedFields":[{"manager":"manager","operation":"Update","apiVersion":"apps/v1","time":"2022-03-18T18:06:25Z","fieldsType":"FieldsV1","fieldsV1":{"f:metadata":{"f:labels":{".":{},"f:app.kubernetes.io/component":{},"f:app.kubernetes.io/name":{},"f:app.kubernetes.io/part-of":{}},"f:ownerReferences":{".":{},"k:{\"uid\":\"3ecefa8a-1bec-48a7-9af4-dd0df3339101\"}":{".":{},"f:apiVersion":{},"f:blockOwnerDeletion":{},"f:controller":{},"f:kind":{},"f:name":{},"f:uid":{}}}},"f:spec":{"f:podManagementPolicy":{},"f:replicas":{},"f:revisionHistoryLimit":{},"f:selector":{"f:matchLabels":{".":{},"f:app.kubernetes.io/name":{}}},"f:serviceName":{},"f:template":{"f:metadata":{"f:annotations":{".":{},"f:prometheus.io/port":{},"f:prometheus.io/scrape":{}},"f:labels":{".":{},"f:app.kubernetes.io/component":{},"f:app.kubernetes.io/name":{},"f:app.kubernetes.io/part-of":{}}},"f:spec":{"f:automountServiceAccountToken":{},"f:containers":{"k:{\"name\":\"rabbitmq\"}":{".":{},"f:env":{".":{},"k:{\"name\":\"K8S_HOSTNAME_SUFFIX\"}":{".":{},"f:name":{},"f:value":{}},"k:{\"name\":\"K8S_SERVICE_NAME\"}":{".":{},"f:name":{},"f:value":{}},"k:{\"name\":\"MY_POD_NAME\"}":{".":{},"f:name":{},"f:valueFrom":{".":{},"f:fieldRef":{".":{},"f:apiVersion":{},"f:fieldPath":{}}}},"k:{\"name\":\"MY_POD_NAMESPACE\"}":{".":{},"f:name":{},"f:valueFrom":{".":{},"f:fieldRef":{".":{},"f:apiVersion":{},"f:fieldPath":{}}}},"k:{\"name\":\"RABBITMQ_ENABLED_PLUGINS_FILE\"}":{".":{},"f:name":{},"f:value":{}},"k:{\"name\":\"RABBITMQ_NODENAME\"}":{".":{},"f:name":{},"f:value":{}},"k:{\"name\":\"RABBITMQ_USE_LONGNAME\"}":{".":{},"f:name":{},"f:value":{}}},"f:image":{},"f:imagePullPolicy":{},"f:lifecycle":{".":{},"f:preStop":{".":{},"f:exec":{".":{},"f:command":{}}}},"f:name":{},"f:ports":{".":{},"k:{\"containerPort\":4369,\"protocol\":\"TCP\"}":{".":{},"f:containerPort":{},"f:name":{},"f:protocol":{}},"k:{\"containerPort\":5672,\"protocol\":\"TCP\"}":{".":{},"f:containerPort":{},"f:name":{},"f:protocol":{}},"k:{\"containerPort\":15672,\"protocol\":\"TCP\"}":{".":{},"f:containerPort":{},"f:name":{},"f:protocol":{}},"k:{\"containerPort\":15692,\"protocol\":\"TCP\"}":{".":{},"f:containerPort":{},"f:name":{},"f:protocol":{}}},"f:readinessProbe":{".":{},"f:failureThreshold":{},"f:initialDelaySeconds":{},"f:periodSeconds":{},"f:successThreshold":{},"f:tcpSocket":{".":{},"f:port":{}},"f:timeoutSeconds":{}},"f:resources":{".":{},"f:limits":{".":{},"f:cpu":{},"f:memory":{}},"f:requests":{".":{},"f:cpu":{},"f:memory":{}}},"f:terminationMessagePath":{},"f:terminationMessagePolicy":{},"f:volumeMounts":{".":{},"k:{\"mountPath\":\"/etc/pod-info/\"}":{".":{},"f:mountPath":{},"f:name":{}},"k:{\"mountPath\":\"/etc/rabbitmq/conf.d/10-operatorDefaults.conf\"}":{".":{},"f:mountPath":{},"f:name":{},"f:subPath":{}},"k:{\"mountPath\":\"/etc/rabbitmq/conf.d/11-default_user.conf\"}":{".":{},"f:mountPath":{},"f:name":{},"f:subPath":{}},"k:{\"mountPath\":\"/etc/rabbitmq/conf.d/90-userDefinedConfiguration.conf\"}":{".":{},"f:mountPath":{},"f:name":{},"f:subPath":{}},"k:{\"mountPath\":\"/operator\"}":{".":{},"f:mountPath":{},"f:name":{}},"k:{\"mountPath\":\"/var/lib/rabbitmq/\"}":{".":{},"f:mountPath":{},"f:name":{}},"k:{\"mountPath\":\"/var/lib/rabbitmq/mnesia/\"}":{".":{},"f:mountPath":{},"f:name":{}}}}},"f:dnsPolicy":{},"f:initContainers":{".":{},"k:{\"name\":\"setup-container\"}":{".":{},"f:command":{},"f:image":{},"f:imagePullPolicy":{},"f:name":{},"f:resources":{".":{},"f:limits":{".":{},"f:cpu":{},"f:memory":{}},"f:requests":{".":{},"f:cpu":{},"f:memory":{}}},"f:securityContext":{".":{},"f:capabilities":{".":{},"f:drop":{}},"f:runAsUser":{}},"f:terminationMessagePath":{},"f:terminationMessagePolicy":{},"f:volumeMounts":{".":{},"k:{\"mountPath\":\"/operator\"}":{".":{},"f:mountPath":{},"f:name":{}},"k:{\"mountPath\":\"/tmp/default_user.conf\"}":{".":{},"f:mountPath":{},"f:name":{},"f:subPath":{}},"k:{\"mountPath\":\"/tmp/erlang-cookie-secret/\"}":{".":{},"f:mountPath":{},"f:name":{}},"k:{\"mountPath\":\"/tmp/rabbitmq-plugins/\"}":{".":{},"f:mountPath":{},"f:name":{}},"k:{\"mountPath\":\"/var/lib/rabbitmq/\"}":{".":{},"f:mountPath":{},"f:name":{}},"k:{\"mountPath\":\"/var/lib/rabbitmq/mnesia/\"}":{".":{},"f:mountPath":{},"f:name":{}}}}},"f:restartPolicy":{},"f:schedulerName":{},"f:securityContext":{".":{},"f:fsGroup":{},"f:runAsGroup":{},"f:runAsUser":{}},"f:serviceAccount":{},"f:serviceAccountName":{},"f:terminationGracePeriodSeconds":{},"f:topologySpreadConstraints":{".":{},"k:{\"topologyKey\":\"topology.kubernetes.io/zone\",\"whenUnsatisfiable\":\"ScheduleAnyway\"}":{".":{},"f:labelSelector":{".":{},"f:matchLabels":{".":{},"f:app.kubernetes.io/name":{}}},"f:maxSkew":{},"f:topologyKey":{},"f:whenUnsatisfiable":{}}},"f:volumes":{".":{},"k:{\"name\":\"erlang-cookie-secret\"}":{".":{},"f:name":{},"f:secret":{".":{},"f:defaultMode":{},"f:secretName":{}}},"k:{\"name\":\"plugins-conf\"}":{".":{},"f:configMap":{".":{},"f:defaultMode":{},"f:name":{}},"f:name":{}},"k:{\"name\":\"pod-info\"}":{".":{},"f:downwardAPI":{".":{},"f:defaultMode":{},"f:items":{}},"f:name":{}},"k:{\"name\":\"rabbitmq-confd\"}":{".":{},"f:name":{},"f:projected":{".":{},"f:defaultMode":{},"f:sources":{}}},"k:{\"name\":\"rabbitmq-erlang-cookie\"}":{".":{},"f:emptyDir":{},"f:name":{}},"k:{\"name\":\"rabbitmq-plugins\"}":{".":{},"f:emptyDir":{},"f:name":{}}}}},"f:updateStrategy":{"f:rollingUpdate":{".":{},"f:partition":{}},"f:type":{}},"f:volumeClaimTemplates":{}}}},{"manager":"kube-controller-manager","operation":"Update","apiVersion":"apps/v1","time":"2022-03-18T18:07:23Z","fieldsType":"FieldsV1","fieldsV1":{"f:status":{"f:collisionCount":{},"f:currentReplicas":{},"f:currentRevision":{},"f:observedGeneration":{},"f:readyReplicas":{},"f:replicas":{},"f:updateRevision":{},"f:updatedReplicas":{}}}}]},"spec":{"replicas":1,"selector":{"matchLabels":{"app.kubernetes.io/name":"rabbitmq-cluster"}},"template":{"metadata":{"creationTimestamp":null,"labels":{"app.kubernetes.io/component":"rabbitmq","app.kubernetes.io/name":"rabbitmq-cluster","app.kubernetes.io/part-of":"rabbitmq"},"annotations":{"prometheus.io/port":"15692","prometheus.io/scrape":"true"}},"spec":{"volumes":[{"name":"plugins-conf","configMap":{"name":"rabbitmq-cluster-plugins-conf","defaultMode":420}},{"name":"rabbitmq-confd","projected":{"sources":[{"secret":{"name":"rabbitmq-cluster-default-user","items":[{"key":"default_user.conf","path":"default_user.conf"}]}},{"configMap":{"name":"rabbitmq-cluster-server-conf","items":[{"key":"operatorDefaults.conf","path":"operatorDefaults.conf"},{"key":"userDefinedConfiguration.conf","path":"userDefinedConfiguration.conf"}]}}],"defaultMode":420}},{"name":"rabbitmq-erlang-cookie","emptyDir":{}},{"name":"erlang-cookie-secret","secret":{"secretName":"rabbitmq-cluster-erlang-cookie","defaultMode":420}},{"name":"rabbitmq-plugins","emptyDir":{}},{"name":"pod-info","downwardAPI":{"items":[{"path":"skipPreStopChecks","fieldRef":{"apiVersion":"v1","fieldPath":"metadata.labels['skipPreStopChecks']"}}],"defaultMode":420}}],"initContainers":[{"name":"setup-container","image":"rabbitmq:3.8.12-management","command":["sh","-c","cp /tmp/erlang-cookie-secret/.erlang.cookie /var/lib/rabbitmq/.erlang.cookie \u0026\u0026 chown 999:999 /var/lib/rabbitmq/.erlang.cookie \u0026\u0026 chmod 600 /var/lib/rabbitmq/.erlang.cookie ; cp /tmp/rabbitmq-plugins/enabled_plugins /operator/enabled_plugins \u0026\u0026 chown 999:999 /operator/enabled_plugins ; chown 999:999 /var/lib/rabbitmq/mnesia/ ; echo '[default]' \u003e /var/lib/rabbitmq/.rabbitmqadmin.conf \u0026\u0026 sed -e 's/default_user/username/' -e 's/default_pass/password/' /tmp/default_user.conf \u003e\u003e /var/lib/rabbitmq/.rabbitmqadmin.conf \u0026\u0026 chown 999:999 /var/lib/rabbitmq/.rabbitmqadmin.conf \u0026\u0026 chmod 600 /var/lib/rabbitmq/.rabbitmqadmin.conf"],"resources":{"limits":{"cpu":"100m","memory":"500Mi"},"requests":{"cpu":"100m","memory":"500Mi"}},"volumeMounts":[{"name":"plugins-conf","mountPath":"/tmp/rabbitmq-plugins/"},{"name":"rabbitmq-erlang-cookie","mountPath":"/var/lib/rabbitmq/"},{"name":"erlang-cookie-secret","mountPath":"/tmp/erlang-cookie-secret/"},{"name":"rabbitmq-plugins","mountPath":"/operator"},{"name":"persistence","mountPath":"/var/lib/rabbitmq/mnesia/"},{"name":"rabbitmq-confd","mountPath":"/tmp/default_user.conf","subPath":"default_user.conf"}],"terminationMessagePath":"/dev/termination-log","terminationMessagePolicy":"File","imagePullPolicy":"IfNotPresent","securityContext":{"capabilities":{"drop":["FSETID","KILL","SETGID","SETUID","SETPCAP","NET_BIND_SERVICE","NET_RAW","SYS_CHROOT","MKNOD","AUDIT_WRITE","SETFCAP"]},"runAsUser":0}}],"containers":[{"name":"rabbitmq","image":"rabbitmq:3.8.12-management","ports":[{"name":"epmd","containerPort":4369,"protocol":"TCP"},{"name":"amqp","containerPort":5672,"protocol":"TCP"},{"name":"management","containerPort":15672,"protocol":"TCP"},{"name":"prometheus","containerPort":15692,"protocol":"TCP"}],"env":[{"name":"MY_POD_NAME","valueFrom":{"fieldRef":{"apiVersion":"v1","fieldPath":"metadata.name"}}},{"name":"MY_POD_NAMESPACE","valueFrom":{"fieldRef":{"apiVersion":"v1","fieldPath":"metadata.namespace"}}},{"name":"RABBITMQ_ENABLED_PLUGINS_FILE","value":"/operator/enabled_plugins"},{"name":"K8S_SERVICE_NAME","value":"rabbitmq-cluster-nodes"},{"name":"RABBITMQ_USE_LONGNAME","value":"true"},{"name":"RABBITMQ_NODENAME","value":"rabbit@$(MY_POD_NAME).$(K8S_SERVICE_NAME).$(MY_POD_NAMESPACE)"},{"name":"K8S_HOSTNAME_SUFFIX","value":".$(K8S_SERVICE_NAME).$(MY_POD_NAMESPACE)"}],"resources":{"limits":{"cpu":"2","memory":"2Gi"},"requests":{"cpu":"1","memory":"2Gi"}},"volumeMounts":[{"name":"rabbitmq-erlang-cookie","mountPath":"/var/lib/rabbitmq/"},{"name":"persistence","mountPath":"/var/lib/rabbitmq/mnesia/"},{"name":"rabbitmq-plugins","mountPath":"/operator"},{"name":"rabbitmq-confd","mountPath":"/etc/rabbitmq/conf.d/10-operatorDefaults.conf","subPath":"operatorDefaults.conf"},{"name":"rabbitmq-confd","mountPath":"/etc/rabbitmq/conf.d/11-default_user.conf","subPath":"default_user.conf"},{"name":"rabbitmq-confd","mountPath":"/etc/rabbitmq/conf.d/90-userDefinedConfiguration.conf","subPath":"userDefinedConfiguration.conf"},{"name":"pod-info","mountPath":"/etc/pod-info/"}],"readinessProbe":{"tcpSocket":{"port":"amqp"},"initialDelaySeconds":10,"timeoutSeconds":5,"periodSeconds":10,"successThreshold":1,"failureThreshold":3},"lifecycle":{"preStop":{"exec":{"command":["/bin/bash","-c","if [ ! -z \"$(cat /etc/pod-info/skipPreStopChecks)\" ]; then exit 0; fi; rabbitmq-upgrade await_online_quorum_plus_one -t 604800; rabbitmq-upgrade await_online_synchronized_mirror -t 604800; rabbitmq-upgrade drain -t 604800"]}}},"terminationMessagePath":"/dev/termination-log","terminationMessagePolicy":"File","imagePullPolicy":"IfNotPresent"}],"restartPolicy":"Always","terminationGracePeriodSeconds":604800,"dnsPolicy":"ClusterFirst","serviceAccountName":"rabbitmq-cluster-server","serviceAccount":"rabbitmq-cluster-server","automountServiceAccountToken":true,"securityContext":{"runAsUser":999,"runAsGroup":999,"fsGroup":999},"schedulerName":"default-scheduler","topologySpreadConstraints":[{"maxSkew":1,"topologyKey":"topology.kubernetes.io/zone","whenUnsatisfiable":"ScheduleAnyway","labelSelector":{"matchLabels":{"app.kubernetes.io/name":"rabbitmq-cluster"}}}]}},"volumeClaimTemplates":[{"metadata":{"name":"persistence","namespace":"default","creationTimestamp":null,"labels":{"app.kubernetes.io/component":"rabbitmq","app.kubernetes.io/name":"rabbitmq-cluster","app.kubernetes.io/part-of":"rabbitmq"},"ownerReferences":[{"apiVersion":"rabbitmq.com/v1beta1","kind":"RabbitmqCluster","name":"rabbitmq-cluster","uid":"3ecefa8a-1bec-48a7-9af4-dd0df3339101","controller":true,"blockOwnerDeletion":false}]},"spec":{"accessModes":["ReadWriteOnce"],"resources":{"requests":{"storage":"10Gi"}},"volumeMode":"Filesystem"},"status":{"phase":"Pending"}}],"serviceName":"rabbitmq-cluster-nodes","podManagementPolicy":"Parallel","updateStrategy":{"type":"RollingUpdate","rollingUpdate":{"partition":0}},"revisionHistoryLimit":10},"status":{"observedGeneration":1,"replicas":1,"readyReplicas":1,"currentReplicas":1,"updatedReplicas":1,"currentRevision":"rabbitmq-cluster-server-5f8b8665fb","updateRevision":"rabbitmq-cluster-server-5f8b8665fb","collisionCount":0}}
2022/03/18 18:07:31 learn_server.go:291: [SIEVE-AFTER-READ]	Get	true	statefulset	default	rabbitmq-cluster-server	github.com/rabbitmq/cluster-operator/controllers.(*RabbitmqClusterReconciler)	NoError	{"kind":"StatefulSet","apiVersion":"apps/v1","metadata":{"name":"rabbitmq-cluster-server","namespace":"default","selfLink":"/apis/apps/v1/namespaces/default/statefulsets/rabbitmq-cluster-server","uid":"f2f07f3e-b500-4c48-a5de-8db7eaf37b9a","resourceVersion":"1409","generation":1,"creationTimestamp":"2022-03-18T18:06:25Z","labels":{"app.kubernetes.io/component":"rabbitmq","app.kubernetes.io/name":"rabbitmq-cluster","app.kubernetes.io/part-of":"rabbitmq"},"ownerReferences":[{"apiVersion":"rabbitmq.com/v1beta1","kind":"RabbitmqCluster","name":"rabbitmq-cluster","uid":"3ecefa8a-1bec-48a7-9af4-dd0df3339101","controller":true,"blockOwnerDeletion":true}],"managedFields":[{"manager":"manager","operation":"Update","apiVersion":"apps/v1","time":"2022-03-18T18:06:25Z","fieldsType":"FieldsV1","fieldsV1":{"f:metadata":{"f:labels":{".":{},"f:app.kubernetes.io/component":{},"f:app.kubernetes.io/name":{},"f:app.kubernetes.io/part-of":{}},"f:ownerReferences":{".":{},"k:{\"uid\":\"3ecefa8a-1bec-48a7-9af4-dd0df3339101\"}":{".":{},"f:apiVersion":{},"f:blockOwnerDeletion":{},"f:controller":{},"f:kind":{},"f:name":{},"f:uid":{}}}},"f:spec":{"f:podManagementPolicy":{},"f:replicas":{},"f:revisionHistoryLimit":{},"f:selector":{"f:matchLabels":{".":{},"f:app.kubernetes.io/name":{}}},"f:serviceName":{},"f:template":{"f:metadata":{"f:annotations":{".":{},"f:prometheus.io/port":{},"f:prometheus.io/scrape":{}},"f:labels":{".":{},"f:app.kubernetes.io/component":{},"f:app.kubernetes.io/name":{},"f:app.kubernetes.io/part-of":{}}},"f:spec":{"f:automountServiceAccountToken":{},"f:containers":{"k:{\"name\":\"rabbitmq\"}":{".":{},"f:env":{".":{},"k:{\"name\":\"K8S_HOSTNAME_SUFFIX\"}":{".":{},"f:name":{},"f:value":{}},"k:{\"name\":\"K8S_SERVICE_NAME\"}":{".":{},"f:name":{},"f:value":{}},"k:{\"name\":\"MY_POD_NAME\"}":{".":{},"f:name":{},"f:valueFrom":{".":{},"f:fieldRef":{".":{},"f:apiVersion":{},"f:fieldPath":{}}}},"k:{\"name\":\"MY_POD_NAMESPACE\"}":{".":{},"f:name":{},"f:valueFrom":{".":{},"f:fieldRef":{".":{},"f:apiVersion":{},"f:fieldPath":{}}}},"k:{\"name\":\"RABBITMQ_ENABLED_PLUGINS_FILE\"}":{".":{},"f:name":{},"f:value":{}},"k:{\"name\":\"RABBITMQ_NODENAME\"}":{".":{},"f:name":{},"f:value":{}},"k:{\"name\":\"RABBITMQ_USE_LONGNAME\"}":{".":{},"f:name":{},"f:value":{}}},"f:image":{},"f:imagePullPolicy":{},"f:lifecycle":{".":{},"f:preStop":{".":{},"f:exec":{".":{},"f:command":{}}}},"f:name":{},"f:ports":{".":{},"k:{\"containerPort\":4369,\"protocol\":\"TCP\"}":{".":{},"f:containerPort":{},"f:name":{},"f:protocol":{}},"k:{\"containerPort\":5672,\"protocol\":\"TCP\"}":{".":{},"f:containerPort":{},"f:name":{},"f:protocol":{}},"k:{\"containerPort\":15672,\"protocol\":\"TCP\"}":{".":{},"f:containerPort":{},"f:name":{},"f:protocol":{}},"k:{\"containerPort\":15692,\"protocol\":\"TCP\"}":{".":{},"f:containerPort":{},"f:name":{},"f:protocol":{}}},"f:readinessProbe":{".":{},"f:failureThreshold":{},"f:initialDelaySeconds":{},"f:periodSeconds":{},"f:successThreshold":{},"f:tcpSocket":{".":{},"f:port":{}},"f:timeoutSeconds":{}},"f:resources":{".":{},"f:limits":{".":{},"f:cpu":{},"f:memory":{}},"f:requests":{".":{},"f:cpu":{},"f:memory":{}}},"f:terminationMessagePath":{},"f:terminationMessagePolicy":{},"f:volumeMounts":{".":{},"k:{\"mountPath\":\"/etc/pod-info/\"}":{".":{},"f:mountPath":{},"f:name":{}},"k:{\"mountPath\":\"/etc/rabbitmq/conf.d/10-operatorDefaults.conf\"}":{".":{},"f:mountPath":{},"f:name":{},"f:subPath":{}},"k:{\"mountPath\":\"/etc/rabbitmq/conf.d/11-default_user.conf\"}":{".":{},"f:mountPath":{},"f:name":{},"f:subPath":{}},"k:{\"mountPath\":\"/etc/rabbitmq/conf.d/90-userDefinedConfiguration.conf\"}":{".":{},"f:mountPath":{},"f:name":{},"f:subPath":{}},"k:{\"mountPath\":\"/operator\"}":{".":{},"f:mountPath":{},"f:name":{}},"k:{\"mountPath\":\"/var/lib/rabbitmq/\"}":{".":{},"f:mountPath":{},"f:name":{}},"k:{\"mountPath\":\"/var/lib/rabbitmq/mnesia/\"}":{".":{},"f:mountPath":{},"f:name":{}}}}},"f:dnsPolicy":{},"f:initContainers":{".":{},"k:{\"name\":\"setup-container\"}":{".":{},"f:command":{},"f:image":{},"f:imagePullPolicy":{},"f:name":{},"f:resources":{".":{},"f:limits":{".":{},"f:cpu":{},"f:memory":{}},"f:requests":{".":{},"f:cpu":{},"f:memory":{}}},"f:securityContext":{".":{},"f:capabilities":{".":{},"f:drop":{}},"f:runAsUser":{}},"f:terminationMessagePath":{},"f:terminationMessagePolicy":{},"f:volumeMounts":{".":{},"k:{\"mountPath\":\"/operator\"}":{".":{},"f:mountPath":{},"f:name":{}},"k:{\"mountPath\":\"/tmp/default_user.conf\"}":{".":{},"f:mountPath":{},"f:name":{},"f:subPath":{}},"k:{\"mountPath\":\"/tmp/erlang-cookie-secret/\"}":{".":{},"f:mountPath":{},"f:name":{}},"k:{\"mountPath\":\"/tmp/rabbitmq-plugins/\"}":{".":{},"f:mountPath":{},"f:name":{}},"k:{\"mountPath\":\"/var/lib/rabbitmq/\"}":{".":{},"f:mountPath":{},"f:name":{}},"k:{\"mountPath\":\"/var/lib/rabbitmq/mnesia/\"}":{".":{},"f:mountPath":{},"f:name":{}}}}},"f:restartPolicy":{},"f:schedulerName":{},"f:securityContext":{".":{},"f:fsGroup":{},"f:runAsGroup":{},"f:runAsUser":{}},"f:serviceAccount":{},"f:serviceAccountName":{},"f:terminationGracePeriodSeconds":{},"f:topologySpreadConstraints":{".":{},"k:{\"topologyKey\":\"topology.kubernetes.io/zone\",\"whenUnsatisfiable\":\"ScheduleAnyway\"}":{".":{},"f:labelSelector":{".":{},"f:matchLabels":{".":{},"f:app.kubernetes.io/name":{}}},"f:maxSkew":{},"f:topologyKey":{},"f:whenUnsatisfiable":{}}},"f:volumes":{".":{},"k:{\"name\":\"erlang-cookie-secret\"}":{".":{},"f:name":{},"f:secret":{".":{},"f:defaultMode":{},"f:secretName":{}}},"k:{\"name\":\"plugins-conf\"}":{".":{},"f:configMap":{".":{},"f:defaultMode":{},"f:name":{}},"f:name":{}},"k:{\"name\":\"pod-info\"}":{".":{},"f:downwardAPI":{".":{},"f:defaultMode":{},"f:items":{}},"f:name":{}},"k:{\"name\":\"rabbitmq-confd\"}":{".":{},"f:name":{},"f:projected":{".":{},"f:defaultMode":{},"f:sources":{}}},"k:{\"name\":\"rabbitmq-erlang-cookie\"}":{".":{},"f:emptyDir":{},"f:name":{}},"k:{\"name\":\"rabbitmq-plugins\"}":{".":{},"f:emptyDir":{},"f:name":{}}}}},"f:updateStrategy":{"f:rollingUpdate":{".":{},"f:partition":{}},"f:type":{}},"f:volumeClaimTemplates":{}}}},{"manager":"kube-controller-manager","operation":"Update","apiVersion":"apps/v1","time":"2022-03-18T18:07:23Z","fieldsType":"FieldsV1","fieldsV1":{"f:status":{"f:collisionCount":{},"f:currentReplicas":{},"f:currentRevision":{},"f:observedGeneration":{},"f:readyReplicas":{},"f:replicas":{},"f:updateRevision":{},"f:updatedReplicas":{}}}}]},"spec":{"replicas":1,"selector":{"matchLabels":{"app.kubernetes.io/name":"rabbitmq-cluster"}},"template":{"metadata":{"creationTimestamp":null,"labels":{"app.kubernetes.io/component":"rabbitmq","app.kubernetes.io/name":"rabbitmq-cluster","app.kubernetes.io/part-of":"rabbitmq"},"annotations":{"prometheus.io/port":"15692","prometheus.io/scrape":"true"}},"spec":{"volumes":[{"name":"plugins-conf","configMap":{"name":"rabbitmq-cluster-plugins-conf","defaultMode":420}},{"name":"rabbitmq-confd","projected":{"sources":[{"secret":{"name":"rabbitmq-cluster-default-user","items":[{"key":"default_user.conf","path":"default_user.conf"}]}},{"configMap":{"name":"rabbitmq-cluster-server-conf","items":[{"key":"operatorDefaults.conf","path":"operatorDefaults.conf"},{"key":"userDefinedConfiguration.conf","path":"userDefinedConfiguration.conf"}]}}],"defaultMode":420}},{"name":"rabbitmq-erlang-cookie","emptyDir":{}},{"name":"erlang-cookie-secret","secret":{"secretName":"rabbitmq-cluster-erlang-cookie","defaultMode":420}},{"name":"rabbitmq-plugins","emptyDir":{}},{"name":"pod-info","downwardAPI":{"items":[{"path":"skipPreStopChecks","fieldRef":{"apiVersion":"v1","fieldPath":"metadata.labels['skipPreStopChecks']"}}],"defaultMode":420}}],"initContainers":[{"name":"setup-container","image":"rabbitmq:3.8.12-management","command":["sh","-c","cp /tmp/erlang-cookie-secret/.erlang.cookie /var/lib/rabbitmq/.erlang.cookie \u0026\u0026 chown 999:999 /var/lib/rabbitmq/.erlang.cookie \u0026\u0026 chmod 600 /var/lib/rabbitmq/.erlang.cookie ; cp /tmp/rabbitmq-plugins/enabled_plugins /operator/enabled_plugins \u0026\u0026 chown 999:999 /operator/enabled_plugins ; chown 999:999 /var/lib/rabbitmq/mnesia/ ; echo '[default]' \u003e /var/lib/rabbitmq/.rabbitmqadmin.conf \u0026\u0026 sed -e 's/default_user/username/' -e 's/default_pass/password/' /tmp/default_user.conf \u003e\u003e /var/lib/rabbitmq/.rabbitmqadmin.conf \u0026\u0026 chown 999:999 /var/lib/rabbitmq/.rabbitmqadmin.conf \u0026\u0026 chmod 600 /var/lib/rabbitmq/.rabbitmqadmin.conf"],"resources":{"limits":{"cpu":"100m","memory":"500Mi"},"requests":{"cpu":"100m","memory":"500Mi"}},"volumeMounts":[{"name":"plugins-conf","mountPath":"/tmp/rabbitmq-plugins/"},{"name":"rabbitmq-erlang-cookie","mountPath":"/var/lib/rabbitmq/"},{"name":"erlang-cookie-secret","mountPath":"/tmp/erlang-cookie-secret/"},{"name":"rabbitmq-plugins","mountPath":"/operator"},{"name":"persistence","mountPath":"/var/lib/rabbitmq/mnesia/"},{"name":"rabbitmq-confd","mountPath":"/tmp/default_user.conf","subPath":"default_user.conf"}],"terminationMessagePath":"/dev/termination-log","terminationMessagePolicy":"File","imagePullPolicy":"IfNotPresent","securityContext":{"capabilities":{"drop":["FSETID","KILL","SETGID","SETUID","SETPCAP","NET_BIND_SERVICE","NET_RAW","SYS_CHROOT","MKNOD","AUDIT_WRITE","SETFCAP"]},"runAsUser":0}}],"containers":[{"name":"rabbitmq","image":"rabbitmq:3.8.12-management","ports":[{"name":"epmd","containerPort":4369,"protocol":"TCP"},{"name":"amqp","containerPort":5672,"protocol":"TCP"},{"name":"management","containerPort":15672,"protocol":"TCP"},{"name":"prometheus","containerPort":15692,"protocol":"TCP"}],"env":[{"name":"MY_POD_NAME","valueFrom":{"fieldRef":{"apiVersion":"v1","fieldPath":"metadata.name"}}},{"name":"MY_POD_NAMESPACE","valueFrom":{"fieldRef":{"apiVersion":"v1","fieldPath":"metadata.namespace"}}},{"name":"RABBITMQ_ENABLED_PLUGINS_FILE","value":"/operator/enabled_plugins"},{"name":"K8S_SERVICE_NAME","value":"rabbitmq-cluster-nodes"},{"name":"RABBITMQ_USE_LONGNAME","value":"true"},{"name":"RABBITMQ_NODENAME","value":"rabbit@$(MY_POD_NAME).$(K8S_SERVICE_NAME).$(MY_POD_NAMESPACE)"},{"name":"K8S_HOSTNAME_SUFFIX","value":".$(K8S_SERVICE_NAME).$(MY_POD_NAMESPACE)"}],"resources":{"limits":{"cpu":"2","memory":"2Gi"},"requests":{"cpu":"1","memory":"2Gi"}},"volumeMounts":[{"name":"rabbitmq-erlang-cookie","mountPath":"/var/lib/rabbitmq/"},{"name":"persistence","mountPath":"/var/lib/rabbitmq/mnesia/"},{"name":"rabbitmq-plugins","mountPath":"/operator"},{"name":"rabbitmq-confd","mountPath":"/etc/rabbitmq/conf.d/10-operatorDefaults.conf","subPath":"operatorDefaults.conf"},{"name":"rabbitmq-confd","mountPath":"/etc/rabbitmq/conf.d/11-default_user.conf","subPath":"default_user.conf"},{"name":"rabbitmq-confd","mountPath":"/etc/rabbitmq/conf.d/90-userDefinedConfiguration.conf","subPath":"userDefinedConfiguration.conf"},{"name":"pod-info","mountPath":"/etc/pod-info/"}],"readinessProbe":{"tcpSocket":{"port":"amqp"},"initialDelaySeconds":10,"timeoutSeconds":5,"periodSeconds":10,"successThreshold":1,"failureThreshold":3},"lifecycle":{"preStop":{"exec":{"command":["/bin/bash","-c","if [ ! -z \"$(cat /etc/pod-info/skipPreStopChecks)\" ]; then exit 0; fi; rabbitmq-upgrade await_online_quorum_plus_one -t 604800; rabbitmq-upgrade await_online_synchronized_mirror -t 604800; rabbitmq-upgrade drain -t 604800"]}}},"terminationMessagePath":"/dev/termination-log","terminationMessagePolicy":"File","imagePullPolicy":"IfNotPresent"}],"restartPolicy":"Always","terminationGracePeriodSeconds":604800,"dnsPolicy":"ClusterFirst","serviceAccountName":"rabbitmq-cluster-server","serviceAccount":"rabbitmq-cluster-server","automountServiceAccountToken":true,"securityContext":{"runAsUser":999,"runAsGroup":999,"fsGroup":999},"schedulerName":"default-scheduler","topologySpreadConstraints":[{"maxSkew":1,"topologyKey":"topology.kubernetes.io/zone","whenUnsatisfiable":"ScheduleAnyway","labelSelector":{"matchLabels":{"app.kubernetes.io/name":"rabbitmq-cluster"}}}]}},"volumeClaimTemplates":[{"metadata":{"name":"persistence","namespace":"default","creationTimestamp":null,"labels":{"app.kubernetes.io/component":"rabbitmq","app.kubernetes.io/name":"rabbitmq-cluster","app.kubernetes.io/part-of":"rabbitmq"},"ownerReferences":[{"apiVersion":"rabbitmq.com/v1beta1","kind":"RabbitmqCluster","name":"rabbitmq-cluster","uid":"3ecefa8a-1bec-48a7-9af4-dd0df3339101","controller":true,"blockOwnerDeletion":false}]},"spec":{"accessModes":["ReadWriteOnce"],"resources":{"requests":{"storage":"10Gi"}},"volumeMode":"Filesystem"},"status":{"phase":"Pending"}}],"serviceName":"rabbitmq-cluster-nodes","podManagementPolicy":"Parallel","updateStrategy":{"type":"RollingUpdate","rollingUpdate":{"partition":0}},"revisionHistoryLimit":10},"status":{"observedGeneration":1,"replicas":1,"readyReplicas":1,"currentReplicas":1,"updatedReplicas":1,"currentRevision":"rabbitmq-cluster-server-5f8b8665fb","updateRevision":"rabbitmq-cluster-server-5f8b8665fb","collisionCount":0}}
2022/03/18 18:07:31 learn_server.go:256: [SIEVE-BEFORE-WRITE]	37
2022/03/18 18:07:31 learn_server.go:263: [SIEVE-AFTER-WRITE]	37	Delete	statefulset	github.com/rabbitmq/cluster-operator/controllers.(*RabbitmqClusterReconciler)	NoError	{"kind":"StatefulSet","apiVersion":"apps/v1","metadata":{"name":"rabbitmq-cluster-server","namespace":"default","selfLink":"/apis/apps/v1/namespaces/default/statefulsets/rabbitmq-cluster-server","uid":"f2f07f3e-b500-4c48-a5de-8db7eaf37b9a","resourceVersion":"1409","generation":1,"creationTimestamp":"2022-03-18T18:06:25Z","labels":{"app.kubernetes.io/component":"rabbitmq","app.kubernetes.io/name":"rabbitmq-cluster","app.kubernetes.io/part-of":"rabbitmq"},"ownerReferences":[{"apiVersion":"rabbitmq.com/v1beta1","kind":"RabbitmqCluster","name":"rabbitmq-cluster","uid":"3ecefa8a-1bec-48a7-9af4-dd0df3339101","controller":true,"blockOwnerDeletion":true}],"managedFields":[{"manager":"manager","operation":"Update","apiVersion":"apps/v1","time":"2022-03-18T18:06:25Z","fieldsType":"FieldsV1","fieldsV1":{"f:metadata":{"f:labels":{".":{},"f:app.kubernetes.io/component":{},"f:app.kubernetes.io/name":{},"f:app.kubernetes.io/part-of":{}},"f:ownerReferences":{".":{},"k:{\"uid\":\"3ecefa8a-1bec-48a7-9af4-dd0df3339101\"}":{".":{},"f:apiVersion":{},"f:blockOwnerDeletion":{},"f:controller":{},"f:kind":{},"f:name":{},"f:uid":{}}}},"f:spec":{"f:podManagementPolicy":{},"f:replicas":{},"f:revisionHistoryLimit":{},"f:selector":{"f:matchLabels":{".":{},"f:app.kubernetes.io/name":{}}},"f:serviceName":{},"f:template":{"f:metadata":{"f:annotations":{".":{},"f:prometheus.io/port":{},"f:prometheus.io/scrape":{}},"f:labels":{".":{},"f:app.kubernetes.io/component":{},"f:app.kubernetes.io/name":{},"f:app.kubernetes.io/part-of":{}}},"f:spec":{"f:automountServiceAccountToken":{},"f:containers":{"k:{\"name\":\"rabbitmq\"}":{".":{},"f:env":{".":{},"k:{\"name\":\"K8S_HOSTNAME_SUFFIX\"}":{".":{},"f:name":{},"f:value":{}},"k:{\"name\":\"K8S_SERVICE_NAME\"}":{".":{},"f:name":{},"f:value":{}},"k:{\"name\":\"MY_POD_NAME\"}":{".":{},"f:name":{},"f:valueFrom":{".":{},"f:fieldRef":{".":{},"f:apiVersion":{},"f:fieldPath":{}}}},"k:{\"name\":\"MY_POD_NAMESPACE\"}":{".":{},"f:name":{},"f:valueFrom":{".":{},"f:fieldRef":{".":{},"f:apiVersion":{},"f:fieldPath":{}}}},"k:{\"name\":\"RABBITMQ_ENABLED_PLUGINS_FILE\"}":{".":{},"f:name":{},"f:value":{}},"k:{\"name\":\"RABBITMQ_NODENAME\"}":{".":{},"f:name":{},"f:value":{}},"k:{\"name\":\"RABBITMQ_USE_LONGNAME\"}":{".":{},"f:name":{},"f:value":{}}},"f:image":{},"f:imagePullPolicy":{},"f:lifecycle":{".":{},"f:preStop":{".":{},"f:exec":{".":{},"f:command":{}}}},"f:name":{},"f:ports":{".":{},"k:{\"containerPort\":4369,\"protocol\":\"TCP\"}":{".":{},"f:containerPort":{},"f:name":{},"f:protocol":{}},"k:{\"containerPort\":5672,\"protocol\":\"TCP\"}":{".":{},"f:containerPort":{},"f:name":{},"f:protocol":{}},"k:{\"containerPort\":15672,\"protocol\":\"TCP\"}":{".":{},"f:containerPort":{},"f:name":{},"f:protocol":{}},"k:{\"containerPort\":15692,\"protocol\":\"TCP\"}":{".":{},"f:containerPort":{},"f:name":{},"f:protocol":{}}},"f:readinessProbe":{".":{},"f:failureThreshold":{},"f:initialDelaySeconds":{},"f:periodSeconds":{},"f:successThreshold":{},"f:tcpSocket":{".":{},"f:port":{}},"f:timeoutSeconds":{}},"f:resources":{".":{},"f:limits":{".":{},"f:cpu":{},"f:memory":{}},"f:requests":{".":{},"f:cpu":{},"f:memory":{}}},"f:terminationMessagePath":{},"f:terminationMessagePolicy":{},"f:volumeMounts":{".":{},"k:{\"mountPath\":\"/etc/pod-info/\"}":{".":{},"f:mountPath":{},"f:name":{}},"k:{\"mountPath\":\"/etc/rabbitmq/conf.d/10-operatorDefaults.conf\"}":{".":{},"f:mountPath":{},"f:name":{},"f:subPath":{}},"k:{\"mountPath\":\"/etc/rabbitmq/conf.d/11-default_user.conf\"}":{".":{},"f:mountPath":{},"f:name":{},"f:subPath":{}},"k:{\"mountPath\":\"/etc/rabbitmq/conf.d/90-userDefinedConfiguration.conf\"}":{".":{},"f:mountPath":{},"f:name":{},"f:subPath":{}},"k:{\"mountPath\":\"/operator\"}":{".":{},"f:mountPath":{},"f:name":{}},"k:{\"mountPath\":\"/var/lib/rabbitmq/\"}":{".":{},"f:mountPath":{},"f:name":{}},"k:{\"mountPath\":\"/var/lib/rabbitmq/mnesia/\"}":{".":{},"f:mountPath":{},"f:name":{}}}}},"f:dnsPolicy":{},"f:initContainers":{".":{},"k:{\"name\":\"setup-container\"}":{".":{},"f:command":{},"f:image":{},"f:imagePullPolicy":{},"f:name":{},"f:resources":{".":{},"f:limits":{".":{},"f:cpu":{},"f:memory":{}},"f:requests":{".":{},"f:cpu":{},"f:memory":{}}},"f:securityContext":{".":{},"f:capabilities":{".":{},"f:drop":{}},"f:runAsUser":{}},"f:terminationMessagePath":{},"f:terminationMessagePolicy":{},"f:volumeMounts":{".":{},"k:{\"mountPath\":\"/operator\"}":{".":{},"f:mountPath":{},"f:name":{}},"k:{\"mountPath\":\"/tmp/default_user.conf\"}":{".":{},"f:mountPath":{},"f:name":{},"f:subPath":{}},"k:{\"mountPath\":\"/tmp/erlang-cookie-secret/\"}":{".":{},"f:mountPath":{},"f:name":{}},"k:{\"mountPath\":\"/tmp/rabbitmq-plugins/\"}":{".":{},"f:mountPath":{},"f:name":{}},"k:{\"mountPath\":\"/var/lib/rabbitmq/\"}":{".":{},"f:mountPath":{},"f:name":{}},"k:{\"mountPath\":\"/var/lib/rabbitmq/mnesia/\"}":{".":{},"f:mountPath":{},"f:name":{}}}}},"f:restartPolicy":{},"f:schedulerName":{},"f:securityContext":{".":{},"f:fsGroup":{},"f:runAsGroup":{},"f:runAsUser":{}},"f:serviceAccount":{},"f:serviceAccountName":{},"f:terminationGracePeriodSeconds":{},"f:topologySpreadConstraints":{".":{},"k:{\"topologyKey\":\"topology.kubernetes.io/zone\",\"whenUnsatisfiable\":\"ScheduleAnyway\"}":{".":{},"f:labelSelector":{".":{},"f:matchLabels":{".":{},"f:app.kubernetes.io/name":{}}},"f:maxSkew":{},"f:topologyKey":{},"f:whenUnsatisfiable":{}}},"f:volumes":{".":{},"k:{\"name\":\"erlang-cookie-secret\"}":{".":{},"f:name":{},"f:secret":{".":{},"f:defaultMode":{},"f:secretName":{}}},"k:{\"name\":\"plugins-conf\"}":{".":{},"f:configMap":{".":{},"f:defaultMode":{},"f:name":{}},"f:name":{}},"k:{\"name\":\"pod-info\"}":{".":{},"f:downwardAPI":{".":{},"f:defaultMode":{},"f:items":{}},"f:name":{}},"k:{\"name\":\"rabbitmq-confd\"}":{".":{},"f:name":{},"f:projected":{".":{},"f:defaultMode":{},"f:sources":{}}},"k:{\"name\":\"rabbitmq-erlang-cookie\"}":{".":{},"f:emptyDir":{},"f:name":{}},"k:{\"name\":\"rabbitmq-plugins\"}":{".":{},"f:emptyDir":{},"f:name":{}}}}},"f:updateStrategy":{"f:rollingUpdate":{".":{},"f:partition":{}},"f:type":{}},"f:volumeClaimTemplates":{}}}},{"manager":"kube-controller-manager","operation":"Update","apiVersion":"apps/v1","time":"2022-03-18T18:07:23Z","fieldsType":"FieldsV1","fieldsV1":{"f:status":{"f:collisionCount":{},"f:currentReplicas":{},"f:currentRevision":{},"f:observedGeneration":{},"f:readyReplicas":{},"f:replicas":{},"f:updateRevision":{},"f:updatedReplicas":{}}}}]},"spec":{"replicas":1,"selector":{"matchLabels":{"app.kubernetes.io/name":"rabbitmq-cluster"}},"template":{"metadata":{"creationTimestamp":null,"labels":{"app.kubernetes.io/component":"rabbitmq","app.kubernetes.io/name":"rabbitmq-cluster","app.kubernetes.io/part-of":"rabbitmq"},"annotations":{"prometheus.io/port":"15692","prometheus.io/scrape":"true"}},"spec":{"volumes":[{"name":"plugins-conf","configMap":{"name":"rabbitmq-cluster-plugins-conf","defaultMode":420}},{"name":"rabbitmq-confd","projected":{"sources":[{"secret":{"name":"rabbitmq-cluster-default-user","items":[{"key":"default_user.conf","path":"default_user.conf"}]}},{"configMap":{"name":"rabbitmq-cluster-server-conf","items":[{"key":"operatorDefaults.conf","path":"operatorDefaults.conf"},{"key":"userDefinedConfiguration.conf","path":"userDefinedConfiguration.conf"}]}}],"defaultMode":420}},{"name":"rabbitmq-erlang-cookie","emptyDir":{}},{"name":"erlang-cookie-secret","secret":{"secretName":"rabbitmq-cluster-erlang-cookie","defaultMode":420}},{"name":"rabbitmq-plugins","emptyDir":{}},{"name":"pod-info","downwardAPI":{"items":[{"path":"skipPreStopChecks","fieldRef":{"apiVersion":"v1","fieldPath":"metadata.labels['skipPreStopChecks']"}}],"defaultMode":420}}],"initContainers":[{"name":"setup-container","image":"rabbitmq:3.8.12-management","command":["sh","-c","cp /tmp/erlang-cookie-secret/.erlang.cookie /var/lib/rabbitmq/.erlang.cookie \u0026\u0026 chown 999:999 /var/lib/rabbitmq/.erlang.cookie \u0026\u0026 chmod 600 /var/lib/rabbitmq/.erlang.cookie ; cp /tmp/rabbitmq-plugins/enabled_plugins /operator/enabled_plugins \u0026\u0026 chown 999:999 /operator/enabled_plugins ; chown 999:999 /var/lib/rabbitmq/mnesia/ ; echo '[default]' \u003e /var/lib/rabbitmq/.rabbitmqadmin.conf \u0026\u0026 sed -e 's/default_user/username/' -e 's/default_pass/password/' /tmp/default_user.conf \u003e\u003e /var/lib/rabbitmq/.rabbitmqadmin.conf \u0026\u0026 chown 999:999 /var/lib/rabbitmq/.rabbitmqadmin.conf \u0026\u0026 chmod 600 /var/lib/rabbitmq/.rabbitmqadmin.conf"],"resources":{"limits":{"cpu":"100m","memory":"500Mi"},"requests":{"cpu":"100m","memory":"500Mi"}},"volumeMounts":[{"name":"plugins-conf","mountPath":"/tmp/rabbitmq-plugins/"},{"name":"rabbitmq-erlang-cookie","mountPath":"/var/lib/rabbitmq/"},{"name":"erlang-cookie-secret","mountPath":"/tmp/erlang-cookie-secret/"},{"name":"rabbitmq-plugins","mountPath":"/operator"},{"name":"persistence","mountPath":"/var/lib/rabbitmq/mnesia/"},{"name":"rabbitmq-confd","mountPath":"/tmp/default_user.conf","subPath":"default_user.conf"}],"terminationMessagePath":"/dev/termination-log","terminationMessagePolicy":"File","imagePullPolicy":"IfNotPresent","securityContext":{"capabilities":{"drop":["FSETID","KILL","SETGID","SETUID","SETPCAP","NET_BIND_SERVICE","NET_RAW","SYS_CHROOT","MKNOD","AUDIT_WRITE","SETFCAP"]},"runAsUser":0}}],"containers":[{"name":"rabbitmq","image":"rabbitmq:3.8.12-management","ports":[{"name":"epmd","containerPort":4369,"protocol":"TCP"},{"name":"amqp","containerPort":5672,"protocol":"TCP"},{"name":"management","containerPort":15672,"protocol":"TCP"},{"name":"prometheus","containerPort":15692,"protocol":"TCP"}],"env":[{"name":"MY_POD_NAME","valueFrom":{"fieldRef":{"apiVersion":"v1","fieldPath":"metadata.name"}}},{"name":"MY_POD_NAMESPACE","valueFrom":{"fieldRef":{"apiVersion":"v1","fieldPath":"metadata.namespace"}}},{"name":"RABBITMQ_ENABLED_PLUGINS_FILE","value":"/operator/enabled_plugins"},{"name":"K8S_SERVICE_NAME","value":"rabbitmq-cluster-nodes"},{"name":"RABBITMQ_USE_LONGNAME","value":"true"},{"name":"RABBITMQ_NODENAME","value":"rabbit@$(MY_POD_NAME).$(K8S_SERVICE_NAME).$(MY_POD_NAMESPACE)"},{"name":"K8S_HOSTNAME_SUFFIX","value":".$(K8S_SERVICE_NAME).$(MY_POD_NAMESPACE)"}],"resources":{"limits":{"cpu":"2","memory":"2Gi"},"requests":{"cpu":"1","memory":"2Gi"}},"volumeMounts":[{"name":"rabbitmq-erlang-cookie","mountPath":"/var/lib/rabbitmq/"},{"name":"persistence","mountPath":"/var/lib/rabbitmq/mnesia/"},{"name":"rabbitmq-plugins","mountPath":"/operator"},{"name":"rabbitmq-confd","mountPath":"/etc/rabbitmq/conf.d/10-operatorDefaults.conf","subPath":"operatorDefaults.conf"},{"name":"rabbitmq-confd","mountPath":"/etc/rabbitmq/conf.d/11-default_user.conf","subPath":"default_user.conf"},{"name":"rabbitmq-confd","mountPath":"/etc/rabbitmq/conf.d/90-userDefinedConfiguration.conf","subPath":"userDefinedConfiguration.conf"},{"name":"pod-info","mountPath":"/etc/pod-info/"}],"readinessProbe":{"tcpSocket":{"port":"amqp"},"initialDelaySeconds":10,"timeoutSeconds":5,"periodSeconds":10,"successThreshold":1,"failureThreshold":3},"lifecycle":{"preStop":{"exec":{"command":["/bin/bash","-c","if [ ! -z \"$(cat /etc/pod-info/skipPreStopChecks)\" ]; then exit 0; fi; rabbitmq-upgrade await_online_quorum_plus_one -t 604800; rabbitmq-upgrade await_online_synchronized_mirror -t 604800; rabbitmq-upgrade drain -t 604800"]}}},"terminationMessagePath":"/dev/termination-log","terminationMessagePolicy":"File","imagePullPolicy":"IfNotPresent"}],"restartPolicy":"Always","terminationGracePeriodSeconds":604800,"dnsPolicy":"ClusterFirst","serviceAccountName":"rabbitmq-cluster-server","serviceAccount":"rabbitmq-cluster-server","automountServiceAccountToken":true,"securityContext":{"runAsUser":999,"runAsGroup":999,"fsGroup":999},"schedulerName":"default-scheduler","topologySpreadConstraints":[{"maxSkew":1,"topologyKey":"topology.kubernetes.io/zone","whenUnsatisfiable":"ScheduleAnyway","labelSelector":{"matchLabels":{"app.kubernetes.io/name":"rabbitmq-cluster"}}}]}},"volumeClaimTemplates":[{"metadata":{"name":"persistence","namespace":"default","creationTimestamp":null,"labels":{"app.kubernetes.io/component":"rabbitmq","app.kubernetes.io/name":"rabbitmq-cluster","app.kubernetes.io/part-of":"rabbitmq"},"ownerReferences":[{"apiVersion":"rabbitmq.com/v1beta1","kind":"RabbitmqCluster","name":"rabbitmq-cluster","uid":"3ecefa8a-1bec-48a7-9af4-dd0df3339101","controller":true,"blockOwnerDeletion":false}]},"spec":{"accessModes":["ReadWriteOnce"],"resources":{"requests":{"storage":"10Gi"}},"volumeMode":"Filesystem"},"status":{"phase":"Pending"}}],"serviceName":"rabbitmq-cluster-nodes","podManagementPolicy":"Parallel","updateStrategy":{"type":"RollingUpdate","rollingUpdate":{"partition":0}},"revisionHistoryLimit":10},"status":{"observedGeneration":1,"replicas":1,"readyReplicas":1,"currentReplicas":1,"updatedReplicas":1,"currentRevision":"rabbitmq-cluster-server-5f8b8665fb","updateRevision":"rabbitmq-cluster-server-5f8b8665fb","collisionCount":0}}
2022/03/18 18:07:31 learn_server.go:279: [SIEVE-BEFORE-HEAR]	23	Updated	statefulset	{"metadata":{"name":"rabbitmq-cluster-server","namespace":"default","selfLink":"/apis/apps/v1/namespaces/default/statefulsets/rabbitmq-cluster-server","uid":"f2f07f3e-b500-4c48-a5de-8db7eaf37b9a","resourceVersion":"1441","generation":2,"creationTimestamp":"2022-03-18T18:06:25Z","deletionTimestamp":"2022-03-18T18:07:31Z","deletionGracePeriodSeconds":0,"labels":{"app.kubernetes.io/component":"rabbitmq","app.kubernetes.io/name":"rabbitmq-cluster","app.kubernetes.io/part-of":"rabbitmq"},"ownerReferences":[{"apiVersion":"rabbitmq.com/v1beta1","kind":"RabbitmqCluster","name":"rabbitmq-cluster","uid":"3ecefa8a-1bec-48a7-9af4-dd0df3339101","controller":true,"blockOwnerDeletion":true}],"finalizers":["orphan"],"managedFields":[{"manager":"manager","operation":"Update","apiVersion":"apps/v1","time":"2022-03-18T18:06:25Z","fieldsType":"FieldsV1","fieldsV1":{"f:metadata":{"f:labels":{".":{},"f:app.kubernetes.io/component":{},"f:app.kubernetes.io/name":{},"f:app.kubernetes.io/part-of":{}},"f:ownerReferences":{".":{},"k:{\"uid\":\"3ecefa8a-1bec-48a7-9af4-dd0df3339101\"}":{".":{},"f:apiVersion":{},"f:blockOwnerDeletion":{},"f:controller":{},"f:kind":{},"f:name":{},"f:uid":{}}}},"f:spec":{"f:podManagementPolicy":{},"f:replicas":{},"f:revisionHistoryLimit":{},"f:selector":{"f:matchLabels":{".":{},"f:app.kubernetes.io/name":{}}},"f:serviceName":{},"f:template":{"f:metadata":{"f:annotations":{".":{},"f:prometheus.io/port":{},"f:prometheus.io/scrape":{}},"f:labels":{".":{},"f:app.kubernetes.io/component":{},"f:app.kubernetes.io/name":{},"f:app.kubernetes.io/part-of":{}}},"f:spec":{"f:automountServiceAccountToken":{},"f:containers":{"k:{\"name\":\"rabbitmq\"}":{".":{},"f:env":{".":{},"k:{\"name\":\"K8S_HOSTNAME_SUFFIX\"}":{".":{},"f:name":{},"f:value":{}},"k:{\"name\":\"K8S_SERVICE_NAME\"}":{".":{},"f:name":{},"f:value":{}},"k:{\"name\":\"MY_POD_NAME\"}":{".":{},"f:name":{},"f:valueFrom":{".":{},"f:fieldRef":{".":{},"f:apiVersion":{},"f:fieldPath":{}}}},"k:{\"name\":\"MY_POD_NAMESPACE\"}":{".":{},"f:name":{},"f:valueFrom":{".":{},"f:fieldRef":{".":{},"f:apiVersion":{},"f:fieldPath":{}}}},"k:{\"name\":\"RABBITMQ_ENABLED_PLUGINS_FILE\"}":{".":{},"f:name":{},"f:value":{}},"k:{\"name\":\"RABBITMQ_NODENAME\"}":{".":{},"f:name":{},"f:value":{}},"k:{\"name\":\"RABBITMQ_USE_LONGNAME\"}":{".":{},"f:name":{},"f:value":{}}},"f:image":{},"f:imagePullPolicy":{},"f:lifecycle":{".":{},"f:preStop":{".":{},"f:exec":{".":{},"f:command":{}}}},"f:name":{},"f:ports":{".":{},"k:{\"containerPort\":4369,\"protocol\":\"TCP\"}":{".":{},"f:containerPort":{},"f:name":{},"f:protocol":{}},"k:{\"containerPort\":5672,\"protocol\":\"TCP\"}":{".":{},"f:containerPort":{},"f:name":{},"f:protocol":{}},"k:{\"containerPort\":15672,\"protocol\":\"TCP\"}":{".":{},"f:containerPort":{},"f:name":{},"f:protocol":{}},"k:{\"containerPort\":15692,\"protocol\":\"TCP\"}":{".":{},"f:containerPort":{},"f:name":{},"f:protocol":{}}},"f:readinessProbe":{".":{},"f:failureThreshold":{},"f:initialDelaySeconds":{},"f:periodSeconds":{},"f:successThreshold":{},"f:tcpSocket":{".":{},"f:port":{}},"f:timeoutSeconds":{}},"f:resources":{".":{},"f:limits":{".":{},"f:cpu":{},"f:memory":{}},"f:requests":{".":{},"f:cpu":{},"f:memory":{}}},"f:terminationMessagePath":{},"f:terminationMessagePolicy":{},"f:volumeMounts":{".":{},"k:{\"mountPath\":\"/etc/pod-info/\"}":{".":{},"f:mountPath":{},"f:name":{}},"k:{\"mountPath\":\"/etc/rabbitmq/conf.d/10-operatorDefaults.conf\"}":{".":{},"f:mountPath":{},"f:name":{},"f:subPath":{}},"k:{\"mountPath\":\"/etc/rabbitmq/conf.d/11-default_user.conf\"}":{".":{},"f:mountPath":{},"f:name":{},"f:subPath":{}},"k:{\"mountPath\":\"/etc/rabbitmq/conf.d/90-userDefinedConfiguration.conf\"}":{".":{},"f:mountPath":{},"f:name":{},"f:subPath":{}},"k:{\"mountPath\":\"/operator\"}":{".":{},"f:mountPath":{},"f:name":{}},"k:{\"mountPath\":\"/var/lib/rabbitmq/\"}":{".":{},"f:mountPath":{},"f:name":{}},"k:{\"mountPath\":\"/var/lib/rabbitmq/mnesia/\"}":{".":{},"f:mountPath":{},"f:name":{}}}}},"f:dnsPolicy":{},"f:initContainers":{".":{},"k:{\"name\":\"setup-container\"}":{".":{},"f:command":{},"f:image":{},"f:imagePullPolicy":{},"f:name":{},"f:resources":{".":{},"f:limits":{".":{},"f:cpu":{},"f:memory":{}},"f:requests":{".":{},"f:cpu":{},"f:memory":{}}},"f:securityContext":{".":{},"f:capabilities":{".":{},"f:drop":{}},"f:runAsUser":{}},"f:terminationMessagePath":{},"f:terminationMessagePolicy":{},"f:volumeMounts":{".":{},"k:{\"mountPath\":\"/operator\"}":{".":{},"f:mountPath":{},"f:name":{}},"k:{\"mountPath\":\"/tmp/default_user.conf\"}":{".":{},"f:mountPath":{},"f:name":{},"f:subPath":{}},"k:{\"mountPath\":\"/tmp/erlang-cookie-secret/\"}":{".":{},"f:mountPath":{},"f:name":{}},"k:{\"mountPath\":\"/tmp/rabbitmq-plugins/\"}":{".":{},"f:mountPath":{},"f:name":{}},"k:{\"mountPath\":\"/var/lib/rabbitmq/\"}":{".":{},"f:mountPath":{},"f:name":{}},"k:{\"mountPath\":\"/var/lib/rabbitmq/mnesia/\"}":{".":{},"f:mountPath":{},"f:name":{}}}}},"f:restartPolicy":{},"f:schedulerName":{},"f:securityContext":{".":{},"f:fsGroup":{},"f:runAsGroup":{},"f:runAsUser":{}},"f:serviceAccount":{},"f:serviceAccountName":{},"f:terminationGracePeriodSeconds":{},"f:topologySpreadConstraints":{".":{},"k:{\"topologyKey\":\"topology.kubernetes.io/zone\",\"whenUnsatisfiable\":\"ScheduleAnyway\"}":{".":{},"f:labelSelector":{".":{},"f:matchLabels":{".":{},"f:app.kubernetes.io/name":{}}},"f:maxSkew":{},"f:topologyKey":{},"f:whenUnsatisfiable":{}}},"f:volumes":{".":{},"k:{\"name\":\"erlang-cookie-secret\"}":{".":{},"f:name":{},"f:secret":{".":{},"f:defaultMode":{},"f:secretName":{}}},"k:{\"name\":\"plugins-conf\"}":{".":{},"f:configMap":{".":{},"f:defaultMode":{},"f:name":{}},"f:name":{}},"k:{\"name\":\"pod-info\"}":{".":{},"f:downwardAPI":{".":{},"f:defaultMode":{},"f:items":{}},"f:name":{}},"k:{\"name\":\"rabbitmq-confd\"}":{".":{},"f:name":{},"f:projected":{".":{},"f:defaultMode":{},"f:sources":{}}},"k:{\"name\":\"rabbitmq-erlang-cookie\"}":{".":{},"f:emptyDir":{},"f:name":{}},"k:{\"name\":\"rabbitmq-plugins\"}":{".":{},"f:emptyDir":{},"f:name":{}}}}},"f:updateStrategy":{"f:rollingUpdate":{".":{},"f:partition":{}},"f:type":{}},"f:volumeClaimTemplates":{}}}},{"manager":"kube-controller-manager","operation":"Update","apiVersion":"apps/v1","time":"2022-03-18T18:07:23Z","fieldsType":"FieldsV1","fieldsV1":{"f:status":{"f:collisionCount":{},"f:currentReplicas":{},"f:currentRevision":{},"f:observedGeneration":{},"f:readyReplicas":{},"f:replicas":{},"f:updateRevision":{},"f:updatedReplicas":{}}}}]},"spec":{"replicas":1,"selector":{"matchLabels":{"app.kubernetes.io/name":"rabbitmq-cluster"}},"template":{"metadata":{"creationTimestamp":null,"labels":{"app.kubernetes.io/component":"rabbitmq","app.kubernetes.io/name":"rabbitmq-cluster","app.kubernetes.io/part-of":"rabbitmq"},"annotations":{"prometheus.io/port":"15692","prometheus.io/scrape":"true"}},"spec":{"volumes":[{"name":"plugins-conf","configMap":{"name":"rabbitmq-cluster-plugins-conf","defaultMode":420}},{"name":"rabbitmq-confd","projected":{"sources":[{"secret":{"name":"rabbitmq-cluster-default-user","items":[{"key":"default_user.conf","path":"default_user.conf"}]}},{"configMap":{"name":"rabbitmq-cluster-server-conf","items":[{"key":"operatorDefaults.conf","path":"operatorDefaults.conf"},{"key":"userDefinedConfiguration.conf","path":"userDefinedConfiguration.conf"}]}}],"defaultMode":420}},{"name":"rabbitmq-erlang-cookie","emptyDir":{}},{"name":"erlang-cookie-secret","secret":{"secretName":"rabbitmq-cluster-erlang-cookie","defaultMode":420}},{"name":"rabbitmq-plugins","emptyDir":{}},{"name":"pod-info","downwardAPI":{"items":[{"path":"skipPreStopChecks","fieldRef":{"apiVersion":"v1","fieldPath":"metadata.labels['skipPreStopChecks']"}}],"defaultMode":420}}],"initContainers":[{"name":"setup-container","image":"rabbitmq:3.8.12-management","command":["sh","-c","cp /tmp/erlang-cookie-secret/.erlang.cookie /var/lib/rabbitmq/.erlang.cookie \u0026\u0026 chown 999:999 /var/lib/rabbitmq/.erlang.cookie \u0026\u0026 chmod 600 /var/lib/rabbitmq/.erlang.cookie ; cp /tmp/rabbitmq-plugins/enabled_plugins /operator/enabled_plugins \u0026\u0026 chown 999:999 /operator/enabled_plugins ; chown 999:999 /var/lib/rabbitmq/mnesia/ ; echo '[default]' \u003e /var/lib/rabbitmq/.rabbitmqadmin.conf \u0026\u0026 sed -e 's/default_user/username/' -e 's/default_pass/password/' /tmp/default_user.conf \u003e\u003e /var/lib/rabbitmq/.rabbitmqadmin.conf \u0026\u0026 chown 999:999 /var/lib/rabbitmq/.rabbitmqadmin.conf \u0026\u0026 chmod 600 /var/lib/rabbitmq/.rabbitmqadmin.conf"],"resources":{"limits":{"cpu":"100m","memory":"500Mi"},"requests":{"cpu":"100m","memory":"500Mi"}},"volumeMounts":[{"name":"plugins-conf","mountPath":"/tmp/rabbitmq-plugins/"},{"name":"rabbitmq-erlang-cookie","mountPath":"/var/lib/rabbitmq/"},{"name":"erlang-cookie-secret","mountPath":"/tmp/erlang-cookie-secret/"},{"name":"rabbitmq-plugins","mountPath":"/operator"},{"name":"persistence","mountPath":"/var/lib/rabbitmq/mnesia/"},{"name":"rabbitmq-confd","mountPath":"/tmp/default_user.conf","subPath":"default_user.conf"}],"terminationMessagePath":"/dev/termination-log","terminationMessagePolicy":"File","imagePullPolicy":"IfNotPresent","securityContext":{"capabilities":{"drop":["FSETID","KILL","SETGID","SETUID","SETPCAP","NET_BIND_SERVICE","NET_RAW","SYS_CHROOT","MKNOD","AUDIT_WRITE","SETFCAP"]},"runAsUser":0}}],"containers":[{"name":"rabbitmq","image":"rabbitmq:3.8.12-management","ports":[{"name":"epmd","containerPort":4369,"protocol":"TCP"},{"name":"amqp","containerPort":5672,"protocol":"TCP"},{"name":"management","containerPort":15672,"protocol":"TCP"},{"name":"prometheus","containerPort":15692,"protocol":"TCP"}],"env":[{"name":"MY_POD_NAME","valueFrom":{"fieldRef":{"apiVersion":"v1","fieldPath":"metadata.name"}}},{"name":"MY_POD_NAMESPACE","valueFrom":{"fieldRef":{"apiVersion":"v1","fieldPath":"metadata.namespace"}}},{"name":"RABBITMQ_ENABLED_PLUGINS_FILE","value":"/operator/enabled_plugins"},{"name":"K8S_SERVICE_NAME","value":"rabbitmq-cluster-nodes"},{"name":"RABBITMQ_USE_LONGNAME","value":"true"},{"name":"RABBITMQ_NODENAME","value":"rabbit@$(MY_POD_NAME).$(K8S_SERVICE_NAME).$(MY_POD_NAMESPACE)"},{"name":"K8S_HOSTNAME_SUFFIX","value":".$(K8S_SERVICE_NAME).$(MY_POD_NAMESPACE)"}],"resources":{"limits":{"cpu":"2","memory":"2Gi"},"requests":{"cpu":"1","memory":"2Gi"}},"volumeMounts":[{"name":"rabbitmq-erlang-cookie","mountPath":"/var/lib/rabbitmq/"},{"name":"persistence","mountPath":"/var/lib/rabbitmq/mnesia/"},{"name":"rabbitmq-plugins","mountPath":"/operator"},{"name":"rabbitmq-confd","mountPath":"/etc/rabbitmq/conf.d/10-operatorDefaults.conf","subPath":"operatorDefaults.conf"},{"name":"rabbitmq-confd","mountPath":"/etc/rabbitmq/conf.d/11-default_user.conf","subPath":"default_user.conf"},{"name":"rabbitmq-confd","mountPath":"/etc/rabbitmq/conf.d/90-userDefinedConfiguration.conf","subPath":"userDefinedConfiguration.conf"},{"name":"pod-info","mountPath":"/etc/pod-info/"}],"readinessProbe":{"tcpSocket":{"port":"amqp"},"initialDelaySeconds":10,"timeoutSeconds":5,"periodSeconds":10,"successThreshold":1,"failureThreshold":3},"lifecycle":{"preStop":{"exec":{"command":["/bin/bash","-c","if [ ! -z \"$(cat /etc/pod-info/skipPreStopChecks)\" ]; then exit 0; fi; rabbitmq-upgrade await_online_quorum_plus_one -t 604800; rabbitmq-upgrade await_online_synchronized_mirror -t 604800; rabbitmq-upgrade drain -t 604800"]}}},"terminationMessagePath":"/dev/termination-log","terminationMessagePolicy":"File","imagePullPolicy":"IfNotPresent"}],"restartPolicy":"Always","terminationGracePeriodSeconds":604800,"dnsPolicy":"ClusterFirst","serviceAccountName":"rabbitmq-cluster-server","serviceAccount":"rabbitmq-cluster-server","automountServiceAccountToken":true,"securityContext":{"runAsUser":999,"runAsGroup":999,"fsGroup":999},"schedulerName":"default-scheduler","topologySpreadConstraints":[{"maxSkew":1,"topologyKey":"topology.kubernetes.io/zone","whenUnsatisfiable":"ScheduleAnyway","labelSelector":{"matchLabels":{"app.kubernetes.io/name":"rabbitmq-cluster"}}}]}},"volumeClaimTemplates":[{"metadata":{"name":"persistence","namespace":"default","creationTimestamp":null,"labels":{"app.kubernetes.io/component":"rabbitmq","app.kubernetes.io/name":"rabbitmq-cluster","app.kubernetes.io/part-of":"rabbitmq"},"ownerReferences":[{"apiVersion":"rabbitmq.com/v1beta1","kind":"RabbitmqCluster","name":"rabbitmq-cluster","uid":"3ecefa8a-1bec-48a7-9af4-dd0df3339101","controller":true,"blockOwnerDeletion":false}]},"spec":{"accessModes":["ReadWriteOnce"],"resources":{"requests":{"storage":"10Gi"}},"volumeMode":"Filesystem"},"status":{"phase":"Pending"}}],"serviceName":"rabbitmq-cluster-nodes","podManagementPolicy":"Parallel","updateStrategy":{"type":"RollingUpdate","rollingUpdate":{"partition":0}},"revisionHistoryLimit":10},"status":{"observedGeneration":1,"replicas":1,"readyReplicas":1,"currentReplicas":1,"updatedReplicas":1,"currentRevision":"rabbitmq-cluster-server-5f8b8665fb","updateRevision":"rabbitmq-cluster-server-5f8b8665fb","collisionCount":0}}
2022/03/18 18:07:31 learn_server.go:289: [SIEVE-AFTER-HEAR]	23
2022/03/18 18:07:31 learn_server.go:291: [SIEVE-AFTER-READ]	Get	true	statefulset	default	rabbitmq-cluster-server	github.com/rabbitmq/cluster-operator/controllers.(*RabbitmqClusterReconciler)	NoError	{"kind":"StatefulSet","apiVersion":"apps/v1","metadata":{"name":"rabbitmq-cluster-server","namespace":"default","selfLink":"/apis/apps/v1/namespaces/default/statefulsets/rabbitmq-cluster-server","uid":"f2f07f3e-b500-4c48-a5de-8db7eaf37b9a","resourceVersion":"1441","generation":2,"creationTimestamp":"2022-03-18T18:06:25Z","deletionTimestamp":"2022-03-18T18:07:31Z","deletionGracePeriodSeconds":0,"labels":{"app.kubernetes.io/component":"rabbitmq","app.kubernetes.io/name":"rabbitmq-cluster","app.kubernetes.io/part-of":"rabbitmq"},"ownerReferences":[{"apiVersion":"rabbitmq.com/v1beta1","kind":"RabbitmqCluster","name":"rabbitmq-cluster","uid":"3ecefa8a-1bec-48a7-9af4-dd0df3339101","controller":true,"blockOwnerDeletion":true}],"finalizers":["orphan"],"managedFields":[{"manager":"manager","operation":"Update","apiVersion":"apps/v1","time":"2022-03-18T18:06:25Z","fieldsType":"FieldsV1","fieldsV1":{"f:metadata":{"f:labels":{".":{},"f:app.kubernetes.io/component":{},"f:app.kubernetes.io/name":{},"f:app.kubernetes.io/part-of":{}},"f:ownerReferences":{".":{},"k:{\"uid\":\"3ecefa8a-1bec-48a7-9af4-dd0df3339101\"}":{".":{},"f:apiVersion":{},"f:blockOwnerDeletion":{},"f:controller":{},"f:kind":{},"f:name":{},"f:uid":{}}}},"f:spec":{"f:podManagementPolicy":{},"f:replicas":{},"f:revisionHistoryLimit":{},"f:selector":{"f:matchLabels":{".":{},"f:app.kubernetes.io/name":{}}},"f:serviceName":{},"f:template":{"f:metadata":{"f:annotations":{".":{},"f:prometheus.io/port":{},"f:prometheus.io/scrape":{}},"f:labels":{".":{},"f:app.kubernetes.io/component":{},"f:app.kubernetes.io/name":{},"f:app.kubernetes.io/part-of":{}}},"f:spec":{"f:automountServiceAccountToken":{},"f:containers":{"k:{\"name\":\"rabbitmq\"}":{".":{},"f:env":{".":{},"k:{\"name\":\"K8S_HOSTNAME_SUFFIX\"}":{".":{},"f:name":{},"f:value":{}},"k:{\"name\":\"K8S_SERVICE_NAME\"}":{".":{},"f:name":{},"f:value":{}},"k:{\"name\":\"MY_POD_NAME\"}":{".":{},"f:name":{},"f:valueFrom":{".":{},"f:fieldRef":{".":{},"f:apiVersion":{},"f:fieldPath":{}}}},"k:{\"name\":\"MY_POD_NAMESPACE\"}":{".":{},"f:name":{},"f:valueFrom":{".":{},"f:fieldRef":{".":{},"f:apiVersion":{},"f:fieldPath":{}}}},"k:{\"name\":\"RABBITMQ_ENABLED_PLUGINS_FILE\"}":{".":{},"f:name":{},"f:value":{}},"k:{\"name\":\"RABBITMQ_NODENAME\"}":{".":{},"f:name":{},"f:value":{}},"k:{\"name\":\"RABBITMQ_USE_LONGNAME\"}":{".":{},"f:name":{},"f:value":{}}},"f:image":{},"f:imagePullPolicy":{},"f:lifecycle":{".":{},"f:preStop":{".":{},"f:exec":{".":{},"f:command":{}}}},"f:name":{},"f:ports":{".":{},"k:{\"containerPort\":4369,\"protocol\":\"TCP\"}":{".":{},"f:containerPort":{},"f:name":{},"f:protocol":{}},"k:{\"containerPort\":5672,\"protocol\":\"TCP\"}":{".":{},"f:containerPort":{},"f:name":{},"f:protocol":{}},"k:{\"containerPort\":15672,\"protocol\":\"TCP\"}":{".":{},"f:containerPort":{},"f:name":{},"f:protocol":{}},"k:{\"containerPort\":15692,\"protocol\":\"TCP\"}":{".":{},"f:containerPort":{},"f:name":{},"f:protocol":{}}},"f:readinessProbe":{".":{},"f:failureThreshold":{},"f:initialDelaySeconds":{},"f:periodSeconds":{},"f:successThreshold":{},"f:tcpSocket":{".":{},"f:port":{}},"f:timeoutSeconds":{}},"f:resources":{".":{},"f:limits":{".":{},"f:cpu":{},"f:memory":{}},"f:requests":{".":{},"f:cpu":{},"f:memory":{}}},"f:terminationMessagePath":{},"f:terminationMessagePolicy":{},"f:volumeMounts":{".":{},"k:{\"mountPath\":\"/etc/pod-info/\"}":{".":{},"f:mountPath":{},"f:name":{}},"k:{\"mountPath\":\"/etc/rabbitmq/conf.d/10-operatorDefaults.conf\"}":{".":{},"f:mountPath":{},"f:name":{},"f:subPath":{}},"k:{\"mountPath\":\"/etc/rabbitmq/conf.d/11-default_user.conf\"}":{".":{},"f:mountPath":{},"f:name":{},"f:subPath":{}},"k:{\"mountPath\":\"/etc/rabbitmq/conf.d/90-userDefinedConfiguration.conf\"}":{".":{},"f:mountPath":{},"f:name":{},"f:subPath":{}},"k:{\"mountPath\":\"/operator\"}":{".":{},"f:mountPath":{},"f:name":{}},"k:{\"mountPath\":\"/var/lib/rabbitmq/\"}":{".":{},"f:mountPath":{},"f:name":{}},"k:{\"mountPath\":\"/var/lib/rabbitmq/mnesia/\"}":{".":{},"f:mountPath":{},"f:name":{}}}}},"f:dnsPolicy":{},"f:initContainers":{".":{},"k:{\"name\":\"setup-container\"}":{".":{},"f:command":{},"f:image":{},"f:imagePullPolicy":{},"f:name":{},"f:resources":{".":{},"f:limits":{".":{},"f:cpu":{},"f:memory":{}},"f:requests":{".":{},"f:cpu":{},"f:memory":{}}},"f:securityContext":{".":{},"f:capabilities":{".":{},"f:drop":{}},"f:runAsUser":{}},"f:terminationMessagePath":{},"f:terminationMessagePolicy":{},"f:volumeMounts":{".":{},"k:{\"mountPath\":\"/operator\"}":{".":{},"f:mountPath":{},"f:name":{}},"k:{\"mountPath\":\"/tmp/default_user.conf\"}":{".":{},"f:mountPath":{},"f:name":{},"f:subPath":{}},"k:{\"mountPath\":\"/tmp/erlang-cookie-secret/\"}":{".":{},"f:mountPath":{},"f:name":{}},"k:{\"mountPath\":\"/tmp/rabbitmq-plugins/\"}":{".":{},"f:mountPath":{},"f:name":{}},"k:{\"mountPath\":\"/var/lib/rabbitmq/\"}":{".":{},"f:mountPath":{},"f:name":{}},"k:{\"mountPath\":\"/var/lib/rabbitmq/mnesia/\"}":{".":{},"f:mountPath":{},"f:name":{}}}}},"f:restartPolicy":{},"f:schedulerName":{},"f:securityContext":{".":{},"f:fsGroup":{},"f:runAsGroup":{},"f:runAsUser":{}},"f:serviceAccount":{},"f:serviceAccountName":{},"f:terminationGracePeriodSeconds":{},"f:topologySpreadConstraints":{".":{},"k:{\"topologyKey\":\"topology.kubernetes.io/zone\",\"whenUnsatisfiable\":\"ScheduleAnyway\"}":{".":{},"f:labelSelector":{".":{},"f:matchLabels":{".":{},"f:app.kubernetes.io/name":{}}},"f:maxSkew":{},"f:topologyKey":{},"f:whenUnsatisfiable":{}}},"f:volumes":{".":{},"k:{\"name\":\"erlang-cookie-secret\"}":{".":{},"f:name":{},"f:secret":{".":{},"f:defaultMode":{},"f:secretName":{}}},"k:{\"name\":\"plugins-conf\"}":{".":{},"f:configMap":{".":{},"f:defaultMode":{},"f:name":{}},"f:name":{}},"k:{\"name\":\"pod-info\"}":{".":{},"f:downwardAPI":{".":{},"f:defaultMode":{},"f:items":{}},"f:name":{}},"k:{\"name\":\"rabbitmq-confd\"}":{".":{},"f:name":{},"f:projected":{".":{},"f:defaultMode":{},"f:sources":{}}},"k:{\"name\":\"rabbitmq-erlang-cookie\"}":{".":{},"f:emptyDir":{},"f:name":{}},"k:{\"name\":\"rabbitmq-plugins\"}":{".":{},"f:emptyDir":{},"f:name":{}}}}},"f:updateStrategy":{"f:rollingUpdate":{".":{},"f:partition":{}},"f:type":{}},"f:volumeClaimTemplates":{}}}},{"manager":"kube-controller-manager","operation":"Update","apiVersion":"apps/v1","time":"2022-03-18T18:07:23Z","fieldsType":"FieldsV1","fieldsV1":{"f:status":{"f:collisionCount":{},"f:currentReplicas":{},"f:currentRevision":{},"f:observedGeneration":{},"f:readyReplicas":{},"f:replicas":{},"f:updateRevision":{},"f:updatedReplicas":{}}}}]},"spec":{"replicas":1,"selector":{"matchLabels":{"app.kubernetes.io/name":"rabbitmq-cluster"}},"template":{"metadata":{"creationTimestamp":null,"labels":{"app.kubernetes.io/component":"rabbitmq","app.kubernetes.io/name":"rabbitmq-cluster","app.kubernetes.io/part-of":"rabbitmq"},"annotations":{"prometheus.io/port":"15692","prometheus.io/scrape":"true"}},"spec":{"volumes":[{"name":"plugins-conf","configMap":{"name":"rabbitmq-cluster-plugins-conf","defaultMode":420}},{"name":"rabbitmq-confd","projected":{"sources":[{"secret":{"name":"rabbitmq-cluster-default-user","items":[{"key":"default_user.conf","path":"default_user.conf"}]}},{"configMap":{"name":"rabbitmq-cluster-server-conf","items":[{"key":"operatorDefaults.conf","path":"operatorDefaults.conf"},{"key":"userDefinedConfiguration.conf","path":"userDefinedConfiguration.conf"}]}}],"defaultMode":420}},{"name":"rabbitmq-erlang-cookie","emptyDir":{}},{"name":"erlang-cookie-secret","secret":{"secretName":"rabbitmq-cluster-erlang-cookie","defaultMode":420}},{"name":"rabbitmq-plugins","emptyDir":{}},{"name":"pod-info","downwardAPI":{"items":[{"path":"skipPreStopChecks","fieldRef":{"apiVersion":"v1","fieldPath":"metadata.labels['skipPreStopChecks']"}}],"defaultMode":420}}],"initContainers":[{"name":"setup-container","image":"rabbitmq:3.8.12-management","command":["sh","-c","cp /tmp/erlang-cookie-secret/.erlang.cookie /var/lib/rabbitmq/.erlang.cookie \u0026\u0026 chown 999:999 /var/lib/rabbitmq/.erlang.cookie \u0026\u0026 chmod 600 /var/lib/rabbitmq/.erlang.cookie ; cp /tmp/rabbitmq-plugins/enabled_plugins /operator/enabled_plugins \u0026\u0026 chown 999:999 /operator/enabled_plugins ; chown 999:999 /var/lib/rabbitmq/mnesia/ ; echo '[default]' \u003e /var/lib/rabbitmq/.rabbitmqadmin.conf \u0026\u0026 sed -e 's/default_user/username/' -e 's/default_pass/password/' /tmp/default_user.conf \u003e\u003e /var/lib/rabbitmq/.rabbitmqadmin.conf \u0026\u0026 chown 999:999 /var/lib/rabbitmq/.rabbitmqadmin.conf \u0026\u0026 chmod 600 /var/lib/rabbitmq/.rabbitmqadmin.conf"],"resources":{"limits":{"cpu":"100m","memory":"500Mi"},"requests":{"cpu":"100m","memory":"500Mi"}},"volumeMounts":[{"name":"plugins-conf","mountPath":"/tmp/rabbitmq-plugins/"},{"name":"rabbitmq-erlang-cookie","mountPath":"/var/lib/rabbitmq/"},{"name":"erlang-cookie-secret","mountPath":"/tmp/erlang-cookie-secret/"},{"name":"rabbitmq-plugins","mountPath":"/operator"},{"name":"persistence","mountPath":"/var/lib/rabbitmq/mnesia/"},{"name":"rabbitmq-confd","mountPath":"/tmp/default_user.conf","subPath":"default_user.conf"}],"terminationMessagePath":"/dev/termination-log","terminationMessagePolicy":"File","imagePullPolicy":"IfNotPresent","securityContext":{"capabilities":{"drop":["FSETID","KILL","SETGID","SETUID","SETPCAP","NET_BIND_SERVICE","NET_RAW","SYS_CHROOT","MKNOD","AUDIT_WRITE","SETFCAP"]},"runAsUser":0}}],"containers":[{"name":"rabbitmq","image":"rabbitmq:3.8.12-management","ports":[{"name":"epmd","containerPort":4369,"protocol":"TCP"},{"name":"amqp","containerPort":5672,"protocol":"TCP"},{"name":"management","containerPort":15672,"protocol":"TCP"},{"name":"prometheus","containerPort":15692,"protocol":"TCP"}],"env":[{"name":"MY_POD_NAME","valueFrom":{"fieldRef":{"apiVersion":"v1","fieldPath":"metadata.name"}}},{"name":"MY_POD_NAMESPACE","valueFrom":{"fieldRef":{"apiVersion":"v1","fieldPath":"metadata.namespace"}}},{"name":"RABBITMQ_ENABLED_PLUGINS_FILE","value":"/operator/enabled_plugins"},{"name":"K8S_SERVICE_NAME","value":"rabbitmq-cluster-nodes"},{"name":"RABBITMQ_USE_LONGNAME","value":"true"},{"name":"RABBITMQ_NODENAME","value":"rabbit@$(MY_POD_NAME).$(K8S_SERVICE_NAME).$(MY_POD_NAMESPACE)"},{"name":"K8S_HOSTNAME_SUFFIX","value":".$(K8S_SERVICE_NAME).$(MY_POD_NAMESPACE)"}],"resources":{"limits":{"cpu":"2","memory":"2Gi"},"requests":{"cpu":"1","memory":"2Gi"}},"volumeMounts":[{"name":"rabbitmq-erlang-cookie","mountPath":"/var/lib/rabbitmq/"},{"name":"persistence","mountPath":"/var/lib/rabbitmq/mnesia/"},{"name":"rabbitmq-plugins","mountPath":"/operator"},{"name":"rabbitmq-confd","mountPath":"/etc/rabbitmq/conf.d/10-operatorDefaults.conf","subPath":"operatorDefaults.conf"},{"name":"rabbitmq-confd","mountPath":"/etc/rabbitmq/conf.d/11-default_user.conf","subPath":"default_user.conf"},{"name":"rabbitmq-confd","mountPath":"/etc/rabbitmq/conf.d/90-userDefinedConfiguration.conf","subPath":"userDefinedConfiguration.conf"},{"name":"pod-info","mountPath":"/etc/pod-info/"}],"readinessProbe":{"tcpSocket":{"port":"amqp"},"initialDelaySeconds":10,"timeoutSeconds":5,"periodSeconds":10,"successThreshold":1,"failureThreshold":3},"lifecycle":{"preStop":{"exec":{"command":["/bin/bash","-c","if [ ! -z \"$(cat /etc/pod-info/skipPreStopChecks)\" ]; then exit 0; fi; rabbitmq-upgrade await_online_quorum_plus_one -t 604800; rabbitmq-upgrade await_online_synchronized_mirror -t 604800; rabbitmq-upgrade drain -t 604800"]}}},"terminationMessagePath":"/dev/termination-log","terminationMessagePolicy":"File","imagePullPolicy":"IfNotPresent"}],"restartPolicy":"Always","terminationGracePeriodSeconds":604800,"dnsPolicy":"ClusterFirst","serviceAccountName":"rabbitmq-cluster-server","serviceAccount":"rabbitmq-cluster-server","automountServiceAccountToken":true,"securityContext":{"runAsUser":999,"runAsGroup":999,"fsGroup":999},"schedulerName":"default-scheduler","topologySpreadConstraints":[{"maxSkew":1,"topologyKey":"topology.kubernetes.io/zone","whenUnsatisfiable":"ScheduleAnyway","labelSelector":{"matchLabels":{"app.kubernetes.io/name":"rabbitmq-cluster"}}}]}},"volumeClaimTemplates":[{"metadata":{"name":"persistence","namespace":"default","creationTimestamp":null,"labels":{"app.kubernetes.io/component":"rabbitmq","app.kubernetes.io/name":"rabbitmq-cluster","app.kubernetes.io/part-of":"rabbitmq"},"ownerReferences":[{"apiVersion":"rabbitmq.com/v1beta1","kind":"RabbitmqCluster","name":"rabbitmq-cluster","uid":"3ecefa8a-1bec-48a7-9af4-dd0df3339101","controller":true,"blockOwnerDeletion":false}]},"spec":{"accessModes":["ReadWriteOnce"],"resources":{"requests":{"storage":"10Gi"}},"volumeMode":"Filesystem"},"status":{"phase":"Pending"}}],"serviceName":"rabbitmq-cluster-nodes","podManagementPolicy":"Parallel","updateStrategy":{"type":"RollingUpdate","rollingUpdate":{"partition":0}},"revisionHistoryLimit":10},"status":{"observedGeneration":1,"replicas":1,"readyReplicas":1,"currentReplicas":1,"updatedReplicas":1,"currentRevision":"rabbitmq-cluster-server-5f8b8665fb","updateRevision":"rabbitmq-cluster-server-5f8b8665fb","collisionCount":0}}
2022/03/18 18:07:31 learn_server.go:279: [SIEVE-BEFORE-HEAR]	24	Updated	statefulset	{"metadata":{"name":"rabbitmq-cluster-server","namespace":"default","selfLink":"/apis/apps/v1/namespaces/default/statefulsets/rabbitmq-cluster-server","uid":"f2f07f3e-b500-4c48-a5de-8db7eaf37b9a","resourceVersion":"1443","generation":2,"creationTimestamp":"2022-03-18T18:06:25Z","deletionTimestamp":"2022-03-18T18:07:31Z","deletionGracePeriodSeconds":0,"labels":{"app.kubernetes.io/component":"rabbitmq","app.kubernetes.io/name":"rabbitmq-cluster","app.kubernetes.io/part-of":"rabbitmq"},"ownerReferences":[{"apiVersion":"rabbitmq.com/v1beta1","kind":"RabbitmqCluster","name":"rabbitmq-cluster","uid":"3ecefa8a-1bec-48a7-9af4-dd0df3339101","controller":true,"blockOwnerDeletion":true}],"finalizers":["orphan"],"managedFields":[{"manager":"manager","operation":"Update","apiVersion":"apps/v1","time":"2022-03-18T18:06:25Z","fieldsType":"FieldsV1","fieldsV1":{"f:metadata":{"f:labels":{".":{},"f:app.kubernetes.io/component":{},"f:app.kubernetes.io/name":{},"f:app.kubernetes.io/part-of":{}},"f:ownerReferences":{".":{},"k:{\"uid\":\"3ecefa8a-1bec-48a7-9af4-dd0df3339101\"}":{".":{},"f:apiVersion":{},"f:blockOwnerDeletion":{},"f:controller":{},"f:kind":{},"f:name":{},"f:uid":{}}}},"f:spec":{"f:podManagementPolicy":{},"f:replicas":{},"f:revisionHistoryLimit":{},"f:selector":{"f:matchLabels":{".":{},"f:app.kubernetes.io/name":{}}},"f:serviceName":{},"f:template":{"f:metadata":{"f:annotations":{".":{},"f:prometheus.io/port":{},"f:prometheus.io/scrape":{}},"f:labels":{".":{},"f:app.kubernetes.io/component":{},"f:app.kubernetes.io/name":{},"f:app.kubernetes.io/part-of":{}}},"f:spec":{"f:automountServiceAccountToken":{},"f:containers":{"k:{\"name\":\"rabbitmq\"}":{".":{},"f:env":{".":{},"k:{\"name\":\"K8S_HOSTNAME_SUFFIX\"}":{".":{},"f:name":{},"f:value":{}},"k:{\"name\":\"K8S_SERVICE_NAME\"}":{".":{},"f:name":{},"f:value":{}},"k:{\"name\":\"MY_POD_NAME\"}":{".":{},"f:name":{},"f:valueFrom":{".":{},"f:fieldRef":{".":{},"f:apiVersion":{},"f:fieldPath":{}}}},"k:{\"name\":\"MY_POD_NAMESPACE\"}":{".":{},"f:name":{},"f:valueFrom":{".":{},"f:fieldRef":{".":{},"f:apiVersion":{},"f:fieldPath":{}}}},"k:{\"name\":\"RABBITMQ_ENABLED_PLUGINS_FILE\"}":{".":{},"f:name":{},"f:value":{}},"k:{\"name\":\"RABBITMQ_NODENAME\"}":{".":{},"f:name":{},"f:value":{}},"k:{\"name\":\"RABBITMQ_USE_LONGNAME\"}":{".":{},"f:name":{},"f:value":{}}},"f:image":{},"f:imagePullPolicy":{},"f:lifecycle":{".":{},"f:preStop":{".":{},"f:exec":{".":{},"f:command":{}}}},"f:name":{},"f:ports":{".":{},"k:{\"containerPort\":4369,\"protocol\":\"TCP\"}":{".":{},"f:containerPort":{},"f:name":{},"f:protocol":{}},"k:{\"containerPort\":5672,\"protocol\":\"TCP\"}":{".":{},"f:containerPort":{},"f:name":{},"f:protocol":{}},"k:{\"containerPort\":15672,\"protocol\":\"TCP\"}":{".":{},"f:containerPort":{},"f:name":{},"f:protocol":{}},"k:{\"containerPort\":15692,\"protocol\":\"TCP\"}":{".":{},"f:containerPort":{},"f:name":{},"f:protocol":{}}},"f:readinessProbe":{".":{},"f:failureThreshold":{},"f:initialDelaySeconds":{},"f:periodSeconds":{},"f:successThreshold":{},"f:tcpSocket":{".":{},"f:port":{}},"f:timeoutSeconds":{}},"f:resources":{".":{},"f:limits":{".":{},"f:cpu":{},"f:memory":{}},"f:requests":{".":{},"f:cpu":{},"f:memory":{}}},"f:terminationMessagePath":{},"f:terminationMessagePolicy":{},"f:volumeMounts":{".":{},"k:{\"mountPath\":\"/etc/pod-info/\"}":{".":{},"f:mountPath":{},"f:name":{}},"k:{\"mountPath\":\"/etc/rabbitmq/conf.d/10-operatorDefaults.conf\"}":{".":{},"f:mountPath":{},"f:name":{},"f:subPath":{}},"k:{\"mountPath\":\"/etc/rabbitmq/conf.d/11-default_user.conf\"}":{".":{},"f:mountPath":{},"f:name":{},"f:subPath":{}},"k:{\"mountPath\":\"/etc/rabbitmq/conf.d/90-userDefinedConfiguration.conf\"}":{".":{},"f:mountPath":{},"f:name":{},"f:subPath":{}},"k:{\"mountPath\":\"/operator\"}":{".":{},"f:mountPath":{},"f:name":{}},"k:{\"mountPath\":\"/var/lib/rabbitmq/\"}":{".":{},"f:mountPath":{},"f:name":{}},"k:{\"mountPath\":\"/var/lib/rabbitmq/mnesia/\"}":{".":{},"f:mountPath":{},"f:name":{}}}}},"f:dnsPolicy":{},"f:initContainers":{".":{},"k:{\"name\":\"setup-container\"}":{".":{},"f:command":{},"f:image":{},"f:imagePullPolicy":{},"f:name":{},"f:resources":{".":{},"f:limits":{".":{},"f:cpu":{},"f:memory":{}},"f:requests":{".":{},"f:cpu":{},"f:memory":{}}},"f:securityContext":{".":{},"f:capabilities":{".":{},"f:drop":{}},"f:runAsUser":{}},"f:terminationMessagePath":{},"f:terminationMessagePolicy":{},"f:volumeMounts":{".":{},"k:{\"mountPath\":\"/operator\"}":{".":{},"f:mountPath":{},"f:name":{}},"k:{\"mountPath\":\"/tmp/default_user.conf\"}":{".":{},"f:mountPath":{},"f:name":{},"f:subPath":{}},"k:{\"mountPath\":\"/tmp/erlang-cookie-secret/\"}":{".":{},"f:mountPath":{},"f:name":{}},"k:{\"mountPath\":\"/tmp/rabbitmq-plugins/\"}":{".":{},"f:mountPath":{},"f:name":{}},"k:{\"mountPath\":\"/var/lib/rabbitmq/\"}":{".":{},"f:mountPath":{},"f:name":{}},"k:{\"mountPath\":\"/var/lib/rabbitmq/mnesia/\"}":{".":{},"f:mountPath":{},"f:name":{}}}}},"f:restartPolicy":{},"f:schedulerName":{},"f:securityContext":{".":{},"f:fsGroup":{},"f:runAsGroup":{},"f:runAsUser":{}},"f:serviceAccount":{},"f:serviceAccountName":{},"f:terminationGracePeriodSeconds":{},"f:topologySpreadConstraints":{".":{},"k:{\"topologyKey\":\"topology.kubernetes.io/zone\",\"whenUnsatisfiable\":\"ScheduleAnyway\"}":{".":{},"f:labelSelector":{".":{},"f:matchLabels":{".":{},"f:app.kubernetes.io/name":{}}},"f:maxSkew":{},"f:topologyKey":{},"f:whenUnsatisfiable":{}}},"f:volumes":{".":{},"k:{\"name\":\"erlang-cookie-secret\"}":{".":{},"f:name":{},"f:secret":{".":{},"f:defaultMode":{},"f:secretName":{}}},"k:{\"name\":\"plugins-conf\"}":{".":{},"f:configMap":{".":{},"f:defaultMode":{},"f:name":{}},"f:name":{}},"k:{\"name\":\"pod-info\"}":{".":{},"f:downwardAPI":{".":{},"f:defaultMode":{},"f:items":{}},"f:name":{}},"k:{\"name\":\"rabbitmq-confd\"}":{".":{},"f:name":{},"f:projected":{".":{},"f:defaultMode":{},"f:sources":{}}},"k:{\"name\":\"rabbitmq-erlang-cookie\"}":{".":{},"f:emptyDir":{},"f:name":{}},"k:{\"name\":\"rabbitmq-plugins\"}":{".":{},"f:emptyDir":{},"f:name":{}}}}},"f:updateStrategy":{"f:rollingUpdate":{".":{},"f:partition":{}},"f:type":{}},"f:volumeClaimTemplates":{}}}},{"manager":"kube-controller-manager","operation":"Update","apiVersion":"apps/v1","time":"2022-03-18T18:07:31Z","fieldsType":"FieldsV1","fieldsV1":{"f:status":{"f:collisionCount":{},"f:currentReplicas":{},"f:currentRevision":{},"f:observedGeneration":{},"f:readyReplicas":{},"f:replicas":{},"f:updateRevision":{},"f:updatedReplicas":{}}}}]},"spec":{"replicas":1,"selector":{"matchLabels":{"app.kubernetes.io/name":"rabbitmq-cluster"}},"template":{"metadata":{"creationTimestamp":null,"labels":{"app.kubernetes.io/component":"rabbitmq","app.kubernetes.io/name":"rabbitmq-cluster","app.kubernetes.io/part-of":"rabbitmq"},"annotations":{"prometheus.io/port":"15692","prometheus.io/scrape":"true"}},"spec":{"volumes":[{"name":"plugins-conf","configMap":{"name":"rabbitmq-cluster-plugins-conf","defaultMode":420}},{"name":"rabbitmq-confd","projected":{"sources":[{"secret":{"name":"rabbitmq-cluster-default-user","items":[{"key":"default_user.conf","path":"default_user.conf"}]}},{"configMap":{"name":"rabbitmq-cluster-server-conf","items":[{"key":"operatorDefaults.conf","path":"operatorDefaults.conf"},{"key":"userDefinedConfiguration.conf","path":"userDefinedConfiguration.conf"}]}}],"defaultMode":420}},{"name":"rabbitmq-erlang-cookie","emptyDir":{}},{"name":"erlang-cookie-secret","secret":{"secretName":"rabbitmq-cluster-erlang-cookie","defaultMode":420}},{"name":"rabbitmq-plugins","emptyDir":{}},{"name":"pod-info","downwardAPI":{"items":[{"path":"skipPreStopChecks","fieldRef":{"apiVersion":"v1","fieldPath":"metadata.labels['skipPreStopChecks']"}}],"defaultMode":420}}],"initContainers":[{"name":"setup-container","image":"rabbitmq:3.8.12-management","command":["sh","-c","cp /tmp/erlang-cookie-secret/.erlang.cookie /var/lib/rabbitmq/.erlang.cookie \u0026\u0026 chown 999:999 /var/lib/rabbitmq/.erlang.cookie \u0026\u0026 chmod 600 /var/lib/rabbitmq/.erlang.cookie ; cp /tmp/rabbitmq-plugins/enabled_plugins /operator/enabled_plugins \u0026\u0026 chown 999:999 /operator/enabled_plugins ; chown 999:999 /var/lib/rabbitmq/mnesia/ ; echo '[default]' \u003e /var/lib/rabbitmq/.rabbitmqadmin.conf \u0026\u0026 sed -e 's/default_user/username/' -e 's/default_pass/password/' /tmp/default_user.conf \u003e\u003e /var/lib/rabbitmq/.rabbitmqadmin.conf \u0026\u0026 chown 999:999 /var/lib/rabbitmq/.rabbitmqadmin.conf \u0026\u0026 chmod 600 /var/lib/rabbitmq/.rabbitmqadmin.conf"],"resources":{"limits":{"cpu":"100m","memory":"500Mi"},"requests":{"cpu":"100m","memory":"500Mi"}},"volumeMounts":[{"name":"plugins-conf","mountPath":"/tmp/rabbitmq-plugins/"},{"name":"rabbitmq-erlang-cookie","mountPath":"/var/lib/rabbitmq/"},{"name":"erlang-cookie-secret","mountPath":"/tmp/erlang-cookie-secret/"},{"name":"rabbitmq-plugins","mountPath":"/operator"},{"name":"persistence","mountPath":"/var/lib/rabbitmq/mnesia/"},{"name":"rabbitmq-confd","mountPath":"/tmp/default_user.conf","subPath":"default_user.conf"}],"terminationMessagePath":"/dev/termination-log","terminationMessagePolicy":"File","imagePullPolicy":"IfNotPresent","securityContext":{"capabilities":{"drop":["FSETID","KILL","SETGID","SETUID","SETPCAP","NET_BIND_SERVICE","NET_RAW","SYS_CHROOT","MKNOD","AUDIT_WRITE","SETFCAP"]},"runAsUser":0}}],"containers":[{"name":"rabbitmq","image":"rabbitmq:3.8.12-management","ports":[{"name":"epmd","containerPort":4369,"protocol":"TCP"},{"name":"amqp","containerPort":5672,"protocol":"TCP"},{"name":"management","containerPort":15672,"protocol":"TCP"},{"name":"prometheus","containerPort":15692,"protocol":"TCP"}],"env":[{"name":"MY_POD_NAME","valueFrom":{"fieldRef":{"apiVersion":"v1","fieldPath":"metadata.name"}}},{"name":"MY_POD_NAMESPACE","valueFrom":{"fieldRef":{"apiVersion":"v1","fieldPath":"metadata.namespace"}}},{"name":"RABBITMQ_ENABLED_PLUGINS_FILE","value":"/operator/enabled_plugins"},{"name":"K8S_SERVICE_NAME","value":"rabbitmq-cluster-nodes"},{"name":"RABBITMQ_USE_LONGNAME","value":"true"},{"name":"RABBITMQ_NODENAME","value":"rabbit@$(MY_POD_NAME).$(K8S_SERVICE_NAME).$(MY_POD_NAMESPACE)"},{"name":"K8S_HOSTNAME_SUFFIX","value":".$(K8S_SERVICE_NAME).$(MY_POD_NAMESPACE)"}],"resources":{"limits":{"cpu":"2","memory":"2Gi"},"requests":{"cpu":"1","memory":"2Gi"}},"volumeMounts":[{"name":"rabbitmq-erlang-cookie","mountPath":"/var/lib/rabbitmq/"},{"name":"persistence","mountPath":"/var/lib/rabbitmq/mnesia/"},{"name":"rabbitmq-plugins","mountPath":"/operator"},{"name":"rabbitmq-confd","mountPath":"/etc/rabbitmq/conf.d/10-operatorDefaults.conf","subPath":"operatorDefaults.conf"},{"name":"rabbitmq-confd","mountPath":"/etc/rabbitmq/conf.d/11-default_user.conf","subPath":"default_user.conf"},{"name":"rabbitmq-confd","mountPath":"/etc/rabbitmq/conf.d/90-userDefinedConfiguration.conf","subPath":"userDefinedConfiguration.conf"},{"name":"pod-info","mountPath":"/etc/pod-info/"}],"readinessProbe":{"tcpSocket":{"port":"amqp"},"initialDelaySeconds":10,"timeoutSeconds":5,"periodSeconds":10,"successThreshold":1,"failureThreshold":3},"lifecycle":{"preStop":{"exec":{"command":["/bin/bash","-c","if [ ! -z \"$(cat /etc/pod-info/skipPreStopChecks)\" ]; then exit 0; fi; rabbitmq-upgrade await_online_quorum_plus_one -t 604800; rabbitmq-upgrade await_online_synchronized_mirror -t 604800; rabbitmq-upgrade drain -t 604800"]}}},"terminationMessagePath":"/dev/termination-log","terminationMessagePolicy":"File","imagePullPolicy":"IfNotPresent"}],"restartPolicy":"Always","terminationGracePeriodSeconds":604800,"dnsPolicy":"ClusterFirst","serviceAccountName":"rabbitmq-cluster-server","serviceAccount":"rabbitmq-cluster-server","automountServiceAccountToken":true,"securityContext":{"runAsUser":999,"runAsGroup":999,"fsGroup":999},"schedulerName":"default-scheduler","topologySpreadConstraints":[{"maxSkew":1,"topologyKey":"topology.kubernetes.io/zone","whenUnsatisfiable":"ScheduleAnyway","labelSelector":{"matchLabels":{"app.kubernetes.io/name":"rabbitmq-cluster"}}}]}},"volumeClaimTemplates":[{"metadata":{"name":"persistence","namespace":"default","creationTimestamp":null,"labels":{"app.kubernetes.io/component":"rabbitmq","app.kubernetes.io/name":"rabbitmq-cluster","app.kubernetes.io/part-of":"rabbitmq"},"ownerReferences":[{"apiVersion":"rabbitmq.com/v1beta1","kind":"RabbitmqCluster","name":"rabbitmq-cluster","uid":"3ecefa8a-1bec-48a7-9af4-dd0df3339101","controller":true,"blockOwnerDeletion":false}]},"spec":{"accessModes":["ReadWriteOnce"],"resources":{"requests":{"storage":"10Gi"}},"volumeMode":"Filesystem"},"status":{"phase":"Pending"}}],"serviceName":"rabbitmq-cluster-nodes","podManagementPolicy":"Parallel","updateStrategy":{"type":"RollingUpdate","rollingUpdate":{"partition":0}},"revisionHistoryLimit":10},"status":{"observedGeneration":2,"replicas":1,"readyReplicas":1,"currentReplicas":1,"updatedReplicas":1,"currentRevision":"rabbitmq-cluster-server-5f8b8665fb","updateRevision":"rabbitmq-cluster-server-5f8b8665fb","collisionCount":0}}
2022/03/18 18:07:31 learn_server.go:289: [SIEVE-AFTER-HEAR]	24
2022/03/18 18:07:31 learn_server.go:279: [SIEVE-BEFORE-HEAR]	25	Deleted	statefulset	{"metadata":{"name":"rabbitmq-cluster-server","namespace":"default","selfLink":"/apis/apps/v1/namespaces/default/statefulsets/rabbitmq-cluster-server","uid":"f2f07f3e-b500-4c48-a5de-8db7eaf37b9a","resourceVersion":"1450","generation":2,"creationTimestamp":"2022-03-18T18:06:25Z","deletionTimestamp":"2022-03-18T18:07:31Z","deletionGracePeriodSeconds":0,"labels":{"app.kubernetes.io/component":"rabbitmq","app.kubernetes.io/name":"rabbitmq-cluster","app.kubernetes.io/part-of":"rabbitmq"},"ownerReferences":[{"apiVersion":"rabbitmq.com/v1beta1","kind":"RabbitmqCluster","name":"rabbitmq-cluster","uid":"3ecefa8a-1bec-48a7-9af4-dd0df3339101","controller":true,"blockOwnerDeletion":true}],"finalizers":["orphan"],"managedFields":[{"manager":"manager","operation":"Update","apiVersion":"apps/v1","time":"2022-03-18T18:06:25Z","fieldsType":"FieldsV1","fieldsV1":{"f:metadata":{"f:labels":{".":{},"f:app.kubernetes.io/component":{},"f:app.kubernetes.io/name":{},"f:app.kubernetes.io/part-of":{}},"f:ownerReferences":{".":{},"k:{\"uid\":\"3ecefa8a-1bec-48a7-9af4-dd0df3339101\"}":{".":{},"f:apiVersion":{},"f:blockOwnerDeletion":{},"f:controller":{},"f:kind":{},"f:name":{},"f:uid":{}}}},"f:spec":{"f:podManagementPolicy":{},"f:replicas":{},"f:revisionHistoryLimit":{},"f:selector":{"f:matchLabels":{".":{},"f:app.kubernetes.io/name":{}}},"f:serviceName":{},"f:template":{"f:metadata":{"f:annotations":{".":{},"f:prometheus.io/port":{},"f:prometheus.io/scrape":{}},"f:labels":{".":{},"f:app.kubernetes.io/component":{},"f:app.kubernetes.io/name":{},"f:app.kubernetes.io/part-of":{}}},"f:spec":{"f:automountServiceAccountToken":{},"f:containers":{"k:{\"name\":\"rabbitmq\"}":{".":{},"f:env":{".":{},"k:{\"name\":\"K8S_HOSTNAME_SUFFIX\"}":{".":{},"f:name":{},"f:value":{}},"k:{\"name\":\"K8S_SERVICE_NAME\"}":{".":{},"f:name":{},"f:value":{}},"k:{\"name\":\"MY_POD_NAME\"}":{".":{},"f:name":{},"f:valueFrom":{".":{},"f:fieldRef":{".":{},"f:apiVersion":{},"f:fieldPath":{}}}},"k:{\"name\":\"MY_POD_NAMESPACE\"}":{".":{},"f:name":{},"f:valueFrom":{".":{},"f:fieldRef":{".":{},"f:apiVersion":{},"f:fieldPath":{}}}},"k:{\"name\":\"RABBITMQ_ENABLED_PLUGINS_FILE\"}":{".":{},"f:name":{},"f:value":{}},"k:{\"name\":\"RABBITMQ_NODENAME\"}":{".":{},"f:name":{},"f:value":{}},"k:{\"name\":\"RABBITMQ_USE_LONGNAME\"}":{".":{},"f:name":{},"f:value":{}}},"f:image":{},"f:imagePullPolicy":{},"f:lifecycle":{".":{},"f:preStop":{".":{},"f:exec":{".":{},"f:command":{}}}},"f:name":{},"f:ports":{".":{},"k:{\"containerPort\":4369,\"protocol\":\"TCP\"}":{".":{},"f:containerPort":{},"f:name":{},"f:protocol":{}},"k:{\"containerPort\":5672,\"protocol\":\"TCP\"}":{".":{},"f:containerPort":{},"f:name":{},"f:protocol":{}},"k:{\"containerPort\":15672,\"protocol\":\"TCP\"}":{".":{},"f:containerPort":{},"f:name":{},"f:protocol":{}},"k:{\"containerPort\":15692,\"protocol\":\"TCP\"}":{".":{},"f:containerPort":{},"f:name":{},"f:protocol":{}}},"f:readinessProbe":{".":{},"f:failureThreshold":{},"f:initialDelaySeconds":{},"f:periodSeconds":{},"f:successThreshold":{},"f:tcpSocket":{".":{},"f:port":{}},"f:timeoutSeconds":{}},"f:resources":{".":{},"f:limits":{".":{},"f:cpu":{},"f:memory":{}},"f:requests":{".":{},"f:cpu":{},"f:memory":{}}},"f:terminationMessagePath":{},"f:terminationMessagePolicy":{},"f:volumeMounts":{".":{},"k:{\"mountPath\":\"/etc/pod-info/\"}":{".":{},"f:mountPath":{},"f:name":{}},"k:{\"mountPath\":\"/etc/rabbitmq/conf.d/10-operatorDefaults.conf\"}":{".":{},"f:mountPath":{},"f:name":{},"f:subPath":{}},"k:{\"mountPath\":\"/etc/rabbitmq/conf.d/11-default_user.conf\"}":{".":{},"f:mountPath":{},"f:name":{},"f:subPath":{}},"k:{\"mountPath\":\"/etc/rabbitmq/conf.d/90-userDefinedConfiguration.conf\"}":{".":{},"f:mountPath":{},"f:name":{},"f:subPath":{}},"k:{\"mountPath\":\"/operator\"}":{".":{},"f:mountPath":{},"f:name":{}},"k:{\"mountPath\":\"/var/lib/rabbitmq/\"}":{".":{},"f:mountPath":{},"f:name":{}},"k:{\"mountPath\":\"/var/lib/rabbitmq/mnesia/\"}":{".":{},"f:mountPath":{},"f:name":{}}}}},"f:dnsPolicy":{},"f:initContainers":{".":{},"k:{\"name\":\"setup-container\"}":{".":{},"f:command":{},"f:image":{},"f:imagePullPolicy":{},"f:name":{},"f:resources":{".":{},"f:limits":{".":{},"f:cpu":{},"f:memory":{}},"f:requests":{".":{},"f:cpu":{},"f:memory":{}}},"f:securityContext":{".":{},"f:capabilities":{".":{},"f:drop":{}},"f:runAsUser":{}},"f:terminationMessagePath":{},"f:terminationMessagePolicy":{},"f:volumeMounts":{".":{},"k:{\"mountPath\":\"/operator\"}":{".":{},"f:mountPath":{},"f:name":{}},"k:{\"mountPath\":\"/tmp/default_user.conf\"}":{".":{},"f:mountPath":{},"f:name":{},"f:subPath":{}},"k:{\"mountPath\":\"/tmp/erlang-cookie-secret/\"}":{".":{},"f:mountPath":{},"f:name":{}},"k:{\"mountPath\":\"/tmp/rabbitmq-plugins/\"}":{".":{},"f:mountPath":{},"f:name":{}},"k:{\"mountPath\":\"/var/lib/rabbitmq/\"}":{".":{},"f:mountPath":{},"f:name":{}},"k:{\"mountPath\":\"/var/lib/rabbitmq/mnesia/\"}":{".":{},"f:mountPath":{},"f:name":{}}}}},"f:restartPolicy":{},"f:schedulerName":{},"f:securityContext":{".":{},"f:fsGroup":{},"f:runAsGroup":{},"f:runAsUser":{}},"f:serviceAccount":{},"f:serviceAccountName":{},"f:terminationGracePeriodSeconds":{},"f:topologySpreadConstraints":{".":{},"k:{\"topologyKey\":\"topology.kubernetes.io/zone\",\"whenUnsatisfiable\":\"ScheduleAnyway\"}":{".":{},"f:labelSelector":{".":{},"f:matchLabels":{".":{},"f:app.kubernetes.io/name":{}}},"f:maxSkew":{},"f:topologyKey":{},"f:whenUnsatisfiable":{}}},"f:volumes":{".":{},"k:{\"name\":\"erlang-cookie-secret\"}":{".":{},"f:name":{},"f:secret":{".":{},"f:defaultMode":{},"f:secretName":{}}},"k:{\"name\":\"plugins-conf\"}":{".":{},"f:configMap":{".":{},"f:defaultMode":{},"f:name":{}},"f:name":{}},"k:{\"name\":\"pod-info\"}":{".":{},"f:downwardAPI":{".":{},"f:defaultMode":{},"f:items":{}},"f:name":{}},"k:{\"name\":\"rabbitmq-confd\"}":{".":{},"f:name":{},"f:projected":{".":{},"f:defaultMode":{},"f:sources":{}}},"k:{\"name\":\"rabbitmq-erlang-cookie\"}":{".":{},"f:emptyDir":{},"f:name":{}},"k:{\"name\":\"rabbitmq-plugins\"}":{".":{},"f:emptyDir":{},"f:name":{}}}}},"f:updateStrategy":{"f:rollingUpdate":{".":{},"f:partition":{}},"f:type":{}},"f:volumeClaimTemplates":{}}}},{"manager":"kube-controller-manager","operation":"Update","apiVersion":"apps/v1","time":"2022-03-18T18:07:31Z","fieldsType":"FieldsV1","fieldsV1":{"f:status":{"f:collisionCount":{},"f:currentReplicas":{},"f:currentRevision":{},"f:observedGeneration":{},"f:readyReplicas":{},"f:replicas":{},"f:updateRevision":{},"f:updatedReplicas":{}}}}]},"spec":{"replicas":1,"selector":{"matchLabels":{"app.kubernetes.io/name":"rabbitmq-cluster"}},"template":{"metadata":{"creationTimestamp":null,"labels":{"app.kubernetes.io/component":"rabbitmq","app.kubernetes.io/name":"rabbitmq-cluster","app.kubernetes.io/part-of":"rabbitmq"},"annotations":{"prometheus.io/port":"15692","prometheus.io/scrape":"true"}},"spec":{"volumes":[{"name":"plugins-conf","configMap":{"name":"rabbitmq-cluster-plugins-conf","defaultMode":420}},{"name":"rabbitmq-confd","projected":{"sources":[{"secret":{"name":"rabbitmq-cluster-default-user","items":[{"key":"default_user.conf","path":"default_user.conf"}]}},{"configMap":{"name":"rabbitmq-cluster-server-conf","items":[{"key":"operatorDefaults.conf","path":"operatorDefaults.conf"},{"key":"userDefinedConfiguration.conf","path":"userDefinedConfiguration.conf"}]}}],"defaultMode":420}},{"name":"rabbitmq-erlang-cookie","emptyDir":{}},{"name":"erlang-cookie-secret","secret":{"secretName":"rabbitmq-cluster-erlang-cookie","defaultMode":420}},{"name":"rabbitmq-plugins","emptyDir":{}},{"name":"pod-info","downwardAPI":{"items":[{"path":"skipPreStopChecks","fieldRef":{"apiVersion":"v1","fieldPath":"metadata.labels['skipPreStopChecks']"}}],"defaultMode":420}}],"initContainers":[{"name":"setup-container","image":"rabbitmq:3.8.12-management","command":["sh","-c","cp /tmp/erlang-cookie-secret/.erlang.cookie /var/lib/rabbitmq/.erlang.cookie \u0026\u0026 chown 999:999 /var/lib/rabbitmq/.erlang.cookie \u0026\u0026 chmod 600 /var/lib/rabbitmq/.erlang.cookie ; cp /tmp/rabbitmq-plugins/enabled_plugins /operator/enabled_plugins \u0026\u0026 chown 999:999 /operator/enabled_plugins ; chown 999:999 /var/lib/rabbitmq/mnesia/ ; echo '[default]' \u003e /var/lib/rabbitmq/.rabbitmqadmin.conf \u0026\u0026 sed -e 's/default_user/username/' -e 's/default_pass/password/' /tmp/default_user.conf \u003e\u003e /var/lib/rabbitmq/.rabbitmqadmin.conf \u0026\u0026 chown 999:999 /var/lib/rabbitmq/.rabbitmqadmin.conf \u0026\u0026 chmod 600 /var/lib/rabbitmq/.rabbitmqadmin.conf"],"resources":{"limits":{"cpu":"100m","memory":"500Mi"},"requests":{"cpu":"100m","memory":"500Mi"}},"volumeMounts":[{"name":"plugins-conf","mountPath":"/tmp/rabbitmq-plugins/"},{"name":"rabbitmq-erlang-cookie","mountPath":"/var/lib/rabbitmq/"},{"name":"erlang-cookie-secret","mountPath":"/tmp/erlang-cookie-secret/"},{"name":"rabbitmq-plugins","mountPath":"/operator"},{"name":"persistence","mountPath":"/var/lib/rabbitmq/mnesia/"},{"name":"rabbitmq-confd","mountPath":"/tmp/default_user.conf","subPath":"default_user.conf"}],"terminationMessagePath":"/dev/termination-log","terminationMessagePolicy":"File","imagePullPolicy":"IfNotPresent","securityContext":{"capabilities":{"drop":["FSETID","KILL","SETGID","SETUID","SETPCAP","NET_BIND_SERVICE","NET_RAW","SYS_CHROOT","MKNOD","AUDIT_WRITE","SETFCAP"]},"runAsUser":0}}],"containers":[{"name":"rabbitmq","image":"rabbitmq:3.8.12-management","ports":[{"name":"epmd","containerPort":4369,"protocol":"TCP"},{"name":"amqp","containerPort":5672,"protocol":"TCP"},{"name":"management","containerPort":15672,"protocol":"TCP"},{"name":"prometheus","containerPort":15692,"protocol":"TCP"}],"env":[{"name":"MY_POD_NAME","valueFrom":{"fieldRef":{"apiVersion":"v1","fieldPath":"metadata.name"}}},{"name":"MY_POD_NAMESPACE","valueFrom":{"fieldRef":{"apiVersion":"v1","fieldPath":"metadata.namespace"}}},{"name":"RABBITMQ_ENABLED_PLUGINS_FILE","value":"/operator/enabled_plugins"},{"name":"K8S_SERVICE_NAME","value":"rabbitmq-cluster-nodes"},{"name":"RABBITMQ_USE_LONGNAME","value":"true"},{"name":"RABBITMQ_NODENAME","value":"rabbit@$(MY_POD_NAME).$(K8S_SERVICE_NAME).$(MY_POD_NAMESPACE)"},{"name":"K8S_HOSTNAME_SUFFIX","value":".$(K8S_SERVICE_NAME).$(MY_POD_NAMESPACE)"}],"resources":{"limits":{"cpu":"2","memory":"2Gi"},"requests":{"cpu":"1","memory":"2Gi"}},"volumeMounts":[{"name":"rabbitmq-erlang-cookie","mountPath":"/var/lib/rabbitmq/"},{"name":"persistence","mountPath":"/var/lib/rabbitmq/mnesia/"},{"name":"rabbitmq-plugins","mountPath":"/operator"},{"name":"rabbitmq-confd","mountPath":"/etc/rabbitmq/conf.d/10-operatorDefaults.conf","subPath":"operatorDefaults.conf"},{"name":"rabbitmq-confd","mountPath":"/etc/rabbitmq/conf.d/11-default_user.conf","subPath":"default_user.conf"},{"name":"rabbitmq-confd","mountPath":"/etc/rabbitmq/conf.d/90-userDefinedConfiguration.conf","subPath":"userDefinedConfiguration.conf"},{"name":"pod-info","mountPath":"/etc/pod-info/"}],"readinessProbe":{"tcpSocket":{"port":"amqp"},"initialDelaySeconds":10,"timeoutSeconds":5,"periodSeconds":10,"successThreshold":1,"failureThreshold":3},"lifecycle":{"preStop":{"exec":{"command":["/bin/bash","-c","if [ ! -z \"$(cat /etc/pod-info/skipPreStopChecks)\" ]; then exit 0; fi; rabbitmq-upgrade await_online_quorum_plus_one -t 604800; rabbitmq-upgrade await_online_synchronized_mirror -t 604800; rabbitmq-upgrade drain -t 604800"]}}},"terminationMessagePath":"/dev/termination-log","terminationMessagePolicy":"File","imagePullPolicy":"IfNotPresent"}],"restartPolicy":"Always","terminationGracePeriodSeconds":604800,"dnsPolicy":"ClusterFirst","serviceAccountName":"rabbitmq-cluster-server","serviceAccount":"rabbitmq-cluster-server","automountServiceAccountToken":true,"securityContext":{"runAsUser":999,"runAsGroup":999,"fsGroup":999},"schedulerName":"default-scheduler","topologySpreadConstraints":[{"maxSkew":1,"topologyKey":"topology.kubernetes.io/zone","whenUnsatisfiable":"ScheduleAnyway","labelSelector":{"matchLabels":{"app.kubernetes.io/name":"rabbitmq-cluster"}}}]}},"volumeClaimTemplates":[{"metadata":{"name":"persistence","namespace":"default","creationTimestamp":null,"labels":{"app.kubernetes.io/component":"rabbitmq","app.kubernetes.io/name":"rabbitmq-cluster","app.kubernetes.io/part-of":"rabbitmq"},"ownerReferences":[{"apiVersion":"rabbitmq.com/v1beta1","kind":"RabbitmqCluster","name":"rabbitmq-cluster","uid":"3ecefa8a-1bec-48a7-9af4-dd0df3339101","controller":true,"blockOwnerDeletion":false}]},"spec":{"accessModes":["ReadWriteOnce"],"resources":{"requests":{"storage":"10Gi"}},"volumeMode":"Filesystem"},"status":{"phase":"Pending"}}],"serviceName":"rabbitmq-cluster-nodes","podManagementPolicy":"Parallel","updateStrategy":{"type":"RollingUpdate","rollingUpdate":{"partition":0}},"revisionHistoryLimit":10},"status":{"observedGeneration":2,"replicas":1,"readyReplicas":1,"currentReplicas":1,"updatedReplicas":1,"currentRevision":"rabbitmq-cluster-server-5f8b8665fb","updateRevision":"rabbitmq-cluster-server-5f8b8665fb","collisionCount":0}}
2022/03/18 18:07:31 learn_server.go:289: [SIEVE-AFTER-HEAR]	25
2022/03/18 18:07:34 learn_server.go:291: [SIEVE-AFTER-READ]	Get	true	statefulset	default	rabbitmq-cluster-server	github.com/rabbitmq/cluster-operator/controllers.(*RabbitmqClusterReconciler)	NotFound	{"metadata":{"creationTimestamp":null},"spec":{"selector":null,"template":{"metadata":{"creationTimestamp":null},"spec":{"containers":null}},"serviceName":"","updateStrategy":{}},"status":{"replicas":0}}
2022/03/18 18:07:34 learn_server.go:279: [SIEVE-BEFORE-HEAR]	26	Replaced	persistentvolumeclaim	{"metadata":{"name":"persistence-rabbitmq-cluster-server-0","namespace":"default","selfLink":"/api/v1/namespaces/default/persistentvolumeclaims/persistence-rabbitmq-cluster-server-0","uid":"2a49a40a-31f5-4d2b-ba65-716831e0fa6b","resourceVersion":"1130","creationTimestamp":"2022-03-18T18:06:25Z","labels":{"app.kubernetes.io/component":"rabbitmq","app.kubernetes.io/name":"rabbitmq-cluster","app.kubernetes.io/part-of":"rabbitmq"},"annotations":{"pv.kubernetes.io/bind-completed":"yes","pv.kubernetes.io/bound-by-controller":"yes","volume.beta.kubernetes.io/storage-provisioner":"hostpath.csi.k8s.io"},"ownerReferences":[{"apiVersion":"rabbitmq.com/v1beta1","kind":"RabbitmqCluster","name":"rabbitmq-cluster","uid":"3ecefa8a-1bec-48a7-9af4-dd0df3339101","controller":true,"blockOwnerDeletion":false}],"finalizers":["kubernetes.io/pvc-protection"],"managedFields":[{"manager":"kube-controller-manager","operation":"Update","apiVersion":"v1","time":"2022-03-18T18:06:25Z","fieldsType":"FieldsV1","fieldsV1":{"f:metadata":{"f:annotations":{".":{},"f:pv.kubernetes.io/bind-completed":{},"f:pv.kubernetes.io/bound-by-controller":{},"f:volume.beta.kubernetes.io/storage-provisioner":{}},"f:labels":{".":{},"f:app.kubernetes.io/component":{},"f:app.kubernetes.io/name":{},"f:app.kubernetes.io/part-of":{}},"f:ownerReferences":{".":{},"k:{\"uid\":\"3ecefa8a-1bec-48a7-9af4-dd0df3339101\"}":{".":{},"f:apiVersion":{},"f:blockOwnerDeletion":{},"f:controller":{},"f:kind":{},"f:name":{},"f:uid":{}}}},"f:spec":{"f:accessModes":{},"f:resources":{"f:requests":{".":{},"f:storage":{}}},"f:volumeMode":{},"f:volumeName":{}},"f:status":{"f:accessModes":{},"f:capacity":{".":{},"f:storage":{}},"f:phase":{}}}}]},"spec":{"accessModes":["ReadWriteOnce"],"resources":{"requests":{"storage":"10Gi"}},"volumeName":"pvc-2a49a40a-31f5-4d2b-ba65-716831e0fa6b","storageClassName":"csi-hostpath-sc","volumeMode":"Filesystem"},"status":{"phase":"Bound","accessModes":["ReadWriteOnce"],"capacity":{"storage":"10Gi"}}}
2022/03/18 18:07:34 learn_server.go:289: [SIEVE-AFTER-HEAR]	26
2022/03/18 18:07:34 learn_server.go:291: [SIEVE-AFTER-READ]	Get	true	persistentvolumeclaim	default	persistence-rabbitmq-cluster-server-0	github.com/rabbitmq/cluster-operator/controllers.(*RabbitmqClusterReconciler)	NoError	{"kind":"PersistentVolumeClaim","apiVersion":"v1","metadata":{"name":"persistence-rabbitmq-cluster-server-0","namespace":"default","selfLink":"/api/v1/namespaces/default/persistentvolumeclaims/persistence-rabbitmq-cluster-server-0","uid":"2a49a40a-31f5-4d2b-ba65-716831e0fa6b","resourceVersion":"1130","creationTimestamp":"2022-03-18T18:06:25Z","labels":{"app.kubernetes.io/component":"rabbitmq","app.kubernetes.io/name":"rabbitmq-cluster","app.kubernetes.io/part-of":"rabbitmq"},"annotations":{"pv.kubernetes.io/bind-completed":"yes","pv.kubernetes.io/bound-by-controller":"yes","volume.beta.kubernetes.io/storage-provisioner":"hostpath.csi.k8s.io"},"ownerReferences":[{"apiVersion":"rabbitmq.com/v1beta1","kind":"RabbitmqCluster","name":"rabbitmq-cluster","uid":"3ecefa8a-1bec-48a7-9af4-dd0df3339101","controller":true,"blockOwnerDeletion":false}],"finalizers":["kubernetes.io/pvc-protection"],"managedFields":[{"manager":"kube-controller-manager","operation":"Update","apiVersion":"v1","time":"2022-03-18T18:06:25Z","fieldsType":"FieldsV1","fieldsV1":{"f:metadata":{"f:annotations":{".":{},"f:pv.kubernetes.io/bind-completed":{},"f:pv.kubernetes.io/bound-by-controller":{},"f:volume.beta.kubernetes.io/storage-provisioner":{}},"f:labels":{".":{},"f:app.kubernetes.io/component":{},"f:app.kubernetes.io/name":{},"f:app.kubernetes.io/part-of":{}},"f:ownerReferences":{".":{},"k:{\"uid\":\"3ecefa8a-1bec-48a7-9af4-dd0df3339101\"}":{".":{},"f:apiVersion":{},"f:blockOwnerDeletion":{},"f:controller":{},"f:kind":{},"f:name":{},"f:uid":{}}}},"f:spec":{"f:accessModes":{},"f:resources":{"f:requests":{".":{},"f:storage":{}}},"f:volumeMode":{},"f:volumeName":{}},"f:status":{"f:accessModes":{},"f:capacity":{".":{},"f:storage":{}},"f:phase":{}}}}]},"spec":{"accessModes":["ReadWriteOnce"],"resources":{"requests":{"storage":"10Gi"}},"volumeName":"pvc-2a49a40a-31f5-4d2b-ba65-716831e0fa6b","storageClassName":"csi-hostpath-sc","volumeMode":"Filesystem"},"status":{"phase":"Bound","accessModes":["ReadWriteOnce"],"capacity":{"storage":"10Gi"}}}
2022/03/18 18:07:34 learn_server.go:256: [SIEVE-BEFORE-WRITE]	38
2022/03/18 18:07:34 learn_server.go:279: [SIEVE-BEFORE-HEAR]	27	Updated	persistentvolumeclaim	{"metadata":{"name":"persistence-rabbitmq-cluster-server-0","namespace":"default","selfLink":"/api/v1/namespaces/default/persistentvolumeclaims/persistence-rabbitmq-cluster-server-0","uid":"2a49a40a-31f5-4d2b-ba65-716831e0fa6b","resourceVersion":"1460","creationTimestamp":"2022-03-18T18:06:25Z","labels":{"app.kubernetes.io/component":"rabbitmq","app.kubernetes.io/name":"rabbitmq-cluster","app.kubernetes.io/part-of":"rabbitmq"},"annotations":{"pv.kubernetes.io/bind-completed":"yes","pv.kubernetes.io/bound-by-controller":"yes","volume.beta.kubernetes.io/storage-provisioner":"hostpath.csi.k8s.io"},"ownerReferences":[{"apiVersion":"rabbitmq.com/v1beta1","kind":"RabbitmqCluster","name":"rabbitmq-cluster","uid":"3ecefa8a-1bec-48a7-9af4-dd0df3339101","controller":true,"blockOwnerDeletion":false}],"finalizers":["kubernetes.io/pvc-protection"],"managedFields":[{"manager":"kube-controller-manager","operation":"Update","apiVersion":"v1","time":"2022-03-18T18:06:25Z","fieldsType":"FieldsV1","fieldsV1":{"f:metadata":{"f:annotations":{".":{},"f:pv.kubernetes.io/bind-completed":{},"f:pv.kubernetes.io/bound-by-controller":{},"f:volume.beta.kubernetes.io/storage-provisioner":{}},"f:labels":{".":{},"f:app.kubernetes.io/component":{},"f:app.kubernetes.io/name":{},"f:app.kubernetes.io/part-of":{}},"f:ownerReferences":{".":{},"k:{\"uid\":\"3ecefa8a-1bec-48a7-9af4-dd0df3339101\"}":{".":{},"f:apiVersion":{},"f:blockOwnerDeletion":{},"f:controller":{},"f:kind":{},"f:name":{},"f:uid":{}}}},"f:spec":{"f:accessModes":{},"f:resources":{"f:requests":{}},"f:volumeMode":{},"f:volumeName":{}},"f:status":{"f:accessModes":{},"f:capacity":{".":{},"f:storage":{}},"f:phase":{}}}},{"manager":"manager","operation":"Update","apiVersion":"v1","time":"2022-03-18T18:07:34Z","fieldsType":"FieldsV1","fieldsV1":{"f:spec":{"f:resources":{"f:requests":{"f:storage":{}}}}}}]},"spec":{"accessModes":["ReadWriteOnce"],"resources":{"requests":{"storage":"15Gi"}},"volumeName":"pvc-2a49a40a-31f5-4d2b-ba65-716831e0fa6b","storageClassName":"csi-hostpath-sc","volumeMode":"Filesystem"},"status":{"phase":"Bound","accessModes":["ReadWriteOnce"],"capacity":{"storage":"10Gi"}}}
2022/03/18 18:07:34 learn_server.go:289: [SIEVE-AFTER-HEAR]	27
2022/03/18 18:07:34 learn_server.go:263: [SIEVE-AFTER-WRITE]	38	Update	persistentvolumeclaim	github.com/rabbitmq/cluster-operator/controllers.(*RabbitmqClusterReconciler)	NoError	{"metadata":{"name":"persistence-rabbitmq-cluster-server-0","namespace":"default","selfLink":"/api/v1/namespaces/default/persistentvolumeclaims/persistence-rabbitmq-cluster-server-0","uid":"2a49a40a-31f5-4d2b-ba65-716831e0fa6b","resourceVersion":"1460","creationTimestamp":"2022-03-18T18:06:25Z","labels":{"app.kubernetes.io/component":"rabbitmq","app.kubernetes.io/name":"rabbitmq-cluster","app.kubernetes.io/part-of":"rabbitmq"},"annotations":{"pv.kubernetes.io/bind-completed":"yes","pv.kubernetes.io/bound-by-controller":"yes","volume.beta.kubernetes.io/storage-provisioner":"hostpath.csi.k8s.io"},"ownerReferences":[{"apiVersion":"rabbitmq.com/v1beta1","kind":"RabbitmqCluster","name":"rabbitmq-cluster","uid":"3ecefa8a-1bec-48a7-9af4-dd0df3339101","controller":true,"blockOwnerDeletion":false}],"finalizers":["kubernetes.io/pvc-protection"],"managedFields":[{"manager":"kube-controller-manager","operation":"Update","apiVersion":"v1","time":"2022-03-18T18:06:25Z","fieldsType":"FieldsV1","fieldsV1":{"f:metadata":{"f:annotations":{".":{},"f:pv.kubernetes.io/bind-completed":{},"f:pv.kubernetes.io/bound-by-controller":{},"f:volume.beta.kubernetes.io/storage-provisioner":{}},"f:labels":{".":{},"f:app.kubernetes.io/component":{},"f:app.kubernetes.io/name":{},"f:app.kubernetes.io/part-of":{}},"f:ownerReferences":{".":{},"k:{\"uid\":\"3ecefa8a-1bec-48a7-9af4-dd0df3339101\"}":{".":{},"f:apiVersion":{},"f:blockOwnerDeletion":{},"f:controller":{},"f:kind":{},"f:name":{},"f:uid":{}}}},"f:spec":{"f:accessModes":{},"f:resources":{"f:requests":{}},"f:volumeMode":{},"f:volumeName":{}},"f:status":{"f:accessModes":{},"f:capacity":{".":{},"f:storage":{}},"f:phase":{}}}},{"manager":"manager","operation":"Update","apiVersion":"v1","time":"2022-03-18T18:07:34Z","fieldsType":"FieldsV1","fieldsV1":{"f:spec":{"f:resources":{"f:requests":{"f:storage":{}}}}}}]},"spec":{"accessModes":["ReadWriteOnce"],"resources":{"requests":{"storage":"15Gi"}},"volumeName":"pvc-2a49a40a-31f5-4d2b-ba65-716831e0fa6b","storageClassName":"csi-hostpath-sc","volumeMode":"Filesystem"},"status":{"phase":"Bound","accessModes":["ReadWriteOnce"],"capacity":{"storage":"10Gi"}}}
2022/03/18 18:07:34 learn_server.go:291: [SIEVE-AFTER-READ]	Get	true	statefulset	default	rabbitmq-cluster-server	github.com/rabbitmq/cluster-operator/controllers.(*RabbitmqClusterReconciler)	NotFound	{"metadata":{"name":"rabbitmq-cluster-server","namespace":"default","creationTimestamp":null,"labels":{"app.kubernetes.io/component":"rabbitmq","app.kubernetes.io/name":"rabbitmq-cluster","app.kubernetes.io/part-of":"rabbitmq"},"ownerReferences":[{"apiVersion":"rabbitmq.com/v1beta1","kind":"RabbitmqCluster","name":"rabbitmq-cluster","uid":"3ecefa8a-1bec-48a7-9af4-dd0df3339101","controller":true,"blockOwnerDeletion":true}]},"spec":{"replicas":1,"selector":{"matchLabels":{"app.kubernetes.io/name":"rabbitmq-cluster"}},"template":{"metadata":{"creationTimestamp":null,"labels":{"app.kubernetes.io/component":"rabbitmq","app.kubernetes.io/name":"rabbitmq-cluster","app.kubernetes.io/part-of":"rabbitmq"},"annotations":{"prometheus.io/port":"15692","prometheus.io/scrape":"true"}},"spec":{"volumes":[{"name":"plugins-conf","configMap":{"name":"rabbitmq-cluster-plugins-conf"}},{"name":"rabbitmq-confd","projected":{"sources":[{"secret":{"name":"rabbitmq-cluster-default-user","items":[{"key":"default_user.conf","path":"default_user.conf"}]}},{"configMap":{"name":"rabbitmq-cluster-server-conf","items":[{"key":"operatorDefaults.conf","path":"operatorDefaults.conf"},{"key":"userDefinedConfiguration.conf","path":"userDefinedConfiguration.conf"}]}}]}},{"name":"rabbitmq-erlang-cookie","emptyDir":{}},{"name":"erlang-cookie-secret","secret":{"secretName":"rabbitmq-cluster-erlang-cookie"}},{"name":"rabbitmq-plugins","emptyDir":{}},{"name":"pod-info","downwardAPI":{"items":[{"path":"skipPreStopChecks","fieldRef":{"fieldPath":"metadata.labels['skipPreStopChecks']"}}]}}],"initContainers":[{"name":"setup-container","image":"rabbitmq:3.8.12-management","command":["sh","-c","cp /tmp/erlang-cookie-secret/.erlang.cookie /var/lib/rabbitmq/.erlang.cookie \u0026\u0026 chown 999:999 /var/lib/rabbitmq/.erlang.cookie \u0026\u0026 chmod 600 /var/lib/rabbitmq/.erlang.cookie ; cp /tmp/rabbitmq-plugins/enabled_plugins /operator/enabled_plugins \u0026\u0026 chown 999:999 /operator/enabled_plugins ; chown 999:999 /var/lib/rabbitmq/mnesia/ ; echo '[default]' \u003e /var/lib/rabbitmq/.rabbitmqadmin.conf \u0026\u0026 sed -e 's/default_user/username/' -e 's/default_pass/password/' /tmp/default_user.conf \u003e\u003e /var/lib/rabbitmq/.rabbitmqadmin.conf \u0026\u0026 chown 999:999 /var/lib/rabbitmq/.rabbitmqadmin.conf \u0026\u0026 chmod 600 /var/lib/rabbitmq/.rabbitmqadmin.conf"],"resources":{"limits":{"cpu":"100m","memory":"500Mi"},"requests":{"cpu":"100m","memory":"500Mi"}},"volumeMounts":[{"name":"plugins-conf","mountPath":"/tmp/rabbitmq-plugins/"},{"name":"rabbitmq-erlang-cookie","mountPath":"/var/lib/rabbitmq/"},{"name":"erlang-cookie-secret","mountPath":"/tmp/erlang-cookie-secret/"},{"name":"rabbitmq-plugins","mountPath":"/operator"},{"name":"persistence","mountPath":"/var/lib/rabbitmq/mnesia/"},{"name":"rabbitmq-confd","mountPath":"/tmp/default_user.conf","subPath":"default_user.conf"}],"securityContext":{"capabilities":{"drop":["FSETID","KILL","SETGID","SETUID","SETPCAP","NET_BIND_SERVICE","NET_RAW","SYS_CHROOT","MKNOD","AUDIT_WRITE","SETFCAP"]},"runAsUser":0}}],"containers":[{"name":"rabbitmq","image":"rabbitmq:3.8.12-management","ports":[{"name":"epmd","containerPort":4369},{"name":"amqp","containerPort":5672},{"name":"management","containerPort":15672},{"name":"prometheus","containerPort":15692}],"env":[{"name":"MY_POD_NAME","valueFrom":{"fieldRef":{"apiVersion":"v1","fieldPath":"metadata.name"}}},{"name":"MY_POD_NAMESPACE","valueFrom":{"fieldRef":{"apiVersion":"v1","fieldPath":"metadata.namespace"}}},{"name":"RABBITMQ_ENABLED_PLUGINS_FILE","value":"/operator/enabled_plugins"},{"name":"K8S_SERVICE_NAME","value":"rabbitmq-cluster-nodes"},{"name":"RABBITMQ_USE_LONGNAME","value":"true"},{"name":"RABBITMQ_NODENAME","value":"rabbit@$(MY_POD_NAME).$(K8S_SERVICE_NAME).$(MY_POD_NAMESPACE)"},{"name":"K8S_HOSTNAME_SUFFIX","value":".$(K8S_SERVICE_NAME).$(MY_POD_NAMESPACE)"}],"resources":{"limits":{"cpu":"2","memory":"2Gi"},"requests":{"cpu":"1","memory":"2Gi"}},"volumeMounts":[{"name":"rabbitmq-erlang-cookie","mountPath":"/var/lib/rabbitmq/"},{"name":"persistence","mountPath":"/var/lib/rabbitmq/mnesia/"},{"name":"rabbitmq-plugins","mountPath":"/operator"},{"name":"rabbitmq-confd","mountPath":"/etc/rabbitmq/conf.d/10-operatorDefaults.conf","subPath":"operatorDefaults.conf"},{"name":"rabbitmq-confd","mountPath":"/etc/rabbitmq/conf.d/11-default_user.conf","subPath":"default_user.conf"},{"name":"rabbitmq-confd","mountPath":"/etc/rabbitmq/conf.d/90-userDefinedConfiguration.conf","subPath":"userDefinedConfiguration.conf"},{"name":"pod-info","mountPath":"/etc/pod-info/"}],"readinessProbe":{"tcpSocket":{"port":"amqp"},"initialDelaySeconds":10,"timeoutSeconds":5,"periodSeconds":10,"successThreshold":1,"failureThreshold":3},"lifecycle":{"preStop":{"exec":{"command":["/bin/bash","-c","if [ ! -z \"$(cat /etc/pod-info/skipPreStopChecks)\" ]; then exit 0; fi; rabbitmq-upgrade await_online_quorum_plus_one -t 604800; rabbitmq-upgrade await_online_synchronized_mirror -t 604800; rabbitmq-upgrade drain -t 604800"]}}}}],"terminationGracePeriodSeconds":604800,"serviceAccountName":"rabbitmq-cluster-server","automountServiceAccountToken":true,"securityContext":{"runAsUser":999,"runAsGroup":999,"fsGroup":999},"topologySpreadConstraints":[{"maxSkew":1,"topologyKey":"topology.kubernetes.io/zone","whenUnsatisfiable":"ScheduleAnyway","labelSelector":{"matchLabels":{"app.kubernetes.io/name":"rabbitmq-cluster"}}}]}},"volumeClaimTemplates":[{"metadata":{"name":"persistence","namespace":"default","creationTimestamp":null,"labels":{"app.kubernetes.io/component":"rabbitmq","app.kubernetes.io/name":"rabbitmq-cluster","app.kubernetes.io/part-of":"rabbitmq"},"ownerReferences":[{"apiVersion":"rabbitmq.com/v1beta1","kind":"RabbitmqCluster","name":"rabbitmq-cluster","uid":"3ecefa8a-1bec-48a7-9af4-dd0df3339101","controller":true,"blockOwnerDeletion":false}]},"spec":{"accessModes":["ReadWriteOnce"],"resources":{"requests":{"storage":"15Gi"}}},"status":{}}],"serviceName":"rabbitmq-cluster-nodes","podManagementPolicy":"Parallel","updateStrategy":{"type":"RollingUpdate","rollingUpdate":{"partition":0}}},"status":{"replicas":0}}
2022/03/18 18:07:34 learn_server.go:256: [SIEVE-BEFORE-WRITE]	39
2022/03/18 18:07:34 learn_server.go:279: [SIEVE-BEFORE-HEAR]	28	Added	statefulset	{"metadata":{"name":"rabbitmq-cluster-server","namespace":"default","selfLink":"/apis/apps/v1/namespaces/default/statefulsets/rabbitmq-cluster-server","uid":"1d62d993-2c32-4da7-8884-e4cfad9e587d","resourceVersion":"1462","generation":1,"creationTimestamp":"2022-03-18T18:07:34Z","labels":{"app.kubernetes.io/component":"rabbitmq","app.kubernetes.io/name":"rabbitmq-cluster","app.kubernetes.io/part-of":"rabbitmq"},"ownerReferences":[{"apiVersion":"rabbitmq.com/v1beta1","kind":"RabbitmqCluster","name":"rabbitmq-cluster","uid":"3ecefa8a-1bec-48a7-9af4-dd0df3339101","controller":true,"blockOwnerDeletion":true}],"managedFields":[{"manager":"manager","operation":"Update","apiVersion":"apps/v1","time":"2022-03-18T18:07:34Z","fieldsType":"FieldsV1","fieldsV1":{"f:metadata":{"f:labels":{".":{},"f:app.kubernetes.io/component":{},"f:app.kubernetes.io/name":{},"f:app.kubernetes.io/part-of":{}},"f:ownerReferences":{".":{},"k:{\"uid\":\"3ecefa8a-1bec-48a7-9af4-dd0df3339101\"}":{".":{},"f:apiVersion":{},"f:blockOwnerDeletion":{},"f:controller":{},"f:kind":{},"f:name":{},"f:uid":{}}}},"f:spec":{"f:podManagementPolicy":{},"f:replicas":{},"f:revisionHistoryLimit":{},"f:selector":{"f:matchLabels":{".":{},"f:app.kubernetes.io/name":{}}},"f:serviceName":{},"f:template":{"f:metadata":{"f:annotations":{".":{},"f:prometheus.io/port":{},"f:prometheus.io/scrape":{}},"f:labels":{".":{},"f:app.kubernetes.io/component":{},"f:app.kubernetes.io/name":{},"f:app.kubernetes.io/part-of":{}}},"f:spec":{"f:automountServiceAccountToken":{},"f:containers":{"k:{\"name\":\"rabbitmq\"}":{".":{},"f:env":{".":{},"k:{\"name\":\"K8S_HOSTNAME_SUFFIX\"}":{".":{},"f:name":{},"f:value":{}},"k:{\"name\":\"K8S_SERVICE_NAME\"}":{".":{},"f:name":{},"f:value":{}},"k:{\"name\":\"MY_POD_NAME\"}":{".":{},"f:name":{},"f:valueFrom":{".":{},"f:fieldRef":{".":{},"f:apiVersion":{},"f:fieldPath":{}}}},"k:{\"name\":\"MY_POD_NAMESPACE\"}":{".":{},"f:name":{},"f:valueFrom":{".":{},"f:fieldRef":{".":{},"f:apiVersion":{},"f:fieldPath":{}}}},"k:{\"name\":\"RABBITMQ_ENABLED_PLUGINS_FILE\"}":{".":{},"f:name":{},"f:value":{}},"k:{\"name\":\"RABBITMQ_NODENAME\"}":{".":{},"f:name":{},"f:value":{}},"k:{\"name\":\"RABBITMQ_USE_LONGNAME\"}":{".":{},"f:name":{},"f:value":{}}},"f:image":{},"f:imagePullPolicy":{},"f:lifecycle":{".":{},"f:preStop":{".":{},"f:exec":{".":{},"f:command":{}}}},"f:name":{},"f:ports":{".":{},"k:{\"containerPort\":4369,\"protocol\":\"TCP\"}":{".":{},"f:containerPort":{},"f:name":{},"f:protocol":{}},"k:{\"containerPort\":5672,\"protocol\":\"TCP\"}":{".":{},"f:containerPort":{},"f:name":{},"f:protocol":{}},"k:{\"containerPort\":15672,\"protocol\":\"TCP\"}":{".":{},"f:containerPort":{},"f:name":{},"f:protocol":{}},"k:{\"containerPort\":15692,\"protocol\":\"TCP\"}":{".":{},"f:containerPort":{},"f:name":{},"f:protocol":{}}},"f:readinessProbe":{".":{},"f:failureThreshold":{},"f:initialDelaySeconds":{},"f:periodSeconds":{},"f:successThreshold":{},"f:tcpSocket":{".":{},"f:port":{}},"f:timeoutSeconds":{}},"f:resources":{".":{},"f:limits":{".":{},"f:cpu":{},"f:memory":{}},"f:requests":{".":{},"f:cpu":{},"f:memory":{}}},"f:terminationMessagePath":{},"f:terminationMessagePolicy":{},"f:volumeMounts":{".":{},"k:{\"mountPath\":\"/etc/pod-info/\"}":{".":{},"f:mountPath":{},"f:name":{}},"k:{\"mountPath\":\"/etc/rabbitmq/conf.d/10-operatorDefaults.conf\"}":{".":{},"f:mountPath":{},"f:name":{},"f:subPath":{}},"k:{\"mountPath\":\"/etc/rabbitmq/conf.d/11-default_user.conf\"}":{".":{},"f:mountPath":{},"f:name":{},"f:subPath":{}},"k:{\"mountPath\":\"/etc/rabbitmq/conf.d/90-userDefinedConfiguration.conf\"}":{".":{},"f:mountPath":{},"f:name":{},"f:subPath":{}},"k:{\"mountPath\":\"/operator\"}":{".":{},"f:mountPath":{},"f:name":{}},"k:{\"mountPath\":\"/var/lib/rabbitmq/\"}":{".":{},"f:mountPath":{},"f:name":{}},"k:{\"mountPath\":\"/var/lib/rabbitmq/mnesia/\"}":{".":{},"f:mountPath":{},"f:name":{}}}}},"f:dnsPolicy":{},"f:initContainers":{".":{},"k:{\"name\":\"setup-container\"}":{".":{},"f:command":{},"f:image":{},"f:imagePullPolicy":{},"f:name":{},"f:resources":{".":{},"f:limits":{".":{},"f:cpu":{},"f:memory":{}},"f:requests":{".":{},"f:cpu":{},"f:memory":{}}},"f:securityContext":{".":{},"f:capabilities":{".":{},"f:drop":{}},"f:runAsUser":{}},"f:terminationMessagePath":{},"f:terminationMessagePolicy":{},"f:volumeMounts":{".":{},"k:{\"mountPath\":\"/operator\"}":{".":{},"f:mountPath":{},"f:name":{}},"k:{\"mountPath\":\"/tmp/default_user.conf\"}":{".":{},"f:mountPath":{},"f:name":{},"f:subPath":{}},"k:{\"mountPath\":\"/tmp/erlang-cookie-secret/\"}":{".":{},"f:mountPath":{},"f:name":{}},"k:{\"mountPath\":\"/tmp/rabbitmq-plugins/\"}":{".":{},"f:mountPath":{},"f:name":{}},"k:{\"mountPath\":\"/var/lib/rabbitmq/\"}":{".":{},"f:mountPath":{},"f:name":{}},"k:{\"mountPath\":\"/var/lib/rabbitmq/mnesia/\"}":{".":{},"f:mountPath":{},"f:name":{}}}}},"f:restartPolicy":{},"f:schedulerName":{},"f:securityContext":{".":{},"f:fsGroup":{},"f:runAsGroup":{},"f:runAsUser":{}},"f:serviceAccount":{},"f:serviceAccountName":{},"f:terminationGracePeriodSeconds":{},"f:topologySpreadConstraints":{".":{},"k:{\"topologyKey\":\"topology.kubernetes.io/zone\",\"whenUnsatisfiable\":\"ScheduleAnyway\"}":{".":{},"f:labelSelector":{".":{},"f:matchLabels":{".":{},"f:app.kubernetes.io/name":{}}},"f:maxSkew":{},"f:topologyKey":{},"f:whenUnsatisfiable":{}}},"f:volumes":{".":{},"k:{\"name\":\"erlang-cookie-secret\"}":{".":{},"f:name":{},"f:secret":{".":{},"f:defaultMode":{},"f:secretName":{}}},"k:{\"name\":\"plugins-conf\"}":{".":{},"f:configMap":{".":{},"f:defaultMode":{},"f:name":{}},"f:name":{}},"k:{\"name\":\"pod-info\"}":{".":{},"f:downwardAPI":{".":{},"f:defaultMode":{},"f:items":{}},"f:name":{}},"k:{\"name\":\"rabbitmq-confd\"}":{".":{},"f:name":{},"f:projected":{".":{},"f:defaultMode":{},"f:sources":{}}},"k:{\"name\":\"rabbitmq-erlang-cookie\"}":{".":{},"f:emptyDir":{},"f:name":{}},"k:{\"name\":\"rabbitmq-plugins\"}":{".":{},"f:emptyDir":{},"f:name":{}}}}},"f:updateStrategy":{"f:rollingUpdate":{".":{},"f:partition":{}},"f:type":{}},"f:volumeClaimTemplates":{}}}}]},"spec":{"replicas":1,"selector":{"matchLabels":{"app.kubernetes.io/name":"rabbitmq-cluster"}},"template":{"metadata":{"creationTimestamp":null,"labels":{"app.kubernetes.io/component":"rabbitmq","app.kubernetes.io/name":"rabbitmq-cluster","app.kubernetes.io/part-of":"rabbitmq"},"annotations":{"prometheus.io/port":"15692","prometheus.io/scrape":"true"}},"spec":{"volumes":[{"name":"plugins-conf","configMap":{"name":"rabbitmq-cluster-plugins-conf","defaultMode":420}},{"name":"rabbitmq-confd","projected":{"sources":[{"secret":{"name":"rabbitmq-cluster-default-user","items":[{"key":"default_user.conf","path":"default_user.conf"}]}},{"configMap":{"name":"rabbitmq-cluster-server-conf","items":[{"key":"operatorDefaults.conf","path":"operatorDefaults.conf"},{"key":"userDefinedConfiguration.conf","path":"userDefinedConfiguration.conf"}]}}],"defaultMode":420}},{"name":"rabbitmq-erlang-cookie","emptyDir":{}},{"name":"erlang-cookie-secret","secret":{"secretName":"rabbitmq-cluster-erlang-cookie","defaultMode":420}},{"name":"rabbitmq-plugins","emptyDir":{}},{"name":"pod-info","downwardAPI":{"items":[{"path":"skipPreStopChecks","fieldRef":{"apiVersion":"v1","fieldPath":"metadata.labels['skipPreStopChecks']"}}],"defaultMode":420}}],"initContainers":[{"name":"setup-container","image":"rabbitmq:3.8.12-management","command":["sh","-c","cp /tmp/erlang-cookie-secret/.erlang.cookie /var/lib/rabbitmq/.erlang.cookie \u0026\u0026 chown 999:999 /var/lib/rabbitmq/.erlang.cookie \u0026\u0026 chmod 600 /var/lib/rabbitmq/.erlang.cookie ; cp /tmp/rabbitmq-plugins/enabled_plugins /operator/enabled_plugins \u0026\u0026 chown 999:999 /operator/enabled_plugins ; chown 999:999 /var/lib/rabbitmq/mnesia/ ; echo '[default]' \u003e /var/lib/rabbitmq/.rabbitmqadmin.conf \u0026\u0026 sed -e 's/default_user/username/' -e 's/default_pass/password/' /tmp/default_user.conf \u003e\u003e /var/lib/rabbitmq/.rabbitmqadmin.conf \u0026\u0026 chown 999:999 /var/lib/rabbitmq/.rabbitmqadmin.conf \u0026\u0026 chmod 600 /var/lib/rabbitmq/.rabbitmqadmin.conf"],"resources":{"limits":{"cpu":"100m","memory":"500Mi"},"requests":{"cpu":"100m","memory":"500Mi"}},"volumeMounts":[{"name":"plugins-conf","mountPath":"/tmp/rabbitmq-plugins/"},{"name":"rabbitmq-erlang-cookie","mountPath":"/var/lib/rabbitmq/"},{"name":"erlang-cookie-secret","mountPath":"/tmp/erlang-cookie-secret/"},{"name":"rabbitmq-plugins","mountPath":"/operator"},{"name":"persistence","mountPath":"/var/lib/rabbitmq/mnesia/"},{"name":"rabbitmq-confd","mountPath":"/tmp/default_user.conf","subPath":"default_user.conf"}],"terminationMessagePath":"/dev/termination-log","terminationMessagePolicy":"File","imagePullPolicy":"IfNotPresent","securityContext":{"capabilities":{"drop":["FSETID","KILL","SETGID","SETUID","SETPCAP","NET_BIND_SERVICE","NET_RAW","SYS_CHROOT","MKNOD","AUDIT_WRITE","SETFCAP"]},"runAsUser":0}}],"containers":[{"name":"rabbitmq","image":"rabbitmq:3.8.12-management","ports":[{"name":"epmd","containerPort":4369,"protocol":"TCP"},{"name":"amqp","containerPort":5672,"protocol":"TCP"},{"name":"management","containerPort":15672,"protocol":"TCP"},{"name":"prometheus","containerPort":15692,"protocol":"TCP"}],"env":[{"name":"MY_POD_NAME","valueFrom":{"fieldRef":{"apiVersion":"v1","fieldPath":"metadata.name"}}},{"name":"MY_POD_NAMESPACE","valueFrom":{"fieldRef":{"apiVersion":"v1","fieldPath":"metadata.namespace"}}},{"name":"RABBITMQ_ENABLED_PLUGINS_FILE","value":"/operator/enabled_plugins"},{"name":"K8S_SERVICE_NAME","value":"rabbitmq-cluster-nodes"},{"name":"RABBITMQ_USE_LONGNAME","value":"true"},{"name":"RABBITMQ_NODENAME","value":"rabbit@$(MY_POD_NAME).$(K8S_SERVICE_NAME).$(MY_POD_NAMESPACE)"},{"name":"K8S_HOSTNAME_SUFFIX","value":".$(K8S_SERVICE_NAME).$(MY_POD_NAMESPACE)"}],"resources":{"limits":{"cpu":"2","memory":"2Gi"},"requests":{"cpu":"1","memory":"2Gi"}},"volumeMounts":[{"name":"rabbitmq-erlang-cookie","mountPath":"/var/lib/rabbitmq/"},{"name":"persistence","mountPath":"/var/lib/rabbitmq/mnesia/"},{"name":"rabbitmq-plugins","mountPath":"/operator"},{"name":"rabbitmq-confd","mountPath":"/etc/rabbitmq/conf.d/10-operatorDefaults.conf","subPath":"operatorDefaults.conf"},{"name":"rabbitmq-confd","mountPath":"/etc/rabbitmq/conf.d/11-default_user.conf","subPath":"default_user.conf"},{"name":"rabbitmq-confd","mountPath":"/etc/rabbitmq/conf.d/90-userDefinedConfiguration.conf","subPath":"userDefinedConfiguration.conf"},{"name":"pod-info","mountPath":"/etc/pod-info/"}],"readinessProbe":{"tcpSocket":{"port":"amqp"},"initialDelaySeconds":10,"timeoutSeconds":5,"periodSeconds":10,"successThreshold":1,"failureThreshold":3},"lifecycle":{"preStop":{"exec":{"command":["/bin/bash","-c","if [ ! -z \"$(cat /etc/pod-info/skipPreStopChecks)\" ]; then exit 0; fi; rabbitmq-upgrade await_online_quorum_plus_one -t 604800; rabbitmq-upgrade await_online_synchronized_mirror -t 604800; rabbitmq-upgrade drain -t 604800"]}}},"terminationMessagePath":"/dev/termination-log","terminationMessagePolicy":"File","imagePullPolicy":"IfNotPresent"}],"restartPolicy":"Always","terminationGracePeriodSeconds":604800,"dnsPolicy":"ClusterFirst","serviceAccountName":"rabbitmq-cluster-server","serviceAccount":"rabbitmq-cluster-server","automountServiceAccountToken":true,"securityContext":{"runAsUser":999,"runAsGroup":999,"fsGroup":999},"schedulerName":"default-scheduler","topologySpreadConstraints":[{"maxSkew":1,"topologyKey":"topology.kubernetes.io/zone","whenUnsatisfiable":"ScheduleAnyway","labelSelector":{"matchLabels":{"app.kubernetes.io/name":"rabbitmq-cluster"}}}]}},"volumeClaimTemplates":[{"metadata":{"name":"persistence","namespace":"default","creationTimestamp":null,"labels":{"app.kubernetes.io/component":"rabbitmq","app.kubernetes.io/name":"rabbitmq-cluster","app.kubernetes.io/part-of":"rabbitmq"},"ownerReferences":[{"apiVersion":"rabbitmq.com/v1beta1","kind":"RabbitmqCluster","name":"rabbitmq-cluster","uid":"3ecefa8a-1bec-48a7-9af4-dd0df3339101","controller":true,"blockOwnerDeletion":false}]},"spec":{"accessModes":["ReadWriteOnce"],"resources":{"requests":{"storage":"15Gi"}},"volumeMode":"Filesystem"},"status":{"phase":"Pending"}}],"serviceName":"rabbitmq-cluster-nodes","podManagementPolicy":"Parallel","updateStrategy":{"type":"RollingUpdate","rollingUpdate":{"partition":0}},"revisionHistoryLimit":10},"status":{"replicas":0}}
2022/03/18 18:07:34 learn_server.go:289: [SIEVE-AFTER-HEAR]	28
2022/03/18 18:07:34 learn_server.go:263: [SIEVE-AFTER-WRITE]	39	Create	statefulset	github.com/rabbitmq/cluster-operator/controllers.(*RabbitmqClusterReconciler)	NoError	{"metadata":{"name":"rabbitmq-cluster-server","namespace":"default","selfLink":"/apis/apps/v1/namespaces/default/statefulsets/rabbitmq-cluster-server","uid":"1d62d993-2c32-4da7-8884-e4cfad9e587d","resourceVersion":"1462","generation":1,"creationTimestamp":"2022-03-18T18:07:34Z","labels":{"app.kubernetes.io/component":"rabbitmq","app.kubernetes.io/name":"rabbitmq-cluster","app.kubernetes.io/part-of":"rabbitmq"},"ownerReferences":[{"apiVersion":"rabbitmq.com/v1beta1","kind":"RabbitmqCluster","name":"rabbitmq-cluster","uid":"3ecefa8a-1bec-48a7-9af4-dd0df3339101","controller":true,"blockOwnerDeletion":true}],"managedFields":[{"manager":"manager","operation":"Update","apiVersion":"apps/v1","time":"2022-03-18T18:07:34Z","fieldsType":"FieldsV1","fieldsV1":{"f:metadata":{"f:labels":{".":{},"f:app.kubernetes.io/component":{},"f:app.kubernetes.io/name":{},"f:app.kubernetes.io/part-of":{}},"f:ownerReferences":{".":{},"k:{\"uid\":\"3ecefa8a-1bec-48a7-9af4-dd0df3339101\"}":{".":{},"f:apiVersion":{},"f:blockOwnerDeletion":{},"f:controller":{},"f:kind":{},"f:name":{},"f:uid":{}}}},"f:spec":{"f:podManagementPolicy":{},"f:replicas":{},"f:revisionHistoryLimit":{},"f:selector":{"f:matchLabels":{".":{},"f:app.kubernetes.io/name":{}}},"f:serviceName":{},"f:template":{"f:metadata":{"f:annotations":{".":{},"f:prometheus.io/port":{},"f:prometheus.io/scrape":{}},"f:labels":{".":{},"f:app.kubernetes.io/component":{},"f:app.kubernetes.io/name":{},"f:app.kubernetes.io/part-of":{}}},"f:spec":{"f:automountServiceAccountToken":{},"f:containers":{"k:{\"name\":\"rabbitmq\"}":{".":{},"f:env":{".":{},"k:{\"name\":\"K8S_HOSTNAME_SUFFIX\"}":{".":{},"f:name":{},"f:value":{}},"k:{\"name\":\"K8S_SERVICE_NAME\"}":{".":{},"f:name":{},"f:value":{}},"k:{\"name\":\"MY_POD_NAME\"}":{".":{},"f:name":{},"f:valueFrom":{".":{},"f:fieldRef":{".":{},"f:apiVersion":{},"f:fieldPath":{}}}},"k:{\"name\":\"MY_POD_NAMESPACE\"}":{".":{},"f:name":{},"f:valueFrom":{".":{},"f:fieldRef":{".":{},"f:apiVersion":{},"f:fieldPath":{}}}},"k:{\"name\":\"RABBITMQ_ENABLED_PLUGINS_FILE\"}":{".":{},"f:name":{},"f:value":{}},"k:{\"name\":\"RABBITMQ_NODENAME\"}":{".":{},"f:name":{},"f:value":{}},"k:{\"name\":\"RABBITMQ_USE_LONGNAME\"}":{".":{},"f:name":{},"f:value":{}}},"f:image":{},"f:imagePullPolicy":{},"f:lifecycle":{".":{},"f:preStop":{".":{},"f:exec":{".":{},"f:command":{}}}},"f:name":{},"f:ports":{".":{},"k:{\"containerPort\":4369,\"protocol\":\"TCP\"}":{".":{},"f:containerPort":{},"f:name":{},"f:protocol":{}},"k:{\"containerPort\":5672,\"protocol\":\"TCP\"}":{".":{},"f:containerPort":{},"f:name":{},"f:protocol":{}},"k:{\"containerPort\":15672,\"protocol\":\"TCP\"}":{".":{},"f:containerPort":{},"f:name":{},"f:protocol":{}},"k:{\"containerPort\":15692,\"protocol\":\"TCP\"}":{".":{},"f:containerPort":{},"f:name":{},"f:protocol":{}}},"f:readinessProbe":{".":{},"f:failureThreshold":{},"f:initialDelaySeconds":{},"f:periodSeconds":{},"f:successThreshold":{},"f:tcpSocket":{".":{},"f:port":{}},"f:timeoutSeconds":{}},"f:resources":{".":{},"f:limits":{".":{},"f:cpu":{},"f:memory":{}},"f:requests":{".":{},"f:cpu":{},"f:memory":{}}},"f:terminationMessagePath":{},"f:terminationMessagePolicy":{},"f:volumeMounts":{".":{},"k:{\"mountPath\":\"/etc/pod-info/\"}":{".":{},"f:mountPath":{},"f:name":{}},"k:{\"mountPath\":\"/etc/rabbitmq/conf.d/10-operatorDefaults.conf\"}":{".":{},"f:mountPath":{},"f:name":{},"f:subPath":{}},"k:{\"mountPath\":\"/etc/rabbitmq/conf.d/11-default_user.conf\"}":{".":{},"f:mountPath":{},"f:name":{},"f:subPath":{}},"k:{\"mountPath\":\"/etc/rabbitmq/conf.d/90-userDefinedConfiguration.conf\"}":{".":{},"f:mountPath":{},"f:name":{},"f:subPath":{}},"k:{\"mountPath\":\"/operator\"}":{".":{},"f:mountPath":{},"f:name":{}},"k:{\"mountPath\":\"/var/lib/rabbitmq/\"}":{".":{},"f:mountPath":{},"f:name":{}},"k:{\"mountPath\":\"/var/lib/rabbitmq/mnesia/\"}":{".":{},"f:mountPath":{},"f:name":{}}}}},"f:dnsPolicy":{},"f:initContainers":{".":{},"k:{\"name\":\"setup-container\"}":{".":{},"f:command":{},"f:image":{},"f:imagePullPolicy":{},"f:name":{},"f:resources":{".":{},"f:limits":{".":{},"f:cpu":{},"f:memory":{}},"f:requests":{".":{},"f:cpu":{},"f:memory":{}}},"f:securityContext":{".":{},"f:capabilities":{".":{},"f:drop":{}},"f:runAsUser":{}},"f:terminationMessagePath":{},"f:terminationMessagePolicy":{},"f:volumeMounts":{".":{},"k:{\"mountPath\":\"/operator\"}":{".":{},"f:mountPath":{},"f:name":{}},"k:{\"mountPath\":\"/tmp/default_user.conf\"}":{".":{},"f:mountPath":{},"f:name":{},"f:subPath":{}},"k:{\"mountPath\":\"/tmp/erlang-cookie-secret/\"}":{".":{},"f:mountPath":{},"f:name":{}},"k:{\"mountPath\":\"/tmp/rabbitmq-plugins/\"}":{".":{},"f:mountPath":{},"f:name":{}},"k:{\"mountPath\":\"/var/lib/rabbitmq/\"}":{".":{},"f:mountPath":{},"f:name":{}},"k:{\"mountPath\":\"/var/lib/rabbitmq/mnesia/\"}":{".":{},"f:mountPath":{},"f:name":{}}}}},"f:restartPolicy":{},"f:schedulerName":{},"f:securityContext":{".":{},"f:fsGroup":{},"f:runAsGroup":{},"f:runAsUser":{}},"f:serviceAccount":{},"f:serviceAccountName":{},"f:terminationGracePeriodSeconds":{},"f:topologySpreadConstraints":{".":{},"k:{\"topologyKey\":\"topology.kubernetes.io/zone\",\"whenUnsatisfiable\":\"ScheduleAnyway\"}":{".":{},"f:labelSelector":{".":{},"f:matchLabels":{".":{},"f:app.kubernetes.io/name":{}}},"f:maxSkew":{},"f:topologyKey":{},"f:whenUnsatisfiable":{}}},"f:volumes":{".":{},"k:{\"name\":\"erlang-cookie-secret\"}":{".":{},"f:name":{},"f:secret":{".":{},"f:defaultMode":{},"f:secretName":{}}},"k:{\"name\":\"plugins-conf\"}":{".":{},"f:configMap":{".":{},"f:defaultMode":{},"f:name":{}},"f:name":{}},"k:{\"name\":\"pod-info\"}":{".":{},"f:downwardAPI":{".":{},"f:defaultMode":{},"f:items":{}},"f:name":{}},"k:{\"name\":\"rabbitmq-confd\"}":{".":{},"f:name":{},"f:projected":{".":{},"f:defaultMode":{},"f:sources":{}}},"k:{\"name\":\"rabbitmq-erlang-cookie\"}":{".":{},"f:emptyDir":{},"f:name":{}},"k:{\"name\":\"rabbitmq-plugins\"}":{".":{},"f:emptyDir":{},"f:name":{}}}}},"f:updateStrategy":{"f:rollingUpdate":{".":{},"f:partition":{}},"f:type":{}},"f:volumeClaimTemplates":{}}}}]},"spec":{"replicas":1,"selector":{"matchLabels":{"app.kubernetes.io/name":"rabbitmq-cluster"}},"template":{"metadata":{"creationTimestamp":null,"labels":{"app.kubernetes.io/component":"rabbitmq","app.kubernetes.io/name":"rabbitmq-cluster","app.kubernetes.io/part-of":"rabbitmq"},"annotations":{"prometheus.io/port":"15692","prometheus.io/scrape":"true"}},"spec":{"volumes":[{"name":"plugins-conf","configMap":{"name":"rabbitmq-cluster-plugins-conf","defaultMode":420}},{"name":"rabbitmq-confd","projected":{"sources":[{"secret":{"name":"rabbitmq-cluster-default-user","items":[{"key":"default_user.conf","path":"default_user.conf"}]}},{"configMap":{"name":"rabbitmq-cluster-server-conf","items":[{"key":"operatorDefaults.conf","path":"operatorDefaults.conf"},{"key":"userDefinedConfiguration.conf","path":"userDefinedConfiguration.conf"}]}}],"defaultMode":420}},{"name":"rabbitmq-erlang-cookie","emptyDir":{}},{"name":"erlang-cookie-secret","secret":{"secretName":"rabbitmq-cluster-erlang-cookie","defaultMode":420}},{"name":"rabbitmq-plugins","emptyDir":{}},{"name":"pod-info","downwardAPI":{"items":[{"path":"skipPreStopChecks","fieldRef":{"apiVersion":"v1","fieldPath":"metadata.labels['skipPreStopChecks']"}}],"defaultMode":420}}],"initContainers":[{"name":"setup-container","image":"rabbitmq:3.8.12-management","command":["sh","-c","cp /tmp/erlang-cookie-secret/.erlang.cookie /var/lib/rabbitmq/.erlang.cookie \u0026\u0026 chown 999:999 /var/lib/rabbitmq/.erlang.cookie \u0026\u0026 chmod 600 /var/lib/rabbitmq/.erlang.cookie ; cp /tmp/rabbitmq-plugins/enabled_plugins /operator/enabled_plugins \u0026\u0026 chown 999:999 /operator/enabled_plugins ; chown 999:999 /var/lib/rabbitmq/mnesia/ ; echo '[default]' \u003e /var/lib/rabbitmq/.rabbitmqadmin.conf \u0026\u0026 sed -e 's/default_user/username/' -e 's/default_pass/password/' /tmp/default_user.conf \u003e\u003e /var/lib/rabbitmq/.rabbitmqadmin.conf \u0026\u0026 chown 999:999 /var/lib/rabbitmq/.rabbitmqadmin.conf \u0026\u0026 chmod 600 /var/lib/rabbitmq/.rabbitmqadmin.conf"],"resources":{"limits":{"cpu":"100m","memory":"500Mi"},"requests":{"cpu":"100m","memory":"500Mi"}},"volumeMounts":[{"name":"plugins-conf","mountPath":"/tmp/rabbitmq-plugins/"},{"name":"rabbitmq-erlang-cookie","mountPath":"/var/lib/rabbitmq/"},{"name":"erlang-cookie-secret","mountPath":"/tmp/erlang-cookie-secret/"},{"name":"rabbitmq-plugins","mountPath":"/operator"},{"name":"persistence","mountPath":"/var/lib/rabbitmq/mnesia/"},{"name":"rabbitmq-confd","mountPath":"/tmp/default_user.conf","subPath":"default_user.conf"}],"terminationMessagePath":"/dev/termination-log","terminationMessagePolicy":"File","imagePullPolicy":"IfNotPresent","securityContext":{"capabilities":{"drop":["FSETID","KILL","SETGID","SETUID","SETPCAP","NET_BIND_SERVICE","NET_RAW","SYS_CHROOT","MKNOD","AUDIT_WRITE","SETFCAP"]},"runAsUser":0}}],"containers":[{"name":"rabbitmq","image":"rabbitmq:3.8.12-management","ports":[{"name":"epmd","containerPort":4369,"protocol":"TCP"},{"name":"amqp","containerPort":5672,"protocol":"TCP"},{"name":"management","containerPort":15672,"protocol":"TCP"},{"name":"prometheus","containerPort":15692,"protocol":"TCP"}],"env":[{"name":"MY_POD_NAME","valueFrom":{"fieldRef":{"apiVersion":"v1","fieldPath":"metadata.name"}}},{"name":"MY_POD_NAMESPACE","valueFrom":{"fieldRef":{"apiVersion":"v1","fieldPath":"metadata.namespace"}}},{"name":"RABBITMQ_ENABLED_PLUGINS_FILE","value":"/operator/enabled_plugins"},{"name":"K8S_SERVICE_NAME","value":"rabbitmq-cluster-nodes"},{"name":"RABBITMQ_USE_LONGNAME","value":"true"},{"name":"RABBITMQ_NODENAME","value":"rabbit@$(MY_POD_NAME).$(K8S_SERVICE_NAME).$(MY_POD_NAMESPACE)"},{"name":"K8S_HOSTNAME_SUFFIX","value":".$(K8S_SERVICE_NAME).$(MY_POD_NAMESPACE)"}],"resources":{"limits":{"cpu":"2","memory":"2Gi"},"requests":{"cpu":"1","memory":"2Gi"}},"volumeMounts":[{"name":"rabbitmq-erlang-cookie","mountPath":"/var/lib/rabbitmq/"},{"name":"persistence","mountPath":"/var/lib/rabbitmq/mnesia/"},{"name":"rabbitmq-plugins","mountPath":"/operator"},{"name":"rabbitmq-confd","mountPath":"/etc/rabbitmq/conf.d/10-operatorDefaults.conf","subPath":"operatorDefaults.conf"},{"name":"rabbitmq-confd","mountPath":"/etc/rabbitmq/conf.d/11-default_user.conf","subPath":"default_user.conf"},{"name":"rabbitmq-confd","mountPath":"/etc/rabbitmq/conf.d/90-userDefinedConfiguration.conf","subPath":"userDefinedConfiguration.conf"},{"name":"pod-info","mountPath":"/etc/pod-info/"}],"readinessProbe":{"tcpSocket":{"port":"amqp"},"initialDelaySeconds":10,"timeoutSeconds":5,"periodSeconds":10,"successThreshold":1,"failureThreshold":3},"lifecycle":{"preStop":{"exec":{"command":["/bin/bash","-c","if [ ! -z \"$(cat /etc/pod-info/skipPreStopChecks)\" ]; then exit 0; fi; rabbitmq-upgrade await_online_quorum_plus_one -t 604800; rabbitmq-upgrade await_online_synchronized_mirror -t 604800; rabbitmq-upgrade drain -t 604800"]}}},"terminationMessagePath":"/dev/termination-log","terminationMessagePolicy":"File","imagePullPolicy":"IfNotPresent"}],"restartPolicy":"Always","terminationGracePeriodSeconds":604800,"dnsPolicy":"ClusterFirst","serviceAccountName":"rabbitmq-cluster-server","serviceAccount":"rabbitmq-cluster-server","automountServiceAccountToken":true,"securityContext":{"runAsUser":999,"runAsGroup":999,"fsGroup":999},"schedulerName":"default-scheduler","topologySpreadConstraints":[{"maxSkew":1,"topologyKey":"topology.kubernetes.io/zone","whenUnsatisfiable":"ScheduleAnyway","labelSelector":{"matchLabels":{"app.kubernetes.io/name":"rabbitmq-cluster"}}}]}},"volumeClaimTemplates":[{"metadata":{"name":"persistence","namespace":"default","creationTimestamp":null,"labels":{"app.kubernetes.io/component":"rabbitmq","app.kubernetes.io/name":"rabbitmq-cluster","app.kubernetes.io/part-of":"rabbitmq"},"ownerReferences":[{"apiVersion":"rabbitmq.com/v1beta1","kind":"RabbitmqCluster","name":"rabbitmq-cluster","uid":"3ecefa8a-1bec-48a7-9af4-dd0df3339101","controller":true,"blockOwnerDeletion":false}]},"spec":{"accessModes":["ReadWriteOnce"],"resources":{"requests":{"storage":"15Gi"}},"volumeMode":"Filesystem"},"status":{"phase":"Pending"}}],"serviceName":"rabbitmq-cluster-nodes","podManagementPolicy":"Parallel","updateStrategy":{"type":"RollingUpdate","rollingUpdate":{"partition":0}},"revisionHistoryLimit":10},"status":{"replicas":0}}
2022/03/18 18:07:34 learn_server.go:279: [SIEVE-BEFORE-HEAR]	29	Updated	persistentvolumeclaim	{"metadata":{"name":"persistence-rabbitmq-cluster-server-0","namespace":"default","selfLink":"/api/v1/namespaces/default/persistentvolumeclaims/persistence-rabbitmq-cluster-server-0","uid":"2a49a40a-31f5-4d2b-ba65-716831e0fa6b","resourceVersion":"1463","creationTimestamp":"2022-03-18T18:06:25Z","labels":{"app.kubernetes.io/component":"rabbitmq","app.kubernetes.io/name":"rabbitmq-cluster","app.kubernetes.io/part-of":"rabbitmq"},"annotations":{"pv.kubernetes.io/bind-completed":"yes","pv.kubernetes.io/bound-by-controller":"yes","volume.beta.kubernetes.io/storage-provisioner":"hostpath.csi.k8s.io"},"ownerReferences":[{"apiVersion":"rabbitmq.com/v1beta1","kind":"RabbitmqCluster","name":"rabbitmq-cluster","uid":"3ecefa8a-1bec-48a7-9af4-dd0df3339101","controller":true,"blockOwnerDeletion":false}],"finalizers":["kubernetes.io/pvc-protection"],"managedFields":[{"manager":"kube-controller-manager","operation":"Update","apiVersion":"v1","time":"2022-03-18T18:06:25Z","fieldsType":"FieldsV1","fieldsV1":{"f:metadata":{"f:annotations":{".":{},"f:pv.kubernetes.io/bind-completed":{},"f:pv.kubernetes.io/bound-by-controller":{},"f:volume.beta.kubernetes.io/storage-provisioner":{}},"f:labels":{".":{},"f:app.kubernetes.io/component":{},"f:app.kubernetes.io/name":{},"f:app.kubernetes.io/part-of":{}},"f:ownerReferences":{".":{},"k:{\"uid\":\"3ecefa8a-1bec-48a7-9af4-dd0df3339101\"}":{".":{},"f:apiVersion":{},"f:blockOwnerDeletion":{},"f:controller":{},"f:kind":{},"f:name":{},"f:uid":{}}}},"f:spec":{"f:accessModes":{},"f:resources":{"f:requests":{}},"f:volumeMode":{},"f:volumeName":{}},"f:status":{"f:accessModes":{},"f:capacity":{".":{},"f:storage":{}},"f:phase":{}}}},{"manager":"csi-resizer","operation":"Update","apiVersion":"v1","time":"2022-03-18T18:07:34Z","fieldsType":"FieldsV1","fieldsV1":{"f:status":{"f:conditions":{".":{},"k:{\"type\":\"Resizing\"}":{".":{},"f:lastProbeTime":{},"f:lastTransitionTime":{},"f:status":{},"f:type":{}}}}}},{"manager":"manager","operation":"Update","apiVersion":"v1","time":"2022-03-18T18:07:34Z","fieldsType":"FieldsV1","fieldsV1":{"f:spec":{"f:resources":{"f:requests":{"f:storage":{}}}}}}]},"spec":{"accessModes":["ReadWriteOnce"],"resources":{"requests":{"storage":"15Gi"}},"volumeName":"pvc-2a49a40a-31f5-4d2b-ba65-716831e0fa6b","storageClassName":"csi-hostpath-sc","volumeMode":"Filesystem"},"status":{"phase":"Bound","accessModes":["ReadWriteOnce"],"capacity":{"storage":"10Gi"},"conditions":[{"type":"Resizing","status":"True","lastProbeTime":null,"lastTransitionTime":"2022-03-18T18:07:34Z"}]}}
2022/03/18 18:07:34 learn_server.go:291: [SIEVE-AFTER-READ]	Get	true	statefulset	default	rabbitmq-cluster-server	github.com/rabbitmq/cluster-operator/controllers.(*RabbitmqClusterReconciler)	NoError	{"kind":"StatefulSet","apiVersion":"apps/v1","metadata":{"name":"rabbitmq-cluster-server","namespace":"default","selfLink":"/apis/apps/v1/namespaces/default/statefulsets/rabbitmq-cluster-server","uid":"1d62d993-2c32-4da7-8884-e4cfad9e587d","resourceVersion":"1462","generation":1,"creationTimestamp":"2022-03-18T18:07:34Z","labels":{"app.kubernetes.io/component":"rabbitmq","app.kubernetes.io/name":"rabbitmq-cluster","app.kubernetes.io/part-of":"rabbitmq"},"ownerReferences":[{"apiVersion":"rabbitmq.com/v1beta1","kind":"RabbitmqCluster","name":"rabbitmq-cluster","uid":"3ecefa8a-1bec-48a7-9af4-dd0df3339101","controller":true,"blockOwnerDeletion":true}],"managedFields":[{"manager":"manager","operation":"Update","apiVersion":"apps/v1","time":"2022-03-18T18:07:34Z","fieldsType":"FieldsV1","fieldsV1":{"f:metadata":{"f:labels":{".":{},"f:app.kubernetes.io/component":{},"f:app.kubernetes.io/name":{},"f:app.kubernetes.io/part-of":{}},"f:ownerReferences":{".":{},"k:{\"uid\":\"3ecefa8a-1bec-48a7-9af4-dd0df3339101\"}":{".":{},"f:apiVersion":{},"f:blockOwnerDeletion":{},"f:controller":{},"f:kind":{},"f:name":{},"f:uid":{}}}},"f:spec":{"f:podManagementPolicy":{},"f:replicas":{},"f:revisionHistoryLimit":{},"f:selector":{"f:matchLabels":{".":{},"f:app.kubernetes.io/name":{}}},"f:serviceName":{},"f:template":{"f:metadata":{"f:annotations":{".":{},"f:prometheus.io/port":{},"f:prometheus.io/scrape":{}},"f:labels":{".":{},"f:app.kubernetes.io/component":{},"f:app.kubernetes.io/name":{},"f:app.kubernetes.io/part-of":{}}},"f:spec":{"f:automountServiceAccountToken":{},"f:containers":{"k:{\"name\":\"rabbitmq\"}":{".":{},"f:env":{".":{},"k:{\"name\":\"K8S_HOSTNAME_SUFFIX\"}":{".":{},"f:name":{},"f:value":{}},"k:{\"name\":\"K8S_SERVICE_NAME\"}":{".":{},"f:name":{},"f:value":{}},"k:{\"name\":\"MY_POD_NAME\"}":{".":{},"f:name":{},"f:valueFrom":{".":{},"f:fieldRef":{".":{},"f:apiVersion":{},"f:fieldPath":{}}}},"k:{\"name\":\"MY_POD_NAMESPACE\"}":{".":{},"f:name":{},"f:valueFrom":{".":{},"f:fieldRef":{".":{},"f:apiVersion":{},"f:fieldPath":{}}}},"k:{\"name\":\"RABBITMQ_ENABLED_PLUGINS_FILE\"}":{".":{},"f:name":{},"f:value":{}},"k:{\"name\":\"RABBITMQ_NODENAME\"}":{".":{},"f:name":{},"f:value":{}},"k:{\"name\":\"RABBITMQ_USE_LONGNAME\"}":{".":{},"f:name":{},"f:value":{}}},"f:image":{},"f:imagePullPolicy":{},"f:lifecycle":{".":{},"f:preStop":{".":{},"f:exec":{".":{},"f:command":{}}}},"f:name":{},"f:ports":{".":{},"k:{\"containerPort\":4369,\"protocol\":\"TCP\"}":{".":{},"f:containerPort":{},"f:name":{},"f:protocol":{}},"k:{\"containerPort\":5672,\"protocol\":\"TCP\"}":{".":{},"f:containerPort":{},"f:name":{},"f:protocol":{}},"k:{\"containerPort\":15672,\"protocol\":\"TCP\"}":{".":{},"f:containerPort":{},"f:name":{},"f:protocol":{}},"k:{\"containerPort\":15692,\"protocol\":\"TCP\"}":{".":{},"f:containerPort":{},"f:name":{},"f:protocol":{}}},"f:readinessProbe":{".":{},"f:failureThreshold":{},"f:initialDelaySeconds":{},"f:periodSeconds":{},"f:successThreshold":{},"f:tcpSocket":{".":{},"f:port":{}},"f:timeoutSeconds":{}},"f:resources":{".":{},"f:limits":{".":{},"f:cpu":{},"f:memory":{}},"f:requests":{".":{},"f:cpu":{},"f:memory":{}}},"f:terminationMessagePath":{},"f:terminationMessagePolicy":{},"f:volumeMounts":{".":{},"k:{\"mountPath\":\"/etc/pod-info/\"}":{".":{},"f:mountPath":{},"f:name":{}},"k:{\"mountPath\":\"/etc/rabbitmq/conf.d/10-operatorDefaults.conf\"}":{".":{},"f:mountPath":{},"f:name":{},"f:subPath":{}},"k:{\"mountPath\":\"/etc/rabbitmq/conf.d/11-default_user.conf\"}":{".":{},"f:mountPath":{},"f:name":{},"f:subPath":{}},"k:{\"mountPath\":\"/etc/rabbitmq/conf.d/90-userDefinedConfiguration.conf\"}":{".":{},"f:mountPath":{},"f:name":{},"f:subPath":{}},"k:{\"mountPath\":\"/operator\"}":{".":{},"f:mountPath":{},"f:name":{}},"k:{\"mountPath\":\"/var/lib/rabbitmq/\"}":{".":{},"f:mountPath":{},"f:name":{}},"k:{\"mountPath\":\"/var/lib/rabbitmq/mnesia/\"}":{".":{},"f:mountPath":{},"f:name":{}}}}},"f:dnsPolicy":{},"f:initContainers":{".":{},"k:{\"name\":\"setup-container\"}":{".":{},"f:command":{},"f:image":{},"f:imagePullPolicy":{},"f:name":{},"f:resources":{".":{},"f:limits":{".":{},"f:cpu":{},"f:memory":{}},"f:requests":{".":{},"f:cpu":{},"f:memory":{}}},"f:securityContext":{".":{},"f:capabilities":{".":{},"f:drop":{}},"f:runAsUser":{}},"f:terminationMessagePath":{},"f:terminationMessagePolicy":{},"f:volumeMounts":{".":{},"k:{\"mountPath\":\"/operator\"}":{".":{},"f:mountPath":{},"f:name":{}},"k:{\"mountPath\":\"/tmp/default_user.conf\"}":{".":{},"f:mountPath":{},"f:name":{},"f:subPath":{}},"k:{\"mountPath\":\"/tmp/erlang-cookie-secret/\"}":{".":{},"f:mountPath":{},"f:name":{}},"k:{\"mountPath\":\"/tmp/rabbitmq-plugins/\"}":{".":{},"f:mountPath":{},"f:name":{}},"k:{\"mountPath\":\"/var/lib/rabbitmq/\"}":{".":{},"f:mountPath":{},"f:name":{}},"k:{\"mountPath\":\"/var/lib/rabbitmq/mnesia/\"}":{".":{},"f:mountPath":{},"f:name":{}}}}},"f:restartPolicy":{},"f:schedulerName":{},"f:securityContext":{".":{},"f:fsGroup":{},"f:runAsGroup":{},"f:runAsUser":{}},"f:serviceAccount":{},"f:serviceAccountName":{},"f:terminationGracePeriodSeconds":{},"f:topologySpreadConstraints":{".":{},"k:{\"topologyKey\":\"topology.kubernetes.io/zone\",\"whenUnsatisfiable\":\"ScheduleAnyway\"}":{".":{},"f:labelSelector":{".":{},"f:matchLabels":{".":{},"f:app.kubernetes.io/name":{}}},"f:maxSkew":{},"f:topologyKey":{},"f:whenUnsatisfiable":{}}},"f:volumes":{".":{},"k:{\"name\":\"erlang-cookie-secret\"}":{".":{},"f:name":{},"f:secret":{".":{},"f:defaultMode":{},"f:secretName":{}}},"k:{\"name\":\"plugins-conf\"}":{".":{},"f:configMap":{".":{},"f:defaultMode":{},"f:name":{}},"f:name":{}},"k:{\"name\":\"pod-info\"}":{".":{},"f:downwardAPI":{".":{},"f:defaultMode":{},"f:items":{}},"f:name":{}},"k:{\"name\":\"rabbitmq-confd\"}":{".":{},"f:name":{},"f:projected":{".":{},"f:defaultMode":{},"f:sources":{}}},"k:{\"name\":\"rabbitmq-erlang-cookie\"}":{".":{},"f:emptyDir":{},"f:name":{}},"k:{\"name\":\"rabbitmq-plugins\"}":{".":{},"f:emptyDir":{},"f:name":{}}}}},"f:updateStrategy":{"f:rollingUpdate":{".":{},"f:partition":{}},"f:type":{}},"f:volumeClaimTemplates":{}}}}]},"spec":{"replicas":1,"selector":{"matchLabels":{"app.kubernetes.io/name":"rabbitmq-cluster"}},"template":{"metadata":{"creationTimestamp":null,"labels":{"app.kubernetes.io/component":"rabbitmq","app.kubernetes.io/name":"rabbitmq-cluster","app.kubernetes.io/part-of":"rabbitmq"},"annotations":{"prometheus.io/port":"15692","prometheus.io/scrape":"true"}},"spec":{"volumes":[{"name":"plugins-conf","configMap":{"name":"rabbitmq-cluster-plugins-conf","defaultMode":420}},{"name":"rabbitmq-confd","projected":{"sources":[{"secret":{"name":"rabbitmq-cluster-default-user","items":[{"key":"default_user.conf","path":"default_user.conf"}]}},{"configMap":{"name":"rabbitmq-cluster-server-conf","items":[{"key":"operatorDefaults.conf","path":"operatorDefaults.conf"},{"key":"userDefinedConfiguration.conf","path":"userDefinedConfiguration.conf"}]}}],"defaultMode":420}},{"name":"rabbitmq-erlang-cookie","emptyDir":{}},{"name":"erlang-cookie-secret","secret":{"secretName":"rabbitmq-cluster-erlang-cookie","defaultMode":420}},{"name":"rabbitmq-plugins","emptyDir":{}},{"name":"pod-info","downwardAPI":{"items":[{"path":"skipPreStopChecks","fieldRef":{"apiVersion":"v1","fieldPath":"metadata.labels['skipPreStopChecks']"}}],"defaultMode":420}}],"initContainers":[{"name":"setup-container","image":"rabbitmq:3.8.12-management","command":["sh","-c","cp /tmp/erlang-cookie-secret/.erlang.cookie /var/lib/rabbitmq/.erlang.cookie \u0026\u0026 chown 999:999 /var/lib/rabbitmq/.erlang.cookie \u0026\u0026 chmod 600 /var/lib/rabbitmq/.erlang.cookie ; cp /tmp/rabbitmq-plugins/enabled_plugins /operator/enabled_plugins \u0026\u0026 chown 999:999 /operator/enabled_plugins ; chown 999:999 /var/lib/rabbitmq/mnesia/ ; echo '[default]' \u003e /var/lib/rabbitmq/.rabbitmqadmin.conf \u0026\u0026 sed -e 's/default_user/username/' -e 's/default_pass/password/' /tmp/default_user.conf \u003e\u003e /var/lib/rabbitmq/.rabbitmqadmin.conf \u0026\u0026 chown 999:999 /var/lib/rabbitmq/.rabbitmqadmin.conf \u0026\u0026 chmod 600 /var/lib/rabbitmq/.rabbitmqadmin.conf"],"resources":{"limits":{"cpu":"100m","memory":"500Mi"},"requests":{"cpu":"100m","memory":"500Mi"}},"volumeMounts":[{"name":"plugins-conf","mountPath":"/tmp/rabbitmq-plugins/"},{"name":"rabbitmq-erlang-cookie","mountPath":"/var/lib/rabbitmq/"},{"name":"erlang-cookie-secret","mountPath":"/tmp/erlang-cookie-secret/"},{"name":"rabbitmq-plugins","mountPath":"/operator"},{"name":"persistence","mountPath":"/var/lib/rabbitmq/mnesia/"},{"name":"rabbitmq-confd","mountPath":"/tmp/default_user.conf","subPath":"default_user.conf"}],"terminationMessagePath":"/dev/termination-log","terminationMessagePolicy":"File","imagePullPolicy":"IfNotPresent","securityContext":{"capabilities":{"drop":["FSETID","KILL","SETGID","SETUID","SETPCAP","NET_BIND_SERVICE","NET_RAW","SYS_CHROOT","MKNOD","AUDIT_WRITE","SETFCAP"]},"runAsUser":0}}],"containers":[{"name":"rabbitmq","image":"rabbitmq:3.8.12-management","ports":[{"name":"epmd","containerPort":4369,"protocol":"TCP"},{"name":"amqp","containerPort":5672,"protocol":"TCP"},{"name":"management","containerPort":15672,"protocol":"TCP"},{"name":"prometheus","containerPort":15692,"protocol":"TCP"}],"env":[{"name":"MY_POD_NAME","valueFrom":{"fieldRef":{"apiVersion":"v1","fieldPath":"metadata.name"}}},{"name":"MY_POD_NAMESPACE","valueFrom":{"fieldRef":{"apiVersion":"v1","fieldPath":"metadata.namespace"}}},{"name":"RABBITMQ_ENABLED_PLUGINS_FILE","value":"/operator/enabled_plugins"},{"name":"K8S_SERVICE_NAME","value":"rabbitmq-cluster-nodes"},{"name":"RABBITMQ_USE_LONGNAME","value":"true"},{"name":"RABBITMQ_NODENAME","value":"rabbit@$(MY_POD_NAME).$(K8S_SERVICE_NAME).$(MY_POD_NAMESPACE)"},{"name":"K8S_HOSTNAME_SUFFIX","value":".$(K8S_SERVICE_NAME).$(MY_POD_NAMESPACE)"}],"resources":{"limits":{"cpu":"2","memory":"2Gi"},"requests":{"cpu":"1","memory":"2Gi"}},"volumeMounts":[{"name":"rabbitmq-erlang-cookie","mountPath":"/var/lib/rabbitmq/"},{"name":"persistence","mountPath":"/var/lib/rabbitmq/mnesia/"},{"name":"rabbitmq-plugins","mountPath":"/operator"},{"name":"rabbitmq-confd","mountPath":"/etc/rabbitmq/conf.d/10-operatorDefaults.conf","subPath":"operatorDefaults.conf"},{"name":"rabbitmq-confd","mountPath":"/etc/rabbitmq/conf.d/11-default_user.conf","subPath":"default_user.conf"},{"name":"rabbitmq-confd","mountPath":"/etc/rabbitmq/conf.d/90-userDefinedConfiguration.conf","subPath":"userDefinedConfiguration.conf"},{"name":"pod-info","mountPath":"/etc/pod-info/"}],"readinessProbe":{"tcpSocket":{"port":"amqp"},"initialDelaySeconds":10,"timeoutSeconds":5,"periodSeconds":10,"successThreshold":1,"failureThreshold":3},"lifecycle":{"preStop":{"exec":{"command":["/bin/bash","-c","if [ ! -z \"$(cat /etc/pod-info/skipPreStopChecks)\" ]; then exit 0; fi; rabbitmq-upgrade await_online_quorum_plus_one -t 604800; rabbitmq-upgrade await_online_synchronized_mirror -t 604800; rabbitmq-upgrade drain -t 604800"]}}},"terminationMessagePath":"/dev/termination-log","terminationMessagePolicy":"File","imagePullPolicy":"IfNotPresent"}],"restartPolicy":"Always","terminationGracePeriodSeconds":604800,"dnsPolicy":"ClusterFirst","serviceAccountName":"rabbitmq-cluster-server","serviceAccount":"rabbitmq-cluster-server","automountServiceAccountToken":true,"securityContext":{"runAsUser":999,"runAsGroup":999,"fsGroup":999},"schedulerName":"default-scheduler","topologySpreadConstraints":[{"maxSkew":1,"topologyKey":"topology.kubernetes.io/zone","whenUnsatisfiable":"ScheduleAnyway","labelSelector":{"matchLabels":{"app.kubernetes.io/name":"rabbitmq-cluster"}}}]}},"volumeClaimTemplates":[{"metadata":{"name":"persistence","namespace":"default","creationTimestamp":null,"labels":{"app.kubernetes.io/component":"rabbitmq","app.kubernetes.io/name":"rabbitmq-cluster","app.kubernetes.io/part-of":"rabbitmq"},"ownerReferences":[{"apiVersion":"rabbitmq.com/v1beta1","kind":"RabbitmqCluster","name":"rabbitmq-cluster","uid":"3ecefa8a-1bec-48a7-9af4-dd0df3339101","controller":true,"blockOwnerDeletion":false}]},"spec":{"accessModes":["ReadWriteOnce"],"resources":{"requests":{"storage":"15Gi"}},"volumeMode":"Filesystem"},"status":{"phase":"Pending"}}],"serviceName":"rabbitmq-cluster-nodes","podManagementPolicy":"Parallel","updateStrategy":{"type":"RollingUpdate","rollingUpdate":{"partition":0}},"revisionHistoryLimit":10},"status":{"replicas":0}}
2022/03/18 18:07:34 learn_server.go:256: [SIEVE-BEFORE-WRITE]	40
2022/03/18 18:07:34 learn_server.go:289: [SIEVE-AFTER-HEAR]	29
2022/03/18 18:07:34 learn_server.go:279: [SIEVE-BEFORE-HEAR]	30	Updated	statefulset	{"metadata":{"name":"rabbitmq-cluster-server","namespace":"default","selfLink":"/apis/apps/v1/namespaces/default/statefulsets/rabbitmq-cluster-server","uid":"1d62d993-2c32-4da7-8884-e4cfad9e587d","resourceVersion":"1465","generation":1,"creationTimestamp":"2022-03-18T18:07:34Z","labels":{"app.kubernetes.io/component":"rabbitmq","app.kubernetes.io/name":"rabbitmq-cluster","app.kubernetes.io/part-of":"rabbitmq"},"annotations":{"rabbitmq.com/createdAt":"2022-03-18T18:07:34Z"},"ownerReferences":[{"apiVersion":"rabbitmq.com/v1beta1","kind":"RabbitmqCluster","name":"rabbitmq-cluster","uid":"3ecefa8a-1bec-48a7-9af4-dd0df3339101","controller":true,"blockOwnerDeletion":true}],"managedFields":[{"manager":"manager","operation":"Update","apiVersion":"apps/v1","time":"2022-03-18T18:07:34Z","fieldsType":"FieldsV1","fieldsV1":{"f:metadata":{"f:annotations":{".":{},"f:rabbitmq.com/createdAt":{}},"f:labels":{".":{},"f:app.kubernetes.io/component":{},"f:app.kubernetes.io/name":{},"f:app.kubernetes.io/part-of":{}},"f:ownerReferences":{".":{},"k:{\"uid\":\"3ecefa8a-1bec-48a7-9af4-dd0df3339101\"}":{".":{},"f:apiVersion":{},"f:blockOwnerDeletion":{},"f:controller":{},"f:kind":{},"f:name":{},"f:uid":{}}}},"f:spec":{"f:podManagementPolicy":{},"f:replicas":{},"f:revisionHistoryLimit":{},"f:selector":{"f:matchLabels":{".":{},"f:app.kubernetes.io/name":{}}},"f:serviceName":{},"f:template":{"f:metadata":{"f:annotations":{".":{},"f:prometheus.io/port":{},"f:prometheus.io/scrape":{}},"f:labels":{".":{},"f:app.kubernetes.io/component":{},"f:app.kubernetes.io/name":{},"f:app.kubernetes.io/part-of":{}}},"f:spec":{"f:automountServiceAccountToken":{},"f:containers":{"k:{\"name\":\"rabbitmq\"}":{".":{},"f:env":{".":{},"k:{\"name\":\"K8S_HOSTNAME_SUFFIX\"}":{".":{},"f:name":{},"f:value":{}},"k:{\"name\":\"K8S_SERVICE_NAME\"}":{".":{},"f:name":{},"f:value":{}},"k:{\"name\":\"MY_POD_NAME\"}":{".":{},"f:name":{},"f:valueFrom":{".":{},"f:fieldRef":{".":{},"f:apiVersion":{},"f:fieldPath":{}}}},"k:{\"name\":\"MY_POD_NAMESPACE\"}":{".":{},"f:name":{},"f:valueFrom":{".":{},"f:fieldRef":{".":{},"f:apiVersion":{},"f:fieldPath":{}}}},"k:{\"name\":\"RABBITMQ_ENABLED_PLUGINS_FILE\"}":{".":{},"f:name":{},"f:value":{}},"k:{\"name\":\"RABBITMQ_NODENAME\"}":{".":{},"f:name":{},"f:value":{}},"k:{\"name\":\"RABBITMQ_USE_LONGNAME\"}":{".":{},"f:name":{},"f:value":{}}},"f:image":{},"f:imagePullPolicy":{},"f:lifecycle":{".":{},"f:preStop":{".":{},"f:exec":{".":{},"f:command":{}}}},"f:name":{},"f:ports":{".":{},"k:{\"containerPort\":4369,\"protocol\":\"TCP\"}":{".":{},"f:containerPort":{},"f:name":{},"f:protocol":{}},"k:{\"containerPort\":5672,\"protocol\":\"TCP\"}":{".":{},"f:containerPort":{},"f:name":{},"f:protocol":{}},"k:{\"containerPort\":15672,\"protocol\":\"TCP\"}":{".":{},"f:containerPort":{},"f:name":{},"f:protocol":{}},"k:{\"containerPort\":15692,\"protocol\":\"TCP\"}":{".":{},"f:containerPort":{},"f:name":{},"f:protocol":{}}},"f:readinessProbe":{".":{},"f:failureThreshold":{},"f:initialDelaySeconds":{},"f:periodSeconds":{},"f:successThreshold":{},"f:tcpSocket":{".":{},"f:port":{}},"f:timeoutSeconds":{}},"f:resources":{".":{},"f:limits":{".":{},"f:cpu":{},"f:memory":{}},"f:requests":{".":{},"f:cpu":{},"f:memory":{}}},"f:terminationMessagePath":{},"f:terminationMessagePolicy":{},"f:volumeMounts":{".":{},"k:{\"mountPath\":\"/etc/pod-info/\"}":{".":{},"f:mountPath":{},"f:name":{}},"k:{\"mountPath\":\"/etc/rabbitmq/conf.d/10-operatorDefaults.conf\"}":{".":{},"f:mountPath":{},"f:name":{},"f:subPath":{}},"k:{\"mountPath\":\"/etc/rabbitmq/conf.d/11-default_user.conf\"}":{".":{},"f:mountPath":{},"f:name":{},"f:subPath":{}},"k:{\"mountPath\":\"/etc/rabbitmq/conf.d/90-userDefinedConfiguration.conf\"}":{".":{},"f:mountPath":{},"f:name":{},"f:subPath":{}},"k:{\"mountPath\":\"/operator\"}":{".":{},"f:mountPath":{},"f:name":{}},"k:{\"mountPath\":\"/var/lib/rabbitmq/\"}":{".":{},"f:mountPath":{},"f:name":{}},"k:{\"mountPath\":\"/var/lib/rabbitmq/mnesia/\"}":{".":{},"f:mountPath":{},"f:name":{}}}}},"f:dnsPolicy":{},"f:initContainers":{".":{},"k:{\"name\":\"setup-container\"}":{".":{},"f:command":{},"f:image":{},"f:imagePullPolicy":{},"f:name":{},"f:resources":{".":{},"f:limits":{".":{},"f:cpu":{},"f:memory":{}},"f:requests":{".":{},"f:cpu":{},"f:memory":{}}},"f:securityContext":{".":{},"f:capabilities":{".":{},"f:drop":{}},"f:runAsUser":{}},"f:terminationMessagePath":{},"f:terminationMessagePolicy":{},"f:volumeMounts":{".":{},"k:{\"mountPath\":\"/operator\"}":{".":{},"f:mountPath":{},"f:name":{}},"k:{\"mountPath\":\"/tmp/default_user.conf\"}":{".":{},"f:mountPath":{},"f:name":{},"f:subPath":{}},"k:{\"mountPath\":\"/tmp/erlang-cookie-secret/\"}":{".":{},"f:mountPath":{},"f:name":{}},"k:{\"mountPath\":\"/tmp/rabbitmq-plugins/\"}":{".":{},"f:mountPath":{},"f:name":{}},"k:{\"mountPath\":\"/var/lib/rabbitmq/\"}":{".":{},"f:mountPath":{},"f:name":{}},"k:{\"mountPath\":\"/var/lib/rabbitmq/mnesia/\"}":{".":{},"f:mountPath":{},"f:name":{}}}}},"f:restartPolicy":{},"f:schedulerName":{},"f:securityContext":{".":{},"f:fsGroup":{},"f:runAsGroup":{},"f:runAsUser":{}},"f:serviceAccount":{},"f:serviceAccountName":{},"f:terminationGracePeriodSeconds":{},"f:topologySpreadConstraints":{".":{},"k:{\"topologyKey\":\"topology.kubernetes.io/zone\",\"whenUnsatisfiable\":\"ScheduleAnyway\"}":{".":{},"f:labelSelector":{".":{},"f:matchLabels":{".":{},"f:app.kubernetes.io/name":{}}},"f:maxSkew":{},"f:topologyKey":{},"f:whenUnsatisfiable":{}}},"f:volumes":{".":{},"k:{\"name\":\"erlang-cookie-secret\"}":{".":{},"f:name":{},"f:secret":{".":{},"f:defaultMode":{},"f:secretName":{}}},"k:{\"name\":\"plugins-conf\"}":{".":{},"f:configMap":{".":{},"f:defaultMode":{},"f:name":{}},"f:name":{}},"k:{\"name\":\"pod-info\"}":{".":{},"f:downwardAPI":{".":{},"f:defaultMode":{},"f:items":{}},"f:name":{}},"k:{\"name\":\"rabbitmq-confd\"}":{".":{},"f:name":{},"f:projected":{".":{},"f:defaultMode":{},"f:sources":{}}},"k:{\"name\":\"rabbitmq-erlang-cookie\"}":{".":{},"f:emptyDir":{},"f:name":{}},"k:{\"name\":\"rabbitmq-plugins\"}":{".":{},"f:emptyDir":{},"f:name":{}}}}},"f:updateStrategy":{"f:rollingUpdate":{".":{},"f:partition":{}},"f:type":{}},"f:volumeClaimTemplates":{}}}}]},"spec":{"replicas":1,"selector":{"matchLabels":{"app.kubernetes.io/name":"rabbitmq-cluster"}},"template":{"metadata":{"creationTimestamp":null,"labels":{"app.kubernetes.io/component":"rabbitmq","app.kubernetes.io/name":"rabbitmq-cluster","app.kubernetes.io/part-of":"rabbitmq"},"annotations":{"prometheus.io/port":"15692","prometheus.io/scrape":"true"}},"spec":{"volumes":[{"name":"plugins-conf","configMap":{"name":"rabbitmq-cluster-plugins-conf","defaultMode":420}},{"name":"rabbitmq-confd","projected":{"sources":[{"secret":{"name":"rabbitmq-cluster-default-user","items":[{"key":"default_user.conf","path":"default_user.conf"}]}},{"configMap":{"name":"rabbitmq-cluster-server-conf","items":[{"key":"operatorDefaults.conf","path":"operatorDefaults.conf"},{"key":"userDefinedConfiguration.conf","path":"userDefinedConfiguration.conf"}]}}],"defaultMode":420}},{"name":"rabbitmq-erlang-cookie","emptyDir":{}},{"name":"erlang-cookie-secret","secret":{"secretName":"rabbitmq-cluster-erlang-cookie","defaultMode":420}},{"name":"rabbitmq-plugins","emptyDir":{}},{"name":"pod-info","downwardAPI":{"items":[{"path":"skipPreStopChecks","fieldRef":{"apiVersion":"v1","fieldPath":"metadata.labels['skipPreStopChecks']"}}],"defaultMode":420}}],"initContainers":[{"name":"setup-container","image":"rabbitmq:3.8.12-management","command":["sh","-c","cp /tmp/erlang-cookie-secret/.erlang.cookie /var/lib/rabbitmq/.erlang.cookie \u0026\u0026 chown 999:999 /var/lib/rabbitmq/.erlang.cookie \u0026\u0026 chmod 600 /var/lib/rabbitmq/.erlang.cookie ; cp /tmp/rabbitmq-plugins/enabled_plugins /operator/enabled_plugins \u0026\u0026 chown 999:999 /operator/enabled_plugins ; chown 999:999 /var/lib/rabbitmq/mnesia/ ; echo '[default]' \u003e /var/lib/rabbitmq/.rabbitmqadmin.conf \u0026\u0026 sed -e 's/default_user/username/' -e 's/default_pass/password/' /tmp/default_user.conf \u003e\u003e /var/lib/rabbitmq/.rabbitmqadmin.conf \u0026\u0026 chown 999:999 /var/lib/rabbitmq/.rabbitmqadmin.conf \u0026\u0026 chmod 600 /var/lib/rabbitmq/.rabbitmqadmin.conf"],"resources":{"limits":{"cpu":"100m","memory":"500Mi"},"requests":{"cpu":"100m","memory":"500Mi"}},"volumeMounts":[{"name":"plugins-conf","mountPath":"/tmp/rabbitmq-plugins/"},{"name":"rabbitmq-erlang-cookie","mountPath":"/var/lib/rabbitmq/"},{"name":"erlang-cookie-secret","mountPath":"/tmp/erlang-cookie-secret/"},{"name":"rabbitmq-plugins","mountPath":"/operator"},{"name":"persistence","mountPath":"/var/lib/rabbitmq/mnesia/"},{"name":"rabbitmq-confd","mountPath":"/tmp/default_user.conf","subPath":"default_user.conf"}],"terminationMessagePath":"/dev/termination-log","terminationMessagePolicy":"File","imagePullPolicy":"IfNotPresent","securityContext":{"capabilities":{"drop":["FSETID","KILL","SETGID","SETUID","SETPCAP","NET_BIND_SERVICE","NET_RAW","SYS_CHROOT","MKNOD","AUDIT_WRITE","SETFCAP"]},"runAsUser":0}}],"containers":[{"name":"rabbitmq","image":"rabbitmq:3.8.12-management","ports":[{"name":"epmd","containerPort":4369,"protocol":"TCP"},{"name":"amqp","containerPort":5672,"protocol":"TCP"},{"name":"management","containerPort":15672,"protocol":"TCP"},{"name":"prometheus","containerPort":15692,"protocol":"TCP"}],"env":[{"name":"MY_POD_NAME","valueFrom":{"fieldRef":{"apiVersion":"v1","fieldPath":"metadata.name"}}},{"name":"MY_POD_NAMESPACE","valueFrom":{"fieldRef":{"apiVersion":"v1","fieldPath":"metadata.namespace"}}},{"name":"RABBITMQ_ENABLED_PLUGINS_FILE","value":"/operator/enabled_plugins"},{"name":"K8S_SERVICE_NAME","value":"rabbitmq-cluster-nodes"},{"name":"RABBITMQ_USE_LONGNAME","value":"true"},{"name":"RABBITMQ_NODENAME","value":"rabbit@$(MY_POD_NAME).$(K8S_SERVICE_NAME).$(MY_POD_NAMESPACE)"},{"name":"K8S_HOSTNAME_SUFFIX","value":".$(K8S_SERVICE_NAME).$(MY_POD_NAMESPACE)"}],"resources":{"limits":{"cpu":"2","memory":"2Gi"},"requests":{"cpu":"1","memory":"2Gi"}},"volumeMounts":[{"name":"rabbitmq-erlang-cookie","mountPath":"/var/lib/rabbitmq/"},{"name":"persistence","mountPath":"/var/lib/rabbitmq/mnesia/"},{"name":"rabbitmq-plugins","mountPath":"/operator"},{"name":"rabbitmq-confd","mountPath":"/etc/rabbitmq/conf.d/10-operatorDefaults.conf","subPath":"operatorDefaults.conf"},{"name":"rabbitmq-confd","mountPath":"/etc/rabbitmq/conf.d/11-default_user.conf","subPath":"default_user.conf"},{"name":"rabbitmq-confd","mountPath":"/etc/rabbitmq/conf.d/90-userDefinedConfiguration.conf","subPath":"userDefinedConfiguration.conf"},{"name":"pod-info","mountPath":"/etc/pod-info/"}],"readinessProbe":{"tcpSocket":{"port":"amqp"},"initialDelaySeconds":10,"timeoutSeconds":5,"periodSeconds":10,"successThreshold":1,"failureThreshold":3},"lifecycle":{"preStop":{"exec":{"command":["/bin/bash","-c","if [ ! -z \"$(cat /etc/pod-info/skipPreStopChecks)\" ]; then exit 0; fi; rabbitmq-upgrade await_online_quorum_plus_one -t 604800; rabbitmq-upgrade await_online_synchronized_mirror -t 604800; rabbitmq-upgrade drain -t 604800"]}}},"terminationMessagePath":"/dev/termination-log","terminationMessagePolicy":"File","imagePullPolicy":"IfNotPresent"}],"restartPolicy":"Always","terminationGracePeriodSeconds":604800,"dnsPolicy":"ClusterFirst","serviceAccountName":"rabbitmq-cluster-server","serviceAccount":"rabbitmq-cluster-server","automountServiceAccountToken":true,"securityContext":{"runAsUser":999,"runAsGroup":999,"fsGroup":999},"schedulerName":"default-scheduler","topologySpreadConstraints":[{"maxSkew":1,"topologyKey":"topology.kubernetes.io/zone","whenUnsatisfiable":"ScheduleAnyway","labelSelector":{"matchLabels":{"app.kubernetes.io/name":"rabbitmq-cluster"}}}]}},"volumeClaimTemplates":[{"metadata":{"name":"persistence","namespace":"default","creationTimestamp":null,"labels":{"app.kubernetes.io/component":"rabbitmq","app.kubernetes.io/name":"rabbitmq-cluster","app.kubernetes.io/part-of":"rabbitmq"},"ownerReferences":[{"apiVersion":"rabbitmq.com/v1beta1","kind":"RabbitmqCluster","name":"rabbitmq-cluster","uid":"3ecefa8a-1bec-48a7-9af4-dd0df3339101","controller":true,"blockOwnerDeletion":false}]},"spec":{"accessModes":["ReadWriteOnce"],"resources":{"requests":{"storage":"15Gi"}},"volumeMode":"Filesystem"},"status":{"phase":"Pending"}}],"serviceName":"rabbitmq-cluster-nodes","podManagementPolicy":"Parallel","updateStrategy":{"type":"RollingUpdate","rollingUpdate":{"partition":0}},"revisionHistoryLimit":10},"status":{"replicas":0}}
2022/03/18 18:07:34 learn_server.go:263: [SIEVE-AFTER-WRITE]	40	Update	statefulset	github.com/rabbitmq/cluster-operator/controllers.(*RabbitmqClusterReconciler)	NoError	{"metadata":{"name":"rabbitmq-cluster-server","namespace":"default","selfLink":"/apis/apps/v1/namespaces/default/statefulsets/rabbitmq-cluster-server","uid":"1d62d993-2c32-4da7-8884-e4cfad9e587d","resourceVersion":"1465","generation":1,"creationTimestamp":"2022-03-18T18:07:34Z","labels":{"app.kubernetes.io/component":"rabbitmq","app.kubernetes.io/name":"rabbitmq-cluster","app.kubernetes.io/part-of":"rabbitmq"},"annotations":{"rabbitmq.com/createdAt":"2022-03-18T18:07:34Z"},"ownerReferences":[{"apiVersion":"rabbitmq.com/v1beta1","kind":"RabbitmqCluster","name":"rabbitmq-cluster","uid":"3ecefa8a-1bec-48a7-9af4-dd0df3339101","controller":true,"blockOwnerDeletion":true}],"managedFields":[{"manager":"manager","operation":"Update","apiVersion":"apps/v1","time":"2022-03-18T18:07:34Z","fieldsType":"FieldsV1","fieldsV1":{"f:metadata":{"f:annotations":{".":{},"f:rabbitmq.com/createdAt":{}},"f:labels":{".":{},"f:app.kubernetes.io/component":{},"f:app.kubernetes.io/name":{},"f:app.kubernetes.io/part-of":{}},"f:ownerReferences":{".":{},"k:{\"uid\":\"3ecefa8a-1bec-48a7-9af4-dd0df3339101\"}":{".":{},"f:apiVersion":{},"f:blockOwnerDeletion":{},"f:controller":{},"f:kind":{},"f:name":{},"f:uid":{}}}},"f:spec":{"f:podManagementPolicy":{},"f:replicas":{},"f:revisionHistoryLimit":{},"f:selector":{"f:matchLabels":{".":{},"f:app.kubernetes.io/name":{}}},"f:serviceName":{},"f:template":{"f:metadata":{"f:annotations":{".":{},"f:prometheus.io/port":{},"f:prometheus.io/scrape":{}},"f:labels":{".":{},"f:app.kubernetes.io/component":{},"f:app.kubernetes.io/name":{},"f:app.kubernetes.io/part-of":{}}},"f:spec":{"f:automountServiceAccountToken":{},"f:containers":{"k:{\"name\":\"rabbitmq\"}":{".":{},"f:env":{".":{},"k:{\"name\":\"K8S_HOSTNAME_SUFFIX\"}":{".":{},"f:name":{},"f:value":{}},"k:{\"name\":\"K8S_SERVICE_NAME\"}":{".":{},"f:name":{},"f:value":{}},"k:{\"name\":\"MY_POD_NAME\"}":{".":{},"f:name":{},"f:valueFrom":{".":{},"f:fieldRef":{".":{},"f:apiVersion":{},"f:fieldPath":{}}}},"k:{\"name\":\"MY_POD_NAMESPACE\"}":{".":{},"f:name":{},"f:valueFrom":{".":{},"f:fieldRef":{".":{},"f:apiVersion":{},"f:fieldPath":{}}}},"k:{\"name\":\"RABBITMQ_ENABLED_PLUGINS_FILE\"}":{".":{},"f:name":{},"f:value":{}},"k:{\"name\":\"RABBITMQ_NODENAME\"}":{".":{},"f:name":{},"f:value":{}},"k:{\"name\":\"RABBITMQ_USE_LONGNAME\"}":{".":{},"f:name":{},"f:value":{}}},"f:image":{},"f:imagePullPolicy":{},"f:lifecycle":{".":{},"f:preStop":{".":{},"f:exec":{".":{},"f:command":{}}}},"f:name":{},"f:ports":{".":{},"k:{\"containerPort\":4369,\"protocol\":\"TCP\"}":{".":{},"f:containerPort":{},"f:name":{},"f:protocol":{}},"k:{\"containerPort\":5672,\"protocol\":\"TCP\"}":{".":{},"f:containerPort":{},"f:name":{},"f:protocol":{}},"k:{\"containerPort\":15672,\"protocol\":\"TCP\"}":{".":{},"f:containerPort":{},"f:name":{},"f:protocol":{}},"k:{\"containerPort\":15692,\"protocol\":\"TCP\"}":{".":{},"f:containerPort":{},"f:name":{},"f:protocol":{}}},"f:readinessProbe":{".":{},"f:failureThreshold":{},"f:initialDelaySeconds":{},"f:periodSeconds":{},"f:successThreshold":{},"f:tcpSocket":{".":{},"f:port":{}},"f:timeoutSeconds":{}},"f:resources":{".":{},"f:limits":{".":{},"f:cpu":{},"f:memory":{}},"f:requests":{".":{},"f:cpu":{},"f:memory":{}}},"f:terminationMessagePath":{},"f:terminationMessagePolicy":{},"f:volumeMounts":{".":{},"k:{\"mountPath\":\"/etc/pod-info/\"}":{".":{},"f:mountPath":{},"f:name":{}},"k:{\"mountPath\":\"/etc/rabbitmq/conf.d/10-operatorDefaults.conf\"}":{".":{},"f:mountPath":{},"f:name":{},"f:subPath":{}},"k:{\"mountPath\":\"/etc/rabbitmq/conf.d/11-default_user.conf\"}":{".":{},"f:mountPath":{},"f:name":{},"f:subPath":{}},"k:{\"mountPath\":\"/etc/rabbitmq/conf.d/90-userDefinedConfiguration.conf\"}":{".":{},"f:mountPath":{},"f:name":{},"f:subPath":{}},"k:{\"mountPath\":\"/operator\"}":{".":{},"f:mountPath":{},"f:name":{}},"k:{\"mountPath\":\"/var/lib/rabbitmq/\"}":{".":{},"f:mountPath":{},"f:name":{}},"k:{\"mountPath\":\"/var/lib/rabbitmq/mnesia/\"}":{".":{},"f:mountPath":{},"f:name":{}}}}},"f:dnsPolicy":{},"f:initContainers":{".":{},"k:{\"name\":\"setup-container\"}":{".":{},"f:command":{},"f:image":{},"f:imagePullPolicy":{},"f:name":{},"f:resources":{".":{},"f:limits":{".":{},"f:cpu":{},"f:memory":{}},"f:requests":{".":{},"f:cpu":{},"f:memory":{}}},"f:securityContext":{".":{},"f:capabilities":{".":{},"f:drop":{}},"f:runAsUser":{}},"f:terminationMessagePath":{},"f:terminationMessagePolicy":{},"f:volumeMounts":{".":{},"k:{\"mountPath\":\"/operator\"}":{".":{},"f:mountPath":{},"f:name":{}},"k:{\"mountPath\":\"/tmp/default_user.conf\"}":{".":{},"f:mountPath":{},"f:name":{},"f:subPath":{}},"k:{\"mountPath\":\"/tmp/erlang-cookie-secret/\"}":{".":{},"f:mountPath":{},"f:name":{}},"k:{\"mountPath\":\"/tmp/rabbitmq-plugins/\"}":{".":{},"f:mountPath":{},"f:name":{}},"k:{\"mountPath\":\"/var/lib/rabbitmq/\"}":{".":{},"f:mountPath":{},"f:name":{}},"k:{\"mountPath\":\"/var/lib/rabbitmq/mnesia/\"}":{".":{},"f:mountPath":{},"f:name":{}}}}},"f:restartPolicy":{},"f:schedulerName":{},"f:securityContext":{".":{},"f:fsGroup":{},"f:runAsGroup":{},"f:runAsUser":{}},"f:serviceAccount":{},"f:serviceAccountName":{},"f:terminationGracePeriodSeconds":{},"f:topologySpreadConstraints":{".":{},"k:{\"topologyKey\":\"topology.kubernetes.io/zone\",\"whenUnsatisfiable\":\"ScheduleAnyway\"}":{".":{},"f:labelSelector":{".":{},"f:matchLabels":{".":{},"f:app.kubernetes.io/name":{}}},"f:maxSkew":{},"f:topologyKey":{},"f:whenUnsatisfiable":{}}},"f:volumes":{".":{},"k:{\"name\":\"erlang-cookie-secret\"}":{".":{},"f:name":{},"f:secret":{".":{},"f:defaultMode":{},"f:secretName":{}}},"k:{\"name\":\"plugins-conf\"}":{".":{},"f:configMap":{".":{},"f:defaultMode":{},"f:name":{}},"f:name":{}},"k:{\"name\":\"pod-info\"}":{".":{},"f:downwardAPI":{".":{},"f:defaultMode":{},"f:items":{}},"f:name":{}},"k:{\"name\":\"rabbitmq-confd\"}":{".":{},"f:name":{},"f:projected":{".":{},"f:defaultMode":{},"f:sources":{}}},"k:{\"name\":\"rabbitmq-erlang-cookie\"}":{".":{},"f:emptyDir":{},"f:name":{}},"k:{\"name\":\"rabbitmq-plugins\"}":{".":{},"f:emptyDir":{},"f:name":{}}}}},"f:updateStrategy":{"f:rollingUpdate":{".":{},"f:partition":{}},"f:type":{}},"f:volumeClaimTemplates":{}}}}]},"spec":{"replicas":1,"selector":{"matchLabels":{"app.kubernetes.io/name":"rabbitmq-cluster"}},"template":{"metadata":{"creationTimestamp":null,"labels":{"app.kubernetes.io/component":"rabbitmq","app.kubernetes.io/name":"rabbitmq-cluster","app.kubernetes.io/part-of":"rabbitmq"},"annotations":{"prometheus.io/port":"15692","prometheus.io/scrape":"true"}},"spec":{"volumes":[{"name":"plugins-conf","configMap":{"name":"rabbitmq-cluster-plugins-conf","defaultMode":420}},{"name":"rabbitmq-confd","projected":{"sources":[{"secret":{"name":"rabbitmq-cluster-default-user","items":[{"key":"default_user.conf","path":"default_user.conf"}]}},{"configMap":{"name":"rabbitmq-cluster-server-conf","items":[{"key":"operatorDefaults.conf","path":"operatorDefaults.conf"},{"key":"userDefinedConfiguration.conf","path":"userDefinedConfiguration.conf"}]}}],"defaultMode":420}},{"name":"rabbitmq-erlang-cookie","emptyDir":{}},{"name":"erlang-cookie-secret","secret":{"secretName":"rabbitmq-cluster-erlang-cookie","defaultMode":420}},{"name":"rabbitmq-plugins","emptyDir":{}},{"name":"pod-info","downwardAPI":{"items":[{"path":"skipPreStopChecks","fieldRef":{"apiVersion":"v1","fieldPath":"metadata.labels['skipPreStopChecks']"}}],"defaultMode":420}}],"initContainers":[{"name":"setup-container","image":"rabbitmq:3.8.12-management","command":["sh","-c","cp /tmp/erlang-cookie-secret/.erlang.cookie /var/lib/rabbitmq/.erlang.cookie \u0026\u0026 chown 999:999 /var/lib/rabbitmq/.erlang.cookie \u0026\u0026 chmod 600 /var/lib/rabbitmq/.erlang.cookie ; cp /tmp/rabbitmq-plugins/enabled_plugins /operator/enabled_plugins \u0026\u0026 chown 999:999 /operator/enabled_plugins ; chown 999:999 /var/lib/rabbitmq/mnesia/ ; echo '[default]' \u003e /var/lib/rabbitmq/.rabbitmqadmin.conf \u0026\u0026 sed -e 's/default_user/username/' -e 's/default_pass/password/' /tmp/default_user.conf \u003e\u003e /var/lib/rabbitmq/.rabbitmqadmin.conf \u0026\u0026 chown 999:999 /var/lib/rabbitmq/.rabbitmqadmin.conf \u0026\u0026 chmod 600 /var/lib/rabbitmq/.rabbitmqadmin.conf"],"resources":{"limits":{"cpu":"100m","memory":"500Mi"},"requests":{"cpu":"100m","memory":"500Mi"}},"volumeMounts":[{"name":"plugins-conf","mountPath":"/tmp/rabbitmq-plugins/"},{"name":"rabbitmq-erlang-cookie","mountPath":"/var/lib/rabbitmq/"},{"name":"erlang-cookie-secret","mountPath":"/tmp/erlang-cookie-secret/"},{"name":"rabbitmq-plugins","mountPath":"/operator"},{"name":"persistence","mountPath":"/var/lib/rabbitmq/mnesia/"},{"name":"rabbitmq-confd","mountPath":"/tmp/default_user.conf","subPath":"default_user.conf"}],"terminationMessagePath":"/dev/termination-log","terminationMessagePolicy":"File","imagePullPolicy":"IfNotPresent","securityContext":{"capabilities":{"drop":["FSETID","KILL","SETGID","SETUID","SETPCAP","NET_BIND_SERVICE","NET_RAW","SYS_CHROOT","MKNOD","AUDIT_WRITE","SETFCAP"]},"runAsUser":0}}],"containers":[{"name":"rabbitmq","image":"rabbitmq:3.8.12-management","ports":[{"name":"epmd","containerPort":4369,"protocol":"TCP"},{"name":"amqp","containerPort":5672,"protocol":"TCP"},{"name":"management","containerPort":15672,"protocol":"TCP"},{"name":"prometheus","containerPort":15692,"protocol":"TCP"}],"env":[{"name":"MY_POD_NAME","valueFrom":{"fieldRef":{"apiVersion":"v1","fieldPath":"metadata.name"}}},{"name":"MY_POD_NAMESPACE","valueFrom":{"fieldRef":{"apiVersion":"v1","fieldPath":"metadata.namespace"}}},{"name":"RABBITMQ_ENABLED_PLUGINS_FILE","value":"/operator/enabled_plugins"},{"name":"K8S_SERVICE_NAME","value":"rabbitmq-cluster-nodes"},{"name":"RABBITMQ_USE_LONGNAME","value":"true"},{"name":"RABBITMQ_NODENAME","value":"rabbit@$(MY_POD_NAME).$(K8S_SERVICE_NAME).$(MY_POD_NAMESPACE)"},{"name":"K8S_HOSTNAME_SUFFIX","value":".$(K8S_SERVICE_NAME).$(MY_POD_NAMESPACE)"}],"resources":{"limits":{"cpu":"2","memory":"2Gi"},"requests":{"cpu":"1","memory":"2Gi"}},"volumeMounts":[{"name":"rabbitmq-erlang-cookie","mountPath":"/var/lib/rabbitmq/"},{"name":"persistence","mountPath":"/var/lib/rabbitmq/mnesia/"},{"name":"rabbitmq-plugins","mountPath":"/operator"},{"name":"rabbitmq-confd","mountPath":"/etc/rabbitmq/conf.d/10-operatorDefaults.conf","subPath":"operatorDefaults.conf"},{"name":"rabbitmq-confd","mountPath":"/etc/rabbitmq/conf.d/11-default_user.conf","subPath":"default_user.conf"},{"name":"rabbitmq-confd","mountPath":"/etc/rabbitmq/conf.d/90-userDefinedConfiguration.conf","subPath":"userDefinedConfiguration.conf"},{"name":"pod-info","mountPath":"/etc/pod-info/"}],"readinessProbe":{"tcpSocket":{"port":"amqp"},"initialDelaySeconds":10,"timeoutSeconds":5,"periodSeconds":10,"successThreshold":1,"failureThreshold":3},"lifecycle":{"preStop":{"exec":{"command":["/bin/bash","-c","if [ ! -z \"$(cat /etc/pod-info/skipPreStopChecks)\" ]; then exit 0; fi; rabbitmq-upgrade await_online_quorum_plus_one -t 604800; rabbitmq-upgrade await_online_synchronized_mirror -t 604800; rabbitmq-upgrade drain -t 604800"]}}},"terminationMessagePath":"/dev/termination-log","terminationMessagePolicy":"File","imagePullPolicy":"IfNotPresent"}],"restartPolicy":"Always","terminationGracePeriodSeconds":604800,"dnsPolicy":"ClusterFirst","serviceAccountName":"rabbitmq-cluster-server","serviceAccount":"rabbitmq-cluster-server","automountServiceAccountToken":true,"securityContext":{"runAsUser":999,"runAsGroup":999,"fsGroup":999},"schedulerName":"default-scheduler","topologySpreadConstraints":[{"maxSkew":1,"topologyKey":"topology.kubernetes.io/zone","whenUnsatisfiable":"ScheduleAnyway","labelSelector":{"matchLabels":{"app.kubernetes.io/name":"rabbitmq-cluster"}}}]}},"volumeClaimTemplates":[{"metadata":{"name":"persistence","namespace":"default","creationTimestamp":null,"labels":{"app.kubernetes.io/component":"rabbitmq","app.kubernetes.io/name":"rabbitmq-cluster","app.kubernetes.io/part-of":"rabbitmq"},"ownerReferences":[{"apiVersion":"rabbitmq.com/v1beta1","kind":"RabbitmqCluster","name":"rabbitmq-cluster","uid":"3ecefa8a-1bec-48a7-9af4-dd0df3339101","controller":true,"blockOwnerDeletion":false}]},"spec":{"accessModes":["ReadWriteOnce"],"resources":{"requests":{"storage":"15Gi"}},"volumeMode":"Filesystem"},"status":{"phase":"Pending"}}],"serviceName":"rabbitmq-cluster-nodes","podManagementPolicy":"Parallel","updateStrategy":{"type":"RollingUpdate","rollingUpdate":{"partition":0}},"revisionHistoryLimit":10},"status":{"replicas":0}}
2022/03/18 18:07:34 learn_server.go:291: [SIEVE-AFTER-READ]	Get	true	configmap	default	rabbitmq-cluster-server-conf	github.com/rabbitmq/cluster-operator/controllers.(*RabbitmqClusterReconciler)	NoError	{"kind":"ConfigMap","apiVersion":"v1","metadata":{"name":"rabbitmq-cluster-server-conf","namespace":"default","selfLink":"/api/v1/namespaces/default/configmaps/rabbitmq-cluster-server-conf","uid":"e4182078-d429-4baf-9021-72618c509ac5","resourceVersion":"1095","creationTimestamp":"2022-03-18T18:06:25Z","labels":{"app.kubernetes.io/component":"rabbitmq","app.kubernetes.io/name":"rabbitmq-cluster","app.kubernetes.io/part-of":"rabbitmq"},"ownerReferences":[{"apiVersion":"rabbitmq.com/v1beta1","kind":"RabbitmqCluster","name":"rabbitmq-cluster","uid":"3ecefa8a-1bec-48a7-9af4-dd0df3339101","controller":true,"blockOwnerDeletion":true}],"managedFields":[{"manager":"manager","operation":"Update","apiVersion":"v1","time":"2022-03-18T18:06:25Z","fieldsType":"FieldsV1","fieldsV1":{"f:data":{".":{},"f:operatorDefaults.conf":{},"f:userDefinedConfiguration.conf":{}},"f:metadata":{"f:labels":{".":{},"f:app.kubernetes.io/component":{},"f:app.kubernetes.io/name":{},"f:app.kubernetes.io/part-of":{}},"f:ownerReferences":{".":{},"k:{\"uid\":\"3ecefa8a-1bec-48a7-9af4-dd0df3339101\"}":{".":{},"f:apiVersion":{},"f:blockOwnerDeletion":{},"f:controller":{},"f:kind":{},"f:name":{},"f:uid":{}}}}}}]},"data":{"operatorDefaults.conf":"cluster_formation.peer_discovery_backend             = rabbit_peer_discovery_k8s\ncluster_formation.k8s.host                           = kubernetes.default\ncluster_formation.k8s.address_type                   = hostname\ncluster_partition_handling                           = pause_minority\nqueue_master_locator                                 = min-masters\ndisk_free_limit.absolute                             = 2GB\ncluster_formation.randomized_startup_delay_range.min = 5\ncluster_formation.randomized_startup_delay_range.max = 30\ncluster_name                                         = rabbitmq-cluster\n","userDefinedConfiguration.conf":"total_memory_available_override_value = 1717986919\n"}}
2022/03/18 18:07:34 learn_server.go:256: [SIEVE-BEFORE-WRITE]	41
2022/03/18 18:07:34 learn_server.go:289: [SIEVE-AFTER-HEAR]	30
2022/03/18 18:07:34 learn_server.go:263: [SIEVE-AFTER-WRITE]	41	StatusUpdate	rabbitmqcluster	github.com/rabbitmq/cluster-operator/controllers.(*RabbitmqClusterReconciler)	NoError	{"metadata":{"name":"rabbitmq-cluster","namespace":"default","selfLink":"/apis/rabbitmq.com/v1beta1/namespaces/default/rabbitmqclusters/rabbitmq-cluster/status","uid":"3ecefa8a-1bec-48a7-9af4-dd0df3339101","resourceVersion":"1440","generation":3,"creationTimestamp":"2022-03-18T18:06:25Z","annotations":{"kubectl.kubernetes.io/last-applied-configuration":"{\"apiVersion\":\"rabbitmq.com/v1beta1\",\"kind\":\"RabbitmqCluster\",\"metadata\":{\"annotations\":{},\"name\":\"rabbitmq-cluster\",\"namespace\":\"default\"},\"spec\":{\"persistence\":{\"storage\":\"10Gi\"},\"replicas\":1}}\n"},"finalizers":["deletion.finalizers.rabbitmqclusters.rabbitmq.com"],"managedFields":[{"manager":"kubectl-client-side-apply","operation":"Update","apiVersion":"rabbitmq.com/v1beta1","time":"2022-03-18T18:06:25Z","fieldsType":"FieldsV1","fieldsV1":{"f:metadata":{"f:annotations":{".":{},"f:kubectl.kubernetes.io/last-applied-configuration":{}}},"f:spec":{".":{},"f:image":{},"f:persistence":{},"f:replicas":{},"f:resources":{".":{},"f:limits":{".":{},"f:memory":{}},"f:requests":{".":{},"f:memory":{}}},"f:service":{".":{},"f:type":{}},"f:terminationGracePeriodSeconds":{}}}},{"manager":"manager","operation":"Update","apiVersion":"rabbitmq.com/v1beta1","time":"2022-03-18T18:07:24Z","fieldsType":"FieldsV1","fieldsV1":{"f:metadata":{"f:finalizers":{}},"f:spec":{"f:override":{},"f:rabbitmq":{},"f:resources":{"f:limits":{"f:cpu":{}},"f:requests":{"f:cpu":{}}},"f:tls":{}},"f:status":{".":{},"f:conditions":{},"f:defaultUser":{".":{},"f:secretReference":{".":{},"f:keys":{".":{},"f:password":{},"f:username":{}},"f:name":{},"f:namespace":{}},"f:serviceReference":{".":{},"f:name":{},"f:namespace":{}}}}}},{"manager":"kubectl-patch","operation":"Update","apiVersion":"rabbitmq.com/v1beta1","time":"2022-03-18T18:07:31Z","fieldsType":"FieldsV1","fieldsV1":{"f:spec":{"f:persistence":{"f:storage":{}}}}}]},"spec":{"replicas":1,"image":"rabbitmq:3.8.12-management","service":{"type":"ClusterIP"},"persistence":{"storage":"15Gi"},"resources":{"limits":{"cpu":"2","memory":"2Gi"},"requests":{"cpu":"1","memory":"2Gi"}},"rabbitmq":{},"tls":{},"override":{},"terminationGracePeriodSeconds":604800},"status":{"conditions":[{"type":"AllReplicasReady","status":"True","lastTransitionTime":"2022-03-18T18:07:23Z","reason":"AllPodsAreReady"},{"type":"ClusterAvailable","status":"True","lastTransitionTime":"2022-03-18T18:07:23Z","reason":"AtLeastOneEndpointAvailable"},{"type":"NoWarnings","status":"True","lastTransitionTime":"2022-03-18T18:06:25Z","reason":"NoWarnings"},{"type":"ReconcileSuccess","status":"True","lastTransitionTime":"2022-03-18T18:07:24Z","reason":"Success","message":"Finish reconciling"}],"defaultUser":{"secretReference":{"name":"rabbitmq-cluster-default-user","namespace":"default","keys":{"password":"password","username":"username"}},"serviceReference":{"name":"rabbitmq-cluster","namespace":"default"}},"binding":{"name":"rabbitmq-cluster-default-user"}}}
2022/03/18 18:07:34 learn_server.go:291: [SIEVE-AFTER-READ]	Get	true	statefulset	default	rabbitmq-cluster-server	github.com/rabbitmq/cluster-operator/controllers.(*RabbitmqClusterReconciler)	NoError	{"kind":"StatefulSet","apiVersion":"apps/v1","metadata":{"name":"rabbitmq-cluster-server","namespace":"default","selfLink":"/apis/apps/v1/namespaces/default/statefulsets/rabbitmq-cluster-server","uid":"1d62d993-2c32-4da7-8884-e4cfad9e587d","resourceVersion":"1465","generation":1,"creationTimestamp":"2022-03-18T18:07:34Z","labels":{"app.kubernetes.io/component":"rabbitmq","app.kubernetes.io/name":"rabbitmq-cluster","app.kubernetes.io/part-of":"rabbitmq"},"annotations":{"rabbitmq.com/createdAt":"2022-03-18T18:07:34Z"},"ownerReferences":[{"apiVersion":"rabbitmq.com/v1beta1","kind":"RabbitmqCluster","name":"rabbitmq-cluster","uid":"3ecefa8a-1bec-48a7-9af4-dd0df3339101","controller":true,"blockOwnerDeletion":true}],"managedFields":[{"manager":"manager","operation":"Update","apiVersion":"apps/v1","time":"2022-03-18T18:07:34Z","fieldsType":"FieldsV1","fieldsV1":{"f:metadata":{"f:annotations":{".":{},"f:rabbitmq.com/createdAt":{}},"f:labels":{".":{},"f:app.kubernetes.io/component":{},"f:app.kubernetes.io/name":{},"f:app.kubernetes.io/part-of":{}},"f:ownerReferences":{".":{},"k:{\"uid\":\"3ecefa8a-1bec-48a7-9af4-dd0df3339101\"}":{".":{},"f:apiVersion":{},"f:blockOwnerDeletion":{},"f:controller":{},"f:kind":{},"f:name":{},"f:uid":{}}}},"f:spec":{"f:podManagementPolicy":{},"f:replicas":{},"f:revisionHistoryLimit":{},"f:selector":{"f:matchLabels":{".":{},"f:app.kubernetes.io/name":{}}},"f:serviceName":{},"f:template":{"f:metadata":{"f:annotations":{".":{},"f:prometheus.io/port":{},"f:prometheus.io/scrape":{}},"f:labels":{".":{},"f:app.kubernetes.io/component":{},"f:app.kubernetes.io/name":{},"f:app.kubernetes.io/part-of":{}}},"f:spec":{"f:automountServiceAccountToken":{},"f:containers":{"k:{\"name\":\"rabbitmq\"}":{".":{},"f:env":{".":{},"k:{\"name\":\"K8S_HOSTNAME_SUFFIX\"}":{".":{},"f:name":{},"f:value":{}},"k:{\"name\":\"K8S_SERVICE_NAME\"}":{".":{},"f:name":{},"f:value":{}},"k:{\"name\":\"MY_POD_NAME\"}":{".":{},"f:name":{},"f:valueFrom":{".":{},"f:fieldRef":{".":{},"f:apiVersion":{},"f:fieldPath":{}}}},"k:{\"name\":\"MY_POD_NAMESPACE\"}":{".":{},"f:name":{},"f:valueFrom":{".":{},"f:fieldRef":{".":{},"f:apiVersion":{},"f:fieldPath":{}}}},"k:{\"name\":\"RABBITMQ_ENABLED_PLUGINS_FILE\"}":{".":{},"f:name":{},"f:value":{}},"k:{\"name\":\"RABBITMQ_NODENAME\"}":{".":{},"f:name":{},"f:value":{}},"k:{\"name\":\"RABBITMQ_USE_LONGNAME\"}":{".":{},"f:name":{},"f:value":{}}},"f:image":{},"f:imagePullPolicy":{},"f:lifecycle":{".":{},"f:preStop":{".":{},"f:exec":{".":{},"f:command":{}}}},"f:name":{},"f:ports":{".":{},"k:{\"containerPort\":4369,\"protocol\":\"TCP\"}":{".":{},"f:containerPort":{},"f:name":{},"f:protocol":{}},"k:{\"containerPort\":5672,\"protocol\":\"TCP\"}":{".":{},"f:containerPort":{},"f:name":{},"f:protocol":{}},"k:{\"containerPort\":15672,\"protocol\":\"TCP\"}":{".":{},"f:containerPort":{},"f:name":{},"f:protocol":{}},"k:{\"containerPort\":15692,\"protocol\":\"TCP\"}":{".":{},"f:containerPort":{},"f:name":{},"f:protocol":{}}},"f:readinessProbe":{".":{},"f:failureThreshold":{},"f:initialDelaySeconds":{},"f:periodSeconds":{},"f:successThreshold":{},"f:tcpSocket":{".":{},"f:port":{}},"f:timeoutSeconds":{}},"f:resources":{".":{},"f:limits":{".":{},"f:cpu":{},"f:memory":{}},"f:requests":{".":{},"f:cpu":{},"f:memory":{}}},"f:terminationMessagePath":{},"f:terminationMessagePolicy":{},"f:volumeMounts":{".":{},"k:{\"mountPath\":\"/etc/pod-info/\"}":{".":{},"f:mountPath":{},"f:name":{}},"k:{\"mountPath\":\"/etc/rabbitmq/conf.d/10-operatorDefaults.conf\"}":{".":{},"f:mountPath":{},"f:name":{},"f:subPath":{}},"k:{\"mountPath\":\"/etc/rabbitmq/conf.d/11-default_user.conf\"}":{".":{},"f:mountPath":{},"f:name":{},"f:subPath":{}},"k:{\"mountPath\":\"/etc/rabbitmq/conf.d/90-userDefinedConfiguration.conf\"}":{".":{},"f:mountPath":{},"f:name":{},"f:subPath":{}},"k:{\"mountPath\":\"/operator\"}":{".":{},"f:mountPath":{},"f:name":{}},"k:{\"mountPath\":\"/var/lib/rabbitmq/\"}":{".":{},"f:mountPath":{},"f:name":{}},"k:{\"mountPath\":\"/var/lib/rabbitmq/mnesia/\"}":{".":{},"f:mountPath":{},"f:name":{}}}}},"f:dnsPolicy":{},"f:initContainers":{".":{},"k:{\"name\":\"setup-container\"}":{".":{},"f:command":{},"f:image":{},"f:imagePullPolicy":{},"f:name":{},"f:resources":{".":{},"f:limits":{".":{},"f:cpu":{},"f:memory":{}},"f:requests":{".":{},"f:cpu":{},"f:memory":{}}},"f:securityContext":{".":{},"f:capabilities":{".":{},"f:drop":{}},"f:runAsUser":{}},"f:terminationMessagePath":{},"f:terminationMessagePolicy":{},"f:volumeMounts":{".":{},"k:{\"mountPath\":\"/operator\"}":{".":{},"f:mountPath":{},"f:name":{}},"k:{\"mountPath\":\"/tmp/default_user.conf\"}":{".":{},"f:mountPath":{},"f:name":{},"f:subPath":{}},"k:{\"mountPath\":\"/tmp/erlang-cookie-secret/\"}":{".":{},"f:mountPath":{},"f:name":{}},"k:{\"mountPath\":\"/tmp/rabbitmq-plugins/\"}":{".":{},"f:mountPath":{},"f:name":{}},"k:{\"mountPath\":\"/var/lib/rabbitmq/\"}":{".":{},"f:mountPath":{},"f:name":{}},"k:{\"mountPath\":\"/var/lib/rabbitmq/mnesia/\"}":{".":{},"f:mountPath":{},"f:name":{}}}}},"f:restartPolicy":{},"f:schedulerName":{},"f:securityContext":{".":{},"f:fsGroup":{},"f:runAsGroup":{},"f:runAsUser":{}},"f:serviceAccount":{},"f:serviceAccountName":{},"f:terminationGracePeriodSeconds":{},"f:topologySpreadConstraints":{".":{},"k:{\"topologyKey\":\"topology.kubernetes.io/zone\",\"whenUnsatisfiable\":\"ScheduleAnyway\"}":{".":{},"f:labelSelector":{".":{},"f:matchLabels":{".":{},"f:app.kubernetes.io/name":{}}},"f:maxSkew":{},"f:topologyKey":{},"f:whenUnsatisfiable":{}}},"f:volumes":{".":{},"k:{\"name\":\"erlang-cookie-secret\"}":{".":{},"f:name":{},"f:secret":{".":{},"f:defaultMode":{},"f:secretName":{}}},"k:{\"name\":\"plugins-conf\"}":{".":{},"f:configMap":{".":{},"f:defaultMode":{},"f:name":{}},"f:name":{}},"k:{\"name\":\"pod-info\"}":{".":{},"f:downwardAPI":{".":{},"f:defaultMode":{},"f:items":{}},"f:name":{}},"k:{\"name\":\"rabbitmq-confd\"}":{".":{},"f:name":{},"f:projected":{".":{},"f:defaultMode":{},"f:sources":{}}},"k:{\"name\":\"rabbitmq-erlang-cookie\"}":{".":{},"f:emptyDir":{},"f:name":{}},"k:{\"name\":\"rabbitmq-plugins\"}":{".":{},"f:emptyDir":{},"f:name":{}}}}},"f:updateStrategy":{"f:rollingUpdate":{".":{},"f:partition":{}},"f:type":{}},"f:volumeClaimTemplates":{}}}}]},"spec":{"replicas":1,"selector":{"matchLabels":{"app.kubernetes.io/name":"rabbitmq-cluster"}},"template":{"metadata":{"creationTimestamp":null,"labels":{"app.kubernetes.io/component":"rabbitmq","app.kubernetes.io/name":"rabbitmq-cluster","app.kubernetes.io/part-of":"rabbitmq"},"annotations":{"prometheus.io/port":"15692","prometheus.io/scrape":"true"}},"spec":{"volumes":[{"name":"plugins-conf","configMap":{"name":"rabbitmq-cluster-plugins-conf","defaultMode":420}},{"name":"rabbitmq-confd","projected":{"sources":[{"secret":{"name":"rabbitmq-cluster-default-user","items":[{"key":"default_user.conf","path":"default_user.conf"}]}},{"configMap":{"name":"rabbitmq-cluster-server-conf","items":[{"key":"operatorDefaults.conf","path":"operatorDefaults.conf"},{"key":"userDefinedConfiguration.conf","path":"userDefinedConfiguration.conf"}]}}],"defaultMode":420}},{"name":"rabbitmq-erlang-cookie","emptyDir":{}},{"name":"erlang-cookie-secret","secret":{"secretName":"rabbitmq-cluster-erlang-cookie","defaultMode":420}},{"name":"rabbitmq-plugins","emptyDir":{}},{"name":"pod-info","downwardAPI":{"items":[{"path":"skipPreStopChecks","fieldRef":{"apiVersion":"v1","fieldPath":"metadata.labels['skipPreStopChecks']"}}],"defaultMode":420}}],"initContainers":[{"name":"setup-container","image":"rabbitmq:3.8.12-management","command":["sh","-c","cp /tmp/erlang-cookie-secret/.erlang.cookie /var/lib/rabbitmq/.erlang.cookie \u0026\u0026 chown 999:999 /var/lib/rabbitmq/.erlang.cookie \u0026\u0026 chmod 600 /var/lib/rabbitmq/.erlang.cookie ; cp /tmp/rabbitmq-plugins/enabled_plugins /operator/enabled_plugins \u0026\u0026 chown 999:999 /operator/enabled_plugins ; chown 999:999 /var/lib/rabbitmq/mnesia/ ; echo '[default]' \u003e /var/lib/rabbitmq/.rabbitmqadmin.conf \u0026\u0026 sed -e 's/default_user/username/' -e 's/default_pass/password/' /tmp/default_user.conf \u003e\u003e /var/lib/rabbitmq/.rabbitmqadmin.conf \u0026\u0026 chown 999:999 /var/lib/rabbitmq/.rabbitmqadmin.conf \u0026\u0026 chmod 600 /var/lib/rabbitmq/.rabbitmqadmin.conf"],"resources":{"limits":{"cpu":"100m","memory":"500Mi"},"requests":{"cpu":"100m","memory":"500Mi"}},"volumeMounts":[{"name":"plugins-conf","mountPath":"/tmp/rabbitmq-plugins/"},{"name":"rabbitmq-erlang-cookie","mountPath":"/var/lib/rabbitmq/"},{"name":"erlang-cookie-secret","mountPath":"/tmp/erlang-cookie-secret/"},{"name":"rabbitmq-plugins","mountPath":"/operator"},{"name":"persistence","mountPath":"/var/lib/rabbitmq/mnesia/"},{"name":"rabbitmq-confd","mountPath":"/tmp/default_user.conf","subPath":"default_user.conf"}],"terminationMessagePath":"/dev/termination-log","terminationMessagePolicy":"File","imagePullPolicy":"IfNotPresent","securityContext":{"capabilities":{"drop":["FSETID","KILL","SETGID","SETUID","SETPCAP","NET_BIND_SERVICE","NET_RAW","SYS_CHROOT","MKNOD","AUDIT_WRITE","SETFCAP"]},"runAsUser":0}}],"containers":[{"name":"rabbitmq","image":"rabbitmq:3.8.12-management","ports":[{"name":"epmd","containerPort":4369,"protocol":"TCP"},{"name":"amqp","containerPort":5672,"protocol":"TCP"},{"name":"management","containerPort":15672,"protocol":"TCP"},{"name":"prometheus","containerPort":15692,"protocol":"TCP"}],"env":[{"name":"MY_POD_NAME","valueFrom":{"fieldRef":{"apiVersion":"v1","fieldPath":"metadata.name"}}},{"name":"MY_POD_NAMESPACE","valueFrom":{"fieldRef":{"apiVersion":"v1","fieldPath":"metadata.namespace"}}},{"name":"RABBITMQ_ENABLED_PLUGINS_FILE","value":"/operator/enabled_plugins"},{"name":"K8S_SERVICE_NAME","value":"rabbitmq-cluster-nodes"},{"name":"RABBITMQ_USE_LONGNAME","value":"true"},{"name":"RABBITMQ_NODENAME","value":"rabbit@$(MY_POD_NAME).$(K8S_SERVICE_NAME).$(MY_POD_NAMESPACE)"},{"name":"K8S_HOSTNAME_SUFFIX","value":".$(K8S_SERVICE_NAME).$(MY_POD_NAMESPACE)"}],"resources":{"limits":{"cpu":"2","memory":"2Gi"},"requests":{"cpu":"1","memory":"2Gi"}},"volumeMounts":[{"name":"rabbitmq-erlang-cookie","mountPath":"/var/lib/rabbitmq/"},{"name":"persistence","mountPath":"/var/lib/rabbitmq/mnesia/"},{"name":"rabbitmq-plugins","mountPath":"/operator"},{"name":"rabbitmq-confd","mountPath":"/etc/rabbitmq/conf.d/10-operatorDefaults.conf","subPath":"operatorDefaults.conf"},{"name":"rabbitmq-confd","mountPath":"/etc/rabbitmq/conf.d/11-default_user.conf","subPath":"default_user.conf"},{"name":"rabbitmq-confd","mountPath":"/etc/rabbitmq/conf.d/90-userDefinedConfiguration.conf","subPath":"userDefinedConfiguration.conf"},{"name":"pod-info","mountPath":"/etc/pod-info/"}],"readinessProbe":{"tcpSocket":{"port":"amqp"},"initialDelaySeconds":10,"timeoutSeconds":5,"periodSeconds":10,"successThreshold":1,"failureThreshold":3},"lifecycle":{"preStop":{"exec":{"command":["/bin/bash","-c","if [ ! -z \"$(cat /etc/pod-info/skipPreStopChecks)\" ]; then exit 0; fi; rabbitmq-upgrade await_online_quorum_plus_one -t 604800; rabbitmq-upgrade await_online_synchronized_mirror -t 604800; rabbitmq-upgrade drain -t 604800"]}}},"terminationMessagePath":"/dev/termination-log","terminationMessagePolicy":"File","imagePullPolicy":"IfNotPresent"}],"restartPolicy":"Always","terminationGracePeriodSeconds":604800,"dnsPolicy":"ClusterFirst","serviceAccountName":"rabbitmq-cluster-server","serviceAccount":"rabbitmq-cluster-server","automountServiceAccountToken":true,"securityContext":{"runAsUser":999,"runAsGroup":999,"fsGroup":999},"schedulerName":"default-scheduler","topologySpreadConstraints":[{"maxSkew":1,"topologyKey":"topology.kubernetes.io/zone","whenUnsatisfiable":"ScheduleAnyway","labelSelector":{"matchLabels":{"app.kubernetes.io/name":"rabbitmq-cluster"}}}]}},"volumeClaimTemplates":[{"metadata":{"name":"persistence","namespace":"default","creationTimestamp":null,"labels":{"app.kubernetes.io/component":"rabbitmq","app.kubernetes.io/name":"rabbitmq-cluster","app.kubernetes.io/part-of":"rabbitmq"},"ownerReferences":[{"apiVersion":"rabbitmq.com/v1beta1","kind":"RabbitmqCluster","name":"rabbitmq-cluster","uid":"3ecefa8a-1bec-48a7-9af4-dd0df3339101","controller":true,"blockOwnerDeletion":false}]},"spec":{"accessModes":["ReadWriteOnce"],"resources":{"requests":{"storage":"15Gi"}},"volumeMode":"Filesystem"},"status":{"phase":"Pending"}}],"serviceName":"rabbitmq-cluster-nodes","podManagementPolicy":"Parallel","updateStrategy":{"type":"RollingUpdate","rollingUpdate":{"partition":0}},"revisionHistoryLimit":10},"status":{"replicas":0}}
2022/03/18 18:07:34 learn_server.go:253: [SIEVE-AFTER-RECONCILE]	github.com/rabbitmq/cluster-operator/controllers.(*RabbitmqClusterReconciler)	9
2022/03/18 18:07:34 learn_server.go:238: [SIEVE-BEFORE-RECONCILE]	github.com/rabbitmq/cluster-operator/controllers.(*RabbitmqClusterReconciler)	10
2022/03/18 18:07:34 learn_server.go:291: [SIEVE-AFTER-READ]	Get	true	rabbitmqcluster	default	rabbitmq-cluster	github.com/rabbitmq/cluster-operator/controllers.(*RabbitmqClusterReconciler)	NoError	{"kind":"RabbitmqCluster","apiVersion":"rabbitmq.com/v1beta1","metadata":{"name":"rabbitmq-cluster","namespace":"default","selfLink":"/apis/rabbitmq.com/v1beta1/namespaces/default/rabbitmqclusters/rabbitmq-cluster","uid":"3ecefa8a-1bec-48a7-9af4-dd0df3339101","resourceVersion":"1440","generation":3,"creationTimestamp":"2022-03-18T18:06:25Z","annotations":{"kubectl.kubernetes.io/last-applied-configuration":"{\"apiVersion\":\"rabbitmq.com/v1beta1\",\"kind\":\"RabbitmqCluster\",\"metadata\":{\"annotations\":{},\"name\":\"rabbitmq-cluster\",\"namespace\":\"default\"},\"spec\":{\"persistence\":{\"storage\":\"10Gi\"},\"replicas\":1}}\n"},"finalizers":["deletion.finalizers.rabbitmqclusters.rabbitmq.com"],"managedFields":[{"manager":"kubectl-client-side-apply","operation":"Update","apiVersion":"rabbitmq.com/v1beta1","time":"2022-03-18T18:06:25Z","fieldsType":"FieldsV1","fieldsV1":{"f:metadata":{"f:annotations":{".":{},"f:kubectl.kubernetes.io/last-applied-configuration":{}}},"f:spec":{".":{},"f:image":{},"f:persistence":{},"f:replicas":{},"f:resources":{".":{},"f:limits":{".":{},"f:memory":{}},"f:requests":{".":{},"f:memory":{}}},"f:service":{".":{},"f:type":{}},"f:terminationGracePeriodSeconds":{}}}},{"manager":"manager","operation":"Update","apiVersion":"rabbitmq.com/v1beta1","time":"2022-03-18T18:07:24Z","fieldsType":"FieldsV1","fieldsV1":{"f:metadata":{"f:finalizers":{}},"f:spec":{"f:override":{},"f:rabbitmq":{},"f:resources":{"f:limits":{"f:cpu":{}},"f:requests":{"f:cpu":{}}},"f:tls":{}},"f:status":{".":{},"f:conditions":{},"f:defaultUser":{".":{},"f:secretReference":{".":{},"f:keys":{".":{},"f:password":{},"f:username":{}},"f:name":{},"f:namespace":{}},"f:serviceReference":{".":{},"f:name":{},"f:namespace":{}}}}}},{"manager":"kubectl-patch","operation":"Update","apiVersion":"rabbitmq.com/v1beta1","time":"2022-03-18T18:07:31Z","fieldsType":"FieldsV1","fieldsV1":{"f:spec":{"f:persistence":{"f:storage":{}}}}}]},"spec":{"replicas":1,"image":"rabbitmq:3.8.12-management","service":{"type":"ClusterIP"},"persistence":{"storage":"15Gi"},"resources":{"limits":{"cpu":"2","memory":"2Gi"},"requests":{"cpu":"1","memory":"2Gi"}},"rabbitmq":{},"tls":{},"override":{},"terminationGracePeriodSeconds":604800},"status":{"conditions":[{"type":"AllReplicasReady","status":"True","lastTransitionTime":"2022-03-18T18:07:23Z","reason":"AllPodsAreReady"},{"type":"ClusterAvailable","status":"True","lastTransitionTime":"2022-03-18T18:07:23Z","reason":"AtLeastOneEndpointAvailable"},{"type":"NoWarnings","status":"True","lastTransitionTime":"2022-03-18T18:06:25Z","reason":"NoWarnings"},{"type":"ReconcileSuccess","status":"True","lastTransitionTime":"2022-03-18T18:07:24Z","reason":"Success","message":"Finish reconciling"}],"defaultUser":{"secretReference":{"name":"rabbitmq-cluster-default-user","namespace":"default","keys":{"password":"password","username":"username"}},"serviceReference":{"name":"rabbitmq-cluster","namespace":"default"}}}}
2022/03/18 18:07:34 learn_server.go:291: [SIEVE-AFTER-READ]	Get	true	statefulset	default	rabbitmq-cluster-server	github.com/rabbitmq/cluster-operator/controllers.(*RabbitmqClusterReconciler)	NoError	{"kind":"StatefulSet","apiVersion":"apps/v1","metadata":{"name":"rabbitmq-cluster-server","namespace":"default","selfLink":"/apis/apps/v1/namespaces/default/statefulsets/rabbitmq-cluster-server","uid":"1d62d993-2c32-4da7-8884-e4cfad9e587d","resourceVersion":"1465","generation":1,"creationTimestamp":"2022-03-18T18:07:34Z","labels":{"app.kubernetes.io/component":"rabbitmq","app.kubernetes.io/name":"rabbitmq-cluster","app.kubernetes.io/part-of":"rabbitmq"},"annotations":{"rabbitmq.com/createdAt":"2022-03-18T18:07:34Z"},"ownerReferences":[{"apiVersion":"rabbitmq.com/v1beta1","kind":"RabbitmqCluster","name":"rabbitmq-cluster","uid":"3ecefa8a-1bec-48a7-9af4-dd0df3339101","controller":true,"blockOwnerDeletion":true}],"managedFields":[{"manager":"manager","operation":"Update","apiVersion":"apps/v1","time":"2022-03-18T18:07:34Z","fieldsType":"FieldsV1","fieldsV1":{"f:metadata":{"f:annotations":{".":{},"f:rabbitmq.com/createdAt":{}},"f:labels":{".":{},"f:app.kubernetes.io/component":{},"f:app.kubernetes.io/name":{},"f:app.kubernetes.io/part-of":{}},"f:ownerReferences":{".":{},"k:{\"uid\":\"3ecefa8a-1bec-48a7-9af4-dd0df3339101\"}":{".":{},"f:apiVersion":{},"f:blockOwnerDeletion":{},"f:controller":{},"f:kind":{},"f:name":{},"f:uid":{}}}},"f:spec":{"f:podManagementPolicy":{},"f:replicas":{},"f:revisionHistoryLimit":{},"f:selector":{"f:matchLabels":{".":{},"f:app.kubernetes.io/name":{}}},"f:serviceName":{},"f:template":{"f:metadata":{"f:annotations":{".":{},"f:prometheus.io/port":{},"f:prometheus.io/scrape":{}},"f:labels":{".":{},"f:app.kubernetes.io/component":{},"f:app.kubernetes.io/name":{},"f:app.kubernetes.io/part-of":{}}},"f:spec":{"f:automountServiceAccountToken":{},"f:containers":{"k:{\"name\":\"rabbitmq\"}":{".":{},"f:env":{".":{},"k:{\"name\":\"K8S_HOSTNAME_SUFFIX\"}":{".":{},"f:name":{},"f:value":{}},"k:{\"name\":\"K8S_SERVICE_NAME\"}":{".":{},"f:name":{},"f:value":{}},"k:{\"name\":\"MY_POD_NAME\"}":{".":{},"f:name":{},"f:valueFrom":{".":{},"f:fieldRef":{".":{},"f:apiVersion":{},"f:fieldPath":{}}}},"k:{\"name\":\"MY_POD_NAMESPACE\"}":{".":{},"f:name":{},"f:valueFrom":{".":{},"f:fieldRef":{".":{},"f:apiVersion":{},"f:fieldPath":{}}}},"k:{\"name\":\"RABBITMQ_ENABLED_PLUGINS_FILE\"}":{".":{},"f:name":{},"f:value":{}},"k:{\"name\":\"RABBITMQ_NODENAME\"}":{".":{},"f:name":{},"f:value":{}},"k:{\"name\":\"RABBITMQ_USE_LONGNAME\"}":{".":{},"f:name":{},"f:value":{}}},"f:image":{},"f:imagePullPolicy":{},"f:lifecycle":{".":{},"f:preStop":{".":{},"f:exec":{".":{},"f:command":{}}}},"f:name":{},"f:ports":{".":{},"k:{\"containerPort\":4369,\"protocol\":\"TCP\"}":{".":{},"f:containerPort":{},"f:name":{},"f:protocol":{}},"k:{\"containerPort\":5672,\"protocol\":\"TCP\"}":{".":{},"f:containerPort":{},"f:name":{},"f:protocol":{}},"k:{\"containerPort\":15672,\"protocol\":\"TCP\"}":{".":{},"f:containerPort":{},"f:name":{},"f:protocol":{}},"k:{\"containerPort\":15692,\"protocol\":\"TCP\"}":{".":{},"f:containerPort":{},"f:name":{},"f:protocol":{}}},"f:readinessProbe":{".":{},"f:failureThreshold":{},"f:initialDelaySeconds":{},"f:periodSeconds":{},"f:successThreshold":{},"f:tcpSocket":{".":{},"f:port":{}},"f:timeoutSeconds":{}},"f:resources":{".":{},"f:limits":{".":{},"f:cpu":{},"f:memory":{}},"f:requests":{".":{},"f:cpu":{},"f:memory":{}}},"f:terminationMessagePath":{},"f:terminationMessagePolicy":{},"f:volumeMounts":{".":{},"k:{\"mountPath\":\"/etc/pod-info/\"}":{".":{},"f:mountPath":{},"f:name":{}},"k:{\"mountPath\":\"/etc/rabbitmq/conf.d/10-operatorDefaults.conf\"}":{".":{},"f:mountPath":{},"f:name":{},"f:subPath":{}},"k:{\"mountPath\":\"/etc/rabbitmq/conf.d/11-default_user.conf\"}":{".":{},"f:mountPath":{},"f:name":{},"f:subPath":{}},"k:{\"mountPath\":\"/etc/rabbitmq/conf.d/90-userDefinedConfiguration.conf\"}":{".":{},"f:mountPath":{},"f:name":{},"f:subPath":{}},"k:{\"mountPath\":\"/operator\"}":{".":{},"f:mountPath":{},"f:name":{}},"k:{\"mountPath\":\"/var/lib/rabbitmq/\"}":{".":{},"f:mountPath":{},"f:name":{}},"k:{\"mountPath\":\"/var/lib/rabbitmq/mnesia/\"}":{".":{},"f:mountPath":{},"f:name":{}}}}},"f:dnsPolicy":{},"f:initContainers":{".":{},"k:{\"name\":\"setup-container\"}":{".":{},"f:command":{},"f:image":{},"f:imagePullPolicy":{},"f:name":{},"f:resources":{".":{},"f:limits":{".":{},"f:cpu":{},"f:memory":{}},"f:requests":{".":{},"f:cpu":{},"f:memory":{}}},"f:securityContext":{".":{},"f:capabilities":{".":{},"f:drop":{}},"f:runAsUser":{}},"f:terminationMessagePath":{},"f:terminationMessagePolicy":{},"f:volumeMounts":{".":{},"k:{\"mountPath\":\"/operator\"}":{".":{},"f:mountPath":{},"f:name":{}},"k:{\"mountPath\":\"/tmp/default_user.conf\"}":{".":{},"f:mountPath":{},"f:name":{},"f:subPath":{}},"k:{\"mountPath\":\"/tmp/erlang-cookie-secret/\"}":{".":{},"f:mountPath":{},"f:name":{}},"k:{\"mountPath\":\"/tmp/rabbitmq-plugins/\"}":{".":{},"f:mountPath":{},"f:name":{}},"k:{\"mountPath\":\"/var/lib/rabbitmq/\"}":{".":{},"f:mountPath":{},"f:name":{}},"k:{\"mountPath\":\"/var/lib/rabbitmq/mnesia/\"}":{".":{},"f:mountPath":{},"f:name":{}}}}},"f:restartPolicy":{},"f:schedulerName":{},"f:securityContext":{".":{},"f:fsGroup":{},"f:runAsGroup":{},"f:runAsUser":{}},"f:serviceAccount":{},"f:serviceAccountName":{},"f:terminationGracePeriodSeconds":{},"f:topologySpreadConstraints":{".":{},"k:{\"topologyKey\":\"topology.kubernetes.io/zone\",\"whenUnsatisfiable\":\"ScheduleAnyway\"}":{".":{},"f:labelSelector":{".":{},"f:matchLabels":{".":{},"f:app.kubernetes.io/name":{}}},"f:maxSkew":{},"f:topologyKey":{},"f:whenUnsatisfiable":{}}},"f:volumes":{".":{},"k:{\"name\":\"erlang-cookie-secret\"}":{".":{},"f:name":{},"f:secret":{".":{},"f:defaultMode":{},"f:secretName":{}}},"k:{\"name\":\"plugins-conf\"}":{".":{},"f:configMap":{".":{},"f:defaultMode":{},"f:name":{}},"f:name":{}},"k:{\"name\":\"pod-info\"}":{".":{},"f:downwardAPI":{".":{},"f:defaultMode":{},"f:items":{}},"f:name":{}},"k:{\"name\":\"rabbitmq-confd\"}":{".":{},"f:name":{},"f:projected":{".":{},"f:defaultMode":{},"f:sources":{}}},"k:{\"name\":\"rabbitmq-erlang-cookie\"}":{".":{},"f:emptyDir":{},"f:name":{}},"k:{\"name\":\"rabbitmq-plugins\"}":{".":{},"f:emptyDir":{},"f:name":{}}}}},"f:updateStrategy":{"f:rollingUpdate":{".":{},"f:partition":{}},"f:type":{}},"f:volumeClaimTemplates":{}}}}]},"spec":{"replicas":1,"selector":{"matchLabels":{"app.kubernetes.io/name":"rabbitmq-cluster"}},"template":{"metadata":{"creationTimestamp":null,"labels":{"app.kubernetes.io/component":"rabbitmq","app.kubernetes.io/name":"rabbitmq-cluster","app.kubernetes.io/part-of":"rabbitmq"},"annotations":{"prometheus.io/port":"15692","prometheus.io/scrape":"true"}},"spec":{"volumes":[{"name":"plugins-conf","configMap":{"name":"rabbitmq-cluster-plugins-conf","defaultMode":420}},{"name":"rabbitmq-confd","projected":{"sources":[{"secret":{"name":"rabbitmq-cluster-default-user","items":[{"key":"default_user.conf","path":"default_user.conf"}]}},{"configMap":{"name":"rabbitmq-cluster-server-conf","items":[{"key":"operatorDefaults.conf","path":"operatorDefaults.conf"},{"key":"userDefinedConfiguration.conf","path":"userDefinedConfiguration.conf"}]}}],"defaultMode":420}},{"name":"rabbitmq-erlang-cookie","emptyDir":{}},{"name":"erlang-cookie-secret","secret":{"secretName":"rabbitmq-cluster-erlang-cookie","defaultMode":420}},{"name":"rabbitmq-plugins","emptyDir":{}},{"name":"pod-info","downwardAPI":{"items":[{"path":"skipPreStopChecks","fieldRef":{"apiVersion":"v1","fieldPath":"metadata.labels['skipPreStopChecks']"}}],"defaultMode":420}}],"initContainers":[{"name":"setup-container","image":"rabbitmq:3.8.12-management","command":["sh","-c","cp /tmp/erlang-cookie-secret/.erlang.cookie /var/lib/rabbitmq/.erlang.cookie \u0026\u0026 chown 999:999 /var/lib/rabbitmq/.erlang.cookie \u0026\u0026 chmod 600 /var/lib/rabbitmq/.erlang.cookie ; cp /tmp/rabbitmq-plugins/enabled_plugins /operator/enabled_plugins \u0026\u0026 chown 999:999 /operator/enabled_plugins ; chown 999:999 /var/lib/rabbitmq/mnesia/ ; echo '[default]' \u003e /var/lib/rabbitmq/.rabbitmqadmin.conf \u0026\u0026 sed -e 's/default_user/username/' -e 's/default_pass/password/' /tmp/default_user.conf \u003e\u003e /var/lib/rabbitmq/.rabbitmqadmin.conf \u0026\u0026 chown 999:999 /var/lib/rabbitmq/.rabbitmqadmin.conf \u0026\u0026 chmod 600 /var/lib/rabbitmq/.rabbitmqadmin.conf"],"resources":{"limits":{"cpu":"100m","memory":"500Mi"},"requests":{"cpu":"100m","memory":"500Mi"}},"volumeMounts":[{"name":"plugins-conf","mountPath":"/tmp/rabbitmq-plugins/"},{"name":"rabbitmq-erlang-cookie","mountPath":"/var/lib/rabbitmq/"},{"name":"erlang-cookie-secret","mountPath":"/tmp/erlang-cookie-secret/"},{"name":"rabbitmq-plugins","mountPath":"/operator"},{"name":"persistence","mountPath":"/var/lib/rabbitmq/mnesia/"},{"name":"rabbitmq-confd","mountPath":"/tmp/default_user.conf","subPath":"default_user.conf"}],"terminationMessagePath":"/dev/termination-log","terminationMessagePolicy":"File","imagePullPolicy":"IfNotPresent","securityContext":{"capabilities":{"drop":["FSETID","KILL","SETGID","SETUID","SETPCAP","NET_BIND_SERVICE","NET_RAW","SYS_CHROOT","MKNOD","AUDIT_WRITE","SETFCAP"]},"runAsUser":0}}],"containers":[{"name":"rabbitmq","image":"rabbitmq:3.8.12-management","ports":[{"name":"epmd","containerPort":4369,"protocol":"TCP"},{"name":"amqp","containerPort":5672,"protocol":"TCP"},{"name":"management","containerPort":15672,"protocol":"TCP"},{"name":"prometheus","containerPort":15692,"protocol":"TCP"}],"env":[{"name":"MY_POD_NAME","valueFrom":{"fieldRef":{"apiVersion":"v1","fieldPath":"metadata.name"}}},{"name":"MY_POD_NAMESPACE","valueFrom":{"fieldRef":{"apiVersion":"v1","fieldPath":"metadata.namespace"}}},{"name":"RABBITMQ_ENABLED_PLUGINS_FILE","value":"/operator/enabled_plugins"},{"name":"K8S_SERVICE_NAME","value":"rabbitmq-cluster-nodes"},{"name":"RABBITMQ_USE_LONGNAME","value":"true"},{"name":"RABBITMQ_NODENAME","value":"rabbit@$(MY_POD_NAME).$(K8S_SERVICE_NAME).$(MY_POD_NAMESPACE)"},{"name":"K8S_HOSTNAME_SUFFIX","value":".$(K8S_SERVICE_NAME).$(MY_POD_NAMESPACE)"}],"resources":{"limits":{"cpu":"2","memory":"2Gi"},"requests":{"cpu":"1","memory":"2Gi"}},"volumeMounts":[{"name":"rabbitmq-erlang-cookie","mountPath":"/var/lib/rabbitmq/"},{"name":"persistence","mountPath":"/var/lib/rabbitmq/mnesia/"},{"name":"rabbitmq-plugins","mountPath":"/operator"},{"name":"rabbitmq-confd","mountPath":"/etc/rabbitmq/conf.d/10-operatorDefaults.conf","subPath":"operatorDefaults.conf"},{"name":"rabbitmq-confd","mountPath":"/etc/rabbitmq/conf.d/11-default_user.conf","subPath":"default_user.conf"},{"name":"rabbitmq-confd","mountPath":"/etc/rabbitmq/conf.d/90-userDefinedConfiguration.conf","subPath":"userDefinedConfiguration.conf"},{"name":"pod-info","mountPath":"/etc/pod-info/"}],"readinessProbe":{"tcpSocket":{"port":"amqp"},"initialDelaySeconds":10,"timeoutSeconds":5,"periodSeconds":10,"successThreshold":1,"failureThreshold":3},"lifecycle":{"preStop":{"exec":{"command":["/bin/bash","-c","if [ ! -z \"$(cat /etc/pod-info/skipPreStopChecks)\" ]; then exit 0; fi; rabbitmq-upgrade await_online_quorum_plus_one -t 604800; rabbitmq-upgrade await_online_synchronized_mirror -t 604800; rabbitmq-upgrade drain -t 604800"]}}},"terminationMessagePath":"/dev/termination-log","terminationMessagePolicy":"File","imagePullPolicy":"IfNotPresent"}],"restartPolicy":"Always","terminationGracePeriodSeconds":604800,"dnsPolicy":"ClusterFirst","serviceAccountName":"rabbitmq-cluster-server","serviceAccount":"rabbitmq-cluster-server","automountServiceAccountToken":true,"securityContext":{"runAsUser":999,"runAsGroup":999,"fsGroup":999},"schedulerName":"default-scheduler","topologySpreadConstraints":[{"maxSkew":1,"topologyKey":"topology.kubernetes.io/zone","whenUnsatisfiable":"ScheduleAnyway","labelSelector":{"matchLabels":{"app.kubernetes.io/name":"rabbitmq-cluster"}}}]}},"volumeClaimTemplates":[{"metadata":{"name":"persistence","namespace":"default","creationTimestamp":null,"labels":{"app.kubernetes.io/component":"rabbitmq","app.kubernetes.io/name":"rabbitmq-cluster","app.kubernetes.io/part-of":"rabbitmq"},"ownerReferences":[{"apiVersion":"rabbitmq.com/v1beta1","kind":"RabbitmqCluster","name":"rabbitmq-cluster","uid":"3ecefa8a-1bec-48a7-9af4-dd0df3339101","controller":true,"blockOwnerDeletion":false}]},"spec":{"accessModes":["ReadWriteOnce"],"resources":{"requests":{"storage":"15Gi"}},"volumeMode":"Filesystem"},"status":{"phase":"Pending"}}],"serviceName":"rabbitmq-cluster-nodes","podManagementPolicy":"Parallel","updateStrategy":{"type":"RollingUpdate","rollingUpdate":{"partition":0}},"revisionHistoryLimit":10},"status":{"replicas":0}}
2022/03/18 18:07:34 learn_server.go:291: [SIEVE-AFTER-READ]	Get	true	endpoints	default	rabbitmq-cluster	github.com/rabbitmq/cluster-operator/controllers.(*RabbitmqClusterReconciler)	NoError	{"kind":"Endpoints","apiVersion":"v1","metadata":{"name":"rabbitmq-cluster","namespace":"default","selfLink":"/api/v1/namespaces/default/endpoints/rabbitmq-cluster","uid":"eeba9576-0362-4e74-aafd-71e4ffe98d25","resourceVersion":"1402","creationTimestamp":"2022-03-18T18:06:25Z","labels":{"app.kubernetes.io/component":"rabbitmq","app.kubernetes.io/name":"rabbitmq-cluster","app.kubernetes.io/part-of":"rabbitmq"},"annotations":{"endpoints.kubernetes.io/last-change-trigger-time":"2022-03-18T18:07:23Z"},"managedFields":[{"manager":"kube-controller-manager","operation":"Update","apiVersion":"v1","time":"2022-03-18T18:07:23Z","fieldsType":"FieldsV1","fieldsV1":{"f:metadata":{"f:annotations":{".":{},"f:endpoints.kubernetes.io/last-change-trigger-time":{}},"f:labels":{".":{},"f:app.kubernetes.io/component":{},"f:app.kubernetes.io/name":{},"f:app.kubernetes.io/part-of":{}}},"f:subsets":{}}}]},"subsets":[{"addresses":[{"ip":"10.244.1.4","nodeName":"kind-worker","targetRef":{"kind":"Pod","namespace":"default","name":"rabbitmq-cluster-server-0","uid":"cbaba199-5faf-480a-81e8-051ce2cc79e6","resourceVersion":"1399"}}],"ports":[{"name":"amqp","port":5672,"protocol":"TCP"},{"name":"management","port":15672,"protocol":"TCP"}]}]}
2022/03/18 18:07:34 learn_server.go:256: [SIEVE-BEFORE-WRITE]	42
2022/03/18 18:07:34 learn_server.go:279: [SIEVE-BEFORE-HEAR]	31	Updated	persistentvolumeclaim	{"metadata":{"name":"persistence-rabbitmq-cluster-server-0","namespace":"default","selfLink":"/api/v1/namespaces/default/persistentvolumeclaims/persistence-rabbitmq-cluster-server-0","uid":"2a49a40a-31f5-4d2b-ba65-716831e0fa6b","resourceVersion":"1470","creationTimestamp":"2022-03-18T18:06:25Z","labels":{"app.kubernetes.io/component":"rabbitmq","app.kubernetes.io/name":"rabbitmq-cluster","app.kubernetes.io/part-of":"rabbitmq"},"annotations":{"pv.kubernetes.io/bind-completed":"yes","pv.kubernetes.io/bound-by-controller":"yes","volume.beta.kubernetes.io/storage-provisioner":"hostpath.csi.k8s.io"},"ownerReferences":[{"apiVersion":"rabbitmq.com/v1beta1","kind":"RabbitmqCluster","name":"rabbitmq-cluster","uid":"3ecefa8a-1bec-48a7-9af4-dd0df3339101","controller":true,"blockOwnerDeletion":false}],"finalizers":["kubernetes.io/pvc-protection"],"managedFields":[{"manager":"kube-controller-manager","operation":"Update","apiVersion":"v1","time":"2022-03-18T18:06:25Z","fieldsType":"FieldsV1","fieldsV1":{"f:metadata":{"f:annotations":{".":{},"f:pv.kubernetes.io/bind-completed":{},"f:pv.kubernetes.io/bound-by-controller":{},"f:volume.beta.kubernetes.io/storage-provisioner":{}},"f:labels":{".":{},"f:app.kubernetes.io/component":{},"f:app.kubernetes.io/name":{},"f:app.kubernetes.io/part-of":{}},"f:ownerReferences":{".":{},"k:{\"uid\":\"3ecefa8a-1bec-48a7-9af4-dd0df3339101\"}":{".":{},"f:apiVersion":{},"f:blockOwnerDeletion":{},"f:controller":{},"f:kind":{},"f:name":{},"f:uid":{}}}},"f:spec":{"f:accessModes":{},"f:resources":{"f:requests":{}},"f:volumeMode":{},"f:volumeName":{}},"f:status":{"f:accessModes":{},"f:capacity":{".":{},"f:storage":{}},"f:phase":{}}}},{"manager":"csi-resizer","operation":"Update","apiVersion":"v1","time":"2022-03-18T18:07:34Z","fieldsType":"FieldsV1","fieldsV1":{"f:status":{"f:conditions":{".":{},"k:{\"type\":\"FileSystemResizePending\"}":{".":{},"f:lastProbeTime":{},"f:lastTransitionTime":{},"f:message":{},"f:status":{},"f:type":{}}}}}},{"manager":"manager","operation":"Update","apiVersion":"v1","time":"2022-03-18T18:07:34Z","fieldsType":"FieldsV1","fieldsV1":{"f:spec":{"f:resources":{"f:requests":{"f:storage":{}}}}}}]},"spec":{"accessModes":["ReadWriteOnce"],"resources":{"requests":{"storage":"15Gi"}},"volumeName":"pvc-2a49a40a-31f5-4d2b-ba65-716831e0fa6b","storageClassName":"csi-hostpath-sc","volumeMode":"Filesystem"},"status":{"phase":"Bound","accessModes":["ReadWriteOnce"],"capacity":{"storage":"10Gi"},"conditions":[{"type":"FileSystemResizePending","status":"True","lastProbeTime":null,"lastTransitionTime":"2022-03-18T18:07:34Z","message":"Waiting for user to (re-)start a pod to finish file system resize of volume on node."}]}}
2022/03/18 18:07:34 learn_server.go:289: [SIEVE-AFTER-HEAR]	31
2022/03/18 18:07:34 learn_server.go:279: [SIEVE-BEFORE-HEAR]	32	Updated	rabbitmqcluster	{"metadata":{"name":"rabbitmq-cluster","namespace":"default","selfLink":"/apis/rabbitmq.com/v1beta1/namespaces/default/rabbitmqclusters/rabbitmq-cluster","uid":"3ecefa8a-1bec-48a7-9af4-dd0df3339101","resourceVersion":"1473","generation":3,"creationTimestamp":"2022-03-18T18:06:25Z","annotations":{"kubectl.kubernetes.io/last-applied-configuration":"{\"apiVersion\":\"rabbitmq.com/v1beta1\",\"kind\":\"RabbitmqCluster\",\"metadata\":{\"annotations\":{},\"name\":\"rabbitmq-cluster\",\"namespace\":\"default\"},\"spec\":{\"persistence\":{\"storage\":\"10Gi\"},\"replicas\":1}}\n"},"finalizers":["deletion.finalizers.rabbitmqclusters.rabbitmq.com"],"managedFields":[{"manager":"kubectl-client-side-apply","operation":"Update","apiVersion":"rabbitmq.com/v1beta1","time":"2022-03-18T18:06:25Z","fieldsType":"FieldsV1","fieldsV1":{"f:metadata":{"f:annotations":{".":{},"f:kubectl.kubernetes.io/last-applied-configuration":{}}},"f:spec":{".":{},"f:image":{},"f:persistence":{},"f:replicas":{},"f:resources":{".":{},"f:limits":{".":{},"f:memory":{}},"f:requests":{".":{},"f:memory":{}}},"f:service":{".":{},"f:type":{}},"f:terminationGracePeriodSeconds":{}}}},{"manager":"kubectl-patch","operation":"Update","apiVersion":"rabbitmq.com/v1beta1","time":"2022-03-18T18:07:31Z","fieldsType":"FieldsV1","fieldsV1":{"f:spec":{"f:persistence":{"f:storage":{}}}}},{"manager":"manager","operation":"Update","apiVersion":"rabbitmq.com/v1beta1","time":"2022-03-18T18:07:34Z","fieldsType":"FieldsV1","fieldsV1":{"f:metadata":{"f:finalizers":{}},"f:spec":{"f:override":{},"f:rabbitmq":{},"f:resources":{"f:limits":{"f:cpu":{}},"f:requests":{"f:cpu":{}}},"f:tls":{}},"f:status":{".":{},"f:conditions":{},"f:defaultUser":{".":{},"f:secretReference":{".":{},"f:keys":{".":{},"f:password":{},"f:username":{}},"f:name":{},"f:namespace":{}},"f:serviceReference":{".":{},"f:name":{},"f:namespace":{}}}}}}]},"spec":{"replicas":1,"image":"rabbitmq:3.8.12-management","service":{"type":"ClusterIP"},"persistence":{"storage":"15Gi"},"resources":{"limits":{"cpu":"2","memory":"2Gi"},"requests":{"cpu":"1","memory":"2Gi"}},"rabbitmq":{},"tls":{},"override":{},"terminationGracePeriodSeconds":604800},"status":{"conditions":[{"type":"AllReplicasReady","status":"False","lastTransitionTime":"2022-03-18T18:07:34Z","reason":"NotAllPodsReady","message":"0/1 Pods ready"},{"type":"ClusterAvailable","status":"True","lastTransitionTime":"2022-03-18T18:07:23Z","reason":"AtLeastOneEndpointAvailable"},{"type":"NoWarnings","status":"True","lastTransitionTime":"2022-03-18T18:06:25Z","reason":"NoWarnings"},{"type":"ReconcileSuccess","status":"True","lastTransitionTime":"2022-03-18T18:07:24Z","reason":"Success","message":"Finish reconciling"}],"defaultUser":{"secretReference":{"name":"rabbitmq-cluster-default-user","namespace":"default","keys":{"password":"password","username":"username"}},"serviceReference":{"name":"rabbitmq-cluster","namespace":"default"}}}}
2022/03/18 18:07:34 learn_server.go:289: [SIEVE-AFTER-HEAR]	32
2022/03/18 18:07:34 learn_server.go:263: [SIEVE-AFTER-WRITE]	42	StatusUpdate	rabbitmqcluster	github.com/rabbitmq/cluster-operator/controllers.(*RabbitmqClusterReconciler)	NoError	{"metadata":{"name":"rabbitmq-cluster","namespace":"default","selfLink":"/apis/rabbitmq.com/v1beta1/namespaces/default/rabbitmqclusters/rabbitmq-cluster/status","uid":"3ecefa8a-1bec-48a7-9af4-dd0df3339101","resourceVersion":"1473","generation":3,"creationTimestamp":"2022-03-18T18:06:25Z","annotations":{"kubectl.kubernetes.io/last-applied-configuration":"{\"apiVersion\":\"rabbitmq.com/v1beta1\",\"kind\":\"RabbitmqCluster\",\"metadata\":{\"annotations\":{},\"name\":\"rabbitmq-cluster\",\"namespace\":\"default\"},\"spec\":{\"persistence\":{\"storage\":\"10Gi\"},\"replicas\":1}}\n"},"finalizers":["deletion.finalizers.rabbitmqclusters.rabbitmq.com"],"managedFields":[{"manager":"kubectl-client-side-apply","operation":"Update","apiVersion":"rabbitmq.com/v1beta1","time":"2022-03-18T18:06:25Z","fieldsType":"FieldsV1","fieldsV1":{"f:metadata":{"f:annotations":{".":{},"f:kubectl.kubernetes.io/last-applied-configuration":{}}},"f:spec":{".":{},"f:image":{},"f:persistence":{},"f:replicas":{},"f:resources":{".":{},"f:limits":{".":{},"f:memory":{}},"f:requests":{".":{},"f:memory":{}}},"f:service":{".":{},"f:type":{}},"f:terminationGracePeriodSeconds":{}}}},{"manager":"kubectl-patch","operation":"Update","apiVersion":"rabbitmq.com/v1beta1","time":"2022-03-18T18:07:31Z","fieldsType":"FieldsV1","fieldsV1":{"f:spec":{"f:persistence":{"f:storage":{}}}}},{"manager":"manager","operation":"Update","apiVersion":"rabbitmq.com/v1beta1","time":"2022-03-18T18:07:34Z","fieldsType":"FieldsV1","fieldsV1":{"f:metadata":{"f:finalizers":{}},"f:spec":{"f:override":{},"f:rabbitmq":{},"f:resources":{"f:limits":{"f:cpu":{}},"f:requests":{"f:cpu":{}}},"f:tls":{}},"f:status":{".":{},"f:conditions":{},"f:defaultUser":{".":{},"f:secretReference":{".":{},"f:keys":{".":{},"f:password":{},"f:username":{}},"f:name":{},"f:namespace":{}},"f:serviceReference":{".":{},"f:name":{},"f:namespace":{}}}}}}]},"spec":{"replicas":1,"image":"rabbitmq:3.8.12-management","service":{"type":"ClusterIP"},"persistence":{"storage":"15Gi"},"resources":{"limits":{"cpu":"2","memory":"2Gi"},"requests":{"cpu":"1","memory":"2Gi"}},"rabbitmq":{},"tls":{},"override":{},"terminationGracePeriodSeconds":604800},"status":{"conditions":[{"type":"AllReplicasReady","status":"False","lastTransitionTime":"2022-03-18T18:07:34Z","reason":"NotAllPodsReady","message":"0/1 Pods ready"},{"type":"ClusterAvailable","status":"True","lastTransitionTime":"2022-03-18T18:07:23Z","reason":"AtLeastOneEndpointAvailable"},{"type":"NoWarnings","status":"True","lastTransitionTime":"2022-03-18T18:06:25Z","reason":"NoWarnings"},{"type":"ReconcileSuccess","status":"True","lastTransitionTime":"2022-03-18T18:07:24Z","reason":"Success","message":"Finish reconciling"}],"defaultUser":{"secretReference":{"name":"rabbitmq-cluster-default-user","namespace":"default","keys":{"password":"password","username":"username"}},"serviceReference":{"name":"rabbitmq-cluster","namespace":"default"}}}}
2022/03/18 18:07:34 learn_server.go:291: [SIEVE-AFTER-READ]	Get	true	statefulset	default	rabbitmq-cluster-server	github.com/rabbitmq/cluster-operator/controllers.(*RabbitmqClusterReconciler)	NoError	{"kind":"StatefulSet","apiVersion":"apps/v1","metadata":{"name":"rabbitmq-cluster-server","namespace":"default","selfLink":"/apis/apps/v1/namespaces/default/statefulsets/rabbitmq-cluster-server","uid":"1d62d993-2c32-4da7-8884-e4cfad9e587d","resourceVersion":"1465","generation":1,"creationTimestamp":"2022-03-18T18:07:34Z","labels":{"app.kubernetes.io/component":"rabbitmq","app.kubernetes.io/name":"rabbitmq-cluster","app.kubernetes.io/part-of":"rabbitmq"},"annotations":{"rabbitmq.com/createdAt":"2022-03-18T18:07:34Z"},"ownerReferences":[{"apiVersion":"rabbitmq.com/v1beta1","kind":"RabbitmqCluster","name":"rabbitmq-cluster","uid":"3ecefa8a-1bec-48a7-9af4-dd0df3339101","controller":true,"blockOwnerDeletion":true}],"managedFields":[{"manager":"manager","operation":"Update","apiVersion":"apps/v1","time":"2022-03-18T18:07:34Z","fieldsType":"FieldsV1","fieldsV1":{"f:metadata":{"f:annotations":{".":{},"f:rabbitmq.com/createdAt":{}},"f:labels":{".":{},"f:app.kubernetes.io/component":{},"f:app.kubernetes.io/name":{},"f:app.kubernetes.io/part-of":{}},"f:ownerReferences":{".":{},"k:{\"uid\":\"3ecefa8a-1bec-48a7-9af4-dd0df3339101\"}":{".":{},"f:apiVersion":{},"f:blockOwnerDeletion":{},"f:controller":{},"f:kind":{},"f:name":{},"f:uid":{}}}},"f:spec":{"f:podManagementPolicy":{},"f:replicas":{},"f:revisionHistoryLimit":{},"f:selector":{"f:matchLabels":{".":{},"f:app.kubernetes.io/name":{}}},"f:serviceName":{},"f:template":{"f:metadata":{"f:annotations":{".":{},"f:prometheus.io/port":{},"f:prometheus.io/scrape":{}},"f:labels":{".":{},"f:app.kubernetes.io/component":{},"f:app.kubernetes.io/name":{},"f:app.kubernetes.io/part-of":{}}},"f:spec":{"f:automountServiceAccountToken":{},"f:containers":{"k:{\"name\":\"rabbitmq\"}":{".":{},"f:env":{".":{},"k:{\"name\":\"K8S_HOSTNAME_SUFFIX\"}":{".":{},"f:name":{},"f:value":{}},"k:{\"name\":\"K8S_SERVICE_NAME\"}":{".":{},"f:name":{},"f:value":{}},"k:{\"name\":\"MY_POD_NAME\"}":{".":{},"f:name":{},"f:valueFrom":{".":{},"f:fieldRef":{".":{},"f:apiVersion":{},"f:fieldPath":{}}}},"k:{\"name\":\"MY_POD_NAMESPACE\"}":{".":{},"f:name":{},"f:valueFrom":{".":{},"f:fieldRef":{".":{},"f:apiVersion":{},"f:fieldPath":{}}}},"k:{\"name\":\"RABBITMQ_ENABLED_PLUGINS_FILE\"}":{".":{},"f:name":{},"f:value":{}},"k:{\"name\":\"RABBITMQ_NODENAME\"}":{".":{},"f:name":{},"f:value":{}},"k:{\"name\":\"RABBITMQ_USE_LONGNAME\"}":{".":{},"f:name":{},"f:value":{}}},"f:image":{},"f:imagePullPolicy":{},"f:lifecycle":{".":{},"f:preStop":{".":{},"f:exec":{".":{},"f:command":{}}}},"f:name":{},"f:ports":{".":{},"k:{\"containerPort\":4369,\"protocol\":\"TCP\"}":{".":{},"f:containerPort":{},"f:name":{},"f:protocol":{}},"k:{\"containerPort\":5672,\"protocol\":\"TCP\"}":{".":{},"f:containerPort":{},"f:name":{},"f:protocol":{}},"k:{\"containerPort\":15672,\"protocol\":\"TCP\"}":{".":{},"f:containerPort":{},"f:name":{},"f:protocol":{}},"k:{\"containerPort\":15692,\"protocol\":\"TCP\"}":{".":{},"f:containerPort":{},"f:name":{},"f:protocol":{}}},"f:readinessProbe":{".":{},"f:failureThreshold":{},"f:initialDelaySeconds":{},"f:periodSeconds":{},"f:successThreshold":{},"f:tcpSocket":{".":{},"f:port":{}},"f:timeoutSeconds":{}},"f:resources":{".":{},"f:limits":{".":{},"f:cpu":{},"f:memory":{}},"f:requests":{".":{},"f:cpu":{},"f:memory":{}}},"f:terminationMessagePath":{},"f:terminationMessagePolicy":{},"f:volumeMounts":{".":{},"k:{\"mountPath\":\"/etc/pod-info/\"}":{".":{},"f:mountPath":{},"f:name":{}},"k:{\"mountPath\":\"/etc/rabbitmq/conf.d/10-operatorDefaults.conf\"}":{".":{},"f:mountPath":{},"f:name":{},"f:subPath":{}},"k:{\"mountPath\":\"/etc/rabbitmq/conf.d/11-default_user.conf\"}":{".":{},"f:mountPath":{},"f:name":{},"f:subPath":{}},"k:{\"mountPath\":\"/etc/rabbitmq/conf.d/90-userDefinedConfiguration.conf\"}":{".":{},"f:mountPath":{},"f:name":{},"f:subPath":{}},"k:{\"mountPath\":\"/operator\"}":{".":{},"f:mountPath":{},"f:name":{}},"k:{\"mountPath\":\"/var/lib/rabbitmq/\"}":{".":{},"f:mountPath":{},"f:name":{}},"k:{\"mountPath\":\"/var/lib/rabbitmq/mnesia/\"}":{".":{},"f:mountPath":{},"f:name":{}}}}},"f:dnsPolicy":{},"f:initContainers":{".":{},"k:{\"name\":\"setup-container\"}":{".":{},"f:command":{},"f:image":{},"f:imagePullPolicy":{},"f:name":{},"f:resources":{".":{},"f:limits":{".":{},"f:cpu":{},"f:memory":{}},"f:requests":{".":{},"f:cpu":{},"f:memory":{}}},"f:securityContext":{".":{},"f:capabilities":{".":{},"f:drop":{}},"f:runAsUser":{}},"f:terminationMessagePath":{},"f:terminationMessagePolicy":{},"f:volumeMounts":{".":{},"k:{\"mountPath\":\"/operator\"}":{".":{},"f:mountPath":{},"f:name":{}},"k:{\"mountPath\":\"/tmp/default_user.conf\"}":{".":{},"f:mountPath":{},"f:name":{},"f:subPath":{}},"k:{\"mountPath\":\"/tmp/erlang-cookie-secret/\"}":{".":{},"f:mountPath":{},"f:name":{}},"k:{\"mountPath\":\"/tmp/rabbitmq-plugins/\"}":{".":{},"f:mountPath":{},"f:name":{}},"k:{\"mountPath\":\"/var/lib/rabbitmq/\"}":{".":{},"f:mountPath":{},"f:name":{}},"k:{\"mountPath\":\"/var/lib/rabbitmq/mnesia/\"}":{".":{},"f:mountPath":{},"f:name":{}}}}},"f:restartPolicy":{},"f:schedulerName":{},"f:securityContext":{".":{},"f:fsGroup":{},"f:runAsGroup":{},"f:runAsUser":{}},"f:serviceAccount":{},"f:serviceAccountName":{},"f:terminationGracePeriodSeconds":{},"f:topologySpreadConstraints":{".":{},"k:{\"topologyKey\":\"topology.kubernetes.io/zone\",\"whenUnsatisfiable\":\"ScheduleAnyway\"}":{".":{},"f:labelSelector":{".":{},"f:matchLabels":{".":{},"f:app.kubernetes.io/name":{}}},"f:maxSkew":{},"f:topologyKey":{},"f:whenUnsatisfiable":{}}},"f:volumes":{".":{},"k:{\"name\":\"erlang-cookie-secret\"}":{".":{},"f:name":{},"f:secret":{".":{},"f:defaultMode":{},"f:secretName":{}}},"k:{\"name\":\"plugins-conf\"}":{".":{},"f:configMap":{".":{},"f:defaultMode":{},"f:name":{}},"f:name":{}},"k:{\"name\":\"pod-info\"}":{".":{},"f:downwardAPI":{".":{},"f:defaultMode":{},"f:items":{}},"f:name":{}},"k:{\"name\":\"rabbitmq-confd\"}":{".":{},"f:name":{},"f:projected":{".":{},"f:defaultMode":{},"f:sources":{}}},"k:{\"name\":\"rabbitmq-erlang-cookie\"}":{".":{},"f:emptyDir":{},"f:name":{}},"k:{\"name\":\"rabbitmq-plugins\"}":{".":{},"f:emptyDir":{},"f:name":{}}}}},"f:updateStrategy":{"f:rollingUpdate":{".":{},"f:partition":{}},"f:type":{}},"f:volumeClaimTemplates":{}}}}]},"spec":{"replicas":1,"selector":{"matchLabels":{"app.kubernetes.io/name":"rabbitmq-cluster"}},"template":{"metadata":{"creationTimestamp":null,"labels":{"app.kubernetes.io/component":"rabbitmq","app.kubernetes.io/name":"rabbitmq-cluster","app.kubernetes.io/part-of":"rabbitmq"},"annotations":{"prometheus.io/port":"15692","prometheus.io/scrape":"true"}},"spec":{"volumes":[{"name":"plugins-conf","configMap":{"name":"rabbitmq-cluster-plugins-conf","defaultMode":420}},{"name":"rabbitmq-confd","projected":{"sources":[{"secret":{"name":"rabbitmq-cluster-default-user","items":[{"key":"default_user.conf","path":"default_user.conf"}]}},{"configMap":{"name":"rabbitmq-cluster-server-conf","items":[{"key":"operatorDefaults.conf","path":"operatorDefaults.conf"},{"key":"userDefinedConfiguration.conf","path":"userDefinedConfiguration.conf"}]}}],"defaultMode":420}},{"name":"rabbitmq-erlang-cookie","emptyDir":{}},{"name":"erlang-cookie-secret","secret":{"secretName":"rabbitmq-cluster-erlang-cookie","defaultMode":420}},{"name":"rabbitmq-plugins","emptyDir":{}},{"name":"pod-info","downwardAPI":{"items":[{"path":"skipPreStopChecks","fieldRef":{"apiVersion":"v1","fieldPath":"metadata.labels['skipPreStopChecks']"}}],"defaultMode":420}}],"initContainers":[{"name":"setup-container","image":"rabbitmq:3.8.12-management","command":["sh","-c","cp /tmp/erlang-cookie-secret/.erlang.cookie /var/lib/rabbitmq/.erlang.cookie \u0026\u0026 chown 999:999 /var/lib/rabbitmq/.erlang.cookie \u0026\u0026 chmod 600 /var/lib/rabbitmq/.erlang.cookie ; cp /tmp/rabbitmq-plugins/enabled_plugins /operator/enabled_plugins \u0026\u0026 chown 999:999 /operator/enabled_plugins ; chown 999:999 /var/lib/rabbitmq/mnesia/ ; echo '[default]' \u003e /var/lib/rabbitmq/.rabbitmqadmin.conf \u0026\u0026 sed -e 's/default_user/username/' -e 's/default_pass/password/' /tmp/default_user.conf \u003e\u003e /var/lib/rabbitmq/.rabbitmqadmin.conf \u0026\u0026 chown 999:999 /var/lib/rabbitmq/.rabbitmqadmin.conf \u0026\u0026 chmod 600 /var/lib/rabbitmq/.rabbitmqadmin.conf"],"resources":{"limits":{"cpu":"100m","memory":"500Mi"},"requests":{"cpu":"100m","memory":"500Mi"}},"volumeMounts":[{"name":"plugins-conf","mountPath":"/tmp/rabbitmq-plugins/"},{"name":"rabbitmq-erlang-cookie","mountPath":"/var/lib/rabbitmq/"},{"name":"erlang-cookie-secret","mountPath":"/tmp/erlang-cookie-secret/"},{"name":"rabbitmq-plugins","mountPath":"/operator"},{"name":"persistence","mountPath":"/var/lib/rabbitmq/mnesia/"},{"name":"rabbitmq-confd","mountPath":"/tmp/default_user.conf","subPath":"default_user.conf"}],"terminationMessagePath":"/dev/termination-log","terminationMessagePolicy":"File","imagePullPolicy":"IfNotPresent","securityContext":{"capabilities":{"drop":["FSETID","KILL","SETGID","SETUID","SETPCAP","NET_BIND_SERVICE","NET_RAW","SYS_CHROOT","MKNOD","AUDIT_WRITE","SETFCAP"]},"runAsUser":0}}],"containers":[{"name":"rabbitmq","image":"rabbitmq:3.8.12-management","ports":[{"name":"epmd","containerPort":4369,"protocol":"TCP"},{"name":"amqp","containerPort":5672,"protocol":"TCP"},{"name":"management","containerPort":15672,"protocol":"TCP"},{"name":"prometheus","containerPort":15692,"protocol":"TCP"}],"env":[{"name":"MY_POD_NAME","valueFrom":{"fieldRef":{"apiVersion":"v1","fieldPath":"metadata.name"}}},{"name":"MY_POD_NAMESPACE","valueFrom":{"fieldRef":{"apiVersion":"v1","fieldPath":"metadata.namespace"}}},{"name":"RABBITMQ_ENABLED_PLUGINS_FILE","value":"/operator/enabled_plugins"},{"name":"K8S_SERVICE_NAME","value":"rabbitmq-cluster-nodes"},{"name":"RABBITMQ_USE_LONGNAME","value":"true"},{"name":"RABBITMQ_NODENAME","value":"rabbit@$(MY_POD_NAME).$(K8S_SERVICE_NAME).$(MY_POD_NAMESPACE)"},{"name":"K8S_HOSTNAME_SUFFIX","value":".$(K8S_SERVICE_NAME).$(MY_POD_NAMESPACE)"}],"resources":{"limits":{"cpu":"2","memory":"2Gi"},"requests":{"cpu":"1","memory":"2Gi"}},"volumeMounts":[{"name":"rabbitmq-erlang-cookie","mountPath":"/var/lib/rabbitmq/"},{"name":"persistence","mountPath":"/var/lib/rabbitmq/mnesia/"},{"name":"rabbitmq-plugins","mountPath":"/operator"},{"name":"rabbitmq-confd","mountPath":"/etc/rabbitmq/conf.d/10-operatorDefaults.conf","subPath":"operatorDefaults.conf"},{"name":"rabbitmq-confd","mountPath":"/etc/rabbitmq/conf.d/11-default_user.conf","subPath":"default_user.conf"},{"name":"rabbitmq-confd","mountPath":"/etc/rabbitmq/conf.d/90-userDefinedConfiguration.conf","subPath":"userDefinedConfiguration.conf"},{"name":"pod-info","mountPath":"/etc/pod-info/"}],"readinessProbe":{"tcpSocket":{"port":"amqp"},"initialDelaySeconds":10,"timeoutSeconds":5,"periodSeconds":10,"successThreshold":1,"failureThreshold":3},"lifecycle":{"preStop":{"exec":{"command":["/bin/bash","-c","if [ ! -z \"$(cat /etc/pod-info/skipPreStopChecks)\" ]; then exit 0; fi; rabbitmq-upgrade await_online_quorum_plus_one -t 604800; rabbitmq-upgrade await_online_synchronized_mirror -t 604800; rabbitmq-upgrade drain -t 604800"]}}},"terminationMessagePath":"/dev/termination-log","terminationMessagePolicy":"File","imagePullPolicy":"IfNotPresent"}],"restartPolicy":"Always","terminationGracePeriodSeconds":604800,"dnsPolicy":"ClusterFirst","serviceAccountName":"rabbitmq-cluster-server","serviceAccount":"rabbitmq-cluster-server","automountServiceAccountToken":true,"securityContext":{"runAsUser":999,"runAsGroup":999,"fsGroup":999},"schedulerName":"default-scheduler","topologySpreadConstraints":[{"maxSkew":1,"topologyKey":"topology.kubernetes.io/zone","whenUnsatisfiable":"ScheduleAnyway","labelSelector":{"matchLabels":{"app.kubernetes.io/name":"rabbitmq-cluster"}}}]}},"volumeClaimTemplates":[{"metadata":{"name":"persistence","namespace":"default","creationTimestamp":null,"labels":{"app.kubernetes.io/component":"rabbitmq","app.kubernetes.io/name":"rabbitmq-cluster","app.kubernetes.io/part-of":"rabbitmq"},"ownerReferences":[{"apiVersion":"rabbitmq.com/v1beta1","kind":"RabbitmqCluster","name":"rabbitmq-cluster","uid":"3ecefa8a-1bec-48a7-9af4-dd0df3339101","controller":true,"blockOwnerDeletion":false}]},"spec":{"accessModes":["ReadWriteOnce"],"resources":{"requests":{"storage":"15Gi"}},"volumeMode":"Filesystem"},"status":{"phase":"Pending"}}],"serviceName":"rabbitmq-cluster-nodes","podManagementPolicy":"Parallel","updateStrategy":{"type":"RollingUpdate","rollingUpdate":{"partition":0}},"revisionHistoryLimit":10},"status":{"replicas":0}}
2022/03/18 18:07:34 learn_server.go:291: [SIEVE-AFTER-READ]	Get	true	service	default	rabbitmq-cluster-nodes	github.com/rabbitmq/cluster-operator/controllers.(*RabbitmqClusterReconciler)	NoError	{"kind":"Service","apiVersion":"v1","metadata":{"name":"rabbitmq-cluster-nodes","namespace":"default","selfLink":"/api/v1/namespaces/default/services/rabbitmq-cluster-nodes","uid":"f843e1c2-ced0-463d-87c1-0e127aaa2006","resourceVersion":"1080","creationTimestamp":"2022-03-18T18:06:25Z","labels":{"app.kubernetes.io/component":"rabbitmq","app.kubernetes.io/name":"rabbitmq-cluster","app.kubernetes.io/part-of":"rabbitmq"},"ownerReferences":[{"apiVersion":"rabbitmq.com/v1beta1","kind":"RabbitmqCluster","name":"rabbitmq-cluster","uid":"3ecefa8a-1bec-48a7-9af4-dd0df3339101","controller":true,"blockOwnerDeletion":true}],"managedFields":[{"manager":"manager","operation":"Update","apiVersion":"v1","time":"2022-03-18T18:06:25Z","fieldsType":"FieldsV1","fieldsV1":{"f:metadata":{"f:labels":{".":{},"f:app.kubernetes.io/component":{},"f:app.kubernetes.io/name":{},"f:app.kubernetes.io/part-of":{}},"f:ownerReferences":{".":{},"k:{\"uid\":\"3ecefa8a-1bec-48a7-9af4-dd0df3339101\"}":{".":{},"f:apiVersion":{},"f:blockOwnerDeletion":{},"f:controller":{},"f:kind":{},"f:name":{},"f:uid":{}}}},"f:spec":{"f:clusterIP":{},"f:ports":{".":{},"k:{\"port\":4369,\"protocol\":\"TCP\"}":{".":{},"f:name":{},"f:port":{},"f:protocol":{},"f:targetPort":{}},"k:{\"port\":25672,\"protocol\":\"TCP\"}":{".":{},"f:name":{},"f:port":{},"f:protocol":{},"f:targetPort":{}}},"f:publishNotReadyAddresses":{},"f:selector":{".":{},"f:app.kubernetes.io/name":{}},"f:sessionAffinity":{},"f:type":{}}}}]},"spec":{"ports":[{"name":"epmd","protocol":"TCP","port":4369,"targetPort":4369},{"name":"cluster-rpc","protocol":"TCP","port":25672,"targetPort":25672}],"selector":{"app.kubernetes.io/name":"rabbitmq-cluster"},"clusterIP":"None","type":"ClusterIP","sessionAffinity":"None","publishNotReadyAddresses":true},"status":{"loadBalancer":{}}}
2022/03/18 18:07:34 learn_server.go:291: [SIEVE-AFTER-READ]	Get	true	service	default	rabbitmq-cluster	github.com/rabbitmq/cluster-operator/controllers.(*RabbitmqClusterReconciler)	NoError	{"kind":"Service","apiVersion":"v1","metadata":{"name":"rabbitmq-cluster","namespace":"default","selfLink":"/api/v1/namespaces/default/services/rabbitmq-cluster","uid":"ae846a70-784e-49ca-99a0-2b0cefb93b46","resourceVersion":"1085","creationTimestamp":"2022-03-18T18:06:25Z","labels":{"app.kubernetes.io/component":"rabbitmq","app.kubernetes.io/name":"rabbitmq-cluster","app.kubernetes.io/part-of":"rabbitmq"},"ownerReferences":[{"apiVersion":"rabbitmq.com/v1beta1","kind":"RabbitmqCluster","name":"rabbitmq-cluster","uid":"3ecefa8a-1bec-48a7-9af4-dd0df3339101","controller":true,"blockOwnerDeletion":true}],"managedFields":[{"manager":"manager","operation":"Update","apiVersion":"v1","time":"2022-03-18T18:06:25Z","fieldsType":"FieldsV1","fieldsV1":{"f:metadata":{"f:labels":{".":{},"f:app.kubernetes.io/component":{},"f:app.kubernetes.io/name":{},"f:app.kubernetes.io/part-of":{}},"f:ownerReferences":{".":{},"k:{\"uid\":\"3ecefa8a-1bec-48a7-9af4-dd0df3339101\"}":{".":{},"f:apiVersion":{},"f:blockOwnerDeletion":{},"f:controller":{},"f:kind":{},"f:name":{},"f:uid":{}}}},"f:spec":{"f:ports":{".":{},"k:{\"port\":5672,\"protocol\":\"TCP\"}":{".":{},"f:name":{},"f:port":{},"f:protocol":{},"f:targetPort":{}},"k:{\"port\":15672,\"protocol\":\"TCP\"}":{".":{},"f:name":{},"f:port":{},"f:protocol":{},"f:targetPort":{}}},"f:selector":{".":{},"f:app.kubernetes.io/name":{}},"f:sessionAffinity":{},"f:type":{}}}}]},"spec":{"ports":[{"name":"amqp","protocol":"TCP","port":5672,"targetPort":5672},{"name":"management","protocol":"TCP","port":15672,"targetPort":15672}],"selector":{"app.kubernetes.io/name":"rabbitmq-cluster"},"clusterIP":"10.96.47.189","type":"ClusterIP","sessionAffinity":"None"},"status":{"loadBalancer":{}}}
2022/03/18 18:07:34 learn_server.go:291: [SIEVE-AFTER-READ]	Get	true	secret	default	rabbitmq-cluster-erlang-cookie	github.com/rabbitmq/cluster-operator/controllers.(*RabbitmqClusterReconciler)	NoError	{"kind":"Secret","apiVersion":"v1","metadata":{"name":"rabbitmq-cluster-erlang-cookie","namespace":"default","selfLink":"/api/v1/namespaces/default/secrets/rabbitmq-cluster-erlang-cookie","uid":"01d8d8ad-080a-4c3f-9d27-56616c53dd26","resourceVersion":"1088","creationTimestamp":"2022-03-18T18:06:25Z","labels":{"app.kubernetes.io/component":"rabbitmq","app.kubernetes.io/name":"rabbitmq-cluster","app.kubernetes.io/part-of":"rabbitmq"},"ownerReferences":[{"apiVersion":"rabbitmq.com/v1beta1","kind":"RabbitmqCluster","name":"rabbitmq-cluster","uid":"3ecefa8a-1bec-48a7-9af4-dd0df3339101","controller":true,"blockOwnerDeletion":true}],"managedFields":[{"manager":"manager","operation":"Update","apiVersion":"v1","time":"2022-03-18T18:06:25Z","fieldsType":"FieldsV1","fieldsV1":{"f:data":{".":{},"f:.erlang.cookie":{}},"f:metadata":{"f:labels":{".":{},"f:app.kubernetes.io/component":{},"f:app.kubernetes.io/name":{},"f:app.kubernetes.io/part-of":{}},"f:ownerReferences":{".":{},"k:{\"uid\":\"3ecefa8a-1bec-48a7-9af4-dd0df3339101\"}":{".":{},"f:apiVersion":{},"f:blockOwnerDeletion":{},"f:controller":{},"f:kind":{},"f:name":{},"f:uid":{}}}},"f:type":{}}}]},"data":{".erlang.cookie":"ajdscUtLdnBpR1NwUUMwc1V3a2VyTlJxU2tVUTdBeEw="},"type":"Opaque"}
2022/03/18 18:07:34 learn_server.go:291: [SIEVE-AFTER-READ]	Get	true	secret	default	rabbitmq-cluster-default-user	github.com/rabbitmq/cluster-operator/controllers.(*RabbitmqClusterReconciler)	NoError	{"kind":"Secret","apiVersion":"v1","metadata":{"name":"rabbitmq-cluster-default-user","namespace":"default","selfLink":"/api/v1/namespaces/default/secrets/rabbitmq-cluster-default-user","uid":"b2f5a936-e51f-4488-b6e9-ca23e4d95ac2","resourceVersion":"1091","creationTimestamp":"2022-03-18T18:06:25Z","labels":{"app.kubernetes.io/component":"rabbitmq","app.kubernetes.io/name":"rabbitmq-cluster","app.kubernetes.io/part-of":"rabbitmq"},"ownerReferences":[{"apiVersion":"rabbitmq.com/v1beta1","kind":"RabbitmqCluster","name":"rabbitmq-cluster","uid":"3ecefa8a-1bec-48a7-9af4-dd0df3339101","controller":true,"blockOwnerDeletion":true}],"managedFields":[{"manager":"manager","operation":"Update","apiVersion":"v1","time":"2022-03-18T18:06:25Z","fieldsType":"FieldsV1","fieldsV1":{"f:data":{".":{},"f:default_user.conf":{},"f:password":{},"f:provider":{},"f:type":{},"f:username":{}},"f:metadata":{"f:labels":{".":{},"f:app.kubernetes.io/component":{},"f:app.kubernetes.io/name":{},"f:app.kubernetes.io/part-of":{}},"f:ownerReferences":{".":{},"k:{\"uid\":\"3ecefa8a-1bec-48a7-9af4-dd0df3339101\"}":{".":{},"f:apiVersion":{},"f:blockOwnerDeletion":{},"f:controller":{},"f:kind":{},"f:name":{},"f:uid":{}}}},"f:type":{}}}]},"data":{"default_user.conf":"ZGVmYXVsdF91c2VyID0gdEFMN1otZTgzR29ocEtsZ0Z4cUFFV3ZXemEtcjdJQW8KZGVmYXVsdF9wYXNzID0gdXVocndkTkdOcmJXQ2p6NFZPX0NUZE9OYURkSUpoRkoK","password":"dXVocndkTkdOcmJXQ2p6NFZPX0NUZE9OYURkSUpoRko=","provider":"cmFiYml0bXE=","type":"cmFiYml0bXE=","username":"dEFMN1otZTgzR29ocEtsZ0Z4cUFFV3ZXemEtcjdJQW8="},"type":"Opaque"}
2022/03/18 18:07:34 learn_server.go:291: [SIEVE-AFTER-READ]	Get	true	configmap	default	rabbitmq-cluster-plugins-conf	github.com/rabbitmq/cluster-operator/controllers.(*RabbitmqClusterReconciler)	NoError	{"kind":"ConfigMap","apiVersion":"v1","metadata":{"name":"rabbitmq-cluster-plugins-conf","namespace":"default","selfLink":"/api/v1/namespaces/default/configmaps/rabbitmq-cluster-plugins-conf","uid":"0aa26eb6-ff3a-4457-a223-284c897db7fe","resourceVersion":"1092","creationTimestamp":"2022-03-18T18:06:25Z","labels":{"app.kubernetes.io/component":"rabbitmq","app.kubernetes.io/name":"rabbitmq-cluster","app.kubernetes.io/part-of":"rabbitmq"},"ownerReferences":[{"apiVersion":"rabbitmq.com/v1beta1","kind":"RabbitmqCluster","name":"rabbitmq-cluster","uid":"3ecefa8a-1bec-48a7-9af4-dd0df3339101","controller":true,"blockOwnerDeletion":true}],"managedFields":[{"manager":"manager","operation":"Update","apiVersion":"v1","time":"2022-03-18T18:06:25Z","fieldsType":"FieldsV1","fieldsV1":{"f:data":{".":{},"f:enabled_plugins":{}},"f:metadata":{"f:labels":{".":{},"f:app.kubernetes.io/component":{},"f:app.kubernetes.io/name":{},"f:app.kubernetes.io/part-of":{}},"f:ownerReferences":{".":{},"k:{\"uid\":\"3ecefa8a-1bec-48a7-9af4-dd0df3339101\"}":{".":{},"f:apiVersion":{},"f:blockOwnerDeletion":{},"f:controller":{},"f:kind":{},"f:name":{},"f:uid":{}}}}}}]},"data":{"enabled_plugins":"[rabbitmq_peer_discovery_k8s,rabbitmq_prometheus,rabbitmq_management]."}}
2022/03/18 18:07:34 learn_server.go:291: [SIEVE-AFTER-READ]	Get	true	configmap	default	rabbitmq-cluster-server-conf	github.com/rabbitmq/cluster-operator/controllers.(*RabbitmqClusterReconciler)	NoError	{"kind":"ConfigMap","apiVersion":"v1","metadata":{"name":"rabbitmq-cluster-server-conf","namespace":"default","selfLink":"/api/v1/namespaces/default/configmaps/rabbitmq-cluster-server-conf","uid":"e4182078-d429-4baf-9021-72618c509ac5","resourceVersion":"1095","creationTimestamp":"2022-03-18T18:06:25Z","labels":{"app.kubernetes.io/component":"rabbitmq","app.kubernetes.io/name":"rabbitmq-cluster","app.kubernetes.io/part-of":"rabbitmq"},"ownerReferences":[{"apiVersion":"rabbitmq.com/v1beta1","kind":"RabbitmqCluster","name":"rabbitmq-cluster","uid":"3ecefa8a-1bec-48a7-9af4-dd0df3339101","controller":true,"blockOwnerDeletion":true}],"managedFields":[{"manager":"manager","operation":"Update","apiVersion":"v1","time":"2022-03-18T18:06:25Z","fieldsType":"FieldsV1","fieldsV1":{"f:data":{".":{},"f:operatorDefaults.conf":{},"f:userDefinedConfiguration.conf":{}},"f:metadata":{"f:labels":{".":{},"f:app.kubernetes.io/component":{},"f:app.kubernetes.io/name":{},"f:app.kubernetes.io/part-of":{}},"f:ownerReferences":{".":{},"k:{\"uid\":\"3ecefa8a-1bec-48a7-9af4-dd0df3339101\"}":{".":{},"f:apiVersion":{},"f:blockOwnerDeletion":{},"f:controller":{},"f:kind":{},"f:name":{},"f:uid":{}}}}}}]},"data":{"operatorDefaults.conf":"cluster_formation.peer_discovery_backend             = rabbit_peer_discovery_k8s\ncluster_formation.k8s.host                           = kubernetes.default\ncluster_formation.k8s.address_type                   = hostname\ncluster_partition_handling                           = pause_minority\nqueue_master_locator                                 = min-masters\ndisk_free_limit.absolute                             = 2GB\ncluster_formation.randomized_startup_delay_range.min = 5\ncluster_formation.randomized_startup_delay_range.max = 30\ncluster_name                                         = rabbitmq-cluster\n","userDefinedConfiguration.conf":"total_memory_available_override_value = 1717986919\n"}}
2022/03/18 18:07:34 learn_server.go:291: [SIEVE-AFTER-READ]	Get	true	serviceaccount	default	rabbitmq-cluster-server	github.com/rabbitmq/cluster-operator/controllers.(*RabbitmqClusterReconciler)	NoError	{"kind":"ServiceAccount","apiVersion":"v1","metadata":{"name":"rabbitmq-cluster-server","namespace":"default","selfLink":"/api/v1/namespaces/default/serviceaccounts/rabbitmq-cluster-server","uid":"0c3cead0-37dd-452b-b939-fe346a5dfdea","resourceVersion":"1102","creationTimestamp":"2022-03-18T18:06:25Z","labels":{"app.kubernetes.io/component":"rabbitmq","app.kubernetes.io/name":"rabbitmq-cluster","app.kubernetes.io/part-of":"rabbitmq"},"ownerReferences":[{"apiVersion":"rabbitmq.com/v1beta1","kind":"RabbitmqCluster","name":"rabbitmq-cluster","uid":"3ecefa8a-1bec-48a7-9af4-dd0df3339101","controller":true,"blockOwnerDeletion":true}],"managedFields":[{"manager":"kube-controller-manager","operation":"Update","apiVersion":"v1","time":"2022-03-18T18:06:25Z","fieldsType":"FieldsV1","fieldsV1":{"f:secrets":{".":{},"k:{\"name\":\"rabbitmq-cluster-server-token-v4wpv\"}":{".":{},"f:name":{}}}}},{"manager":"manager","operation":"Update","apiVersion":"v1","time":"2022-03-18T18:06:25Z","fieldsType":"FieldsV1","fieldsV1":{"f:metadata":{"f:labels":{".":{},"f:app.kubernetes.io/component":{},"f:app.kubernetes.io/name":{},"f:app.kubernetes.io/part-of":{}},"f:ownerReferences":{".":{},"k:{\"uid\":\"3ecefa8a-1bec-48a7-9af4-dd0df3339101\"}":{".":{},"f:apiVersion":{},"f:blockOwnerDeletion":{},"f:controller":{},"f:kind":{},"f:name":{},"f:uid":{}}}}}}]},"secrets":[{"name":"rabbitmq-cluster-server-token-v4wpv"}]}
2022/03/18 18:07:34 learn_server.go:291: [SIEVE-AFTER-READ]	Get	true	role	default	rabbitmq-cluster-peer-discovery	github.com/rabbitmq/cluster-operator/controllers.(*RabbitmqClusterReconciler)	NoError	{"kind":"Role","apiVersion":"rbac.authorization.k8s.io/v1","metadata":{"name":"rabbitmq-cluster-peer-discovery","namespace":"default","selfLink":"/apis/rbac.authorization.k8s.io/v1/namespaces/default/roles/rabbitmq-cluster-peer-discovery","uid":"ec9ac474-1880-43ed-af46-9ea5f46d6db4","resourceVersion":"1103","creationTimestamp":"2022-03-18T18:06:25Z","labels":{"app.kubernetes.io/component":"rabbitmq","app.kubernetes.io/name":"rabbitmq-cluster","app.kubernetes.io/part-of":"rabbitmq"},"ownerReferences":[{"apiVersion":"rabbitmq.com/v1beta1","kind":"RabbitmqCluster","name":"rabbitmq-cluster","uid":"3ecefa8a-1bec-48a7-9af4-dd0df3339101","controller":true,"blockOwnerDeletion":true}],"managedFields":[{"manager":"manager","operation":"Update","apiVersion":"rbac.authorization.k8s.io/v1","time":"2022-03-18T18:06:25Z","fieldsType":"FieldsV1","fieldsV1":{"f:metadata":{"f:labels":{".":{},"f:app.kubernetes.io/component":{},"f:app.kubernetes.io/name":{},"f:app.kubernetes.io/part-of":{}},"f:ownerReferences":{".":{},"k:{\"uid\":\"3ecefa8a-1bec-48a7-9af4-dd0df3339101\"}":{".":{},"f:apiVersion":{},"f:blockOwnerDeletion":{},"f:controller":{},"f:kind":{},"f:name":{},"f:uid":{}}}},"f:rules":{}}}]},"rules":[{"verbs":["get"],"apiGroups":[""],"resources":["endpoints"]},{"verbs":["create"],"apiGroups":[""],"resources":["events"]}]}
2022/03/18 18:07:34 learn_server.go:291: [SIEVE-AFTER-READ]	Get	true	rolebinding	default	rabbitmq-cluster-server	github.com/rabbitmq/cluster-operator/controllers.(*RabbitmqClusterReconciler)	NoError	{"kind":"RoleBinding","apiVersion":"rbac.authorization.k8s.io/v1","metadata":{"name":"rabbitmq-cluster-server","namespace":"default","selfLink":"/apis/rbac.authorization.k8s.io/v1/namespaces/default/rolebindings/rabbitmq-cluster-server","uid":"fe69a41c-8d28-4b84-a9f6-a9e6044d75ba","resourceVersion":"1105","creationTimestamp":"2022-03-18T18:06:25Z","labels":{"app.kubernetes.io/component":"rabbitmq","app.kubernetes.io/name":"rabbitmq-cluster","app.kubernetes.io/part-of":"rabbitmq"},"ownerReferences":[{"apiVersion":"rabbitmq.com/v1beta1","kind":"RabbitmqCluster","name":"rabbitmq-cluster","uid":"3ecefa8a-1bec-48a7-9af4-dd0df3339101","controller":true,"blockOwnerDeletion":true}],"managedFields":[{"manager":"manager","operation":"Update","apiVersion":"rbac.authorization.k8s.io/v1","time":"2022-03-18T18:06:25Z","fieldsType":"FieldsV1","fieldsV1":{"f:metadata":{"f:labels":{".":{},"f:app.kubernetes.io/component":{},"f:app.kubernetes.io/name":{},"f:app.kubernetes.io/part-of":{}},"f:ownerReferences":{".":{},"k:{\"uid\":\"3ecefa8a-1bec-48a7-9af4-dd0df3339101\"}":{".":{},"f:apiVersion":{},"f:blockOwnerDeletion":{},"f:controller":{},"f:kind":{},"f:name":{},"f:uid":{}}}},"f:roleRef":{"f:apiGroup":{},"f:kind":{},"f:name":{}},"f:subjects":{}}}]},"subjects":[{"kind":"ServiceAccount","name":"rabbitmq-cluster-server"}],"roleRef":{"apiGroup":"rbac.authorization.k8s.io","kind":"Role","name":"rabbitmq-cluster-peer-discovery"}}
2022/03/18 18:07:34 learn_server.go:291: [SIEVE-AFTER-READ]	Get	true	statefulset	default	rabbitmq-cluster-server	github.com/rabbitmq/cluster-operator/controllers.(*RabbitmqClusterReconciler)	NoError	{"kind":"StatefulSet","apiVersion":"apps/v1","metadata":{"name":"rabbitmq-cluster-server","namespace":"default","selfLink":"/apis/apps/v1/namespaces/default/statefulsets/rabbitmq-cluster-server","uid":"1d62d993-2c32-4da7-8884-e4cfad9e587d","resourceVersion":"1465","generation":1,"creationTimestamp":"2022-03-18T18:07:34Z","labels":{"app.kubernetes.io/component":"rabbitmq","app.kubernetes.io/name":"rabbitmq-cluster","app.kubernetes.io/part-of":"rabbitmq"},"annotations":{"rabbitmq.com/createdAt":"2022-03-18T18:07:34Z"},"ownerReferences":[{"apiVersion":"rabbitmq.com/v1beta1","kind":"RabbitmqCluster","name":"rabbitmq-cluster","uid":"3ecefa8a-1bec-48a7-9af4-dd0df3339101","controller":true,"blockOwnerDeletion":true}],"managedFields":[{"manager":"manager","operation":"Update","apiVersion":"apps/v1","time":"2022-03-18T18:07:34Z","fieldsType":"FieldsV1","fieldsV1":{"f:metadata":{"f:annotations":{".":{},"f:rabbitmq.com/createdAt":{}},"f:labels":{".":{},"f:app.kubernetes.io/component":{},"f:app.kubernetes.io/name":{},"f:app.kubernetes.io/part-of":{}},"f:ownerReferences":{".":{},"k:{\"uid\":\"3ecefa8a-1bec-48a7-9af4-dd0df3339101\"}":{".":{},"f:apiVersion":{},"f:blockOwnerDeletion":{},"f:controller":{},"f:kind":{},"f:name":{},"f:uid":{}}}},"f:spec":{"f:podManagementPolicy":{},"f:replicas":{},"f:revisionHistoryLimit":{},"f:selector":{"f:matchLabels":{".":{},"f:app.kubernetes.io/name":{}}},"f:serviceName":{},"f:template":{"f:metadata":{"f:annotations":{".":{},"f:prometheus.io/port":{},"f:prometheus.io/scrape":{}},"f:labels":{".":{},"f:app.kubernetes.io/component":{},"f:app.kubernetes.io/name":{},"f:app.kubernetes.io/part-of":{}}},"f:spec":{"f:automountServiceAccountToken":{},"f:containers":{"k:{\"name\":\"rabbitmq\"}":{".":{},"f:env":{".":{},"k:{\"name\":\"K8S_HOSTNAME_SUFFIX\"}":{".":{},"f:name":{},"f:value":{}},"k:{\"name\":\"K8S_SERVICE_NAME\"}":{".":{},"f:name":{},"f:value":{}},"k:{\"name\":\"MY_POD_NAME\"}":{".":{},"f:name":{},"f:valueFrom":{".":{},"f:fieldRef":{".":{},"f:apiVersion":{},"f:fieldPath":{}}}},"k:{\"name\":\"MY_POD_NAMESPACE\"}":{".":{},"f:name":{},"f:valueFrom":{".":{},"f:fieldRef":{".":{},"f:apiVersion":{},"f:fieldPath":{}}}},"k:{\"name\":\"RABBITMQ_ENABLED_PLUGINS_FILE\"}":{".":{},"f:name":{},"f:value":{}},"k:{\"name\":\"RABBITMQ_NODENAME\"}":{".":{},"f:name":{},"f:value":{}},"k:{\"name\":\"RABBITMQ_USE_LONGNAME\"}":{".":{},"f:name":{},"f:value":{}}},"f:image":{},"f:imagePullPolicy":{},"f:lifecycle":{".":{},"f:preStop":{".":{},"f:exec":{".":{},"f:command":{}}}},"f:name":{},"f:ports":{".":{},"k:{\"containerPort\":4369,\"protocol\":\"TCP\"}":{".":{},"f:containerPort":{},"f:name":{},"f:protocol":{}},"k:{\"containerPort\":5672,\"protocol\":\"TCP\"}":{".":{},"f:containerPort":{},"f:name":{},"f:protocol":{}},"k:{\"containerPort\":15672,\"protocol\":\"TCP\"}":{".":{},"f:containerPort":{},"f:name":{},"f:protocol":{}},"k:{\"containerPort\":15692,\"protocol\":\"TCP\"}":{".":{},"f:containerPort":{},"f:name":{},"f:protocol":{}}},"f:readinessProbe":{".":{},"f:failureThreshold":{},"f:initialDelaySeconds":{},"f:periodSeconds":{},"f:successThreshold":{},"f:tcpSocket":{".":{},"f:port":{}},"f:timeoutSeconds":{}},"f:resources":{".":{},"f:limits":{".":{},"f:cpu":{},"f:memory":{}},"f:requests":{".":{},"f:cpu":{},"f:memory":{}}},"f:terminationMessagePath":{},"f:terminationMessagePolicy":{},"f:volumeMounts":{".":{},"k:{\"mountPath\":\"/etc/pod-info/\"}":{".":{},"f:mountPath":{},"f:name":{}},"k:{\"mountPath\":\"/etc/rabbitmq/conf.d/10-operatorDefaults.conf\"}":{".":{},"f:mountPath":{},"f:name":{},"f:subPath":{}},"k:{\"mountPath\":\"/etc/rabbitmq/conf.d/11-default_user.conf\"}":{".":{},"f:mountPath":{},"f:name":{},"f:subPath":{}},"k:{\"mountPath\":\"/etc/rabbitmq/conf.d/90-userDefinedConfiguration.conf\"}":{".":{},"f:mountPath":{},"f:name":{},"f:subPath":{}},"k:{\"mountPath\":\"/operator\"}":{".":{},"f:mountPath":{},"f:name":{}},"k:{\"mountPath\":\"/var/lib/rabbitmq/\"}":{".":{},"f:mountPath":{},"f:name":{}},"k:{\"mountPath\":\"/var/lib/rabbitmq/mnesia/\"}":{".":{},"f:mountPath":{},"f:name":{}}}}},"f:dnsPolicy":{},"f:initContainers":{".":{},"k:{\"name\":\"setup-container\"}":{".":{},"f:command":{},"f:image":{},"f:imagePullPolicy":{},"f:name":{},"f:resources":{".":{},"f:limits":{".":{},"f:cpu":{},"f:memory":{}},"f:requests":{".":{},"f:cpu":{},"f:memory":{}}},"f:securityContext":{".":{},"f:capabilities":{".":{},"f:drop":{}},"f:runAsUser":{}},"f:terminationMessagePath":{},"f:terminationMessagePolicy":{},"f:volumeMounts":{".":{},"k:{\"mountPath\":\"/operator\"}":{".":{},"f:mountPath":{},"f:name":{}},"k:{\"mountPath\":\"/tmp/default_user.conf\"}":{".":{},"f:mountPath":{},"f:name":{},"f:subPath":{}},"k:{\"mountPath\":\"/tmp/erlang-cookie-secret/\"}":{".":{},"f:mountPath":{},"f:name":{}},"k:{\"mountPath\":\"/tmp/rabbitmq-plugins/\"}":{".":{},"f:mountPath":{},"f:name":{}},"k:{\"mountPath\":\"/var/lib/rabbitmq/\"}":{".":{},"f:mountPath":{},"f:name":{}},"k:{\"mountPath\":\"/var/lib/rabbitmq/mnesia/\"}":{".":{},"f:mountPath":{},"f:name":{}}}}},"f:restartPolicy":{},"f:schedulerName":{},"f:securityContext":{".":{},"f:fsGroup":{},"f:runAsGroup":{},"f:runAsUser":{}},"f:serviceAccount":{},"f:serviceAccountName":{},"f:terminationGracePeriodSeconds":{},"f:topologySpreadConstraints":{".":{},"k:{\"topologyKey\":\"topology.kubernetes.io/zone\",\"whenUnsatisfiable\":\"ScheduleAnyway\"}":{".":{},"f:labelSelector":{".":{},"f:matchLabels":{".":{},"f:app.kubernetes.io/name":{}}},"f:maxSkew":{},"f:topologyKey":{},"f:whenUnsatisfiable":{}}},"f:volumes":{".":{},"k:{\"name\":\"erlang-cookie-secret\"}":{".":{},"f:name":{},"f:secret":{".":{},"f:defaultMode":{},"f:secretName":{}}},"k:{\"name\":\"plugins-conf\"}":{".":{},"f:configMap":{".":{},"f:defaultMode":{},"f:name":{}},"f:name":{}},"k:{\"name\":\"pod-info\"}":{".":{},"f:downwardAPI":{".":{},"f:defaultMode":{},"f:items":{}},"f:name":{}},"k:{\"name\":\"rabbitmq-confd\"}":{".":{},"f:name":{},"f:projected":{".":{},"f:defaultMode":{},"f:sources":{}}},"k:{\"name\":\"rabbitmq-erlang-cookie\"}":{".":{},"f:emptyDir":{},"f:name":{}},"k:{\"name\":\"rabbitmq-plugins\"}":{".":{},"f:emptyDir":{},"f:name":{}}}}},"f:updateStrategy":{"f:rollingUpdate":{".":{},"f:partition":{}},"f:type":{}},"f:volumeClaimTemplates":{}}}}]},"spec":{"replicas":1,"selector":{"matchLabels":{"app.kubernetes.io/name":"rabbitmq-cluster"}},"template":{"metadata":{"creationTimestamp":null,"labels":{"app.kubernetes.io/component":"rabbitmq","app.kubernetes.io/name":"rabbitmq-cluster","app.kubernetes.io/part-of":"rabbitmq"},"annotations":{"prometheus.io/port":"15692","prometheus.io/scrape":"true"}},"spec":{"volumes":[{"name":"plugins-conf","configMap":{"name":"rabbitmq-cluster-plugins-conf","defaultMode":420}},{"name":"rabbitmq-confd","projected":{"sources":[{"secret":{"name":"rabbitmq-cluster-default-user","items":[{"key":"default_user.conf","path":"default_user.conf"}]}},{"configMap":{"name":"rabbitmq-cluster-server-conf","items":[{"key":"operatorDefaults.conf","path":"operatorDefaults.conf"},{"key":"userDefinedConfiguration.conf","path":"userDefinedConfiguration.conf"}]}}],"defaultMode":420}},{"name":"rabbitmq-erlang-cookie","emptyDir":{}},{"name":"erlang-cookie-secret","secret":{"secretName":"rabbitmq-cluster-erlang-cookie","defaultMode":420}},{"name":"rabbitmq-plugins","emptyDir":{}},{"name":"pod-info","downwardAPI":{"items":[{"path":"skipPreStopChecks","fieldRef":{"apiVersion":"v1","fieldPath":"metadata.labels['skipPreStopChecks']"}}],"defaultMode":420}}],"initContainers":[{"name":"setup-container","image":"rabbitmq:3.8.12-management","command":["sh","-c","cp /tmp/erlang-cookie-secret/.erlang.cookie /var/lib/rabbitmq/.erlang.cookie \u0026\u0026 chown 999:999 /var/lib/rabbitmq/.erlang.cookie \u0026\u0026 chmod 600 /var/lib/rabbitmq/.erlang.cookie ; cp /tmp/rabbitmq-plugins/enabled_plugins /operator/enabled_plugins \u0026\u0026 chown 999:999 /operator/enabled_plugins ; chown 999:999 /var/lib/rabbitmq/mnesia/ ; echo '[default]' \u003e /var/lib/rabbitmq/.rabbitmqadmin.conf \u0026\u0026 sed -e 's/default_user/username/' -e 's/default_pass/password/' /tmp/default_user.conf \u003e\u003e /var/lib/rabbitmq/.rabbitmqadmin.conf \u0026\u0026 chown 999:999 /var/lib/rabbitmq/.rabbitmqadmin.conf \u0026\u0026 chmod 600 /var/lib/rabbitmq/.rabbitmqadmin.conf"],"resources":{"limits":{"cpu":"100m","memory":"500Mi"},"requests":{"cpu":"100m","memory":"500Mi"}},"volumeMounts":[{"name":"plugins-conf","mountPath":"/tmp/rabbitmq-plugins/"},{"name":"rabbitmq-erlang-cookie","mountPath":"/var/lib/rabbitmq/"},{"name":"erlang-cookie-secret","mountPath":"/tmp/erlang-cookie-secret/"},{"name":"rabbitmq-plugins","mountPath":"/operator"},{"name":"persistence","mountPath":"/var/lib/rabbitmq/mnesia/"},{"name":"rabbitmq-confd","mountPath":"/tmp/default_user.conf","subPath":"default_user.conf"}],"terminationMessagePath":"/dev/termination-log","terminationMessagePolicy":"File","imagePullPolicy":"IfNotPresent","securityContext":{"capabilities":{"drop":["FSETID","KILL","SETGID","SETUID","SETPCAP","NET_BIND_SERVICE","NET_RAW","SYS_CHROOT","MKNOD","AUDIT_WRITE","SETFCAP"]},"runAsUser":0}}],"containers":[{"name":"rabbitmq","image":"rabbitmq:3.8.12-management","ports":[{"name":"epmd","containerPort":4369,"protocol":"TCP"},{"name":"amqp","containerPort":5672,"protocol":"TCP"},{"name":"management","containerPort":15672,"protocol":"TCP"},{"name":"prometheus","containerPort":15692,"protocol":"TCP"}],"env":[{"name":"MY_POD_NAME","valueFrom":{"fieldRef":{"apiVersion":"v1","fieldPath":"metadata.name"}}},{"name":"MY_POD_NAMESPACE","valueFrom":{"fieldRef":{"apiVersion":"v1","fieldPath":"metadata.namespace"}}},{"name":"RABBITMQ_ENABLED_PLUGINS_FILE","value":"/operator/enabled_plugins"},{"name":"K8S_SERVICE_NAME","value":"rabbitmq-cluster-nodes"},{"name":"RABBITMQ_USE_LONGNAME","value":"true"},{"name":"RABBITMQ_NODENAME","value":"rabbit@$(MY_POD_NAME).$(K8S_SERVICE_NAME).$(MY_POD_NAMESPACE)"},{"name":"K8S_HOSTNAME_SUFFIX","value":".$(K8S_SERVICE_NAME).$(MY_POD_NAMESPACE)"}],"resources":{"limits":{"cpu":"2","memory":"2Gi"},"requests":{"cpu":"1","memory":"2Gi"}},"volumeMounts":[{"name":"rabbitmq-erlang-cookie","mountPath":"/var/lib/rabbitmq/"},{"name":"persistence","mountPath":"/var/lib/rabbitmq/mnesia/"},{"name":"rabbitmq-plugins","mountPath":"/operator"},{"name":"rabbitmq-confd","mountPath":"/etc/rabbitmq/conf.d/10-operatorDefaults.conf","subPath":"operatorDefaults.conf"},{"name":"rabbitmq-confd","mountPath":"/etc/rabbitmq/conf.d/11-default_user.conf","subPath":"default_user.conf"},{"name":"rabbitmq-confd","mountPath":"/etc/rabbitmq/conf.d/90-userDefinedConfiguration.conf","subPath":"userDefinedConfiguration.conf"},{"name":"pod-info","mountPath":"/etc/pod-info/"}],"readinessProbe":{"tcpSocket":{"port":"amqp"},"initialDelaySeconds":10,"timeoutSeconds":5,"periodSeconds":10,"successThreshold":1,"failureThreshold":3},"lifecycle":{"preStop":{"exec":{"command":["/bin/bash","-c","if [ ! -z \"$(cat /etc/pod-info/skipPreStopChecks)\" ]; then exit 0; fi; rabbitmq-upgrade await_online_quorum_plus_one -t 604800; rabbitmq-upgrade await_online_synchronized_mirror -t 604800; rabbitmq-upgrade drain -t 604800"]}}},"terminationMessagePath":"/dev/termination-log","terminationMessagePolicy":"File","imagePullPolicy":"IfNotPresent"}],"restartPolicy":"Always","terminationGracePeriodSeconds":604800,"dnsPolicy":"ClusterFirst","serviceAccountName":"rabbitmq-cluster-server","serviceAccount":"rabbitmq-cluster-server","automountServiceAccountToken":true,"securityContext":{"runAsUser":999,"runAsGroup":999,"fsGroup":999},"schedulerName":"default-scheduler","topologySpreadConstraints":[{"maxSkew":1,"topologyKey":"topology.kubernetes.io/zone","whenUnsatisfiable":"ScheduleAnyway","labelSelector":{"matchLabels":{"app.kubernetes.io/name":"rabbitmq-cluster"}}}]}},"volumeClaimTemplates":[{"metadata":{"name":"persistence","namespace":"default","creationTimestamp":null,"labels":{"app.kubernetes.io/component":"rabbitmq","app.kubernetes.io/name":"rabbitmq-cluster","app.kubernetes.io/part-of":"rabbitmq"},"ownerReferences":[{"apiVersion":"rabbitmq.com/v1beta1","kind":"RabbitmqCluster","name":"rabbitmq-cluster","uid":"3ecefa8a-1bec-48a7-9af4-dd0df3339101","controller":true,"blockOwnerDeletion":false}]},"spec":{"accessModes":["ReadWriteOnce"],"resources":{"requests":{"storage":"15Gi"}},"volumeMode":"Filesystem"},"status":{"phase":"Pending"}}],"serviceName":"rabbitmq-cluster-nodes","podManagementPolicy":"Parallel","updateStrategy":{"type":"RollingUpdate","rollingUpdate":{"partition":0}},"revisionHistoryLimit":10},"status":{"replicas":0}}
2022/03/18 18:07:34 learn_server.go:291: [SIEVE-AFTER-READ]	Get	true	statefulset	default	rabbitmq-cluster-server	github.com/rabbitmq/cluster-operator/controllers.(*RabbitmqClusterReconciler)	NoError	{"kind":"StatefulSet","apiVersion":"apps/v1","metadata":{"name":"rabbitmq-cluster-server","namespace":"default","selfLink":"/apis/apps/v1/namespaces/default/statefulsets/rabbitmq-cluster-server","uid":"1d62d993-2c32-4da7-8884-e4cfad9e587d","resourceVersion":"1465","generation":1,"creationTimestamp":"2022-03-18T18:07:34Z","labels":{"app.kubernetes.io/component":"rabbitmq","app.kubernetes.io/name":"rabbitmq-cluster","app.kubernetes.io/part-of":"rabbitmq"},"annotations":{"rabbitmq.com/createdAt":"2022-03-18T18:07:34Z"},"ownerReferences":[{"apiVersion":"rabbitmq.com/v1beta1","kind":"RabbitmqCluster","name":"rabbitmq-cluster","uid":"3ecefa8a-1bec-48a7-9af4-dd0df3339101","controller":true,"blockOwnerDeletion":true}],"managedFields":[{"manager":"manager","operation":"Update","apiVersion":"apps/v1","time":"2022-03-18T18:07:34Z","fieldsType":"FieldsV1","fieldsV1":{"f:metadata":{"f:annotations":{".":{},"f:rabbitmq.com/createdAt":{}},"f:labels":{".":{},"f:app.kubernetes.io/component":{},"f:app.kubernetes.io/name":{},"f:app.kubernetes.io/part-of":{}},"f:ownerReferences":{".":{},"k:{\"uid\":\"3ecefa8a-1bec-48a7-9af4-dd0df3339101\"}":{".":{},"f:apiVersion":{},"f:blockOwnerDeletion":{},"f:controller":{},"f:kind":{},"f:name":{},"f:uid":{}}}},"f:spec":{"f:podManagementPolicy":{},"f:replicas":{},"f:revisionHistoryLimit":{},"f:selector":{"f:matchLabels":{".":{},"f:app.kubernetes.io/name":{}}},"f:serviceName":{},"f:template":{"f:metadata":{"f:annotations":{".":{},"f:prometheus.io/port":{},"f:prometheus.io/scrape":{}},"f:labels":{".":{},"f:app.kubernetes.io/component":{},"f:app.kubernetes.io/name":{},"f:app.kubernetes.io/part-of":{}}},"f:spec":{"f:automountServiceAccountToken":{},"f:containers":{"k:{\"name\":\"rabbitmq\"}":{".":{},"f:env":{".":{},"k:{\"name\":\"K8S_HOSTNAME_SUFFIX\"}":{".":{},"f:name":{},"f:value":{}},"k:{\"name\":\"K8S_SERVICE_NAME\"}":{".":{},"f:name":{},"f:value":{}},"k:{\"name\":\"MY_POD_NAME\"}":{".":{},"f:name":{},"f:valueFrom":{".":{},"f:fieldRef":{".":{},"f:apiVersion":{},"f:fieldPath":{}}}},"k:{\"name\":\"MY_POD_NAMESPACE\"}":{".":{},"f:name":{},"f:valueFrom":{".":{},"f:fieldRef":{".":{},"f:apiVersion":{},"f:fieldPath":{}}}},"k:{\"name\":\"RABBITMQ_ENABLED_PLUGINS_FILE\"}":{".":{},"f:name":{},"f:value":{}},"k:{\"name\":\"RABBITMQ_NODENAME\"}":{".":{},"f:name":{},"f:value":{}},"k:{\"name\":\"RABBITMQ_USE_LONGNAME\"}":{".":{},"f:name":{},"f:value":{}}},"f:image":{},"f:imagePullPolicy":{},"f:lifecycle":{".":{},"f:preStop":{".":{},"f:exec":{".":{},"f:command":{}}}},"f:name":{},"f:ports":{".":{},"k:{\"containerPort\":4369,\"protocol\":\"TCP\"}":{".":{},"f:containerPort":{},"f:name":{},"f:protocol":{}},"k:{\"containerPort\":5672,\"protocol\":\"TCP\"}":{".":{},"f:containerPort":{},"f:name":{},"f:protocol":{}},"k:{\"containerPort\":15672,\"protocol\":\"TCP\"}":{".":{},"f:containerPort":{},"f:name":{},"f:protocol":{}},"k:{\"containerPort\":15692,\"protocol\":\"TCP\"}":{".":{},"f:containerPort":{},"f:name":{},"f:protocol":{}}},"f:readinessProbe":{".":{},"f:failureThreshold":{},"f:initialDelaySeconds":{},"f:periodSeconds":{},"f:successThreshold":{},"f:tcpSocket":{".":{},"f:port":{}},"f:timeoutSeconds":{}},"f:resources":{".":{},"f:limits":{".":{},"f:cpu":{},"f:memory":{}},"f:requests":{".":{},"f:cpu":{},"f:memory":{}}},"f:terminationMessagePath":{},"f:terminationMessagePolicy":{},"f:volumeMounts":{".":{},"k:{\"mountPath\":\"/etc/pod-info/\"}":{".":{},"f:mountPath":{},"f:name":{}},"k:{\"mountPath\":\"/etc/rabbitmq/conf.d/10-operatorDefaults.conf\"}":{".":{},"f:mountPath":{},"f:name":{},"f:subPath":{}},"k:{\"mountPath\":\"/etc/rabbitmq/conf.d/11-default_user.conf\"}":{".":{},"f:mountPath":{},"f:name":{},"f:subPath":{}},"k:{\"mountPath\":\"/etc/rabbitmq/conf.d/90-userDefinedConfiguration.conf\"}":{".":{},"f:mountPath":{},"f:name":{},"f:subPath":{}},"k:{\"mountPath\":\"/operator\"}":{".":{},"f:mountPath":{},"f:name":{}},"k:{\"mountPath\":\"/var/lib/rabbitmq/\"}":{".":{},"f:mountPath":{},"f:name":{}},"k:{\"mountPath\":\"/var/lib/rabbitmq/mnesia/\"}":{".":{},"f:mountPath":{},"f:name":{}}}}},"f:dnsPolicy":{},"f:initContainers":{".":{},"k:{\"name\":\"setup-container\"}":{".":{},"f:command":{},"f:image":{},"f:imagePullPolicy":{},"f:name":{},"f:resources":{".":{},"f:limits":{".":{},"f:cpu":{},"f:memory":{}},"f:requests":{".":{},"f:cpu":{},"f:memory":{}}},"f:securityContext":{".":{},"f:capabilities":{".":{},"f:drop":{}},"f:runAsUser":{}},"f:terminationMessagePath":{},"f:terminationMessagePolicy":{},"f:volumeMounts":{".":{},"k:{\"mountPath\":\"/operator\"}":{".":{},"f:mountPath":{},"f:name":{}},"k:{\"mountPath\":\"/tmp/default_user.conf\"}":{".":{},"f:mountPath":{},"f:name":{},"f:subPath":{}},"k:{\"mountPath\":\"/tmp/erlang-cookie-secret/\"}":{".":{},"f:mountPath":{},"f:name":{}},"k:{\"mountPath\":\"/tmp/rabbitmq-plugins/\"}":{".":{},"f:mountPath":{},"f:name":{}},"k:{\"mountPath\":\"/var/lib/rabbitmq/\"}":{".":{},"f:mountPath":{},"f:name":{}},"k:{\"mountPath\":\"/var/lib/rabbitmq/mnesia/\"}":{".":{},"f:mountPath":{},"f:name":{}}}}},"f:restartPolicy":{},"f:schedulerName":{},"f:securityContext":{".":{},"f:fsGroup":{},"f:runAsGroup":{},"f:runAsUser":{}},"f:serviceAccount":{},"f:serviceAccountName":{},"f:terminationGracePeriodSeconds":{},"f:topologySpreadConstraints":{".":{},"k:{\"topologyKey\":\"topology.kubernetes.io/zone\",\"whenUnsatisfiable\":\"ScheduleAnyway\"}":{".":{},"f:labelSelector":{".":{},"f:matchLabels":{".":{},"f:app.kubernetes.io/name":{}}},"f:maxSkew":{},"f:topologyKey":{},"f:whenUnsatisfiable":{}}},"f:volumes":{".":{},"k:{\"name\":\"erlang-cookie-secret\"}":{".":{},"f:name":{},"f:secret":{".":{},"f:defaultMode":{},"f:secretName":{}}},"k:{\"name\":\"plugins-conf\"}":{".":{},"f:configMap":{".":{},"f:defaultMode":{},"f:name":{}},"f:name":{}},"k:{\"name\":\"pod-info\"}":{".":{},"f:downwardAPI":{".":{},"f:defaultMode":{},"f:items":{}},"f:name":{}},"k:{\"name\":\"rabbitmq-confd\"}":{".":{},"f:name":{},"f:projected":{".":{},"f:defaultMode":{},"f:sources":{}}},"k:{\"name\":\"rabbitmq-erlang-cookie\"}":{".":{},"f:emptyDir":{},"f:name":{}},"k:{\"name\":\"rabbitmq-plugins\"}":{".":{},"f:emptyDir":{},"f:name":{}}}}},"f:updateStrategy":{"f:rollingUpdate":{".":{},"f:partition":{}},"f:type":{}},"f:volumeClaimTemplates":{}}}}]},"spec":{"replicas":1,"selector":{"matchLabels":{"app.kubernetes.io/name":"rabbitmq-cluster"}},"template":{"metadata":{"creationTimestamp":null,"labels":{"app.kubernetes.io/component":"rabbitmq","app.kubernetes.io/name":"rabbitmq-cluster","app.kubernetes.io/part-of":"rabbitmq"},"annotations":{"prometheus.io/port":"15692","prometheus.io/scrape":"true"}},"spec":{"volumes":[{"name":"plugins-conf","configMap":{"name":"rabbitmq-cluster-plugins-conf","defaultMode":420}},{"name":"rabbitmq-confd","projected":{"sources":[{"secret":{"name":"rabbitmq-cluster-default-user","items":[{"key":"default_user.conf","path":"default_user.conf"}]}},{"configMap":{"name":"rabbitmq-cluster-server-conf","items":[{"key":"operatorDefaults.conf","path":"operatorDefaults.conf"},{"key":"userDefinedConfiguration.conf","path":"userDefinedConfiguration.conf"}]}}],"defaultMode":420}},{"name":"rabbitmq-erlang-cookie","emptyDir":{}},{"name":"erlang-cookie-secret","secret":{"secretName":"rabbitmq-cluster-erlang-cookie","defaultMode":420}},{"name":"rabbitmq-plugins","emptyDir":{}},{"name":"pod-info","downwardAPI":{"items":[{"path":"skipPreStopChecks","fieldRef":{"apiVersion":"v1","fieldPath":"metadata.labels['skipPreStopChecks']"}}],"defaultMode":420}}],"initContainers":[{"name":"setup-container","image":"rabbitmq:3.8.12-management","command":["sh","-c","cp /tmp/erlang-cookie-secret/.erlang.cookie /var/lib/rabbitmq/.erlang.cookie \u0026\u0026 chown 999:999 /var/lib/rabbitmq/.erlang.cookie \u0026\u0026 chmod 600 /var/lib/rabbitmq/.erlang.cookie ; cp /tmp/rabbitmq-plugins/enabled_plugins /operator/enabled_plugins \u0026\u0026 chown 999:999 /operator/enabled_plugins ; chown 999:999 /var/lib/rabbitmq/mnesia/ ; echo '[default]' \u003e /var/lib/rabbitmq/.rabbitmqadmin.conf \u0026\u0026 sed -e 's/default_user/username/' -e 's/default_pass/password/' /tmp/default_user.conf \u003e\u003e /var/lib/rabbitmq/.rabbitmqadmin.conf \u0026\u0026 chown 999:999 /var/lib/rabbitmq/.rabbitmqadmin.conf \u0026\u0026 chmod 600 /var/lib/rabbitmq/.rabbitmqadmin.conf"],"resources":{"limits":{"cpu":"100m","memory":"500Mi"},"requests":{"cpu":"100m","memory":"500Mi"}},"volumeMounts":[{"name":"plugins-conf","mountPath":"/tmp/rabbitmq-plugins/"},{"name":"rabbitmq-erlang-cookie","mountPath":"/var/lib/rabbitmq/"},{"name":"erlang-cookie-secret","mountPath":"/tmp/erlang-cookie-secret/"},{"name":"rabbitmq-plugins","mountPath":"/operator"},{"name":"persistence","mountPath":"/var/lib/rabbitmq/mnesia/"},{"name":"rabbitmq-confd","mountPath":"/tmp/default_user.conf","subPath":"default_user.conf"}],"terminationMessagePath":"/dev/termination-log","terminationMessagePolicy":"File","imagePullPolicy":"IfNotPresent","securityContext":{"capabilities":{"drop":["FSETID","KILL","SETGID","SETUID","SETPCAP","NET_BIND_SERVICE","NET_RAW","SYS_CHROOT","MKNOD","AUDIT_WRITE","SETFCAP"]},"runAsUser":0}}],"containers":[{"name":"rabbitmq","image":"rabbitmq:3.8.12-management","ports":[{"name":"epmd","containerPort":4369,"protocol":"TCP"},{"name":"amqp","containerPort":5672,"protocol":"TCP"},{"name":"management","containerPort":15672,"protocol":"TCP"},{"name":"prometheus","containerPort":15692,"protocol":"TCP"}],"env":[{"name":"MY_POD_NAME","valueFrom":{"fieldRef":{"apiVersion":"v1","fieldPath":"metadata.name"}}},{"name":"MY_POD_NAMESPACE","valueFrom":{"fieldRef":{"apiVersion":"v1","fieldPath":"metadata.namespace"}}},{"name":"RABBITMQ_ENABLED_PLUGINS_FILE","value":"/operator/enabled_plugins"},{"name":"K8S_SERVICE_NAME","value":"rabbitmq-cluster-nodes"},{"name":"RABBITMQ_USE_LONGNAME","value":"true"},{"name":"RABBITMQ_NODENAME","value":"rabbit@$(MY_POD_NAME).$(K8S_SERVICE_NAME).$(MY_POD_NAMESPACE)"},{"name":"K8S_HOSTNAME_SUFFIX","value":".$(K8S_SERVICE_NAME).$(MY_POD_NAMESPACE)"}],"resources":{"limits":{"cpu":"2","memory":"2Gi"},"requests":{"cpu":"1","memory":"2Gi"}},"volumeMounts":[{"name":"rabbitmq-erlang-cookie","mountPath":"/var/lib/rabbitmq/"},{"name":"persistence","mountPath":"/var/lib/rabbitmq/mnesia/"},{"name":"rabbitmq-plugins","mountPath":"/operator"},{"name":"rabbitmq-confd","mountPath":"/etc/rabbitmq/conf.d/10-operatorDefaults.conf","subPath":"operatorDefaults.conf"},{"name":"rabbitmq-confd","mountPath":"/etc/rabbitmq/conf.d/11-default_user.conf","subPath":"default_user.conf"},{"name":"rabbitmq-confd","mountPath":"/etc/rabbitmq/conf.d/90-userDefinedConfiguration.conf","subPath":"userDefinedConfiguration.conf"},{"name":"pod-info","mountPath":"/etc/pod-info/"}],"readinessProbe":{"tcpSocket":{"port":"amqp"},"initialDelaySeconds":10,"timeoutSeconds":5,"periodSeconds":10,"successThreshold":1,"failureThreshold":3},"lifecycle":{"preStop":{"exec":{"command":["/bin/bash","-c","if [ ! -z \"$(cat /etc/pod-info/skipPreStopChecks)\" ]; then exit 0; fi; rabbitmq-upgrade await_online_quorum_plus_one -t 604800; rabbitmq-upgrade await_online_synchronized_mirror -t 604800; rabbitmq-upgrade drain -t 604800"]}}},"terminationMessagePath":"/dev/termination-log","terminationMessagePolicy":"File","imagePullPolicy":"IfNotPresent"}],"restartPolicy":"Always","terminationGracePeriodSeconds":604800,"dnsPolicy":"ClusterFirst","serviceAccountName":"rabbitmq-cluster-server","serviceAccount":"rabbitmq-cluster-server","automountServiceAccountToken":true,"securityContext":{"runAsUser":999,"runAsGroup":999,"fsGroup":999},"schedulerName":"default-scheduler","topologySpreadConstraints":[{"maxSkew":1,"topologyKey":"topology.kubernetes.io/zone","whenUnsatisfiable":"ScheduleAnyway","labelSelector":{"matchLabels":{"app.kubernetes.io/name":"rabbitmq-cluster"}}}]}},"volumeClaimTemplates":[{"metadata":{"name":"persistence","namespace":"default","creationTimestamp":null,"labels":{"app.kubernetes.io/component":"rabbitmq","app.kubernetes.io/name":"rabbitmq-cluster","app.kubernetes.io/part-of":"rabbitmq"},"ownerReferences":[{"apiVersion":"rabbitmq.com/v1beta1","kind":"RabbitmqCluster","name":"rabbitmq-cluster","uid":"3ecefa8a-1bec-48a7-9af4-dd0df3339101","controller":true,"blockOwnerDeletion":false}]},"spec":{"accessModes":["ReadWriteOnce"],"resources":{"requests":{"storage":"15Gi"}},"volumeMode":"Filesystem"},"status":{"phase":"Pending"}}],"serviceName":"rabbitmq-cluster-nodes","podManagementPolicy":"Parallel","updateStrategy":{"type":"RollingUpdate","rollingUpdate":{"partition":0}},"revisionHistoryLimit":10},"status":{"replicas":0}}
2022/03/18 18:07:34 learn_server.go:256: [SIEVE-BEFORE-WRITE]	43
2022/03/18 18:07:34 learn_server.go:279: [SIEVE-BEFORE-HEAR]	33	Updated	statefulset	{"metadata":{"name":"rabbitmq-cluster-server","namespace":"default","selfLink":"/apis/apps/v1/namespaces/default/statefulsets/rabbitmq-cluster-server","uid":"1d62d993-2c32-4da7-8884-e4cfad9e587d","resourceVersion":"1474","generation":1,"creationTimestamp":"2022-03-18T18:07:34Z","labels":{"app.kubernetes.io/component":"rabbitmq","app.kubernetes.io/name":"rabbitmq-cluster","app.kubernetes.io/part-of":"rabbitmq"},"annotations":{"rabbitmq.com/createdAt":"2022-03-18T18:07:34Z"},"ownerReferences":[{"apiVersion":"rabbitmq.com/v1beta1","kind":"RabbitmqCluster","name":"rabbitmq-cluster","uid":"3ecefa8a-1bec-48a7-9af4-dd0df3339101","controller":true,"blockOwnerDeletion":true}],"managedFields":[{"manager":"kube-controller-manager","operation":"Update","apiVersion":"apps/v1","time":"2022-03-18T18:07:34Z","fieldsType":"FieldsV1","fieldsV1":{"f:status":{"f:collisionCount":{},"f:currentReplicas":{},"f:currentRevision":{},"f:observedGeneration":{},"f:readyReplicas":{},"f:replicas":{},"f:updateRevision":{},"f:updatedReplicas":{}}}},{"manager":"manager","operation":"Update","apiVersion":"apps/v1","time":"2022-03-18T18:07:34Z","fieldsType":"FieldsV1","fieldsV1":{"f:metadata":{"f:annotations":{".":{},"f:rabbitmq.com/createdAt":{}},"f:labels":{".":{},"f:app.kubernetes.io/component":{},"f:app.kubernetes.io/name":{},"f:app.kubernetes.io/part-of":{}},"f:ownerReferences":{".":{},"k:{\"uid\":\"3ecefa8a-1bec-48a7-9af4-dd0df3339101\"}":{".":{},"f:apiVersion":{},"f:blockOwnerDeletion":{},"f:controller":{},"f:kind":{},"f:name":{},"f:uid":{}}}},"f:spec":{"f:podManagementPolicy":{},"f:replicas":{},"f:revisionHistoryLimit":{},"f:selector":{"f:matchLabels":{".":{},"f:app.kubernetes.io/name":{}}},"f:serviceName":{},"f:template":{"f:metadata":{"f:annotations":{".":{},"f:prometheus.io/port":{},"f:prometheus.io/scrape":{}},"f:labels":{".":{},"f:app.kubernetes.io/component":{},"f:app.kubernetes.io/name":{},"f:app.kubernetes.io/part-of":{}}},"f:spec":{"f:automountServiceAccountToken":{},"f:containers":{"k:{\"name\":\"rabbitmq\"}":{".":{},"f:env":{".":{},"k:{\"name\":\"K8S_HOSTNAME_SUFFIX\"}":{".":{},"f:name":{},"f:value":{}},"k:{\"name\":\"K8S_SERVICE_NAME\"}":{".":{},"f:name":{},"f:value":{}},"k:{\"name\":\"MY_POD_NAME\"}":{".":{},"f:name":{},"f:valueFrom":{".":{},"f:fieldRef":{".":{},"f:apiVersion":{},"f:fieldPath":{}}}},"k:{\"name\":\"MY_POD_NAMESPACE\"}":{".":{},"f:name":{},"f:valueFrom":{".":{},"f:fieldRef":{".":{},"f:apiVersion":{},"f:fieldPath":{}}}},"k:{\"name\":\"RABBITMQ_ENABLED_PLUGINS_FILE\"}":{".":{},"f:name":{},"f:value":{}},"k:{\"name\":\"RABBITMQ_NODENAME\"}":{".":{},"f:name":{},"f:value":{}},"k:{\"name\":\"RABBITMQ_USE_LONGNAME\"}":{".":{},"f:name":{},"f:value":{}}},"f:image":{},"f:imagePullPolicy":{},"f:lifecycle":{".":{},"f:preStop":{".":{},"f:exec":{".":{},"f:command":{}}}},"f:name":{},"f:ports":{".":{},"k:{\"containerPort\":4369,\"protocol\":\"TCP\"}":{".":{},"f:containerPort":{},"f:name":{},"f:protocol":{}},"k:{\"containerPort\":5672,\"protocol\":\"TCP\"}":{".":{},"f:containerPort":{},"f:name":{},"f:protocol":{}},"k:{\"containerPort\":15672,\"protocol\":\"TCP\"}":{".":{},"f:containerPort":{},"f:name":{},"f:protocol":{}},"k:{\"containerPort\":15692,\"protocol\":\"TCP\"}":{".":{},"f:containerPort":{},"f:name":{},"f:protocol":{}}},"f:readinessProbe":{".":{},"f:failureThreshold":{},"f:initialDelaySeconds":{},"f:periodSeconds":{},"f:successThreshold":{},"f:tcpSocket":{".":{},"f:port":{}},"f:timeoutSeconds":{}},"f:resources":{".":{},"f:limits":{".":{},"f:cpu":{},"f:memory":{}},"f:requests":{".":{},"f:cpu":{},"f:memory":{}}},"f:terminationMessagePath":{},"f:terminationMessagePolicy":{},"f:volumeMounts":{".":{},"k:{\"mountPath\":\"/etc/pod-info/\"}":{".":{},"f:mountPath":{},"f:name":{}},"k:{\"mountPath\":\"/etc/rabbitmq/conf.d/10-operatorDefaults.conf\"}":{".":{},"f:mountPath":{},"f:name":{},"f:subPath":{}},"k:{\"mountPath\":\"/etc/rabbitmq/conf.d/11-default_user.conf\"}":{".":{},"f:mountPath":{},"f:name":{},"f:subPath":{}},"k:{\"mountPath\":\"/etc/rabbitmq/conf.d/90-userDefinedConfiguration.conf\"}":{".":{},"f:mountPath":{},"f:name":{},"f:subPath":{}},"k:{\"mountPath\":\"/operator\"}":{".":{},"f:mountPath":{},"f:name":{}},"k:{\"mountPath\":\"/var/lib/rabbitmq/\"}":{".":{},"f:mountPath":{},"f:name":{}},"k:{\"mountPath\":\"/var/lib/rabbitmq/mnesia/\"}":{".":{},"f:mountPath":{},"f:name":{}}}}},"f:dnsPolicy":{},"f:initContainers":{".":{},"k:{\"name\":\"setup-container\"}":{".":{},"f:command":{},"f:image":{},"f:imagePullPolicy":{},"f:name":{},"f:resources":{".":{},"f:limits":{".":{},"f:cpu":{},"f:memory":{}},"f:requests":{".":{},"f:cpu":{},"f:memory":{}}},"f:securityContext":{".":{},"f:capabilities":{".":{},"f:drop":{}},"f:runAsUser":{}},"f:terminationMessagePath":{},"f:terminationMessagePolicy":{},"f:volumeMounts":{".":{},"k:{\"mountPath\":\"/operator\"}":{".":{},"f:mountPath":{},"f:name":{}},"k:{\"mountPath\":\"/tmp/default_user.conf\"}":{".":{},"f:mountPath":{},"f:name":{},"f:subPath":{}},"k:{\"mountPath\":\"/tmp/erlang-cookie-secret/\"}":{".":{},"f:mountPath":{},"f:name":{}},"k:{\"mountPath\":\"/tmp/rabbitmq-plugins/\"}":{".":{},"f:mountPath":{},"f:name":{}},"k:{\"mountPath\":\"/var/lib/rabbitmq/\"}":{".":{},"f:mountPath":{},"f:name":{}},"k:{\"mountPath\":\"/var/lib/rabbitmq/mnesia/\"}":{".":{},"f:mountPath":{},"f:name":{}}}}},"f:restartPolicy":{},"f:schedulerName":{},"f:securityContext":{".":{},"f:fsGroup":{},"f:runAsGroup":{},"f:runAsUser":{}},"f:serviceAccount":{},"f:serviceAccountName":{},"f:terminationGracePeriodSeconds":{},"f:topologySpreadConstraints":{".":{},"k:{\"topologyKey\":\"topology.kubernetes.io/zone\",\"whenUnsatisfiable\":\"ScheduleAnyway\"}":{".":{},"f:labelSelector":{".":{},"f:matchLabels":{".":{},"f:app.kubernetes.io/name":{}}},"f:maxSkew":{},"f:topologyKey":{},"f:whenUnsatisfiable":{}}},"f:volumes":{".":{},"k:{\"name\":\"erlang-cookie-secret\"}":{".":{},"f:name":{},"f:secret":{".":{},"f:defaultMode":{},"f:secretName":{}}},"k:{\"name\":\"plugins-conf\"}":{".":{},"f:configMap":{".":{},"f:defaultMode":{},"f:name":{}},"f:name":{}},"k:{\"name\":\"pod-info\"}":{".":{},"f:downwardAPI":{".":{},"f:defaultMode":{},"f:items":{}},"f:name":{}},"k:{\"name\":\"rabbitmq-confd\"}":{".":{},"f:name":{},"f:projected":{".":{},"f:defaultMode":{},"f:sources":{}}},"k:{\"name\":\"rabbitmq-erlang-cookie\"}":{".":{},"f:emptyDir":{},"f:name":{}},"k:{\"name\":\"rabbitmq-plugins\"}":{".":{},"f:emptyDir":{},"f:name":{}}}}},"f:updateStrategy":{"f:rollingUpdate":{".":{},"f:partition":{}},"f:type":{}},"f:volumeClaimTemplates":{}}}}]},"spec":{"replicas":1,"selector":{"matchLabels":{"app.kubernetes.io/name":"rabbitmq-cluster"}},"template":{"metadata":{"creationTimestamp":null,"labels":{"app.kubernetes.io/component":"rabbitmq","app.kubernetes.io/name":"rabbitmq-cluster","app.kubernetes.io/part-of":"rabbitmq"},"annotations":{"prometheus.io/port":"15692","prometheus.io/scrape":"true"}},"spec":{"volumes":[{"name":"plugins-conf","configMap":{"name":"rabbitmq-cluster-plugins-conf","defaultMode":420}},{"name":"rabbitmq-confd","projected":{"sources":[{"secret":{"name":"rabbitmq-cluster-default-user","items":[{"key":"default_user.conf","path":"default_user.conf"}]}},{"configMap":{"name":"rabbitmq-cluster-server-conf","items":[{"key":"operatorDefaults.conf","path":"operatorDefaults.conf"},{"key":"userDefinedConfiguration.conf","path":"userDefinedConfiguration.conf"}]}}],"defaultMode":420}},{"name":"rabbitmq-erlang-cookie","emptyDir":{}},{"name":"erlang-cookie-secret","secret":{"secretName":"rabbitmq-cluster-erlang-cookie","defaultMode":420}},{"name":"rabbitmq-plugins","emptyDir":{}},{"name":"pod-info","downwardAPI":{"items":[{"path":"skipPreStopChecks","fieldRef":{"apiVersion":"v1","fieldPath":"metadata.labels['skipPreStopChecks']"}}],"defaultMode":420}}],"initContainers":[{"name":"setup-container","image":"rabbitmq:3.8.12-management","command":["sh","-c","cp /tmp/erlang-cookie-secret/.erlang.cookie /var/lib/rabbitmq/.erlang.cookie \u0026\u0026 chown 999:999 /var/lib/rabbitmq/.erlang.cookie \u0026\u0026 chmod 600 /var/lib/rabbitmq/.erlang.cookie ; cp /tmp/rabbitmq-plugins/enabled_plugins /operator/enabled_plugins \u0026\u0026 chown 999:999 /operator/enabled_plugins ; chown 999:999 /var/lib/rabbitmq/mnesia/ ; echo '[default]' \u003e /var/lib/rabbitmq/.rabbitmqadmin.conf \u0026\u0026 sed -e 's/default_user/username/' -e 's/default_pass/password/' /tmp/default_user.conf \u003e\u003e /var/lib/rabbitmq/.rabbitmqadmin.conf \u0026\u0026 chown 999:999 /var/lib/rabbitmq/.rabbitmqadmin.conf \u0026\u0026 chmod 600 /var/lib/rabbitmq/.rabbitmqadmin.conf"],"resources":{"limits":{"cpu":"100m","memory":"500Mi"},"requests":{"cpu":"100m","memory":"500Mi"}},"volumeMounts":[{"name":"plugins-conf","mountPath":"/tmp/rabbitmq-plugins/"},{"name":"rabbitmq-erlang-cookie","mountPath":"/var/lib/rabbitmq/"},{"name":"erlang-cookie-secret","mountPath":"/tmp/erlang-cookie-secret/"},{"name":"rabbitmq-plugins","mountPath":"/operator"},{"name":"persistence","mountPath":"/var/lib/rabbitmq/mnesia/"},{"name":"rabbitmq-confd","mountPath":"/tmp/default_user.conf","subPath":"default_user.conf"}],"terminationMessagePath":"/dev/termination-log","terminationMessagePolicy":"File","imagePullPolicy":"IfNotPresent","securityContext":{"capabilities":{"drop":["FSETID","KILL","SETGID","SETUID","SETPCAP","NET_BIND_SERVICE","NET_RAW","SYS_CHROOT","MKNOD","AUDIT_WRITE","SETFCAP"]},"runAsUser":0}}],"containers":[{"name":"rabbitmq","image":"rabbitmq:3.8.12-management","ports":[{"name":"epmd","containerPort":4369,"protocol":"TCP"},{"name":"amqp","containerPort":5672,"protocol":"TCP"},{"name":"management","containerPort":15672,"protocol":"TCP"},{"name":"prometheus","containerPort":15692,"protocol":"TCP"}],"env":[{"name":"MY_POD_NAME","valueFrom":{"fieldRef":{"apiVersion":"v1","fieldPath":"metadata.name"}}},{"name":"MY_POD_NAMESPACE","valueFrom":{"fieldRef":{"apiVersion":"v1","fieldPath":"metadata.namespace"}}},{"name":"RABBITMQ_ENABLED_PLUGINS_FILE","value":"/operator/enabled_plugins"},{"name":"K8S_SERVICE_NAME","value":"rabbitmq-cluster-nodes"},{"name":"RABBITMQ_USE_LONGNAME","value":"true"},{"name":"RABBITMQ_NODENAME","value":"rabbit@$(MY_POD_NAME).$(K8S_SERVICE_NAME).$(MY_POD_NAMESPACE)"},{"name":"K8S_HOSTNAME_SUFFIX","value":".$(K8S_SERVICE_NAME).$(MY_POD_NAMESPACE)"}],"resources":{"limits":{"cpu":"2","memory":"2Gi"},"requests":{"cpu":"1","memory":"2Gi"}},"volumeMounts":[{"name":"rabbitmq-erlang-cookie","mountPath":"/var/lib/rabbitmq/"},{"name":"persistence","mountPath":"/var/lib/rabbitmq/mnesia/"},{"name":"rabbitmq-plugins","mountPath":"/operator"},{"name":"rabbitmq-confd","mountPath":"/etc/rabbitmq/conf.d/10-operatorDefaults.conf","subPath":"operatorDefaults.conf"},{"name":"rabbitmq-confd","mountPath":"/etc/rabbitmq/conf.d/11-default_user.conf","subPath":"default_user.conf"},{"name":"rabbitmq-confd","mountPath":"/etc/rabbitmq/conf.d/90-userDefinedConfiguration.conf","subPath":"userDefinedConfiguration.conf"},{"name":"pod-info","mountPath":"/etc/pod-info/"}],"readinessProbe":{"tcpSocket":{"port":"amqp"},"initialDelaySeconds":10,"timeoutSeconds":5,"periodSeconds":10,"successThreshold":1,"failureThreshold":3},"lifecycle":{"preStop":{"exec":{"command":["/bin/bash","-c","if [ ! -z \"$(cat /etc/pod-info/skipPreStopChecks)\" ]; then exit 0; fi; rabbitmq-upgrade await_online_quorum_plus_one -t 604800; rabbitmq-upgrade await_online_synchronized_mirror -t 604800; rabbitmq-upgrade drain -t 604800"]}}},"terminationMessagePath":"/dev/termination-log","terminationMessagePolicy":"File","imagePullPolicy":"IfNotPresent"}],"restartPolicy":"Always","terminationGracePeriodSeconds":604800,"dnsPolicy":"ClusterFirst","serviceAccountName":"rabbitmq-cluster-server","serviceAccount":"rabbitmq-cluster-server","automountServiceAccountToken":true,"securityContext":{"runAsUser":999,"runAsGroup":999,"fsGroup":999},"schedulerName":"default-scheduler","topologySpreadConstraints":[{"maxSkew":1,"topologyKey":"topology.kubernetes.io/zone","whenUnsatisfiable":"ScheduleAnyway","labelSelector":{"matchLabels":{"app.kubernetes.io/name":"rabbitmq-cluster"}}}]}},"volumeClaimTemplates":[{"metadata":{"name":"persistence","namespace":"default","creationTimestamp":null,"labels":{"app.kubernetes.io/component":"rabbitmq","app.kubernetes.io/name":"rabbitmq-cluster","app.kubernetes.io/part-of":"rabbitmq"},"ownerReferences":[{"apiVersion":"rabbitmq.com/v1beta1","kind":"RabbitmqCluster","name":"rabbitmq-cluster","uid":"3ecefa8a-1bec-48a7-9af4-dd0df3339101","controller":true,"blockOwnerDeletion":false}]},"spec":{"accessModes":["ReadWriteOnce"],"resources":{"requests":{"storage":"15Gi"}},"volumeMode":"Filesystem"},"status":{"phase":"Pending"}}],"serviceName":"rabbitmq-cluster-nodes","podManagementPolicy":"Parallel","updateStrategy":{"type":"RollingUpdate","rollingUpdate":{"partition":0}},"revisionHistoryLimit":10},"status":{"observedGeneration":1,"replicas":1,"readyReplicas":1,"currentReplicas":1,"updatedReplicas":1,"currentRevision":"rabbitmq-cluster-server-5f8b8665fb","updateRevision":"rabbitmq-cluster-server-5f8b8665fb","collisionCount":0}}
2022/03/18 18:07:34 learn_server.go:289: [SIEVE-AFTER-HEAR]	33
2022/03/18 18:07:34 learn_server.go:263: [SIEVE-AFTER-WRITE]	43	Update	statefulset	github.com/rabbitmq/cluster-operator/controllers.(*RabbitmqClusterReconciler)	Conflict	{"kind":"StatefulSet","apiVersion":"apps/v1","metadata":{"name":"rabbitmq-cluster-server","namespace":"default","selfLink":"/apis/apps/v1/namespaces/default/statefulsets/rabbitmq-cluster-server","uid":"1d62d993-2c32-4da7-8884-e4cfad9e587d","resourceVersion":"1465","generation":1,"creationTimestamp":"2022-03-18T18:07:34Z","labels":{"app.kubernetes.io/component":"rabbitmq","app.kubernetes.io/name":"rabbitmq-cluster","app.kubernetes.io/part-of":"rabbitmq"},"annotations":{"rabbitmq.com/createdAt":"2022-03-18T18:07:34Z"},"ownerReferences":[{"apiVersion":"rabbitmq.com/v1beta1","kind":"RabbitmqCluster","name":"rabbitmq-cluster","uid":"3ecefa8a-1bec-48a7-9af4-dd0df3339101","controller":true,"blockOwnerDeletion":true}],"managedFields":[{"manager":"manager","operation":"Update","apiVersion":"apps/v1","time":"2022-03-18T18:07:34Z","fieldsType":"FieldsV1","fieldsV1":{"f:metadata":{"f:annotations":{".":{},"f:rabbitmq.com/createdAt":{}},"f:labels":{".":{},"f:app.kubernetes.io/component":{},"f:app.kubernetes.io/name":{},"f:app.kubernetes.io/part-of":{}},"f:ownerReferences":{".":{},"k:{\"uid\":\"3ecefa8a-1bec-48a7-9af4-dd0df3339101\"}":{".":{},"f:apiVersion":{},"f:blockOwnerDeletion":{},"f:controller":{},"f:kind":{},"f:name":{},"f:uid":{}}}},"f:spec":{"f:podManagementPolicy":{},"f:replicas":{},"f:revisionHistoryLimit":{},"f:selector":{"f:matchLabels":{".":{},"f:app.kubernetes.io/name":{}}},"f:serviceName":{},"f:template":{"f:metadata":{"f:annotations":{".":{},"f:prometheus.io/port":{},"f:prometheus.io/scrape":{}},"f:labels":{".":{},"f:app.kubernetes.io/component":{},"f:app.kubernetes.io/name":{},"f:app.kubernetes.io/part-of":{}}},"f:spec":{"f:automountServiceAccountToken":{},"f:containers":{"k:{\"name\":\"rabbitmq\"}":{".":{},"f:env":{".":{},"k:{\"name\":\"K8S_HOSTNAME_SUFFIX\"}":{".":{},"f:name":{},"f:value":{}},"k:{\"name\":\"K8S_SERVICE_NAME\"}":{".":{},"f:name":{},"f:value":{}},"k:{\"name\":\"MY_POD_NAME\"}":{".":{},"f:name":{},"f:valueFrom":{".":{},"f:fieldRef":{".":{},"f:apiVersion":{},"f:fieldPath":{}}}},"k:{\"name\":\"MY_POD_NAMESPACE\"}":{".":{},"f:name":{},"f:valueFrom":{".":{},"f:fieldRef":{".":{},"f:apiVersion":{},"f:fieldPath":{}}}},"k:{\"name\":\"RABBITMQ_ENABLED_PLUGINS_FILE\"}":{".":{},"f:name":{},"f:value":{}},"k:{\"name\":\"RABBITMQ_NODENAME\"}":{".":{},"f:name":{},"f:value":{}},"k:{\"name\":\"RABBITMQ_USE_LONGNAME\"}":{".":{},"f:name":{},"f:value":{}}},"f:image":{},"f:imagePullPolicy":{},"f:lifecycle":{".":{},"f:preStop":{".":{},"f:exec":{".":{},"f:command":{}}}},"f:name":{},"f:ports":{".":{},"k:{\"containerPort\":4369,\"protocol\":\"TCP\"}":{".":{},"f:containerPort":{},"f:name":{},"f:protocol":{}},"k:{\"containerPort\":5672,\"protocol\":\"TCP\"}":{".":{},"f:containerPort":{},"f:name":{},"f:protocol":{}},"k:{\"containerPort\":15672,\"protocol\":\"TCP\"}":{".":{},"f:containerPort":{},"f:name":{},"f:protocol":{}},"k:{\"containerPort\":15692,\"protocol\":\"TCP\"}":{".":{},"f:containerPort":{},"f:name":{},"f:protocol":{}}},"f:readinessProbe":{".":{},"f:failureThreshold":{},"f:initialDelaySeconds":{},"f:periodSeconds":{},"f:successThreshold":{},"f:tcpSocket":{".":{},"f:port":{}},"f:timeoutSeconds":{}},"f:resources":{".":{},"f:limits":{".":{},"f:cpu":{},"f:memory":{}},"f:requests":{".":{},"f:cpu":{},"f:memory":{}}},"f:terminationMessagePath":{},"f:terminationMessagePolicy":{},"f:volumeMounts":{".":{},"k:{\"mountPath\":\"/etc/pod-info/\"}":{".":{},"f:mountPath":{},"f:name":{}},"k:{\"mountPath\":\"/etc/rabbitmq/conf.d/10-operatorDefaults.conf\"}":{".":{},"f:mountPath":{},"f:name":{},"f:subPath":{}},"k:{\"mountPath\":\"/etc/rabbitmq/conf.d/11-default_user.conf\"}":{".":{},"f:mountPath":{},"f:name":{},"f:subPath":{}},"k:{\"mountPath\":\"/etc/rabbitmq/conf.d/90-userDefinedConfiguration.conf\"}":{".":{},"f:mountPath":{},"f:name":{},"f:subPath":{}},"k:{\"mountPath\":\"/operator\"}":{".":{},"f:mountPath":{},"f:name":{}},"k:{\"mountPath\":\"/var/lib/rabbitmq/\"}":{".":{},"f:mountPath":{},"f:name":{}},"k:{\"mountPath\":\"/var/lib/rabbitmq/mnesia/\"}":{".":{},"f:mountPath":{},"f:name":{}}}}},"f:dnsPolicy":{},"f:initContainers":{".":{},"k:{\"name\":\"setup-container\"}":{".":{},"f:command":{},"f:image":{},"f:imagePullPolicy":{},"f:name":{},"f:resources":{".":{},"f:limits":{".":{},"f:cpu":{},"f:memory":{}},"f:requests":{".":{},"f:cpu":{},"f:memory":{}}},"f:securityContext":{".":{},"f:capabilities":{".":{},"f:drop":{}},"f:runAsUser":{}},"f:terminationMessagePath":{},"f:terminationMessagePolicy":{},"f:volumeMounts":{".":{},"k:{\"mountPath\":\"/operator\"}":{".":{},"f:mountPath":{},"f:name":{}},"k:{\"mountPath\":\"/tmp/default_user.conf\"}":{".":{},"f:mountPath":{},"f:name":{},"f:subPath":{}},"k:{\"mountPath\":\"/tmp/erlang-cookie-secret/\"}":{".":{},"f:mountPath":{},"f:name":{}},"k:{\"mountPath\":\"/tmp/rabbitmq-plugins/\"}":{".":{},"f:mountPath":{},"f:name":{}},"k:{\"mountPath\":\"/var/lib/rabbitmq/\"}":{".":{},"f:mountPath":{},"f:name":{}},"k:{\"mountPath\":\"/var/lib/rabbitmq/mnesia/\"}":{".":{},"f:mountPath":{},"f:name":{}}}}},"f:restartPolicy":{},"f:schedulerName":{},"f:securityContext":{".":{},"f:fsGroup":{},"f:runAsGroup":{},"f:runAsUser":{}},"f:serviceAccount":{},"f:serviceAccountName":{},"f:terminationGracePeriodSeconds":{},"f:topologySpreadConstraints":{".":{},"k:{\"topologyKey\":\"topology.kubernetes.io/zone\",\"whenUnsatisfiable\":\"ScheduleAnyway\"}":{".":{},"f:labelSelector":{".":{},"f:matchLabels":{".":{},"f:app.kubernetes.io/name":{}}},"f:maxSkew":{},"f:topologyKey":{},"f:whenUnsatisfiable":{}}},"f:volumes":{".":{},"k:{\"name\":\"erlang-cookie-secret\"}":{".":{},"f:name":{},"f:secret":{".":{},"f:defaultMode":{},"f:secretName":{}}},"k:{\"name\":\"plugins-conf\"}":{".":{},"f:configMap":{".":{},"f:defaultMode":{},"f:name":{}},"f:name":{}},"k:{\"name\":\"pod-info\"}":{".":{},"f:downwardAPI":{".":{},"f:defaultMode":{},"f:items":{}},"f:name":{}},"k:{\"name\":\"rabbitmq-confd\"}":{".":{},"f:name":{},"f:projected":{".":{},"f:defaultMode":{},"f:sources":{}}},"k:{\"name\":\"rabbitmq-erlang-cookie\"}":{".":{},"f:emptyDir":{},"f:name":{}},"k:{\"name\":\"rabbitmq-plugins\"}":{".":{},"f:emptyDir":{},"f:name":{}}}}},"f:updateStrategy":{"f:rollingUpdate":{".":{},"f:partition":{}},"f:type":{}},"f:volumeClaimTemplates":{}}}}]},"spec":{"replicas":1,"selector":{"matchLabels":{"app.kubernetes.io/name":"rabbitmq-cluster"}},"template":{"metadata":{"creationTimestamp":null,"labels":{"app.kubernetes.io/component":"rabbitmq","app.kubernetes.io/name":"rabbitmq-cluster","app.kubernetes.io/part-of":"rabbitmq"},"annotations":{"prometheus.io/port":"15692","prometheus.io/scrape":"true"}},"spec":{"volumes":[{"name":"plugins-conf","configMap":{"name":"rabbitmq-cluster-plugins-conf"}},{"name":"rabbitmq-confd","projected":{"sources":[{"secret":{"name":"rabbitmq-cluster-default-user","items":[{"key":"default_user.conf","path":"default_user.conf"}]}},{"configMap":{"name":"rabbitmq-cluster-server-conf","items":[{"key":"operatorDefaults.conf","path":"operatorDefaults.conf"},{"key":"userDefinedConfiguration.conf","path":"userDefinedConfiguration.conf"}]}}]}},{"name":"rabbitmq-erlang-cookie","emptyDir":{}},{"name":"erlang-cookie-secret","secret":{"secretName":"rabbitmq-cluster-erlang-cookie"}},{"name":"rabbitmq-plugins","emptyDir":{}},{"name":"pod-info","downwardAPI":{"items":[{"path":"skipPreStopChecks","fieldRef":{"fieldPath":"metadata.labels['skipPreStopChecks']"}}]}}],"initContainers":[{"name":"setup-container","image":"rabbitmq:3.8.12-management","command":["sh","-c","cp /tmp/erlang-cookie-secret/.erlang.cookie /var/lib/rabbitmq/.erlang.cookie \u0026\u0026 chown 999:999 /var/lib/rabbitmq/.erlang.cookie \u0026\u0026 chmod 600 /var/lib/rabbitmq/.erlang.cookie ; cp /tmp/rabbitmq-plugins/enabled_plugins /operator/enabled_plugins \u0026\u0026 chown 999:999 /operator/enabled_plugins ; chown 999:999 /var/lib/rabbitmq/mnesia/ ; echo '[default]' \u003e /var/lib/rabbitmq/.rabbitmqadmin.conf \u0026\u0026 sed -e 's/default_user/username/' -e 's/default_pass/password/' /tmp/default_user.conf \u003e\u003e /var/lib/rabbitmq/.rabbitmqadmin.conf \u0026\u0026 chown 999:999 /var/lib/rabbitmq/.rabbitmqadmin.conf \u0026\u0026 chmod 600 /var/lib/rabbitmq/.rabbitmqadmin.conf"],"resources":{"limits":{"cpu":"100m","memory":"500Mi"},"requests":{"cpu":"100m","memory":"500Mi"}},"volumeMounts":[{"name":"plugins-conf","mountPath":"/tmp/rabbitmq-plugins/"},{"name":"rabbitmq-erlang-cookie","mountPath":"/var/lib/rabbitmq/"},{"name":"erlang-cookie-secret","mountPath":"/tmp/erlang-cookie-secret/"},{"name":"rabbitmq-plugins","mountPath":"/operator"},{"name":"persistence","mountPath":"/var/lib/rabbitmq/mnesia/"},{"name":"rabbitmq-confd","mountPath":"/tmp/default_user.conf","subPath":"default_user.conf"}],"securityContext":{"capabilities":{"drop":["FSETID","KILL","SETGID","SETUID","SETPCAP","NET_BIND_SERVICE","NET_RAW","SYS_CHROOT","MKNOD","AUDIT_WRITE","SETFCAP"]},"runAsUser":0}}],"containers":[{"name":"rabbitmq","image":"rabbitmq:3.8.12-management","ports":[{"name":"epmd","containerPort":4369},{"name":"amqp","containerPort":5672},{"name":"management","containerPort":15672},{"name":"prometheus","containerPort":15692}],"env":[{"name":"MY_POD_NAME","valueFrom":{"fieldRef":{"apiVersion":"v1","fieldPath":"metadata.name"}}},{"name":"MY_POD_NAMESPACE","valueFrom":{"fieldRef":{"apiVersion":"v1","fieldPath":"metadata.namespace"}}},{"name":"RABBITMQ_ENABLED_PLUGINS_FILE","value":"/operator/enabled_plugins"},{"name":"K8S_SERVICE_NAME","value":"rabbitmq-cluster-nodes"},{"name":"RABBITMQ_USE_LONGNAME","value":"true"},{"name":"RABBITMQ_NODENAME","value":"rabbit@$(MY_POD_NAME).$(K8S_SERVICE_NAME).$(MY_POD_NAMESPACE)"},{"name":"K8S_HOSTNAME_SUFFIX","value":".$(K8S_SERVICE_NAME).$(MY_POD_NAMESPACE)"}],"resources":{"limits":{"cpu":"2","memory":"2Gi"},"requests":{"cpu":"1","memory":"2Gi"}},"volumeMounts":[{"name":"rabbitmq-erlang-cookie","mountPath":"/var/lib/rabbitmq/"},{"name":"persistence","mountPath":"/var/lib/rabbitmq/mnesia/"},{"name":"rabbitmq-plugins","mountPath":"/operator"},{"name":"rabbitmq-confd","mountPath":"/etc/rabbitmq/conf.d/10-operatorDefaults.conf","subPath":"operatorDefaults.conf"},{"name":"rabbitmq-confd","mountPath":"/etc/rabbitmq/conf.d/11-default_user.conf","subPath":"default_user.conf"},{"name":"rabbitmq-confd","mountPath":"/etc/rabbitmq/conf.d/90-userDefinedConfiguration.conf","subPath":"userDefinedConfiguration.conf"},{"name":"pod-info","mountPath":"/etc/pod-info/"}],"readinessProbe":{"tcpSocket":{"port":"amqp"},"initialDelaySeconds":10,"timeoutSeconds":5,"periodSeconds":10,"successThreshold":1,"failureThreshold":3},"lifecycle":{"preStop":{"exec":{"command":["/bin/bash","-c","if [ ! -z \"$(cat /etc/pod-info/skipPreStopChecks)\" ]; then exit 0; fi; rabbitmq-upgrade await_online_quorum_plus_one -t 604800; rabbitmq-upgrade await_online_synchronized_mirror -t 604800; rabbitmq-upgrade drain -t 604800"]}}}}],"terminationGracePeriodSeconds":604800,"serviceAccountName":"rabbitmq-cluster-server","automountServiceAccountToken":true,"securityContext":{"runAsUser":999,"runAsGroup":999,"fsGroup":999},"topologySpreadConstraints":[{"maxSkew":1,"topologyKey":"topology.kubernetes.io/zone","whenUnsatisfiable":"ScheduleAnyway","labelSelector":{"matchLabels":{"app.kubernetes.io/name":"rabbitmq-cluster"}}}]}},"volumeClaimTemplates":[{"metadata":{"name":"persistence","namespace":"default","creationTimestamp":null,"labels":{"app.kubernetes.io/component":"rabbitmq","app.kubernetes.io/name":"rabbitmq-cluster","app.kubernetes.io/part-of":"rabbitmq"},"ownerReferences":[{"apiVersion":"rabbitmq.com/v1beta1","kind":"RabbitmqCluster","name":"rabbitmq-cluster","uid":"3ecefa8a-1bec-48a7-9af4-dd0df3339101","controller":true,"blockOwnerDeletion":false}]},"spec":{"accessModes":["ReadWriteOnce"],"resources":{"requests":{"storage":"15Gi"}},"volumeMode":"Filesystem"},"status":{"phase":"Pending"}}],"serviceName":"rabbitmq-cluster-nodes","podManagementPolicy":"Parallel","updateStrategy":{"type":"RollingUpdate","rollingUpdate":{"partition":0}},"revisionHistoryLimit":10},"status":{"replicas":0}}
2022/03/18 18:07:34 learn_server.go:291: [SIEVE-AFTER-READ]	Get	true	statefulset	default	rabbitmq-cluster-server	github.com/rabbitmq/cluster-operator/controllers.(*RabbitmqClusterReconciler)	NoError	{"kind":"StatefulSet","apiVersion":"apps/v1","metadata":{"name":"rabbitmq-cluster-server","namespace":"default","selfLink":"/apis/apps/v1/namespaces/default/statefulsets/rabbitmq-cluster-server","uid":"1d62d993-2c32-4da7-8884-e4cfad9e587d","resourceVersion":"1474","generation":1,"creationTimestamp":"2022-03-18T18:07:34Z","labels":{"app.kubernetes.io/component":"rabbitmq","app.kubernetes.io/name":"rabbitmq-cluster","app.kubernetes.io/part-of":"rabbitmq"},"annotations":{"rabbitmq.com/createdAt":"2022-03-18T18:07:34Z"},"ownerReferences":[{"apiVersion":"rabbitmq.com/v1beta1","kind":"RabbitmqCluster","name":"rabbitmq-cluster","uid":"3ecefa8a-1bec-48a7-9af4-dd0df3339101","controller":true,"blockOwnerDeletion":true}],"managedFields":[{"manager":"kube-controller-manager","operation":"Update","apiVersion":"apps/v1","time":"2022-03-18T18:07:34Z","fieldsType":"FieldsV1","fieldsV1":{"f:status":{"f:collisionCount":{},"f:currentReplicas":{},"f:currentRevision":{},"f:observedGeneration":{},"f:readyReplicas":{},"f:replicas":{},"f:updateRevision":{},"f:updatedReplicas":{}}}},{"manager":"manager","operation":"Update","apiVersion":"apps/v1","time":"2022-03-18T18:07:34Z","fieldsType":"FieldsV1","fieldsV1":{"f:metadata":{"f:annotations":{".":{},"f:rabbitmq.com/createdAt":{}},"f:labels":{".":{},"f:app.kubernetes.io/component":{},"f:app.kubernetes.io/name":{},"f:app.kubernetes.io/part-of":{}},"f:ownerReferences":{".":{},"k:{\"uid\":\"3ecefa8a-1bec-48a7-9af4-dd0df3339101\"}":{".":{},"f:apiVersion":{},"f:blockOwnerDeletion":{},"f:controller":{},"f:kind":{},"f:name":{},"f:uid":{}}}},"f:spec":{"f:podManagementPolicy":{},"f:replicas":{},"f:revisionHistoryLimit":{},"f:selector":{"f:matchLabels":{".":{},"f:app.kubernetes.io/name":{}}},"f:serviceName":{},"f:template":{"f:metadata":{"f:annotations":{".":{},"f:prometheus.io/port":{},"f:prometheus.io/scrape":{}},"f:labels":{".":{},"f:app.kubernetes.io/component":{},"f:app.kubernetes.io/name":{},"f:app.kubernetes.io/part-of":{}}},"f:spec":{"f:automountServiceAccountToken":{},"f:containers":{"k:{\"name\":\"rabbitmq\"}":{".":{},"f:env":{".":{},"k:{\"name\":\"K8S_HOSTNAME_SUFFIX\"}":{".":{},"f:name":{},"f:value":{}},"k:{\"name\":\"K8S_SERVICE_NAME\"}":{".":{},"f:name":{},"f:value":{}},"k:{\"name\":\"MY_POD_NAME\"}":{".":{},"f:name":{},"f:valueFrom":{".":{},"f:fieldRef":{".":{},"f:apiVersion":{},"f:fieldPath":{}}}},"k:{\"name\":\"MY_POD_NAMESPACE\"}":{".":{},"f:name":{},"f:valueFrom":{".":{},"f:fieldRef":{".":{},"f:apiVersion":{},"f:fieldPath":{}}}},"k:{\"name\":\"RABBITMQ_ENABLED_PLUGINS_FILE\"}":{".":{},"f:name":{},"f:value":{}},"k:{\"name\":\"RABBITMQ_NODENAME\"}":{".":{},"f:name":{},"f:value":{}},"k:{\"name\":\"RABBITMQ_USE_LONGNAME\"}":{".":{},"f:name":{},"f:value":{}}},"f:image":{},"f:imagePullPolicy":{},"f:lifecycle":{".":{},"f:preStop":{".":{},"f:exec":{".":{},"f:command":{}}}},"f:name":{},"f:ports":{".":{},"k:{\"containerPort\":4369,\"protocol\":\"TCP\"}":{".":{},"f:containerPort":{},"f:name":{},"f:protocol":{}},"k:{\"containerPort\":5672,\"protocol\":\"TCP\"}":{".":{},"f:containerPort":{},"f:name":{},"f:protocol":{}},"k:{\"containerPort\":15672,\"protocol\":\"TCP\"}":{".":{},"f:containerPort":{},"f:name":{},"f:protocol":{}},"k:{\"containerPort\":15692,\"protocol\":\"TCP\"}":{".":{},"f:containerPort":{},"f:name":{},"f:protocol":{}}},"f:readinessProbe":{".":{},"f:failureThreshold":{},"f:initialDelaySeconds":{},"f:periodSeconds":{},"f:successThreshold":{},"f:tcpSocket":{".":{},"f:port":{}},"f:timeoutSeconds":{}},"f:resources":{".":{},"f:limits":{".":{},"f:cpu":{},"f:memory":{}},"f:requests":{".":{},"f:cpu":{},"f:memory":{}}},"f:terminationMessagePath":{},"f:terminationMessagePolicy":{},"f:volumeMounts":{".":{},"k:{\"mountPath\":\"/etc/pod-info/\"}":{".":{},"f:mountPath":{},"f:name":{}},"k:{\"mountPath\":\"/etc/rabbitmq/conf.d/10-operatorDefaults.conf\"}":{".":{},"f:mountPath":{},"f:name":{},"f:subPath":{}},"k:{\"mountPath\":\"/etc/rabbitmq/conf.d/11-default_user.conf\"}":{".":{},"f:mountPath":{},"f:name":{},"f:subPath":{}},"k:{\"mountPath\":\"/etc/rabbitmq/conf.d/90-userDefinedConfiguration.conf\"}":{".":{},"f:mountPath":{},"f:name":{},"f:subPath":{}},"k:{\"mountPath\":\"/operator\"}":{".":{},"f:mountPath":{},"f:name":{}},"k:{\"mountPath\":\"/var/lib/rabbitmq/\"}":{".":{},"f:mountPath":{},"f:name":{}},"k:{\"mountPath\":\"/var/lib/rabbitmq/mnesia/\"}":{".":{},"f:mountPath":{},"f:name":{}}}}},"f:dnsPolicy":{},"f:initContainers":{".":{},"k:{\"name\":\"setup-container\"}":{".":{},"f:command":{},"f:image":{},"f:imagePullPolicy":{},"f:name":{},"f:resources":{".":{},"f:limits":{".":{},"f:cpu":{},"f:memory":{}},"f:requests":{".":{},"f:cpu":{},"f:memory":{}}},"f:securityContext":{".":{},"f:capabilities":{".":{},"f:drop":{}},"f:runAsUser":{}},"f:terminationMessagePath":{},"f:terminationMessagePolicy":{},"f:volumeMounts":{".":{},"k:{\"mountPath\":\"/operator\"}":{".":{},"f:mountPath":{},"f:name":{}},"k:{\"mountPath\":\"/tmp/default_user.conf\"}":{".":{},"f:mountPath":{},"f:name":{},"f:subPath":{}},"k:{\"mountPath\":\"/tmp/erlang-cookie-secret/\"}":{".":{},"f:mountPath":{},"f:name":{}},"k:{\"mountPath\":\"/tmp/rabbitmq-plugins/\"}":{".":{},"f:mountPath":{},"f:name":{}},"k:{\"mountPath\":\"/var/lib/rabbitmq/\"}":{".":{},"f:mountPath":{},"f:name":{}},"k:{\"mountPath\":\"/var/lib/rabbitmq/mnesia/\"}":{".":{},"f:mountPath":{},"f:name":{}}}}},"f:restartPolicy":{},"f:schedulerName":{},"f:securityContext":{".":{},"f:fsGroup":{},"f:runAsGroup":{},"f:runAsUser":{}},"f:serviceAccount":{},"f:serviceAccountName":{},"f:terminationGracePeriodSeconds":{},"f:topologySpreadConstraints":{".":{},"k:{\"topologyKey\":\"topology.kubernetes.io/zone\",\"whenUnsatisfiable\":\"ScheduleAnyway\"}":{".":{},"f:labelSelector":{".":{},"f:matchLabels":{".":{},"f:app.kubernetes.io/name":{}}},"f:maxSkew":{},"f:topologyKey":{},"f:whenUnsatisfiable":{}}},"f:volumes":{".":{},"k:{\"name\":\"erlang-cookie-secret\"}":{".":{},"f:name":{},"f:secret":{".":{},"f:defaultMode":{},"f:secretName":{}}},"k:{\"name\":\"plugins-conf\"}":{".":{},"f:configMap":{".":{},"f:defaultMode":{},"f:name":{}},"f:name":{}},"k:{\"name\":\"pod-info\"}":{".":{},"f:downwardAPI":{".":{},"f:defaultMode":{},"f:items":{}},"f:name":{}},"k:{\"name\":\"rabbitmq-confd\"}":{".":{},"f:name":{},"f:projected":{".":{},"f:defaultMode":{},"f:sources":{}}},"k:{\"name\":\"rabbitmq-erlang-cookie\"}":{".":{},"f:emptyDir":{},"f:name":{}},"k:{\"name\":\"rabbitmq-plugins\"}":{".":{},"f:emptyDir":{},"f:name":{}}}}},"f:updateStrategy":{"f:rollingUpdate":{".":{},"f:partition":{}},"f:type":{}},"f:volumeClaimTemplates":{}}}}]},"spec":{"replicas":1,"selector":{"matchLabels":{"app.kubernetes.io/name":"rabbitmq-cluster"}},"template":{"metadata":{"creationTimestamp":null,"labels":{"app.kubernetes.io/component":"rabbitmq","app.kubernetes.io/name":"rabbitmq-cluster","app.kubernetes.io/part-of":"rabbitmq"},"annotations":{"prometheus.io/port":"15692","prometheus.io/scrape":"true"}},"spec":{"volumes":[{"name":"plugins-conf","configMap":{"name":"rabbitmq-cluster-plugins-conf","defaultMode":420}},{"name":"rabbitmq-confd","projected":{"sources":[{"secret":{"name":"rabbitmq-cluster-default-user","items":[{"key":"default_user.conf","path":"default_user.conf"}]}},{"configMap":{"name":"rabbitmq-cluster-server-conf","items":[{"key":"operatorDefaults.conf","path":"operatorDefaults.conf"},{"key":"userDefinedConfiguration.conf","path":"userDefinedConfiguration.conf"}]}}],"defaultMode":420}},{"name":"rabbitmq-erlang-cookie","emptyDir":{}},{"name":"erlang-cookie-secret","secret":{"secretName":"rabbitmq-cluster-erlang-cookie","defaultMode":420}},{"name":"rabbitmq-plugins","emptyDir":{}},{"name":"pod-info","downwardAPI":{"items":[{"path":"skipPreStopChecks","fieldRef":{"apiVersion":"v1","fieldPath":"metadata.labels['skipPreStopChecks']"}}],"defaultMode":420}}],"initContainers":[{"name":"setup-container","image":"rabbitmq:3.8.12-management","command":["sh","-c","cp /tmp/erlang-cookie-secret/.erlang.cookie /var/lib/rabbitmq/.erlang.cookie \u0026\u0026 chown 999:999 /var/lib/rabbitmq/.erlang.cookie \u0026\u0026 chmod 600 /var/lib/rabbitmq/.erlang.cookie ; cp /tmp/rabbitmq-plugins/enabled_plugins /operator/enabled_plugins \u0026\u0026 chown 999:999 /operator/enabled_plugins ; chown 999:999 /var/lib/rabbitmq/mnesia/ ; echo '[default]' \u003e /var/lib/rabbitmq/.rabbitmqadmin.conf \u0026\u0026 sed -e 's/default_user/username/' -e 's/default_pass/password/' /tmp/default_user.conf \u003e\u003e /var/lib/rabbitmq/.rabbitmqadmin.conf \u0026\u0026 chown 999:999 /var/lib/rabbitmq/.rabbitmqadmin.conf \u0026\u0026 chmod 600 /var/lib/rabbitmq/.rabbitmqadmin.conf"],"resources":{"limits":{"cpu":"100m","memory":"500Mi"},"requests":{"cpu":"100m","memory":"500Mi"}},"volumeMounts":[{"name":"plugins-conf","mountPath":"/tmp/rabbitmq-plugins/"},{"name":"rabbitmq-erlang-cookie","mountPath":"/var/lib/rabbitmq/"},{"name":"erlang-cookie-secret","mountPath":"/tmp/erlang-cookie-secret/"},{"name":"rabbitmq-plugins","mountPath":"/operator"},{"name":"persistence","mountPath":"/var/lib/rabbitmq/mnesia/"},{"name":"rabbitmq-confd","mountPath":"/tmp/default_user.conf","subPath":"default_user.conf"}],"terminationMessagePath":"/dev/termination-log","terminationMessagePolicy":"File","imagePullPolicy":"IfNotPresent","securityContext":{"capabilities":{"drop":["FSETID","KILL","SETGID","SETUID","SETPCAP","NET_BIND_SERVICE","NET_RAW","SYS_CHROOT","MKNOD","AUDIT_WRITE","SETFCAP"]},"runAsUser":0}}],"containers":[{"name":"rabbitmq","image":"rabbitmq:3.8.12-management","ports":[{"name":"epmd","containerPort":4369,"protocol":"TCP"},{"name":"amqp","containerPort":5672,"protocol":"TCP"},{"name":"management","containerPort":15672,"protocol":"TCP"},{"name":"prometheus","containerPort":15692,"protocol":"TCP"}],"env":[{"name":"MY_POD_NAME","valueFrom":{"fieldRef":{"apiVersion":"v1","fieldPath":"metadata.name"}}},{"name":"MY_POD_NAMESPACE","valueFrom":{"fieldRef":{"apiVersion":"v1","fieldPath":"metadata.namespace"}}},{"name":"RABBITMQ_ENABLED_PLUGINS_FILE","value":"/operator/enabled_plugins"},{"name":"K8S_SERVICE_NAME","value":"rabbitmq-cluster-nodes"},{"name":"RABBITMQ_USE_LONGNAME","value":"true"},{"name":"RABBITMQ_NODENAME","value":"rabbit@$(MY_POD_NAME).$(K8S_SERVICE_NAME).$(MY_POD_NAMESPACE)"},{"name":"K8S_HOSTNAME_SUFFIX","value":".$(K8S_SERVICE_NAME).$(MY_POD_NAMESPACE)"}],"resources":{"limits":{"cpu":"2","memory":"2Gi"},"requests":{"cpu":"1","memory":"2Gi"}},"volumeMounts":[{"name":"rabbitmq-erlang-cookie","mountPath":"/var/lib/rabbitmq/"},{"name":"persistence","mountPath":"/var/lib/rabbitmq/mnesia/"},{"name":"rabbitmq-plugins","mountPath":"/operator"},{"name":"rabbitmq-confd","mountPath":"/etc/rabbitmq/conf.d/10-operatorDefaults.conf","subPath":"operatorDefaults.conf"},{"name":"rabbitmq-confd","mountPath":"/etc/rabbitmq/conf.d/11-default_user.conf","subPath":"default_user.conf"},{"name":"rabbitmq-confd","mountPath":"/etc/rabbitmq/conf.d/90-userDefinedConfiguration.conf","subPath":"userDefinedConfiguration.conf"},{"name":"pod-info","mountPath":"/etc/pod-info/"}],"readinessProbe":{"tcpSocket":{"port":"amqp"},"initialDelaySeconds":10,"timeoutSeconds":5,"periodSeconds":10,"successThreshold":1,"failureThreshold":3},"lifecycle":{"preStop":{"exec":{"command":["/bin/bash","-c","if [ ! -z \"$(cat /etc/pod-info/skipPreStopChecks)\" ]; then exit 0; fi; rabbitmq-upgrade await_online_quorum_plus_one -t 604800; rabbitmq-upgrade await_online_synchronized_mirror -t 604800; rabbitmq-upgrade drain -t 604800"]}}},"terminationMessagePath":"/dev/termination-log","terminationMessagePolicy":"File","imagePullPolicy":"IfNotPresent"}],"restartPolicy":"Always","terminationGracePeriodSeconds":604800,"dnsPolicy":"ClusterFirst","serviceAccountName":"rabbitmq-cluster-server","serviceAccount":"rabbitmq-cluster-server","automountServiceAccountToken":true,"securityContext":{"runAsUser":999,"runAsGroup":999,"fsGroup":999},"schedulerName":"default-scheduler","topologySpreadConstraints":[{"maxSkew":1,"topologyKey":"topology.kubernetes.io/zone","whenUnsatisfiable":"ScheduleAnyway","labelSelector":{"matchLabels":{"app.kubernetes.io/name":"rabbitmq-cluster"}}}]}},"volumeClaimTemplates":[{"metadata":{"name":"persistence","namespace":"default","creationTimestamp":null,"labels":{"app.kubernetes.io/component":"rabbitmq","app.kubernetes.io/name":"rabbitmq-cluster","app.kubernetes.io/part-of":"rabbitmq"},"ownerReferences":[{"apiVersion":"rabbitmq.com/v1beta1","kind":"RabbitmqCluster","name":"rabbitmq-cluster","uid":"3ecefa8a-1bec-48a7-9af4-dd0df3339101","controller":true,"blockOwnerDeletion":false}]},"spec":{"accessModes":["ReadWriteOnce"],"resources":{"requests":{"storage":"15Gi"}},"volumeMode":"Filesystem"},"status":{"phase":"Pending"}}],"serviceName":"rabbitmq-cluster-nodes","podManagementPolicy":"Parallel","updateStrategy":{"type":"RollingUpdate","rollingUpdate":{"partition":0}},"revisionHistoryLimit":10},"status":{"observedGeneration":1,"replicas":1,"readyReplicas":1,"currentReplicas":1,"updatedReplicas":1,"currentRevision":"rabbitmq-cluster-server-5f8b8665fb","updateRevision":"rabbitmq-cluster-server-5f8b8665fb","collisionCount":0}}
2022/03/18 18:07:34 learn_server.go:256: [SIEVE-BEFORE-WRITE]	44
2022/03/18 18:07:34 learn_server.go:263: [SIEVE-AFTER-WRITE]	44	Update	statefulset	github.com/rabbitmq/cluster-operator/controllers.(*RabbitmqClusterReconciler)	NoError	{"metadata":{"name":"rabbitmq-cluster-server","namespace":"default","selfLink":"/apis/apps/v1/namespaces/default/statefulsets/rabbitmq-cluster-server","uid":"1d62d993-2c32-4da7-8884-e4cfad9e587d","resourceVersion":"1474","generation":1,"creationTimestamp":"2022-03-18T18:07:34Z","labels":{"app.kubernetes.io/component":"rabbitmq","app.kubernetes.io/name":"rabbitmq-cluster","app.kubernetes.io/part-of":"rabbitmq"},"annotations":{"rabbitmq.com/createdAt":"2022-03-18T18:07:34Z"},"ownerReferences":[{"apiVersion":"rabbitmq.com/v1beta1","kind":"RabbitmqCluster","name":"rabbitmq-cluster","uid":"3ecefa8a-1bec-48a7-9af4-dd0df3339101","controller":true,"blockOwnerDeletion":true}],"managedFields":[{"manager":"kube-controller-manager","operation":"Update","apiVersion":"apps/v1","time":"2022-03-18T18:07:34Z","fieldsType":"FieldsV1","fieldsV1":{"f:status":{"f:collisionCount":{},"f:currentReplicas":{},"f:currentRevision":{},"f:observedGeneration":{},"f:readyReplicas":{},"f:replicas":{},"f:updateRevision":{},"f:updatedReplicas":{}}}},{"manager":"manager","operation":"Update","apiVersion":"apps/v1","time":"2022-03-18T18:07:34Z","fieldsType":"FieldsV1","fieldsV1":{"f:metadata":{"f:annotations":{".":{},"f:rabbitmq.com/createdAt":{}},"f:labels":{".":{},"f:app.kubernetes.io/component":{},"f:app.kubernetes.io/name":{},"f:app.kubernetes.io/part-of":{}},"f:ownerReferences":{".":{},"k:{\"uid\":\"3ecefa8a-1bec-48a7-9af4-dd0df3339101\"}":{".":{},"f:apiVersion":{},"f:blockOwnerDeletion":{},"f:controller":{},"f:kind":{},"f:name":{},"f:uid":{}}}},"f:spec":{"f:podManagementPolicy":{},"f:replicas":{},"f:revisionHistoryLimit":{},"f:selector":{"f:matchLabels":{".":{},"f:app.kubernetes.io/name":{}}},"f:serviceName":{},"f:template":{"f:metadata":{"f:annotations":{".":{},"f:prometheus.io/port":{},"f:prometheus.io/scrape":{}},"f:labels":{".":{},"f:app.kubernetes.io/component":{},"f:app.kubernetes.io/name":{},"f:app.kubernetes.io/part-of":{}}},"f:spec":{"f:automountServiceAccountToken":{},"f:containers":{"k:{\"name\":\"rabbitmq\"}":{".":{},"f:env":{".":{},"k:{\"name\":\"K8S_HOSTNAME_SUFFIX\"}":{".":{},"f:name":{},"f:value":{}},"k:{\"name\":\"K8S_SERVICE_NAME\"}":{".":{},"f:name":{},"f:value":{}},"k:{\"name\":\"MY_POD_NAME\"}":{".":{},"f:name":{},"f:valueFrom":{".":{},"f:fieldRef":{".":{},"f:apiVersion":{},"f:fieldPath":{}}}},"k:{\"name\":\"MY_POD_NAMESPACE\"}":{".":{},"f:name":{},"f:valueFrom":{".":{},"f:fieldRef":{".":{},"f:apiVersion":{},"f:fieldPath":{}}}},"k:{\"name\":\"RABBITMQ_ENABLED_PLUGINS_FILE\"}":{".":{},"f:name":{},"f:value":{}},"k:{\"name\":\"RABBITMQ_NODENAME\"}":{".":{},"f:name":{},"f:value":{}},"k:{\"name\":\"RABBITMQ_USE_LONGNAME\"}":{".":{},"f:name":{},"f:value":{}}},"f:image":{},"f:imagePullPolicy":{},"f:lifecycle":{".":{},"f:preStop":{".":{},"f:exec":{".":{},"f:command":{}}}},"f:name":{},"f:ports":{".":{},"k:{\"containerPort\":4369,\"protocol\":\"TCP\"}":{".":{},"f:containerPort":{},"f:name":{},"f:protocol":{}},"k:{\"containerPort\":5672,\"protocol\":\"TCP\"}":{".":{},"f:containerPort":{},"f:name":{},"f:protocol":{}},"k:{\"containerPort\":15672,\"protocol\":\"TCP\"}":{".":{},"f:containerPort":{},"f:name":{},"f:protocol":{}},"k:{\"containerPort\":15692,\"protocol\":\"TCP\"}":{".":{},"f:containerPort":{},"f:name":{},"f:protocol":{}}},"f:readinessProbe":{".":{},"f:failureThreshold":{},"f:initialDelaySeconds":{},"f:periodSeconds":{},"f:successThreshold":{},"f:tcpSocket":{".":{},"f:port":{}},"f:timeoutSeconds":{}},"f:resources":{".":{},"f:limits":{".":{},"f:cpu":{},"f:memory":{}},"f:requests":{".":{},"f:cpu":{},"f:memory":{}}},"f:terminationMessagePath":{},"f:terminationMessagePolicy":{},"f:volumeMounts":{".":{},"k:{\"mountPath\":\"/etc/pod-info/\"}":{".":{},"f:mountPath":{},"f:name":{}},"k:{\"mountPath\":\"/etc/rabbitmq/conf.d/10-operatorDefaults.conf\"}":{".":{},"f:mountPath":{},"f:name":{},"f:subPath":{}},"k:{\"mountPath\":\"/etc/rabbitmq/conf.d/11-default_user.conf\"}":{".":{},"f:mountPath":{},"f:name":{},"f:subPath":{}},"k:{\"mountPath\":\"/etc/rabbitmq/conf.d/90-userDefinedConfiguration.conf\"}":{".":{},"f:mountPath":{},"f:name":{},"f:subPath":{}},"k:{\"mountPath\":\"/operator\"}":{".":{},"f:mountPath":{},"f:name":{}},"k:{\"mountPath\":\"/var/lib/rabbitmq/\"}":{".":{},"f:mountPath":{},"f:name":{}},"k:{\"mountPath\":\"/var/lib/rabbitmq/mnesia/\"}":{".":{},"f:mountPath":{},"f:name":{}}}}},"f:dnsPolicy":{},"f:initContainers":{".":{},"k:{\"name\":\"setup-container\"}":{".":{},"f:command":{},"f:image":{},"f:imagePullPolicy":{},"f:name":{},"f:resources":{".":{},"f:limits":{".":{},"f:cpu":{},"f:memory":{}},"f:requests":{".":{},"f:cpu":{},"f:memory":{}}},"f:securityContext":{".":{},"f:capabilities":{".":{},"f:drop":{}},"f:runAsUser":{}},"f:terminationMessagePath":{},"f:terminationMessagePolicy":{},"f:volumeMounts":{".":{},"k:{\"mountPath\":\"/operator\"}":{".":{},"f:mountPath":{},"f:name":{}},"k:{\"mountPath\":\"/tmp/default_user.conf\"}":{".":{},"f:mountPath":{},"f:name":{},"f:subPath":{}},"k:{\"mountPath\":\"/tmp/erlang-cookie-secret/\"}":{".":{},"f:mountPath":{},"f:name":{}},"k:{\"mountPath\":\"/tmp/rabbitmq-plugins/\"}":{".":{},"f:mountPath":{},"f:name":{}},"k:{\"mountPath\":\"/var/lib/rabbitmq/\"}":{".":{},"f:mountPath":{},"f:name":{}},"k:{\"mountPath\":\"/var/lib/rabbitmq/mnesia/\"}":{".":{},"f:mountPath":{},"f:name":{}}}}},"f:restartPolicy":{},"f:schedulerName":{},"f:securityContext":{".":{},"f:fsGroup":{},"f:runAsGroup":{},"f:runAsUser":{}},"f:serviceAccount":{},"f:serviceAccountName":{},"f:terminationGracePeriodSeconds":{},"f:topologySpreadConstraints":{".":{},"k:{\"topologyKey\":\"topology.kubernetes.io/zone\",\"whenUnsatisfiable\":\"ScheduleAnyway\"}":{".":{},"f:labelSelector":{".":{},"f:matchLabels":{".":{},"f:app.kubernetes.io/name":{}}},"f:maxSkew":{},"f:topologyKey":{},"f:whenUnsatisfiable":{}}},"f:volumes":{".":{},"k:{\"name\":\"erlang-cookie-secret\"}":{".":{},"f:name":{},"f:secret":{".":{},"f:defaultMode":{},"f:secretName":{}}},"k:{\"name\":\"plugins-conf\"}":{".":{},"f:configMap":{".":{},"f:defaultMode":{},"f:name":{}},"f:name":{}},"k:{\"name\":\"pod-info\"}":{".":{},"f:downwardAPI":{".":{},"f:defaultMode":{},"f:items":{}},"f:name":{}},"k:{\"name\":\"rabbitmq-confd\"}":{".":{},"f:name":{},"f:projected":{".":{},"f:defaultMode":{},"f:sources":{}}},"k:{\"name\":\"rabbitmq-erlang-cookie\"}":{".":{},"f:emptyDir":{},"f:name":{}},"k:{\"name\":\"rabbitmq-plugins\"}":{".":{},"f:emptyDir":{},"f:name":{}}}}},"f:updateStrategy":{"f:rollingUpdate":{".":{},"f:partition":{}},"f:type":{}},"f:volumeClaimTemplates":{}}}}]},"spec":{"replicas":1,"selector":{"matchLabels":{"app.kubernetes.io/name":"rabbitmq-cluster"}},"template":{"metadata":{"creationTimestamp":null,"labels":{"app.kubernetes.io/component":"rabbitmq","app.kubernetes.io/name":"rabbitmq-cluster","app.kubernetes.io/part-of":"rabbitmq"},"annotations":{"prometheus.io/port":"15692","prometheus.io/scrape":"true"}},"spec":{"volumes":[{"name":"plugins-conf","configMap":{"name":"rabbitmq-cluster-plugins-conf","defaultMode":420}},{"name":"rabbitmq-confd","projected":{"sources":[{"secret":{"name":"rabbitmq-cluster-default-user","items":[{"key":"default_user.conf","path":"default_user.conf"}]}},{"configMap":{"name":"rabbitmq-cluster-server-conf","items":[{"key":"operatorDefaults.conf","path":"operatorDefaults.conf"},{"key":"userDefinedConfiguration.conf","path":"userDefinedConfiguration.conf"}]}}],"defaultMode":420}},{"name":"rabbitmq-erlang-cookie","emptyDir":{}},{"name":"erlang-cookie-secret","secret":{"secretName":"rabbitmq-cluster-erlang-cookie","defaultMode":420}},{"name":"rabbitmq-plugins","emptyDir":{}},{"name":"pod-info","downwardAPI":{"items":[{"path":"skipPreStopChecks","fieldRef":{"apiVersion":"v1","fieldPath":"metadata.labels['skipPreStopChecks']"}}],"defaultMode":420}}],"initContainers":[{"name":"setup-container","image":"rabbitmq:3.8.12-management","command":["sh","-c","cp /tmp/erlang-cookie-secret/.erlang.cookie /var/lib/rabbitmq/.erlang.cookie \u0026\u0026 chown 999:999 /var/lib/rabbitmq/.erlang.cookie \u0026\u0026 chmod 600 /var/lib/rabbitmq/.erlang.cookie ; cp /tmp/rabbitmq-plugins/enabled_plugins /operator/enabled_plugins \u0026\u0026 chown 999:999 /operator/enabled_plugins ; chown 999:999 /var/lib/rabbitmq/mnesia/ ; echo '[default]' \u003e /var/lib/rabbitmq/.rabbitmqadmin.conf \u0026\u0026 sed -e 's/default_user/username/' -e 's/default_pass/password/' /tmp/default_user.conf \u003e\u003e /var/lib/rabbitmq/.rabbitmqadmin.conf \u0026\u0026 chown 999:999 /var/lib/rabbitmq/.rabbitmqadmin.conf \u0026\u0026 chmod 600 /var/lib/rabbitmq/.rabbitmqadmin.conf"],"resources":{"limits":{"cpu":"100m","memory":"500Mi"},"requests":{"cpu":"100m","memory":"500Mi"}},"volumeMounts":[{"name":"plugins-conf","mountPath":"/tmp/rabbitmq-plugins/"},{"name":"rabbitmq-erlang-cookie","mountPath":"/var/lib/rabbitmq/"},{"name":"erlang-cookie-secret","mountPath":"/tmp/erlang-cookie-secret/"},{"name":"rabbitmq-plugins","mountPath":"/operator"},{"name":"persistence","mountPath":"/var/lib/rabbitmq/mnesia/"},{"name":"rabbitmq-confd","mountPath":"/tmp/default_user.conf","subPath":"default_user.conf"}],"terminationMessagePath":"/dev/termination-log","terminationMessagePolicy":"File","imagePullPolicy":"IfNotPresent","securityContext":{"capabilities":{"drop":["FSETID","KILL","SETGID","SETUID","SETPCAP","NET_BIND_SERVICE","NET_RAW","SYS_CHROOT","MKNOD","AUDIT_WRITE","SETFCAP"]},"runAsUser":0}}],"containers":[{"name":"rabbitmq","image":"rabbitmq:3.8.12-management","ports":[{"name":"epmd","containerPort":4369,"protocol":"TCP"},{"name":"amqp","containerPort":5672,"protocol":"TCP"},{"name":"management","containerPort":15672,"protocol":"TCP"},{"name":"prometheus","containerPort":15692,"protocol":"TCP"}],"env":[{"name":"MY_POD_NAME","valueFrom":{"fieldRef":{"apiVersion":"v1","fieldPath":"metadata.name"}}},{"name":"MY_POD_NAMESPACE","valueFrom":{"fieldRef":{"apiVersion":"v1","fieldPath":"metadata.namespace"}}},{"name":"RABBITMQ_ENABLED_PLUGINS_FILE","value":"/operator/enabled_plugins"},{"name":"K8S_SERVICE_NAME","value":"rabbitmq-cluster-nodes"},{"name":"RABBITMQ_USE_LONGNAME","value":"true"},{"name":"RABBITMQ_NODENAME","value":"rabbit@$(MY_POD_NAME).$(K8S_SERVICE_NAME).$(MY_POD_NAMESPACE)"},{"name":"K8S_HOSTNAME_SUFFIX","value":".$(K8S_SERVICE_NAME).$(MY_POD_NAMESPACE)"}],"resources":{"limits":{"cpu":"2","memory":"2Gi"},"requests":{"cpu":"1","memory":"2Gi"}},"volumeMounts":[{"name":"rabbitmq-erlang-cookie","mountPath":"/var/lib/rabbitmq/"},{"name":"persistence","mountPath":"/var/lib/rabbitmq/mnesia/"},{"name":"rabbitmq-plugins","mountPath":"/operator"},{"name":"rabbitmq-confd","mountPath":"/etc/rabbitmq/conf.d/10-operatorDefaults.conf","subPath":"operatorDefaults.conf"},{"name":"rabbitmq-confd","mountPath":"/etc/rabbitmq/conf.d/11-default_user.conf","subPath":"default_user.conf"},{"name":"rabbitmq-confd","mountPath":"/etc/rabbitmq/conf.d/90-userDefinedConfiguration.conf","subPath":"userDefinedConfiguration.conf"},{"name":"pod-info","mountPath":"/etc/pod-info/"}],"readinessProbe":{"tcpSocket":{"port":"amqp"},"initialDelaySeconds":10,"timeoutSeconds":5,"periodSeconds":10,"successThreshold":1,"failureThreshold":3},"lifecycle":{"preStop":{"exec":{"command":["/bin/bash","-c","if [ ! -z \"$(cat /etc/pod-info/skipPreStopChecks)\" ]; then exit 0; fi; rabbitmq-upgrade await_online_quorum_plus_one -t 604800; rabbitmq-upgrade await_online_synchronized_mirror -t 604800; rabbitmq-upgrade drain -t 604800"]}}},"terminationMessagePath":"/dev/termination-log","terminationMessagePolicy":"File","imagePullPolicy":"IfNotPresent"}],"restartPolicy":"Always","terminationGracePeriodSeconds":604800,"dnsPolicy":"ClusterFirst","serviceAccountName":"rabbitmq-cluster-server","serviceAccount":"rabbitmq-cluster-server","automountServiceAccountToken":true,"securityContext":{"runAsUser":999,"runAsGroup":999,"fsGroup":999},"schedulerName":"default-scheduler","topologySpreadConstraints":[{"maxSkew":1,"topologyKey":"topology.kubernetes.io/zone","whenUnsatisfiable":"ScheduleAnyway","labelSelector":{"matchLabels":{"app.kubernetes.io/name":"rabbitmq-cluster"}}}]}},"volumeClaimTemplates":[{"metadata":{"name":"persistence","namespace":"default","creationTimestamp":null,"labels":{"app.kubernetes.io/component":"rabbitmq","app.kubernetes.io/name":"rabbitmq-cluster","app.kubernetes.io/part-of":"rabbitmq"},"ownerReferences":[{"apiVersion":"rabbitmq.com/v1beta1","kind":"RabbitmqCluster","name":"rabbitmq-cluster","uid":"3ecefa8a-1bec-48a7-9af4-dd0df3339101","controller":true,"blockOwnerDeletion":false}]},"spec":{"accessModes":["ReadWriteOnce"],"resources":{"requests":{"storage":"15Gi"}},"volumeMode":"Filesystem"},"status":{"phase":"Pending"}}],"serviceName":"rabbitmq-cluster-nodes","podManagementPolicy":"Parallel","updateStrategy":{"type":"RollingUpdate","rollingUpdate":{"partition":0}},"revisionHistoryLimit":10},"status":{"observedGeneration":1,"replicas":1,"readyReplicas":1,"currentReplicas":1,"updatedReplicas":1,"currentRevision":"rabbitmq-cluster-server-5f8b8665fb","updateRevision":"rabbitmq-cluster-server-5f8b8665fb","collisionCount":0}}
2022/03/18 18:07:34 learn_server.go:291: [SIEVE-AFTER-READ]	Get	true	configmap	default	rabbitmq-cluster-server-conf	github.com/rabbitmq/cluster-operator/controllers.(*RabbitmqClusterReconciler)	NoError	{"kind":"ConfigMap","apiVersion":"v1","metadata":{"name":"rabbitmq-cluster-server-conf","namespace":"default","selfLink":"/api/v1/namespaces/default/configmaps/rabbitmq-cluster-server-conf","uid":"e4182078-d429-4baf-9021-72618c509ac5","resourceVersion":"1095","creationTimestamp":"2022-03-18T18:06:25Z","labels":{"app.kubernetes.io/component":"rabbitmq","app.kubernetes.io/name":"rabbitmq-cluster","app.kubernetes.io/part-of":"rabbitmq"},"ownerReferences":[{"apiVersion":"rabbitmq.com/v1beta1","kind":"RabbitmqCluster","name":"rabbitmq-cluster","uid":"3ecefa8a-1bec-48a7-9af4-dd0df3339101","controller":true,"blockOwnerDeletion":true}],"managedFields":[{"manager":"manager","operation":"Update","apiVersion":"v1","time":"2022-03-18T18:06:25Z","fieldsType":"FieldsV1","fieldsV1":{"f:data":{".":{},"f:operatorDefaults.conf":{},"f:userDefinedConfiguration.conf":{}},"f:metadata":{"f:labels":{".":{},"f:app.kubernetes.io/component":{},"f:app.kubernetes.io/name":{},"f:app.kubernetes.io/part-of":{}},"f:ownerReferences":{".":{},"k:{\"uid\":\"3ecefa8a-1bec-48a7-9af4-dd0df3339101\"}":{".":{},"f:apiVersion":{},"f:blockOwnerDeletion":{},"f:controller":{},"f:kind":{},"f:name":{},"f:uid":{}}}}}}]},"data":{"operatorDefaults.conf":"cluster_formation.peer_discovery_backend             = rabbit_peer_discovery_k8s\ncluster_formation.k8s.host                           = kubernetes.default\ncluster_formation.k8s.address_type                   = hostname\ncluster_partition_handling                           = pause_minority\nqueue_master_locator                                 = min-masters\ndisk_free_limit.absolute                             = 2GB\ncluster_formation.randomized_startup_delay_range.min = 5\ncluster_formation.randomized_startup_delay_range.max = 30\ncluster_name                                         = rabbitmq-cluster\n","userDefinedConfiguration.conf":"total_memory_available_override_value = 1717986919\n"}}
2022/03/18 18:07:34 learn_server.go:256: [SIEVE-BEFORE-WRITE]	45
2022/03/18 18:07:34 learn_server.go:263: [SIEVE-AFTER-WRITE]	45	StatusUpdate	rabbitmqcluster	github.com/rabbitmq/cluster-operator/controllers.(*RabbitmqClusterReconciler)	NoError	{"metadata":{"name":"rabbitmq-cluster","namespace":"default","selfLink":"/apis/rabbitmq.com/v1beta1/namespaces/default/rabbitmqclusters/rabbitmq-cluster/status","uid":"3ecefa8a-1bec-48a7-9af4-dd0df3339101","resourceVersion":"1473","generation":3,"creationTimestamp":"2022-03-18T18:06:25Z","annotations":{"kubectl.kubernetes.io/last-applied-configuration":"{\"apiVersion\":\"rabbitmq.com/v1beta1\",\"kind\":\"RabbitmqCluster\",\"metadata\":{\"annotations\":{},\"name\":\"rabbitmq-cluster\",\"namespace\":\"default\"},\"spec\":{\"persistence\":{\"storage\":\"10Gi\"},\"replicas\":1}}\n"},"finalizers":["deletion.finalizers.rabbitmqclusters.rabbitmq.com"],"managedFields":[{"manager":"kubectl-client-side-apply","operation":"Update","apiVersion":"rabbitmq.com/v1beta1","time":"2022-03-18T18:06:25Z","fieldsType":"FieldsV1","fieldsV1":{"f:metadata":{"f:annotations":{".":{},"f:kubectl.kubernetes.io/last-applied-configuration":{}}},"f:spec":{".":{},"f:image":{},"f:persistence":{},"f:replicas":{},"f:resources":{".":{},"f:limits":{".":{},"f:memory":{}},"f:requests":{".":{},"f:memory":{}}},"f:service":{".":{},"f:type":{}},"f:terminationGracePeriodSeconds":{}}}},{"manager":"kubectl-patch","operation":"Update","apiVersion":"rabbitmq.com/v1beta1","time":"2022-03-18T18:07:31Z","fieldsType":"FieldsV1","fieldsV1":{"f:spec":{"f:persistence":{"f:storage":{}}}}},{"manager":"manager","operation":"Update","apiVersion":"rabbitmq.com/v1beta1","time":"2022-03-18T18:07:34Z","fieldsType":"FieldsV1","fieldsV1":{"f:metadata":{"f:finalizers":{}},"f:spec":{"f:override":{},"f:rabbitmq":{},"f:resources":{"f:limits":{"f:cpu":{}},"f:requests":{"f:cpu":{}}},"f:tls":{}},"f:status":{".":{},"f:conditions":{},"f:defaultUser":{".":{},"f:secretReference":{".":{},"f:keys":{".":{},"f:password":{},"f:username":{}},"f:name":{},"f:namespace":{}},"f:serviceReference":{".":{},"f:name":{},"f:namespace":{}}}}}}]},"spec":{"replicas":1,"image":"rabbitmq:3.8.12-management","service":{"type":"ClusterIP"},"persistence":{"storage":"15Gi"},"resources":{"limits":{"cpu":"2","memory":"2Gi"},"requests":{"cpu":"1","memory":"2Gi"}},"rabbitmq":{},"tls":{},"override":{},"terminationGracePeriodSeconds":604800},"status":{"conditions":[{"type":"AllReplicasReady","status":"False","lastTransitionTime":"2022-03-18T18:07:34Z","reason":"NotAllPodsReady","message":"0/1 Pods ready"},{"type":"ClusterAvailable","status":"True","lastTransitionTime":"2022-03-18T18:07:23Z","reason":"AtLeastOneEndpointAvailable"},{"type":"NoWarnings","status":"True","lastTransitionTime":"2022-03-18T18:06:25Z","reason":"NoWarnings"},{"type":"ReconcileSuccess","status":"True","lastTransitionTime":"2022-03-18T18:07:24Z","reason":"Success","message":"Finish reconciling"}],"defaultUser":{"secretReference":{"name":"rabbitmq-cluster-default-user","namespace":"default","keys":{"password":"password","username":"username"}},"serviceReference":{"name":"rabbitmq-cluster","namespace":"default"}},"binding":{"name":"rabbitmq-cluster-default-user"}}}
2022/03/18 18:07:34 learn_server.go:291: [SIEVE-AFTER-READ]	Get	true	statefulset	default	rabbitmq-cluster-server	github.com/rabbitmq/cluster-operator/controllers.(*RabbitmqClusterReconciler)	NoError	{"kind":"StatefulSet","apiVersion":"apps/v1","metadata":{"name":"rabbitmq-cluster-server","namespace":"default","selfLink":"/apis/apps/v1/namespaces/default/statefulsets/rabbitmq-cluster-server","uid":"1d62d993-2c32-4da7-8884-e4cfad9e587d","resourceVersion":"1474","generation":1,"creationTimestamp":"2022-03-18T18:07:34Z","labels":{"app.kubernetes.io/component":"rabbitmq","app.kubernetes.io/name":"rabbitmq-cluster","app.kubernetes.io/part-of":"rabbitmq"},"annotations":{"rabbitmq.com/createdAt":"2022-03-18T18:07:34Z"},"ownerReferences":[{"apiVersion":"rabbitmq.com/v1beta1","kind":"RabbitmqCluster","name":"rabbitmq-cluster","uid":"3ecefa8a-1bec-48a7-9af4-dd0df3339101","controller":true,"blockOwnerDeletion":true}],"managedFields":[{"manager":"kube-controller-manager","operation":"Update","apiVersion":"apps/v1","time":"2022-03-18T18:07:34Z","fieldsType":"FieldsV1","fieldsV1":{"f:status":{"f:collisionCount":{},"f:currentReplicas":{},"f:currentRevision":{},"f:observedGeneration":{},"f:readyReplicas":{},"f:replicas":{},"f:updateRevision":{},"f:updatedReplicas":{}}}},{"manager":"manager","operation":"Update","apiVersion":"apps/v1","time":"2022-03-18T18:07:34Z","fieldsType":"FieldsV1","fieldsV1":{"f:metadata":{"f:annotations":{".":{},"f:rabbitmq.com/createdAt":{}},"f:labels":{".":{},"f:app.kubernetes.io/component":{},"f:app.kubernetes.io/name":{},"f:app.kubernetes.io/part-of":{}},"f:ownerReferences":{".":{},"k:{\"uid\":\"3ecefa8a-1bec-48a7-9af4-dd0df3339101\"}":{".":{},"f:apiVersion":{},"f:blockOwnerDeletion":{},"f:controller":{},"f:kind":{},"f:name":{},"f:uid":{}}}},"f:spec":{"f:podManagementPolicy":{},"f:replicas":{},"f:revisionHistoryLimit":{},"f:selector":{"f:matchLabels":{".":{},"f:app.kubernetes.io/name":{}}},"f:serviceName":{},"f:template":{"f:metadata":{"f:annotations":{".":{},"f:prometheus.io/port":{},"f:prometheus.io/scrape":{}},"f:labels":{".":{},"f:app.kubernetes.io/component":{},"f:app.kubernetes.io/name":{},"f:app.kubernetes.io/part-of":{}}},"f:spec":{"f:automountServiceAccountToken":{},"f:containers":{"k:{\"name\":\"rabbitmq\"}":{".":{},"f:env":{".":{},"k:{\"name\":\"K8S_HOSTNAME_SUFFIX\"}":{".":{},"f:name":{},"f:value":{}},"k:{\"name\":\"K8S_SERVICE_NAME\"}":{".":{},"f:name":{},"f:value":{}},"k:{\"name\":\"MY_POD_NAME\"}":{".":{},"f:name":{},"f:valueFrom":{".":{},"f:fieldRef":{".":{},"f:apiVersion":{},"f:fieldPath":{}}}},"k:{\"name\":\"MY_POD_NAMESPACE\"}":{".":{},"f:name":{},"f:valueFrom":{".":{},"f:fieldRef":{".":{},"f:apiVersion":{},"f:fieldPath":{}}}},"k:{\"name\":\"RABBITMQ_ENABLED_PLUGINS_FILE\"}":{".":{},"f:name":{},"f:value":{}},"k:{\"name\":\"RABBITMQ_NODENAME\"}":{".":{},"f:name":{},"f:value":{}},"k:{\"name\":\"RABBITMQ_USE_LONGNAME\"}":{".":{},"f:name":{},"f:value":{}}},"f:image":{},"f:imagePullPolicy":{},"f:lifecycle":{".":{},"f:preStop":{".":{},"f:exec":{".":{},"f:command":{}}}},"f:name":{},"f:ports":{".":{},"k:{\"containerPort\":4369,\"protocol\":\"TCP\"}":{".":{},"f:containerPort":{},"f:name":{},"f:protocol":{}},"k:{\"containerPort\":5672,\"protocol\":\"TCP\"}":{".":{},"f:containerPort":{},"f:name":{},"f:protocol":{}},"k:{\"containerPort\":15672,\"protocol\":\"TCP\"}":{".":{},"f:containerPort":{},"f:name":{},"f:protocol":{}},"k:{\"containerPort\":15692,\"protocol\":\"TCP\"}":{".":{},"f:containerPort":{},"f:name":{},"f:protocol":{}}},"f:readinessProbe":{".":{},"f:failureThreshold":{},"f:initialDelaySeconds":{},"f:periodSeconds":{},"f:successThreshold":{},"f:tcpSocket":{".":{},"f:port":{}},"f:timeoutSeconds":{}},"f:resources":{".":{},"f:limits":{".":{},"f:cpu":{},"f:memory":{}},"f:requests":{".":{},"f:cpu":{},"f:memory":{}}},"f:terminationMessagePath":{},"f:terminationMessagePolicy":{},"f:volumeMounts":{".":{},"k:{\"mountPath\":\"/etc/pod-info/\"}":{".":{},"f:mountPath":{},"f:name":{}},"k:{\"mountPath\":\"/etc/rabbitmq/conf.d/10-operatorDefaults.conf\"}":{".":{},"f:mountPath":{},"f:name":{},"f:subPath":{}},"k:{\"mountPath\":\"/etc/rabbitmq/conf.d/11-default_user.conf\"}":{".":{},"f:mountPath":{},"f:name":{},"f:subPath":{}},"k:{\"mountPath\":\"/etc/rabbitmq/conf.d/90-userDefinedConfiguration.conf\"}":{".":{},"f:mountPath":{},"f:name":{},"f:subPath":{}},"k:{\"mountPath\":\"/operator\"}":{".":{},"f:mountPath":{},"f:name":{}},"k:{\"mountPath\":\"/var/lib/rabbitmq/\"}":{".":{},"f:mountPath":{},"f:name":{}},"k:{\"mountPath\":\"/var/lib/rabbitmq/mnesia/\"}":{".":{},"f:mountPath":{},"f:name":{}}}}},"f:dnsPolicy":{},"f:initContainers":{".":{},"k:{\"name\":\"setup-container\"}":{".":{},"f:command":{},"f:image":{},"f:imagePullPolicy":{},"f:name":{},"f:resources":{".":{},"f:limits":{".":{},"f:cpu":{},"f:memory":{}},"f:requests":{".":{},"f:cpu":{},"f:memory":{}}},"f:securityContext":{".":{},"f:capabilities":{".":{},"f:drop":{}},"f:runAsUser":{}},"f:terminationMessagePath":{},"f:terminationMessagePolicy":{},"f:volumeMounts":{".":{},"k:{\"mountPath\":\"/operator\"}":{".":{},"f:mountPath":{},"f:name":{}},"k:{\"mountPath\":\"/tmp/default_user.conf\"}":{".":{},"f:mountPath":{},"f:name":{},"f:subPath":{}},"k:{\"mountPath\":\"/tmp/erlang-cookie-secret/\"}":{".":{},"f:mountPath":{},"f:name":{}},"k:{\"mountPath\":\"/tmp/rabbitmq-plugins/\"}":{".":{},"f:mountPath":{},"f:name":{}},"k:{\"mountPath\":\"/var/lib/rabbitmq/\"}":{".":{},"f:mountPath":{},"f:name":{}},"k:{\"mountPath\":\"/var/lib/rabbitmq/mnesia/\"}":{".":{},"f:mountPath":{},"f:name":{}}}}},"f:restartPolicy":{},"f:schedulerName":{},"f:securityContext":{".":{},"f:fsGroup":{},"f:runAsGroup":{},"f:runAsUser":{}},"f:serviceAccount":{},"f:serviceAccountName":{},"f:terminationGracePeriodSeconds":{},"f:topologySpreadConstraints":{".":{},"k:{\"topologyKey\":\"topology.kubernetes.io/zone\",\"whenUnsatisfiable\":\"ScheduleAnyway\"}":{".":{},"f:labelSelector":{".":{},"f:matchLabels":{".":{},"f:app.kubernetes.io/name":{}}},"f:maxSkew":{},"f:topologyKey":{},"f:whenUnsatisfiable":{}}},"f:volumes":{".":{},"k:{\"name\":\"erlang-cookie-secret\"}":{".":{},"f:name":{},"f:secret":{".":{},"f:defaultMode":{},"f:secretName":{}}},"k:{\"name\":\"plugins-conf\"}":{".":{},"f:configMap":{".":{},"f:defaultMode":{},"f:name":{}},"f:name":{}},"k:{\"name\":\"pod-info\"}":{".":{},"f:downwardAPI":{".":{},"f:defaultMode":{},"f:items":{}},"f:name":{}},"k:{\"name\":\"rabbitmq-confd\"}":{".":{},"f:name":{},"f:projected":{".":{},"f:defaultMode":{},"f:sources":{}}},"k:{\"name\":\"rabbitmq-erlang-cookie\"}":{".":{},"f:emptyDir":{},"f:name":{}},"k:{\"name\":\"rabbitmq-plugins\"}":{".":{},"f:emptyDir":{},"f:name":{}}}}},"f:updateStrategy":{"f:rollingUpdate":{".":{},"f:partition":{}},"f:type":{}},"f:volumeClaimTemplates":{}}}}]},"spec":{"replicas":1,"selector":{"matchLabels":{"app.kubernetes.io/name":"rabbitmq-cluster"}},"template":{"metadata":{"creationTimestamp":null,"labels":{"app.kubernetes.io/component":"rabbitmq","app.kubernetes.io/name":"rabbitmq-cluster","app.kubernetes.io/part-of":"rabbitmq"},"annotations":{"prometheus.io/port":"15692","prometheus.io/scrape":"true"}},"spec":{"volumes":[{"name":"plugins-conf","configMap":{"name":"rabbitmq-cluster-plugins-conf","defaultMode":420}},{"name":"rabbitmq-confd","projected":{"sources":[{"secret":{"name":"rabbitmq-cluster-default-user","items":[{"key":"default_user.conf","path":"default_user.conf"}]}},{"configMap":{"name":"rabbitmq-cluster-server-conf","items":[{"key":"operatorDefaults.conf","path":"operatorDefaults.conf"},{"key":"userDefinedConfiguration.conf","path":"userDefinedConfiguration.conf"}]}}],"defaultMode":420}},{"name":"rabbitmq-erlang-cookie","emptyDir":{}},{"name":"erlang-cookie-secret","secret":{"secretName":"rabbitmq-cluster-erlang-cookie","defaultMode":420}},{"name":"rabbitmq-plugins","emptyDir":{}},{"name":"pod-info","downwardAPI":{"items":[{"path":"skipPreStopChecks","fieldRef":{"apiVersion":"v1","fieldPath":"metadata.labels['skipPreStopChecks']"}}],"defaultMode":420}}],"initContainers":[{"name":"setup-container","image":"rabbitmq:3.8.12-management","command":["sh","-c","cp /tmp/erlang-cookie-secret/.erlang.cookie /var/lib/rabbitmq/.erlang.cookie \u0026\u0026 chown 999:999 /var/lib/rabbitmq/.erlang.cookie \u0026\u0026 chmod 600 /var/lib/rabbitmq/.erlang.cookie ; cp /tmp/rabbitmq-plugins/enabled_plugins /operator/enabled_plugins \u0026\u0026 chown 999:999 /operator/enabled_plugins ; chown 999:999 /var/lib/rabbitmq/mnesia/ ; echo '[default]' \u003e /var/lib/rabbitmq/.rabbitmqadmin.conf \u0026\u0026 sed -e 's/default_user/username/' -e 's/default_pass/password/' /tmp/default_user.conf \u003e\u003e /var/lib/rabbitmq/.rabbitmqadmin.conf \u0026\u0026 chown 999:999 /var/lib/rabbitmq/.rabbitmqadmin.conf \u0026\u0026 chmod 600 /var/lib/rabbitmq/.rabbitmqadmin.conf"],"resources":{"limits":{"cpu":"100m","memory":"500Mi"},"requests":{"cpu":"100m","memory":"500Mi"}},"volumeMounts":[{"name":"plugins-conf","mountPath":"/tmp/rabbitmq-plugins/"},{"name":"rabbitmq-erlang-cookie","mountPath":"/var/lib/rabbitmq/"},{"name":"erlang-cookie-secret","mountPath":"/tmp/erlang-cookie-secret/"},{"name":"rabbitmq-plugins","mountPath":"/operator"},{"name":"persistence","mountPath":"/var/lib/rabbitmq/mnesia/"},{"name":"rabbitmq-confd","mountPath":"/tmp/default_user.conf","subPath":"default_user.conf"}],"terminationMessagePath":"/dev/termination-log","terminationMessagePolicy":"File","imagePullPolicy":"IfNotPresent","securityContext":{"capabilities":{"drop":["FSETID","KILL","SETGID","SETUID","SETPCAP","NET_BIND_SERVICE","NET_RAW","SYS_CHROOT","MKNOD","AUDIT_WRITE","SETFCAP"]},"runAsUser":0}}],"containers":[{"name":"rabbitmq","image":"rabbitmq:3.8.12-management","ports":[{"name":"epmd","containerPort":4369,"protocol":"TCP"},{"name":"amqp","containerPort":5672,"protocol":"TCP"},{"name":"management","containerPort":15672,"protocol":"TCP"},{"name":"prometheus","containerPort":15692,"protocol":"TCP"}],"env":[{"name":"MY_POD_NAME","valueFrom":{"fieldRef":{"apiVersion":"v1","fieldPath":"metadata.name"}}},{"name":"MY_POD_NAMESPACE","valueFrom":{"fieldRef":{"apiVersion":"v1","fieldPath":"metadata.namespace"}}},{"name":"RABBITMQ_ENABLED_PLUGINS_FILE","value":"/operator/enabled_plugins"},{"name":"K8S_SERVICE_NAME","value":"rabbitmq-cluster-nodes"},{"name":"RABBITMQ_USE_LONGNAME","value":"true"},{"name":"RABBITMQ_NODENAME","value":"rabbit@$(MY_POD_NAME).$(K8S_SERVICE_NAME).$(MY_POD_NAMESPACE)"},{"name":"K8S_HOSTNAME_SUFFIX","value":".$(K8S_SERVICE_NAME).$(MY_POD_NAMESPACE)"}],"resources":{"limits":{"cpu":"2","memory":"2Gi"},"requests":{"cpu":"1","memory":"2Gi"}},"volumeMounts":[{"name":"rabbitmq-erlang-cookie","mountPath":"/var/lib/rabbitmq/"},{"name":"persistence","mountPath":"/var/lib/rabbitmq/mnesia/"},{"name":"rabbitmq-plugins","mountPath":"/operator"},{"name":"rabbitmq-confd","mountPath":"/etc/rabbitmq/conf.d/10-operatorDefaults.conf","subPath":"operatorDefaults.conf"},{"name":"rabbitmq-confd","mountPath":"/etc/rabbitmq/conf.d/11-default_user.conf","subPath":"default_user.conf"},{"name":"rabbitmq-confd","mountPath":"/etc/rabbitmq/conf.d/90-userDefinedConfiguration.conf","subPath":"userDefinedConfiguration.conf"},{"name":"pod-info","mountPath":"/etc/pod-info/"}],"readinessProbe":{"tcpSocket":{"port":"amqp"},"initialDelaySeconds":10,"timeoutSeconds":5,"periodSeconds":10,"successThreshold":1,"failureThreshold":3},"lifecycle":{"preStop":{"exec":{"command":["/bin/bash","-c","if [ ! -z \"$(cat /etc/pod-info/skipPreStopChecks)\" ]; then exit 0; fi; rabbitmq-upgrade await_online_quorum_plus_one -t 604800; rabbitmq-upgrade await_online_synchronized_mirror -t 604800; rabbitmq-upgrade drain -t 604800"]}}},"terminationMessagePath":"/dev/termination-log","terminationMessagePolicy":"File","imagePullPolicy":"IfNotPresent"}],"restartPolicy":"Always","terminationGracePeriodSeconds":604800,"dnsPolicy":"ClusterFirst","serviceAccountName":"rabbitmq-cluster-server","serviceAccount":"rabbitmq-cluster-server","automountServiceAccountToken":true,"securityContext":{"runAsUser":999,"runAsGroup":999,"fsGroup":999},"schedulerName":"default-scheduler","topologySpreadConstraints":[{"maxSkew":1,"topologyKey":"topology.kubernetes.io/zone","whenUnsatisfiable":"ScheduleAnyway","labelSelector":{"matchLabels":{"app.kubernetes.io/name":"rabbitmq-cluster"}}}]}},"volumeClaimTemplates":[{"metadata":{"name":"persistence","namespace":"default","creationTimestamp":null,"labels":{"app.kubernetes.io/component":"rabbitmq","app.kubernetes.io/name":"rabbitmq-cluster","app.kubernetes.io/part-of":"rabbitmq"},"ownerReferences":[{"apiVersion":"rabbitmq.com/v1beta1","kind":"RabbitmqCluster","name":"rabbitmq-cluster","uid":"3ecefa8a-1bec-48a7-9af4-dd0df3339101","controller":true,"blockOwnerDeletion":false}]},"spec":{"accessModes":["ReadWriteOnce"],"resources":{"requests":{"storage":"15Gi"}},"volumeMode":"Filesystem"},"status":{"phase":"Pending"}}],"serviceName":"rabbitmq-cluster-nodes","podManagementPolicy":"Parallel","updateStrategy":{"type":"RollingUpdate","rollingUpdate":{"partition":0}},"revisionHistoryLimit":10},"status":{"observedGeneration":1,"replicas":1,"readyReplicas":1,"currentReplicas":1,"updatedReplicas":1,"currentRevision":"rabbitmq-cluster-server-5f8b8665fb","updateRevision":"rabbitmq-cluster-server-5f8b8665fb","collisionCount":0}}
2022/03/18 18:07:34 learn_server.go:291: [SIEVE-AFTER-READ]	Get	true	configmap	default	rabbitmq-cluster-plugins-conf	github.com/rabbitmq/cluster-operator/controllers.(*RabbitmqClusterReconciler)	NoError	{"kind":"ConfigMap","apiVersion":"v1","metadata":{"name":"rabbitmq-cluster-plugins-conf","namespace":"default","selfLink":"/api/v1/namespaces/default/configmaps/rabbitmq-cluster-plugins-conf","uid":"0aa26eb6-ff3a-4457-a223-284c897db7fe","resourceVersion":"1092","creationTimestamp":"2022-03-18T18:06:25Z","labels":{"app.kubernetes.io/component":"rabbitmq","app.kubernetes.io/name":"rabbitmq-cluster","app.kubernetes.io/part-of":"rabbitmq"},"ownerReferences":[{"apiVersion":"rabbitmq.com/v1beta1","kind":"RabbitmqCluster","name":"rabbitmq-cluster","uid":"3ecefa8a-1bec-48a7-9af4-dd0df3339101","controller":true,"blockOwnerDeletion":true}],"managedFields":[{"manager":"manager","operation":"Update","apiVersion":"v1","time":"2022-03-18T18:06:25Z","fieldsType":"FieldsV1","fieldsV1":{"f:data":{".":{},"f:enabled_plugins":{}},"f:metadata":{"f:labels":{".":{},"f:app.kubernetes.io/component":{},"f:app.kubernetes.io/name":{},"f:app.kubernetes.io/part-of":{}},"f:ownerReferences":{".":{},"k:{\"uid\":\"3ecefa8a-1bec-48a7-9af4-dd0df3339101\"}":{".":{},"f:apiVersion":{},"f:blockOwnerDeletion":{},"f:controller":{},"f:kind":{},"f:name":{},"f:uid":{}}}}}}]},"data":{"enabled_plugins":"[rabbitmq_peer_discovery_k8s,rabbitmq_prometheus,rabbitmq_management]."}}
2022/03/18 18:07:35 learn_server.go:256: [SIEVE-BEFORE-WRITE]	46
2022/03/18 18:07:35 learn_server.go:263: [SIEVE-AFTER-WRITE]	46	Update	statefulset	github.com/rabbitmq/cluster-operator/controllers.(*RabbitmqClusterReconciler)	NoError	{"metadata":{"name":"rabbitmq-cluster-server","namespace":"default","selfLink":"/apis/apps/v1/namespaces/default/statefulsets/rabbitmq-cluster-server","uid":"1d62d993-2c32-4da7-8884-e4cfad9e587d","resourceVersion":"1481","generation":1,"creationTimestamp":"2022-03-18T18:07:34Z","labels":{"app.kubernetes.io/component":"rabbitmq","app.kubernetes.io/name":"rabbitmq-cluster","app.kubernetes.io/part-of":"rabbitmq"},"ownerReferences":[{"apiVersion":"rabbitmq.com/v1beta1","kind":"RabbitmqCluster","name":"rabbitmq-cluster","uid":"3ecefa8a-1bec-48a7-9af4-dd0df3339101","controller":true,"blockOwnerDeletion":true}],"managedFields":[{"manager":"kube-controller-manager","operation":"Update","apiVersion":"apps/v1","time":"2022-03-18T18:07:34Z","fieldsType":"FieldsV1","fieldsV1":{"f:status":{"f:collisionCount":{},"f:currentReplicas":{},"f:currentRevision":{},"f:observedGeneration":{},"f:readyReplicas":{},"f:replicas":{},"f:updateRevision":{},"f:updatedReplicas":{}}}},{"manager":"manager","operation":"Update","apiVersion":"apps/v1","time":"2022-03-18T18:07:34Z","fieldsType":"FieldsV1","fieldsV1":{"f:metadata":{"f:labels":{".":{},"f:app.kubernetes.io/component":{},"f:app.kubernetes.io/name":{},"f:app.kubernetes.io/part-of":{}},"f:ownerReferences":{".":{},"k:{\"uid\":\"3ecefa8a-1bec-48a7-9af4-dd0df3339101\"}":{".":{},"f:apiVersion":{},"f:blockOwnerDeletion":{},"f:controller":{},"f:kind":{},"f:name":{},"f:uid":{}}}},"f:spec":{"f:podManagementPolicy":{},"f:replicas":{},"f:revisionHistoryLimit":{},"f:selector":{"f:matchLabels":{".":{},"f:app.kubernetes.io/name":{}}},"f:serviceName":{},"f:template":{"f:metadata":{"f:annotations":{".":{},"f:prometheus.io/port":{},"f:prometheus.io/scrape":{}},"f:labels":{".":{},"f:app.kubernetes.io/component":{},"f:app.kubernetes.io/name":{},"f:app.kubernetes.io/part-of":{}}},"f:spec":{"f:automountServiceAccountToken":{},"f:containers":{"k:{\"name\":\"rabbitmq\"}":{".":{},"f:env":{".":{},"k:{\"name\":\"K8S_HOSTNAME_SUFFIX\"}":{".":{},"f:name":{},"f:value":{}},"k:{\"name\":\"K8S_SERVICE_NAME\"}":{".":{},"f:name":{},"f:value":{}},"k:{\"name\":\"MY_POD_NAME\"}":{".":{},"f:name":{},"f:valueFrom":{".":{},"f:fieldRef":{".":{},"f:apiVersion":{},"f:fieldPath":{}}}},"k:{\"name\":\"MY_POD_NAMESPACE\"}":{".":{},"f:name":{},"f:valueFrom":{".":{},"f:fieldRef":{".":{},"f:apiVersion":{},"f:fieldPath":{}}}},"k:{\"name\":\"RABBITMQ_ENABLED_PLUGINS_FILE\"}":{".":{},"f:name":{},"f:value":{}},"k:{\"name\":\"RABBITMQ_NODENAME\"}":{".":{},"f:name":{},"f:value":{}},"k:{\"name\":\"RABBITMQ_USE_LONGNAME\"}":{".":{},"f:name":{},"f:value":{}}},"f:image":{},"f:imagePullPolicy":{},"f:lifecycle":{".":{},"f:preStop":{".":{},"f:exec":{".":{},"f:command":{}}}},"f:name":{},"f:ports":{".":{},"k:{\"containerPort\":4369,\"protocol\":\"TCP\"}":{".":{},"f:containerPort":{},"f:name":{},"f:protocol":{}},"k:{\"containerPort\":5672,\"protocol\":\"TCP\"}":{".":{},"f:containerPort":{},"f:name":{},"f:protocol":{}},"k:{\"containerPort\":15672,\"protocol\":\"TCP\"}":{".":{},"f:containerPort":{},"f:name":{},"f:protocol":{}},"k:{\"containerPort\":15692,\"protocol\":\"TCP\"}":{".":{},"f:containerPort":{},"f:name":{},"f:protocol":{}}},"f:readinessProbe":{".":{},"f:failureThreshold":{},"f:initialDelaySeconds":{},"f:periodSeconds":{},"f:successThreshold":{},"f:tcpSocket":{".":{},"f:port":{}},"f:timeoutSeconds":{}},"f:resources":{".":{},"f:limits":{".":{},"f:cpu":{},"f:memory":{}},"f:requests":{".":{},"f:cpu":{},"f:memory":{}}},"f:terminationMessagePath":{},"f:terminationMessagePolicy":{},"f:volumeMounts":{".":{},"k:{\"mountPath\":\"/etc/pod-info/\"}":{".":{},"f:mountPath":{},"f:name":{}},"k:{\"mountPath\":\"/etc/rabbitmq/conf.d/10-operatorDefaults.conf\"}":{".":{},"f:mountPath":{},"f:name":{},"f:subPath":{}},"k:{\"mountPath\":\"/etc/rabbitmq/conf.d/11-default_user.conf\"}":{".":{},"f:mountPath":{},"f:name":{},"f:subPath":{}},"k:{\"mountPath\":\"/etc/rabbitmq/conf.d/90-userDefinedConfiguration.conf\"}":{".":{},"f:mountPath":{},"f:name":{},"f:subPath":{}},"k:{\"mountPath\":\"/operator\"}":{".":{},"f:mountPath":{},"f:name":{}},"k:{\"mountPath\":\"/var/lib/rabbitmq/\"}":{".":{},"f:mountPath":{},"f:name":{}},"k:{\"mountPath\":\"/var/lib/rabbitmq/mnesia/\"}":{".":{},"f:mountPath":{},"f:name":{}}}}},"f:dnsPolicy":{},"f:initContainers":{".":{},"k:{\"name\":\"setup-container\"}":{".":{},"f:command":{},"f:image":{},"f:imagePullPolicy":{},"f:name":{},"f:resources":{".":{},"f:limits":{".":{},"f:cpu":{},"f:memory":{}},"f:requests":{".":{},"f:cpu":{},"f:memory":{}}},"f:securityContext":{".":{},"f:capabilities":{".":{},"f:drop":{}},"f:runAsUser":{}},"f:terminationMessagePath":{},"f:terminationMessagePolicy":{},"f:volumeMounts":{".":{},"k:{\"mountPath\":\"/operator\"}":{".":{},"f:mountPath":{},"f:name":{}},"k:{\"mountPath\":\"/tmp/default_user.conf\"}":{".":{},"f:mountPath":{},"f:name":{},"f:subPath":{}},"k:{\"mountPath\":\"/tmp/erlang-cookie-secret/\"}":{".":{},"f:mountPath":{},"f:name":{}},"k:{\"mountPath\":\"/tmp/rabbitmq-plugins/\"}":{".":{},"f:mountPath":{},"f:name":{}},"k:{\"mountPath\":\"/var/lib/rabbitmq/\"}":{".":{},"f:mountPath":{},"f:name":{}},"k:{\"mountPath\":\"/var/lib/rabbitmq/mnesia/\"}":{".":{},"f:mountPath":{},"f:name":{}}}}},"f:restartPolicy":{},"f:schedulerName":{},"f:securityContext":{".":{},"f:fsGroup":{},"f:runAsGroup":{},"f:runAsUser":{}},"f:serviceAccount":{},"f:serviceAccountName":{},"f:terminationGracePeriodSeconds":{},"f:topologySpreadConstraints":{".":{},"k:{\"topologyKey\":\"topology.kubernetes.io/zone\",\"whenUnsatisfiable\":\"ScheduleAnyway\"}":{".":{},"f:labelSelector":{".":{},"f:matchLabels":{".":{},"f:app.kubernetes.io/name":{}}},"f:maxSkew":{},"f:topologyKey":{},"f:whenUnsatisfiable":{}}},"f:volumes":{".":{},"k:{\"name\":\"erlang-cookie-secret\"}":{".":{},"f:name":{},"f:secret":{".":{},"f:defaultMode":{},"f:secretName":{}}},"k:{\"name\":\"plugins-conf\"}":{".":{},"f:configMap":{".":{},"f:defaultMode":{},"f:name":{}},"f:name":{}},"k:{\"name\":\"pod-info\"}":{".":{},"f:downwardAPI":{".":{},"f:defaultMode":{},"f:items":{}},"f:name":{}},"k:{\"name\":\"rabbitmq-confd\"}":{".":{},"f:name":{},"f:projected":{".":{},"f:defaultMode":{},"f:sources":{}}},"k:{\"name\":\"rabbitmq-erlang-cookie\"}":{".":{},"f:emptyDir":{},"f:name":{}},"k:{\"name\":\"rabbitmq-plugins\"}":{".":{},"f:emptyDir":{},"f:name":{}}}}},"f:updateStrategy":{"f:rollingUpdate":{".":{},"f:partition":{}},"f:type":{}},"f:volumeClaimTemplates":{}}}}]},"spec":{"replicas":1,"selector":{"matchLabels":{"app.kubernetes.io/name":"rabbitmq-cluster"}},"template":{"metadata":{"creationTimestamp":null,"labels":{"app.kubernetes.io/component":"rabbitmq","app.kubernetes.io/name":"rabbitmq-cluster","app.kubernetes.io/part-of":"rabbitmq"},"annotations":{"prometheus.io/port":"15692","prometheus.io/scrape":"true"}},"spec":{"volumes":[{"name":"plugins-conf","configMap":{"name":"rabbitmq-cluster-plugins-conf","defaultMode":420}},{"name":"rabbitmq-confd","projected":{"sources":[{"secret":{"name":"rabbitmq-cluster-default-user","items":[{"key":"default_user.conf","path":"default_user.conf"}]}},{"configMap":{"name":"rabbitmq-cluster-server-conf","items":[{"key":"operatorDefaults.conf","path":"operatorDefaults.conf"},{"key":"userDefinedConfiguration.conf","path":"userDefinedConfiguration.conf"}]}}],"defaultMode":420}},{"name":"rabbitmq-erlang-cookie","emptyDir":{}},{"name":"erlang-cookie-secret","secret":{"secretName":"rabbitmq-cluster-erlang-cookie","defaultMode":420}},{"name":"rabbitmq-plugins","emptyDir":{}},{"name":"pod-info","downwardAPI":{"items":[{"path":"skipPreStopChecks","fieldRef":{"apiVersion":"v1","fieldPath":"metadata.labels['skipPreStopChecks']"}}],"defaultMode":420}}],"initContainers":[{"name":"setup-container","image":"rabbitmq:3.8.12-management","command":["sh","-c","cp /tmp/erlang-cookie-secret/.erlang.cookie /var/lib/rabbitmq/.erlang.cookie \u0026\u0026 chown 999:999 /var/lib/rabbitmq/.erlang.cookie \u0026\u0026 chmod 600 /var/lib/rabbitmq/.erlang.cookie ; cp /tmp/rabbitmq-plugins/enabled_plugins /operator/enabled_plugins \u0026\u0026 chown 999:999 /operator/enabled_plugins ; chown 999:999 /var/lib/rabbitmq/mnesia/ ; echo '[default]' \u003e /var/lib/rabbitmq/.rabbitmqadmin.conf \u0026\u0026 sed -e 's/default_user/username/' -e 's/default_pass/password/' /tmp/default_user.conf \u003e\u003e /var/lib/rabbitmq/.rabbitmqadmin.conf \u0026\u0026 chown 999:999 /var/lib/rabbitmq/.rabbitmqadmin.conf \u0026\u0026 chmod 600 /var/lib/rabbitmq/.rabbitmqadmin.conf"],"resources":{"limits":{"cpu":"100m","memory":"500Mi"},"requests":{"cpu":"100m","memory":"500Mi"}},"volumeMounts":[{"name":"plugins-conf","mountPath":"/tmp/rabbitmq-plugins/"},{"name":"rabbitmq-erlang-cookie","mountPath":"/var/lib/rabbitmq/"},{"name":"erlang-cookie-secret","mountPath":"/tmp/erlang-cookie-secret/"},{"name":"rabbitmq-plugins","mountPath":"/operator"},{"name":"persistence","mountPath":"/var/lib/rabbitmq/mnesia/"},{"name":"rabbitmq-confd","mountPath":"/tmp/default_user.conf","subPath":"default_user.conf"}],"terminationMessagePath":"/dev/termination-log","terminationMessagePolicy":"File","imagePullPolicy":"IfNotPresent","securityContext":{"capabilities":{"drop":["FSETID","KILL","SETGID","SETUID","SETPCAP","NET_BIND_SERVICE","NET_RAW","SYS_CHROOT","MKNOD","AUDIT_WRITE","SETFCAP"]},"runAsUser":0}}],"containers":[{"name":"rabbitmq","image":"rabbitmq:3.8.12-management","ports":[{"name":"epmd","containerPort":4369,"protocol":"TCP"},{"name":"amqp","containerPort":5672,"protocol":"TCP"},{"name":"management","containerPort":15672,"protocol":"TCP"},{"name":"prometheus","containerPort":15692,"protocol":"TCP"}],"env":[{"name":"MY_POD_NAME","valueFrom":{"fieldRef":{"apiVersion":"v1","fieldPath":"metadata.name"}}},{"name":"MY_POD_NAMESPACE","valueFrom":{"fieldRef":{"apiVersion":"v1","fieldPath":"metadata.namespace"}}},{"name":"RABBITMQ_ENABLED_PLUGINS_FILE","value":"/operator/enabled_plugins"},{"name":"K8S_SERVICE_NAME","value":"rabbitmq-cluster-nodes"},{"name":"RABBITMQ_USE_LONGNAME","value":"true"},{"name":"RABBITMQ_NODENAME","value":"rabbit@$(MY_POD_NAME).$(K8S_SERVICE_NAME).$(MY_POD_NAMESPACE)"},{"name":"K8S_HOSTNAME_SUFFIX","value":".$(K8S_SERVICE_NAME).$(MY_POD_NAMESPACE)"}],"resources":{"limits":{"cpu":"2","memory":"2Gi"},"requests":{"cpu":"1","memory":"2Gi"}},"volumeMounts":[{"name":"rabbitmq-erlang-cookie","mountPath":"/var/lib/rabbitmq/"},{"name":"persistence","mountPath":"/var/lib/rabbitmq/mnesia/"},{"name":"rabbitmq-plugins","mountPath":"/operator"},{"name":"rabbitmq-confd","mountPath":"/etc/rabbitmq/conf.d/10-operatorDefaults.conf","subPath":"operatorDefaults.conf"},{"name":"rabbitmq-confd","mountPath":"/etc/rabbitmq/conf.d/11-default_user.conf","subPath":"default_user.conf"},{"name":"rabbitmq-confd","mountPath":"/etc/rabbitmq/conf.d/90-userDefinedConfiguration.conf","subPath":"userDefinedConfiguration.conf"},{"name":"pod-info","mountPath":"/etc/pod-info/"}],"readinessProbe":{"tcpSocket":{"port":"amqp"},"initialDelaySeconds":10,"timeoutSeconds":5,"periodSeconds":10,"successThreshold":1,"failureThreshold":3},"lifecycle":{"preStop":{"exec":{"command":["/bin/bash","-c","if [ ! -z \"$(cat /etc/pod-info/skipPreStopChecks)\" ]; then exit 0; fi; rabbitmq-upgrade await_online_quorum_plus_one -t 604800; rabbitmq-upgrade await_online_synchronized_mirror -t 604800; rabbitmq-upgrade drain -t 604800"]}}},"terminationMessagePath":"/dev/termination-log","terminationMessagePolicy":"File","imagePullPolicy":"IfNotPresent"}],"restartPolicy":"Always","terminationGracePeriodSeconds":604800,"dnsPolicy":"ClusterFirst","serviceAccountName":"rabbitmq-cluster-server","serviceAccount":"rabbitmq-cluster-server","automountServiceAccountToken":true,"securityContext":{"runAsUser":999,"runAsGroup":999,"fsGroup":999},"schedulerName":"default-scheduler","topologySpreadConstraints":[{"maxSkew":1,"topologyKey":"topology.kubernetes.io/zone","whenUnsatisfiable":"ScheduleAnyway","labelSelector":{"matchLabels":{"app.kubernetes.io/name":"rabbitmq-cluster"}}}]}},"volumeClaimTemplates":[{"metadata":{"name":"persistence","namespace":"default","creationTimestamp":null,"labels":{"app.kubernetes.io/component":"rabbitmq","app.kubernetes.io/name":"rabbitmq-cluster","app.kubernetes.io/part-of":"rabbitmq"},"ownerReferences":[{"apiVersion":"rabbitmq.com/v1beta1","kind":"RabbitmqCluster","name":"rabbitmq-cluster","uid":"3ecefa8a-1bec-48a7-9af4-dd0df3339101","controller":true,"blockOwnerDeletion":false}]},"spec":{"accessModes":["ReadWriteOnce"],"resources":{"requests":{"storage":"15Gi"}},"volumeMode":"Filesystem"},"status":{"phase":"Pending"}}],"serviceName":"rabbitmq-cluster-nodes","podManagementPolicy":"Parallel","updateStrategy":{"type":"RollingUpdate","rollingUpdate":{"partition":0}},"revisionHistoryLimit":10},"status":{"observedGeneration":1,"replicas":1,"readyReplicas":1,"currentReplicas":1,"updatedReplicas":1,"currentRevision":"rabbitmq-cluster-server-5f8b8665fb","updateRevision":"rabbitmq-cluster-server-5f8b8665fb","collisionCount":0}}
2022/03/18 18:07:35 learn_server.go:279: [SIEVE-BEFORE-HEAR]	34	Updated	statefulset	{"metadata":{"name":"rabbitmq-cluster-server","namespace":"default","selfLink":"/apis/apps/v1/namespaces/default/statefulsets/rabbitmq-cluster-server","uid":"1d62d993-2c32-4da7-8884-e4cfad9e587d","resourceVersion":"1481","generation":1,"creationTimestamp":"2022-03-18T18:07:34Z","labels":{"app.kubernetes.io/component":"rabbitmq","app.kubernetes.io/name":"rabbitmq-cluster","app.kubernetes.io/part-of":"rabbitmq"},"ownerReferences":[{"apiVersion":"rabbitmq.com/v1beta1","kind":"RabbitmqCluster","name":"rabbitmq-cluster","uid":"3ecefa8a-1bec-48a7-9af4-dd0df3339101","controller":true,"blockOwnerDeletion":true}],"managedFields":[{"manager":"kube-controller-manager","operation":"Update","apiVersion":"apps/v1","time":"2022-03-18T18:07:34Z","fieldsType":"FieldsV1","fieldsV1":{"f:status":{"f:collisionCount":{},"f:currentReplicas":{},"f:currentRevision":{},"f:observedGeneration":{},"f:readyReplicas":{},"f:replicas":{},"f:updateRevision":{},"f:updatedReplicas":{}}}},{"manager":"manager","operation":"Update","apiVersion":"apps/v1","time":"2022-03-18T18:07:34Z","fieldsType":"FieldsV1","fieldsV1":{"f:metadata":{"f:labels":{".":{},"f:app.kubernetes.io/component":{},"f:app.kubernetes.io/name":{},"f:app.kubernetes.io/part-of":{}},"f:ownerReferences":{".":{},"k:{\"uid\":\"3ecefa8a-1bec-48a7-9af4-dd0df3339101\"}":{".":{},"f:apiVersion":{},"f:blockOwnerDeletion":{},"f:controller":{},"f:kind":{},"f:name":{},"f:uid":{}}}},"f:spec":{"f:podManagementPolicy":{},"f:replicas":{},"f:revisionHistoryLimit":{},"f:selector":{"f:matchLabels":{".":{},"f:app.kubernetes.io/name":{}}},"f:serviceName":{},"f:template":{"f:metadata":{"f:annotations":{".":{},"f:prometheus.io/port":{},"f:prometheus.io/scrape":{}},"f:labels":{".":{},"f:app.kubernetes.io/component":{},"f:app.kubernetes.io/name":{},"f:app.kubernetes.io/part-of":{}}},"f:spec":{"f:automountServiceAccountToken":{},"f:containers":{"k:{\"name\":\"rabbitmq\"}":{".":{},"f:env":{".":{},"k:{\"name\":\"K8S_HOSTNAME_SUFFIX\"}":{".":{},"f:name":{},"f:value":{}},"k:{\"name\":\"K8S_SERVICE_NAME\"}":{".":{},"f:name":{},"f:value":{}},"k:{\"name\":\"MY_POD_NAME\"}":{".":{},"f:name":{},"f:valueFrom":{".":{},"f:fieldRef":{".":{},"f:apiVersion":{},"f:fieldPath":{}}}},"k:{\"name\":\"MY_POD_NAMESPACE\"}":{".":{},"f:name":{},"f:valueFrom":{".":{},"f:fieldRef":{".":{},"f:apiVersion":{},"f:fieldPath":{}}}},"k:{\"name\":\"RABBITMQ_ENABLED_PLUGINS_FILE\"}":{".":{},"f:name":{},"f:value":{}},"k:{\"name\":\"RABBITMQ_NODENAME\"}":{".":{},"f:name":{},"f:value":{}},"k:{\"name\":\"RABBITMQ_USE_LONGNAME\"}":{".":{},"f:name":{},"f:value":{}}},"f:image":{},"f:imagePullPolicy":{},"f:lifecycle":{".":{},"f:preStop":{".":{},"f:exec":{".":{},"f:command":{}}}},"f:name":{},"f:ports":{".":{},"k:{\"containerPort\":4369,\"protocol\":\"TCP\"}":{".":{},"f:containerPort":{},"f:name":{},"f:protocol":{}},"k:{\"containerPort\":5672,\"protocol\":\"TCP\"}":{".":{},"f:containerPort":{},"f:name":{},"f:protocol":{}},"k:{\"containerPort\":15672,\"protocol\":\"TCP\"}":{".":{},"f:containerPort":{},"f:name":{},"f:protocol":{}},"k:{\"containerPort\":15692,\"protocol\":\"TCP\"}":{".":{},"f:containerPort":{},"f:name":{},"f:protocol":{}}},"f:readinessProbe":{".":{},"f:failureThreshold":{},"f:initialDelaySeconds":{},"f:periodSeconds":{},"f:successThreshold":{},"f:tcpSocket":{".":{},"f:port":{}},"f:timeoutSeconds":{}},"f:resources":{".":{},"f:limits":{".":{},"f:cpu":{},"f:memory":{}},"f:requests":{".":{},"f:cpu":{},"f:memory":{}}},"f:terminationMessagePath":{},"f:terminationMessagePolicy":{},"f:volumeMounts":{".":{},"k:{\"mountPath\":\"/etc/pod-info/\"}":{".":{},"f:mountPath":{},"f:name":{}},"k:{\"mountPath\":\"/etc/rabbitmq/conf.d/10-operatorDefaults.conf\"}":{".":{},"f:mountPath":{},"f:name":{},"f:subPath":{}},"k:{\"mountPath\":\"/etc/rabbitmq/conf.d/11-default_user.conf\"}":{".":{},"f:mountPath":{},"f:name":{},"f:subPath":{}},"k:{\"mountPath\":\"/etc/rabbitmq/conf.d/90-userDefinedConfiguration.conf\"}":{".":{},"f:mountPath":{},"f:name":{},"f:subPath":{}},"k:{\"mountPath\":\"/operator\"}":{".":{},"f:mountPath":{},"f:name":{}},"k:{\"mountPath\":\"/var/lib/rabbitmq/\"}":{".":{},"f:mountPath":{},"f:name":{}},"k:{\"mountPath\":\"/var/lib/rabbitmq/mnesia/\"}":{".":{},"f:mountPath":{},"f:name":{}}}}},"f:dnsPolicy":{},"f:initContainers":{".":{},"k:{\"name\":\"setup-container\"}":{".":{},"f:command":{},"f:image":{},"f:imagePullPolicy":{},"f:name":{},"f:resources":{".":{},"f:limits":{".":{},"f:cpu":{},"f:memory":{}},"f:requests":{".":{},"f:cpu":{},"f:memory":{}}},"f:securityContext":{".":{},"f:capabilities":{".":{},"f:drop":{}},"f:runAsUser":{}},"f:terminationMessagePath":{},"f:terminationMessagePolicy":{},"f:volumeMounts":{".":{},"k:{\"mountPath\":\"/operator\"}":{".":{},"f:mountPath":{},"f:name":{}},"k:{\"mountPath\":\"/tmp/default_user.conf\"}":{".":{},"f:mountPath":{},"f:name":{},"f:subPath":{}},"k:{\"mountPath\":\"/tmp/erlang-cookie-secret/\"}":{".":{},"f:mountPath":{},"f:name":{}},"k:{\"mountPath\":\"/tmp/rabbitmq-plugins/\"}":{".":{},"f:mountPath":{},"f:name":{}},"k:{\"mountPath\":\"/var/lib/rabbitmq/\"}":{".":{},"f:mountPath":{},"f:name":{}},"k:{\"mountPath\":\"/var/lib/rabbitmq/mnesia/\"}":{".":{},"f:mountPath":{},"f:name":{}}}}},"f:restartPolicy":{},"f:schedulerName":{},"f:securityContext":{".":{},"f:fsGroup":{},"f:runAsGroup":{},"f:runAsUser":{}},"f:serviceAccount":{},"f:serviceAccountName":{},"f:terminationGracePeriodSeconds":{},"f:topologySpreadConstraints":{".":{},"k:{\"topologyKey\":\"topology.kubernetes.io/zone\",\"whenUnsatisfiable\":\"ScheduleAnyway\"}":{".":{},"f:labelSelector":{".":{},"f:matchLabels":{".":{},"f:app.kubernetes.io/name":{}}},"f:maxSkew":{},"f:topologyKey":{},"f:whenUnsatisfiable":{}}},"f:volumes":{".":{},"k:{\"name\":\"erlang-cookie-secret\"}":{".":{},"f:name":{},"f:secret":{".":{},"f:defaultMode":{},"f:secretName":{}}},"k:{\"name\":\"plugins-conf\"}":{".":{},"f:configMap":{".":{},"f:defaultMode":{},"f:name":{}},"f:name":{}},"k:{\"name\":\"pod-info\"}":{".":{},"f:downwardAPI":{".":{},"f:defaultMode":{},"f:items":{}},"f:name":{}},"k:{\"name\":\"rabbitmq-confd\"}":{".":{},"f:name":{},"f:projected":{".":{},"f:defaultMode":{},"f:sources":{}}},"k:{\"name\":\"rabbitmq-erlang-cookie\"}":{".":{},"f:emptyDir":{},"f:name":{}},"k:{\"name\":\"rabbitmq-plugins\"}":{".":{},"f:emptyDir":{},"f:name":{}}}}},"f:updateStrategy":{"f:rollingUpdate":{".":{},"f:partition":{}},"f:type":{}},"f:volumeClaimTemplates":{}}}}]},"spec":{"replicas":1,"selector":{"matchLabels":{"app.kubernetes.io/name":"rabbitmq-cluster"}},"template":{"metadata":{"creationTimestamp":null,"labels":{"app.kubernetes.io/component":"rabbitmq","app.kubernetes.io/name":"rabbitmq-cluster","app.kubernetes.io/part-of":"rabbitmq"},"annotations":{"prometheus.io/port":"15692","prometheus.io/scrape":"true"}},"spec":{"volumes":[{"name":"plugins-conf","configMap":{"name":"rabbitmq-cluster-plugins-conf","defaultMode":420}},{"name":"rabbitmq-confd","projected":{"sources":[{"secret":{"name":"rabbitmq-cluster-default-user","items":[{"key":"default_user.conf","path":"default_user.conf"}]}},{"configMap":{"name":"rabbitmq-cluster-server-conf","items":[{"key":"operatorDefaults.conf","path":"operatorDefaults.conf"},{"key":"userDefinedConfiguration.conf","path":"userDefinedConfiguration.conf"}]}}],"defaultMode":420}},{"name":"rabbitmq-erlang-cookie","emptyDir":{}},{"name":"erlang-cookie-secret","secret":{"secretName":"rabbitmq-cluster-erlang-cookie","defaultMode":420}},{"name":"rabbitmq-plugins","emptyDir":{}},{"name":"pod-info","downwardAPI":{"items":[{"path":"skipPreStopChecks","fieldRef":{"apiVersion":"v1","fieldPath":"metadata.labels['skipPreStopChecks']"}}],"defaultMode":420}}],"initContainers":[{"name":"setup-container","image":"rabbitmq:3.8.12-management","command":["sh","-c","cp /tmp/erlang-cookie-secret/.erlang.cookie /var/lib/rabbitmq/.erlang.cookie \u0026\u0026 chown 999:999 /var/lib/rabbitmq/.erlang.cookie \u0026\u0026 chmod 600 /var/lib/rabbitmq/.erlang.cookie ; cp /tmp/rabbitmq-plugins/enabled_plugins /operator/enabled_plugins \u0026\u0026 chown 999:999 /operator/enabled_plugins ; chown 999:999 /var/lib/rabbitmq/mnesia/ ; echo '[default]' \u003e /var/lib/rabbitmq/.rabbitmqadmin.conf \u0026\u0026 sed -e 's/default_user/username/' -e 's/default_pass/password/' /tmp/default_user.conf \u003e\u003e /var/lib/rabbitmq/.rabbitmqadmin.conf \u0026\u0026 chown 999:999 /var/lib/rabbitmq/.rabbitmqadmin.conf \u0026\u0026 chmod 600 /var/lib/rabbitmq/.rabbitmqadmin.conf"],"resources":{"limits":{"cpu":"100m","memory":"500Mi"},"requests":{"cpu":"100m","memory":"500Mi"}},"volumeMounts":[{"name":"plugins-conf","mountPath":"/tmp/rabbitmq-plugins/"},{"name":"rabbitmq-erlang-cookie","mountPath":"/var/lib/rabbitmq/"},{"name":"erlang-cookie-secret","mountPath":"/tmp/erlang-cookie-secret/"},{"name":"rabbitmq-plugins","mountPath":"/operator"},{"name":"persistence","mountPath":"/var/lib/rabbitmq/mnesia/"},{"name":"rabbitmq-confd","mountPath":"/tmp/default_user.conf","subPath":"default_user.conf"}],"terminationMessagePath":"/dev/termination-log","terminationMessagePolicy":"File","imagePullPolicy":"IfNotPresent","securityContext":{"capabilities":{"drop":["FSETID","KILL","SETGID","SETUID","SETPCAP","NET_BIND_SERVICE","NET_RAW","SYS_CHROOT","MKNOD","AUDIT_WRITE","SETFCAP"]},"runAsUser":0}}],"containers":[{"name":"rabbitmq","image":"rabbitmq:3.8.12-management","ports":[{"name":"epmd","containerPort":4369,"protocol":"TCP"},{"name":"amqp","containerPort":5672,"protocol":"TCP"},{"name":"management","containerPort":15672,"protocol":"TCP"},{"name":"prometheus","containerPort":15692,"protocol":"TCP"}],"env":[{"name":"MY_POD_NAME","valueFrom":{"fieldRef":{"apiVersion":"v1","fieldPath":"metadata.name"}}},{"name":"MY_POD_NAMESPACE","valueFrom":{"fieldRef":{"apiVersion":"v1","fieldPath":"metadata.namespace"}}},{"name":"RABBITMQ_ENABLED_PLUGINS_FILE","value":"/operator/enabled_plugins"},{"name":"K8S_SERVICE_NAME","value":"rabbitmq-cluster-nodes"},{"name":"RABBITMQ_USE_LONGNAME","value":"true"},{"name":"RABBITMQ_NODENAME","value":"rabbit@$(MY_POD_NAME).$(K8S_SERVICE_NAME).$(MY_POD_NAMESPACE)"},{"name":"K8S_HOSTNAME_SUFFIX","value":".$(K8S_SERVICE_NAME).$(MY_POD_NAMESPACE)"}],"resources":{"limits":{"cpu":"2","memory":"2Gi"},"requests":{"cpu":"1","memory":"2Gi"}},"volumeMounts":[{"name":"rabbitmq-erlang-cookie","mountPath":"/var/lib/rabbitmq/"},{"name":"persistence","mountPath":"/var/lib/rabbitmq/mnesia/"},{"name":"rabbitmq-plugins","mountPath":"/operator"},{"name":"rabbitmq-confd","mountPath":"/etc/rabbitmq/conf.d/10-operatorDefaults.conf","subPath":"operatorDefaults.conf"},{"name":"rabbitmq-confd","mountPath":"/etc/rabbitmq/conf.d/11-default_user.conf","subPath":"default_user.conf"},{"name":"rabbitmq-confd","mountPath":"/etc/rabbitmq/conf.d/90-userDefinedConfiguration.conf","subPath":"userDefinedConfiguration.conf"},{"name":"pod-info","mountPath":"/etc/pod-info/"}],"readinessProbe":{"tcpSocket":{"port":"amqp"},"initialDelaySeconds":10,"timeoutSeconds":5,"periodSeconds":10,"successThreshold":1,"failureThreshold":3},"lifecycle":{"preStop":{"exec":{"command":["/bin/bash","-c","if [ ! -z \"$(cat /etc/pod-info/skipPreStopChecks)\" ]; then exit 0; fi; rabbitmq-upgrade await_online_quorum_plus_one -t 604800; rabbitmq-upgrade await_online_synchronized_mirror -t 604800; rabbitmq-upgrade drain -t 604800"]}}},"terminationMessagePath":"/dev/termination-log","terminationMessagePolicy":"File","imagePullPolicy":"IfNotPresent"}],"restartPolicy":"Always","terminationGracePeriodSeconds":604800,"dnsPolicy":"ClusterFirst","serviceAccountName":"rabbitmq-cluster-server","serviceAccount":"rabbitmq-cluster-server","automountServiceAccountToken":true,"securityContext":{"runAsUser":999,"runAsGroup":999,"fsGroup":999},"schedulerName":"default-scheduler","topologySpreadConstraints":[{"maxSkew":1,"topologyKey":"topology.kubernetes.io/zone","whenUnsatisfiable":"ScheduleAnyway","labelSelector":{"matchLabels":{"app.kubernetes.io/name":"rabbitmq-cluster"}}}]}},"volumeClaimTemplates":[{"metadata":{"name":"persistence","namespace":"default","creationTimestamp":null,"labels":{"app.kubernetes.io/component":"rabbitmq","app.kubernetes.io/name":"rabbitmq-cluster","app.kubernetes.io/part-of":"rabbitmq"},"ownerReferences":[{"apiVersion":"rabbitmq.com/v1beta1","kind":"RabbitmqCluster","name":"rabbitmq-cluster","uid":"3ecefa8a-1bec-48a7-9af4-dd0df3339101","controller":true,"blockOwnerDeletion":false}]},"spec":{"accessModes":["ReadWriteOnce"],"resources":{"requests":{"storage":"15Gi"}},"volumeMode":"Filesystem"},"status":{"phase":"Pending"}}],"serviceName":"rabbitmq-cluster-nodes","podManagementPolicy":"Parallel","updateStrategy":{"type":"RollingUpdate","rollingUpdate":{"partition":0}},"revisionHistoryLimit":10},"status":{"observedGeneration":1,"replicas":1,"readyReplicas":1,"currentReplicas":1,"updatedReplicas":1,"currentRevision":"rabbitmq-cluster-server-5f8b8665fb","updateRevision":"rabbitmq-cluster-server-5f8b8665fb","collisionCount":0}}
2022/03/18 18:07:35 learn_server.go:256: [SIEVE-BEFORE-WRITE]	47
2022/03/18 18:07:35 learn_server.go:289: [SIEVE-AFTER-HEAR]	34
2022/03/18 18:07:35 learn_server.go:263: [SIEVE-AFTER-WRITE]	47	StatusUpdate	rabbitmqcluster	github.com/rabbitmq/cluster-operator/controllers.(*RabbitmqClusterReconciler)	NoError	{"metadata":{"name":"rabbitmq-cluster","namespace":"default","selfLink":"/apis/rabbitmq.com/v1beta1/namespaces/default/rabbitmqclusters/rabbitmq-cluster/status","uid":"3ecefa8a-1bec-48a7-9af4-dd0df3339101","resourceVersion":"1473","generation":3,"creationTimestamp":"2022-03-18T18:06:25Z","annotations":{"kubectl.kubernetes.io/last-applied-configuration":"{\"apiVersion\":\"rabbitmq.com/v1beta1\",\"kind\":\"RabbitmqCluster\",\"metadata\":{\"annotations\":{},\"name\":\"rabbitmq-cluster\",\"namespace\":\"default\"},\"spec\":{\"persistence\":{\"storage\":\"10Gi\"},\"replicas\":1}}\n"},"finalizers":["deletion.finalizers.rabbitmqclusters.rabbitmq.com"],"managedFields":[{"manager":"kubectl-client-side-apply","operation":"Update","apiVersion":"rabbitmq.com/v1beta1","time":"2022-03-18T18:06:25Z","fieldsType":"FieldsV1","fieldsV1":{"f:metadata":{"f:annotations":{".":{},"f:kubectl.kubernetes.io/last-applied-configuration":{}}},"f:spec":{".":{},"f:image":{},"f:persistence":{},"f:replicas":{},"f:resources":{".":{},"f:limits":{".":{},"f:memory":{}},"f:requests":{".":{},"f:memory":{}}},"f:service":{".":{},"f:type":{}},"f:terminationGracePeriodSeconds":{}}}},{"manager":"kubectl-patch","operation":"Update","apiVersion":"rabbitmq.com/v1beta1","time":"2022-03-18T18:07:31Z","fieldsType":"FieldsV1","fieldsV1":{"f:spec":{"f:persistence":{"f:storage":{}}}}},{"manager":"manager","operation":"Update","apiVersion":"rabbitmq.com/v1beta1","time":"2022-03-18T18:07:34Z","fieldsType":"FieldsV1","fieldsV1":{"f:metadata":{"f:finalizers":{}},"f:spec":{"f:override":{},"f:rabbitmq":{},"f:resources":{"f:limits":{"f:cpu":{}},"f:requests":{"f:cpu":{}}},"f:tls":{}},"f:status":{".":{},"f:conditions":{},"f:defaultUser":{".":{},"f:secretReference":{".":{},"f:keys":{".":{},"f:password":{},"f:username":{}},"f:name":{},"f:namespace":{}},"f:serviceReference":{".":{},"f:name":{},"f:namespace":{}}}}}}]},"spec":{"replicas":1,"image":"rabbitmq:3.8.12-management","service":{"type":"ClusterIP"},"persistence":{"storage":"15Gi"},"resources":{"limits":{"cpu":"2","memory":"2Gi"},"requests":{"cpu":"1","memory":"2Gi"}},"rabbitmq":{},"tls":{},"override":{},"terminationGracePeriodSeconds":604800},"status":{"conditions":[{"type":"AllReplicasReady","status":"False","lastTransitionTime":"2022-03-18T18:07:34Z","reason":"NotAllPodsReady","message":"0/1 Pods ready"},{"type":"ClusterAvailable","status":"True","lastTransitionTime":"2022-03-18T18:07:23Z","reason":"AtLeastOneEndpointAvailable"},{"type":"NoWarnings","status":"True","lastTransitionTime":"2022-03-18T18:06:25Z","reason":"NoWarnings"},{"type":"ReconcileSuccess","status":"True","lastTransitionTime":"2022-03-18T18:07:24Z","reason":"Success","message":"Finish reconciling"}],"defaultUser":{"secretReference":{"name":"rabbitmq-cluster-default-user","namespace":"default","keys":{"password":"password","username":"username"}},"serviceReference":{"name":"rabbitmq-cluster","namespace":"default"}},"binding":{"name":"rabbitmq-cluster-default-user"}}}
2022/03/18 18:07:35 learn_server.go:253: [SIEVE-AFTER-RECONCILE]	github.com/rabbitmq/cluster-operator/controllers.(*RabbitmqClusterReconciler)	10
2022/03/18 18:07:35 learn_server.go:238: [SIEVE-BEFORE-RECONCILE]	github.com/rabbitmq/cluster-operator/controllers.(*RabbitmqClusterReconciler)	11
2022/03/18 18:07:35 learn_server.go:291: [SIEVE-AFTER-READ]	Get	true	rabbitmqcluster	default	rabbitmq-cluster	github.com/rabbitmq/cluster-operator/controllers.(*RabbitmqClusterReconciler)	NoError	{"kind":"RabbitmqCluster","apiVersion":"rabbitmq.com/v1beta1","metadata":{"name":"rabbitmq-cluster","namespace":"default","selfLink":"/apis/rabbitmq.com/v1beta1/namespaces/default/rabbitmqclusters/rabbitmq-cluster","uid":"3ecefa8a-1bec-48a7-9af4-dd0df3339101","resourceVersion":"1473","generation":3,"creationTimestamp":"2022-03-18T18:06:25Z","annotations":{"kubectl.kubernetes.io/last-applied-configuration":"{\"apiVersion\":\"rabbitmq.com/v1beta1\",\"kind\":\"RabbitmqCluster\",\"metadata\":{\"annotations\":{},\"name\":\"rabbitmq-cluster\",\"namespace\":\"default\"},\"spec\":{\"persistence\":{\"storage\":\"10Gi\"},\"replicas\":1}}\n"},"finalizers":["deletion.finalizers.rabbitmqclusters.rabbitmq.com"],"managedFields":[{"manager":"kubectl-client-side-apply","operation":"Update","apiVersion":"rabbitmq.com/v1beta1","time":"2022-03-18T18:06:25Z","fieldsType":"FieldsV1","fieldsV1":{"f:metadata":{"f:annotations":{".":{},"f:kubectl.kubernetes.io/last-applied-configuration":{}}},"f:spec":{".":{},"f:image":{},"f:persistence":{},"f:replicas":{},"f:resources":{".":{},"f:limits":{".":{},"f:memory":{}},"f:requests":{".":{},"f:memory":{}}},"f:service":{".":{},"f:type":{}},"f:terminationGracePeriodSeconds":{}}}},{"manager":"kubectl-patch","operation":"Update","apiVersion":"rabbitmq.com/v1beta1","time":"2022-03-18T18:07:31Z","fieldsType":"FieldsV1","fieldsV1":{"f:spec":{"f:persistence":{"f:storage":{}}}}},{"manager":"manager","operation":"Update","apiVersion":"rabbitmq.com/v1beta1","time":"2022-03-18T18:07:34Z","fieldsType":"FieldsV1","fieldsV1":{"f:metadata":{"f:finalizers":{}},"f:spec":{"f:override":{},"f:rabbitmq":{},"f:resources":{"f:limits":{"f:cpu":{}},"f:requests":{"f:cpu":{}}},"f:tls":{}},"f:status":{".":{},"f:conditions":{},"f:defaultUser":{".":{},"f:secretReference":{".":{},"f:keys":{".":{},"f:password":{},"f:username":{}},"f:name":{},"f:namespace":{}},"f:serviceReference":{".":{},"f:name":{},"f:namespace":{}}}}}}]},"spec":{"replicas":1,"image":"rabbitmq:3.8.12-management","service":{"type":"ClusterIP"},"persistence":{"storage":"15Gi"},"resources":{"limits":{"cpu":"2","memory":"2Gi"},"requests":{"cpu":"1","memory":"2Gi"}},"rabbitmq":{},"tls":{},"override":{},"terminationGracePeriodSeconds":604800},"status":{"conditions":[{"type":"AllReplicasReady","status":"False","lastTransitionTime":"2022-03-18T18:07:34Z","reason":"NotAllPodsReady","message":"0/1 Pods ready"},{"type":"ClusterAvailable","status":"True","lastTransitionTime":"2022-03-18T18:07:23Z","reason":"AtLeastOneEndpointAvailable"},{"type":"NoWarnings","status":"True","lastTransitionTime":"2022-03-18T18:06:25Z","reason":"NoWarnings"},{"type":"ReconcileSuccess","status":"True","lastTransitionTime":"2022-03-18T18:07:24Z","reason":"Success","message":"Finish reconciling"}],"defaultUser":{"secretReference":{"name":"rabbitmq-cluster-default-user","namespace":"default","keys":{"password":"password","username":"username"}},"serviceReference":{"name":"rabbitmq-cluster","namespace":"default"}}}}
2022/03/18 18:07:35 learn_server.go:291: [SIEVE-AFTER-READ]	Get	true	statefulset	default	rabbitmq-cluster-server	github.com/rabbitmq/cluster-operator/controllers.(*RabbitmqClusterReconciler)	NoError	{"kind":"StatefulSet","apiVersion":"apps/v1","metadata":{"name":"rabbitmq-cluster-server","namespace":"default","selfLink":"/apis/apps/v1/namespaces/default/statefulsets/rabbitmq-cluster-server","uid":"1d62d993-2c32-4da7-8884-e4cfad9e587d","resourceVersion":"1481","generation":1,"creationTimestamp":"2022-03-18T18:07:34Z","labels":{"app.kubernetes.io/component":"rabbitmq","app.kubernetes.io/name":"rabbitmq-cluster","app.kubernetes.io/part-of":"rabbitmq"},"ownerReferences":[{"apiVersion":"rabbitmq.com/v1beta1","kind":"RabbitmqCluster","name":"rabbitmq-cluster","uid":"3ecefa8a-1bec-48a7-9af4-dd0df3339101","controller":true,"blockOwnerDeletion":true}],"managedFields":[{"manager":"kube-controller-manager","operation":"Update","apiVersion":"apps/v1","time":"2022-03-18T18:07:34Z","fieldsType":"FieldsV1","fieldsV1":{"f:status":{"f:collisionCount":{},"f:currentReplicas":{},"f:currentRevision":{},"f:observedGeneration":{},"f:readyReplicas":{},"f:replicas":{},"f:updateRevision":{},"f:updatedReplicas":{}}}},{"manager":"manager","operation":"Update","apiVersion":"apps/v1","time":"2022-03-18T18:07:34Z","fieldsType":"FieldsV1","fieldsV1":{"f:metadata":{"f:labels":{".":{},"f:app.kubernetes.io/component":{},"f:app.kubernetes.io/name":{},"f:app.kubernetes.io/part-of":{}},"f:ownerReferences":{".":{},"k:{\"uid\":\"3ecefa8a-1bec-48a7-9af4-dd0df3339101\"}":{".":{},"f:apiVersion":{},"f:blockOwnerDeletion":{},"f:controller":{},"f:kind":{},"f:name":{},"f:uid":{}}}},"f:spec":{"f:podManagementPolicy":{},"f:replicas":{},"f:revisionHistoryLimit":{},"f:selector":{"f:matchLabels":{".":{},"f:app.kubernetes.io/name":{}}},"f:serviceName":{},"f:template":{"f:metadata":{"f:annotations":{".":{},"f:prometheus.io/port":{},"f:prometheus.io/scrape":{}},"f:labels":{".":{},"f:app.kubernetes.io/component":{},"f:app.kubernetes.io/name":{},"f:app.kubernetes.io/part-of":{}}},"f:spec":{"f:automountServiceAccountToken":{},"f:containers":{"k:{\"name\":\"rabbitmq\"}":{".":{},"f:env":{".":{},"k:{\"name\":\"K8S_HOSTNAME_SUFFIX\"}":{".":{},"f:name":{},"f:value":{}},"k:{\"name\":\"K8S_SERVICE_NAME\"}":{".":{},"f:name":{},"f:value":{}},"k:{\"name\":\"MY_POD_NAME\"}":{".":{},"f:name":{},"f:valueFrom":{".":{},"f:fieldRef":{".":{},"f:apiVersion":{},"f:fieldPath":{}}}},"k:{\"name\":\"MY_POD_NAMESPACE\"}":{".":{},"f:name":{},"f:valueFrom":{".":{},"f:fieldRef":{".":{},"f:apiVersion":{},"f:fieldPath":{}}}},"k:{\"name\":\"RABBITMQ_ENABLED_PLUGINS_FILE\"}":{".":{},"f:name":{},"f:value":{}},"k:{\"name\":\"RABBITMQ_NODENAME\"}":{".":{},"f:name":{},"f:value":{}},"k:{\"name\":\"RABBITMQ_USE_LONGNAME\"}":{".":{},"f:name":{},"f:value":{}}},"f:image":{},"f:imagePullPolicy":{},"f:lifecycle":{".":{},"f:preStop":{".":{},"f:exec":{".":{},"f:command":{}}}},"f:name":{},"f:ports":{".":{},"k:{\"containerPort\":4369,\"protocol\":\"TCP\"}":{".":{},"f:containerPort":{},"f:name":{},"f:protocol":{}},"k:{\"containerPort\":5672,\"protocol\":\"TCP\"}":{".":{},"f:containerPort":{},"f:name":{},"f:protocol":{}},"k:{\"containerPort\":15672,\"protocol\":\"TCP\"}":{".":{},"f:containerPort":{},"f:name":{},"f:protocol":{}},"k:{\"containerPort\":15692,\"protocol\":\"TCP\"}":{".":{},"f:containerPort":{},"f:name":{},"f:protocol":{}}},"f:readinessProbe":{".":{},"f:failureThreshold":{},"f:initialDelaySeconds":{},"f:periodSeconds":{},"f:successThreshold":{},"f:tcpSocket":{".":{},"f:port":{}},"f:timeoutSeconds":{}},"f:resources":{".":{},"f:limits":{".":{},"f:cpu":{},"f:memory":{}},"f:requests":{".":{},"f:cpu":{},"f:memory":{}}},"f:terminationMessagePath":{},"f:terminationMessagePolicy":{},"f:volumeMounts":{".":{},"k:{\"mountPath\":\"/etc/pod-info/\"}":{".":{},"f:mountPath":{},"f:name":{}},"k:{\"mountPath\":\"/etc/rabbitmq/conf.d/10-operatorDefaults.conf\"}":{".":{},"f:mountPath":{},"f:name":{},"f:subPath":{}},"k:{\"mountPath\":\"/etc/rabbitmq/conf.d/11-default_user.conf\"}":{".":{},"f:mountPath":{},"f:name":{},"f:subPath":{}},"k:{\"mountPath\":\"/etc/rabbitmq/conf.d/90-userDefinedConfiguration.conf\"}":{".":{},"f:mountPath":{},"f:name":{},"f:subPath":{}},"k:{\"mountPath\":\"/operator\"}":{".":{},"f:mountPath":{},"f:name":{}},"k:{\"mountPath\":\"/var/lib/rabbitmq/\"}":{".":{},"f:mountPath":{},"f:name":{}},"k:{\"mountPath\":\"/var/lib/rabbitmq/mnesia/\"}":{".":{},"f:mountPath":{},"f:name":{}}}}},"f:dnsPolicy":{},"f:initContainers":{".":{},"k:{\"name\":\"setup-container\"}":{".":{},"f:command":{},"f:image":{},"f:imagePullPolicy":{},"f:name":{},"f:resources":{".":{},"f:limits":{".":{},"f:cpu":{},"f:memory":{}},"f:requests":{".":{},"f:cpu":{},"f:memory":{}}},"f:securityContext":{".":{},"f:capabilities":{".":{},"f:drop":{}},"f:runAsUser":{}},"f:terminationMessagePath":{},"f:terminationMessagePolicy":{},"f:volumeMounts":{".":{},"k:{\"mountPath\":\"/operator\"}":{".":{},"f:mountPath":{},"f:name":{}},"k:{\"mountPath\":\"/tmp/default_user.conf\"}":{".":{},"f:mountPath":{},"f:name":{},"f:subPath":{}},"k:{\"mountPath\":\"/tmp/erlang-cookie-secret/\"}":{".":{},"f:mountPath":{},"f:name":{}},"k:{\"mountPath\":\"/tmp/rabbitmq-plugins/\"}":{".":{},"f:mountPath":{},"f:name":{}},"k:{\"mountPath\":\"/var/lib/rabbitmq/\"}":{".":{},"f:mountPath":{},"f:name":{}},"k:{\"mountPath\":\"/var/lib/rabbitmq/mnesia/\"}":{".":{},"f:mountPath":{},"f:name":{}}}}},"f:restartPolicy":{},"f:schedulerName":{},"f:securityContext":{".":{},"f:fsGroup":{},"f:runAsGroup":{},"f:runAsUser":{}},"f:serviceAccount":{},"f:serviceAccountName":{},"f:terminationGracePeriodSeconds":{},"f:topologySpreadConstraints":{".":{},"k:{\"topologyKey\":\"topology.kubernetes.io/zone\",\"whenUnsatisfiable\":\"ScheduleAnyway\"}":{".":{},"f:labelSelector":{".":{},"f:matchLabels":{".":{},"f:app.kubernetes.io/name":{}}},"f:maxSkew":{},"f:topologyKey":{},"f:whenUnsatisfiable":{}}},"f:volumes":{".":{},"k:{\"name\":\"erlang-cookie-secret\"}":{".":{},"f:name":{},"f:secret":{".":{},"f:defaultMode":{},"f:secretName":{}}},"k:{\"name\":\"plugins-conf\"}":{".":{},"f:configMap":{".":{},"f:defaultMode":{},"f:name":{}},"f:name":{}},"k:{\"name\":\"pod-info\"}":{".":{},"f:downwardAPI":{".":{},"f:defaultMode":{},"f:items":{}},"f:name":{}},"k:{\"name\":\"rabbitmq-confd\"}":{".":{},"f:name":{},"f:projected":{".":{},"f:defaultMode":{},"f:sources":{}}},"k:{\"name\":\"rabbitmq-erlang-cookie\"}":{".":{},"f:emptyDir":{},"f:name":{}},"k:{\"name\":\"rabbitmq-plugins\"}":{".":{},"f:emptyDir":{},"f:name":{}}}}},"f:updateStrategy":{"f:rollingUpdate":{".":{},"f:partition":{}},"f:type":{}},"f:volumeClaimTemplates":{}}}}]},"spec":{"replicas":1,"selector":{"matchLabels":{"app.kubernetes.io/name":"rabbitmq-cluster"}},"template":{"metadata":{"creationTimestamp":null,"labels":{"app.kubernetes.io/component":"rabbitmq","app.kubernetes.io/name":"rabbitmq-cluster","app.kubernetes.io/part-of":"rabbitmq"},"annotations":{"prometheus.io/port":"15692","prometheus.io/scrape":"true"}},"spec":{"volumes":[{"name":"plugins-conf","configMap":{"name":"rabbitmq-cluster-plugins-conf","defaultMode":420}},{"name":"rabbitmq-confd","projected":{"sources":[{"secret":{"name":"rabbitmq-cluster-default-user","items":[{"key":"default_user.conf","path":"default_user.conf"}]}},{"configMap":{"name":"rabbitmq-cluster-server-conf","items":[{"key":"operatorDefaults.conf","path":"operatorDefaults.conf"},{"key":"userDefinedConfiguration.conf","path":"userDefinedConfiguration.conf"}]}}],"defaultMode":420}},{"name":"rabbitmq-erlang-cookie","emptyDir":{}},{"name":"erlang-cookie-secret","secret":{"secretName":"rabbitmq-cluster-erlang-cookie","defaultMode":420}},{"name":"rabbitmq-plugins","emptyDir":{}},{"name":"pod-info","downwardAPI":{"items":[{"path":"skipPreStopChecks","fieldRef":{"apiVersion":"v1","fieldPath":"metadata.labels['skipPreStopChecks']"}}],"defaultMode":420}}],"initContainers":[{"name":"setup-container","image":"rabbitmq:3.8.12-management","command":["sh","-c","cp /tmp/erlang-cookie-secret/.erlang.cookie /var/lib/rabbitmq/.erlang.cookie \u0026\u0026 chown 999:999 /var/lib/rabbitmq/.erlang.cookie \u0026\u0026 chmod 600 /var/lib/rabbitmq/.erlang.cookie ; cp /tmp/rabbitmq-plugins/enabled_plugins /operator/enabled_plugins \u0026\u0026 chown 999:999 /operator/enabled_plugins ; chown 999:999 /var/lib/rabbitmq/mnesia/ ; echo '[default]' \u003e /var/lib/rabbitmq/.rabbitmqadmin.conf \u0026\u0026 sed -e 's/default_user/username/' -e 's/default_pass/password/' /tmp/default_user.conf \u003e\u003e /var/lib/rabbitmq/.rabbitmqadmin.conf \u0026\u0026 chown 999:999 /var/lib/rabbitmq/.rabbitmqadmin.conf \u0026\u0026 chmod 600 /var/lib/rabbitmq/.rabbitmqadmin.conf"],"resources":{"limits":{"cpu":"100m","memory":"500Mi"},"requests":{"cpu":"100m","memory":"500Mi"}},"volumeMounts":[{"name":"plugins-conf","mountPath":"/tmp/rabbitmq-plugins/"},{"name":"rabbitmq-erlang-cookie","mountPath":"/var/lib/rabbitmq/"},{"name":"erlang-cookie-secret","mountPath":"/tmp/erlang-cookie-secret/"},{"name":"rabbitmq-plugins","mountPath":"/operator"},{"name":"persistence","mountPath":"/var/lib/rabbitmq/mnesia/"},{"name":"rabbitmq-confd","mountPath":"/tmp/default_user.conf","subPath":"default_user.conf"}],"terminationMessagePath":"/dev/termination-log","terminationMessagePolicy":"File","imagePullPolicy":"IfNotPresent","securityContext":{"capabilities":{"drop":["FSETID","KILL","SETGID","SETUID","SETPCAP","NET_BIND_SERVICE","NET_RAW","SYS_CHROOT","MKNOD","AUDIT_WRITE","SETFCAP"]},"runAsUser":0}}],"containers":[{"name":"rabbitmq","image":"rabbitmq:3.8.12-management","ports":[{"name":"epmd","containerPort":4369,"protocol":"TCP"},{"name":"amqp","containerPort":5672,"protocol":"TCP"},{"name":"management","containerPort":15672,"protocol":"TCP"},{"name":"prometheus","containerPort":15692,"protocol":"TCP"}],"env":[{"name":"MY_POD_NAME","valueFrom":{"fieldRef":{"apiVersion":"v1","fieldPath":"metadata.name"}}},{"name":"MY_POD_NAMESPACE","valueFrom":{"fieldRef":{"apiVersion":"v1","fieldPath":"metadata.namespace"}}},{"name":"RABBITMQ_ENABLED_PLUGINS_FILE","value":"/operator/enabled_plugins"},{"name":"K8S_SERVICE_NAME","value":"rabbitmq-cluster-nodes"},{"name":"RABBITMQ_USE_LONGNAME","value":"true"},{"name":"RABBITMQ_NODENAME","value":"rabbit@$(MY_POD_NAME).$(K8S_SERVICE_NAME).$(MY_POD_NAMESPACE)"},{"name":"K8S_HOSTNAME_SUFFIX","value":".$(K8S_SERVICE_NAME).$(MY_POD_NAMESPACE)"}],"resources":{"limits":{"cpu":"2","memory":"2Gi"},"requests":{"cpu":"1","memory":"2Gi"}},"volumeMounts":[{"name":"rabbitmq-erlang-cookie","mountPath":"/var/lib/rabbitmq/"},{"name":"persistence","mountPath":"/var/lib/rabbitmq/mnesia/"},{"name":"rabbitmq-plugins","mountPath":"/operator"},{"name":"rabbitmq-confd","mountPath":"/etc/rabbitmq/conf.d/10-operatorDefaults.conf","subPath":"operatorDefaults.conf"},{"name":"rabbitmq-confd","mountPath":"/etc/rabbitmq/conf.d/11-default_user.conf","subPath":"default_user.conf"},{"name":"rabbitmq-confd","mountPath":"/etc/rabbitmq/conf.d/90-userDefinedConfiguration.conf","subPath":"userDefinedConfiguration.conf"},{"name":"pod-info","mountPath":"/etc/pod-info/"}],"readinessProbe":{"tcpSocket":{"port":"amqp"},"initialDelaySeconds":10,"timeoutSeconds":5,"periodSeconds":10,"successThreshold":1,"failureThreshold":3},"lifecycle":{"preStop":{"exec":{"command":["/bin/bash","-c","if [ ! -z \"$(cat /etc/pod-info/skipPreStopChecks)\" ]; then exit 0; fi; rabbitmq-upgrade await_online_quorum_plus_one -t 604800; rabbitmq-upgrade await_online_synchronized_mirror -t 604800; rabbitmq-upgrade drain -t 604800"]}}},"terminationMessagePath":"/dev/termination-log","terminationMessagePolicy":"File","imagePullPolicy":"IfNotPresent"}],"restartPolicy":"Always","terminationGracePeriodSeconds":604800,"dnsPolicy":"ClusterFirst","serviceAccountName":"rabbitmq-cluster-server","serviceAccount":"rabbitmq-cluster-server","automountServiceAccountToken":true,"securityContext":{"runAsUser":999,"runAsGroup":999,"fsGroup":999},"schedulerName":"default-scheduler","topologySpreadConstraints":[{"maxSkew":1,"topologyKey":"topology.kubernetes.io/zone","whenUnsatisfiable":"ScheduleAnyway","labelSelector":{"matchLabels":{"app.kubernetes.io/name":"rabbitmq-cluster"}}}]}},"volumeClaimTemplates":[{"metadata":{"name":"persistence","namespace":"default","creationTimestamp":null,"labels":{"app.kubernetes.io/component":"rabbitmq","app.kubernetes.io/name":"rabbitmq-cluster","app.kubernetes.io/part-of":"rabbitmq"},"ownerReferences":[{"apiVersion":"rabbitmq.com/v1beta1","kind":"RabbitmqCluster","name":"rabbitmq-cluster","uid":"3ecefa8a-1bec-48a7-9af4-dd0df3339101","controller":true,"blockOwnerDeletion":false}]},"spec":{"accessModes":["ReadWriteOnce"],"resources":{"requests":{"storage":"15Gi"}},"volumeMode":"Filesystem"},"status":{"phase":"Pending"}}],"serviceName":"rabbitmq-cluster-nodes","podManagementPolicy":"Parallel","updateStrategy":{"type":"RollingUpdate","rollingUpdate":{"partition":0}},"revisionHistoryLimit":10},"status":{"observedGeneration":1,"replicas":1,"readyReplicas":1,"currentReplicas":1,"updatedReplicas":1,"currentRevision":"rabbitmq-cluster-server-5f8b8665fb","updateRevision":"rabbitmq-cluster-server-5f8b8665fb","collisionCount":0}}
2022/03/18 18:07:35 learn_server.go:291: [SIEVE-AFTER-READ]	Get	true	endpoints	default	rabbitmq-cluster	github.com/rabbitmq/cluster-operator/controllers.(*RabbitmqClusterReconciler)	NoError	{"kind":"Endpoints","apiVersion":"v1","metadata":{"name":"rabbitmq-cluster","namespace":"default","selfLink":"/api/v1/namespaces/default/endpoints/rabbitmq-cluster","uid":"eeba9576-0362-4e74-aafd-71e4ffe98d25","resourceVersion":"1402","creationTimestamp":"2022-03-18T18:06:25Z","labels":{"app.kubernetes.io/component":"rabbitmq","app.kubernetes.io/name":"rabbitmq-cluster","app.kubernetes.io/part-of":"rabbitmq"},"annotations":{"endpoints.kubernetes.io/last-change-trigger-time":"2022-03-18T18:07:23Z"},"managedFields":[{"manager":"kube-controller-manager","operation":"Update","apiVersion":"v1","time":"2022-03-18T18:07:23Z","fieldsType":"FieldsV1","fieldsV1":{"f:metadata":{"f:annotations":{".":{},"f:endpoints.kubernetes.io/last-change-trigger-time":{}},"f:labels":{".":{},"f:app.kubernetes.io/component":{},"f:app.kubernetes.io/name":{},"f:app.kubernetes.io/part-of":{}}},"f:subsets":{}}}]},"subsets":[{"addresses":[{"ip":"10.244.1.4","nodeName":"kind-worker","targetRef":{"kind":"Pod","namespace":"default","name":"rabbitmq-cluster-server-0","uid":"cbaba199-5faf-480a-81e8-051ce2cc79e6","resourceVersion":"1399"}}],"ports":[{"name":"amqp","port":5672,"protocol":"TCP"},{"name":"management","port":15672,"protocol":"TCP"}]}]}
2022/03/18 18:07:35 learn_server.go:256: [SIEVE-BEFORE-WRITE]	48
2022/03/18 18:07:35 learn_server.go:263: [SIEVE-AFTER-WRITE]	48	StatusUpdate	rabbitmqcluster	github.com/rabbitmq/cluster-operator/controllers.(*RabbitmqClusterReconciler)	NoError	{"metadata":{"name":"rabbitmq-cluster","namespace":"default","selfLink":"/apis/rabbitmq.com/v1beta1/namespaces/default/rabbitmqclusters/rabbitmq-cluster/status","uid":"3ecefa8a-1bec-48a7-9af4-dd0df3339101","resourceVersion":"1482","generation":3,"creationTimestamp":"2022-03-18T18:06:25Z","annotations":{"kubectl.kubernetes.io/last-applied-configuration":"{\"apiVersion\":\"rabbitmq.com/v1beta1\",\"kind\":\"RabbitmqCluster\",\"metadata\":{\"annotations\":{},\"name\":\"rabbitmq-cluster\",\"namespace\":\"default\"},\"spec\":{\"persistence\":{\"storage\":\"10Gi\"},\"replicas\":1}}\n"},"finalizers":["deletion.finalizers.rabbitmqclusters.rabbitmq.com"],"managedFields":[{"manager":"kubectl-client-side-apply","operation":"Update","apiVersion":"rabbitmq.com/v1beta1","time":"2022-03-18T18:06:25Z","fieldsType":"FieldsV1","fieldsV1":{"f:metadata":{"f:annotations":{".":{},"f:kubectl.kubernetes.io/last-applied-configuration":{}}},"f:spec":{".":{},"f:image":{},"f:persistence":{},"f:replicas":{},"f:resources":{".":{},"f:limits":{".":{},"f:memory":{}},"f:requests":{".":{},"f:memory":{}}},"f:service":{".":{},"f:type":{}},"f:terminationGracePeriodSeconds":{}}}},{"manager":"kubectl-patch","operation":"Update","apiVersion":"rabbitmq.com/v1beta1","time":"2022-03-18T18:07:31Z","fieldsType":"FieldsV1","fieldsV1":{"f:spec":{"f:persistence":{"f:storage":{}}}}},{"manager":"manager","operation":"Update","apiVersion":"rabbitmq.com/v1beta1","time":"2022-03-18T18:07:35Z","fieldsType":"FieldsV1","fieldsV1":{"f:metadata":{"f:finalizers":{}},"f:spec":{"f:override":{},"f:rabbitmq":{},"f:resources":{"f:limits":{"f:cpu":{}},"f:requests":{"f:cpu":{}}},"f:tls":{}},"f:status":{".":{},"f:conditions":{},"f:defaultUser":{".":{},"f:secretReference":{".":{},"f:keys":{".":{},"f:password":{},"f:username":{}},"f:name":{},"f:namespace":{}},"f:serviceReference":{".":{},"f:name":{},"f:namespace":{}}}}}}]},"spec":{"replicas":1,"image":"rabbitmq:3.8.12-management","service":{"type":"ClusterIP"},"persistence":{"storage":"15Gi"},"resources":{"limits":{"cpu":"2","memory":"2Gi"},"requests":{"cpu":"1","memory":"2Gi"}},"rabbitmq":{},"tls":{},"override":{},"terminationGracePeriodSeconds":604800},"status":{"conditions":[{"type":"AllReplicasReady","status":"True","lastTransitionTime":"2022-03-18T18:07:35Z","reason":"AllPodsAreReady"},{"type":"ClusterAvailable","status":"True","lastTransitionTime":"2022-03-18T18:07:23Z","reason":"AtLeastOneEndpointAvailable"},{"type":"NoWarnings","status":"True","lastTransitionTime":"2022-03-18T18:06:25Z","reason":"NoWarnings"},{"type":"ReconcileSuccess","status":"True","lastTransitionTime":"2022-03-18T18:07:24Z","reason":"Success","message":"Finish reconciling"}],"defaultUser":{"secretReference":{"name":"rabbitmq-cluster-default-user","namespace":"default","keys":{"password":"password","username":"username"}},"serviceReference":{"name":"rabbitmq-cluster","namespace":"default"}}}}
2022/03/18 18:07:35 learn_server.go:279: [SIEVE-BEFORE-HEAR]	35	Updated	rabbitmqcluster	{"metadata":{"name":"rabbitmq-cluster","namespace":"default","selfLink":"/apis/rabbitmq.com/v1beta1/namespaces/default/rabbitmqclusters/rabbitmq-cluster","uid":"3ecefa8a-1bec-48a7-9af4-dd0df3339101","resourceVersion":"1482","generation":3,"creationTimestamp":"2022-03-18T18:06:25Z","annotations":{"kubectl.kubernetes.io/last-applied-configuration":"{\"apiVersion\":\"rabbitmq.com/v1beta1\",\"kind\":\"RabbitmqCluster\",\"metadata\":{\"annotations\":{},\"name\":\"rabbitmq-cluster\",\"namespace\":\"default\"},\"spec\":{\"persistence\":{\"storage\":\"10Gi\"},\"replicas\":1}}\n"},"finalizers":["deletion.finalizers.rabbitmqclusters.rabbitmq.com"],"managedFields":[{"manager":"kubectl-client-side-apply","operation":"Update","apiVersion":"rabbitmq.com/v1beta1","time":"2022-03-18T18:06:25Z","fieldsType":"FieldsV1","fieldsV1":{"f:metadata":{"f:annotations":{".":{},"f:kubectl.kubernetes.io/last-applied-configuration":{}}},"f:spec":{".":{},"f:image":{},"f:persistence":{},"f:replicas":{},"f:resources":{".":{},"f:limits":{".":{},"f:memory":{}},"f:requests":{".":{},"f:memory":{}}},"f:service":{".":{},"f:type":{}},"f:terminationGracePeriodSeconds":{}}}},{"manager":"kubectl-patch","operation":"Update","apiVersion":"rabbitmq.com/v1beta1","time":"2022-03-18T18:07:31Z","fieldsType":"FieldsV1","fieldsV1":{"f:spec":{"f:persistence":{"f:storage":{}}}}},{"manager":"manager","operation":"Update","apiVersion":"rabbitmq.com/v1beta1","time":"2022-03-18T18:07:35Z","fieldsType":"FieldsV1","fieldsV1":{"f:metadata":{"f:finalizers":{}},"f:spec":{"f:override":{},"f:rabbitmq":{},"f:resources":{"f:limits":{"f:cpu":{}},"f:requests":{"f:cpu":{}}},"f:tls":{}},"f:status":{".":{},"f:conditions":{},"f:defaultUser":{".":{},"f:secretReference":{".":{},"f:keys":{".":{},"f:password":{},"f:username":{}},"f:name":{},"f:namespace":{}},"f:serviceReference":{".":{},"f:name":{},"f:namespace":{}}}}}}]},"spec":{"replicas":1,"image":"rabbitmq:3.8.12-management","service":{"type":"ClusterIP"},"persistence":{"storage":"15Gi"},"resources":{"limits":{"cpu":"2","memory":"2Gi"},"requests":{"cpu":"1","memory":"2Gi"}},"rabbitmq":{},"tls":{},"override":{},"terminationGracePeriodSeconds":604800},"status":{"conditions":[{"type":"AllReplicasReady","status":"True","lastTransitionTime":"2022-03-18T18:07:35Z","reason":"AllPodsAreReady"},{"type":"ClusterAvailable","status":"True","lastTransitionTime":"2022-03-18T18:07:23Z","reason":"AtLeastOneEndpointAvailable"},{"type":"NoWarnings","status":"True","lastTransitionTime":"2022-03-18T18:06:25Z","reason":"NoWarnings"},{"type":"ReconcileSuccess","status":"True","lastTransitionTime":"2022-03-18T18:07:24Z","reason":"Success","message":"Finish reconciling"}],"defaultUser":{"secretReference":{"name":"rabbitmq-cluster-default-user","namespace":"default","keys":{"password":"password","username":"username"}},"serviceReference":{"name":"rabbitmq-cluster","namespace":"default"}}}}
2022/03/18 18:07:35 learn_server.go:291: [SIEVE-AFTER-READ]	Get	true	statefulset	default	rabbitmq-cluster-server	github.com/rabbitmq/cluster-operator/controllers.(*RabbitmqClusterReconciler)	NoError	{"kind":"StatefulSet","apiVersion":"apps/v1","metadata":{"name":"rabbitmq-cluster-server","namespace":"default","selfLink":"/apis/apps/v1/namespaces/default/statefulsets/rabbitmq-cluster-server","uid":"1d62d993-2c32-4da7-8884-e4cfad9e587d","resourceVersion":"1481","generation":1,"creationTimestamp":"2022-03-18T18:07:34Z","labels":{"app.kubernetes.io/component":"rabbitmq","app.kubernetes.io/name":"rabbitmq-cluster","app.kubernetes.io/part-of":"rabbitmq"},"ownerReferences":[{"apiVersion":"rabbitmq.com/v1beta1","kind":"RabbitmqCluster","name":"rabbitmq-cluster","uid":"3ecefa8a-1bec-48a7-9af4-dd0df3339101","controller":true,"blockOwnerDeletion":true}],"managedFields":[{"manager":"kube-controller-manager","operation":"Update","apiVersion":"apps/v1","time":"2022-03-18T18:07:34Z","fieldsType":"FieldsV1","fieldsV1":{"f:status":{"f:collisionCount":{},"f:currentReplicas":{},"f:currentRevision":{},"f:observedGeneration":{},"f:readyReplicas":{},"f:replicas":{},"f:updateRevision":{},"f:updatedReplicas":{}}}},{"manager":"manager","operation":"Update","apiVersion":"apps/v1","time":"2022-03-18T18:07:34Z","fieldsType":"FieldsV1","fieldsV1":{"f:metadata":{"f:labels":{".":{},"f:app.kubernetes.io/component":{},"f:app.kubernetes.io/name":{},"f:app.kubernetes.io/part-of":{}},"f:ownerReferences":{".":{},"k:{\"uid\":\"3ecefa8a-1bec-48a7-9af4-dd0df3339101\"}":{".":{},"f:apiVersion":{},"f:blockOwnerDeletion":{},"f:controller":{},"f:kind":{},"f:name":{},"f:uid":{}}}},"f:spec":{"f:podManagementPolicy":{},"f:replicas":{},"f:revisionHistoryLimit":{},"f:selector":{"f:matchLabels":{".":{},"f:app.kubernetes.io/name":{}}},"f:serviceName":{},"f:template":{"f:metadata":{"f:annotations":{".":{},"f:prometheus.io/port":{},"f:prometheus.io/scrape":{}},"f:labels":{".":{},"f:app.kubernetes.io/component":{},"f:app.kubernetes.io/name":{},"f:app.kubernetes.io/part-of":{}}},"f:spec":{"f:automountServiceAccountToken":{},"f:containers":{"k:{\"name\":\"rabbitmq\"}":{".":{},"f:env":{".":{},"k:{\"name\":\"K8S_HOSTNAME_SUFFIX\"}":{".":{},"f:name":{},"f:value":{}},"k:{\"name\":\"K8S_SERVICE_NAME\"}":{".":{},"f:name":{},"f:value":{}},"k:{\"name\":\"MY_POD_NAME\"}":{".":{},"f:name":{},"f:valueFrom":{".":{},"f:fieldRef":{".":{},"f:apiVersion":{},"f:fieldPath":{}}}},"k:{\"name\":\"MY_POD_NAMESPACE\"}":{".":{},"f:name":{},"f:valueFrom":{".":{},"f:fieldRef":{".":{},"f:apiVersion":{},"f:fieldPath":{}}}},"k:{\"name\":\"RABBITMQ_ENABLED_PLUGINS_FILE\"}":{".":{},"f:name":{},"f:value":{}},"k:{\"name\":\"RABBITMQ_NODENAME\"}":{".":{},"f:name":{},"f:value":{}},"k:{\"name\":\"RABBITMQ_USE_LONGNAME\"}":{".":{},"f:name":{},"f:value":{}}},"f:image":{},"f:imagePullPolicy":{},"f:lifecycle":{".":{},"f:preStop":{".":{},"f:exec":{".":{},"f:command":{}}}},"f:name":{},"f:ports":{".":{},"k:{\"containerPort\":4369,\"protocol\":\"TCP\"}":{".":{},"f:containerPort":{},"f:name":{},"f:protocol":{}},"k:{\"containerPort\":5672,\"protocol\":\"TCP\"}":{".":{},"f:containerPort":{},"f:name":{},"f:protocol":{}},"k:{\"containerPort\":15672,\"protocol\":\"TCP\"}":{".":{},"f:containerPort":{},"f:name":{},"f:protocol":{}},"k:{\"containerPort\":15692,\"protocol\":\"TCP\"}":{".":{},"f:containerPort":{},"f:name":{},"f:protocol":{}}},"f:readinessProbe":{".":{},"f:failureThreshold":{},"f:initialDelaySeconds":{},"f:periodSeconds":{},"f:successThreshold":{},"f:tcpSocket":{".":{},"f:port":{}},"f:timeoutSeconds":{}},"f:resources":{".":{},"f:limits":{".":{},"f:cpu":{},"f:memory":{}},"f:requests":{".":{},"f:cpu":{},"f:memory":{}}},"f:terminationMessagePath":{},"f:terminationMessagePolicy":{},"f:volumeMounts":{".":{},"k:{\"mountPath\":\"/etc/pod-info/\"}":{".":{},"f:mountPath":{},"f:name":{}},"k:{\"mountPath\":\"/etc/rabbitmq/conf.d/10-operatorDefaults.conf\"}":{".":{},"f:mountPath":{},"f:name":{},"f:subPath":{}},"k:{\"mountPath\":\"/etc/rabbitmq/conf.d/11-default_user.conf\"}":{".":{},"f:mountPath":{},"f:name":{},"f:subPath":{}},"k:{\"mountPath\":\"/etc/rabbitmq/conf.d/90-userDefinedConfiguration.conf\"}":{".":{},"f:mountPath":{},"f:name":{},"f:subPath":{}},"k:{\"mountPath\":\"/operator\"}":{".":{},"f:mountPath":{},"f:name":{}},"k:{\"mountPath\":\"/var/lib/rabbitmq/\"}":{".":{},"f:mountPath":{},"f:name":{}},"k:{\"mountPath\":\"/var/lib/rabbitmq/mnesia/\"}":{".":{},"f:mountPath":{},"f:name":{}}}}},"f:dnsPolicy":{},"f:initContainers":{".":{},"k:{\"name\":\"setup-container\"}":{".":{},"f:command":{},"f:image":{},"f:imagePullPolicy":{},"f:name":{},"f:resources":{".":{},"f:limits":{".":{},"f:cpu":{},"f:memory":{}},"f:requests":{".":{},"f:cpu":{},"f:memory":{}}},"f:securityContext":{".":{},"f:capabilities":{".":{},"f:drop":{}},"f:runAsUser":{}},"f:terminationMessagePath":{},"f:terminationMessagePolicy":{},"f:volumeMounts":{".":{},"k:{\"mountPath\":\"/operator\"}":{".":{},"f:mountPath":{},"f:name":{}},"k:{\"mountPath\":\"/tmp/default_user.conf\"}":{".":{},"f:mountPath":{},"f:name":{},"f:subPath":{}},"k:{\"mountPath\":\"/tmp/erlang-cookie-secret/\"}":{".":{},"f:mountPath":{},"f:name":{}},"k:{\"mountPath\":\"/tmp/rabbitmq-plugins/\"}":{".":{},"f:mountPath":{},"f:name":{}},"k:{\"mountPath\":\"/var/lib/rabbitmq/\"}":{".":{},"f:mountPath":{},"f:name":{}},"k:{\"mountPath\":\"/var/lib/rabbitmq/mnesia/\"}":{".":{},"f:mountPath":{},"f:name":{}}}}},"f:restartPolicy":{},"f:schedulerName":{},"f:securityContext":{".":{},"f:fsGroup":{},"f:runAsGroup":{},"f:runAsUser":{}},"f:serviceAccount":{},"f:serviceAccountName":{},"f:terminationGracePeriodSeconds":{},"f:topologySpreadConstraints":{".":{},"k:{\"topologyKey\":\"topology.kubernetes.io/zone\",\"whenUnsatisfiable\":\"ScheduleAnyway\"}":{".":{},"f:labelSelector":{".":{},"f:matchLabels":{".":{},"f:app.kubernetes.io/name":{}}},"f:maxSkew":{},"f:topologyKey":{},"f:whenUnsatisfiable":{}}},"f:volumes":{".":{},"k:{\"name\":\"erlang-cookie-secret\"}":{".":{},"f:name":{},"f:secret":{".":{},"f:defaultMode":{},"f:secretName":{}}},"k:{\"name\":\"plugins-conf\"}":{".":{},"f:configMap":{".":{},"f:defaultMode":{},"f:name":{}},"f:name":{}},"k:{\"name\":\"pod-info\"}":{".":{},"f:downwardAPI":{".":{},"f:defaultMode":{},"f:items":{}},"f:name":{}},"k:{\"name\":\"rabbitmq-confd\"}":{".":{},"f:name":{},"f:projected":{".":{},"f:defaultMode":{},"f:sources":{}}},"k:{\"name\":\"rabbitmq-erlang-cookie\"}":{".":{},"f:emptyDir":{},"f:name":{}},"k:{\"name\":\"rabbitmq-plugins\"}":{".":{},"f:emptyDir":{},"f:name":{}}}}},"f:updateStrategy":{"f:rollingUpdate":{".":{},"f:partition":{}},"f:type":{}},"f:volumeClaimTemplates":{}}}}]},"spec":{"replicas":1,"selector":{"matchLabels":{"app.kubernetes.io/name":"rabbitmq-cluster"}},"template":{"metadata":{"creationTimestamp":null,"labels":{"app.kubernetes.io/component":"rabbitmq","app.kubernetes.io/name":"rabbitmq-cluster","app.kubernetes.io/part-of":"rabbitmq"},"annotations":{"prometheus.io/port":"15692","prometheus.io/scrape":"true"}},"spec":{"volumes":[{"name":"plugins-conf","configMap":{"name":"rabbitmq-cluster-plugins-conf","defaultMode":420}},{"name":"rabbitmq-confd","projected":{"sources":[{"secret":{"name":"rabbitmq-cluster-default-user","items":[{"key":"default_user.conf","path":"default_user.conf"}]}},{"configMap":{"name":"rabbitmq-cluster-server-conf","items":[{"key":"operatorDefaults.conf","path":"operatorDefaults.conf"},{"key":"userDefinedConfiguration.conf","path":"userDefinedConfiguration.conf"}]}}],"defaultMode":420}},{"name":"rabbitmq-erlang-cookie","emptyDir":{}},{"name":"erlang-cookie-secret","secret":{"secretName":"rabbitmq-cluster-erlang-cookie","defaultMode":420}},{"name":"rabbitmq-plugins","emptyDir":{}},{"name":"pod-info","downwardAPI":{"items":[{"path":"skipPreStopChecks","fieldRef":{"apiVersion":"v1","fieldPath":"metadata.labels['skipPreStopChecks']"}}],"defaultMode":420}}],"initContainers":[{"name":"setup-container","image":"rabbitmq:3.8.12-management","command":["sh","-c","cp /tmp/erlang-cookie-secret/.erlang.cookie /var/lib/rabbitmq/.erlang.cookie \u0026\u0026 chown 999:999 /var/lib/rabbitmq/.erlang.cookie \u0026\u0026 chmod 600 /var/lib/rabbitmq/.erlang.cookie ; cp /tmp/rabbitmq-plugins/enabled_plugins /operator/enabled_plugins \u0026\u0026 chown 999:999 /operator/enabled_plugins ; chown 999:999 /var/lib/rabbitmq/mnesia/ ; echo '[default]' \u003e /var/lib/rabbitmq/.rabbitmqadmin.conf \u0026\u0026 sed -e 's/default_user/username/' -e 's/default_pass/password/' /tmp/default_user.conf \u003e\u003e /var/lib/rabbitmq/.rabbitmqadmin.conf \u0026\u0026 chown 999:999 /var/lib/rabbitmq/.rabbitmqadmin.conf \u0026\u0026 chmod 600 /var/lib/rabbitmq/.rabbitmqadmin.conf"],"resources":{"limits":{"cpu":"100m","memory":"500Mi"},"requests":{"cpu":"100m","memory":"500Mi"}},"volumeMounts":[{"name":"plugins-conf","mountPath":"/tmp/rabbitmq-plugins/"},{"name":"rabbitmq-erlang-cookie","mountPath":"/var/lib/rabbitmq/"},{"name":"erlang-cookie-secret","mountPath":"/tmp/erlang-cookie-secret/"},{"name":"rabbitmq-plugins","mountPath":"/operator"},{"name":"persistence","mountPath":"/var/lib/rabbitmq/mnesia/"},{"name":"rabbitmq-confd","mountPath":"/tmp/default_user.conf","subPath":"default_user.conf"}],"terminationMessagePath":"/dev/termination-log","terminationMessagePolicy":"File","imagePullPolicy":"IfNotPresent","securityContext":{"capabilities":{"drop":["FSETID","KILL","SETGID","SETUID","SETPCAP","NET_BIND_SERVICE","NET_RAW","SYS_CHROOT","MKNOD","AUDIT_WRITE","SETFCAP"]},"runAsUser":0}}],"containers":[{"name":"rabbitmq","image":"rabbitmq:3.8.12-management","ports":[{"name":"epmd","containerPort":4369,"protocol":"TCP"},{"name":"amqp","containerPort":5672,"protocol":"TCP"},{"name":"management","containerPort":15672,"protocol":"TCP"},{"name":"prometheus","containerPort":15692,"protocol":"TCP"}],"env":[{"name":"MY_POD_NAME","valueFrom":{"fieldRef":{"apiVersion":"v1","fieldPath":"metadata.name"}}},{"name":"MY_POD_NAMESPACE","valueFrom":{"fieldRef":{"apiVersion":"v1","fieldPath":"metadata.namespace"}}},{"name":"RABBITMQ_ENABLED_PLUGINS_FILE","value":"/operator/enabled_plugins"},{"name":"K8S_SERVICE_NAME","value":"rabbitmq-cluster-nodes"},{"name":"RABBITMQ_USE_LONGNAME","value":"true"},{"name":"RABBITMQ_NODENAME","value":"rabbit@$(MY_POD_NAME).$(K8S_SERVICE_NAME).$(MY_POD_NAMESPACE)"},{"name":"K8S_HOSTNAME_SUFFIX","value":".$(K8S_SERVICE_NAME).$(MY_POD_NAMESPACE)"}],"resources":{"limits":{"cpu":"2","memory":"2Gi"},"requests":{"cpu":"1","memory":"2Gi"}},"volumeMounts":[{"name":"rabbitmq-erlang-cookie","mountPath":"/var/lib/rabbitmq/"},{"name":"persistence","mountPath":"/var/lib/rabbitmq/mnesia/"},{"name":"rabbitmq-plugins","mountPath":"/operator"},{"name":"rabbitmq-confd","mountPath":"/etc/rabbitmq/conf.d/10-operatorDefaults.conf","subPath":"operatorDefaults.conf"},{"name":"rabbitmq-confd","mountPath":"/etc/rabbitmq/conf.d/11-default_user.conf","subPath":"default_user.conf"},{"name":"rabbitmq-confd","mountPath":"/etc/rabbitmq/conf.d/90-userDefinedConfiguration.conf","subPath":"userDefinedConfiguration.conf"},{"name":"pod-info","mountPath":"/etc/pod-info/"}],"readinessProbe":{"tcpSocket":{"port":"amqp"},"initialDelaySeconds":10,"timeoutSeconds":5,"periodSeconds":10,"successThreshold":1,"failureThreshold":3},"lifecycle":{"preStop":{"exec":{"command":["/bin/bash","-c","if [ ! -z \"$(cat /etc/pod-info/skipPreStopChecks)\" ]; then exit 0; fi; rabbitmq-upgrade await_online_quorum_plus_one -t 604800; rabbitmq-upgrade await_online_synchronized_mirror -t 604800; rabbitmq-upgrade drain -t 604800"]}}},"terminationMessagePath":"/dev/termination-log","terminationMessagePolicy":"File","imagePullPolicy":"IfNotPresent"}],"restartPolicy":"Always","terminationGracePeriodSeconds":604800,"dnsPolicy":"ClusterFirst","serviceAccountName":"rabbitmq-cluster-server","serviceAccount":"rabbitmq-cluster-server","automountServiceAccountToken":true,"securityContext":{"runAsUser":999,"runAsGroup":999,"fsGroup":999},"schedulerName":"default-scheduler","topologySpreadConstraints":[{"maxSkew":1,"topologyKey":"topology.kubernetes.io/zone","whenUnsatisfiable":"ScheduleAnyway","labelSelector":{"matchLabels":{"app.kubernetes.io/name":"rabbitmq-cluster"}}}]}},"volumeClaimTemplates":[{"metadata":{"name":"persistence","namespace":"default","creationTimestamp":null,"labels":{"app.kubernetes.io/component":"rabbitmq","app.kubernetes.io/name":"rabbitmq-cluster","app.kubernetes.io/part-of":"rabbitmq"},"ownerReferences":[{"apiVersion":"rabbitmq.com/v1beta1","kind":"RabbitmqCluster","name":"rabbitmq-cluster","uid":"3ecefa8a-1bec-48a7-9af4-dd0df3339101","controller":true,"blockOwnerDeletion":false}]},"spec":{"accessModes":["ReadWriteOnce"],"resources":{"requests":{"storage":"15Gi"}},"volumeMode":"Filesystem"},"status":{"phase":"Pending"}}],"serviceName":"rabbitmq-cluster-nodes","podManagementPolicy":"Parallel","updateStrategy":{"type":"RollingUpdate","rollingUpdate":{"partition":0}},"revisionHistoryLimit":10},"status":{"observedGeneration":1,"replicas":1,"readyReplicas":1,"currentReplicas":1,"updatedReplicas":1,"currentRevision":"rabbitmq-cluster-server-5f8b8665fb","updateRevision":"rabbitmq-cluster-server-5f8b8665fb","collisionCount":0}}
2022/03/18 18:07:35 learn_server.go:289: [SIEVE-AFTER-HEAR]	35
2022/03/18 18:07:35 learn_server.go:291: [SIEVE-AFTER-READ]	Get	true	service	default	rabbitmq-cluster-nodes	github.com/rabbitmq/cluster-operator/controllers.(*RabbitmqClusterReconciler)	NoError	{"kind":"Service","apiVersion":"v1","metadata":{"name":"rabbitmq-cluster-nodes","namespace":"default","selfLink":"/api/v1/namespaces/default/services/rabbitmq-cluster-nodes","uid":"f843e1c2-ced0-463d-87c1-0e127aaa2006","resourceVersion":"1080","creationTimestamp":"2022-03-18T18:06:25Z","labels":{"app.kubernetes.io/component":"rabbitmq","app.kubernetes.io/name":"rabbitmq-cluster","app.kubernetes.io/part-of":"rabbitmq"},"ownerReferences":[{"apiVersion":"rabbitmq.com/v1beta1","kind":"RabbitmqCluster","name":"rabbitmq-cluster","uid":"3ecefa8a-1bec-48a7-9af4-dd0df3339101","controller":true,"blockOwnerDeletion":true}],"managedFields":[{"manager":"manager","operation":"Update","apiVersion":"v1","time":"2022-03-18T18:06:25Z","fieldsType":"FieldsV1","fieldsV1":{"f:metadata":{"f:labels":{".":{},"f:app.kubernetes.io/component":{},"f:app.kubernetes.io/name":{},"f:app.kubernetes.io/part-of":{}},"f:ownerReferences":{".":{},"k:{\"uid\":\"3ecefa8a-1bec-48a7-9af4-dd0df3339101\"}":{".":{},"f:apiVersion":{},"f:blockOwnerDeletion":{},"f:controller":{},"f:kind":{},"f:name":{},"f:uid":{}}}},"f:spec":{"f:clusterIP":{},"f:ports":{".":{},"k:{\"port\":4369,\"protocol\":\"TCP\"}":{".":{},"f:name":{},"f:port":{},"f:protocol":{},"f:targetPort":{}},"k:{\"port\":25672,\"protocol\":\"TCP\"}":{".":{},"f:name":{},"f:port":{},"f:protocol":{},"f:targetPort":{}}},"f:publishNotReadyAddresses":{},"f:selector":{".":{},"f:app.kubernetes.io/name":{}},"f:sessionAffinity":{},"f:type":{}}}}]},"spec":{"ports":[{"name":"epmd","protocol":"TCP","port":4369,"targetPort":4369},{"name":"cluster-rpc","protocol":"TCP","port":25672,"targetPort":25672}],"selector":{"app.kubernetes.io/name":"rabbitmq-cluster"},"clusterIP":"None","type":"ClusterIP","sessionAffinity":"None","publishNotReadyAddresses":true},"status":{"loadBalancer":{}}}
2022/03/18 18:07:35 learn_server.go:291: [SIEVE-AFTER-READ]	Get	true	service	default	rabbitmq-cluster	github.com/rabbitmq/cluster-operator/controllers.(*RabbitmqClusterReconciler)	NoError	{"kind":"Service","apiVersion":"v1","metadata":{"name":"rabbitmq-cluster","namespace":"default","selfLink":"/api/v1/namespaces/default/services/rabbitmq-cluster","uid":"ae846a70-784e-49ca-99a0-2b0cefb93b46","resourceVersion":"1085","creationTimestamp":"2022-03-18T18:06:25Z","labels":{"app.kubernetes.io/component":"rabbitmq","app.kubernetes.io/name":"rabbitmq-cluster","app.kubernetes.io/part-of":"rabbitmq"},"ownerReferences":[{"apiVersion":"rabbitmq.com/v1beta1","kind":"RabbitmqCluster","name":"rabbitmq-cluster","uid":"3ecefa8a-1bec-48a7-9af4-dd0df3339101","controller":true,"blockOwnerDeletion":true}],"managedFields":[{"manager":"manager","operation":"Update","apiVersion":"v1","time":"2022-03-18T18:06:25Z","fieldsType":"FieldsV1","fieldsV1":{"f:metadata":{"f:labels":{".":{},"f:app.kubernetes.io/component":{},"f:app.kubernetes.io/name":{},"f:app.kubernetes.io/part-of":{}},"f:ownerReferences":{".":{},"k:{\"uid\":\"3ecefa8a-1bec-48a7-9af4-dd0df3339101\"}":{".":{},"f:apiVersion":{},"f:blockOwnerDeletion":{},"f:controller":{},"f:kind":{},"f:name":{},"f:uid":{}}}},"f:spec":{"f:ports":{".":{},"k:{\"port\":5672,\"protocol\":\"TCP\"}":{".":{},"f:name":{},"f:port":{},"f:protocol":{},"f:targetPort":{}},"k:{\"port\":15672,\"protocol\":\"TCP\"}":{".":{},"f:name":{},"f:port":{},"f:protocol":{},"f:targetPort":{}}},"f:selector":{".":{},"f:app.kubernetes.io/name":{}},"f:sessionAffinity":{},"f:type":{}}}}]},"spec":{"ports":[{"name":"amqp","protocol":"TCP","port":5672,"targetPort":5672},{"name":"management","protocol":"TCP","port":15672,"targetPort":15672}],"selector":{"app.kubernetes.io/name":"rabbitmq-cluster"},"clusterIP":"10.96.47.189","type":"ClusterIP","sessionAffinity":"None"},"status":{"loadBalancer":{}}}
2022/03/18 18:07:35 learn_server.go:291: [SIEVE-AFTER-READ]	Get	true	secret	default	rabbitmq-cluster-erlang-cookie	github.com/rabbitmq/cluster-operator/controllers.(*RabbitmqClusterReconciler)	NoError	{"kind":"Secret","apiVersion":"v1","metadata":{"name":"rabbitmq-cluster-erlang-cookie","namespace":"default","selfLink":"/api/v1/namespaces/default/secrets/rabbitmq-cluster-erlang-cookie","uid":"01d8d8ad-080a-4c3f-9d27-56616c53dd26","resourceVersion":"1088","creationTimestamp":"2022-03-18T18:06:25Z","labels":{"app.kubernetes.io/component":"rabbitmq","app.kubernetes.io/name":"rabbitmq-cluster","app.kubernetes.io/part-of":"rabbitmq"},"ownerReferences":[{"apiVersion":"rabbitmq.com/v1beta1","kind":"RabbitmqCluster","name":"rabbitmq-cluster","uid":"3ecefa8a-1bec-48a7-9af4-dd0df3339101","controller":true,"blockOwnerDeletion":true}],"managedFields":[{"manager":"manager","operation":"Update","apiVersion":"v1","time":"2022-03-18T18:06:25Z","fieldsType":"FieldsV1","fieldsV1":{"f:data":{".":{},"f:.erlang.cookie":{}},"f:metadata":{"f:labels":{".":{},"f:app.kubernetes.io/component":{},"f:app.kubernetes.io/name":{},"f:app.kubernetes.io/part-of":{}},"f:ownerReferences":{".":{},"k:{\"uid\":\"3ecefa8a-1bec-48a7-9af4-dd0df3339101\"}":{".":{},"f:apiVersion":{},"f:blockOwnerDeletion":{},"f:controller":{},"f:kind":{},"f:name":{},"f:uid":{}}}},"f:type":{}}}]},"data":{".erlang.cookie":"ajdscUtLdnBpR1NwUUMwc1V3a2VyTlJxU2tVUTdBeEw="},"type":"Opaque"}
2022/03/18 18:07:35 learn_server.go:291: [SIEVE-AFTER-READ]	Get	true	secret	default	rabbitmq-cluster-default-user	github.com/rabbitmq/cluster-operator/controllers.(*RabbitmqClusterReconciler)	NoError	{"kind":"Secret","apiVersion":"v1","metadata":{"name":"rabbitmq-cluster-default-user","namespace":"default","selfLink":"/api/v1/namespaces/default/secrets/rabbitmq-cluster-default-user","uid":"b2f5a936-e51f-4488-b6e9-ca23e4d95ac2","resourceVersion":"1091","creationTimestamp":"2022-03-18T18:06:25Z","labels":{"app.kubernetes.io/component":"rabbitmq","app.kubernetes.io/name":"rabbitmq-cluster","app.kubernetes.io/part-of":"rabbitmq"},"ownerReferences":[{"apiVersion":"rabbitmq.com/v1beta1","kind":"RabbitmqCluster","name":"rabbitmq-cluster","uid":"3ecefa8a-1bec-48a7-9af4-dd0df3339101","controller":true,"blockOwnerDeletion":true}],"managedFields":[{"manager":"manager","operation":"Update","apiVersion":"v1","time":"2022-03-18T18:06:25Z","fieldsType":"FieldsV1","fieldsV1":{"f:data":{".":{},"f:default_user.conf":{},"f:password":{},"f:provider":{},"f:type":{},"f:username":{}},"f:metadata":{"f:labels":{".":{},"f:app.kubernetes.io/component":{},"f:app.kubernetes.io/name":{},"f:app.kubernetes.io/part-of":{}},"f:ownerReferences":{".":{},"k:{\"uid\":\"3ecefa8a-1bec-48a7-9af4-dd0df3339101\"}":{".":{},"f:apiVersion":{},"f:blockOwnerDeletion":{},"f:controller":{},"f:kind":{},"f:name":{},"f:uid":{}}}},"f:type":{}}}]},"data":{"default_user.conf":"ZGVmYXVsdF91c2VyID0gdEFMN1otZTgzR29ocEtsZ0Z4cUFFV3ZXemEtcjdJQW8KZGVmYXVsdF9wYXNzID0gdXVocndkTkdOcmJXQ2p6NFZPX0NUZE9OYURkSUpoRkoK","password":"dXVocndkTkdOcmJXQ2p6NFZPX0NUZE9OYURkSUpoRko=","provider":"cmFiYml0bXE=","type":"cmFiYml0bXE=","username":"dEFMN1otZTgzR29ocEtsZ0Z4cUFFV3ZXemEtcjdJQW8="},"type":"Opaque"}
2022/03/18 18:07:35 learn_server.go:291: [SIEVE-AFTER-READ]	Get	true	configmap	default	rabbitmq-cluster-plugins-conf	github.com/rabbitmq/cluster-operator/controllers.(*RabbitmqClusterReconciler)	NoError	{"kind":"ConfigMap","apiVersion":"v1","metadata":{"name":"rabbitmq-cluster-plugins-conf","namespace":"default","selfLink":"/api/v1/namespaces/default/configmaps/rabbitmq-cluster-plugins-conf","uid":"0aa26eb6-ff3a-4457-a223-284c897db7fe","resourceVersion":"1092","creationTimestamp":"2022-03-18T18:06:25Z","labels":{"app.kubernetes.io/component":"rabbitmq","app.kubernetes.io/name":"rabbitmq-cluster","app.kubernetes.io/part-of":"rabbitmq"},"ownerReferences":[{"apiVersion":"rabbitmq.com/v1beta1","kind":"RabbitmqCluster","name":"rabbitmq-cluster","uid":"3ecefa8a-1bec-48a7-9af4-dd0df3339101","controller":true,"blockOwnerDeletion":true}],"managedFields":[{"manager":"manager","operation":"Update","apiVersion":"v1","time":"2022-03-18T18:06:25Z","fieldsType":"FieldsV1","fieldsV1":{"f:data":{".":{},"f:enabled_plugins":{}},"f:metadata":{"f:labels":{".":{},"f:app.kubernetes.io/component":{},"f:app.kubernetes.io/name":{},"f:app.kubernetes.io/part-of":{}},"f:ownerReferences":{".":{},"k:{\"uid\":\"3ecefa8a-1bec-48a7-9af4-dd0df3339101\"}":{".":{},"f:apiVersion":{},"f:blockOwnerDeletion":{},"f:controller":{},"f:kind":{},"f:name":{},"f:uid":{}}}}}}]},"data":{"enabled_plugins":"[rabbitmq_peer_discovery_k8s,rabbitmq_prometheus,rabbitmq_management]."}}
2022/03/18 18:07:35 learn_server.go:291: [SIEVE-AFTER-READ]	Get	true	configmap	default	rabbitmq-cluster-server-conf	github.com/rabbitmq/cluster-operator/controllers.(*RabbitmqClusterReconciler)	NoError	{"kind":"ConfigMap","apiVersion":"v1","metadata":{"name":"rabbitmq-cluster-server-conf","namespace":"default","selfLink":"/api/v1/namespaces/default/configmaps/rabbitmq-cluster-server-conf","uid":"e4182078-d429-4baf-9021-72618c509ac5","resourceVersion":"1095","creationTimestamp":"2022-03-18T18:06:25Z","labels":{"app.kubernetes.io/component":"rabbitmq","app.kubernetes.io/name":"rabbitmq-cluster","app.kubernetes.io/part-of":"rabbitmq"},"ownerReferences":[{"apiVersion":"rabbitmq.com/v1beta1","kind":"RabbitmqCluster","name":"rabbitmq-cluster","uid":"3ecefa8a-1bec-48a7-9af4-dd0df3339101","controller":true,"blockOwnerDeletion":true}],"managedFields":[{"manager":"manager","operation":"Update","apiVersion":"v1","time":"2022-03-18T18:06:25Z","fieldsType":"FieldsV1","fieldsV1":{"f:data":{".":{},"f:operatorDefaults.conf":{},"f:userDefinedConfiguration.conf":{}},"f:metadata":{"f:labels":{".":{},"f:app.kubernetes.io/component":{},"f:app.kubernetes.io/name":{},"f:app.kubernetes.io/part-of":{}},"f:ownerReferences":{".":{},"k:{\"uid\":\"3ecefa8a-1bec-48a7-9af4-dd0df3339101\"}":{".":{},"f:apiVersion":{},"f:blockOwnerDeletion":{},"f:controller":{},"f:kind":{},"f:name":{},"f:uid":{}}}}}}]},"data":{"operatorDefaults.conf":"cluster_formation.peer_discovery_backend             = rabbit_peer_discovery_k8s\ncluster_formation.k8s.host                           = kubernetes.default\ncluster_formation.k8s.address_type                   = hostname\ncluster_partition_handling                           = pause_minority\nqueue_master_locator                                 = min-masters\ndisk_free_limit.absolute                             = 2GB\ncluster_formation.randomized_startup_delay_range.min = 5\ncluster_formation.randomized_startup_delay_range.max = 30\ncluster_name                                         = rabbitmq-cluster\n","userDefinedConfiguration.conf":"total_memory_available_override_value = 1717986919\n"}}
2022/03/18 18:07:35 learn_server.go:291: [SIEVE-AFTER-READ]	Get	true	serviceaccount	default	rabbitmq-cluster-server	github.com/rabbitmq/cluster-operator/controllers.(*RabbitmqClusterReconciler)	NoError	{"kind":"ServiceAccount","apiVersion":"v1","metadata":{"name":"rabbitmq-cluster-server","namespace":"default","selfLink":"/api/v1/namespaces/default/serviceaccounts/rabbitmq-cluster-server","uid":"0c3cead0-37dd-452b-b939-fe346a5dfdea","resourceVersion":"1102","creationTimestamp":"2022-03-18T18:06:25Z","labels":{"app.kubernetes.io/component":"rabbitmq","app.kubernetes.io/name":"rabbitmq-cluster","app.kubernetes.io/part-of":"rabbitmq"},"ownerReferences":[{"apiVersion":"rabbitmq.com/v1beta1","kind":"RabbitmqCluster","name":"rabbitmq-cluster","uid":"3ecefa8a-1bec-48a7-9af4-dd0df3339101","controller":true,"blockOwnerDeletion":true}],"managedFields":[{"manager":"kube-controller-manager","operation":"Update","apiVersion":"v1","time":"2022-03-18T18:06:25Z","fieldsType":"FieldsV1","fieldsV1":{"f:secrets":{".":{},"k:{\"name\":\"rabbitmq-cluster-server-token-v4wpv\"}":{".":{},"f:name":{}}}}},{"manager":"manager","operation":"Update","apiVersion":"v1","time":"2022-03-18T18:06:25Z","fieldsType":"FieldsV1","fieldsV1":{"f:metadata":{"f:labels":{".":{},"f:app.kubernetes.io/component":{},"f:app.kubernetes.io/name":{},"f:app.kubernetes.io/part-of":{}},"f:ownerReferences":{".":{},"k:{\"uid\":\"3ecefa8a-1bec-48a7-9af4-dd0df3339101\"}":{".":{},"f:apiVersion":{},"f:blockOwnerDeletion":{},"f:controller":{},"f:kind":{},"f:name":{},"f:uid":{}}}}}}]},"secrets":[{"name":"rabbitmq-cluster-server-token-v4wpv"}]}
2022/03/18 18:07:35 learn_server.go:291: [SIEVE-AFTER-READ]	Get	true	role	default	rabbitmq-cluster-peer-discovery	github.com/rabbitmq/cluster-operator/controllers.(*RabbitmqClusterReconciler)	NoError	{"kind":"Role","apiVersion":"rbac.authorization.k8s.io/v1","metadata":{"name":"rabbitmq-cluster-peer-discovery","namespace":"default","selfLink":"/apis/rbac.authorization.k8s.io/v1/namespaces/default/roles/rabbitmq-cluster-peer-discovery","uid":"ec9ac474-1880-43ed-af46-9ea5f46d6db4","resourceVersion":"1103","creationTimestamp":"2022-03-18T18:06:25Z","labels":{"app.kubernetes.io/component":"rabbitmq","app.kubernetes.io/name":"rabbitmq-cluster","app.kubernetes.io/part-of":"rabbitmq"},"ownerReferences":[{"apiVersion":"rabbitmq.com/v1beta1","kind":"RabbitmqCluster","name":"rabbitmq-cluster","uid":"3ecefa8a-1bec-48a7-9af4-dd0df3339101","controller":true,"blockOwnerDeletion":true}],"managedFields":[{"manager":"manager","operation":"Update","apiVersion":"rbac.authorization.k8s.io/v1","time":"2022-03-18T18:06:25Z","fieldsType":"FieldsV1","fieldsV1":{"f:metadata":{"f:labels":{".":{},"f:app.kubernetes.io/component":{},"f:app.kubernetes.io/name":{},"f:app.kubernetes.io/part-of":{}},"f:ownerReferences":{".":{},"k:{\"uid\":\"3ecefa8a-1bec-48a7-9af4-dd0df3339101\"}":{".":{},"f:apiVersion":{},"f:blockOwnerDeletion":{},"f:controller":{},"f:kind":{},"f:name":{},"f:uid":{}}}},"f:rules":{}}}]},"rules":[{"verbs":["get"],"apiGroups":[""],"resources":["endpoints"]},{"verbs":["create"],"apiGroups":[""],"resources":["events"]}]}
2022/03/18 18:07:35 learn_server.go:291: [SIEVE-AFTER-READ]	Get	true	rolebinding	default	rabbitmq-cluster-server	github.com/rabbitmq/cluster-operator/controllers.(*RabbitmqClusterReconciler)	NoError	{"kind":"RoleBinding","apiVersion":"rbac.authorization.k8s.io/v1","metadata":{"name":"rabbitmq-cluster-server","namespace":"default","selfLink":"/apis/rbac.authorization.k8s.io/v1/namespaces/default/rolebindings/rabbitmq-cluster-server","uid":"fe69a41c-8d28-4b84-a9f6-a9e6044d75ba","resourceVersion":"1105","creationTimestamp":"2022-03-18T18:06:25Z","labels":{"app.kubernetes.io/component":"rabbitmq","app.kubernetes.io/name":"rabbitmq-cluster","app.kubernetes.io/part-of":"rabbitmq"},"ownerReferences":[{"apiVersion":"rabbitmq.com/v1beta1","kind":"RabbitmqCluster","name":"rabbitmq-cluster","uid":"3ecefa8a-1bec-48a7-9af4-dd0df3339101","controller":true,"blockOwnerDeletion":true}],"managedFields":[{"manager":"manager","operation":"Update","apiVersion":"rbac.authorization.k8s.io/v1","time":"2022-03-18T18:06:25Z","fieldsType":"FieldsV1","fieldsV1":{"f:metadata":{"f:labels":{".":{},"f:app.kubernetes.io/component":{},"f:app.kubernetes.io/name":{},"f:app.kubernetes.io/part-of":{}},"f:ownerReferences":{".":{},"k:{\"uid\":\"3ecefa8a-1bec-48a7-9af4-dd0df3339101\"}":{".":{},"f:apiVersion":{},"f:blockOwnerDeletion":{},"f:controller":{},"f:kind":{},"f:name":{},"f:uid":{}}}},"f:roleRef":{"f:apiGroup":{},"f:kind":{},"f:name":{}},"f:subjects":{}}}]},"subjects":[{"kind":"ServiceAccount","name":"rabbitmq-cluster-server"}],"roleRef":{"apiGroup":"rbac.authorization.k8s.io","kind":"Role","name":"rabbitmq-cluster-peer-discovery"}}
2022/03/18 18:07:35 learn_server.go:291: [SIEVE-AFTER-READ]	Get	true	statefulset	default	rabbitmq-cluster-server	github.com/rabbitmq/cluster-operator/controllers.(*RabbitmqClusterReconciler)	NoError	{"kind":"StatefulSet","apiVersion":"apps/v1","metadata":{"name":"rabbitmq-cluster-server","namespace":"default","selfLink":"/apis/apps/v1/namespaces/default/statefulsets/rabbitmq-cluster-server","uid":"1d62d993-2c32-4da7-8884-e4cfad9e587d","resourceVersion":"1481","generation":1,"creationTimestamp":"2022-03-18T18:07:34Z","labels":{"app.kubernetes.io/component":"rabbitmq","app.kubernetes.io/name":"rabbitmq-cluster","app.kubernetes.io/part-of":"rabbitmq"},"ownerReferences":[{"apiVersion":"rabbitmq.com/v1beta1","kind":"RabbitmqCluster","name":"rabbitmq-cluster","uid":"3ecefa8a-1bec-48a7-9af4-dd0df3339101","controller":true,"blockOwnerDeletion":true}],"managedFields":[{"manager":"kube-controller-manager","operation":"Update","apiVersion":"apps/v1","time":"2022-03-18T18:07:34Z","fieldsType":"FieldsV1","fieldsV1":{"f:status":{"f:collisionCount":{},"f:currentReplicas":{},"f:currentRevision":{},"f:observedGeneration":{},"f:readyReplicas":{},"f:replicas":{},"f:updateRevision":{},"f:updatedReplicas":{}}}},{"manager":"manager","operation":"Update","apiVersion":"apps/v1","time":"2022-03-18T18:07:34Z","fieldsType":"FieldsV1","fieldsV1":{"f:metadata":{"f:labels":{".":{},"f:app.kubernetes.io/component":{},"f:app.kubernetes.io/name":{},"f:app.kubernetes.io/part-of":{}},"f:ownerReferences":{".":{},"k:{\"uid\":\"3ecefa8a-1bec-48a7-9af4-dd0df3339101\"}":{".":{},"f:apiVersion":{},"f:blockOwnerDeletion":{},"f:controller":{},"f:kind":{},"f:name":{},"f:uid":{}}}},"f:spec":{"f:podManagementPolicy":{},"f:replicas":{},"f:revisionHistoryLimit":{},"f:selector":{"f:matchLabels":{".":{},"f:app.kubernetes.io/name":{}}},"f:serviceName":{},"f:template":{"f:metadata":{"f:annotations":{".":{},"f:prometheus.io/port":{},"f:prometheus.io/scrape":{}},"f:labels":{".":{},"f:app.kubernetes.io/component":{},"f:app.kubernetes.io/name":{},"f:app.kubernetes.io/part-of":{}}},"f:spec":{"f:automountServiceAccountToken":{},"f:containers":{"k:{\"name\":\"rabbitmq\"}":{".":{},"f:env":{".":{},"k:{\"name\":\"K8S_HOSTNAME_SUFFIX\"}":{".":{},"f:name":{},"f:value":{}},"k:{\"name\":\"K8S_SERVICE_NAME\"}":{".":{},"f:name":{},"f:value":{}},"k:{\"name\":\"MY_POD_NAME\"}":{".":{},"f:name":{},"f:valueFrom":{".":{},"f:fieldRef":{".":{},"f:apiVersion":{},"f:fieldPath":{}}}},"k:{\"name\":\"MY_POD_NAMESPACE\"}":{".":{},"f:name":{},"f:valueFrom":{".":{},"f:fieldRef":{".":{},"f:apiVersion":{},"f:fieldPath":{}}}},"k:{\"name\":\"RABBITMQ_ENABLED_PLUGINS_FILE\"}":{".":{},"f:name":{},"f:value":{}},"k:{\"name\":\"RABBITMQ_NODENAME\"}":{".":{},"f:name":{},"f:value":{}},"k:{\"name\":\"RABBITMQ_USE_LONGNAME\"}":{".":{},"f:name":{},"f:value":{}}},"f:image":{},"f:imagePullPolicy":{},"f:lifecycle":{".":{},"f:preStop":{".":{},"f:exec":{".":{},"f:command":{}}}},"f:name":{},"f:ports":{".":{},"k:{\"containerPort\":4369,\"protocol\":\"TCP\"}":{".":{},"f:containerPort":{},"f:name":{},"f:protocol":{}},"k:{\"containerPort\":5672,\"protocol\":\"TCP\"}":{".":{},"f:containerPort":{},"f:name":{},"f:protocol":{}},"k:{\"containerPort\":15672,\"protocol\":\"TCP\"}":{".":{},"f:containerPort":{},"f:name":{},"f:protocol":{}},"k:{\"containerPort\":15692,\"protocol\":\"TCP\"}":{".":{},"f:containerPort":{},"f:name":{},"f:protocol":{}}},"f:readinessProbe":{".":{},"f:failureThreshold":{},"f:initialDelaySeconds":{},"f:periodSeconds":{},"f:successThreshold":{},"f:tcpSocket":{".":{},"f:port":{}},"f:timeoutSeconds":{}},"f:resources":{".":{},"f:limits":{".":{},"f:cpu":{},"f:memory":{}},"f:requests":{".":{},"f:cpu":{},"f:memory":{}}},"f:terminationMessagePath":{},"f:terminationMessagePolicy":{},"f:volumeMounts":{".":{},"k:{\"mountPath\":\"/etc/pod-info/\"}":{".":{},"f:mountPath":{},"f:name":{}},"k:{\"mountPath\":\"/etc/rabbitmq/conf.d/10-operatorDefaults.conf\"}":{".":{},"f:mountPath":{},"f:name":{},"f:subPath":{}},"k:{\"mountPath\":\"/etc/rabbitmq/conf.d/11-default_user.conf\"}":{".":{},"f:mountPath":{},"f:name":{},"f:subPath":{}},"k:{\"mountPath\":\"/etc/rabbitmq/conf.d/90-userDefinedConfiguration.conf\"}":{".":{},"f:mountPath":{},"f:name":{},"f:subPath":{}},"k:{\"mountPath\":\"/operator\"}":{".":{},"f:mountPath":{},"f:name":{}},"k:{\"mountPath\":\"/var/lib/rabbitmq/\"}":{".":{},"f:mountPath":{},"f:name":{}},"k:{\"mountPath\":\"/var/lib/rabbitmq/mnesia/\"}":{".":{},"f:mountPath":{},"f:name":{}}}}},"f:dnsPolicy":{},"f:initContainers":{".":{},"k:{\"name\":\"setup-container\"}":{".":{},"f:command":{},"f:image":{},"f:imagePullPolicy":{},"f:name":{},"f:resources":{".":{},"f:limits":{".":{},"f:cpu":{},"f:memory":{}},"f:requests":{".":{},"f:cpu":{},"f:memory":{}}},"f:securityContext":{".":{},"f:capabilities":{".":{},"f:drop":{}},"f:runAsUser":{}},"f:terminationMessagePath":{},"f:terminationMessagePolicy":{},"f:volumeMounts":{".":{},"k:{\"mountPath\":\"/operator\"}":{".":{},"f:mountPath":{},"f:name":{}},"k:{\"mountPath\":\"/tmp/default_user.conf\"}":{".":{},"f:mountPath":{},"f:name":{},"f:subPath":{}},"k:{\"mountPath\":\"/tmp/erlang-cookie-secret/\"}":{".":{},"f:mountPath":{},"f:name":{}},"k:{\"mountPath\":\"/tmp/rabbitmq-plugins/\"}":{".":{},"f:mountPath":{},"f:name":{}},"k:{\"mountPath\":\"/var/lib/rabbitmq/\"}":{".":{},"f:mountPath":{},"f:name":{}},"k:{\"mountPath\":\"/var/lib/rabbitmq/mnesia/\"}":{".":{},"f:mountPath":{},"f:name":{}}}}},"f:restartPolicy":{},"f:schedulerName":{},"f:securityContext":{".":{},"f:fsGroup":{},"f:runAsGroup":{},"f:runAsUser":{}},"f:serviceAccount":{},"f:serviceAccountName":{},"f:terminationGracePeriodSeconds":{},"f:topologySpreadConstraints":{".":{},"k:{\"topologyKey\":\"topology.kubernetes.io/zone\",\"whenUnsatisfiable\":\"ScheduleAnyway\"}":{".":{},"f:labelSelector":{".":{},"f:matchLabels":{".":{},"f:app.kubernetes.io/name":{}}},"f:maxSkew":{},"f:topologyKey":{},"f:whenUnsatisfiable":{}}},"f:volumes":{".":{},"k:{\"name\":\"erlang-cookie-secret\"}":{".":{},"f:name":{},"f:secret":{".":{},"f:defaultMode":{},"f:secretName":{}}},"k:{\"name\":\"plugins-conf\"}":{".":{},"f:configMap":{".":{},"f:defaultMode":{},"f:name":{}},"f:name":{}},"k:{\"name\":\"pod-info\"}":{".":{},"f:downwardAPI":{".":{},"f:defaultMode":{},"f:items":{}},"f:name":{}},"k:{\"name\":\"rabbitmq-confd\"}":{".":{},"f:name":{},"f:projected":{".":{},"f:defaultMode":{},"f:sources":{}}},"k:{\"name\":\"rabbitmq-erlang-cookie\"}":{".":{},"f:emptyDir":{},"f:name":{}},"k:{\"name\":\"rabbitmq-plugins\"}":{".":{},"f:emptyDir":{},"f:name":{}}}}},"f:updateStrategy":{"f:rollingUpdate":{".":{},"f:partition":{}},"f:type":{}},"f:volumeClaimTemplates":{}}}}]},"spec":{"replicas":1,"selector":{"matchLabels":{"app.kubernetes.io/name":"rabbitmq-cluster"}},"template":{"metadata":{"creationTimestamp":null,"labels":{"app.kubernetes.io/component":"rabbitmq","app.kubernetes.io/name":"rabbitmq-cluster","app.kubernetes.io/part-of":"rabbitmq"},"annotations":{"prometheus.io/port":"15692","prometheus.io/scrape":"true"}},"spec":{"volumes":[{"name":"plugins-conf","configMap":{"name":"rabbitmq-cluster-plugins-conf","defaultMode":420}},{"name":"rabbitmq-confd","projected":{"sources":[{"secret":{"name":"rabbitmq-cluster-default-user","items":[{"key":"default_user.conf","path":"default_user.conf"}]}},{"configMap":{"name":"rabbitmq-cluster-server-conf","items":[{"key":"operatorDefaults.conf","path":"operatorDefaults.conf"},{"key":"userDefinedConfiguration.conf","path":"userDefinedConfiguration.conf"}]}}],"defaultMode":420}},{"name":"rabbitmq-erlang-cookie","emptyDir":{}},{"name":"erlang-cookie-secret","secret":{"secretName":"rabbitmq-cluster-erlang-cookie","defaultMode":420}},{"name":"rabbitmq-plugins","emptyDir":{}},{"name":"pod-info","downwardAPI":{"items":[{"path":"skipPreStopChecks","fieldRef":{"apiVersion":"v1","fieldPath":"metadata.labels['skipPreStopChecks']"}}],"defaultMode":420}}],"initContainers":[{"name":"setup-container","image":"rabbitmq:3.8.12-management","command":["sh","-c","cp /tmp/erlang-cookie-secret/.erlang.cookie /var/lib/rabbitmq/.erlang.cookie \u0026\u0026 chown 999:999 /var/lib/rabbitmq/.erlang.cookie \u0026\u0026 chmod 600 /var/lib/rabbitmq/.erlang.cookie ; cp /tmp/rabbitmq-plugins/enabled_plugins /operator/enabled_plugins \u0026\u0026 chown 999:999 /operator/enabled_plugins ; chown 999:999 /var/lib/rabbitmq/mnesia/ ; echo '[default]' \u003e /var/lib/rabbitmq/.rabbitmqadmin.conf \u0026\u0026 sed -e 's/default_user/username/' -e 's/default_pass/password/' /tmp/default_user.conf \u003e\u003e /var/lib/rabbitmq/.rabbitmqadmin.conf \u0026\u0026 chown 999:999 /var/lib/rabbitmq/.rabbitmqadmin.conf \u0026\u0026 chmod 600 /var/lib/rabbitmq/.rabbitmqadmin.conf"],"resources":{"limits":{"cpu":"100m","memory":"500Mi"},"requests":{"cpu":"100m","memory":"500Mi"}},"volumeMounts":[{"name":"plugins-conf","mountPath":"/tmp/rabbitmq-plugins/"},{"name":"rabbitmq-erlang-cookie","mountPath":"/var/lib/rabbitmq/"},{"name":"erlang-cookie-secret","mountPath":"/tmp/erlang-cookie-secret/"},{"name":"rabbitmq-plugins","mountPath":"/operator"},{"name":"persistence","mountPath":"/var/lib/rabbitmq/mnesia/"},{"name":"rabbitmq-confd","mountPath":"/tmp/default_user.conf","subPath":"default_user.conf"}],"terminationMessagePath":"/dev/termination-log","terminationMessagePolicy":"File","imagePullPolicy":"IfNotPresent","securityContext":{"capabilities":{"drop":["FSETID","KILL","SETGID","SETUID","SETPCAP","NET_BIND_SERVICE","NET_RAW","SYS_CHROOT","MKNOD","AUDIT_WRITE","SETFCAP"]},"runAsUser":0}}],"containers":[{"name":"rabbitmq","image":"rabbitmq:3.8.12-management","ports":[{"name":"epmd","containerPort":4369,"protocol":"TCP"},{"name":"amqp","containerPort":5672,"protocol":"TCP"},{"name":"management","containerPort":15672,"protocol":"TCP"},{"name":"prometheus","containerPort":15692,"protocol":"TCP"}],"env":[{"name":"MY_POD_NAME","valueFrom":{"fieldRef":{"apiVersion":"v1","fieldPath":"metadata.name"}}},{"name":"MY_POD_NAMESPACE","valueFrom":{"fieldRef":{"apiVersion":"v1","fieldPath":"metadata.namespace"}}},{"name":"RABBITMQ_ENABLED_PLUGINS_FILE","value":"/operator/enabled_plugins"},{"name":"K8S_SERVICE_NAME","value":"rabbitmq-cluster-nodes"},{"name":"RABBITMQ_USE_LONGNAME","value":"true"},{"name":"RABBITMQ_NODENAME","value":"rabbit@$(MY_POD_NAME).$(K8S_SERVICE_NAME).$(MY_POD_NAMESPACE)"},{"name":"K8S_HOSTNAME_SUFFIX","value":".$(K8S_SERVICE_NAME).$(MY_POD_NAMESPACE)"}],"resources":{"limits":{"cpu":"2","memory":"2Gi"},"requests":{"cpu":"1","memory":"2Gi"}},"volumeMounts":[{"name":"rabbitmq-erlang-cookie","mountPath":"/var/lib/rabbitmq/"},{"name":"persistence","mountPath":"/var/lib/rabbitmq/mnesia/"},{"name":"rabbitmq-plugins","mountPath":"/operator"},{"name":"rabbitmq-confd","mountPath":"/etc/rabbitmq/conf.d/10-operatorDefaults.conf","subPath":"operatorDefaults.conf"},{"name":"rabbitmq-confd","mountPath":"/etc/rabbitmq/conf.d/11-default_user.conf","subPath":"default_user.conf"},{"name":"rabbitmq-confd","mountPath":"/etc/rabbitmq/conf.d/90-userDefinedConfiguration.conf","subPath":"userDefinedConfiguration.conf"},{"name":"pod-info","mountPath":"/etc/pod-info/"}],"readinessProbe":{"tcpSocket":{"port":"amqp"},"initialDelaySeconds":10,"timeoutSeconds":5,"periodSeconds":10,"successThreshold":1,"failureThreshold":3},"lifecycle":{"preStop":{"exec":{"command":["/bin/bash","-c","if [ ! -z \"$(cat /etc/pod-info/skipPreStopChecks)\" ]; then exit 0; fi; rabbitmq-upgrade await_online_quorum_plus_one -t 604800; rabbitmq-upgrade await_online_synchronized_mirror -t 604800; rabbitmq-upgrade drain -t 604800"]}}},"terminationMessagePath":"/dev/termination-log","terminationMessagePolicy":"File","imagePullPolicy":"IfNotPresent"}],"restartPolicy":"Always","terminationGracePeriodSeconds":604800,"dnsPolicy":"ClusterFirst","serviceAccountName":"rabbitmq-cluster-server","serviceAccount":"rabbitmq-cluster-server","automountServiceAccountToken":true,"securityContext":{"runAsUser":999,"runAsGroup":999,"fsGroup":999},"schedulerName":"default-scheduler","topologySpreadConstraints":[{"maxSkew":1,"topologyKey":"topology.kubernetes.io/zone","whenUnsatisfiable":"ScheduleAnyway","labelSelector":{"matchLabels":{"app.kubernetes.io/name":"rabbitmq-cluster"}}}]}},"volumeClaimTemplates":[{"metadata":{"name":"persistence","namespace":"default","creationTimestamp":null,"labels":{"app.kubernetes.io/component":"rabbitmq","app.kubernetes.io/name":"rabbitmq-cluster","app.kubernetes.io/part-of":"rabbitmq"},"ownerReferences":[{"apiVersion":"rabbitmq.com/v1beta1","kind":"RabbitmqCluster","name":"rabbitmq-cluster","uid":"3ecefa8a-1bec-48a7-9af4-dd0df3339101","controller":true,"blockOwnerDeletion":false}]},"spec":{"accessModes":["ReadWriteOnce"],"resources":{"requests":{"storage":"15Gi"}},"volumeMode":"Filesystem"},"status":{"phase":"Pending"}}],"serviceName":"rabbitmq-cluster-nodes","podManagementPolicy":"Parallel","updateStrategy":{"type":"RollingUpdate","rollingUpdate":{"partition":0}},"revisionHistoryLimit":10},"status":{"observedGeneration":1,"replicas":1,"readyReplicas":1,"currentReplicas":1,"updatedReplicas":1,"currentRevision":"rabbitmq-cluster-server-5f8b8665fb","updateRevision":"rabbitmq-cluster-server-5f8b8665fb","collisionCount":0}}
2022/03/18 18:07:35 learn_server.go:291: [SIEVE-AFTER-READ]	Get	true	statefulset	default	rabbitmq-cluster-server	github.com/rabbitmq/cluster-operator/controllers.(*RabbitmqClusterReconciler)	NoError	{"kind":"StatefulSet","apiVersion":"apps/v1","metadata":{"name":"rabbitmq-cluster-server","namespace":"default","selfLink":"/apis/apps/v1/namespaces/default/statefulsets/rabbitmq-cluster-server","uid":"1d62d993-2c32-4da7-8884-e4cfad9e587d","resourceVersion":"1481","generation":1,"creationTimestamp":"2022-03-18T18:07:34Z","labels":{"app.kubernetes.io/component":"rabbitmq","app.kubernetes.io/name":"rabbitmq-cluster","app.kubernetes.io/part-of":"rabbitmq"},"ownerReferences":[{"apiVersion":"rabbitmq.com/v1beta1","kind":"RabbitmqCluster","name":"rabbitmq-cluster","uid":"3ecefa8a-1bec-48a7-9af4-dd0df3339101","controller":true,"blockOwnerDeletion":true}],"managedFields":[{"manager":"kube-controller-manager","operation":"Update","apiVersion":"apps/v1","time":"2022-03-18T18:07:34Z","fieldsType":"FieldsV1","fieldsV1":{"f:status":{"f:collisionCount":{},"f:currentReplicas":{},"f:currentRevision":{},"f:observedGeneration":{},"f:readyReplicas":{},"f:replicas":{},"f:updateRevision":{},"f:updatedReplicas":{}}}},{"manager":"manager","operation":"Update","apiVersion":"apps/v1","time":"2022-03-18T18:07:34Z","fieldsType":"FieldsV1","fieldsV1":{"f:metadata":{"f:labels":{".":{},"f:app.kubernetes.io/component":{},"f:app.kubernetes.io/name":{},"f:app.kubernetes.io/part-of":{}},"f:ownerReferences":{".":{},"k:{\"uid\":\"3ecefa8a-1bec-48a7-9af4-dd0df3339101\"}":{".":{},"f:apiVersion":{},"f:blockOwnerDeletion":{},"f:controller":{},"f:kind":{},"f:name":{},"f:uid":{}}}},"f:spec":{"f:podManagementPolicy":{},"f:replicas":{},"f:revisionHistoryLimit":{},"f:selector":{"f:matchLabels":{".":{},"f:app.kubernetes.io/name":{}}},"f:serviceName":{},"f:template":{"f:metadata":{"f:annotations":{".":{},"f:prometheus.io/port":{},"f:prometheus.io/scrape":{}},"f:labels":{".":{},"f:app.kubernetes.io/component":{},"f:app.kubernetes.io/name":{},"f:app.kubernetes.io/part-of":{}}},"f:spec":{"f:automountServiceAccountToken":{},"f:containers":{"k:{\"name\":\"rabbitmq\"}":{".":{},"f:env":{".":{},"k:{\"name\":\"K8S_HOSTNAME_SUFFIX\"}":{".":{},"f:name":{},"f:value":{}},"k:{\"name\":\"K8S_SERVICE_NAME\"}":{".":{},"f:name":{},"f:value":{}},"k:{\"name\":\"MY_POD_NAME\"}":{".":{},"f:name":{},"f:valueFrom":{".":{},"f:fieldRef":{".":{},"f:apiVersion":{},"f:fieldPath":{}}}},"k:{\"name\":\"MY_POD_NAMESPACE\"}":{".":{},"f:name":{},"f:valueFrom":{".":{},"f:fieldRef":{".":{},"f:apiVersion":{},"f:fieldPath":{}}}},"k:{\"name\":\"RABBITMQ_ENABLED_PLUGINS_FILE\"}":{".":{},"f:name":{},"f:value":{}},"k:{\"name\":\"RABBITMQ_NODENAME\"}":{".":{},"f:name":{},"f:value":{}},"k:{\"name\":\"RABBITMQ_USE_LONGNAME\"}":{".":{},"f:name":{},"f:value":{}}},"f:image":{},"f:imagePullPolicy":{},"f:lifecycle":{".":{},"f:preStop":{".":{},"f:exec":{".":{},"f:command":{}}}},"f:name":{},"f:ports":{".":{},"k:{\"containerPort\":4369,\"protocol\":\"TCP\"}":{".":{},"f:containerPort":{},"f:name":{},"f:protocol":{}},"k:{\"containerPort\":5672,\"protocol\":\"TCP\"}":{".":{},"f:containerPort":{},"f:name":{},"f:protocol":{}},"k:{\"containerPort\":15672,\"protocol\":\"TCP\"}":{".":{},"f:containerPort":{},"f:name":{},"f:protocol":{}},"k:{\"containerPort\":15692,\"protocol\":\"TCP\"}":{".":{},"f:containerPort":{},"f:name":{},"f:protocol":{}}},"f:readinessProbe":{".":{},"f:failureThreshold":{},"f:initialDelaySeconds":{},"f:periodSeconds":{},"f:successThreshold":{},"f:tcpSocket":{".":{},"f:port":{}},"f:timeoutSeconds":{}},"f:resources":{".":{},"f:limits":{".":{},"f:cpu":{},"f:memory":{}},"f:requests":{".":{},"f:cpu":{},"f:memory":{}}},"f:terminationMessagePath":{},"f:terminationMessagePolicy":{},"f:volumeMounts":{".":{},"k:{\"mountPath\":\"/etc/pod-info/\"}":{".":{},"f:mountPath":{},"f:name":{}},"k:{\"mountPath\":\"/etc/rabbitmq/conf.d/10-operatorDefaults.conf\"}":{".":{},"f:mountPath":{},"f:name":{},"f:subPath":{}},"k:{\"mountPath\":\"/etc/rabbitmq/conf.d/11-default_user.conf\"}":{".":{},"f:mountPath":{},"f:name":{},"f:subPath":{}},"k:{\"mountPath\":\"/etc/rabbitmq/conf.d/90-userDefinedConfiguration.conf\"}":{".":{},"f:mountPath":{},"f:name":{},"f:subPath":{}},"k:{\"mountPath\":\"/operator\"}":{".":{},"f:mountPath":{},"f:name":{}},"k:{\"mountPath\":\"/var/lib/rabbitmq/\"}":{".":{},"f:mountPath":{},"f:name":{}},"k:{\"mountPath\":\"/var/lib/rabbitmq/mnesia/\"}":{".":{},"f:mountPath":{},"f:name":{}}}}},"f:dnsPolicy":{},"f:initContainers":{".":{},"k:{\"name\":\"setup-container\"}":{".":{},"f:command":{},"f:image":{},"f:imagePullPolicy":{},"f:name":{},"f:resources":{".":{},"f:limits":{".":{},"f:cpu":{},"f:memory":{}},"f:requests":{".":{},"f:cpu":{},"f:memory":{}}},"f:securityContext":{".":{},"f:capabilities":{".":{},"f:drop":{}},"f:runAsUser":{}},"f:terminationMessagePath":{},"f:terminationMessagePolicy":{},"f:volumeMounts":{".":{},"k:{\"mountPath\":\"/operator\"}":{".":{},"f:mountPath":{},"f:name":{}},"k:{\"mountPath\":\"/tmp/default_user.conf\"}":{".":{},"f:mountPath":{},"f:name":{},"f:subPath":{}},"k:{\"mountPath\":\"/tmp/erlang-cookie-secret/\"}":{".":{},"f:mountPath":{},"f:name":{}},"k:{\"mountPath\":\"/tmp/rabbitmq-plugins/\"}":{".":{},"f:mountPath":{},"f:name":{}},"k:{\"mountPath\":\"/var/lib/rabbitmq/\"}":{".":{},"f:mountPath":{},"f:name":{}},"k:{\"mountPath\":\"/var/lib/rabbitmq/mnesia/\"}":{".":{},"f:mountPath":{},"f:name":{}}}}},"f:restartPolicy":{},"f:schedulerName":{},"f:securityContext":{".":{},"f:fsGroup":{},"f:runAsGroup":{},"f:runAsUser":{}},"f:serviceAccount":{},"f:serviceAccountName":{},"f:terminationGracePeriodSeconds":{},"f:topologySpreadConstraints":{".":{},"k:{\"topologyKey\":\"topology.kubernetes.io/zone\",\"whenUnsatisfiable\":\"ScheduleAnyway\"}":{".":{},"f:labelSelector":{".":{},"f:matchLabels":{".":{},"f:app.kubernetes.io/name":{}}},"f:maxSkew":{},"f:topologyKey":{},"f:whenUnsatisfiable":{}}},"f:volumes":{".":{},"k:{\"name\":\"erlang-cookie-secret\"}":{".":{},"f:name":{},"f:secret":{".":{},"f:defaultMode":{},"f:secretName":{}}},"k:{\"name\":\"plugins-conf\"}":{".":{},"f:configMap":{".":{},"f:defaultMode":{},"f:name":{}},"f:name":{}},"k:{\"name\":\"pod-info\"}":{".":{},"f:downwardAPI":{".":{},"f:defaultMode":{},"f:items":{}},"f:name":{}},"k:{\"name\":\"rabbitmq-confd\"}":{".":{},"f:name":{},"f:projected":{".":{},"f:defaultMode":{},"f:sources":{}}},"k:{\"name\":\"rabbitmq-erlang-cookie\"}":{".":{},"f:emptyDir":{},"f:name":{}},"k:{\"name\":\"rabbitmq-plugins\"}":{".":{},"f:emptyDir":{},"f:name":{}}}}},"f:updateStrategy":{"f:rollingUpdate":{".":{},"f:partition":{}},"f:type":{}},"f:volumeClaimTemplates":{}}}}]},"spec":{"replicas":1,"selector":{"matchLabels":{"app.kubernetes.io/name":"rabbitmq-cluster"}},"template":{"metadata":{"creationTimestamp":null,"labels":{"app.kubernetes.io/component":"rabbitmq","app.kubernetes.io/name":"rabbitmq-cluster","app.kubernetes.io/part-of":"rabbitmq"},"annotations":{"prometheus.io/port":"15692","prometheus.io/scrape":"true"}},"spec":{"volumes":[{"name":"plugins-conf","configMap":{"name":"rabbitmq-cluster-plugins-conf","defaultMode":420}},{"name":"rabbitmq-confd","projected":{"sources":[{"secret":{"name":"rabbitmq-cluster-default-user","items":[{"key":"default_user.conf","path":"default_user.conf"}]}},{"configMap":{"name":"rabbitmq-cluster-server-conf","items":[{"key":"operatorDefaults.conf","path":"operatorDefaults.conf"},{"key":"userDefinedConfiguration.conf","path":"userDefinedConfiguration.conf"}]}}],"defaultMode":420}},{"name":"rabbitmq-erlang-cookie","emptyDir":{}},{"name":"erlang-cookie-secret","secret":{"secretName":"rabbitmq-cluster-erlang-cookie","defaultMode":420}},{"name":"rabbitmq-plugins","emptyDir":{}},{"name":"pod-info","downwardAPI":{"items":[{"path":"skipPreStopChecks","fieldRef":{"apiVersion":"v1","fieldPath":"metadata.labels['skipPreStopChecks']"}}],"defaultMode":420}}],"initContainers":[{"name":"setup-container","image":"rabbitmq:3.8.12-management","command":["sh","-c","cp /tmp/erlang-cookie-secret/.erlang.cookie /var/lib/rabbitmq/.erlang.cookie \u0026\u0026 chown 999:999 /var/lib/rabbitmq/.erlang.cookie \u0026\u0026 chmod 600 /var/lib/rabbitmq/.erlang.cookie ; cp /tmp/rabbitmq-plugins/enabled_plugins /operator/enabled_plugins \u0026\u0026 chown 999:999 /operator/enabled_plugins ; chown 999:999 /var/lib/rabbitmq/mnesia/ ; echo '[default]' \u003e /var/lib/rabbitmq/.rabbitmqadmin.conf \u0026\u0026 sed -e 's/default_user/username/' -e 's/default_pass/password/' /tmp/default_user.conf \u003e\u003e /var/lib/rabbitmq/.rabbitmqadmin.conf \u0026\u0026 chown 999:999 /var/lib/rabbitmq/.rabbitmqadmin.conf \u0026\u0026 chmod 600 /var/lib/rabbitmq/.rabbitmqadmin.conf"],"resources":{"limits":{"cpu":"100m","memory":"500Mi"},"requests":{"cpu":"100m","memory":"500Mi"}},"volumeMounts":[{"name":"plugins-conf","mountPath":"/tmp/rabbitmq-plugins/"},{"name":"rabbitmq-erlang-cookie","mountPath":"/var/lib/rabbitmq/"},{"name":"erlang-cookie-secret","mountPath":"/tmp/erlang-cookie-secret/"},{"name":"rabbitmq-plugins","mountPath":"/operator"},{"name":"persistence","mountPath":"/var/lib/rabbitmq/mnesia/"},{"name":"rabbitmq-confd","mountPath":"/tmp/default_user.conf","subPath":"default_user.conf"}],"terminationMessagePath":"/dev/termination-log","terminationMessagePolicy":"File","imagePullPolicy":"IfNotPresent","securityContext":{"capabilities":{"drop":["FSETID","KILL","SETGID","SETUID","SETPCAP","NET_BIND_SERVICE","NET_RAW","SYS_CHROOT","MKNOD","AUDIT_WRITE","SETFCAP"]},"runAsUser":0}}],"containers":[{"name":"rabbitmq","image":"rabbitmq:3.8.12-management","ports":[{"name":"epmd","containerPort":4369,"protocol":"TCP"},{"name":"amqp","containerPort":5672,"protocol":"TCP"},{"name":"management","containerPort":15672,"protocol":"TCP"},{"name":"prometheus","containerPort":15692,"protocol":"TCP"}],"env":[{"name":"MY_POD_NAME","valueFrom":{"fieldRef":{"apiVersion":"v1","fieldPath":"metadata.name"}}},{"name":"MY_POD_NAMESPACE","valueFrom":{"fieldRef":{"apiVersion":"v1","fieldPath":"metadata.namespace"}}},{"name":"RABBITMQ_ENABLED_PLUGINS_FILE","value":"/operator/enabled_plugins"},{"name":"K8S_SERVICE_NAME","value":"rabbitmq-cluster-nodes"},{"name":"RABBITMQ_USE_LONGNAME","value":"true"},{"name":"RABBITMQ_NODENAME","value":"rabbit@$(MY_POD_NAME).$(K8S_SERVICE_NAME).$(MY_POD_NAMESPACE)"},{"name":"K8S_HOSTNAME_SUFFIX","value":".$(K8S_SERVICE_NAME).$(MY_POD_NAMESPACE)"}],"resources":{"limits":{"cpu":"2","memory":"2Gi"},"requests":{"cpu":"1","memory":"2Gi"}},"volumeMounts":[{"name":"rabbitmq-erlang-cookie","mountPath":"/var/lib/rabbitmq/"},{"name":"persistence","mountPath":"/var/lib/rabbitmq/mnesia/"},{"name":"rabbitmq-plugins","mountPath":"/operator"},{"name":"rabbitmq-confd","mountPath":"/etc/rabbitmq/conf.d/10-operatorDefaults.conf","subPath":"operatorDefaults.conf"},{"name":"rabbitmq-confd","mountPath":"/etc/rabbitmq/conf.d/11-default_user.conf","subPath":"default_user.conf"},{"name":"rabbitmq-confd","mountPath":"/etc/rabbitmq/conf.d/90-userDefinedConfiguration.conf","subPath":"userDefinedConfiguration.conf"},{"name":"pod-info","mountPath":"/etc/pod-info/"}],"readinessProbe":{"tcpSocket":{"port":"amqp"},"initialDelaySeconds":10,"timeoutSeconds":5,"periodSeconds":10,"successThreshold":1,"failureThreshold":3},"lifecycle":{"preStop":{"exec":{"command":["/bin/bash","-c","if [ ! -z \"$(cat /etc/pod-info/skipPreStopChecks)\" ]; then exit 0; fi; rabbitmq-upgrade await_online_quorum_plus_one -t 604800; rabbitmq-upgrade await_online_synchronized_mirror -t 604800; rabbitmq-upgrade drain -t 604800"]}}},"terminationMessagePath":"/dev/termination-log","terminationMessagePolicy":"File","imagePullPolicy":"IfNotPresent"}],"restartPolicy":"Always","terminationGracePeriodSeconds":604800,"dnsPolicy":"ClusterFirst","serviceAccountName":"rabbitmq-cluster-server","serviceAccount":"rabbitmq-cluster-server","automountServiceAccountToken":true,"securityContext":{"runAsUser":999,"runAsGroup":999,"fsGroup":999},"schedulerName":"default-scheduler","topologySpreadConstraints":[{"maxSkew":1,"topologyKey":"topology.kubernetes.io/zone","whenUnsatisfiable":"ScheduleAnyway","labelSelector":{"matchLabels":{"app.kubernetes.io/name":"rabbitmq-cluster"}}}]}},"volumeClaimTemplates":[{"metadata":{"name":"persistence","namespace":"default","creationTimestamp":null,"labels":{"app.kubernetes.io/component":"rabbitmq","app.kubernetes.io/name":"rabbitmq-cluster","app.kubernetes.io/part-of":"rabbitmq"},"ownerReferences":[{"apiVersion":"rabbitmq.com/v1beta1","kind":"RabbitmqCluster","name":"rabbitmq-cluster","uid":"3ecefa8a-1bec-48a7-9af4-dd0df3339101","controller":true,"blockOwnerDeletion":false}]},"spec":{"accessModes":["ReadWriteOnce"],"resources":{"requests":{"storage":"15Gi"}},"volumeMode":"Filesystem"},"status":{"phase":"Pending"}}],"serviceName":"rabbitmq-cluster-nodes","podManagementPolicy":"Parallel","updateStrategy":{"type":"RollingUpdate","rollingUpdate":{"partition":0}},"revisionHistoryLimit":10},"status":{"observedGeneration":1,"replicas":1,"readyReplicas":1,"currentReplicas":1,"updatedReplicas":1,"currentRevision":"rabbitmq-cluster-server-5f8b8665fb","updateRevision":"rabbitmq-cluster-server-5f8b8665fb","collisionCount":0}}
2022/03/18 18:07:35 learn_server.go:256: [SIEVE-BEFORE-WRITE]	49
2022/03/18 18:07:35 learn_server.go:263: [SIEVE-AFTER-WRITE]	49	Update	statefulset	github.com/rabbitmq/cluster-operator/controllers.(*RabbitmqClusterReconciler)	NoError	{"metadata":{"name":"rabbitmq-cluster-server","namespace":"default","selfLink":"/apis/apps/v1/namespaces/default/statefulsets/rabbitmq-cluster-server","uid":"1d62d993-2c32-4da7-8884-e4cfad9e587d","resourceVersion":"1481","generation":1,"creationTimestamp":"2022-03-18T18:07:34Z","labels":{"app.kubernetes.io/component":"rabbitmq","app.kubernetes.io/name":"rabbitmq-cluster","app.kubernetes.io/part-of":"rabbitmq"},"ownerReferences":[{"apiVersion":"rabbitmq.com/v1beta1","kind":"RabbitmqCluster","name":"rabbitmq-cluster","uid":"3ecefa8a-1bec-48a7-9af4-dd0df3339101","controller":true,"blockOwnerDeletion":true}],"managedFields":[{"manager":"kube-controller-manager","operation":"Update","apiVersion":"apps/v1","time":"2022-03-18T18:07:34Z","fieldsType":"FieldsV1","fieldsV1":{"f:status":{"f:collisionCount":{},"f:currentReplicas":{},"f:currentRevision":{},"f:observedGeneration":{},"f:readyReplicas":{},"f:replicas":{},"f:updateRevision":{},"f:updatedReplicas":{}}}},{"manager":"manager","operation":"Update","apiVersion":"apps/v1","time":"2022-03-18T18:07:34Z","fieldsType":"FieldsV1","fieldsV1":{"f:metadata":{"f:labels":{".":{},"f:app.kubernetes.io/component":{},"f:app.kubernetes.io/name":{},"f:app.kubernetes.io/part-of":{}},"f:ownerReferences":{".":{},"k:{\"uid\":\"3ecefa8a-1bec-48a7-9af4-dd0df3339101\"}":{".":{},"f:apiVersion":{},"f:blockOwnerDeletion":{},"f:controller":{},"f:kind":{},"f:name":{},"f:uid":{}}}},"f:spec":{"f:podManagementPolicy":{},"f:replicas":{},"f:revisionHistoryLimit":{},"f:selector":{"f:matchLabels":{".":{},"f:app.kubernetes.io/name":{}}},"f:serviceName":{},"f:template":{"f:metadata":{"f:annotations":{".":{},"f:prometheus.io/port":{},"f:prometheus.io/scrape":{}},"f:labels":{".":{},"f:app.kubernetes.io/component":{},"f:app.kubernetes.io/name":{},"f:app.kubernetes.io/part-of":{}}},"f:spec":{"f:automountServiceAccountToken":{},"f:containers":{"k:{\"name\":\"rabbitmq\"}":{".":{},"f:env":{".":{},"k:{\"name\":\"K8S_HOSTNAME_SUFFIX\"}":{".":{},"f:name":{},"f:value":{}},"k:{\"name\":\"K8S_SERVICE_NAME\"}":{".":{},"f:name":{},"f:value":{}},"k:{\"name\":\"MY_POD_NAME\"}":{".":{},"f:name":{},"f:valueFrom":{".":{},"f:fieldRef":{".":{},"f:apiVersion":{},"f:fieldPath":{}}}},"k:{\"name\":\"MY_POD_NAMESPACE\"}":{".":{},"f:name":{},"f:valueFrom":{".":{},"f:fieldRef":{".":{},"f:apiVersion":{},"f:fieldPath":{}}}},"k:{\"name\":\"RABBITMQ_ENABLED_PLUGINS_FILE\"}":{".":{},"f:name":{},"f:value":{}},"k:{\"name\":\"RABBITMQ_NODENAME\"}":{".":{},"f:name":{},"f:value":{}},"k:{\"name\":\"RABBITMQ_USE_LONGNAME\"}":{".":{},"f:name":{},"f:value":{}}},"f:image":{},"f:imagePullPolicy":{},"f:lifecycle":{".":{},"f:preStop":{".":{},"f:exec":{".":{},"f:command":{}}}},"f:name":{},"f:ports":{".":{},"k:{\"containerPort\":4369,\"protocol\":\"TCP\"}":{".":{},"f:containerPort":{},"f:name":{},"f:protocol":{}},"k:{\"containerPort\":5672,\"protocol\":\"TCP\"}":{".":{},"f:containerPort":{},"f:name":{},"f:protocol":{}},"k:{\"containerPort\":15672,\"protocol\":\"TCP\"}":{".":{},"f:containerPort":{},"f:name":{},"f:protocol":{}},"k:{\"containerPort\":15692,\"protocol\":\"TCP\"}":{".":{},"f:containerPort":{},"f:name":{},"f:protocol":{}}},"f:readinessProbe":{".":{},"f:failureThreshold":{},"f:initialDelaySeconds":{},"f:periodSeconds":{},"f:successThreshold":{},"f:tcpSocket":{".":{},"f:port":{}},"f:timeoutSeconds":{}},"f:resources":{".":{},"f:limits":{".":{},"f:cpu":{},"f:memory":{}},"f:requests":{".":{},"f:cpu":{},"f:memory":{}}},"f:terminationMessagePath":{},"f:terminationMessagePolicy":{},"f:volumeMounts":{".":{},"k:{\"mountPath\":\"/etc/pod-info/\"}":{".":{},"f:mountPath":{},"f:name":{}},"k:{\"mountPath\":\"/etc/rabbitmq/conf.d/10-operatorDefaults.conf\"}":{".":{},"f:mountPath":{},"f:name":{},"f:subPath":{}},"k:{\"mountPath\":\"/etc/rabbitmq/conf.d/11-default_user.conf\"}":{".":{},"f:mountPath":{},"f:name":{},"f:subPath":{}},"k:{\"mountPath\":\"/etc/rabbitmq/conf.d/90-userDefinedConfiguration.conf\"}":{".":{},"f:mountPath":{},"f:name":{},"f:subPath":{}},"k:{\"mountPath\":\"/operator\"}":{".":{},"f:mountPath":{},"f:name":{}},"k:{\"mountPath\":\"/var/lib/rabbitmq/\"}":{".":{},"f:mountPath":{},"f:name":{}},"k:{\"mountPath\":\"/var/lib/rabbitmq/mnesia/\"}":{".":{},"f:mountPath":{},"f:name":{}}}}},"f:dnsPolicy":{},"f:initContainers":{".":{},"k:{\"name\":\"setup-container\"}":{".":{},"f:command":{},"f:image":{},"f:imagePullPolicy":{},"f:name":{},"f:resources":{".":{},"f:limits":{".":{},"f:cpu":{},"f:memory":{}},"f:requests":{".":{},"f:cpu":{},"f:memory":{}}},"f:securityContext":{".":{},"f:capabilities":{".":{},"f:drop":{}},"f:runAsUser":{}},"f:terminationMessagePath":{},"f:terminationMessagePolicy":{},"f:volumeMounts":{".":{},"k:{\"mountPath\":\"/operator\"}":{".":{},"f:mountPath":{},"f:name":{}},"k:{\"mountPath\":\"/tmp/default_user.conf\"}":{".":{},"f:mountPath":{},"f:name":{},"f:subPath":{}},"k:{\"mountPath\":\"/tmp/erlang-cookie-secret/\"}":{".":{},"f:mountPath":{},"f:name":{}},"k:{\"mountPath\":\"/tmp/rabbitmq-plugins/\"}":{".":{},"f:mountPath":{},"f:name":{}},"k:{\"mountPath\":\"/var/lib/rabbitmq/\"}":{".":{},"f:mountPath":{},"f:name":{}},"k:{\"mountPath\":\"/var/lib/rabbitmq/mnesia/\"}":{".":{},"f:mountPath":{},"f:name":{}}}}},"f:restartPolicy":{},"f:schedulerName":{},"f:securityContext":{".":{},"f:fsGroup":{},"f:runAsGroup":{},"f:runAsUser":{}},"f:serviceAccount":{},"f:serviceAccountName":{},"f:terminationGracePeriodSeconds":{},"f:topologySpreadConstraints":{".":{},"k:{\"topologyKey\":\"topology.kubernetes.io/zone\",\"whenUnsatisfiable\":\"ScheduleAnyway\"}":{".":{},"f:labelSelector":{".":{},"f:matchLabels":{".":{},"f:app.kubernetes.io/name":{}}},"f:maxSkew":{},"f:topologyKey":{},"f:whenUnsatisfiable":{}}},"f:volumes":{".":{},"k:{\"name\":\"erlang-cookie-secret\"}":{".":{},"f:name":{},"f:secret":{".":{},"f:defaultMode":{},"f:secretName":{}}},"k:{\"name\":\"plugins-conf\"}":{".":{},"f:configMap":{".":{},"f:defaultMode":{},"f:name":{}},"f:name":{}},"k:{\"name\":\"pod-info\"}":{".":{},"f:downwardAPI":{".":{},"f:defaultMode":{},"f:items":{}},"f:name":{}},"k:{\"name\":\"rabbitmq-confd\"}":{".":{},"f:name":{},"f:projected":{".":{},"f:defaultMode":{},"f:sources":{}}},"k:{\"name\":\"rabbitmq-erlang-cookie\"}":{".":{},"f:emptyDir":{},"f:name":{}},"k:{\"name\":\"rabbitmq-plugins\"}":{".":{},"f:emptyDir":{},"f:name":{}}}}},"f:updateStrategy":{"f:rollingUpdate":{".":{},"f:partition":{}},"f:type":{}},"f:volumeClaimTemplates":{}}}}]},"spec":{"replicas":1,"selector":{"matchLabels":{"app.kubernetes.io/name":"rabbitmq-cluster"}},"template":{"metadata":{"creationTimestamp":null,"labels":{"app.kubernetes.io/component":"rabbitmq","app.kubernetes.io/name":"rabbitmq-cluster","app.kubernetes.io/part-of":"rabbitmq"},"annotations":{"prometheus.io/port":"15692","prometheus.io/scrape":"true"}},"spec":{"volumes":[{"name":"plugins-conf","configMap":{"name":"rabbitmq-cluster-plugins-conf","defaultMode":420}},{"name":"rabbitmq-confd","projected":{"sources":[{"secret":{"name":"rabbitmq-cluster-default-user","items":[{"key":"default_user.conf","path":"default_user.conf"}]}},{"configMap":{"name":"rabbitmq-cluster-server-conf","items":[{"key":"operatorDefaults.conf","path":"operatorDefaults.conf"},{"key":"userDefinedConfiguration.conf","path":"userDefinedConfiguration.conf"}]}}],"defaultMode":420}},{"name":"rabbitmq-erlang-cookie","emptyDir":{}},{"name":"erlang-cookie-secret","secret":{"secretName":"rabbitmq-cluster-erlang-cookie","defaultMode":420}},{"name":"rabbitmq-plugins","emptyDir":{}},{"name":"pod-info","downwardAPI":{"items":[{"path":"skipPreStopChecks","fieldRef":{"apiVersion":"v1","fieldPath":"metadata.labels['skipPreStopChecks']"}}],"defaultMode":420}}],"initContainers":[{"name":"setup-container","image":"rabbitmq:3.8.12-management","command":["sh","-c","cp /tmp/erlang-cookie-secret/.erlang.cookie /var/lib/rabbitmq/.erlang.cookie \u0026\u0026 chown 999:999 /var/lib/rabbitmq/.erlang.cookie \u0026\u0026 chmod 600 /var/lib/rabbitmq/.erlang.cookie ; cp /tmp/rabbitmq-plugins/enabled_plugins /operator/enabled_plugins \u0026\u0026 chown 999:999 /operator/enabled_plugins ; chown 999:999 /var/lib/rabbitmq/mnesia/ ; echo '[default]' \u003e /var/lib/rabbitmq/.rabbitmqadmin.conf \u0026\u0026 sed -e 's/default_user/username/' -e 's/default_pass/password/' /tmp/default_user.conf \u003e\u003e /var/lib/rabbitmq/.rabbitmqadmin.conf \u0026\u0026 chown 999:999 /var/lib/rabbitmq/.rabbitmqadmin.conf \u0026\u0026 chmod 600 /var/lib/rabbitmq/.rabbitmqadmin.conf"],"resources":{"limits":{"cpu":"100m","memory":"500Mi"},"requests":{"cpu":"100m","memory":"500Mi"}},"volumeMounts":[{"name":"plugins-conf","mountPath":"/tmp/rabbitmq-plugins/"},{"name":"rabbitmq-erlang-cookie","mountPath":"/var/lib/rabbitmq/"},{"name":"erlang-cookie-secret","mountPath":"/tmp/erlang-cookie-secret/"},{"name":"rabbitmq-plugins","mountPath":"/operator"},{"name":"persistence","mountPath":"/var/lib/rabbitmq/mnesia/"},{"name":"rabbitmq-confd","mountPath":"/tmp/default_user.conf","subPath":"default_user.conf"}],"terminationMessagePath":"/dev/termination-log","terminationMessagePolicy":"File","imagePullPolicy":"IfNotPresent","securityContext":{"capabilities":{"drop":["FSETID","KILL","SETGID","SETUID","SETPCAP","NET_BIND_SERVICE","NET_RAW","SYS_CHROOT","MKNOD","AUDIT_WRITE","SETFCAP"]},"runAsUser":0}}],"containers":[{"name":"rabbitmq","image":"rabbitmq:3.8.12-management","ports":[{"name":"epmd","containerPort":4369,"protocol":"TCP"},{"name":"amqp","containerPort":5672,"protocol":"TCP"},{"name":"management","containerPort":15672,"protocol":"TCP"},{"name":"prometheus","containerPort":15692,"protocol":"TCP"}],"env":[{"name":"MY_POD_NAME","valueFrom":{"fieldRef":{"apiVersion":"v1","fieldPath":"metadata.name"}}},{"name":"MY_POD_NAMESPACE","valueFrom":{"fieldRef":{"apiVersion":"v1","fieldPath":"metadata.namespace"}}},{"name":"RABBITMQ_ENABLED_PLUGINS_FILE","value":"/operator/enabled_plugins"},{"name":"K8S_SERVICE_NAME","value":"rabbitmq-cluster-nodes"},{"name":"RABBITMQ_USE_LONGNAME","value":"true"},{"name":"RABBITMQ_NODENAME","value":"rabbit@$(MY_POD_NAME).$(K8S_SERVICE_NAME).$(MY_POD_NAMESPACE)"},{"name":"K8S_HOSTNAME_SUFFIX","value":".$(K8S_SERVICE_NAME).$(MY_POD_NAMESPACE)"}],"resources":{"limits":{"cpu":"2","memory":"2Gi"},"requests":{"cpu":"1","memory":"2Gi"}},"volumeMounts":[{"name":"rabbitmq-erlang-cookie","mountPath":"/var/lib/rabbitmq/"},{"name":"persistence","mountPath":"/var/lib/rabbitmq/mnesia/"},{"name":"rabbitmq-plugins","mountPath":"/operator"},{"name":"rabbitmq-confd","mountPath":"/etc/rabbitmq/conf.d/10-operatorDefaults.conf","subPath":"operatorDefaults.conf"},{"name":"rabbitmq-confd","mountPath":"/etc/rabbitmq/conf.d/11-default_user.conf","subPath":"default_user.conf"},{"name":"rabbitmq-confd","mountPath":"/etc/rabbitmq/conf.d/90-userDefinedConfiguration.conf","subPath":"userDefinedConfiguration.conf"},{"name":"pod-info","mountPath":"/etc/pod-info/"}],"readinessProbe":{"tcpSocket":{"port":"amqp"},"initialDelaySeconds":10,"timeoutSeconds":5,"periodSeconds":10,"successThreshold":1,"failureThreshold":3},"lifecycle":{"preStop":{"exec":{"command":["/bin/bash","-c","if [ ! -z \"$(cat /etc/pod-info/skipPreStopChecks)\" ]; then exit 0; fi; rabbitmq-upgrade await_online_quorum_plus_one -t 604800; rabbitmq-upgrade await_online_synchronized_mirror -t 604800; rabbitmq-upgrade drain -t 604800"]}}},"terminationMessagePath":"/dev/termination-log","terminationMessagePolicy":"File","imagePullPolicy":"IfNotPresent"}],"restartPolicy":"Always","terminationGracePeriodSeconds":604800,"dnsPolicy":"ClusterFirst","serviceAccountName":"rabbitmq-cluster-server","serviceAccount":"rabbitmq-cluster-server","automountServiceAccountToken":true,"securityContext":{"runAsUser":999,"runAsGroup":999,"fsGroup":999},"schedulerName":"default-scheduler","topologySpreadConstraints":[{"maxSkew":1,"topologyKey":"topology.kubernetes.io/zone","whenUnsatisfiable":"ScheduleAnyway","labelSelector":{"matchLabels":{"app.kubernetes.io/name":"rabbitmq-cluster"}}}]}},"volumeClaimTemplates":[{"metadata":{"name":"persistence","namespace":"default","creationTimestamp":null,"labels":{"app.kubernetes.io/component":"rabbitmq","app.kubernetes.io/name":"rabbitmq-cluster","app.kubernetes.io/part-of":"rabbitmq"},"ownerReferences":[{"apiVersion":"rabbitmq.com/v1beta1","kind":"RabbitmqCluster","name":"rabbitmq-cluster","uid":"3ecefa8a-1bec-48a7-9af4-dd0df3339101","controller":true,"blockOwnerDeletion":false}]},"spec":{"accessModes":["ReadWriteOnce"],"resources":{"requests":{"storage":"15Gi"}},"volumeMode":"Filesystem"},"status":{"phase":"Pending"}}],"serviceName":"rabbitmq-cluster-nodes","podManagementPolicy":"Parallel","updateStrategy":{"type":"RollingUpdate","rollingUpdate":{"partition":0}},"revisionHistoryLimit":10},"status":{"observedGeneration":1,"replicas":1,"readyReplicas":1,"currentReplicas":1,"updatedReplicas":1,"currentRevision":"rabbitmq-cluster-server-5f8b8665fb","updateRevision":"rabbitmq-cluster-server-5f8b8665fb","collisionCount":0}}
2022/03/18 18:07:35 learn_server.go:291: [SIEVE-AFTER-READ]	Get	true	configmap	default	rabbitmq-cluster-server-conf	github.com/rabbitmq/cluster-operator/controllers.(*RabbitmqClusterReconciler)	NoError	{"kind":"ConfigMap","apiVersion":"v1","metadata":{"name":"rabbitmq-cluster-server-conf","namespace":"default","selfLink":"/api/v1/namespaces/default/configmaps/rabbitmq-cluster-server-conf","uid":"e4182078-d429-4baf-9021-72618c509ac5","resourceVersion":"1095","creationTimestamp":"2022-03-18T18:06:25Z","labels":{"app.kubernetes.io/component":"rabbitmq","app.kubernetes.io/name":"rabbitmq-cluster","app.kubernetes.io/part-of":"rabbitmq"},"ownerReferences":[{"apiVersion":"rabbitmq.com/v1beta1","kind":"RabbitmqCluster","name":"rabbitmq-cluster","uid":"3ecefa8a-1bec-48a7-9af4-dd0df3339101","controller":true,"blockOwnerDeletion":true}],"managedFields":[{"manager":"manager","operation":"Update","apiVersion":"v1","time":"2022-03-18T18:06:25Z","fieldsType":"FieldsV1","fieldsV1":{"f:data":{".":{},"f:operatorDefaults.conf":{},"f:userDefinedConfiguration.conf":{}},"f:metadata":{"f:labels":{".":{},"f:app.kubernetes.io/component":{},"f:app.kubernetes.io/name":{},"f:app.kubernetes.io/part-of":{}},"f:ownerReferences":{".":{},"k:{\"uid\":\"3ecefa8a-1bec-48a7-9af4-dd0df3339101\"}":{".":{},"f:apiVersion":{},"f:blockOwnerDeletion":{},"f:controller":{},"f:kind":{},"f:name":{},"f:uid":{}}}}}}]},"data":{"operatorDefaults.conf":"cluster_formation.peer_discovery_backend             = rabbit_peer_discovery_k8s\ncluster_formation.k8s.host                           = kubernetes.default\ncluster_formation.k8s.address_type                   = hostname\ncluster_partition_handling                           = pause_minority\nqueue_master_locator                                 = min-masters\ndisk_free_limit.absolute                             = 2GB\ncluster_formation.randomized_startup_delay_range.min = 5\ncluster_formation.randomized_startup_delay_range.max = 30\ncluster_name                                         = rabbitmq-cluster\n","userDefinedConfiguration.conf":"total_memory_available_override_value = 1717986919\n"}}
2022/03/18 18:07:35 learn_server.go:256: [SIEVE-BEFORE-WRITE]	50
2022/03/18 18:07:35 learn_server.go:263: [SIEVE-AFTER-WRITE]	50	StatusUpdate	rabbitmqcluster	github.com/rabbitmq/cluster-operator/controllers.(*RabbitmqClusterReconciler)	NoError	{"metadata":{"name":"rabbitmq-cluster","namespace":"default","selfLink":"/apis/rabbitmq.com/v1beta1/namespaces/default/rabbitmqclusters/rabbitmq-cluster/status","uid":"3ecefa8a-1bec-48a7-9af4-dd0df3339101","resourceVersion":"1482","generation":3,"creationTimestamp":"2022-03-18T18:06:25Z","annotations":{"kubectl.kubernetes.io/last-applied-configuration":"{\"apiVersion\":\"rabbitmq.com/v1beta1\",\"kind\":\"RabbitmqCluster\",\"metadata\":{\"annotations\":{},\"name\":\"rabbitmq-cluster\",\"namespace\":\"default\"},\"spec\":{\"persistence\":{\"storage\":\"10Gi\"},\"replicas\":1}}\n"},"finalizers":["deletion.finalizers.rabbitmqclusters.rabbitmq.com"],"managedFields":[{"manager":"kubectl-client-side-apply","operation":"Update","apiVersion":"rabbitmq.com/v1beta1","time":"2022-03-18T18:06:25Z","fieldsType":"FieldsV1","fieldsV1":{"f:metadata":{"f:annotations":{".":{},"f:kubectl.kubernetes.io/last-applied-configuration":{}}},"f:spec":{".":{},"f:image":{},"f:persistence":{},"f:replicas":{},"f:resources":{".":{},"f:limits":{".":{},"f:memory":{}},"f:requests":{".":{},"f:memory":{}}},"f:service":{".":{},"f:type":{}},"f:terminationGracePeriodSeconds":{}}}},{"manager":"kubectl-patch","operation":"Update","apiVersion":"rabbitmq.com/v1beta1","time":"2022-03-18T18:07:31Z","fieldsType":"FieldsV1","fieldsV1":{"f:spec":{"f:persistence":{"f:storage":{}}}}},{"manager":"manager","operation":"Update","apiVersion":"rabbitmq.com/v1beta1","time":"2022-03-18T18:07:35Z","fieldsType":"FieldsV1","fieldsV1":{"f:metadata":{"f:finalizers":{}},"f:spec":{"f:override":{},"f:rabbitmq":{},"f:resources":{"f:limits":{"f:cpu":{}},"f:requests":{"f:cpu":{}}},"f:tls":{}},"f:status":{".":{},"f:conditions":{},"f:defaultUser":{".":{},"f:secretReference":{".":{},"f:keys":{".":{},"f:password":{},"f:username":{}},"f:name":{},"f:namespace":{}},"f:serviceReference":{".":{},"f:name":{},"f:namespace":{}}}}}}]},"spec":{"replicas":1,"image":"rabbitmq:3.8.12-management","service":{"type":"ClusterIP"},"persistence":{"storage":"15Gi"},"resources":{"limits":{"cpu":"2","memory":"2Gi"},"requests":{"cpu":"1","memory":"2Gi"}},"rabbitmq":{},"tls":{},"override":{},"terminationGracePeriodSeconds":604800},"status":{"conditions":[{"type":"AllReplicasReady","status":"True","lastTransitionTime":"2022-03-18T18:07:35Z","reason":"AllPodsAreReady"},{"type":"ClusterAvailable","status":"True","lastTransitionTime":"2022-03-18T18:07:23Z","reason":"AtLeastOneEndpointAvailable"},{"type":"NoWarnings","status":"True","lastTransitionTime":"2022-03-18T18:06:25Z","reason":"NoWarnings"},{"type":"ReconcileSuccess","status":"True","lastTransitionTime":"2022-03-18T18:07:24Z","reason":"Success","message":"Finish reconciling"}],"defaultUser":{"secretReference":{"name":"rabbitmq-cluster-default-user","namespace":"default","keys":{"password":"password","username":"username"}},"serviceReference":{"name":"rabbitmq-cluster","namespace":"default"}},"binding":{"name":"rabbitmq-cluster-default-user"}}}
2022/03/18 18:07:35 learn_server.go:291: [SIEVE-AFTER-READ]	Get	true	statefulset	default	rabbitmq-cluster-server	github.com/rabbitmq/cluster-operator/controllers.(*RabbitmqClusterReconciler)	NoError	{"kind":"StatefulSet","apiVersion":"apps/v1","metadata":{"name":"rabbitmq-cluster-server","namespace":"default","selfLink":"/apis/apps/v1/namespaces/default/statefulsets/rabbitmq-cluster-server","uid":"1d62d993-2c32-4da7-8884-e4cfad9e587d","resourceVersion":"1481","generation":1,"creationTimestamp":"2022-03-18T18:07:34Z","labels":{"app.kubernetes.io/component":"rabbitmq","app.kubernetes.io/name":"rabbitmq-cluster","app.kubernetes.io/part-of":"rabbitmq"},"ownerReferences":[{"apiVersion":"rabbitmq.com/v1beta1","kind":"RabbitmqCluster","name":"rabbitmq-cluster","uid":"3ecefa8a-1bec-48a7-9af4-dd0df3339101","controller":true,"blockOwnerDeletion":true}],"managedFields":[{"manager":"kube-controller-manager","operation":"Update","apiVersion":"apps/v1","time":"2022-03-18T18:07:34Z","fieldsType":"FieldsV1","fieldsV1":{"f:status":{"f:collisionCount":{},"f:currentReplicas":{},"f:currentRevision":{},"f:observedGeneration":{},"f:readyReplicas":{},"f:replicas":{},"f:updateRevision":{},"f:updatedReplicas":{}}}},{"manager":"manager","operation":"Update","apiVersion":"apps/v1","time":"2022-03-18T18:07:34Z","fieldsType":"FieldsV1","fieldsV1":{"f:metadata":{"f:labels":{".":{},"f:app.kubernetes.io/component":{},"f:app.kubernetes.io/name":{},"f:app.kubernetes.io/part-of":{}},"f:ownerReferences":{".":{},"k:{\"uid\":\"3ecefa8a-1bec-48a7-9af4-dd0df3339101\"}":{".":{},"f:apiVersion":{},"f:blockOwnerDeletion":{},"f:controller":{},"f:kind":{},"f:name":{},"f:uid":{}}}},"f:spec":{"f:podManagementPolicy":{},"f:replicas":{},"f:revisionHistoryLimit":{},"f:selector":{"f:matchLabels":{".":{},"f:app.kubernetes.io/name":{}}},"f:serviceName":{},"f:template":{"f:metadata":{"f:annotations":{".":{},"f:prometheus.io/port":{},"f:prometheus.io/scrape":{}},"f:labels":{".":{},"f:app.kubernetes.io/component":{},"f:app.kubernetes.io/name":{},"f:app.kubernetes.io/part-of":{}}},"f:spec":{"f:automountServiceAccountToken":{},"f:containers":{"k:{\"name\":\"rabbitmq\"}":{".":{},"f:env":{".":{},"k:{\"name\":\"K8S_HOSTNAME_SUFFIX\"}":{".":{},"f:name":{},"f:value":{}},"k:{\"name\":\"K8S_SERVICE_NAME\"}":{".":{},"f:name":{},"f:value":{}},"k:{\"name\":\"MY_POD_NAME\"}":{".":{},"f:name":{},"f:valueFrom":{".":{},"f:fieldRef":{".":{},"f:apiVersion":{},"f:fieldPath":{}}}},"k:{\"name\":\"MY_POD_NAMESPACE\"}":{".":{},"f:name":{},"f:valueFrom":{".":{},"f:fieldRef":{".":{},"f:apiVersion":{},"f:fieldPath":{}}}},"k:{\"name\":\"RABBITMQ_ENABLED_PLUGINS_FILE\"}":{".":{},"f:name":{},"f:value":{}},"k:{\"name\":\"RABBITMQ_NODENAME\"}":{".":{},"f:name":{},"f:value":{}},"k:{\"name\":\"RABBITMQ_USE_LONGNAME\"}":{".":{},"f:name":{},"f:value":{}}},"f:image":{},"f:imagePullPolicy":{},"f:lifecycle":{".":{},"f:preStop":{".":{},"f:exec":{".":{},"f:command":{}}}},"f:name":{},"f:ports":{".":{},"k:{\"containerPort\":4369,\"protocol\":\"TCP\"}":{".":{},"f:containerPort":{},"f:name":{},"f:protocol":{}},"k:{\"containerPort\":5672,\"protocol\":\"TCP\"}":{".":{},"f:containerPort":{},"f:name":{},"f:protocol":{}},"k:{\"containerPort\":15672,\"protocol\":\"TCP\"}":{".":{},"f:containerPort":{},"f:name":{},"f:protocol":{}},"k:{\"containerPort\":15692,\"protocol\":\"TCP\"}":{".":{},"f:containerPort":{},"f:name":{},"f:protocol":{}}},"f:readinessProbe":{".":{},"f:failureThreshold":{},"f:initialDelaySeconds":{},"f:periodSeconds":{},"f:successThreshold":{},"f:tcpSocket":{".":{},"f:port":{}},"f:timeoutSeconds":{}},"f:resources":{".":{},"f:limits":{".":{},"f:cpu":{},"f:memory":{}},"f:requests":{".":{},"f:cpu":{},"f:memory":{}}},"f:terminationMessagePath":{},"f:terminationMessagePolicy":{},"f:volumeMounts":{".":{},"k:{\"mountPath\":\"/etc/pod-info/\"}":{".":{},"f:mountPath":{},"f:name":{}},"k:{\"mountPath\":\"/etc/rabbitmq/conf.d/10-operatorDefaults.conf\"}":{".":{},"f:mountPath":{},"f:name":{},"f:subPath":{}},"k:{\"mountPath\":\"/etc/rabbitmq/conf.d/11-default_user.conf\"}":{".":{},"f:mountPath":{},"f:name":{},"f:subPath":{}},"k:{\"mountPath\":\"/etc/rabbitmq/conf.d/90-userDefinedConfiguration.conf\"}":{".":{},"f:mountPath":{},"f:name":{},"f:subPath":{}},"k:{\"mountPath\":\"/operator\"}":{".":{},"f:mountPath":{},"f:name":{}},"k:{\"mountPath\":\"/var/lib/rabbitmq/\"}":{".":{},"f:mountPath":{},"f:name":{}},"k:{\"mountPath\":\"/var/lib/rabbitmq/mnesia/\"}":{".":{},"f:mountPath":{},"f:name":{}}}}},"f:dnsPolicy":{},"f:initContainers":{".":{},"k:{\"name\":\"setup-container\"}":{".":{},"f:command":{},"f:image":{},"f:imagePullPolicy":{},"f:name":{},"f:resources":{".":{},"f:limits":{".":{},"f:cpu":{},"f:memory":{}},"f:requests":{".":{},"f:cpu":{},"f:memory":{}}},"f:securityContext":{".":{},"f:capabilities":{".":{},"f:drop":{}},"f:runAsUser":{}},"f:terminationMessagePath":{},"f:terminationMessagePolicy":{},"f:volumeMounts":{".":{},"k:{\"mountPath\":\"/operator\"}":{".":{},"f:mountPath":{},"f:name":{}},"k:{\"mountPath\":\"/tmp/default_user.conf\"}":{".":{},"f:mountPath":{},"f:name":{},"f:subPath":{}},"k:{\"mountPath\":\"/tmp/erlang-cookie-secret/\"}":{".":{},"f:mountPath":{},"f:name":{}},"k:{\"mountPath\":\"/tmp/rabbitmq-plugins/\"}":{".":{},"f:mountPath":{},"f:name":{}},"k:{\"mountPath\":\"/var/lib/rabbitmq/\"}":{".":{},"f:mountPath":{},"f:name":{}},"k:{\"mountPath\":\"/var/lib/rabbitmq/mnesia/\"}":{".":{},"f:mountPath":{},"f:name":{}}}}},"f:restartPolicy":{},"f:schedulerName":{},"f:securityContext":{".":{},"f:fsGroup":{},"f:runAsGroup":{},"f:runAsUser":{}},"f:serviceAccount":{},"f:serviceAccountName":{},"f:terminationGracePeriodSeconds":{},"f:topologySpreadConstraints":{".":{},"k:{\"topologyKey\":\"topology.kubernetes.io/zone\",\"whenUnsatisfiable\":\"ScheduleAnyway\"}":{".":{},"f:labelSelector":{".":{},"f:matchLabels":{".":{},"f:app.kubernetes.io/name":{}}},"f:maxSkew":{},"f:topologyKey":{},"f:whenUnsatisfiable":{}}},"f:volumes":{".":{},"k:{\"name\":\"erlang-cookie-secret\"}":{".":{},"f:name":{},"f:secret":{".":{},"f:defaultMode":{},"f:secretName":{}}},"k:{\"name\":\"plugins-conf\"}":{".":{},"f:configMap":{".":{},"f:defaultMode":{},"f:name":{}},"f:name":{}},"k:{\"name\":\"pod-info\"}":{".":{},"f:downwardAPI":{".":{},"f:defaultMode":{},"f:items":{}},"f:name":{}},"k:{\"name\":\"rabbitmq-confd\"}":{".":{},"f:name":{},"f:projected":{".":{},"f:defaultMode":{},"f:sources":{}}},"k:{\"name\":\"rabbitmq-erlang-cookie\"}":{".":{},"f:emptyDir":{},"f:name":{}},"k:{\"name\":\"rabbitmq-plugins\"}":{".":{},"f:emptyDir":{},"f:name":{}}}}},"f:updateStrategy":{"f:rollingUpdate":{".":{},"f:partition":{}},"f:type":{}},"f:volumeClaimTemplates":{}}}}]},"spec":{"replicas":1,"selector":{"matchLabels":{"app.kubernetes.io/name":"rabbitmq-cluster"}},"template":{"metadata":{"creationTimestamp":null,"labels":{"app.kubernetes.io/component":"rabbitmq","app.kubernetes.io/name":"rabbitmq-cluster","app.kubernetes.io/part-of":"rabbitmq"},"annotations":{"prometheus.io/port":"15692","prometheus.io/scrape":"true"}},"spec":{"volumes":[{"name":"plugins-conf","configMap":{"name":"rabbitmq-cluster-plugins-conf","defaultMode":420}},{"name":"rabbitmq-confd","projected":{"sources":[{"secret":{"name":"rabbitmq-cluster-default-user","items":[{"key":"default_user.conf","path":"default_user.conf"}]}},{"configMap":{"name":"rabbitmq-cluster-server-conf","items":[{"key":"operatorDefaults.conf","path":"operatorDefaults.conf"},{"key":"userDefinedConfiguration.conf","path":"userDefinedConfiguration.conf"}]}}],"defaultMode":420}},{"name":"rabbitmq-erlang-cookie","emptyDir":{}},{"name":"erlang-cookie-secret","secret":{"secretName":"rabbitmq-cluster-erlang-cookie","defaultMode":420}},{"name":"rabbitmq-plugins","emptyDir":{}},{"name":"pod-info","downwardAPI":{"items":[{"path":"skipPreStopChecks","fieldRef":{"apiVersion":"v1","fieldPath":"metadata.labels['skipPreStopChecks']"}}],"defaultMode":420}}],"initContainers":[{"name":"setup-container","image":"rabbitmq:3.8.12-management","command":["sh","-c","cp /tmp/erlang-cookie-secret/.erlang.cookie /var/lib/rabbitmq/.erlang.cookie \u0026\u0026 chown 999:999 /var/lib/rabbitmq/.erlang.cookie \u0026\u0026 chmod 600 /var/lib/rabbitmq/.erlang.cookie ; cp /tmp/rabbitmq-plugins/enabled_plugins /operator/enabled_plugins \u0026\u0026 chown 999:999 /operator/enabled_plugins ; chown 999:999 /var/lib/rabbitmq/mnesia/ ; echo '[default]' \u003e /var/lib/rabbitmq/.rabbitmqadmin.conf \u0026\u0026 sed -e 's/default_user/username/' -e 's/default_pass/password/' /tmp/default_user.conf \u003e\u003e /var/lib/rabbitmq/.rabbitmqadmin.conf \u0026\u0026 chown 999:999 /var/lib/rabbitmq/.rabbitmqadmin.conf \u0026\u0026 chmod 600 /var/lib/rabbitmq/.rabbitmqadmin.conf"],"resources":{"limits":{"cpu":"100m","memory":"500Mi"},"requests":{"cpu":"100m","memory":"500Mi"}},"volumeMounts":[{"name":"plugins-conf","mountPath":"/tmp/rabbitmq-plugins/"},{"name":"rabbitmq-erlang-cookie","mountPath":"/var/lib/rabbitmq/"},{"name":"erlang-cookie-secret","mountPath":"/tmp/erlang-cookie-secret/"},{"name":"rabbitmq-plugins","mountPath":"/operator"},{"name":"persistence","mountPath":"/var/lib/rabbitmq/mnesia/"},{"name":"rabbitmq-confd","mountPath":"/tmp/default_user.conf","subPath":"default_user.conf"}],"terminationMessagePath":"/dev/termination-log","terminationMessagePolicy":"File","imagePullPolicy":"IfNotPresent","securityContext":{"capabilities":{"drop":["FSETID","KILL","SETGID","SETUID","SETPCAP","NET_BIND_SERVICE","NET_RAW","SYS_CHROOT","MKNOD","AUDIT_WRITE","SETFCAP"]},"runAsUser":0}}],"containers":[{"name":"rabbitmq","image":"rabbitmq:3.8.12-management","ports":[{"name":"epmd","containerPort":4369,"protocol":"TCP"},{"name":"amqp","containerPort":5672,"protocol":"TCP"},{"name":"management","containerPort":15672,"protocol":"TCP"},{"name":"prometheus","containerPort":15692,"protocol":"TCP"}],"env":[{"name":"MY_POD_NAME","valueFrom":{"fieldRef":{"apiVersion":"v1","fieldPath":"metadata.name"}}},{"name":"MY_POD_NAMESPACE","valueFrom":{"fieldRef":{"apiVersion":"v1","fieldPath":"metadata.namespace"}}},{"name":"RABBITMQ_ENABLED_PLUGINS_FILE","value":"/operator/enabled_plugins"},{"name":"K8S_SERVICE_NAME","value":"rabbitmq-cluster-nodes"},{"name":"RABBITMQ_USE_LONGNAME","value":"true"},{"name":"RABBITMQ_NODENAME","value":"rabbit@$(MY_POD_NAME).$(K8S_SERVICE_NAME).$(MY_POD_NAMESPACE)"},{"name":"K8S_HOSTNAME_SUFFIX","value":".$(K8S_SERVICE_NAME).$(MY_POD_NAMESPACE)"}],"resources":{"limits":{"cpu":"2","memory":"2Gi"},"requests":{"cpu":"1","memory":"2Gi"}},"volumeMounts":[{"name":"rabbitmq-erlang-cookie","mountPath":"/var/lib/rabbitmq/"},{"name":"persistence","mountPath":"/var/lib/rabbitmq/mnesia/"},{"name":"rabbitmq-plugins","mountPath":"/operator"},{"name":"rabbitmq-confd","mountPath":"/etc/rabbitmq/conf.d/10-operatorDefaults.conf","subPath":"operatorDefaults.conf"},{"name":"rabbitmq-confd","mountPath":"/etc/rabbitmq/conf.d/11-default_user.conf","subPath":"default_user.conf"},{"name":"rabbitmq-confd","mountPath":"/etc/rabbitmq/conf.d/90-userDefinedConfiguration.conf","subPath":"userDefinedConfiguration.conf"},{"name":"pod-info","mountPath":"/etc/pod-info/"}],"readinessProbe":{"tcpSocket":{"port":"amqp"},"initialDelaySeconds":10,"timeoutSeconds":5,"periodSeconds":10,"successThreshold":1,"failureThreshold":3},"lifecycle":{"preStop":{"exec":{"command":["/bin/bash","-c","if [ ! -z \"$(cat /etc/pod-info/skipPreStopChecks)\" ]; then exit 0; fi; rabbitmq-upgrade await_online_quorum_plus_one -t 604800; rabbitmq-upgrade await_online_synchronized_mirror -t 604800; rabbitmq-upgrade drain -t 604800"]}}},"terminationMessagePath":"/dev/termination-log","terminationMessagePolicy":"File","imagePullPolicy":"IfNotPresent"}],"restartPolicy":"Always","terminationGracePeriodSeconds":604800,"dnsPolicy":"ClusterFirst","serviceAccountName":"rabbitmq-cluster-server","serviceAccount":"rabbitmq-cluster-server","automountServiceAccountToken":true,"securityContext":{"runAsUser":999,"runAsGroup":999,"fsGroup":999},"schedulerName":"default-scheduler","topologySpreadConstraints":[{"maxSkew":1,"topologyKey":"topology.kubernetes.io/zone","whenUnsatisfiable":"ScheduleAnyway","labelSelector":{"matchLabels":{"app.kubernetes.io/name":"rabbitmq-cluster"}}}]}},"volumeClaimTemplates":[{"metadata":{"name":"persistence","namespace":"default","creationTimestamp":null,"labels":{"app.kubernetes.io/component":"rabbitmq","app.kubernetes.io/name":"rabbitmq-cluster","app.kubernetes.io/part-of":"rabbitmq"},"ownerReferences":[{"apiVersion":"rabbitmq.com/v1beta1","kind":"RabbitmqCluster","name":"rabbitmq-cluster","uid":"3ecefa8a-1bec-48a7-9af4-dd0df3339101","controller":true,"blockOwnerDeletion":false}]},"spec":{"accessModes":["ReadWriteOnce"],"resources":{"requests":{"storage":"15Gi"}},"volumeMode":"Filesystem"},"status":{"phase":"Pending"}}],"serviceName":"rabbitmq-cluster-nodes","podManagementPolicy":"Parallel","updateStrategy":{"type":"RollingUpdate","rollingUpdate":{"partition":0}},"revisionHistoryLimit":10},"status":{"observedGeneration":1,"replicas":1,"readyReplicas":1,"currentReplicas":1,"updatedReplicas":1,"currentRevision":"rabbitmq-cluster-server-5f8b8665fb","updateRevision":"rabbitmq-cluster-server-5f8b8665fb","collisionCount":0}}
2022/03/18 18:07:35 learn_server.go:291: [SIEVE-AFTER-READ]	Get	true	configmap	default	rabbitmq-cluster-plugins-conf	github.com/rabbitmq/cluster-operator/controllers.(*RabbitmqClusterReconciler)	NoError	{"kind":"ConfigMap","apiVersion":"v1","metadata":{"name":"rabbitmq-cluster-plugins-conf","namespace":"default","selfLink":"/api/v1/namespaces/default/configmaps/rabbitmq-cluster-plugins-conf","uid":"0aa26eb6-ff3a-4457-a223-284c897db7fe","resourceVersion":"1092","creationTimestamp":"2022-03-18T18:06:25Z","labels":{"app.kubernetes.io/component":"rabbitmq","app.kubernetes.io/name":"rabbitmq-cluster","app.kubernetes.io/part-of":"rabbitmq"},"ownerReferences":[{"apiVersion":"rabbitmq.com/v1beta1","kind":"RabbitmqCluster","name":"rabbitmq-cluster","uid":"3ecefa8a-1bec-48a7-9af4-dd0df3339101","controller":true,"blockOwnerDeletion":true}],"managedFields":[{"manager":"manager","operation":"Update","apiVersion":"v1","time":"2022-03-18T18:06:25Z","fieldsType":"FieldsV1","fieldsV1":{"f:data":{".":{},"f:enabled_plugins":{}},"f:metadata":{"f:labels":{".":{},"f:app.kubernetes.io/component":{},"f:app.kubernetes.io/name":{},"f:app.kubernetes.io/part-of":{}},"f:ownerReferences":{".":{},"k:{\"uid\":\"3ecefa8a-1bec-48a7-9af4-dd0df3339101\"}":{".":{},"f:apiVersion":{},"f:blockOwnerDeletion":{},"f:controller":{},"f:kind":{},"f:name":{},"f:uid":{}}}}}}]},"data":{"enabled_plugins":"[rabbitmq_peer_discovery_k8s,rabbitmq_prometheus,rabbitmq_management]."}}
2022/03/18 18:07:35 learn_server.go:256: [SIEVE-BEFORE-WRITE]	51
2022/03/18 18:07:35 learn_server.go:263: [SIEVE-AFTER-WRITE]	51	StatusUpdate	rabbitmqcluster	github.com/rabbitmq/cluster-operator/controllers.(*RabbitmqClusterReconciler)	NoError	{"metadata":{"name":"rabbitmq-cluster","namespace":"default","selfLink":"/apis/rabbitmq.com/v1beta1/namespaces/default/rabbitmqclusters/rabbitmq-cluster/status","uid":"3ecefa8a-1bec-48a7-9af4-dd0df3339101","resourceVersion":"1482","generation":3,"creationTimestamp":"2022-03-18T18:06:25Z","annotations":{"kubectl.kubernetes.io/last-applied-configuration":"{\"apiVersion\":\"rabbitmq.com/v1beta1\",\"kind\":\"RabbitmqCluster\",\"metadata\":{\"annotations\":{},\"name\":\"rabbitmq-cluster\",\"namespace\":\"default\"},\"spec\":{\"persistence\":{\"storage\":\"10Gi\"},\"replicas\":1}}\n"},"finalizers":["deletion.finalizers.rabbitmqclusters.rabbitmq.com"],"managedFields":[{"manager":"kubectl-client-side-apply","operation":"Update","apiVersion":"rabbitmq.com/v1beta1","time":"2022-03-18T18:06:25Z","fieldsType":"FieldsV1","fieldsV1":{"f:metadata":{"f:annotations":{".":{},"f:kubectl.kubernetes.io/last-applied-configuration":{}}},"f:spec":{".":{},"f:image":{},"f:persistence":{},"f:replicas":{},"f:resources":{".":{},"f:limits":{".":{},"f:memory":{}},"f:requests":{".":{},"f:memory":{}}},"f:service":{".":{},"f:type":{}},"f:terminationGracePeriodSeconds":{}}}},{"manager":"kubectl-patch","operation":"Update","apiVersion":"rabbitmq.com/v1beta1","time":"2022-03-18T18:07:31Z","fieldsType":"FieldsV1","fieldsV1":{"f:spec":{"f:persistence":{"f:storage":{}}}}},{"manager":"manager","operation":"Update","apiVersion":"rabbitmq.com/v1beta1","time":"2022-03-18T18:07:35Z","fieldsType":"FieldsV1","fieldsV1":{"f:metadata":{"f:finalizers":{}},"f:spec":{"f:override":{},"f:rabbitmq":{},"f:resources":{"f:limits":{"f:cpu":{}},"f:requests":{"f:cpu":{}}},"f:tls":{}},"f:status":{".":{},"f:conditions":{},"f:defaultUser":{".":{},"f:secretReference":{".":{},"f:keys":{".":{},"f:password":{},"f:username":{}},"f:name":{},"f:namespace":{}},"f:serviceReference":{".":{},"f:name":{},"f:namespace":{}}}}}}]},"spec":{"replicas":1,"image":"rabbitmq:3.8.12-management","service":{"type":"ClusterIP"},"persistence":{"storage":"15Gi"},"resources":{"limits":{"cpu":"2","memory":"2Gi"},"requests":{"cpu":"1","memory":"2Gi"}},"rabbitmq":{},"tls":{},"override":{},"terminationGracePeriodSeconds":604800},"status":{"conditions":[{"type":"AllReplicasReady","status":"True","lastTransitionTime":"2022-03-18T18:07:35Z","reason":"AllPodsAreReady"},{"type":"ClusterAvailable","status":"True","lastTransitionTime":"2022-03-18T18:07:23Z","reason":"AtLeastOneEndpointAvailable"},{"type":"NoWarnings","status":"True","lastTransitionTime":"2022-03-18T18:06:25Z","reason":"NoWarnings"},{"type":"ReconcileSuccess","status":"True","lastTransitionTime":"2022-03-18T18:07:24Z","reason":"Success","message":"Finish reconciling"}],"defaultUser":{"secretReference":{"name":"rabbitmq-cluster-default-user","namespace":"default","keys":{"password":"password","username":"username"}},"serviceReference":{"name":"rabbitmq-cluster","namespace":"default"}},"binding":{"name":"rabbitmq-cluster-default-user"}}}
2022/03/18 18:07:35 learn_server.go:253: [SIEVE-AFTER-RECONCILE]	github.com/rabbitmq/cluster-operator/controllers.(*RabbitmqClusterReconciler)	11
2022/03/18 18:07:35 learn_server.go:238: [SIEVE-BEFORE-RECONCILE]	github.com/rabbitmq/cluster-operator/controllers.(*RabbitmqClusterReconciler)	12
2022/03/18 18:07:35 learn_server.go:291: [SIEVE-AFTER-READ]	Get	true	rabbitmqcluster	default	rabbitmq-cluster	github.com/rabbitmq/cluster-operator/controllers.(*RabbitmqClusterReconciler)	NoError	{"kind":"RabbitmqCluster","apiVersion":"rabbitmq.com/v1beta1","metadata":{"name":"rabbitmq-cluster","namespace":"default","selfLink":"/apis/rabbitmq.com/v1beta1/namespaces/default/rabbitmqclusters/rabbitmq-cluster","uid":"3ecefa8a-1bec-48a7-9af4-dd0df3339101","resourceVersion":"1482","generation":3,"creationTimestamp":"2022-03-18T18:06:25Z","annotations":{"kubectl.kubernetes.io/last-applied-configuration":"{\"apiVersion\":\"rabbitmq.com/v1beta1\",\"kind\":\"RabbitmqCluster\",\"metadata\":{\"annotations\":{},\"name\":\"rabbitmq-cluster\",\"namespace\":\"default\"},\"spec\":{\"persistence\":{\"storage\":\"10Gi\"},\"replicas\":1}}\n"},"finalizers":["deletion.finalizers.rabbitmqclusters.rabbitmq.com"],"managedFields":[{"manager":"kubectl-client-side-apply","operation":"Update","apiVersion":"rabbitmq.com/v1beta1","time":"2022-03-18T18:06:25Z","fieldsType":"FieldsV1","fieldsV1":{"f:metadata":{"f:annotations":{".":{},"f:kubectl.kubernetes.io/last-applied-configuration":{}}},"f:spec":{".":{},"f:image":{},"f:persistence":{},"f:replicas":{},"f:resources":{".":{},"f:limits":{".":{},"f:memory":{}},"f:requests":{".":{},"f:memory":{}}},"f:service":{".":{},"f:type":{}},"f:terminationGracePeriodSeconds":{}}}},{"manager":"kubectl-patch","operation":"Update","apiVersion":"rabbitmq.com/v1beta1","time":"2022-03-18T18:07:31Z","fieldsType":"FieldsV1","fieldsV1":{"f:spec":{"f:persistence":{"f:storage":{}}}}},{"manager":"manager","operation":"Update","apiVersion":"rabbitmq.com/v1beta1","time":"2022-03-18T18:07:35Z","fieldsType":"FieldsV1","fieldsV1":{"f:metadata":{"f:finalizers":{}},"f:spec":{"f:override":{},"f:rabbitmq":{},"f:resources":{"f:limits":{"f:cpu":{}},"f:requests":{"f:cpu":{}}},"f:tls":{}},"f:status":{".":{},"f:conditions":{},"f:defaultUser":{".":{},"f:secretReference":{".":{},"f:keys":{".":{},"f:password":{},"f:username":{}},"f:name":{},"f:namespace":{}},"f:serviceReference":{".":{},"f:name":{},"f:namespace":{}}}}}}]},"spec":{"replicas":1,"image":"rabbitmq:3.8.12-management","service":{"type":"ClusterIP"},"persistence":{"storage":"15Gi"},"resources":{"limits":{"cpu":"2","memory":"2Gi"},"requests":{"cpu":"1","memory":"2Gi"}},"rabbitmq":{},"tls":{},"override":{},"terminationGracePeriodSeconds":604800},"status":{"conditions":[{"type":"AllReplicasReady","status":"True","lastTransitionTime":"2022-03-18T18:07:35Z","reason":"AllPodsAreReady"},{"type":"ClusterAvailable","status":"True","lastTransitionTime":"2022-03-18T18:07:23Z","reason":"AtLeastOneEndpointAvailable"},{"type":"NoWarnings","status":"True","lastTransitionTime":"2022-03-18T18:06:25Z","reason":"NoWarnings"},{"type":"ReconcileSuccess","status":"True","lastTransitionTime":"2022-03-18T18:07:24Z","reason":"Success","message":"Finish reconciling"}],"defaultUser":{"secretReference":{"name":"rabbitmq-cluster-default-user","namespace":"default","keys":{"password":"password","username":"username"}},"serviceReference":{"name":"rabbitmq-cluster","namespace":"default"}}}}
2022/03/18 18:07:35 learn_server.go:291: [SIEVE-AFTER-READ]	Get	true	statefulset	default	rabbitmq-cluster-server	github.com/rabbitmq/cluster-operator/controllers.(*RabbitmqClusterReconciler)	NoError	{"kind":"StatefulSet","apiVersion":"apps/v1","metadata":{"name":"rabbitmq-cluster-server","namespace":"default","selfLink":"/apis/apps/v1/namespaces/default/statefulsets/rabbitmq-cluster-server","uid":"1d62d993-2c32-4da7-8884-e4cfad9e587d","resourceVersion":"1481","generation":1,"creationTimestamp":"2022-03-18T18:07:34Z","labels":{"app.kubernetes.io/component":"rabbitmq","app.kubernetes.io/name":"rabbitmq-cluster","app.kubernetes.io/part-of":"rabbitmq"},"ownerReferences":[{"apiVersion":"rabbitmq.com/v1beta1","kind":"RabbitmqCluster","name":"rabbitmq-cluster","uid":"3ecefa8a-1bec-48a7-9af4-dd0df3339101","controller":true,"blockOwnerDeletion":true}],"managedFields":[{"manager":"kube-controller-manager","operation":"Update","apiVersion":"apps/v1","time":"2022-03-18T18:07:34Z","fieldsType":"FieldsV1","fieldsV1":{"f:status":{"f:collisionCount":{},"f:currentReplicas":{},"f:currentRevision":{},"f:observedGeneration":{},"f:readyReplicas":{},"f:replicas":{},"f:updateRevision":{},"f:updatedReplicas":{}}}},{"manager":"manager","operation":"Update","apiVersion":"apps/v1","time":"2022-03-18T18:07:34Z","fieldsType":"FieldsV1","fieldsV1":{"f:metadata":{"f:labels":{".":{},"f:app.kubernetes.io/component":{},"f:app.kubernetes.io/name":{},"f:app.kubernetes.io/part-of":{}},"f:ownerReferences":{".":{},"k:{\"uid\":\"3ecefa8a-1bec-48a7-9af4-dd0df3339101\"}":{".":{},"f:apiVersion":{},"f:blockOwnerDeletion":{},"f:controller":{},"f:kind":{},"f:name":{},"f:uid":{}}}},"f:spec":{"f:podManagementPolicy":{},"f:replicas":{},"f:revisionHistoryLimit":{},"f:selector":{"f:matchLabels":{".":{},"f:app.kubernetes.io/name":{}}},"f:serviceName":{},"f:template":{"f:metadata":{"f:annotations":{".":{},"f:prometheus.io/port":{},"f:prometheus.io/scrape":{}},"f:labels":{".":{},"f:app.kubernetes.io/component":{},"f:app.kubernetes.io/name":{},"f:app.kubernetes.io/part-of":{}}},"f:spec":{"f:automountServiceAccountToken":{},"f:containers":{"k:{\"name\":\"rabbitmq\"}":{".":{},"f:env":{".":{},"k:{\"name\":\"K8S_HOSTNAME_SUFFIX\"}":{".":{},"f:name":{},"f:value":{}},"k:{\"name\":\"K8S_SERVICE_NAME\"}":{".":{},"f:name":{},"f:value":{}},"k:{\"name\":\"MY_POD_NAME\"}":{".":{},"f:name":{},"f:valueFrom":{".":{},"f:fieldRef":{".":{},"f:apiVersion":{},"f:fieldPath":{}}}},"k:{\"name\":\"MY_POD_NAMESPACE\"}":{".":{},"f:name":{},"f:valueFrom":{".":{},"f:fieldRef":{".":{},"f:apiVersion":{},"f:fieldPath":{}}}},"k:{\"name\":\"RABBITMQ_ENABLED_PLUGINS_FILE\"}":{".":{},"f:name":{},"f:value":{}},"k:{\"name\":\"RABBITMQ_NODENAME\"}":{".":{},"f:name":{},"f:value":{}},"k:{\"name\":\"RABBITMQ_USE_LONGNAME\"}":{".":{},"f:name":{},"f:value":{}}},"f:image":{},"f:imagePullPolicy":{},"f:lifecycle":{".":{},"f:preStop":{".":{},"f:exec":{".":{},"f:command":{}}}},"f:name":{},"f:ports":{".":{},"k:{\"containerPort\":4369,\"protocol\":\"TCP\"}":{".":{},"f:containerPort":{},"f:name":{},"f:protocol":{}},"k:{\"containerPort\":5672,\"protocol\":\"TCP\"}":{".":{},"f:containerPort":{},"f:name":{},"f:protocol":{}},"k:{\"containerPort\":15672,\"protocol\":\"TCP\"}":{".":{},"f:containerPort":{},"f:name":{},"f:protocol":{}},"k:{\"containerPort\":15692,\"protocol\":\"TCP\"}":{".":{},"f:containerPort":{},"f:name":{},"f:protocol":{}}},"f:readinessProbe":{".":{},"f:failureThreshold":{},"f:initialDelaySeconds":{},"f:periodSeconds":{},"f:successThreshold":{},"f:tcpSocket":{".":{},"f:port":{}},"f:timeoutSeconds":{}},"f:resources":{".":{},"f:limits":{".":{},"f:cpu":{},"f:memory":{}},"f:requests":{".":{},"f:cpu":{},"f:memory":{}}},"f:terminationMessagePath":{},"f:terminationMessagePolicy":{},"f:volumeMounts":{".":{},"k:{\"mountPath\":\"/etc/pod-info/\"}":{".":{},"f:mountPath":{},"f:name":{}},"k:{\"mountPath\":\"/etc/rabbitmq/conf.d/10-operatorDefaults.conf\"}":{".":{},"f:mountPath":{},"f:name":{},"f:subPath":{}},"k:{\"mountPath\":\"/etc/rabbitmq/conf.d/11-default_user.conf\"}":{".":{},"f:mountPath":{},"f:name":{},"f:subPath":{}},"k:{\"mountPath\":\"/etc/rabbitmq/conf.d/90-userDefinedConfiguration.conf\"}":{".":{},"f:mountPath":{},"f:name":{},"f:subPath":{}},"k:{\"mountPath\":\"/operator\"}":{".":{},"f:mountPath":{},"f:name":{}},"k:{\"mountPath\":\"/var/lib/rabbitmq/\"}":{".":{},"f:mountPath":{},"f:name":{}},"k:{\"mountPath\":\"/var/lib/rabbitmq/mnesia/\"}":{".":{},"f:mountPath":{},"f:name":{}}}}},"f:dnsPolicy":{},"f:initContainers":{".":{},"k:{\"name\":\"setup-container\"}":{".":{},"f:command":{},"f:image":{},"f:imagePullPolicy":{},"f:name":{},"f:resources":{".":{},"f:limits":{".":{},"f:cpu":{},"f:memory":{}},"f:requests":{".":{},"f:cpu":{},"f:memory":{}}},"f:securityContext":{".":{},"f:capabilities":{".":{},"f:drop":{}},"f:runAsUser":{}},"f:terminationMessagePath":{},"f:terminationMessagePolicy":{},"f:volumeMounts":{".":{},"k:{\"mountPath\":\"/operator\"}":{".":{},"f:mountPath":{},"f:name":{}},"k:{\"mountPath\":\"/tmp/default_user.conf\"}":{".":{},"f:mountPath":{},"f:name":{},"f:subPath":{}},"k:{\"mountPath\":\"/tmp/erlang-cookie-secret/\"}":{".":{},"f:mountPath":{},"f:name":{}},"k:{\"mountPath\":\"/tmp/rabbitmq-plugins/\"}":{".":{},"f:mountPath":{},"f:name":{}},"k:{\"mountPath\":\"/var/lib/rabbitmq/\"}":{".":{},"f:mountPath":{},"f:name":{}},"k:{\"mountPath\":\"/var/lib/rabbitmq/mnesia/\"}":{".":{},"f:mountPath":{},"f:name":{}}}}},"f:restartPolicy":{},"f:schedulerName":{},"f:securityContext":{".":{},"f:fsGroup":{},"f:runAsGroup":{},"f:runAsUser":{}},"f:serviceAccount":{},"f:serviceAccountName":{},"f:terminationGracePeriodSeconds":{},"f:topologySpreadConstraints":{".":{},"k:{\"topologyKey\":\"topology.kubernetes.io/zone\",\"whenUnsatisfiable\":\"ScheduleAnyway\"}":{".":{},"f:labelSelector":{".":{},"f:matchLabels":{".":{},"f:app.kubernetes.io/name":{}}},"f:maxSkew":{},"f:topologyKey":{},"f:whenUnsatisfiable":{}}},"f:volumes":{".":{},"k:{\"name\":\"erlang-cookie-secret\"}":{".":{},"f:name":{},"f:secret":{".":{},"f:defaultMode":{},"f:secretName":{}}},"k:{\"name\":\"plugins-conf\"}":{".":{},"f:configMap":{".":{},"f:defaultMode":{},"f:name":{}},"f:name":{}},"k:{\"name\":\"pod-info\"}":{".":{},"f:downwardAPI":{".":{},"f:defaultMode":{},"f:items":{}},"f:name":{}},"k:{\"name\":\"rabbitmq-confd\"}":{".":{},"f:name":{},"f:projected":{".":{},"f:defaultMode":{},"f:sources":{}}},"k:{\"name\":\"rabbitmq-erlang-cookie\"}":{".":{},"f:emptyDir":{},"f:name":{}},"k:{\"name\":\"rabbitmq-plugins\"}":{".":{},"f:emptyDir":{},"f:name":{}}}}},"f:updateStrategy":{"f:rollingUpdate":{".":{},"f:partition":{}},"f:type":{}},"f:volumeClaimTemplates":{}}}}]},"spec":{"replicas":1,"selector":{"matchLabels":{"app.kubernetes.io/name":"rabbitmq-cluster"}},"template":{"metadata":{"creationTimestamp":null,"labels":{"app.kubernetes.io/component":"rabbitmq","app.kubernetes.io/name":"rabbitmq-cluster","app.kubernetes.io/part-of":"rabbitmq"},"annotations":{"prometheus.io/port":"15692","prometheus.io/scrape":"true"}},"spec":{"volumes":[{"name":"plugins-conf","configMap":{"name":"rabbitmq-cluster-plugins-conf","defaultMode":420}},{"name":"rabbitmq-confd","projected":{"sources":[{"secret":{"name":"rabbitmq-cluster-default-user","items":[{"key":"default_user.conf","path":"default_user.conf"}]}},{"configMap":{"name":"rabbitmq-cluster-server-conf","items":[{"key":"operatorDefaults.conf","path":"operatorDefaults.conf"},{"key":"userDefinedConfiguration.conf","path":"userDefinedConfiguration.conf"}]}}],"defaultMode":420}},{"name":"rabbitmq-erlang-cookie","emptyDir":{}},{"name":"erlang-cookie-secret","secret":{"secretName":"rabbitmq-cluster-erlang-cookie","defaultMode":420}},{"name":"rabbitmq-plugins","emptyDir":{}},{"name":"pod-info","downwardAPI":{"items":[{"path":"skipPreStopChecks","fieldRef":{"apiVersion":"v1","fieldPath":"metadata.labels['skipPreStopChecks']"}}],"defaultMode":420}}],"initContainers":[{"name":"setup-container","image":"rabbitmq:3.8.12-management","command":["sh","-c","cp /tmp/erlang-cookie-secret/.erlang.cookie /var/lib/rabbitmq/.erlang.cookie \u0026\u0026 chown 999:999 /var/lib/rabbitmq/.erlang.cookie \u0026\u0026 chmod 600 /var/lib/rabbitmq/.erlang.cookie ; cp /tmp/rabbitmq-plugins/enabled_plugins /operator/enabled_plugins \u0026\u0026 chown 999:999 /operator/enabled_plugins ; chown 999:999 /var/lib/rabbitmq/mnesia/ ; echo '[default]' \u003e /var/lib/rabbitmq/.rabbitmqadmin.conf \u0026\u0026 sed -e 's/default_user/username/' -e 's/default_pass/password/' /tmp/default_user.conf \u003e\u003e /var/lib/rabbitmq/.rabbitmqadmin.conf \u0026\u0026 chown 999:999 /var/lib/rabbitmq/.rabbitmqadmin.conf \u0026\u0026 chmod 600 /var/lib/rabbitmq/.rabbitmqadmin.conf"],"resources":{"limits":{"cpu":"100m","memory":"500Mi"},"requests":{"cpu":"100m","memory":"500Mi"}},"volumeMounts":[{"name":"plugins-conf","mountPath":"/tmp/rabbitmq-plugins/"},{"name":"rabbitmq-erlang-cookie","mountPath":"/var/lib/rabbitmq/"},{"name":"erlang-cookie-secret","mountPath":"/tmp/erlang-cookie-secret/"},{"name":"rabbitmq-plugins","mountPath":"/operator"},{"name":"persistence","mountPath":"/var/lib/rabbitmq/mnesia/"},{"name":"rabbitmq-confd","mountPath":"/tmp/default_user.conf","subPath":"default_user.conf"}],"terminationMessagePath":"/dev/termination-log","terminationMessagePolicy":"File","imagePullPolicy":"IfNotPresent","securityContext":{"capabilities":{"drop":["FSETID","KILL","SETGID","SETUID","SETPCAP","NET_BIND_SERVICE","NET_RAW","SYS_CHROOT","MKNOD","AUDIT_WRITE","SETFCAP"]},"runAsUser":0}}],"containers":[{"name":"rabbitmq","image":"rabbitmq:3.8.12-management","ports":[{"name":"epmd","containerPort":4369,"protocol":"TCP"},{"name":"amqp","containerPort":5672,"protocol":"TCP"},{"name":"management","containerPort":15672,"protocol":"TCP"},{"name":"prometheus","containerPort":15692,"protocol":"TCP"}],"env":[{"name":"MY_POD_NAME","valueFrom":{"fieldRef":{"apiVersion":"v1","fieldPath":"metadata.name"}}},{"name":"MY_POD_NAMESPACE","valueFrom":{"fieldRef":{"apiVersion":"v1","fieldPath":"metadata.namespace"}}},{"name":"RABBITMQ_ENABLED_PLUGINS_FILE","value":"/operator/enabled_plugins"},{"name":"K8S_SERVICE_NAME","value":"rabbitmq-cluster-nodes"},{"name":"RABBITMQ_USE_LONGNAME","value":"true"},{"name":"RABBITMQ_NODENAME","value":"rabbit@$(MY_POD_NAME).$(K8S_SERVICE_NAME).$(MY_POD_NAMESPACE)"},{"name":"K8S_HOSTNAME_SUFFIX","value":".$(K8S_SERVICE_NAME).$(MY_POD_NAMESPACE)"}],"resources":{"limits":{"cpu":"2","memory":"2Gi"},"requests":{"cpu":"1","memory":"2Gi"}},"volumeMounts":[{"name":"rabbitmq-erlang-cookie","mountPath":"/var/lib/rabbitmq/"},{"name":"persistence","mountPath":"/var/lib/rabbitmq/mnesia/"},{"name":"rabbitmq-plugins","mountPath":"/operator"},{"name":"rabbitmq-confd","mountPath":"/etc/rabbitmq/conf.d/10-operatorDefaults.conf","subPath":"operatorDefaults.conf"},{"name":"rabbitmq-confd","mountPath":"/etc/rabbitmq/conf.d/11-default_user.conf","subPath":"default_user.conf"},{"name":"rabbitmq-confd","mountPath":"/etc/rabbitmq/conf.d/90-userDefinedConfiguration.conf","subPath":"userDefinedConfiguration.conf"},{"name":"pod-info","mountPath":"/etc/pod-info/"}],"readinessProbe":{"tcpSocket":{"port":"amqp"},"initialDelaySeconds":10,"timeoutSeconds":5,"periodSeconds":10,"successThreshold":1,"failureThreshold":3},"lifecycle":{"preStop":{"exec":{"command":["/bin/bash","-c","if [ ! -z \"$(cat /etc/pod-info/skipPreStopChecks)\" ]; then exit 0; fi; rabbitmq-upgrade await_online_quorum_plus_one -t 604800; rabbitmq-upgrade await_online_synchronized_mirror -t 604800; rabbitmq-upgrade drain -t 604800"]}}},"terminationMessagePath":"/dev/termination-log","terminationMessagePolicy":"File","imagePullPolicy":"IfNotPresent"}],"restartPolicy":"Always","terminationGracePeriodSeconds":604800,"dnsPolicy":"ClusterFirst","serviceAccountName":"rabbitmq-cluster-server","serviceAccount":"rabbitmq-cluster-server","automountServiceAccountToken":true,"securityContext":{"runAsUser":999,"runAsGroup":999,"fsGroup":999},"schedulerName":"default-scheduler","topologySpreadConstraints":[{"maxSkew":1,"topologyKey":"topology.kubernetes.io/zone","whenUnsatisfiable":"ScheduleAnyway","labelSelector":{"matchLabels":{"app.kubernetes.io/name":"rabbitmq-cluster"}}}]}},"volumeClaimTemplates":[{"metadata":{"name":"persistence","namespace":"default","creationTimestamp":null,"labels":{"app.kubernetes.io/component":"rabbitmq","app.kubernetes.io/name":"rabbitmq-cluster","app.kubernetes.io/part-of":"rabbitmq"},"ownerReferences":[{"apiVersion":"rabbitmq.com/v1beta1","kind":"RabbitmqCluster","name":"rabbitmq-cluster","uid":"3ecefa8a-1bec-48a7-9af4-dd0df3339101","controller":true,"blockOwnerDeletion":false}]},"spec":{"accessModes":["ReadWriteOnce"],"resources":{"requests":{"storage":"15Gi"}},"volumeMode":"Filesystem"},"status":{"phase":"Pending"}}],"serviceName":"rabbitmq-cluster-nodes","podManagementPolicy":"Parallel","updateStrategy":{"type":"RollingUpdate","rollingUpdate":{"partition":0}},"revisionHistoryLimit":10},"status":{"observedGeneration":1,"replicas":1,"readyReplicas":1,"currentReplicas":1,"updatedReplicas":1,"currentRevision":"rabbitmq-cluster-server-5f8b8665fb","updateRevision":"rabbitmq-cluster-server-5f8b8665fb","collisionCount":0}}
2022/03/18 18:07:35 learn_server.go:291: [SIEVE-AFTER-READ]	Get	true	endpoints	default	rabbitmq-cluster	github.com/rabbitmq/cluster-operator/controllers.(*RabbitmqClusterReconciler)	NoError	{"kind":"Endpoints","apiVersion":"v1","metadata":{"name":"rabbitmq-cluster","namespace":"default","selfLink":"/api/v1/namespaces/default/endpoints/rabbitmq-cluster","uid":"eeba9576-0362-4e74-aafd-71e4ffe98d25","resourceVersion":"1402","creationTimestamp":"2022-03-18T18:06:25Z","labels":{"app.kubernetes.io/component":"rabbitmq","app.kubernetes.io/name":"rabbitmq-cluster","app.kubernetes.io/part-of":"rabbitmq"},"annotations":{"endpoints.kubernetes.io/last-change-trigger-time":"2022-03-18T18:07:23Z"},"managedFields":[{"manager":"kube-controller-manager","operation":"Update","apiVersion":"v1","time":"2022-03-18T18:07:23Z","fieldsType":"FieldsV1","fieldsV1":{"f:metadata":{"f:annotations":{".":{},"f:endpoints.kubernetes.io/last-change-trigger-time":{}},"f:labels":{".":{},"f:app.kubernetes.io/component":{},"f:app.kubernetes.io/name":{},"f:app.kubernetes.io/part-of":{}}},"f:subsets":{}}}]},"subsets":[{"addresses":[{"ip":"10.244.1.4","nodeName":"kind-worker","targetRef":{"kind":"Pod","namespace":"default","name":"rabbitmq-cluster-server-0","uid":"cbaba199-5faf-480a-81e8-051ce2cc79e6","resourceVersion":"1399"}}],"ports":[{"name":"amqp","port":5672,"protocol":"TCP"},{"name":"management","port":15672,"protocol":"TCP"}]}]}
2022/03/18 18:07:35 learn_server.go:291: [SIEVE-AFTER-READ]	Get	true	statefulset	default	rabbitmq-cluster-server	github.com/rabbitmq/cluster-operator/controllers.(*RabbitmqClusterReconciler)	NoError	{"kind":"StatefulSet","apiVersion":"apps/v1","metadata":{"name":"rabbitmq-cluster-server","namespace":"default","selfLink":"/apis/apps/v1/namespaces/default/statefulsets/rabbitmq-cluster-server","uid":"1d62d993-2c32-4da7-8884-e4cfad9e587d","resourceVersion":"1481","generation":1,"creationTimestamp":"2022-03-18T18:07:34Z","labels":{"app.kubernetes.io/component":"rabbitmq","app.kubernetes.io/name":"rabbitmq-cluster","app.kubernetes.io/part-of":"rabbitmq"},"ownerReferences":[{"apiVersion":"rabbitmq.com/v1beta1","kind":"RabbitmqCluster","name":"rabbitmq-cluster","uid":"3ecefa8a-1bec-48a7-9af4-dd0df3339101","controller":true,"blockOwnerDeletion":true}],"managedFields":[{"manager":"kube-controller-manager","operation":"Update","apiVersion":"apps/v1","time":"2022-03-18T18:07:34Z","fieldsType":"FieldsV1","fieldsV1":{"f:status":{"f:collisionCount":{},"f:currentReplicas":{},"f:currentRevision":{},"f:observedGeneration":{},"f:readyReplicas":{},"f:replicas":{},"f:updateRevision":{},"f:updatedReplicas":{}}}},{"manager":"manager","operation":"Update","apiVersion":"apps/v1","time":"2022-03-18T18:07:34Z","fieldsType":"FieldsV1","fieldsV1":{"f:metadata":{"f:labels":{".":{},"f:app.kubernetes.io/component":{},"f:app.kubernetes.io/name":{},"f:app.kubernetes.io/part-of":{}},"f:ownerReferences":{".":{},"k:{\"uid\":\"3ecefa8a-1bec-48a7-9af4-dd0df3339101\"}":{".":{},"f:apiVersion":{},"f:blockOwnerDeletion":{},"f:controller":{},"f:kind":{},"f:name":{},"f:uid":{}}}},"f:spec":{"f:podManagementPolicy":{},"f:replicas":{},"f:revisionHistoryLimit":{},"f:selector":{"f:matchLabels":{".":{},"f:app.kubernetes.io/name":{}}},"f:serviceName":{},"f:template":{"f:metadata":{"f:annotations":{".":{},"f:prometheus.io/port":{},"f:prometheus.io/scrape":{}},"f:labels":{".":{},"f:app.kubernetes.io/component":{},"f:app.kubernetes.io/name":{},"f:app.kubernetes.io/part-of":{}}},"f:spec":{"f:automountServiceAccountToken":{},"f:containers":{"k:{\"name\":\"rabbitmq\"}":{".":{},"f:env":{".":{},"k:{\"name\":\"K8S_HOSTNAME_SUFFIX\"}":{".":{},"f:name":{},"f:value":{}},"k:{\"name\":\"K8S_SERVICE_NAME\"}":{".":{},"f:name":{},"f:value":{}},"k:{\"name\":\"MY_POD_NAME\"}":{".":{},"f:name":{},"f:valueFrom":{".":{},"f:fieldRef":{".":{},"f:apiVersion":{},"f:fieldPath":{}}}},"k:{\"name\":\"MY_POD_NAMESPACE\"}":{".":{},"f:name":{},"f:valueFrom":{".":{},"f:fieldRef":{".":{},"f:apiVersion":{},"f:fieldPath":{}}}},"k:{\"name\":\"RABBITMQ_ENABLED_PLUGINS_FILE\"}":{".":{},"f:name":{},"f:value":{}},"k:{\"name\":\"RABBITMQ_NODENAME\"}":{".":{},"f:name":{},"f:value":{}},"k:{\"name\":\"RABBITMQ_USE_LONGNAME\"}":{".":{},"f:name":{},"f:value":{}}},"f:image":{},"f:imagePullPolicy":{},"f:lifecycle":{".":{},"f:preStop":{".":{},"f:exec":{".":{},"f:command":{}}}},"f:name":{},"f:ports":{".":{},"k:{\"containerPort\":4369,\"protocol\":\"TCP\"}":{".":{},"f:containerPort":{},"f:name":{},"f:protocol":{}},"k:{\"containerPort\":5672,\"protocol\":\"TCP\"}":{".":{},"f:containerPort":{},"f:name":{},"f:protocol":{}},"k:{\"containerPort\":15672,\"protocol\":\"TCP\"}":{".":{},"f:containerPort":{},"f:name":{},"f:protocol":{}},"k:{\"containerPort\":15692,\"protocol\":\"TCP\"}":{".":{},"f:containerPort":{},"f:name":{},"f:protocol":{}}},"f:readinessProbe":{".":{},"f:failureThreshold":{},"f:initialDelaySeconds":{},"f:periodSeconds":{},"f:successThreshold":{},"f:tcpSocket":{".":{},"f:port":{}},"f:timeoutSeconds":{}},"f:resources":{".":{},"f:limits":{".":{},"f:cpu":{},"f:memory":{}},"f:requests":{".":{},"f:cpu":{},"f:memory":{}}},"f:terminationMessagePath":{},"f:terminationMessagePolicy":{},"f:volumeMounts":{".":{},"k:{\"mountPath\":\"/etc/pod-info/\"}":{".":{},"f:mountPath":{},"f:name":{}},"k:{\"mountPath\":\"/etc/rabbitmq/conf.d/10-operatorDefaults.conf\"}":{".":{},"f:mountPath":{},"f:name":{},"f:subPath":{}},"k:{\"mountPath\":\"/etc/rabbitmq/conf.d/11-default_user.conf\"}":{".":{},"f:mountPath":{},"f:name":{},"f:subPath":{}},"k:{\"mountPath\":\"/etc/rabbitmq/conf.d/90-userDefinedConfiguration.conf\"}":{".":{},"f:mountPath":{},"f:name":{},"f:subPath":{}},"k:{\"mountPath\":\"/operator\"}":{".":{},"f:mountPath":{},"f:name":{}},"k:{\"mountPath\":\"/var/lib/rabbitmq/\"}":{".":{},"f:mountPath":{},"f:name":{}},"k:{\"mountPath\":\"/var/lib/rabbitmq/mnesia/\"}":{".":{},"f:mountPath":{},"f:name":{}}}}},"f:dnsPolicy":{},"f:initContainers":{".":{},"k:{\"name\":\"setup-container\"}":{".":{},"f:command":{},"f:image":{},"f:imagePullPolicy":{},"f:name":{},"f:resources":{".":{},"f:limits":{".":{},"f:cpu":{},"f:memory":{}},"f:requests":{".":{},"f:cpu":{},"f:memory":{}}},"f:securityContext":{".":{},"f:capabilities":{".":{},"f:drop":{}},"f:runAsUser":{}},"f:terminationMessagePath":{},"f:terminationMessagePolicy":{},"f:volumeMounts":{".":{},"k:{\"mountPath\":\"/operator\"}":{".":{},"f:mountPath":{},"f:name":{}},"k:{\"mountPath\":\"/tmp/default_user.conf\"}":{".":{},"f:mountPath":{},"f:name":{},"f:subPath":{}},"k:{\"mountPath\":\"/tmp/erlang-cookie-secret/\"}":{".":{},"f:mountPath":{},"f:name":{}},"k:{\"mountPath\":\"/tmp/rabbitmq-plugins/\"}":{".":{},"f:mountPath":{},"f:name":{}},"k:{\"mountPath\":\"/var/lib/rabbitmq/\"}":{".":{},"f:mountPath":{},"f:name":{}},"k:{\"mountPath\":\"/var/lib/rabbitmq/mnesia/\"}":{".":{},"f:mountPath":{},"f:name":{}}}}},"f:restartPolicy":{},"f:schedulerName":{},"f:securityContext":{".":{},"f:fsGroup":{},"f:runAsGroup":{},"f:runAsUser":{}},"f:serviceAccount":{},"f:serviceAccountName":{},"f:terminationGracePeriodSeconds":{},"f:topologySpreadConstraints":{".":{},"k:{\"topologyKey\":\"topology.kubernetes.io/zone\",\"whenUnsatisfiable\":\"ScheduleAnyway\"}":{".":{},"f:labelSelector":{".":{},"f:matchLabels":{".":{},"f:app.kubernetes.io/name":{}}},"f:maxSkew":{},"f:topologyKey":{},"f:whenUnsatisfiable":{}}},"f:volumes":{".":{},"k:{\"name\":\"erlang-cookie-secret\"}":{".":{},"f:name":{},"f:secret":{".":{},"f:defaultMode":{},"f:secretName":{}}},"k:{\"name\":\"plugins-conf\"}":{".":{},"f:configMap":{".":{},"f:defaultMode":{},"f:name":{}},"f:name":{}},"k:{\"name\":\"pod-info\"}":{".":{},"f:downwardAPI":{".":{},"f:defaultMode":{},"f:items":{}},"f:name":{}},"k:{\"name\":\"rabbitmq-confd\"}":{".":{},"f:name":{},"f:projected":{".":{},"f:defaultMode":{},"f:sources":{}}},"k:{\"name\":\"rabbitmq-erlang-cookie\"}":{".":{},"f:emptyDir":{},"f:name":{}},"k:{\"name\":\"rabbitmq-plugins\"}":{".":{},"f:emptyDir":{},"f:name":{}}}}},"f:updateStrategy":{"f:rollingUpdate":{".":{},"f:partition":{}},"f:type":{}},"f:volumeClaimTemplates":{}}}}]},"spec":{"replicas":1,"selector":{"matchLabels":{"app.kubernetes.io/name":"rabbitmq-cluster"}},"template":{"metadata":{"creationTimestamp":null,"labels":{"app.kubernetes.io/component":"rabbitmq","app.kubernetes.io/name":"rabbitmq-cluster","app.kubernetes.io/part-of":"rabbitmq"},"annotations":{"prometheus.io/port":"15692","prometheus.io/scrape":"true"}},"spec":{"volumes":[{"name":"plugins-conf","configMap":{"name":"rabbitmq-cluster-plugins-conf","defaultMode":420}},{"name":"rabbitmq-confd","projected":{"sources":[{"secret":{"name":"rabbitmq-cluster-default-user","items":[{"key":"default_user.conf","path":"default_user.conf"}]}},{"configMap":{"name":"rabbitmq-cluster-server-conf","items":[{"key":"operatorDefaults.conf","path":"operatorDefaults.conf"},{"key":"userDefinedConfiguration.conf","path":"userDefinedConfiguration.conf"}]}}],"defaultMode":420}},{"name":"rabbitmq-erlang-cookie","emptyDir":{}},{"name":"erlang-cookie-secret","secret":{"secretName":"rabbitmq-cluster-erlang-cookie","defaultMode":420}},{"name":"rabbitmq-plugins","emptyDir":{}},{"name":"pod-info","downwardAPI":{"items":[{"path":"skipPreStopChecks","fieldRef":{"apiVersion":"v1","fieldPath":"metadata.labels['skipPreStopChecks']"}}],"defaultMode":420}}],"initContainers":[{"name":"setup-container","image":"rabbitmq:3.8.12-management","command":["sh","-c","cp /tmp/erlang-cookie-secret/.erlang.cookie /var/lib/rabbitmq/.erlang.cookie \u0026\u0026 chown 999:999 /var/lib/rabbitmq/.erlang.cookie \u0026\u0026 chmod 600 /var/lib/rabbitmq/.erlang.cookie ; cp /tmp/rabbitmq-plugins/enabled_plugins /operator/enabled_plugins \u0026\u0026 chown 999:999 /operator/enabled_plugins ; chown 999:999 /var/lib/rabbitmq/mnesia/ ; echo '[default]' \u003e /var/lib/rabbitmq/.rabbitmqadmin.conf \u0026\u0026 sed -e 's/default_user/username/' -e 's/default_pass/password/' /tmp/default_user.conf \u003e\u003e /var/lib/rabbitmq/.rabbitmqadmin.conf \u0026\u0026 chown 999:999 /var/lib/rabbitmq/.rabbitmqadmin.conf \u0026\u0026 chmod 600 /var/lib/rabbitmq/.rabbitmqadmin.conf"],"resources":{"limits":{"cpu":"100m","memory":"500Mi"},"requests":{"cpu":"100m","memory":"500Mi"}},"volumeMounts":[{"name":"plugins-conf","mountPath":"/tmp/rabbitmq-plugins/"},{"name":"rabbitmq-erlang-cookie","mountPath":"/var/lib/rabbitmq/"},{"name":"erlang-cookie-secret","mountPath":"/tmp/erlang-cookie-secret/"},{"name":"rabbitmq-plugins","mountPath":"/operator"},{"name":"persistence","mountPath":"/var/lib/rabbitmq/mnesia/"},{"name":"rabbitmq-confd","mountPath":"/tmp/default_user.conf","subPath":"default_user.conf"}],"terminationMessagePath":"/dev/termination-log","terminationMessagePolicy":"File","imagePullPolicy":"IfNotPresent","securityContext":{"capabilities":{"drop":["FSETID","KILL","SETGID","SETUID","SETPCAP","NET_BIND_SERVICE","NET_RAW","SYS_CHROOT","MKNOD","AUDIT_WRITE","SETFCAP"]},"runAsUser":0}}],"containers":[{"name":"rabbitmq","image":"rabbitmq:3.8.12-management","ports":[{"name":"epmd","containerPort":4369,"protocol":"TCP"},{"name":"amqp","containerPort":5672,"protocol":"TCP"},{"name":"management","containerPort":15672,"protocol":"TCP"},{"name":"prometheus","containerPort":15692,"protocol":"TCP"}],"env":[{"name":"MY_POD_NAME","valueFrom":{"fieldRef":{"apiVersion":"v1","fieldPath":"metadata.name"}}},{"name":"MY_POD_NAMESPACE","valueFrom":{"fieldRef":{"apiVersion":"v1","fieldPath":"metadata.namespace"}}},{"name":"RABBITMQ_ENABLED_PLUGINS_FILE","value":"/operator/enabled_plugins"},{"name":"K8S_SERVICE_NAME","value":"rabbitmq-cluster-nodes"},{"name":"RABBITMQ_USE_LONGNAME","value":"true"},{"name":"RABBITMQ_NODENAME","value":"rabbit@$(MY_POD_NAME).$(K8S_SERVICE_NAME).$(MY_POD_NAMESPACE)"},{"name":"K8S_HOSTNAME_SUFFIX","value":".$(K8S_SERVICE_NAME).$(MY_POD_NAMESPACE)"}],"resources":{"limits":{"cpu":"2","memory":"2Gi"},"requests":{"cpu":"1","memory":"2Gi"}},"volumeMounts":[{"name":"rabbitmq-erlang-cookie","mountPath":"/var/lib/rabbitmq/"},{"name":"persistence","mountPath":"/var/lib/rabbitmq/mnesia/"},{"name":"rabbitmq-plugins","mountPath":"/operator"},{"name":"rabbitmq-confd","mountPath":"/etc/rabbitmq/conf.d/10-operatorDefaults.conf","subPath":"operatorDefaults.conf"},{"name":"rabbitmq-confd","mountPath":"/etc/rabbitmq/conf.d/11-default_user.conf","subPath":"default_user.conf"},{"name":"rabbitmq-confd","mountPath":"/etc/rabbitmq/conf.d/90-userDefinedConfiguration.conf","subPath":"userDefinedConfiguration.conf"},{"name":"pod-info","mountPath":"/etc/pod-info/"}],"readinessProbe":{"tcpSocket":{"port":"amqp"},"initialDelaySeconds":10,"timeoutSeconds":5,"periodSeconds":10,"successThreshold":1,"failureThreshold":3},"lifecycle":{"preStop":{"exec":{"command":["/bin/bash","-c","if [ ! -z \"$(cat /etc/pod-info/skipPreStopChecks)\" ]; then exit 0; fi; rabbitmq-upgrade await_online_quorum_plus_one -t 604800; rabbitmq-upgrade await_online_synchronized_mirror -t 604800; rabbitmq-upgrade drain -t 604800"]}}},"terminationMessagePath":"/dev/termination-log","terminationMessagePolicy":"File","imagePullPolicy":"IfNotPresent"}],"restartPolicy":"Always","terminationGracePeriodSeconds":604800,"dnsPolicy":"ClusterFirst","serviceAccountName":"rabbitmq-cluster-server","serviceAccount":"rabbitmq-cluster-server","automountServiceAccountToken":true,"securityContext":{"runAsUser":999,"runAsGroup":999,"fsGroup":999},"schedulerName":"default-scheduler","topologySpreadConstraints":[{"maxSkew":1,"topologyKey":"topology.kubernetes.io/zone","whenUnsatisfiable":"ScheduleAnyway","labelSelector":{"matchLabels":{"app.kubernetes.io/name":"rabbitmq-cluster"}}}]}},"volumeClaimTemplates":[{"metadata":{"name":"persistence","namespace":"default","creationTimestamp":null,"labels":{"app.kubernetes.io/component":"rabbitmq","app.kubernetes.io/name":"rabbitmq-cluster","app.kubernetes.io/part-of":"rabbitmq"},"ownerReferences":[{"apiVersion":"rabbitmq.com/v1beta1","kind":"RabbitmqCluster","name":"rabbitmq-cluster","uid":"3ecefa8a-1bec-48a7-9af4-dd0df3339101","controller":true,"blockOwnerDeletion":false}]},"spec":{"accessModes":["ReadWriteOnce"],"resources":{"requests":{"storage":"15Gi"}},"volumeMode":"Filesystem"},"status":{"phase":"Pending"}}],"serviceName":"rabbitmq-cluster-nodes","podManagementPolicy":"Parallel","updateStrategy":{"type":"RollingUpdate","rollingUpdate":{"partition":0}},"revisionHistoryLimit":10},"status":{"observedGeneration":1,"replicas":1,"readyReplicas":1,"currentReplicas":1,"updatedReplicas":1,"currentRevision":"rabbitmq-cluster-server-5f8b8665fb","updateRevision":"rabbitmq-cluster-server-5f8b8665fb","collisionCount":0}}
2022/03/18 18:07:35 learn_server.go:291: [SIEVE-AFTER-READ]	Get	true	service	default	rabbitmq-cluster-nodes	github.com/rabbitmq/cluster-operator/controllers.(*RabbitmqClusterReconciler)	NoError	{"kind":"Service","apiVersion":"v1","metadata":{"name":"rabbitmq-cluster-nodes","namespace":"default","selfLink":"/api/v1/namespaces/default/services/rabbitmq-cluster-nodes","uid":"f843e1c2-ced0-463d-87c1-0e127aaa2006","resourceVersion":"1080","creationTimestamp":"2022-03-18T18:06:25Z","labels":{"app.kubernetes.io/component":"rabbitmq","app.kubernetes.io/name":"rabbitmq-cluster","app.kubernetes.io/part-of":"rabbitmq"},"ownerReferences":[{"apiVersion":"rabbitmq.com/v1beta1","kind":"RabbitmqCluster","name":"rabbitmq-cluster","uid":"3ecefa8a-1bec-48a7-9af4-dd0df3339101","controller":true,"blockOwnerDeletion":true}],"managedFields":[{"manager":"manager","operation":"Update","apiVersion":"v1","time":"2022-03-18T18:06:25Z","fieldsType":"FieldsV1","fieldsV1":{"f:metadata":{"f:labels":{".":{},"f:app.kubernetes.io/component":{},"f:app.kubernetes.io/name":{},"f:app.kubernetes.io/part-of":{}},"f:ownerReferences":{".":{},"k:{\"uid\":\"3ecefa8a-1bec-48a7-9af4-dd0df3339101\"}":{".":{},"f:apiVersion":{},"f:blockOwnerDeletion":{},"f:controller":{},"f:kind":{},"f:name":{},"f:uid":{}}}},"f:spec":{"f:clusterIP":{},"f:ports":{".":{},"k:{\"port\":4369,\"protocol\":\"TCP\"}":{".":{},"f:name":{},"f:port":{},"f:protocol":{},"f:targetPort":{}},"k:{\"port\":25672,\"protocol\":\"TCP\"}":{".":{},"f:name":{},"f:port":{},"f:protocol":{},"f:targetPort":{}}},"f:publishNotReadyAddresses":{},"f:selector":{".":{},"f:app.kubernetes.io/name":{}},"f:sessionAffinity":{},"f:type":{}}}}]},"spec":{"ports":[{"name":"epmd","protocol":"TCP","port":4369,"targetPort":4369},{"name":"cluster-rpc","protocol":"TCP","port":25672,"targetPort":25672}],"selector":{"app.kubernetes.io/name":"rabbitmq-cluster"},"clusterIP":"None","type":"ClusterIP","sessionAffinity":"None","publishNotReadyAddresses":true},"status":{"loadBalancer":{}}}
2022/03/18 18:07:35 learn_server.go:291: [SIEVE-AFTER-READ]	Get	true	service	default	rabbitmq-cluster	github.com/rabbitmq/cluster-operator/controllers.(*RabbitmqClusterReconciler)	NoError	{"kind":"Service","apiVersion":"v1","metadata":{"name":"rabbitmq-cluster","namespace":"default","selfLink":"/api/v1/namespaces/default/services/rabbitmq-cluster","uid":"ae846a70-784e-49ca-99a0-2b0cefb93b46","resourceVersion":"1085","creationTimestamp":"2022-03-18T18:06:25Z","labels":{"app.kubernetes.io/component":"rabbitmq","app.kubernetes.io/name":"rabbitmq-cluster","app.kubernetes.io/part-of":"rabbitmq"},"ownerReferences":[{"apiVersion":"rabbitmq.com/v1beta1","kind":"RabbitmqCluster","name":"rabbitmq-cluster","uid":"3ecefa8a-1bec-48a7-9af4-dd0df3339101","controller":true,"blockOwnerDeletion":true}],"managedFields":[{"manager":"manager","operation":"Update","apiVersion":"v1","time":"2022-03-18T18:06:25Z","fieldsType":"FieldsV1","fieldsV1":{"f:metadata":{"f:labels":{".":{},"f:app.kubernetes.io/component":{},"f:app.kubernetes.io/name":{},"f:app.kubernetes.io/part-of":{}},"f:ownerReferences":{".":{},"k:{\"uid\":\"3ecefa8a-1bec-48a7-9af4-dd0df3339101\"}":{".":{},"f:apiVersion":{},"f:blockOwnerDeletion":{},"f:controller":{},"f:kind":{},"f:name":{},"f:uid":{}}}},"f:spec":{"f:ports":{".":{},"k:{\"port\":5672,\"protocol\":\"TCP\"}":{".":{},"f:name":{},"f:port":{},"f:protocol":{},"f:targetPort":{}},"k:{\"port\":15672,\"protocol\":\"TCP\"}":{".":{},"f:name":{},"f:port":{},"f:protocol":{},"f:targetPort":{}}},"f:selector":{".":{},"f:app.kubernetes.io/name":{}},"f:sessionAffinity":{},"f:type":{}}}}]},"spec":{"ports":[{"name":"amqp","protocol":"TCP","port":5672,"targetPort":5672},{"name":"management","protocol":"TCP","port":15672,"targetPort":15672}],"selector":{"app.kubernetes.io/name":"rabbitmq-cluster"},"clusterIP":"10.96.47.189","type":"ClusterIP","sessionAffinity":"None"},"status":{"loadBalancer":{}}}
2022/03/18 18:07:35 learn_server.go:291: [SIEVE-AFTER-READ]	Get	true	secret	default	rabbitmq-cluster-erlang-cookie	github.com/rabbitmq/cluster-operator/controllers.(*RabbitmqClusterReconciler)	NoError	{"kind":"Secret","apiVersion":"v1","metadata":{"name":"rabbitmq-cluster-erlang-cookie","namespace":"default","selfLink":"/api/v1/namespaces/default/secrets/rabbitmq-cluster-erlang-cookie","uid":"01d8d8ad-080a-4c3f-9d27-56616c53dd26","resourceVersion":"1088","creationTimestamp":"2022-03-18T18:06:25Z","labels":{"app.kubernetes.io/component":"rabbitmq","app.kubernetes.io/name":"rabbitmq-cluster","app.kubernetes.io/part-of":"rabbitmq"},"ownerReferences":[{"apiVersion":"rabbitmq.com/v1beta1","kind":"RabbitmqCluster","name":"rabbitmq-cluster","uid":"3ecefa8a-1bec-48a7-9af4-dd0df3339101","controller":true,"blockOwnerDeletion":true}],"managedFields":[{"manager":"manager","operation":"Update","apiVersion":"v1","time":"2022-03-18T18:06:25Z","fieldsType":"FieldsV1","fieldsV1":{"f:data":{".":{},"f:.erlang.cookie":{}},"f:metadata":{"f:labels":{".":{},"f:app.kubernetes.io/component":{},"f:app.kubernetes.io/name":{},"f:app.kubernetes.io/part-of":{}},"f:ownerReferences":{".":{},"k:{\"uid\":\"3ecefa8a-1bec-48a7-9af4-dd0df3339101\"}":{".":{},"f:apiVersion":{},"f:blockOwnerDeletion":{},"f:controller":{},"f:kind":{},"f:name":{},"f:uid":{}}}},"f:type":{}}}]},"data":{".erlang.cookie":"ajdscUtLdnBpR1NwUUMwc1V3a2VyTlJxU2tVUTdBeEw="},"type":"Opaque"}
2022/03/18 18:07:35 learn_server.go:291: [SIEVE-AFTER-READ]	Get	true	secret	default	rabbitmq-cluster-default-user	github.com/rabbitmq/cluster-operator/controllers.(*RabbitmqClusterReconciler)	NoError	{"kind":"Secret","apiVersion":"v1","metadata":{"name":"rabbitmq-cluster-default-user","namespace":"default","selfLink":"/api/v1/namespaces/default/secrets/rabbitmq-cluster-default-user","uid":"b2f5a936-e51f-4488-b6e9-ca23e4d95ac2","resourceVersion":"1091","creationTimestamp":"2022-03-18T18:06:25Z","labels":{"app.kubernetes.io/component":"rabbitmq","app.kubernetes.io/name":"rabbitmq-cluster","app.kubernetes.io/part-of":"rabbitmq"},"ownerReferences":[{"apiVersion":"rabbitmq.com/v1beta1","kind":"RabbitmqCluster","name":"rabbitmq-cluster","uid":"3ecefa8a-1bec-48a7-9af4-dd0df3339101","controller":true,"blockOwnerDeletion":true}],"managedFields":[{"manager":"manager","operation":"Update","apiVersion":"v1","time":"2022-03-18T18:06:25Z","fieldsType":"FieldsV1","fieldsV1":{"f:data":{".":{},"f:default_user.conf":{},"f:password":{},"f:provider":{},"f:type":{},"f:username":{}},"f:metadata":{"f:labels":{".":{},"f:app.kubernetes.io/component":{},"f:app.kubernetes.io/name":{},"f:app.kubernetes.io/part-of":{}},"f:ownerReferences":{".":{},"k:{\"uid\":\"3ecefa8a-1bec-48a7-9af4-dd0df3339101\"}":{".":{},"f:apiVersion":{},"f:blockOwnerDeletion":{},"f:controller":{},"f:kind":{},"f:name":{},"f:uid":{}}}},"f:type":{}}}]},"data":{"default_user.conf":"ZGVmYXVsdF91c2VyID0gdEFMN1otZTgzR29ocEtsZ0Z4cUFFV3ZXemEtcjdJQW8KZGVmYXVsdF9wYXNzID0gdXVocndkTkdOcmJXQ2p6NFZPX0NUZE9OYURkSUpoRkoK","password":"dXVocndkTkdOcmJXQ2p6NFZPX0NUZE9OYURkSUpoRko=","provider":"cmFiYml0bXE=","type":"cmFiYml0bXE=","username":"dEFMN1otZTgzR29ocEtsZ0Z4cUFFV3ZXemEtcjdJQW8="},"type":"Opaque"}
2022/03/18 18:07:35 learn_server.go:291: [SIEVE-AFTER-READ]	Get	true	configmap	default	rabbitmq-cluster-plugins-conf	github.com/rabbitmq/cluster-operator/controllers.(*RabbitmqClusterReconciler)	NoError	{"kind":"ConfigMap","apiVersion":"v1","metadata":{"name":"rabbitmq-cluster-plugins-conf","namespace":"default","selfLink":"/api/v1/namespaces/default/configmaps/rabbitmq-cluster-plugins-conf","uid":"0aa26eb6-ff3a-4457-a223-284c897db7fe","resourceVersion":"1092","creationTimestamp":"2022-03-18T18:06:25Z","labels":{"app.kubernetes.io/component":"rabbitmq","app.kubernetes.io/name":"rabbitmq-cluster","app.kubernetes.io/part-of":"rabbitmq"},"ownerReferences":[{"apiVersion":"rabbitmq.com/v1beta1","kind":"RabbitmqCluster","name":"rabbitmq-cluster","uid":"3ecefa8a-1bec-48a7-9af4-dd0df3339101","controller":true,"blockOwnerDeletion":true}],"managedFields":[{"manager":"manager","operation":"Update","apiVersion":"v1","time":"2022-03-18T18:06:25Z","fieldsType":"FieldsV1","fieldsV1":{"f:data":{".":{},"f:enabled_plugins":{}},"f:metadata":{"f:labels":{".":{},"f:app.kubernetes.io/component":{},"f:app.kubernetes.io/name":{},"f:app.kubernetes.io/part-of":{}},"f:ownerReferences":{".":{},"k:{\"uid\":\"3ecefa8a-1bec-48a7-9af4-dd0df3339101\"}":{".":{},"f:apiVersion":{},"f:blockOwnerDeletion":{},"f:controller":{},"f:kind":{},"f:name":{},"f:uid":{}}}}}}]},"data":{"enabled_plugins":"[rabbitmq_peer_discovery_k8s,rabbitmq_prometheus,rabbitmq_management]."}}
2022/03/18 18:07:35 learn_server.go:291: [SIEVE-AFTER-READ]	Get	true	configmap	default	rabbitmq-cluster-server-conf	github.com/rabbitmq/cluster-operator/controllers.(*RabbitmqClusterReconciler)	NoError	{"kind":"ConfigMap","apiVersion":"v1","metadata":{"name":"rabbitmq-cluster-server-conf","namespace":"default","selfLink":"/api/v1/namespaces/default/configmaps/rabbitmq-cluster-server-conf","uid":"e4182078-d429-4baf-9021-72618c509ac5","resourceVersion":"1095","creationTimestamp":"2022-03-18T18:06:25Z","labels":{"app.kubernetes.io/component":"rabbitmq","app.kubernetes.io/name":"rabbitmq-cluster","app.kubernetes.io/part-of":"rabbitmq"},"ownerReferences":[{"apiVersion":"rabbitmq.com/v1beta1","kind":"RabbitmqCluster","name":"rabbitmq-cluster","uid":"3ecefa8a-1bec-48a7-9af4-dd0df3339101","controller":true,"blockOwnerDeletion":true}],"managedFields":[{"manager":"manager","operation":"Update","apiVersion":"v1","time":"2022-03-18T18:06:25Z","fieldsType":"FieldsV1","fieldsV1":{"f:data":{".":{},"f:operatorDefaults.conf":{},"f:userDefinedConfiguration.conf":{}},"f:metadata":{"f:labels":{".":{},"f:app.kubernetes.io/component":{},"f:app.kubernetes.io/name":{},"f:app.kubernetes.io/part-of":{}},"f:ownerReferences":{".":{},"k:{\"uid\":\"3ecefa8a-1bec-48a7-9af4-dd0df3339101\"}":{".":{},"f:apiVersion":{},"f:blockOwnerDeletion":{},"f:controller":{},"f:kind":{},"f:name":{},"f:uid":{}}}}}}]},"data":{"operatorDefaults.conf":"cluster_formation.peer_discovery_backend             = rabbit_peer_discovery_k8s\ncluster_formation.k8s.host                           = kubernetes.default\ncluster_formation.k8s.address_type                   = hostname\ncluster_partition_handling                           = pause_minority\nqueue_master_locator                                 = min-masters\ndisk_free_limit.absolute                             = 2GB\ncluster_formation.randomized_startup_delay_range.min = 5\ncluster_formation.randomized_startup_delay_range.max = 30\ncluster_name                                         = rabbitmq-cluster\n","userDefinedConfiguration.conf":"total_memory_available_override_value = 1717986919\n"}}
2022/03/18 18:07:35 learn_server.go:291: [SIEVE-AFTER-READ]	Get	true	serviceaccount	default	rabbitmq-cluster-server	github.com/rabbitmq/cluster-operator/controllers.(*RabbitmqClusterReconciler)	NoError	{"kind":"ServiceAccount","apiVersion":"v1","metadata":{"name":"rabbitmq-cluster-server","namespace":"default","selfLink":"/api/v1/namespaces/default/serviceaccounts/rabbitmq-cluster-server","uid":"0c3cead0-37dd-452b-b939-fe346a5dfdea","resourceVersion":"1102","creationTimestamp":"2022-03-18T18:06:25Z","labels":{"app.kubernetes.io/component":"rabbitmq","app.kubernetes.io/name":"rabbitmq-cluster","app.kubernetes.io/part-of":"rabbitmq"},"ownerReferences":[{"apiVersion":"rabbitmq.com/v1beta1","kind":"RabbitmqCluster","name":"rabbitmq-cluster","uid":"3ecefa8a-1bec-48a7-9af4-dd0df3339101","controller":true,"blockOwnerDeletion":true}],"managedFields":[{"manager":"kube-controller-manager","operation":"Update","apiVersion":"v1","time":"2022-03-18T18:06:25Z","fieldsType":"FieldsV1","fieldsV1":{"f:secrets":{".":{},"k:{\"name\":\"rabbitmq-cluster-server-token-v4wpv\"}":{".":{},"f:name":{}}}}},{"manager":"manager","operation":"Update","apiVersion":"v1","time":"2022-03-18T18:06:25Z","fieldsType":"FieldsV1","fieldsV1":{"f:metadata":{"f:labels":{".":{},"f:app.kubernetes.io/component":{},"f:app.kubernetes.io/name":{},"f:app.kubernetes.io/part-of":{}},"f:ownerReferences":{".":{},"k:{\"uid\":\"3ecefa8a-1bec-48a7-9af4-dd0df3339101\"}":{".":{},"f:apiVersion":{},"f:blockOwnerDeletion":{},"f:controller":{},"f:kind":{},"f:name":{},"f:uid":{}}}}}}]},"secrets":[{"name":"rabbitmq-cluster-server-token-v4wpv"}]}
2022/03/18 18:07:35 learn_server.go:291: [SIEVE-AFTER-READ]	Get	true	role	default	rabbitmq-cluster-peer-discovery	github.com/rabbitmq/cluster-operator/controllers.(*RabbitmqClusterReconciler)	NoError	{"kind":"Role","apiVersion":"rbac.authorization.k8s.io/v1","metadata":{"name":"rabbitmq-cluster-peer-discovery","namespace":"default","selfLink":"/apis/rbac.authorization.k8s.io/v1/namespaces/default/roles/rabbitmq-cluster-peer-discovery","uid":"ec9ac474-1880-43ed-af46-9ea5f46d6db4","resourceVersion":"1103","creationTimestamp":"2022-03-18T18:06:25Z","labels":{"app.kubernetes.io/component":"rabbitmq","app.kubernetes.io/name":"rabbitmq-cluster","app.kubernetes.io/part-of":"rabbitmq"},"ownerReferences":[{"apiVersion":"rabbitmq.com/v1beta1","kind":"RabbitmqCluster","name":"rabbitmq-cluster","uid":"3ecefa8a-1bec-48a7-9af4-dd0df3339101","controller":true,"blockOwnerDeletion":true}],"managedFields":[{"manager":"manager","operation":"Update","apiVersion":"rbac.authorization.k8s.io/v1","time":"2022-03-18T18:06:25Z","fieldsType":"FieldsV1","fieldsV1":{"f:metadata":{"f:labels":{".":{},"f:app.kubernetes.io/component":{},"f:app.kubernetes.io/name":{},"f:app.kubernetes.io/part-of":{}},"f:ownerReferences":{".":{},"k:{\"uid\":\"3ecefa8a-1bec-48a7-9af4-dd0df3339101\"}":{".":{},"f:apiVersion":{},"f:blockOwnerDeletion":{},"f:controller":{},"f:kind":{},"f:name":{},"f:uid":{}}}},"f:rules":{}}}]},"rules":[{"verbs":["get"],"apiGroups":[""],"resources":["endpoints"]},{"verbs":["create"],"apiGroups":[""],"resources":["events"]}]}
2022/03/18 18:07:35 learn_server.go:291: [SIEVE-AFTER-READ]	Get	true	rolebinding	default	rabbitmq-cluster-server	github.com/rabbitmq/cluster-operator/controllers.(*RabbitmqClusterReconciler)	NoError	{"kind":"RoleBinding","apiVersion":"rbac.authorization.k8s.io/v1","metadata":{"name":"rabbitmq-cluster-server","namespace":"default","selfLink":"/apis/rbac.authorization.k8s.io/v1/namespaces/default/rolebindings/rabbitmq-cluster-server","uid":"fe69a41c-8d28-4b84-a9f6-a9e6044d75ba","resourceVersion":"1105","creationTimestamp":"2022-03-18T18:06:25Z","labels":{"app.kubernetes.io/component":"rabbitmq","app.kubernetes.io/name":"rabbitmq-cluster","app.kubernetes.io/part-of":"rabbitmq"},"ownerReferences":[{"apiVersion":"rabbitmq.com/v1beta1","kind":"RabbitmqCluster","name":"rabbitmq-cluster","uid":"3ecefa8a-1bec-48a7-9af4-dd0df3339101","controller":true,"blockOwnerDeletion":true}],"managedFields":[{"manager":"manager","operation":"Update","apiVersion":"rbac.authorization.k8s.io/v1","time":"2022-03-18T18:06:25Z","fieldsType":"FieldsV1","fieldsV1":{"f:metadata":{"f:labels":{".":{},"f:app.kubernetes.io/component":{},"f:app.kubernetes.io/name":{},"f:app.kubernetes.io/part-of":{}},"f:ownerReferences":{".":{},"k:{\"uid\":\"3ecefa8a-1bec-48a7-9af4-dd0df3339101\"}":{".":{},"f:apiVersion":{},"f:blockOwnerDeletion":{},"f:controller":{},"f:kind":{},"f:name":{},"f:uid":{}}}},"f:roleRef":{"f:apiGroup":{},"f:kind":{},"f:name":{}},"f:subjects":{}}}]},"subjects":[{"kind":"ServiceAccount","name":"rabbitmq-cluster-server"}],"roleRef":{"apiGroup":"rbac.authorization.k8s.io","kind":"Role","name":"rabbitmq-cluster-peer-discovery"}}
2022/03/18 18:07:35 learn_server.go:291: [SIEVE-AFTER-READ]	Get	true	statefulset	default	rabbitmq-cluster-server	github.com/rabbitmq/cluster-operator/controllers.(*RabbitmqClusterReconciler)	NoError	{"kind":"StatefulSet","apiVersion":"apps/v1","metadata":{"name":"rabbitmq-cluster-server","namespace":"default","selfLink":"/apis/apps/v1/namespaces/default/statefulsets/rabbitmq-cluster-server","uid":"1d62d993-2c32-4da7-8884-e4cfad9e587d","resourceVersion":"1481","generation":1,"creationTimestamp":"2022-03-18T18:07:34Z","labels":{"app.kubernetes.io/component":"rabbitmq","app.kubernetes.io/name":"rabbitmq-cluster","app.kubernetes.io/part-of":"rabbitmq"},"ownerReferences":[{"apiVersion":"rabbitmq.com/v1beta1","kind":"RabbitmqCluster","name":"rabbitmq-cluster","uid":"3ecefa8a-1bec-48a7-9af4-dd0df3339101","controller":true,"blockOwnerDeletion":true}],"managedFields":[{"manager":"kube-controller-manager","operation":"Update","apiVersion":"apps/v1","time":"2022-03-18T18:07:34Z","fieldsType":"FieldsV1","fieldsV1":{"f:status":{"f:collisionCount":{},"f:currentReplicas":{},"f:currentRevision":{},"f:observedGeneration":{},"f:readyReplicas":{},"f:replicas":{},"f:updateRevision":{},"f:updatedReplicas":{}}}},{"manager":"manager","operation":"Update","apiVersion":"apps/v1","time":"2022-03-18T18:07:34Z","fieldsType":"FieldsV1","fieldsV1":{"f:metadata":{"f:labels":{".":{},"f:app.kubernetes.io/component":{},"f:app.kubernetes.io/name":{},"f:app.kubernetes.io/part-of":{}},"f:ownerReferences":{".":{},"k:{\"uid\":\"3ecefa8a-1bec-48a7-9af4-dd0df3339101\"}":{".":{},"f:apiVersion":{},"f:blockOwnerDeletion":{},"f:controller":{},"f:kind":{},"f:name":{},"f:uid":{}}}},"f:spec":{"f:podManagementPolicy":{},"f:replicas":{},"f:revisionHistoryLimit":{},"f:selector":{"f:matchLabels":{".":{},"f:app.kubernetes.io/name":{}}},"f:serviceName":{},"f:template":{"f:metadata":{"f:annotations":{".":{},"f:prometheus.io/port":{},"f:prometheus.io/scrape":{}},"f:labels":{".":{},"f:app.kubernetes.io/component":{},"f:app.kubernetes.io/name":{},"f:app.kubernetes.io/part-of":{}}},"f:spec":{"f:automountServiceAccountToken":{},"f:containers":{"k:{\"name\":\"rabbitmq\"}":{".":{},"f:env":{".":{},"k:{\"name\":\"K8S_HOSTNAME_SUFFIX\"}":{".":{},"f:name":{},"f:value":{}},"k:{\"name\":\"K8S_SERVICE_NAME\"}":{".":{},"f:name":{},"f:value":{}},"k:{\"name\":\"MY_POD_NAME\"}":{".":{},"f:name":{},"f:valueFrom":{".":{},"f:fieldRef":{".":{},"f:apiVersion":{},"f:fieldPath":{}}}},"k:{\"name\":\"MY_POD_NAMESPACE\"}":{".":{},"f:name":{},"f:valueFrom":{".":{},"f:fieldRef":{".":{},"f:apiVersion":{},"f:fieldPath":{}}}},"k:{\"name\":\"RABBITMQ_ENABLED_PLUGINS_FILE\"}":{".":{},"f:name":{},"f:value":{}},"k:{\"name\":\"RABBITMQ_NODENAME\"}":{".":{},"f:name":{},"f:value":{}},"k:{\"name\":\"RABBITMQ_USE_LONGNAME\"}":{".":{},"f:name":{},"f:value":{}}},"f:image":{},"f:imagePullPolicy":{},"f:lifecycle":{".":{},"f:preStop":{".":{},"f:exec":{".":{},"f:command":{}}}},"f:name":{},"f:ports":{".":{},"k:{\"containerPort\":4369,\"protocol\":\"TCP\"}":{".":{},"f:containerPort":{},"f:name":{},"f:protocol":{}},"k:{\"containerPort\":5672,\"protocol\":\"TCP\"}":{".":{},"f:containerPort":{},"f:name":{},"f:protocol":{}},"k:{\"containerPort\":15672,\"protocol\":\"TCP\"}":{".":{},"f:containerPort":{},"f:name":{},"f:protocol":{}},"k:{\"containerPort\":15692,\"protocol\":\"TCP\"}":{".":{},"f:containerPort":{},"f:name":{},"f:protocol":{}}},"f:readinessProbe":{".":{},"f:failureThreshold":{},"f:initialDelaySeconds":{},"f:periodSeconds":{},"f:successThreshold":{},"f:tcpSocket":{".":{},"f:port":{}},"f:timeoutSeconds":{}},"f:resources":{".":{},"f:limits":{".":{},"f:cpu":{},"f:memory":{}},"f:requests":{".":{},"f:cpu":{},"f:memory":{}}},"f:terminationMessagePath":{},"f:terminationMessagePolicy":{},"f:volumeMounts":{".":{},"k:{\"mountPath\":\"/etc/pod-info/\"}":{".":{},"f:mountPath":{},"f:name":{}},"k:{\"mountPath\":\"/etc/rabbitmq/conf.d/10-operatorDefaults.conf\"}":{".":{},"f:mountPath":{},"f:name":{},"f:subPath":{}},"k:{\"mountPath\":\"/etc/rabbitmq/conf.d/11-default_user.conf\"}":{".":{},"f:mountPath":{},"f:name":{},"f:subPath":{}},"k:{\"mountPath\":\"/etc/rabbitmq/conf.d/90-userDefinedConfiguration.conf\"}":{".":{},"f:mountPath":{},"f:name":{},"f:subPath":{}},"k:{\"mountPath\":\"/operator\"}":{".":{},"f:mountPath":{},"f:name":{}},"k:{\"mountPath\":\"/var/lib/rabbitmq/\"}":{".":{},"f:mountPath":{},"f:name":{}},"k:{\"mountPath\":\"/var/lib/rabbitmq/mnesia/\"}":{".":{},"f:mountPath":{},"f:name":{}}}}},"f:dnsPolicy":{},"f:initContainers":{".":{},"k:{\"name\":\"setup-container\"}":{".":{},"f:command":{},"f:image":{},"f:imagePullPolicy":{},"f:name":{},"f:resources":{".":{},"f:limits":{".":{},"f:cpu":{},"f:memory":{}},"f:requests":{".":{},"f:cpu":{},"f:memory":{}}},"f:securityContext":{".":{},"f:capabilities":{".":{},"f:drop":{}},"f:runAsUser":{}},"f:terminationMessagePath":{},"f:terminationMessagePolicy":{},"f:volumeMounts":{".":{},"k:{\"mountPath\":\"/operator\"}":{".":{},"f:mountPath":{},"f:name":{}},"k:{\"mountPath\":\"/tmp/default_user.conf\"}":{".":{},"f:mountPath":{},"f:name":{},"f:subPath":{}},"k:{\"mountPath\":\"/tmp/erlang-cookie-secret/\"}":{".":{},"f:mountPath":{},"f:name":{}},"k:{\"mountPath\":\"/tmp/rabbitmq-plugins/\"}":{".":{},"f:mountPath":{},"f:name":{}},"k:{\"mountPath\":\"/var/lib/rabbitmq/\"}":{".":{},"f:mountPath":{},"f:name":{}},"k:{\"mountPath\":\"/var/lib/rabbitmq/mnesia/\"}":{".":{},"f:mountPath":{},"f:name":{}}}}},"f:restartPolicy":{},"f:schedulerName":{},"f:securityContext":{".":{},"f:fsGroup":{},"f:runAsGroup":{},"f:runAsUser":{}},"f:serviceAccount":{},"f:serviceAccountName":{},"f:terminationGracePeriodSeconds":{},"f:topologySpreadConstraints":{".":{},"k:{\"topologyKey\":\"topology.kubernetes.io/zone\",\"whenUnsatisfiable\":\"ScheduleAnyway\"}":{".":{},"f:labelSelector":{".":{},"f:matchLabels":{".":{},"f:app.kubernetes.io/name":{}}},"f:maxSkew":{},"f:topologyKey":{},"f:whenUnsatisfiable":{}}},"f:volumes":{".":{},"k:{\"name\":\"erlang-cookie-secret\"}":{".":{},"f:name":{},"f:secret":{".":{},"f:defaultMode":{},"f:secretName":{}}},"k:{\"name\":\"plugins-conf\"}":{".":{},"f:configMap":{".":{},"f:defaultMode":{},"f:name":{}},"f:name":{}},"k:{\"name\":\"pod-info\"}":{".":{},"f:downwardAPI":{".":{},"f:defaultMode":{},"f:items":{}},"f:name":{}},"k:{\"name\":\"rabbitmq-confd\"}":{".":{},"f:name":{},"f:projected":{".":{},"f:defaultMode":{},"f:sources":{}}},"k:{\"name\":\"rabbitmq-erlang-cookie\"}":{".":{},"f:emptyDir":{},"f:name":{}},"k:{\"name\":\"rabbitmq-plugins\"}":{".":{},"f:emptyDir":{},"f:name":{}}}}},"f:updateStrategy":{"f:rollingUpdate":{".":{},"f:partition":{}},"f:type":{}},"f:volumeClaimTemplates":{}}}}]},"spec":{"replicas":1,"selector":{"matchLabels":{"app.kubernetes.io/name":"rabbitmq-cluster"}},"template":{"metadata":{"creationTimestamp":null,"labels":{"app.kubernetes.io/component":"rabbitmq","app.kubernetes.io/name":"rabbitmq-cluster","app.kubernetes.io/part-of":"rabbitmq"},"annotations":{"prometheus.io/port":"15692","prometheus.io/scrape":"true"}},"spec":{"volumes":[{"name":"plugins-conf","configMap":{"name":"rabbitmq-cluster-plugins-conf","defaultMode":420}},{"name":"rabbitmq-confd","projected":{"sources":[{"secret":{"name":"rabbitmq-cluster-default-user","items":[{"key":"default_user.conf","path":"default_user.conf"}]}},{"configMap":{"name":"rabbitmq-cluster-server-conf","items":[{"key":"operatorDefaults.conf","path":"operatorDefaults.conf"},{"key":"userDefinedConfiguration.conf","path":"userDefinedConfiguration.conf"}]}}],"defaultMode":420}},{"name":"rabbitmq-erlang-cookie","emptyDir":{}},{"name":"erlang-cookie-secret","secret":{"secretName":"rabbitmq-cluster-erlang-cookie","defaultMode":420}},{"name":"rabbitmq-plugins","emptyDir":{}},{"name":"pod-info","downwardAPI":{"items":[{"path":"skipPreStopChecks","fieldRef":{"apiVersion":"v1","fieldPath":"metadata.labels['skipPreStopChecks']"}}],"defaultMode":420}}],"initContainers":[{"name":"setup-container","image":"rabbitmq:3.8.12-management","command":["sh","-c","cp /tmp/erlang-cookie-secret/.erlang.cookie /var/lib/rabbitmq/.erlang.cookie \u0026\u0026 chown 999:999 /var/lib/rabbitmq/.erlang.cookie \u0026\u0026 chmod 600 /var/lib/rabbitmq/.erlang.cookie ; cp /tmp/rabbitmq-plugins/enabled_plugins /operator/enabled_plugins \u0026\u0026 chown 999:999 /operator/enabled_plugins ; chown 999:999 /var/lib/rabbitmq/mnesia/ ; echo '[default]' \u003e /var/lib/rabbitmq/.rabbitmqadmin.conf \u0026\u0026 sed -e 's/default_user/username/' -e 's/default_pass/password/' /tmp/default_user.conf \u003e\u003e /var/lib/rabbitmq/.rabbitmqadmin.conf \u0026\u0026 chown 999:999 /var/lib/rabbitmq/.rabbitmqadmin.conf \u0026\u0026 chmod 600 /var/lib/rabbitmq/.rabbitmqadmin.conf"],"resources":{"limits":{"cpu":"100m","memory":"500Mi"},"requests":{"cpu":"100m","memory":"500Mi"}},"volumeMounts":[{"name":"plugins-conf","mountPath":"/tmp/rabbitmq-plugins/"},{"name":"rabbitmq-erlang-cookie","mountPath":"/var/lib/rabbitmq/"},{"name":"erlang-cookie-secret","mountPath":"/tmp/erlang-cookie-secret/"},{"name":"rabbitmq-plugins","mountPath":"/operator"},{"name":"persistence","mountPath":"/var/lib/rabbitmq/mnesia/"},{"name":"rabbitmq-confd","mountPath":"/tmp/default_user.conf","subPath":"default_user.conf"}],"terminationMessagePath":"/dev/termination-log","terminationMessagePolicy":"File","imagePullPolicy":"IfNotPresent","securityContext":{"capabilities":{"drop":["FSETID","KILL","SETGID","SETUID","SETPCAP","NET_BIND_SERVICE","NET_RAW","SYS_CHROOT","MKNOD","AUDIT_WRITE","SETFCAP"]},"runAsUser":0}}],"containers":[{"name":"rabbitmq","image":"rabbitmq:3.8.12-management","ports":[{"name":"epmd","containerPort":4369,"protocol":"TCP"},{"name":"amqp","containerPort":5672,"protocol":"TCP"},{"name":"management","containerPort":15672,"protocol":"TCP"},{"name":"prometheus","containerPort":15692,"protocol":"TCP"}],"env":[{"name":"MY_POD_NAME","valueFrom":{"fieldRef":{"apiVersion":"v1","fieldPath":"metadata.name"}}},{"name":"MY_POD_NAMESPACE","valueFrom":{"fieldRef":{"apiVersion":"v1","fieldPath":"metadata.namespace"}}},{"name":"RABBITMQ_ENABLED_PLUGINS_FILE","value":"/operator/enabled_plugins"},{"name":"K8S_SERVICE_NAME","value":"rabbitmq-cluster-nodes"},{"name":"RABBITMQ_USE_LONGNAME","value":"true"},{"name":"RABBITMQ_NODENAME","value":"rabbit@$(MY_POD_NAME).$(K8S_SERVICE_NAME).$(MY_POD_NAMESPACE)"},{"name":"K8S_HOSTNAME_SUFFIX","value":".$(K8S_SERVICE_NAME).$(MY_POD_NAMESPACE)"}],"resources":{"limits":{"cpu":"2","memory":"2Gi"},"requests":{"cpu":"1","memory":"2Gi"}},"volumeMounts":[{"name":"rabbitmq-erlang-cookie","mountPath":"/var/lib/rabbitmq/"},{"name":"persistence","mountPath":"/var/lib/rabbitmq/mnesia/"},{"name":"rabbitmq-plugins","mountPath":"/operator"},{"name":"rabbitmq-confd","mountPath":"/etc/rabbitmq/conf.d/10-operatorDefaults.conf","subPath":"operatorDefaults.conf"},{"name":"rabbitmq-confd","mountPath":"/etc/rabbitmq/conf.d/11-default_user.conf","subPath":"default_user.conf"},{"name":"rabbitmq-confd","mountPath":"/etc/rabbitmq/conf.d/90-userDefinedConfiguration.conf","subPath":"userDefinedConfiguration.conf"},{"name":"pod-info","mountPath":"/etc/pod-info/"}],"readinessProbe":{"tcpSocket":{"port":"amqp"},"initialDelaySeconds":10,"timeoutSeconds":5,"periodSeconds":10,"successThreshold":1,"failureThreshold":3},"lifecycle":{"preStop":{"exec":{"command":["/bin/bash","-c","if [ ! -z \"$(cat /etc/pod-info/skipPreStopChecks)\" ]; then exit 0; fi; rabbitmq-upgrade await_online_quorum_plus_one -t 604800; rabbitmq-upgrade await_online_synchronized_mirror -t 604800; rabbitmq-upgrade drain -t 604800"]}}},"terminationMessagePath":"/dev/termination-log","terminationMessagePolicy":"File","imagePullPolicy":"IfNotPresent"}],"restartPolicy":"Always","terminationGracePeriodSeconds":604800,"dnsPolicy":"ClusterFirst","serviceAccountName":"rabbitmq-cluster-server","serviceAccount":"rabbitmq-cluster-server","automountServiceAccountToken":true,"securityContext":{"runAsUser":999,"runAsGroup":999,"fsGroup":999},"schedulerName":"default-scheduler","topologySpreadConstraints":[{"maxSkew":1,"topologyKey":"topology.kubernetes.io/zone","whenUnsatisfiable":"ScheduleAnyway","labelSelector":{"matchLabels":{"app.kubernetes.io/name":"rabbitmq-cluster"}}}]}},"volumeClaimTemplates":[{"metadata":{"name":"persistence","namespace":"default","creationTimestamp":null,"labels":{"app.kubernetes.io/component":"rabbitmq","app.kubernetes.io/name":"rabbitmq-cluster","app.kubernetes.io/part-of":"rabbitmq"},"ownerReferences":[{"apiVersion":"rabbitmq.com/v1beta1","kind":"RabbitmqCluster","name":"rabbitmq-cluster","uid":"3ecefa8a-1bec-48a7-9af4-dd0df3339101","controller":true,"blockOwnerDeletion":false}]},"spec":{"accessModes":["ReadWriteOnce"],"resources":{"requests":{"storage":"15Gi"}},"volumeMode":"Filesystem"},"status":{"phase":"Pending"}}],"serviceName":"rabbitmq-cluster-nodes","podManagementPolicy":"Parallel","updateStrategy":{"type":"RollingUpdate","rollingUpdate":{"partition":0}},"revisionHistoryLimit":10},"status":{"observedGeneration":1,"replicas":1,"readyReplicas":1,"currentReplicas":1,"updatedReplicas":1,"currentRevision":"rabbitmq-cluster-server-5f8b8665fb","updateRevision":"rabbitmq-cluster-server-5f8b8665fb","collisionCount":0}}
2022/03/18 18:07:35 learn_server.go:291: [SIEVE-AFTER-READ]	Get	true	statefulset	default	rabbitmq-cluster-server	github.com/rabbitmq/cluster-operator/controllers.(*RabbitmqClusterReconciler)	NoError	{"kind":"StatefulSet","apiVersion":"apps/v1","metadata":{"name":"rabbitmq-cluster-server","namespace":"default","selfLink":"/apis/apps/v1/namespaces/default/statefulsets/rabbitmq-cluster-server","uid":"1d62d993-2c32-4da7-8884-e4cfad9e587d","resourceVersion":"1481","generation":1,"creationTimestamp":"2022-03-18T18:07:34Z","labels":{"app.kubernetes.io/component":"rabbitmq","app.kubernetes.io/name":"rabbitmq-cluster","app.kubernetes.io/part-of":"rabbitmq"},"ownerReferences":[{"apiVersion":"rabbitmq.com/v1beta1","kind":"RabbitmqCluster","name":"rabbitmq-cluster","uid":"3ecefa8a-1bec-48a7-9af4-dd0df3339101","controller":true,"blockOwnerDeletion":true}],"managedFields":[{"manager":"kube-controller-manager","operation":"Update","apiVersion":"apps/v1","time":"2022-03-18T18:07:34Z","fieldsType":"FieldsV1","fieldsV1":{"f:status":{"f:collisionCount":{},"f:currentReplicas":{},"f:currentRevision":{},"f:observedGeneration":{},"f:readyReplicas":{},"f:replicas":{},"f:updateRevision":{},"f:updatedReplicas":{}}}},{"manager":"manager","operation":"Update","apiVersion":"apps/v1","time":"2022-03-18T18:07:34Z","fieldsType":"FieldsV1","fieldsV1":{"f:metadata":{"f:labels":{".":{},"f:app.kubernetes.io/component":{},"f:app.kubernetes.io/name":{},"f:app.kubernetes.io/part-of":{}},"f:ownerReferences":{".":{},"k:{\"uid\":\"3ecefa8a-1bec-48a7-9af4-dd0df3339101\"}":{".":{},"f:apiVersion":{},"f:blockOwnerDeletion":{},"f:controller":{},"f:kind":{},"f:name":{},"f:uid":{}}}},"f:spec":{"f:podManagementPolicy":{},"f:replicas":{},"f:revisionHistoryLimit":{},"f:selector":{"f:matchLabels":{".":{},"f:app.kubernetes.io/name":{}}},"f:serviceName":{},"f:template":{"f:metadata":{"f:annotations":{".":{},"f:prometheus.io/port":{},"f:prometheus.io/scrape":{}},"f:labels":{".":{},"f:app.kubernetes.io/component":{},"f:app.kubernetes.io/name":{},"f:app.kubernetes.io/part-of":{}}},"f:spec":{"f:automountServiceAccountToken":{},"f:containers":{"k:{\"name\":\"rabbitmq\"}":{".":{},"f:env":{".":{},"k:{\"name\":\"K8S_HOSTNAME_SUFFIX\"}":{".":{},"f:name":{},"f:value":{}},"k:{\"name\":\"K8S_SERVICE_NAME\"}":{".":{},"f:name":{},"f:value":{}},"k:{\"name\":\"MY_POD_NAME\"}":{".":{},"f:name":{},"f:valueFrom":{".":{},"f:fieldRef":{".":{},"f:apiVersion":{},"f:fieldPath":{}}}},"k:{\"name\":\"MY_POD_NAMESPACE\"}":{".":{},"f:name":{},"f:valueFrom":{".":{},"f:fieldRef":{".":{},"f:apiVersion":{},"f:fieldPath":{}}}},"k:{\"name\":\"RABBITMQ_ENABLED_PLUGINS_FILE\"}":{".":{},"f:name":{},"f:value":{}},"k:{\"name\":\"RABBITMQ_NODENAME\"}":{".":{},"f:name":{},"f:value":{}},"k:{\"name\":\"RABBITMQ_USE_LONGNAME\"}":{".":{},"f:name":{},"f:value":{}}},"f:image":{},"f:imagePullPolicy":{},"f:lifecycle":{".":{},"f:preStop":{".":{},"f:exec":{".":{},"f:command":{}}}},"f:name":{},"f:ports":{".":{},"k:{\"containerPort\":4369,\"protocol\":\"TCP\"}":{".":{},"f:containerPort":{},"f:name":{},"f:protocol":{}},"k:{\"containerPort\":5672,\"protocol\":\"TCP\"}":{".":{},"f:containerPort":{},"f:name":{},"f:protocol":{}},"k:{\"containerPort\":15672,\"protocol\":\"TCP\"}":{".":{},"f:containerPort":{},"f:name":{},"f:protocol":{}},"k:{\"containerPort\":15692,\"protocol\":\"TCP\"}":{".":{},"f:containerPort":{},"f:name":{},"f:protocol":{}}},"f:readinessProbe":{".":{},"f:failureThreshold":{},"f:initialDelaySeconds":{},"f:periodSeconds":{},"f:successThreshold":{},"f:tcpSocket":{".":{},"f:port":{}},"f:timeoutSeconds":{}},"f:resources":{".":{},"f:limits":{".":{},"f:cpu":{},"f:memory":{}},"f:requests":{".":{},"f:cpu":{},"f:memory":{}}},"f:terminationMessagePath":{},"f:terminationMessagePolicy":{},"f:volumeMounts":{".":{},"k:{\"mountPath\":\"/etc/pod-info/\"}":{".":{},"f:mountPath":{},"f:name":{}},"k:{\"mountPath\":\"/etc/rabbitmq/conf.d/10-operatorDefaults.conf\"}":{".":{},"f:mountPath":{},"f:name":{},"f:subPath":{}},"k:{\"mountPath\":\"/etc/rabbitmq/conf.d/11-default_user.conf\"}":{".":{},"f:mountPath":{},"f:name":{},"f:subPath":{}},"k:{\"mountPath\":\"/etc/rabbitmq/conf.d/90-userDefinedConfiguration.conf\"}":{".":{},"f:mountPath":{},"f:name":{},"f:subPath":{}},"k:{\"mountPath\":\"/operator\"}":{".":{},"f:mountPath":{},"f:name":{}},"k:{\"mountPath\":\"/var/lib/rabbitmq/\"}":{".":{},"f:mountPath":{},"f:name":{}},"k:{\"mountPath\":\"/var/lib/rabbitmq/mnesia/\"}":{".":{},"f:mountPath":{},"f:name":{}}}}},"f:dnsPolicy":{},"f:initContainers":{".":{},"k:{\"name\":\"setup-container\"}":{".":{},"f:command":{},"f:image":{},"f:imagePullPolicy":{},"f:name":{},"f:resources":{".":{},"f:limits":{".":{},"f:cpu":{},"f:memory":{}},"f:requests":{".":{},"f:cpu":{},"f:memory":{}}},"f:securityContext":{".":{},"f:capabilities":{".":{},"f:drop":{}},"f:runAsUser":{}},"f:terminationMessagePath":{},"f:terminationMessagePolicy":{},"f:volumeMounts":{".":{},"k:{\"mountPath\":\"/operator\"}":{".":{},"f:mountPath":{},"f:name":{}},"k:{\"mountPath\":\"/tmp/default_user.conf\"}":{".":{},"f:mountPath":{},"f:name":{},"f:subPath":{}},"k:{\"mountPath\":\"/tmp/erlang-cookie-secret/\"}":{".":{},"f:mountPath":{},"f:name":{}},"k:{\"mountPath\":\"/tmp/rabbitmq-plugins/\"}":{".":{},"f:mountPath":{},"f:name":{}},"k:{\"mountPath\":\"/var/lib/rabbitmq/\"}":{".":{},"f:mountPath":{},"f:name":{}},"k:{\"mountPath\":\"/var/lib/rabbitmq/mnesia/\"}":{".":{},"f:mountPath":{},"f:name":{}}}}},"f:restartPolicy":{},"f:schedulerName":{},"f:securityContext":{".":{},"f:fsGroup":{},"f:runAsGroup":{},"f:runAsUser":{}},"f:serviceAccount":{},"f:serviceAccountName":{},"f:terminationGracePeriodSeconds":{},"f:topologySpreadConstraints":{".":{},"k:{\"topologyKey\":\"topology.kubernetes.io/zone\",\"whenUnsatisfiable\":\"ScheduleAnyway\"}":{".":{},"f:labelSelector":{".":{},"f:matchLabels":{".":{},"f:app.kubernetes.io/name":{}}},"f:maxSkew":{},"f:topologyKey":{},"f:whenUnsatisfiable":{}}},"f:volumes":{".":{},"k:{\"name\":\"erlang-cookie-secret\"}":{".":{},"f:name":{},"f:secret":{".":{},"f:defaultMode":{},"f:secretName":{}}},"k:{\"name\":\"plugins-conf\"}":{".":{},"f:configMap":{".":{},"f:defaultMode":{},"f:name":{}},"f:name":{}},"k:{\"name\":\"pod-info\"}":{".":{},"f:downwardAPI":{".":{},"f:defaultMode":{},"f:items":{}},"f:name":{}},"k:{\"name\":\"rabbitmq-confd\"}":{".":{},"f:name":{},"f:projected":{".":{},"f:defaultMode":{},"f:sources":{}}},"k:{\"name\":\"rabbitmq-erlang-cookie\"}":{".":{},"f:emptyDir":{},"f:name":{}},"k:{\"name\":\"rabbitmq-plugins\"}":{".":{},"f:emptyDir":{},"f:name":{}}}}},"f:updateStrategy":{"f:rollingUpdate":{".":{},"f:partition":{}},"f:type":{}},"f:volumeClaimTemplates":{}}}}]},"spec":{"replicas":1,"selector":{"matchLabels":{"app.kubernetes.io/name":"rabbitmq-cluster"}},"template":{"metadata":{"creationTimestamp":null,"labels":{"app.kubernetes.io/component":"rabbitmq","app.kubernetes.io/name":"rabbitmq-cluster","app.kubernetes.io/part-of":"rabbitmq"},"annotations":{"prometheus.io/port":"15692","prometheus.io/scrape":"true"}},"spec":{"volumes":[{"name":"plugins-conf","configMap":{"name":"rabbitmq-cluster-plugins-conf","defaultMode":420}},{"name":"rabbitmq-confd","projected":{"sources":[{"secret":{"name":"rabbitmq-cluster-default-user","items":[{"key":"default_user.conf","path":"default_user.conf"}]}},{"configMap":{"name":"rabbitmq-cluster-server-conf","items":[{"key":"operatorDefaults.conf","path":"operatorDefaults.conf"},{"key":"userDefinedConfiguration.conf","path":"userDefinedConfiguration.conf"}]}}],"defaultMode":420}},{"name":"rabbitmq-erlang-cookie","emptyDir":{}},{"name":"erlang-cookie-secret","secret":{"secretName":"rabbitmq-cluster-erlang-cookie","defaultMode":420}},{"name":"rabbitmq-plugins","emptyDir":{}},{"name":"pod-info","downwardAPI":{"items":[{"path":"skipPreStopChecks","fieldRef":{"apiVersion":"v1","fieldPath":"metadata.labels['skipPreStopChecks']"}}],"defaultMode":420}}],"initContainers":[{"name":"setup-container","image":"rabbitmq:3.8.12-management","command":["sh","-c","cp /tmp/erlang-cookie-secret/.erlang.cookie /var/lib/rabbitmq/.erlang.cookie \u0026\u0026 chown 999:999 /var/lib/rabbitmq/.erlang.cookie \u0026\u0026 chmod 600 /var/lib/rabbitmq/.erlang.cookie ; cp /tmp/rabbitmq-plugins/enabled_plugins /operator/enabled_plugins \u0026\u0026 chown 999:999 /operator/enabled_plugins ; chown 999:999 /var/lib/rabbitmq/mnesia/ ; echo '[default]' \u003e /var/lib/rabbitmq/.rabbitmqadmin.conf \u0026\u0026 sed -e 's/default_user/username/' -e 's/default_pass/password/' /tmp/default_user.conf \u003e\u003e /var/lib/rabbitmq/.rabbitmqadmin.conf \u0026\u0026 chown 999:999 /var/lib/rabbitmq/.rabbitmqadmin.conf \u0026\u0026 chmod 600 /var/lib/rabbitmq/.rabbitmqadmin.conf"],"resources":{"limits":{"cpu":"100m","memory":"500Mi"},"requests":{"cpu":"100m","memory":"500Mi"}},"volumeMounts":[{"name":"plugins-conf","mountPath":"/tmp/rabbitmq-plugins/"},{"name":"rabbitmq-erlang-cookie","mountPath":"/var/lib/rabbitmq/"},{"name":"erlang-cookie-secret","mountPath":"/tmp/erlang-cookie-secret/"},{"name":"rabbitmq-plugins","mountPath":"/operator"},{"name":"persistence","mountPath":"/var/lib/rabbitmq/mnesia/"},{"name":"rabbitmq-confd","mountPath":"/tmp/default_user.conf","subPath":"default_user.conf"}],"terminationMessagePath":"/dev/termination-log","terminationMessagePolicy":"File","imagePullPolicy":"IfNotPresent","securityContext":{"capabilities":{"drop":["FSETID","KILL","SETGID","SETUID","SETPCAP","NET_BIND_SERVICE","NET_RAW","SYS_CHROOT","MKNOD","AUDIT_WRITE","SETFCAP"]},"runAsUser":0}}],"containers":[{"name":"rabbitmq","image":"rabbitmq:3.8.12-management","ports":[{"name":"epmd","containerPort":4369,"protocol":"TCP"},{"name":"amqp","containerPort":5672,"protocol":"TCP"},{"name":"management","containerPort":15672,"protocol":"TCP"},{"name":"prometheus","containerPort":15692,"protocol":"TCP"}],"env":[{"name":"MY_POD_NAME","valueFrom":{"fieldRef":{"apiVersion":"v1","fieldPath":"metadata.name"}}},{"name":"MY_POD_NAMESPACE","valueFrom":{"fieldRef":{"apiVersion":"v1","fieldPath":"metadata.namespace"}}},{"name":"RABBITMQ_ENABLED_PLUGINS_FILE","value":"/operator/enabled_plugins"},{"name":"K8S_SERVICE_NAME","value":"rabbitmq-cluster-nodes"},{"name":"RABBITMQ_USE_LONGNAME","value":"true"},{"name":"RABBITMQ_NODENAME","value":"rabbit@$(MY_POD_NAME).$(K8S_SERVICE_NAME).$(MY_POD_NAMESPACE)"},{"name":"K8S_HOSTNAME_SUFFIX","value":".$(K8S_SERVICE_NAME).$(MY_POD_NAMESPACE)"}],"resources":{"limits":{"cpu":"2","memory":"2Gi"},"requests":{"cpu":"1","memory":"2Gi"}},"volumeMounts":[{"name":"rabbitmq-erlang-cookie","mountPath":"/var/lib/rabbitmq/"},{"name":"persistence","mountPath":"/var/lib/rabbitmq/mnesia/"},{"name":"rabbitmq-plugins","mountPath":"/operator"},{"name":"rabbitmq-confd","mountPath":"/etc/rabbitmq/conf.d/10-operatorDefaults.conf","subPath":"operatorDefaults.conf"},{"name":"rabbitmq-confd","mountPath":"/etc/rabbitmq/conf.d/11-default_user.conf","subPath":"default_user.conf"},{"name":"rabbitmq-confd","mountPath":"/etc/rabbitmq/conf.d/90-userDefinedConfiguration.conf","subPath":"userDefinedConfiguration.conf"},{"name":"pod-info","mountPath":"/etc/pod-info/"}],"readinessProbe":{"tcpSocket":{"port":"amqp"},"initialDelaySeconds":10,"timeoutSeconds":5,"periodSeconds":10,"successThreshold":1,"failureThreshold":3},"lifecycle":{"preStop":{"exec":{"command":["/bin/bash","-c","if [ ! -z \"$(cat /etc/pod-info/skipPreStopChecks)\" ]; then exit 0; fi; rabbitmq-upgrade await_online_quorum_plus_one -t 604800; rabbitmq-upgrade await_online_synchronized_mirror -t 604800; rabbitmq-upgrade drain -t 604800"]}}},"terminationMessagePath":"/dev/termination-log","terminationMessagePolicy":"File","imagePullPolicy":"IfNotPresent"}],"restartPolicy":"Always","terminationGracePeriodSeconds":604800,"dnsPolicy":"ClusterFirst","serviceAccountName":"rabbitmq-cluster-server","serviceAccount":"rabbitmq-cluster-server","automountServiceAccountToken":true,"securityContext":{"runAsUser":999,"runAsGroup":999,"fsGroup":999},"schedulerName":"default-scheduler","topologySpreadConstraints":[{"maxSkew":1,"topologyKey":"topology.kubernetes.io/zone","whenUnsatisfiable":"ScheduleAnyway","labelSelector":{"matchLabels":{"app.kubernetes.io/name":"rabbitmq-cluster"}}}]}},"volumeClaimTemplates":[{"metadata":{"name":"persistence","namespace":"default","creationTimestamp":null,"labels":{"app.kubernetes.io/component":"rabbitmq","app.kubernetes.io/name":"rabbitmq-cluster","app.kubernetes.io/part-of":"rabbitmq"},"ownerReferences":[{"apiVersion":"rabbitmq.com/v1beta1","kind":"RabbitmqCluster","name":"rabbitmq-cluster","uid":"3ecefa8a-1bec-48a7-9af4-dd0df3339101","controller":true,"blockOwnerDeletion":false}]},"spec":{"accessModes":["ReadWriteOnce"],"resources":{"requests":{"storage":"15Gi"}},"volumeMode":"Filesystem"},"status":{"phase":"Pending"}}],"serviceName":"rabbitmq-cluster-nodes","podManagementPolicy":"Parallel","updateStrategy":{"type":"RollingUpdate","rollingUpdate":{"partition":0}},"revisionHistoryLimit":10},"status":{"observedGeneration":1,"replicas":1,"readyReplicas":1,"currentReplicas":1,"updatedReplicas":1,"currentRevision":"rabbitmq-cluster-server-5f8b8665fb","updateRevision":"rabbitmq-cluster-server-5f8b8665fb","collisionCount":0}}
2022/03/18 18:07:35 learn_server.go:256: [SIEVE-BEFORE-WRITE]	52
2022/03/18 18:07:35 learn_server.go:263: [SIEVE-AFTER-WRITE]	52	Update	statefulset	github.com/rabbitmq/cluster-operator/controllers.(*RabbitmqClusterReconciler)	NoError	{"metadata":{"name":"rabbitmq-cluster-server","namespace":"default","selfLink":"/apis/apps/v1/namespaces/default/statefulsets/rabbitmq-cluster-server","uid":"1d62d993-2c32-4da7-8884-e4cfad9e587d","resourceVersion":"1481","generation":1,"creationTimestamp":"2022-03-18T18:07:34Z","labels":{"app.kubernetes.io/component":"rabbitmq","app.kubernetes.io/name":"rabbitmq-cluster","app.kubernetes.io/part-of":"rabbitmq"},"ownerReferences":[{"apiVersion":"rabbitmq.com/v1beta1","kind":"RabbitmqCluster","name":"rabbitmq-cluster","uid":"3ecefa8a-1bec-48a7-9af4-dd0df3339101","controller":true,"blockOwnerDeletion":true}],"managedFields":[{"manager":"kube-controller-manager","operation":"Update","apiVersion":"apps/v1","time":"2022-03-18T18:07:34Z","fieldsType":"FieldsV1","fieldsV1":{"f:status":{"f:collisionCount":{},"f:currentReplicas":{},"f:currentRevision":{},"f:observedGeneration":{},"f:readyReplicas":{},"f:replicas":{},"f:updateRevision":{},"f:updatedReplicas":{}}}},{"manager":"manager","operation":"Update","apiVersion":"apps/v1","time":"2022-03-18T18:07:34Z","fieldsType":"FieldsV1","fieldsV1":{"f:metadata":{"f:labels":{".":{},"f:app.kubernetes.io/component":{},"f:app.kubernetes.io/name":{},"f:app.kubernetes.io/part-of":{}},"f:ownerReferences":{".":{},"k:{\"uid\":\"3ecefa8a-1bec-48a7-9af4-dd0df3339101\"}":{".":{},"f:apiVersion":{},"f:blockOwnerDeletion":{},"f:controller":{},"f:kind":{},"f:name":{},"f:uid":{}}}},"f:spec":{"f:podManagementPolicy":{},"f:replicas":{},"f:revisionHistoryLimit":{},"f:selector":{"f:matchLabels":{".":{},"f:app.kubernetes.io/name":{}}},"f:serviceName":{},"f:template":{"f:metadata":{"f:annotations":{".":{},"f:prometheus.io/port":{},"f:prometheus.io/scrape":{}},"f:labels":{".":{},"f:app.kubernetes.io/component":{},"f:app.kubernetes.io/name":{},"f:app.kubernetes.io/part-of":{}}},"f:spec":{"f:automountServiceAccountToken":{},"f:containers":{"k:{\"name\":\"rabbitmq\"}":{".":{},"f:env":{".":{},"k:{\"name\":\"K8S_HOSTNAME_SUFFIX\"}":{".":{},"f:name":{},"f:value":{}},"k:{\"name\":\"K8S_SERVICE_NAME\"}":{".":{},"f:name":{},"f:value":{}},"k:{\"name\":\"MY_POD_NAME\"}":{".":{},"f:name":{},"f:valueFrom":{".":{},"f:fieldRef":{".":{},"f:apiVersion":{},"f:fieldPath":{}}}},"k:{\"name\":\"MY_POD_NAMESPACE\"}":{".":{},"f:name":{},"f:valueFrom":{".":{},"f:fieldRef":{".":{},"f:apiVersion":{},"f:fieldPath":{}}}},"k:{\"name\":\"RABBITMQ_ENABLED_PLUGINS_FILE\"}":{".":{},"f:name":{},"f:value":{}},"k:{\"name\":\"RABBITMQ_NODENAME\"}":{".":{},"f:name":{},"f:value":{}},"k:{\"name\":\"RABBITMQ_USE_LONGNAME\"}":{".":{},"f:name":{},"f:value":{}}},"f:image":{},"f:imagePullPolicy":{},"f:lifecycle":{".":{},"f:preStop":{".":{},"f:exec":{".":{},"f:command":{}}}},"f:name":{},"f:ports":{".":{},"k:{\"containerPort\":4369,\"protocol\":\"TCP\"}":{".":{},"f:containerPort":{},"f:name":{},"f:protocol":{}},"k:{\"containerPort\":5672,\"protocol\":\"TCP\"}":{".":{},"f:containerPort":{},"f:name":{},"f:protocol":{}},"k:{\"containerPort\":15672,\"protocol\":\"TCP\"}":{".":{},"f:containerPort":{},"f:name":{},"f:protocol":{}},"k:{\"containerPort\":15692,\"protocol\":\"TCP\"}":{".":{},"f:containerPort":{},"f:name":{},"f:protocol":{}}},"f:readinessProbe":{".":{},"f:failureThreshold":{},"f:initialDelaySeconds":{},"f:periodSeconds":{},"f:successThreshold":{},"f:tcpSocket":{".":{},"f:port":{}},"f:timeoutSeconds":{}},"f:resources":{".":{},"f:limits":{".":{},"f:cpu":{},"f:memory":{}},"f:requests":{".":{},"f:cpu":{},"f:memory":{}}},"f:terminationMessagePath":{},"f:terminationMessagePolicy":{},"f:volumeMounts":{".":{},"k:{\"mountPath\":\"/etc/pod-info/\"}":{".":{},"f:mountPath":{},"f:name":{}},"k:{\"mountPath\":\"/etc/rabbitmq/conf.d/10-operatorDefaults.conf\"}":{".":{},"f:mountPath":{},"f:name":{},"f:subPath":{}},"k:{\"mountPath\":\"/etc/rabbitmq/conf.d/11-default_user.conf\"}":{".":{},"f:mountPath":{},"f:name":{},"f:subPath":{}},"k:{\"mountPath\":\"/etc/rabbitmq/conf.d/90-userDefinedConfiguration.conf\"}":{".":{},"f:mountPath":{},"f:name":{},"f:subPath":{}},"k:{\"mountPath\":\"/operator\"}":{".":{},"f:mountPath":{},"f:name":{}},"k:{\"mountPath\":\"/var/lib/rabbitmq/\"}":{".":{},"f:mountPath":{},"f:name":{}},"k:{\"mountPath\":\"/var/lib/rabbitmq/mnesia/\"}":{".":{},"f:mountPath":{},"f:name":{}}}}},"f:dnsPolicy":{},"f:initContainers":{".":{},"k:{\"name\":\"setup-container\"}":{".":{},"f:command":{},"f:image":{},"f:imagePullPolicy":{},"f:name":{},"f:resources":{".":{},"f:limits":{".":{},"f:cpu":{},"f:memory":{}},"f:requests":{".":{},"f:cpu":{},"f:memory":{}}},"f:securityContext":{".":{},"f:capabilities":{".":{},"f:drop":{}},"f:runAsUser":{}},"f:terminationMessagePath":{},"f:terminationMessagePolicy":{},"f:volumeMounts":{".":{},"k:{\"mountPath\":\"/operator\"}":{".":{},"f:mountPath":{},"f:name":{}},"k:{\"mountPath\":\"/tmp/default_user.conf\"}":{".":{},"f:mountPath":{},"f:name":{},"f:subPath":{}},"k:{\"mountPath\":\"/tmp/erlang-cookie-secret/\"}":{".":{},"f:mountPath":{},"f:name":{}},"k:{\"mountPath\":\"/tmp/rabbitmq-plugins/\"}":{".":{},"f:mountPath":{},"f:name":{}},"k:{\"mountPath\":\"/var/lib/rabbitmq/\"}":{".":{},"f:mountPath":{},"f:name":{}},"k:{\"mountPath\":\"/var/lib/rabbitmq/mnesia/\"}":{".":{},"f:mountPath":{},"f:name":{}}}}},"f:restartPolicy":{},"f:schedulerName":{},"f:securityContext":{".":{},"f:fsGroup":{},"f:runAsGroup":{},"f:runAsUser":{}},"f:serviceAccount":{},"f:serviceAccountName":{},"f:terminationGracePeriodSeconds":{},"f:topologySpreadConstraints":{".":{},"k:{\"topologyKey\":\"topology.kubernetes.io/zone\",\"whenUnsatisfiable\":\"ScheduleAnyway\"}":{".":{},"f:labelSelector":{".":{},"f:matchLabels":{".":{},"f:app.kubernetes.io/name":{}}},"f:maxSkew":{},"f:topologyKey":{},"f:whenUnsatisfiable":{}}},"f:volumes":{".":{},"k:{\"name\":\"erlang-cookie-secret\"}":{".":{},"f:name":{},"f:secret":{".":{},"f:defaultMode":{},"f:secretName":{}}},"k:{\"name\":\"plugins-conf\"}":{".":{},"f:configMap":{".":{},"f:defaultMode":{},"f:name":{}},"f:name":{}},"k:{\"name\":\"pod-info\"}":{".":{},"f:downwardAPI":{".":{},"f:defaultMode":{},"f:items":{}},"f:name":{}},"k:{\"name\":\"rabbitmq-confd\"}":{".":{},"f:name":{},"f:projected":{".":{},"f:defaultMode":{},"f:sources":{}}},"k:{\"name\":\"rabbitmq-erlang-cookie\"}":{".":{},"f:emptyDir":{},"f:name":{}},"k:{\"name\":\"rabbitmq-plugins\"}":{".":{},"f:emptyDir":{},"f:name":{}}}}},"f:updateStrategy":{"f:rollingUpdate":{".":{},"f:partition":{}},"f:type":{}},"f:volumeClaimTemplates":{}}}}]},"spec":{"replicas":1,"selector":{"matchLabels":{"app.kubernetes.io/name":"rabbitmq-cluster"}},"template":{"metadata":{"creationTimestamp":null,"labels":{"app.kubernetes.io/component":"rabbitmq","app.kubernetes.io/name":"rabbitmq-cluster","app.kubernetes.io/part-of":"rabbitmq"},"annotations":{"prometheus.io/port":"15692","prometheus.io/scrape":"true"}},"spec":{"volumes":[{"name":"plugins-conf","configMap":{"name":"rabbitmq-cluster-plugins-conf","defaultMode":420}},{"name":"rabbitmq-confd","projected":{"sources":[{"secret":{"name":"rabbitmq-cluster-default-user","items":[{"key":"default_user.conf","path":"default_user.conf"}]}},{"configMap":{"name":"rabbitmq-cluster-server-conf","items":[{"key":"operatorDefaults.conf","path":"operatorDefaults.conf"},{"key":"userDefinedConfiguration.conf","path":"userDefinedConfiguration.conf"}]}}],"defaultMode":420}},{"name":"rabbitmq-erlang-cookie","emptyDir":{}},{"name":"erlang-cookie-secret","secret":{"secretName":"rabbitmq-cluster-erlang-cookie","defaultMode":420}},{"name":"rabbitmq-plugins","emptyDir":{}},{"name":"pod-info","downwardAPI":{"items":[{"path":"skipPreStopChecks","fieldRef":{"apiVersion":"v1","fieldPath":"metadata.labels['skipPreStopChecks']"}}],"defaultMode":420}}],"initContainers":[{"name":"setup-container","image":"rabbitmq:3.8.12-management","command":["sh","-c","cp /tmp/erlang-cookie-secret/.erlang.cookie /var/lib/rabbitmq/.erlang.cookie \u0026\u0026 chown 999:999 /var/lib/rabbitmq/.erlang.cookie \u0026\u0026 chmod 600 /var/lib/rabbitmq/.erlang.cookie ; cp /tmp/rabbitmq-plugins/enabled_plugins /operator/enabled_plugins \u0026\u0026 chown 999:999 /operator/enabled_plugins ; chown 999:999 /var/lib/rabbitmq/mnesia/ ; echo '[default]' \u003e /var/lib/rabbitmq/.rabbitmqadmin.conf \u0026\u0026 sed -e 's/default_user/username/' -e 's/default_pass/password/' /tmp/default_user.conf \u003e\u003e /var/lib/rabbitmq/.rabbitmqadmin.conf \u0026\u0026 chown 999:999 /var/lib/rabbitmq/.rabbitmqadmin.conf \u0026\u0026 chmod 600 /var/lib/rabbitmq/.rabbitmqadmin.conf"],"resources":{"limits":{"cpu":"100m","memory":"500Mi"},"requests":{"cpu":"100m","memory":"500Mi"}},"volumeMounts":[{"name":"plugins-conf","mountPath":"/tmp/rabbitmq-plugins/"},{"name":"rabbitmq-erlang-cookie","mountPath":"/var/lib/rabbitmq/"},{"name":"erlang-cookie-secret","mountPath":"/tmp/erlang-cookie-secret/"},{"name":"rabbitmq-plugins","mountPath":"/operator"},{"name":"persistence","mountPath":"/var/lib/rabbitmq/mnesia/"},{"name":"rabbitmq-confd","mountPath":"/tmp/default_user.conf","subPath":"default_user.conf"}],"terminationMessagePath":"/dev/termination-log","terminationMessagePolicy":"File","imagePullPolicy":"IfNotPresent","securityContext":{"capabilities":{"drop":["FSETID","KILL","SETGID","SETUID","SETPCAP","NET_BIND_SERVICE","NET_RAW","SYS_CHROOT","MKNOD","AUDIT_WRITE","SETFCAP"]},"runAsUser":0}}],"containers":[{"name":"rabbitmq","image":"rabbitmq:3.8.12-management","ports":[{"name":"epmd","containerPort":4369,"protocol":"TCP"},{"name":"amqp","containerPort":5672,"protocol":"TCP"},{"name":"management","containerPort":15672,"protocol":"TCP"},{"name":"prometheus","containerPort":15692,"protocol":"TCP"}],"env":[{"name":"MY_POD_NAME","valueFrom":{"fieldRef":{"apiVersion":"v1","fieldPath":"metadata.name"}}},{"name":"MY_POD_NAMESPACE","valueFrom":{"fieldRef":{"apiVersion":"v1","fieldPath":"metadata.namespace"}}},{"name":"RABBITMQ_ENABLED_PLUGINS_FILE","value":"/operator/enabled_plugins"},{"name":"K8S_SERVICE_NAME","value":"rabbitmq-cluster-nodes"},{"name":"RABBITMQ_USE_LONGNAME","value":"true"},{"name":"RABBITMQ_NODENAME","value":"rabbit@$(MY_POD_NAME).$(K8S_SERVICE_NAME).$(MY_POD_NAMESPACE)"},{"name":"K8S_HOSTNAME_SUFFIX","value":".$(K8S_SERVICE_NAME).$(MY_POD_NAMESPACE)"}],"resources":{"limits":{"cpu":"2","memory":"2Gi"},"requests":{"cpu":"1","memory":"2Gi"}},"volumeMounts":[{"name":"rabbitmq-erlang-cookie","mountPath":"/var/lib/rabbitmq/"},{"name":"persistence","mountPath":"/var/lib/rabbitmq/mnesia/"},{"name":"rabbitmq-plugins","mountPath":"/operator"},{"name":"rabbitmq-confd","mountPath":"/etc/rabbitmq/conf.d/10-operatorDefaults.conf","subPath":"operatorDefaults.conf"},{"name":"rabbitmq-confd","mountPath":"/etc/rabbitmq/conf.d/11-default_user.conf","subPath":"default_user.conf"},{"name":"rabbitmq-confd","mountPath":"/etc/rabbitmq/conf.d/90-userDefinedConfiguration.conf","subPath":"userDefinedConfiguration.conf"},{"name":"pod-info","mountPath":"/etc/pod-info/"}],"readinessProbe":{"tcpSocket":{"port":"amqp"},"initialDelaySeconds":10,"timeoutSeconds":5,"periodSeconds":10,"successThreshold":1,"failureThreshold":3},"lifecycle":{"preStop":{"exec":{"command":["/bin/bash","-c","if [ ! -z \"$(cat /etc/pod-info/skipPreStopChecks)\" ]; then exit 0; fi; rabbitmq-upgrade await_online_quorum_plus_one -t 604800; rabbitmq-upgrade await_online_synchronized_mirror -t 604800; rabbitmq-upgrade drain -t 604800"]}}},"terminationMessagePath":"/dev/termination-log","terminationMessagePolicy":"File","imagePullPolicy":"IfNotPresent"}],"restartPolicy":"Always","terminationGracePeriodSeconds":604800,"dnsPolicy":"ClusterFirst","serviceAccountName":"rabbitmq-cluster-server","serviceAccount":"rabbitmq-cluster-server","automountServiceAccountToken":true,"securityContext":{"runAsUser":999,"runAsGroup":999,"fsGroup":999},"schedulerName":"default-scheduler","topologySpreadConstraints":[{"maxSkew":1,"topologyKey":"topology.kubernetes.io/zone","whenUnsatisfiable":"ScheduleAnyway","labelSelector":{"matchLabels":{"app.kubernetes.io/name":"rabbitmq-cluster"}}}]}},"volumeClaimTemplates":[{"metadata":{"name":"persistence","namespace":"default","creationTimestamp":null,"labels":{"app.kubernetes.io/component":"rabbitmq","app.kubernetes.io/name":"rabbitmq-cluster","app.kubernetes.io/part-of":"rabbitmq"},"ownerReferences":[{"apiVersion":"rabbitmq.com/v1beta1","kind":"RabbitmqCluster","name":"rabbitmq-cluster","uid":"3ecefa8a-1bec-48a7-9af4-dd0df3339101","controller":true,"blockOwnerDeletion":false}]},"spec":{"accessModes":["ReadWriteOnce"],"resources":{"requests":{"storage":"15Gi"}},"volumeMode":"Filesystem"},"status":{"phase":"Pending"}}],"serviceName":"rabbitmq-cluster-nodes","podManagementPolicy":"Parallel","updateStrategy":{"type":"RollingUpdate","rollingUpdate":{"partition":0}},"revisionHistoryLimit":10},"status":{"observedGeneration":1,"replicas":1,"readyReplicas":1,"currentReplicas":1,"updatedReplicas":1,"currentRevision":"rabbitmq-cluster-server-5f8b8665fb","updateRevision":"rabbitmq-cluster-server-5f8b8665fb","collisionCount":0}}
2022/03/18 18:07:35 learn_server.go:291: [SIEVE-AFTER-READ]	Get	true	configmap	default	rabbitmq-cluster-server-conf	github.com/rabbitmq/cluster-operator/controllers.(*RabbitmqClusterReconciler)	NoError	{"kind":"ConfigMap","apiVersion":"v1","metadata":{"name":"rabbitmq-cluster-server-conf","namespace":"default","selfLink":"/api/v1/namespaces/default/configmaps/rabbitmq-cluster-server-conf","uid":"e4182078-d429-4baf-9021-72618c509ac5","resourceVersion":"1095","creationTimestamp":"2022-03-18T18:06:25Z","labels":{"app.kubernetes.io/component":"rabbitmq","app.kubernetes.io/name":"rabbitmq-cluster","app.kubernetes.io/part-of":"rabbitmq"},"ownerReferences":[{"apiVersion":"rabbitmq.com/v1beta1","kind":"RabbitmqCluster","name":"rabbitmq-cluster","uid":"3ecefa8a-1bec-48a7-9af4-dd0df3339101","controller":true,"blockOwnerDeletion":true}],"managedFields":[{"manager":"manager","operation":"Update","apiVersion":"v1","time":"2022-03-18T18:06:25Z","fieldsType":"FieldsV1","fieldsV1":{"f:data":{".":{},"f:operatorDefaults.conf":{},"f:userDefinedConfiguration.conf":{}},"f:metadata":{"f:labels":{".":{},"f:app.kubernetes.io/component":{},"f:app.kubernetes.io/name":{},"f:app.kubernetes.io/part-of":{}},"f:ownerReferences":{".":{},"k:{\"uid\":\"3ecefa8a-1bec-48a7-9af4-dd0df3339101\"}":{".":{},"f:apiVersion":{},"f:blockOwnerDeletion":{},"f:controller":{},"f:kind":{},"f:name":{},"f:uid":{}}}}}}]},"data":{"operatorDefaults.conf":"cluster_formation.peer_discovery_backend             = rabbit_peer_discovery_k8s\ncluster_formation.k8s.host                           = kubernetes.default\ncluster_formation.k8s.address_type                   = hostname\ncluster_partition_handling                           = pause_minority\nqueue_master_locator                                 = min-masters\ndisk_free_limit.absolute                             = 2GB\ncluster_formation.randomized_startup_delay_range.min = 5\ncluster_formation.randomized_startup_delay_range.max = 30\ncluster_name                                         = rabbitmq-cluster\n","userDefinedConfiguration.conf":"total_memory_available_override_value = 1717986919\n"}}
2022/03/18 18:07:35 learn_server.go:256: [SIEVE-BEFORE-WRITE]	53
2022/03/18 18:07:35 learn_server.go:263: [SIEVE-AFTER-WRITE]	53	StatusUpdate	rabbitmqcluster	github.com/rabbitmq/cluster-operator/controllers.(*RabbitmqClusterReconciler)	NoError	{"metadata":{"name":"rabbitmq-cluster","namespace":"default","selfLink":"/apis/rabbitmq.com/v1beta1/namespaces/default/rabbitmqclusters/rabbitmq-cluster/status","uid":"3ecefa8a-1bec-48a7-9af4-dd0df3339101","resourceVersion":"1482","generation":3,"creationTimestamp":"2022-03-18T18:06:25Z","annotations":{"kubectl.kubernetes.io/last-applied-configuration":"{\"apiVersion\":\"rabbitmq.com/v1beta1\",\"kind\":\"RabbitmqCluster\",\"metadata\":{\"annotations\":{},\"name\":\"rabbitmq-cluster\",\"namespace\":\"default\"},\"spec\":{\"persistence\":{\"storage\":\"10Gi\"},\"replicas\":1}}\n"},"finalizers":["deletion.finalizers.rabbitmqclusters.rabbitmq.com"],"managedFields":[{"manager":"kubectl-client-side-apply","operation":"Update","apiVersion":"rabbitmq.com/v1beta1","time":"2022-03-18T18:06:25Z","fieldsType":"FieldsV1","fieldsV1":{"f:metadata":{"f:annotations":{".":{},"f:kubectl.kubernetes.io/last-applied-configuration":{}}},"f:spec":{".":{},"f:image":{},"f:persistence":{},"f:replicas":{},"f:resources":{".":{},"f:limits":{".":{},"f:memory":{}},"f:requests":{".":{},"f:memory":{}}},"f:service":{".":{},"f:type":{}},"f:terminationGracePeriodSeconds":{}}}},{"manager":"kubectl-patch","operation":"Update","apiVersion":"rabbitmq.com/v1beta1","time":"2022-03-18T18:07:31Z","fieldsType":"FieldsV1","fieldsV1":{"f:spec":{"f:persistence":{"f:storage":{}}}}},{"manager":"manager","operation":"Update","apiVersion":"rabbitmq.com/v1beta1","time":"2022-03-18T18:07:35Z","fieldsType":"FieldsV1","fieldsV1":{"f:metadata":{"f:finalizers":{}},"f:spec":{"f:override":{},"f:rabbitmq":{},"f:resources":{"f:limits":{"f:cpu":{}},"f:requests":{"f:cpu":{}}},"f:tls":{}},"f:status":{".":{},"f:conditions":{},"f:defaultUser":{".":{},"f:secretReference":{".":{},"f:keys":{".":{},"f:password":{},"f:username":{}},"f:name":{},"f:namespace":{}},"f:serviceReference":{".":{},"f:name":{},"f:namespace":{}}}}}}]},"spec":{"replicas":1,"image":"rabbitmq:3.8.12-management","service":{"type":"ClusterIP"},"persistence":{"storage":"15Gi"},"resources":{"limits":{"cpu":"2","memory":"2Gi"},"requests":{"cpu":"1","memory":"2Gi"}},"rabbitmq":{},"tls":{},"override":{},"terminationGracePeriodSeconds":604800},"status":{"conditions":[{"type":"AllReplicasReady","status":"True","lastTransitionTime":"2022-03-18T18:07:35Z","reason":"AllPodsAreReady"},{"type":"ClusterAvailable","status":"True","lastTransitionTime":"2022-03-18T18:07:23Z","reason":"AtLeastOneEndpointAvailable"},{"type":"NoWarnings","status":"True","lastTransitionTime":"2022-03-18T18:06:25Z","reason":"NoWarnings"},{"type":"ReconcileSuccess","status":"True","lastTransitionTime":"2022-03-18T18:07:24Z","reason":"Success","message":"Finish reconciling"}],"defaultUser":{"secretReference":{"name":"rabbitmq-cluster-default-user","namespace":"default","keys":{"password":"password","username":"username"}},"serviceReference":{"name":"rabbitmq-cluster","namespace":"default"}},"binding":{"name":"rabbitmq-cluster-default-user"}}}
2022/03/18 18:07:35 learn_server.go:291: [SIEVE-AFTER-READ]	Get	true	statefulset	default	rabbitmq-cluster-server	github.com/rabbitmq/cluster-operator/controllers.(*RabbitmqClusterReconciler)	NoError	{"kind":"StatefulSet","apiVersion":"apps/v1","metadata":{"name":"rabbitmq-cluster-server","namespace":"default","selfLink":"/apis/apps/v1/namespaces/default/statefulsets/rabbitmq-cluster-server","uid":"1d62d993-2c32-4da7-8884-e4cfad9e587d","resourceVersion":"1481","generation":1,"creationTimestamp":"2022-03-18T18:07:34Z","labels":{"app.kubernetes.io/component":"rabbitmq","app.kubernetes.io/name":"rabbitmq-cluster","app.kubernetes.io/part-of":"rabbitmq"},"ownerReferences":[{"apiVersion":"rabbitmq.com/v1beta1","kind":"RabbitmqCluster","name":"rabbitmq-cluster","uid":"3ecefa8a-1bec-48a7-9af4-dd0df3339101","controller":true,"blockOwnerDeletion":true}],"managedFields":[{"manager":"kube-controller-manager","operation":"Update","apiVersion":"apps/v1","time":"2022-03-18T18:07:34Z","fieldsType":"FieldsV1","fieldsV1":{"f:status":{"f:collisionCount":{},"f:currentReplicas":{},"f:currentRevision":{},"f:observedGeneration":{},"f:readyReplicas":{},"f:replicas":{},"f:updateRevision":{},"f:updatedReplicas":{}}}},{"manager":"manager","operation":"Update","apiVersion":"apps/v1","time":"2022-03-18T18:07:34Z","fieldsType":"FieldsV1","fieldsV1":{"f:metadata":{"f:labels":{".":{},"f:app.kubernetes.io/component":{},"f:app.kubernetes.io/name":{},"f:app.kubernetes.io/part-of":{}},"f:ownerReferences":{".":{},"k:{\"uid\":\"3ecefa8a-1bec-48a7-9af4-dd0df3339101\"}":{".":{},"f:apiVersion":{},"f:blockOwnerDeletion":{},"f:controller":{},"f:kind":{},"f:name":{},"f:uid":{}}}},"f:spec":{"f:podManagementPolicy":{},"f:replicas":{},"f:revisionHistoryLimit":{},"f:selector":{"f:matchLabels":{".":{},"f:app.kubernetes.io/name":{}}},"f:serviceName":{},"f:template":{"f:metadata":{"f:annotations":{".":{},"f:prometheus.io/port":{},"f:prometheus.io/scrape":{}},"f:labels":{".":{},"f:app.kubernetes.io/component":{},"f:app.kubernetes.io/name":{},"f:app.kubernetes.io/part-of":{}}},"f:spec":{"f:automountServiceAccountToken":{},"f:containers":{"k:{\"name\":\"rabbitmq\"}":{".":{},"f:env":{".":{},"k:{\"name\":\"K8S_HOSTNAME_SUFFIX\"}":{".":{},"f:name":{},"f:value":{}},"k:{\"name\":\"K8S_SERVICE_NAME\"}":{".":{},"f:name":{},"f:value":{}},"k:{\"name\":\"MY_POD_NAME\"}":{".":{},"f:name":{},"f:valueFrom":{".":{},"f:fieldRef":{".":{},"f:apiVersion":{},"f:fieldPath":{}}}},"k:{\"name\":\"MY_POD_NAMESPACE\"}":{".":{},"f:name":{},"f:valueFrom":{".":{},"f:fieldRef":{".":{},"f:apiVersion":{},"f:fieldPath":{}}}},"k:{\"name\":\"RABBITMQ_ENABLED_PLUGINS_FILE\"}":{".":{},"f:name":{},"f:value":{}},"k:{\"name\":\"RABBITMQ_NODENAME\"}":{".":{},"f:name":{},"f:value":{}},"k:{\"name\":\"RABBITMQ_USE_LONGNAME\"}":{".":{},"f:name":{},"f:value":{}}},"f:image":{},"f:imagePullPolicy":{},"f:lifecycle":{".":{},"f:preStop":{".":{},"f:exec":{".":{},"f:command":{}}}},"f:name":{},"f:ports":{".":{},"k:{\"containerPort\":4369,\"protocol\":\"TCP\"}":{".":{},"f:containerPort":{},"f:name":{},"f:protocol":{}},"k:{\"containerPort\":5672,\"protocol\":\"TCP\"}":{".":{},"f:containerPort":{},"f:name":{},"f:protocol":{}},"k:{\"containerPort\":15672,\"protocol\":\"TCP\"}":{".":{},"f:containerPort":{},"f:name":{},"f:protocol":{}},"k:{\"containerPort\":15692,\"protocol\":\"TCP\"}":{".":{},"f:containerPort":{},"f:name":{},"f:protocol":{}}},"f:readinessProbe":{".":{},"f:failureThreshold":{},"f:initialDelaySeconds":{},"f:periodSeconds":{},"f:successThreshold":{},"f:tcpSocket":{".":{},"f:port":{}},"f:timeoutSeconds":{}},"f:resources":{".":{},"f:limits":{".":{},"f:cpu":{},"f:memory":{}},"f:requests":{".":{},"f:cpu":{},"f:memory":{}}},"f:terminationMessagePath":{},"f:terminationMessagePolicy":{},"f:volumeMounts":{".":{},"k:{\"mountPath\":\"/etc/pod-info/\"}":{".":{},"f:mountPath":{},"f:name":{}},"k:{\"mountPath\":\"/etc/rabbitmq/conf.d/10-operatorDefaults.conf\"}":{".":{},"f:mountPath":{},"f:name":{},"f:subPath":{}},"k:{\"mountPath\":\"/etc/rabbitmq/conf.d/11-default_user.conf\"}":{".":{},"f:mountPath":{},"f:name":{},"f:subPath":{}},"k:{\"mountPath\":\"/etc/rabbitmq/conf.d/90-userDefinedConfiguration.conf\"}":{".":{},"f:mountPath":{},"f:name":{},"f:subPath":{}},"k:{\"mountPath\":\"/operator\"}":{".":{},"f:mountPath":{},"f:name":{}},"k:{\"mountPath\":\"/var/lib/rabbitmq/\"}":{".":{},"f:mountPath":{},"f:name":{}},"k:{\"mountPath\":\"/var/lib/rabbitmq/mnesia/\"}":{".":{},"f:mountPath":{},"f:name":{}}}}},"f:dnsPolicy":{},"f:initContainers":{".":{},"k:{\"name\":\"setup-container\"}":{".":{},"f:command":{},"f:image":{},"f:imagePullPolicy":{},"f:name":{},"f:resources":{".":{},"f:limits":{".":{},"f:cpu":{},"f:memory":{}},"f:requests":{".":{},"f:cpu":{},"f:memory":{}}},"f:securityContext":{".":{},"f:capabilities":{".":{},"f:drop":{}},"f:runAsUser":{}},"f:terminationMessagePath":{},"f:terminationMessagePolicy":{},"f:volumeMounts":{".":{},"k:{\"mountPath\":\"/operator\"}":{".":{},"f:mountPath":{},"f:name":{}},"k:{\"mountPath\":\"/tmp/default_user.conf\"}":{".":{},"f:mountPath":{},"f:name":{},"f:subPath":{}},"k:{\"mountPath\":\"/tmp/erlang-cookie-secret/\"}":{".":{},"f:mountPath":{},"f:name":{}},"k:{\"mountPath\":\"/tmp/rabbitmq-plugins/\"}":{".":{},"f:mountPath":{},"f:name":{}},"k:{\"mountPath\":\"/var/lib/rabbitmq/\"}":{".":{},"f:mountPath":{},"f:name":{}},"k:{\"mountPath\":\"/var/lib/rabbitmq/mnesia/\"}":{".":{},"f:mountPath":{},"f:name":{}}}}},"f:restartPolicy":{},"f:schedulerName":{},"f:securityContext":{".":{},"f:fsGroup":{},"f:runAsGroup":{},"f:runAsUser":{}},"f:serviceAccount":{},"f:serviceAccountName":{},"f:terminationGracePeriodSeconds":{},"f:topologySpreadConstraints":{".":{},"k:{\"topologyKey\":\"topology.kubernetes.io/zone\",\"whenUnsatisfiable\":\"ScheduleAnyway\"}":{".":{},"f:labelSelector":{".":{},"f:matchLabels":{".":{},"f:app.kubernetes.io/name":{}}},"f:maxSkew":{},"f:topologyKey":{},"f:whenUnsatisfiable":{}}},"f:volumes":{".":{},"k:{\"name\":\"erlang-cookie-secret\"}":{".":{},"f:name":{},"f:secret":{".":{},"f:defaultMode":{},"f:secretName":{}}},"k:{\"name\":\"plugins-conf\"}":{".":{},"f:configMap":{".":{},"f:defaultMode":{},"f:name":{}},"f:name":{}},"k:{\"name\":\"pod-info\"}":{".":{},"f:downwardAPI":{".":{},"f:defaultMode":{},"f:items":{}},"f:name":{}},"k:{\"name\":\"rabbitmq-confd\"}":{".":{},"f:name":{},"f:projected":{".":{},"f:defaultMode":{},"f:sources":{}}},"k:{\"name\":\"rabbitmq-erlang-cookie\"}":{".":{},"f:emptyDir":{},"f:name":{}},"k:{\"name\":\"rabbitmq-plugins\"}":{".":{},"f:emptyDir":{},"f:name":{}}}}},"f:updateStrategy":{"f:rollingUpdate":{".":{},"f:partition":{}},"f:type":{}},"f:volumeClaimTemplates":{}}}}]},"spec":{"replicas":1,"selector":{"matchLabels":{"app.kubernetes.io/name":"rabbitmq-cluster"}},"template":{"metadata":{"creationTimestamp":null,"labels":{"app.kubernetes.io/component":"rabbitmq","app.kubernetes.io/name":"rabbitmq-cluster","app.kubernetes.io/part-of":"rabbitmq"},"annotations":{"prometheus.io/port":"15692","prometheus.io/scrape":"true"}},"spec":{"volumes":[{"name":"plugins-conf","configMap":{"name":"rabbitmq-cluster-plugins-conf","defaultMode":420}},{"name":"rabbitmq-confd","projected":{"sources":[{"secret":{"name":"rabbitmq-cluster-default-user","items":[{"key":"default_user.conf","path":"default_user.conf"}]}},{"configMap":{"name":"rabbitmq-cluster-server-conf","items":[{"key":"operatorDefaults.conf","path":"operatorDefaults.conf"},{"key":"userDefinedConfiguration.conf","path":"userDefinedConfiguration.conf"}]}}],"defaultMode":420}},{"name":"rabbitmq-erlang-cookie","emptyDir":{}},{"name":"erlang-cookie-secret","secret":{"secretName":"rabbitmq-cluster-erlang-cookie","defaultMode":420}},{"name":"rabbitmq-plugins","emptyDir":{}},{"name":"pod-info","downwardAPI":{"items":[{"path":"skipPreStopChecks","fieldRef":{"apiVersion":"v1","fieldPath":"metadata.labels['skipPreStopChecks']"}}],"defaultMode":420}}],"initContainers":[{"name":"setup-container","image":"rabbitmq:3.8.12-management","command":["sh","-c","cp /tmp/erlang-cookie-secret/.erlang.cookie /var/lib/rabbitmq/.erlang.cookie \u0026\u0026 chown 999:999 /var/lib/rabbitmq/.erlang.cookie \u0026\u0026 chmod 600 /var/lib/rabbitmq/.erlang.cookie ; cp /tmp/rabbitmq-plugins/enabled_plugins /operator/enabled_plugins \u0026\u0026 chown 999:999 /operator/enabled_plugins ; chown 999:999 /var/lib/rabbitmq/mnesia/ ; echo '[default]' \u003e /var/lib/rabbitmq/.rabbitmqadmin.conf \u0026\u0026 sed -e 's/default_user/username/' -e 's/default_pass/password/' /tmp/default_user.conf \u003e\u003e /var/lib/rabbitmq/.rabbitmqadmin.conf \u0026\u0026 chown 999:999 /var/lib/rabbitmq/.rabbitmqadmin.conf \u0026\u0026 chmod 600 /var/lib/rabbitmq/.rabbitmqadmin.conf"],"resources":{"limits":{"cpu":"100m","memory":"500Mi"},"requests":{"cpu":"100m","memory":"500Mi"}},"volumeMounts":[{"name":"plugins-conf","mountPath":"/tmp/rabbitmq-plugins/"},{"name":"rabbitmq-erlang-cookie","mountPath":"/var/lib/rabbitmq/"},{"name":"erlang-cookie-secret","mountPath":"/tmp/erlang-cookie-secret/"},{"name":"rabbitmq-plugins","mountPath":"/operator"},{"name":"persistence","mountPath":"/var/lib/rabbitmq/mnesia/"},{"name":"rabbitmq-confd","mountPath":"/tmp/default_user.conf","subPath":"default_user.conf"}],"terminationMessagePath":"/dev/termination-log","terminationMessagePolicy":"File","imagePullPolicy":"IfNotPresent","securityContext":{"capabilities":{"drop":["FSETID","KILL","SETGID","SETUID","SETPCAP","NET_BIND_SERVICE","NET_RAW","SYS_CHROOT","MKNOD","AUDIT_WRITE","SETFCAP"]},"runAsUser":0}}],"containers":[{"name":"rabbitmq","image":"rabbitmq:3.8.12-management","ports":[{"name":"epmd","containerPort":4369,"protocol":"TCP"},{"name":"amqp","containerPort":5672,"protocol":"TCP"},{"name":"management","containerPort":15672,"protocol":"TCP"},{"name":"prometheus","containerPort":15692,"protocol":"TCP"}],"env":[{"name":"MY_POD_NAME","valueFrom":{"fieldRef":{"apiVersion":"v1","fieldPath":"metadata.name"}}},{"name":"MY_POD_NAMESPACE","valueFrom":{"fieldRef":{"apiVersion":"v1","fieldPath":"metadata.namespace"}}},{"name":"RABBITMQ_ENABLED_PLUGINS_FILE","value":"/operator/enabled_plugins"},{"name":"K8S_SERVICE_NAME","value":"rabbitmq-cluster-nodes"},{"name":"RABBITMQ_USE_LONGNAME","value":"true"},{"name":"RABBITMQ_NODENAME","value":"rabbit@$(MY_POD_NAME).$(K8S_SERVICE_NAME).$(MY_POD_NAMESPACE)"},{"name":"K8S_HOSTNAME_SUFFIX","value":".$(K8S_SERVICE_NAME).$(MY_POD_NAMESPACE)"}],"resources":{"limits":{"cpu":"2","memory":"2Gi"},"requests":{"cpu":"1","memory":"2Gi"}},"volumeMounts":[{"name":"rabbitmq-erlang-cookie","mountPath":"/var/lib/rabbitmq/"},{"name":"persistence","mountPath":"/var/lib/rabbitmq/mnesia/"},{"name":"rabbitmq-plugins","mountPath":"/operator"},{"name":"rabbitmq-confd","mountPath":"/etc/rabbitmq/conf.d/10-operatorDefaults.conf","subPath":"operatorDefaults.conf"},{"name":"rabbitmq-confd","mountPath":"/etc/rabbitmq/conf.d/11-default_user.conf","subPath":"default_user.conf"},{"name":"rabbitmq-confd","mountPath":"/etc/rabbitmq/conf.d/90-userDefinedConfiguration.conf","subPath":"userDefinedConfiguration.conf"},{"name":"pod-info","mountPath":"/etc/pod-info/"}],"readinessProbe":{"tcpSocket":{"port":"amqp"},"initialDelaySeconds":10,"timeoutSeconds":5,"periodSeconds":10,"successThreshold":1,"failureThreshold":3},"lifecycle":{"preStop":{"exec":{"command":["/bin/bash","-c","if [ ! -z \"$(cat /etc/pod-info/skipPreStopChecks)\" ]; then exit 0; fi; rabbitmq-upgrade await_online_quorum_plus_one -t 604800; rabbitmq-upgrade await_online_synchronized_mirror -t 604800; rabbitmq-upgrade drain -t 604800"]}}},"terminationMessagePath":"/dev/termination-log","terminationMessagePolicy":"File","imagePullPolicy":"IfNotPresent"}],"restartPolicy":"Always","terminationGracePeriodSeconds":604800,"dnsPolicy":"ClusterFirst","serviceAccountName":"rabbitmq-cluster-server","serviceAccount":"rabbitmq-cluster-server","automountServiceAccountToken":true,"securityContext":{"runAsUser":999,"runAsGroup":999,"fsGroup":999},"schedulerName":"default-scheduler","topologySpreadConstraints":[{"maxSkew":1,"topologyKey":"topology.kubernetes.io/zone","whenUnsatisfiable":"ScheduleAnyway","labelSelector":{"matchLabels":{"app.kubernetes.io/name":"rabbitmq-cluster"}}}]}},"volumeClaimTemplates":[{"metadata":{"name":"persistence","namespace":"default","creationTimestamp":null,"labels":{"app.kubernetes.io/component":"rabbitmq","app.kubernetes.io/name":"rabbitmq-cluster","app.kubernetes.io/part-of":"rabbitmq"},"ownerReferences":[{"apiVersion":"rabbitmq.com/v1beta1","kind":"RabbitmqCluster","name":"rabbitmq-cluster","uid":"3ecefa8a-1bec-48a7-9af4-dd0df3339101","controller":true,"blockOwnerDeletion":false}]},"spec":{"accessModes":["ReadWriteOnce"],"resources":{"requests":{"storage":"15Gi"}},"volumeMode":"Filesystem"},"status":{"phase":"Pending"}}],"serviceName":"rabbitmq-cluster-nodes","podManagementPolicy":"Parallel","updateStrategy":{"type":"RollingUpdate","rollingUpdate":{"partition":0}},"revisionHistoryLimit":10},"status":{"observedGeneration":1,"replicas":1,"readyReplicas":1,"currentReplicas":1,"updatedReplicas":1,"currentRevision":"rabbitmq-cluster-server-5f8b8665fb","updateRevision":"rabbitmq-cluster-server-5f8b8665fb","collisionCount":0}}
2022/03/18 18:07:35 learn_server.go:291: [SIEVE-AFTER-READ]	Get	true	configmap	default	rabbitmq-cluster-plugins-conf	github.com/rabbitmq/cluster-operator/controllers.(*RabbitmqClusterReconciler)	NoError	{"kind":"ConfigMap","apiVersion":"v1","metadata":{"name":"rabbitmq-cluster-plugins-conf","namespace":"default","selfLink":"/api/v1/namespaces/default/configmaps/rabbitmq-cluster-plugins-conf","uid":"0aa26eb6-ff3a-4457-a223-284c897db7fe","resourceVersion":"1092","creationTimestamp":"2022-03-18T18:06:25Z","labels":{"app.kubernetes.io/component":"rabbitmq","app.kubernetes.io/name":"rabbitmq-cluster","app.kubernetes.io/part-of":"rabbitmq"},"ownerReferences":[{"apiVersion":"rabbitmq.com/v1beta1","kind":"RabbitmqCluster","name":"rabbitmq-cluster","uid":"3ecefa8a-1bec-48a7-9af4-dd0df3339101","controller":true,"blockOwnerDeletion":true}],"managedFields":[{"manager":"manager","operation":"Update","apiVersion":"v1","time":"2022-03-18T18:06:25Z","fieldsType":"FieldsV1","fieldsV1":{"f:data":{".":{},"f:enabled_plugins":{}},"f:metadata":{"f:labels":{".":{},"f:app.kubernetes.io/component":{},"f:app.kubernetes.io/name":{},"f:app.kubernetes.io/part-of":{}},"f:ownerReferences":{".":{},"k:{\"uid\":\"3ecefa8a-1bec-48a7-9af4-dd0df3339101\"}":{".":{},"f:apiVersion":{},"f:blockOwnerDeletion":{},"f:controller":{},"f:kind":{},"f:name":{},"f:uid":{}}}}}}]},"data":{"enabled_plugins":"[rabbitmq_peer_discovery_k8s,rabbitmq_prometheus,rabbitmq_management]."}}
2022/03/18 18:07:35 learn_server.go:256: [SIEVE-BEFORE-WRITE]	54
2022/03/18 18:07:35 learn_server.go:263: [SIEVE-AFTER-WRITE]	54	StatusUpdate	rabbitmqcluster	github.com/rabbitmq/cluster-operator/controllers.(*RabbitmqClusterReconciler)	NoError	{"metadata":{"name":"rabbitmq-cluster","namespace":"default","selfLink":"/apis/rabbitmq.com/v1beta1/namespaces/default/rabbitmqclusters/rabbitmq-cluster/status","uid":"3ecefa8a-1bec-48a7-9af4-dd0df3339101","resourceVersion":"1482","generation":3,"creationTimestamp":"2022-03-18T18:06:25Z","annotations":{"kubectl.kubernetes.io/last-applied-configuration":"{\"apiVersion\":\"rabbitmq.com/v1beta1\",\"kind\":\"RabbitmqCluster\",\"metadata\":{\"annotations\":{},\"name\":\"rabbitmq-cluster\",\"namespace\":\"default\"},\"spec\":{\"persistence\":{\"storage\":\"10Gi\"},\"replicas\":1}}\n"},"finalizers":["deletion.finalizers.rabbitmqclusters.rabbitmq.com"],"managedFields":[{"manager":"kubectl-client-side-apply","operation":"Update","apiVersion":"rabbitmq.com/v1beta1","time":"2022-03-18T18:06:25Z","fieldsType":"FieldsV1","fieldsV1":{"f:metadata":{"f:annotations":{".":{},"f:kubectl.kubernetes.io/last-applied-configuration":{}}},"f:spec":{".":{},"f:image":{},"f:persistence":{},"f:replicas":{},"f:resources":{".":{},"f:limits":{".":{},"f:memory":{}},"f:requests":{".":{},"f:memory":{}}},"f:service":{".":{},"f:type":{}},"f:terminationGracePeriodSeconds":{}}}},{"manager":"kubectl-patch","operation":"Update","apiVersion":"rabbitmq.com/v1beta1","time":"2022-03-18T18:07:31Z","fieldsType":"FieldsV1","fieldsV1":{"f:spec":{"f:persistence":{"f:storage":{}}}}},{"manager":"manager","operation":"Update","apiVersion":"rabbitmq.com/v1beta1","time":"2022-03-18T18:07:35Z","fieldsType":"FieldsV1","fieldsV1":{"f:metadata":{"f:finalizers":{}},"f:spec":{"f:override":{},"f:rabbitmq":{},"f:resources":{"f:limits":{"f:cpu":{}},"f:requests":{"f:cpu":{}}},"f:tls":{}},"f:status":{".":{},"f:conditions":{},"f:defaultUser":{".":{},"f:secretReference":{".":{},"f:keys":{".":{},"f:password":{},"f:username":{}},"f:name":{},"f:namespace":{}},"f:serviceReference":{".":{},"f:name":{},"f:namespace":{}}}}}}]},"spec":{"replicas":1,"image":"rabbitmq:3.8.12-management","service":{"type":"ClusterIP"},"persistence":{"storage":"15Gi"},"resources":{"limits":{"cpu":"2","memory":"2Gi"},"requests":{"cpu":"1","memory":"2Gi"}},"rabbitmq":{},"tls":{},"override":{},"terminationGracePeriodSeconds":604800},"status":{"conditions":[{"type":"AllReplicasReady","status":"True","lastTransitionTime":"2022-03-18T18:07:35Z","reason":"AllPodsAreReady"},{"type":"ClusterAvailable","status":"True","lastTransitionTime":"2022-03-18T18:07:23Z","reason":"AtLeastOneEndpointAvailable"},{"type":"NoWarnings","status":"True","lastTransitionTime":"2022-03-18T18:06:25Z","reason":"NoWarnings"},{"type":"ReconcileSuccess","status":"True","lastTransitionTime":"2022-03-18T18:07:24Z","reason":"Success","message":"Finish reconciling"}],"defaultUser":{"secretReference":{"name":"rabbitmq-cluster-default-user","namespace":"default","keys":{"password":"password","username":"username"}},"serviceReference":{"name":"rabbitmq-cluster","namespace":"default"}},"binding":{"name":"rabbitmq-cluster-default-user"}}}
2022/03/18 18:07:35 learn_server.go:253: [SIEVE-AFTER-RECONCILE]	github.com/rabbitmq/cluster-operator/controllers.(*RabbitmqClusterReconciler)	12
2022/03/18 18:07:49 learn_server.go:238: [SIEVE-BEFORE-RECONCILE]	github.com/rabbitmq/cluster-operator/controllers.(*RabbitmqClusterReconciler)	13
2022/03/18 18:07:49 learn_server.go:291: [SIEVE-AFTER-READ]	Get	true	rabbitmqcluster	default	rabbitmq-cluster	github.com/rabbitmq/cluster-operator/controllers.(*RabbitmqClusterReconciler)	NoError	{"kind":"RabbitmqCluster","apiVersion":"rabbitmq.com/v1beta1","metadata":{"name":"rabbitmq-cluster","namespace":"default","selfLink":"/apis/rabbitmq.com/v1beta1/namespaces/default/rabbitmqclusters/rabbitmq-cluster","uid":"3ecefa8a-1bec-48a7-9af4-dd0df3339101","resourceVersion":"1482","generation":3,"creationTimestamp":"2022-03-18T18:06:25Z","annotations":{"kubectl.kubernetes.io/last-applied-configuration":"{\"apiVersion\":\"rabbitmq.com/v1beta1\",\"kind\":\"RabbitmqCluster\",\"metadata\":{\"annotations\":{},\"name\":\"rabbitmq-cluster\",\"namespace\":\"default\"},\"spec\":{\"persistence\":{\"storage\":\"10Gi\"},\"replicas\":1}}\n"},"finalizers":["deletion.finalizers.rabbitmqclusters.rabbitmq.com"],"managedFields":[{"manager":"kubectl-client-side-apply","operation":"Update","apiVersion":"rabbitmq.com/v1beta1","time":"2022-03-18T18:06:25Z","fieldsType":"FieldsV1","fieldsV1":{"f:metadata":{"f:annotations":{".":{},"f:kubectl.kubernetes.io/last-applied-configuration":{}}},"f:spec":{".":{},"f:image":{},"f:persistence":{},"f:replicas":{},"f:resources":{".":{},"f:limits":{".":{},"f:memory":{}},"f:requests":{".":{},"f:memory":{}}},"f:service":{".":{},"f:type":{}},"f:terminationGracePeriodSeconds":{}}}},{"manager":"kubectl-patch","operation":"Update","apiVersion":"rabbitmq.com/v1beta1","time":"2022-03-18T18:07:31Z","fieldsType":"FieldsV1","fieldsV1":{"f:spec":{"f:persistence":{"f:storage":{}}}}},{"manager":"manager","operation":"Update","apiVersion":"rabbitmq.com/v1beta1","time":"2022-03-18T18:07:35Z","fieldsType":"FieldsV1","fieldsV1":{"f:metadata":{"f:finalizers":{}},"f:spec":{"f:override":{},"f:rabbitmq":{},"f:resources":{"f:limits":{"f:cpu":{}},"f:requests":{"f:cpu":{}}},"f:tls":{}},"f:status":{".":{},"f:conditions":{},"f:defaultUser":{".":{},"f:secretReference":{".":{},"f:keys":{".":{},"f:password":{},"f:username":{}},"f:name":{},"f:namespace":{}},"f:serviceReference":{".":{},"f:name":{},"f:namespace":{}}}}}}]},"spec":{"replicas":1,"image":"rabbitmq:3.8.12-management","service":{"type":"ClusterIP"},"persistence":{"storage":"15Gi"},"resources":{"limits":{"cpu":"2","memory":"2Gi"},"requests":{"cpu":"1","memory":"2Gi"}},"rabbitmq":{},"tls":{},"override":{},"terminationGracePeriodSeconds":604800},"status":{"conditions":[{"type":"AllReplicasReady","status":"True","lastTransitionTime":"2022-03-18T18:07:35Z","reason":"AllPodsAreReady"},{"type":"ClusterAvailable","status":"True","lastTransitionTime":"2022-03-18T18:07:23Z","reason":"AtLeastOneEndpointAvailable"},{"type":"NoWarnings","status":"True","lastTransitionTime":"2022-03-18T18:06:25Z","reason":"NoWarnings"},{"type":"ReconcileSuccess","status":"True","lastTransitionTime":"2022-03-18T18:07:24Z","reason":"Success","message":"Finish reconciling"}],"defaultUser":{"secretReference":{"name":"rabbitmq-cluster-default-user","namespace":"default","keys":{"password":"password","username":"username"}},"serviceReference":{"name":"rabbitmq-cluster","namespace":"default"}}}}
2022/03/18 18:07:49 learn_server.go:291: [SIEVE-AFTER-READ]	Get	true	statefulset	default	rabbitmq-cluster-server	github.com/rabbitmq/cluster-operator/controllers.(*RabbitmqClusterReconciler)	NoError	{"kind":"StatefulSet","apiVersion":"apps/v1","metadata":{"name":"rabbitmq-cluster-server","namespace":"default","selfLink":"/apis/apps/v1/namespaces/default/statefulsets/rabbitmq-cluster-server","uid":"1d62d993-2c32-4da7-8884-e4cfad9e587d","resourceVersion":"1481","generation":1,"creationTimestamp":"2022-03-18T18:07:34Z","labels":{"app.kubernetes.io/component":"rabbitmq","app.kubernetes.io/name":"rabbitmq-cluster","app.kubernetes.io/part-of":"rabbitmq"},"ownerReferences":[{"apiVersion":"rabbitmq.com/v1beta1","kind":"RabbitmqCluster","name":"rabbitmq-cluster","uid":"3ecefa8a-1bec-48a7-9af4-dd0df3339101","controller":true,"blockOwnerDeletion":true}],"managedFields":[{"manager":"kube-controller-manager","operation":"Update","apiVersion":"apps/v1","time":"2022-03-18T18:07:34Z","fieldsType":"FieldsV1","fieldsV1":{"f:status":{"f:collisionCount":{},"f:currentReplicas":{},"f:currentRevision":{},"f:observedGeneration":{},"f:readyReplicas":{},"f:replicas":{},"f:updateRevision":{},"f:updatedReplicas":{}}}},{"manager":"manager","operation":"Update","apiVersion":"apps/v1","time":"2022-03-18T18:07:34Z","fieldsType":"FieldsV1","fieldsV1":{"f:metadata":{"f:labels":{".":{},"f:app.kubernetes.io/component":{},"f:app.kubernetes.io/name":{},"f:app.kubernetes.io/part-of":{}},"f:ownerReferences":{".":{},"k:{\"uid\":\"3ecefa8a-1bec-48a7-9af4-dd0df3339101\"}":{".":{},"f:apiVersion":{},"f:blockOwnerDeletion":{},"f:controller":{},"f:kind":{},"f:name":{},"f:uid":{}}}},"f:spec":{"f:podManagementPolicy":{},"f:replicas":{},"f:revisionHistoryLimit":{},"f:selector":{"f:matchLabels":{".":{},"f:app.kubernetes.io/name":{}}},"f:serviceName":{},"f:template":{"f:metadata":{"f:annotations":{".":{},"f:prometheus.io/port":{},"f:prometheus.io/scrape":{}},"f:labels":{".":{},"f:app.kubernetes.io/component":{},"f:app.kubernetes.io/name":{},"f:app.kubernetes.io/part-of":{}}},"f:spec":{"f:automountServiceAccountToken":{},"f:containers":{"k:{\"name\":\"rabbitmq\"}":{".":{},"f:env":{".":{},"k:{\"name\":\"K8S_HOSTNAME_SUFFIX\"}":{".":{},"f:name":{},"f:value":{}},"k:{\"name\":\"K8S_SERVICE_NAME\"}":{".":{},"f:name":{},"f:value":{}},"k:{\"name\":\"MY_POD_NAME\"}":{".":{},"f:name":{},"f:valueFrom":{".":{},"f:fieldRef":{".":{},"f:apiVersion":{},"f:fieldPath":{}}}},"k:{\"name\":\"MY_POD_NAMESPACE\"}":{".":{},"f:name":{},"f:valueFrom":{".":{},"f:fieldRef":{".":{},"f:apiVersion":{},"f:fieldPath":{}}}},"k:{\"name\":\"RABBITMQ_ENABLED_PLUGINS_FILE\"}":{".":{},"f:name":{},"f:value":{}},"k:{\"name\":\"RABBITMQ_NODENAME\"}":{".":{},"f:name":{},"f:value":{}},"k:{\"name\":\"RABBITMQ_USE_LONGNAME\"}":{".":{},"f:name":{},"f:value":{}}},"f:image":{},"f:imagePullPolicy":{},"f:lifecycle":{".":{},"f:preStop":{".":{},"f:exec":{".":{},"f:command":{}}}},"f:name":{},"f:ports":{".":{},"k:{\"containerPort\":4369,\"protocol\":\"TCP\"}":{".":{},"f:containerPort":{},"f:name":{},"f:protocol":{}},"k:{\"containerPort\":5672,\"protocol\":\"TCP\"}":{".":{},"f:containerPort":{},"f:name":{},"f:protocol":{}},"k:{\"containerPort\":15672,\"protocol\":\"TCP\"}":{".":{},"f:containerPort":{},"f:name":{},"f:protocol":{}},"k:{\"containerPort\":15692,\"protocol\":\"TCP\"}":{".":{},"f:containerPort":{},"f:name":{},"f:protocol":{}}},"f:readinessProbe":{".":{},"f:failureThreshold":{},"f:initialDelaySeconds":{},"f:periodSeconds":{},"f:successThreshold":{},"f:tcpSocket":{".":{},"f:port":{}},"f:timeoutSeconds":{}},"f:resources":{".":{},"f:limits":{".":{},"f:cpu":{},"f:memory":{}},"f:requests":{".":{},"f:cpu":{},"f:memory":{}}},"f:terminationMessagePath":{},"f:terminationMessagePolicy":{},"f:volumeMounts":{".":{},"k:{\"mountPath\":\"/etc/pod-info/\"}":{".":{},"f:mountPath":{},"f:name":{}},"k:{\"mountPath\":\"/etc/rabbitmq/conf.d/10-operatorDefaults.conf\"}":{".":{},"f:mountPath":{},"f:name":{},"f:subPath":{}},"k:{\"mountPath\":\"/etc/rabbitmq/conf.d/11-default_user.conf\"}":{".":{},"f:mountPath":{},"f:name":{},"f:subPath":{}},"k:{\"mountPath\":\"/etc/rabbitmq/conf.d/90-userDefinedConfiguration.conf\"}":{".":{},"f:mountPath":{},"f:name":{},"f:subPath":{}},"k:{\"mountPath\":\"/operator\"}":{".":{},"f:mountPath":{},"f:name":{}},"k:{\"mountPath\":\"/var/lib/rabbitmq/\"}":{".":{},"f:mountPath":{},"f:name":{}},"k:{\"mountPath\":\"/var/lib/rabbitmq/mnesia/\"}":{".":{},"f:mountPath":{},"f:name":{}}}}},"f:dnsPolicy":{},"f:initContainers":{".":{},"k:{\"name\":\"setup-container\"}":{".":{},"f:command":{},"f:image":{},"f:imagePullPolicy":{},"f:name":{},"f:resources":{".":{},"f:limits":{".":{},"f:cpu":{},"f:memory":{}},"f:requests":{".":{},"f:cpu":{},"f:memory":{}}},"f:securityContext":{".":{},"f:capabilities":{".":{},"f:drop":{}},"f:runAsUser":{}},"f:terminationMessagePath":{},"f:terminationMessagePolicy":{},"f:volumeMounts":{".":{},"k:{\"mountPath\":\"/operator\"}":{".":{},"f:mountPath":{},"f:name":{}},"k:{\"mountPath\":\"/tmp/default_user.conf\"}":{".":{},"f:mountPath":{},"f:name":{},"f:subPath":{}},"k:{\"mountPath\":\"/tmp/erlang-cookie-secret/\"}":{".":{},"f:mountPath":{},"f:name":{}},"k:{\"mountPath\":\"/tmp/rabbitmq-plugins/\"}":{".":{},"f:mountPath":{},"f:name":{}},"k:{\"mountPath\":\"/var/lib/rabbitmq/\"}":{".":{},"f:mountPath":{},"f:name":{}},"k:{\"mountPath\":\"/var/lib/rabbitmq/mnesia/\"}":{".":{},"f:mountPath":{},"f:name":{}}}}},"f:restartPolicy":{},"f:schedulerName":{},"f:securityContext":{".":{},"f:fsGroup":{},"f:runAsGroup":{},"f:runAsUser":{}},"f:serviceAccount":{},"f:serviceAccountName":{},"f:terminationGracePeriodSeconds":{},"f:topologySpreadConstraints":{".":{},"k:{\"topologyKey\":\"topology.kubernetes.io/zone\",\"whenUnsatisfiable\":\"ScheduleAnyway\"}":{".":{},"f:labelSelector":{".":{},"f:matchLabels":{".":{},"f:app.kubernetes.io/name":{}}},"f:maxSkew":{},"f:topologyKey":{},"f:whenUnsatisfiable":{}}},"f:volumes":{".":{},"k:{\"name\":\"erlang-cookie-secret\"}":{".":{},"f:name":{},"f:secret":{".":{},"f:defaultMode":{},"f:secretName":{}}},"k:{\"name\":\"plugins-conf\"}":{".":{},"f:configMap":{".":{},"f:defaultMode":{},"f:name":{}},"f:name":{}},"k:{\"name\":\"pod-info\"}":{".":{},"f:downwardAPI":{".":{},"f:defaultMode":{},"f:items":{}},"f:name":{}},"k:{\"name\":\"rabbitmq-confd\"}":{".":{},"f:name":{},"f:projected":{".":{},"f:defaultMode":{},"f:sources":{}}},"k:{\"name\":\"rabbitmq-erlang-cookie\"}":{".":{},"f:emptyDir":{},"f:name":{}},"k:{\"name\":\"rabbitmq-plugins\"}":{".":{},"f:emptyDir":{},"f:name":{}}}}},"f:updateStrategy":{"f:rollingUpdate":{".":{},"f:partition":{}},"f:type":{}},"f:volumeClaimTemplates":{}}}}]},"spec":{"replicas":1,"selector":{"matchLabels":{"app.kubernetes.io/name":"rabbitmq-cluster"}},"template":{"metadata":{"creationTimestamp":null,"labels":{"app.kubernetes.io/component":"rabbitmq","app.kubernetes.io/name":"rabbitmq-cluster","app.kubernetes.io/part-of":"rabbitmq"},"annotations":{"prometheus.io/port":"15692","prometheus.io/scrape":"true"}},"spec":{"volumes":[{"name":"plugins-conf","configMap":{"name":"rabbitmq-cluster-plugins-conf","defaultMode":420}},{"name":"rabbitmq-confd","projected":{"sources":[{"secret":{"name":"rabbitmq-cluster-default-user","items":[{"key":"default_user.conf","path":"default_user.conf"}]}},{"configMap":{"name":"rabbitmq-cluster-server-conf","items":[{"key":"operatorDefaults.conf","path":"operatorDefaults.conf"},{"key":"userDefinedConfiguration.conf","path":"userDefinedConfiguration.conf"}]}}],"defaultMode":420}},{"name":"rabbitmq-erlang-cookie","emptyDir":{}},{"name":"erlang-cookie-secret","secret":{"secretName":"rabbitmq-cluster-erlang-cookie","defaultMode":420}},{"name":"rabbitmq-plugins","emptyDir":{}},{"name":"pod-info","downwardAPI":{"items":[{"path":"skipPreStopChecks","fieldRef":{"apiVersion":"v1","fieldPath":"metadata.labels['skipPreStopChecks']"}}],"defaultMode":420}}],"initContainers":[{"name":"setup-container","image":"rabbitmq:3.8.12-management","command":["sh","-c","cp /tmp/erlang-cookie-secret/.erlang.cookie /var/lib/rabbitmq/.erlang.cookie \u0026\u0026 chown 999:999 /var/lib/rabbitmq/.erlang.cookie \u0026\u0026 chmod 600 /var/lib/rabbitmq/.erlang.cookie ; cp /tmp/rabbitmq-plugins/enabled_plugins /operator/enabled_plugins \u0026\u0026 chown 999:999 /operator/enabled_plugins ; chown 999:999 /var/lib/rabbitmq/mnesia/ ; echo '[default]' \u003e /var/lib/rabbitmq/.rabbitmqadmin.conf \u0026\u0026 sed -e 's/default_user/username/' -e 's/default_pass/password/' /tmp/default_user.conf \u003e\u003e /var/lib/rabbitmq/.rabbitmqadmin.conf \u0026\u0026 chown 999:999 /var/lib/rabbitmq/.rabbitmqadmin.conf \u0026\u0026 chmod 600 /var/lib/rabbitmq/.rabbitmqadmin.conf"],"resources":{"limits":{"cpu":"100m","memory":"500Mi"},"requests":{"cpu":"100m","memory":"500Mi"}},"volumeMounts":[{"name":"plugins-conf","mountPath":"/tmp/rabbitmq-plugins/"},{"name":"rabbitmq-erlang-cookie","mountPath":"/var/lib/rabbitmq/"},{"name":"erlang-cookie-secret","mountPath":"/tmp/erlang-cookie-secret/"},{"name":"rabbitmq-plugins","mountPath":"/operator"},{"name":"persistence","mountPath":"/var/lib/rabbitmq/mnesia/"},{"name":"rabbitmq-confd","mountPath":"/tmp/default_user.conf","subPath":"default_user.conf"}],"terminationMessagePath":"/dev/termination-log","terminationMessagePolicy":"File","imagePullPolicy":"IfNotPresent","securityContext":{"capabilities":{"drop":["FSETID","KILL","SETGID","SETUID","SETPCAP","NET_BIND_SERVICE","NET_RAW","SYS_CHROOT","MKNOD","AUDIT_WRITE","SETFCAP"]},"runAsUser":0}}],"containers":[{"name":"rabbitmq","image":"rabbitmq:3.8.12-management","ports":[{"name":"epmd","containerPort":4369,"protocol":"TCP"},{"name":"amqp","containerPort":5672,"protocol":"TCP"},{"name":"management","containerPort":15672,"protocol":"TCP"},{"name":"prometheus","containerPort":15692,"protocol":"TCP"}],"env":[{"name":"MY_POD_NAME","valueFrom":{"fieldRef":{"apiVersion":"v1","fieldPath":"metadata.name"}}},{"name":"MY_POD_NAMESPACE","valueFrom":{"fieldRef":{"apiVersion":"v1","fieldPath":"metadata.namespace"}}},{"name":"RABBITMQ_ENABLED_PLUGINS_FILE","value":"/operator/enabled_plugins"},{"name":"K8S_SERVICE_NAME","value":"rabbitmq-cluster-nodes"},{"name":"RABBITMQ_USE_LONGNAME","value":"true"},{"name":"RABBITMQ_NODENAME","value":"rabbit@$(MY_POD_NAME).$(K8S_SERVICE_NAME).$(MY_POD_NAMESPACE)"},{"name":"K8S_HOSTNAME_SUFFIX","value":".$(K8S_SERVICE_NAME).$(MY_POD_NAMESPACE)"}],"resources":{"limits":{"cpu":"2","memory":"2Gi"},"requests":{"cpu":"1","memory":"2Gi"}},"volumeMounts":[{"name":"rabbitmq-erlang-cookie","mountPath":"/var/lib/rabbitmq/"},{"name":"persistence","mountPath":"/var/lib/rabbitmq/mnesia/"},{"name":"rabbitmq-plugins","mountPath":"/operator"},{"name":"rabbitmq-confd","mountPath":"/etc/rabbitmq/conf.d/10-operatorDefaults.conf","subPath":"operatorDefaults.conf"},{"name":"rabbitmq-confd","mountPath":"/etc/rabbitmq/conf.d/11-default_user.conf","subPath":"default_user.conf"},{"name":"rabbitmq-confd","mountPath":"/etc/rabbitmq/conf.d/90-userDefinedConfiguration.conf","subPath":"userDefinedConfiguration.conf"},{"name":"pod-info","mountPath":"/etc/pod-info/"}],"readinessProbe":{"tcpSocket":{"port":"amqp"},"initialDelaySeconds":10,"timeoutSeconds":5,"periodSeconds":10,"successThreshold":1,"failureThreshold":3},"lifecycle":{"preStop":{"exec":{"command":["/bin/bash","-c","if [ ! -z \"$(cat /etc/pod-info/skipPreStopChecks)\" ]; then exit 0; fi; rabbitmq-upgrade await_online_quorum_plus_one -t 604800; rabbitmq-upgrade await_online_synchronized_mirror -t 604800; rabbitmq-upgrade drain -t 604800"]}}},"terminationMessagePath":"/dev/termination-log","terminationMessagePolicy":"File","imagePullPolicy":"IfNotPresent"}],"restartPolicy":"Always","terminationGracePeriodSeconds":604800,"dnsPolicy":"ClusterFirst","serviceAccountName":"rabbitmq-cluster-server","serviceAccount":"rabbitmq-cluster-server","automountServiceAccountToken":true,"securityContext":{"runAsUser":999,"runAsGroup":999,"fsGroup":999},"schedulerName":"default-scheduler","topologySpreadConstraints":[{"maxSkew":1,"topologyKey":"topology.kubernetes.io/zone","whenUnsatisfiable":"ScheduleAnyway","labelSelector":{"matchLabels":{"app.kubernetes.io/name":"rabbitmq-cluster"}}}]}},"volumeClaimTemplates":[{"metadata":{"name":"persistence","namespace":"default","creationTimestamp":null,"labels":{"app.kubernetes.io/component":"rabbitmq","app.kubernetes.io/name":"rabbitmq-cluster","app.kubernetes.io/part-of":"rabbitmq"},"ownerReferences":[{"apiVersion":"rabbitmq.com/v1beta1","kind":"RabbitmqCluster","name":"rabbitmq-cluster","uid":"3ecefa8a-1bec-48a7-9af4-dd0df3339101","controller":true,"blockOwnerDeletion":false}]},"spec":{"accessModes":["ReadWriteOnce"],"resources":{"requests":{"storage":"15Gi"}},"volumeMode":"Filesystem"},"status":{"phase":"Pending"}}],"serviceName":"rabbitmq-cluster-nodes","podManagementPolicy":"Parallel","updateStrategy":{"type":"RollingUpdate","rollingUpdate":{"partition":0}},"revisionHistoryLimit":10},"status":{"observedGeneration":1,"replicas":1,"readyReplicas":1,"currentReplicas":1,"updatedReplicas":1,"currentRevision":"rabbitmq-cluster-server-5f8b8665fb","updateRevision":"rabbitmq-cluster-server-5f8b8665fb","collisionCount":0}}
2022/03/18 18:07:49 learn_server.go:291: [SIEVE-AFTER-READ]	Get	true	endpoints	default	rabbitmq-cluster	github.com/rabbitmq/cluster-operator/controllers.(*RabbitmqClusterReconciler)	NoError	{"kind":"Endpoints","apiVersion":"v1","metadata":{"name":"rabbitmq-cluster","namespace":"default","selfLink":"/api/v1/namespaces/default/endpoints/rabbitmq-cluster","uid":"eeba9576-0362-4e74-aafd-71e4ffe98d25","resourceVersion":"1402","creationTimestamp":"2022-03-18T18:06:25Z","labels":{"app.kubernetes.io/component":"rabbitmq","app.kubernetes.io/name":"rabbitmq-cluster","app.kubernetes.io/part-of":"rabbitmq"},"annotations":{"endpoints.kubernetes.io/last-change-trigger-time":"2022-03-18T18:07:23Z"},"managedFields":[{"manager":"kube-controller-manager","operation":"Update","apiVersion":"v1","time":"2022-03-18T18:07:23Z","fieldsType":"FieldsV1","fieldsV1":{"f:metadata":{"f:annotations":{".":{},"f:endpoints.kubernetes.io/last-change-trigger-time":{}},"f:labels":{".":{},"f:app.kubernetes.io/component":{},"f:app.kubernetes.io/name":{},"f:app.kubernetes.io/part-of":{}}},"f:subsets":{}}}]},"subsets":[{"addresses":[{"ip":"10.244.1.4","nodeName":"kind-worker","targetRef":{"kind":"Pod","namespace":"default","name":"rabbitmq-cluster-server-0","uid":"cbaba199-5faf-480a-81e8-051ce2cc79e6","resourceVersion":"1399"}}],"ports":[{"name":"amqp","port":5672,"protocol":"TCP"},{"name":"management","port":15672,"protocol":"TCP"}]}]}
2022/03/18 18:07:49 learn_server.go:291: [SIEVE-AFTER-READ]	Get	true	statefulset	default	rabbitmq-cluster-server	github.com/rabbitmq/cluster-operator/controllers.(*RabbitmqClusterReconciler)	NoError	{"kind":"StatefulSet","apiVersion":"apps/v1","metadata":{"name":"rabbitmq-cluster-server","namespace":"default","selfLink":"/apis/apps/v1/namespaces/default/statefulsets/rabbitmq-cluster-server","uid":"1d62d993-2c32-4da7-8884-e4cfad9e587d","resourceVersion":"1481","generation":1,"creationTimestamp":"2022-03-18T18:07:34Z","labels":{"app.kubernetes.io/component":"rabbitmq","app.kubernetes.io/name":"rabbitmq-cluster","app.kubernetes.io/part-of":"rabbitmq"},"ownerReferences":[{"apiVersion":"rabbitmq.com/v1beta1","kind":"RabbitmqCluster","name":"rabbitmq-cluster","uid":"3ecefa8a-1bec-48a7-9af4-dd0df3339101","controller":true,"blockOwnerDeletion":true}],"managedFields":[{"manager":"kube-controller-manager","operation":"Update","apiVersion":"apps/v1","time":"2022-03-18T18:07:34Z","fieldsType":"FieldsV1","fieldsV1":{"f:status":{"f:collisionCount":{},"f:currentReplicas":{},"f:currentRevision":{},"f:observedGeneration":{},"f:readyReplicas":{},"f:replicas":{},"f:updateRevision":{},"f:updatedReplicas":{}}}},{"manager":"manager","operation":"Update","apiVersion":"apps/v1","time":"2022-03-18T18:07:34Z","fieldsType":"FieldsV1","fieldsV1":{"f:metadata":{"f:labels":{".":{},"f:app.kubernetes.io/component":{},"f:app.kubernetes.io/name":{},"f:app.kubernetes.io/part-of":{}},"f:ownerReferences":{".":{},"k:{\"uid\":\"3ecefa8a-1bec-48a7-9af4-dd0df3339101\"}":{".":{},"f:apiVersion":{},"f:blockOwnerDeletion":{},"f:controller":{},"f:kind":{},"f:name":{},"f:uid":{}}}},"f:spec":{"f:podManagementPolicy":{},"f:replicas":{},"f:revisionHistoryLimit":{},"f:selector":{"f:matchLabels":{".":{},"f:app.kubernetes.io/name":{}}},"f:serviceName":{},"f:template":{"f:metadata":{"f:annotations":{".":{},"f:prometheus.io/port":{},"f:prometheus.io/scrape":{}},"f:labels":{".":{},"f:app.kubernetes.io/component":{},"f:app.kubernetes.io/name":{},"f:app.kubernetes.io/part-of":{}}},"f:spec":{"f:automountServiceAccountToken":{},"f:containers":{"k:{\"name\":\"rabbitmq\"}":{".":{},"f:env":{".":{},"k:{\"name\":\"K8S_HOSTNAME_SUFFIX\"}":{".":{},"f:name":{},"f:value":{}},"k:{\"name\":\"K8S_SERVICE_NAME\"}":{".":{},"f:name":{},"f:value":{}},"k:{\"name\":\"MY_POD_NAME\"}":{".":{},"f:name":{},"f:valueFrom":{".":{},"f:fieldRef":{".":{},"f:apiVersion":{},"f:fieldPath":{}}}},"k:{\"name\":\"MY_POD_NAMESPACE\"}":{".":{},"f:name":{},"f:valueFrom":{".":{},"f:fieldRef":{".":{},"f:apiVersion":{},"f:fieldPath":{}}}},"k:{\"name\":\"RABBITMQ_ENABLED_PLUGINS_FILE\"}":{".":{},"f:name":{},"f:value":{}},"k:{\"name\":\"RABBITMQ_NODENAME\"}":{".":{},"f:name":{},"f:value":{}},"k:{\"name\":\"RABBITMQ_USE_LONGNAME\"}":{".":{},"f:name":{},"f:value":{}}},"f:image":{},"f:imagePullPolicy":{},"f:lifecycle":{".":{},"f:preStop":{".":{},"f:exec":{".":{},"f:command":{}}}},"f:name":{},"f:ports":{".":{},"k:{\"containerPort\":4369,\"protocol\":\"TCP\"}":{".":{},"f:containerPort":{},"f:name":{},"f:protocol":{}},"k:{\"containerPort\":5672,\"protocol\":\"TCP\"}":{".":{},"f:containerPort":{},"f:name":{},"f:protocol":{}},"k:{\"containerPort\":15672,\"protocol\":\"TCP\"}":{".":{},"f:containerPort":{},"f:name":{},"f:protocol":{}},"k:{\"containerPort\":15692,\"protocol\":\"TCP\"}":{".":{},"f:containerPort":{},"f:name":{},"f:protocol":{}}},"f:readinessProbe":{".":{},"f:failureThreshold":{},"f:initialDelaySeconds":{},"f:periodSeconds":{},"f:successThreshold":{},"f:tcpSocket":{".":{},"f:port":{}},"f:timeoutSeconds":{}},"f:resources":{".":{},"f:limits":{".":{},"f:cpu":{},"f:memory":{}},"f:requests":{".":{},"f:cpu":{},"f:memory":{}}},"f:terminationMessagePath":{},"f:terminationMessagePolicy":{},"f:volumeMounts":{".":{},"k:{\"mountPath\":\"/etc/pod-info/\"}":{".":{},"f:mountPath":{},"f:name":{}},"k:{\"mountPath\":\"/etc/rabbitmq/conf.d/10-operatorDefaults.conf\"}":{".":{},"f:mountPath":{},"f:name":{},"f:subPath":{}},"k:{\"mountPath\":\"/etc/rabbitmq/conf.d/11-default_user.conf\"}":{".":{},"f:mountPath":{},"f:name":{},"f:subPath":{}},"k:{\"mountPath\":\"/etc/rabbitmq/conf.d/90-userDefinedConfiguration.conf\"}":{".":{},"f:mountPath":{},"f:name":{},"f:subPath":{}},"k:{\"mountPath\":\"/operator\"}":{".":{},"f:mountPath":{},"f:name":{}},"k:{\"mountPath\":\"/var/lib/rabbitmq/\"}":{".":{},"f:mountPath":{},"f:name":{}},"k:{\"mountPath\":\"/var/lib/rabbitmq/mnesia/\"}":{".":{},"f:mountPath":{},"f:name":{}}}}},"f:dnsPolicy":{},"f:initContainers":{".":{},"k:{\"name\":\"setup-container\"}":{".":{},"f:command":{},"f:image":{},"f:imagePullPolicy":{},"f:name":{},"f:resources":{".":{},"f:limits":{".":{},"f:cpu":{},"f:memory":{}},"f:requests":{".":{},"f:cpu":{},"f:memory":{}}},"f:securityContext":{".":{},"f:capabilities":{".":{},"f:drop":{}},"f:runAsUser":{}},"f:terminationMessagePath":{},"f:terminationMessagePolicy":{},"f:volumeMounts":{".":{},"k:{\"mountPath\":\"/operator\"}":{".":{},"f:mountPath":{},"f:name":{}},"k:{\"mountPath\":\"/tmp/default_user.conf\"}":{".":{},"f:mountPath":{},"f:name":{},"f:subPath":{}},"k:{\"mountPath\":\"/tmp/erlang-cookie-secret/\"}":{".":{},"f:mountPath":{},"f:name":{}},"k:{\"mountPath\":\"/tmp/rabbitmq-plugins/\"}":{".":{},"f:mountPath":{},"f:name":{}},"k:{\"mountPath\":\"/var/lib/rabbitmq/\"}":{".":{},"f:mountPath":{},"f:name":{}},"k:{\"mountPath\":\"/var/lib/rabbitmq/mnesia/\"}":{".":{},"f:mountPath":{},"f:name":{}}}}},"f:restartPolicy":{},"f:schedulerName":{},"f:securityContext":{".":{},"f:fsGroup":{},"f:runAsGroup":{},"f:runAsUser":{}},"f:serviceAccount":{},"f:serviceAccountName":{},"f:terminationGracePeriodSeconds":{},"f:topologySpreadConstraints":{".":{},"k:{\"topologyKey\":\"topology.kubernetes.io/zone\",\"whenUnsatisfiable\":\"ScheduleAnyway\"}":{".":{},"f:labelSelector":{".":{},"f:matchLabels":{".":{},"f:app.kubernetes.io/name":{}}},"f:maxSkew":{},"f:topologyKey":{},"f:whenUnsatisfiable":{}}},"f:volumes":{".":{},"k:{\"name\":\"erlang-cookie-secret\"}":{".":{},"f:name":{},"f:secret":{".":{},"f:defaultMode":{},"f:secretName":{}}},"k:{\"name\":\"plugins-conf\"}":{".":{},"f:configMap":{".":{},"f:defaultMode":{},"f:name":{}},"f:name":{}},"k:{\"name\":\"pod-info\"}":{".":{},"f:downwardAPI":{".":{},"f:defaultMode":{},"f:items":{}},"f:name":{}},"k:{\"name\":\"rabbitmq-confd\"}":{".":{},"f:name":{},"f:projected":{".":{},"f:defaultMode":{},"f:sources":{}}},"k:{\"name\":\"rabbitmq-erlang-cookie\"}":{".":{},"f:emptyDir":{},"f:name":{}},"k:{\"name\":\"rabbitmq-plugins\"}":{".":{},"f:emptyDir":{},"f:name":{}}}}},"f:updateStrategy":{"f:rollingUpdate":{".":{},"f:partition":{}},"f:type":{}},"f:volumeClaimTemplates":{}}}}]},"spec":{"replicas":1,"selector":{"matchLabels":{"app.kubernetes.io/name":"rabbitmq-cluster"}},"template":{"metadata":{"creationTimestamp":null,"labels":{"app.kubernetes.io/component":"rabbitmq","app.kubernetes.io/name":"rabbitmq-cluster","app.kubernetes.io/part-of":"rabbitmq"},"annotations":{"prometheus.io/port":"15692","prometheus.io/scrape":"true"}},"spec":{"volumes":[{"name":"plugins-conf","configMap":{"name":"rabbitmq-cluster-plugins-conf","defaultMode":420}},{"name":"rabbitmq-confd","projected":{"sources":[{"secret":{"name":"rabbitmq-cluster-default-user","items":[{"key":"default_user.conf","path":"default_user.conf"}]}},{"configMap":{"name":"rabbitmq-cluster-server-conf","items":[{"key":"operatorDefaults.conf","path":"operatorDefaults.conf"},{"key":"userDefinedConfiguration.conf","path":"userDefinedConfiguration.conf"}]}}],"defaultMode":420}},{"name":"rabbitmq-erlang-cookie","emptyDir":{}},{"name":"erlang-cookie-secret","secret":{"secretName":"rabbitmq-cluster-erlang-cookie","defaultMode":420}},{"name":"rabbitmq-plugins","emptyDir":{}},{"name":"pod-info","downwardAPI":{"items":[{"path":"skipPreStopChecks","fieldRef":{"apiVersion":"v1","fieldPath":"metadata.labels['skipPreStopChecks']"}}],"defaultMode":420}}],"initContainers":[{"name":"setup-container","image":"rabbitmq:3.8.12-management","command":["sh","-c","cp /tmp/erlang-cookie-secret/.erlang.cookie /var/lib/rabbitmq/.erlang.cookie \u0026\u0026 chown 999:999 /var/lib/rabbitmq/.erlang.cookie \u0026\u0026 chmod 600 /var/lib/rabbitmq/.erlang.cookie ; cp /tmp/rabbitmq-plugins/enabled_plugins /operator/enabled_plugins \u0026\u0026 chown 999:999 /operator/enabled_plugins ; chown 999:999 /var/lib/rabbitmq/mnesia/ ; echo '[default]' \u003e /var/lib/rabbitmq/.rabbitmqadmin.conf \u0026\u0026 sed -e 's/default_user/username/' -e 's/default_pass/password/' /tmp/default_user.conf \u003e\u003e /var/lib/rabbitmq/.rabbitmqadmin.conf \u0026\u0026 chown 999:999 /var/lib/rabbitmq/.rabbitmqadmin.conf \u0026\u0026 chmod 600 /var/lib/rabbitmq/.rabbitmqadmin.conf"],"resources":{"limits":{"cpu":"100m","memory":"500Mi"},"requests":{"cpu":"100m","memory":"500Mi"}},"volumeMounts":[{"name":"plugins-conf","mountPath":"/tmp/rabbitmq-plugins/"},{"name":"rabbitmq-erlang-cookie","mountPath":"/var/lib/rabbitmq/"},{"name":"erlang-cookie-secret","mountPath":"/tmp/erlang-cookie-secret/"},{"name":"rabbitmq-plugins","mountPath":"/operator"},{"name":"persistence","mountPath":"/var/lib/rabbitmq/mnesia/"},{"name":"rabbitmq-confd","mountPath":"/tmp/default_user.conf","subPath":"default_user.conf"}],"terminationMessagePath":"/dev/termination-log","terminationMessagePolicy":"File","imagePullPolicy":"IfNotPresent","securityContext":{"capabilities":{"drop":["FSETID","KILL","SETGID","SETUID","SETPCAP","NET_BIND_SERVICE","NET_RAW","SYS_CHROOT","MKNOD","AUDIT_WRITE","SETFCAP"]},"runAsUser":0}}],"containers":[{"name":"rabbitmq","image":"rabbitmq:3.8.12-management","ports":[{"name":"epmd","containerPort":4369,"protocol":"TCP"},{"name":"amqp","containerPort":5672,"protocol":"TCP"},{"name":"management","containerPort":15672,"protocol":"TCP"},{"name":"prometheus","containerPort":15692,"protocol":"TCP"}],"env":[{"name":"MY_POD_NAME","valueFrom":{"fieldRef":{"apiVersion":"v1","fieldPath":"metadata.name"}}},{"name":"MY_POD_NAMESPACE","valueFrom":{"fieldRef":{"apiVersion":"v1","fieldPath":"metadata.namespace"}}},{"name":"RABBITMQ_ENABLED_PLUGINS_FILE","value":"/operator/enabled_plugins"},{"name":"K8S_SERVICE_NAME","value":"rabbitmq-cluster-nodes"},{"name":"RABBITMQ_USE_LONGNAME","value":"true"},{"name":"RABBITMQ_NODENAME","value":"rabbit@$(MY_POD_NAME).$(K8S_SERVICE_NAME).$(MY_POD_NAMESPACE)"},{"name":"K8S_HOSTNAME_SUFFIX","value":".$(K8S_SERVICE_NAME).$(MY_POD_NAMESPACE)"}],"resources":{"limits":{"cpu":"2","memory":"2Gi"},"requests":{"cpu":"1","memory":"2Gi"}},"volumeMounts":[{"name":"rabbitmq-erlang-cookie","mountPath":"/var/lib/rabbitmq/"},{"name":"persistence","mountPath":"/var/lib/rabbitmq/mnesia/"},{"name":"rabbitmq-plugins","mountPath":"/operator"},{"name":"rabbitmq-confd","mountPath":"/etc/rabbitmq/conf.d/10-operatorDefaults.conf","subPath":"operatorDefaults.conf"},{"name":"rabbitmq-confd","mountPath":"/etc/rabbitmq/conf.d/11-default_user.conf","subPath":"default_user.conf"},{"name":"rabbitmq-confd","mountPath":"/etc/rabbitmq/conf.d/90-userDefinedConfiguration.conf","subPath":"userDefinedConfiguration.conf"},{"name":"pod-info","mountPath":"/etc/pod-info/"}],"readinessProbe":{"tcpSocket":{"port":"amqp"},"initialDelaySeconds":10,"timeoutSeconds":5,"periodSeconds":10,"successThreshold":1,"failureThreshold":3},"lifecycle":{"preStop":{"exec":{"command":["/bin/bash","-c","if [ ! -z \"$(cat /etc/pod-info/skipPreStopChecks)\" ]; then exit 0; fi; rabbitmq-upgrade await_online_quorum_plus_one -t 604800; rabbitmq-upgrade await_online_synchronized_mirror -t 604800; rabbitmq-upgrade drain -t 604800"]}}},"terminationMessagePath":"/dev/termination-log","terminationMessagePolicy":"File","imagePullPolicy":"IfNotPresent"}],"restartPolicy":"Always","terminationGracePeriodSeconds":604800,"dnsPolicy":"ClusterFirst","serviceAccountName":"rabbitmq-cluster-server","serviceAccount":"rabbitmq-cluster-server","automountServiceAccountToken":true,"securityContext":{"runAsUser":999,"runAsGroup":999,"fsGroup":999},"schedulerName":"default-scheduler","topologySpreadConstraints":[{"maxSkew":1,"topologyKey":"topology.kubernetes.io/zone","whenUnsatisfiable":"ScheduleAnyway","labelSelector":{"matchLabels":{"app.kubernetes.io/name":"rabbitmq-cluster"}}}]}},"volumeClaimTemplates":[{"metadata":{"name":"persistence","namespace":"default","creationTimestamp":null,"labels":{"app.kubernetes.io/component":"rabbitmq","app.kubernetes.io/name":"rabbitmq-cluster","app.kubernetes.io/part-of":"rabbitmq"},"ownerReferences":[{"apiVersion":"rabbitmq.com/v1beta1","kind":"RabbitmqCluster","name":"rabbitmq-cluster","uid":"3ecefa8a-1bec-48a7-9af4-dd0df3339101","controller":true,"blockOwnerDeletion":false}]},"spec":{"accessModes":["ReadWriteOnce"],"resources":{"requests":{"storage":"15Gi"}},"volumeMode":"Filesystem"},"status":{"phase":"Pending"}}],"serviceName":"rabbitmq-cluster-nodes","podManagementPolicy":"Parallel","updateStrategy":{"type":"RollingUpdate","rollingUpdate":{"partition":0}},"revisionHistoryLimit":10},"status":{"observedGeneration":1,"replicas":1,"readyReplicas":1,"currentReplicas":1,"updatedReplicas":1,"currentRevision":"rabbitmq-cluster-server-5f8b8665fb","updateRevision":"rabbitmq-cluster-server-5f8b8665fb","collisionCount":0}}
2022/03/18 18:07:49 learn_server.go:291: [SIEVE-AFTER-READ]	Get	true	service	default	rabbitmq-cluster-nodes	github.com/rabbitmq/cluster-operator/controllers.(*RabbitmqClusterReconciler)	NoError	{"kind":"Service","apiVersion":"v1","metadata":{"name":"rabbitmq-cluster-nodes","namespace":"default","selfLink":"/api/v1/namespaces/default/services/rabbitmq-cluster-nodes","uid":"f843e1c2-ced0-463d-87c1-0e127aaa2006","resourceVersion":"1080","creationTimestamp":"2022-03-18T18:06:25Z","labels":{"app.kubernetes.io/component":"rabbitmq","app.kubernetes.io/name":"rabbitmq-cluster","app.kubernetes.io/part-of":"rabbitmq"},"ownerReferences":[{"apiVersion":"rabbitmq.com/v1beta1","kind":"RabbitmqCluster","name":"rabbitmq-cluster","uid":"3ecefa8a-1bec-48a7-9af4-dd0df3339101","controller":true,"blockOwnerDeletion":true}],"managedFields":[{"manager":"manager","operation":"Update","apiVersion":"v1","time":"2022-03-18T18:06:25Z","fieldsType":"FieldsV1","fieldsV1":{"f:metadata":{"f:labels":{".":{},"f:app.kubernetes.io/component":{},"f:app.kubernetes.io/name":{},"f:app.kubernetes.io/part-of":{}},"f:ownerReferences":{".":{},"k:{\"uid\":\"3ecefa8a-1bec-48a7-9af4-dd0df3339101\"}":{".":{},"f:apiVersion":{},"f:blockOwnerDeletion":{},"f:controller":{},"f:kind":{},"f:name":{},"f:uid":{}}}},"f:spec":{"f:clusterIP":{},"f:ports":{".":{},"k:{\"port\":4369,\"protocol\":\"TCP\"}":{".":{},"f:name":{},"f:port":{},"f:protocol":{},"f:targetPort":{}},"k:{\"port\":25672,\"protocol\":\"TCP\"}":{".":{},"f:name":{},"f:port":{},"f:protocol":{},"f:targetPort":{}}},"f:publishNotReadyAddresses":{},"f:selector":{".":{},"f:app.kubernetes.io/name":{}},"f:sessionAffinity":{},"f:type":{}}}}]},"spec":{"ports":[{"name":"epmd","protocol":"TCP","port":4369,"targetPort":4369},{"name":"cluster-rpc","protocol":"TCP","port":25672,"targetPort":25672}],"selector":{"app.kubernetes.io/name":"rabbitmq-cluster"},"clusterIP":"None","type":"ClusterIP","sessionAffinity":"None","publishNotReadyAddresses":true},"status":{"loadBalancer":{}}}
2022/03/18 18:07:49 learn_server.go:291: [SIEVE-AFTER-READ]	Get	true	service	default	rabbitmq-cluster	github.com/rabbitmq/cluster-operator/controllers.(*RabbitmqClusterReconciler)	NoError	{"kind":"Service","apiVersion":"v1","metadata":{"name":"rabbitmq-cluster","namespace":"default","selfLink":"/api/v1/namespaces/default/services/rabbitmq-cluster","uid":"ae846a70-784e-49ca-99a0-2b0cefb93b46","resourceVersion":"1085","creationTimestamp":"2022-03-18T18:06:25Z","labels":{"app.kubernetes.io/component":"rabbitmq","app.kubernetes.io/name":"rabbitmq-cluster","app.kubernetes.io/part-of":"rabbitmq"},"ownerReferences":[{"apiVersion":"rabbitmq.com/v1beta1","kind":"RabbitmqCluster","name":"rabbitmq-cluster","uid":"3ecefa8a-1bec-48a7-9af4-dd0df3339101","controller":true,"blockOwnerDeletion":true}],"managedFields":[{"manager":"manager","operation":"Update","apiVersion":"v1","time":"2022-03-18T18:06:25Z","fieldsType":"FieldsV1","fieldsV1":{"f:metadata":{"f:labels":{".":{},"f:app.kubernetes.io/component":{},"f:app.kubernetes.io/name":{},"f:app.kubernetes.io/part-of":{}},"f:ownerReferences":{".":{},"k:{\"uid\":\"3ecefa8a-1bec-48a7-9af4-dd0df3339101\"}":{".":{},"f:apiVersion":{},"f:blockOwnerDeletion":{},"f:controller":{},"f:kind":{},"f:name":{},"f:uid":{}}}},"f:spec":{"f:ports":{".":{},"k:{\"port\":5672,\"protocol\":\"TCP\"}":{".":{},"f:name":{},"f:port":{},"f:protocol":{},"f:targetPort":{}},"k:{\"port\":15672,\"protocol\":\"TCP\"}":{".":{},"f:name":{},"f:port":{},"f:protocol":{},"f:targetPort":{}}},"f:selector":{".":{},"f:app.kubernetes.io/name":{}},"f:sessionAffinity":{},"f:type":{}}}}]},"spec":{"ports":[{"name":"amqp","protocol":"TCP","port":5672,"targetPort":5672},{"name":"management","protocol":"TCP","port":15672,"targetPort":15672}],"selector":{"app.kubernetes.io/name":"rabbitmq-cluster"},"clusterIP":"10.96.47.189","type":"ClusterIP","sessionAffinity":"None"},"status":{"loadBalancer":{}}}
2022/03/18 18:07:49 learn_server.go:291: [SIEVE-AFTER-READ]	Get	true	secret	default	rabbitmq-cluster-erlang-cookie	github.com/rabbitmq/cluster-operator/controllers.(*RabbitmqClusterReconciler)	NoError	{"kind":"Secret","apiVersion":"v1","metadata":{"name":"rabbitmq-cluster-erlang-cookie","namespace":"default","selfLink":"/api/v1/namespaces/default/secrets/rabbitmq-cluster-erlang-cookie","uid":"01d8d8ad-080a-4c3f-9d27-56616c53dd26","resourceVersion":"1088","creationTimestamp":"2022-03-18T18:06:25Z","labels":{"app.kubernetes.io/component":"rabbitmq","app.kubernetes.io/name":"rabbitmq-cluster","app.kubernetes.io/part-of":"rabbitmq"},"ownerReferences":[{"apiVersion":"rabbitmq.com/v1beta1","kind":"RabbitmqCluster","name":"rabbitmq-cluster","uid":"3ecefa8a-1bec-48a7-9af4-dd0df3339101","controller":true,"blockOwnerDeletion":true}],"managedFields":[{"manager":"manager","operation":"Update","apiVersion":"v1","time":"2022-03-18T18:06:25Z","fieldsType":"FieldsV1","fieldsV1":{"f:data":{".":{},"f:.erlang.cookie":{}},"f:metadata":{"f:labels":{".":{},"f:app.kubernetes.io/component":{},"f:app.kubernetes.io/name":{},"f:app.kubernetes.io/part-of":{}},"f:ownerReferences":{".":{},"k:{\"uid\":\"3ecefa8a-1bec-48a7-9af4-dd0df3339101\"}":{".":{},"f:apiVersion":{},"f:blockOwnerDeletion":{},"f:controller":{},"f:kind":{},"f:name":{},"f:uid":{}}}},"f:type":{}}}]},"data":{".erlang.cookie":"ajdscUtLdnBpR1NwUUMwc1V3a2VyTlJxU2tVUTdBeEw="},"type":"Opaque"}
2022/03/18 18:07:49 learn_server.go:291: [SIEVE-AFTER-READ]	Get	true	secret	default	rabbitmq-cluster-default-user	github.com/rabbitmq/cluster-operator/controllers.(*RabbitmqClusterReconciler)	NoError	{"kind":"Secret","apiVersion":"v1","metadata":{"name":"rabbitmq-cluster-default-user","namespace":"default","selfLink":"/api/v1/namespaces/default/secrets/rabbitmq-cluster-default-user","uid":"b2f5a936-e51f-4488-b6e9-ca23e4d95ac2","resourceVersion":"1091","creationTimestamp":"2022-03-18T18:06:25Z","labels":{"app.kubernetes.io/component":"rabbitmq","app.kubernetes.io/name":"rabbitmq-cluster","app.kubernetes.io/part-of":"rabbitmq"},"ownerReferences":[{"apiVersion":"rabbitmq.com/v1beta1","kind":"RabbitmqCluster","name":"rabbitmq-cluster","uid":"3ecefa8a-1bec-48a7-9af4-dd0df3339101","controller":true,"blockOwnerDeletion":true}],"managedFields":[{"manager":"manager","operation":"Update","apiVersion":"v1","time":"2022-03-18T18:06:25Z","fieldsType":"FieldsV1","fieldsV1":{"f:data":{".":{},"f:default_user.conf":{},"f:password":{},"f:provider":{},"f:type":{},"f:username":{}},"f:metadata":{"f:labels":{".":{},"f:app.kubernetes.io/component":{},"f:app.kubernetes.io/name":{},"f:app.kubernetes.io/part-of":{}},"f:ownerReferences":{".":{},"k:{\"uid\":\"3ecefa8a-1bec-48a7-9af4-dd0df3339101\"}":{".":{},"f:apiVersion":{},"f:blockOwnerDeletion":{},"f:controller":{},"f:kind":{},"f:name":{},"f:uid":{}}}},"f:type":{}}}]},"data":{"default_user.conf":"ZGVmYXVsdF91c2VyID0gdEFMN1otZTgzR29ocEtsZ0Z4cUFFV3ZXemEtcjdJQW8KZGVmYXVsdF9wYXNzID0gdXVocndkTkdOcmJXQ2p6NFZPX0NUZE9OYURkSUpoRkoK","password":"dXVocndkTkdOcmJXQ2p6NFZPX0NUZE9OYURkSUpoRko=","provider":"cmFiYml0bXE=","type":"cmFiYml0bXE=","username":"dEFMN1otZTgzR29ocEtsZ0Z4cUFFV3ZXemEtcjdJQW8="},"type":"Opaque"}
2022/03/18 18:07:49 learn_server.go:291: [SIEVE-AFTER-READ]	Get	true	configmap	default	rabbitmq-cluster-plugins-conf	github.com/rabbitmq/cluster-operator/controllers.(*RabbitmqClusterReconciler)	NoError	{"kind":"ConfigMap","apiVersion":"v1","metadata":{"name":"rabbitmq-cluster-plugins-conf","namespace":"default","selfLink":"/api/v1/namespaces/default/configmaps/rabbitmq-cluster-plugins-conf","uid":"0aa26eb6-ff3a-4457-a223-284c897db7fe","resourceVersion":"1092","creationTimestamp":"2022-03-18T18:06:25Z","labels":{"app.kubernetes.io/component":"rabbitmq","app.kubernetes.io/name":"rabbitmq-cluster","app.kubernetes.io/part-of":"rabbitmq"},"ownerReferences":[{"apiVersion":"rabbitmq.com/v1beta1","kind":"RabbitmqCluster","name":"rabbitmq-cluster","uid":"3ecefa8a-1bec-48a7-9af4-dd0df3339101","controller":true,"blockOwnerDeletion":true}],"managedFields":[{"manager":"manager","operation":"Update","apiVersion":"v1","time":"2022-03-18T18:06:25Z","fieldsType":"FieldsV1","fieldsV1":{"f:data":{".":{},"f:enabled_plugins":{}},"f:metadata":{"f:labels":{".":{},"f:app.kubernetes.io/component":{},"f:app.kubernetes.io/name":{},"f:app.kubernetes.io/part-of":{}},"f:ownerReferences":{".":{},"k:{\"uid\":\"3ecefa8a-1bec-48a7-9af4-dd0df3339101\"}":{".":{},"f:apiVersion":{},"f:blockOwnerDeletion":{},"f:controller":{},"f:kind":{},"f:name":{},"f:uid":{}}}}}}]},"data":{"enabled_plugins":"[rabbitmq_peer_discovery_k8s,rabbitmq_prometheus,rabbitmq_management]."}}
2022/03/18 18:07:49 learn_server.go:291: [SIEVE-AFTER-READ]	Get	true	configmap	default	rabbitmq-cluster-server-conf	github.com/rabbitmq/cluster-operator/controllers.(*RabbitmqClusterReconciler)	NoError	{"kind":"ConfigMap","apiVersion":"v1","metadata":{"name":"rabbitmq-cluster-server-conf","namespace":"default","selfLink":"/api/v1/namespaces/default/configmaps/rabbitmq-cluster-server-conf","uid":"e4182078-d429-4baf-9021-72618c509ac5","resourceVersion":"1095","creationTimestamp":"2022-03-18T18:06:25Z","labels":{"app.kubernetes.io/component":"rabbitmq","app.kubernetes.io/name":"rabbitmq-cluster","app.kubernetes.io/part-of":"rabbitmq"},"ownerReferences":[{"apiVersion":"rabbitmq.com/v1beta1","kind":"RabbitmqCluster","name":"rabbitmq-cluster","uid":"3ecefa8a-1bec-48a7-9af4-dd0df3339101","controller":true,"blockOwnerDeletion":true}],"managedFields":[{"manager":"manager","operation":"Update","apiVersion":"v1","time":"2022-03-18T18:06:25Z","fieldsType":"FieldsV1","fieldsV1":{"f:data":{".":{},"f:operatorDefaults.conf":{},"f:userDefinedConfiguration.conf":{}},"f:metadata":{"f:labels":{".":{},"f:app.kubernetes.io/component":{},"f:app.kubernetes.io/name":{},"f:app.kubernetes.io/part-of":{}},"f:ownerReferences":{".":{},"k:{\"uid\":\"3ecefa8a-1bec-48a7-9af4-dd0df3339101\"}":{".":{},"f:apiVersion":{},"f:blockOwnerDeletion":{},"f:controller":{},"f:kind":{},"f:name":{},"f:uid":{}}}}}}]},"data":{"operatorDefaults.conf":"cluster_formation.peer_discovery_backend             = rabbit_peer_discovery_k8s\ncluster_formation.k8s.host                           = kubernetes.default\ncluster_formation.k8s.address_type                   = hostname\ncluster_partition_handling                           = pause_minority\nqueue_master_locator                                 = min-masters\ndisk_free_limit.absolute                             = 2GB\ncluster_formation.randomized_startup_delay_range.min = 5\ncluster_formation.randomized_startup_delay_range.max = 30\ncluster_name                                         = rabbitmq-cluster\n","userDefinedConfiguration.conf":"total_memory_available_override_value = 1717986919\n"}}
2022/03/18 18:07:49 learn_server.go:291: [SIEVE-AFTER-READ]	Get	true	serviceaccount	default	rabbitmq-cluster-server	github.com/rabbitmq/cluster-operator/controllers.(*RabbitmqClusterReconciler)	NoError	{"kind":"ServiceAccount","apiVersion":"v1","metadata":{"name":"rabbitmq-cluster-server","namespace":"default","selfLink":"/api/v1/namespaces/default/serviceaccounts/rabbitmq-cluster-server","uid":"0c3cead0-37dd-452b-b939-fe346a5dfdea","resourceVersion":"1102","creationTimestamp":"2022-03-18T18:06:25Z","labels":{"app.kubernetes.io/component":"rabbitmq","app.kubernetes.io/name":"rabbitmq-cluster","app.kubernetes.io/part-of":"rabbitmq"},"ownerReferences":[{"apiVersion":"rabbitmq.com/v1beta1","kind":"RabbitmqCluster","name":"rabbitmq-cluster","uid":"3ecefa8a-1bec-48a7-9af4-dd0df3339101","controller":true,"blockOwnerDeletion":true}],"managedFields":[{"manager":"kube-controller-manager","operation":"Update","apiVersion":"v1","time":"2022-03-18T18:06:25Z","fieldsType":"FieldsV1","fieldsV1":{"f:secrets":{".":{},"k:{\"name\":\"rabbitmq-cluster-server-token-v4wpv\"}":{".":{},"f:name":{}}}}},{"manager":"manager","operation":"Update","apiVersion":"v1","time":"2022-03-18T18:06:25Z","fieldsType":"FieldsV1","fieldsV1":{"f:metadata":{"f:labels":{".":{},"f:app.kubernetes.io/component":{},"f:app.kubernetes.io/name":{},"f:app.kubernetes.io/part-of":{}},"f:ownerReferences":{".":{},"k:{\"uid\":\"3ecefa8a-1bec-48a7-9af4-dd0df3339101\"}":{".":{},"f:apiVersion":{},"f:blockOwnerDeletion":{},"f:controller":{},"f:kind":{},"f:name":{},"f:uid":{}}}}}}]},"secrets":[{"name":"rabbitmq-cluster-server-token-v4wpv"}]}
2022/03/18 18:07:49 learn_server.go:291: [SIEVE-AFTER-READ]	Get	true	role	default	rabbitmq-cluster-peer-discovery	github.com/rabbitmq/cluster-operator/controllers.(*RabbitmqClusterReconciler)	NoError	{"kind":"Role","apiVersion":"rbac.authorization.k8s.io/v1","metadata":{"name":"rabbitmq-cluster-peer-discovery","namespace":"default","selfLink":"/apis/rbac.authorization.k8s.io/v1/namespaces/default/roles/rabbitmq-cluster-peer-discovery","uid":"ec9ac474-1880-43ed-af46-9ea5f46d6db4","resourceVersion":"1103","creationTimestamp":"2022-03-18T18:06:25Z","labels":{"app.kubernetes.io/component":"rabbitmq","app.kubernetes.io/name":"rabbitmq-cluster","app.kubernetes.io/part-of":"rabbitmq"},"ownerReferences":[{"apiVersion":"rabbitmq.com/v1beta1","kind":"RabbitmqCluster","name":"rabbitmq-cluster","uid":"3ecefa8a-1bec-48a7-9af4-dd0df3339101","controller":true,"blockOwnerDeletion":true}],"managedFields":[{"manager":"manager","operation":"Update","apiVersion":"rbac.authorization.k8s.io/v1","time":"2022-03-18T18:06:25Z","fieldsType":"FieldsV1","fieldsV1":{"f:metadata":{"f:labels":{".":{},"f:app.kubernetes.io/component":{},"f:app.kubernetes.io/name":{},"f:app.kubernetes.io/part-of":{}},"f:ownerReferences":{".":{},"k:{\"uid\":\"3ecefa8a-1bec-48a7-9af4-dd0df3339101\"}":{".":{},"f:apiVersion":{},"f:blockOwnerDeletion":{},"f:controller":{},"f:kind":{},"f:name":{},"f:uid":{}}}},"f:rules":{}}}]},"rules":[{"verbs":["get"],"apiGroups":[""],"resources":["endpoints"]},{"verbs":["create"],"apiGroups":[""],"resources":["events"]}]}
2022/03/18 18:07:49 learn_server.go:291: [SIEVE-AFTER-READ]	Get	true	rolebinding	default	rabbitmq-cluster-server	github.com/rabbitmq/cluster-operator/controllers.(*RabbitmqClusterReconciler)	NoError	{"kind":"RoleBinding","apiVersion":"rbac.authorization.k8s.io/v1","metadata":{"name":"rabbitmq-cluster-server","namespace":"default","selfLink":"/apis/rbac.authorization.k8s.io/v1/namespaces/default/rolebindings/rabbitmq-cluster-server","uid":"fe69a41c-8d28-4b84-a9f6-a9e6044d75ba","resourceVersion":"1105","creationTimestamp":"2022-03-18T18:06:25Z","labels":{"app.kubernetes.io/component":"rabbitmq","app.kubernetes.io/name":"rabbitmq-cluster","app.kubernetes.io/part-of":"rabbitmq"},"ownerReferences":[{"apiVersion":"rabbitmq.com/v1beta1","kind":"RabbitmqCluster","name":"rabbitmq-cluster","uid":"3ecefa8a-1bec-48a7-9af4-dd0df3339101","controller":true,"blockOwnerDeletion":true}],"managedFields":[{"manager":"manager","operation":"Update","apiVersion":"rbac.authorization.k8s.io/v1","time":"2022-03-18T18:06:25Z","fieldsType":"FieldsV1","fieldsV1":{"f:metadata":{"f:labels":{".":{},"f:app.kubernetes.io/component":{},"f:app.kubernetes.io/name":{},"f:app.kubernetes.io/part-of":{}},"f:ownerReferences":{".":{},"k:{\"uid\":\"3ecefa8a-1bec-48a7-9af4-dd0df3339101\"}":{".":{},"f:apiVersion":{},"f:blockOwnerDeletion":{},"f:controller":{},"f:kind":{},"f:name":{},"f:uid":{}}}},"f:roleRef":{"f:apiGroup":{},"f:kind":{},"f:name":{}},"f:subjects":{}}}]},"subjects":[{"kind":"ServiceAccount","name":"rabbitmq-cluster-server"}],"roleRef":{"apiGroup":"rbac.authorization.k8s.io","kind":"Role","name":"rabbitmq-cluster-peer-discovery"}}
2022/03/18 18:07:49 learn_server.go:291: [SIEVE-AFTER-READ]	Get	true	statefulset	default	rabbitmq-cluster-server	github.com/rabbitmq/cluster-operator/controllers.(*RabbitmqClusterReconciler)	NoError	{"kind":"StatefulSet","apiVersion":"apps/v1","metadata":{"name":"rabbitmq-cluster-server","namespace":"default","selfLink":"/apis/apps/v1/namespaces/default/statefulsets/rabbitmq-cluster-server","uid":"1d62d993-2c32-4da7-8884-e4cfad9e587d","resourceVersion":"1481","generation":1,"creationTimestamp":"2022-03-18T18:07:34Z","labels":{"app.kubernetes.io/component":"rabbitmq","app.kubernetes.io/name":"rabbitmq-cluster","app.kubernetes.io/part-of":"rabbitmq"},"ownerReferences":[{"apiVersion":"rabbitmq.com/v1beta1","kind":"RabbitmqCluster","name":"rabbitmq-cluster","uid":"3ecefa8a-1bec-48a7-9af4-dd0df3339101","controller":true,"blockOwnerDeletion":true}],"managedFields":[{"manager":"kube-controller-manager","operation":"Update","apiVersion":"apps/v1","time":"2022-03-18T18:07:34Z","fieldsType":"FieldsV1","fieldsV1":{"f:status":{"f:collisionCount":{},"f:currentReplicas":{},"f:currentRevision":{},"f:observedGeneration":{},"f:readyReplicas":{},"f:replicas":{},"f:updateRevision":{},"f:updatedReplicas":{}}}},{"manager":"manager","operation":"Update","apiVersion":"apps/v1","time":"2022-03-18T18:07:34Z","fieldsType":"FieldsV1","fieldsV1":{"f:metadata":{"f:labels":{".":{},"f:app.kubernetes.io/component":{},"f:app.kubernetes.io/name":{},"f:app.kubernetes.io/part-of":{}},"f:ownerReferences":{".":{},"k:{\"uid\":\"3ecefa8a-1bec-48a7-9af4-dd0df3339101\"}":{".":{},"f:apiVersion":{},"f:blockOwnerDeletion":{},"f:controller":{},"f:kind":{},"f:name":{},"f:uid":{}}}},"f:spec":{"f:podManagementPolicy":{},"f:replicas":{},"f:revisionHistoryLimit":{},"f:selector":{"f:matchLabels":{".":{},"f:app.kubernetes.io/name":{}}},"f:serviceName":{},"f:template":{"f:metadata":{"f:annotations":{".":{},"f:prometheus.io/port":{},"f:prometheus.io/scrape":{}},"f:labels":{".":{},"f:app.kubernetes.io/component":{},"f:app.kubernetes.io/name":{},"f:app.kubernetes.io/part-of":{}}},"f:spec":{"f:automountServiceAccountToken":{},"f:containers":{"k:{\"name\":\"rabbitmq\"}":{".":{},"f:env":{".":{},"k:{\"name\":\"K8S_HOSTNAME_SUFFIX\"}":{".":{},"f:name":{},"f:value":{}},"k:{\"name\":\"K8S_SERVICE_NAME\"}":{".":{},"f:name":{},"f:value":{}},"k:{\"name\":\"MY_POD_NAME\"}":{".":{},"f:name":{},"f:valueFrom":{".":{},"f:fieldRef":{".":{},"f:apiVersion":{},"f:fieldPath":{}}}},"k:{\"name\":\"MY_POD_NAMESPACE\"}":{".":{},"f:name":{},"f:valueFrom":{".":{},"f:fieldRef":{".":{},"f:apiVersion":{},"f:fieldPath":{}}}},"k:{\"name\":\"RABBITMQ_ENABLED_PLUGINS_FILE\"}":{".":{},"f:name":{},"f:value":{}},"k:{\"name\":\"RABBITMQ_NODENAME\"}":{".":{},"f:name":{},"f:value":{}},"k:{\"name\":\"RABBITMQ_USE_LONGNAME\"}":{".":{},"f:name":{},"f:value":{}}},"f:image":{},"f:imagePullPolicy":{},"f:lifecycle":{".":{},"f:preStop":{".":{},"f:exec":{".":{},"f:command":{}}}},"f:name":{},"f:ports":{".":{},"k:{\"containerPort\":4369,\"protocol\":\"TCP\"}":{".":{},"f:containerPort":{},"f:name":{},"f:protocol":{}},"k:{\"containerPort\":5672,\"protocol\":\"TCP\"}":{".":{},"f:containerPort":{},"f:name":{},"f:protocol":{}},"k:{\"containerPort\":15672,\"protocol\":\"TCP\"}":{".":{},"f:containerPort":{},"f:name":{},"f:protocol":{}},"k:{\"containerPort\":15692,\"protocol\":\"TCP\"}":{".":{},"f:containerPort":{},"f:name":{},"f:protocol":{}}},"f:readinessProbe":{".":{},"f:failureThreshold":{},"f:initialDelaySeconds":{},"f:periodSeconds":{},"f:successThreshold":{},"f:tcpSocket":{".":{},"f:port":{}},"f:timeoutSeconds":{}},"f:resources":{".":{},"f:limits":{".":{},"f:cpu":{},"f:memory":{}},"f:requests":{".":{},"f:cpu":{},"f:memory":{}}},"f:terminationMessagePath":{},"f:terminationMessagePolicy":{},"f:volumeMounts":{".":{},"k:{\"mountPath\":\"/etc/pod-info/\"}":{".":{},"f:mountPath":{},"f:name":{}},"k:{\"mountPath\":\"/etc/rabbitmq/conf.d/10-operatorDefaults.conf\"}":{".":{},"f:mountPath":{},"f:name":{},"f:subPath":{}},"k:{\"mountPath\":\"/etc/rabbitmq/conf.d/11-default_user.conf\"}":{".":{},"f:mountPath":{},"f:name":{},"f:subPath":{}},"k:{\"mountPath\":\"/etc/rabbitmq/conf.d/90-userDefinedConfiguration.conf\"}":{".":{},"f:mountPath":{},"f:name":{},"f:subPath":{}},"k:{\"mountPath\":\"/operator\"}":{".":{},"f:mountPath":{},"f:name":{}},"k:{\"mountPath\":\"/var/lib/rabbitmq/\"}":{".":{},"f:mountPath":{},"f:name":{}},"k:{\"mountPath\":\"/var/lib/rabbitmq/mnesia/\"}":{".":{},"f:mountPath":{},"f:name":{}}}}},"f:dnsPolicy":{},"f:initContainers":{".":{},"k:{\"name\":\"setup-container\"}":{".":{},"f:command":{},"f:image":{},"f:imagePullPolicy":{},"f:name":{},"f:resources":{".":{},"f:limits":{".":{},"f:cpu":{},"f:memory":{}},"f:requests":{".":{},"f:cpu":{},"f:memory":{}}},"f:securityContext":{".":{},"f:capabilities":{".":{},"f:drop":{}},"f:runAsUser":{}},"f:terminationMessagePath":{},"f:terminationMessagePolicy":{},"f:volumeMounts":{".":{},"k:{\"mountPath\":\"/operator\"}":{".":{},"f:mountPath":{},"f:name":{}},"k:{\"mountPath\":\"/tmp/default_user.conf\"}":{".":{},"f:mountPath":{},"f:name":{},"f:subPath":{}},"k:{\"mountPath\":\"/tmp/erlang-cookie-secret/\"}":{".":{},"f:mountPath":{},"f:name":{}},"k:{\"mountPath\":\"/tmp/rabbitmq-plugins/\"}":{".":{},"f:mountPath":{},"f:name":{}},"k:{\"mountPath\":\"/var/lib/rabbitmq/\"}":{".":{},"f:mountPath":{},"f:name":{}},"k:{\"mountPath\":\"/var/lib/rabbitmq/mnesia/\"}":{".":{},"f:mountPath":{},"f:name":{}}}}},"f:restartPolicy":{},"f:schedulerName":{},"f:securityContext":{".":{},"f:fsGroup":{},"f:runAsGroup":{},"f:runAsUser":{}},"f:serviceAccount":{},"f:serviceAccountName":{},"f:terminationGracePeriodSeconds":{},"f:topologySpreadConstraints":{".":{},"k:{\"topologyKey\":\"topology.kubernetes.io/zone\",\"whenUnsatisfiable\":\"ScheduleAnyway\"}":{".":{},"f:labelSelector":{".":{},"f:matchLabels":{".":{},"f:app.kubernetes.io/name":{}}},"f:maxSkew":{},"f:topologyKey":{},"f:whenUnsatisfiable":{}}},"f:volumes":{".":{},"k:{\"name\":\"erlang-cookie-secret\"}":{".":{},"f:name":{},"f:secret":{".":{},"f:defaultMode":{},"f:secretName":{}}},"k:{\"name\":\"plugins-conf\"}":{".":{},"f:configMap":{".":{},"f:defaultMode":{},"f:name":{}},"f:name":{}},"k:{\"name\":\"pod-info\"}":{".":{},"f:downwardAPI":{".":{},"f:defaultMode":{},"f:items":{}},"f:name":{}},"k:{\"name\":\"rabbitmq-confd\"}":{".":{},"f:name":{},"f:projected":{".":{},"f:defaultMode":{},"f:sources":{}}},"k:{\"name\":\"rabbitmq-erlang-cookie\"}":{".":{},"f:emptyDir":{},"f:name":{}},"k:{\"name\":\"rabbitmq-plugins\"}":{".":{},"f:emptyDir":{},"f:name":{}}}}},"f:updateStrategy":{"f:rollingUpdate":{".":{},"f:partition":{}},"f:type":{}},"f:volumeClaimTemplates":{}}}}]},"spec":{"replicas":1,"selector":{"matchLabels":{"app.kubernetes.io/name":"rabbitmq-cluster"}},"template":{"metadata":{"creationTimestamp":null,"labels":{"app.kubernetes.io/component":"rabbitmq","app.kubernetes.io/name":"rabbitmq-cluster","app.kubernetes.io/part-of":"rabbitmq"},"annotations":{"prometheus.io/port":"15692","prometheus.io/scrape":"true"}},"spec":{"volumes":[{"name":"plugins-conf","configMap":{"name":"rabbitmq-cluster-plugins-conf","defaultMode":420}},{"name":"rabbitmq-confd","projected":{"sources":[{"secret":{"name":"rabbitmq-cluster-default-user","items":[{"key":"default_user.conf","path":"default_user.conf"}]}},{"configMap":{"name":"rabbitmq-cluster-server-conf","items":[{"key":"operatorDefaults.conf","path":"operatorDefaults.conf"},{"key":"userDefinedConfiguration.conf","path":"userDefinedConfiguration.conf"}]}}],"defaultMode":420}},{"name":"rabbitmq-erlang-cookie","emptyDir":{}},{"name":"erlang-cookie-secret","secret":{"secretName":"rabbitmq-cluster-erlang-cookie","defaultMode":420}},{"name":"rabbitmq-plugins","emptyDir":{}},{"name":"pod-info","downwardAPI":{"items":[{"path":"skipPreStopChecks","fieldRef":{"apiVersion":"v1","fieldPath":"metadata.labels['skipPreStopChecks']"}}],"defaultMode":420}}],"initContainers":[{"name":"setup-container","image":"rabbitmq:3.8.12-management","command":["sh","-c","cp /tmp/erlang-cookie-secret/.erlang.cookie /var/lib/rabbitmq/.erlang.cookie \u0026\u0026 chown 999:999 /var/lib/rabbitmq/.erlang.cookie \u0026\u0026 chmod 600 /var/lib/rabbitmq/.erlang.cookie ; cp /tmp/rabbitmq-plugins/enabled_plugins /operator/enabled_plugins \u0026\u0026 chown 999:999 /operator/enabled_plugins ; chown 999:999 /var/lib/rabbitmq/mnesia/ ; echo '[default]' \u003e /var/lib/rabbitmq/.rabbitmqadmin.conf \u0026\u0026 sed -e 's/default_user/username/' -e 's/default_pass/password/' /tmp/default_user.conf \u003e\u003e /var/lib/rabbitmq/.rabbitmqadmin.conf \u0026\u0026 chown 999:999 /var/lib/rabbitmq/.rabbitmqadmin.conf \u0026\u0026 chmod 600 /var/lib/rabbitmq/.rabbitmqadmin.conf"],"resources":{"limits":{"cpu":"100m","memory":"500Mi"},"requests":{"cpu":"100m","memory":"500Mi"}},"volumeMounts":[{"name":"plugins-conf","mountPath":"/tmp/rabbitmq-plugins/"},{"name":"rabbitmq-erlang-cookie","mountPath":"/var/lib/rabbitmq/"},{"name":"erlang-cookie-secret","mountPath":"/tmp/erlang-cookie-secret/"},{"name":"rabbitmq-plugins","mountPath":"/operator"},{"name":"persistence","mountPath":"/var/lib/rabbitmq/mnesia/"},{"name":"rabbitmq-confd","mountPath":"/tmp/default_user.conf","subPath":"default_user.conf"}],"terminationMessagePath":"/dev/termination-log","terminationMessagePolicy":"File","imagePullPolicy":"IfNotPresent","securityContext":{"capabilities":{"drop":["FSETID","KILL","SETGID","SETUID","SETPCAP","NET_BIND_SERVICE","NET_RAW","SYS_CHROOT","MKNOD","AUDIT_WRITE","SETFCAP"]},"runAsUser":0}}],"containers":[{"name":"rabbitmq","image":"rabbitmq:3.8.12-management","ports":[{"name":"epmd","containerPort":4369,"protocol":"TCP"},{"name":"amqp","containerPort":5672,"protocol":"TCP"},{"name":"management","containerPort":15672,"protocol":"TCP"},{"name":"prometheus","containerPort":15692,"protocol":"TCP"}],"env":[{"name":"MY_POD_NAME","valueFrom":{"fieldRef":{"apiVersion":"v1","fieldPath":"metadata.name"}}},{"name":"MY_POD_NAMESPACE","valueFrom":{"fieldRef":{"apiVersion":"v1","fieldPath":"metadata.namespace"}}},{"name":"RABBITMQ_ENABLED_PLUGINS_FILE","value":"/operator/enabled_plugins"},{"name":"K8S_SERVICE_NAME","value":"rabbitmq-cluster-nodes"},{"name":"RABBITMQ_USE_LONGNAME","value":"true"},{"name":"RABBITMQ_NODENAME","value":"rabbit@$(MY_POD_NAME).$(K8S_SERVICE_NAME).$(MY_POD_NAMESPACE)"},{"name":"K8S_HOSTNAME_SUFFIX","value":".$(K8S_SERVICE_NAME).$(MY_POD_NAMESPACE)"}],"resources":{"limits":{"cpu":"2","memory":"2Gi"},"requests":{"cpu":"1","memory":"2Gi"}},"volumeMounts":[{"name":"rabbitmq-erlang-cookie","mountPath":"/var/lib/rabbitmq/"},{"name":"persistence","mountPath":"/var/lib/rabbitmq/mnesia/"},{"name":"rabbitmq-plugins","mountPath":"/operator"},{"name":"rabbitmq-confd","mountPath":"/etc/rabbitmq/conf.d/10-operatorDefaults.conf","subPath":"operatorDefaults.conf"},{"name":"rabbitmq-confd","mountPath":"/etc/rabbitmq/conf.d/11-default_user.conf","subPath":"default_user.conf"},{"name":"rabbitmq-confd","mountPath":"/etc/rabbitmq/conf.d/90-userDefinedConfiguration.conf","subPath":"userDefinedConfiguration.conf"},{"name":"pod-info","mountPath":"/etc/pod-info/"}],"readinessProbe":{"tcpSocket":{"port":"amqp"},"initialDelaySeconds":10,"timeoutSeconds":5,"periodSeconds":10,"successThreshold":1,"failureThreshold":3},"lifecycle":{"preStop":{"exec":{"command":["/bin/bash","-c","if [ ! -z \"$(cat /etc/pod-info/skipPreStopChecks)\" ]; then exit 0; fi; rabbitmq-upgrade await_online_quorum_plus_one -t 604800; rabbitmq-upgrade await_online_synchronized_mirror -t 604800; rabbitmq-upgrade drain -t 604800"]}}},"terminationMessagePath":"/dev/termination-log","terminationMessagePolicy":"File","imagePullPolicy":"IfNotPresent"}],"restartPolicy":"Always","terminationGracePeriodSeconds":604800,"dnsPolicy":"ClusterFirst","serviceAccountName":"rabbitmq-cluster-server","serviceAccount":"rabbitmq-cluster-server","automountServiceAccountToken":true,"securityContext":{"runAsUser":999,"runAsGroup":999,"fsGroup":999},"schedulerName":"default-scheduler","topologySpreadConstraints":[{"maxSkew":1,"topologyKey":"topology.kubernetes.io/zone","whenUnsatisfiable":"ScheduleAnyway","labelSelector":{"matchLabels":{"app.kubernetes.io/name":"rabbitmq-cluster"}}}]}},"volumeClaimTemplates":[{"metadata":{"name":"persistence","namespace":"default","creationTimestamp":null,"labels":{"app.kubernetes.io/component":"rabbitmq","app.kubernetes.io/name":"rabbitmq-cluster","app.kubernetes.io/part-of":"rabbitmq"},"ownerReferences":[{"apiVersion":"rabbitmq.com/v1beta1","kind":"RabbitmqCluster","name":"rabbitmq-cluster","uid":"3ecefa8a-1bec-48a7-9af4-dd0df3339101","controller":true,"blockOwnerDeletion":false}]},"spec":{"accessModes":["ReadWriteOnce"],"resources":{"requests":{"storage":"15Gi"}},"volumeMode":"Filesystem"},"status":{"phase":"Pending"}}],"serviceName":"rabbitmq-cluster-nodes","podManagementPolicy":"Parallel","updateStrategy":{"type":"RollingUpdate","rollingUpdate":{"partition":0}},"revisionHistoryLimit":10},"status":{"observedGeneration":1,"replicas":1,"readyReplicas":1,"currentReplicas":1,"updatedReplicas":1,"currentRevision":"rabbitmq-cluster-server-5f8b8665fb","updateRevision":"rabbitmq-cluster-server-5f8b8665fb","collisionCount":0}}
2022/03/18 18:07:49 learn_server.go:291: [SIEVE-AFTER-READ]	Get	true	statefulset	default	rabbitmq-cluster-server	github.com/rabbitmq/cluster-operator/controllers.(*RabbitmqClusterReconciler)	NoError	{"kind":"StatefulSet","apiVersion":"apps/v1","metadata":{"name":"rabbitmq-cluster-server","namespace":"default","selfLink":"/apis/apps/v1/namespaces/default/statefulsets/rabbitmq-cluster-server","uid":"1d62d993-2c32-4da7-8884-e4cfad9e587d","resourceVersion":"1481","generation":1,"creationTimestamp":"2022-03-18T18:07:34Z","labels":{"app.kubernetes.io/component":"rabbitmq","app.kubernetes.io/name":"rabbitmq-cluster","app.kubernetes.io/part-of":"rabbitmq"},"ownerReferences":[{"apiVersion":"rabbitmq.com/v1beta1","kind":"RabbitmqCluster","name":"rabbitmq-cluster","uid":"3ecefa8a-1bec-48a7-9af4-dd0df3339101","controller":true,"blockOwnerDeletion":true}],"managedFields":[{"manager":"kube-controller-manager","operation":"Update","apiVersion":"apps/v1","time":"2022-03-18T18:07:34Z","fieldsType":"FieldsV1","fieldsV1":{"f:status":{"f:collisionCount":{},"f:currentReplicas":{},"f:currentRevision":{},"f:observedGeneration":{},"f:readyReplicas":{},"f:replicas":{},"f:updateRevision":{},"f:updatedReplicas":{}}}},{"manager":"manager","operation":"Update","apiVersion":"apps/v1","time":"2022-03-18T18:07:34Z","fieldsType":"FieldsV1","fieldsV1":{"f:metadata":{"f:labels":{".":{},"f:app.kubernetes.io/component":{},"f:app.kubernetes.io/name":{},"f:app.kubernetes.io/part-of":{}},"f:ownerReferences":{".":{},"k:{\"uid\":\"3ecefa8a-1bec-48a7-9af4-dd0df3339101\"}":{".":{},"f:apiVersion":{},"f:blockOwnerDeletion":{},"f:controller":{},"f:kind":{},"f:name":{},"f:uid":{}}}},"f:spec":{"f:podManagementPolicy":{},"f:replicas":{},"f:revisionHistoryLimit":{},"f:selector":{"f:matchLabels":{".":{},"f:app.kubernetes.io/name":{}}},"f:serviceName":{},"f:template":{"f:metadata":{"f:annotations":{".":{},"f:prometheus.io/port":{},"f:prometheus.io/scrape":{}},"f:labels":{".":{},"f:app.kubernetes.io/component":{},"f:app.kubernetes.io/name":{},"f:app.kubernetes.io/part-of":{}}},"f:spec":{"f:automountServiceAccountToken":{},"f:containers":{"k:{\"name\":\"rabbitmq\"}":{".":{},"f:env":{".":{},"k:{\"name\":\"K8S_HOSTNAME_SUFFIX\"}":{".":{},"f:name":{},"f:value":{}},"k:{\"name\":\"K8S_SERVICE_NAME\"}":{".":{},"f:name":{},"f:value":{}},"k:{\"name\":\"MY_POD_NAME\"}":{".":{},"f:name":{},"f:valueFrom":{".":{},"f:fieldRef":{".":{},"f:apiVersion":{},"f:fieldPath":{}}}},"k:{\"name\":\"MY_POD_NAMESPACE\"}":{".":{},"f:name":{},"f:valueFrom":{".":{},"f:fieldRef":{".":{},"f:apiVersion":{},"f:fieldPath":{}}}},"k:{\"name\":\"RABBITMQ_ENABLED_PLUGINS_FILE\"}":{".":{},"f:name":{},"f:value":{}},"k:{\"name\":\"RABBITMQ_NODENAME\"}":{".":{},"f:name":{},"f:value":{}},"k:{\"name\":\"RABBITMQ_USE_LONGNAME\"}":{".":{},"f:name":{},"f:value":{}}},"f:image":{},"f:imagePullPolicy":{},"f:lifecycle":{".":{},"f:preStop":{".":{},"f:exec":{".":{},"f:command":{}}}},"f:name":{},"f:ports":{".":{},"k:{\"containerPort\":4369,\"protocol\":\"TCP\"}":{".":{},"f:containerPort":{},"f:name":{},"f:protocol":{}},"k:{\"containerPort\":5672,\"protocol\":\"TCP\"}":{".":{},"f:containerPort":{},"f:name":{},"f:protocol":{}},"k:{\"containerPort\":15672,\"protocol\":\"TCP\"}":{".":{},"f:containerPort":{},"f:name":{},"f:protocol":{}},"k:{\"containerPort\":15692,\"protocol\":\"TCP\"}":{".":{},"f:containerPort":{},"f:name":{},"f:protocol":{}}},"f:readinessProbe":{".":{},"f:failureThreshold":{},"f:initialDelaySeconds":{},"f:periodSeconds":{},"f:successThreshold":{},"f:tcpSocket":{".":{},"f:port":{}},"f:timeoutSeconds":{}},"f:resources":{".":{},"f:limits":{".":{},"f:cpu":{},"f:memory":{}},"f:requests":{".":{},"f:cpu":{},"f:memory":{}}},"f:terminationMessagePath":{},"f:terminationMessagePolicy":{},"f:volumeMounts":{".":{},"k:{\"mountPath\":\"/etc/pod-info/\"}":{".":{},"f:mountPath":{},"f:name":{}},"k:{\"mountPath\":\"/etc/rabbitmq/conf.d/10-operatorDefaults.conf\"}":{".":{},"f:mountPath":{},"f:name":{},"f:subPath":{}},"k:{\"mountPath\":\"/etc/rabbitmq/conf.d/11-default_user.conf\"}":{".":{},"f:mountPath":{},"f:name":{},"f:subPath":{}},"k:{\"mountPath\":\"/etc/rabbitmq/conf.d/90-userDefinedConfiguration.conf\"}":{".":{},"f:mountPath":{},"f:name":{},"f:subPath":{}},"k:{\"mountPath\":\"/operator\"}":{".":{},"f:mountPath":{},"f:name":{}},"k:{\"mountPath\":\"/var/lib/rabbitmq/\"}":{".":{},"f:mountPath":{},"f:name":{}},"k:{\"mountPath\":\"/var/lib/rabbitmq/mnesia/\"}":{".":{},"f:mountPath":{},"f:name":{}}}}},"f:dnsPolicy":{},"f:initContainers":{".":{},"k:{\"name\":\"setup-container\"}":{".":{},"f:command":{},"f:image":{},"f:imagePullPolicy":{},"f:name":{},"f:resources":{".":{},"f:limits":{".":{},"f:cpu":{},"f:memory":{}},"f:requests":{".":{},"f:cpu":{},"f:memory":{}}},"f:securityContext":{".":{},"f:capabilities":{".":{},"f:drop":{}},"f:runAsUser":{}},"f:terminationMessagePath":{},"f:terminationMessagePolicy":{},"f:volumeMounts":{".":{},"k:{\"mountPath\":\"/operator\"}":{".":{},"f:mountPath":{},"f:name":{}},"k:{\"mountPath\":\"/tmp/default_user.conf\"}":{".":{},"f:mountPath":{},"f:name":{},"f:subPath":{}},"k:{\"mountPath\":\"/tmp/erlang-cookie-secret/\"}":{".":{},"f:mountPath":{},"f:name":{}},"k:{\"mountPath\":\"/tmp/rabbitmq-plugins/\"}":{".":{},"f:mountPath":{},"f:name":{}},"k:{\"mountPath\":\"/var/lib/rabbitmq/\"}":{".":{},"f:mountPath":{},"f:name":{}},"k:{\"mountPath\":\"/var/lib/rabbitmq/mnesia/\"}":{".":{},"f:mountPath":{},"f:name":{}}}}},"f:restartPolicy":{},"f:schedulerName":{},"f:securityContext":{".":{},"f:fsGroup":{},"f:runAsGroup":{},"f:runAsUser":{}},"f:serviceAccount":{},"f:serviceAccountName":{},"f:terminationGracePeriodSeconds":{},"f:topologySpreadConstraints":{".":{},"k:{\"topologyKey\":\"topology.kubernetes.io/zone\",\"whenUnsatisfiable\":\"ScheduleAnyway\"}":{".":{},"f:labelSelector":{".":{},"f:matchLabels":{".":{},"f:app.kubernetes.io/name":{}}},"f:maxSkew":{},"f:topologyKey":{},"f:whenUnsatisfiable":{}}},"f:volumes":{".":{},"k:{\"name\":\"erlang-cookie-secret\"}":{".":{},"f:name":{},"f:secret":{".":{},"f:defaultMode":{},"f:secretName":{}}},"k:{\"name\":\"plugins-conf\"}":{".":{},"f:configMap":{".":{},"f:defaultMode":{},"f:name":{}},"f:name":{}},"k:{\"name\":\"pod-info\"}":{".":{},"f:downwardAPI":{".":{},"f:defaultMode":{},"f:items":{}},"f:name":{}},"k:{\"name\":\"rabbitmq-confd\"}":{".":{},"f:name":{},"f:projected":{".":{},"f:defaultMode":{},"f:sources":{}}},"k:{\"name\":\"rabbitmq-erlang-cookie\"}":{".":{},"f:emptyDir":{},"f:name":{}},"k:{\"name\":\"rabbitmq-plugins\"}":{".":{},"f:emptyDir":{},"f:name":{}}}}},"f:updateStrategy":{"f:rollingUpdate":{".":{},"f:partition":{}},"f:type":{}},"f:volumeClaimTemplates":{}}}}]},"spec":{"replicas":1,"selector":{"matchLabels":{"app.kubernetes.io/name":"rabbitmq-cluster"}},"template":{"metadata":{"creationTimestamp":null,"labels":{"app.kubernetes.io/component":"rabbitmq","app.kubernetes.io/name":"rabbitmq-cluster","app.kubernetes.io/part-of":"rabbitmq"},"annotations":{"prometheus.io/port":"15692","prometheus.io/scrape":"true"}},"spec":{"volumes":[{"name":"plugins-conf","configMap":{"name":"rabbitmq-cluster-plugins-conf","defaultMode":420}},{"name":"rabbitmq-confd","projected":{"sources":[{"secret":{"name":"rabbitmq-cluster-default-user","items":[{"key":"default_user.conf","path":"default_user.conf"}]}},{"configMap":{"name":"rabbitmq-cluster-server-conf","items":[{"key":"operatorDefaults.conf","path":"operatorDefaults.conf"},{"key":"userDefinedConfiguration.conf","path":"userDefinedConfiguration.conf"}]}}],"defaultMode":420}},{"name":"rabbitmq-erlang-cookie","emptyDir":{}},{"name":"erlang-cookie-secret","secret":{"secretName":"rabbitmq-cluster-erlang-cookie","defaultMode":420}},{"name":"rabbitmq-plugins","emptyDir":{}},{"name":"pod-info","downwardAPI":{"items":[{"path":"skipPreStopChecks","fieldRef":{"apiVersion":"v1","fieldPath":"metadata.labels['skipPreStopChecks']"}}],"defaultMode":420}}],"initContainers":[{"name":"setup-container","image":"rabbitmq:3.8.12-management","command":["sh","-c","cp /tmp/erlang-cookie-secret/.erlang.cookie /var/lib/rabbitmq/.erlang.cookie \u0026\u0026 chown 999:999 /var/lib/rabbitmq/.erlang.cookie \u0026\u0026 chmod 600 /var/lib/rabbitmq/.erlang.cookie ; cp /tmp/rabbitmq-plugins/enabled_plugins /operator/enabled_plugins \u0026\u0026 chown 999:999 /operator/enabled_plugins ; chown 999:999 /var/lib/rabbitmq/mnesia/ ; echo '[default]' \u003e /var/lib/rabbitmq/.rabbitmqadmin.conf \u0026\u0026 sed -e 's/default_user/username/' -e 's/default_pass/password/' /tmp/default_user.conf \u003e\u003e /var/lib/rabbitmq/.rabbitmqadmin.conf \u0026\u0026 chown 999:999 /var/lib/rabbitmq/.rabbitmqadmin.conf \u0026\u0026 chmod 600 /var/lib/rabbitmq/.rabbitmqadmin.conf"],"resources":{"limits":{"cpu":"100m","memory":"500Mi"},"requests":{"cpu":"100m","memory":"500Mi"}},"volumeMounts":[{"name":"plugins-conf","mountPath":"/tmp/rabbitmq-plugins/"},{"name":"rabbitmq-erlang-cookie","mountPath":"/var/lib/rabbitmq/"},{"name":"erlang-cookie-secret","mountPath":"/tmp/erlang-cookie-secret/"},{"name":"rabbitmq-plugins","mountPath":"/operator"},{"name":"persistence","mountPath":"/var/lib/rabbitmq/mnesia/"},{"name":"rabbitmq-confd","mountPath":"/tmp/default_user.conf","subPath":"default_user.conf"}],"terminationMessagePath":"/dev/termination-log","terminationMessagePolicy":"File","imagePullPolicy":"IfNotPresent","securityContext":{"capabilities":{"drop":["FSETID","KILL","SETGID","SETUID","SETPCAP","NET_BIND_SERVICE","NET_RAW","SYS_CHROOT","MKNOD","AUDIT_WRITE","SETFCAP"]},"runAsUser":0}}],"containers":[{"name":"rabbitmq","image":"rabbitmq:3.8.12-management","ports":[{"name":"epmd","containerPort":4369,"protocol":"TCP"},{"name":"amqp","containerPort":5672,"protocol":"TCP"},{"name":"management","containerPort":15672,"protocol":"TCP"},{"name":"prometheus","containerPort":15692,"protocol":"TCP"}],"env":[{"name":"MY_POD_NAME","valueFrom":{"fieldRef":{"apiVersion":"v1","fieldPath":"metadata.name"}}},{"name":"MY_POD_NAMESPACE","valueFrom":{"fieldRef":{"apiVersion":"v1","fieldPath":"metadata.namespace"}}},{"name":"RABBITMQ_ENABLED_PLUGINS_FILE","value":"/operator/enabled_plugins"},{"name":"K8S_SERVICE_NAME","value":"rabbitmq-cluster-nodes"},{"name":"RABBITMQ_USE_LONGNAME","value":"true"},{"name":"RABBITMQ_NODENAME","value":"rabbit@$(MY_POD_NAME).$(K8S_SERVICE_NAME).$(MY_POD_NAMESPACE)"},{"name":"K8S_HOSTNAME_SUFFIX","value":".$(K8S_SERVICE_NAME).$(MY_POD_NAMESPACE)"}],"resources":{"limits":{"cpu":"2","memory":"2Gi"},"requests":{"cpu":"1","memory":"2Gi"}},"volumeMounts":[{"name":"rabbitmq-erlang-cookie","mountPath":"/var/lib/rabbitmq/"},{"name":"persistence","mountPath":"/var/lib/rabbitmq/mnesia/"},{"name":"rabbitmq-plugins","mountPath":"/operator"},{"name":"rabbitmq-confd","mountPath":"/etc/rabbitmq/conf.d/10-operatorDefaults.conf","subPath":"operatorDefaults.conf"},{"name":"rabbitmq-confd","mountPath":"/etc/rabbitmq/conf.d/11-default_user.conf","subPath":"default_user.conf"},{"name":"rabbitmq-confd","mountPath":"/etc/rabbitmq/conf.d/90-userDefinedConfiguration.conf","subPath":"userDefinedConfiguration.conf"},{"name":"pod-info","mountPath":"/etc/pod-info/"}],"readinessProbe":{"tcpSocket":{"port":"amqp"},"initialDelaySeconds":10,"timeoutSeconds":5,"periodSeconds":10,"successThreshold":1,"failureThreshold":3},"lifecycle":{"preStop":{"exec":{"command":["/bin/bash","-c","if [ ! -z \"$(cat /etc/pod-info/skipPreStopChecks)\" ]; then exit 0; fi; rabbitmq-upgrade await_online_quorum_plus_one -t 604800; rabbitmq-upgrade await_online_synchronized_mirror -t 604800; rabbitmq-upgrade drain -t 604800"]}}},"terminationMessagePath":"/dev/termination-log","terminationMessagePolicy":"File","imagePullPolicy":"IfNotPresent"}],"restartPolicy":"Always","terminationGracePeriodSeconds":604800,"dnsPolicy":"ClusterFirst","serviceAccountName":"rabbitmq-cluster-server","serviceAccount":"rabbitmq-cluster-server","automountServiceAccountToken":true,"securityContext":{"runAsUser":999,"runAsGroup":999,"fsGroup":999},"schedulerName":"default-scheduler","topologySpreadConstraints":[{"maxSkew":1,"topologyKey":"topology.kubernetes.io/zone","whenUnsatisfiable":"ScheduleAnyway","labelSelector":{"matchLabels":{"app.kubernetes.io/name":"rabbitmq-cluster"}}}]}},"volumeClaimTemplates":[{"metadata":{"name":"persistence","namespace":"default","creationTimestamp":null,"labels":{"app.kubernetes.io/component":"rabbitmq","app.kubernetes.io/name":"rabbitmq-cluster","app.kubernetes.io/part-of":"rabbitmq"},"ownerReferences":[{"apiVersion":"rabbitmq.com/v1beta1","kind":"RabbitmqCluster","name":"rabbitmq-cluster","uid":"3ecefa8a-1bec-48a7-9af4-dd0df3339101","controller":true,"blockOwnerDeletion":false}]},"spec":{"accessModes":["ReadWriteOnce"],"resources":{"requests":{"storage":"15Gi"}},"volumeMode":"Filesystem"},"status":{"phase":"Pending"}}],"serviceName":"rabbitmq-cluster-nodes","podManagementPolicy":"Parallel","updateStrategy":{"type":"RollingUpdate","rollingUpdate":{"partition":0}},"revisionHistoryLimit":10},"status":{"observedGeneration":1,"replicas":1,"readyReplicas":1,"currentReplicas":1,"updatedReplicas":1,"currentRevision":"rabbitmq-cluster-server-5f8b8665fb","updateRevision":"rabbitmq-cluster-server-5f8b8665fb","collisionCount":0}}
2022/03/18 18:07:49 learn_server.go:256: [SIEVE-BEFORE-WRITE]	55
2022/03/18 18:07:49 learn_server.go:263: [SIEVE-AFTER-WRITE]	55	Update	statefulset	github.com/rabbitmq/cluster-operator/controllers.(*RabbitmqClusterReconciler)	NoError	{"metadata":{"name":"rabbitmq-cluster-server","namespace":"default","selfLink":"/apis/apps/v1/namespaces/default/statefulsets/rabbitmq-cluster-server","uid":"1d62d993-2c32-4da7-8884-e4cfad9e587d","resourceVersion":"1481","generation":1,"creationTimestamp":"2022-03-18T18:07:34Z","labels":{"app.kubernetes.io/component":"rabbitmq","app.kubernetes.io/name":"rabbitmq-cluster","app.kubernetes.io/part-of":"rabbitmq"},"ownerReferences":[{"apiVersion":"rabbitmq.com/v1beta1","kind":"RabbitmqCluster","name":"rabbitmq-cluster","uid":"3ecefa8a-1bec-48a7-9af4-dd0df3339101","controller":true,"blockOwnerDeletion":true}],"managedFields":[{"manager":"kube-controller-manager","operation":"Update","apiVersion":"apps/v1","time":"2022-03-18T18:07:34Z","fieldsType":"FieldsV1","fieldsV1":{"f:status":{"f:collisionCount":{},"f:currentReplicas":{},"f:currentRevision":{},"f:observedGeneration":{},"f:readyReplicas":{},"f:replicas":{},"f:updateRevision":{},"f:updatedReplicas":{}}}},{"manager":"manager","operation":"Update","apiVersion":"apps/v1","time":"2022-03-18T18:07:34Z","fieldsType":"FieldsV1","fieldsV1":{"f:metadata":{"f:labels":{".":{},"f:app.kubernetes.io/component":{},"f:app.kubernetes.io/name":{},"f:app.kubernetes.io/part-of":{}},"f:ownerReferences":{".":{},"k:{\"uid\":\"3ecefa8a-1bec-48a7-9af4-dd0df3339101\"}":{".":{},"f:apiVersion":{},"f:blockOwnerDeletion":{},"f:controller":{},"f:kind":{},"f:name":{},"f:uid":{}}}},"f:spec":{"f:podManagementPolicy":{},"f:replicas":{},"f:revisionHistoryLimit":{},"f:selector":{"f:matchLabels":{".":{},"f:app.kubernetes.io/name":{}}},"f:serviceName":{},"f:template":{"f:metadata":{"f:annotations":{".":{},"f:prometheus.io/port":{},"f:prometheus.io/scrape":{}},"f:labels":{".":{},"f:app.kubernetes.io/component":{},"f:app.kubernetes.io/name":{},"f:app.kubernetes.io/part-of":{}}},"f:spec":{"f:automountServiceAccountToken":{},"f:containers":{"k:{\"name\":\"rabbitmq\"}":{".":{},"f:env":{".":{},"k:{\"name\":\"K8S_HOSTNAME_SUFFIX\"}":{".":{},"f:name":{},"f:value":{}},"k:{\"name\":\"K8S_SERVICE_NAME\"}":{".":{},"f:name":{},"f:value":{}},"k:{\"name\":\"MY_POD_NAME\"}":{".":{},"f:name":{},"f:valueFrom":{".":{},"f:fieldRef":{".":{},"f:apiVersion":{},"f:fieldPath":{}}}},"k:{\"name\":\"MY_POD_NAMESPACE\"}":{".":{},"f:name":{},"f:valueFrom":{".":{},"f:fieldRef":{".":{},"f:apiVersion":{},"f:fieldPath":{}}}},"k:{\"name\":\"RABBITMQ_ENABLED_PLUGINS_FILE\"}":{".":{},"f:name":{},"f:value":{}},"k:{\"name\":\"RABBITMQ_NODENAME\"}":{".":{},"f:name":{},"f:value":{}},"k:{\"name\":\"RABBITMQ_USE_LONGNAME\"}":{".":{},"f:name":{},"f:value":{}}},"f:image":{},"f:imagePullPolicy":{},"f:lifecycle":{".":{},"f:preStop":{".":{},"f:exec":{".":{},"f:command":{}}}},"f:name":{},"f:ports":{".":{},"k:{\"containerPort\":4369,\"protocol\":\"TCP\"}":{".":{},"f:containerPort":{},"f:name":{},"f:protocol":{}},"k:{\"containerPort\":5672,\"protocol\":\"TCP\"}":{".":{},"f:containerPort":{},"f:name":{},"f:protocol":{}},"k:{\"containerPort\":15672,\"protocol\":\"TCP\"}":{".":{},"f:containerPort":{},"f:name":{},"f:protocol":{}},"k:{\"containerPort\":15692,\"protocol\":\"TCP\"}":{".":{},"f:containerPort":{},"f:name":{},"f:protocol":{}}},"f:readinessProbe":{".":{},"f:failureThreshold":{},"f:initialDelaySeconds":{},"f:periodSeconds":{},"f:successThreshold":{},"f:tcpSocket":{".":{},"f:port":{}},"f:timeoutSeconds":{}},"f:resources":{".":{},"f:limits":{".":{},"f:cpu":{},"f:memory":{}},"f:requests":{".":{},"f:cpu":{},"f:memory":{}}},"f:terminationMessagePath":{},"f:terminationMessagePolicy":{},"f:volumeMounts":{".":{},"k:{\"mountPath\":\"/etc/pod-info/\"}":{".":{},"f:mountPath":{},"f:name":{}},"k:{\"mountPath\":\"/etc/rabbitmq/conf.d/10-operatorDefaults.conf\"}":{".":{},"f:mountPath":{},"f:name":{},"f:subPath":{}},"k:{\"mountPath\":\"/etc/rabbitmq/conf.d/11-default_user.conf\"}":{".":{},"f:mountPath":{},"f:name":{},"f:subPath":{}},"k:{\"mountPath\":\"/etc/rabbitmq/conf.d/90-userDefinedConfiguration.conf\"}":{".":{},"f:mountPath":{},"f:name":{},"f:subPath":{}},"k:{\"mountPath\":\"/operator\"}":{".":{},"f:mountPath":{},"f:name":{}},"k:{\"mountPath\":\"/var/lib/rabbitmq/\"}":{".":{},"f:mountPath":{},"f:name":{}},"k:{\"mountPath\":\"/var/lib/rabbitmq/mnesia/\"}":{".":{},"f:mountPath":{},"f:name":{}}}}},"f:dnsPolicy":{},"f:initContainers":{".":{},"k:{\"name\":\"setup-container\"}":{".":{},"f:command":{},"f:image":{},"f:imagePullPolicy":{},"f:name":{},"f:resources":{".":{},"f:limits":{".":{},"f:cpu":{},"f:memory":{}},"f:requests":{".":{},"f:cpu":{},"f:memory":{}}},"f:securityContext":{".":{},"f:capabilities":{".":{},"f:drop":{}},"f:runAsUser":{}},"f:terminationMessagePath":{},"f:terminationMessagePolicy":{},"f:volumeMounts":{".":{},"k:{\"mountPath\":\"/operator\"}":{".":{},"f:mountPath":{},"f:name":{}},"k:{\"mountPath\":\"/tmp/default_user.conf\"}":{".":{},"f:mountPath":{},"f:name":{},"f:subPath":{}},"k:{\"mountPath\":\"/tmp/erlang-cookie-secret/\"}":{".":{},"f:mountPath":{},"f:name":{}},"k:{\"mountPath\":\"/tmp/rabbitmq-plugins/\"}":{".":{},"f:mountPath":{},"f:name":{}},"k:{\"mountPath\":\"/var/lib/rabbitmq/\"}":{".":{},"f:mountPath":{},"f:name":{}},"k:{\"mountPath\":\"/var/lib/rabbitmq/mnesia/\"}":{".":{},"f:mountPath":{},"f:name":{}}}}},"f:restartPolicy":{},"f:schedulerName":{},"f:securityContext":{".":{},"f:fsGroup":{},"f:runAsGroup":{},"f:runAsUser":{}},"f:serviceAccount":{},"f:serviceAccountName":{},"f:terminationGracePeriodSeconds":{},"f:topologySpreadConstraints":{".":{},"k:{\"topologyKey\":\"topology.kubernetes.io/zone\",\"whenUnsatisfiable\":\"ScheduleAnyway\"}":{".":{},"f:labelSelector":{".":{},"f:matchLabels":{".":{},"f:app.kubernetes.io/name":{}}},"f:maxSkew":{},"f:topologyKey":{},"f:whenUnsatisfiable":{}}},"f:volumes":{".":{},"k:{\"name\":\"erlang-cookie-secret\"}":{".":{},"f:name":{},"f:secret":{".":{},"f:defaultMode":{},"f:secretName":{}}},"k:{\"name\":\"plugins-conf\"}":{".":{},"f:configMap":{".":{},"f:defaultMode":{},"f:name":{}},"f:name":{}},"k:{\"name\":\"pod-info\"}":{".":{},"f:downwardAPI":{".":{},"f:defaultMode":{},"f:items":{}},"f:name":{}},"k:{\"name\":\"rabbitmq-confd\"}":{".":{},"f:name":{},"f:projected":{".":{},"f:defaultMode":{},"f:sources":{}}},"k:{\"name\":\"rabbitmq-erlang-cookie\"}":{".":{},"f:emptyDir":{},"f:name":{}},"k:{\"name\":\"rabbitmq-plugins\"}":{".":{},"f:emptyDir":{},"f:name":{}}}}},"f:updateStrategy":{"f:rollingUpdate":{".":{},"f:partition":{}},"f:type":{}},"f:volumeClaimTemplates":{}}}}]},"spec":{"replicas":1,"selector":{"matchLabels":{"app.kubernetes.io/name":"rabbitmq-cluster"}},"template":{"metadata":{"creationTimestamp":null,"labels":{"app.kubernetes.io/component":"rabbitmq","app.kubernetes.io/name":"rabbitmq-cluster","app.kubernetes.io/part-of":"rabbitmq"},"annotations":{"prometheus.io/port":"15692","prometheus.io/scrape":"true"}},"spec":{"volumes":[{"name":"plugins-conf","configMap":{"name":"rabbitmq-cluster-plugins-conf","defaultMode":420}},{"name":"rabbitmq-confd","projected":{"sources":[{"secret":{"name":"rabbitmq-cluster-default-user","items":[{"key":"default_user.conf","path":"default_user.conf"}]}},{"configMap":{"name":"rabbitmq-cluster-server-conf","items":[{"key":"operatorDefaults.conf","path":"operatorDefaults.conf"},{"key":"userDefinedConfiguration.conf","path":"userDefinedConfiguration.conf"}]}}],"defaultMode":420}},{"name":"rabbitmq-erlang-cookie","emptyDir":{}},{"name":"erlang-cookie-secret","secret":{"secretName":"rabbitmq-cluster-erlang-cookie","defaultMode":420}},{"name":"rabbitmq-plugins","emptyDir":{}},{"name":"pod-info","downwardAPI":{"items":[{"path":"skipPreStopChecks","fieldRef":{"apiVersion":"v1","fieldPath":"metadata.labels['skipPreStopChecks']"}}],"defaultMode":420}}],"initContainers":[{"name":"setup-container","image":"rabbitmq:3.8.12-management","command":["sh","-c","cp /tmp/erlang-cookie-secret/.erlang.cookie /var/lib/rabbitmq/.erlang.cookie \u0026\u0026 chown 999:999 /var/lib/rabbitmq/.erlang.cookie \u0026\u0026 chmod 600 /var/lib/rabbitmq/.erlang.cookie ; cp /tmp/rabbitmq-plugins/enabled_plugins /operator/enabled_plugins \u0026\u0026 chown 999:999 /operator/enabled_plugins ; chown 999:999 /var/lib/rabbitmq/mnesia/ ; echo '[default]' \u003e /var/lib/rabbitmq/.rabbitmqadmin.conf \u0026\u0026 sed -e 's/default_user/username/' -e 's/default_pass/password/' /tmp/default_user.conf \u003e\u003e /var/lib/rabbitmq/.rabbitmqadmin.conf \u0026\u0026 chown 999:999 /var/lib/rabbitmq/.rabbitmqadmin.conf \u0026\u0026 chmod 600 /var/lib/rabbitmq/.rabbitmqadmin.conf"],"resources":{"limits":{"cpu":"100m","memory":"500Mi"},"requests":{"cpu":"100m","memory":"500Mi"}},"volumeMounts":[{"name":"plugins-conf","mountPath":"/tmp/rabbitmq-plugins/"},{"name":"rabbitmq-erlang-cookie","mountPath":"/var/lib/rabbitmq/"},{"name":"erlang-cookie-secret","mountPath":"/tmp/erlang-cookie-secret/"},{"name":"rabbitmq-plugins","mountPath":"/operator"},{"name":"persistence","mountPath":"/var/lib/rabbitmq/mnesia/"},{"name":"rabbitmq-confd","mountPath":"/tmp/default_user.conf","subPath":"default_user.conf"}],"terminationMessagePath":"/dev/termination-log","terminationMessagePolicy":"File","imagePullPolicy":"IfNotPresent","securityContext":{"capabilities":{"drop":["FSETID","KILL","SETGID","SETUID","SETPCAP","NET_BIND_SERVICE","NET_RAW","SYS_CHROOT","MKNOD","AUDIT_WRITE","SETFCAP"]},"runAsUser":0}}],"containers":[{"name":"rabbitmq","image":"rabbitmq:3.8.12-management","ports":[{"name":"epmd","containerPort":4369,"protocol":"TCP"},{"name":"amqp","containerPort":5672,"protocol":"TCP"},{"name":"management","containerPort":15672,"protocol":"TCP"},{"name":"prometheus","containerPort":15692,"protocol":"TCP"}],"env":[{"name":"MY_POD_NAME","valueFrom":{"fieldRef":{"apiVersion":"v1","fieldPath":"metadata.name"}}},{"name":"MY_POD_NAMESPACE","valueFrom":{"fieldRef":{"apiVersion":"v1","fieldPath":"metadata.namespace"}}},{"name":"RABBITMQ_ENABLED_PLUGINS_FILE","value":"/operator/enabled_plugins"},{"name":"K8S_SERVICE_NAME","value":"rabbitmq-cluster-nodes"},{"name":"RABBITMQ_USE_LONGNAME","value":"true"},{"name":"RABBITMQ_NODENAME","value":"rabbit@$(MY_POD_NAME).$(K8S_SERVICE_NAME).$(MY_POD_NAMESPACE)"},{"name":"K8S_HOSTNAME_SUFFIX","value":".$(K8S_SERVICE_NAME).$(MY_POD_NAMESPACE)"}],"resources":{"limits":{"cpu":"2","memory":"2Gi"},"requests":{"cpu":"1","memory":"2Gi"}},"volumeMounts":[{"name":"rabbitmq-erlang-cookie","mountPath":"/var/lib/rabbitmq/"},{"name":"persistence","mountPath":"/var/lib/rabbitmq/mnesia/"},{"name":"rabbitmq-plugins","mountPath":"/operator"},{"name":"rabbitmq-confd","mountPath":"/etc/rabbitmq/conf.d/10-operatorDefaults.conf","subPath":"operatorDefaults.conf"},{"name":"rabbitmq-confd","mountPath":"/etc/rabbitmq/conf.d/11-default_user.conf","subPath":"default_user.conf"},{"name":"rabbitmq-confd","mountPath":"/etc/rabbitmq/conf.d/90-userDefinedConfiguration.conf","subPath":"userDefinedConfiguration.conf"},{"name":"pod-info","mountPath":"/etc/pod-info/"}],"readinessProbe":{"tcpSocket":{"port":"amqp"},"initialDelaySeconds":10,"timeoutSeconds":5,"periodSeconds":10,"successThreshold":1,"failureThreshold":3},"lifecycle":{"preStop":{"exec":{"command":["/bin/bash","-c","if [ ! -z \"$(cat /etc/pod-info/skipPreStopChecks)\" ]; then exit 0; fi; rabbitmq-upgrade await_online_quorum_plus_one -t 604800; rabbitmq-upgrade await_online_synchronized_mirror -t 604800; rabbitmq-upgrade drain -t 604800"]}}},"terminationMessagePath":"/dev/termination-log","terminationMessagePolicy":"File","imagePullPolicy":"IfNotPresent"}],"restartPolicy":"Always","terminationGracePeriodSeconds":604800,"dnsPolicy":"ClusterFirst","serviceAccountName":"rabbitmq-cluster-server","serviceAccount":"rabbitmq-cluster-server","automountServiceAccountToken":true,"securityContext":{"runAsUser":999,"runAsGroup":999,"fsGroup":999},"schedulerName":"default-scheduler","topologySpreadConstraints":[{"maxSkew":1,"topologyKey":"topology.kubernetes.io/zone","whenUnsatisfiable":"ScheduleAnyway","labelSelector":{"matchLabels":{"app.kubernetes.io/name":"rabbitmq-cluster"}}}]}},"volumeClaimTemplates":[{"metadata":{"name":"persistence","namespace":"default","creationTimestamp":null,"labels":{"app.kubernetes.io/component":"rabbitmq","app.kubernetes.io/name":"rabbitmq-cluster","app.kubernetes.io/part-of":"rabbitmq"},"ownerReferences":[{"apiVersion":"rabbitmq.com/v1beta1","kind":"RabbitmqCluster","name":"rabbitmq-cluster","uid":"3ecefa8a-1bec-48a7-9af4-dd0df3339101","controller":true,"blockOwnerDeletion":false}]},"spec":{"accessModes":["ReadWriteOnce"],"resources":{"requests":{"storage":"15Gi"}},"volumeMode":"Filesystem"},"status":{"phase":"Pending"}}],"serviceName":"rabbitmq-cluster-nodes","podManagementPolicy":"Parallel","updateStrategy":{"type":"RollingUpdate","rollingUpdate":{"partition":0}},"revisionHistoryLimit":10},"status":{"observedGeneration":1,"replicas":1,"readyReplicas":1,"currentReplicas":1,"updatedReplicas":1,"currentRevision":"rabbitmq-cluster-server-5f8b8665fb","updateRevision":"rabbitmq-cluster-server-5f8b8665fb","collisionCount":0}}
2022/03/18 18:07:49 learn_server.go:291: [SIEVE-AFTER-READ]	Get	true	configmap	default	rabbitmq-cluster-server-conf	github.com/rabbitmq/cluster-operator/controllers.(*RabbitmqClusterReconciler)	NoError	{"kind":"ConfigMap","apiVersion":"v1","metadata":{"name":"rabbitmq-cluster-server-conf","namespace":"default","selfLink":"/api/v1/namespaces/default/configmaps/rabbitmq-cluster-server-conf","uid":"e4182078-d429-4baf-9021-72618c509ac5","resourceVersion":"1095","creationTimestamp":"2022-03-18T18:06:25Z","labels":{"app.kubernetes.io/component":"rabbitmq","app.kubernetes.io/name":"rabbitmq-cluster","app.kubernetes.io/part-of":"rabbitmq"},"ownerReferences":[{"apiVersion":"rabbitmq.com/v1beta1","kind":"RabbitmqCluster","name":"rabbitmq-cluster","uid":"3ecefa8a-1bec-48a7-9af4-dd0df3339101","controller":true,"blockOwnerDeletion":true}],"managedFields":[{"manager":"manager","operation":"Update","apiVersion":"v1","time":"2022-03-18T18:06:25Z","fieldsType":"FieldsV1","fieldsV1":{"f:data":{".":{},"f:operatorDefaults.conf":{},"f:userDefinedConfiguration.conf":{}},"f:metadata":{"f:labels":{".":{},"f:app.kubernetes.io/component":{},"f:app.kubernetes.io/name":{},"f:app.kubernetes.io/part-of":{}},"f:ownerReferences":{".":{},"k:{\"uid\":\"3ecefa8a-1bec-48a7-9af4-dd0df3339101\"}":{".":{},"f:apiVersion":{},"f:blockOwnerDeletion":{},"f:controller":{},"f:kind":{},"f:name":{},"f:uid":{}}}}}}]},"data":{"operatorDefaults.conf":"cluster_formation.peer_discovery_backend             = rabbit_peer_discovery_k8s\ncluster_formation.k8s.host                           = kubernetes.default\ncluster_formation.k8s.address_type                   = hostname\ncluster_partition_handling                           = pause_minority\nqueue_master_locator                                 = min-masters\ndisk_free_limit.absolute                             = 2GB\ncluster_formation.randomized_startup_delay_range.min = 5\ncluster_formation.randomized_startup_delay_range.max = 30\ncluster_name                                         = rabbitmq-cluster\n","userDefinedConfiguration.conf":"total_memory_available_override_value = 1717986919\n"}}
2022/03/18 18:07:49 learn_server.go:256: [SIEVE-BEFORE-WRITE]	56
2022/03/18 18:07:49 learn_server.go:263: [SIEVE-AFTER-WRITE]	56	StatusUpdate	rabbitmqcluster	github.com/rabbitmq/cluster-operator/controllers.(*RabbitmqClusterReconciler)	NoError	{"metadata":{"name":"rabbitmq-cluster","namespace":"default","selfLink":"/apis/rabbitmq.com/v1beta1/namespaces/default/rabbitmqclusters/rabbitmq-cluster/status","uid":"3ecefa8a-1bec-48a7-9af4-dd0df3339101","resourceVersion":"1482","generation":3,"creationTimestamp":"2022-03-18T18:06:25Z","annotations":{"kubectl.kubernetes.io/last-applied-configuration":"{\"apiVersion\":\"rabbitmq.com/v1beta1\",\"kind\":\"RabbitmqCluster\",\"metadata\":{\"annotations\":{},\"name\":\"rabbitmq-cluster\",\"namespace\":\"default\"},\"spec\":{\"persistence\":{\"storage\":\"10Gi\"},\"replicas\":1}}\n"},"finalizers":["deletion.finalizers.rabbitmqclusters.rabbitmq.com"],"managedFields":[{"manager":"kubectl-client-side-apply","operation":"Update","apiVersion":"rabbitmq.com/v1beta1","time":"2022-03-18T18:06:25Z","fieldsType":"FieldsV1","fieldsV1":{"f:metadata":{"f:annotations":{".":{},"f:kubectl.kubernetes.io/last-applied-configuration":{}}},"f:spec":{".":{},"f:image":{},"f:persistence":{},"f:replicas":{},"f:resources":{".":{},"f:limits":{".":{},"f:memory":{}},"f:requests":{".":{},"f:memory":{}}},"f:service":{".":{},"f:type":{}},"f:terminationGracePeriodSeconds":{}}}},{"manager":"kubectl-patch","operation":"Update","apiVersion":"rabbitmq.com/v1beta1","time":"2022-03-18T18:07:31Z","fieldsType":"FieldsV1","fieldsV1":{"f:spec":{"f:persistence":{"f:storage":{}}}}},{"manager":"manager","operation":"Update","apiVersion":"rabbitmq.com/v1beta1","time":"2022-03-18T18:07:35Z","fieldsType":"FieldsV1","fieldsV1":{"f:metadata":{"f:finalizers":{}},"f:spec":{"f:override":{},"f:rabbitmq":{},"f:resources":{"f:limits":{"f:cpu":{}},"f:requests":{"f:cpu":{}}},"f:tls":{}},"f:status":{".":{},"f:conditions":{},"f:defaultUser":{".":{},"f:secretReference":{".":{},"f:keys":{".":{},"f:password":{},"f:username":{}},"f:name":{},"f:namespace":{}},"f:serviceReference":{".":{},"f:name":{},"f:namespace":{}}}}}}]},"spec":{"replicas":1,"image":"rabbitmq:3.8.12-management","service":{"type":"ClusterIP"},"persistence":{"storage":"15Gi"},"resources":{"limits":{"cpu":"2","memory":"2Gi"},"requests":{"cpu":"1","memory":"2Gi"}},"rabbitmq":{},"tls":{},"override":{},"terminationGracePeriodSeconds":604800},"status":{"conditions":[{"type":"AllReplicasReady","status":"True","lastTransitionTime":"2022-03-18T18:07:35Z","reason":"AllPodsAreReady"},{"type":"ClusterAvailable","status":"True","lastTransitionTime":"2022-03-18T18:07:23Z","reason":"AtLeastOneEndpointAvailable"},{"type":"NoWarnings","status":"True","lastTransitionTime":"2022-03-18T18:06:25Z","reason":"NoWarnings"},{"type":"ReconcileSuccess","status":"True","lastTransitionTime":"2022-03-18T18:07:24Z","reason":"Success","message":"Finish reconciling"}],"defaultUser":{"secretReference":{"name":"rabbitmq-cluster-default-user","namespace":"default","keys":{"password":"password","username":"username"}},"serviceReference":{"name":"rabbitmq-cluster","namespace":"default"}},"binding":{"name":"rabbitmq-cluster-default-user"}}}
2022/03/18 18:07:49 learn_server.go:291: [SIEVE-AFTER-READ]	Get	true	statefulset	default	rabbitmq-cluster-server	github.com/rabbitmq/cluster-operator/controllers.(*RabbitmqClusterReconciler)	NoError	{"kind":"StatefulSet","apiVersion":"apps/v1","metadata":{"name":"rabbitmq-cluster-server","namespace":"default","selfLink":"/apis/apps/v1/namespaces/default/statefulsets/rabbitmq-cluster-server","uid":"1d62d993-2c32-4da7-8884-e4cfad9e587d","resourceVersion":"1481","generation":1,"creationTimestamp":"2022-03-18T18:07:34Z","labels":{"app.kubernetes.io/component":"rabbitmq","app.kubernetes.io/name":"rabbitmq-cluster","app.kubernetes.io/part-of":"rabbitmq"},"ownerReferences":[{"apiVersion":"rabbitmq.com/v1beta1","kind":"RabbitmqCluster","name":"rabbitmq-cluster","uid":"3ecefa8a-1bec-48a7-9af4-dd0df3339101","controller":true,"blockOwnerDeletion":true}],"managedFields":[{"manager":"kube-controller-manager","operation":"Update","apiVersion":"apps/v1","time":"2022-03-18T18:07:34Z","fieldsType":"FieldsV1","fieldsV1":{"f:status":{"f:collisionCount":{},"f:currentReplicas":{},"f:currentRevision":{},"f:observedGeneration":{},"f:readyReplicas":{},"f:replicas":{},"f:updateRevision":{},"f:updatedReplicas":{}}}},{"manager":"manager","operation":"Update","apiVersion":"apps/v1","time":"2022-03-18T18:07:34Z","fieldsType":"FieldsV1","fieldsV1":{"f:metadata":{"f:labels":{".":{},"f:app.kubernetes.io/component":{},"f:app.kubernetes.io/name":{},"f:app.kubernetes.io/part-of":{}},"f:ownerReferences":{".":{},"k:{\"uid\":\"3ecefa8a-1bec-48a7-9af4-dd0df3339101\"}":{".":{},"f:apiVersion":{},"f:blockOwnerDeletion":{},"f:controller":{},"f:kind":{},"f:name":{},"f:uid":{}}}},"f:spec":{"f:podManagementPolicy":{},"f:replicas":{},"f:revisionHistoryLimit":{},"f:selector":{"f:matchLabels":{".":{},"f:app.kubernetes.io/name":{}}},"f:serviceName":{},"f:template":{"f:metadata":{"f:annotations":{".":{},"f:prometheus.io/port":{},"f:prometheus.io/scrape":{}},"f:labels":{".":{},"f:app.kubernetes.io/component":{},"f:app.kubernetes.io/name":{},"f:app.kubernetes.io/part-of":{}}},"f:spec":{"f:automountServiceAccountToken":{},"f:containers":{"k:{\"name\":\"rabbitmq\"}":{".":{},"f:env":{".":{},"k:{\"name\":\"K8S_HOSTNAME_SUFFIX\"}":{".":{},"f:name":{},"f:value":{}},"k:{\"name\":\"K8S_SERVICE_NAME\"}":{".":{},"f:name":{},"f:value":{}},"k:{\"name\":\"MY_POD_NAME\"}":{".":{},"f:name":{},"f:valueFrom":{".":{},"f:fieldRef":{".":{},"f:apiVersion":{},"f:fieldPath":{}}}},"k:{\"name\":\"MY_POD_NAMESPACE\"}":{".":{},"f:name":{},"f:valueFrom":{".":{},"f:fieldRef":{".":{},"f:apiVersion":{},"f:fieldPath":{}}}},"k:{\"name\":\"RABBITMQ_ENABLED_PLUGINS_FILE\"}":{".":{},"f:name":{},"f:value":{}},"k:{\"name\":\"RABBITMQ_NODENAME\"}":{".":{},"f:name":{},"f:value":{}},"k:{\"name\":\"RABBITMQ_USE_LONGNAME\"}":{".":{},"f:name":{},"f:value":{}}},"f:image":{},"f:imagePullPolicy":{},"f:lifecycle":{".":{},"f:preStop":{".":{},"f:exec":{".":{},"f:command":{}}}},"f:name":{},"f:ports":{".":{},"k:{\"containerPort\":4369,\"protocol\":\"TCP\"}":{".":{},"f:containerPort":{},"f:name":{},"f:protocol":{}},"k:{\"containerPort\":5672,\"protocol\":\"TCP\"}":{".":{},"f:containerPort":{},"f:name":{},"f:protocol":{}},"k:{\"containerPort\":15672,\"protocol\":\"TCP\"}":{".":{},"f:containerPort":{},"f:name":{},"f:protocol":{}},"k:{\"containerPort\":15692,\"protocol\":\"TCP\"}":{".":{},"f:containerPort":{},"f:name":{},"f:protocol":{}}},"f:readinessProbe":{".":{},"f:failureThreshold":{},"f:initialDelaySeconds":{},"f:periodSeconds":{},"f:successThreshold":{},"f:tcpSocket":{".":{},"f:port":{}},"f:timeoutSeconds":{}},"f:resources":{".":{},"f:limits":{".":{},"f:cpu":{},"f:memory":{}},"f:requests":{".":{},"f:cpu":{},"f:memory":{}}},"f:terminationMessagePath":{},"f:terminationMessagePolicy":{},"f:volumeMounts":{".":{},"k:{\"mountPath\":\"/etc/pod-info/\"}":{".":{},"f:mountPath":{},"f:name":{}},"k:{\"mountPath\":\"/etc/rabbitmq/conf.d/10-operatorDefaults.conf\"}":{".":{},"f:mountPath":{},"f:name":{},"f:subPath":{}},"k:{\"mountPath\":\"/etc/rabbitmq/conf.d/11-default_user.conf\"}":{".":{},"f:mountPath":{},"f:name":{},"f:subPath":{}},"k:{\"mountPath\":\"/etc/rabbitmq/conf.d/90-userDefinedConfiguration.conf\"}":{".":{},"f:mountPath":{},"f:name":{},"f:subPath":{}},"k:{\"mountPath\":\"/operator\"}":{".":{},"f:mountPath":{},"f:name":{}},"k:{\"mountPath\":\"/var/lib/rabbitmq/\"}":{".":{},"f:mountPath":{},"f:name":{}},"k:{\"mountPath\":\"/var/lib/rabbitmq/mnesia/\"}":{".":{},"f:mountPath":{},"f:name":{}}}}},"f:dnsPolicy":{},"f:initContainers":{".":{},"k:{\"name\":\"setup-container\"}":{".":{},"f:command":{},"f:image":{},"f:imagePullPolicy":{},"f:name":{},"f:resources":{".":{},"f:limits":{".":{},"f:cpu":{},"f:memory":{}},"f:requests":{".":{},"f:cpu":{},"f:memory":{}}},"f:securityContext":{".":{},"f:capabilities":{".":{},"f:drop":{}},"f:runAsUser":{}},"f:terminationMessagePath":{},"f:terminationMessagePolicy":{},"f:volumeMounts":{".":{},"k:{\"mountPath\":\"/operator\"}":{".":{},"f:mountPath":{},"f:name":{}},"k:{\"mountPath\":\"/tmp/default_user.conf\"}":{".":{},"f:mountPath":{},"f:name":{},"f:subPath":{}},"k:{\"mountPath\":\"/tmp/erlang-cookie-secret/\"}":{".":{},"f:mountPath":{},"f:name":{}},"k:{\"mountPath\":\"/tmp/rabbitmq-plugins/\"}":{".":{},"f:mountPath":{},"f:name":{}},"k:{\"mountPath\":\"/var/lib/rabbitmq/\"}":{".":{},"f:mountPath":{},"f:name":{}},"k:{\"mountPath\":\"/var/lib/rabbitmq/mnesia/\"}":{".":{},"f:mountPath":{},"f:name":{}}}}},"f:restartPolicy":{},"f:schedulerName":{},"f:securityContext":{".":{},"f:fsGroup":{},"f:runAsGroup":{},"f:runAsUser":{}},"f:serviceAccount":{},"f:serviceAccountName":{},"f:terminationGracePeriodSeconds":{},"f:topologySpreadConstraints":{".":{},"k:{\"topologyKey\":\"topology.kubernetes.io/zone\",\"whenUnsatisfiable\":\"ScheduleAnyway\"}":{".":{},"f:labelSelector":{".":{},"f:matchLabels":{".":{},"f:app.kubernetes.io/name":{}}},"f:maxSkew":{},"f:topologyKey":{},"f:whenUnsatisfiable":{}}},"f:volumes":{".":{},"k:{\"name\":\"erlang-cookie-secret\"}":{".":{},"f:name":{},"f:secret":{".":{},"f:defaultMode":{},"f:secretName":{}}},"k:{\"name\":\"plugins-conf\"}":{".":{},"f:configMap":{".":{},"f:defaultMode":{},"f:name":{}},"f:name":{}},"k:{\"name\":\"pod-info\"}":{".":{},"f:downwardAPI":{".":{},"f:defaultMode":{},"f:items":{}},"f:name":{}},"k:{\"name\":\"rabbitmq-confd\"}":{".":{},"f:name":{},"f:projected":{".":{},"f:defaultMode":{},"f:sources":{}}},"k:{\"name\":\"rabbitmq-erlang-cookie\"}":{".":{},"f:emptyDir":{},"f:name":{}},"k:{\"name\":\"rabbitmq-plugins\"}":{".":{},"f:emptyDir":{},"f:name":{}}}}},"f:updateStrategy":{"f:rollingUpdate":{".":{},"f:partition":{}},"f:type":{}},"f:volumeClaimTemplates":{}}}}]},"spec":{"replicas":1,"selector":{"matchLabels":{"app.kubernetes.io/name":"rabbitmq-cluster"}},"template":{"metadata":{"creationTimestamp":null,"labels":{"app.kubernetes.io/component":"rabbitmq","app.kubernetes.io/name":"rabbitmq-cluster","app.kubernetes.io/part-of":"rabbitmq"},"annotations":{"prometheus.io/port":"15692","prometheus.io/scrape":"true"}},"spec":{"volumes":[{"name":"plugins-conf","configMap":{"name":"rabbitmq-cluster-plugins-conf","defaultMode":420}},{"name":"rabbitmq-confd","projected":{"sources":[{"secret":{"name":"rabbitmq-cluster-default-user","items":[{"key":"default_user.conf","path":"default_user.conf"}]}},{"configMap":{"name":"rabbitmq-cluster-server-conf","items":[{"key":"operatorDefaults.conf","path":"operatorDefaults.conf"},{"key":"userDefinedConfiguration.conf","path":"userDefinedConfiguration.conf"}]}}],"defaultMode":420}},{"name":"rabbitmq-erlang-cookie","emptyDir":{}},{"name":"erlang-cookie-secret","secret":{"secretName":"rabbitmq-cluster-erlang-cookie","defaultMode":420}},{"name":"rabbitmq-plugins","emptyDir":{}},{"name":"pod-info","downwardAPI":{"items":[{"path":"skipPreStopChecks","fieldRef":{"apiVersion":"v1","fieldPath":"metadata.labels['skipPreStopChecks']"}}],"defaultMode":420}}],"initContainers":[{"name":"setup-container","image":"rabbitmq:3.8.12-management","command":["sh","-c","cp /tmp/erlang-cookie-secret/.erlang.cookie /var/lib/rabbitmq/.erlang.cookie \u0026\u0026 chown 999:999 /var/lib/rabbitmq/.erlang.cookie \u0026\u0026 chmod 600 /var/lib/rabbitmq/.erlang.cookie ; cp /tmp/rabbitmq-plugins/enabled_plugins /operator/enabled_plugins \u0026\u0026 chown 999:999 /operator/enabled_plugins ; chown 999:999 /var/lib/rabbitmq/mnesia/ ; echo '[default]' \u003e /var/lib/rabbitmq/.rabbitmqadmin.conf \u0026\u0026 sed -e 's/default_user/username/' -e 's/default_pass/password/' /tmp/default_user.conf \u003e\u003e /var/lib/rabbitmq/.rabbitmqadmin.conf \u0026\u0026 chown 999:999 /var/lib/rabbitmq/.rabbitmqadmin.conf \u0026\u0026 chmod 600 /var/lib/rabbitmq/.rabbitmqadmin.conf"],"resources":{"limits":{"cpu":"100m","memory":"500Mi"},"requests":{"cpu":"100m","memory":"500Mi"}},"volumeMounts":[{"name":"plugins-conf","mountPath":"/tmp/rabbitmq-plugins/"},{"name":"rabbitmq-erlang-cookie","mountPath":"/var/lib/rabbitmq/"},{"name":"erlang-cookie-secret","mountPath":"/tmp/erlang-cookie-secret/"},{"name":"rabbitmq-plugins","mountPath":"/operator"},{"name":"persistence","mountPath":"/var/lib/rabbitmq/mnesia/"},{"name":"rabbitmq-confd","mountPath":"/tmp/default_user.conf","subPath":"default_user.conf"}],"terminationMessagePath":"/dev/termination-log","terminationMessagePolicy":"File","imagePullPolicy":"IfNotPresent","securityContext":{"capabilities":{"drop":["FSETID","KILL","SETGID","SETUID","SETPCAP","NET_BIND_SERVICE","NET_RAW","SYS_CHROOT","MKNOD","AUDIT_WRITE","SETFCAP"]},"runAsUser":0}}],"containers":[{"name":"rabbitmq","image":"rabbitmq:3.8.12-management","ports":[{"name":"epmd","containerPort":4369,"protocol":"TCP"},{"name":"amqp","containerPort":5672,"protocol":"TCP"},{"name":"management","containerPort":15672,"protocol":"TCP"},{"name":"prometheus","containerPort":15692,"protocol":"TCP"}],"env":[{"name":"MY_POD_NAME","valueFrom":{"fieldRef":{"apiVersion":"v1","fieldPath":"metadata.name"}}},{"name":"MY_POD_NAMESPACE","valueFrom":{"fieldRef":{"apiVersion":"v1","fieldPath":"metadata.namespace"}}},{"name":"RABBITMQ_ENABLED_PLUGINS_FILE","value":"/operator/enabled_plugins"},{"name":"K8S_SERVICE_NAME","value":"rabbitmq-cluster-nodes"},{"name":"RABBITMQ_USE_LONGNAME","value":"true"},{"name":"RABBITMQ_NODENAME","value":"rabbit@$(MY_POD_NAME).$(K8S_SERVICE_NAME).$(MY_POD_NAMESPACE)"},{"name":"K8S_HOSTNAME_SUFFIX","value":".$(K8S_SERVICE_NAME).$(MY_POD_NAMESPACE)"}],"resources":{"limits":{"cpu":"2","memory":"2Gi"},"requests":{"cpu":"1","memory":"2Gi"}},"volumeMounts":[{"name":"rabbitmq-erlang-cookie","mountPath":"/var/lib/rabbitmq/"},{"name":"persistence","mountPath":"/var/lib/rabbitmq/mnesia/"},{"name":"rabbitmq-plugins","mountPath":"/operator"},{"name":"rabbitmq-confd","mountPath":"/etc/rabbitmq/conf.d/10-operatorDefaults.conf","subPath":"operatorDefaults.conf"},{"name":"rabbitmq-confd","mountPath":"/etc/rabbitmq/conf.d/11-default_user.conf","subPath":"default_user.conf"},{"name":"rabbitmq-confd","mountPath":"/etc/rabbitmq/conf.d/90-userDefinedConfiguration.conf","subPath":"userDefinedConfiguration.conf"},{"name":"pod-info","mountPath":"/etc/pod-info/"}],"readinessProbe":{"tcpSocket":{"port":"amqp"},"initialDelaySeconds":10,"timeoutSeconds":5,"periodSeconds":10,"successThreshold":1,"failureThreshold":3},"lifecycle":{"preStop":{"exec":{"command":["/bin/bash","-c","if [ ! -z \"$(cat /etc/pod-info/skipPreStopChecks)\" ]; then exit 0; fi; rabbitmq-upgrade await_online_quorum_plus_one -t 604800; rabbitmq-upgrade await_online_synchronized_mirror -t 604800; rabbitmq-upgrade drain -t 604800"]}}},"terminationMessagePath":"/dev/termination-log","terminationMessagePolicy":"File","imagePullPolicy":"IfNotPresent"}],"restartPolicy":"Always","terminationGracePeriodSeconds":604800,"dnsPolicy":"ClusterFirst","serviceAccountName":"rabbitmq-cluster-server","serviceAccount":"rabbitmq-cluster-server","automountServiceAccountToken":true,"securityContext":{"runAsUser":999,"runAsGroup":999,"fsGroup":999},"schedulerName":"default-scheduler","topologySpreadConstraints":[{"maxSkew":1,"topologyKey":"topology.kubernetes.io/zone","whenUnsatisfiable":"ScheduleAnyway","labelSelector":{"matchLabels":{"app.kubernetes.io/name":"rabbitmq-cluster"}}}]}},"volumeClaimTemplates":[{"metadata":{"name":"persistence","namespace":"default","creationTimestamp":null,"labels":{"app.kubernetes.io/component":"rabbitmq","app.kubernetes.io/name":"rabbitmq-cluster","app.kubernetes.io/part-of":"rabbitmq"},"ownerReferences":[{"apiVersion":"rabbitmq.com/v1beta1","kind":"RabbitmqCluster","name":"rabbitmq-cluster","uid":"3ecefa8a-1bec-48a7-9af4-dd0df3339101","controller":true,"blockOwnerDeletion":false}]},"spec":{"accessModes":["ReadWriteOnce"],"resources":{"requests":{"storage":"15Gi"}},"volumeMode":"Filesystem"},"status":{"phase":"Pending"}}],"serviceName":"rabbitmq-cluster-nodes","podManagementPolicy":"Parallel","updateStrategy":{"type":"RollingUpdate","rollingUpdate":{"partition":0}},"revisionHistoryLimit":10},"status":{"observedGeneration":1,"replicas":1,"readyReplicas":1,"currentReplicas":1,"updatedReplicas":1,"currentRevision":"rabbitmq-cluster-server-5f8b8665fb","updateRevision":"rabbitmq-cluster-server-5f8b8665fb","collisionCount":0}}
2022/03/18 18:07:49 learn_server.go:291: [SIEVE-AFTER-READ]	Get	true	configmap	default	rabbitmq-cluster-plugins-conf	github.com/rabbitmq/cluster-operator/controllers.(*RabbitmqClusterReconciler)	NoError	{"kind":"ConfigMap","apiVersion":"v1","metadata":{"name":"rabbitmq-cluster-plugins-conf","namespace":"default","selfLink":"/api/v1/namespaces/default/configmaps/rabbitmq-cluster-plugins-conf","uid":"0aa26eb6-ff3a-4457-a223-284c897db7fe","resourceVersion":"1092","creationTimestamp":"2022-03-18T18:06:25Z","labels":{"app.kubernetes.io/component":"rabbitmq","app.kubernetes.io/name":"rabbitmq-cluster","app.kubernetes.io/part-of":"rabbitmq"},"ownerReferences":[{"apiVersion":"rabbitmq.com/v1beta1","kind":"RabbitmqCluster","name":"rabbitmq-cluster","uid":"3ecefa8a-1bec-48a7-9af4-dd0df3339101","controller":true,"blockOwnerDeletion":true}],"managedFields":[{"manager":"manager","operation":"Update","apiVersion":"v1","time":"2022-03-18T18:06:25Z","fieldsType":"FieldsV1","fieldsV1":{"f:data":{".":{},"f:enabled_plugins":{}},"f:metadata":{"f:labels":{".":{},"f:app.kubernetes.io/component":{},"f:app.kubernetes.io/name":{},"f:app.kubernetes.io/part-of":{}},"f:ownerReferences":{".":{},"k:{\"uid\":\"3ecefa8a-1bec-48a7-9af4-dd0df3339101\"}":{".":{},"f:apiVersion":{},"f:blockOwnerDeletion":{},"f:controller":{},"f:kind":{},"f:name":{},"f:uid":{}}}}}}]},"data":{"enabled_plugins":"[rabbitmq_peer_discovery_k8s,rabbitmq_prometheus,rabbitmq_management]."}}
2022/03/18 18:07:49 learn_server.go:256: [SIEVE-BEFORE-WRITE]	57
2022/03/18 18:07:49 learn_server.go:263: [SIEVE-AFTER-WRITE]	57	StatusUpdate	rabbitmqcluster	github.com/rabbitmq/cluster-operator/controllers.(*RabbitmqClusterReconciler)	NoError	{"metadata":{"name":"rabbitmq-cluster","namespace":"default","selfLink":"/apis/rabbitmq.com/v1beta1/namespaces/default/rabbitmqclusters/rabbitmq-cluster/status","uid":"3ecefa8a-1bec-48a7-9af4-dd0df3339101","resourceVersion":"1482","generation":3,"creationTimestamp":"2022-03-18T18:06:25Z","annotations":{"kubectl.kubernetes.io/last-applied-configuration":"{\"apiVersion\":\"rabbitmq.com/v1beta1\",\"kind\":\"RabbitmqCluster\",\"metadata\":{\"annotations\":{},\"name\":\"rabbitmq-cluster\",\"namespace\":\"default\"},\"spec\":{\"persistence\":{\"storage\":\"10Gi\"},\"replicas\":1}}\n"},"finalizers":["deletion.finalizers.rabbitmqclusters.rabbitmq.com"],"managedFields":[{"manager":"kubectl-client-side-apply","operation":"Update","apiVersion":"rabbitmq.com/v1beta1","time":"2022-03-18T18:06:25Z","fieldsType":"FieldsV1","fieldsV1":{"f:metadata":{"f:annotations":{".":{},"f:kubectl.kubernetes.io/last-applied-configuration":{}}},"f:spec":{".":{},"f:image":{},"f:persistence":{},"f:replicas":{},"f:resources":{".":{},"f:limits":{".":{},"f:memory":{}},"f:requests":{".":{},"f:memory":{}}},"f:service":{".":{},"f:type":{}},"f:terminationGracePeriodSeconds":{}}}},{"manager":"kubectl-patch","operation":"Update","apiVersion":"rabbitmq.com/v1beta1","time":"2022-03-18T18:07:31Z","fieldsType":"FieldsV1","fieldsV1":{"f:spec":{"f:persistence":{"f:storage":{}}}}},{"manager":"manager","operation":"Update","apiVersion":"rabbitmq.com/v1beta1","time":"2022-03-18T18:07:35Z","fieldsType":"FieldsV1","fieldsV1":{"f:metadata":{"f:finalizers":{}},"f:spec":{"f:override":{},"f:rabbitmq":{},"f:resources":{"f:limits":{"f:cpu":{}},"f:requests":{"f:cpu":{}}},"f:tls":{}},"f:status":{".":{},"f:conditions":{},"f:defaultUser":{".":{},"f:secretReference":{".":{},"f:keys":{".":{},"f:password":{},"f:username":{}},"f:name":{},"f:namespace":{}},"f:serviceReference":{".":{},"f:name":{},"f:namespace":{}}}}}}]},"spec":{"replicas":1,"image":"rabbitmq:3.8.12-management","service":{"type":"ClusterIP"},"persistence":{"storage":"15Gi"},"resources":{"limits":{"cpu":"2","memory":"2Gi"},"requests":{"cpu":"1","memory":"2Gi"}},"rabbitmq":{},"tls":{},"override":{},"terminationGracePeriodSeconds":604800},"status":{"conditions":[{"type":"AllReplicasReady","status":"True","lastTransitionTime":"2022-03-18T18:07:35Z","reason":"AllPodsAreReady"},{"type":"ClusterAvailable","status":"True","lastTransitionTime":"2022-03-18T18:07:23Z","reason":"AtLeastOneEndpointAvailable"},{"type":"NoWarnings","status":"True","lastTransitionTime":"2022-03-18T18:06:25Z","reason":"NoWarnings"},{"type":"ReconcileSuccess","status":"True","lastTransitionTime":"2022-03-18T18:07:24Z","reason":"Success","message":"Finish reconciling"}],"defaultUser":{"secretReference":{"name":"rabbitmq-cluster-default-user","namespace":"default","keys":{"password":"password","username":"username"}},"serviceReference":{"name":"rabbitmq-cluster","namespace":"default"}},"binding":{"name":"rabbitmq-cluster-default-user"}}}
2022/03/18 18:07:49 learn_server.go:253: [SIEVE-AFTER-RECONCILE]	github.com/rabbitmq/cluster-operator/controllers.(*RabbitmqClusterReconciler)	13
2022/03/18 18:07:58 learn_server.go:279: [SIEVE-BEFORE-HEAR]	36	Updated	persistentvolumeclaim	{"metadata":{"name":"persistence-rabbitmq-cluster-server-0","namespace":"default","selfLink":"/api/v1/namespaces/default/persistentvolumeclaims/persistence-rabbitmq-cluster-server-0","uid":"2a49a40a-31f5-4d2b-ba65-716831e0fa6b","resourceVersion":"1579","creationTimestamp":"2022-03-18T18:06:25Z","labels":{"app.kubernetes.io/component":"rabbitmq","app.kubernetes.io/name":"rabbitmq-cluster","app.kubernetes.io/part-of":"rabbitmq"},"annotations":{"pv.kubernetes.io/bind-completed":"yes","pv.kubernetes.io/bound-by-controller":"yes","volume.beta.kubernetes.io/storage-provisioner":"hostpath.csi.k8s.io"},"ownerReferences":[{"apiVersion":"rabbitmq.com/v1beta1","kind":"RabbitmqCluster","name":"rabbitmq-cluster","uid":"3ecefa8a-1bec-48a7-9af4-dd0df3339101","controller":true,"blockOwnerDeletion":false}],"finalizers":["kubernetes.io/pvc-protection"],"managedFields":[{"manager":"kube-controller-manager","operation":"Update","apiVersion":"v1","time":"2022-03-18T18:06:25Z","fieldsType":"FieldsV1","fieldsV1":{"f:metadata":{"f:annotations":{".":{},"f:pv.kubernetes.io/bind-completed":{},"f:pv.kubernetes.io/bound-by-controller":{},"f:volume.beta.kubernetes.io/storage-provisioner":{}},"f:labels":{".":{},"f:app.kubernetes.io/component":{},"f:app.kubernetes.io/name":{},"f:app.kubernetes.io/part-of":{}},"f:ownerReferences":{".":{},"k:{\"uid\":\"3ecefa8a-1bec-48a7-9af4-dd0df3339101\"}":{".":{},"f:apiVersion":{},"f:blockOwnerDeletion":{},"f:controller":{},"f:kind":{},"f:name":{},"f:uid":{}}}},"f:spec":{"f:accessModes":{},"f:resources":{"f:requests":{}},"f:volumeMode":{},"f:volumeName":{}},"f:status":{"f:accessModes":{},"f:capacity":{},"f:phase":{}}}},{"manager":"manager","operation":"Update","apiVersion":"v1","time":"2022-03-18T18:07:34Z","fieldsType":"FieldsV1","fieldsV1":{"f:spec":{"f:resources":{"f:requests":{"f:storage":{}}}}}},{"manager":"kubelet","operation":"Update","apiVersion":"v1","time":"2022-03-18T18:07:58Z","fieldsType":"FieldsV1","fieldsV1":{"f:status":{"f:capacity":{"f:storage":{}}}}}]},"spec":{"accessModes":["ReadWriteOnce"],"resources":{"requests":{"storage":"15Gi"}},"volumeName":"pvc-2a49a40a-31f5-4d2b-ba65-716831e0fa6b","storageClassName":"csi-hostpath-sc","volumeMode":"Filesystem"},"status":{"phase":"Bound","accessModes":["ReadWriteOnce"],"capacity":{"storage":"15Gi"}}}
2022/03/18 18:07:58 learn_server.go:289: [SIEVE-AFTER-HEAR]	36
