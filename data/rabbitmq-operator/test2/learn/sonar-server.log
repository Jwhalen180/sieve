2021/04/09 01:04:10 registering rpc server...
2021/04/09 01:04:10 config:
map[crds:[rabbitmqcluster] mode:learn]
2021/04/09 01:04:10 learn
2021/04/09 01:04:10 start learnServer...
2021/04/09 01:04:10 setting up connection...
2021/04/09 01:04:13 no event happening
2021/04/09 01:04:16 no event happening
2021/04/09 01:04:19 no event happening
2021/04/09 01:04:22 no event happening
2021/04/09 01:04:25 no event happening
2021/04/09 01:04:28 no event happening
2021/04/09 01:04:31 no event happening
2021/04/09 01:04:34 no event happening
2021/04/09 01:04:37 no event happening
2021/04/09 01:04:40 no event happening
2021/04/09 01:04:43 no event happening
2021/04/09 01:04:46 no event happening
2021/04/09 01:04:49 no event happening
2021/04/09 01:04:52 no event happening
2021/04/09 01:04:55 no event happening
2021/04/09 01:04:58 no event happening
2021/04/09 01:05:01 no event happening
2021/04/09 01:05:04 no event happening
2021/04/09 01:05:07 no event happening
2021/04/09 01:05:10 no event happening
2021/04/09 01:05:13 no event happening
2021/04/09 01:05:16 no event happening
2021/04/09 01:05:19 no event happening
2021/04/09 01:05:22 no event happening
2021/04/09 01:05:25 no event happening
2021/04/09 01:05:28 no event happening
2021/04/09 01:05:31 no event happening
2021/04/09 01:05:34 no event happening
2021/04/09 01:05:37 no event happening
2021/04/09 01:05:40 no event happening
2021/04/09 01:05:43 no event happening
2021/04/09 01:05:46 no event happening
2021/04/09 01:05:49 no event happening
2021/04/09 01:05:52 no event happening
2021/04/09 01:05:55 no event happening
2021/04/09 01:05:58 no event happening
2021/04/09 01:06:01 no event happening
2021/04/09 01:06:04 no event happening
2021/04/09 01:06:07 [SONAR-EVENT]	0	Added	rabbitmqcluster	{"metadata":{"name":"sonar-rabbitmq-cluster","namespace":"default","selfLink":"/apis/rabbitmq.com/v1beta1/namespaces/default/rabbitmqclusters/sonar-rabbitmq-cluster","uid":"955a1113-f3fc-4efc-a6d1-b15ae324f7c0","resourceVersion":"1414","generation":1,"creationTimestamp":"2021-04-09T01:06:05Z","annotations":{"kubectl.kubernetes.io/last-applied-configuration":"{\"apiVersion\":\"rabbitmq.com/v1beta1\",\"kind\":\"RabbitmqCluster\",\"metadata\":{\"annotations\":{},\"name\":\"sonar-rabbitmq-cluster\",\"namespace\":\"default\"},\"spec\":{\"replicas\":1}}\n"},"managedFields":[{"manager":"kubectl-client-side-apply","operation":"Update","apiVersion":"rabbitmq.com/v1beta1","time":"2021-04-09T01:06:05Z","fieldsType":"FieldsV1","fieldsV1":{"f:metadata":{"f:annotations":{".":{},"f:kubectl.kubernetes.io/last-applied-configuration":{}}},"f:spec":{".":{},"f:image":{},"f:persistence":{".":{},"f:storage":{}},"f:replicas":{},"f:resources":{".":{},"f:limits":{".":{},"f:cpu":{},"f:memory":{}},"f:requests":{".":{},"f:cpu":{},"f:memory":{}}},"f:service":{".":{},"f:type":{}},"f:terminationGracePeriodSeconds":{}}}}]},"spec":{"replicas":1,"image":"rabbitmq:3.8.12-management","service":{"type":"ClusterIP"},"persistence":{"storage":"10Gi"},"resources":{"limits":{"cpu":"2","memory":"2Gi"},"requests":{"cpu":"1","memory":"2Gi"}},"rabbitmq":{},"tls":{},"override":{},"terminationGracePeriodSeconds":604800},"status":{"conditions":null}}
2021/04/09 01:06:07 [SONAR-START-RECONCILE]	rabbitmqcluster	0
2021/04/09 01:06:07 [SONAR-CACHE-READ]	Get	rabbitmqcluster	default	sonar-rabbitmq-cluster	NoError
2021/04/09 01:06:07 [SONAR-SIDE-EFFECT]	Update	rabbitmqcluster	default	sonar-rabbitmq-cluster	NoError
2021/04/09 01:06:07 [SONAR-CACHE-READ]	Get	statefulset	default	sonar-rabbitmq-cluster-server	NotFound
2021/04/09 01:06:07 [SONAR-CACHE-READ]	Get	endpoints	default	sonar-rabbitmq-cluster	NotFound
2021/04/09 01:06:07 [SONAR-CACHE-READ]	Get	statefulset	default	sonar-rabbitmq-cluster-server	NotFound
2021/04/09 01:06:07 [SONAR-CACHE-READ]	Get	service	default	sonar-rabbitmq-cluster-nodes	NotFound
2021/04/09 01:06:07 [SONAR-SIDE-EFFECT]	Create	service	default	sonar-rabbitmq-cluster-nodes	NoError
2021/04/09 01:06:10 [SONAR-EVENT]	1	Updated	rabbitmqcluster	{"metadata":{"name":"sonar-rabbitmq-cluster","namespace":"default","selfLink":"/apis/rabbitmq.com/v1beta1/namespaces/default/rabbitmqclusters/sonar-rabbitmq-cluster","uid":"955a1113-f3fc-4efc-a6d1-b15ae324f7c0","resourceVersion":"1423","generation":2,"creationTimestamp":"2021-04-09T01:06:05Z","annotations":{"kubectl.kubernetes.io/last-applied-configuration":"{\"apiVersion\":\"rabbitmq.com/v1beta1\",\"kind\":\"RabbitmqCluster\",\"metadata\":{\"annotations\":{},\"name\":\"sonar-rabbitmq-cluster\",\"namespace\":\"default\"},\"spec\":{\"replicas\":1}}\n"},"finalizers":["deletion.finalizers.rabbitmqclusters.rabbitmq.com"],"managedFields":[{"manager":"kubectl-client-side-apply","operation":"Update","apiVersion":"rabbitmq.com/v1beta1","time":"2021-04-09T01:06:05Z","fieldsType":"FieldsV1","fieldsV1":{"f:metadata":{"f:annotations":{".":{},"f:kubectl.kubernetes.io/last-applied-configuration":{}}},"f:spec":{".":{},"f:image":{},"f:persistence":{".":{},"f:storage":{}},"f:replicas":{},"f:resources":{".":{},"f:limits":{".":{},"f:memory":{}},"f:requests":{".":{},"f:memory":{}}},"f:service":{".":{},"f:type":{}},"f:terminationGracePeriodSeconds":{}}}},{"manager":"manager","operation":"Update","apiVersion":"rabbitmq.com/v1beta1","time":"2021-04-09T01:06:07Z","fieldsType":"FieldsV1","fieldsV1":{"f:metadata":{"f:finalizers":{}},"f:spec":{"f:override":{},"f:rabbitmq":{},"f:resources":{"f:limits":{"f:cpu":{}},"f:requests":{"f:cpu":{}}},"f:tls":{}},"f:status":{".":{},"f:conditions":{}}}}]},"spec":{"replicas":1,"image":"rabbitmq:3.8.12-management","service":{"type":"ClusterIP"},"persistence":{"storage":"10Gi"},"resources":{"limits":{"cpu":"2","memory":"2Gi"},"requests":{"cpu":"1","memory":"2Gi"}},"rabbitmq":{},"tls":{},"override":{},"terminationGracePeriodSeconds":604800},"status":{"conditions":null}}
2021/04/09 01:06:13 [SONAR-EVENT]	2	Added	service	{"metadata":{"name":"sonar-rabbitmq-cluster-nodes","namespace":"default","selfLink":"/api/v1/namespaces/default/services/sonar-rabbitmq-cluster-nodes","uid":"ee3590e9-0678-49e8-84f0-eea5f96ecbed","resourceVersion":"1425","creationTimestamp":"2021-04-09T01:06:07Z","labels":{"app.kubernetes.io/component":"rabbitmq","app.kubernetes.io/name":"sonar-rabbitmq-cluster","app.kubernetes.io/part-of":"rabbitmq"},"ownerReferences":[{"apiVersion":"rabbitmq.com/v1beta1","kind":"RabbitmqCluster","name":"sonar-rabbitmq-cluster","uid":"955a1113-f3fc-4efc-a6d1-b15ae324f7c0","controller":true,"blockOwnerDeletion":true}],"managedFields":[{"manager":"manager","operation":"Update","apiVersion":"v1","time":"2021-04-09T01:06:07Z","fieldsType":"FieldsV1","fieldsV1":{"f:metadata":{"f:labels":{".":{},"f:app.kubernetes.io/component":{},"f:app.kubernetes.io/name":{},"f:app.kubernetes.io/part-of":{}},"f:ownerReferences":{".":{},"k:{\"uid\":\"955a1113-f3fc-4efc-a6d1-b15ae324f7c0\"}":{".":{},"f:apiVersion":{},"f:blockOwnerDeletion":{},"f:controller":{},"f:kind":{},"f:name":{},"f:uid":{}}}},"f:spec":{"f:clusterIP":{},"f:ports":{".":{},"k:{\"port\":4369,\"protocol\":\"TCP\"}":{".":{},"f:name":{},"f:port":{},"f:protocol":{},"f:targetPort":{}},"k:{\"port\":25672,\"protocol\":\"TCP\"}":{".":{},"f:name":{},"f:port":{},"f:protocol":{},"f:targetPort":{}}},"f:publishNotReadyAddresses":{},"f:selector":{".":{},"f:app.kubernetes.io/name":{}},"f:sessionAffinity":{},"f:type":{}}}}]},"spec":{"ports":[{"name":"epmd","protocol":"TCP","port":4369,"targetPort":4369},{"name":"cluster-rpc","protocol":"TCP","port":25672,"targetPort":25672}],"selector":{"app.kubernetes.io/name":"sonar-rabbitmq-cluster"},"clusterIP":"None","type":"ClusterIP","sessionAffinity":"None","publishNotReadyAddresses":true},"status":{"loadBalancer":{}}}
2021/04/09 01:06:13 [SONAR-CACHE-READ]	Get	service	default	sonar-rabbitmq-cluster	NotFound
2021/04/09 01:06:13 [SONAR-SIDE-EFFECT]	Create	service	default	sonar-rabbitmq-cluster	NoError
2021/04/09 01:06:13 [SONAR-CACHE-READ]	Get	secret	default	sonar-rabbitmq-cluster-erlang-cookie	NotFound
2021/04/09 01:06:13 [SONAR-SIDE-EFFECT]	Create	secret	default	sonar-rabbitmq-cluster-erlang-cookie	NoError
2021/04/09 01:06:16 [SONAR-EVENT]	3	Updated	rabbitmqcluster	{"metadata":{"name":"sonar-rabbitmq-cluster","namespace":"default","selfLink":"/apis/rabbitmq.com/v1beta1/namespaces/default/rabbitmqclusters/sonar-rabbitmq-cluster","uid":"955a1113-f3fc-4efc-a6d1-b15ae324f7c0","resourceVersion":"1424","generation":2,"creationTimestamp":"2021-04-09T01:06:05Z","annotations":{"kubectl.kubernetes.io/last-applied-configuration":"{\"apiVersion\":\"rabbitmq.com/v1beta1\",\"kind\":\"RabbitmqCluster\",\"metadata\":{\"annotations\":{},\"name\":\"sonar-rabbitmq-cluster\",\"namespace\":\"default\"},\"spec\":{\"replicas\":1}}\n"},"finalizers":["deletion.finalizers.rabbitmqclusters.rabbitmq.com"],"managedFields":[{"manager":"kubectl-client-side-apply","operation":"Update","apiVersion":"rabbitmq.com/v1beta1","time":"2021-04-09T01:06:05Z","fieldsType":"FieldsV1","fieldsV1":{"f:metadata":{"f:annotations":{".":{},"f:kubectl.kubernetes.io/last-applied-configuration":{}}},"f:spec":{".":{},"f:image":{},"f:persistence":{".":{},"f:storage":{}},"f:replicas":{},"f:resources":{".":{},"f:limits":{".":{},"f:memory":{}},"f:requests":{".":{},"f:memory":{}}},"f:service":{".":{},"f:type":{}},"f:terminationGracePeriodSeconds":{}}}},{"manager":"manager","operation":"Update","apiVersion":"rabbitmq.com/v1beta1","time":"2021-04-09T01:06:07Z","fieldsType":"FieldsV1","fieldsV1":{"f:metadata":{"f:finalizers":{}},"f:spec":{"f:override":{},"f:rabbitmq":{},"f:resources":{"f:limits":{"f:cpu":{}},"f:requests":{"f:cpu":{}}},"f:tls":{}},"f:status":{".":{},"f:conditions":{}}}}]},"spec":{"replicas":1,"image":"rabbitmq:3.8.12-management","service":{"type":"ClusterIP"},"persistence":{"storage":"10Gi"},"resources":{"limits":{"cpu":"2","memory":"2Gi"},"requests":{"cpu":"1","memory":"2Gi"}},"rabbitmq":{},"tls":{},"override":{},"terminationGracePeriodSeconds":604800},"status":{"conditions":[{"type":"AllReplicasReady","status":"Unknown","lastTransitionTime":"2021-04-09T01:06:07Z","reason":"MissingStatefulSet","message":"Could not find StatefulSet"},{"type":"ClusterAvailable","status":"Unknown","lastTransitionTime":"2021-04-09T01:06:07Z","reason":"CouldNotRetrieveEndpoints","message":"Could not verify available service endpoints"},{"type":"NoWarnings","status":"Unknown","lastTransitionTime":"2021-04-09T01:06:07Z","reason":"MissingStatefulSet","message":"Could not find StatefulSet"},{"type":"ReconcileSuccess","status":"Unknown","lastTransitionTime":"2021-04-09T01:06:07Z","reason":"Initialising"}]}}
2021/04/09 01:06:19 [SONAR-EVENT]	4	Added	service	{"metadata":{"name":"sonar-rabbitmq-cluster","namespace":"default","selfLink":"/api/v1/namespaces/default/services/sonar-rabbitmq-cluster","uid":"809f9589-df72-4fc2-9132-f6c38665a517","resourceVersion":"1460","creationTimestamp":"2021-04-09T01:06:13Z","labels":{"app.kubernetes.io/component":"rabbitmq","app.kubernetes.io/name":"sonar-rabbitmq-cluster","app.kubernetes.io/part-of":"rabbitmq"},"ownerReferences":[{"apiVersion":"rabbitmq.com/v1beta1","kind":"RabbitmqCluster","name":"sonar-rabbitmq-cluster","uid":"955a1113-f3fc-4efc-a6d1-b15ae324f7c0","controller":true,"blockOwnerDeletion":true}],"managedFields":[{"manager":"manager","operation":"Update","apiVersion":"v1","time":"2021-04-09T01:06:13Z","fieldsType":"FieldsV1","fieldsV1":{"f:metadata":{"f:labels":{".":{},"f:app.kubernetes.io/component":{},"f:app.kubernetes.io/name":{},"f:app.kubernetes.io/part-of":{}},"f:ownerReferences":{".":{},"k:{\"uid\":\"955a1113-f3fc-4efc-a6d1-b15ae324f7c0\"}":{".":{},"f:apiVersion":{},"f:blockOwnerDeletion":{},"f:controller":{},"f:kind":{},"f:name":{},"f:uid":{}}}},"f:spec":{"f:ports":{".":{},"k:{\"port\":5672,\"protocol\":\"TCP\"}":{".":{},"f:name":{},"f:port":{},"f:protocol":{},"f:targetPort":{}},"k:{\"port\":15672,\"protocol\":\"TCP\"}":{".":{},"f:name":{},"f:port":{},"f:protocol":{},"f:targetPort":{}}},"f:selector":{".":{},"f:app.kubernetes.io/name":{}},"f:sessionAffinity":{},"f:type":{}}}}]},"spec":{"ports":[{"name":"amqp","protocol":"TCP","port":5672,"targetPort":5672},{"name":"management","protocol":"TCP","port":15672,"targetPort":15672}],"selector":{"app.kubernetes.io/name":"sonar-rabbitmq-cluster"},"clusterIP":"10.96.207.206","type":"ClusterIP","sessionAffinity":"None"},"status":{"loadBalancer":{}}}
2021/04/09 01:06:22 [SONAR-EVENT]	5	Added	secret	{"metadata":{"name":"sonar-rabbitmq-cluster-erlang-cookie","namespace":"default","selfLink":"/api/v1/namespaces/default/secrets/sonar-rabbitmq-cluster-erlang-cookie","uid":"4535fd65-6b63-4654-9516-54562f59aeba","resourceVersion":"1464","creationTimestamp":"2021-04-09T01:06:13Z","labels":{"app.kubernetes.io/component":"rabbitmq","app.kubernetes.io/name":"sonar-rabbitmq-cluster","app.kubernetes.io/part-of":"rabbitmq"},"ownerReferences":[{"apiVersion":"rabbitmq.com/v1beta1","kind":"RabbitmqCluster","name":"sonar-rabbitmq-cluster","uid":"955a1113-f3fc-4efc-a6d1-b15ae324f7c0","controller":true,"blockOwnerDeletion":true}],"managedFields":[{"manager":"manager","operation":"Update","apiVersion":"v1","time":"2021-04-09T01:06:13Z","fieldsType":"FieldsV1","fieldsV1":{"f:data":{".":{},"f:.erlang.cookie":{}},"f:metadata":{"f:labels":{".":{},"f:app.kubernetes.io/component":{},"f:app.kubernetes.io/name":{},"f:app.kubernetes.io/part-of":{}},"f:ownerReferences":{".":{},"k:{\"uid\":\"955a1113-f3fc-4efc-a6d1-b15ae324f7c0\"}":{".":{},"f:apiVersion":{},"f:blockOwnerDeletion":{},"f:controller":{},"f:kind":{},"f:name":{},"f:uid":{}}}},"f:type":{}}}]},"data":{".erlang.cookie":"VlhkbkRsR2hnZEI5OHBCTUpOZ1FNaFVtdi1vdFNQbnY="},"type":"Opaque"}
2021/04/09 01:06:22 [SONAR-CACHE-READ]	Get	secret	default	sonar-rabbitmq-cluster-default-user	NotFound
2021/04/09 01:06:22 [SONAR-SIDE-EFFECT]	Create	secret	default	sonar-rabbitmq-cluster-default-user	NoError
2021/04/09 01:06:22 [SONAR-CACHE-READ]	Get	configmap	default	sonar-rabbitmq-cluster-plugins-conf	NotFound
2021/04/09 01:06:22 [SONAR-SIDE-EFFECT]	Create	configmap	default	sonar-rabbitmq-cluster-plugins-conf	NoError
2021/04/09 01:06:25 [SONAR-EVENT]	6	Added	secret	{"metadata":{"name":"sonar-rabbitmq-cluster-default-user","namespace":"default","selfLink":"/api/v1/namespaces/default/secrets/sonar-rabbitmq-cluster-default-user","uid":"080f81b2-89a6-47d3-86e3-b9cf8aeb5080","resourceVersion":"1511","creationTimestamp":"2021-04-09T01:06:22Z","labels":{"app.kubernetes.io/component":"rabbitmq","app.kubernetes.io/name":"sonar-rabbitmq-cluster","app.kubernetes.io/part-of":"rabbitmq"},"ownerReferences":[{"apiVersion":"rabbitmq.com/v1beta1","kind":"RabbitmqCluster","name":"sonar-rabbitmq-cluster","uid":"955a1113-f3fc-4efc-a6d1-b15ae324f7c0","controller":true,"blockOwnerDeletion":true}],"managedFields":[{"manager":"manager","operation":"Update","apiVersion":"v1","time":"2021-04-09T01:06:22Z","fieldsType":"FieldsV1","fieldsV1":{"f:data":{".":{},"f:default_user.conf":{},"f:password":{},"f:provider":{},"f:type":{},"f:username":{}},"f:metadata":{"f:labels":{".":{},"f:app.kubernetes.io/component":{},"f:app.kubernetes.io/name":{},"f:app.kubernetes.io/part-of":{}},"f:ownerReferences":{".":{},"k:{\"uid\":\"955a1113-f3fc-4efc-a6d1-b15ae324f7c0\"}":{".":{},"f:apiVersion":{},"f:blockOwnerDeletion":{},"f:controller":{},"f:kind":{},"f:name":{},"f:uid":{}}}},"f:type":{}}}]},"data":{"default_user.conf":"ZGVmYXVsdF91c2VyID0gODJ6SW9ZUkhEWDVOOVFsS1VmdUxnTFBjYlZKWDVnbnEKZGVmYXVsdF9wYXNzID0gQmFWN1hFaU4zWXZTMUtuY0VrTmJwVEM0cWRucURja2kK","password":"QmFWN1hFaU4zWXZTMUtuY0VrTmJwVEM0cWRucURja2k=","provider":"cmFiYml0bXE=","type":"cmFiYml0bXE=","username":"ODJ6SW9ZUkhEWDVOOVFsS1VmdUxnTFBjYlZKWDVnbnE="},"type":"Opaque"}
2021/04/09 01:06:28 [SONAR-EVENT]	7	Added	configmap	{"metadata":{"name":"sonar-rabbitmq-cluster-plugins-conf","namespace":"default","selfLink":"/api/v1/namespaces/default/configmaps/sonar-rabbitmq-cluster-plugins-conf","uid":"6464a6f2-9ba9-48de-acaa-d280f33efc04","resourceVersion":"1513","creationTimestamp":"2021-04-09T01:06:22Z","labels":{"app.kubernetes.io/component":"rabbitmq","app.kubernetes.io/name":"sonar-rabbitmq-cluster","app.kubernetes.io/part-of":"rabbitmq"},"ownerReferences":[{"apiVersion":"rabbitmq.com/v1beta1","kind":"RabbitmqCluster","name":"sonar-rabbitmq-cluster","uid":"955a1113-f3fc-4efc-a6d1-b15ae324f7c0","controller":true,"blockOwnerDeletion":true}],"managedFields":[{"manager":"manager","operation":"Update","apiVersion":"v1","time":"2021-04-09T01:06:22Z","fieldsType":"FieldsV1","fieldsV1":{"f:data":{".":{},"f:enabled_plugins":{}},"f:metadata":{"f:labels":{".":{},"f:app.kubernetes.io/component":{},"f:app.kubernetes.io/name":{},"f:app.kubernetes.io/part-of":{}},"f:ownerReferences":{".":{},"k:{\"uid\":\"955a1113-f3fc-4efc-a6d1-b15ae324f7c0\"}":{".":{},"f:apiVersion":{},"f:blockOwnerDeletion":{},"f:controller":{},"f:kind":{},"f:name":{},"f:uid":{}}}}}}]},"data":{"enabled_plugins":"[rabbitmq_peer_discovery_k8s,rabbitmq_prometheus,rabbitmq_management]."}}
2021/04/09 01:06:28 [SONAR-CACHE-READ]	Get	configmap	default	sonar-rabbitmq-cluster-server-conf	NotFound
2021/04/09 01:06:28 [SONAR-SIDE-EFFECT]	Create	configmap	default	sonar-rabbitmq-cluster-server-conf	NoError
2021/04/09 01:06:28 [SONAR-CACHE-READ]	Get	serviceaccount	default	sonar-rabbitmq-cluster-server	NotFound
2021/04/09 01:06:28 [SONAR-SIDE-EFFECT]	Create	serviceaccount	default	sonar-rabbitmq-cluster-server	NoError
2021/04/09 01:06:28 [SONAR-CACHE-READ]	Get	role	default	sonar-rabbitmq-cluster-peer-discovery	NotFound
2021/04/09 01:06:28 [SONAR-SIDE-EFFECT]	Create	role	default	sonar-rabbitmq-cluster-peer-discovery	NoError
2021/04/09 01:06:28 [SONAR-CACHE-READ]	Get	rolebinding	default	sonar-rabbitmq-cluster-server	NotFound
2021/04/09 01:06:28 [SONAR-SIDE-EFFECT]	Create	rolebinding	default	sonar-rabbitmq-cluster-server	NoError
2021/04/09 01:06:28 [SONAR-CACHE-READ]	Get	statefulset	default	sonar-rabbitmq-cluster-server	NotFound
2021/04/09 01:06:28 [SONAR-CACHE-READ]	Get	statefulset	default	sonar-rabbitmq-cluster-server	NotFound
2021/04/09 01:06:28 [SONAR-SIDE-EFFECT]	Create	statefulset	default	sonar-rabbitmq-cluster-server	NoError
2021/04/09 01:06:31 [SONAR-EVENT]	8	Added	configmap	{"metadata":{"name":"sonar-rabbitmq-cluster-server-conf","namespace":"default","selfLink":"/api/v1/namespaces/default/configmaps/sonar-rabbitmq-cluster-server-conf","uid":"cbb78d33-7300-4456-b883-a4ec9652d4a5","resourceVersion":"1537","creationTimestamp":"2021-04-09T01:06:28Z","labels":{"app.kubernetes.io/component":"rabbitmq","app.kubernetes.io/name":"sonar-rabbitmq-cluster","app.kubernetes.io/part-of":"rabbitmq"},"ownerReferences":[{"apiVersion":"rabbitmq.com/v1beta1","kind":"RabbitmqCluster","name":"sonar-rabbitmq-cluster","uid":"955a1113-f3fc-4efc-a6d1-b15ae324f7c0","controller":true,"blockOwnerDeletion":true}],"managedFields":[{"manager":"manager","operation":"Update","apiVersion":"v1","time":"2021-04-09T01:06:28Z","fieldsType":"FieldsV1","fieldsV1":{"f:data":{".":{},"f:operatorDefaults.conf":{},"f:userDefinedConfiguration.conf":{}},"f:metadata":{"f:labels":{".":{},"f:app.kubernetes.io/component":{},"f:app.kubernetes.io/name":{},"f:app.kubernetes.io/part-of":{}},"f:ownerReferences":{".":{},"k:{\"uid\":\"955a1113-f3fc-4efc-a6d1-b15ae324f7c0\"}":{".":{},"f:apiVersion":{},"f:blockOwnerDeletion":{},"f:controller":{},"f:kind":{},"f:name":{},"f:uid":{}}}}}}]},"data":{"operatorDefaults.conf":"cluster_formation.peer_discovery_backend             = rabbit_peer_discovery_k8s\ncluster_formation.k8s.host                           = kubernetes.default\ncluster_formation.k8s.address_type                   = hostname\ncluster_partition_handling                           = pause_minority\nqueue_master_locator                                 = min-masters\ndisk_free_limit.absolute                             = 2GB\ncluster_formation.randomized_startup_delay_range.min = 5\ncluster_formation.randomized_startup_delay_range.max = 30\ncluster_name                                         = sonar-rabbitmq-cluster\n","userDefinedConfiguration.conf":"total_memory_available_override_value = 1717986919\n"}}
2021/04/09 01:06:34 [SONAR-EVENT]	9	Added	serviceaccount	{"metadata":{"name":"sonar-rabbitmq-cluster-server","namespace":"default","selfLink":"/api/v1/namespaces/default/serviceaccounts/sonar-rabbitmq-cluster-server","uid":"d96018aa-e1dd-4a37-8b4e-9e940df5b44a","resourceVersion":"1539","creationTimestamp":"2021-04-09T01:06:28Z","labels":{"app.kubernetes.io/component":"rabbitmq","app.kubernetes.io/name":"sonar-rabbitmq-cluster","app.kubernetes.io/part-of":"rabbitmq"},"ownerReferences":[{"apiVersion":"rabbitmq.com/v1beta1","kind":"RabbitmqCluster","name":"sonar-rabbitmq-cluster","uid":"955a1113-f3fc-4efc-a6d1-b15ae324f7c0","controller":true,"blockOwnerDeletion":true}],"managedFields":[{"manager":"manager","operation":"Update","apiVersion":"v1","time":"2021-04-09T01:06:28Z","fieldsType":"FieldsV1","fieldsV1":{"f:metadata":{"f:labels":{".":{},"f:app.kubernetes.io/component":{},"f:app.kubernetes.io/name":{},"f:app.kubernetes.io/part-of":{}},"f:ownerReferences":{".":{},"k:{\"uid\":\"955a1113-f3fc-4efc-a6d1-b15ae324f7c0\"}":{".":{},"f:apiVersion":{},"f:blockOwnerDeletion":{},"f:controller":{},"f:kind":{},"f:name":{},"f:uid":{}}}}}}]}}
2021/04/09 01:06:37 [SONAR-EVENT]	10	Added	role	{"metadata":{"name":"sonar-rabbitmq-cluster-peer-discovery","namespace":"default","selfLink":"/apis/rbac.authorization.k8s.io/v1/namespaces/default/roles/sonar-rabbitmq-cluster-peer-discovery","uid":"259888f2-9357-41c8-a364-09e8d77d880e","resourceVersion":"1543","creationTimestamp":"2021-04-09T01:06:28Z","labels":{"app.kubernetes.io/component":"rabbitmq","app.kubernetes.io/name":"sonar-rabbitmq-cluster","app.kubernetes.io/part-of":"rabbitmq"},"ownerReferences":[{"apiVersion":"rabbitmq.com/v1beta1","kind":"RabbitmqCluster","name":"sonar-rabbitmq-cluster","uid":"955a1113-f3fc-4efc-a6d1-b15ae324f7c0","controller":true,"blockOwnerDeletion":true}],"managedFields":[{"manager":"manager","operation":"Update","apiVersion":"rbac.authorization.k8s.io/v1","time":"2021-04-09T01:06:28Z","fieldsType":"FieldsV1","fieldsV1":{"f:metadata":{"f:labels":{".":{},"f:app.kubernetes.io/component":{},"f:app.kubernetes.io/name":{},"f:app.kubernetes.io/part-of":{}},"f:ownerReferences":{".":{},"k:{\"uid\":\"955a1113-f3fc-4efc-a6d1-b15ae324f7c0\"}":{".":{},"f:apiVersion":{},"f:blockOwnerDeletion":{},"f:controller":{},"f:kind":{},"f:name":{},"f:uid":{}}}},"f:rules":{}}}]},"rules":[{"verbs":["get"],"apiGroups":[""],"resources":["endpoints"]},{"verbs":["create"],"apiGroups":[""],"resources":["events"]}]}
2021/04/09 01:06:40 [SONAR-EVENT]	11	Added	rolebinding	{"metadata":{"name":"sonar-rabbitmq-cluster-server","namespace":"default","selfLink":"/apis/rbac.authorization.k8s.io/v1/namespaces/default/rolebindings/sonar-rabbitmq-cluster-server","uid":"ab6c066b-784f-419f-a00a-f90af504077b","resourceVersion":"1545","creationTimestamp":"2021-04-09T01:06:28Z","labels":{"app.kubernetes.io/component":"rabbitmq","app.kubernetes.io/name":"sonar-rabbitmq-cluster","app.kubernetes.io/part-of":"rabbitmq"},"ownerReferences":[{"apiVersion":"rabbitmq.com/v1beta1","kind":"RabbitmqCluster","name":"sonar-rabbitmq-cluster","uid":"955a1113-f3fc-4efc-a6d1-b15ae324f7c0","controller":true,"blockOwnerDeletion":true}],"managedFields":[{"manager":"manager","operation":"Update","apiVersion":"rbac.authorization.k8s.io/v1","time":"2021-04-09T01:06:28Z","fieldsType":"FieldsV1","fieldsV1":{"f:metadata":{"f:labels":{".":{},"f:app.kubernetes.io/component":{},"f:app.kubernetes.io/name":{},"f:app.kubernetes.io/part-of":{}},"f:ownerReferences":{".":{},"k:{\"uid\":\"955a1113-f3fc-4efc-a6d1-b15ae324f7c0\"}":{".":{},"f:apiVersion":{},"f:blockOwnerDeletion":{},"f:controller":{},"f:kind":{},"f:name":{},"f:uid":{}}}},"f:roleRef":{"f:apiGroup":{},"f:kind":{},"f:name":{}},"f:subjects":{}}}]},"subjects":[{"kind":"ServiceAccount","name":"sonar-rabbitmq-cluster-server"}],"roleRef":{"apiGroup":"rbac.authorization.k8s.io","kind":"Role","name":"sonar-rabbitmq-cluster-peer-discovery"}}
2021/04/09 01:06:43 [SONAR-EVENT]	12	Added	statefulset	{"metadata":{"name":"sonar-rabbitmq-cluster-server","namespace":"default","selfLink":"/apis/apps/v1/namespaces/default/statefulsets/sonar-rabbitmq-cluster-server","uid":"82dfe424-f051-485c-8d8d-010eec6463c3","resourceVersion":"1547","generation":1,"creationTimestamp":"2021-04-09T01:06:28Z","labels":{"app.kubernetes.io/component":"rabbitmq","app.kubernetes.io/name":"sonar-rabbitmq-cluster","app.kubernetes.io/part-of":"rabbitmq"},"ownerReferences":[{"apiVersion":"rabbitmq.com/v1beta1","kind":"RabbitmqCluster","name":"sonar-rabbitmq-cluster","uid":"955a1113-f3fc-4efc-a6d1-b15ae324f7c0","controller":true,"blockOwnerDeletion":true}],"managedFields":[{"manager":"manager","operation":"Update","apiVersion":"apps/v1","time":"2021-04-09T01:06:28Z","fieldsType":"FieldsV1","fieldsV1":{"f:metadata":{"f:labels":{".":{},"f:app.kubernetes.io/component":{},"f:app.kubernetes.io/name":{},"f:app.kubernetes.io/part-of":{}},"f:ownerReferences":{".":{},"k:{\"uid\":\"955a1113-f3fc-4efc-a6d1-b15ae324f7c0\"}":{".":{},"f:apiVersion":{},"f:blockOwnerDeletion":{},"f:controller":{},"f:kind":{},"f:name":{},"f:uid":{}}}},"f:spec":{"f:podManagementPolicy":{},"f:replicas":{},"f:revisionHistoryLimit":{},"f:selector":{"f:matchLabels":{".":{},"f:app.kubernetes.io/name":{}}},"f:serviceName":{},"f:template":{"f:metadata":{"f:annotations":{".":{},"f:prometheus.io/port":{},"f:prometheus.io/scrape":{}},"f:labels":{".":{},"f:app.kubernetes.io/component":{},"f:app.kubernetes.io/name":{},"f:app.kubernetes.io/part-of":{}}},"f:spec":{"f:automountServiceAccountToken":{},"f:containers":{"k:{\"name\":\"rabbitmq\"}":{".":{},"f:env":{".":{},"k:{\"name\":\"K8S_HOSTNAME_SUFFIX\"}":{".":{},"f:name":{},"f:value":{}},"k:{\"name\":\"K8S_SERVICE_NAME\"}":{".":{},"f:name":{},"f:value":{}},"k:{\"name\":\"MY_POD_NAME\"}":{".":{},"f:name":{},"f:valueFrom":{".":{},"f:fieldRef":{".":{},"f:apiVersion":{},"f:fieldPath":{}}}},"k:{\"name\":\"MY_POD_NAMESPACE\"}":{".":{},"f:name":{},"f:valueFrom":{".":{},"f:fieldRef":{".":{},"f:apiVersion":{},"f:fieldPath":{}}}},"k:{\"name\":\"RABBITMQ_ENABLED_PLUGINS_FILE\"}":{".":{},"f:name":{},"f:value":{}},"k:{\"name\":\"RABBITMQ_NODENAME\"}":{".":{},"f:name":{},"f:value":{}},"k:{\"name\":\"RABBITMQ_USE_LONGNAME\"}":{".":{},"f:name":{},"f:value":{}}},"f:image":{},"f:imagePullPolicy":{},"f:lifecycle":{".":{},"f:preStop":{".":{},"f:exec":{".":{},"f:command":{}}}},"f:name":{},"f:ports":{".":{},"k:{\"containerPort\":4369,\"protocol\":\"TCP\"}":{".":{},"f:containerPort":{},"f:name":{},"f:protocol":{}},"k:{\"containerPort\":5672,\"protocol\":\"TCP\"}":{".":{},"f:containerPort":{},"f:name":{},"f:protocol":{}},"k:{\"containerPort\":15672,\"protocol\":\"TCP\"}":{".":{},"f:containerPort":{},"f:name":{},"f:protocol":{}},"k:{\"containerPort\":15692,\"protocol\":\"TCP\"}":{".":{},"f:containerPort":{},"f:name":{},"f:protocol":{}}},"f:readinessProbe":{".":{},"f:failureThreshold":{},"f:initialDelaySeconds":{},"f:periodSeconds":{},"f:successThreshold":{},"f:tcpSocket":{".":{},"f:port":{}},"f:timeoutSeconds":{}},"f:resources":{".":{},"f:limits":{".":{},"f:cpu":{},"f:memory":{}},"f:requests":{".":{},"f:cpu":{},"f:memory":{}}},"f:terminationMessagePath":{},"f:terminationMessagePolicy":{},"f:volumeMounts":{".":{},"k:{\"mountPath\":\"/etc/pod-info/\"}":{".":{},"f:mountPath":{},"f:name":{}},"k:{\"mountPath\":\"/etc/rabbitmq/conf.d/10-operatorDefaults.conf\"}":{".":{},"f:mountPath":{},"f:name":{},"f:subPath":{}},"k:{\"mountPath\":\"/etc/rabbitmq/conf.d/11-default_user.conf\"}":{".":{},"f:mountPath":{},"f:name":{},"f:subPath":{}},"k:{\"mountPath\":\"/etc/rabbitmq/conf.d/90-userDefinedConfiguration.conf\"}":{".":{},"f:mountPath":{},"f:name":{},"f:subPath":{}},"k:{\"mountPath\":\"/operator\"}":{".":{},"f:mountPath":{},"f:name":{}},"k:{\"mountPath\":\"/var/lib/rabbitmq/\"}":{".":{},"f:mountPath":{},"f:name":{}},"k:{\"mountPath\":\"/var/lib/rabbitmq/mnesia/\"}":{".":{},"f:mountPath":{},"f:name":{}}}}},"f:dnsPolicy":{},"f:initContainers":{".":{},"k:{\"name\":\"setup-container\"}":{".":{},"f:command":{},"f:image":{},"f:imagePullPolicy":{},"f:name":{},"f:resources":{".":{},"f:limits":{".":{},"f:cpu":{},"f:memory":{}},"f:requests":{".":{},"f:cpu":{},"f:memory":{}}},"f:securityContext":{".":{},"f:capabilities":{".":{},"f:drop":{}},"f:runAsUser":{}},"f:terminationMessagePath":{},"f:terminationMessagePolicy":{},"f:volumeMounts":{".":{},"k:{\"mountPath\":\"/operator\"}":{".":{},"f:mountPath":{},"f:name":{}},"k:{\"mountPath\":\"/tmp/default_user.conf\"}":{".":{},"f:mountPath":{},"f:name":{},"f:subPath":{}},"k:{\"mountPath\":\"/tmp/erlang-cookie-secret/\"}":{".":{},"f:mountPath":{},"f:name":{}},"k:{\"mountPath\":\"/tmp/rabbitmq-plugins/\"}":{".":{},"f:mountPath":{},"f:name":{}},"k:{\"mountPath\":\"/var/lib/rabbitmq/\"}":{".":{},"f:mountPath":{},"f:name":{}},"k:{\"mountPath\":\"/var/lib/rabbitmq/mnesia/\"}":{".":{},"f:mountPath":{},"f:name":{}}}}},"f:restartPolicy":{},"f:schedulerName":{},"f:securityContext":{".":{},"f:fsGroup":{},"f:runAsGroup":{},"f:runAsUser":{}},"f:serviceAccount":{},"f:serviceAccountName":{},"f:terminationGracePeriodSeconds":{},"f:topologySpreadConstraints":{".":{},"k:{\"topologyKey\":\"topology.kubernetes.io/zone\",\"whenUnsatisfiable\":\"ScheduleAnyway\"}":{".":{},"f:labelSelector":{".":{},"f:matchLabels":{".":{},"f:app.kubernetes.io/name":{}}},"f:maxSkew":{},"f:topologyKey":{},"f:whenUnsatisfiable":{}}},"f:volumes":{".":{},"k:{\"name\":\"erlang-cookie-secret\"}":{".":{},"f:name":{},"f:secret":{".":{},"f:defaultMode":{},"f:secretName":{}}},"k:{\"name\":\"plugins-conf\"}":{".":{},"f:configMap":{".":{},"f:defaultMode":{},"f:name":{}},"f:name":{}},"k:{\"name\":\"pod-info\"}":{".":{},"f:downwardAPI":{".":{},"f:defaultMode":{},"f:items":{}},"f:name":{}},"k:{\"name\":\"rabbitmq-confd\"}":{".":{},"f:name":{},"f:projected":{".":{},"f:defaultMode":{},"f:sources":{}}},"k:{\"name\":\"rabbitmq-erlang-cookie\"}":{".":{},"f:emptyDir":{},"f:name":{}},"k:{\"name\":\"rabbitmq-plugins\"}":{".":{},"f:emptyDir":{},"f:name":{}}}}},"f:updateStrategy":{"f:rollingUpdate":{".":{},"f:partition":{}},"f:type":{}},"f:volumeClaimTemplates":{}}}}]},"spec":{"replicas":1,"selector":{"matchLabels":{"app.kubernetes.io/name":"sonar-rabbitmq-cluster"}},"template":{"metadata":{"creationTimestamp":null,"labels":{"app.kubernetes.io/component":"rabbitmq","app.kubernetes.io/name":"sonar-rabbitmq-cluster","app.kubernetes.io/part-of":"rabbitmq"},"annotations":{"prometheus.io/port":"15692","prometheus.io/scrape":"true"}},"spec":{"volumes":[{"name":"plugins-conf","configMap":{"name":"sonar-rabbitmq-cluster-plugins-conf","defaultMode":420}},{"name":"rabbitmq-confd","projected":{"sources":[{"secret":{"name":"sonar-rabbitmq-cluster-default-user","items":[{"key":"default_user.conf","path":"default_user.conf"}]}},{"configMap":{"name":"sonar-rabbitmq-cluster-server-conf","items":[{"key":"operatorDefaults.conf","path":"operatorDefaults.conf"},{"key":"userDefinedConfiguration.conf","path":"userDefinedConfiguration.conf"}]}}],"defaultMode":420}},{"name":"rabbitmq-erlang-cookie","emptyDir":{}},{"name":"erlang-cookie-secret","secret":{"secretName":"sonar-rabbitmq-cluster-erlang-cookie","defaultMode":420}},{"name":"rabbitmq-plugins","emptyDir":{}},{"name":"pod-info","downwardAPI":{"items":[{"path":"skipPreStopChecks","fieldRef":{"apiVersion":"v1","fieldPath":"metadata.labels['skipPreStopChecks']"}}],"defaultMode":420}}],"initContainers":[{"name":"setup-container","image":"rabbitmq:3.8.12-management","command":["sh","-c","cp /tmp/erlang-cookie-secret/.erlang.cookie /var/lib/rabbitmq/.erlang.cookie \u0026\u0026 chown 999:999 /var/lib/rabbitmq/.erlang.cookie \u0026\u0026 chmod 600 /var/lib/rabbitmq/.erlang.cookie ; cp /tmp/rabbitmq-plugins/enabled_plugins /operator/enabled_plugins \u0026\u0026 chown 999:999 /operator/enabled_plugins ; chown 999:999 /var/lib/rabbitmq/mnesia/ ; echo '[default]' \u003e /var/lib/rabbitmq/.rabbitmqadmin.conf \u0026\u0026 sed -e 's/default_user/username/' -e 's/default_pass/password/' /tmp/default_user.conf \u003e\u003e /var/lib/rabbitmq/.rabbitmqadmin.conf \u0026\u0026 chown 999:999 /var/lib/rabbitmq/.rabbitmqadmin.conf \u0026\u0026 chmod 600 /var/lib/rabbitmq/.rabbitmqadmin.conf"],"resources":{"limits":{"cpu":"100m","memory":"500Mi"},"requests":{"cpu":"100m","memory":"500Mi"}},"volumeMounts":[{"name":"plugins-conf","mountPath":"/tmp/rabbitmq-plugins/"},{"name":"rabbitmq-erlang-cookie","mountPath":"/var/lib/rabbitmq/"},{"name":"erlang-cookie-secret","mountPath":"/tmp/erlang-cookie-secret/"},{"name":"rabbitmq-plugins","mountPath":"/operator"},{"name":"persistence","mountPath":"/var/lib/rabbitmq/mnesia/"},{"name":"rabbitmq-confd","mountPath":"/tmp/default_user.conf","subPath":"default_user.conf"}],"terminationMessagePath":"/dev/termination-log","terminationMessagePolicy":"File","imagePullPolicy":"IfNotPresent","securityContext":{"capabilities":{"drop":["FSETID","KILL","SETGID","SETUID","SETPCAP","NET_BIND_SERVICE","NET_RAW","SYS_CHROOT","MKNOD","AUDIT_WRITE","SETFCAP"]},"runAsUser":0}}],"containers":[{"name":"rabbitmq","image":"rabbitmq:3.8.12-management","ports":[{"name":"epmd","containerPort":4369,"protocol":"TCP"},{"name":"amqp","containerPort":5672,"protocol":"TCP"},{"name":"management","containerPort":15672,"protocol":"TCP"},{"name":"prometheus","containerPort":15692,"protocol":"TCP"}],"env":[{"name":"MY_POD_NAME","valueFrom":{"fieldRef":{"apiVersion":"v1","fieldPath":"metadata.name"}}},{"name":"MY_POD_NAMESPACE","valueFrom":{"fieldRef":{"apiVersion":"v1","fieldPath":"metadata.namespace"}}},{"name":"RABBITMQ_ENABLED_PLUGINS_FILE","value":"/operator/enabled_plugins"},{"name":"K8S_SERVICE_NAME","value":"sonar-rabbitmq-cluster-nodes"},{"name":"RABBITMQ_USE_LONGNAME","value":"true"},{"name":"RABBITMQ_NODENAME","value":"rabbit@$(MY_POD_NAME).$(K8S_SERVICE_NAME).$(MY_POD_NAMESPACE)"},{"name":"K8S_HOSTNAME_SUFFIX","value":".$(K8S_SERVICE_NAME).$(MY_POD_NAMESPACE)"}],"resources":{"limits":{"cpu":"2","memory":"2Gi"},"requests":{"cpu":"1","memory":"2Gi"}},"volumeMounts":[{"name":"rabbitmq-erlang-cookie","mountPath":"/var/lib/rabbitmq/"},{"name":"persistence","mountPath":"/var/lib/rabbitmq/mnesia/"},{"name":"rabbitmq-plugins","mountPath":"/operator"},{"name":"rabbitmq-confd","mountPath":"/etc/rabbitmq/conf.d/10-operatorDefaults.conf","subPath":"operatorDefaults.conf"},{"name":"rabbitmq-confd","mountPath":"/etc/rabbitmq/conf.d/11-default_user.conf","subPath":"default_user.conf"},{"name":"rabbitmq-confd","mountPath":"/etc/rabbitmq/conf.d/90-userDefinedConfiguration.conf","subPath":"userDefinedConfiguration.conf"},{"name":"pod-info","mountPath":"/etc/pod-info/"}],"readinessProbe":{"tcpSocket":{"port":"amqp"},"initialDelaySeconds":10,"timeoutSeconds":5,"periodSeconds":10,"successThreshold":1,"failureThreshold":3},"lifecycle":{"preStop":{"exec":{"command":["/bin/bash","-c","if [ ! -z \"$(cat /etc/pod-info/skipPreStopChecks)\" ]; then exit 0; fi; rabbitmq-upgrade await_online_quorum_plus_one -t 604800; rabbitmq-upgrade await_online_synchronized_mirror -t 604800; rabbitmq-upgrade drain -t 604800"]}}},"terminationMessagePath":"/dev/termination-log","terminationMessagePolicy":"File","imagePullPolicy":"IfNotPresent"}],"restartPolicy":"Always","terminationGracePeriodSeconds":604800,"dnsPolicy":"ClusterFirst","serviceAccountName":"sonar-rabbitmq-cluster-server","serviceAccount":"sonar-rabbitmq-cluster-server","automountServiceAccountToken":true,"securityContext":{"runAsUser":999,"runAsGroup":999,"fsGroup":999},"schedulerName":"default-scheduler","topologySpreadConstraints":[{"maxSkew":1,"topologyKey":"topology.kubernetes.io/zone","whenUnsatisfiable":"ScheduleAnyway","labelSelector":{"matchLabels":{"app.kubernetes.io/name":"sonar-rabbitmq-cluster"}}}]}},"volumeClaimTemplates":[{"metadata":{"name":"persistence","namespace":"default","creationTimestamp":null,"labels":{"app.kubernetes.io/component":"rabbitmq","app.kubernetes.io/name":"sonar-rabbitmq-cluster","app.kubernetes.io/part-of":"rabbitmq"},"ownerReferences":[{"apiVersion":"rabbitmq.com/v1beta1","kind":"RabbitmqCluster","name":"sonar-rabbitmq-cluster","uid":"955a1113-f3fc-4efc-a6d1-b15ae324f7c0","controller":true,"blockOwnerDeletion":false}]},"spec":{"accessModes":["ReadWriteOnce"],"resources":{"requests":{"storage":"10Gi"}},"volumeMode":"Filesystem"},"status":{"phase":"Pending"}}],"serviceName":"sonar-rabbitmq-cluster-nodes","podManagementPolicy":"Parallel","updateStrategy":{"type":"RollingUpdate","rollingUpdate":{"partition":0}},"revisionHistoryLimit":10},"status":{"replicas":0}}
2021/04/09 01:06:43 [SONAR-CACHE-READ]	Get	statefulset	default	sonar-rabbitmq-cluster-server	NoError
2021/04/09 01:06:43 [SONAR-SIDE-EFFECT]	Update	statefulset	default	sonar-rabbitmq-cluster-server	Conflict
2021/04/09 01:06:46 [SONAR-EVENT]	13	Updated	serviceaccount	{"metadata":{"name":"sonar-rabbitmq-cluster-server","namespace":"default","selfLink":"/api/v1/namespaces/default/serviceaccounts/sonar-rabbitmq-cluster-server","uid":"d96018aa-e1dd-4a37-8b4e-9e940df5b44a","resourceVersion":"1542","creationTimestamp":"2021-04-09T01:06:28Z","labels":{"app.kubernetes.io/component":"rabbitmq","app.kubernetes.io/name":"sonar-rabbitmq-cluster","app.kubernetes.io/part-of":"rabbitmq"},"ownerReferences":[{"apiVersion":"rabbitmq.com/v1beta1","kind":"RabbitmqCluster","name":"sonar-rabbitmq-cluster","uid":"955a1113-f3fc-4efc-a6d1-b15ae324f7c0","controller":true,"blockOwnerDeletion":true}],"managedFields":[{"manager":"kube-controller-manager","operation":"Update","apiVersion":"v1","time":"2021-04-09T01:06:28Z","fieldsType":"FieldsV1","fieldsV1":{"f:secrets":{".":{},"k:{\"name\":\"sonar-rabbitmq-cluster-server-token-sl858\"}":{".":{},"f:name":{}}}}},{"manager":"manager","operation":"Update","apiVersion":"v1","time":"2021-04-09T01:06:28Z","fieldsType":"FieldsV1","fieldsV1":{"f:metadata":{"f:labels":{".":{},"f:app.kubernetes.io/component":{},"f:app.kubernetes.io/name":{},"f:app.kubernetes.io/part-of":{}},"f:ownerReferences":{".":{},"k:{\"uid\":\"955a1113-f3fc-4efc-a6d1-b15ae324f7c0\"}":{".":{},"f:apiVersion":{},"f:blockOwnerDeletion":{},"f:controller":{},"f:kind":{},"f:name":{},"f:uid":{}}}}}}]},"secrets":[{"name":"sonar-rabbitmq-cluster-server-token-sl858"}]}
2021/04/09 01:06:49 [SONAR-EVENT]	14	Updated	statefulset	{"metadata":{"name":"sonar-rabbitmq-cluster-server","namespace":"default","selfLink":"/apis/apps/v1/namespaces/default/statefulsets/sonar-rabbitmq-cluster-server","uid":"82dfe424-f051-485c-8d8d-010eec6463c3","resourceVersion":"1558","generation":1,"creationTimestamp":"2021-04-09T01:06:28Z","labels":{"app.kubernetes.io/component":"rabbitmq","app.kubernetes.io/name":"sonar-rabbitmq-cluster","app.kubernetes.io/part-of":"rabbitmq"},"ownerReferences":[{"apiVersion":"rabbitmq.com/v1beta1","kind":"RabbitmqCluster","name":"sonar-rabbitmq-cluster","uid":"955a1113-f3fc-4efc-a6d1-b15ae324f7c0","controller":true,"blockOwnerDeletion":true}],"managedFields":[{"manager":"kube-controller-manager","operation":"Update","apiVersion":"apps/v1","time":"2021-04-09T01:06:28Z","fieldsType":"FieldsV1","fieldsV1":{"f:status":{"f:collisionCount":{},"f:currentReplicas":{},"f:currentRevision":{},"f:observedGeneration":{},"f:replicas":{},"f:updateRevision":{},"f:updatedReplicas":{}}}},{"manager":"manager","operation":"Update","apiVersion":"apps/v1","time":"2021-04-09T01:06:28Z","fieldsType":"FieldsV1","fieldsV1":{"f:metadata":{"f:labels":{".":{},"f:app.kubernetes.io/component":{},"f:app.kubernetes.io/name":{},"f:app.kubernetes.io/part-of":{}},"f:ownerReferences":{".":{},"k:{\"uid\":\"955a1113-f3fc-4efc-a6d1-b15ae324f7c0\"}":{".":{},"f:apiVersion":{},"f:blockOwnerDeletion":{},"f:controller":{},"f:kind":{},"f:name":{},"f:uid":{}}}},"f:spec":{"f:podManagementPolicy":{},"f:replicas":{},"f:revisionHistoryLimit":{},"f:selector":{"f:matchLabels":{".":{},"f:app.kubernetes.io/name":{}}},"f:serviceName":{},"f:template":{"f:metadata":{"f:annotations":{".":{},"f:prometheus.io/port":{},"f:prometheus.io/scrape":{}},"f:labels":{".":{},"f:app.kubernetes.io/component":{},"f:app.kubernetes.io/name":{},"f:app.kubernetes.io/part-of":{}}},"f:spec":{"f:automountServiceAccountToken":{},"f:containers":{"k:{\"name\":\"rabbitmq\"}":{".":{},"f:env":{".":{},"k:{\"name\":\"K8S_HOSTNAME_SUFFIX\"}":{".":{},"f:name":{},"f:value":{}},"k:{\"name\":\"K8S_SERVICE_NAME\"}":{".":{},"f:name":{},"f:value":{}},"k:{\"name\":\"MY_POD_NAME\"}":{".":{},"f:name":{},"f:valueFrom":{".":{},"f:fieldRef":{".":{},"f:apiVersion":{},"f:fieldPath":{}}}},"k:{\"name\":\"MY_POD_NAMESPACE\"}":{".":{},"f:name":{},"f:valueFrom":{".":{},"f:fieldRef":{".":{},"f:apiVersion":{},"f:fieldPath":{}}}},"k:{\"name\":\"RABBITMQ_ENABLED_PLUGINS_FILE\"}":{".":{},"f:name":{},"f:value":{}},"k:{\"name\":\"RABBITMQ_NODENAME\"}":{".":{},"f:name":{},"f:value":{}},"k:{\"name\":\"RABBITMQ_USE_LONGNAME\"}":{".":{},"f:name":{},"f:value":{}}},"f:image":{},"f:imagePullPolicy":{},"f:lifecycle":{".":{},"f:preStop":{".":{},"f:exec":{".":{},"f:command":{}}}},"f:name":{},"f:ports":{".":{},"k:{\"containerPort\":4369,\"protocol\":\"TCP\"}":{".":{},"f:containerPort":{},"f:name":{},"f:protocol":{}},"k:{\"containerPort\":5672,\"protocol\":\"TCP\"}":{".":{},"f:containerPort":{},"f:name":{},"f:protocol":{}},"k:{\"containerPort\":15672,\"protocol\":\"TCP\"}":{".":{},"f:containerPort":{},"f:name":{},"f:protocol":{}},"k:{\"containerPort\":15692,\"protocol\":\"TCP\"}":{".":{},"f:containerPort":{},"f:name":{},"f:protocol":{}}},"f:readinessProbe":{".":{},"f:failureThreshold":{},"f:initialDelaySeconds":{},"f:periodSeconds":{},"f:successThreshold":{},"f:tcpSocket":{".":{},"f:port":{}},"f:timeoutSeconds":{}},"f:resources":{".":{},"f:limits":{".":{},"f:cpu":{},"f:memory":{}},"f:requests":{".":{},"f:cpu":{},"f:memory":{}}},"f:terminationMessagePath":{},"f:terminationMessagePolicy":{},"f:volumeMounts":{".":{},"k:{\"mountPath\":\"/etc/pod-info/\"}":{".":{},"f:mountPath":{},"f:name":{}},"k:{\"mountPath\":\"/etc/rabbitmq/conf.d/10-operatorDefaults.conf\"}":{".":{},"f:mountPath":{},"f:name":{},"f:subPath":{}},"k:{\"mountPath\":\"/etc/rabbitmq/conf.d/11-default_user.conf\"}":{".":{},"f:mountPath":{},"f:name":{},"f:subPath":{}},"k:{\"mountPath\":\"/etc/rabbitmq/conf.d/90-userDefinedConfiguration.conf\"}":{".":{},"f:mountPath":{},"f:name":{},"f:subPath":{}},"k:{\"mountPath\":\"/operator\"}":{".":{},"f:mountPath":{},"f:name":{}},"k:{\"mountPath\":\"/var/lib/rabbitmq/\"}":{".":{},"f:mountPath":{},"f:name":{}},"k:{\"mountPath\":\"/var/lib/rabbitmq/mnesia/\"}":{".":{},"f:mountPath":{},"f:name":{}}}}},"f:dnsPolicy":{},"f:initContainers":{".":{},"k:{\"name\":\"setup-container\"}":{".":{},"f:command":{},"f:image":{},"f:imagePullPolicy":{},"f:name":{},"f:resources":{".":{},"f:limits":{".":{},"f:cpu":{},"f:memory":{}},"f:requests":{".":{},"f:cpu":{},"f:memory":{}}},"f:securityContext":{".":{},"f:capabilities":{".":{},"f:drop":{}},"f:runAsUser":{}},"f:terminationMessagePath":{},"f:terminationMessagePolicy":{},"f:volumeMounts":{".":{},"k:{\"mountPath\":\"/operator\"}":{".":{},"f:mountPath":{},"f:name":{}},"k:{\"mountPath\":\"/tmp/default_user.conf\"}":{".":{},"f:mountPath":{},"f:name":{},"f:subPath":{}},"k:{\"mountPath\":\"/tmp/erlang-cookie-secret/\"}":{".":{},"f:mountPath":{},"f:name":{}},"k:{\"mountPath\":\"/tmp/rabbitmq-plugins/\"}":{".":{},"f:mountPath":{},"f:name":{}},"k:{\"mountPath\":\"/var/lib/rabbitmq/\"}":{".":{},"f:mountPath":{},"f:name":{}},"k:{\"mountPath\":\"/var/lib/rabbitmq/mnesia/\"}":{".":{},"f:mountPath":{},"f:name":{}}}}},"f:restartPolicy":{},"f:schedulerName":{},"f:securityContext":{".":{},"f:fsGroup":{},"f:runAsGroup":{},"f:runAsUser":{}},"f:serviceAccount":{},"f:serviceAccountName":{},"f:terminationGracePeriodSeconds":{},"f:topologySpreadConstraints":{".":{},"k:{\"topologyKey\":\"topology.kubernetes.io/zone\",\"whenUnsatisfiable\":\"ScheduleAnyway\"}":{".":{},"f:labelSelector":{".":{},"f:matchLabels":{".":{},"f:app.kubernetes.io/name":{}}},"f:maxSkew":{},"f:topologyKey":{},"f:whenUnsatisfiable":{}}},"f:volumes":{".":{},"k:{\"name\":\"erlang-cookie-secret\"}":{".":{},"f:name":{},"f:secret":{".":{},"f:defaultMode":{},"f:secretName":{}}},"k:{\"name\":\"plugins-conf\"}":{".":{},"f:configMap":{".":{},"f:defaultMode":{},"f:name":{}},"f:name":{}},"k:{\"name\":\"pod-info\"}":{".":{},"f:downwardAPI":{".":{},"f:defaultMode":{},"f:items":{}},"f:name":{}},"k:{\"name\":\"rabbitmq-confd\"}":{".":{},"f:name":{},"f:projected":{".":{},"f:defaultMode":{},"f:sources":{}}},"k:{\"name\":\"rabbitmq-erlang-cookie\"}":{".":{},"f:emptyDir":{},"f:name":{}},"k:{\"name\":\"rabbitmq-plugins\"}":{".":{},"f:emptyDir":{},"f:name":{}}}}},"f:updateStrategy":{"f:rollingUpdate":{".":{},"f:partition":{}},"f:type":{}},"f:volumeClaimTemplates":{}}}}]},"spec":{"replicas":1,"selector":{"matchLabels":{"app.kubernetes.io/name":"sonar-rabbitmq-cluster"}},"template":{"metadata":{"creationTimestamp":null,"labels":{"app.kubernetes.io/component":"rabbitmq","app.kubernetes.io/name":"sonar-rabbitmq-cluster","app.kubernetes.io/part-of":"rabbitmq"},"annotations":{"prometheus.io/port":"15692","prometheus.io/scrape":"true"}},"spec":{"volumes":[{"name":"plugins-conf","configMap":{"name":"sonar-rabbitmq-cluster-plugins-conf","defaultMode":420}},{"name":"rabbitmq-confd","projected":{"sources":[{"secret":{"name":"sonar-rabbitmq-cluster-default-user","items":[{"key":"default_user.conf","path":"default_user.conf"}]}},{"configMap":{"name":"sonar-rabbitmq-cluster-server-conf","items":[{"key":"operatorDefaults.conf","path":"operatorDefaults.conf"},{"key":"userDefinedConfiguration.conf","path":"userDefinedConfiguration.conf"}]}}],"defaultMode":420}},{"name":"rabbitmq-erlang-cookie","emptyDir":{}},{"name":"erlang-cookie-secret","secret":{"secretName":"sonar-rabbitmq-cluster-erlang-cookie","defaultMode":420}},{"name":"rabbitmq-plugins","emptyDir":{}},{"name":"pod-info","downwardAPI":{"items":[{"path":"skipPreStopChecks","fieldRef":{"apiVersion":"v1","fieldPath":"metadata.labels['skipPreStopChecks']"}}],"defaultMode":420}}],"initContainers":[{"name":"setup-container","image":"rabbitmq:3.8.12-management","command":["sh","-c","cp /tmp/erlang-cookie-secret/.erlang.cookie /var/lib/rabbitmq/.erlang.cookie \u0026\u0026 chown 999:999 /var/lib/rabbitmq/.erlang.cookie \u0026\u0026 chmod 600 /var/lib/rabbitmq/.erlang.cookie ; cp /tmp/rabbitmq-plugins/enabled_plugins /operator/enabled_plugins \u0026\u0026 chown 999:999 /operator/enabled_plugins ; chown 999:999 /var/lib/rabbitmq/mnesia/ ; echo '[default]' \u003e /var/lib/rabbitmq/.rabbitmqadmin.conf \u0026\u0026 sed -e 's/default_user/username/' -e 's/default_pass/password/' /tmp/default_user.conf \u003e\u003e /var/lib/rabbitmq/.rabbitmqadmin.conf \u0026\u0026 chown 999:999 /var/lib/rabbitmq/.rabbitmqadmin.conf \u0026\u0026 chmod 600 /var/lib/rabbitmq/.rabbitmqadmin.conf"],"resources":{"limits":{"cpu":"100m","memory":"500Mi"},"requests":{"cpu":"100m","memory":"500Mi"}},"volumeMounts":[{"name":"plugins-conf","mountPath":"/tmp/rabbitmq-plugins/"},{"name":"rabbitmq-erlang-cookie","mountPath":"/var/lib/rabbitmq/"},{"name":"erlang-cookie-secret","mountPath":"/tmp/erlang-cookie-secret/"},{"name":"rabbitmq-plugins","mountPath":"/operator"},{"name":"persistence","mountPath":"/var/lib/rabbitmq/mnesia/"},{"name":"rabbitmq-confd","mountPath":"/tmp/default_user.conf","subPath":"default_user.conf"}],"terminationMessagePath":"/dev/termination-log","terminationMessagePolicy":"File","imagePullPolicy":"IfNotPresent","securityContext":{"capabilities":{"drop":["FSETID","KILL","SETGID","SETUID","SETPCAP","NET_BIND_SERVICE","NET_RAW","SYS_CHROOT","MKNOD","AUDIT_WRITE","SETFCAP"]},"runAsUser":0}}],"containers":[{"name":"rabbitmq","image":"rabbitmq:3.8.12-management","ports":[{"name":"epmd","containerPort":4369,"protocol":"TCP"},{"name":"amqp","containerPort":5672,"protocol":"TCP"},{"name":"management","containerPort":15672,"protocol":"TCP"},{"name":"prometheus","containerPort":15692,"protocol":"TCP"}],"env":[{"name":"MY_POD_NAME","valueFrom":{"fieldRef":{"apiVersion":"v1","fieldPath":"metadata.name"}}},{"name":"MY_POD_NAMESPACE","valueFrom":{"fieldRef":{"apiVersion":"v1","fieldPath":"metadata.namespace"}}},{"name":"RABBITMQ_ENABLED_PLUGINS_FILE","value":"/operator/enabled_plugins"},{"name":"K8S_SERVICE_NAME","value":"sonar-rabbitmq-cluster-nodes"},{"name":"RABBITMQ_USE_LONGNAME","value":"true"},{"name":"RABBITMQ_NODENAME","value":"rabbit@$(MY_POD_NAME).$(K8S_SERVICE_NAME).$(MY_POD_NAMESPACE)"},{"name":"K8S_HOSTNAME_SUFFIX","value":".$(K8S_SERVICE_NAME).$(MY_POD_NAMESPACE)"}],"resources":{"limits":{"cpu":"2","memory":"2Gi"},"requests":{"cpu":"1","memory":"2Gi"}},"volumeMounts":[{"name":"rabbitmq-erlang-cookie","mountPath":"/var/lib/rabbitmq/"},{"name":"persistence","mountPath":"/var/lib/rabbitmq/mnesia/"},{"name":"rabbitmq-plugins","mountPath":"/operator"},{"name":"rabbitmq-confd","mountPath":"/etc/rabbitmq/conf.d/10-operatorDefaults.conf","subPath":"operatorDefaults.conf"},{"name":"rabbitmq-confd","mountPath":"/etc/rabbitmq/conf.d/11-default_user.conf","subPath":"default_user.conf"},{"name":"rabbitmq-confd","mountPath":"/etc/rabbitmq/conf.d/90-userDefinedConfiguration.conf","subPath":"userDefinedConfiguration.conf"},{"name":"pod-info","mountPath":"/etc/pod-info/"}],"readinessProbe":{"tcpSocket":{"port":"amqp"},"initialDelaySeconds":10,"timeoutSeconds":5,"periodSeconds":10,"successThreshold":1,"failureThreshold":3},"lifecycle":{"preStop":{"exec":{"command":["/bin/bash","-c","if [ ! -z \"$(cat /etc/pod-info/skipPreStopChecks)\" ]; then exit 0; fi; rabbitmq-upgrade await_online_quorum_plus_one -t 604800; rabbitmq-upgrade await_online_synchronized_mirror -t 604800; rabbitmq-upgrade drain -t 604800"]}}},"terminationMessagePath":"/dev/termination-log","terminationMessagePolicy":"File","imagePullPolicy":"IfNotPresent"}],"restartPolicy":"Always","terminationGracePeriodSeconds":604800,"dnsPolicy":"ClusterFirst","serviceAccountName":"sonar-rabbitmq-cluster-server","serviceAccount":"sonar-rabbitmq-cluster-server","automountServiceAccountToken":true,"securityContext":{"runAsUser":999,"runAsGroup":999,"fsGroup":999},"schedulerName":"default-scheduler","topologySpreadConstraints":[{"maxSkew":1,"topologyKey":"topology.kubernetes.io/zone","whenUnsatisfiable":"ScheduleAnyway","labelSelector":{"matchLabels":{"app.kubernetes.io/name":"sonar-rabbitmq-cluster"}}}]}},"volumeClaimTemplates":[{"metadata":{"name":"persistence","namespace":"default","creationTimestamp":null,"labels":{"app.kubernetes.io/component":"rabbitmq","app.kubernetes.io/name":"sonar-rabbitmq-cluster","app.kubernetes.io/part-of":"rabbitmq"},"ownerReferences":[{"apiVersion":"rabbitmq.com/v1beta1","kind":"RabbitmqCluster","name":"sonar-rabbitmq-cluster","uid":"955a1113-f3fc-4efc-a6d1-b15ae324f7c0","controller":true,"blockOwnerDeletion":false}]},"spec":{"accessModes":["ReadWriteOnce"],"resources":{"requests":{"storage":"10Gi"}},"volumeMode":"Filesystem"},"status":{"phase":"Pending"}}],"serviceName":"sonar-rabbitmq-cluster-nodes","podManagementPolicy":"Parallel","updateStrategy":{"type":"RollingUpdate","rollingUpdate":{"partition":0}},"revisionHistoryLimit":10},"status":{"observedGeneration":1,"replicas":1,"currentReplicas":1,"updatedReplicas":1,"currentRevision":"sonar-rabbitmq-cluster-server-594479b66","updateRevision":"sonar-rabbitmq-cluster-server-594479b66","collisionCount":0}}
2021/04/09 01:06:49 [SONAR-CACHE-READ]	Get	statefulset	default	sonar-rabbitmq-cluster-server	NoError
2021/04/09 01:06:49 [SONAR-SIDE-EFFECT]	Update	statefulset	default	sonar-rabbitmq-cluster-server	NoError
2021/04/09 01:06:49 [SONAR-CACHE-READ]	Get	configmap	default	sonar-rabbitmq-cluster-server-conf	NoError
2021/04/09 01:06:52 [SONAR-EVENT]	15	Updated	statefulset	{"metadata":{"name":"sonar-rabbitmq-cluster-server","namespace":"default","selfLink":"/apis/apps/v1/namespaces/default/statefulsets/sonar-rabbitmq-cluster-server","uid":"82dfe424-f051-485c-8d8d-010eec6463c3","resourceVersion":"1685","generation":1,"creationTimestamp":"2021-04-09T01:06:28Z","labels":{"app.kubernetes.io/component":"rabbitmq","app.kubernetes.io/name":"sonar-rabbitmq-cluster","app.kubernetes.io/part-of":"rabbitmq"},"annotations":{"rabbitmq.com/createdAt":"2021-04-09T01:06:28Z"},"ownerReferences":[{"apiVersion":"rabbitmq.com/v1beta1","kind":"RabbitmqCluster","name":"sonar-rabbitmq-cluster","uid":"955a1113-f3fc-4efc-a6d1-b15ae324f7c0","controller":true,"blockOwnerDeletion":true}],"managedFields":[{"manager":"kube-controller-manager","operation":"Update","apiVersion":"apps/v1","time":"2021-04-09T01:06:28Z","fieldsType":"FieldsV1","fieldsV1":{"f:status":{"f:collisionCount":{},"f:currentReplicas":{},"f:currentRevision":{},"f:observedGeneration":{},"f:replicas":{},"f:updateRevision":{},"f:updatedReplicas":{}}}},{"manager":"manager","operation":"Update","apiVersion":"apps/v1","time":"2021-04-09T01:06:49Z","fieldsType":"FieldsV1","fieldsV1":{"f:metadata":{"f:annotations":{".":{},"f:rabbitmq.com/createdAt":{}},"f:labels":{".":{},"f:app.kubernetes.io/component":{},"f:app.kubernetes.io/name":{},"f:app.kubernetes.io/part-of":{}},"f:ownerReferences":{".":{},"k:{\"uid\":\"955a1113-f3fc-4efc-a6d1-b15ae324f7c0\"}":{".":{},"f:apiVersion":{},"f:blockOwnerDeletion":{},"f:controller":{},"f:kind":{},"f:name":{},"f:uid":{}}}},"f:spec":{"f:podManagementPolicy":{},"f:replicas":{},"f:revisionHistoryLimit":{},"f:selector":{"f:matchLabels":{".":{},"f:app.kubernetes.io/name":{}}},"f:serviceName":{},"f:template":{"f:metadata":{"f:annotations":{".":{},"f:prometheus.io/port":{},"f:prometheus.io/scrape":{}},"f:labels":{".":{},"f:app.kubernetes.io/component":{},"f:app.kubernetes.io/name":{},"f:app.kubernetes.io/part-of":{}}},"f:spec":{"f:automountServiceAccountToken":{},"f:containers":{"k:{\"name\":\"rabbitmq\"}":{".":{},"f:env":{".":{},"k:{\"name\":\"K8S_HOSTNAME_SUFFIX\"}":{".":{},"f:name":{},"f:value":{}},"k:{\"name\":\"K8S_SERVICE_NAME\"}":{".":{},"f:name":{},"f:value":{}},"k:{\"name\":\"MY_POD_NAME\"}":{".":{},"f:name":{},"f:valueFrom":{".":{},"f:fieldRef":{".":{},"f:apiVersion":{},"f:fieldPath":{}}}},"k:{\"name\":\"MY_POD_NAMESPACE\"}":{".":{},"f:name":{},"f:valueFrom":{".":{},"f:fieldRef":{".":{},"f:apiVersion":{},"f:fieldPath":{}}}},"k:{\"name\":\"RABBITMQ_ENABLED_PLUGINS_FILE\"}":{".":{},"f:name":{},"f:value":{}},"k:{\"name\":\"RABBITMQ_NODENAME\"}":{".":{},"f:name":{},"f:value":{}},"k:{\"name\":\"RABBITMQ_USE_LONGNAME\"}":{".":{},"f:name":{},"f:value":{}}},"f:image":{},"f:imagePullPolicy":{},"f:lifecycle":{".":{},"f:preStop":{".":{},"f:exec":{".":{},"f:command":{}}}},"f:name":{},"f:ports":{".":{},"k:{\"containerPort\":4369,\"protocol\":\"TCP\"}":{".":{},"f:containerPort":{},"f:name":{},"f:protocol":{}},"k:{\"containerPort\":5672,\"protocol\":\"TCP\"}":{".":{},"f:containerPort":{},"f:name":{},"f:protocol":{}},"k:{\"containerPort\":15672,\"protocol\":\"TCP\"}":{".":{},"f:containerPort":{},"f:name":{},"f:protocol":{}},"k:{\"containerPort\":15692,\"protocol\":\"TCP\"}":{".":{},"f:containerPort":{},"f:name":{},"f:protocol":{}}},"f:readinessProbe":{".":{},"f:failureThreshold":{},"f:initialDelaySeconds":{},"f:periodSeconds":{},"f:successThreshold":{},"f:tcpSocket":{".":{},"f:port":{}},"f:timeoutSeconds":{}},"f:resources":{".":{},"f:limits":{".":{},"f:cpu":{},"f:memory":{}},"f:requests":{".":{},"f:cpu":{},"f:memory":{}}},"f:terminationMessagePath":{},"f:terminationMessagePolicy":{},"f:volumeMounts":{".":{},"k:{\"mountPath\":\"/etc/pod-info/\"}":{".":{},"f:mountPath":{},"f:name":{}},"k:{\"mountPath\":\"/etc/rabbitmq/conf.d/10-operatorDefaults.conf\"}":{".":{},"f:mountPath":{},"f:name":{},"f:subPath":{}},"k:{\"mountPath\":\"/etc/rabbitmq/conf.d/11-default_user.conf\"}":{".":{},"f:mountPath":{},"f:name":{},"f:subPath":{}},"k:{\"mountPath\":\"/etc/rabbitmq/conf.d/90-userDefinedConfiguration.conf\"}":{".":{},"f:mountPath":{},"f:name":{},"f:subPath":{}},"k:{\"mountPath\":\"/operator\"}":{".":{},"f:mountPath":{},"f:name":{}},"k:{\"mountPath\":\"/var/lib/rabbitmq/\"}":{".":{},"f:mountPath":{},"f:name":{}},"k:{\"mountPath\":\"/var/lib/rabbitmq/mnesia/\"}":{".":{},"f:mountPath":{},"f:name":{}}}}},"f:dnsPolicy":{},"f:initContainers":{".":{},"k:{\"name\":\"setup-container\"}":{".":{},"f:command":{},"f:image":{},"f:imagePullPolicy":{},"f:name":{},"f:resources":{".":{},"f:limits":{".":{},"f:cpu":{},"f:memory":{}},"f:requests":{".":{},"f:cpu":{},"f:memory":{}}},"f:securityContext":{".":{},"f:capabilities":{".":{},"f:drop":{}},"f:runAsUser":{}},"f:terminationMessagePath":{},"f:terminationMessagePolicy":{},"f:volumeMounts":{".":{},"k:{\"mountPath\":\"/operator\"}":{".":{},"f:mountPath":{},"f:name":{}},"k:{\"mountPath\":\"/tmp/default_user.conf\"}":{".":{},"f:mountPath":{},"f:name":{},"f:subPath":{}},"k:{\"mountPath\":\"/tmp/erlang-cookie-secret/\"}":{".":{},"f:mountPath":{},"f:name":{}},"k:{\"mountPath\":\"/tmp/rabbitmq-plugins/\"}":{".":{},"f:mountPath":{},"f:name":{}},"k:{\"mountPath\":\"/var/lib/rabbitmq/\"}":{".":{},"f:mountPath":{},"f:name":{}},"k:{\"mountPath\":\"/var/lib/rabbitmq/mnesia/\"}":{".":{},"f:mountPath":{},"f:name":{}}}}},"f:restartPolicy":{},"f:schedulerName":{},"f:securityContext":{".":{},"f:fsGroup":{},"f:runAsGroup":{},"f:runAsUser":{}},"f:serviceAccount":{},"f:serviceAccountName":{},"f:terminationGracePeriodSeconds":{},"f:topologySpreadConstraints":{".":{},"k:{\"topologyKey\":\"topology.kubernetes.io/zone\",\"whenUnsatisfiable\":\"ScheduleAnyway\"}":{".":{},"f:labelSelector":{".":{},"f:matchLabels":{".":{},"f:app.kubernetes.io/name":{}}},"f:maxSkew":{},"f:topologyKey":{},"f:whenUnsatisfiable":{}}},"f:volumes":{".":{},"k:{\"name\":\"erlang-cookie-secret\"}":{".":{},"f:name":{},"f:secret":{".":{},"f:defaultMode":{},"f:secretName":{}}},"k:{\"name\":\"plugins-conf\"}":{".":{},"f:configMap":{".":{},"f:defaultMode":{},"f:name":{}},"f:name":{}},"k:{\"name\":\"pod-info\"}":{".":{},"f:downwardAPI":{".":{},"f:defaultMode":{},"f:items":{}},"f:name":{}},"k:{\"name\":\"rabbitmq-confd\"}":{".":{},"f:name":{},"f:projected":{".":{},"f:defaultMode":{},"f:sources":{}}},"k:{\"name\":\"rabbitmq-erlang-cookie\"}":{".":{},"f:emptyDir":{},"f:name":{}},"k:{\"name\":\"rabbitmq-plugins\"}":{".":{},"f:emptyDir":{},"f:name":{}}}}},"f:updateStrategy":{"f:rollingUpdate":{".":{},"f:partition":{}},"f:type":{}},"f:volumeClaimTemplates":{}}}}]},"spec":{"replicas":1,"selector":{"matchLabels":{"app.kubernetes.io/name":"sonar-rabbitmq-cluster"}},"template":{"metadata":{"creationTimestamp":null,"labels":{"app.kubernetes.io/component":"rabbitmq","app.kubernetes.io/name":"sonar-rabbitmq-cluster","app.kubernetes.io/part-of":"rabbitmq"},"annotations":{"prometheus.io/port":"15692","prometheus.io/scrape":"true"}},"spec":{"volumes":[{"name":"plugins-conf","configMap":{"name":"sonar-rabbitmq-cluster-plugins-conf","defaultMode":420}},{"name":"rabbitmq-confd","projected":{"sources":[{"secret":{"name":"sonar-rabbitmq-cluster-default-user","items":[{"key":"default_user.conf","path":"default_user.conf"}]}},{"configMap":{"name":"sonar-rabbitmq-cluster-server-conf","items":[{"key":"operatorDefaults.conf","path":"operatorDefaults.conf"},{"key":"userDefinedConfiguration.conf","path":"userDefinedConfiguration.conf"}]}}],"defaultMode":420}},{"name":"rabbitmq-erlang-cookie","emptyDir":{}},{"name":"erlang-cookie-secret","secret":{"secretName":"sonar-rabbitmq-cluster-erlang-cookie","defaultMode":420}},{"name":"rabbitmq-plugins","emptyDir":{}},{"name":"pod-info","downwardAPI":{"items":[{"path":"skipPreStopChecks","fieldRef":{"apiVersion":"v1","fieldPath":"metadata.labels['skipPreStopChecks']"}}],"defaultMode":420}}],"initContainers":[{"name":"setup-container","image":"rabbitmq:3.8.12-management","command":["sh","-c","cp /tmp/erlang-cookie-secret/.erlang.cookie /var/lib/rabbitmq/.erlang.cookie \u0026\u0026 chown 999:999 /var/lib/rabbitmq/.erlang.cookie \u0026\u0026 chmod 600 /var/lib/rabbitmq/.erlang.cookie ; cp /tmp/rabbitmq-plugins/enabled_plugins /operator/enabled_plugins \u0026\u0026 chown 999:999 /operator/enabled_plugins ; chown 999:999 /var/lib/rabbitmq/mnesia/ ; echo '[default]' \u003e /var/lib/rabbitmq/.rabbitmqadmin.conf \u0026\u0026 sed -e 's/default_user/username/' -e 's/default_pass/password/' /tmp/default_user.conf \u003e\u003e /var/lib/rabbitmq/.rabbitmqadmin.conf \u0026\u0026 chown 999:999 /var/lib/rabbitmq/.rabbitmqadmin.conf \u0026\u0026 chmod 600 /var/lib/rabbitmq/.rabbitmqadmin.conf"],"resources":{"limits":{"cpu":"100m","memory":"500Mi"},"requests":{"cpu":"100m","memory":"500Mi"}},"volumeMounts":[{"name":"plugins-conf","mountPath":"/tmp/rabbitmq-plugins/"},{"name":"rabbitmq-erlang-cookie","mountPath":"/var/lib/rabbitmq/"},{"name":"erlang-cookie-secret","mountPath":"/tmp/erlang-cookie-secret/"},{"name":"rabbitmq-plugins","mountPath":"/operator"},{"name":"persistence","mountPath":"/var/lib/rabbitmq/mnesia/"},{"name":"rabbitmq-confd","mountPath":"/tmp/default_user.conf","subPath":"default_user.conf"}],"terminationMessagePath":"/dev/termination-log","terminationMessagePolicy":"File","imagePullPolicy":"IfNotPresent","securityContext":{"capabilities":{"drop":["FSETID","KILL","SETGID","SETUID","SETPCAP","NET_BIND_SERVICE","NET_RAW","SYS_CHROOT","MKNOD","AUDIT_WRITE","SETFCAP"]},"runAsUser":0}}],"containers":[{"name":"rabbitmq","image":"rabbitmq:3.8.12-management","ports":[{"name":"epmd","containerPort":4369,"protocol":"TCP"},{"name":"amqp","containerPort":5672,"protocol":"TCP"},{"name":"management","containerPort":15672,"protocol":"TCP"},{"name":"prometheus","containerPort":15692,"protocol":"TCP"}],"env":[{"name":"MY_POD_NAME","valueFrom":{"fieldRef":{"apiVersion":"v1","fieldPath":"metadata.name"}}},{"name":"MY_POD_NAMESPACE","valueFrom":{"fieldRef":{"apiVersion":"v1","fieldPath":"metadata.namespace"}}},{"name":"RABBITMQ_ENABLED_PLUGINS_FILE","value":"/operator/enabled_plugins"},{"name":"K8S_SERVICE_NAME","value":"sonar-rabbitmq-cluster-nodes"},{"name":"RABBITMQ_USE_LONGNAME","value":"true"},{"name":"RABBITMQ_NODENAME","value":"rabbit@$(MY_POD_NAME).$(K8S_SERVICE_NAME).$(MY_POD_NAMESPACE)"},{"name":"K8S_HOSTNAME_SUFFIX","value":".$(K8S_SERVICE_NAME).$(MY_POD_NAMESPACE)"}],"resources":{"limits":{"cpu":"2","memory":"2Gi"},"requests":{"cpu":"1","memory":"2Gi"}},"volumeMounts":[{"name":"rabbitmq-erlang-cookie","mountPath":"/var/lib/rabbitmq/"},{"name":"persistence","mountPath":"/var/lib/rabbitmq/mnesia/"},{"name":"rabbitmq-plugins","mountPath":"/operator"},{"name":"rabbitmq-confd","mountPath":"/etc/rabbitmq/conf.d/10-operatorDefaults.conf","subPath":"operatorDefaults.conf"},{"name":"rabbitmq-confd","mountPath":"/etc/rabbitmq/conf.d/11-default_user.conf","subPath":"default_user.conf"},{"name":"rabbitmq-confd","mountPath":"/etc/rabbitmq/conf.d/90-userDefinedConfiguration.conf","subPath":"userDefinedConfiguration.conf"},{"name":"pod-info","mountPath":"/etc/pod-info/"}],"readinessProbe":{"tcpSocket":{"port":"amqp"},"initialDelaySeconds":10,"timeoutSeconds":5,"periodSeconds":10,"successThreshold":1,"failureThreshold":3},"lifecycle":{"preStop":{"exec":{"command":["/bin/bash","-c","if [ ! -z \"$(cat /etc/pod-info/skipPreStopChecks)\" ]; then exit 0; fi; rabbitmq-upgrade await_online_quorum_plus_one -t 604800; rabbitmq-upgrade await_online_synchronized_mirror -t 604800; rabbitmq-upgrade drain -t 604800"]}}},"terminationMessagePath":"/dev/termination-log","terminationMessagePolicy":"File","imagePullPolicy":"IfNotPresent"}],"restartPolicy":"Always","terminationGracePeriodSeconds":604800,"dnsPolicy":"ClusterFirst","serviceAccountName":"sonar-rabbitmq-cluster-server","serviceAccount":"sonar-rabbitmq-cluster-server","automountServiceAccountToken":true,"securityContext":{"runAsUser":999,"runAsGroup":999,"fsGroup":999},"schedulerName":"default-scheduler","topologySpreadConstraints":[{"maxSkew":1,"topologyKey":"topology.kubernetes.io/zone","whenUnsatisfiable":"ScheduleAnyway","labelSelector":{"matchLabels":{"app.kubernetes.io/name":"sonar-rabbitmq-cluster"}}}]}},"volumeClaimTemplates":[{"metadata":{"name":"persistence","namespace":"default","creationTimestamp":null,"labels":{"app.kubernetes.io/component":"rabbitmq","app.kubernetes.io/name":"sonar-rabbitmq-cluster","app.kubernetes.io/part-of":"rabbitmq"},"ownerReferences":[{"apiVersion":"rabbitmq.com/v1beta1","kind":"RabbitmqCluster","name":"sonar-rabbitmq-cluster","uid":"955a1113-f3fc-4efc-a6d1-b15ae324f7c0","controller":true,"blockOwnerDeletion":false}]},"spec":{"accessModes":["ReadWriteOnce"],"resources":{"requests":{"storage":"10Gi"}},"volumeMode":"Filesystem"},"status":{"phase":"Pending"}}],"serviceName":"sonar-rabbitmq-cluster-nodes","podManagementPolicy":"Parallel","updateStrategy":{"type":"RollingUpdate","rollingUpdate":{"partition":0}},"revisionHistoryLimit":10},"status":{"observedGeneration":1,"replicas":1,"currentReplicas":1,"updatedReplicas":1,"currentRevision":"sonar-rabbitmq-cluster-server-594479b66","updateRevision":"sonar-rabbitmq-cluster-server-594479b66","collisionCount":0}}
2021/04/09 01:06:52 [SONAR-CACHE-READ]	Get	statefulset	default	sonar-rabbitmq-cluster-server	NoError
2021/04/09 01:06:52 [SONAR-EVENT]	16	Updated	rabbitmqcluster	{"metadata":{"name":"sonar-rabbitmq-cluster","namespace":"default","selfLink":"/apis/rabbitmq.com/v1beta1/namespaces/default/rabbitmqclusters/sonar-rabbitmq-cluster","uid":"955a1113-f3fc-4efc-a6d1-b15ae324f7c0","resourceVersion":"1686","generation":2,"creationTimestamp":"2021-04-09T01:06:05Z","annotations":{"kubectl.kubernetes.io/last-applied-configuration":"{\"apiVersion\":\"rabbitmq.com/v1beta1\",\"kind\":\"RabbitmqCluster\",\"metadata\":{\"annotations\":{},\"name\":\"sonar-rabbitmq-cluster\",\"namespace\":\"default\"},\"spec\":{\"replicas\":1}}\n"},"finalizers":["deletion.finalizers.rabbitmqclusters.rabbitmq.com"],"managedFields":[{"manager":"kubectl-client-side-apply","operation":"Update","apiVersion":"rabbitmq.com/v1beta1","time":"2021-04-09T01:06:05Z","fieldsType":"FieldsV1","fieldsV1":{"f:metadata":{"f:annotations":{".":{},"f:kubectl.kubernetes.io/last-applied-configuration":{}}},"f:spec":{".":{},"f:image":{},"f:persistence":{".":{},"f:storage":{}},"f:replicas":{},"f:resources":{".":{},"f:limits":{".":{},"f:memory":{}},"f:requests":{".":{},"f:memory":{}}},"f:service":{".":{},"f:type":{}},"f:terminationGracePeriodSeconds":{}}}},{"manager":"manager","operation":"Update","apiVersion":"rabbitmq.com/v1beta1","time":"2021-04-09T01:06:49Z","fieldsType":"FieldsV1","fieldsV1":{"f:metadata":{"f:finalizers":{}},"f:spec":{"f:override":{},"f:rabbitmq":{},"f:resources":{"f:limits":{"f:cpu":{}},"f:requests":{"f:cpu":{}}},"f:tls":{}},"f:status":{".":{},"f:conditions":{},"f:defaultUser":{".":{},"f:secretReference":{".":{},"f:keys":{".":{},"f:password":{},"f:username":{}},"f:name":{},"f:namespace":{}},"f:serviceReference":{".":{},"f:name":{},"f:namespace":{}}}}}}]},"spec":{"replicas":1,"image":"rabbitmq:3.8.12-management","service":{"type":"ClusterIP"},"persistence":{"storage":"10Gi"},"resources":{"limits":{"cpu":"2","memory":"2Gi"},"requests":{"cpu":"1","memory":"2Gi"}},"rabbitmq":{},"tls":{},"override":{},"terminationGracePeriodSeconds":604800},"status":{"conditions":[{"type":"AllReplicasReady","status":"Unknown","lastTransitionTime":"2021-04-09T01:06:07Z","reason":"MissingStatefulSet","message":"Could not find StatefulSet"},{"type":"ClusterAvailable","status":"Unknown","lastTransitionTime":"2021-04-09T01:06:07Z","reason":"CouldNotRetrieveEndpoints","message":"Could not verify available service endpoints"},{"type":"NoWarnings","status":"Unknown","lastTransitionTime":"2021-04-09T01:06:07Z","reason":"MissingStatefulSet","message":"Could not find StatefulSet"},{"type":"ReconcileSuccess","status":"Unknown","lastTransitionTime":"2021-04-09T01:06:07Z","reason":"Initialising"}],"defaultUser":{"secretReference":{"name":"sonar-rabbitmq-cluster-default-user","namespace":"default","keys":{"password":"password","username":"username"}},"serviceReference":{"name":"sonar-rabbitmq-cluster","namespace":"default"}}}}
2021/04/09 01:06:52 [SONAR-FINISH-RECONCILE]	rabbitmqcluster	0
2021/04/09 01:06:52 [SONAR-START-RECONCILE]	rabbitmqcluster	1
2021/04/09 01:06:52 [SONAR-CACHE-READ]	Get	rabbitmqcluster	default	sonar-rabbitmq-cluster	NoError
2021/04/09 01:06:52 [SONAR-CACHE-READ]	Get	statefulset	default	sonar-rabbitmq-cluster-server	NoError
2021/04/09 01:06:52 [SONAR-CACHE-READ]	Get	endpoints	default	sonar-rabbitmq-cluster	NoError
2021/04/09 01:06:52 [SONAR-CACHE-READ]	Get	statefulset	default	sonar-rabbitmq-cluster-server	NoError
2021/04/09 01:06:52 [SONAR-CACHE-READ]	Get	service	default	sonar-rabbitmq-cluster-nodes	NoError
2021/04/09 01:06:52 [SONAR-CACHE-READ]	Get	service	default	sonar-rabbitmq-cluster	NoError
2021/04/09 01:06:52 [SONAR-CACHE-READ]	Get	secret	default	sonar-rabbitmq-cluster-erlang-cookie	NoError
2021/04/09 01:06:52 [SONAR-CACHE-READ]	Get	secret	default	sonar-rabbitmq-cluster-default-user	NoError
2021/04/09 01:06:52 [SONAR-CACHE-READ]	Get	configmap	default	sonar-rabbitmq-cluster-plugins-conf	NoError
2021/04/09 01:06:52 [SONAR-CACHE-READ]	Get	configmap	default	sonar-rabbitmq-cluster-server-conf	NoError
2021/04/09 01:06:52 [SONAR-CACHE-READ]	Get	serviceaccount	default	sonar-rabbitmq-cluster-server	NoError
2021/04/09 01:06:52 [SONAR-CACHE-READ]	Get	role	default	sonar-rabbitmq-cluster-peer-discovery	NoError
2021/04/09 01:06:52 [SONAR-CACHE-READ]	Get	rolebinding	default	sonar-rabbitmq-cluster-server	NoError
2021/04/09 01:06:52 [SONAR-CACHE-READ]	Get	statefulset	default	sonar-rabbitmq-cluster-server	NoError
2021/04/09 01:06:52 [SONAR-CACHE-READ]	Get	statefulset	default	sonar-rabbitmq-cluster-server	NoError
2021/04/09 01:06:52 [SONAR-SIDE-EFFECT]	Update	statefulset	default	sonar-rabbitmq-cluster-server	NoError
2021/04/09 01:06:52 [SONAR-CACHE-READ]	Get	configmap	default	sonar-rabbitmq-cluster-server-conf	NoError
2021/04/09 01:06:52 [SONAR-CACHE-READ]	Get	statefulset	default	sonar-rabbitmq-cluster-server	NoError
2021/04/09 01:06:52 [SONAR-EVENT]	17	Updated	rabbitmqcluster	{"metadata":{"name":"sonar-rabbitmq-cluster","namespace":"default","selfLink":"/apis/rabbitmq.com/v1beta1/namespaces/default/rabbitmqclusters/sonar-rabbitmq-cluster","uid":"955a1113-f3fc-4efc-a6d1-b15ae324f7c0","resourceVersion":"1702","generation":2,"creationTimestamp":"2021-04-09T01:06:05Z","annotations":{"kubectl.kubernetes.io/last-applied-configuration":"{\"apiVersion\":\"rabbitmq.com/v1beta1\",\"kind\":\"RabbitmqCluster\",\"metadata\":{\"annotations\":{},\"name\":\"sonar-rabbitmq-cluster\",\"namespace\":\"default\"},\"spec\":{\"replicas\":1}}\n"},"finalizers":["deletion.finalizers.rabbitmqclusters.rabbitmq.com"],"managedFields":[{"manager":"kubectl-client-side-apply","operation":"Update","apiVersion":"rabbitmq.com/v1beta1","time":"2021-04-09T01:06:05Z","fieldsType":"FieldsV1","fieldsV1":{"f:metadata":{"f:annotations":{".":{},"f:kubectl.kubernetes.io/last-applied-configuration":{}}},"f:spec":{".":{},"f:image":{},"f:persistence":{".":{},"f:storage":{}},"f:replicas":{},"f:resources":{".":{},"f:limits":{".":{},"f:memory":{}},"f:requests":{".":{},"f:memory":{}}},"f:service":{".":{},"f:type":{}},"f:terminationGracePeriodSeconds":{}}}},{"manager":"manager","operation":"Update","apiVersion":"rabbitmq.com/v1beta1","time":"2021-04-09T01:06:52Z","fieldsType":"FieldsV1","fieldsV1":{"f:metadata":{"f:finalizers":{}},"f:spec":{"f:override":{},"f:rabbitmq":{},"f:resources":{"f:limits":{"f:cpu":{}},"f:requests":{"f:cpu":{}}},"f:tls":{}},"f:status":{".":{},"f:conditions":{},"f:defaultUser":{".":{},"f:secretReference":{".":{},"f:keys":{".":{},"f:password":{},"f:username":{}},"f:name":{},"f:namespace":{}},"f:serviceReference":{".":{},"f:name":{},"f:namespace":{}}}}}}]},"spec":{"replicas":1,"image":"rabbitmq:3.8.12-management","service":{"type":"ClusterIP"},"persistence":{"storage":"10Gi"},"resources":{"limits":{"cpu":"2","memory":"2Gi"},"requests":{"cpu":"1","memory":"2Gi"}},"rabbitmq":{},"tls":{},"override":{},"terminationGracePeriodSeconds":604800},"status":{"conditions":[{"type":"AllReplicasReady","status":"False","lastTransitionTime":"2021-04-09T01:06:52Z","reason":"NotAllPodsReady","message":"0/1 Pods ready"},{"type":"ClusterAvailable","status":"False","lastTransitionTime":"2021-04-09T01:06:52Z","reason":"NoEndpointsAvailable","message":"The service has no endpoints available"},{"type":"NoWarnings","status":"True","lastTransitionTime":"2021-04-09T01:06:52Z","reason":"NoWarnings"},{"type":"ReconcileSuccess","status":"Unknown","lastTransitionTime":"2021-04-09T01:06:07Z","reason":"Initialising"}],"defaultUser":{"secretReference":{"name":"sonar-rabbitmq-cluster-default-user","namespace":"default","keys":{"password":"password","username":"username"}},"serviceReference":{"name":"sonar-rabbitmq-cluster","namespace":"default"}}}}
2021/04/09 01:06:52 [SONAR-FINISH-RECONCILE]	rabbitmqcluster	1
2021/04/09 01:06:52 [SONAR-START-RECONCILE]	rabbitmqcluster	2
2021/04/09 01:06:52 [SONAR-CACHE-READ]	Get	rabbitmqcluster	default	sonar-rabbitmq-cluster	NoError
2021/04/09 01:06:52 [SONAR-CACHE-READ]	Get	statefulset	default	sonar-rabbitmq-cluster-server	NoError
2021/04/09 01:06:52 [SONAR-CACHE-READ]	Get	endpoints	default	sonar-rabbitmq-cluster	NoError
2021/04/09 01:06:52 [SONAR-CACHE-READ]	Get	statefulset	default	sonar-rabbitmq-cluster-server	NoError
2021/04/09 01:06:52 [SONAR-CACHE-READ]	Get	service	default	sonar-rabbitmq-cluster-nodes	NoError
2021/04/09 01:06:52 [SONAR-CACHE-READ]	Get	service	default	sonar-rabbitmq-cluster	NoError
2021/04/09 01:06:53 [SONAR-CACHE-READ]	Get	secret	default	sonar-rabbitmq-cluster-erlang-cookie	NoError
2021/04/09 01:06:53 [SONAR-CACHE-READ]	Get	secret	default	sonar-rabbitmq-cluster-default-user	NoError
2021/04/09 01:06:53 [SONAR-CACHE-READ]	Get	configmap	default	sonar-rabbitmq-cluster-plugins-conf	NoError
2021/04/09 01:06:53 [SONAR-CACHE-READ]	Get	configmap	default	sonar-rabbitmq-cluster-server-conf	NoError
2021/04/09 01:06:53 [SONAR-CACHE-READ]	Get	serviceaccount	default	sonar-rabbitmq-cluster-server	NoError
2021/04/09 01:06:53 [SONAR-CACHE-READ]	Get	role	default	sonar-rabbitmq-cluster-peer-discovery	NoError
2021/04/09 01:06:53 [SONAR-CACHE-READ]	Get	rolebinding	default	sonar-rabbitmq-cluster-server	NoError
2021/04/09 01:06:53 [SONAR-CACHE-READ]	Get	statefulset	default	sonar-rabbitmq-cluster-server	NoError
2021/04/09 01:06:53 [SONAR-CACHE-READ]	Get	statefulset	default	sonar-rabbitmq-cluster-server	NoError
2021/04/09 01:06:53 [SONAR-SIDE-EFFECT]	Update	statefulset	default	sonar-rabbitmq-cluster-server	NoError
2021/04/09 01:06:53 [SONAR-CACHE-READ]	Get	configmap	default	sonar-rabbitmq-cluster-server-conf	NoError
2021/04/09 01:06:53 [SONAR-CACHE-READ]	Get	statefulset	default	sonar-rabbitmq-cluster-server	NoError
2021/04/09 01:06:53 no event happening
2021/04/09 01:06:53 [SONAR-FINISH-RECONCILE]	rabbitmqcluster	2
2021/04/09 01:06:53 [SONAR-START-RECONCILE]	rabbitmqcluster	3
2021/04/09 01:06:53 [SONAR-CACHE-READ]	Get	rabbitmqcluster	default	sonar-rabbitmq-cluster	NoError
2021/04/09 01:06:53 [SONAR-CACHE-READ]	Get	statefulset	default	sonar-rabbitmq-cluster-server	NoError
2021/04/09 01:06:53 [SONAR-CACHE-READ]	Get	endpoints	default	sonar-rabbitmq-cluster	NoError
2021/04/09 01:06:53 [SONAR-CACHE-READ]	Get	statefulset	default	sonar-rabbitmq-cluster-server	NoError
2021/04/09 01:06:53 [SONAR-CACHE-READ]	Get	service	default	sonar-rabbitmq-cluster-nodes	NoError
2021/04/09 01:06:53 [SONAR-CACHE-READ]	Get	service	default	sonar-rabbitmq-cluster	NoError
2021/04/09 01:06:53 [SONAR-CACHE-READ]	Get	secret	default	sonar-rabbitmq-cluster-erlang-cookie	NoError
2021/04/09 01:06:53 [SONAR-CACHE-READ]	Get	secret	default	sonar-rabbitmq-cluster-default-user	NoError
2021/04/09 01:06:53 [SONAR-CACHE-READ]	Get	configmap	default	sonar-rabbitmq-cluster-plugins-conf	NoError
2021/04/09 01:06:53 [SONAR-CACHE-READ]	Get	configmap	default	sonar-rabbitmq-cluster-server-conf	NoError
2021/04/09 01:06:53 [SONAR-CACHE-READ]	Get	serviceaccount	default	sonar-rabbitmq-cluster-server	NoError
2021/04/09 01:06:53 [SONAR-CACHE-READ]	Get	role	default	sonar-rabbitmq-cluster-peer-discovery	NoError
2021/04/09 01:06:53 [SONAR-CACHE-READ]	Get	rolebinding	default	sonar-rabbitmq-cluster-server	NoError
2021/04/09 01:06:53 [SONAR-CACHE-READ]	Get	statefulset	default	sonar-rabbitmq-cluster-server	NoError
2021/04/09 01:06:53 [SONAR-CACHE-READ]	Get	statefulset	default	sonar-rabbitmq-cluster-server	NoError
2021/04/09 01:06:53 [SONAR-SIDE-EFFECT]	Update	statefulset	default	sonar-rabbitmq-cluster-server	NoError
2021/04/09 01:06:53 [SONAR-CACHE-READ]	Get	configmap	default	sonar-rabbitmq-cluster-server-conf	NoError
2021/04/09 01:06:53 [SONAR-CACHE-READ]	Get	statefulset	default	sonar-rabbitmq-cluster-server	NoError
2021/04/09 01:06:53 no event happening
2021/04/09 01:06:53 [SONAR-FINISH-RECONCILE]	rabbitmqcluster	3
2021/04/09 01:06:56 [SONAR-EVENT]	18	Updated	rabbitmqcluster	{"metadata":{"name":"sonar-rabbitmq-cluster","namespace":"default","selfLink":"/apis/rabbitmq.com/v1beta1/namespaces/default/rabbitmqclusters/sonar-rabbitmq-cluster","uid":"955a1113-f3fc-4efc-a6d1-b15ae324f7c0","resourceVersion":"1716","generation":3,"creationTimestamp":"2021-04-09T01:06:05Z","annotations":{"kubectl.kubernetes.io/last-applied-configuration":"{\"apiVersion\":\"rabbitmq.com/v1beta1\",\"kind\":\"RabbitmqCluster\",\"metadata\":{\"annotations\":{},\"name\":\"sonar-rabbitmq-cluster\",\"namespace\":\"default\"},\"spec\":{\"persistence\":{\"storage\":\"15Gi\"},\"replicas\":1}}\n"},"finalizers":["deletion.finalizers.rabbitmqclusters.rabbitmq.com"],"managedFields":[{"manager":"manager","operation":"Update","apiVersion":"rabbitmq.com/v1beta1","time":"2021-04-09T01:06:52Z","fieldsType":"FieldsV1","fieldsV1":{"f:metadata":{"f:finalizers":{}},"f:spec":{"f:override":{},"f:rabbitmq":{},"f:resources":{"f:limits":{"f:cpu":{}},"f:requests":{"f:cpu":{}}},"f:tls":{}},"f:status":{".":{},"f:conditions":{},"f:defaultUser":{".":{},"f:secretReference":{".":{},"f:keys":{".":{},"f:password":{},"f:username":{}},"f:name":{},"f:namespace":{}},"f:serviceReference":{".":{},"f:name":{},"f:namespace":{}}}}}},{"manager":"kubectl-client-side-apply","operation":"Update","apiVersion":"rabbitmq.com/v1beta1","time":"2021-04-09T01:06:55Z","fieldsType":"FieldsV1","fieldsV1":{"f:metadata":{"f:annotations":{".":{},"f:kubectl.kubernetes.io/last-applied-configuration":{}}},"f:spec":{".":{},"f:image":{},"f:persistence":{".":{},"f:storage":{}},"f:replicas":{},"f:resources":{".":{},"f:limits":{".":{},"f:memory":{}},"f:requests":{".":{},"f:memory":{}}},"f:service":{".":{},"f:type":{}},"f:terminationGracePeriodSeconds":{}}}}]},"spec":{"replicas":1,"image":"rabbitmq:3.8.12-management","service":{"type":"ClusterIP"},"persistence":{"storage":"15Gi"},"resources":{"limits":{"cpu":"2","memory":"2Gi"},"requests":{"cpu":"1","memory":"2Gi"}},"rabbitmq":{},"tls":{},"override":{},"terminationGracePeriodSeconds":604800},"status":{"conditions":[{"type":"AllReplicasReady","status":"False","lastTransitionTime":"2021-04-09T01:06:52Z","reason":"NotAllPodsReady","message":"0/1 Pods ready"},{"type":"ClusterAvailable","status":"False","lastTransitionTime":"2021-04-09T01:06:52Z","reason":"NoEndpointsAvailable","message":"The service has no endpoints available"},{"type":"NoWarnings","status":"True","lastTransitionTime":"2021-04-09T01:06:52Z","reason":"NoWarnings"},{"type":"ReconcileSuccess","status":"Unknown","lastTransitionTime":"2021-04-09T01:06:07Z","reason":"Initialising"}],"defaultUser":{"secretReference":{"name":"sonar-rabbitmq-cluster-default-user","namespace":"default","keys":{"password":"password","username":"username"}},"serviceReference":{"name":"sonar-rabbitmq-cluster","namespace":"default"}}}}
2021/04/09 01:06:56 [SONAR-START-RECONCILE]	rabbitmqcluster	4
2021/04/09 01:06:56 [SONAR-CACHE-READ]	Get	rabbitmqcluster	default	sonar-rabbitmq-cluster	NoError
2021/04/09 01:06:56 [SONAR-CACHE-READ]	Get	statefulset	default	sonar-rabbitmq-cluster-server	NoError
2021/04/09 01:06:56 [SONAR-CACHE-READ]	Get	endpoints	default	sonar-rabbitmq-cluster	NoError
2021/04/09 01:06:56 [SONAR-CACHE-READ]	Get	statefulset	default	sonar-rabbitmq-cluster-server	NoError
2021/04/09 01:06:56 [SONAR-CACHE-READ]	Get	service	default	sonar-rabbitmq-cluster-nodes	NoError
2021/04/09 01:06:56 [SONAR-CACHE-READ]	Get	service	default	sonar-rabbitmq-cluster	NoError
2021/04/09 01:06:56 [SONAR-CACHE-READ]	Get	secret	default	sonar-rabbitmq-cluster-erlang-cookie	NoError
2021/04/09 01:06:56 [SONAR-CACHE-READ]	Get	secret	default	sonar-rabbitmq-cluster-default-user	NoError
2021/04/09 01:06:56 [SONAR-CACHE-READ]	Get	configmap	default	sonar-rabbitmq-cluster-plugins-conf	NoError
2021/04/09 01:06:56 [SONAR-CACHE-READ]	Get	configmap	default	sonar-rabbitmq-cluster-server-conf	NoError
2021/04/09 01:06:56 [SONAR-CACHE-READ]	Get	serviceaccount	default	sonar-rabbitmq-cluster-server	NoError
2021/04/09 01:06:56 [SONAR-CACHE-READ]	Get	role	default	sonar-rabbitmq-cluster-peer-discovery	NoError
2021/04/09 01:06:56 [SONAR-CACHE-READ]	Get	rolebinding	default	sonar-rabbitmq-cluster-server	NoError
2021/04/09 01:06:56 [SONAR-CACHE-READ]	Get	statefulset	default	sonar-rabbitmq-cluster-server	NoError
2021/04/09 01:06:56 [SONAR-CACHE-READ]	Get	statefulset	default	sonar-rabbitmq-cluster-server	NoError
2021/04/09 01:06:56 [SONAR-SIDE-EFFECT]	Delete	statefulset	default	sonar-rabbitmq-cluster-server	NoError
2021/04/09 01:06:59 [SONAR-EVENT]	19	Updated	statefulset	{"metadata":{"name":"sonar-rabbitmq-cluster-server","namespace":"default","selfLink":"/apis/apps/v1/namespaces/default/statefulsets/sonar-rabbitmq-cluster-server","uid":"82dfe424-f051-485c-8d8d-010eec6463c3","resourceVersion":"1717","generation":2,"creationTimestamp":"2021-04-09T01:06:28Z","deletionTimestamp":"2021-04-09T01:06:56Z","deletionGracePeriodSeconds":0,"labels":{"app.kubernetes.io/component":"rabbitmq","app.kubernetes.io/name":"sonar-rabbitmq-cluster","app.kubernetes.io/part-of":"rabbitmq"},"annotations":{"rabbitmq.com/createdAt":"2021-04-09T01:06:28Z"},"ownerReferences":[{"apiVersion":"rabbitmq.com/v1beta1","kind":"RabbitmqCluster","name":"sonar-rabbitmq-cluster","uid":"955a1113-f3fc-4efc-a6d1-b15ae324f7c0","controller":true,"blockOwnerDeletion":true}],"finalizers":["orphan"],"managedFields":[{"manager":"kube-controller-manager","operation":"Update","apiVersion":"apps/v1","time":"2021-04-09T01:06:28Z","fieldsType":"FieldsV1","fieldsV1":{"f:status":{"f:collisionCount":{},"f:currentReplicas":{},"f:currentRevision":{},"f:observedGeneration":{},"f:replicas":{},"f:updateRevision":{},"f:updatedReplicas":{}}}},{"manager":"manager","operation":"Update","apiVersion":"apps/v1","time":"2021-04-09T01:06:49Z","fieldsType":"FieldsV1","fieldsV1":{"f:metadata":{"f:annotations":{".":{},"f:rabbitmq.com/createdAt":{}},"f:labels":{".":{},"f:app.kubernetes.io/component":{},"f:app.kubernetes.io/name":{},"f:app.kubernetes.io/part-of":{}},"f:ownerReferences":{".":{},"k:{\"uid\":\"955a1113-f3fc-4efc-a6d1-b15ae324f7c0\"}":{".":{},"f:apiVersion":{},"f:blockOwnerDeletion":{},"f:controller":{},"f:kind":{},"f:name":{},"f:uid":{}}}},"f:spec":{"f:podManagementPolicy":{},"f:replicas":{},"f:revisionHistoryLimit":{},"f:selector":{"f:matchLabels":{".":{},"f:app.kubernetes.io/name":{}}},"f:serviceName":{},"f:template":{"f:metadata":{"f:annotations":{".":{},"f:prometheus.io/port":{},"f:prometheus.io/scrape":{}},"f:labels":{".":{},"f:app.kubernetes.io/component":{},"f:app.kubernetes.io/name":{},"f:app.kubernetes.io/part-of":{}}},"f:spec":{"f:automountServiceAccountToken":{},"f:containers":{"k:{\"name\":\"rabbitmq\"}":{".":{},"f:env":{".":{},"k:{\"name\":\"K8S_HOSTNAME_SUFFIX\"}":{".":{},"f:name":{},"f:value":{}},"k:{\"name\":\"K8S_SERVICE_NAME\"}":{".":{},"f:name":{},"f:value":{}},"k:{\"name\":\"MY_POD_NAME\"}":{".":{},"f:name":{},"f:valueFrom":{".":{},"f:fieldRef":{".":{},"f:apiVersion":{},"f:fieldPath":{}}}},"k:{\"name\":\"MY_POD_NAMESPACE\"}":{".":{},"f:name":{},"f:valueFrom":{".":{},"f:fieldRef":{".":{},"f:apiVersion":{},"f:fieldPath":{}}}},"k:{\"name\":\"RABBITMQ_ENABLED_PLUGINS_FILE\"}":{".":{},"f:name":{},"f:value":{}},"k:{\"name\":\"RABBITMQ_NODENAME\"}":{".":{},"f:name":{},"f:value":{}},"k:{\"name\":\"RABBITMQ_USE_LONGNAME\"}":{".":{},"f:name":{},"f:value":{}}},"f:image":{},"f:imagePullPolicy":{},"f:lifecycle":{".":{},"f:preStop":{".":{},"f:exec":{".":{},"f:command":{}}}},"f:name":{},"f:ports":{".":{},"k:{\"containerPort\":4369,\"protocol\":\"TCP\"}":{".":{},"f:containerPort":{},"f:name":{},"f:protocol":{}},"k:{\"containerPort\":5672,\"protocol\":\"TCP\"}":{".":{},"f:containerPort":{},"f:name":{},"f:protocol":{}},"k:{\"containerPort\":15672,\"protocol\":\"TCP\"}":{".":{},"f:containerPort":{},"f:name":{},"f:protocol":{}},"k:{\"containerPort\":15692,\"protocol\":\"TCP\"}":{".":{},"f:containerPort":{},"f:name":{},"f:protocol":{}}},"f:readinessProbe":{".":{},"f:failureThreshold":{},"f:initialDelaySeconds":{},"f:periodSeconds":{},"f:successThreshold":{},"f:tcpSocket":{".":{},"f:port":{}},"f:timeoutSeconds":{}},"f:resources":{".":{},"f:limits":{".":{},"f:cpu":{},"f:memory":{}},"f:requests":{".":{},"f:cpu":{},"f:memory":{}}},"f:terminationMessagePath":{},"f:terminationMessagePolicy":{},"f:volumeMounts":{".":{},"k:{\"mountPath\":\"/etc/pod-info/\"}":{".":{},"f:mountPath":{},"f:name":{}},"k:{\"mountPath\":\"/etc/rabbitmq/conf.d/10-operatorDefaults.conf\"}":{".":{},"f:mountPath":{},"f:name":{},"f:subPath":{}},"k:{\"mountPath\":\"/etc/rabbitmq/conf.d/11-default_user.conf\"}":{".":{},"f:mountPath":{},"f:name":{},"f:subPath":{}},"k:{\"mountPath\":\"/etc/rabbitmq/conf.d/90-userDefinedConfiguration.conf\"}":{".":{},"f:mountPath":{},"f:name":{},"f:subPath":{}},"k:{\"mountPath\":\"/operator\"}":{".":{},"f:mountPath":{},"f:name":{}},"k:{\"mountPath\":\"/var/lib/rabbitmq/\"}":{".":{},"f:mountPath":{},"f:name":{}},"k:{\"mountPath\":\"/var/lib/rabbitmq/mnesia/\"}":{".":{},"f:mountPath":{},"f:name":{}}}}},"f:dnsPolicy":{},"f:initContainers":{".":{},"k:{\"name\":\"setup-container\"}":{".":{},"f:command":{},"f:image":{},"f:imagePullPolicy":{},"f:name":{},"f:resources":{".":{},"f:limits":{".":{},"f:cpu":{},"f:memory":{}},"f:requests":{".":{},"f:cpu":{},"f:memory":{}}},"f:securityContext":{".":{},"f:capabilities":{".":{},"f:drop":{}},"f:runAsUser":{}},"f:terminationMessagePath":{},"f:terminationMessagePolicy":{},"f:volumeMounts":{".":{},"k:{\"mountPath\":\"/operator\"}":{".":{},"f:mountPath":{},"f:name":{}},"k:{\"mountPath\":\"/tmp/default_user.conf\"}":{".":{},"f:mountPath":{},"f:name":{},"f:subPath":{}},"k:{\"mountPath\":\"/tmp/erlang-cookie-secret/\"}":{".":{},"f:mountPath":{},"f:name":{}},"k:{\"mountPath\":\"/tmp/rabbitmq-plugins/\"}":{".":{},"f:mountPath":{},"f:name":{}},"k:{\"mountPath\":\"/var/lib/rabbitmq/\"}":{".":{},"f:mountPath":{},"f:name":{}},"k:{\"mountPath\":\"/var/lib/rabbitmq/mnesia/\"}":{".":{},"f:mountPath":{},"f:name":{}}}}},"f:restartPolicy":{},"f:schedulerName":{},"f:securityContext":{".":{},"f:fsGroup":{},"f:runAsGroup":{},"f:runAsUser":{}},"f:serviceAccount":{},"f:serviceAccountName":{},"f:terminationGracePeriodSeconds":{},"f:topologySpreadConstraints":{".":{},"k:{\"topologyKey\":\"topology.kubernetes.io/zone\",\"whenUnsatisfiable\":\"ScheduleAnyway\"}":{".":{},"f:labelSelector":{".":{},"f:matchLabels":{".":{},"f:app.kubernetes.io/name":{}}},"f:maxSkew":{},"f:topologyKey":{},"f:whenUnsatisfiable":{}}},"f:volumes":{".":{},"k:{\"name\":\"erlang-cookie-secret\"}":{".":{},"f:name":{},"f:secret":{".":{},"f:defaultMode":{},"f:secretName":{}}},"k:{\"name\":\"plugins-conf\"}":{".":{},"f:configMap":{".":{},"f:defaultMode":{},"f:name":{}},"f:name":{}},"k:{\"name\":\"pod-info\"}":{".":{},"f:downwardAPI":{".":{},"f:defaultMode":{},"f:items":{}},"f:name":{}},"k:{\"name\":\"rabbitmq-confd\"}":{".":{},"f:name":{},"f:projected":{".":{},"f:defaultMode":{},"f:sources":{}}},"k:{\"name\":\"rabbitmq-erlang-cookie\"}":{".":{},"f:emptyDir":{},"f:name":{}},"k:{\"name\":\"rabbitmq-plugins\"}":{".":{},"f:emptyDir":{},"f:name":{}}}}},"f:updateStrategy":{"f:rollingUpdate":{".":{},"f:partition":{}},"f:type":{}},"f:volumeClaimTemplates":{}}}}]},"spec":{"replicas":1,"selector":{"matchLabels":{"app.kubernetes.io/name":"sonar-rabbitmq-cluster"}},"template":{"metadata":{"creationTimestamp":null,"labels":{"app.kubernetes.io/component":"rabbitmq","app.kubernetes.io/name":"sonar-rabbitmq-cluster","app.kubernetes.io/part-of":"rabbitmq"},"annotations":{"prometheus.io/port":"15692","prometheus.io/scrape":"true"}},"spec":{"volumes":[{"name":"plugins-conf","configMap":{"name":"sonar-rabbitmq-cluster-plugins-conf","defaultMode":420}},{"name":"rabbitmq-confd","projected":{"sources":[{"secret":{"name":"sonar-rabbitmq-cluster-default-user","items":[{"key":"default_user.conf","path":"default_user.conf"}]}},{"configMap":{"name":"sonar-rabbitmq-cluster-server-conf","items":[{"key":"operatorDefaults.conf","path":"operatorDefaults.conf"},{"key":"userDefinedConfiguration.conf","path":"userDefinedConfiguration.conf"}]}}],"defaultMode":420}},{"name":"rabbitmq-erlang-cookie","emptyDir":{}},{"name":"erlang-cookie-secret","secret":{"secretName":"sonar-rabbitmq-cluster-erlang-cookie","defaultMode":420}},{"name":"rabbitmq-plugins","emptyDir":{}},{"name":"pod-info","downwardAPI":{"items":[{"path":"skipPreStopChecks","fieldRef":{"apiVersion":"v1","fieldPath":"metadata.labels['skipPreStopChecks']"}}],"defaultMode":420}}],"initContainers":[{"name":"setup-container","image":"rabbitmq:3.8.12-management","command":["sh","-c","cp /tmp/erlang-cookie-secret/.erlang.cookie /var/lib/rabbitmq/.erlang.cookie \u0026\u0026 chown 999:999 /var/lib/rabbitmq/.erlang.cookie \u0026\u0026 chmod 600 /var/lib/rabbitmq/.erlang.cookie ; cp /tmp/rabbitmq-plugins/enabled_plugins /operator/enabled_plugins \u0026\u0026 chown 999:999 /operator/enabled_plugins ; chown 999:999 /var/lib/rabbitmq/mnesia/ ; echo '[default]' \u003e /var/lib/rabbitmq/.rabbitmqadmin.conf \u0026\u0026 sed -e 's/default_user/username/' -e 's/default_pass/password/' /tmp/default_user.conf \u003e\u003e /var/lib/rabbitmq/.rabbitmqadmin.conf \u0026\u0026 chown 999:999 /var/lib/rabbitmq/.rabbitmqadmin.conf \u0026\u0026 chmod 600 /var/lib/rabbitmq/.rabbitmqadmin.conf"],"resources":{"limits":{"cpu":"100m","memory":"500Mi"},"requests":{"cpu":"100m","memory":"500Mi"}},"volumeMounts":[{"name":"plugins-conf","mountPath":"/tmp/rabbitmq-plugins/"},{"name":"rabbitmq-erlang-cookie","mountPath":"/var/lib/rabbitmq/"},{"name":"erlang-cookie-secret","mountPath":"/tmp/erlang-cookie-secret/"},{"name":"rabbitmq-plugins","mountPath":"/operator"},{"name":"persistence","mountPath":"/var/lib/rabbitmq/mnesia/"},{"name":"rabbitmq-confd","mountPath":"/tmp/default_user.conf","subPath":"default_user.conf"}],"terminationMessagePath":"/dev/termination-log","terminationMessagePolicy":"File","imagePullPolicy":"IfNotPresent","securityContext":{"capabilities":{"drop":["FSETID","KILL","SETGID","SETUID","SETPCAP","NET_BIND_SERVICE","NET_RAW","SYS_CHROOT","MKNOD","AUDIT_WRITE","SETFCAP"]},"runAsUser":0}}],"containers":[{"name":"rabbitmq","image":"rabbitmq:3.8.12-management","ports":[{"name":"epmd","containerPort":4369,"protocol":"TCP"},{"name":"amqp","containerPort":5672,"protocol":"TCP"},{"name":"management","containerPort":15672,"protocol":"TCP"},{"name":"prometheus","containerPort":15692,"protocol":"TCP"}],"env":[{"name":"MY_POD_NAME","valueFrom":{"fieldRef":{"apiVersion":"v1","fieldPath":"metadata.name"}}},{"name":"MY_POD_NAMESPACE","valueFrom":{"fieldRef":{"apiVersion":"v1","fieldPath":"metadata.namespace"}}},{"name":"RABBITMQ_ENABLED_PLUGINS_FILE","value":"/operator/enabled_plugins"},{"name":"K8S_SERVICE_NAME","value":"sonar-rabbitmq-cluster-nodes"},{"name":"RABBITMQ_USE_LONGNAME","value":"true"},{"name":"RABBITMQ_NODENAME","value":"rabbit@$(MY_POD_NAME).$(K8S_SERVICE_NAME).$(MY_POD_NAMESPACE)"},{"name":"K8S_HOSTNAME_SUFFIX","value":".$(K8S_SERVICE_NAME).$(MY_POD_NAMESPACE)"}],"resources":{"limits":{"cpu":"2","memory":"2Gi"},"requests":{"cpu":"1","memory":"2Gi"}},"volumeMounts":[{"name":"rabbitmq-erlang-cookie","mountPath":"/var/lib/rabbitmq/"},{"name":"persistence","mountPath":"/var/lib/rabbitmq/mnesia/"},{"name":"rabbitmq-plugins","mountPath":"/operator"},{"name":"rabbitmq-confd","mountPath":"/etc/rabbitmq/conf.d/10-operatorDefaults.conf","subPath":"operatorDefaults.conf"},{"name":"rabbitmq-confd","mountPath":"/etc/rabbitmq/conf.d/11-default_user.conf","subPath":"default_user.conf"},{"name":"rabbitmq-confd","mountPath":"/etc/rabbitmq/conf.d/90-userDefinedConfiguration.conf","subPath":"userDefinedConfiguration.conf"},{"name":"pod-info","mountPath":"/etc/pod-info/"}],"readinessProbe":{"tcpSocket":{"port":"amqp"},"initialDelaySeconds":10,"timeoutSeconds":5,"periodSeconds":10,"successThreshold":1,"failureThreshold":3},"lifecycle":{"preStop":{"exec":{"command":["/bin/bash","-c","if [ ! -z \"$(cat /etc/pod-info/skipPreStopChecks)\" ]; then exit 0; fi; rabbitmq-upgrade await_online_quorum_plus_one -t 604800; rabbitmq-upgrade await_online_synchronized_mirror -t 604800; rabbitmq-upgrade drain -t 604800"]}}},"terminationMessagePath":"/dev/termination-log","terminationMessagePolicy":"File","imagePullPolicy":"IfNotPresent"}],"restartPolicy":"Always","terminationGracePeriodSeconds":604800,"dnsPolicy":"ClusterFirst","serviceAccountName":"sonar-rabbitmq-cluster-server","serviceAccount":"sonar-rabbitmq-cluster-server","automountServiceAccountToken":true,"securityContext":{"runAsUser":999,"runAsGroup":999,"fsGroup":999},"schedulerName":"default-scheduler","topologySpreadConstraints":[{"maxSkew":1,"topologyKey":"topology.kubernetes.io/zone","whenUnsatisfiable":"ScheduleAnyway","labelSelector":{"matchLabels":{"app.kubernetes.io/name":"sonar-rabbitmq-cluster"}}}]}},"volumeClaimTemplates":[{"metadata":{"name":"persistence","namespace":"default","creationTimestamp":null,"labels":{"app.kubernetes.io/component":"rabbitmq","app.kubernetes.io/name":"sonar-rabbitmq-cluster","app.kubernetes.io/part-of":"rabbitmq"},"ownerReferences":[{"apiVersion":"rabbitmq.com/v1beta1","kind":"RabbitmqCluster","name":"sonar-rabbitmq-cluster","uid":"955a1113-f3fc-4efc-a6d1-b15ae324f7c0","controller":true,"blockOwnerDeletion":false}]},"spec":{"accessModes":["ReadWriteOnce"],"resources":{"requests":{"storage":"10Gi"}},"volumeMode":"Filesystem"},"status":{"phase":"Pending"}}],"serviceName":"sonar-rabbitmq-cluster-nodes","podManagementPolicy":"Parallel","updateStrategy":{"type":"RollingUpdate","rollingUpdate":{"partition":0}},"revisionHistoryLimit":10},"status":{"observedGeneration":1,"replicas":1,"currentReplicas":1,"updatedReplicas":1,"currentRevision":"sonar-rabbitmq-cluster-server-594479b66","updateRevision":"sonar-rabbitmq-cluster-server-594479b66","collisionCount":0}}
2021/04/09 01:06:59 [SONAR-CACHE-READ]	Get	statefulset	default	sonar-rabbitmq-cluster-server	NoError
2021/04/09 01:07:02 [SONAR-EVENT]	20	Updated	statefulset	{"metadata":{"name":"sonar-rabbitmq-cluster-server","namespace":"default","selfLink":"/apis/apps/v1/namespaces/default/statefulsets/sonar-rabbitmq-cluster-server","uid":"82dfe424-f051-485c-8d8d-010eec6463c3","resourceVersion":"1718","generation":2,"creationTimestamp":"2021-04-09T01:06:28Z","deletionTimestamp":"2021-04-09T01:06:56Z","deletionGracePeriodSeconds":0,"labels":{"app.kubernetes.io/component":"rabbitmq","app.kubernetes.io/name":"sonar-rabbitmq-cluster","app.kubernetes.io/part-of":"rabbitmq"},"annotations":{"rabbitmq.com/createdAt":"2021-04-09T01:06:28Z"},"ownerReferences":[{"apiVersion":"rabbitmq.com/v1beta1","kind":"RabbitmqCluster","name":"sonar-rabbitmq-cluster","uid":"955a1113-f3fc-4efc-a6d1-b15ae324f7c0","controller":true,"blockOwnerDeletion":true}],"finalizers":["orphan"],"managedFields":[{"manager":"manager","operation":"Update","apiVersion":"apps/v1","time":"2021-04-09T01:06:49Z","fieldsType":"FieldsV1","fieldsV1":{"f:metadata":{"f:annotations":{".":{},"f:rabbitmq.com/createdAt":{}},"f:labels":{".":{},"f:app.kubernetes.io/component":{},"f:app.kubernetes.io/name":{},"f:app.kubernetes.io/part-of":{}},"f:ownerReferences":{".":{},"k:{\"uid\":\"955a1113-f3fc-4efc-a6d1-b15ae324f7c0\"}":{".":{},"f:apiVersion":{},"f:blockOwnerDeletion":{},"f:controller":{},"f:kind":{},"f:name":{},"f:uid":{}}}},"f:spec":{"f:podManagementPolicy":{},"f:replicas":{},"f:revisionHistoryLimit":{},"f:selector":{"f:matchLabels":{".":{},"f:app.kubernetes.io/name":{}}},"f:serviceName":{},"f:template":{"f:metadata":{"f:annotations":{".":{},"f:prometheus.io/port":{},"f:prometheus.io/scrape":{}},"f:labels":{".":{},"f:app.kubernetes.io/component":{},"f:app.kubernetes.io/name":{},"f:app.kubernetes.io/part-of":{}}},"f:spec":{"f:automountServiceAccountToken":{},"f:containers":{"k:{\"name\":\"rabbitmq\"}":{".":{},"f:env":{".":{},"k:{\"name\":\"K8S_HOSTNAME_SUFFIX\"}":{".":{},"f:name":{},"f:value":{}},"k:{\"name\":\"K8S_SERVICE_NAME\"}":{".":{},"f:name":{},"f:value":{}},"k:{\"name\":\"MY_POD_NAME\"}":{".":{},"f:name":{},"f:valueFrom":{".":{},"f:fieldRef":{".":{},"f:apiVersion":{},"f:fieldPath":{}}}},"k:{\"name\":\"MY_POD_NAMESPACE\"}":{".":{},"f:name":{},"f:valueFrom":{".":{},"f:fieldRef":{".":{},"f:apiVersion":{},"f:fieldPath":{}}}},"k:{\"name\":\"RABBITMQ_ENABLED_PLUGINS_FILE\"}":{".":{},"f:name":{},"f:value":{}},"k:{\"name\":\"RABBITMQ_NODENAME\"}":{".":{},"f:name":{},"f:value":{}},"k:{\"name\":\"RABBITMQ_USE_LONGNAME\"}":{".":{},"f:name":{},"f:value":{}}},"f:image":{},"f:imagePullPolicy":{},"f:lifecycle":{".":{},"f:preStop":{".":{},"f:exec":{".":{},"f:command":{}}}},"f:name":{},"f:ports":{".":{},"k:{\"containerPort\":4369,\"protocol\":\"TCP\"}":{".":{},"f:containerPort":{},"f:name":{},"f:protocol":{}},"k:{\"containerPort\":5672,\"protocol\":\"TCP\"}":{".":{},"f:containerPort":{},"f:name":{},"f:protocol":{}},"k:{\"containerPort\":15672,\"protocol\":\"TCP\"}":{".":{},"f:containerPort":{},"f:name":{},"f:protocol":{}},"k:{\"containerPort\":15692,\"protocol\":\"TCP\"}":{".":{},"f:containerPort":{},"f:name":{},"f:protocol":{}}},"f:readinessProbe":{".":{},"f:failureThreshold":{},"f:initialDelaySeconds":{},"f:periodSeconds":{},"f:successThreshold":{},"f:tcpSocket":{".":{},"f:port":{}},"f:timeoutSeconds":{}},"f:resources":{".":{},"f:limits":{".":{},"f:cpu":{},"f:memory":{}},"f:requests":{".":{},"f:cpu":{},"f:memory":{}}},"f:terminationMessagePath":{},"f:terminationMessagePolicy":{},"f:volumeMounts":{".":{},"k:{\"mountPath\":\"/etc/pod-info/\"}":{".":{},"f:mountPath":{},"f:name":{}},"k:{\"mountPath\":\"/etc/rabbitmq/conf.d/10-operatorDefaults.conf\"}":{".":{},"f:mountPath":{},"f:name":{},"f:subPath":{}},"k:{\"mountPath\":\"/etc/rabbitmq/conf.d/11-default_user.conf\"}":{".":{},"f:mountPath":{},"f:name":{},"f:subPath":{}},"k:{\"mountPath\":\"/etc/rabbitmq/conf.d/90-userDefinedConfiguration.conf\"}":{".":{},"f:mountPath":{},"f:name":{},"f:subPath":{}},"k:{\"mountPath\":\"/operator\"}":{".":{},"f:mountPath":{},"f:name":{}},"k:{\"mountPath\":\"/var/lib/rabbitmq/\"}":{".":{},"f:mountPath":{},"f:name":{}},"k:{\"mountPath\":\"/var/lib/rabbitmq/mnesia/\"}":{".":{},"f:mountPath":{},"f:name":{}}}}},"f:dnsPolicy":{},"f:initContainers":{".":{},"k:{\"name\":\"setup-container\"}":{".":{},"f:command":{},"f:image":{},"f:imagePullPolicy":{},"f:name":{},"f:resources":{".":{},"f:limits":{".":{},"f:cpu":{},"f:memory":{}},"f:requests":{".":{},"f:cpu":{},"f:memory":{}}},"f:securityContext":{".":{},"f:capabilities":{".":{},"f:drop":{}},"f:runAsUser":{}},"f:terminationMessagePath":{},"f:terminationMessagePolicy":{},"f:volumeMounts":{".":{},"k:{\"mountPath\":\"/operator\"}":{".":{},"f:mountPath":{},"f:name":{}},"k:{\"mountPath\":\"/tmp/default_user.conf\"}":{".":{},"f:mountPath":{},"f:name":{},"f:subPath":{}},"k:{\"mountPath\":\"/tmp/erlang-cookie-secret/\"}":{".":{},"f:mountPath":{},"f:name":{}},"k:{\"mountPath\":\"/tmp/rabbitmq-plugins/\"}":{".":{},"f:mountPath":{},"f:name":{}},"k:{\"mountPath\":\"/var/lib/rabbitmq/\"}":{".":{},"f:mountPath":{},"f:name":{}},"k:{\"mountPath\":\"/var/lib/rabbitmq/mnesia/\"}":{".":{},"f:mountPath":{},"f:name":{}}}}},"f:restartPolicy":{},"f:schedulerName":{},"f:securityContext":{".":{},"f:fsGroup":{},"f:runAsGroup":{},"f:runAsUser":{}},"f:serviceAccount":{},"f:serviceAccountName":{},"f:terminationGracePeriodSeconds":{},"f:topologySpreadConstraints":{".":{},"k:{\"topologyKey\":\"topology.kubernetes.io/zone\",\"whenUnsatisfiable\":\"ScheduleAnyway\"}":{".":{},"f:labelSelector":{".":{},"f:matchLabels":{".":{},"f:app.kubernetes.io/name":{}}},"f:maxSkew":{},"f:topologyKey":{},"f:whenUnsatisfiable":{}}},"f:volumes":{".":{},"k:{\"name\":\"erlang-cookie-secret\"}":{".":{},"f:name":{},"f:secret":{".":{},"f:defaultMode":{},"f:secretName":{}}},"k:{\"name\":\"plugins-conf\"}":{".":{},"f:configMap":{".":{},"f:defaultMode":{},"f:name":{}},"f:name":{}},"k:{\"name\":\"pod-info\"}":{".":{},"f:downwardAPI":{".":{},"f:defaultMode":{},"f:items":{}},"f:name":{}},"k:{\"name\":\"rabbitmq-confd\"}":{".":{},"f:name":{},"f:projected":{".":{},"f:defaultMode":{},"f:sources":{}}},"k:{\"name\":\"rabbitmq-erlang-cookie\"}":{".":{},"f:emptyDir":{},"f:name":{}},"k:{\"name\":\"rabbitmq-plugins\"}":{".":{},"f:emptyDir":{},"f:name":{}}}}},"f:updateStrategy":{"f:rollingUpdate":{".":{},"f:partition":{}},"f:type":{}},"f:volumeClaimTemplates":{}}}},{"manager":"kube-controller-manager","operation":"Update","apiVersion":"apps/v1","time":"2021-04-09T01:06:56Z","fieldsType":"FieldsV1","fieldsV1":{"f:status":{"f:collisionCount":{},"f:currentReplicas":{},"f:currentRevision":{},"f:observedGeneration":{},"f:replicas":{},"f:updateRevision":{},"f:updatedReplicas":{}}}}]},"spec":{"replicas":1,"selector":{"matchLabels":{"app.kubernetes.io/name":"sonar-rabbitmq-cluster"}},"template":{"metadata":{"creationTimestamp":null,"labels":{"app.kubernetes.io/component":"rabbitmq","app.kubernetes.io/name":"sonar-rabbitmq-cluster","app.kubernetes.io/part-of":"rabbitmq"},"annotations":{"prometheus.io/port":"15692","prometheus.io/scrape":"true"}},"spec":{"volumes":[{"name":"plugins-conf","configMap":{"name":"sonar-rabbitmq-cluster-plugins-conf","defaultMode":420}},{"name":"rabbitmq-confd","projected":{"sources":[{"secret":{"name":"sonar-rabbitmq-cluster-default-user","items":[{"key":"default_user.conf","path":"default_user.conf"}]}},{"configMap":{"name":"sonar-rabbitmq-cluster-server-conf","items":[{"key":"operatorDefaults.conf","path":"operatorDefaults.conf"},{"key":"userDefinedConfiguration.conf","path":"userDefinedConfiguration.conf"}]}}],"defaultMode":420}},{"name":"rabbitmq-erlang-cookie","emptyDir":{}},{"name":"erlang-cookie-secret","secret":{"secretName":"sonar-rabbitmq-cluster-erlang-cookie","defaultMode":420}},{"name":"rabbitmq-plugins","emptyDir":{}},{"name":"pod-info","downwardAPI":{"items":[{"path":"skipPreStopChecks","fieldRef":{"apiVersion":"v1","fieldPath":"metadata.labels['skipPreStopChecks']"}}],"defaultMode":420}}],"initContainers":[{"name":"setup-container","image":"rabbitmq:3.8.12-management","command":["sh","-c","cp /tmp/erlang-cookie-secret/.erlang.cookie /var/lib/rabbitmq/.erlang.cookie \u0026\u0026 chown 999:999 /var/lib/rabbitmq/.erlang.cookie \u0026\u0026 chmod 600 /var/lib/rabbitmq/.erlang.cookie ; cp /tmp/rabbitmq-plugins/enabled_plugins /operator/enabled_plugins \u0026\u0026 chown 999:999 /operator/enabled_plugins ; chown 999:999 /var/lib/rabbitmq/mnesia/ ; echo '[default]' \u003e /var/lib/rabbitmq/.rabbitmqadmin.conf \u0026\u0026 sed -e 's/default_user/username/' -e 's/default_pass/password/' /tmp/default_user.conf \u003e\u003e /var/lib/rabbitmq/.rabbitmqadmin.conf \u0026\u0026 chown 999:999 /var/lib/rabbitmq/.rabbitmqadmin.conf \u0026\u0026 chmod 600 /var/lib/rabbitmq/.rabbitmqadmin.conf"],"resources":{"limits":{"cpu":"100m","memory":"500Mi"},"requests":{"cpu":"100m","memory":"500Mi"}},"volumeMounts":[{"name":"plugins-conf","mountPath":"/tmp/rabbitmq-plugins/"},{"name":"rabbitmq-erlang-cookie","mountPath":"/var/lib/rabbitmq/"},{"name":"erlang-cookie-secret","mountPath":"/tmp/erlang-cookie-secret/"},{"name":"rabbitmq-plugins","mountPath":"/operator"},{"name":"persistence","mountPath":"/var/lib/rabbitmq/mnesia/"},{"name":"rabbitmq-confd","mountPath":"/tmp/default_user.conf","subPath":"default_user.conf"}],"terminationMessagePath":"/dev/termination-log","terminationMessagePolicy":"File","imagePullPolicy":"IfNotPresent","securityContext":{"capabilities":{"drop":["FSETID","KILL","SETGID","SETUID","SETPCAP","NET_BIND_SERVICE","NET_RAW","SYS_CHROOT","MKNOD","AUDIT_WRITE","SETFCAP"]},"runAsUser":0}}],"containers":[{"name":"rabbitmq","image":"rabbitmq:3.8.12-management","ports":[{"name":"epmd","containerPort":4369,"protocol":"TCP"},{"name":"amqp","containerPort":5672,"protocol":"TCP"},{"name":"management","containerPort":15672,"protocol":"TCP"},{"name":"prometheus","containerPort":15692,"protocol":"TCP"}],"env":[{"name":"MY_POD_NAME","valueFrom":{"fieldRef":{"apiVersion":"v1","fieldPath":"metadata.name"}}},{"name":"MY_POD_NAMESPACE","valueFrom":{"fieldRef":{"apiVersion":"v1","fieldPath":"metadata.namespace"}}},{"name":"RABBITMQ_ENABLED_PLUGINS_FILE","value":"/operator/enabled_plugins"},{"name":"K8S_SERVICE_NAME","value":"sonar-rabbitmq-cluster-nodes"},{"name":"RABBITMQ_USE_LONGNAME","value":"true"},{"name":"RABBITMQ_NODENAME","value":"rabbit@$(MY_POD_NAME).$(K8S_SERVICE_NAME).$(MY_POD_NAMESPACE)"},{"name":"K8S_HOSTNAME_SUFFIX","value":".$(K8S_SERVICE_NAME).$(MY_POD_NAMESPACE)"}],"resources":{"limits":{"cpu":"2","memory":"2Gi"},"requests":{"cpu":"1","memory":"2Gi"}},"volumeMounts":[{"name":"rabbitmq-erlang-cookie","mountPath":"/var/lib/rabbitmq/"},{"name":"persistence","mountPath":"/var/lib/rabbitmq/mnesia/"},{"name":"rabbitmq-plugins","mountPath":"/operator"},{"name":"rabbitmq-confd","mountPath":"/etc/rabbitmq/conf.d/10-operatorDefaults.conf","subPath":"operatorDefaults.conf"},{"name":"rabbitmq-confd","mountPath":"/etc/rabbitmq/conf.d/11-default_user.conf","subPath":"default_user.conf"},{"name":"rabbitmq-confd","mountPath":"/etc/rabbitmq/conf.d/90-userDefinedConfiguration.conf","subPath":"userDefinedConfiguration.conf"},{"name":"pod-info","mountPath":"/etc/pod-info/"}],"readinessProbe":{"tcpSocket":{"port":"amqp"},"initialDelaySeconds":10,"timeoutSeconds":5,"periodSeconds":10,"successThreshold":1,"failureThreshold":3},"lifecycle":{"preStop":{"exec":{"command":["/bin/bash","-c","if [ ! -z \"$(cat /etc/pod-info/skipPreStopChecks)\" ]; then exit 0; fi; rabbitmq-upgrade await_online_quorum_plus_one -t 604800; rabbitmq-upgrade await_online_synchronized_mirror -t 604800; rabbitmq-upgrade drain -t 604800"]}}},"terminationMessagePath":"/dev/termination-log","terminationMessagePolicy":"File","imagePullPolicy":"IfNotPresent"}],"restartPolicy":"Always","terminationGracePeriodSeconds":604800,"dnsPolicy":"ClusterFirst","serviceAccountName":"sonar-rabbitmq-cluster-server","serviceAccount":"sonar-rabbitmq-cluster-server","automountServiceAccountToken":true,"securityContext":{"runAsUser":999,"runAsGroup":999,"fsGroup":999},"schedulerName":"default-scheduler","topologySpreadConstraints":[{"maxSkew":1,"topologyKey":"topology.kubernetes.io/zone","whenUnsatisfiable":"ScheduleAnyway","labelSelector":{"matchLabels":{"app.kubernetes.io/name":"sonar-rabbitmq-cluster"}}}]}},"volumeClaimTemplates":[{"metadata":{"name":"persistence","namespace":"default","creationTimestamp":null,"labels":{"app.kubernetes.io/component":"rabbitmq","app.kubernetes.io/name":"sonar-rabbitmq-cluster","app.kubernetes.io/part-of":"rabbitmq"},"ownerReferences":[{"apiVersion":"rabbitmq.com/v1beta1","kind":"RabbitmqCluster","name":"sonar-rabbitmq-cluster","uid":"955a1113-f3fc-4efc-a6d1-b15ae324f7c0","controller":true,"blockOwnerDeletion":false}]},"spec":{"accessModes":["ReadWriteOnce"],"resources":{"requests":{"storage":"10Gi"}},"volumeMode":"Filesystem"},"status":{"phase":"Pending"}}],"serviceName":"sonar-rabbitmq-cluster-nodes","podManagementPolicy":"Parallel","updateStrategy":{"type":"RollingUpdate","rollingUpdate":{"partition":0}},"revisionHistoryLimit":10},"status":{"observedGeneration":2,"replicas":1,"currentReplicas":1,"updatedReplicas":1,"currentRevision":"sonar-rabbitmq-cluster-server-594479b66","updateRevision":"sonar-rabbitmq-cluster-server-594479b66","collisionCount":0}}
2021/04/09 01:07:05 [SONAR-EVENT]	21	Deleted	statefulset	{"metadata":{"name":"sonar-rabbitmq-cluster-server","namespace":"default","selfLink":"/apis/apps/v1/namespaces/default/statefulsets/sonar-rabbitmq-cluster-server","uid":"82dfe424-f051-485c-8d8d-010eec6463c3","resourceVersion":"1724","generation":2,"creationTimestamp":"2021-04-09T01:06:28Z","deletionTimestamp":"2021-04-09T01:06:56Z","deletionGracePeriodSeconds":0,"labels":{"app.kubernetes.io/component":"rabbitmq","app.kubernetes.io/name":"sonar-rabbitmq-cluster","app.kubernetes.io/part-of":"rabbitmq"},"annotations":{"rabbitmq.com/createdAt":"2021-04-09T01:06:28Z"},"ownerReferences":[{"apiVersion":"rabbitmq.com/v1beta1","kind":"RabbitmqCluster","name":"sonar-rabbitmq-cluster","uid":"955a1113-f3fc-4efc-a6d1-b15ae324f7c0","controller":true,"blockOwnerDeletion":true}],"finalizers":["orphan"],"managedFields":[{"manager":"manager","operation":"Update","apiVersion":"apps/v1","time":"2021-04-09T01:06:49Z","fieldsType":"FieldsV1","fieldsV1":{"f:metadata":{"f:annotations":{".":{},"f:rabbitmq.com/createdAt":{}},"f:labels":{".":{},"f:app.kubernetes.io/component":{},"f:app.kubernetes.io/name":{},"f:app.kubernetes.io/part-of":{}},"f:ownerReferences":{".":{},"k:{\"uid\":\"955a1113-f3fc-4efc-a6d1-b15ae324f7c0\"}":{".":{},"f:apiVersion":{},"f:blockOwnerDeletion":{},"f:controller":{},"f:kind":{},"f:name":{},"f:uid":{}}}},"f:spec":{"f:podManagementPolicy":{},"f:replicas":{},"f:revisionHistoryLimit":{},"f:selector":{"f:matchLabels":{".":{},"f:app.kubernetes.io/name":{}}},"f:serviceName":{},"f:template":{"f:metadata":{"f:annotations":{".":{},"f:prometheus.io/port":{},"f:prometheus.io/scrape":{}},"f:labels":{".":{},"f:app.kubernetes.io/component":{},"f:app.kubernetes.io/name":{},"f:app.kubernetes.io/part-of":{}}},"f:spec":{"f:automountServiceAccountToken":{},"f:containers":{"k:{\"name\":\"rabbitmq\"}":{".":{},"f:env":{".":{},"k:{\"name\":\"K8S_HOSTNAME_SUFFIX\"}":{".":{},"f:name":{},"f:value":{}},"k:{\"name\":\"K8S_SERVICE_NAME\"}":{".":{},"f:name":{},"f:value":{}},"k:{\"name\":\"MY_POD_NAME\"}":{".":{},"f:name":{},"f:valueFrom":{".":{},"f:fieldRef":{".":{},"f:apiVersion":{},"f:fieldPath":{}}}},"k:{\"name\":\"MY_POD_NAMESPACE\"}":{".":{},"f:name":{},"f:valueFrom":{".":{},"f:fieldRef":{".":{},"f:apiVersion":{},"f:fieldPath":{}}}},"k:{\"name\":\"RABBITMQ_ENABLED_PLUGINS_FILE\"}":{".":{},"f:name":{},"f:value":{}},"k:{\"name\":\"RABBITMQ_NODENAME\"}":{".":{},"f:name":{},"f:value":{}},"k:{\"name\":\"RABBITMQ_USE_LONGNAME\"}":{".":{},"f:name":{},"f:value":{}}},"f:image":{},"f:imagePullPolicy":{},"f:lifecycle":{".":{},"f:preStop":{".":{},"f:exec":{".":{},"f:command":{}}}},"f:name":{},"f:ports":{".":{},"k:{\"containerPort\":4369,\"protocol\":\"TCP\"}":{".":{},"f:containerPort":{},"f:name":{},"f:protocol":{}},"k:{\"containerPort\":5672,\"protocol\":\"TCP\"}":{".":{},"f:containerPort":{},"f:name":{},"f:protocol":{}},"k:{\"containerPort\":15672,\"protocol\":\"TCP\"}":{".":{},"f:containerPort":{},"f:name":{},"f:protocol":{}},"k:{\"containerPort\":15692,\"protocol\":\"TCP\"}":{".":{},"f:containerPort":{},"f:name":{},"f:protocol":{}}},"f:readinessProbe":{".":{},"f:failureThreshold":{},"f:initialDelaySeconds":{},"f:periodSeconds":{},"f:successThreshold":{},"f:tcpSocket":{".":{},"f:port":{}},"f:timeoutSeconds":{}},"f:resources":{".":{},"f:limits":{".":{},"f:cpu":{},"f:memory":{}},"f:requests":{".":{},"f:cpu":{},"f:memory":{}}},"f:terminationMessagePath":{},"f:terminationMessagePolicy":{},"f:volumeMounts":{".":{},"k:{\"mountPath\":\"/etc/pod-info/\"}":{".":{},"f:mountPath":{},"f:name":{}},"k:{\"mountPath\":\"/etc/rabbitmq/conf.d/10-operatorDefaults.conf\"}":{".":{},"f:mountPath":{},"f:name":{},"f:subPath":{}},"k:{\"mountPath\":\"/etc/rabbitmq/conf.d/11-default_user.conf\"}":{".":{},"f:mountPath":{},"f:name":{},"f:subPath":{}},"k:{\"mountPath\":\"/etc/rabbitmq/conf.d/90-userDefinedConfiguration.conf\"}":{".":{},"f:mountPath":{},"f:name":{},"f:subPath":{}},"k:{\"mountPath\":\"/operator\"}":{".":{},"f:mountPath":{},"f:name":{}},"k:{\"mountPath\":\"/var/lib/rabbitmq/\"}":{".":{},"f:mountPath":{},"f:name":{}},"k:{\"mountPath\":\"/var/lib/rabbitmq/mnesia/\"}":{".":{},"f:mountPath":{},"f:name":{}}}}},"f:dnsPolicy":{},"f:initContainers":{".":{},"k:{\"name\":\"setup-container\"}":{".":{},"f:command":{},"f:image":{},"f:imagePullPolicy":{},"f:name":{},"f:resources":{".":{},"f:limits":{".":{},"f:cpu":{},"f:memory":{}},"f:requests":{".":{},"f:cpu":{},"f:memory":{}}},"f:securityContext":{".":{},"f:capabilities":{".":{},"f:drop":{}},"f:runAsUser":{}},"f:terminationMessagePath":{},"f:terminationMessagePolicy":{},"f:volumeMounts":{".":{},"k:{\"mountPath\":\"/operator\"}":{".":{},"f:mountPath":{},"f:name":{}},"k:{\"mountPath\":\"/tmp/default_user.conf\"}":{".":{},"f:mountPath":{},"f:name":{},"f:subPath":{}},"k:{\"mountPath\":\"/tmp/erlang-cookie-secret/\"}":{".":{},"f:mountPath":{},"f:name":{}},"k:{\"mountPath\":\"/tmp/rabbitmq-plugins/\"}":{".":{},"f:mountPath":{},"f:name":{}},"k:{\"mountPath\":\"/var/lib/rabbitmq/\"}":{".":{},"f:mountPath":{},"f:name":{}},"k:{\"mountPath\":\"/var/lib/rabbitmq/mnesia/\"}":{".":{},"f:mountPath":{},"f:name":{}}}}},"f:restartPolicy":{},"f:schedulerName":{},"f:securityContext":{".":{},"f:fsGroup":{},"f:runAsGroup":{},"f:runAsUser":{}},"f:serviceAccount":{},"f:serviceAccountName":{},"f:terminationGracePeriodSeconds":{},"f:topologySpreadConstraints":{".":{},"k:{\"topologyKey\":\"topology.kubernetes.io/zone\",\"whenUnsatisfiable\":\"ScheduleAnyway\"}":{".":{},"f:labelSelector":{".":{},"f:matchLabels":{".":{},"f:app.kubernetes.io/name":{}}},"f:maxSkew":{},"f:topologyKey":{},"f:whenUnsatisfiable":{}}},"f:volumes":{".":{},"k:{\"name\":\"erlang-cookie-secret\"}":{".":{},"f:name":{},"f:secret":{".":{},"f:defaultMode":{},"f:secretName":{}}},"k:{\"name\":\"plugins-conf\"}":{".":{},"f:configMap":{".":{},"f:defaultMode":{},"f:name":{}},"f:name":{}},"k:{\"name\":\"pod-info\"}":{".":{},"f:downwardAPI":{".":{},"f:defaultMode":{},"f:items":{}},"f:name":{}},"k:{\"name\":\"rabbitmq-confd\"}":{".":{},"f:name":{},"f:projected":{".":{},"f:defaultMode":{},"f:sources":{}}},"k:{\"name\":\"rabbitmq-erlang-cookie\"}":{".":{},"f:emptyDir":{},"f:name":{}},"k:{\"name\":\"rabbitmq-plugins\"}":{".":{},"f:emptyDir":{},"f:name":{}}}}},"f:updateStrategy":{"f:rollingUpdate":{".":{},"f:partition":{}},"f:type":{}},"f:volumeClaimTemplates":{}}}},{"manager":"kube-controller-manager","operation":"Update","apiVersion":"apps/v1","time":"2021-04-09T01:06:56Z","fieldsType":"FieldsV1","fieldsV1":{"f:status":{"f:collisionCount":{},"f:currentReplicas":{},"f:currentRevision":{},"f:observedGeneration":{},"f:replicas":{},"f:updateRevision":{},"f:updatedReplicas":{}}}}]},"spec":{"replicas":1,"selector":{"matchLabels":{"app.kubernetes.io/name":"sonar-rabbitmq-cluster"}},"template":{"metadata":{"creationTimestamp":null,"labels":{"app.kubernetes.io/component":"rabbitmq","app.kubernetes.io/name":"sonar-rabbitmq-cluster","app.kubernetes.io/part-of":"rabbitmq"},"annotations":{"prometheus.io/port":"15692","prometheus.io/scrape":"true"}},"spec":{"volumes":[{"name":"plugins-conf","configMap":{"name":"sonar-rabbitmq-cluster-plugins-conf","defaultMode":420}},{"name":"rabbitmq-confd","projected":{"sources":[{"secret":{"name":"sonar-rabbitmq-cluster-default-user","items":[{"key":"default_user.conf","path":"default_user.conf"}]}},{"configMap":{"name":"sonar-rabbitmq-cluster-server-conf","items":[{"key":"operatorDefaults.conf","path":"operatorDefaults.conf"},{"key":"userDefinedConfiguration.conf","path":"userDefinedConfiguration.conf"}]}}],"defaultMode":420}},{"name":"rabbitmq-erlang-cookie","emptyDir":{}},{"name":"erlang-cookie-secret","secret":{"secretName":"sonar-rabbitmq-cluster-erlang-cookie","defaultMode":420}},{"name":"rabbitmq-plugins","emptyDir":{}},{"name":"pod-info","downwardAPI":{"items":[{"path":"skipPreStopChecks","fieldRef":{"apiVersion":"v1","fieldPath":"metadata.labels['skipPreStopChecks']"}}],"defaultMode":420}}],"initContainers":[{"name":"setup-container","image":"rabbitmq:3.8.12-management","command":["sh","-c","cp /tmp/erlang-cookie-secret/.erlang.cookie /var/lib/rabbitmq/.erlang.cookie \u0026\u0026 chown 999:999 /var/lib/rabbitmq/.erlang.cookie \u0026\u0026 chmod 600 /var/lib/rabbitmq/.erlang.cookie ; cp /tmp/rabbitmq-plugins/enabled_plugins /operator/enabled_plugins \u0026\u0026 chown 999:999 /operator/enabled_plugins ; chown 999:999 /var/lib/rabbitmq/mnesia/ ; echo '[default]' \u003e /var/lib/rabbitmq/.rabbitmqadmin.conf \u0026\u0026 sed -e 's/default_user/username/' -e 's/default_pass/password/' /tmp/default_user.conf \u003e\u003e /var/lib/rabbitmq/.rabbitmqadmin.conf \u0026\u0026 chown 999:999 /var/lib/rabbitmq/.rabbitmqadmin.conf \u0026\u0026 chmod 600 /var/lib/rabbitmq/.rabbitmqadmin.conf"],"resources":{"limits":{"cpu":"100m","memory":"500Mi"},"requests":{"cpu":"100m","memory":"500Mi"}},"volumeMounts":[{"name":"plugins-conf","mountPath":"/tmp/rabbitmq-plugins/"},{"name":"rabbitmq-erlang-cookie","mountPath":"/var/lib/rabbitmq/"},{"name":"erlang-cookie-secret","mountPath":"/tmp/erlang-cookie-secret/"},{"name":"rabbitmq-plugins","mountPath":"/operator"},{"name":"persistence","mountPath":"/var/lib/rabbitmq/mnesia/"},{"name":"rabbitmq-confd","mountPath":"/tmp/default_user.conf","subPath":"default_user.conf"}],"terminationMessagePath":"/dev/termination-log","terminationMessagePolicy":"File","imagePullPolicy":"IfNotPresent","securityContext":{"capabilities":{"drop":["FSETID","KILL","SETGID","SETUID","SETPCAP","NET_BIND_SERVICE","NET_RAW","SYS_CHROOT","MKNOD","AUDIT_WRITE","SETFCAP"]},"runAsUser":0}}],"containers":[{"name":"rabbitmq","image":"rabbitmq:3.8.12-management","ports":[{"name":"epmd","containerPort":4369,"protocol":"TCP"},{"name":"amqp","containerPort":5672,"protocol":"TCP"},{"name":"management","containerPort":15672,"protocol":"TCP"},{"name":"prometheus","containerPort":15692,"protocol":"TCP"}],"env":[{"name":"MY_POD_NAME","valueFrom":{"fieldRef":{"apiVersion":"v1","fieldPath":"metadata.name"}}},{"name":"MY_POD_NAMESPACE","valueFrom":{"fieldRef":{"apiVersion":"v1","fieldPath":"metadata.namespace"}}},{"name":"RABBITMQ_ENABLED_PLUGINS_FILE","value":"/operator/enabled_plugins"},{"name":"K8S_SERVICE_NAME","value":"sonar-rabbitmq-cluster-nodes"},{"name":"RABBITMQ_USE_LONGNAME","value":"true"},{"name":"RABBITMQ_NODENAME","value":"rabbit@$(MY_POD_NAME).$(K8S_SERVICE_NAME).$(MY_POD_NAMESPACE)"},{"name":"K8S_HOSTNAME_SUFFIX","value":".$(K8S_SERVICE_NAME).$(MY_POD_NAMESPACE)"}],"resources":{"limits":{"cpu":"2","memory":"2Gi"},"requests":{"cpu":"1","memory":"2Gi"}},"volumeMounts":[{"name":"rabbitmq-erlang-cookie","mountPath":"/var/lib/rabbitmq/"},{"name":"persistence","mountPath":"/var/lib/rabbitmq/mnesia/"},{"name":"rabbitmq-plugins","mountPath":"/operator"},{"name":"rabbitmq-confd","mountPath":"/etc/rabbitmq/conf.d/10-operatorDefaults.conf","subPath":"operatorDefaults.conf"},{"name":"rabbitmq-confd","mountPath":"/etc/rabbitmq/conf.d/11-default_user.conf","subPath":"default_user.conf"},{"name":"rabbitmq-confd","mountPath":"/etc/rabbitmq/conf.d/90-userDefinedConfiguration.conf","subPath":"userDefinedConfiguration.conf"},{"name":"pod-info","mountPath":"/etc/pod-info/"}],"readinessProbe":{"tcpSocket":{"port":"amqp"},"initialDelaySeconds":10,"timeoutSeconds":5,"periodSeconds":10,"successThreshold":1,"failureThreshold":3},"lifecycle":{"preStop":{"exec":{"command":["/bin/bash","-c","if [ ! -z \"$(cat /etc/pod-info/skipPreStopChecks)\" ]; then exit 0; fi; rabbitmq-upgrade await_online_quorum_plus_one -t 604800; rabbitmq-upgrade await_online_synchronized_mirror -t 604800; rabbitmq-upgrade drain -t 604800"]}}},"terminationMessagePath":"/dev/termination-log","terminationMessagePolicy":"File","imagePullPolicy":"IfNotPresent"}],"restartPolicy":"Always","terminationGracePeriodSeconds":604800,"dnsPolicy":"ClusterFirst","serviceAccountName":"sonar-rabbitmq-cluster-server","serviceAccount":"sonar-rabbitmq-cluster-server","automountServiceAccountToken":true,"securityContext":{"runAsUser":999,"runAsGroup":999,"fsGroup":999},"schedulerName":"default-scheduler","topologySpreadConstraints":[{"maxSkew":1,"topologyKey":"topology.kubernetes.io/zone","whenUnsatisfiable":"ScheduleAnyway","labelSelector":{"matchLabels":{"app.kubernetes.io/name":"sonar-rabbitmq-cluster"}}}]}},"volumeClaimTemplates":[{"metadata":{"name":"persistence","namespace":"default","creationTimestamp":null,"labels":{"app.kubernetes.io/component":"rabbitmq","app.kubernetes.io/name":"sonar-rabbitmq-cluster","app.kubernetes.io/part-of":"rabbitmq"},"ownerReferences":[{"apiVersion":"rabbitmq.com/v1beta1","kind":"RabbitmqCluster","name":"sonar-rabbitmq-cluster","uid":"955a1113-f3fc-4efc-a6d1-b15ae324f7c0","controller":true,"blockOwnerDeletion":false}]},"spec":{"accessModes":["ReadWriteOnce"],"resources":{"requests":{"storage":"10Gi"}},"volumeMode":"Filesystem"},"status":{"phase":"Pending"}}],"serviceName":"sonar-rabbitmq-cluster-nodes","podManagementPolicy":"Parallel","updateStrategy":{"type":"RollingUpdate","rollingUpdate":{"partition":0}},"revisionHistoryLimit":10},"status":{"observedGeneration":2,"replicas":1,"currentReplicas":1,"updatedReplicas":1,"currentRevision":"sonar-rabbitmq-cluster-server-594479b66","updateRevision":"sonar-rabbitmq-cluster-server-594479b66","collisionCount":0}}
2021/04/09 01:07:05 [SONAR-CACHE-READ]	Get	statefulset	default	sonar-rabbitmq-cluster-server	NotFound
2021/04/09 01:07:08 [SONAR-EVENT]	22	Replaced	persistentvolumeclaim	{"metadata":{"name":"persistence-sonar-rabbitmq-cluster-server-0","namespace":"default","selfLink":"/api/v1/namespaces/default/persistentvolumeclaims/persistence-sonar-rabbitmq-cluster-server-0","uid":"f24d58ed-6f2a-46c5-97c7-c8667c8dba3b","resourceVersion":"1581","creationTimestamp":"2021-04-09T01:06:28Z","labels":{"app.kubernetes.io/component":"rabbitmq","app.kubernetes.io/name":"sonar-rabbitmq-cluster","app.kubernetes.io/part-of":"rabbitmq"},"annotations":{"pv.kubernetes.io/bind-completed":"yes","pv.kubernetes.io/bound-by-controller":"yes","volume.beta.kubernetes.io/storage-provisioner":"rancher.io/local-path","volume.kubernetes.io/selected-node":"kind-worker2"},"ownerReferences":[{"apiVersion":"rabbitmq.com/v1beta1","kind":"RabbitmqCluster","name":"sonar-rabbitmq-cluster","uid":"955a1113-f3fc-4efc-a6d1-b15ae324f7c0","controller":true,"blockOwnerDeletion":false}],"finalizers":["kubernetes.io/pvc-protection"],"managedFields":[{"manager":"kube-scheduler","operation":"Update","apiVersion":"v1","time":"2021-04-09T01:06:28Z","fieldsType":"FieldsV1","fieldsV1":{"f:metadata":{"f:annotations":{".":{},"f:volume.kubernetes.io/selected-node":{}}}}},{"manager":"kube-controller-manager","operation":"Update","apiVersion":"v1","time":"2021-04-09T01:06:29Z","fieldsType":"FieldsV1","fieldsV1":{"f:metadata":{"f:annotations":{"f:pv.kubernetes.io/bind-completed":{},"f:pv.kubernetes.io/bound-by-controller":{},"f:volume.beta.kubernetes.io/storage-provisioner":{}},"f:labels":{".":{},"f:app.kubernetes.io/component":{},"f:app.kubernetes.io/name":{},"f:app.kubernetes.io/part-of":{}},"f:ownerReferences":{".":{},"k:{\"uid\":\"955a1113-f3fc-4efc-a6d1-b15ae324f7c0\"}":{".":{},"f:apiVersion":{},"f:blockOwnerDeletion":{},"f:controller":{},"f:kind":{},"f:name":{},"f:uid":{}}}},"f:spec":{"f:accessModes":{},"f:resources":{"f:requests":{".":{},"f:storage":{}}},"f:volumeMode":{},"f:volumeName":{}},"f:status":{"f:accessModes":{},"f:capacity":{".":{},"f:storage":{}},"f:phase":{}}}}]},"spec":{"accessModes":["ReadWriteOnce"],"resources":{"requests":{"storage":"10Gi"}},"volumeName":"pvc-f24d58ed-6f2a-46c5-97c7-c8667c8dba3b","storageClassName":"standard","volumeMode":"Filesystem"},"status":{"phase":"Bound","accessModes":["ReadWriteOnce"],"capacity":{"storage":"10Gi"}}}
2021/04/09 01:07:08 [SONAR-CACHE-READ]	Get	persistentvolumeclaim	default	persistence-sonar-rabbitmq-cluster-server-0	NoError
2021/04/09 01:07:08 [SONAR-SIDE-EFFECT]	Update	persistentvolumeclaim	default	persistence-sonar-rabbitmq-cluster-server-0	Forbidden
2021/04/09 01:07:08 [SONAR-EVENT]	23	Updated	rabbitmqcluster	{"metadata":{"name":"sonar-rabbitmq-cluster","namespace":"default","selfLink":"/apis/rabbitmq.com/v1beta1/namespaces/default/rabbitmqclusters/sonar-rabbitmq-cluster","uid":"955a1113-f3fc-4efc-a6d1-b15ae324f7c0","resourceVersion":"1780","generation":3,"creationTimestamp":"2021-04-09T01:06:05Z","annotations":{"kubectl.kubernetes.io/last-applied-configuration":"{\"apiVersion\":\"rabbitmq.com/v1beta1\",\"kind\":\"RabbitmqCluster\",\"metadata\":{\"annotations\":{},\"name\":\"sonar-rabbitmq-cluster\",\"namespace\":\"default\"},\"spec\":{\"persistence\":{\"storage\":\"15Gi\"},\"replicas\":1}}\n"},"finalizers":["deletion.finalizers.rabbitmqclusters.rabbitmq.com"],"managedFields":[{"manager":"kubectl-client-side-apply","operation":"Update","apiVersion":"rabbitmq.com/v1beta1","time":"2021-04-09T01:06:55Z","fieldsType":"FieldsV1","fieldsV1":{"f:metadata":{"f:annotations":{".":{},"f:kubectl.kubernetes.io/last-applied-configuration":{}}},"f:spec":{".":{},"f:image":{},"f:persistence":{".":{},"f:storage":{}},"f:replicas":{},"f:resources":{".":{},"f:limits":{".":{},"f:memory":{}},"f:requests":{".":{},"f:memory":{}}},"f:service":{".":{},"f:type":{}},"f:terminationGracePeriodSeconds":{}}}},{"manager":"manager","operation":"Update","apiVersion":"rabbitmq.com/v1beta1","time":"2021-04-09T01:07:08Z","fieldsType":"FieldsV1","fieldsV1":{"f:metadata":{"f:finalizers":{}},"f:spec":{"f:override":{},"f:rabbitmq":{},"f:resources":{"f:limits":{"f:cpu":{}},"f:requests":{"f:cpu":{}}},"f:tls":{}},"f:status":{".":{},"f:conditions":{},"f:defaultUser":{".":{},"f:secretReference":{".":{},"f:keys":{".":{},"f:password":{},"f:username":{}},"f:name":{},"f:namespace":{}},"f:serviceReference":{".":{},"f:name":{},"f:namespace":{}}}}}}]},"spec":{"replicas":1,"image":"rabbitmq:3.8.12-management","service":{"type":"ClusterIP"},"persistence":{"storage":"15Gi"},"resources":{"limits":{"cpu":"2","memory":"2Gi"},"requests":{"cpu":"1","memory":"2Gi"}},"rabbitmq":{},"tls":{},"override":{},"terminationGracePeriodSeconds":604800},"status":{"conditions":[{"type":"AllReplicasReady","status":"False","lastTransitionTime":"2021-04-09T01:06:52Z","reason":"NotAllPodsReady","message":"0/1 Pods ready"},{"type":"ClusterAvailable","status":"False","lastTransitionTime":"2021-04-09T01:06:52Z","reason":"NoEndpointsAvailable","message":"The service has no endpoints available"},{"type":"NoWarnings","status":"True","lastTransitionTime":"2021-04-09T01:06:52Z","reason":"NoWarnings"},{"type":"ReconcileSuccess","status":"False","lastTransitionTime":"2021-04-09T01:07:08Z","reason":"FailedReconcilePVC","message":"failed to update PersistentVolumeClaim persistence-sonar-rabbitmq-cluster-server-0: persistentvolumeclaims \"persistence-sonar-rabbitmq-cluster-server-0\" is forbidden: only dynamically provisioned pvc can be resized and the storageclass that provisions the pvc must support resize"}],"defaultUser":{"secretReference":{"name":"sonar-rabbitmq-cluster-default-user","namespace":"default","keys":{"password":"password","username":"username"}},"serviceReference":{"name":"sonar-rabbitmq-cluster","namespace":"default"}}}}
2021/04/09 01:07:08 [SONAR-FINISH-RECONCILE]	rabbitmqcluster	4
2021/04/09 01:07:08 [SONAR-START-RECONCILE]	rabbitmqcluster	5
2021/04/09 01:07:08 [SONAR-CACHE-READ]	Get	rabbitmqcluster	default	sonar-rabbitmq-cluster	NoError
2021/04/09 01:07:08 [SONAR-CACHE-READ]	Get	statefulset	default	sonar-rabbitmq-cluster-server	NotFound
2021/04/09 01:07:08 [SONAR-CACHE-READ]	Get	endpoints	default	sonar-rabbitmq-cluster	NoError
2021/04/09 01:07:08 [SONAR-CACHE-READ]	Get	statefulset	default	sonar-rabbitmq-cluster-server	NotFound
2021/04/09 01:07:08 [SONAR-CACHE-READ]	Get	service	default	sonar-rabbitmq-cluster-nodes	NoError
2021/04/09 01:07:08 [SONAR-CACHE-READ]	Get	service	default	sonar-rabbitmq-cluster	NoError
2021/04/09 01:07:08 [SONAR-CACHE-READ]	Get	secret	default	sonar-rabbitmq-cluster-erlang-cookie	NoError
2021/04/09 01:07:08 [SONAR-CACHE-READ]	Get	secret	default	sonar-rabbitmq-cluster-default-user	NoError
2021/04/09 01:07:08 [SONAR-CACHE-READ]	Get	configmap	default	sonar-rabbitmq-cluster-plugins-conf	NoError
2021/04/09 01:07:08 [SONAR-CACHE-READ]	Get	configmap	default	sonar-rabbitmq-cluster-server-conf	NoError
2021/04/09 01:07:08 [SONAR-CACHE-READ]	Get	serviceaccount	default	sonar-rabbitmq-cluster-server	NoError
2021/04/09 01:07:08 [SONAR-CACHE-READ]	Get	role	default	sonar-rabbitmq-cluster-peer-discovery	NoError
2021/04/09 01:07:08 [SONAR-CACHE-READ]	Get	rolebinding	default	sonar-rabbitmq-cluster-server	NoError
2021/04/09 01:07:08 [SONAR-CACHE-READ]	Get	statefulset	default	sonar-rabbitmq-cluster-server	NotFound
2021/04/09 01:07:08 [SONAR-CACHE-READ]	Get	statefulset	default	sonar-rabbitmq-cluster-server	NotFound
2021/04/09 01:07:08 [SONAR-SIDE-EFFECT]	Create	statefulset	default	sonar-rabbitmq-cluster-server	NoError
2021/04/09 01:07:11 [SONAR-EVENT]	24	Updated	rabbitmqcluster	{"metadata":{"name":"sonar-rabbitmq-cluster","namespace":"default","selfLink":"/apis/rabbitmq.com/v1beta1/namespaces/default/rabbitmqclusters/sonar-rabbitmq-cluster","uid":"955a1113-f3fc-4efc-a6d1-b15ae324f7c0","resourceVersion":"1782","generation":3,"creationTimestamp":"2021-04-09T01:06:05Z","annotations":{"kubectl.kubernetes.io/last-applied-configuration":"{\"apiVersion\":\"rabbitmq.com/v1beta1\",\"kind\":\"RabbitmqCluster\",\"metadata\":{\"annotations\":{},\"name\":\"sonar-rabbitmq-cluster\",\"namespace\":\"default\"},\"spec\":{\"persistence\":{\"storage\":\"15Gi\"},\"replicas\":1}}\n"},"finalizers":["deletion.finalizers.rabbitmqclusters.rabbitmq.com"],"managedFields":[{"manager":"kubectl-client-side-apply","operation":"Update","apiVersion":"rabbitmq.com/v1beta1","time":"2021-04-09T01:06:55Z","fieldsType":"FieldsV1","fieldsV1":{"f:metadata":{"f:annotations":{".":{},"f:kubectl.kubernetes.io/last-applied-configuration":{}}},"f:spec":{".":{},"f:image":{},"f:persistence":{".":{},"f:storage":{}},"f:replicas":{},"f:resources":{".":{},"f:limits":{".":{},"f:memory":{}},"f:requests":{".":{},"f:memory":{}}},"f:service":{".":{},"f:type":{}},"f:terminationGracePeriodSeconds":{}}}},{"manager":"manager","operation":"Update","apiVersion":"rabbitmq.com/v1beta1","time":"2021-04-09T01:07:08Z","fieldsType":"FieldsV1","fieldsV1":{"f:metadata":{"f:finalizers":{}},"f:spec":{"f:override":{},"f:rabbitmq":{},"f:resources":{"f:limits":{"f:cpu":{}},"f:requests":{"f:cpu":{}}},"f:tls":{}},"f:status":{".":{},"f:conditions":{},"f:defaultUser":{".":{},"f:secretReference":{".":{},"f:keys":{".":{},"f:password":{},"f:username":{}},"f:name":{},"f:namespace":{}},"f:serviceReference":{".":{},"f:name":{},"f:namespace":{}}}}}}]},"spec":{"replicas":1,"image":"rabbitmq:3.8.12-management","service":{"type":"ClusterIP"},"persistence":{"storage":"15Gi"},"resources":{"limits":{"cpu":"2","memory":"2Gi"},"requests":{"cpu":"1","memory":"2Gi"}},"rabbitmq":{},"tls":{},"override":{},"terminationGracePeriodSeconds":604800},"status":{"conditions":[{"type":"AllReplicasReady","status":"Unknown","lastTransitionTime":"2021-04-09T01:07:08Z","reason":"MissingStatefulSet","message":"Could not find StatefulSet"},{"type":"ClusterAvailable","status":"True","lastTransitionTime":"2021-04-09T01:07:08Z","reason":"AtLeastOneEndpointAvailable"},{"type":"NoWarnings","status":"Unknown","lastTransitionTime":"2021-04-09T01:07:08Z","reason":"MissingStatefulSet","message":"Could not find StatefulSet"},{"type":"ReconcileSuccess","status":"False","lastTransitionTime":"2021-04-09T01:07:08Z","reason":"FailedReconcilePVC","message":"failed to update PersistentVolumeClaim persistence-sonar-rabbitmq-cluster-server-0: persistentvolumeclaims \"persistence-sonar-rabbitmq-cluster-server-0\" is forbidden: only dynamically provisioned pvc can be resized and the storageclass that provisions the pvc must support resize"}],"defaultUser":{"secretReference":{"name":"sonar-rabbitmq-cluster-default-user","namespace":"default","keys":{"password":"password","username":"username"}},"serviceReference":{"name":"sonar-rabbitmq-cluster","namespace":"default"}}}}
2021/04/09 01:07:14 [SONAR-EVENT]	25	Added	statefulset	{"metadata":{"name":"sonar-rabbitmq-cluster-server","namespace":"default","selfLink":"/apis/apps/v1/namespaces/default/statefulsets/sonar-rabbitmq-cluster-server","uid":"2aa29b6e-a32c-4c1f-a68f-97c3efd4f6b2","resourceVersion":"1783","generation":1,"creationTimestamp":"2021-04-09T01:07:08Z","labels":{"app.kubernetes.io/component":"rabbitmq","app.kubernetes.io/name":"sonar-rabbitmq-cluster","app.kubernetes.io/part-of":"rabbitmq"},"ownerReferences":[{"apiVersion":"rabbitmq.com/v1beta1","kind":"RabbitmqCluster","name":"sonar-rabbitmq-cluster","uid":"955a1113-f3fc-4efc-a6d1-b15ae324f7c0","controller":true,"blockOwnerDeletion":true}],"managedFields":[{"manager":"manager","operation":"Update","apiVersion":"apps/v1","time":"2021-04-09T01:07:08Z","fieldsType":"FieldsV1","fieldsV1":{"f:metadata":{"f:labels":{".":{},"f:app.kubernetes.io/component":{},"f:app.kubernetes.io/name":{},"f:app.kubernetes.io/part-of":{}},"f:ownerReferences":{".":{},"k:{\"uid\":\"955a1113-f3fc-4efc-a6d1-b15ae324f7c0\"}":{".":{},"f:apiVersion":{},"f:blockOwnerDeletion":{},"f:controller":{},"f:kind":{},"f:name":{},"f:uid":{}}}},"f:spec":{"f:podManagementPolicy":{},"f:replicas":{},"f:revisionHistoryLimit":{},"f:selector":{"f:matchLabels":{".":{},"f:app.kubernetes.io/name":{}}},"f:serviceName":{},"f:template":{"f:metadata":{"f:annotations":{".":{},"f:prometheus.io/port":{},"f:prometheus.io/scrape":{}},"f:labels":{".":{},"f:app.kubernetes.io/component":{},"f:app.kubernetes.io/name":{},"f:app.kubernetes.io/part-of":{}}},"f:spec":{"f:automountServiceAccountToken":{},"f:containers":{"k:{\"name\":\"rabbitmq\"}":{".":{},"f:env":{".":{},"k:{\"name\":\"K8S_HOSTNAME_SUFFIX\"}":{".":{},"f:name":{},"f:value":{}},"k:{\"name\":\"K8S_SERVICE_NAME\"}":{".":{},"f:name":{},"f:value":{}},"k:{\"name\":\"MY_POD_NAME\"}":{".":{},"f:name":{},"f:valueFrom":{".":{},"f:fieldRef":{".":{},"f:apiVersion":{},"f:fieldPath":{}}}},"k:{\"name\":\"MY_POD_NAMESPACE\"}":{".":{},"f:name":{},"f:valueFrom":{".":{},"f:fieldRef":{".":{},"f:apiVersion":{},"f:fieldPath":{}}}},"k:{\"name\":\"RABBITMQ_ENABLED_PLUGINS_FILE\"}":{".":{},"f:name":{},"f:value":{}},"k:{\"name\":\"RABBITMQ_NODENAME\"}":{".":{},"f:name":{},"f:value":{}},"k:{\"name\":\"RABBITMQ_USE_LONGNAME\"}":{".":{},"f:name":{},"f:value":{}}},"f:image":{},"f:imagePullPolicy":{},"f:lifecycle":{".":{},"f:preStop":{".":{},"f:exec":{".":{},"f:command":{}}}},"f:name":{},"f:ports":{".":{},"k:{\"containerPort\":4369,\"protocol\":\"TCP\"}":{".":{},"f:containerPort":{},"f:name":{},"f:protocol":{}},"k:{\"containerPort\":5672,\"protocol\":\"TCP\"}":{".":{},"f:containerPort":{},"f:name":{},"f:protocol":{}},"k:{\"containerPort\":15672,\"protocol\":\"TCP\"}":{".":{},"f:containerPort":{},"f:name":{},"f:protocol":{}},"k:{\"containerPort\":15692,\"protocol\":\"TCP\"}":{".":{},"f:containerPort":{},"f:name":{},"f:protocol":{}}},"f:readinessProbe":{".":{},"f:failureThreshold":{},"f:initialDelaySeconds":{},"f:periodSeconds":{},"f:successThreshold":{},"f:tcpSocket":{".":{},"f:port":{}},"f:timeoutSeconds":{}},"f:resources":{".":{},"f:limits":{".":{},"f:cpu":{},"f:memory":{}},"f:requests":{".":{},"f:cpu":{},"f:memory":{}}},"f:terminationMessagePath":{},"f:terminationMessagePolicy":{},"f:volumeMounts":{".":{},"k:{\"mountPath\":\"/etc/pod-info/\"}":{".":{},"f:mountPath":{},"f:name":{}},"k:{\"mountPath\":\"/etc/rabbitmq/conf.d/10-operatorDefaults.conf\"}":{".":{},"f:mountPath":{},"f:name":{},"f:subPath":{}},"k:{\"mountPath\":\"/etc/rabbitmq/conf.d/11-default_user.conf\"}":{".":{},"f:mountPath":{},"f:name":{},"f:subPath":{}},"k:{\"mountPath\":\"/etc/rabbitmq/conf.d/90-userDefinedConfiguration.conf\"}":{".":{},"f:mountPath":{},"f:name":{},"f:subPath":{}},"k:{\"mountPath\":\"/operator\"}":{".":{},"f:mountPath":{},"f:name":{}},"k:{\"mountPath\":\"/var/lib/rabbitmq/\"}":{".":{},"f:mountPath":{},"f:name":{}},"k:{\"mountPath\":\"/var/lib/rabbitmq/mnesia/\"}":{".":{},"f:mountPath":{},"f:name":{}}}}},"f:dnsPolicy":{},"f:initContainers":{".":{},"k:{\"name\":\"setup-container\"}":{".":{},"f:command":{},"f:image":{},"f:imagePullPolicy":{},"f:name":{},"f:resources":{".":{},"f:limits":{".":{},"f:cpu":{},"f:memory":{}},"f:requests":{".":{},"f:cpu":{},"f:memory":{}}},"f:securityContext":{".":{},"f:capabilities":{".":{},"f:drop":{}},"f:runAsUser":{}},"f:terminationMessagePath":{},"f:terminationMessagePolicy":{},"f:volumeMounts":{".":{},"k:{\"mountPath\":\"/operator\"}":{".":{},"f:mountPath":{},"f:name":{}},"k:{\"mountPath\":\"/tmp/default_user.conf\"}":{".":{},"f:mountPath":{},"f:name":{},"f:subPath":{}},"k:{\"mountPath\":\"/tmp/erlang-cookie-secret/\"}":{".":{},"f:mountPath":{},"f:name":{}},"k:{\"mountPath\":\"/tmp/rabbitmq-plugins/\"}":{".":{},"f:mountPath":{},"f:name":{}},"k:{\"mountPath\":\"/var/lib/rabbitmq/\"}":{".":{},"f:mountPath":{},"f:name":{}},"k:{\"mountPath\":\"/var/lib/rabbitmq/mnesia/\"}":{".":{},"f:mountPath":{},"f:name":{}}}}},"f:restartPolicy":{},"f:schedulerName":{},"f:securityContext":{".":{},"f:fsGroup":{},"f:runAsGroup":{},"f:runAsUser":{}},"f:serviceAccount":{},"f:serviceAccountName":{},"f:terminationGracePeriodSeconds":{},"f:topologySpreadConstraints":{".":{},"k:{\"topologyKey\":\"topology.kubernetes.io/zone\",\"whenUnsatisfiable\":\"ScheduleAnyway\"}":{".":{},"f:labelSelector":{".":{},"f:matchLabels":{".":{},"f:app.kubernetes.io/name":{}}},"f:maxSkew":{},"f:topologyKey":{},"f:whenUnsatisfiable":{}}},"f:volumes":{".":{},"k:{\"name\":\"erlang-cookie-secret\"}":{".":{},"f:name":{},"f:secret":{".":{},"f:defaultMode":{},"f:secretName":{}}},"k:{\"name\":\"plugins-conf\"}":{".":{},"f:configMap":{".":{},"f:defaultMode":{},"f:name":{}},"f:name":{}},"k:{\"name\":\"pod-info\"}":{".":{},"f:downwardAPI":{".":{},"f:defaultMode":{},"f:items":{}},"f:name":{}},"k:{\"name\":\"rabbitmq-confd\"}":{".":{},"f:name":{},"f:projected":{".":{},"f:defaultMode":{},"f:sources":{}}},"k:{\"name\":\"rabbitmq-erlang-cookie\"}":{".":{},"f:emptyDir":{},"f:name":{}},"k:{\"name\":\"rabbitmq-plugins\"}":{".":{},"f:emptyDir":{},"f:name":{}}}}},"f:updateStrategy":{"f:rollingUpdate":{".":{},"f:partition":{}},"f:type":{}},"f:volumeClaimTemplates":{}}}}]},"spec":{"replicas":1,"selector":{"matchLabels":{"app.kubernetes.io/name":"sonar-rabbitmq-cluster"}},"template":{"metadata":{"creationTimestamp":null,"labels":{"app.kubernetes.io/component":"rabbitmq","app.kubernetes.io/name":"sonar-rabbitmq-cluster","app.kubernetes.io/part-of":"rabbitmq"},"annotations":{"prometheus.io/port":"15692","prometheus.io/scrape":"true"}},"spec":{"volumes":[{"name":"plugins-conf","configMap":{"name":"sonar-rabbitmq-cluster-plugins-conf","defaultMode":420}},{"name":"rabbitmq-confd","projected":{"sources":[{"secret":{"name":"sonar-rabbitmq-cluster-default-user","items":[{"key":"default_user.conf","path":"default_user.conf"}]}},{"configMap":{"name":"sonar-rabbitmq-cluster-server-conf","items":[{"key":"operatorDefaults.conf","path":"operatorDefaults.conf"},{"key":"userDefinedConfiguration.conf","path":"userDefinedConfiguration.conf"}]}}],"defaultMode":420}},{"name":"rabbitmq-erlang-cookie","emptyDir":{}},{"name":"erlang-cookie-secret","secret":{"secretName":"sonar-rabbitmq-cluster-erlang-cookie","defaultMode":420}},{"name":"rabbitmq-plugins","emptyDir":{}},{"name":"pod-info","downwardAPI":{"items":[{"path":"skipPreStopChecks","fieldRef":{"apiVersion":"v1","fieldPath":"metadata.labels['skipPreStopChecks']"}}],"defaultMode":420}}],"initContainers":[{"name":"setup-container","image":"rabbitmq:3.8.12-management","command":["sh","-c","cp /tmp/erlang-cookie-secret/.erlang.cookie /var/lib/rabbitmq/.erlang.cookie \u0026\u0026 chown 999:999 /var/lib/rabbitmq/.erlang.cookie \u0026\u0026 chmod 600 /var/lib/rabbitmq/.erlang.cookie ; cp /tmp/rabbitmq-plugins/enabled_plugins /operator/enabled_plugins \u0026\u0026 chown 999:999 /operator/enabled_plugins ; chown 999:999 /var/lib/rabbitmq/mnesia/ ; echo '[default]' \u003e /var/lib/rabbitmq/.rabbitmqadmin.conf \u0026\u0026 sed -e 's/default_user/username/' -e 's/default_pass/password/' /tmp/default_user.conf \u003e\u003e /var/lib/rabbitmq/.rabbitmqadmin.conf \u0026\u0026 chown 999:999 /var/lib/rabbitmq/.rabbitmqadmin.conf \u0026\u0026 chmod 600 /var/lib/rabbitmq/.rabbitmqadmin.conf"],"resources":{"limits":{"cpu":"100m","memory":"500Mi"},"requests":{"cpu":"100m","memory":"500Mi"}},"volumeMounts":[{"name":"plugins-conf","mountPath":"/tmp/rabbitmq-plugins/"},{"name":"rabbitmq-erlang-cookie","mountPath":"/var/lib/rabbitmq/"},{"name":"erlang-cookie-secret","mountPath":"/tmp/erlang-cookie-secret/"},{"name":"rabbitmq-plugins","mountPath":"/operator"},{"name":"persistence","mountPath":"/var/lib/rabbitmq/mnesia/"},{"name":"rabbitmq-confd","mountPath":"/tmp/default_user.conf","subPath":"default_user.conf"}],"terminationMessagePath":"/dev/termination-log","terminationMessagePolicy":"File","imagePullPolicy":"IfNotPresent","securityContext":{"capabilities":{"drop":["FSETID","KILL","SETGID","SETUID","SETPCAP","NET_BIND_SERVICE","NET_RAW","SYS_CHROOT","MKNOD","AUDIT_WRITE","SETFCAP"]},"runAsUser":0}}],"containers":[{"name":"rabbitmq","image":"rabbitmq:3.8.12-management","ports":[{"name":"epmd","containerPort":4369,"protocol":"TCP"},{"name":"amqp","containerPort":5672,"protocol":"TCP"},{"name":"management","containerPort":15672,"protocol":"TCP"},{"name":"prometheus","containerPort":15692,"protocol":"TCP"}],"env":[{"name":"MY_POD_NAME","valueFrom":{"fieldRef":{"apiVersion":"v1","fieldPath":"metadata.name"}}},{"name":"MY_POD_NAMESPACE","valueFrom":{"fieldRef":{"apiVersion":"v1","fieldPath":"metadata.namespace"}}},{"name":"RABBITMQ_ENABLED_PLUGINS_FILE","value":"/operator/enabled_plugins"},{"name":"K8S_SERVICE_NAME","value":"sonar-rabbitmq-cluster-nodes"},{"name":"RABBITMQ_USE_LONGNAME","value":"true"},{"name":"RABBITMQ_NODENAME","value":"rabbit@$(MY_POD_NAME).$(K8S_SERVICE_NAME).$(MY_POD_NAMESPACE)"},{"name":"K8S_HOSTNAME_SUFFIX","value":".$(K8S_SERVICE_NAME).$(MY_POD_NAMESPACE)"}],"resources":{"limits":{"cpu":"2","memory":"2Gi"},"requests":{"cpu":"1","memory":"2Gi"}},"volumeMounts":[{"name":"rabbitmq-erlang-cookie","mountPath":"/var/lib/rabbitmq/"},{"name":"persistence","mountPath":"/var/lib/rabbitmq/mnesia/"},{"name":"rabbitmq-plugins","mountPath":"/operator"},{"name":"rabbitmq-confd","mountPath":"/etc/rabbitmq/conf.d/10-operatorDefaults.conf","subPath":"operatorDefaults.conf"},{"name":"rabbitmq-confd","mountPath":"/etc/rabbitmq/conf.d/11-default_user.conf","subPath":"default_user.conf"},{"name":"rabbitmq-confd","mountPath":"/etc/rabbitmq/conf.d/90-userDefinedConfiguration.conf","subPath":"userDefinedConfiguration.conf"},{"name":"pod-info","mountPath":"/etc/pod-info/"}],"readinessProbe":{"tcpSocket":{"port":"amqp"},"initialDelaySeconds":10,"timeoutSeconds":5,"periodSeconds":10,"successThreshold":1,"failureThreshold":3},"lifecycle":{"preStop":{"exec":{"command":["/bin/bash","-c","if [ ! -z \"$(cat /etc/pod-info/skipPreStopChecks)\" ]; then exit 0; fi; rabbitmq-upgrade await_online_quorum_plus_one -t 604800; rabbitmq-upgrade await_online_synchronized_mirror -t 604800; rabbitmq-upgrade drain -t 604800"]}}},"terminationMessagePath":"/dev/termination-log","terminationMessagePolicy":"File","imagePullPolicy":"IfNotPresent"}],"restartPolicy":"Always","terminationGracePeriodSeconds":604800,"dnsPolicy":"ClusterFirst","serviceAccountName":"sonar-rabbitmq-cluster-server","serviceAccount":"sonar-rabbitmq-cluster-server","automountServiceAccountToken":true,"securityContext":{"runAsUser":999,"runAsGroup":999,"fsGroup":999},"schedulerName":"default-scheduler","topologySpreadConstraints":[{"maxSkew":1,"topologyKey":"topology.kubernetes.io/zone","whenUnsatisfiable":"ScheduleAnyway","labelSelector":{"matchLabels":{"app.kubernetes.io/name":"sonar-rabbitmq-cluster"}}}]}},"volumeClaimTemplates":[{"metadata":{"name":"persistence","namespace":"default","creationTimestamp":null,"labels":{"app.kubernetes.io/component":"rabbitmq","app.kubernetes.io/name":"sonar-rabbitmq-cluster","app.kubernetes.io/part-of":"rabbitmq"},"ownerReferences":[{"apiVersion":"rabbitmq.com/v1beta1","kind":"RabbitmqCluster","name":"sonar-rabbitmq-cluster","uid":"955a1113-f3fc-4efc-a6d1-b15ae324f7c0","controller":true,"blockOwnerDeletion":false}]},"spec":{"accessModes":["ReadWriteOnce"],"resources":{"requests":{"storage":"15Gi"}},"volumeMode":"Filesystem"},"status":{"phase":"Pending"}}],"serviceName":"sonar-rabbitmq-cluster-nodes","podManagementPolicy":"Parallel","updateStrategy":{"type":"RollingUpdate","rollingUpdate":{"partition":0}},"revisionHistoryLimit":10},"status":{"replicas":0}}
2021/04/09 01:07:14 [SONAR-CACHE-READ]	Get	statefulset	default	sonar-rabbitmq-cluster-server	NoError
2021/04/09 01:07:14 [SONAR-SIDE-EFFECT]	Update	statefulset	default	sonar-rabbitmq-cluster-server	Conflict
2021/04/09 01:07:17 [SONAR-EVENT]	26	Updated	statefulset	{"metadata":{"name":"sonar-rabbitmq-cluster-server","namespace":"default","selfLink":"/apis/apps/v1/namespaces/default/statefulsets/sonar-rabbitmq-cluster-server","uid":"2aa29b6e-a32c-4c1f-a68f-97c3efd4f6b2","resourceVersion":"1787","generation":1,"creationTimestamp":"2021-04-09T01:07:08Z","labels":{"app.kubernetes.io/component":"rabbitmq","app.kubernetes.io/name":"sonar-rabbitmq-cluster","app.kubernetes.io/part-of":"rabbitmq"},"ownerReferences":[{"apiVersion":"rabbitmq.com/v1beta1","kind":"RabbitmqCluster","name":"sonar-rabbitmq-cluster","uid":"955a1113-f3fc-4efc-a6d1-b15ae324f7c0","controller":true,"blockOwnerDeletion":true}],"managedFields":[{"manager":"kube-controller-manager","operation":"Update","apiVersion":"apps/v1","time":"2021-04-09T01:07:08Z","fieldsType":"FieldsV1","fieldsV1":{"f:status":{"f:collisionCount":{},"f:currentReplicas":{},"f:currentRevision":{},"f:observedGeneration":{},"f:readyReplicas":{},"f:replicas":{},"f:updateRevision":{},"f:updatedReplicas":{}}}},{"manager":"manager","operation":"Update","apiVersion":"apps/v1","time":"2021-04-09T01:07:08Z","fieldsType":"FieldsV1","fieldsV1":{"f:metadata":{"f:labels":{".":{},"f:app.kubernetes.io/component":{},"f:app.kubernetes.io/name":{},"f:app.kubernetes.io/part-of":{}},"f:ownerReferences":{".":{},"k:{\"uid\":\"955a1113-f3fc-4efc-a6d1-b15ae324f7c0\"}":{".":{},"f:apiVersion":{},"f:blockOwnerDeletion":{},"f:controller":{},"f:kind":{},"f:name":{},"f:uid":{}}}},"f:spec":{"f:podManagementPolicy":{},"f:replicas":{},"f:revisionHistoryLimit":{},"f:selector":{"f:matchLabels":{".":{},"f:app.kubernetes.io/name":{}}},"f:serviceName":{},"f:template":{"f:metadata":{"f:annotations":{".":{},"f:prometheus.io/port":{},"f:prometheus.io/scrape":{}},"f:labels":{".":{},"f:app.kubernetes.io/component":{},"f:app.kubernetes.io/name":{},"f:app.kubernetes.io/part-of":{}}},"f:spec":{"f:automountServiceAccountToken":{},"f:containers":{"k:{\"name\":\"rabbitmq\"}":{".":{},"f:env":{".":{},"k:{\"name\":\"K8S_HOSTNAME_SUFFIX\"}":{".":{},"f:name":{},"f:value":{}},"k:{\"name\":\"K8S_SERVICE_NAME\"}":{".":{},"f:name":{},"f:value":{}},"k:{\"name\":\"MY_POD_NAME\"}":{".":{},"f:name":{},"f:valueFrom":{".":{},"f:fieldRef":{".":{},"f:apiVersion":{},"f:fieldPath":{}}}},"k:{\"name\":\"MY_POD_NAMESPACE\"}":{".":{},"f:name":{},"f:valueFrom":{".":{},"f:fieldRef":{".":{},"f:apiVersion":{},"f:fieldPath":{}}}},"k:{\"name\":\"RABBITMQ_ENABLED_PLUGINS_FILE\"}":{".":{},"f:name":{},"f:value":{}},"k:{\"name\":\"RABBITMQ_NODENAME\"}":{".":{},"f:name":{},"f:value":{}},"k:{\"name\":\"RABBITMQ_USE_LONGNAME\"}":{".":{},"f:name":{},"f:value":{}}},"f:image":{},"f:imagePullPolicy":{},"f:lifecycle":{".":{},"f:preStop":{".":{},"f:exec":{".":{},"f:command":{}}}},"f:name":{},"f:ports":{".":{},"k:{\"containerPort\":4369,\"protocol\":\"TCP\"}":{".":{},"f:containerPort":{},"f:name":{},"f:protocol":{}},"k:{\"containerPort\":5672,\"protocol\":\"TCP\"}":{".":{},"f:containerPort":{},"f:name":{},"f:protocol":{}},"k:{\"containerPort\":15672,\"protocol\":\"TCP\"}":{".":{},"f:containerPort":{},"f:name":{},"f:protocol":{}},"k:{\"containerPort\":15692,\"protocol\":\"TCP\"}":{".":{},"f:containerPort":{},"f:name":{},"f:protocol":{}}},"f:readinessProbe":{".":{},"f:failureThreshold":{},"f:initialDelaySeconds":{},"f:periodSeconds":{},"f:successThreshold":{},"f:tcpSocket":{".":{},"f:port":{}},"f:timeoutSeconds":{}},"f:resources":{".":{},"f:limits":{".":{},"f:cpu":{},"f:memory":{}},"f:requests":{".":{},"f:cpu":{},"f:memory":{}}},"f:terminationMessagePath":{},"f:terminationMessagePolicy":{},"f:volumeMounts":{".":{},"k:{\"mountPath\":\"/etc/pod-info/\"}":{".":{},"f:mountPath":{},"f:name":{}},"k:{\"mountPath\":\"/etc/rabbitmq/conf.d/10-operatorDefaults.conf\"}":{".":{},"f:mountPath":{},"f:name":{},"f:subPath":{}},"k:{\"mountPath\":\"/etc/rabbitmq/conf.d/11-default_user.conf\"}":{".":{},"f:mountPath":{},"f:name":{},"f:subPath":{}},"k:{\"mountPath\":\"/etc/rabbitmq/conf.d/90-userDefinedConfiguration.conf\"}":{".":{},"f:mountPath":{},"f:name":{},"f:subPath":{}},"k:{\"mountPath\":\"/operator\"}":{".":{},"f:mountPath":{},"f:name":{}},"k:{\"mountPath\":\"/var/lib/rabbitmq/\"}":{".":{},"f:mountPath":{},"f:name":{}},"k:{\"mountPath\":\"/var/lib/rabbitmq/mnesia/\"}":{".":{},"f:mountPath":{},"f:name":{}}}}},"f:dnsPolicy":{},"f:initContainers":{".":{},"k:{\"name\":\"setup-container\"}":{".":{},"f:command":{},"f:image":{},"f:imagePullPolicy":{},"f:name":{},"f:resources":{".":{},"f:limits":{".":{},"f:cpu":{},"f:memory":{}},"f:requests":{".":{},"f:cpu":{},"f:memory":{}}},"f:securityContext":{".":{},"f:capabilities":{".":{},"f:drop":{}},"f:runAsUser":{}},"f:terminationMessagePath":{},"f:terminationMessagePolicy":{},"f:volumeMounts":{".":{},"k:{\"mountPath\":\"/operator\"}":{".":{},"f:mountPath":{},"f:name":{}},"k:{\"mountPath\":\"/tmp/default_user.conf\"}":{".":{},"f:mountPath":{},"f:name":{},"f:subPath":{}},"k:{\"mountPath\":\"/tmp/erlang-cookie-secret/\"}":{".":{},"f:mountPath":{},"f:name":{}},"k:{\"mountPath\":\"/tmp/rabbitmq-plugins/\"}":{".":{},"f:mountPath":{},"f:name":{}},"k:{\"mountPath\":\"/var/lib/rabbitmq/\"}":{".":{},"f:mountPath":{},"f:name":{}},"k:{\"mountPath\":\"/var/lib/rabbitmq/mnesia/\"}":{".":{},"f:mountPath":{},"f:name":{}}}}},"f:restartPolicy":{},"f:schedulerName":{},"f:securityContext":{".":{},"f:fsGroup":{},"f:runAsGroup":{},"f:runAsUser":{}},"f:serviceAccount":{},"f:serviceAccountName":{},"f:terminationGracePeriodSeconds":{},"f:topologySpreadConstraints":{".":{},"k:{\"topologyKey\":\"topology.kubernetes.io/zone\",\"whenUnsatisfiable\":\"ScheduleAnyway\"}":{".":{},"f:labelSelector":{".":{},"f:matchLabels":{".":{},"f:app.kubernetes.io/name":{}}},"f:maxSkew":{},"f:topologyKey":{},"f:whenUnsatisfiable":{}}},"f:volumes":{".":{},"k:{\"name\":\"erlang-cookie-secret\"}":{".":{},"f:name":{},"f:secret":{".":{},"f:defaultMode":{},"f:secretName":{}}},"k:{\"name\":\"plugins-conf\"}":{".":{},"f:configMap":{".":{},"f:defaultMode":{},"f:name":{}},"f:name":{}},"k:{\"name\":\"pod-info\"}":{".":{},"f:downwardAPI":{".":{},"f:defaultMode":{},"f:items":{}},"f:name":{}},"k:{\"name\":\"rabbitmq-confd\"}":{".":{},"f:name":{},"f:projected":{".":{},"f:defaultMode":{},"f:sources":{}}},"k:{\"name\":\"rabbitmq-erlang-cookie\"}":{".":{},"f:emptyDir":{},"f:name":{}},"k:{\"name\":\"rabbitmq-plugins\"}":{".":{},"f:emptyDir":{},"f:name":{}}}}},"f:updateStrategy":{"f:rollingUpdate":{".":{},"f:partition":{}},"f:type":{}},"f:volumeClaimTemplates":{}}}}]},"spec":{"replicas":1,"selector":{"matchLabels":{"app.kubernetes.io/name":"sonar-rabbitmq-cluster"}},"template":{"metadata":{"creationTimestamp":null,"labels":{"app.kubernetes.io/component":"rabbitmq","app.kubernetes.io/name":"sonar-rabbitmq-cluster","app.kubernetes.io/part-of":"rabbitmq"},"annotations":{"prometheus.io/port":"15692","prometheus.io/scrape":"true"}},"spec":{"volumes":[{"name":"plugins-conf","configMap":{"name":"sonar-rabbitmq-cluster-plugins-conf","defaultMode":420}},{"name":"rabbitmq-confd","projected":{"sources":[{"secret":{"name":"sonar-rabbitmq-cluster-default-user","items":[{"key":"default_user.conf","path":"default_user.conf"}]}},{"configMap":{"name":"sonar-rabbitmq-cluster-server-conf","items":[{"key":"operatorDefaults.conf","path":"operatorDefaults.conf"},{"key":"userDefinedConfiguration.conf","path":"userDefinedConfiguration.conf"}]}}],"defaultMode":420}},{"name":"rabbitmq-erlang-cookie","emptyDir":{}},{"name":"erlang-cookie-secret","secret":{"secretName":"sonar-rabbitmq-cluster-erlang-cookie","defaultMode":420}},{"name":"rabbitmq-plugins","emptyDir":{}},{"name":"pod-info","downwardAPI":{"items":[{"path":"skipPreStopChecks","fieldRef":{"apiVersion":"v1","fieldPath":"metadata.labels['skipPreStopChecks']"}}],"defaultMode":420}}],"initContainers":[{"name":"setup-container","image":"rabbitmq:3.8.12-management","command":["sh","-c","cp /tmp/erlang-cookie-secret/.erlang.cookie /var/lib/rabbitmq/.erlang.cookie \u0026\u0026 chown 999:999 /var/lib/rabbitmq/.erlang.cookie \u0026\u0026 chmod 600 /var/lib/rabbitmq/.erlang.cookie ; cp /tmp/rabbitmq-plugins/enabled_plugins /operator/enabled_plugins \u0026\u0026 chown 999:999 /operator/enabled_plugins ; chown 999:999 /var/lib/rabbitmq/mnesia/ ; echo '[default]' \u003e /var/lib/rabbitmq/.rabbitmqadmin.conf \u0026\u0026 sed -e 's/default_user/username/' -e 's/default_pass/password/' /tmp/default_user.conf \u003e\u003e /var/lib/rabbitmq/.rabbitmqadmin.conf \u0026\u0026 chown 999:999 /var/lib/rabbitmq/.rabbitmqadmin.conf \u0026\u0026 chmod 600 /var/lib/rabbitmq/.rabbitmqadmin.conf"],"resources":{"limits":{"cpu":"100m","memory":"500Mi"},"requests":{"cpu":"100m","memory":"500Mi"}},"volumeMounts":[{"name":"plugins-conf","mountPath":"/tmp/rabbitmq-plugins/"},{"name":"rabbitmq-erlang-cookie","mountPath":"/var/lib/rabbitmq/"},{"name":"erlang-cookie-secret","mountPath":"/tmp/erlang-cookie-secret/"},{"name":"rabbitmq-plugins","mountPath":"/operator"},{"name":"persistence","mountPath":"/var/lib/rabbitmq/mnesia/"},{"name":"rabbitmq-confd","mountPath":"/tmp/default_user.conf","subPath":"default_user.conf"}],"terminationMessagePath":"/dev/termination-log","terminationMessagePolicy":"File","imagePullPolicy":"IfNotPresent","securityContext":{"capabilities":{"drop":["FSETID","KILL","SETGID","SETUID","SETPCAP","NET_BIND_SERVICE","NET_RAW","SYS_CHROOT","MKNOD","AUDIT_WRITE","SETFCAP"]},"runAsUser":0}}],"containers":[{"name":"rabbitmq","image":"rabbitmq:3.8.12-management","ports":[{"name":"epmd","containerPort":4369,"protocol":"TCP"},{"name":"amqp","containerPort":5672,"protocol":"TCP"},{"name":"management","containerPort":15672,"protocol":"TCP"},{"name":"prometheus","containerPort":15692,"protocol":"TCP"}],"env":[{"name":"MY_POD_NAME","valueFrom":{"fieldRef":{"apiVersion":"v1","fieldPath":"metadata.name"}}},{"name":"MY_POD_NAMESPACE","valueFrom":{"fieldRef":{"apiVersion":"v1","fieldPath":"metadata.namespace"}}},{"name":"RABBITMQ_ENABLED_PLUGINS_FILE","value":"/operator/enabled_plugins"},{"name":"K8S_SERVICE_NAME","value":"sonar-rabbitmq-cluster-nodes"},{"name":"RABBITMQ_USE_LONGNAME","value":"true"},{"name":"RABBITMQ_NODENAME","value":"rabbit@$(MY_POD_NAME).$(K8S_SERVICE_NAME).$(MY_POD_NAMESPACE)"},{"name":"K8S_HOSTNAME_SUFFIX","value":".$(K8S_SERVICE_NAME).$(MY_POD_NAMESPACE)"}],"resources":{"limits":{"cpu":"2","memory":"2Gi"},"requests":{"cpu":"1","memory":"2Gi"}},"volumeMounts":[{"name":"rabbitmq-erlang-cookie","mountPath":"/var/lib/rabbitmq/"},{"name":"persistence","mountPath":"/var/lib/rabbitmq/mnesia/"},{"name":"rabbitmq-plugins","mountPath":"/operator"},{"name":"rabbitmq-confd","mountPath":"/etc/rabbitmq/conf.d/10-operatorDefaults.conf","subPath":"operatorDefaults.conf"},{"name":"rabbitmq-confd","mountPath":"/etc/rabbitmq/conf.d/11-default_user.conf","subPath":"default_user.conf"},{"name":"rabbitmq-confd","mountPath":"/etc/rabbitmq/conf.d/90-userDefinedConfiguration.conf","subPath":"userDefinedConfiguration.conf"},{"name":"pod-info","mountPath":"/etc/pod-info/"}],"readinessProbe":{"tcpSocket":{"port":"amqp"},"initialDelaySeconds":10,"timeoutSeconds":5,"periodSeconds":10,"successThreshold":1,"failureThreshold":3},"lifecycle":{"preStop":{"exec":{"command":["/bin/bash","-c","if [ ! -z \"$(cat /etc/pod-info/skipPreStopChecks)\" ]; then exit 0; fi; rabbitmq-upgrade await_online_quorum_plus_one -t 604800; rabbitmq-upgrade await_online_synchronized_mirror -t 604800; rabbitmq-upgrade drain -t 604800"]}}},"terminationMessagePath":"/dev/termination-log","terminationMessagePolicy":"File","imagePullPolicy":"IfNotPresent"}],"restartPolicy":"Always","terminationGracePeriodSeconds":604800,"dnsPolicy":"ClusterFirst","serviceAccountName":"sonar-rabbitmq-cluster-server","serviceAccount":"sonar-rabbitmq-cluster-server","automountServiceAccountToken":true,"securityContext":{"runAsUser":999,"runAsGroup":999,"fsGroup":999},"schedulerName":"default-scheduler","topologySpreadConstraints":[{"maxSkew":1,"topologyKey":"topology.kubernetes.io/zone","whenUnsatisfiable":"ScheduleAnyway","labelSelector":{"matchLabels":{"app.kubernetes.io/name":"sonar-rabbitmq-cluster"}}}]}},"volumeClaimTemplates":[{"metadata":{"name":"persistence","namespace":"default","creationTimestamp":null,"labels":{"app.kubernetes.io/component":"rabbitmq","app.kubernetes.io/name":"sonar-rabbitmq-cluster","app.kubernetes.io/part-of":"rabbitmq"},"ownerReferences":[{"apiVersion":"rabbitmq.com/v1beta1","kind":"RabbitmqCluster","name":"sonar-rabbitmq-cluster","uid":"955a1113-f3fc-4efc-a6d1-b15ae324f7c0","controller":true,"blockOwnerDeletion":false}]},"spec":{"accessModes":["ReadWriteOnce"],"resources":{"requests":{"storage":"15Gi"}},"volumeMode":"Filesystem"},"status":{"phase":"Pending"}}],"serviceName":"sonar-rabbitmq-cluster-nodes","podManagementPolicy":"Parallel","updateStrategy":{"type":"RollingUpdate","rollingUpdate":{"partition":0}},"revisionHistoryLimit":10},"status":{"observedGeneration":1,"replicas":1,"readyReplicas":1,"currentReplicas":1,"updatedReplicas":1,"currentRevision":"sonar-rabbitmq-cluster-server-594479b66","updateRevision":"sonar-rabbitmq-cluster-server-594479b66","collisionCount":0}}
2021/04/09 01:07:17 [SONAR-CACHE-READ]	Get	statefulset	default	sonar-rabbitmq-cluster-server	NoError
2021/04/09 01:07:17 [SONAR-SIDE-EFFECT]	Update	statefulset	default	sonar-rabbitmq-cluster-server	NoError
2021/04/09 01:07:17 [SONAR-CACHE-READ]	Get	configmap	default	sonar-rabbitmq-cluster-server-conf	NoError
2021/04/09 01:07:20 [SONAR-EVENT]	27	Updated	statefulset	{"metadata":{"name":"sonar-rabbitmq-cluster-server","namespace":"default","selfLink":"/apis/apps/v1/namespaces/default/statefulsets/sonar-rabbitmq-cluster-server","uid":"2aa29b6e-a32c-4c1f-a68f-97c3efd4f6b2","resourceVersion":"1833","generation":1,"creationTimestamp":"2021-04-09T01:07:08Z","labels":{"app.kubernetes.io/component":"rabbitmq","app.kubernetes.io/name":"sonar-rabbitmq-cluster","app.kubernetes.io/part-of":"rabbitmq"},"annotations":{"rabbitmq.com/createdAt":"2021-04-09T01:07:08Z"},"ownerReferences":[{"apiVersion":"rabbitmq.com/v1beta1","kind":"RabbitmqCluster","name":"sonar-rabbitmq-cluster","uid":"955a1113-f3fc-4efc-a6d1-b15ae324f7c0","controller":true,"blockOwnerDeletion":true}],"managedFields":[{"manager":"kube-controller-manager","operation":"Update","apiVersion":"apps/v1","time":"2021-04-09T01:07:08Z","fieldsType":"FieldsV1","fieldsV1":{"f:status":{"f:collisionCount":{},"f:currentReplicas":{},"f:currentRevision":{},"f:observedGeneration":{},"f:readyReplicas":{},"f:replicas":{},"f:updateRevision":{},"f:updatedReplicas":{}}}},{"manager":"manager","operation":"Update","apiVersion":"apps/v1","time":"2021-04-09T01:07:17Z","fieldsType":"FieldsV1","fieldsV1":{"f:metadata":{"f:annotations":{".":{},"f:rabbitmq.com/createdAt":{}},"f:labels":{".":{},"f:app.kubernetes.io/component":{},"f:app.kubernetes.io/name":{},"f:app.kubernetes.io/part-of":{}},"f:ownerReferences":{".":{},"k:{\"uid\":\"955a1113-f3fc-4efc-a6d1-b15ae324f7c0\"}":{".":{},"f:apiVersion":{},"f:blockOwnerDeletion":{},"f:controller":{},"f:kind":{},"f:name":{},"f:uid":{}}}},"f:spec":{"f:podManagementPolicy":{},"f:replicas":{},"f:revisionHistoryLimit":{},"f:selector":{"f:matchLabels":{".":{},"f:app.kubernetes.io/name":{}}},"f:serviceName":{},"f:template":{"f:metadata":{"f:annotations":{".":{},"f:prometheus.io/port":{},"f:prometheus.io/scrape":{}},"f:labels":{".":{},"f:app.kubernetes.io/component":{},"f:app.kubernetes.io/name":{},"f:app.kubernetes.io/part-of":{}}},"f:spec":{"f:automountServiceAccountToken":{},"f:containers":{"k:{\"name\":\"rabbitmq\"}":{".":{},"f:env":{".":{},"k:{\"name\":\"K8S_HOSTNAME_SUFFIX\"}":{".":{},"f:name":{},"f:value":{}},"k:{\"name\":\"K8S_SERVICE_NAME\"}":{".":{},"f:name":{},"f:value":{}},"k:{\"name\":\"MY_POD_NAME\"}":{".":{},"f:name":{},"f:valueFrom":{".":{},"f:fieldRef":{".":{},"f:apiVersion":{},"f:fieldPath":{}}}},"k:{\"name\":\"MY_POD_NAMESPACE\"}":{".":{},"f:name":{},"f:valueFrom":{".":{},"f:fieldRef":{".":{},"f:apiVersion":{},"f:fieldPath":{}}}},"k:{\"name\":\"RABBITMQ_ENABLED_PLUGINS_FILE\"}":{".":{},"f:name":{},"f:value":{}},"k:{\"name\":\"RABBITMQ_NODENAME\"}":{".":{},"f:name":{},"f:value":{}},"k:{\"name\":\"RABBITMQ_USE_LONGNAME\"}":{".":{},"f:name":{},"f:value":{}}},"f:image":{},"f:imagePullPolicy":{},"f:lifecycle":{".":{},"f:preStop":{".":{},"f:exec":{".":{},"f:command":{}}}},"f:name":{},"f:ports":{".":{},"k:{\"containerPort\":4369,\"protocol\":\"TCP\"}":{".":{},"f:containerPort":{},"f:name":{},"f:protocol":{}},"k:{\"containerPort\":5672,\"protocol\":\"TCP\"}":{".":{},"f:containerPort":{},"f:name":{},"f:protocol":{}},"k:{\"containerPort\":15672,\"protocol\":\"TCP\"}":{".":{},"f:containerPort":{},"f:name":{},"f:protocol":{}},"k:{\"containerPort\":15692,\"protocol\":\"TCP\"}":{".":{},"f:containerPort":{},"f:name":{},"f:protocol":{}}},"f:readinessProbe":{".":{},"f:failureThreshold":{},"f:initialDelaySeconds":{},"f:periodSeconds":{},"f:successThreshold":{},"f:tcpSocket":{".":{},"f:port":{}},"f:timeoutSeconds":{}},"f:resources":{".":{},"f:limits":{".":{},"f:cpu":{},"f:memory":{}},"f:requests":{".":{},"f:cpu":{},"f:memory":{}}},"f:terminationMessagePath":{},"f:terminationMessagePolicy":{},"f:volumeMounts":{".":{},"k:{\"mountPath\":\"/etc/pod-info/\"}":{".":{},"f:mountPath":{},"f:name":{}},"k:{\"mountPath\":\"/etc/rabbitmq/conf.d/10-operatorDefaults.conf\"}":{".":{},"f:mountPath":{},"f:name":{},"f:subPath":{}},"k:{\"mountPath\":\"/etc/rabbitmq/conf.d/11-default_user.conf\"}":{".":{},"f:mountPath":{},"f:name":{},"f:subPath":{}},"k:{\"mountPath\":\"/etc/rabbitmq/conf.d/90-userDefinedConfiguration.conf\"}":{".":{},"f:mountPath":{},"f:name":{},"f:subPath":{}},"k:{\"mountPath\":\"/operator\"}":{".":{},"f:mountPath":{},"f:name":{}},"k:{\"mountPath\":\"/var/lib/rabbitmq/\"}":{".":{},"f:mountPath":{},"f:name":{}},"k:{\"mountPath\":\"/var/lib/rabbitmq/mnesia/\"}":{".":{},"f:mountPath":{},"f:name":{}}}}},"f:dnsPolicy":{},"f:initContainers":{".":{},"k:{\"name\":\"setup-container\"}":{".":{},"f:command":{},"f:image":{},"f:imagePullPolicy":{},"f:name":{},"f:resources":{".":{},"f:limits":{".":{},"f:cpu":{},"f:memory":{}},"f:requests":{".":{},"f:cpu":{},"f:memory":{}}},"f:securityContext":{".":{},"f:capabilities":{".":{},"f:drop":{}},"f:runAsUser":{}},"f:terminationMessagePath":{},"f:terminationMessagePolicy":{},"f:volumeMounts":{".":{},"k:{\"mountPath\":\"/operator\"}":{".":{},"f:mountPath":{},"f:name":{}},"k:{\"mountPath\":\"/tmp/default_user.conf\"}":{".":{},"f:mountPath":{},"f:name":{},"f:subPath":{}},"k:{\"mountPath\":\"/tmp/erlang-cookie-secret/\"}":{".":{},"f:mountPath":{},"f:name":{}},"k:{\"mountPath\":\"/tmp/rabbitmq-plugins/\"}":{".":{},"f:mountPath":{},"f:name":{}},"k:{\"mountPath\":\"/var/lib/rabbitmq/\"}":{".":{},"f:mountPath":{},"f:name":{}},"k:{\"mountPath\":\"/var/lib/rabbitmq/mnesia/\"}":{".":{},"f:mountPath":{},"f:name":{}}}}},"f:restartPolicy":{},"f:schedulerName":{},"f:securityContext":{".":{},"f:fsGroup":{},"f:runAsGroup":{},"f:runAsUser":{}},"f:serviceAccount":{},"f:serviceAccountName":{},"f:terminationGracePeriodSeconds":{},"f:topologySpreadConstraints":{".":{},"k:{\"topologyKey\":\"topology.kubernetes.io/zone\",\"whenUnsatisfiable\":\"ScheduleAnyway\"}":{".":{},"f:labelSelector":{".":{},"f:matchLabels":{".":{},"f:app.kubernetes.io/name":{}}},"f:maxSkew":{},"f:topologyKey":{},"f:whenUnsatisfiable":{}}},"f:volumes":{".":{},"k:{\"name\":\"erlang-cookie-secret\"}":{".":{},"f:name":{},"f:secret":{".":{},"f:defaultMode":{},"f:secretName":{}}},"k:{\"name\":\"plugins-conf\"}":{".":{},"f:configMap":{".":{},"f:defaultMode":{},"f:name":{}},"f:name":{}},"k:{\"name\":\"pod-info\"}":{".":{},"f:downwardAPI":{".":{},"f:defaultMode":{},"f:items":{}},"f:name":{}},"k:{\"name\":\"rabbitmq-confd\"}":{".":{},"f:name":{},"f:projected":{".":{},"f:defaultMode":{},"f:sources":{}}},"k:{\"name\":\"rabbitmq-erlang-cookie\"}":{".":{},"f:emptyDir":{},"f:name":{}},"k:{\"name\":\"rabbitmq-plugins\"}":{".":{},"f:emptyDir":{},"f:name":{}}}}},"f:updateStrategy":{"f:rollingUpdate":{".":{},"f:partition":{}},"f:type":{}},"f:volumeClaimTemplates":{}}}}]},"spec":{"replicas":1,"selector":{"matchLabels":{"app.kubernetes.io/name":"sonar-rabbitmq-cluster"}},"template":{"metadata":{"creationTimestamp":null,"labels":{"app.kubernetes.io/component":"rabbitmq","app.kubernetes.io/name":"sonar-rabbitmq-cluster","app.kubernetes.io/part-of":"rabbitmq"},"annotations":{"prometheus.io/port":"15692","prometheus.io/scrape":"true"}},"spec":{"volumes":[{"name":"plugins-conf","configMap":{"name":"sonar-rabbitmq-cluster-plugins-conf","defaultMode":420}},{"name":"rabbitmq-confd","projected":{"sources":[{"secret":{"name":"sonar-rabbitmq-cluster-default-user","items":[{"key":"default_user.conf","path":"default_user.conf"}]}},{"configMap":{"name":"sonar-rabbitmq-cluster-server-conf","items":[{"key":"operatorDefaults.conf","path":"operatorDefaults.conf"},{"key":"userDefinedConfiguration.conf","path":"userDefinedConfiguration.conf"}]}}],"defaultMode":420}},{"name":"rabbitmq-erlang-cookie","emptyDir":{}},{"name":"erlang-cookie-secret","secret":{"secretName":"sonar-rabbitmq-cluster-erlang-cookie","defaultMode":420}},{"name":"rabbitmq-plugins","emptyDir":{}},{"name":"pod-info","downwardAPI":{"items":[{"path":"skipPreStopChecks","fieldRef":{"apiVersion":"v1","fieldPath":"metadata.labels['skipPreStopChecks']"}}],"defaultMode":420}}],"initContainers":[{"name":"setup-container","image":"rabbitmq:3.8.12-management","command":["sh","-c","cp /tmp/erlang-cookie-secret/.erlang.cookie /var/lib/rabbitmq/.erlang.cookie \u0026\u0026 chown 999:999 /var/lib/rabbitmq/.erlang.cookie \u0026\u0026 chmod 600 /var/lib/rabbitmq/.erlang.cookie ; cp /tmp/rabbitmq-plugins/enabled_plugins /operator/enabled_plugins \u0026\u0026 chown 999:999 /operator/enabled_plugins ; chown 999:999 /var/lib/rabbitmq/mnesia/ ; echo '[default]' \u003e /var/lib/rabbitmq/.rabbitmqadmin.conf \u0026\u0026 sed -e 's/default_user/username/' -e 's/default_pass/password/' /tmp/default_user.conf \u003e\u003e /var/lib/rabbitmq/.rabbitmqadmin.conf \u0026\u0026 chown 999:999 /var/lib/rabbitmq/.rabbitmqadmin.conf \u0026\u0026 chmod 600 /var/lib/rabbitmq/.rabbitmqadmin.conf"],"resources":{"limits":{"cpu":"100m","memory":"500Mi"},"requests":{"cpu":"100m","memory":"500Mi"}},"volumeMounts":[{"name":"plugins-conf","mountPath":"/tmp/rabbitmq-plugins/"},{"name":"rabbitmq-erlang-cookie","mountPath":"/var/lib/rabbitmq/"},{"name":"erlang-cookie-secret","mountPath":"/tmp/erlang-cookie-secret/"},{"name":"rabbitmq-plugins","mountPath":"/operator"},{"name":"persistence","mountPath":"/var/lib/rabbitmq/mnesia/"},{"name":"rabbitmq-confd","mountPath":"/tmp/default_user.conf","subPath":"default_user.conf"}],"terminationMessagePath":"/dev/termination-log","terminationMessagePolicy":"File","imagePullPolicy":"IfNotPresent","securityContext":{"capabilities":{"drop":["FSETID","KILL","SETGID","SETUID","SETPCAP","NET_BIND_SERVICE","NET_RAW","SYS_CHROOT","MKNOD","AUDIT_WRITE","SETFCAP"]},"runAsUser":0}}],"containers":[{"name":"rabbitmq","image":"rabbitmq:3.8.12-management","ports":[{"name":"epmd","containerPort":4369,"protocol":"TCP"},{"name":"amqp","containerPort":5672,"protocol":"TCP"},{"name":"management","containerPort":15672,"protocol":"TCP"},{"name":"prometheus","containerPort":15692,"protocol":"TCP"}],"env":[{"name":"MY_POD_NAME","valueFrom":{"fieldRef":{"apiVersion":"v1","fieldPath":"metadata.name"}}},{"name":"MY_POD_NAMESPACE","valueFrom":{"fieldRef":{"apiVersion":"v1","fieldPath":"metadata.namespace"}}},{"name":"RABBITMQ_ENABLED_PLUGINS_FILE","value":"/operator/enabled_plugins"},{"name":"K8S_SERVICE_NAME","value":"sonar-rabbitmq-cluster-nodes"},{"name":"RABBITMQ_USE_LONGNAME","value":"true"},{"name":"RABBITMQ_NODENAME","value":"rabbit@$(MY_POD_NAME).$(K8S_SERVICE_NAME).$(MY_POD_NAMESPACE)"},{"name":"K8S_HOSTNAME_SUFFIX","value":".$(K8S_SERVICE_NAME).$(MY_POD_NAMESPACE)"}],"resources":{"limits":{"cpu":"2","memory":"2Gi"},"requests":{"cpu":"1","memory":"2Gi"}},"volumeMounts":[{"name":"rabbitmq-erlang-cookie","mountPath":"/var/lib/rabbitmq/"},{"name":"persistence","mountPath":"/var/lib/rabbitmq/mnesia/"},{"name":"rabbitmq-plugins","mountPath":"/operator"},{"name":"rabbitmq-confd","mountPath":"/etc/rabbitmq/conf.d/10-operatorDefaults.conf","subPath":"operatorDefaults.conf"},{"name":"rabbitmq-confd","mountPath":"/etc/rabbitmq/conf.d/11-default_user.conf","subPath":"default_user.conf"},{"name":"rabbitmq-confd","mountPath":"/etc/rabbitmq/conf.d/90-userDefinedConfiguration.conf","subPath":"userDefinedConfiguration.conf"},{"name":"pod-info","mountPath":"/etc/pod-info/"}],"readinessProbe":{"tcpSocket":{"port":"amqp"},"initialDelaySeconds":10,"timeoutSeconds":5,"periodSeconds":10,"successThreshold":1,"failureThreshold":3},"lifecycle":{"preStop":{"exec":{"command":["/bin/bash","-c","if [ ! -z \"$(cat /etc/pod-info/skipPreStopChecks)\" ]; then exit 0; fi; rabbitmq-upgrade await_online_quorum_plus_one -t 604800; rabbitmq-upgrade await_online_synchronized_mirror -t 604800; rabbitmq-upgrade drain -t 604800"]}}},"terminationMessagePath":"/dev/termination-log","terminationMessagePolicy":"File","imagePullPolicy":"IfNotPresent"}],"restartPolicy":"Always","terminationGracePeriodSeconds":604800,"dnsPolicy":"ClusterFirst","serviceAccountName":"sonar-rabbitmq-cluster-server","serviceAccount":"sonar-rabbitmq-cluster-server","automountServiceAccountToken":true,"securityContext":{"runAsUser":999,"runAsGroup":999,"fsGroup":999},"schedulerName":"default-scheduler","topologySpreadConstraints":[{"maxSkew":1,"topologyKey":"topology.kubernetes.io/zone","whenUnsatisfiable":"ScheduleAnyway","labelSelector":{"matchLabels":{"app.kubernetes.io/name":"sonar-rabbitmq-cluster"}}}]}},"volumeClaimTemplates":[{"metadata":{"name":"persistence","namespace":"default","creationTimestamp":null,"labels":{"app.kubernetes.io/component":"rabbitmq","app.kubernetes.io/name":"sonar-rabbitmq-cluster","app.kubernetes.io/part-of":"rabbitmq"},"ownerReferences":[{"apiVersion":"rabbitmq.com/v1beta1","kind":"RabbitmqCluster","name":"sonar-rabbitmq-cluster","uid":"955a1113-f3fc-4efc-a6d1-b15ae324f7c0","controller":true,"blockOwnerDeletion":false}]},"spec":{"accessModes":["ReadWriteOnce"],"resources":{"requests":{"storage":"15Gi"}},"volumeMode":"Filesystem"},"status":{"phase":"Pending"}}],"serviceName":"sonar-rabbitmq-cluster-nodes","podManagementPolicy":"Parallel","updateStrategy":{"type":"RollingUpdate","rollingUpdate":{"partition":0}},"revisionHistoryLimit":10},"status":{"observedGeneration":1,"replicas":1,"readyReplicas":1,"currentReplicas":1,"updatedReplicas":1,"currentRevision":"sonar-rabbitmq-cluster-server-594479b66","updateRevision":"sonar-rabbitmq-cluster-server-594479b66","collisionCount":0}}
2021/04/09 01:07:20 [SONAR-CACHE-READ]	Get	statefulset	default	sonar-rabbitmq-cluster-server	NoError
2021/04/09 01:07:20 [SONAR-CACHE-READ]	Get	configmap	default	sonar-rabbitmq-cluster-plugins-conf	NoError
2021/04/09 01:07:20 [SONAR-SIDE-EFFECT]	Update	statefulset	default	sonar-rabbitmq-cluster-server	NoError
2021/04/09 01:07:20 [SONAR-EVENT]	28	Updated	statefulset	{"metadata":{"name":"sonar-rabbitmq-cluster-server","namespace":"default","selfLink":"/apis/apps/v1/namespaces/default/statefulsets/sonar-rabbitmq-cluster-server","uid":"2aa29b6e-a32c-4c1f-a68f-97c3efd4f6b2","resourceVersion":"1852","generation":1,"creationTimestamp":"2021-04-09T01:07:08Z","labels":{"app.kubernetes.io/component":"rabbitmq","app.kubernetes.io/name":"sonar-rabbitmq-cluster","app.kubernetes.io/part-of":"rabbitmq"},"ownerReferences":[{"apiVersion":"rabbitmq.com/v1beta1","kind":"RabbitmqCluster","name":"sonar-rabbitmq-cluster","uid":"955a1113-f3fc-4efc-a6d1-b15ae324f7c0","controller":true,"blockOwnerDeletion":true}],"managedFields":[{"manager":"kube-controller-manager","operation":"Update","apiVersion":"apps/v1","time":"2021-04-09T01:07:08Z","fieldsType":"FieldsV1","fieldsV1":{"f:status":{"f:collisionCount":{},"f:currentReplicas":{},"f:currentRevision":{},"f:observedGeneration":{},"f:readyReplicas":{},"f:replicas":{},"f:updateRevision":{},"f:updatedReplicas":{}}}},{"manager":"manager","operation":"Update","apiVersion":"apps/v1","time":"2021-04-09T01:07:17Z","fieldsType":"FieldsV1","fieldsV1":{"f:metadata":{"f:labels":{".":{},"f:app.kubernetes.io/component":{},"f:app.kubernetes.io/name":{},"f:app.kubernetes.io/part-of":{}},"f:ownerReferences":{".":{},"k:{\"uid\":\"955a1113-f3fc-4efc-a6d1-b15ae324f7c0\"}":{".":{},"f:apiVersion":{},"f:blockOwnerDeletion":{},"f:controller":{},"f:kind":{},"f:name":{},"f:uid":{}}}},"f:spec":{"f:podManagementPolicy":{},"f:replicas":{},"f:revisionHistoryLimit":{},"f:selector":{"f:matchLabels":{".":{},"f:app.kubernetes.io/name":{}}},"f:serviceName":{},"f:template":{"f:metadata":{"f:annotations":{".":{},"f:prometheus.io/port":{},"f:prometheus.io/scrape":{}},"f:labels":{".":{},"f:app.kubernetes.io/component":{},"f:app.kubernetes.io/name":{},"f:app.kubernetes.io/part-of":{}}},"f:spec":{"f:automountServiceAccountToken":{},"f:containers":{"k:{\"name\":\"rabbitmq\"}":{".":{},"f:env":{".":{},"k:{\"name\":\"K8S_HOSTNAME_SUFFIX\"}":{".":{},"f:name":{},"f:value":{}},"k:{\"name\":\"K8S_SERVICE_NAME\"}":{".":{},"f:name":{},"f:value":{}},"k:{\"name\":\"MY_POD_NAME\"}":{".":{},"f:name":{},"f:valueFrom":{".":{},"f:fieldRef":{".":{},"f:apiVersion":{},"f:fieldPath":{}}}},"k:{\"name\":\"MY_POD_NAMESPACE\"}":{".":{},"f:name":{},"f:valueFrom":{".":{},"f:fieldRef":{".":{},"f:apiVersion":{},"f:fieldPath":{}}}},"k:{\"name\":\"RABBITMQ_ENABLED_PLUGINS_FILE\"}":{".":{},"f:name":{},"f:value":{}},"k:{\"name\":\"RABBITMQ_NODENAME\"}":{".":{},"f:name":{},"f:value":{}},"k:{\"name\":\"RABBITMQ_USE_LONGNAME\"}":{".":{},"f:name":{},"f:value":{}}},"f:image":{},"f:imagePullPolicy":{},"f:lifecycle":{".":{},"f:preStop":{".":{},"f:exec":{".":{},"f:command":{}}}},"f:name":{},"f:ports":{".":{},"k:{\"containerPort\":4369,\"protocol\":\"TCP\"}":{".":{},"f:containerPort":{},"f:name":{},"f:protocol":{}},"k:{\"containerPort\":5672,\"protocol\":\"TCP\"}":{".":{},"f:containerPort":{},"f:name":{},"f:protocol":{}},"k:{\"containerPort\":15672,\"protocol\":\"TCP\"}":{".":{},"f:containerPort":{},"f:name":{},"f:protocol":{}},"k:{\"containerPort\":15692,\"protocol\":\"TCP\"}":{".":{},"f:containerPort":{},"f:name":{},"f:protocol":{}}},"f:readinessProbe":{".":{},"f:failureThreshold":{},"f:initialDelaySeconds":{},"f:periodSeconds":{},"f:successThreshold":{},"f:tcpSocket":{".":{},"f:port":{}},"f:timeoutSeconds":{}},"f:resources":{".":{},"f:limits":{".":{},"f:cpu":{},"f:memory":{}},"f:requests":{".":{},"f:cpu":{},"f:memory":{}}},"f:terminationMessagePath":{},"f:terminationMessagePolicy":{},"f:volumeMounts":{".":{},"k:{\"mountPath\":\"/etc/pod-info/\"}":{".":{},"f:mountPath":{},"f:name":{}},"k:{\"mountPath\":\"/etc/rabbitmq/conf.d/10-operatorDefaults.conf\"}":{".":{},"f:mountPath":{},"f:name":{},"f:subPath":{}},"k:{\"mountPath\":\"/etc/rabbitmq/conf.d/11-default_user.conf\"}":{".":{},"f:mountPath":{},"f:name":{},"f:subPath":{}},"k:{\"mountPath\":\"/etc/rabbitmq/conf.d/90-userDefinedConfiguration.conf\"}":{".":{},"f:mountPath":{},"f:name":{},"f:subPath":{}},"k:{\"mountPath\":\"/operator\"}":{".":{},"f:mountPath":{},"f:name":{}},"k:{\"mountPath\":\"/var/lib/rabbitmq/\"}":{".":{},"f:mountPath":{},"f:name":{}},"k:{\"mountPath\":\"/var/lib/rabbitmq/mnesia/\"}":{".":{},"f:mountPath":{},"f:name":{}}}}},"f:dnsPolicy":{},"f:initContainers":{".":{},"k:{\"name\":\"setup-container\"}":{".":{},"f:command":{},"f:image":{},"f:imagePullPolicy":{},"f:name":{},"f:resources":{".":{},"f:limits":{".":{},"f:cpu":{},"f:memory":{}},"f:requests":{".":{},"f:cpu":{},"f:memory":{}}},"f:securityContext":{".":{},"f:capabilities":{".":{},"f:drop":{}},"f:runAsUser":{}},"f:terminationMessagePath":{},"f:terminationMessagePolicy":{},"f:volumeMounts":{".":{},"k:{\"mountPath\":\"/operator\"}":{".":{},"f:mountPath":{},"f:name":{}},"k:{\"mountPath\":\"/tmp/default_user.conf\"}":{".":{},"f:mountPath":{},"f:name":{},"f:subPath":{}},"k:{\"mountPath\":\"/tmp/erlang-cookie-secret/\"}":{".":{},"f:mountPath":{},"f:name":{}},"k:{\"mountPath\":\"/tmp/rabbitmq-plugins/\"}":{".":{},"f:mountPath":{},"f:name":{}},"k:{\"mountPath\":\"/var/lib/rabbitmq/\"}":{".":{},"f:mountPath":{},"f:name":{}},"k:{\"mountPath\":\"/var/lib/rabbitmq/mnesia/\"}":{".":{},"f:mountPath":{},"f:name":{}}}}},"f:restartPolicy":{},"f:schedulerName":{},"f:securityContext":{".":{},"f:fsGroup":{},"f:runAsGroup":{},"f:runAsUser":{}},"f:serviceAccount":{},"f:serviceAccountName":{},"f:terminationGracePeriodSeconds":{},"f:topologySpreadConstraints":{".":{},"k:{\"topologyKey\":\"topology.kubernetes.io/zone\",\"whenUnsatisfiable\":\"ScheduleAnyway\"}":{".":{},"f:labelSelector":{".":{},"f:matchLabels":{".":{},"f:app.kubernetes.io/name":{}}},"f:maxSkew":{},"f:topologyKey":{},"f:whenUnsatisfiable":{}}},"f:volumes":{".":{},"k:{\"name\":\"erlang-cookie-secret\"}":{".":{},"f:name":{},"f:secret":{".":{},"f:defaultMode":{},"f:secretName":{}}},"k:{\"name\":\"plugins-conf\"}":{".":{},"f:configMap":{".":{},"f:defaultMode":{},"f:name":{}},"f:name":{}},"k:{\"name\":\"pod-info\"}":{".":{},"f:downwardAPI":{".":{},"f:defaultMode":{},"f:items":{}},"f:name":{}},"k:{\"name\":\"rabbitmq-confd\"}":{".":{},"f:name":{},"f:projected":{".":{},"f:defaultMode":{},"f:sources":{}}},"k:{\"name\":\"rabbitmq-erlang-cookie\"}":{".":{},"f:emptyDir":{},"f:name":{}},"k:{\"name\":\"rabbitmq-plugins\"}":{".":{},"f:emptyDir":{},"f:name":{}}}}},"f:updateStrategy":{"f:rollingUpdate":{".":{},"f:partition":{}},"f:type":{}},"f:volumeClaimTemplates":{}}}}]},"spec":{"replicas":1,"selector":{"matchLabels":{"app.kubernetes.io/name":"sonar-rabbitmq-cluster"}},"template":{"metadata":{"creationTimestamp":null,"labels":{"app.kubernetes.io/component":"rabbitmq","app.kubernetes.io/name":"sonar-rabbitmq-cluster","app.kubernetes.io/part-of":"rabbitmq"},"annotations":{"prometheus.io/port":"15692","prometheus.io/scrape":"true"}},"spec":{"volumes":[{"name":"plugins-conf","configMap":{"name":"sonar-rabbitmq-cluster-plugins-conf","defaultMode":420}},{"name":"rabbitmq-confd","projected":{"sources":[{"secret":{"name":"sonar-rabbitmq-cluster-default-user","items":[{"key":"default_user.conf","path":"default_user.conf"}]}},{"configMap":{"name":"sonar-rabbitmq-cluster-server-conf","items":[{"key":"operatorDefaults.conf","path":"operatorDefaults.conf"},{"key":"userDefinedConfiguration.conf","path":"userDefinedConfiguration.conf"}]}}],"defaultMode":420}},{"name":"rabbitmq-erlang-cookie","emptyDir":{}},{"name":"erlang-cookie-secret","secret":{"secretName":"sonar-rabbitmq-cluster-erlang-cookie","defaultMode":420}},{"name":"rabbitmq-plugins","emptyDir":{}},{"name":"pod-info","downwardAPI":{"items":[{"path":"skipPreStopChecks","fieldRef":{"apiVersion":"v1","fieldPath":"metadata.labels['skipPreStopChecks']"}}],"defaultMode":420}}],"initContainers":[{"name":"setup-container","image":"rabbitmq:3.8.12-management","command":["sh","-c","cp /tmp/erlang-cookie-secret/.erlang.cookie /var/lib/rabbitmq/.erlang.cookie \u0026\u0026 chown 999:999 /var/lib/rabbitmq/.erlang.cookie \u0026\u0026 chmod 600 /var/lib/rabbitmq/.erlang.cookie ; cp /tmp/rabbitmq-plugins/enabled_plugins /operator/enabled_plugins \u0026\u0026 chown 999:999 /operator/enabled_plugins ; chown 999:999 /var/lib/rabbitmq/mnesia/ ; echo '[default]' \u003e /var/lib/rabbitmq/.rabbitmqadmin.conf \u0026\u0026 sed -e 's/default_user/username/' -e 's/default_pass/password/' /tmp/default_user.conf \u003e\u003e /var/lib/rabbitmq/.rabbitmqadmin.conf \u0026\u0026 chown 999:999 /var/lib/rabbitmq/.rabbitmqadmin.conf \u0026\u0026 chmod 600 /var/lib/rabbitmq/.rabbitmqadmin.conf"],"resources":{"limits":{"cpu":"100m","memory":"500Mi"},"requests":{"cpu":"100m","memory":"500Mi"}},"volumeMounts":[{"name":"plugins-conf","mountPath":"/tmp/rabbitmq-plugins/"},{"name":"rabbitmq-erlang-cookie","mountPath":"/var/lib/rabbitmq/"},{"name":"erlang-cookie-secret","mountPath":"/tmp/erlang-cookie-secret/"},{"name":"rabbitmq-plugins","mountPath":"/operator"},{"name":"persistence","mountPath":"/var/lib/rabbitmq/mnesia/"},{"name":"rabbitmq-confd","mountPath":"/tmp/default_user.conf","subPath":"default_user.conf"}],"terminationMessagePath":"/dev/termination-log","terminationMessagePolicy":"File","imagePullPolicy":"IfNotPresent","securityContext":{"capabilities":{"drop":["FSETID","KILL","SETGID","SETUID","SETPCAP","NET_BIND_SERVICE","NET_RAW","SYS_CHROOT","MKNOD","AUDIT_WRITE","SETFCAP"]},"runAsUser":0}}],"containers":[{"name":"rabbitmq","image":"rabbitmq:3.8.12-management","ports":[{"name":"epmd","containerPort":4369,"protocol":"TCP"},{"name":"amqp","containerPort":5672,"protocol":"TCP"},{"name":"management","containerPort":15672,"protocol":"TCP"},{"name":"prometheus","containerPort":15692,"protocol":"TCP"}],"env":[{"name":"MY_POD_NAME","valueFrom":{"fieldRef":{"apiVersion":"v1","fieldPath":"metadata.name"}}},{"name":"MY_POD_NAMESPACE","valueFrom":{"fieldRef":{"apiVersion":"v1","fieldPath":"metadata.namespace"}}},{"name":"RABBITMQ_ENABLED_PLUGINS_FILE","value":"/operator/enabled_plugins"},{"name":"K8S_SERVICE_NAME","value":"sonar-rabbitmq-cluster-nodes"},{"name":"RABBITMQ_USE_LONGNAME","value":"true"},{"name":"RABBITMQ_NODENAME","value":"rabbit@$(MY_POD_NAME).$(K8S_SERVICE_NAME).$(MY_POD_NAMESPACE)"},{"name":"K8S_HOSTNAME_SUFFIX","value":".$(K8S_SERVICE_NAME).$(MY_POD_NAMESPACE)"}],"resources":{"limits":{"cpu":"2","memory":"2Gi"},"requests":{"cpu":"1","memory":"2Gi"}},"volumeMounts":[{"name":"rabbitmq-erlang-cookie","mountPath":"/var/lib/rabbitmq/"},{"name":"persistence","mountPath":"/var/lib/rabbitmq/mnesia/"},{"name":"rabbitmq-plugins","mountPath":"/operator"},{"name":"rabbitmq-confd","mountPath":"/etc/rabbitmq/conf.d/10-operatorDefaults.conf","subPath":"operatorDefaults.conf"},{"name":"rabbitmq-confd","mountPath":"/etc/rabbitmq/conf.d/11-default_user.conf","subPath":"default_user.conf"},{"name":"rabbitmq-confd","mountPath":"/etc/rabbitmq/conf.d/90-userDefinedConfiguration.conf","subPath":"userDefinedConfiguration.conf"},{"name":"pod-info","mountPath":"/etc/pod-info/"}],"readinessProbe":{"tcpSocket":{"port":"amqp"},"initialDelaySeconds":10,"timeoutSeconds":5,"periodSeconds":10,"successThreshold":1,"failureThreshold":3},"lifecycle":{"preStop":{"exec":{"command":["/bin/bash","-c","if [ ! -z \"$(cat /etc/pod-info/skipPreStopChecks)\" ]; then exit 0; fi; rabbitmq-upgrade await_online_quorum_plus_one -t 604800; rabbitmq-upgrade await_online_synchronized_mirror -t 604800; rabbitmq-upgrade drain -t 604800"]}}},"terminationMessagePath":"/dev/termination-log","terminationMessagePolicy":"File","imagePullPolicy":"IfNotPresent"}],"restartPolicy":"Always","terminationGracePeriodSeconds":604800,"dnsPolicy":"ClusterFirst","serviceAccountName":"sonar-rabbitmq-cluster-server","serviceAccount":"sonar-rabbitmq-cluster-server","automountServiceAccountToken":true,"securityContext":{"runAsUser":999,"runAsGroup":999,"fsGroup":999},"schedulerName":"default-scheduler","topologySpreadConstraints":[{"maxSkew":1,"topologyKey":"topology.kubernetes.io/zone","whenUnsatisfiable":"ScheduleAnyway","labelSelector":{"matchLabels":{"app.kubernetes.io/name":"sonar-rabbitmq-cluster"}}}]}},"volumeClaimTemplates":[{"metadata":{"name":"persistence","namespace":"default","creationTimestamp":null,"labels":{"app.kubernetes.io/component":"rabbitmq","app.kubernetes.io/name":"sonar-rabbitmq-cluster","app.kubernetes.io/part-of":"rabbitmq"},"ownerReferences":[{"apiVersion":"rabbitmq.com/v1beta1","kind":"RabbitmqCluster","name":"sonar-rabbitmq-cluster","uid":"955a1113-f3fc-4efc-a6d1-b15ae324f7c0","controller":true,"blockOwnerDeletion":false}]},"spec":{"accessModes":["ReadWriteOnce"],"resources":{"requests":{"storage":"15Gi"}},"volumeMode":"Filesystem"},"status":{"phase":"Pending"}}],"serviceName":"sonar-rabbitmq-cluster-nodes","podManagementPolicy":"Parallel","updateStrategy":{"type":"RollingUpdate","rollingUpdate":{"partition":0}},"revisionHistoryLimit":10},"status":{"observedGeneration":1,"replicas":1,"readyReplicas":1,"currentReplicas":1,"updatedReplicas":1,"currentRevision":"sonar-rabbitmq-cluster-server-594479b66","updateRevision":"sonar-rabbitmq-cluster-server-594479b66","collisionCount":0}}
2021/04/09 01:07:20 [SONAR-FINISH-RECONCILE]	rabbitmqcluster	5
2021/04/09 01:07:20 [SONAR-START-RECONCILE]	rabbitmqcluster	6
2021/04/09 01:07:23 [SONAR-EVENT]	29	Updated	rabbitmqcluster	{"metadata":{"name":"sonar-rabbitmq-cluster","namespace":"default","selfLink":"/apis/rabbitmq.com/v1beta1/namespaces/default/rabbitmqclusters/sonar-rabbitmq-cluster","uid":"955a1113-f3fc-4efc-a6d1-b15ae324f7c0","resourceVersion":"1853","generation":3,"creationTimestamp":"2021-04-09T01:06:05Z","annotations":{"kubectl.kubernetes.io/last-applied-configuration":"{\"apiVersion\":\"rabbitmq.com/v1beta1\",\"kind\":\"RabbitmqCluster\",\"metadata\":{\"annotations\":{},\"name\":\"sonar-rabbitmq-cluster\",\"namespace\":\"default\"},\"spec\":{\"persistence\":{\"storage\":\"15Gi\"},\"replicas\":1}}\n"},"finalizers":["deletion.finalizers.rabbitmqclusters.rabbitmq.com"],"managedFields":[{"manager":"kubectl-client-side-apply","operation":"Update","apiVersion":"rabbitmq.com/v1beta1","time":"2021-04-09T01:06:55Z","fieldsType":"FieldsV1","fieldsV1":{"f:metadata":{"f:annotations":{".":{},"f:kubectl.kubernetes.io/last-applied-configuration":{}}},"f:spec":{".":{},"f:image":{},"f:persistence":{".":{},"f:storage":{}},"f:replicas":{},"f:resources":{".":{},"f:limits":{".":{},"f:memory":{}},"f:requests":{".":{},"f:memory":{}}},"f:service":{".":{},"f:type":{}},"f:terminationGracePeriodSeconds":{}}}},{"manager":"manager","operation":"Update","apiVersion":"rabbitmq.com/v1beta1","time":"2021-04-09T01:07:20Z","fieldsType":"FieldsV1","fieldsV1":{"f:metadata":{"f:finalizers":{}},"f:spec":{"f:override":{},"f:rabbitmq":{},"f:resources":{"f:limits":{"f:cpu":{}},"f:requests":{"f:cpu":{}}},"f:tls":{}},"f:status":{".":{},"f:conditions":{},"f:defaultUser":{".":{},"f:secretReference":{".":{},"f:keys":{".":{},"f:password":{},"f:username":{}},"f:name":{},"f:namespace":{}},"f:serviceReference":{".":{},"f:name":{},"f:namespace":{}}}}}}]},"spec":{"replicas":1,"image":"rabbitmq:3.8.12-management","service":{"type":"ClusterIP"},"persistence":{"storage":"15Gi"},"resources":{"limits":{"cpu":"2","memory":"2Gi"},"requests":{"cpu":"1","memory":"2Gi"}},"rabbitmq":{},"tls":{},"override":{},"terminationGracePeriodSeconds":604800},"status":{"conditions":[{"type":"AllReplicasReady","status":"Unknown","lastTransitionTime":"2021-04-09T01:07:08Z","reason":"MissingStatefulSet","message":"Could not find StatefulSet"},{"type":"ClusterAvailable","status":"True","lastTransitionTime":"2021-04-09T01:07:08Z","reason":"AtLeastOneEndpointAvailable"},{"type":"NoWarnings","status":"Unknown","lastTransitionTime":"2021-04-09T01:07:08Z","reason":"MissingStatefulSet","message":"Could not find StatefulSet"},{"type":"ReconcileSuccess","status":"True","lastTransitionTime":"2021-04-09T01:07:20Z","reason":"Success","message":"Finish reconciling"}],"defaultUser":{"secretReference":{"name":"sonar-rabbitmq-cluster-default-user","namespace":"default","keys":{"password":"password","username":"username"}},"serviceReference":{"name":"sonar-rabbitmq-cluster","namespace":"default"}}}}
2021/04/09 01:07:23 [SONAR-CACHE-READ]	Get	rabbitmqcluster	default	sonar-rabbitmq-cluster	NoError
2021/04/09 01:07:23 [SONAR-CACHE-READ]	Get	statefulset	default	sonar-rabbitmq-cluster-server	NoError
2021/04/09 01:07:23 [SONAR-CACHE-READ]	Get	endpoints	default	sonar-rabbitmq-cluster	NoError
2021/04/09 01:07:23 [SONAR-CACHE-READ]	Get	statefulset	default	sonar-rabbitmq-cluster-server	NoError
2021/04/09 01:07:23 [SONAR-CACHE-READ]	Get	service	default	sonar-rabbitmq-cluster-nodes	NoError
2021/04/09 01:07:23 [SONAR-CACHE-READ]	Get	service	default	sonar-rabbitmq-cluster	NoError
2021/04/09 01:07:23 [SONAR-CACHE-READ]	Get	secret	default	sonar-rabbitmq-cluster-erlang-cookie	NoError
2021/04/09 01:07:23 [SONAR-CACHE-READ]	Get	secret	default	sonar-rabbitmq-cluster-default-user	NoError
2021/04/09 01:07:23 [SONAR-CACHE-READ]	Get	configmap	default	sonar-rabbitmq-cluster-plugins-conf	NoError
2021/04/09 01:07:23 [SONAR-CACHE-READ]	Get	configmap	default	sonar-rabbitmq-cluster-server-conf	NoError
2021/04/09 01:07:23 [SONAR-CACHE-READ]	Get	serviceaccount	default	sonar-rabbitmq-cluster-server	NoError
2021/04/09 01:07:23 [SONAR-CACHE-READ]	Get	role	default	sonar-rabbitmq-cluster-peer-discovery	NoError
2021/04/09 01:07:23 [SONAR-CACHE-READ]	Get	rolebinding	default	sonar-rabbitmq-cluster-server	NoError
2021/04/09 01:07:23 [SONAR-CACHE-READ]	Get	statefulset	default	sonar-rabbitmq-cluster-server	NoError
2021/04/09 01:07:23 [SONAR-CACHE-READ]	Get	statefulset	default	sonar-rabbitmq-cluster-server	NoError
2021/04/09 01:07:23 [SONAR-SIDE-EFFECT]	Update	statefulset	default	sonar-rabbitmq-cluster-server	NoError
2021/04/09 01:07:23 [SONAR-CACHE-READ]	Get	configmap	default	sonar-rabbitmq-cluster-server-conf	NoError
2021/04/09 01:07:23 [SONAR-CACHE-READ]	Get	statefulset	default	sonar-rabbitmq-cluster-server	NoError
2021/04/09 01:07:23 [SONAR-CACHE-READ]	Get	configmap	default	sonar-rabbitmq-cluster-plugins-conf	NoError
2021/04/09 01:07:23 [SONAR-EVENT]	30	Updated	rabbitmqcluster	{"metadata":{"name":"sonar-rabbitmq-cluster","namespace":"default","selfLink":"/apis/rabbitmq.com/v1beta1/namespaces/default/rabbitmqclusters/sonar-rabbitmq-cluster","uid":"955a1113-f3fc-4efc-a6d1-b15ae324f7c0","resourceVersion":"1865","generation":3,"creationTimestamp":"2021-04-09T01:06:05Z","annotations":{"kubectl.kubernetes.io/last-applied-configuration":"{\"apiVersion\":\"rabbitmq.com/v1beta1\",\"kind\":\"RabbitmqCluster\",\"metadata\":{\"annotations\":{},\"name\":\"sonar-rabbitmq-cluster\",\"namespace\":\"default\"},\"spec\":{\"persistence\":{\"storage\":\"15Gi\"},\"replicas\":1}}\n"},"finalizers":["deletion.finalizers.rabbitmqclusters.rabbitmq.com"],"managedFields":[{"manager":"kubectl-client-side-apply","operation":"Update","apiVersion":"rabbitmq.com/v1beta1","time":"2021-04-09T01:06:55Z","fieldsType":"FieldsV1","fieldsV1":{"f:metadata":{"f:annotations":{".":{},"f:kubectl.kubernetes.io/last-applied-configuration":{}}},"f:spec":{".":{},"f:image":{},"f:persistence":{".":{},"f:storage":{}},"f:replicas":{},"f:resources":{".":{},"f:limits":{".":{},"f:memory":{}},"f:requests":{".":{},"f:memory":{}}},"f:service":{".":{},"f:type":{}},"f:terminationGracePeriodSeconds":{}}}},{"manager":"manager","operation":"Update","apiVersion":"rabbitmq.com/v1beta1","time":"2021-04-09T01:07:23Z","fieldsType":"FieldsV1","fieldsV1":{"f:metadata":{"f:finalizers":{}},"f:spec":{"f:override":{},"f:rabbitmq":{},"f:resources":{"f:limits":{"f:cpu":{}},"f:requests":{"f:cpu":{}}},"f:tls":{}},"f:status":{".":{},"f:conditions":{},"f:defaultUser":{".":{},"f:secretReference":{".":{},"f:keys":{".":{},"f:password":{},"f:username":{}},"f:name":{},"f:namespace":{}},"f:serviceReference":{".":{},"f:name":{},"f:namespace":{}}}}}}]},"spec":{"replicas":1,"image":"rabbitmq:3.8.12-management","service":{"type":"ClusterIP"},"persistence":{"storage":"15Gi"},"resources":{"limits":{"cpu":"2","memory":"2Gi"},"requests":{"cpu":"1","memory":"2Gi"}},"rabbitmq":{},"tls":{},"override":{},"terminationGracePeriodSeconds":604800},"status":{"conditions":[{"type":"AllReplicasReady","status":"True","lastTransitionTime":"2021-04-09T01:07:23Z","reason":"AllPodsAreReady"},{"type":"ClusterAvailable","status":"True","lastTransitionTime":"2021-04-09T01:07:08Z","reason":"AtLeastOneEndpointAvailable"},{"type":"NoWarnings","status":"True","lastTransitionTime":"2021-04-09T01:07:23Z","reason":"NoWarnings"},{"type":"ReconcileSuccess","status":"True","lastTransitionTime":"2021-04-09T01:07:20Z","reason":"Success","message":"Finish reconciling"}],"defaultUser":{"secretReference":{"name":"sonar-rabbitmq-cluster-default-user","namespace":"default","keys":{"password":"password","username":"username"}},"serviceReference":{"name":"sonar-rabbitmq-cluster","namespace":"default"}}}}
2021/04/09 01:07:23 [SONAR-FINISH-RECONCILE]	rabbitmqcluster	6
2021/04/09 01:07:23 [SONAR-START-RECONCILE]	rabbitmqcluster	7
2021/04/09 01:07:23 [SONAR-CACHE-READ]	Get	rabbitmqcluster	default	sonar-rabbitmq-cluster	NoError
2021/04/09 01:07:23 [SONAR-CACHE-READ]	Get	statefulset	default	sonar-rabbitmq-cluster-server	NoError
2021/04/09 01:07:23 [SONAR-CACHE-READ]	Get	endpoints	default	sonar-rabbitmq-cluster	NoError
2021/04/09 01:07:23 [SONAR-CACHE-READ]	Get	statefulset	default	sonar-rabbitmq-cluster-server	NoError
2021/04/09 01:07:23 [SONAR-CACHE-READ]	Get	service	default	sonar-rabbitmq-cluster-nodes	NoError
2021/04/09 01:07:23 [SONAR-CACHE-READ]	Get	service	default	sonar-rabbitmq-cluster	NoError
2021/04/09 01:07:23 [SONAR-CACHE-READ]	Get	secret	default	sonar-rabbitmq-cluster-erlang-cookie	NoError
2021/04/09 01:07:23 [SONAR-CACHE-READ]	Get	secret	default	sonar-rabbitmq-cluster-default-user	NoError
2021/04/09 01:07:23 [SONAR-CACHE-READ]	Get	configmap	default	sonar-rabbitmq-cluster-plugins-conf	NoError
2021/04/09 01:07:23 [SONAR-CACHE-READ]	Get	configmap	default	sonar-rabbitmq-cluster-server-conf	NoError
2021/04/09 01:07:23 [SONAR-CACHE-READ]	Get	serviceaccount	default	sonar-rabbitmq-cluster-server	NoError
2021/04/09 01:07:23 [SONAR-CACHE-READ]	Get	role	default	sonar-rabbitmq-cluster-peer-discovery	NoError
2021/04/09 01:07:23 [SONAR-CACHE-READ]	Get	rolebinding	default	sonar-rabbitmq-cluster-server	NoError
2021/04/09 01:07:23 [SONAR-CACHE-READ]	Get	statefulset	default	sonar-rabbitmq-cluster-server	NoError
2021/04/09 01:07:23 [SONAR-CACHE-READ]	Get	statefulset	default	sonar-rabbitmq-cluster-server	NoError
2021/04/09 01:07:23 [SONAR-SIDE-EFFECT]	Update	statefulset	default	sonar-rabbitmq-cluster-server	NoError
2021/04/09 01:07:24 [SONAR-CACHE-READ]	Get	configmap	default	sonar-rabbitmq-cluster-server-conf	NoError
2021/04/09 01:07:24 [SONAR-CACHE-READ]	Get	statefulset	default	sonar-rabbitmq-cluster-server	NoError
2021/04/09 01:07:24 [SONAR-CACHE-READ]	Get	configmap	default	sonar-rabbitmq-cluster-plugins-conf	NoError
2021/04/09 01:07:24 no event happening
2021/04/09 01:07:24 [SONAR-FINISH-RECONCILE]	rabbitmqcluster	7
2021/04/09 01:07:24 [SONAR-START-RECONCILE]	rabbitmqcluster	8
2021/04/09 01:07:24 [SONAR-CACHE-READ]	Get	rabbitmqcluster	default	sonar-rabbitmq-cluster	NoError
2021/04/09 01:07:24 [SONAR-CACHE-READ]	Get	statefulset	default	sonar-rabbitmq-cluster-server	NoError
2021/04/09 01:07:24 [SONAR-CACHE-READ]	Get	endpoints	default	sonar-rabbitmq-cluster	NoError
2021/04/09 01:07:24 [SONAR-CACHE-READ]	Get	statefulset	default	sonar-rabbitmq-cluster-server	NoError
2021/04/09 01:07:24 [SONAR-CACHE-READ]	Get	service	default	sonar-rabbitmq-cluster-nodes	NoError
2021/04/09 01:07:24 [SONAR-CACHE-READ]	Get	service	default	sonar-rabbitmq-cluster	NoError
2021/04/09 01:07:24 [SONAR-CACHE-READ]	Get	secret	default	sonar-rabbitmq-cluster-erlang-cookie	NoError
2021/04/09 01:07:24 [SONAR-CACHE-READ]	Get	secret	default	sonar-rabbitmq-cluster-default-user	NoError
2021/04/09 01:07:24 [SONAR-CACHE-READ]	Get	configmap	default	sonar-rabbitmq-cluster-plugins-conf	NoError
2021/04/09 01:07:24 [SONAR-CACHE-READ]	Get	configmap	default	sonar-rabbitmq-cluster-server-conf	NoError
2021/04/09 01:07:24 [SONAR-CACHE-READ]	Get	serviceaccount	default	sonar-rabbitmq-cluster-server	NoError
2021/04/09 01:07:24 [SONAR-CACHE-READ]	Get	role	default	sonar-rabbitmq-cluster-peer-discovery	NoError
2021/04/09 01:07:24 [SONAR-CACHE-READ]	Get	rolebinding	default	sonar-rabbitmq-cluster-server	NoError
2021/04/09 01:07:24 [SONAR-CACHE-READ]	Get	statefulset	default	sonar-rabbitmq-cluster-server	NoError
2021/04/09 01:07:24 [SONAR-CACHE-READ]	Get	statefulset	default	sonar-rabbitmq-cluster-server	NoError
2021/04/09 01:07:24 [SONAR-SIDE-EFFECT]	Update	statefulset	default	sonar-rabbitmq-cluster-server	NoError
2021/04/09 01:07:24 [SONAR-CACHE-READ]	Get	configmap	default	sonar-rabbitmq-cluster-server-conf	NoError
2021/04/09 01:07:24 [SONAR-CACHE-READ]	Get	statefulset	default	sonar-rabbitmq-cluster-server	NoError
2021/04/09 01:07:24 [SONAR-CACHE-READ]	Get	configmap	default	sonar-rabbitmq-cluster-plugins-conf	NoError
2021/04/09 01:07:24 no event happening
2021/04/09 01:07:24 [SONAR-FINISH-RECONCILE]	rabbitmqcluster	8
2021/04/09 01:07:27 no event happening
2021/04/09 01:07:30 no event happening
2021/04/09 01:07:33 no event happening
2021/04/09 01:07:36 no event happening
2021/04/09 01:07:39 no event happening
2021/04/09 01:07:42 no event happening
2021/04/09 01:07:45 no event happening
